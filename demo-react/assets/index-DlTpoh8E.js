var NI=Object.defineProperty;var MI=(t,e,s)=>e in t?NI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var II=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Wt=(t,e,s)=>MI(t,typeof e!="symbol"?e+"":e,s);var C9=II((D9,Md)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=s(i);fetch(i.href,r)}})();function RI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Fm={exports:{}},Qu={},Pm={exports:{}},ls={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $b;function FI(){if($b)return ls;$b=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),r=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function f(Q){return Q===null||typeof Q!="object"?null:(Q=g&&Q[g]||Q["@@iterator"],typeof Q=="function"?Q:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,_={};function x(Q,Et,Xt){this.props=Q,this.context=Et,this.refs=_,this.updater=Xt||p}x.prototype.isReactComponent={},x.prototype.setState=function(Q,Et){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,Et,"setState")},x.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function v(){}v.prototype=x.prototype;function b(Q,Et,Xt){this.props=Q,this.context=Et,this.refs=_,this.updater=Xt||p}var S=b.prototype=new v;S.constructor=b,y(S,x.prototype),S.isPureReactComponent=!0;var A=Array.isArray,w=Object.prototype.hasOwnProperty,L={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function F(Q,Et,Xt){var Ht,Zt={},ae=null,pe=null;if(Et!=null)for(Ht in Et.ref!==void 0&&(pe=Et.ref),Et.key!==void 0&&(ae=""+Et.key),Et)w.call(Et,Ht)&&!I.hasOwnProperty(Ht)&&(Zt[Ht]=Et[Ht]);var ne=arguments.length-2;if(ne===1)Zt.children=Xt;else if(1<ne){for(var te=Array(ne),se=0;se<ne;se++)te[se]=arguments[se+2];Zt.children=te}if(Q&&Q.defaultProps)for(Ht in ne=Q.defaultProps,ne)Zt[Ht]===void 0&&(Zt[Ht]=ne[Ht]);return{$$typeof:t,type:Q,key:ae,ref:pe,props:Zt,_owner:L.current}}function O(Q,Et){return{$$typeof:t,type:Q.type,key:Et,ref:Q.ref,props:Q.props,_owner:Q._owner}}function V(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===t}function j(Q){var Et={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(Xt){return Et[Xt]})}var Z=/\/+/g;function at(Q,Et){return typeof Q=="object"&&Q!==null&&Q.key!=null?j(""+Q.key):Et.toString(36)}function pt(Q,Et,Xt,Ht,Zt){var ae=typeof Q;(ae==="undefined"||ae==="boolean")&&(Q=null);var pe=!1;if(Q===null)pe=!0;else switch(ae){case"string":case"number":pe=!0;break;case"object":switch(Q.$$typeof){case t:case e:pe=!0}}if(pe)return pe=Q,Zt=Zt(pe),Q=Ht===""?"."+at(pe,0):Ht,A(Zt)?(Xt="",Q!=null&&(Xt=Q.replace(Z,"$&/")+"/"),pt(Zt,Et,Xt,"",function(se){return se})):Zt!=null&&(V(Zt)&&(Zt=O(Zt,Xt+(!Zt.key||pe&&pe.key===Zt.key?"":(""+Zt.key).replace(Z,"$&/")+"/")+Q)),Et.push(Zt)),1;if(pe=0,Ht=Ht===""?".":Ht+":",A(Q))for(var ne=0;ne<Q.length;ne++){ae=Q[ne];var te=Ht+at(ae,ne);pe+=pt(ae,Et,Xt,te,Zt)}else if(te=f(Q),typeof te=="function")for(Q=te.call(Q),ne=0;!(ae=Q.next()).done;)ae=ae.value,te=Ht+at(ae,ne++),pe+=pt(ae,Et,Xt,te,Zt);else if(ae==="object")throw Et=String(Q),Error("Objects are not valid as a React child (found: "+(Et==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":Et)+"). If you meant to render a collection of children, use an array instead.");return pe}function K(Q,Et,Xt){if(Q==null)return Q;var Ht=[],Zt=0;return pt(Q,Ht,"","",function(ae){return Et.call(Xt,ae,Zt++)}),Ht}function ut(Q){if(Q._status===-1){var Et=Q._result;Et=Et(),Et.then(function(Xt){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=Xt)},function(Xt){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=Xt)}),Q._status===-1&&(Q._status=0,Q._result=Et)}if(Q._status===1)return Q._result.default;throw Q._result}var ht={current:null},nt={transition:null},ot={ReactCurrentDispatcher:ht,ReactCurrentBatchConfig:nt,ReactCurrentOwner:L};function Nt(){throw Error("act(...) is not supported in production builds of React.")}return ls.Children={map:K,forEach:function(Q,Et,Xt){K(Q,function(){Et.apply(this,arguments)},Xt)},count:function(Q){var Et=0;return K(Q,function(){Et++}),Et},toArray:function(Q){return K(Q,function(Et){return Et})||[]},only:function(Q){if(!V(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},ls.Component=x,ls.Fragment=s,ls.Profiler=i,ls.PureComponent=b,ls.StrictMode=n,ls.Suspense=l,ls.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ot,ls.act=Nt,ls.cloneElement=function(Q,Et,Xt){if(Q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Q+".");var Ht=y({},Q.props),Zt=Q.key,ae=Q.ref,pe=Q._owner;if(Et!=null){if(Et.ref!==void 0&&(ae=Et.ref,pe=L.current),Et.key!==void 0&&(Zt=""+Et.key),Q.type&&Q.type.defaultProps)var ne=Q.type.defaultProps;for(te in Et)w.call(Et,te)&&!I.hasOwnProperty(te)&&(Ht[te]=Et[te]===void 0&&ne!==void 0?ne[te]:Et[te])}var te=arguments.length-2;if(te===1)Ht.children=Xt;else if(1<te){ne=Array(te);for(var se=0;se<te;se++)ne[se]=arguments[se+2];Ht.children=ne}return{$$typeof:t,type:Q.type,key:Zt,ref:ae,props:Ht,_owner:pe}},ls.createContext=function(Q){return Q={$$typeof:o,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Q.Provider={$$typeof:r,_context:Q},Q.Consumer=Q},ls.createElement=F,ls.createFactory=function(Q){var Et=F.bind(null,Q);return Et.type=Q,Et},ls.createRef=function(){return{current:null}},ls.forwardRef=function(Q){return{$$typeof:a,render:Q}},ls.isValidElement=V,ls.lazy=function(Q){return{$$typeof:h,_payload:{_status:-1,_result:Q},_init:ut}},ls.memo=function(Q,Et){return{$$typeof:u,type:Q,compare:Et===void 0?null:Et}},ls.startTransition=function(Q){var Et=nt.transition;nt.transition={};try{Q()}finally{nt.transition=Et}},ls.unstable_act=Nt,ls.useCallback=function(Q,Et){return ht.current.useCallback(Q,Et)},ls.useContext=function(Q){return ht.current.useContext(Q)},ls.useDebugValue=function(){},ls.useDeferredValue=function(Q){return ht.current.useDeferredValue(Q)},ls.useEffect=function(Q,Et){return ht.current.useEffect(Q,Et)},ls.useId=function(){return ht.current.useId()},ls.useImperativeHandle=function(Q,Et,Xt){return ht.current.useImperativeHandle(Q,Et,Xt)},ls.useInsertionEffect=function(Q,Et){return ht.current.useInsertionEffect(Q,Et)},ls.useLayoutEffect=function(Q,Et){return ht.current.useLayoutEffect(Q,Et)},ls.useMemo=function(Q,Et){return ht.current.useMemo(Q,Et)},ls.useReducer=function(Q,Et,Xt){return ht.current.useReducer(Q,Et,Xt)},ls.useRef=function(Q){return ht.current.useRef(Q)},ls.useState=function(Q){return ht.current.useState(Q)},ls.useSyncExternalStore=function(Q,Et,Xt){return ht.current.useSyncExternalStore(Q,Et,Xt)},ls.useTransition=function(){return ht.current.useTransition()},ls.version="18.3.1",ls}var qb;function ph(){return qb||(qb=1,Pm.exports=FI()),Pm.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yb;function PI(){if(Yb)return Qu;Yb=1;var t=ph(),e=Symbol.for("react.element"),s=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,u){var h,g={},f=null,p=null;u!==void 0&&(f=""+u),l.key!==void 0&&(f=""+l.key),l.ref!==void 0&&(p=l.ref);for(h in l)n.call(l,h)&&!r.hasOwnProperty(h)&&(g[h]=l[h]);if(a&&a.defaultProps)for(h in l=a.defaultProps,l)g[h]===void 0&&(g[h]=l[h]);return{$$typeof:e,type:a,key:f,ref:p,props:g,_owner:i.current}}return Qu.Fragment=s,Qu.jsx=o,Qu.jsxs=o,Qu}var Wb;function zI(){return Wb||(Wb=1,Fm.exports=PI()),Fm.exports}var zt=zI(),Mc={},zm={exports:{}},pi={},Dm={exports:{}},Om={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xb;function DI(){return Xb||(Xb=1,(function(t){function e(nt,ot){var Nt=nt.length;nt.push(ot);t:for(;0<Nt;){var Q=Nt-1>>>1,Et=nt[Q];if(0<i(Et,ot))nt[Q]=ot,nt[Nt]=Et,Nt=Q;else break t}}function s(nt){return nt.length===0?null:nt[0]}function n(nt){if(nt.length===0)return null;var ot=nt[0],Nt=nt.pop();if(Nt!==ot){nt[0]=Nt;t:for(var Q=0,Et=nt.length,Xt=Et>>>1;Q<Xt;){var Ht=2*(Q+1)-1,Zt=nt[Ht],ae=Ht+1,pe=nt[ae];if(0>i(Zt,Nt))ae<Et&&0>i(pe,Zt)?(nt[Q]=pe,nt[ae]=Nt,Q=ae):(nt[Q]=Zt,nt[Ht]=Nt,Q=Ht);else if(ae<Et&&0>i(pe,Nt))nt[Q]=pe,nt[ae]=Nt,Q=ae;else break t}}return ot}function i(nt,ot){var Nt=nt.sortIndex-ot.sortIndex;return Nt!==0?Nt:nt.id-ot.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,g=null,f=3,p=!1,y=!1,_=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(nt){for(var ot=s(u);ot!==null;){if(ot.callback===null)n(u);else if(ot.startTime<=nt)n(u),ot.sortIndex=ot.expirationTime,e(l,ot);else break;ot=s(u)}}function A(nt){if(_=!1,S(nt),!y)if(s(l)!==null)y=!0,ut(w);else{var ot=s(u);ot!==null&&ht(A,ot.startTime-nt)}}function w(nt,ot){y=!1,_&&(_=!1,v(F),F=-1),p=!0;var Nt=f;try{for(S(ot),g=s(l);g!==null&&(!(g.expirationTime>ot)||nt&&!j());){var Q=g.callback;if(typeof Q=="function"){g.callback=null,f=g.priorityLevel;var Et=Q(g.expirationTime<=ot);ot=t.unstable_now(),typeof Et=="function"?g.callback=Et:g===s(l)&&n(l),S(ot)}else n(l);g=s(l)}if(g!==null)var Xt=!0;else{var Ht=s(u);Ht!==null&&ht(A,Ht.startTime-ot),Xt=!1}return Xt}finally{g=null,f=Nt,p=!1}}var L=!1,I=null,F=-1,O=5,V=-1;function j(){return!(t.unstable_now()-V<O)}function Z(){if(I!==null){var nt=t.unstable_now();V=nt;var ot=!0;try{ot=I(!0,nt)}finally{ot?at():(L=!1,I=null)}}else L=!1}var at;if(typeof b=="function")at=function(){b(Z)};else if(typeof MessageChannel<"u"){var pt=new MessageChannel,K=pt.port2;pt.port1.onmessage=Z,at=function(){K.postMessage(null)}}else at=function(){x(Z,0)};function ut(nt){I=nt,L||(L=!0,at())}function ht(nt,ot){F=x(function(){nt(t.unstable_now())},ot)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(nt){nt.callback=null},t.unstable_continueExecution=function(){y||p||(y=!0,ut(w))},t.unstable_forceFrameRate=function(nt){0>nt||125<nt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<nt?Math.floor(1e3/nt):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return s(l)},t.unstable_next=function(nt){switch(f){case 1:case 2:case 3:var ot=3;break;default:ot=f}var Nt=f;f=ot;try{return nt()}finally{f=Nt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(nt,ot){switch(nt){case 1:case 2:case 3:case 4:case 5:break;default:nt=3}var Nt=f;f=nt;try{return ot()}finally{f=Nt}},t.unstable_scheduleCallback=function(nt,ot,Nt){var Q=t.unstable_now();switch(typeof Nt=="object"&&Nt!==null?(Nt=Nt.delay,Nt=typeof Nt=="number"&&0<Nt?Q+Nt:Q):Nt=Q,nt){case 1:var Et=-1;break;case 2:Et=250;break;case 5:Et=1073741823;break;case 4:Et=1e4;break;default:Et=5e3}return Et=Nt+Et,nt={id:h++,callback:ot,priorityLevel:nt,startTime:Nt,expirationTime:Et,sortIndex:-1},Nt>Q?(nt.sortIndex=Nt,e(u,nt),s(l)===null&&nt===s(u)&&(_?(v(F),F=-1):_=!0,ht(A,Nt-Q))):(nt.sortIndex=Et,e(l,nt),y||p||(y=!0,ut(w))),nt},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(nt){var ot=f;return function(){var Nt=f;f=ot;try{return nt.apply(this,arguments)}finally{f=Nt}}}})(Om)),Om}var Zb;function OI(){return Zb||(Zb=1,Dm.exports=DI()),Dm.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kb;function BI(){if(Kb)return pi;Kb=1;var t=ph(),e=OI();function s(d){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+d,m=1;m<arguments.length;m++)c+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+d+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function r(d,c){o(d,c),o(d+"Capture",c)}function o(d,c){for(i[d]=c,d=0;d<c.length;d++)n.add(c[d])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},g={};function f(d){return l.call(g,d)?!0:l.call(h,d)?!1:u.test(d)?g[d]=!0:(h[d]=!0,!1)}function p(d,c,m,E){if(m!==null&&m.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return E?!1:m!==null?!m.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function y(d,c,m,E){if(c===null||typeof c>"u"||p(d,c,m,E))return!0;if(E)return!1;if(m!==null)switch(m.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function _(d,c,m,E,T,M,G){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=E,this.attributeNamespace=T,this.mustUseProperty=m,this.propertyName=d,this.type=c,this.sanitizeURL=M,this.removeEmptyString=G}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){x[d]=new _(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var c=d[0];x[c]=new _(c,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){x[d]=new _(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){x[d]=new _(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){x[d]=new _(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){x[d]=new _(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){x[d]=new _(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){x[d]=new _(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){x[d]=new _(d,5,!1,d.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function b(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var c=d.replace(v,b);x[c]=new _(c,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var c=d.replace(v,b);x[c]=new _(c,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var c=d.replace(v,b);x[c]=new _(c,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){x[d]=new _(d,1,!1,d.toLowerCase(),null,!1,!1)}),x.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){x[d]=new _(d,1,!1,d.toLowerCase(),null,!0,!0)});function S(d,c,m,E){var T=x.hasOwnProperty(c)?x[c]:null;(T!==null?T.type!==0:E||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(y(c,m,T,E)&&(m=null),E||T===null?f(c)&&(m===null?d.removeAttribute(c):d.setAttribute(c,""+m)):T.mustUseProperty?d[T.propertyName]=m===null?T.type===3?!1:"":m:(c=T.attributeName,E=T.attributeNamespace,m===null?d.removeAttribute(c):(T=T.type,m=T===3||T===4&&m===!0?"":""+m,E?d.setAttributeNS(E,c,m):d.setAttribute(c,m))))}var A=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),L=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),j=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),at=Symbol.for("react.suspense"),pt=Symbol.for("react.suspense_list"),K=Symbol.for("react.memo"),ut=Symbol.for("react.lazy"),ht=Symbol.for("react.offscreen"),nt=Symbol.iterator;function ot(d){return d===null||typeof d!="object"?null:(d=nt&&d[nt]||d["@@iterator"],typeof d=="function"?d:null)}var Nt=Object.assign,Q;function Et(d){if(Q===void 0)try{throw Error()}catch(m){var c=m.stack.trim().match(/\n( *(at )?)/);Q=c&&c[1]||""}return`
`+Q+d}var Xt=!1;function Ht(d,c){if(!d||Xt)return"";Xt=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Vt){var E=Vt}Reflect.construct(d,[],c)}else{try{c.call()}catch(Vt){E=Vt}d.call(c.prototype)}else{try{throw Error()}catch(Vt){E=Vt}d()}}catch(Vt){if(Vt&&E&&typeof Vt.stack=="string"){for(var T=Vt.stack.split(`
`),M=E.stack.split(`
`),G=T.length-1,rt=M.length-1;1<=G&&0<=rt&&T[G]!==M[rt];)rt--;for(;1<=G&&0<=rt;G--,rt--)if(T[G]!==M[rt]){if(G!==1||rt!==1)do if(G--,rt--,0>rt||T[G]!==M[rt]){var xt=`
`+T[G].replace(" at new "," at ");return d.displayName&&xt.includes("<anonymous>")&&(xt=xt.replace("<anonymous>",d.displayName)),xt}while(1<=G&&0<=rt);break}}}finally{Xt=!1,Error.prepareStackTrace=m}return(d=d?d.displayName||d.name:"")?Et(d):""}function Zt(d){switch(d.tag){case 5:return Et(d.type);case 16:return Et("Lazy");case 13:return Et("Suspense");case 19:return Et("SuspenseList");case 0:case 2:case 15:return d=Ht(d.type,!1),d;case 11:return d=Ht(d.type.render,!1),d;case 1:return d=Ht(d.type,!0),d;default:return""}}function ae(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case I:return"Fragment";case L:return"Portal";case O:return"Profiler";case F:return"StrictMode";case at:return"Suspense";case pt:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case j:return(d.displayName||"Context")+".Consumer";case V:return(d._context.displayName||"Context")+".Provider";case Z:var c=d.render;return d=d.displayName,d||(d=c.displayName||c.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case K:return c=d.displayName||null,c!==null?c:ae(d.type)||"Memo";case ut:c=d._payload,d=d._init;try{return ae(d(c))}catch{}}return null}function pe(d){var c=d.type;switch(d.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=c.render,d=d.displayName||d.name||"",c.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ae(c);case 8:return c===F?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function ne(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function te(d){var c=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function se(d){var c=te(d)?"checked":"value",m=Object.getOwnPropertyDescriptor(d.constructor.prototype,c),E=""+d[c];if(!d.hasOwnProperty(c)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var T=m.get,M=m.set;return Object.defineProperty(d,c,{configurable:!0,get:function(){return T.call(this)},set:function(G){E=""+G,M.call(this,G)}}),Object.defineProperty(d,c,{enumerable:m.enumerable}),{getValue:function(){return E},setValue:function(G){E=""+G},stopTracking:function(){d._valueTracker=null,delete d[c]}}}}function ce(d){d._valueTracker||(d._valueTracker=se(d))}function Ce(d){if(!d)return!1;var c=d._valueTracker;if(!c)return!0;var m=c.getValue(),E="";return d&&(E=te(d)?d.checked?"true":"false":d.value),d=E,d!==m?(c.setValue(d),!0):!1}function ve(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function Ne(d,c){var m=c.checked;return Nt({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??d._wrapperState.initialChecked})}function ge(d,c){var m=c.defaultValue==null?"":c.defaultValue,E=c.checked!=null?c.checked:c.defaultChecked;m=ne(c.value!=null?c.value:m),d._wrapperState={initialChecked:E,initialValue:m,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function ze(d,c){c=c.checked,c!=null&&S(d,"checked",c,!1)}function is(d,c){ze(d,c);var m=ne(c.value),E=c.type;if(m!=null)E==="number"?(m===0&&d.value===""||d.value!=m)&&(d.value=""+m):d.value!==""+m&&(d.value=""+m);else if(E==="submit"||E==="reset"){d.removeAttribute("value");return}c.hasOwnProperty("value")?De(d,c.type,m):c.hasOwnProperty("defaultValue")&&De(d,c.type,ne(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(d.defaultChecked=!!c.defaultChecked)}function Ge(d,c,m){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var E=c.type;if(!(E!=="submit"&&E!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+d._wrapperState.initialValue,m||c===d.value||(d.value=c),d.defaultValue=c}m=d.name,m!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,m!==""&&(d.name=m)}function De(d,c,m){(c!=="number"||ve(d.ownerDocument)!==d)&&(m==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+m&&(d.defaultValue=""+m))}var He=Array.isArray;function Je(d,c,m,E){if(d=d.options,c){c={};for(var T=0;T<m.length;T++)c["$"+m[T]]=!0;for(m=0;m<d.length;m++)T=c.hasOwnProperty("$"+d[m].value),d[m].selected!==T&&(d[m].selected=T),T&&E&&(d[m].defaultSelected=!0)}else{for(m=""+ne(m),c=null,T=0;T<d.length;T++){if(d[T].value===m){d[T].selected=!0,E&&(d[T].defaultSelected=!0);return}c!==null||d[T].disabled||(c=d[T])}c!==null&&(c.selected=!0)}}function ss(d,c){if(c.dangerouslySetInnerHTML!=null)throw Error(s(91));return Nt({},c,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function ts(d,c){var m=c.value;if(m==null){if(m=c.children,c=c.defaultValue,m!=null){if(c!=null)throw Error(s(92));if(He(m)){if(1<m.length)throw Error(s(93));m=m[0]}c=m}c==null&&(c=""),m=c}d._wrapperState={initialValue:ne(m)}}function hs(d,c){var m=ne(c.value),E=ne(c.defaultValue);m!=null&&(m=""+m,m!==d.value&&(d.value=m),c.defaultValue==null&&d.defaultValue!==m&&(d.defaultValue=m)),E!=null&&(d.defaultValue=""+E)}function Fe(d){var c=d.textContent;c===d._wrapperState.initialValue&&c!==""&&c!==null&&(d.value=c)}function Oe(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cs(d,c){return d==null||d==="http://www.w3.org/1999/xhtml"?Oe(c):d==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var Fs,Hs=(function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,m,E,T){MSApp.execUnsafeLocalFunction(function(){return d(c,m,E,T)})}:d})(function(d,c){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=c;else{for(Fs=Fs||document.createElement("div"),Fs.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Fs.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;c.firstChild;)d.appendChild(c.firstChild)}});function Ls(d,c){if(c){var m=d.firstChild;if(m&&m===d.lastChild&&m.nodeType===3){m.nodeValue=c;return}}d.textContent=c}var Sn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gn=["Webkit","ms","Moz","O"];Object.keys(Sn).forEach(function(d){gn.forEach(function(c){c=c+d.charAt(0).toUpperCase()+d.substring(1),Sn[c]=Sn[d]})});function ln(d,c,m){return c==null||typeof c=="boolean"||c===""?"":m||typeof c!="number"||c===0||Sn.hasOwnProperty(d)&&Sn[d]?(""+c).trim():c+"px"}function xs(d,c){d=d.style;for(var m in c)if(c.hasOwnProperty(m)){var E=m.indexOf("--")===0,T=ln(m,c[m],E);m==="float"&&(m="cssFloat"),E?d.setProperty(m,T):d[m]=T}}var Ps=Nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gt(d,c){if(c){if(Ps[d]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(s(137,d));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(s(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(s(61))}if(c.style!=null&&typeof c.style!="object")throw Error(s(62))}}function N(d,c){if(d.indexOf("-")===-1)return typeof c.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var P=null;function D(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var B=null,$=null,H=null;function X(d){if(d=Du(d)){if(typeof B!="function")throw Error(s(280));var c=d.stateNode;c&&(c=qh(c),B(d.stateNode,d.type,c))}}function lt(d){$?H?H.push(d):H=[d]:$=d}function dt(){if($){var d=$,c=H;if(H=$=null,X(d),c)for(d=0;d<c.length;d++)X(c[d])}}function ct(d,c){return d(c)}function mt(){}var yt=!1;function kt(d,c,m){if(yt)return d(c,m);yt=!0;try{return ct(d,c,m)}finally{yt=!1,($!==null||H!==null)&&(mt(),dt())}}function Tt(d,c){var m=d.stateNode;if(m===null)return null;var E=qh(m);if(E===null)return null;m=E[c];t:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(E=!E.disabled)||(d=d.type,E=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!E;break t;default:d=!1}if(d)return null;if(m&&typeof m!="function")throw Error(s(231,c,typeof m));return m}var At=!1;if(a)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){At=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch{At=!1}function he(d,c,m,E,T,M,G,rt,xt){var Vt=Array.prototype.slice.call(arguments,3);try{c.apply(m,Vt)}catch(de){this.onError(de)}}var xe=!1,be=null,ue=!1,_e=null,Te={onError:function(d){xe=!0,be=d}};function Ve(d,c,m,E,T,M,G,rt,xt){xe=!1,be=null,he.apply(Te,arguments)}function Ie(d,c,m,E,T,M,G,rt,xt){if(Ve.apply(this,arguments),xe){if(xe){var Vt=be;xe=!1,be=null}else throw Error(s(198));ue||(ue=!0,_e=Vt)}}function je(d){var c=d,m=d;if(d.alternate)for(;c.return;)c=c.return;else{d=c;do c=d,(c.flags&4098)!==0&&(m=c.return),d=c.return;while(d)}return c.tag===3?m:null}function Pe(d){if(d.tag===13){var c=d.memoizedState;if(c===null&&(d=d.alternate,d!==null&&(c=d.memoizedState)),c!==null)return c.dehydrated}return null}function Be(d){if(je(d)!==d)throw Error(s(188))}function Ue(d){var c=d.alternate;if(!c){if(c=je(d),c===null)throw Error(s(188));return c!==d?null:d}for(var m=d,E=c;;){var T=m.return;if(T===null)break;var M=T.alternate;if(M===null){if(E=T.return,E!==null){m=E;continue}break}if(T.child===M.child){for(M=T.child;M;){if(M===m)return Be(T),d;if(M===E)return Be(T),c;M=M.sibling}throw Error(s(188))}if(m.return!==E.return)m=T,E=M;else{for(var G=!1,rt=T.child;rt;){if(rt===m){G=!0,m=T,E=M;break}if(rt===E){G=!0,E=T,m=M;break}rt=rt.sibling}if(!G){for(rt=M.child;rt;){if(rt===m){G=!0,m=M,E=T;break}if(rt===E){G=!0,E=M,m=T;break}rt=rt.sibling}if(!G)throw Error(s(189))}}if(m.alternate!==E)throw Error(s(190))}if(m.tag!==3)throw Error(s(188));return m.stateNode.current===m?d:c}function es(d){return d=Ue(d),d!==null?os(d):null}function os(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var c=os(d);if(c!==null)return c;d=d.sibling}return null}var cs=e.unstable_scheduleCallback,Y=e.unstable_cancelCallback,et=e.unstable_shouldYield,J=e.unstable_requestPaint,tt=e.unstable_now,ft=e.unstable_getCurrentPriorityLevel,_t=e.unstable_ImmediatePriority,it=e.unstable_UserBlockingPriority,vt=e.unstable_NormalPriority,Ct=e.unstable_LowPriority,Ft=e.unstable_IdlePriority,Pt=null,Lt=null;function Yt(d){if(Lt&&typeof Lt.onCommitFiberRoot=="function")try{Lt.onCommitFiberRoot(Pt,d,void 0,(d.current.flags&128)===128)}catch{}}var $t=Math.clz32?Math.clz32:qt,Bt=Math.log,Gt=Math.LN2;function qt(d){return d>>>=0,d===0?32:31-(Bt(d)/Gt|0)|0}var Kt=64,ee=4194304;function oe(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function re(d,c){var m=d.pendingLanes;if(m===0)return 0;var E=0,T=d.suspendedLanes,M=d.pingedLanes,G=m&268435455;if(G!==0){var rt=G&~T;rt!==0?E=oe(rt):(M&=G,M!==0&&(E=oe(M)))}else G=m&~T,G!==0?E=oe(G):M!==0&&(E=oe(M));if(E===0)return 0;if(c!==0&&c!==E&&(c&T)===0&&(T=E&-E,M=c&-c,T>=M||T===16&&(M&4194240)!==0))return c;if((E&4)!==0&&(E|=m&16),c=d.entangledLanes,c!==0)for(d=d.entanglements,c&=E;0<c;)m=31-$t(c),T=1<<m,E|=d[m],c&=~T;return E}function C(d,c){switch(d){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function R(d,c){for(var m=d.suspendedLanes,E=d.pingedLanes,T=d.expirationTimes,M=d.pendingLanes;0<M;){var G=31-$t(M),rt=1<<G,xt=T[G];xt===-1?((rt&m)===0||(rt&E)!==0)&&(T[G]=C(rt,c)):xt<=c&&(d.expiredLanes|=rt),M&=~rt}}function U(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function W(){var d=Kt;return Kt<<=1,(Kt&4194240)===0&&(Kt=64),d}function St(d){for(var c=[],m=0;31>m;m++)c.push(d);return c}function bt(d,c,m){d.pendingLanes|=c,c!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,c=31-$t(c),d[c]=m}function It(d,c){var m=d.pendingLanes&~c;d.pendingLanes=c,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=c,d.mutableReadLanes&=c,d.entangledLanes&=c,c=d.entanglements;var E=d.eventTimes;for(d=d.expirationTimes;0<m;){var T=31-$t(m),M=1<<T;c[T]=0,E[T]=-1,d[T]=-1,m&=~M}}function Qt(d,c){var m=d.entangledLanes|=c;for(d=d.entanglements;m;){var E=31-$t(m),T=1<<E;T&c|d[E]&c&&(d[E]|=c),m&=~T}}var ie=0;function Ee(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var we,We,us,ms,ds,ks=!1,gs=[],Ns=null,fn=null,Ss=null,zs=new Map,yn=new Map,tn=[],Zs="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ds(d,c){switch(d){case"focusin":case"focusout":Ns=null;break;case"dragenter":case"dragleave":fn=null;break;case"mouseover":case"mouseout":Ss=null;break;case"pointerover":case"pointerout":zs.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":yn.delete(c.pointerId)}}function An(d,c,m,E,T,M){return d===null||d.nativeEvent!==M?(d={blockedOn:c,domEventName:m,eventSystemFlags:E,nativeEvent:M,targetContainers:[T]},c!==null&&(c=Du(c),c!==null&&We(c)),d):(d.eventSystemFlags|=E,c=d.targetContainers,T!==null&&c.indexOf(T)===-1&&c.push(T),d)}function Wi(d,c,m,E,T){switch(c){case"focusin":return Ns=An(Ns,d,c,m,E,T),!0;case"dragenter":return fn=An(fn,d,c,m,E,T),!0;case"mouseover":return Ss=An(Ss,d,c,m,E,T),!0;case"pointerover":var M=T.pointerId;return zs.set(M,An(zs.get(M)||null,d,c,m,E,T)),!0;case"gotpointercapture":return M=T.pointerId,yn.set(M,An(yn.get(M)||null,d,c,m,E,T)),!0}return!1}function kn(d){var c=da(d.target);if(c!==null){var m=je(c);if(m!==null){if(c=m.tag,c===13){if(c=Pe(m),c!==null){d.blockedOn=c,ds(d.priority,function(){us(m)});return}}else if(c===3&&m.stateNode.current.memoizedState.isDehydrated){d.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Xi(d){if(d.blockedOn!==null)return!1;for(var c=d.targetContainers;0<c.length;){var m=ia(d.domEventName,d.eventSystemFlags,c[0],d.nativeEvent);if(m===null){m=d.nativeEvent;var E=new m.constructor(m.type,m);P=E,m.target.dispatchEvent(E),P=null}else return c=Du(m),c!==null&&We(c),d.blockedOn=m,!1;c.shift()}return!0}function gr(d,c,m){Xi(d)&&m.delete(c)}function vs(){ks=!1,Ns!==null&&Xi(Ns)&&(Ns=null),fn!==null&&Xi(fn)&&(fn=null),Ss!==null&&Xi(Ss)&&(Ss=null),zs.forEach(gr),yn.forEach(gr)}function Zi(d,c){d.blockedOn===c&&(d.blockedOn=null,ks||(ks=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,vs)))}function fr(d){function c(T){return Zi(T,d)}if(0<gs.length){Zi(gs[0],d);for(var m=1;m<gs.length;m++){var E=gs[m];E.blockedOn===d&&(E.blockedOn=null)}}for(Ns!==null&&Zi(Ns,d),fn!==null&&Zi(fn,d),Ss!==null&&Zi(Ss,d),zs.forEach(c),yn.forEach(c),m=0;m<tn.length;m++)E=tn[m],E.blockedOn===d&&(E.blockedOn=null);for(;0<tn.length&&(m=tn[0],m.blockedOn===null);)kn(m),m.blockedOn===null&&tn.shift()}var Ii=A.ReactCurrentBatchConfig,bi=!0;function Qa(d,c,m,E){var T=ie,M=Ii.transition;Ii.transition=null;try{ie=1,Ja(d,c,m,E)}finally{ie=T,Ii.transition=M}}function Ir(d,c,m,E){var T=ie,M=Ii.transition;Ii.transition=null;try{ie=4,Ja(d,c,m,E)}finally{ie=T,Ii.transition=M}}function Ja(d,c,m,E){if(bi){var T=ia(d,c,m,E);if(T===null)Ap(d,c,E,go,m),Ds(d,E);else if(Wi(T,d,c,m,E))E.stopPropagation();else if(Ds(d,E),c&4&&-1<Zs.indexOf(d)){for(;T!==null;){var M=Du(T);if(M!==null&&we(M),M=ia(d,c,m,E),M===null&&Ap(d,c,E,go,m),M===T)break;T=M}T!==null&&E.stopPropagation()}else Ap(d,c,E,null,m)}}var go=null;function ia(d,c,m,E){if(go=null,d=D(E),d=da(d),d!==null)if(c=je(d),c===null)d=null;else if(m=c.tag,m===13){if(d=Pe(c),d!==null)return d;d=null}else if(m===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;d=null}else c!==d&&(d=null);return go=d,null}function bu(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ft()){case _t:return 1;case it:return 4;case vt:case Ct:return 16;case Ft:return 536870912;default:return 16}default:return 16}}var Ki=null,tl=null,el=null;function Ih(){if(el)return el;var d,c=tl,m=c.length,E,T="value"in Ki?Ki.value:Ki.textContent,M=T.length;for(d=0;d<m&&c[d]===T[d];d++);var G=m-d;for(E=1;E<=G&&c[m-E]===T[M-E];E++);return el=T.slice(d,1<E?1-E:void 0)}function Rr(d){var c=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&c===13&&(d=13)):d=c,d===10&&(d=13),32<=d||d===13?d:0}function ra(){return!0}function oa(){return!1}function Nn(d){function c(m,E,T,M,G){this._reactName=m,this._targetInst=T,this.type=E,this.nativeEvent=M,this.target=G,this.currentTarget=null;for(var rt in d)d.hasOwnProperty(rt)&&(m=d[rt],this[rt]=m?m(M):M[rt]);return this.isDefaultPrevented=(M.defaultPrevented!=null?M.defaultPrevented:M.returnValue===!1)?ra:oa,this.isPropagationStopped=oa,this}return Nt(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=ra)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=ra)},persist:function(){},isPersistent:ra}),c}var fo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fr=Nn(fo),aa=Nt({},fo,{view:0,detail:0}),Eu=Nn(aa),po,Pr,pr,la=Nt({},aa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ol,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==pr&&(pr&&d.type==="mousemove"?(po=d.screenX-pr.screenX,Pr=d.screenY-pr.screenY):Pr=po=0,pr=d),po)},movementY:function(d){return"movementY"in d?d.movementY:Pr}}),Su=Nn(la),Rh=Nt({},la,{dataTransfer:0}),Au=Nn(Rh),Kn=Nt({},aa,{relatedTarget:0}),sl=Nn(Kn),wu=Nt({},fo,{animationName:0,elapsedTime:0,pseudoElement:0}),fp=Nn(wu),Fh=Nt({},fo,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),nl=Nn(Fh),Ph=Nt({},fo,{data:0}),Tu=Nn(Ph),il={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Dh(d){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(d):(d=zh[d])?!!c[d]:!1}function ol(){return Dh}var Cu=Nt({},aa,{key:function(d){if(d.key){var c=il[d.key]||d.key;if(c!=="Unidentified")return c}return d.type==="keypress"?(d=Rr(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?rl[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ol,charCode:function(d){return d.type==="keypress"?Rr(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?Rr(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Oh=Nn(Cu),k=Nt({},la,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),z=Nn(k),q=Nt({},aa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ol}),st=Nn(q),Ot=Nt({},fo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rt=Nn(Ot),Jt=Nt({},la,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),me=Nn(Jt),Ye=[9,13,27,32],ns=a&&"CompositionEvent"in window,Xe=null;a&&"documentMode"in document&&(Xe=document.documentMode);var ws=a&&"TextEvent"in window&&!Xe,zn=a&&(!ns||Xe&&8<Xe&&11>=Xe),li=" ",ui=!1;function ua(d,c){switch(d){case"keyup":return Ye.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lu(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var mr=!1;function CM(d,c){switch(d){case"compositionend":return Lu(c);case"keypress":return c.which!==32?null:(ui=!0,li);case"textInput":return d=c.data,d===li&&ui?null:d;default:return null}}function LM(d,c){if(mr)return d==="compositionend"||!ns&&ua(d,c)?(d=Ih(),el=tl=Ki=null,mr=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return zn&&c.locale!=="ko"?null:c.data;default:return null}}var kM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function V0(d){var c=d&&d.nodeName&&d.nodeName.toLowerCase();return c==="input"?!!kM[d.type]:c==="textarea"}function j0(d,c,m,E){lt(E),c=jh(c,"onChange"),0<c.length&&(m=new Fr("onChange","change",null,m,E),d.push({event:m,listeners:c}))}var ku=null,Nu=null;function NM(d){av(d,0)}function Bh(d){var c=hl(d);if(Ce(c))return d}function MM(d,c){if(d==="change")return c}var H0=!1;if(a){var pp;if(a){var mp="oninput"in document;if(!mp){var $0=document.createElement("div");$0.setAttribute("oninput","return;"),mp=typeof $0.oninput=="function"}pp=mp}else pp=!1;H0=pp&&(!document.documentMode||9<document.documentMode)}function q0(){ku&&(ku.detachEvent("onpropertychange",Y0),Nu=ku=null)}function Y0(d){if(d.propertyName==="value"&&Bh(Nu)){var c=[];j0(c,Nu,d,D(d)),kt(NM,c)}}function IM(d,c,m){d==="focusin"?(q0(),ku=c,Nu=m,ku.attachEvent("onpropertychange",Y0)):d==="focusout"&&q0()}function RM(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return Bh(Nu)}function FM(d,c){if(d==="click")return Bh(c)}function PM(d,c){if(d==="input"||d==="change")return Bh(c)}function zM(d,c){return d===c&&(d!==0||1/d===1/c)||d!==d&&c!==c}var Qi=typeof Object.is=="function"?Object.is:zM;function Mu(d,c){if(Qi(d,c))return!0;if(typeof d!="object"||d===null||typeof c!="object"||c===null)return!1;var m=Object.keys(d),E=Object.keys(c);if(m.length!==E.length)return!1;for(E=0;E<m.length;E++){var T=m[E];if(!l.call(c,T)||!Qi(d[T],c[T]))return!1}return!0}function W0(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function X0(d,c){var m=W0(d);d=0;for(var E;m;){if(m.nodeType===3){if(E=d+m.textContent.length,d<=c&&E>=c)return{node:m,offset:c-d};d=E}t:{for(;m;){if(m.nextSibling){m=m.nextSibling;break t}m=m.parentNode}m=void 0}m=W0(m)}}function Z0(d,c){return d&&c?d===c?!0:d&&d.nodeType===3?!1:c&&c.nodeType===3?Z0(d,c.parentNode):"contains"in d?d.contains(c):d.compareDocumentPosition?!!(d.compareDocumentPosition(c)&16):!1:!1}function K0(){for(var d=window,c=ve();c instanceof d.HTMLIFrameElement;){try{var m=typeof c.contentWindow.location.href=="string"}catch{m=!1}if(m)d=c.contentWindow;else break;c=ve(d.document)}return c}function _p(d){var c=d&&d.nodeName&&d.nodeName.toLowerCase();return c&&(c==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||c==="textarea"||d.contentEditable==="true")}function DM(d){var c=K0(),m=d.focusedElem,E=d.selectionRange;if(c!==m&&m&&m.ownerDocument&&Z0(m.ownerDocument.documentElement,m)){if(E!==null&&_p(m)){if(c=E.start,d=E.end,d===void 0&&(d=c),"selectionStart"in m)m.selectionStart=c,m.selectionEnd=Math.min(d,m.value.length);else if(d=(c=m.ownerDocument||document)&&c.defaultView||window,d.getSelection){d=d.getSelection();var T=m.textContent.length,M=Math.min(E.start,T);E=E.end===void 0?M:Math.min(E.end,T),!d.extend&&M>E&&(T=E,E=M,M=T),T=X0(m,M);var G=X0(m,E);T&&G&&(d.rangeCount!==1||d.anchorNode!==T.node||d.anchorOffset!==T.offset||d.focusNode!==G.node||d.focusOffset!==G.offset)&&(c=c.createRange(),c.setStart(T.node,T.offset),d.removeAllRanges(),M>E?(d.addRange(c),d.extend(G.node,G.offset)):(c.setEnd(G.node,G.offset),d.addRange(c)))}}for(c=[],d=m;d=d.parentNode;)d.nodeType===1&&c.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<c.length;m++)d=c[m],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var OM=a&&"documentMode"in document&&11>=document.documentMode,al=null,yp=null,Iu=null,xp=!1;function Q0(d,c,m){var E=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;xp||al==null||al!==ve(E)||(E=al,"selectionStart"in E&&_p(E)?E={start:E.selectionStart,end:E.selectionEnd}:(E=(E.ownerDocument&&E.ownerDocument.defaultView||window).getSelection(),E={anchorNode:E.anchorNode,anchorOffset:E.anchorOffset,focusNode:E.focusNode,focusOffset:E.focusOffset}),Iu&&Mu(Iu,E)||(Iu=E,E=jh(yp,"onSelect"),0<E.length&&(c=new Fr("onSelect","select",null,c,m),d.push({event:c,listeners:E}),c.target=al)))}function Uh(d,c){var m={};return m[d.toLowerCase()]=c.toLowerCase(),m["Webkit"+d]="webkit"+c,m["Moz"+d]="moz"+c,m}var ll={animationend:Uh("Animation","AnimationEnd"),animationiteration:Uh("Animation","AnimationIteration"),animationstart:Uh("Animation","AnimationStart"),transitionend:Uh("Transition","TransitionEnd")},vp={},J0={};a&&(J0=document.createElement("div").style,"AnimationEvent"in window||(delete ll.animationend.animation,delete ll.animationiteration.animation,delete ll.animationstart.animation),"TransitionEvent"in window||delete ll.transitionend.transition);function Gh(d){if(vp[d])return vp[d];if(!ll[d])return d;var c=ll[d],m;for(m in c)if(c.hasOwnProperty(m)&&m in J0)return vp[d]=c[m];return d}var tv=Gh("animationend"),ev=Gh("animationiteration"),sv=Gh("animationstart"),nv=Gh("transitionend"),iv=new Map,rv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mo(d,c){iv.set(d,c),r(c,[d])}for(var bp=0;bp<rv.length;bp++){var Ep=rv[bp],BM=Ep.toLowerCase(),UM=Ep[0].toUpperCase()+Ep.slice(1);mo(BM,"on"+UM)}mo(tv,"onAnimationEnd"),mo(ev,"onAnimationIteration"),mo(sv,"onAnimationStart"),mo("dblclick","onDoubleClick"),mo("focusin","onFocus"),mo("focusout","onBlur"),mo(nv,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),r("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),r("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),r("onBeforeInput",["compositionend","keypress","textInput","paste"]),r("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ru="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GM=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ru));function ov(d,c,m){var E=d.type||"unknown-event";d.currentTarget=m,Ie(E,c,void 0,d),d.currentTarget=null}function av(d,c){c=(c&4)!==0;for(var m=0;m<d.length;m++){var E=d[m],T=E.event;E=E.listeners;t:{var M=void 0;if(c)for(var G=E.length-1;0<=G;G--){var rt=E[G],xt=rt.instance,Vt=rt.currentTarget;if(rt=rt.listener,xt!==M&&T.isPropagationStopped())break t;ov(T,rt,Vt),M=xt}else for(G=0;G<E.length;G++){if(rt=E[G],xt=rt.instance,Vt=rt.currentTarget,rt=rt.listener,xt!==M&&T.isPropagationStopped())break t;ov(T,rt,Vt),M=xt}}}if(ue)throw d=_e,ue=!1,_e=null,d}function Os(d,c){var m=c[Np];m===void 0&&(m=c[Np]=new Set);var E=d+"__bubble";m.has(E)||(lv(c,d,2,!1),m.add(E))}function Sp(d,c,m){var E=0;c&&(E|=4),lv(m,d,E,c)}var Vh="_reactListening"+Math.random().toString(36).slice(2);function Fu(d){if(!d[Vh]){d[Vh]=!0,n.forEach(function(m){m!=="selectionchange"&&(GM.has(m)||Sp(m,!1,d),Sp(m,!0,d))});var c=d.nodeType===9?d:d.ownerDocument;c===null||c[Vh]||(c[Vh]=!0,Sp("selectionchange",!1,c))}}function lv(d,c,m,E){switch(bu(c)){case 1:var T=Qa;break;case 4:T=Ir;break;default:T=Ja}m=T.bind(null,c,m,d),T=void 0,!At||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(T=!0),E?T!==void 0?d.addEventListener(c,m,{capture:!0,passive:T}):d.addEventListener(c,m,!0):T!==void 0?d.addEventListener(c,m,{passive:T}):d.addEventListener(c,m,!1)}function Ap(d,c,m,E,T){var M=E;if((c&1)===0&&(c&2)===0&&E!==null)t:for(;;){if(E===null)return;var G=E.tag;if(G===3||G===4){var rt=E.stateNode.containerInfo;if(rt===T||rt.nodeType===8&&rt.parentNode===T)break;if(G===4)for(G=E.return;G!==null;){var xt=G.tag;if((xt===3||xt===4)&&(xt=G.stateNode.containerInfo,xt===T||xt.nodeType===8&&xt.parentNode===T))return;G=G.return}for(;rt!==null;){if(G=da(rt),G===null)return;if(xt=G.tag,xt===5||xt===6){E=M=G;continue t}rt=rt.parentNode}}E=E.return}kt(function(){var Vt=M,de=D(m),fe=[];t:{var le=iv.get(d);if(le!==void 0){var Ae=Fr,ke=d;switch(d){case"keypress":if(Rr(m)===0)break t;case"keydown":case"keyup":Ae=Oh;break;case"focusin":ke="focus",Ae=sl;break;case"focusout":ke="blur",Ae=sl;break;case"beforeblur":case"afterblur":Ae=sl;break;case"click":if(m.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ae=Su;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ae=Au;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ae=st;break;case tv:case ev:case sv:Ae=fp;break;case nv:Ae=Rt;break;case"scroll":Ae=Eu;break;case"wheel":Ae=me;break;case"copy":case"cut":case"paste":Ae=nl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ae=z}var Me=(c&4)!==0,un=!Me&&d==="scroll",Mt=Me?le!==null?le+"Capture":null:le;Me=[];for(var wt=Vt,Dt;wt!==null;){Dt=wt;var ye=Dt.stateNode;if(Dt.tag===5&&ye!==null&&(Dt=ye,Mt!==null&&(ye=Tt(wt,Mt),ye!=null&&Me.push(Pu(wt,ye,Dt)))),un)break;wt=wt.return}0<Me.length&&(le=new Ae(le,ke,null,m,de),fe.push({event:le,listeners:Me}))}}if((c&7)===0){t:{if(le=d==="mouseover"||d==="pointerover",Ae=d==="mouseout"||d==="pointerout",le&&m!==P&&(ke=m.relatedTarget||m.fromElement)&&(da(ke)||ke[zr]))break t;if((Ae||le)&&(le=de.window===de?de:(le=de.ownerDocument)?le.defaultView||le.parentWindow:window,Ae?(ke=m.relatedTarget||m.toElement,Ae=Vt,ke=ke?da(ke):null,ke!==null&&(un=je(ke),ke!==un||ke.tag!==5&&ke.tag!==6)&&(ke=null)):(Ae=null,ke=Vt),Ae!==ke)){if(Me=Su,ye="onMouseLeave",Mt="onMouseEnter",wt="mouse",(d==="pointerout"||d==="pointerover")&&(Me=z,ye="onPointerLeave",Mt="onPointerEnter",wt="pointer"),un=Ae==null?le:hl(Ae),Dt=ke==null?le:hl(ke),le=new Me(ye,wt+"leave",Ae,m,de),le.target=un,le.relatedTarget=Dt,ye=null,da(de)===Vt&&(Me=new Me(Mt,wt+"enter",ke,m,de),Me.target=Dt,Me.relatedTarget=un,ye=Me),un=ye,Ae&&ke)e:{for(Me=Ae,Mt=ke,wt=0,Dt=Me;Dt;Dt=ul(Dt))wt++;for(Dt=0,ye=Mt;ye;ye=ul(ye))Dt++;for(;0<wt-Dt;)Me=ul(Me),wt--;for(;0<Dt-wt;)Mt=ul(Mt),Dt--;for(;wt--;){if(Me===Mt||Mt!==null&&Me===Mt.alternate)break e;Me=ul(Me),Mt=ul(Mt)}Me=null}else Me=null;Ae!==null&&uv(fe,le,Ae,Me,!1),ke!==null&&un!==null&&uv(fe,un,ke,Me,!0)}}t:{if(le=Vt?hl(Vt):window,Ae=le.nodeName&&le.nodeName.toLowerCase(),Ae==="select"||Ae==="input"&&le.type==="file")var Re=MM;else if(V0(le))if(H0)Re=PM;else{Re=RM;var $e=IM}else(Ae=le.nodeName)&&Ae.toLowerCase()==="input"&&(le.type==="checkbox"||le.type==="radio")&&(Re=FM);if(Re&&(Re=Re(d,Vt))){j0(fe,Re,m,de);break t}$e&&$e(d,le,Vt),d==="focusout"&&($e=le._wrapperState)&&$e.controlled&&le.type==="number"&&De(le,"number",le.value)}switch($e=Vt?hl(Vt):window,d){case"focusin":(V0($e)||$e.contentEditable==="true")&&(al=$e,yp=Vt,Iu=null);break;case"focusout":Iu=yp=al=null;break;case"mousedown":xp=!0;break;case"contextmenu":case"mouseup":case"dragend":xp=!1,Q0(fe,m,de);break;case"selectionchange":if(OM)break;case"keydown":case"keyup":Q0(fe,m,de)}var qe;if(ns)t:{switch(d){case"compositionstart":var Ze="onCompositionStart";break t;case"compositionend":Ze="onCompositionEnd";break t;case"compositionupdate":Ze="onCompositionUpdate";break t}Ze=void 0}else mr?ua(d,m)&&(Ze="onCompositionEnd"):d==="keydown"&&m.keyCode===229&&(Ze="onCompositionStart");Ze&&(zn&&m.locale!=="ko"&&(mr||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&mr&&(qe=Ih()):(Ki=de,tl="value"in Ki?Ki.value:Ki.textContent,mr=!0)),$e=jh(Vt,Ze),0<$e.length&&(Ze=new Tu(Ze,d,null,m,de),fe.push({event:Ze,listeners:$e}),qe?Ze.data=qe:(qe=Lu(m),qe!==null&&(Ze.data=qe)))),(qe=ws?CM(d,m):LM(d,m))&&(Vt=jh(Vt,"onBeforeInput"),0<Vt.length&&(de=new Tu("onBeforeInput","beforeinput",null,m,de),fe.push({event:de,listeners:Vt}),de.data=qe))}av(fe,c)})}function Pu(d,c,m){return{instance:d,listener:c,currentTarget:m}}function jh(d,c){for(var m=c+"Capture",E=[];d!==null;){var T=d,M=T.stateNode;T.tag===5&&M!==null&&(T=M,M=Tt(d,m),M!=null&&E.unshift(Pu(d,M,T)),M=Tt(d,c),M!=null&&E.push(Pu(d,M,T))),d=d.return}return E}function ul(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function uv(d,c,m,E,T){for(var M=c._reactName,G=[];m!==null&&m!==E;){var rt=m,xt=rt.alternate,Vt=rt.stateNode;if(xt!==null&&xt===E)break;rt.tag===5&&Vt!==null&&(rt=Vt,T?(xt=Tt(m,M),xt!=null&&G.unshift(Pu(m,xt,rt))):T||(xt=Tt(m,M),xt!=null&&G.push(Pu(m,xt,rt)))),m=m.return}G.length!==0&&d.push({event:c,listeners:G})}var VM=/\r\n?/g,jM=/\u0000|\uFFFD/g;function dv(d){return(typeof d=="string"?d:""+d).replace(VM,`
`).replace(jM,"")}function Hh(d,c,m){if(c=dv(c),dv(d)!==c&&m)throw Error(s(425))}function $h(){}var wp=null,Tp=null;function Cp(d,c){return d==="textarea"||d==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Lp=typeof setTimeout=="function"?setTimeout:void 0,HM=typeof clearTimeout=="function"?clearTimeout:void 0,hv=typeof Promise=="function"?Promise:void 0,$M=typeof queueMicrotask=="function"?queueMicrotask:typeof hv<"u"?function(d){return hv.resolve(null).then(d).catch(qM)}:Lp;function qM(d){setTimeout(function(){throw d})}function kp(d,c){var m=c,E=0;do{var T=m.nextSibling;if(d.removeChild(m),T&&T.nodeType===8)if(m=T.data,m==="/$"){if(E===0){d.removeChild(T),fr(c);return}E--}else m!=="$"&&m!=="$?"&&m!=="$!"||E++;m=T}while(m);fr(c)}function _o(d){for(;d!=null;d=d.nextSibling){var c=d.nodeType;if(c===1||c===3)break;if(c===8){if(c=d.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return d}function cv(d){d=d.previousSibling;for(var c=0;d;){if(d.nodeType===8){var m=d.data;if(m==="$"||m==="$!"||m==="$?"){if(c===0)return d;c--}else m==="/$"&&c++}d=d.previousSibling}return null}var dl=Math.random().toString(36).slice(2),_r="__reactFiber$"+dl,zu="__reactProps$"+dl,zr="__reactContainer$"+dl,Np="__reactEvents$"+dl,YM="__reactListeners$"+dl,WM="__reactHandles$"+dl;function da(d){var c=d[_r];if(c)return c;for(var m=d.parentNode;m;){if(c=m[zr]||m[_r]){if(m=c.alternate,c.child!==null||m!==null&&m.child!==null)for(d=cv(d);d!==null;){if(m=d[_r])return m;d=cv(d)}return c}d=m,m=d.parentNode}return null}function Du(d){return d=d[_r]||d[zr],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function hl(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(s(33))}function qh(d){return d[zu]||null}var Mp=[],cl=-1;function yo(d){return{current:d}}function Bs(d){0>cl||(d.current=Mp[cl],Mp[cl]=null,cl--)}function Ms(d,c){cl++,Mp[cl]=d.current,d.current=c}var xo={},Dn=yo(xo),di=yo(!1),ha=xo;function gl(d,c){var m=d.type.contextTypes;if(!m)return xo;var E=d.stateNode;if(E&&E.__reactInternalMemoizedUnmaskedChildContext===c)return E.__reactInternalMemoizedMaskedChildContext;var T={},M;for(M in m)T[M]=c[M];return E&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=c,d.__reactInternalMemoizedMaskedChildContext=T),T}function hi(d){return d=d.childContextTypes,d!=null}function Yh(){Bs(di),Bs(Dn)}function gv(d,c,m){if(Dn.current!==xo)throw Error(s(168));Ms(Dn,c),Ms(di,m)}function fv(d,c,m){var E=d.stateNode;if(c=c.childContextTypes,typeof E.getChildContext!="function")return m;E=E.getChildContext();for(var T in E)if(!(T in c))throw Error(s(108,pe(d)||"Unknown",T));return Nt({},m,E)}function Wh(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||xo,ha=Dn.current,Ms(Dn,d),Ms(di,di.current),!0}function pv(d,c,m){var E=d.stateNode;if(!E)throw Error(s(169));m?(d=fv(d,c,ha),E.__reactInternalMemoizedMergedChildContext=d,Bs(di),Bs(Dn),Ms(Dn,d)):Bs(di),Ms(di,m)}var Dr=null,Xh=!1,Ip=!1;function mv(d){Dr===null?Dr=[d]:Dr.push(d)}function XM(d){Xh=!0,mv(d)}function vo(){if(!Ip&&Dr!==null){Ip=!0;var d=0,c=ie;try{var m=Dr;for(ie=1;d<m.length;d++){var E=m[d];do E=E(!0);while(E!==null)}Dr=null,Xh=!1}catch(T){throw Dr!==null&&(Dr=Dr.slice(d+1)),cs(_t,vo),T}finally{ie=c,Ip=!1}}return null}var fl=[],pl=0,Zh=null,Kh=0,Ri=[],Fi=0,ca=null,Or=1,Br="";function ga(d,c){fl[pl++]=Kh,fl[pl++]=Zh,Zh=d,Kh=c}function _v(d,c,m){Ri[Fi++]=Or,Ri[Fi++]=Br,Ri[Fi++]=ca,ca=d;var E=Or;d=Br;var T=32-$t(E)-1;E&=~(1<<T),m+=1;var M=32-$t(c)+T;if(30<M){var G=T-T%5;M=(E&(1<<G)-1).toString(32),E>>=G,T-=G,Or=1<<32-$t(c)+T|m<<T|E,Br=M+d}else Or=1<<M|m<<T|E,Br=d}function Rp(d){d.return!==null&&(ga(d,1),_v(d,1,0))}function Fp(d){for(;d===Zh;)Zh=fl[--pl],fl[pl]=null,Kh=fl[--pl],fl[pl]=null;for(;d===ca;)ca=Ri[--Fi],Ri[Fi]=null,Br=Ri[--Fi],Ri[Fi]=null,Or=Ri[--Fi],Ri[Fi]=null}var Ei=null,Si=null,$s=!1,Ji=null;function yv(d,c){var m=Oi(5,null,null,0);m.elementType="DELETED",m.stateNode=c,m.return=d,c=d.deletions,c===null?(d.deletions=[m],d.flags|=16):c.push(m)}function xv(d,c){switch(d.tag){case 5:var m=d.type;return c=c.nodeType!==1||m.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(d.stateNode=c,Ei=d,Si=_o(c.firstChild),!0):!1;case 6:return c=d.pendingProps===""||c.nodeType!==3?null:c,c!==null?(d.stateNode=c,Ei=d,Si=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(m=ca!==null?{id:Or,overflow:Br}:null,d.memoizedState={dehydrated:c,treeContext:m,retryLane:1073741824},m=Oi(18,null,null,0),m.stateNode=c,m.return=d,d.child=m,Ei=d,Si=null,!0):!1;default:return!1}}function Pp(d){return(d.mode&1)!==0&&(d.flags&128)===0}function zp(d){if($s){var c=Si;if(c){var m=c;if(!xv(d,c)){if(Pp(d))throw Error(s(418));c=_o(m.nextSibling);var E=Ei;c&&xv(d,c)?yv(E,m):(d.flags=d.flags&-4097|2,$s=!1,Ei=d)}}else{if(Pp(d))throw Error(s(418));d.flags=d.flags&-4097|2,$s=!1,Ei=d}}}function vv(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;Ei=d}function Qh(d){if(d!==Ei)return!1;if(!$s)return vv(d),$s=!0,!1;var c;if((c=d.tag!==3)&&!(c=d.tag!==5)&&(c=d.type,c=c!=="head"&&c!=="body"&&!Cp(d.type,d.memoizedProps)),c&&(c=Si)){if(Pp(d))throw bv(),Error(s(418));for(;c;)yv(d,c),c=_o(c.nextSibling)}if(vv(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));t:{for(d=d.nextSibling,c=0;d;){if(d.nodeType===8){var m=d.data;if(m==="/$"){if(c===0){Si=_o(d.nextSibling);break t}c--}else m!=="$"&&m!=="$!"&&m!=="$?"||c++}d=d.nextSibling}Si=null}}else Si=Ei?_o(d.stateNode.nextSibling):null;return!0}function bv(){for(var d=Si;d;)d=_o(d.nextSibling)}function ml(){Si=Ei=null,$s=!1}function Dp(d){Ji===null?Ji=[d]:Ji.push(d)}var ZM=A.ReactCurrentBatchConfig;function Ou(d,c,m){if(d=m.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(s(309));var E=m.stateNode}if(!E)throw Error(s(147,d));var T=E,M=""+d;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===M?c.ref:(c=function(G){var rt=T.refs;G===null?delete rt[M]:rt[M]=G},c._stringRef=M,c)}if(typeof d!="string")throw Error(s(284));if(!m._owner)throw Error(s(290,d))}return d}function Jh(d,c){throw d=Object.prototype.toString.call(c),Error(s(31,d==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":d))}function Ev(d){var c=d._init;return c(d._payload)}function Sv(d){function c(Mt,wt){if(d){var Dt=Mt.deletions;Dt===null?(Mt.deletions=[wt],Mt.flags|=16):Dt.push(wt)}}function m(Mt,wt){if(!d)return null;for(;wt!==null;)c(Mt,wt),wt=wt.sibling;return null}function E(Mt,wt){for(Mt=new Map;wt!==null;)wt.key!==null?Mt.set(wt.key,wt):Mt.set(wt.index,wt),wt=wt.sibling;return Mt}function T(Mt,wt){return Mt=Lo(Mt,wt),Mt.index=0,Mt.sibling=null,Mt}function M(Mt,wt,Dt){return Mt.index=Dt,d?(Dt=Mt.alternate,Dt!==null?(Dt=Dt.index,Dt<wt?(Mt.flags|=2,wt):Dt):(Mt.flags|=2,wt)):(Mt.flags|=1048576,wt)}function G(Mt){return d&&Mt.alternate===null&&(Mt.flags|=2),Mt}function rt(Mt,wt,Dt,ye){return wt===null||wt.tag!==6?(wt=Lm(Dt,Mt.mode,ye),wt.return=Mt,wt):(wt=T(wt,Dt),wt.return=Mt,wt)}function xt(Mt,wt,Dt,ye){var Re=Dt.type;return Re===I?de(Mt,wt,Dt.props.children,ye,Dt.key):wt!==null&&(wt.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===ut&&Ev(Re)===wt.type)?(ye=T(wt,Dt.props),ye.ref=Ou(Mt,wt,Dt),ye.return=Mt,ye):(ye=Sc(Dt.type,Dt.key,Dt.props,null,Mt.mode,ye),ye.ref=Ou(Mt,wt,Dt),ye.return=Mt,ye)}function Vt(Mt,wt,Dt,ye){return wt===null||wt.tag!==4||wt.stateNode.containerInfo!==Dt.containerInfo||wt.stateNode.implementation!==Dt.implementation?(wt=km(Dt,Mt.mode,ye),wt.return=Mt,wt):(wt=T(wt,Dt.children||[]),wt.return=Mt,wt)}function de(Mt,wt,Dt,ye,Re){return wt===null||wt.tag!==7?(wt=ba(Dt,Mt.mode,ye,Re),wt.return=Mt,wt):(wt=T(wt,Dt),wt.return=Mt,wt)}function fe(Mt,wt,Dt){if(typeof wt=="string"&&wt!==""||typeof wt=="number")return wt=Lm(""+wt,Mt.mode,Dt),wt.return=Mt,wt;if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case w:return Dt=Sc(wt.type,wt.key,wt.props,null,Mt.mode,Dt),Dt.ref=Ou(Mt,null,wt),Dt.return=Mt,Dt;case L:return wt=km(wt,Mt.mode,Dt),wt.return=Mt,wt;case ut:var ye=wt._init;return fe(Mt,ye(wt._payload),Dt)}if(He(wt)||ot(wt))return wt=ba(wt,Mt.mode,Dt,null),wt.return=Mt,wt;Jh(Mt,wt)}return null}function le(Mt,wt,Dt,ye){var Re=wt!==null?wt.key:null;if(typeof Dt=="string"&&Dt!==""||typeof Dt=="number")return Re!==null?null:rt(Mt,wt,""+Dt,ye);if(typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case w:return Dt.key===Re?xt(Mt,wt,Dt,ye):null;case L:return Dt.key===Re?Vt(Mt,wt,Dt,ye):null;case ut:return Re=Dt._init,le(Mt,wt,Re(Dt._payload),ye)}if(He(Dt)||ot(Dt))return Re!==null?null:de(Mt,wt,Dt,ye,null);Jh(Mt,Dt)}return null}function Ae(Mt,wt,Dt,ye,Re){if(typeof ye=="string"&&ye!==""||typeof ye=="number")return Mt=Mt.get(Dt)||null,rt(wt,Mt,""+ye,Re);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case w:return Mt=Mt.get(ye.key===null?Dt:ye.key)||null,xt(wt,Mt,ye,Re);case L:return Mt=Mt.get(ye.key===null?Dt:ye.key)||null,Vt(wt,Mt,ye,Re);case ut:var $e=ye._init;return Ae(Mt,wt,Dt,$e(ye._payload),Re)}if(He(ye)||ot(ye))return Mt=Mt.get(Dt)||null,de(wt,Mt,ye,Re,null);Jh(wt,ye)}return null}function ke(Mt,wt,Dt,ye){for(var Re=null,$e=null,qe=wt,Ze=wt=0,Cn=null;qe!==null&&Ze<Dt.length;Ze++){qe.index>Ze?(Cn=qe,qe=null):Cn=qe.sibling;var _s=le(Mt,qe,Dt[Ze],ye);if(_s===null){qe===null&&(qe=Cn);break}d&&qe&&_s.alternate===null&&c(Mt,qe),wt=M(_s,wt,Ze),$e===null?Re=_s:$e.sibling=_s,$e=_s,qe=Cn}if(Ze===Dt.length)return m(Mt,qe),$s&&ga(Mt,Ze),Re;if(qe===null){for(;Ze<Dt.length;Ze++)qe=fe(Mt,Dt[Ze],ye),qe!==null&&(wt=M(qe,wt,Ze),$e===null?Re=qe:$e.sibling=qe,$e=qe);return $s&&ga(Mt,Ze),Re}for(qe=E(Mt,qe);Ze<Dt.length;Ze++)Cn=Ae(qe,Mt,Ze,Dt[Ze],ye),Cn!==null&&(d&&Cn.alternate!==null&&qe.delete(Cn.key===null?Ze:Cn.key),wt=M(Cn,wt,Ze),$e===null?Re=Cn:$e.sibling=Cn,$e=Cn);return d&&qe.forEach(function(ko){return c(Mt,ko)}),$s&&ga(Mt,Ze),Re}function Me(Mt,wt,Dt,ye){var Re=ot(Dt);if(typeof Re!="function")throw Error(s(150));if(Dt=Re.call(Dt),Dt==null)throw Error(s(151));for(var $e=Re=null,qe=wt,Ze=wt=0,Cn=null,_s=Dt.next();qe!==null&&!_s.done;Ze++,_s=Dt.next()){qe.index>Ze?(Cn=qe,qe=null):Cn=qe.sibling;var ko=le(Mt,qe,_s.value,ye);if(ko===null){qe===null&&(qe=Cn);break}d&&qe&&ko.alternate===null&&c(Mt,qe),wt=M(ko,wt,Ze),$e===null?Re=ko:$e.sibling=ko,$e=ko,qe=Cn}if(_s.done)return m(Mt,qe),$s&&ga(Mt,Ze),Re;if(qe===null){for(;!_s.done;Ze++,_s=Dt.next())_s=fe(Mt,_s.value,ye),_s!==null&&(wt=M(_s,wt,Ze),$e===null?Re=_s:$e.sibling=_s,$e=_s);return $s&&ga(Mt,Ze),Re}for(qe=E(Mt,qe);!_s.done;Ze++,_s=Dt.next())_s=Ae(qe,Mt,Ze,_s.value,ye),_s!==null&&(d&&_s.alternate!==null&&qe.delete(_s.key===null?Ze:_s.key),wt=M(_s,wt,Ze),$e===null?Re=_s:$e.sibling=_s,$e=_s);return d&&qe.forEach(function(kI){return c(Mt,kI)}),$s&&ga(Mt,Ze),Re}function un(Mt,wt,Dt,ye){if(typeof Dt=="object"&&Dt!==null&&Dt.type===I&&Dt.key===null&&(Dt=Dt.props.children),typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case w:t:{for(var Re=Dt.key,$e=wt;$e!==null;){if($e.key===Re){if(Re=Dt.type,Re===I){if($e.tag===7){m(Mt,$e.sibling),wt=T($e,Dt.props.children),wt.return=Mt,Mt=wt;break t}}else if($e.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===ut&&Ev(Re)===$e.type){m(Mt,$e.sibling),wt=T($e,Dt.props),wt.ref=Ou(Mt,$e,Dt),wt.return=Mt,Mt=wt;break t}m(Mt,$e);break}else c(Mt,$e);$e=$e.sibling}Dt.type===I?(wt=ba(Dt.props.children,Mt.mode,ye,Dt.key),wt.return=Mt,Mt=wt):(ye=Sc(Dt.type,Dt.key,Dt.props,null,Mt.mode,ye),ye.ref=Ou(Mt,wt,Dt),ye.return=Mt,Mt=ye)}return G(Mt);case L:t:{for($e=Dt.key;wt!==null;){if(wt.key===$e)if(wt.tag===4&&wt.stateNode.containerInfo===Dt.containerInfo&&wt.stateNode.implementation===Dt.implementation){m(Mt,wt.sibling),wt=T(wt,Dt.children||[]),wt.return=Mt,Mt=wt;break t}else{m(Mt,wt);break}else c(Mt,wt);wt=wt.sibling}wt=km(Dt,Mt.mode,ye),wt.return=Mt,Mt=wt}return G(Mt);case ut:return $e=Dt._init,un(Mt,wt,$e(Dt._payload),ye)}if(He(Dt))return ke(Mt,wt,Dt,ye);if(ot(Dt))return Me(Mt,wt,Dt,ye);Jh(Mt,Dt)}return typeof Dt=="string"&&Dt!==""||typeof Dt=="number"?(Dt=""+Dt,wt!==null&&wt.tag===6?(m(Mt,wt.sibling),wt=T(wt,Dt),wt.return=Mt,Mt=wt):(m(Mt,wt),wt=Lm(Dt,Mt.mode,ye),wt.return=Mt,Mt=wt),G(Mt)):m(Mt,wt)}return un}var _l=Sv(!0),Av=Sv(!1),tc=yo(null),ec=null,yl=null,Op=null;function Bp(){Op=yl=ec=null}function Up(d){var c=tc.current;Bs(tc),d._currentValue=c}function Gp(d,c,m){for(;d!==null;){var E=d.alternate;if((d.childLanes&c)!==c?(d.childLanes|=c,E!==null&&(E.childLanes|=c)):E!==null&&(E.childLanes&c)!==c&&(E.childLanes|=c),d===m)break;d=d.return}}function xl(d,c){ec=d,Op=yl=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&c)!==0&&(ci=!0),d.firstContext=null)}function Pi(d){var c=d._currentValue;if(Op!==d)if(d={context:d,memoizedValue:c,next:null},yl===null){if(ec===null)throw Error(s(308));yl=d,ec.dependencies={lanes:0,firstContext:d}}else yl=yl.next=d;return c}var fa=null;function Vp(d){fa===null?fa=[d]:fa.push(d)}function wv(d,c,m,E){var T=c.interleaved;return T===null?(m.next=m,Vp(c)):(m.next=T.next,T.next=m),c.interleaved=m,Ur(d,E)}function Ur(d,c){d.lanes|=c;var m=d.alternate;for(m!==null&&(m.lanes|=c),m=d,d=d.return;d!==null;)d.childLanes|=c,m=d.alternate,m!==null&&(m.childLanes|=c),m=d,d=d.return;return m.tag===3?m.stateNode:null}var bo=!1;function jp(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Tv(d,c){d=d.updateQueue,c.updateQueue===d&&(c.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function Gr(d,c){return{eventTime:d,lane:c,tag:0,payload:null,callback:null,next:null}}function Eo(d,c,m){var E=d.updateQueue;if(E===null)return null;if(E=E.shared,(fs&2)!==0){var T=E.pending;return T===null?c.next=c:(c.next=T.next,T.next=c),E.pending=c,Ur(d,m)}return T=E.interleaved,T===null?(c.next=c,Vp(E)):(c.next=T.next,T.next=c),E.interleaved=c,Ur(d,m)}function sc(d,c,m){if(c=c.updateQueue,c!==null&&(c=c.shared,(m&4194240)!==0)){var E=c.lanes;E&=d.pendingLanes,m|=E,c.lanes=m,Qt(d,m)}}function Cv(d,c){var m=d.updateQueue,E=d.alternate;if(E!==null&&(E=E.updateQueue,m===E)){var T=null,M=null;if(m=m.firstBaseUpdate,m!==null){do{var G={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};M===null?T=M=G:M=M.next=G,m=m.next}while(m!==null);M===null?T=M=c:M=M.next=c}else T=M=c;m={baseState:E.baseState,firstBaseUpdate:T,lastBaseUpdate:M,shared:E.shared,effects:E.effects},d.updateQueue=m;return}d=m.lastBaseUpdate,d===null?m.firstBaseUpdate=c:d.next=c,m.lastBaseUpdate=c}function nc(d,c,m,E){var T=d.updateQueue;bo=!1;var M=T.firstBaseUpdate,G=T.lastBaseUpdate,rt=T.shared.pending;if(rt!==null){T.shared.pending=null;var xt=rt,Vt=xt.next;xt.next=null,G===null?M=Vt:G.next=Vt,G=xt;var de=d.alternate;de!==null&&(de=de.updateQueue,rt=de.lastBaseUpdate,rt!==G&&(rt===null?de.firstBaseUpdate=Vt:rt.next=Vt,de.lastBaseUpdate=xt))}if(M!==null){var fe=T.baseState;G=0,de=Vt=xt=null,rt=M;do{var le=rt.lane,Ae=rt.eventTime;if((E&le)===le){de!==null&&(de=de.next={eventTime:Ae,lane:0,tag:rt.tag,payload:rt.payload,callback:rt.callback,next:null});t:{var ke=d,Me=rt;switch(le=c,Ae=m,Me.tag){case 1:if(ke=Me.payload,typeof ke=="function"){fe=ke.call(Ae,fe,le);break t}fe=ke;break t;case 3:ke.flags=ke.flags&-65537|128;case 0:if(ke=Me.payload,le=typeof ke=="function"?ke.call(Ae,fe,le):ke,le==null)break t;fe=Nt({},fe,le);break t;case 2:bo=!0}}rt.callback!==null&&rt.lane!==0&&(d.flags|=64,le=T.effects,le===null?T.effects=[rt]:le.push(rt))}else Ae={eventTime:Ae,lane:le,tag:rt.tag,payload:rt.payload,callback:rt.callback,next:null},de===null?(Vt=de=Ae,xt=fe):de=de.next=Ae,G|=le;if(rt=rt.next,rt===null){if(rt=T.shared.pending,rt===null)break;le=rt,rt=le.next,le.next=null,T.lastBaseUpdate=le,T.shared.pending=null}}while(!0);if(de===null&&(xt=fe),T.baseState=xt,T.firstBaseUpdate=Vt,T.lastBaseUpdate=de,c=T.shared.interleaved,c!==null){T=c;do G|=T.lane,T=T.next;while(T!==c)}else M===null&&(T.shared.lanes=0);_a|=G,d.lanes=G,d.memoizedState=fe}}function Lv(d,c,m){if(d=c.effects,c.effects=null,d!==null)for(c=0;c<d.length;c++){var E=d[c],T=E.callback;if(T!==null){if(E.callback=null,E=m,typeof T!="function")throw Error(s(191,T));T.call(E)}}}var Bu={},yr=yo(Bu),Uu=yo(Bu),Gu=yo(Bu);function pa(d){if(d===Bu)throw Error(s(174));return d}function Hp(d,c){switch(Ms(Gu,c),Ms(Uu,d),Ms(yr,Bu),d=c.nodeType,d){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Cs(null,"");break;default:d=d===8?c.parentNode:c,c=d.namespaceURI||null,d=d.tagName,c=Cs(c,d)}Bs(yr),Ms(yr,c)}function vl(){Bs(yr),Bs(Uu),Bs(Gu)}function kv(d){pa(Gu.current);var c=pa(yr.current),m=Cs(c,d.type);c!==m&&(Ms(Uu,d),Ms(yr,m))}function $p(d){Uu.current===d&&(Bs(yr),Bs(Uu))}var Ks=yo(0);function ic(d){for(var c=d;c!==null;){if(c.tag===13){var m=c.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===d)break;for(;c.sibling===null;){if(c.return===null||c.return===d)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var qp=[];function Yp(){for(var d=0;d<qp.length;d++)qp[d]._workInProgressVersionPrimary=null;qp.length=0}var rc=A.ReactCurrentDispatcher,Wp=A.ReactCurrentBatchConfig,ma=0,Qs=null,xn=null,wn=null,oc=!1,Vu=!1,ju=0,KM=0;function On(){throw Error(s(321))}function Xp(d,c){if(c===null)return!1;for(var m=0;m<c.length&&m<d.length;m++)if(!Qi(d[m],c[m]))return!1;return!0}function Zp(d,c,m,E,T,M){if(ma=M,Qs=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,rc.current=d===null||d.memoizedState===null?eI:sI,d=m(E,T),Vu){M=0;do{if(Vu=!1,ju=0,25<=M)throw Error(s(301));M+=1,wn=xn=null,c.updateQueue=null,rc.current=nI,d=m(E,T)}while(Vu)}if(rc.current=uc,c=xn!==null&&xn.next!==null,ma=0,wn=xn=Qs=null,oc=!1,c)throw Error(s(300));return d}function Kp(){var d=ju!==0;return ju=0,d}function xr(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wn===null?Qs.memoizedState=wn=d:wn=wn.next=d,wn}function zi(){if(xn===null){var d=Qs.alternate;d=d!==null?d.memoizedState:null}else d=xn.next;var c=wn===null?Qs.memoizedState:wn.next;if(c!==null)wn=c,xn=d;else{if(d===null)throw Error(s(310));xn=d,d={memoizedState:xn.memoizedState,baseState:xn.baseState,baseQueue:xn.baseQueue,queue:xn.queue,next:null},wn===null?Qs.memoizedState=wn=d:wn=wn.next=d}return wn}function Hu(d,c){return typeof c=="function"?c(d):c}function Qp(d){var c=zi(),m=c.queue;if(m===null)throw Error(s(311));m.lastRenderedReducer=d;var E=xn,T=E.baseQueue,M=m.pending;if(M!==null){if(T!==null){var G=T.next;T.next=M.next,M.next=G}E.baseQueue=T=M,m.pending=null}if(T!==null){M=T.next,E=E.baseState;var rt=G=null,xt=null,Vt=M;do{var de=Vt.lane;if((ma&de)===de)xt!==null&&(xt=xt.next={lane:0,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null}),E=Vt.hasEagerState?Vt.eagerState:d(E,Vt.action);else{var fe={lane:de,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null};xt===null?(rt=xt=fe,G=E):xt=xt.next=fe,Qs.lanes|=de,_a|=de}Vt=Vt.next}while(Vt!==null&&Vt!==M);xt===null?G=E:xt.next=rt,Qi(E,c.memoizedState)||(ci=!0),c.memoizedState=E,c.baseState=G,c.baseQueue=xt,m.lastRenderedState=E}if(d=m.interleaved,d!==null){T=d;do M=T.lane,Qs.lanes|=M,_a|=M,T=T.next;while(T!==d)}else T===null&&(m.lanes=0);return[c.memoizedState,m.dispatch]}function Jp(d){var c=zi(),m=c.queue;if(m===null)throw Error(s(311));m.lastRenderedReducer=d;var E=m.dispatch,T=m.pending,M=c.memoizedState;if(T!==null){m.pending=null;var G=T=T.next;do M=d(M,G.action),G=G.next;while(G!==T);Qi(M,c.memoizedState)||(ci=!0),c.memoizedState=M,c.baseQueue===null&&(c.baseState=M),m.lastRenderedState=M}return[M,E]}function Nv(){}function Mv(d,c){var m=Qs,E=zi(),T=c(),M=!Qi(E.memoizedState,T);if(M&&(E.memoizedState=T,ci=!0),E=E.queue,tm(Fv.bind(null,m,E,d),[d]),E.getSnapshot!==c||M||wn!==null&&wn.memoizedState.tag&1){if(m.flags|=2048,$u(9,Rv.bind(null,m,E,T,c),void 0,null),Tn===null)throw Error(s(349));(ma&30)!==0||Iv(m,c,T)}return T}function Iv(d,c,m){d.flags|=16384,d={getSnapshot:c,value:m},c=Qs.updateQueue,c===null?(c={lastEffect:null,stores:null},Qs.updateQueue=c,c.stores=[d]):(m=c.stores,m===null?c.stores=[d]:m.push(d))}function Rv(d,c,m,E){c.value=m,c.getSnapshot=E,Pv(c)&&zv(d)}function Fv(d,c,m){return m(function(){Pv(c)&&zv(d)})}function Pv(d){var c=d.getSnapshot;d=d.value;try{var m=c();return!Qi(d,m)}catch{return!0}}function zv(d){var c=Ur(d,1);c!==null&&nr(c,d,1,-1)}function Dv(d){var c=xr();return typeof d=="function"&&(d=d()),c.memoizedState=c.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hu,lastRenderedState:d},c.queue=d,d=d.dispatch=tI.bind(null,Qs,d),[c.memoizedState,d]}function $u(d,c,m,E){return d={tag:d,create:c,destroy:m,deps:E,next:null},c=Qs.updateQueue,c===null?(c={lastEffect:null,stores:null},Qs.updateQueue=c,c.lastEffect=d.next=d):(m=c.lastEffect,m===null?c.lastEffect=d.next=d:(E=m.next,m.next=d,d.next=E,c.lastEffect=d)),d}function Ov(){return zi().memoizedState}function ac(d,c,m,E){var T=xr();Qs.flags|=d,T.memoizedState=$u(1|c,m,void 0,E===void 0?null:E)}function lc(d,c,m,E){var T=zi();E=E===void 0?null:E;var M=void 0;if(xn!==null){var G=xn.memoizedState;if(M=G.destroy,E!==null&&Xp(E,G.deps)){T.memoizedState=$u(c,m,M,E);return}}Qs.flags|=d,T.memoizedState=$u(1|c,m,M,E)}function Bv(d,c){return ac(8390656,8,d,c)}function tm(d,c){return lc(2048,8,d,c)}function Uv(d,c){return lc(4,2,d,c)}function Gv(d,c){return lc(4,4,d,c)}function Vv(d,c){if(typeof c=="function")return d=d(),c(d),function(){c(null)};if(c!=null)return d=d(),c.current=d,function(){c.current=null}}function jv(d,c,m){return m=m!=null?m.concat([d]):null,lc(4,4,Vv.bind(null,c,d),m)}function em(){}function Hv(d,c){var m=zi();c=c===void 0?null:c;var E=m.memoizedState;return E!==null&&c!==null&&Xp(c,E[1])?E[0]:(m.memoizedState=[d,c],d)}function $v(d,c){var m=zi();c=c===void 0?null:c;var E=m.memoizedState;return E!==null&&c!==null&&Xp(c,E[1])?E[0]:(d=d(),m.memoizedState=[d,c],d)}function qv(d,c,m){return(ma&21)===0?(d.baseState&&(d.baseState=!1,ci=!0),d.memoizedState=m):(Qi(m,c)||(m=W(),Qs.lanes|=m,_a|=m,d.baseState=!0),c)}function QM(d,c){var m=ie;ie=m!==0&&4>m?m:4,d(!0);var E=Wp.transition;Wp.transition={};try{d(!1),c()}finally{ie=m,Wp.transition=E}}function Yv(){return zi().memoizedState}function JM(d,c,m){var E=To(d);if(m={lane:E,action:m,hasEagerState:!1,eagerState:null,next:null},Wv(d))Xv(c,m);else if(m=wv(d,c,m,E),m!==null){var T=Jn();nr(m,d,E,T),Zv(m,c,E)}}function tI(d,c,m){var E=To(d),T={lane:E,action:m,hasEagerState:!1,eagerState:null,next:null};if(Wv(d))Xv(c,T);else{var M=d.alternate;if(d.lanes===0&&(M===null||M.lanes===0)&&(M=c.lastRenderedReducer,M!==null))try{var G=c.lastRenderedState,rt=M(G,m);if(T.hasEagerState=!0,T.eagerState=rt,Qi(rt,G)){var xt=c.interleaved;xt===null?(T.next=T,Vp(c)):(T.next=xt.next,xt.next=T),c.interleaved=T;return}}catch{}finally{}m=wv(d,c,T,E),m!==null&&(T=Jn(),nr(m,d,E,T),Zv(m,c,E))}}function Wv(d){var c=d.alternate;return d===Qs||c!==null&&c===Qs}function Xv(d,c){Vu=oc=!0;var m=d.pending;m===null?c.next=c:(c.next=m.next,m.next=c),d.pending=c}function Zv(d,c,m){if((m&4194240)!==0){var E=c.lanes;E&=d.pendingLanes,m|=E,c.lanes=m,Qt(d,m)}}var uc={readContext:Pi,useCallback:On,useContext:On,useEffect:On,useImperativeHandle:On,useInsertionEffect:On,useLayoutEffect:On,useMemo:On,useReducer:On,useRef:On,useState:On,useDebugValue:On,useDeferredValue:On,useTransition:On,useMutableSource:On,useSyncExternalStore:On,useId:On,unstable_isNewReconciler:!1},eI={readContext:Pi,useCallback:function(d,c){return xr().memoizedState=[d,c===void 0?null:c],d},useContext:Pi,useEffect:Bv,useImperativeHandle:function(d,c,m){return m=m!=null?m.concat([d]):null,ac(4194308,4,Vv.bind(null,c,d),m)},useLayoutEffect:function(d,c){return ac(4194308,4,d,c)},useInsertionEffect:function(d,c){return ac(4,2,d,c)},useMemo:function(d,c){var m=xr();return c=c===void 0?null:c,d=d(),m.memoizedState=[d,c],d},useReducer:function(d,c,m){var E=xr();return c=m!==void 0?m(c):c,E.memoizedState=E.baseState=c,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:c},E.queue=d,d=d.dispatch=JM.bind(null,Qs,d),[E.memoizedState,d]},useRef:function(d){var c=xr();return d={current:d},c.memoizedState=d},useState:Dv,useDebugValue:em,useDeferredValue:function(d){return xr().memoizedState=d},useTransition:function(){var d=Dv(!1),c=d[0];return d=QM.bind(null,d[1]),xr().memoizedState=d,[c,d]},useMutableSource:function(){},useSyncExternalStore:function(d,c,m){var E=Qs,T=xr();if($s){if(m===void 0)throw Error(s(407));m=m()}else{if(m=c(),Tn===null)throw Error(s(349));(ma&30)!==0||Iv(E,c,m)}T.memoizedState=m;var M={value:m,getSnapshot:c};return T.queue=M,Bv(Fv.bind(null,E,M,d),[d]),E.flags|=2048,$u(9,Rv.bind(null,E,M,m,c),void 0,null),m},useId:function(){var d=xr(),c=Tn.identifierPrefix;if($s){var m=Br,E=Or;m=(E&~(1<<32-$t(E)-1)).toString(32)+m,c=":"+c+"R"+m,m=ju++,0<m&&(c+="H"+m.toString(32)),c+=":"}else m=KM++,c=":"+c+"r"+m.toString(32)+":";return d.memoizedState=c},unstable_isNewReconciler:!1},sI={readContext:Pi,useCallback:Hv,useContext:Pi,useEffect:tm,useImperativeHandle:jv,useInsertionEffect:Uv,useLayoutEffect:Gv,useMemo:$v,useReducer:Qp,useRef:Ov,useState:function(){return Qp(Hu)},useDebugValue:em,useDeferredValue:function(d){var c=zi();return qv(c,xn.memoizedState,d)},useTransition:function(){var d=Qp(Hu)[0],c=zi().memoizedState;return[d,c]},useMutableSource:Nv,useSyncExternalStore:Mv,useId:Yv,unstable_isNewReconciler:!1},nI={readContext:Pi,useCallback:Hv,useContext:Pi,useEffect:tm,useImperativeHandle:jv,useInsertionEffect:Uv,useLayoutEffect:Gv,useMemo:$v,useReducer:Jp,useRef:Ov,useState:function(){return Jp(Hu)},useDebugValue:em,useDeferredValue:function(d){var c=zi();return xn===null?c.memoizedState=d:qv(c,xn.memoizedState,d)},useTransition:function(){var d=Jp(Hu)[0],c=zi().memoizedState;return[d,c]},useMutableSource:Nv,useSyncExternalStore:Mv,useId:Yv,unstable_isNewReconciler:!1};function tr(d,c){if(d&&d.defaultProps){c=Nt({},c),d=d.defaultProps;for(var m in d)c[m]===void 0&&(c[m]=d[m]);return c}return c}function sm(d,c,m,E){c=d.memoizedState,m=m(E,c),m=m==null?c:Nt({},c,m),d.memoizedState=m,d.lanes===0&&(d.updateQueue.baseState=m)}var dc={isMounted:function(d){return(d=d._reactInternals)?je(d)===d:!1},enqueueSetState:function(d,c,m){d=d._reactInternals;var E=Jn(),T=To(d),M=Gr(E,T);M.payload=c,m!=null&&(M.callback=m),c=Eo(d,M,T),c!==null&&(nr(c,d,T,E),sc(c,d,T))},enqueueReplaceState:function(d,c,m){d=d._reactInternals;var E=Jn(),T=To(d),M=Gr(E,T);M.tag=1,M.payload=c,m!=null&&(M.callback=m),c=Eo(d,M,T),c!==null&&(nr(c,d,T,E),sc(c,d,T))},enqueueForceUpdate:function(d,c){d=d._reactInternals;var m=Jn(),E=To(d),T=Gr(m,E);T.tag=2,c!=null&&(T.callback=c),c=Eo(d,T,E),c!==null&&(nr(c,d,E,m),sc(c,d,E))}};function Kv(d,c,m,E,T,M,G){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(E,M,G):c.prototype&&c.prototype.isPureReactComponent?!Mu(m,E)||!Mu(T,M):!0}function Qv(d,c,m){var E=!1,T=xo,M=c.contextType;return typeof M=="object"&&M!==null?M=Pi(M):(T=hi(c)?ha:Dn.current,E=c.contextTypes,M=(E=E!=null)?gl(d,T):xo),c=new c(m,M),d.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=dc,d.stateNode=c,c._reactInternals=d,E&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=T,d.__reactInternalMemoizedMaskedChildContext=M),c}function Jv(d,c,m,E){d=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(m,E),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(m,E),c.state!==d&&dc.enqueueReplaceState(c,c.state,null)}function nm(d,c,m,E){var T=d.stateNode;T.props=m,T.state=d.memoizedState,T.refs={},jp(d);var M=c.contextType;typeof M=="object"&&M!==null?T.context=Pi(M):(M=hi(c)?ha:Dn.current,T.context=gl(d,M)),T.state=d.memoizedState,M=c.getDerivedStateFromProps,typeof M=="function"&&(sm(d,c,M,m),T.state=d.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(c=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),c!==T.state&&dc.enqueueReplaceState(T,T.state,null),nc(d,m,T,E),T.state=d.memoizedState),typeof T.componentDidMount=="function"&&(d.flags|=4194308)}function bl(d,c){try{var m="",E=c;do m+=Zt(E),E=E.return;while(E);var T=m}catch(M){T=`
Error generating stack: `+M.message+`
`+M.stack}return{value:d,source:c,stack:T,digest:null}}function im(d,c,m){return{value:d,source:null,stack:m??null,digest:c??null}}function rm(d,c){try{console.error(c.value)}catch(m){setTimeout(function(){throw m})}}var iI=typeof WeakMap=="function"?WeakMap:Map;function tb(d,c,m){m=Gr(-1,m),m.tag=3,m.payload={element:null};var E=c.value;return m.callback=function(){_c||(_c=!0,vm=E),rm(d,c)},m}function eb(d,c,m){m=Gr(-1,m),m.tag=3;var E=d.type.getDerivedStateFromError;if(typeof E=="function"){var T=c.value;m.payload=function(){return E(T)},m.callback=function(){rm(d,c)}}var M=d.stateNode;return M!==null&&typeof M.componentDidCatch=="function"&&(m.callback=function(){rm(d,c),typeof E!="function"&&(Ao===null?Ao=new Set([this]):Ao.add(this));var G=c.stack;this.componentDidCatch(c.value,{componentStack:G!==null?G:""})}),m}function sb(d,c,m){var E=d.pingCache;if(E===null){E=d.pingCache=new iI;var T=new Set;E.set(c,T)}else T=E.get(c),T===void 0&&(T=new Set,E.set(c,T));T.has(m)||(T.add(m),d=yI.bind(null,d,c,m),c.then(d,d))}function nb(d){do{var c;if((c=d.tag===13)&&(c=d.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return d;d=d.return}while(d!==null);return null}function ib(d,c,m,E,T){return(d.mode&1)===0?(d===c?d.flags|=65536:(d.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(c=Gr(-1,1),c.tag=2,Eo(m,c,1))),m.lanes|=1),d):(d.flags|=65536,d.lanes=T,d)}var rI=A.ReactCurrentOwner,ci=!1;function Qn(d,c,m,E){c.child=d===null?Av(c,null,m,E):_l(c,d.child,m,E)}function rb(d,c,m,E,T){m=m.render;var M=c.ref;return xl(c,T),E=Zp(d,c,m,E,M,T),m=Kp(),d!==null&&!ci?(c.updateQueue=d.updateQueue,c.flags&=-2053,d.lanes&=~T,Vr(d,c,T)):($s&&m&&Rp(c),c.flags|=1,Qn(d,c,E,T),c.child)}function ob(d,c,m,E,T){if(d===null){var M=m.type;return typeof M=="function"&&!Cm(M)&&M.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(c.tag=15,c.type=M,ab(d,c,M,E,T)):(d=Sc(m.type,null,E,c,c.mode,T),d.ref=c.ref,d.return=c,c.child=d)}if(M=d.child,(d.lanes&T)===0){var G=M.memoizedProps;if(m=m.compare,m=m!==null?m:Mu,m(G,E)&&d.ref===c.ref)return Vr(d,c,T)}return c.flags|=1,d=Lo(M,E),d.ref=c.ref,d.return=c,c.child=d}function ab(d,c,m,E,T){if(d!==null){var M=d.memoizedProps;if(Mu(M,E)&&d.ref===c.ref)if(ci=!1,c.pendingProps=E=M,(d.lanes&T)!==0)(d.flags&131072)!==0&&(ci=!0);else return c.lanes=d.lanes,Vr(d,c,T)}return om(d,c,m,E,T)}function lb(d,c,m){var E=c.pendingProps,T=E.children,M=d!==null?d.memoizedState:null;if(E.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ms(Sl,Ai),Ai|=m;else{if((m&1073741824)===0)return d=M!==null?M.baseLanes|m:m,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:d,cachePool:null,transitions:null},c.updateQueue=null,Ms(Sl,Ai),Ai|=d,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},E=M!==null?M.baseLanes:m,Ms(Sl,Ai),Ai|=E}else M!==null?(E=M.baseLanes|m,c.memoizedState=null):E=m,Ms(Sl,Ai),Ai|=E;return Qn(d,c,T,m),c.child}function ub(d,c){var m=c.ref;(d===null&&m!==null||d!==null&&d.ref!==m)&&(c.flags|=512,c.flags|=2097152)}function om(d,c,m,E,T){var M=hi(m)?ha:Dn.current;return M=gl(c,M),xl(c,T),m=Zp(d,c,m,E,M,T),E=Kp(),d!==null&&!ci?(c.updateQueue=d.updateQueue,c.flags&=-2053,d.lanes&=~T,Vr(d,c,T)):($s&&E&&Rp(c),c.flags|=1,Qn(d,c,m,T),c.child)}function db(d,c,m,E,T){if(hi(m)){var M=!0;Wh(c)}else M=!1;if(xl(c,T),c.stateNode===null)cc(d,c),Qv(c,m,E),nm(c,m,E,T),E=!0;else if(d===null){var G=c.stateNode,rt=c.memoizedProps;G.props=rt;var xt=G.context,Vt=m.contextType;typeof Vt=="object"&&Vt!==null?Vt=Pi(Vt):(Vt=hi(m)?ha:Dn.current,Vt=gl(c,Vt));var de=m.getDerivedStateFromProps,fe=typeof de=="function"||typeof G.getSnapshotBeforeUpdate=="function";fe||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(rt!==E||xt!==Vt)&&Jv(c,G,E,Vt),bo=!1;var le=c.memoizedState;G.state=le,nc(c,E,G,T),xt=c.memoizedState,rt!==E||le!==xt||di.current||bo?(typeof de=="function"&&(sm(c,m,de,E),xt=c.memoizedState),(rt=bo||Kv(c,m,rt,E,le,xt,Vt))?(fe||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(c.flags|=4194308)):(typeof G.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=E,c.memoizedState=xt),G.props=E,G.state=xt,G.context=Vt,E=rt):(typeof G.componentDidMount=="function"&&(c.flags|=4194308),E=!1)}else{G=c.stateNode,Tv(d,c),rt=c.memoizedProps,Vt=c.type===c.elementType?rt:tr(c.type,rt),G.props=Vt,fe=c.pendingProps,le=G.context,xt=m.contextType,typeof xt=="object"&&xt!==null?xt=Pi(xt):(xt=hi(m)?ha:Dn.current,xt=gl(c,xt));var Ae=m.getDerivedStateFromProps;(de=typeof Ae=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(rt!==fe||le!==xt)&&Jv(c,G,E,xt),bo=!1,le=c.memoizedState,G.state=le,nc(c,E,G,T);var ke=c.memoizedState;rt!==fe||le!==ke||di.current||bo?(typeof Ae=="function"&&(sm(c,m,Ae,E),ke=c.memoizedState),(Vt=bo||Kv(c,m,Vt,E,le,ke,xt)||!1)?(de||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(E,ke,xt),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(E,ke,xt)),typeof G.componentDidUpdate=="function"&&(c.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof G.componentDidUpdate!="function"||rt===d.memoizedProps&&le===d.memoizedState||(c.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||rt===d.memoizedProps&&le===d.memoizedState||(c.flags|=1024),c.memoizedProps=E,c.memoizedState=ke),G.props=E,G.state=ke,G.context=xt,E=Vt):(typeof G.componentDidUpdate!="function"||rt===d.memoizedProps&&le===d.memoizedState||(c.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||rt===d.memoizedProps&&le===d.memoizedState||(c.flags|=1024),E=!1)}return am(d,c,m,E,M,T)}function am(d,c,m,E,T,M){ub(d,c);var G=(c.flags&128)!==0;if(!E&&!G)return T&&pv(c,m,!1),Vr(d,c,M);E=c.stateNode,rI.current=c;var rt=G&&typeof m.getDerivedStateFromError!="function"?null:E.render();return c.flags|=1,d!==null&&G?(c.child=_l(c,d.child,null,M),c.child=_l(c,null,rt,M)):Qn(d,c,rt,M),c.memoizedState=E.state,T&&pv(c,m,!0),c.child}function hb(d){var c=d.stateNode;c.pendingContext?gv(d,c.pendingContext,c.pendingContext!==c.context):c.context&&gv(d,c.context,!1),Hp(d,c.containerInfo)}function cb(d,c,m,E,T){return ml(),Dp(T),c.flags|=256,Qn(d,c,m,E),c.child}var lm={dehydrated:null,treeContext:null,retryLane:0};function um(d){return{baseLanes:d,cachePool:null,transitions:null}}function gb(d,c,m){var E=c.pendingProps,T=Ks.current,M=!1,G=(c.flags&128)!==0,rt;if((rt=G)||(rt=d!==null&&d.memoizedState===null?!1:(T&2)!==0),rt?(M=!0,c.flags&=-129):(d===null||d.memoizedState!==null)&&(T|=1),Ms(Ks,T&1),d===null)return zp(c),d=c.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((c.mode&1)===0?c.lanes=1:d.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(G=E.children,d=E.fallback,M?(E=c.mode,M=c.child,G={mode:"hidden",children:G},(E&1)===0&&M!==null?(M.childLanes=0,M.pendingProps=G):M=Ac(G,E,0,null),d=ba(d,E,m,null),M.return=c,d.return=c,M.sibling=d,c.child=M,c.child.memoizedState=um(m),c.memoizedState=lm,d):dm(c,G));if(T=d.memoizedState,T!==null&&(rt=T.dehydrated,rt!==null))return oI(d,c,G,E,rt,T,m);if(M){M=E.fallback,G=c.mode,T=d.child,rt=T.sibling;var xt={mode:"hidden",children:E.children};return(G&1)===0&&c.child!==T?(E=c.child,E.childLanes=0,E.pendingProps=xt,c.deletions=null):(E=Lo(T,xt),E.subtreeFlags=T.subtreeFlags&14680064),rt!==null?M=Lo(rt,M):(M=ba(M,G,m,null),M.flags|=2),M.return=c,E.return=c,E.sibling=M,c.child=E,E=M,M=c.child,G=d.child.memoizedState,G=G===null?um(m):{baseLanes:G.baseLanes|m,cachePool:null,transitions:G.transitions},M.memoizedState=G,M.childLanes=d.childLanes&~m,c.memoizedState=lm,E}return M=d.child,d=M.sibling,E=Lo(M,{mode:"visible",children:E.children}),(c.mode&1)===0&&(E.lanes=m),E.return=c,E.sibling=null,d!==null&&(m=c.deletions,m===null?(c.deletions=[d],c.flags|=16):m.push(d)),c.child=E,c.memoizedState=null,E}function dm(d,c){return c=Ac({mode:"visible",children:c},d.mode,0,null),c.return=d,d.child=c}function hc(d,c,m,E){return E!==null&&Dp(E),_l(c,d.child,null,m),d=dm(c,c.pendingProps.children),d.flags|=2,c.memoizedState=null,d}function oI(d,c,m,E,T,M,G){if(m)return c.flags&256?(c.flags&=-257,E=im(Error(s(422))),hc(d,c,G,E)):c.memoizedState!==null?(c.child=d.child,c.flags|=128,null):(M=E.fallback,T=c.mode,E=Ac({mode:"visible",children:E.children},T,0,null),M=ba(M,T,G,null),M.flags|=2,E.return=c,M.return=c,E.sibling=M,c.child=E,(c.mode&1)!==0&&_l(c,d.child,null,G),c.child.memoizedState=um(G),c.memoizedState=lm,M);if((c.mode&1)===0)return hc(d,c,G,null);if(T.data==="$!"){if(E=T.nextSibling&&T.nextSibling.dataset,E)var rt=E.dgst;return E=rt,M=Error(s(419)),E=im(M,E,void 0),hc(d,c,G,E)}if(rt=(G&d.childLanes)!==0,ci||rt){if(E=Tn,E!==null){switch(G&-G){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=(T&(E.suspendedLanes|G))!==0?0:T,T!==0&&T!==M.retryLane&&(M.retryLane=T,Ur(d,T),nr(E,d,T,-1))}return Tm(),E=im(Error(s(421))),hc(d,c,G,E)}return T.data==="$?"?(c.flags|=128,c.child=d.child,c=xI.bind(null,d),T._reactRetry=c,null):(d=M.treeContext,Si=_o(T.nextSibling),Ei=c,$s=!0,Ji=null,d!==null&&(Ri[Fi++]=Or,Ri[Fi++]=Br,Ri[Fi++]=ca,Or=d.id,Br=d.overflow,ca=c),c=dm(c,E.children),c.flags|=4096,c)}function fb(d,c,m){d.lanes|=c;var E=d.alternate;E!==null&&(E.lanes|=c),Gp(d.return,c,m)}function hm(d,c,m,E,T){var M=d.memoizedState;M===null?d.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:E,tail:m,tailMode:T}:(M.isBackwards=c,M.rendering=null,M.renderingStartTime=0,M.last=E,M.tail=m,M.tailMode=T)}function pb(d,c,m){var E=c.pendingProps,T=E.revealOrder,M=E.tail;if(Qn(d,c,E.children,m),E=Ks.current,(E&2)!==0)E=E&1|2,c.flags|=128;else{if(d!==null&&(d.flags&128)!==0)t:for(d=c.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&fb(d,m,c);else if(d.tag===19)fb(d,m,c);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break t;for(;d.sibling===null;){if(d.return===null||d.return===c)break t;d=d.return}d.sibling.return=d.return,d=d.sibling}E&=1}if(Ms(Ks,E),(c.mode&1)===0)c.memoizedState=null;else switch(T){case"forwards":for(m=c.child,T=null;m!==null;)d=m.alternate,d!==null&&ic(d)===null&&(T=m),m=m.sibling;m=T,m===null?(T=c.child,c.child=null):(T=m.sibling,m.sibling=null),hm(c,!1,T,m,M);break;case"backwards":for(m=null,T=c.child,c.child=null;T!==null;){if(d=T.alternate,d!==null&&ic(d)===null){c.child=T;break}d=T.sibling,T.sibling=m,m=T,T=d}hm(c,!0,m,null,M);break;case"together":hm(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function cc(d,c){(c.mode&1)===0&&d!==null&&(d.alternate=null,c.alternate=null,c.flags|=2)}function Vr(d,c,m){if(d!==null&&(c.dependencies=d.dependencies),_a|=c.lanes,(m&c.childLanes)===0)return null;if(d!==null&&c.child!==d.child)throw Error(s(153));if(c.child!==null){for(d=c.child,m=Lo(d,d.pendingProps),c.child=m,m.return=c;d.sibling!==null;)d=d.sibling,m=m.sibling=Lo(d,d.pendingProps),m.return=c;m.sibling=null}return c.child}function aI(d,c,m){switch(c.tag){case 3:hb(c),ml();break;case 5:kv(c);break;case 1:hi(c.type)&&Wh(c);break;case 4:Hp(c,c.stateNode.containerInfo);break;case 10:var E=c.type._context,T=c.memoizedProps.value;Ms(tc,E._currentValue),E._currentValue=T;break;case 13:if(E=c.memoizedState,E!==null)return E.dehydrated!==null?(Ms(Ks,Ks.current&1),c.flags|=128,null):(m&c.child.childLanes)!==0?gb(d,c,m):(Ms(Ks,Ks.current&1),d=Vr(d,c,m),d!==null?d.sibling:null);Ms(Ks,Ks.current&1);break;case 19:if(E=(m&c.childLanes)!==0,(d.flags&128)!==0){if(E)return pb(d,c,m);c.flags|=128}if(T=c.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),Ms(Ks,Ks.current),E)break;return null;case 22:case 23:return c.lanes=0,lb(d,c,m)}return Vr(d,c,m)}var mb,cm,_b,yb;mb=function(d,c){for(var m=c.child;m!==null;){if(m.tag===5||m.tag===6)d.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===c)break;for(;m.sibling===null;){if(m.return===null||m.return===c)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},cm=function(){},_b=function(d,c,m,E){var T=d.memoizedProps;if(T!==E){d=c.stateNode,pa(yr.current);var M=null;switch(m){case"input":T=Ne(d,T),E=Ne(d,E),M=[];break;case"select":T=Nt({},T,{value:void 0}),E=Nt({},E,{value:void 0}),M=[];break;case"textarea":T=ss(d,T),E=ss(d,E),M=[];break;default:typeof T.onClick!="function"&&typeof E.onClick=="function"&&(d.onclick=$h)}gt(m,E);var G;m=null;for(Vt in T)if(!E.hasOwnProperty(Vt)&&T.hasOwnProperty(Vt)&&T[Vt]!=null)if(Vt==="style"){var rt=T[Vt];for(G in rt)rt.hasOwnProperty(G)&&(m||(m={}),m[G]="")}else Vt!=="dangerouslySetInnerHTML"&&Vt!=="children"&&Vt!=="suppressContentEditableWarning"&&Vt!=="suppressHydrationWarning"&&Vt!=="autoFocus"&&(i.hasOwnProperty(Vt)?M||(M=[]):(M=M||[]).push(Vt,null));for(Vt in E){var xt=E[Vt];if(rt=T!=null?T[Vt]:void 0,E.hasOwnProperty(Vt)&&xt!==rt&&(xt!=null||rt!=null))if(Vt==="style")if(rt){for(G in rt)!rt.hasOwnProperty(G)||xt&&xt.hasOwnProperty(G)||(m||(m={}),m[G]="");for(G in xt)xt.hasOwnProperty(G)&&rt[G]!==xt[G]&&(m||(m={}),m[G]=xt[G])}else m||(M||(M=[]),M.push(Vt,m)),m=xt;else Vt==="dangerouslySetInnerHTML"?(xt=xt?xt.__html:void 0,rt=rt?rt.__html:void 0,xt!=null&&rt!==xt&&(M=M||[]).push(Vt,xt)):Vt==="children"?typeof xt!="string"&&typeof xt!="number"||(M=M||[]).push(Vt,""+xt):Vt!=="suppressContentEditableWarning"&&Vt!=="suppressHydrationWarning"&&(i.hasOwnProperty(Vt)?(xt!=null&&Vt==="onScroll"&&Os("scroll",d),M||rt===xt||(M=[])):(M=M||[]).push(Vt,xt))}m&&(M=M||[]).push("style",m);var Vt=M;(c.updateQueue=Vt)&&(c.flags|=4)}},yb=function(d,c,m,E){m!==E&&(c.flags|=4)};function qu(d,c){if(!$s)switch(d.tailMode){case"hidden":c=d.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?d.tail=null:m.sibling=null;break;case"collapsed":m=d.tail;for(var E=null;m!==null;)m.alternate!==null&&(E=m),m=m.sibling;E===null?c||d.tail===null?d.tail=null:d.tail.sibling=null:E.sibling=null}}function Bn(d){var c=d.alternate!==null&&d.alternate.child===d.child,m=0,E=0;if(c)for(var T=d.child;T!==null;)m|=T.lanes|T.childLanes,E|=T.subtreeFlags&14680064,E|=T.flags&14680064,T.return=d,T=T.sibling;else for(T=d.child;T!==null;)m|=T.lanes|T.childLanes,E|=T.subtreeFlags,E|=T.flags,T.return=d,T=T.sibling;return d.subtreeFlags|=E,d.childLanes=m,c}function lI(d,c,m){var E=c.pendingProps;switch(Fp(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(c),null;case 1:return hi(c.type)&&Yh(),Bn(c),null;case 3:return E=c.stateNode,vl(),Bs(di),Bs(Dn),Yp(),E.pendingContext&&(E.context=E.pendingContext,E.pendingContext=null),(d===null||d.child===null)&&(Qh(c)?c.flags|=4:d===null||d.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Ji!==null&&(Sm(Ji),Ji=null))),cm(d,c),Bn(c),null;case 5:$p(c);var T=pa(Gu.current);if(m=c.type,d!==null&&c.stateNode!=null)_b(d,c,m,E,T),d.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!E){if(c.stateNode===null)throw Error(s(166));return Bn(c),null}if(d=pa(yr.current),Qh(c)){E=c.stateNode,m=c.type;var M=c.memoizedProps;switch(E[_r]=c,E[zu]=M,d=(c.mode&1)!==0,m){case"dialog":Os("cancel",E),Os("close",E);break;case"iframe":case"object":case"embed":Os("load",E);break;case"video":case"audio":for(T=0;T<Ru.length;T++)Os(Ru[T],E);break;case"source":Os("error",E);break;case"img":case"image":case"link":Os("error",E),Os("load",E);break;case"details":Os("toggle",E);break;case"input":ge(E,M),Os("invalid",E);break;case"select":E._wrapperState={wasMultiple:!!M.multiple},Os("invalid",E);break;case"textarea":ts(E,M),Os("invalid",E)}gt(m,M),T=null;for(var G in M)if(M.hasOwnProperty(G)){var rt=M[G];G==="children"?typeof rt=="string"?E.textContent!==rt&&(M.suppressHydrationWarning!==!0&&Hh(E.textContent,rt,d),T=["children",rt]):typeof rt=="number"&&E.textContent!==""+rt&&(M.suppressHydrationWarning!==!0&&Hh(E.textContent,rt,d),T=["children",""+rt]):i.hasOwnProperty(G)&&rt!=null&&G==="onScroll"&&Os("scroll",E)}switch(m){case"input":ce(E),Ge(E,M,!0);break;case"textarea":ce(E),Fe(E);break;case"select":case"option":break;default:typeof M.onClick=="function"&&(E.onclick=$h)}E=T,c.updateQueue=E,E!==null&&(c.flags|=4)}else{G=T.nodeType===9?T:T.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=Oe(m)),d==="http://www.w3.org/1999/xhtml"?m==="script"?(d=G.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof E.is=="string"?d=G.createElement(m,{is:E.is}):(d=G.createElement(m),m==="select"&&(G=d,E.multiple?G.multiple=!0:E.size&&(G.size=E.size))):d=G.createElementNS(d,m),d[_r]=c,d[zu]=E,mb(d,c,!1,!1),c.stateNode=d;t:{switch(G=N(m,E),m){case"dialog":Os("cancel",d),Os("close",d),T=E;break;case"iframe":case"object":case"embed":Os("load",d),T=E;break;case"video":case"audio":for(T=0;T<Ru.length;T++)Os(Ru[T],d);T=E;break;case"source":Os("error",d),T=E;break;case"img":case"image":case"link":Os("error",d),Os("load",d),T=E;break;case"details":Os("toggle",d),T=E;break;case"input":ge(d,E),T=Ne(d,E),Os("invalid",d);break;case"option":T=E;break;case"select":d._wrapperState={wasMultiple:!!E.multiple},T=Nt({},E,{value:void 0}),Os("invalid",d);break;case"textarea":ts(d,E),T=ss(d,E),Os("invalid",d);break;default:T=E}gt(m,T),rt=T;for(M in rt)if(rt.hasOwnProperty(M)){var xt=rt[M];M==="style"?xs(d,xt):M==="dangerouslySetInnerHTML"?(xt=xt?xt.__html:void 0,xt!=null&&Hs(d,xt)):M==="children"?typeof xt=="string"?(m!=="textarea"||xt!=="")&&Ls(d,xt):typeof xt=="number"&&Ls(d,""+xt):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(i.hasOwnProperty(M)?xt!=null&&M==="onScroll"&&Os("scroll",d):xt!=null&&S(d,M,xt,G))}switch(m){case"input":ce(d),Ge(d,E,!1);break;case"textarea":ce(d),Fe(d);break;case"option":E.value!=null&&d.setAttribute("value",""+ne(E.value));break;case"select":d.multiple=!!E.multiple,M=E.value,M!=null?Je(d,!!E.multiple,M,!1):E.defaultValue!=null&&Je(d,!!E.multiple,E.defaultValue,!0);break;default:typeof T.onClick=="function"&&(d.onclick=$h)}switch(m){case"button":case"input":case"select":case"textarea":E=!!E.autoFocus;break t;case"img":E=!0;break t;default:E=!1}}E&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Bn(c),null;case 6:if(d&&c.stateNode!=null)yb(d,c,d.memoizedProps,E);else{if(typeof E!="string"&&c.stateNode===null)throw Error(s(166));if(m=pa(Gu.current),pa(yr.current),Qh(c)){if(E=c.stateNode,m=c.memoizedProps,E[_r]=c,(M=E.nodeValue!==m)&&(d=Ei,d!==null))switch(d.tag){case 3:Hh(E.nodeValue,m,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&Hh(E.nodeValue,m,(d.mode&1)!==0)}M&&(c.flags|=4)}else E=(m.nodeType===9?m:m.ownerDocument).createTextNode(E),E[_r]=c,c.stateNode=E}return Bn(c),null;case 13:if(Bs(Ks),E=c.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if($s&&Si!==null&&(c.mode&1)!==0&&(c.flags&128)===0)bv(),ml(),c.flags|=98560,M=!1;else if(M=Qh(c),E!==null&&E.dehydrated!==null){if(d===null){if(!M)throw Error(s(318));if(M=c.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(s(317));M[_r]=c}else ml(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Bn(c),M=!1}else Ji!==null&&(Sm(Ji),Ji=null),M=!0;if(!M)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=m,c):(E=E!==null,E!==(d!==null&&d.memoizedState!==null)&&E&&(c.child.flags|=8192,(c.mode&1)!==0&&(d===null||(Ks.current&1)!==0?vn===0&&(vn=3):Tm())),c.updateQueue!==null&&(c.flags|=4),Bn(c),null);case 4:return vl(),cm(d,c),d===null&&Fu(c.stateNode.containerInfo),Bn(c),null;case 10:return Up(c.type._context),Bn(c),null;case 17:return hi(c.type)&&Yh(),Bn(c),null;case 19:if(Bs(Ks),M=c.memoizedState,M===null)return Bn(c),null;if(E=(c.flags&128)!==0,G=M.rendering,G===null)if(E)qu(M,!1);else{if(vn!==0||d!==null&&(d.flags&128)!==0)for(d=c.child;d!==null;){if(G=ic(d),G!==null){for(c.flags|=128,qu(M,!1),E=G.updateQueue,E!==null&&(c.updateQueue=E,c.flags|=4),c.subtreeFlags=0,E=m,m=c.child;m!==null;)M=m,d=E,M.flags&=14680066,G=M.alternate,G===null?(M.childLanes=0,M.lanes=d,M.child=null,M.subtreeFlags=0,M.memoizedProps=null,M.memoizedState=null,M.updateQueue=null,M.dependencies=null,M.stateNode=null):(M.childLanes=G.childLanes,M.lanes=G.lanes,M.child=G.child,M.subtreeFlags=0,M.deletions=null,M.memoizedProps=G.memoizedProps,M.memoizedState=G.memoizedState,M.updateQueue=G.updateQueue,M.type=G.type,d=G.dependencies,M.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),m=m.sibling;return Ms(Ks,Ks.current&1|2),c.child}d=d.sibling}M.tail!==null&&tt()>Al&&(c.flags|=128,E=!0,qu(M,!1),c.lanes=4194304)}else{if(!E)if(d=ic(G),d!==null){if(c.flags|=128,E=!0,m=d.updateQueue,m!==null&&(c.updateQueue=m,c.flags|=4),qu(M,!0),M.tail===null&&M.tailMode==="hidden"&&!G.alternate&&!$s)return Bn(c),null}else 2*tt()-M.renderingStartTime>Al&&m!==1073741824&&(c.flags|=128,E=!0,qu(M,!1),c.lanes=4194304);M.isBackwards?(G.sibling=c.child,c.child=G):(m=M.last,m!==null?m.sibling=G:c.child=G,M.last=G)}return M.tail!==null?(c=M.tail,M.rendering=c,M.tail=c.sibling,M.renderingStartTime=tt(),c.sibling=null,m=Ks.current,Ms(Ks,E?m&1|2:m&1),c):(Bn(c),null);case 22:case 23:return wm(),E=c.memoizedState!==null,d!==null&&d.memoizedState!==null!==E&&(c.flags|=8192),E&&(c.mode&1)!==0?(Ai&1073741824)!==0&&(Bn(c),c.subtreeFlags&6&&(c.flags|=8192)):Bn(c),null;case 24:return null;case 25:return null}throw Error(s(156,c.tag))}function uI(d,c){switch(Fp(c),c.tag){case 1:return hi(c.type)&&Yh(),d=c.flags,d&65536?(c.flags=d&-65537|128,c):null;case 3:return vl(),Bs(di),Bs(Dn),Yp(),d=c.flags,(d&65536)!==0&&(d&128)===0?(c.flags=d&-65537|128,c):null;case 5:return $p(c),null;case 13:if(Bs(Ks),d=c.memoizedState,d!==null&&d.dehydrated!==null){if(c.alternate===null)throw Error(s(340));ml()}return d=c.flags,d&65536?(c.flags=d&-65537|128,c):null;case 19:return Bs(Ks),null;case 4:return vl(),null;case 10:return Up(c.type._context),null;case 22:case 23:return wm(),null;case 24:return null;default:return null}}var gc=!1,Un=!1,dI=typeof WeakSet=="function"?WeakSet:Set,Le=null;function El(d,c){var m=d.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(E){en(d,c,E)}else m.current=null}function gm(d,c,m){try{m()}catch(E){en(d,c,E)}}var xb=!1;function hI(d,c){if(wp=bi,d=K0(),_p(d)){if("selectionStart"in d)var m={start:d.selectionStart,end:d.selectionEnd};else t:{m=(m=d.ownerDocument)&&m.defaultView||window;var E=m.getSelection&&m.getSelection();if(E&&E.rangeCount!==0){m=E.anchorNode;var T=E.anchorOffset,M=E.focusNode;E=E.focusOffset;try{m.nodeType,M.nodeType}catch{m=null;break t}var G=0,rt=-1,xt=-1,Vt=0,de=0,fe=d,le=null;e:for(;;){for(var Ae;fe!==m||T!==0&&fe.nodeType!==3||(rt=G+T),fe!==M||E!==0&&fe.nodeType!==3||(xt=G+E),fe.nodeType===3&&(G+=fe.nodeValue.length),(Ae=fe.firstChild)!==null;)le=fe,fe=Ae;for(;;){if(fe===d)break e;if(le===m&&++Vt===T&&(rt=G),le===M&&++de===E&&(xt=G),(Ae=fe.nextSibling)!==null)break;fe=le,le=fe.parentNode}fe=Ae}m=rt===-1||xt===-1?null:{start:rt,end:xt}}else m=null}m=m||{start:0,end:0}}else m=null;for(Tp={focusedElem:d,selectionRange:m},bi=!1,Le=c;Le!==null;)if(c=Le,d=c.child,(c.subtreeFlags&1028)!==0&&d!==null)d.return=c,Le=d;else for(;Le!==null;){c=Le;try{var ke=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(ke!==null){var Me=ke.memoizedProps,un=ke.memoizedState,Mt=c.stateNode,wt=Mt.getSnapshotBeforeUpdate(c.elementType===c.type?Me:tr(c.type,Me),un);Mt.__reactInternalSnapshotBeforeUpdate=wt}break;case 3:var Dt=c.stateNode.containerInfo;Dt.nodeType===1?Dt.textContent="":Dt.nodeType===9&&Dt.documentElement&&Dt.removeChild(Dt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(ye){en(c,c.return,ye)}if(d=c.sibling,d!==null){d.return=c.return,Le=d;break}Le=c.return}return ke=xb,xb=!1,ke}function Yu(d,c,m){var E=c.updateQueue;if(E=E!==null?E.lastEffect:null,E!==null){var T=E=E.next;do{if((T.tag&d)===d){var M=T.destroy;T.destroy=void 0,M!==void 0&&gm(c,m,M)}T=T.next}while(T!==E)}}function fc(d,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var m=c=c.next;do{if((m.tag&d)===d){var E=m.create;m.destroy=E()}m=m.next}while(m!==c)}}function fm(d){var c=d.ref;if(c!==null){var m=d.stateNode;switch(d.tag){case 5:d=m;break;default:d=m}typeof c=="function"?c(d):c.current=d}}function vb(d){var c=d.alternate;c!==null&&(d.alternate=null,vb(c)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(c=d.stateNode,c!==null&&(delete c[_r],delete c[zu],delete c[Np],delete c[YM],delete c[WM])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function bb(d){return d.tag===5||d.tag===3||d.tag===4}function Eb(d){t:for(;;){for(;d.sibling===null;){if(d.return===null||bb(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue t;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function pm(d,c,m){var E=d.tag;if(E===5||E===6)d=d.stateNode,c?m.nodeType===8?m.parentNode.insertBefore(d,c):m.insertBefore(d,c):(m.nodeType===8?(c=m.parentNode,c.insertBefore(d,m)):(c=m,c.appendChild(d)),m=m._reactRootContainer,m!=null||c.onclick!==null||(c.onclick=$h));else if(E!==4&&(d=d.child,d!==null))for(pm(d,c,m),d=d.sibling;d!==null;)pm(d,c,m),d=d.sibling}function mm(d,c,m){var E=d.tag;if(E===5||E===6)d=d.stateNode,c?m.insertBefore(d,c):m.appendChild(d);else if(E!==4&&(d=d.child,d!==null))for(mm(d,c,m),d=d.sibling;d!==null;)mm(d,c,m),d=d.sibling}var Mn=null,er=!1;function So(d,c,m){for(m=m.child;m!==null;)Sb(d,c,m),m=m.sibling}function Sb(d,c,m){if(Lt&&typeof Lt.onCommitFiberUnmount=="function")try{Lt.onCommitFiberUnmount(Pt,m)}catch{}switch(m.tag){case 5:Un||El(m,c);case 6:var E=Mn,T=er;Mn=null,So(d,c,m),Mn=E,er=T,Mn!==null&&(er?(d=Mn,m=m.stateNode,d.nodeType===8?d.parentNode.removeChild(m):d.removeChild(m)):Mn.removeChild(m.stateNode));break;case 18:Mn!==null&&(er?(d=Mn,m=m.stateNode,d.nodeType===8?kp(d.parentNode,m):d.nodeType===1&&kp(d,m),fr(d)):kp(Mn,m.stateNode));break;case 4:E=Mn,T=er,Mn=m.stateNode.containerInfo,er=!0,So(d,c,m),Mn=E,er=T;break;case 0:case 11:case 14:case 15:if(!Un&&(E=m.updateQueue,E!==null&&(E=E.lastEffect,E!==null))){T=E=E.next;do{var M=T,G=M.destroy;M=M.tag,G!==void 0&&((M&2)!==0||(M&4)!==0)&&gm(m,c,G),T=T.next}while(T!==E)}So(d,c,m);break;case 1:if(!Un&&(El(m,c),E=m.stateNode,typeof E.componentWillUnmount=="function"))try{E.props=m.memoizedProps,E.state=m.memoizedState,E.componentWillUnmount()}catch(rt){en(m,c,rt)}So(d,c,m);break;case 21:So(d,c,m);break;case 22:m.mode&1?(Un=(E=Un)||m.memoizedState!==null,So(d,c,m),Un=E):So(d,c,m);break;default:So(d,c,m)}}function Ab(d){var c=d.updateQueue;if(c!==null){d.updateQueue=null;var m=d.stateNode;m===null&&(m=d.stateNode=new dI),c.forEach(function(E){var T=vI.bind(null,d,E);m.has(E)||(m.add(E),E.then(T,T))})}}function sr(d,c){var m=c.deletions;if(m!==null)for(var E=0;E<m.length;E++){var T=m[E];try{var M=d,G=c,rt=G;t:for(;rt!==null;){switch(rt.tag){case 5:Mn=rt.stateNode,er=!1;break t;case 3:Mn=rt.stateNode.containerInfo,er=!0;break t;case 4:Mn=rt.stateNode.containerInfo,er=!0;break t}rt=rt.return}if(Mn===null)throw Error(s(160));Sb(M,G,T),Mn=null,er=!1;var xt=T.alternate;xt!==null&&(xt.return=null),T.return=null}catch(Vt){en(T,c,Vt)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)wb(c,d),c=c.sibling}function wb(d,c){var m=d.alternate,E=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(sr(c,d),vr(d),E&4){try{Yu(3,d,d.return),fc(3,d)}catch(Me){en(d,d.return,Me)}try{Yu(5,d,d.return)}catch(Me){en(d,d.return,Me)}}break;case 1:sr(c,d),vr(d),E&512&&m!==null&&El(m,m.return);break;case 5:if(sr(c,d),vr(d),E&512&&m!==null&&El(m,m.return),d.flags&32){var T=d.stateNode;try{Ls(T,"")}catch(Me){en(d,d.return,Me)}}if(E&4&&(T=d.stateNode,T!=null)){var M=d.memoizedProps,G=m!==null?m.memoizedProps:M,rt=d.type,xt=d.updateQueue;if(d.updateQueue=null,xt!==null)try{rt==="input"&&M.type==="radio"&&M.name!=null&&ze(T,M),N(rt,G);var Vt=N(rt,M);for(G=0;G<xt.length;G+=2){var de=xt[G],fe=xt[G+1];de==="style"?xs(T,fe):de==="dangerouslySetInnerHTML"?Hs(T,fe):de==="children"?Ls(T,fe):S(T,de,fe,Vt)}switch(rt){case"input":is(T,M);break;case"textarea":hs(T,M);break;case"select":var le=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!M.multiple;var Ae=M.value;Ae!=null?Je(T,!!M.multiple,Ae,!1):le!==!!M.multiple&&(M.defaultValue!=null?Je(T,!!M.multiple,M.defaultValue,!0):Je(T,!!M.multiple,M.multiple?[]:"",!1))}T[zu]=M}catch(Me){en(d,d.return,Me)}}break;case 6:if(sr(c,d),vr(d),E&4){if(d.stateNode===null)throw Error(s(162));T=d.stateNode,M=d.memoizedProps;try{T.nodeValue=M}catch(Me){en(d,d.return,Me)}}break;case 3:if(sr(c,d),vr(d),E&4&&m!==null&&m.memoizedState.isDehydrated)try{fr(c.containerInfo)}catch(Me){en(d,d.return,Me)}break;case 4:sr(c,d),vr(d);break;case 13:sr(c,d),vr(d),T=d.child,T.flags&8192&&(M=T.memoizedState!==null,T.stateNode.isHidden=M,!M||T.alternate!==null&&T.alternate.memoizedState!==null||(xm=tt())),E&4&&Ab(d);break;case 22:if(de=m!==null&&m.memoizedState!==null,d.mode&1?(Un=(Vt=Un)||de,sr(c,d),Un=Vt):sr(c,d),vr(d),E&8192){if(Vt=d.memoizedState!==null,(d.stateNode.isHidden=Vt)&&!de&&(d.mode&1)!==0)for(Le=d,de=d.child;de!==null;){for(fe=Le=de;Le!==null;){switch(le=Le,Ae=le.child,le.tag){case 0:case 11:case 14:case 15:Yu(4,le,le.return);break;case 1:El(le,le.return);var ke=le.stateNode;if(typeof ke.componentWillUnmount=="function"){E=le,m=le.return;try{c=E,ke.props=c.memoizedProps,ke.state=c.memoizedState,ke.componentWillUnmount()}catch(Me){en(E,m,Me)}}break;case 5:El(le,le.return);break;case 22:if(le.memoizedState!==null){Lb(fe);continue}}Ae!==null?(Ae.return=le,Le=Ae):Lb(fe)}de=de.sibling}t:for(de=null,fe=d;;){if(fe.tag===5){if(de===null){de=fe;try{T=fe.stateNode,Vt?(M=T.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none"):(rt=fe.stateNode,xt=fe.memoizedProps.style,G=xt!=null&&xt.hasOwnProperty("display")?xt.display:null,rt.style.display=ln("display",G))}catch(Me){en(d,d.return,Me)}}}else if(fe.tag===6){if(de===null)try{fe.stateNode.nodeValue=Vt?"":fe.memoizedProps}catch(Me){en(d,d.return,Me)}}else if((fe.tag!==22&&fe.tag!==23||fe.memoizedState===null||fe===d)&&fe.child!==null){fe.child.return=fe,fe=fe.child;continue}if(fe===d)break t;for(;fe.sibling===null;){if(fe.return===null||fe.return===d)break t;de===fe&&(de=null),fe=fe.return}de===fe&&(de=null),fe.sibling.return=fe.return,fe=fe.sibling}}break;case 19:sr(c,d),vr(d),E&4&&Ab(d);break;case 21:break;default:sr(c,d),vr(d)}}function vr(d){var c=d.flags;if(c&2){try{t:{for(var m=d.return;m!==null;){if(bb(m)){var E=m;break t}m=m.return}throw Error(s(160))}switch(E.tag){case 5:var T=E.stateNode;E.flags&32&&(Ls(T,""),E.flags&=-33);var M=Eb(d);mm(d,M,T);break;case 3:case 4:var G=E.stateNode.containerInfo,rt=Eb(d);pm(d,rt,G);break;default:throw Error(s(161))}}catch(xt){en(d,d.return,xt)}d.flags&=-3}c&4096&&(d.flags&=-4097)}function cI(d,c,m){Le=d,Tb(d)}function Tb(d,c,m){for(var E=(d.mode&1)!==0;Le!==null;){var T=Le,M=T.child;if(T.tag===22&&E){var G=T.memoizedState!==null||gc;if(!G){var rt=T.alternate,xt=rt!==null&&rt.memoizedState!==null||Un;rt=gc;var Vt=Un;if(gc=G,(Un=xt)&&!Vt)for(Le=T;Le!==null;)G=Le,xt=G.child,G.tag===22&&G.memoizedState!==null?kb(T):xt!==null?(xt.return=G,Le=xt):kb(T);for(;M!==null;)Le=M,Tb(M),M=M.sibling;Le=T,gc=rt,Un=Vt}Cb(d)}else(T.subtreeFlags&8772)!==0&&M!==null?(M.return=T,Le=M):Cb(d)}}function Cb(d){for(;Le!==null;){var c=Le;if((c.flags&8772)!==0){var m=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Un||fc(5,c);break;case 1:var E=c.stateNode;if(c.flags&4&&!Un)if(m===null)E.componentDidMount();else{var T=c.elementType===c.type?m.memoizedProps:tr(c.type,m.memoizedProps);E.componentDidUpdate(T,m.memoizedState,E.__reactInternalSnapshotBeforeUpdate)}var M=c.updateQueue;M!==null&&Lv(c,M,E);break;case 3:var G=c.updateQueue;if(G!==null){if(m=null,c.child!==null)switch(c.child.tag){case 5:m=c.child.stateNode;break;case 1:m=c.child.stateNode}Lv(c,G,m)}break;case 5:var rt=c.stateNode;if(m===null&&c.flags&4){m=rt;var xt=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":xt.autoFocus&&m.focus();break;case"img":xt.src&&(m.src=xt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var Vt=c.alternate;if(Vt!==null){var de=Vt.memoizedState;if(de!==null){var fe=de.dehydrated;fe!==null&&fr(fe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}Un||c.flags&512&&fm(c)}catch(le){en(c,c.return,le)}}if(c===d){Le=null;break}if(m=c.sibling,m!==null){m.return=c.return,Le=m;break}Le=c.return}}function Lb(d){for(;Le!==null;){var c=Le;if(c===d){Le=null;break}var m=c.sibling;if(m!==null){m.return=c.return,Le=m;break}Le=c.return}}function kb(d){for(;Le!==null;){var c=Le;try{switch(c.tag){case 0:case 11:case 15:var m=c.return;try{fc(4,c)}catch(xt){en(c,m,xt)}break;case 1:var E=c.stateNode;if(typeof E.componentDidMount=="function"){var T=c.return;try{E.componentDidMount()}catch(xt){en(c,T,xt)}}var M=c.return;try{fm(c)}catch(xt){en(c,M,xt)}break;case 5:var G=c.return;try{fm(c)}catch(xt){en(c,G,xt)}}}catch(xt){en(c,c.return,xt)}if(c===d){Le=null;break}var rt=c.sibling;if(rt!==null){rt.return=c.return,Le=rt;break}Le=c.return}}var gI=Math.ceil,pc=A.ReactCurrentDispatcher,_m=A.ReactCurrentOwner,Di=A.ReactCurrentBatchConfig,fs=0,Tn=null,pn=null,In=0,Ai=0,Sl=yo(0),vn=0,Wu=null,_a=0,mc=0,ym=0,Xu=null,gi=null,xm=0,Al=1/0,jr=null,_c=!1,vm=null,Ao=null,yc=!1,wo=null,xc=0,Zu=0,bm=null,vc=-1,bc=0;function Jn(){return(fs&6)!==0?tt():vc!==-1?vc:vc=tt()}function To(d){return(d.mode&1)===0?1:(fs&2)!==0&&In!==0?In&-In:ZM.transition!==null?(bc===0&&(bc=W()),bc):(d=ie,d!==0||(d=window.event,d=d===void 0?16:bu(d.type)),d)}function nr(d,c,m,E){if(50<Zu)throw Zu=0,bm=null,Error(s(185));bt(d,m,E),((fs&2)===0||d!==Tn)&&(d===Tn&&((fs&2)===0&&(mc|=m),vn===4&&Co(d,In)),fi(d,E),m===1&&fs===0&&(c.mode&1)===0&&(Al=tt()+500,Xh&&vo()))}function fi(d,c){var m=d.callbackNode;R(d,c);var E=re(d,d===Tn?In:0);if(E===0)m!==null&&Y(m),d.callbackNode=null,d.callbackPriority=0;else if(c=E&-E,d.callbackPriority!==c){if(m!=null&&Y(m),c===1)d.tag===0?XM(Mb.bind(null,d)):mv(Mb.bind(null,d)),$M(function(){(fs&6)===0&&vo()}),m=null;else{switch(Ee(E)){case 1:m=_t;break;case 4:m=it;break;case 16:m=vt;break;case 536870912:m=Ft;break;default:m=vt}m=Bb(m,Nb.bind(null,d))}d.callbackPriority=c,d.callbackNode=m}}function Nb(d,c){if(vc=-1,bc=0,(fs&6)!==0)throw Error(s(327));var m=d.callbackNode;if(wl()&&d.callbackNode!==m)return null;var E=re(d,d===Tn?In:0);if(E===0)return null;if((E&30)!==0||(E&d.expiredLanes)!==0||c)c=Ec(d,E);else{c=E;var T=fs;fs|=2;var M=Rb();(Tn!==d||In!==c)&&(jr=null,Al=tt()+500,xa(d,c));do try{mI();break}catch(rt){Ib(d,rt)}while(!0);Bp(),pc.current=M,fs=T,pn!==null?c=0:(Tn=null,In=0,c=vn)}if(c!==0){if(c===2&&(T=U(d),T!==0&&(E=T,c=Em(d,T))),c===1)throw m=Wu,xa(d,0),Co(d,E),fi(d,tt()),m;if(c===6)Co(d,E);else{if(T=d.current.alternate,(E&30)===0&&!fI(T)&&(c=Ec(d,E),c===2&&(M=U(d),M!==0&&(E=M,c=Em(d,M))),c===1))throw m=Wu,xa(d,0),Co(d,E),fi(d,tt()),m;switch(d.finishedWork=T,d.finishedLanes=E,c){case 0:case 1:throw Error(s(345));case 2:va(d,gi,jr);break;case 3:if(Co(d,E),(E&130023424)===E&&(c=xm+500-tt(),10<c)){if(re(d,0)!==0)break;if(T=d.suspendedLanes,(T&E)!==E){Jn(),d.pingedLanes|=d.suspendedLanes&T;break}d.timeoutHandle=Lp(va.bind(null,d,gi,jr),c);break}va(d,gi,jr);break;case 4:if(Co(d,E),(E&4194240)===E)break;for(c=d.eventTimes,T=-1;0<E;){var G=31-$t(E);M=1<<G,G=c[G],G>T&&(T=G),E&=~M}if(E=T,E=tt()-E,E=(120>E?120:480>E?480:1080>E?1080:1920>E?1920:3e3>E?3e3:4320>E?4320:1960*gI(E/1960))-E,10<E){d.timeoutHandle=Lp(va.bind(null,d,gi,jr),E);break}va(d,gi,jr);break;case 5:va(d,gi,jr);break;default:throw Error(s(329))}}}return fi(d,tt()),d.callbackNode===m?Nb.bind(null,d):null}function Em(d,c){var m=Xu;return d.current.memoizedState.isDehydrated&&(xa(d,c).flags|=256),d=Ec(d,c),d!==2&&(c=gi,gi=m,c!==null&&Sm(c)),d}function Sm(d){gi===null?gi=d:gi.push.apply(gi,d)}function fI(d){for(var c=d;;){if(c.flags&16384){var m=c.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var E=0;E<m.length;E++){var T=m[E],M=T.getSnapshot;T=T.value;try{if(!Qi(M(),T))return!1}catch{return!1}}}if(m=c.child,c.subtreeFlags&16384&&m!==null)m.return=c,c=m;else{if(c===d)break;for(;c.sibling===null;){if(c.return===null||c.return===d)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Co(d,c){for(c&=~ym,c&=~mc,d.suspendedLanes|=c,d.pingedLanes&=~c,d=d.expirationTimes;0<c;){var m=31-$t(c),E=1<<m;d[m]=-1,c&=~E}}function Mb(d){if((fs&6)!==0)throw Error(s(327));wl();var c=re(d,0);if((c&1)===0)return fi(d,tt()),null;var m=Ec(d,c);if(d.tag!==0&&m===2){var E=U(d);E!==0&&(c=E,m=Em(d,E))}if(m===1)throw m=Wu,xa(d,0),Co(d,c),fi(d,tt()),m;if(m===6)throw Error(s(345));return d.finishedWork=d.current.alternate,d.finishedLanes=c,va(d,gi,jr),fi(d,tt()),null}function Am(d,c){var m=fs;fs|=1;try{return d(c)}finally{fs=m,fs===0&&(Al=tt()+500,Xh&&vo())}}function ya(d){wo!==null&&wo.tag===0&&(fs&6)===0&&wl();var c=fs;fs|=1;var m=Di.transition,E=ie;try{if(Di.transition=null,ie=1,d)return d()}finally{ie=E,Di.transition=m,fs=c,(fs&6)===0&&vo()}}function wm(){Ai=Sl.current,Bs(Sl)}function xa(d,c){d.finishedWork=null,d.finishedLanes=0;var m=d.timeoutHandle;if(m!==-1&&(d.timeoutHandle=-1,HM(m)),pn!==null)for(m=pn.return;m!==null;){var E=m;switch(Fp(E),E.tag){case 1:E=E.type.childContextTypes,E!=null&&Yh();break;case 3:vl(),Bs(di),Bs(Dn),Yp();break;case 5:$p(E);break;case 4:vl();break;case 13:Bs(Ks);break;case 19:Bs(Ks);break;case 10:Up(E.type._context);break;case 22:case 23:wm()}m=m.return}if(Tn=d,pn=d=Lo(d.current,null),In=Ai=c,vn=0,Wu=null,ym=mc=_a=0,gi=Xu=null,fa!==null){for(c=0;c<fa.length;c++)if(m=fa[c],E=m.interleaved,E!==null){m.interleaved=null;var T=E.next,M=m.pending;if(M!==null){var G=M.next;M.next=T,E.next=G}m.pending=E}fa=null}return d}function Ib(d,c){do{var m=pn;try{if(Bp(),rc.current=uc,oc){for(var E=Qs.memoizedState;E!==null;){var T=E.queue;T!==null&&(T.pending=null),E=E.next}oc=!1}if(ma=0,wn=xn=Qs=null,Vu=!1,ju=0,_m.current=null,m===null||m.return===null){vn=1,Wu=c,pn=null;break}t:{var M=d,G=m.return,rt=m,xt=c;if(c=In,rt.flags|=32768,xt!==null&&typeof xt=="object"&&typeof xt.then=="function"){var Vt=xt,de=rt,fe=de.tag;if((de.mode&1)===0&&(fe===0||fe===11||fe===15)){var le=de.alternate;le?(de.updateQueue=le.updateQueue,de.memoizedState=le.memoizedState,de.lanes=le.lanes):(de.updateQueue=null,de.memoizedState=null)}var Ae=nb(G);if(Ae!==null){Ae.flags&=-257,ib(Ae,G,rt,M,c),Ae.mode&1&&sb(M,Vt,c),c=Ae,xt=Vt;var ke=c.updateQueue;if(ke===null){var Me=new Set;Me.add(xt),c.updateQueue=Me}else ke.add(xt);break t}else{if((c&1)===0){sb(M,Vt,c),Tm();break t}xt=Error(s(426))}}else if($s&&rt.mode&1){var un=nb(G);if(un!==null){(un.flags&65536)===0&&(un.flags|=256),ib(un,G,rt,M,c),Dp(bl(xt,rt));break t}}M=xt=bl(xt,rt),vn!==4&&(vn=2),Xu===null?Xu=[M]:Xu.push(M),M=G;do{switch(M.tag){case 3:M.flags|=65536,c&=-c,M.lanes|=c;var Mt=tb(M,xt,c);Cv(M,Mt);break t;case 1:rt=xt;var wt=M.type,Dt=M.stateNode;if((M.flags&128)===0&&(typeof wt.getDerivedStateFromError=="function"||Dt!==null&&typeof Dt.componentDidCatch=="function"&&(Ao===null||!Ao.has(Dt)))){M.flags|=65536,c&=-c,M.lanes|=c;var ye=eb(M,rt,c);Cv(M,ye);break t}}M=M.return}while(M!==null)}Pb(m)}catch(Re){c=Re,pn===m&&m!==null&&(pn=m=m.return);continue}break}while(!0)}function Rb(){var d=pc.current;return pc.current=uc,d===null?uc:d}function Tm(){(vn===0||vn===3||vn===2)&&(vn=4),Tn===null||(_a&268435455)===0&&(mc&268435455)===0||Co(Tn,In)}function Ec(d,c){var m=fs;fs|=2;var E=Rb();(Tn!==d||In!==c)&&(jr=null,xa(d,c));do try{pI();break}catch(T){Ib(d,T)}while(!0);if(Bp(),fs=m,pc.current=E,pn!==null)throw Error(s(261));return Tn=null,In=0,vn}function pI(){for(;pn!==null;)Fb(pn)}function mI(){for(;pn!==null&&!et();)Fb(pn)}function Fb(d){var c=Ob(d.alternate,d,Ai);d.memoizedProps=d.pendingProps,c===null?Pb(d):pn=c,_m.current=null}function Pb(d){var c=d;do{var m=c.alternate;if(d=c.return,(c.flags&32768)===0){if(m=lI(m,c,Ai),m!==null){pn=m;return}}else{if(m=uI(m,c),m!==null){m.flags&=32767,pn=m;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{vn=6,pn=null;return}}if(c=c.sibling,c!==null){pn=c;return}pn=c=d}while(c!==null);vn===0&&(vn=5)}function va(d,c,m){var E=ie,T=Di.transition;try{Di.transition=null,ie=1,_I(d,c,m,E)}finally{Di.transition=T,ie=E}return null}function _I(d,c,m,E){do wl();while(wo!==null);if((fs&6)!==0)throw Error(s(327));m=d.finishedWork;var T=d.finishedLanes;if(m===null)return null;if(d.finishedWork=null,d.finishedLanes=0,m===d.current)throw Error(s(177));d.callbackNode=null,d.callbackPriority=0;var M=m.lanes|m.childLanes;if(It(d,M),d===Tn&&(pn=Tn=null,In=0),(m.subtreeFlags&2064)===0&&(m.flags&2064)===0||yc||(yc=!0,Bb(vt,function(){return wl(),null})),M=(m.flags&15990)!==0,(m.subtreeFlags&15990)!==0||M){M=Di.transition,Di.transition=null;var G=ie;ie=1;var rt=fs;fs|=4,_m.current=null,hI(d,m),wb(m,d),DM(Tp),bi=!!wp,Tp=wp=null,d.current=m,cI(m),J(),fs=rt,ie=G,Di.transition=M}else d.current=m;if(yc&&(yc=!1,wo=d,xc=T),M=d.pendingLanes,M===0&&(Ao=null),Yt(m.stateNode),fi(d,tt()),c!==null)for(E=d.onRecoverableError,m=0;m<c.length;m++)T=c[m],E(T.value,{componentStack:T.stack,digest:T.digest});if(_c)throw _c=!1,d=vm,vm=null,d;return(xc&1)!==0&&d.tag!==0&&wl(),M=d.pendingLanes,(M&1)!==0?d===bm?Zu++:(Zu=0,bm=d):Zu=0,vo(),null}function wl(){if(wo!==null){var d=Ee(xc),c=Di.transition,m=ie;try{if(Di.transition=null,ie=16>d?16:d,wo===null)var E=!1;else{if(d=wo,wo=null,xc=0,(fs&6)!==0)throw Error(s(331));var T=fs;for(fs|=4,Le=d.current;Le!==null;){var M=Le,G=M.child;if((Le.flags&16)!==0){var rt=M.deletions;if(rt!==null){for(var xt=0;xt<rt.length;xt++){var Vt=rt[xt];for(Le=Vt;Le!==null;){var de=Le;switch(de.tag){case 0:case 11:case 15:Yu(8,de,M)}var fe=de.child;if(fe!==null)fe.return=de,Le=fe;else for(;Le!==null;){de=Le;var le=de.sibling,Ae=de.return;if(vb(de),de===Vt){Le=null;break}if(le!==null){le.return=Ae,Le=le;break}Le=Ae}}}var ke=M.alternate;if(ke!==null){var Me=ke.child;if(Me!==null){ke.child=null;do{var un=Me.sibling;Me.sibling=null,Me=un}while(Me!==null)}}Le=M}}if((M.subtreeFlags&2064)!==0&&G!==null)G.return=M,Le=G;else t:for(;Le!==null;){if(M=Le,(M.flags&2048)!==0)switch(M.tag){case 0:case 11:case 15:Yu(9,M,M.return)}var Mt=M.sibling;if(Mt!==null){Mt.return=M.return,Le=Mt;break t}Le=M.return}}var wt=d.current;for(Le=wt;Le!==null;){G=Le;var Dt=G.child;if((G.subtreeFlags&2064)!==0&&Dt!==null)Dt.return=G,Le=Dt;else t:for(G=wt;Le!==null;){if(rt=Le,(rt.flags&2048)!==0)try{switch(rt.tag){case 0:case 11:case 15:fc(9,rt)}}catch(Re){en(rt,rt.return,Re)}if(rt===G){Le=null;break t}var ye=rt.sibling;if(ye!==null){ye.return=rt.return,Le=ye;break t}Le=rt.return}}if(fs=T,vo(),Lt&&typeof Lt.onPostCommitFiberRoot=="function")try{Lt.onPostCommitFiberRoot(Pt,d)}catch{}E=!0}return E}finally{ie=m,Di.transition=c}}return!1}function zb(d,c,m){c=bl(m,c),c=tb(d,c,1),d=Eo(d,c,1),c=Jn(),d!==null&&(bt(d,1,c),fi(d,c))}function en(d,c,m){if(d.tag===3)zb(d,d,m);else for(;c!==null;){if(c.tag===3){zb(c,d,m);break}else if(c.tag===1){var E=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(Ao===null||!Ao.has(E))){d=bl(m,d),d=eb(c,d,1),c=Eo(c,d,1),d=Jn(),c!==null&&(bt(c,1,d),fi(c,d));break}}c=c.return}}function yI(d,c,m){var E=d.pingCache;E!==null&&E.delete(c),c=Jn(),d.pingedLanes|=d.suspendedLanes&m,Tn===d&&(In&m)===m&&(vn===4||vn===3&&(In&130023424)===In&&500>tt()-xm?xa(d,0):ym|=m),fi(d,c)}function Db(d,c){c===0&&((d.mode&1)===0?c=1:(c=ee,ee<<=1,(ee&130023424)===0&&(ee=4194304)));var m=Jn();d=Ur(d,c),d!==null&&(bt(d,c,m),fi(d,m))}function xI(d){var c=d.memoizedState,m=0;c!==null&&(m=c.retryLane),Db(d,m)}function vI(d,c){var m=0;switch(d.tag){case 13:var E=d.stateNode,T=d.memoizedState;T!==null&&(m=T.retryLane);break;case 19:E=d.stateNode;break;default:throw Error(s(314))}E!==null&&E.delete(c),Db(d,m)}var Ob;Ob=function(d,c,m){if(d!==null)if(d.memoizedProps!==c.pendingProps||di.current)ci=!0;else{if((d.lanes&m)===0&&(c.flags&128)===0)return ci=!1,aI(d,c,m);ci=(d.flags&131072)!==0}else ci=!1,$s&&(c.flags&1048576)!==0&&_v(c,Kh,c.index);switch(c.lanes=0,c.tag){case 2:var E=c.type;cc(d,c),d=c.pendingProps;var T=gl(c,Dn.current);xl(c,m),T=Zp(null,c,E,d,T,m);var M=Kp();return c.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,hi(E)?(M=!0,Wh(c)):M=!1,c.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,jp(c),T.updater=dc,c.stateNode=T,T._reactInternals=c,nm(c,E,d,m),c=am(null,c,E,!0,M,m)):(c.tag=0,$s&&M&&Rp(c),Qn(null,c,T,m),c=c.child),c;case 16:E=c.elementType;t:{switch(cc(d,c),d=c.pendingProps,T=E._init,E=T(E._payload),c.type=E,T=c.tag=EI(E),d=tr(E,d),T){case 0:c=om(null,c,E,d,m);break t;case 1:c=db(null,c,E,d,m);break t;case 11:c=rb(null,c,E,d,m);break t;case 14:c=ob(null,c,E,tr(E.type,d),m);break t}throw Error(s(306,E,""))}return c;case 0:return E=c.type,T=c.pendingProps,T=c.elementType===E?T:tr(E,T),om(d,c,E,T,m);case 1:return E=c.type,T=c.pendingProps,T=c.elementType===E?T:tr(E,T),db(d,c,E,T,m);case 3:t:{if(hb(c),d===null)throw Error(s(387));E=c.pendingProps,M=c.memoizedState,T=M.element,Tv(d,c),nc(c,E,null,m);var G=c.memoizedState;if(E=G.element,M.isDehydrated)if(M={element:E,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},c.updateQueue.baseState=M,c.memoizedState=M,c.flags&256){T=bl(Error(s(423)),c),c=cb(d,c,E,m,T);break t}else if(E!==T){T=bl(Error(s(424)),c),c=cb(d,c,E,m,T);break t}else for(Si=_o(c.stateNode.containerInfo.firstChild),Ei=c,$s=!0,Ji=null,m=Av(c,null,E,m),c.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(ml(),E===T){c=Vr(d,c,m);break t}Qn(d,c,E,m)}c=c.child}return c;case 5:return kv(c),d===null&&zp(c),E=c.type,T=c.pendingProps,M=d!==null?d.memoizedProps:null,G=T.children,Cp(E,T)?G=null:M!==null&&Cp(E,M)&&(c.flags|=32),ub(d,c),Qn(d,c,G,m),c.child;case 6:return d===null&&zp(c),null;case 13:return gb(d,c,m);case 4:return Hp(c,c.stateNode.containerInfo),E=c.pendingProps,d===null?c.child=_l(c,null,E,m):Qn(d,c,E,m),c.child;case 11:return E=c.type,T=c.pendingProps,T=c.elementType===E?T:tr(E,T),rb(d,c,E,T,m);case 7:return Qn(d,c,c.pendingProps,m),c.child;case 8:return Qn(d,c,c.pendingProps.children,m),c.child;case 12:return Qn(d,c,c.pendingProps.children,m),c.child;case 10:t:{if(E=c.type._context,T=c.pendingProps,M=c.memoizedProps,G=T.value,Ms(tc,E._currentValue),E._currentValue=G,M!==null)if(Qi(M.value,G)){if(M.children===T.children&&!di.current){c=Vr(d,c,m);break t}}else for(M=c.child,M!==null&&(M.return=c);M!==null;){var rt=M.dependencies;if(rt!==null){G=M.child;for(var xt=rt.firstContext;xt!==null;){if(xt.context===E){if(M.tag===1){xt=Gr(-1,m&-m),xt.tag=2;var Vt=M.updateQueue;if(Vt!==null){Vt=Vt.shared;var de=Vt.pending;de===null?xt.next=xt:(xt.next=de.next,de.next=xt),Vt.pending=xt}}M.lanes|=m,xt=M.alternate,xt!==null&&(xt.lanes|=m),Gp(M.return,m,c),rt.lanes|=m;break}xt=xt.next}}else if(M.tag===10)G=M.type===c.type?null:M.child;else if(M.tag===18){if(G=M.return,G===null)throw Error(s(341));G.lanes|=m,rt=G.alternate,rt!==null&&(rt.lanes|=m),Gp(G,m,c),G=M.sibling}else G=M.child;if(G!==null)G.return=M;else for(G=M;G!==null;){if(G===c){G=null;break}if(M=G.sibling,M!==null){M.return=G.return,G=M;break}G=G.return}M=G}Qn(d,c,T.children,m),c=c.child}return c;case 9:return T=c.type,E=c.pendingProps.children,xl(c,m),T=Pi(T),E=E(T),c.flags|=1,Qn(d,c,E,m),c.child;case 14:return E=c.type,T=tr(E,c.pendingProps),T=tr(E.type,T),ob(d,c,E,T,m);case 15:return ab(d,c,c.type,c.pendingProps,m);case 17:return E=c.type,T=c.pendingProps,T=c.elementType===E?T:tr(E,T),cc(d,c),c.tag=1,hi(E)?(d=!0,Wh(c)):d=!1,xl(c,m),Qv(c,E,T),nm(c,E,T,m),am(null,c,E,!0,d,m);case 19:return pb(d,c,m);case 22:return lb(d,c,m)}throw Error(s(156,c.tag))};function Bb(d,c){return cs(d,c)}function bI(d,c,m,E){this.tag=d,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oi(d,c,m,E){return new bI(d,c,m,E)}function Cm(d){return d=d.prototype,!(!d||!d.isReactComponent)}function EI(d){if(typeof d=="function")return Cm(d)?1:0;if(d!=null){if(d=d.$$typeof,d===Z)return 11;if(d===K)return 14}return 2}function Lo(d,c){var m=d.alternate;return m===null?(m=Oi(d.tag,c,d.key,d.mode),m.elementType=d.elementType,m.type=d.type,m.stateNode=d.stateNode,m.alternate=d,d.alternate=m):(m.pendingProps=c,m.type=d.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=d.flags&14680064,m.childLanes=d.childLanes,m.lanes=d.lanes,m.child=d.child,m.memoizedProps=d.memoizedProps,m.memoizedState=d.memoizedState,m.updateQueue=d.updateQueue,c=d.dependencies,m.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},m.sibling=d.sibling,m.index=d.index,m.ref=d.ref,m}function Sc(d,c,m,E,T,M){var G=2;if(E=d,typeof d=="function")Cm(d)&&(G=1);else if(typeof d=="string")G=5;else t:switch(d){case I:return ba(m.children,T,M,c);case F:G=8,T|=8;break;case O:return d=Oi(12,m,c,T|2),d.elementType=O,d.lanes=M,d;case at:return d=Oi(13,m,c,T),d.elementType=at,d.lanes=M,d;case pt:return d=Oi(19,m,c,T),d.elementType=pt,d.lanes=M,d;case ht:return Ac(m,T,M,c);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case V:G=10;break t;case j:G=9;break t;case Z:G=11;break t;case K:G=14;break t;case ut:G=16,E=null;break t}throw Error(s(130,d==null?d:typeof d,""))}return c=Oi(G,m,c,T),c.elementType=d,c.type=E,c.lanes=M,c}function ba(d,c,m,E){return d=Oi(7,d,E,c),d.lanes=m,d}function Ac(d,c,m,E){return d=Oi(22,d,E,c),d.elementType=ht,d.lanes=m,d.stateNode={isHidden:!1},d}function Lm(d,c,m){return d=Oi(6,d,null,c),d.lanes=m,d}function km(d,c,m){return c=Oi(4,d.children!==null?d.children:[],d.key,c),c.lanes=m,c.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},c}function SI(d,c,m,E,T){this.tag=c,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=St(0),this.expirationTimes=St(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=St(0),this.identifierPrefix=E,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function Nm(d,c,m,E,T,M,G,rt,xt){return d=new SI(d,c,m,rt,xt),c===1?(c=1,M===!0&&(c|=8)):c=0,M=Oi(3,null,null,c),d.current=M,M.stateNode=d,M.memoizedState={element:E,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},jp(M),d}function AI(d,c,m){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:E==null?null:""+E,children:d,containerInfo:c,implementation:m}}function Ub(d){if(!d)return xo;d=d._reactInternals;t:{if(je(d)!==d||d.tag!==1)throw Error(s(170));var c=d;do{switch(c.tag){case 3:c=c.stateNode.context;break t;case 1:if(hi(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break t}}c=c.return}while(c!==null);throw Error(s(171))}if(d.tag===1){var m=d.type;if(hi(m))return fv(d,m,c)}return c}function Gb(d,c,m,E,T,M,G,rt,xt){return d=Nm(m,E,!0,d,T,M,G,rt,xt),d.context=Ub(null),m=d.current,E=Jn(),T=To(m),M=Gr(E,T),M.callback=c??null,Eo(m,M,T),d.current.lanes=T,bt(d,T,E),fi(d,E),d}function wc(d,c,m,E){var T=c.current,M=Jn(),G=To(T);return m=Ub(m),c.context===null?c.context=m:c.pendingContext=m,c=Gr(M,G),c.payload={element:d},E=E===void 0?null:E,E!==null&&(c.callback=E),d=Eo(T,c,G),d!==null&&(nr(d,T,G,M),sc(d,T,G)),G}function Tc(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function Vb(d,c){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var m=d.retryLane;d.retryLane=m!==0&&m<c?m:c}}function Mm(d,c){Vb(d,c),(d=d.alternate)&&Vb(d,c)}function wI(){return null}var jb=typeof reportError=="function"?reportError:function(d){console.error(d)};function Im(d){this._internalRoot=d}Cc.prototype.render=Im.prototype.render=function(d){var c=this._internalRoot;if(c===null)throw Error(s(409));wc(d,c,null,null)},Cc.prototype.unmount=Im.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var c=d.containerInfo;ya(function(){wc(null,d,null,null)}),c[zr]=null}};function Cc(d){this._internalRoot=d}Cc.prototype.unstable_scheduleHydration=function(d){if(d){var c=ms();d={blockedOn:null,target:d,priority:c};for(var m=0;m<tn.length&&c!==0&&c<tn[m].priority;m++);tn.splice(m,0,d),m===0&&kn(d)}};function Rm(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function Lc(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function Hb(){}function TI(d,c,m,E,T){if(T){if(typeof E=="function"){var M=E;E=function(){var Vt=Tc(G);M.call(Vt)}}var G=Gb(c,E,d,0,null,!1,!1,"",Hb);return d._reactRootContainer=G,d[zr]=G.current,Fu(d.nodeType===8?d.parentNode:d),ya(),G}for(;T=d.lastChild;)d.removeChild(T);if(typeof E=="function"){var rt=E;E=function(){var Vt=Tc(xt);rt.call(Vt)}}var xt=Nm(d,0,!1,null,null,!1,!1,"",Hb);return d._reactRootContainer=xt,d[zr]=xt.current,Fu(d.nodeType===8?d.parentNode:d),ya(function(){wc(c,xt,m,E)}),xt}function kc(d,c,m,E,T){var M=m._reactRootContainer;if(M){var G=M;if(typeof T=="function"){var rt=T;T=function(){var xt=Tc(G);rt.call(xt)}}wc(c,G,d,T)}else G=TI(m,c,d,T,E);return Tc(G)}we=function(d){switch(d.tag){case 3:var c=d.stateNode;if(c.current.memoizedState.isDehydrated){var m=oe(c.pendingLanes);m!==0&&(Qt(c,m|1),fi(c,tt()),(fs&6)===0&&(Al=tt()+500,vo()))}break;case 13:ya(function(){var E=Ur(d,1);if(E!==null){var T=Jn();nr(E,d,1,T)}}),Mm(d,1)}},We=function(d){if(d.tag===13){var c=Ur(d,134217728);if(c!==null){var m=Jn();nr(c,d,134217728,m)}Mm(d,134217728)}},us=function(d){if(d.tag===13){var c=To(d),m=Ur(d,c);if(m!==null){var E=Jn();nr(m,d,c,E)}Mm(d,c)}},ms=function(){return ie},ds=function(d,c){var m=ie;try{return ie=d,c()}finally{ie=m}},B=function(d,c,m){switch(c){case"input":if(is(d,m),c=m.name,m.type==="radio"&&c!=null){for(m=d;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<m.length;c++){var E=m[c];if(E!==d&&E.form===d.form){var T=qh(E);if(!T)throw Error(s(90));Ce(E),is(E,T)}}}break;case"textarea":hs(d,m);break;case"select":c=m.value,c!=null&&Je(d,!!m.multiple,c,!1)}},ct=Am,mt=ya;var CI={usingClientEntryPoint:!1,Events:[Du,hl,qh,lt,dt,Am]},Ku={findFiberByHostInstance:da,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},LI={bundleType:Ku.bundleType,version:Ku.version,rendererPackageName:Ku.rendererPackageName,rendererConfig:Ku.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=es(d),d===null?null:d.stateNode},findFiberByHostInstance:Ku.findFiberByHostInstance||wI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nc.isDisabled&&Nc.supportsFiber)try{Pt=Nc.inject(LI),Lt=Nc}catch{}}return pi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CI,pi.createPortal=function(d,c){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Rm(c))throw Error(s(200));return AI(d,c,null,m)},pi.createRoot=function(d,c){if(!Rm(d))throw Error(s(299));var m=!1,E="",T=jb;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(E=c.identifierPrefix),c.onRecoverableError!==void 0&&(T=c.onRecoverableError)),c=Nm(d,1,!1,null,null,m,!1,E,T),d[zr]=c.current,Fu(d.nodeType===8?d.parentNode:d),new Im(c)},pi.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var c=d._reactInternals;if(c===void 0)throw typeof d.render=="function"?Error(s(188)):(d=Object.keys(d).join(","),Error(s(268,d)));return d=es(c),d=d===null?null:d.stateNode,d},pi.flushSync=function(d){return ya(d)},pi.hydrate=function(d,c,m){if(!Lc(c))throw Error(s(200));return kc(null,d,c,!0,m)},pi.hydrateRoot=function(d,c,m){if(!Rm(d))throw Error(s(405));var E=m!=null&&m.hydratedSources||null,T=!1,M="",G=jb;if(m!=null&&(m.unstable_strictMode===!0&&(T=!0),m.identifierPrefix!==void 0&&(M=m.identifierPrefix),m.onRecoverableError!==void 0&&(G=m.onRecoverableError)),c=Gb(c,null,d,1,m??null,T,!1,M,G),d[zr]=c.current,Fu(d),E)for(d=0;d<E.length;d++)m=E[d],T=m._getVersion,T=T(m._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[m,T]:c.mutableSourceEagerHydrationData.push(m,T);return new Cc(c)},pi.render=function(d,c,m){if(!Lc(c))throw Error(s(200));return kc(null,d,c,!1,m)},pi.unmountComponentAtNode=function(d){if(!Lc(d))throw Error(s(40));return d._reactRootContainer?(ya(function(){kc(null,null,d,!1,function(){d._reactRootContainer=null,d[zr]=null})}),!0):!1},pi.unstable_batchedUpdates=Am,pi.unstable_renderSubtreeIntoContainer=function(d,c,m,E){if(!Lc(m))throw Error(s(200));if(d==null||d._reactInternals===void 0)throw Error(s(38));return kc(d,c,m,!1,E)},pi.version="18.3.1-next-f1338f8080-20240426",pi}var Qb;function sT(){if(Qb)return zm.exports;Qb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),zm.exports=BI(),zm.exports}var Jb;function UI(){if(Jb)return Mc;Jb=1;var t=sT();return Mc.createRoot=t.createRoot,Mc.hydrateRoot=t.hydrateRoot,Mc}var GI=UI(),VI=Object.create,Cx=Object.defineProperty,jI=Object.getOwnPropertyDescriptor,nT=Object.getOwnPropertyNames,HI=Object.getPrototypeOf,$I=Object.prototype.hasOwnProperty,qI=(t,e)=>function(){return e||(0,t[nT(t)[0]])((e={exports:{}}).exports,e),e.exports},mh=(t,e)=>{for(var s in e)Cx(t,s,{get:e[s],enumerable:!0})},YI=(t,e,s,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of nT(e))$I.call(t,i)||i===s||Cx(t,i,{get:()=>e[i],enumerable:!(n=jI(e,i))||n.enumerable});return t},iT=(t,e,s)=>(s=t!=null?VI(HI(t)):{},YI(t&&t.__esModule?s:Cx(s,"default",{value:t,enumerable:!0}),t)),rT=qI({"node_modules/@linkurious/spatial-index/dist/esm/index.js"(t,e){/**
     * @linkurious/spatial-index v0.5.8
     * Ogma spatial index data structures
     *
     * @author Alexander Milevski
     * @license ISC
     * @preserve
     */var s,n;s=t,n=function(i){function r(gt,N,P,D,B){const $=Math.abs(P-gt),H=gt<P?1:-1,X=-Math.abs(D-N),lt=N<D?1:-1;let dt,ct=$+X;for(;;){if(B(gt,N),dt=2*ct,dt>=X){if(gt===P)break;ct+=X,gt+=H}if(dt<=$){if(N===D)break;ct+=$,N+=lt}}}function o(gt,N="assert error"){if(!gt)throw new Error(N)}function a(gt,N,P,D,B,$,H){var X,lt,dt,ct,mt,yt=B-P,kt=$-D,Tt=gt-P,At=N-D,Ut=Tt*kt-At*yt;if(yt*yt+kt*kt>Tt*Tt+At*At&&(B=gt,gt=yt+P,$=N,N=kt+D,Ut=-Ut),Ut!=0){Tt+=yt,At+=kt,X=2*(Tt*=yt=gt<B?1:-1)*(At*=kt=N<$?1:-1),Tt*=Tt,At*=At,Ut*yt*kt<0&&(Tt=-Tt,At=-At,X=-X,Ut=-Ut),lt=4*kt*(P-gt)*Ut+Tt-X,dt=4*yt*(N-D)*Ut+At-X,Tt+=Tt,At+=At,ct=lt+dt+X;do{if(Ut=Math.min(lt+X,-X-dt),mt=Math.max(lt+X,-X-dt),mt+=2*mt*Ut*Ut/(4*mt*mt+Ut*Ut),H(gt,N,255*Math.abs(ct-lt-dt-X)/mt),gt==B||N==$)break;P=gt,Ut=lt-ct,D=+(2*ct+dt<0),2*ct+lt>0&&(ct-dt<mt&&H(gt,N+kt,255*Math.abs(ct-dt)/mt),gt+=yt,lt-=X,ct+=dt+=At),D&&(Ut<mt&&H(P+yt,N,255*Math.abs(Ut)/mt),N+=kt,dt-=X,ct+=lt+=Tt)}while(dt<lt)}(function(xe,be,ue,_e,Te){const Ve=xe<ue?1:-1,Ie=be<_e?1:-1;let je,Pe=Math.abs(ue-xe),Be=Math.abs(_e-be),Ue=Pe*Pe+Be*Be,es=Ue===0?1:1/Math.sqrt(Ue);for(Pe*=es,Be*=es,Ue=Pe-Be;;){if(Te(xe,be,Math.abs(Ue-(Pe+Be))>>16),es=Ue,je=xe,2*es>=-Pe){if(xe===ue)break;es+Be<16711680&&Te(xe,be+Ie,es+Be>>16),Ue-=Be,xe+=Ve}if(2*es<=Be){if(be===_e)break;Pe-es<16711680&&Te(je+Ve,be,Pe-es>>16),Ue+=Pe,be+=Ie}}})(gt,N,B,$,H)}function l(gt,N,P,D,B,$,H,X,lt){var dt,ct,mt,yt=1;let kt,Tt,At,Ut,he,xe,be,ue,_e,Te,Ve,Ie=gt<H?1:-1,je=N<X?1:-1,Pe=-Math.abs(gt+P-B-H),Be=Pe-4*Ie*(P-B),Ue=Ie*(gt-P-B+H),es=-Math.abs(N+D-$-X),os=es-4*je*(D-$),cs=je*(N-D-$+X),Y=.01;if(o((P-gt)*(B-H)<Y&&((H-gt)*(P-B)<Y||Ue*Ue<Be*Pe+Y),"slope change"),o((D-N)*($-X)<Y&&((X-N)*(D-$)<Y||cs*cs<os*es+Y),"slope change"),Be==0&&os==0)return Ie=Math.floor((3*P-gt+1)/2),je=Math.floor((3*D-N+1)/2),(function(J,tt,ft,_t,it,vt,Ct){var Ft,Pt,Lt,Yt,$t=it-ft,Bt=vt-_t,Gt=J-ft,qt=tt-_t,Kt=Gt*Bt-qt*$t;if(o(Gt*$t<=0&&qt*Bt<=0,"sign of gradient must not change"),$t*$t+Bt*Bt>Gt*Gt+qt*qt&&(it=J,J=$t+ft,vt=tt,tt=Bt+_t,Kt=-Kt),Kt!=0){Gt+=$t,qt+=Bt,Ft=2*(Gt*=$t=J<it?1:-1)*(qt*=Bt=tt<vt?1:-1),Gt*=Gt,qt*=qt,Kt*$t*Bt<0&&(Gt=-Gt,qt=-qt,Ft=-Ft,Kt=-Kt),Pt=4*Bt*Kt*(ft-J)+Gt-Ft,Lt=4*$t*Kt*(tt-_t)+qt-Ft,Gt+=Gt,qt+=qt,Yt=Pt+Lt+Ft;do{if(Ct(J,tt),J==it&&tt==vt)return;_t=+(2*Yt<Pt),2*Yt>Lt&&(J+=$t,Pt-=Ft,Yt+=Lt+=qt),_t&&(tt+=Bt,Lt-=Ft,Yt+=Pt+=Gt)}while(Lt<0&&Pt>0)}r(J,tt,it,vt,Ct)})(gt,N,Ie,je,H,X,lt);P=(P-gt)*(P-gt)+(D-N)*(D-N)+1,B=(B-H)*(B-H)+($-X)*($-X)+1;do{kt=Be*cs-Ue*os,Tt=Be*es-Pe*os,At=Ue*es-Pe*cs,Te=kt*(kt+Tt-3*At)+Tt*Tt,kt*=dt=Te>0?1:Math.sqrt(1+1024/P),Tt*=dt,At*=dt,Te*=dt*dt,xe=9*(kt+Tt+At)/8,Ut=8*(Be-os),ue=27*(8*kt*(cs*cs-os*es)+Te*(os+2*cs+es))/64-os*os*(xe-os),_e=27*(8*kt*(Ue*Ue-Be*Pe)-Te*(Be+2*Ue+Pe))/64-Be*Be*(xe+Be),he=3*(3*kt*(3*cs*cs-os*os-2*os*es)-os*(3*Tt*(os+cs)+os*Ut))/4,be=3*(3*kt*(3*Ue*Ue-Be*Be-2*Be*Pe)-Be*(3*Tt*(Be+Ue)+Be*Ut))/4,xe=Be*os*(6*kt+6*Tt-3*At+Ut),Tt=os*os,Ut=Be*Be,xe=3*(xe+9*dt*(Ut*cs*es-Ue*Pe*Tt)-18*Ue*cs*kt)/8,Te<0&&(ue=-ue,_e=-_e,he=-he,be=-be,xe=-xe,Tt=-Tt,Ut=-Ut),kt=6*os*Tt,Tt*=-6*Be,At=6*os*Ut,Ut*=-6*Be,ue+=xe,Te=ue+_e,_e+=xe;t:for(Ve=xe,ct=mt=dt;gt!=H&&N!=X;){lt(gt,N);do{if(ue>Ve||_e<Ve)break t;D=2*Te-_e,2*Te>=ue&&(ct--,Te+=ue+=he,_e+=xe+=Tt,be+=At,he+=kt),D<=0&&(mt--,Te+=_e+=be,ue+=xe+=At,he+=Tt,be+=Ut)}while(ct>0&&mt>0);2*ct<=dt&&(gt+=Ie,ct+=dt),2*mt<=dt&&(N+=je,mt+=dt),Ve==xe&&ue<0&&_e>0&&(Ve=Y)}he=gt,gt=H,H=he,Ie=-Ie,Ue=-Ue,be=N,N=X,X=be,je=-je,cs=-cs,P=B}while(yt--);r(gt,N,H,X,lt)}function u(gt,N,P,D,B,$,H,X,lt){(function(ct,mt,yt,kt,Tt,At,Ut,he,xe,be){let ue=0,_e=0,Te=ct+yt-Tt-Ut,Ve=Te-4*(yt-Tt),Ie=ct-yt-Tt+Ut,je=Ie+4*(yt+Tt),Pe=mt+kt-At-he,Be=Pe-4*(kt-At),Ue=mt-kt-At+he,es=Ue+4*(kt+At);var os,cs,Y,et,J,tt,ft=ct,_t=mt;let it,vt=Ie*Ie-Ve*Te;const Ct=[0,0,0,0,0];for(Ve==0?Math.abs(Te)<2*Math.abs(Ie)&&(Ct[ue++]=Te/(2*Ie)):vt>0&&(it=Math.sqrt(vt),vt=(Ie-it)/Ve,Math.abs(vt)<1&&(Ct[ue++]=vt),vt=(Ie+it)/Ve,Math.abs(vt)<1&&(Ct[ue++]=vt)),vt=Ue*Ue-Be*Pe,Be==0?Math.abs(Pe)<2*Math.abs(Ue)&&(Ct[ue++]=Pe/(2*Ue)):vt>0&&(it=Math.sqrt(vt),vt=(Ue-it)/Be,Math.abs(vt)<1&&(Ct[ue++]=vt),vt=(Ue+it)/Be,Math.abs(vt)<1&&(Ct[ue++]=vt)),_e=1;_e<ue;_e++)(vt=Ct[_e-1])>Ct[_e]&&(Ct[_e-1]=Ct[_e],Ct[_e]=vt,_e=0);for(vt=-1,Ct[ue]=1,_e=0;_e<=ue;_e++)it=Ct[_e],os=(vt*(vt*Ie-2*Te)-it*(vt*(vt*Ve-2*Ie)+Te)+je)/8-ft,et=(vt*(vt*Ue-2*Pe)-it*(vt*(vt*Be-2*Ue)+Pe)+es)/8-_t,cs=(it*(it*Ie-2*Te)-vt*(it*(it*Ve-2*Ie)+Te)+je)/8-ft,J=(it*(it*Ue-2*Pe)-vt*(it*(it*Be-2*Ue)+Pe)+es)/8-_t,ft-=Y=(it*(it*(3*Ie-it*Ve)-3*Te)+je)/8,_t-=tt=(it*(it*(3*Ue-it*Be)-3*Pe)+es)/8,Ut=Math.floor(Y+.5),he=Math.floor(tt+.5),ft!=0&&(os*=ft=(ct-Ut)/ft,cs*=ft),_t!=0&&(et*=_t=(mt-he)/_t,J*=_t),(ct!=Ut||mt!=he)&&xe(ct,mt,ct+os,mt+et,ct+cs,mt+J,Ut,he,be),ct=Ut,mt=he,ft=Y,_t=tt,vt=it})(gt,N,P,D,B,$,H,X,l,lt)}for(var h=Object.freeze({__proto__:null,AABB:0,SEGMENT:1,CURVE:3,LOOP:4,POINT:5}),g=[0,1],f=[0,2],p=4;p<65535;p<<=2)for(var y=0,_=g.length;y<_;y++)g.push(g[y]|p),f.push((g[y]|p)<<1);function x(gt,N){return(f[255&N]|g[255&gt])+65536*(f[N>>8&255]|g[gt>>8&255])+4294967296*(f[N>>16&255]|g[gt>>16&255])}let v,b;function S(gt,N=[0,0]){if(gt>0xffffffffffff)throw"Only morton codes up to 48 bits are supported.";if(!v){v={},b={};for(var P=0;P<256;P++)v[x(P,0)]=P,b[x(0,P)]=P}var D=v[21845&gt],B=b[43690&gt];return gt>65535&&(D|=v[21845&(gt/=65536)]<<8,B|=b[43690&gt]<<8,gt>65535&&(D|=v[21845&(gt/=65536)]<<16,B|=b[43690&gt]<<16)),N[0]=D,N[1]=B,N}x.code=function(N,P,D){if(N>24)throw"Morton codes are only supported up to Z=24";var B=1<<24-N;return x(P*B,D*B)},x.range=function(N,P,D){if(N>24)throw"Morton ranges are only supported up to Z=24";var B=1<<24-N,$=x(P*B,D*B);return[$,$+B*B-1]},x.reverse=S,x.decode=function(N,P){var D=S(P),B=1<<24-N;return[D[0]/B,D[1]/B]},x.min=function(N,P){var D=1431655765&N,B=1431655765&P,$=2863311530&N,H=2863311530&P;return Math.min(D,B)+Math.min($,H)};const A=x;let w,L,I;function F(gt,N,P){const D=1<<P;return[gt=~~(D*((gt+I)/L)),N=~~(D*((N+I)/L))]}function O(gt,N,P){const D=1<<P;return[gt=D*((gt+I)/L),N=D*((N+I)/L)]}function V(gt,N,P,D,B,$){const H=F(gt,N,B),X=F(P,D,B);for(let lt=H[0];lt<=X[0];lt++)for(let dt=H[1];dt<=X[1];dt++)$.push(A(lt,dt))}function j(gt,N,P){const[D,B]=F(gt[0],gt[1],N),[$,H]=F(gt[2],gt[3],N),[X,lt]=F(gt[4],gt[5],N);(function(ct,mt,yt,kt,Tt,At,Ut){var he,xe=ct-yt,be=mt-kt,ue=ct-2*yt+Tt;xe*(Tt-yt)>0&&(be*(At-kt)>0&&Math.abs((mt-2*kt+At)/ue*xe)>Math.abs(be)&&(ct=Tt,Tt=xe+yt,mt=At,At=be+kt),he=(1-(ue=(ct-yt)/ue))*((1-ue)*mt+2*ue*kt)+ue*ue*At,ue=(ct*Tt-yt*yt)*ue/(ct-yt),xe=Math.floor(ue+.5),be=Math.floor(he+.5),he=(kt-mt)*(ue-ct)/(yt-ct)+mt,a(ct,mt,xe,Math.floor(he+.5),xe,be,Ut),he=(kt-At)*(ue-Tt)/(yt-Tt)+At,ct=yt=xe,mt=be,kt=Math.floor(he+.5)),(mt-kt)*(At-kt)>0&&(he=(1-(ue=(mt-kt)/(ue=mt-2*kt+At)))*((1-ue)*ct+2*ue*yt)+ue*ue*Tt,ue=(mt*At-kt*kt)*ue/(mt-kt),xe=Math.floor(he+.5),be=Math.floor(ue+.5),he=(yt-ct)*(ue-mt)/(kt-mt)+ct,a(ct,mt,Math.floor(he+.5),be,xe,be,Ut),he=(yt-Tt)*(ue-At)/(kt-At)+Tt,ct=xe,yt=Math.floor(he+.5),mt=kt=be),a(ct,mt,yt,kt,Tt,At,Ut)})(D,B,$,H,X,lt,((dt,ct)=>{P.push(A(dt,ct))}))}(function(N){w=N,L=1<<w,I=1<<w-1})(14);const Z=[[0,0],[0,0]];function at(gt,N){const P=gt.type,D=gt.coordinates,B=[];switch(P){case 1:Z[0][0]=D[0],Z[0][1]=D[1],Z[1][0]=D[2],Z[1][1]=D[3],(function(H,X,lt,dt){for(var ct,mt,yt=0;yt<H.length-1;yt++){var kt=O(H[yt][0],H[yt][1],X),Tt=O(H[yt+1][0],H[yt+1][1],X),At=kt[0],Ut=kt[1],he=Tt[0]-At,xe=Tt[1]-Ut;if(xe!==0||he!==0){var be=he>0?1:-1,ue=xe>0?1:-1,_e=Math.floor(At),Te=Math.floor(Ut),Ve=he===0?1/0:Math.abs(((he>0?1:0)+_e-At)/he),Ie=xe===0?1/0:Math.abs(((xe>0?1:0)+Te-Ut)/xe),je=Math.abs(be/he),Pe=Math.abs(ue/xe);for(_e===ct&&Te===mt||(dt.push(A(_e,Te)),ct=_e,mt=Te);Ve<1||Ie<1;)Ve<Ie?(Ve+=je,_e+=be):(Ie+=Pe,Te+=ue),dt.push(A(_e,Te)),ct=_e,mt=Te}}})(Z,N,void 0,B);break;case 0:V(D[0],D[1],D[2],D[3],N,B);break;case 5:V(D[0]-D[2],D[1]-D[2],D[0]+D[2],D[1]+D[2],N,B);break;case 3:j(D,N,B);break;case 4:(function(H,X,lt){const[dt,ct]=F(H[0],H[1],X),[mt,yt]=F(H[2],H[3],X),[kt,Tt]=F(H[4],H[5],X),[At,Ut]=F(H[6],H[7],X);u(dt,ct,mt,yt,kt,Tt,At,Ut,((he,xe)=>{lt.push(A(he,xe))}))})(D,N,B)}return B}class pt{constructor(N=Int32Array,P=16,D=8){this._BIG_LIST=new Uint8Array([-1])[0],this._ArrayType=N,this._capacity=P,this._MAX_LIST_SIZE=D,this._freeIndex=-1,this.clear()}clear(){this._buffer=new this._ArrayType(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._idToIndex=new Map,this._constList=new Array(this._MAX_LIST_SIZE)}addEntry(N){let P;return this._freeIndex===-1?P=this._nextIndex++:(P=this._freeIndex,this._freeIndex=-1),this._idToIndex.set(N,P),P>=this._capacity&&this._expand(P+1),this._sizes[P]=0,P}getItems(N){const P=this._idToIndex.get(N);if(P===void 0)return;const D=this._sizes[P],B=this._MAX_LIST_SIZE*P;if(D<=this._MAX_LIST_SIZE){this._constList.length=D;for(let $=0,H=D;$<H;++$)this._constList[$]=this._buffer[B+$];return this._constList}if(D===this._BIG_LIST){const $=this._buffer[B];return this._bigLists[$]}}removeEntry(N){const P=this._idToIndex.get(N);if(this._sizes[P]===this._BIG_LIST){const D=this._MAX_LIST_SIZE*P,B=this._buffer[D];this._bigLists[B].length=0}this._sizes[P]=0,this._freeIndex=P}size(N){const P=this._idToIndex.get(N),D=this._sizes[P];return D<=this._MAX_LIST_SIZE?D:this._bigLists[this._buffer[P*this._MAX_LIST_SIZE]].length}sizes(N){const P=this._sizes,D=this._bigLists,B=this._buffer,$=this._MAX_LIST_SIZE,H=N.length,X=new Array(H);for(let lt=0;lt<H;lt++){const dt=this._idToIndex.get(N[lt]),ct=P[dt];X[lt]=ct<=$?ct:D[B[dt*$]].length}return X}addTo(N,P){const D=this._idToIndex.get(N),B=this._sizes[D],$=D*this._MAX_LIST_SIZE;if(B<this._MAX_LIST_SIZE)this._buffer[$+B]=P,this._sizes[D]=B+1;else if(B===this._BIG_LIST){const H=this._buffer[$];this._bigLists[H].push(P)}else{const H=new Array(this._MAX_LIST_SIZE);for(let X=0;X<this._MAX_LIST_SIZE;++X)H[X]=this._buffer[$+X];H.push(P),this._bigLists.push(H),this._sizes[D]=this._BIG_LIST,this._buffer[$]=this._bigLists.length-1}}removeFrom(N,P){this.removeFromAndGetSize(N,P)}removeFromAndGetSize(N,P){const D=this._idToIndex.get(N);let B=this._sizes[D];const $=this._MAX_LIST_SIZE*D;if(B<=this._MAX_LIST_SIZE){for(let H=$,X=$+B;H<X;++H)if(this._buffer[H]===P)return B-=1,this._buffer[H]=this._buffer[X-1],this._sizes[D]=B,B}else if(B===this._BIG_LIST){const H=this._buffer[$],X=this._bigLists[H],lt=X.indexOf(P);if(lt!==-1)return X.splice(lt,1),X.length}}reserve(N){this._capacity<N&&this._expand(N)}_expand(N){this._capacity=Math.pow(2,Math.ceil(Math.log2(N))),this._buffer=K(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=K(this._sizes,this._capacity)}has(N){const P=this._idToIndex.get(N);return!(P===void 0||P>=this._capacity)&&this._sizes[P]!==0}keys(){return Array.from(this._idToIndex.keys())}get averageSize(){let N=0;for(let P=0;P<this._capacity;P++)N+=this._sizes[P];return N/this._capacity}}function K(gt,N){const P=new gt.constructor(N);return P.set(gt),P}function ut(){for(var gt=arguments,N=gt.length-1,P=N,D=[],B=0;B<=N&&Math.abs(gt[B])<=1e-12;B++)N--;switch(N){case 1:ht(gt[P],gt[P-1],D);break;case 2:nt(gt[P],gt[P-1],gt[P-2],D);break;case 3:ot(gt[P],gt[P-1],gt[P-2],gt[P-3],D)}return D}function ht(gt,N,P=[]){return N!==0&&P.push(-gt/N),P}function nt(gt,N,P,D=[]){var B=N/P,$=B*B-gt/P*4;if($>0){var H=Math.sqrt($);D.push(.5*(-B+H)),D.push(.5*(-B-H))}else $===0&&D.push(.5*-B);return D}function ot(gt,N,P,D,B=[]){var $,H,X=P/D,lt=N/D,dt=(3*lt-X*X)/3,ct=(2*X*X*X-9*lt*X+gt/D*27)/27,mt=X/3,yt=ct*ct/4+dt*dt*dt/27,kt=ct/2;if(Math.abs(yt)<=1e-6&&(yt=0),yt>0){var Tt=Math.sqrt(yt);H=($=-kt+Tt)>=0?Math.pow($,1/3):-Math.pow(-$,1/3),($=-kt-Tt)>=0?H+=Math.pow($,1/3):H-=Math.pow(-$,1/3),B.push(H-mt)}else if(yt<0){var At=Math.sqrt(-dt/3),Ut=Math.atan2(Math.sqrt(-yt),-kt)/3,he=Math.cos(Ut),xe=Math.sin(Ut),be=Math.sqrt(3);B.push(2*At*he-mt),B.push(-At*(he+be*xe)-mt),B.push(-At*(he-be*xe)-mt)}else $=kt>=0?-Math.pow(kt,1/3):Math.pow(-kt,1/3),B.push(2*$-mt),B.push(-$-mt);return B}function Nt(gt,N,P,D,B,$,H,X,lt,dt,ct){for(var mt,yt,kt=Math.min(H,lt),Tt=Math.min(X,dt),At=Math.max(H,lt),Ut=Math.max(X,dt),he=ut((mt=X-dt)*(gt+-2*P+B)+(yt=lt-H)*(N+-2*D+$),mt*(-2*gt+2*P)+yt*(-2*N+2*D),mt*gt+yt*N+(H*dt-lt*X)),xe=0;xe<he.length;xe++){var be=he[xe];if(0<=be&&be<=1){var ue=gt+(P-gt)*be,_e=N+(D-N)*be,Te=ue+(P+(B-P)*be-ue)*be,Ve=_e+(D+($-D)*be-_e)*be;if(H===lt){if(Tt<=Ve&&Ve<=Ut)return 1}else if(X===dt){if(kt<=Te&&Te<=At)return 1}else if(Te>=kt&&Ve>=Tt&&Te<=At&&Ve<=Ut)return 1}}return ct?ct.length/2:0}function Q(gt,N,P,D,B,$,H,X,lt,dt,ct,mt,yt){for(var kt,Tt,At=Math.min(lt,ct),Ut=Math.min(dt,mt),he=Math.max(lt,ct),xe=Math.max(dt,mt),be=ut((kt=dt-mt)*(-1*gt+3*P+-3*B+H)+(Tt=ct-lt)*(-1*N+3*D+-3*$+X),kt*(3*gt+-6*P+3*B)+Tt*(3*N+-6*D+3*$),kt*(-3*gt+3*P)+Tt*(-3*N+3*D),kt*gt+Tt*N+(lt*mt-ct*dt)),ue=0;ue<be.length;ue++){var _e=be[ue];if(0<=_e&&_e<=1){var Te=gt+(P-gt)*_e,Ve=N+(D-N)*_e,Ie=P+(B-P)*_e,je=D+($-D)*_e,Pe=Te+(Ie-Te)*_e,Be=Ve+(je-Ve)*_e,Ue=Pe+(Ie+(B+(H-B)*_e-Ie)*_e-Pe)*_e,es=Be+(je+($+(X-$)*_e-je)*_e-Be)*_e;if(lt===ct){if(Ut<=es&&es<=xe)return 1}else if(dt===mt){if(At<=Ue&&Ue<=he)return 1}else if(Ue>=At&&es>=Ut&&Ue<=he&&es<=xe)return 1}}return yt?yt.length/2:0}const Et=function(N,P,D,B,$,H,X,lt,dt,ct,mt){return X<=N&&dt>=N&&lt<=P&&ct>=P||X<=$&&dt>=$&&lt<=H&&ct>=H||Nt(N,P,D,B,$,H,X,lt,dt,lt)||Nt(N,P,D,B,$,H,dt,lt,dt,ct)||Nt(N,P,D,B,$,H,X,ct,dt,ct)||Nt(N,P,D,B,$,H,X,lt,X,ct)?1:0},Xt=function(N,P,D,B,$,H,X,lt,dt,ct,mt,yt,kt){return dt<=N&&mt>=N&&ct<=P&&yt>=P||dt<=X&&mt>=X&&ct<=lt&&yt>=lt||Q(N,P,D,B,$,H,X,lt,dt,ct,mt,ct)||Q(N,P,D,B,$,H,X,lt,mt,ct,mt,yt)||Q(N,P,D,B,$,H,X,lt,dt,yt,mt,yt)||Q(N,P,D,B,$,H,X,lt,dt,ct,dt,yt)?1:0};function Ht(gt,N,P){return Math.min(Math.max(N,gt),P)}function Zt(gt,N,P,D,B,$,H,X){const lt=((H-B)*(N-$)-(X-$)*(gt-B))/((X-$)*(P-gt)-(H-B)*(D-N)),dt=((P-gt)*(N-$)-(D-N)*(gt-B))/((X-$)*(P-gt)-(H-B)*(D-N));return lt>=0&&lt<=1&&dt>=0&&dt<=1}function ae(gt,N,P,D,B){const $=gt.type,H=gt.coordinates;return $===5?(function(lt,dt,ct,mt,yt,kt,Tt){const At=lt-Ht(lt,mt,kt),Ut=dt-Ht(dt,yt,Tt);return At*At+Ut*Ut<ct*ct})(H[0],H[1],H[2],N,P,D,B):$===1?(function(lt,dt,ct,mt,yt,kt,Tt,At){return lt>=yt&&dt>=kt&&lt<=Tt&&dt<=At||ct>=yt&&mt>=kt&&ct<=Tt&&mt<=At||!!Zt(lt,dt,ct,mt,yt,kt,yt,At)||!!Zt(lt,dt,ct,mt,Tt,kt,Tt,At)||!!Zt(lt,dt,ct,mt,yt,kt,Tt,kt)||!!Zt(lt,dt,ct,mt,yt,At,Tt,At)})(H[0],H[1],H[2],H[3],N,P,D,B):$===3?Et(H[0],H[1],H[2],H[3],H[4],H[5],N,P,D,B):$===4?Xt(H[0],H[1],H[2],H[3],H[4],H[5],H[6],H[7],N,P,D,B):(function(lt,dt){return lt[3]>dt[1]&&lt[1]<dt[3]&&lt[2]>dt[0]&&lt[0]<dt[2]})(H,[N,P,D,B])}const pe=2863311530,ne=4294967295,te=31;function se(gt,N,P){let D=N;for(let B=te;B>=0;B--){const $=1<<B,H=((P&$)<<2|(gt&$)<<1|N&$)>>B;if(H===1)D=gt&~(pe>>>te-B)&ne|1<<B,N=(N|pe>>>te-B&~(ne<<B)&ne)&~(1<<B)&ne;else{if(H===3)return gt;if(H===4)return D;H===5&&(gt=gt&~(pe>>>te-B)&ne|1<<B)}}return D}function ce(gt,N,P){for(let D=te;D>=0;D--){const B=1<<D,$=((P&B)<<2|(gt&B)<<1|N&B)>>D;if($===1)N=(N|pe>>>te-D&~(ne<<D)&ne)&~(1<<D)&ne;else{if($===3||$===4)return!1;$===5&&(gt=gt&~(pe>>>te-D)&ne|1<<D)}}return!0}function Ce(gt,N,P){const D=P+1;let B=0;for(let $=te;$>=0;$--){const H=1<<$,X=(D&H)>>$,lt=(gt&H)>>$,dt=(N&H)>>$,ct=1&$,mt=B&3<<2*ct;if(mt===0&&X>dt&&lt<=dt){B|=2<<2*ct;break}if(mt===0&&X<lt){B|=1<<2*ct;break}}return B===0?D:se(gt,N,P)}class ve{constructor(N,P){this.key=N,this.data=P,this.left=null,this.right=null}}function Ne(gt,N){return gt>N?1:gt<N?-1:0}function ge(gt,N,P){if(N===null)return N;let D,B,$;const H=new ve;for(D=B=H;;){const X=P(gt,N.key);if(X<0){if(N.left===null||P(gt,N.left.key)<0&&($=N.left,N.left=$.right,$.right=N,(N=$).left===null))break;B.left=N,B=N,N=N.left}else{if(!(X>0)||N.right===null||P(gt,N.right.key)>0&&($=N.right,N.right=$.left,$.left=N,(N=$).right===null))break;D.right=N,D=N,N=N.right}}return D.right=N.left,B.left=N.right,N.left=H.right,N.right=H.left,N}function ze(gt,N,P,D,B){const $=new ve(gt,N);if(B._size++,P===null)return $.left=$.right=null,$;const H=D(gt,(P=ge(gt,P,D)).key);return H<0?($.left=P.left,$.right=P,P.left=null):H>=0&&($.right=P.right,$.left=P,P.right=null),$}function is(gt,N,P,D){let B;return N===null?null:P(gt,(N=ge(gt,N,P)).key)===0?(N.left===null?B=N.right:(B=ge(gt,N.left,P),B.right=N.right),D._size--,B):N}function Ge(gt,N,P){let D,B;if(N===null)D=B=null;else{const $=P((N=ge(gt,N,P)).key,gt);$===0?(D=N.left,B=N.right):$<0?(B=N.right,N.right=null,D=N):(D=N.left,N.left=null,B=N)}return{left:D,right:B}}function De(gt,N,P,D,B){if(gt){D(`${N}${P?" ":" "}${B(gt)}
`);const $=N+(P?"    ":"   ");gt.left&&De(gt.left,$,!1,D,B),gt.right&&De(gt.right,$,!0,D,B)}}class He{constructor(N=Ne){this._comparator=N,this._root=null,this._size=0}insert(N,P){return this._root=ze(N,P,this._root,this._comparator,this)}add(N,P){return this._root=(function(B,$,H,X,lt){const dt=new ve(B,$);if(H===null)return dt.left=dt.right=null,lt._size++,dt;const ct=X(B,(H=ge(B,H,X)).key);return ct===0?H:(ct<0?(dt.left=H.left,dt.right=H,H.left=null):ct>0&&(dt.right=H.right,dt.left=H,H.right=null),lt._size++,dt)})(N,P,this._root,this._comparator,this)}remove(N){this._root=is(N,this._root,this._comparator,this)}pop(){let N=this._root;if(N){for(;N.left;)N=N.left;return this._root=ge(N.key,this._root,this._comparator),this._root=is(N.key,this._root,this._comparator,this),{key:N.key,data:N.data}}return null}findStatic(N){let P=this._root;const D=this._comparator;for(;P;){const B=D(N,P.key);if(B===0)return P;P=B<0?P.left:P.right}return null}find(N){return this._root&&(this._root=ge(N,this._root,this._comparator),this._comparator(N,this._root.key)!==0)?null:this._root}contains(N){let P=this._root;const D=this._comparator;for(;P;){const B=D(N,P.key);if(B===0)return!0;P=B<0?P.left:P.right}return!1}forEach(N,P){let D=this._root;const B=[];let $=!1;for(;!$;)D!==null?(B.push(D),D=D.left):B.length!==0?(D=B.pop(),N.call(P,D),D=D.right):$=!0;return this}range(N,P,D,B){const $=[],H=this._comparator;let X,lt=this._root;for(;$.length!==0||lt;)if(lt)$.push(lt),lt=lt.left;else{if(lt=$.pop(),X=H(lt.key,P),X>0)break;if(H(lt.key,N)>=0&&D.call(B,lt))return this;lt=lt.right}return this}keys(){const N=[];return this.forEach((({key:P})=>N.push(P))),N}values(){const N=[];return this.forEach((({data:P})=>N.push(P))),N}min(){return this._root?this.minNode(this._root).key:null}max(){return this._root?this.maxNode(this._root).key:null}minNode(N=this._root){if(N)for(;N.left;)N=N.left;return N}maxNode(N=this._root){if(N)for(;N.right;)N=N.right;return N}at(N){let P=this._root,D=!1,B=0;const $=[];for(;!D;)if(P)$.push(P),P=P.left;else if($.length>0){if(P=$.pop(),B===N)return P;B++,P=P.right}else D=!0;return null}next(N){let P=this._root,D=null;if(N.right){for(D=N.right;D.left;)D=D.left;return D}const B=this._comparator;for(;P;){const $=B(N.key,P.key);if($===0)break;$<0?(D=P,P=P.left):P=P.right}return D}prev(N){let P=this._root,D=null;if(N.left!==null){for(D=N.left;D.right;)D=D.right;return D}const B=this._comparator;for(;P;){const $=B(N.key,P.key);if($===0)break;$<0?P=P.left:(D=P,P=P.right)}return D}clear(){return this._root=null,this._size=0,this}toList(){return(function(P){var D=P,B=[],$=!1;const H={next:null};let X=H;for(;!$;)D?(B.push(D),D=D.left):B.length>0?D=(D=X=X.next=B.pop()).right:$=!0;return X.next=null,H.next})(this._root)}load(N=[],P=[],D=!1){let B=N.length;const $=this._comparator;if(D&&ts(N,P,0,B-1,$),this._root===null)this._root=Je(this._root,N,P,0,B),this._size=B;else{const H=(function(lt,dt,ct=((mt,yt)=>mt-yt)){const mt={};let yt=mt,kt=lt,Tt=dt;for(;kt!==null&&Tt!==null;)ct(kt.key,Tt.key)<0?(yt.next=kt,kt=kt.next):(yt.next=Tt,Tt=Tt.next),yt=yt.next;return kt!==null?yt.next=kt:Tt!==null&&(yt.next=Tt),mt.next})(this.toList(),(function(lt,dt){const ct={next:null};let mt=ct;for(let yt=0;yt<lt.length;yt++)mt=mt.next={key:lt[yt],data:dt[yt]};return mt.next=null,ct.next})(N,P),$);B=this._size+B,this._root=ss({head:H},0,B)}return this}isEmpty(){return this._root===null}get size(){return this._size}toString(N=(P=>P.key)){const P=[];return De(this._root,"",!0,(D=>P.push(D)),N),P.join("")}update(N,P,D){const B=this._comparator;let{left:$,right:H}=Ge(N,this._root,B);this._size--,B(N,P)<0?H=ze(P,D,H,B,this):$=ze(P,D,$,B,this),this._root=(function(lt,dt,ct){return dt===null?lt:(lt===null||((dt=ge(lt.key,dt,ct)).left=lt),dt)})($,H,B)}split(N){return Ge(N,this._root,this._comparator)}}function Je(gt,N,P,D,B){const $=B-D;if($>0){const H=D+Math.floor($/2),X={key:N[H],data:P[H],parent:gt};return X.left=Je(X,N,P,D,H),X.right=Je(X,N,P,H+1,B),X}return null}function ss(gt,N,P){const D=P-N;if(D>0){const B=N+Math.floor(D/2),$=ss(gt,N,B),H=gt.head;return H.left=$,gt.head=gt.head.next,H.right=ss(gt,B+1,P),H}return null}function ts(gt,N,P,D,B){if(P>=D)return;const $=gt[P+D>>1];let H=P-1,X=D+1;for(;;){do H++;while(B(gt[H],$)<0);do X--;while(B(gt[X],$)>0);if(H>=X)break;let lt=gt[H];gt[H]=gt[X],gt[X]=lt,lt=N[H],N[H]=N[X],N[X]=lt}ts(gt,N,P,X,B),ts(gt,N,X+1,D,B)}class hs extends He{constructor(N){super(N)}lte(N){const P=this._comparator;let D,B=this._root;for(;B;){if(D=P(B.key,N),B.left===null&&B.right===null&&D>0)return null;if(D<=0&&B.right===null||D<=0&&P(B.right.key,N)>0)return B;B=D>=0?B.left:B.right}return B}gte(N){const P=[],D=this._comparator;let B=this._root;for(;P.length!==0||B;)if(B)P.push(B),B=B.left;else{if(B=P.pop(),D(B.key,N)>=0)break;B=B.right}return B}clear(){return this._root=null,this._size=0,this}}class Fe{constructor(N,P=8){this.setLevel(P),this.setAccessor(N),this._tree=new hs(((D,B)=>D-B)),this._nodeToId=new pt(Uint32Array,1e3,16),this._idToNode=new pt(Uint32Array,16,8),this._size=0,this._checkedNodes=[],this._codeCache=[0,0]}setAccessor(N){return this._getGeometry=N,this}load(N){const P=[],D=this._nodeToId,B=this._idToNode,$=this._level,H=this._getGeometry;for(let X=0;X<N.length;X++){const lt=N[X],dt=at(H(lt),$);B.addEntry(lt);for(let ct=0;ct<dt.length;ct++){const mt=dt[ct];D.has(mt)||(D.addEntry(mt),P.push(mt)),D.addTo(mt,lt),B.addTo(lt,mt)}}return this._tree.load(P,[],!0),this._size+=N.length,this}addToPage(){}removeFromPage(){}insert(N){const P=at(this._getGeometry(N),this._level),D=this._idToNode,B=this._nodeToId,$=this._tree;this._size++,D.addEntry(N);for(let H=0;H<P.length;H++){const X=P[H];B.has(X)||($.insert(X),B.addEntry(X)),B.addTo(X,N),D.addTo(N,X)}}remove(N){const P=this._idToNode.getItems(N),D=this._nodeToId,B=this._tree;if(P)for(let $=0;$<P.length;$++){const H=P[$];D.removeFromAndGetSize(H,N)===0&&B.remove(H)}return this._idToNode.removeEntry(N),this._size--,this}update(N){return this.remove(N),this.insert(N),this}forEach(N){return this._tree.forEach(N),this}all(){const N=[];return this._tree.forEach((P=>{N.push(P)})),N}clear(){return this._tree.clear(),this._nodeToId.clear(),this._idToNode.clear(),this}setLevel(N){return this._level=N,this}traverse(N,P,D,B,$){const[H,X]=O(N,P,this._level),[lt,dt]=O(D,B,this._level),ct=x(H,X),mt=x(lt,dt);let yt=this._tree._root;const kt=[];let Tt=ct;for(;kt.length>0||yt;)if(yt)kt.push(yt),yt=yt.left;else{yt=kt.pop();const At=yt.key;if(At>mt)break;if(At>=ct&&At>=Tt&&(Tt=Ce(ct,mt,At),$(yt)))return this;yt=yt.right}return this}getKeys(N){const[P,D,B,$]=N,[H,X]=O(P,D,this._level),[lt,dt]=O(B,$,this._level),ct=x(H,X),mt=x(lt,dt);let yt=this._tree._root;const kt=[];let Tt=ct;for(;kt.length>0||yt;)if(yt)kt.push(yt),yt=yt.left;else{yt=kt.pop();const At=yt.key;if(At>mt)break;At>=ct&&At>=Tt&&(Tt=Ce(ct,mt,At)),yt=yt.right}return this}traverseDescend(N,P,D,B,$){const H=O(P,D,this._level),X=O(B,$,this._level),lt=x(H[0],H[1]),dt=x(X[0],X[1]);return this._recurse(this._tree._root,lt,dt,lt,dt,N),this}traverseRange(N,P,D,B,$){const[H,X]=O(P,D,this._level),[lt,dt]=O(B,$,this._level),ct=x(H,X),mt=x(lt,dt);return this._tree.range(ct,mt,(yt=>{const kt=yt.key;if(ce(ct,mt,kt)&&N(yt))return!0})),this}_recurse(N,P,D,B,$,H){if(N===null)return;const X=N.key;if(X<P)return this._recurse(N.right,P,D,B,$,H);if(X>D)return this._recurse(N.left,P,D,B,$,H);if(ce(B,$,X)){if(this._recurse(N.left,P,X,B,$,H),H(N))return;this._recurse(N.right,X,D,B,$,H)}else{const lt=se(B,$,X),dt=(function(mt,yt,kt){let Tt=mt;for(let At=te;At>=0;At--){const Ut=1<<At,he=((kt&Ut)<<2|(mt&Ut)<<1|yt&Ut)>>At;if(he===1)yt=(yt|pe>>>te-At&~(ne<<At)&ne)&~(1<<At)&ne;else{if(he===3)return Tt;if(he===4)return yt;he===5&&(Tt=(yt|pe>>>te-At&~(ne<<At)&ne)&~(1<<At)&ne,mt=mt&~(pe>>>te-At)&ne|1<<At)}}return Tt})(B,$,X);this._recurse(N.left,P,dt,B,$,H),this._recurse(N.right,lt,D,B,$,H)}}query(N,P,D,B){const $=[],H=[];this.traverse(N,P,D,B,(dt=>{$.push(dt)}));const X={},lt=this._getGeometry;this._intersectionChecks=0;for(let dt=0;dt<$.length;dt++){const ct=$[dt],mt=this._nodeToId.getItems(ct.key);for(let yt=0;yt<mt.length;yt++){const kt=mt[yt];if(!X[kt]){const Tt=lt(kt);this._intersectionChecks++,ae(Tt,N,P,D,B)&&H.push(kt),X[kt]=!0}}}return this._checkedNodes=$,H}getItems(N){return this._nodeToId.getItems(N)}get intersectionChecks(){return this._intersectionChecks}get level(){return this._level}get size(){return this._size}keyToBBox(N){const P=(function(){return w})(),[D,B]=x.reverse(N),$=1<<12-this._level+(P-12),H=1<<P-1;return[D*$-H,B*$-H,(D+1)*$-H,(B+1)*$-H]}}Fe.MAX_ZOOM=12;var Oe=typeof Map>"u"?class{constructor(){this._values={},this._size=0}get size(){return this._size}has(N){return!!this._values[N]}set(N,P){N in this._values||this._size++,this._values[N]=P}get(N){return this._values[N]}delete(N){N in this._values&&(delete this._values[N],this._size--)}keys(){return Object.keys(this._values)}clear(){this._values={},this._size=0}}:Map,Cs=typeof Set>"u"?class{constructor(){this._values={},this._size=0}get size(){return this._size}has(N){return!!this._values[N]}add(N){N in this._values||this._size++,this._values[N]=!0}delete(N){N in this._values&&(delete this._values[N],this._size--)}keys(){return Object.keys(this._values)}clear(){this._values={},this._size=0}}:Set;class Fs{constructor(){this._intersects=null,this._getBounds=null}setBoundsGetter(N){return this._getBounds=N,this}setIntersector(N){return this._intersects=N,this}}function Hs(gt,N,P,D,B,$,H,X){return D>=$&&N<=X&&P>=B&&gt<=H}const Ls=(gt,N,P,D,B,$)=>({minX:gt,minY:N,maxX:P,maxY:D,leaf:!0,level:$,parent:B,objects:[],final:!1,children:null});function Sn(gt){const{minX:N,minY:P,maxX:D,maxY:B}=gt;return[N,P,D,B]}function gn(gt,N,P,D,B,$,H,X){return gt>=B&&P<=H&&N>=$&&D<=X}function ln(gt,N,P,D,B,$,H,X){const lt=($+X)/2,dt=(N+D)/2;return(gt+P)/2<=(B+H)/2?dt<=lt?0:1:dt<=lt?3:2}const xs=gt=>gt;class Ps extends Fs{constructor(N=xs,P=10,D,B=0){super(),this._nodeCapacity=10,this._root=null,this._objects={},this._size=0,this._rootLevel=0,this._maxLevel=30,this._idToCell={},this._nodeCapacity=P,this._root=null,this._getBounds=N,this._rootLevel=B,this._maxLevel=B+30,this._idToCell={},D&&(this._root=Ls(D[0],D[1],D[2],D[3],null,B))}get size(){return this._size}get root(){return this._root}clear(){return this._root=null,this._objects={},this._size=0,this._idToCell={},this._rootLevel=0,this._maxLevel=this._rootLevel+30,this}insert(N,P,D,B,$,H=this._root){if(P||([P,D,B,$]=this._getBounds(N)),this._objects[N])return;if(this._objects[N]=!0,this._size++,!this._root){const Tt=Math.max(Math.abs(B-P),Math.abs($-D));return this._root=Ls(P,D,P+Tt,D+Tt,null,this._rootLevel),this._idToCell[N]=[this._root],this._root.objects=[N],N}let X,lt=[H],dt=!1;const ct=this._nodeCapacity,mt=this._idToCell,yt=this._maxLevel;let kt;for(;kt=lt.pop();){X=kt;const{minX:Tt,minY:At,maxX:Ut,maxY:he}=X;Hs(P,D,B,$,Tt,At,Ut,he)&&(X.leaf?X.objects&&(X.objects.length<ct||X.final)?(X.objects.push(N),mt[N]?mt[N].push(X):mt[N]=[X],dt=!0,(X.level>=yt||Math.abs(Ut-Tt)<=Math.abs(B-P)||Math.abs(he-At)<=Math.abs($-D))&&(X.final=!0)):(this.splitNode(X),lt.push(X)):lt.push.apply(lt,X.children))}if(!gn(P,D,B,$,(H=this._root).minX,H.minY,H.maxX,H.maxY)){let Tt=this._rootLevel;for(;!gn(P,D,B,$,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){H=this._root;const{minX:At,minY:Ut,maxX:he,maxY:xe}=H;let be=At,ue=Ut,_e=he,Te=xe;const Ve=Math.abs(he-At),Ie=Math.abs(xe-Ut);if(Ie===0&&Ve===0)break;const je=Math.max(Ve,Ie);P<At?(be-=je,D<Ut?ue-=je:Te+=je):(_e+=je,D<Ut?ue-=je:Te+=je);const Pe=Ls(be,ue,_e,Te,null,--Tt);this.splitNode(Pe),Pe.children[ln(At,Ut,he,xe,be,ue,_e,Te)]=H,this._root=H.parent=Pe}for(lt=[this._root],this._root.level=this._rootLevel;kt=lt.shift();)if(X=kt,!X.leaf)for(let At=0;At<4;At++){const Ut=X.children[At];Ut.level=X.level+1,lt.push(Ut)}H=this._root;for(let At=0;At<4;At++){const Ut=H.children[At];Ut&&Ut.leaf&&Ut.objects&&(Ut.objects.push(N),mt[N]?mt[N].push(Ut):mt[N]=[Ut])}}return dt?N:void 0}removeById(N){if(!this._objects[N])return N;this._size--;const P=this._idToCell[N];for(let D=0;D<P.length;D++){const B=P[D].objects||[];for(let $=0,H=B.length;$<H;$++)if(B[$]===N){B.splice($,1);break}}return delete this._objects[N],delete this._idToCell[N],N}remove(N){const[P,D,B,$]=this._getBounds(N),H=[this._root];let X,lt;const dt=[];for(;X=H.pop();)if(Hs(P,D,B,$,X.minX,X.minY,X.maxX,X.maxY))if(X.leaf){const ct=X.objects||[];for(let mt=0,yt=ct.length;mt<yt;mt++)if(ct[mt]===N){ct.splice(mt,1),yt===1&&dt.push(X);break}}else H.push.apply(H,X.children);if(delete this._idToCell[N],delete this._objects[N],this._size--,dt.length)for(;lt=dt.pop();){let ct=lt.parent,mt=!0;for(;ct&&mt;){if(!ct.leaf){for(let yt=0;yt<4;yt++)if(X=ct.children[yt],!X.leaf||X.objects&&X.objects.length!==0){mt=!1;break}mt&&(ct.leaf=!0,ct.children=[],ct.objects=[])}ct=ct.parent}}return N}splitNode(N){const{minX:P,minY:D,maxX:B,maxY:$}=N,H=(P+B)/2,X=(D+$)/2,lt=N.level+1,dt=this._idToCell,ct=this._maxLevel,mt=[Ls(P,D,H,X,N,lt),Ls(P,X,H,$,N,lt),Ls(H,X,B,$,N,lt),Ls(H,D,B,X,N,lt)];if(N.objects!==null){const yt=N.objects,kt=this._getBounds;for(let Tt=0,At=yt.length;Tt<At;Tt++){const Ut=yt[Tt],he=kt(Ut);let xe=dt[Ut];for(let be=0;be<4;be++){const ue=mt[be],{minX:_e,minY:Te,maxX:Ve,maxY:Ie}=ue;Hs(he[0],he[1],he[2],he[3],_e,Te,Ve,Ie)&&(ue.objects&&ue.objects.push(Ut),(ue.level>=ct||Math.abs(Ve-_e)<=Math.abs(he[2]-he[0])||Math.abs(Ie-Te)<=Math.abs(he[3]-he[1]))&&(ue.final=!0),xe?xe.push(ue):xe=[ue])}xe&&xe.splice(xe.indexOf(N),1)}}N.children=mt,N.objects=null,N.leaf=!1}point(N,P,D){let B=[];const $=[this._root];let H,X,lt;const dt=this._getBounds;for(;H=$.pop();)if(N>=H.minX&&N<=H.maxX&&P>=H.minY&&P<=H.maxY){if(H.leaf){D&&H.objects&&(B=H.objects);const ct=H.objects||[];for(let mt=0,yt=ct.length;mt<yt;mt++)lt=ct[mt],X=dt(lt),N>=X[0]&&N<=X[2]&&P>=X[1]&&P<=X[3]&&B.push(lt);break}$.push.apply($,H.children)}return B.length?B:null}neigbours(N,P){let D,B=[];const $=[this._root];for(;D=$.pop();)if(N>=D.minX&&N<=D.maxX&&P>=D.minY&&P<=D.maxY){if(D.leaf){B=D.objects;break}$.push.apply($,D.children)}return B}query(N,P,D,B){const $=[],H=[this._root];let X,lt,dt;const ct=this._getBounds,mt={},yt=this._intersects;let kt;for(;X=H.pop();)if(Hs(N,P,D,B,X.minX,X.minY,X.maxX,X.maxY))if(X.leaf){const Tt=X.objects||[];for(let At=0,Ut=Tt.length;At<Ut;At++)dt=Tt[At],mt[dt]||(lt=ct(dt),Hs(N,P,D,B,lt[0],lt[1],lt[2],lt[3])&&(yt&&!yt(dt,N,P,D,B)||$.push(dt)),mt[dt]=!0)}else kt=ln(N,P,D,B,X.minX,X.minY,X.maxX,X.maxY),H.push(X.children[(kt+3)%4],X.children[(kt+2)%4],X.children[(kt+1)%4],X.children[kt]);return $}traverse(N,P,D,B,$){const H=[],X=[this._root];let lt,dt,ct;const mt=this._getBounds,yt={},kt=this._intersects;let Tt;for(;lt=X.pop();)if(Hs(N,P,D,B,lt.minX,lt.minY,lt.maxX,lt.maxY))if(lt.leaf){const At=lt.objects||[];for(let Ut=0,he=At.length;Ut<he;Ut++)if(ct=At[Ut],!yt[ct]){if(dt=mt(ct),Hs(N,P,D,B,dt[0],dt[1],dt[2],dt[3])&&(!kt||kt(ct,N,P,D,B))&&(H.push(ct),$(ct)))return H;yt[ct]=!0}}else Tt=ln(N,P,D,B,lt.minX,lt.minY,lt.maxX,lt.maxY),X.push(lt.children[(Tt+3)%4],lt.children[(Tt+2)%4],lt.children[(Tt+1)%4],lt.children[Tt]);return H}getOverlaps(){const N=[this._root];let P,D,B;const $=[],H=this._getBounds,X={};for(;P=N.pop();)if(P.leaf){const lt=P.objects||[],dt=lt.length;for(let ct=0;ct<dt;ct++)for(let mt=0;mt<dt;mt++)if(D=lt[ct],B=lt[mt],ct!==mt&&!X[D+":"+B]&&!X[B+":"+D]){X[D+":"+B]=!0;const yt=H(D),kt=H(B);Hs(yt[0],yt[1],yt[2],yt[3],kt[0],kt[1],kt[2],kt[3])&&$.push(D,B)}}else N.push.apply(N,P.children);return $}cover(N,P,D,B){if(this._root===null)return this._root=Ls(N,P,D,B,null,0),this;let $=this._root;if(!gn(N,P,D,B,$.minX,$.minY,$.maxX,$.maxY)){let H=this._rootLevel;for(;!gn(N,P,D,B,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){$=this._root;const{minX:ct,minY:mt,maxX:yt,maxY:kt}=$;let Tt=ct,At=mt,Ut=yt,he=kt;const xe=Math.abs(yt-ct),be=Math.abs(kt-mt);if(be===0&&xe===0)break;const ue=Math.max(xe,be);N<ct?(Tt-=ue,P<mt?At-=ue:he+=ue):(Ut+=ue,P<mt?At-=ue:he+=ue);const _e=Ls(Tt,At,Ut,he,null,--H);this.splitNode(_e),_e.children[ln(ct,mt,yt,kt,Tt,At,Ut,he)]=$,this._root=$.parent=_e}const X=[this._root];let lt,dt;for(this._root.level=this._rootLevel;lt=X.shift();)if(dt=lt,!dt.leaf)for(let ct=0;ct<4;ct++){const mt=dt.children[ct];mt.level=dt.level+1,X.push(mt)}}return this}getAll(){return Object.keys(this._objects).map((N=>Number(N)))}forEach(N,P){const D=[this._root];let B;for(;B=D.pop();)if(B.leaf&&B.objects)for(let $=0,H=B.objects.length;$<H;$++)N.call(P,B.objects[$]);else D.push.apply(D,B.children);return this}getLeafs(){const N=[this._root],P=[];let D;for(;D=N.pop();)D.leaf?P.push(D):N.push.apply(N,D.children);return P}traverseFromRoot(N,P){const D=[this._root];let B;for(;B=D.pop();)N.call(P,B,B.objects)||B.leaf||D.push.apply(D,B.children);return this}update(N,P,D,B,$){return this.remove(N),this.insert(N,P,D,B,$),this}getNodeBounds(N){return Sn(N)}}Ps.flatAccessor=(gt,N)=>P=>{const D=N*P;return gt.slice(D,D+N)},Ps.inside=gn,Ps.intersects=function(N,P,D,B,$,H,X,lt){return N>$&&N<X&&P>H&&P<lt||D>$&&D<X&&B>H&&B<lt},Ps.overlaps=Hs,Ps.getNodeBBox=Sn,i.GeometryTypes=h,i.HGrid=class extends Fs{constructor(N,P,D=16,B=65536,$=Int32Array,H=16){super(),this._occupied=0,this._idToCode=new Oe,this._codeCache=[0,0,0],this.code=(X,lt,dt)=>dt|x(X,lt)<<this._bitsForZoom,this.decode=(X,lt)=>(x.reverse(X>>this._bitsForZoom,lt),lt[2]=X&this._zoomMask,lt),this._intersects=N,this._getBounds=P,this._cells=new pt($),this._offset=B,this._maxLevels=H,this._mortonMax=(1<<this._maxLevels)-1,this._bitsForZoom=Math.log2(this._maxLevels),this._zoomMask=(1<<this._bitsForZoom)-1,this._objectsAtLevel=new Array(this._maxLevels).fill(0),this._min=-B,this._max=B,this._resolution=this._mortonMax/(this._max-this._min),this._minCellSize=D*this._resolution,this._bounds=new Array(4*this._maxLevels);for(let X=0;X<this._maxLevels;X++)this._bounds[4*X]=1/0,this._bounds[4*X+1]=1/0,this._bounds[4*X+2]=-1/0,this._bounds[4*X+3]=-1/0}setMinCellSize(N){return this._minCellSize=N,this}setOffset(N){return this._offset=N,this._min=-N,this._max=N,this._resolution=this._mortonMax/(this._max-this._min),this}insert(N,P,D,B,$){P===void 0&&([P,D,B,$]=this._getBounds(N));const H=Math.max(B-P,$-D);let X,lt=this._minCellSize;for(X=0;lt<H&&X<this._maxLevels-1;X++)lt*=2;const dt=this._resolution,ct=this._min,mt=dt*(.5*(B+P)-ct)/lt|0,yt=dt*(.5*($+D)-ct)/lt|0,kt=this.code(mt,yt,X);this._cells.has(kt)||this._cells.addEntry(kt),this._cells.addTo(kt,N),this._objectsAtLevel[X]++,this._occupied|=1<<X;const Tt=4*X,At=this._bounds;return mt<At[Tt]&&(At[Tt]=mt),yt<At[Tt+1]&&(At[Tt+1]=yt),mt>At[Tt+2]&&(At[Tt+2]=mt),yt>At[Tt+3]&&(At[Tt+3]=yt),this._idToCode.set(N,kt),kt}has(N){return this._idToCode.has(N)}update(N,P,D,B,$){return this.remove(N),this.insert(N,P,D,B,$)}remove(N){const P=this._idToCode.get(N);this.decode(P,this._codeCache);const D=this._codeCache[2];return--this._objectsAtLevel[D]==0&&(this._occupied&=~(1<<D),this._bounds[4*D]=1/0,this._bounds[4*D+1]=1/0,this._bounds[4*D+2]=-1/0,this._bounds[4*D+3]=-1/0),this._cells.removeFrom(P,N),this._idToCode.delete(N),this}query(N,P,D,B){const $=this._cells,H=this._bounds,X=this._intersects,lt=this._min,dt=this._resolution;let ct=this._minCellSize,mt=this._occupied;const yt=[];for(let kt=0;kt<this._maxLevels&&mt!==0;ct*=2,mt>>=1,kt++){if((1&mt)==0)continue;const Tt=1/ct,At=4*kt,Ut=Math.max(H[At],dt*(N-lt)*Tt-1>>0),he=Math.max(H[At+1],dt*(P-lt)*Tt-1>>0),xe=Math.min(H[At+2],dt*(D-lt)*Tt+1>>0),be=Math.min(H[At+3],dt*(B-lt)*Tt+1>>0);for(let ue=Ut;ue<=xe;ue++)for(let _e=he;_e<=be;_e++){const Te=this.code(ue,_e,kt);if(!$.has(Te))continue;const Ve=$.getItems(Te);if(Ve!==void 0)for(let Ie=0;Ie<Ve.length;Ie++){const je=Ve[Ie];X(je,N,P,D,B)&&yt.push(je)}}}return yt}traverse(N,P,D,B,$){const H=this._cells,X=this._bounds,lt=this._intersects,dt=this._min,ct=this._resolution;let mt=this._minCellSize,yt=this._occupied;const kt=[];for(let Tt=0;Tt<this._maxLevels&&yt!==0;mt*=2,yt>>=1,Tt++){if((1&yt)==0)continue;const At=1/mt,Ut=4*Tt,he=Math.max(X[Ut],ct*(N-dt)*At-1>>0),xe=Math.max(X[Ut+1],ct*(P-dt)*At-1>>0),be=Math.min(X[Ut+2],ct*(D-dt)*At+1>>0),ue=Math.min(X[Ut+3],ct*(B-dt)*At+1>>0);for(let _e=he;_e<=be;_e++)for(let Te=xe;Te<=ue;Te++){const Ve=this.code(_e,Te,Tt),Ie=H.getItems(Ve);if(Ie!==void 0)for(let je=0;je<Ie.length;je++){const Pe=Ie[je];if(lt(Pe,N,P,D,B)&&(kt.push(Pe),$(Pe)))return kt}}}return kt}collisions(N,P=this._getBounds){if(typeof P!="function")throw new Error("getBounds function is required to get the object bounds");const D=Array.from(this._idToCode.keys()),B=this._min,$=this._resolution,H=this._cells,X=new Oe,lt=[];for(let dt=0;dt<D.length;dt++){let ct=0,mt=this._minCellSize,yt=this._occupied;const kt=D[dt];let[Tt,At,Ut,he]=P(kt);const xe=Math.max(Ut-Tt,he-At);for(ct=0;mt<xe;ct++)mt*=2,yt>>=1;Tt=$*(Tt-B),At=$*(At-B),Ut=$*(Ut-B),he=$*(he-B);for(let be=ct;be<this._maxLevels&&yt!==0;mt*=2,yt>>=1,be++){if((1&yt)==0)continue;const ue=1/mt,_e=At*ue-1>>0,Te=Ut*ue+1>>0,Ve=he*ue+1>>0;for(let Ie=Tt*ue-1>>0;Ie<=Te;Ie++)for(let je=_e;je<=Ve;je++){const Pe=this.code(Ie,je,be);if(X.get(Pe)===dt)continue;X.set(Pe,dt);const Be=H.getItems(Pe);if(Be!==void 0)for(let Ue=0;Ue<Be.length;Ue++){const es=Be[Ue],[os,cs,Y,et]=this._getBounds(es);es!==kt&&N(kt,os,cs,Y,et)&&lt.push(kt,es)}}}}return(function(ct){const mt=new Cs,yt=[];for(let kt=0;kt<ct.length;kt+=2){const Tt=ct[kt],At=ct[kt+1],Ut=Tt<At?Tt*At+(At-Tt-1)*(At-Tt-1)/4:Tt*At+(Tt-At-1)*(Tt-At-1)/4;mt.has(Ut)||(mt.add(Ut),yt.push(Tt,At))}return yt})(lt)}clear(){this._occupied=0,this._cells.clear(),this._idToCode.clear(),this._objectsAtLevel=new Array(this._maxLevels).fill(0),this._bounds=new Array(4*this._maxLevels);for(let N=0;N<this._maxLevels;N++)this._bounds[4*N]=1/0,this._bounds[4*N+1]=1/0,this._bounds[4*N+2]=-1/0,this._bounds[4*N+3]=-1/0;return this}keyToBBox(N){const[P,D,B]=this.decode(N,[0,0,0]),$=this._minCellSize*(1<<B),H=this._min,X=this._resolution;return[P*$/X+H,D*$/X+H,(P+1)*$/X+H,(D+1)*$/X+H]}keys(){return this._cells.keys()}get averageCellOccupancy(){return this._cells.averageSize}get size(){return this._idToCode.size}getBoxes(){return Array.from(this._idToCode.keys()).map((N=>this._getBounds(N)))}},i.Quadtree=Ps,i.SGrid=class extends Fs{constructor(N,P,D){super();const B=this.cells=[];if(N instanceof ArrayBuffer){this.arrayBuffer=N;const H=new Int32Array(this.arrayBuffer);N=H[0],P=H[1],D=H[2],this.d=P+2*D;for(let dt=0;dt<this.d*this.d;dt++){const ct=H[3+dt],mt=H[3+dt+1];B.push(ct===mt?null:H.subarray(ct,mt))}const X=H[3+B.length],lt=H[3+B.length+1];this.keys=H.subarray(X,lt),this.bboxes=H.subarray(lt),this.insert=this._insertReadonly}else{this.d=P+2*D;for(let H=0;H<this.d*this.d;H++)B.push([]);this.keys=[],this.bboxes=[]}this.n=P,this.extent=N,this.padding=D,this.scale=P/N,this.uid=0;const $=D/P*N;this.min=-$,this.max=N+$}insert(N,P,D,B,$){return P===void 0&&([P,D,B,$]=this._getBounds(N)),this._forEachCell(P,D,B,$,this._insertCell,this.uid++),this.keys.push(N),this.bboxes.push(P),this.bboxes.push(D),this.bboxes.push(B),this.bboxes.push($),this}_insertReadonly(N,P,D,B,$){throw"Cannot insert into a GridIndex created from an ArrayBuffer."}_insertCell(N,P,D,B,$,H){this.cells[$].push(H)}query(N,P,D,B,$){const H=this.min,X=this.max;if(N<=H&&P<=H&&X<=D&&X<=B&&!$)return Array.prototype.slice.call(this.keys);{const lt=[],dt={};return this._forEachCell(N,P,D,B,this._queryCell,lt,dt,$),lt}}traverse(N,P,D,B,$,H){const X=this.min,lt=this.max;if(N<=X&&P<=X&&lt<=D&&lt<=B&&!H)return Array.prototype.slice.call(this.keys);{const dt=[],ct={};return this._forEachCell(N,P,D,B,this._queryCellEarlyStop,dt,ct,$,H),dt}}_queryCell(N,P,D,B,$,H,X,lt){const dt=this.cells[$];if(dt!==null){const ct=this.keys,mt=this.bboxes,yt=this._intersects;for(let kt=0;kt<dt.length;kt++){const Tt=dt[kt];if(X[Tt]===void 0){const At=4*Tt;!(lt?lt(mt[At+0],mt[At+1],mt[At+2],mt[At+3]):N<=mt[At+2]&&P<=mt[At+3]&&D>=mt[At+0]&&B>=mt[At+1])||yt&&!yt(Tt,N,P,D,B)?yt&&!yt(Tt,N,P,D,B)||(X[Tt]=!1):(X[Tt]=!0,H.push(ct[Tt]))}}}}_queryCellEarlyStop(N,P,D,B,$,H,X,lt,dt){const ct=this.cells[$];if(ct!==null){const mt=this.keys,yt=this.bboxes,kt=this._intersects;for(let Tt=0;Tt<ct.length;Tt++){const At=ct[Tt];if(X[At]===void 0){const Ut=4*At;if(!(dt?dt(yt[Ut+0],yt[Ut+1],yt[Ut+2],yt[Ut+3]):N<=yt[Ut+2]&&P<=yt[Ut+3]&&D>=yt[Ut+0]&&B>=yt[Ut+1])||kt&&!kt(At,N,P,D,B))kt&&!kt(At,N,P,D,B)||(X[At]=!1);else if(X[At]=!0,H.push(mt[At]),lt(At))return!0}}}}remove(N){throw new Error("Method not implemented yet.")}update(N,P,D,B,$){throw new Error("Method not implemented yet.")}clear(){const N=this.cells=[];if(this.arrayBuffer){for(let P=0;P<this.d*this.d;P++)N.push(null);this.keys=new Int32Array([]),this.bboxes=new Int32Array([])}else{for(let P=0;P<this.d*this.d;P++)N.push([]);this.keys=[],this.bboxes=[]}return this.uid=0,this}_forEachCell(N,P,D,B,$,H,X,lt,dt){const ct=this._convertToCellCoord(N),mt=this._convertToCellCoord(P),yt=this._convertToCellCoord(D),kt=this._convertToCellCoord(B);for(let Tt=ct;Tt<=yt;Tt++)for(let At=mt;At<=kt;At++){const Ut=this.d*At+Tt;if((!dt||dt(this._convertFromCellCoord(Tt),this._convertFromCellCoord(At),this._convertFromCellCoord(Tt+1),this._convertFromCellCoord(At+1)))&&$.call(this,N,P,D,B,Ut,H,X,lt,dt))return}}_convertFromCellCoord(N){return(N-this.padding)/this.scale}_convertToCellCoord(N){return Math.max(0,Math.min(this.d-1,Math.floor(N*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const N=this.cells,P=3+this.cells.length+1+1;let D=0;for(let H=0;H<this.cells.length;H++)D+=this.cells[H].length;const B=new Int32Array(P+D+this.keys.length+this.bboxes.length);B[0]=this.extent,B[1]=this.n,B[2]=this.padding;let $=P;for(let H=0;H<N.length;H++){const X=N[H];B[3+H]=$,B.set(X,$),$+=X.length}return B[3+N.length]=$,B.set(this.keys,$),$+=this.keys.length,B[3+N.length+1]=$,B.set(this.bboxes,$),$+=this.bboxes.length,B.buffer}},i.UBTree=Fe,i.morton=x,Object.defineProperty(i,"__esModule",{value:!0})},typeof t=="object"&&e!==void 0?n(t):typeof define=="function"&&define.amd?define(["exports"],n):n((s=typeof globalThis<"u"?globalThis:s||self).SpatialIndex={})}}),Rs=class{constructor(t){this._ogma=t}};function fd(t,e){for(let s=1,n=t.length;s<n;s++){const i=t[s];let r=s;for(;r>0&&e.get(t[r-1])>e.get(i);)t[r]=t[r-1],--r;t[r]=i}return t}function WI(t,e){for(let s=1,n=t.length;s<n;s++){const i=t[s];let r=s;for(;r>0&&e.get(t[r-1])<e.get(i);)t[r]=t[r-1],--r;t[r]=i}return t}function Fn(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Z_(t){return Array.isArray(t)?t:[t]}function oT(t){const e=[];for(let s=0;s<t.length;++s){const n=t[s];if(Array.isArray(n))for(let i=0;i<n.length;++i)e.push(n[i]);else e.push(n)}return e}function XI(...t){if(t.length===0)return[];const e=t[0].constructor;let s=0;for(const r of t)s+=r.length;const n=new e(s);let i=0;for(const r of t){for(let o=0;o<r.length;o++)n[i+o]=r[o];i+=r.length}return n}function ZI(t,e){const s=t.indexOf(e);return s!==-1&&(t.splice(s,1),!0)}function aT(t,e){let s,n,i=0,r=t.length-1;for(;i<=r;)if(s=(i+r)/2|0,n=t[s],n<e)i=s+1;else{if(!(n>e))return s;r=s-1}return-1}var qd=(t,e)=>{const s=new Array(t.length);for(let n=0;n<t.length;n++)s[n]=e[t[n]];return s};function KI(t){return typeof t=="number"&&t%1==0}function K_(t){return Array.isArray(t)?t.join("."):t}function Ba(t){if(!t)return[];if(typeof t=="string")return t.split(".");if(Array.isArray(t)){for(let e=0;e<t.length;++e)if(typeof t[e]!="string")throw new TypeError(`${t[e]} is not a string`);return t.slice()}throw new TypeError(`invalid property path "${t}": expected string or array of strings`)}function Yd(t,e,s){let n,i,r;if(e===0)return function(){t.apply(s,arguments)};const o=function(){n=!1,i&&(r.apply(s,i),i=null)};return r=function(){let a;return n?i=arguments:(a=t.apply(s,arguments),setTimeout(o,e),n=!0),a},r}function lT(t,e){let s,n=!1;return function i(){s?n=!0:s=setTimeout((()=>{if(s=null,n)return i(),void(n=!1);n=!1,t()}),e)}}function QI(t,e,s){let n,i,r,o,a;const l=e===0||e===void 0?100:e;function u(){const g=Date.now()-o;g<l&&g>=0?n=setTimeout(u,l-g):(n=null,s||(a=t.apply(r,i),r=i=null))}const h=function(){r=this,i=arguments,o=Date.now();const g=s&&!n;return n||(n=setTimeout(u,e)),g&&(a=t.apply(r,i),r=i=null),a};return h.clear=function(){n&&(clearTimeout(n),n=null)},h.flush=function(){n&&(a=t.apply(r,i),r=i=null,clearTimeout(n),n=null)},h}function uT(t,e,s,n,i){s(t[e],e,t,n,i).then((r=>{e===t.length-1?n(r):uT(t,e+1,s,n,i)})).catch(i)}function JI(t,e){return new Promise(((s,n)=>uT(t,0,e,s,n)))}function Of(){return new Uint8Array(new Uint32Array([305419896]).buffer)[0]===120}function dT(t){return t.reduce(((e,s)=>e.then(s)),Promise.resolve())}function Q_(t,e,s,n,i,r,o,a){return t+i+256*(e+r)+65536*(s+o)+16777216*(n+a)}function tR(t,e){return t<e?t*e+Math.pow(e-t-1,2)/4:t*e+Math.pow(t-e-1,2)/4}function Ua(t){return!(t===null||typeof t!="object"||Fn(t)||t instanceof RegExp||typeof HTMLElement<"u"&&t instanceof HTMLElement)}function Id(t){const e=Object.keys(t),s=new Array(e.length);for(let n=0;n<e.length;++n)s[n]=t[e[n]];return s}function kr(t,e,s){if(Array.isArray(t))return t.forEach(e,s);if(!Ua(t))throw new Error("forEach: invalid argument "+JSON.stringify(t));const n=Object.keys(t);if(s!==void 0)for(let i=0;i<n.length;++i){const r=n[i];e.call(s,t[r],r)}else for(let i=0;i<n.length;++i){const r=n[i];e(t[r],r)}}function Xs(t){if(Array.isArray(t)){const n=new Array(t.length);for(let i=0;i<t.length;++i)n[i]=Xs(t[i]);return n}if(!cn(t))return t;const e={},s=Object.keys(t);for(const n of s)e[n]=Xs(t[n]);return e}function eR(t,e){e.forEach((s=>{t.indexOf(s)===-1&&t.push(s)}))}function so(t,e,s){const n=typeof e=="string"?e.split("."):e;for(let i=0;i<n.length-1;++i){const r=n[i];let o=t[r];o||(o={},t[r]=o),t=o}t[n[n.length-1]]=s}function qs(t,e){const s=Ba(e);if(!s.length)return t;if(t){for(let n=0;n<s.length-1;++n){const i=t[s[n]];if(!i)return;t=i}return t[s[s.length-1]]}}function Wd(t,e,s="."){e||(e=r=>!Ua(r));const n={},i=Object.keys(t);for(let r=0;r<i.length;++r){const o=i[r],a=t[o];if(a instanceof Date)n[o]=a;else if(e(a))n[o]=a;else{const l=Wd(a,e),u=Object.keys(l);for(let h=0;h<u.length;h++){const g=u[h];n[`${o}${s}${g}`]=l[g]}}}return n}function J_(t){const e={},s=Object.keys(t);for(let n=0;n<s.length;++n){const i=s[n];so(e,i,t[i])}return e}function Ga(t,e,s=[]){const n=Object.keys(t);for(let i=0;i<n.length;++i){const r=n[i],o=t[r],a=e?e+r:r;cn(o)?Ga(o,a+".",s):s.push(a)}return s}var hT=Object.prototype.hasOwnProperty;function cT(t,e){const s=[t];let n;for(;s.length>0;)if(n=s.pop(),n)if(cn(n))for(const i in n)hT.call(n,i)&&s.push(n[i]);else e(n)}function sR(t){const e={};return cT(t,(s=>e[s.getName()]=s)),e}function Bf(t,e=[]){if(cn(t)){const s=Object.keys(t);for(const n of s)Bf(t[n],e)}else e.push(t);return e}function Uf(t){for(const e in t)typeof t[e]=="function"&&delete t[e];return t}function Ni(t,e){if(t===void 0)return Xs(e);if(!Ua(t))return t;const s={},n=Object.keys(e);for(const i of n){const r=e[i],o=t[i];Ua(r)?s[i]=Ni(o,r):s[i]=o===void 0?Xs(r):o}return s}function cn(t){return t&&(t.constructor===Object||!t.constructor)}function Kg(t,e){if(!cn(e)||!cn(t))return e;const s=Object.assign({},t),n=Object.keys(e);for(const i of n)s[i]=Kg(s[i],e[i]);return s}function ty(t,e){return e==null?t:e.reduce(((s,n)=>(s[n]=t[n],s)),{})}var Vl=(...t)=>{const e={};for(let s=0;s<t.length;s++){const n=t[s];for(const i in n)hT.call(n,i)&&(Array.isArray(e[i])&&Array.isArray(n[i])?e[i]=Array.from(new Set(e[i].concat(n[i]))):cn(e[i])&&cn(n[i])?e[i]=Vl(e[i],n[i]):e[i]=n[i])}return e},_h={};/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gf(t){if(t!==_h)throw new Error("Bad secret")}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nR(t,e){if(!rR(t)||e+1!==t.length)throw new TypeError(`
    ############################## ERROR ##############################

    It looks like you are trying to call a template tag function (fn\`...\`)
    using the normal function syntax (fn(...)), which is not supported.

    The functions in the safevalues library are not designed to be called
    like normal functions, and doing so invalidates the security guarantees
    that safevalues provides.

    If you are stuck and not sure how to proceed, please reach out to us
    instead through:
     - https://github.com/google/safevalues/issues

    ############################## ERROR ##############################`)}function pd(t){return Object.isFrozen(t)&&Object.isFrozen(t.raw)}function Ic(t){return t.toString().indexOf("`")===-1}var tE=Ic((t=>t``))||Ic((t=>t`\0`))||Ic((t=>t`\n`))||Ic((t=>t`\u0000`)),iR=pd``&&pd`\0`&&pd`\n`&&pd`\u0000`;function rR(t){return!(!Array.isArray(t)||!Array.isArray(t.raw))&&t.length===t.raw.length&&!(!tE&&t===t.raw)&&!!(tE&&!iR||pd(t))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Bm,oR="google#safe",aR=oR,lR=globalThis.trustedTypes,eE=lR;function uR(){let t=null;if(!eE)return t;try{const e=s=>s;t=eE.createPolicy(aR,{createHTML:e,createScript:e,createScriptURL:e})}catch(e){throw e}return t}function Lx(){return Bm===void 0&&(Bm=uR()),Bm}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Rc(t){return{valueOf:t}.valueOf()}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var gT=class{constructor(t,e){Gf(t),this.privateDoNotAccessOrElseWrappedHtml=e}toString(){return this.privateDoNotAccessOrElseWrappedHtml+""}},dR=gT;function hR(t){return new dR(_h,t)}function fT(t){const e=t,s=Lx();return hR(s?s.createHTML(e):e)}function cR(t){return t instanceof gT}function kx(t){if(cR(t))return t.privateDoNotAccessOrElseWrappedHtml;{let e="";throw e="Unexpected type when unwrapping SafeHtml",new Error(e)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var pT=class{constructor(t,e){Gf(t),this.privateDoNotAccessOrElseWrappedResourceUrl=e}toString(){return this.privateDoNotAccessOrElseWrappedResourceUrl+""}},gR=pT;function fR(t){return new gR(_h,t)}function pR(t){const e=t,s=Lx();return fR(s?s.createScriptURL(e):e)}function mR(t){return t instanceof pT}function xu(t){if(mR(t))return t.privateDoNotAccessOrElseWrappedResourceUrl;{let e="";throw e="Unexpected type when unwrapping TrustedResourceUrl",new Error(e)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Qg,sE,mT=class{constructor(t,e){Gf(t),this.privateDoNotAccessOrElseWrappedScript=e}toString(){return this.privateDoNotAccessOrElseWrappedScript+""}},_R=mT;function yR(t){return new _R(_h,t)}function Nx(t){const e=t,s=Lx();return yR(s?s.createScript(e):e)}function xR(t){return t instanceof mT}function _T(t){if(xR(t))return t.privateDoNotAccessOrElseWrappedScript;{let e="";throw e="Unexpected type when unwrapping SafeScript",new Error(e)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vR(t,e){e.appendChild(t);let s=new XMLSerializer().serializeToString(e);return s=s.slice(s.indexOf(">")+1,s.lastIndexOf("</")),fT(s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nE(t){try{return new URL(t,window.document.baseURI)}catch{return new URL("about:invalid")}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bR(t){let e;try{e=new URL(t)}catch{return"https:"}return e.protocol}(function(t){t[t.STYLE_ELEMENT=0]="STYLE_ELEMENT",t[t.STYLE_ATTRIBUTE=1]="STYLE_ATTRIBUTE",t[t.HTML_ATTRIBUTE=2]="HTML_ATTRIBUTE"})(Qg||(Qg={})),(function(t){t[t.AT_KEYWORD=0]="AT_KEYWORD",t[t.CDC=1]="CDC",t[t.CDO=2]="CDO",t[t.CLOSE_CURLY=3]="CLOSE_CURLY",t[t.CLOSE_PAREN=4]="CLOSE_PAREN",t[t.CLOSE_SQUARE=5]="CLOSE_SQUARE",t[t.COLON=6]="COLON",t[t.COMMA=7]="COMMA",t[t.DELIM=8]="DELIM",t[t.DIMENSION=9]="DIMENSION",t[t.EOF=10]="EOF",t[t.FUNCTION=11]="FUNCTION",t[t.HASH=12]="HASH",t[t.IDENT=13]="IDENT",t[t.NUMBER=14]="NUMBER",t[t.OPEN_CURLY=15]="OPEN_CURLY",t[t.OPEN_PAREN=16]="OPEN_PAREN",t[t.OPEN_SQUARE=17]="OPEN_SQUARE",t[t.PERCENTAGE=18]="PERCENTAGE",t[t.SEMICOLON=19]="SEMICOLON",t[t.STRING=20]="STRING",t[t.WHITESPACE=21]="WHITESPACE"})(sE||(sE={}));var ER=["data:","http:","https:","mailto:","ftp:"],SR=/^\s*(?!javascript:)(?:[\w+.-]+:|[^:/?#]*(?:[/?#]|$))/i;function AR(t){const e=!SR.test(t);return e&&console.error(`A URL with content '${t}' was sanitized away.`),e}function wR(t){if(!AR(t))return t}function yh(t){return wR(t)}function TR(t){const e=bR(t);return e!==void 0&&ER.indexOf(e.toLowerCase())!==-1?t:"about:invalid#zClosurez"}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var CR="display:inline-block;clip-path:inset(0);overflow:hidden;vertical-align:top;text-decoration:inherit",LR=`:host{${CR}}`;/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kR(t,e){return t.createContextualFragment(kx(e))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NR(t,e){if(e.defaultView)throw new Error("createInertFragment called with non-inert document");const s=e.createRange();return s.selectNode(e.body),kR(s,fT(t))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iE(t){const e=t.nodeName;return typeof e=="string"?e:"FORM"}function rE(t){return t.nodeType===3}function oE(t){const e=t.nodeType;return e===1||typeof e!="number"}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ts,Sr=class{constructor(t,e,s,n,i){this.allowedElements=t,this.elementPolicies=e,this.allowedGlobalAttributes=s,this.globalAttributePolicies=n,this.globallyAllowedAttributePrefixes=i}isAllowedElement(t){return t!=="FORM"&&(this.allowedElements.has(t)||this.elementPolicies.has(t))}getAttributePolicy(t,e){const s=this.elementPolicies.get(e);return s!=null&&s.has(t)?s.get(t):this.allowedGlobalAttributes.has(t)?{policyAction:Ts.KEEP}:this.globalAttributePolicies.get(t)||(this.globallyAllowedAttributePrefixes&&[...this.globallyAllowedAttributePrefixes].some((i=>t.indexOf(i)===0))?{policyAction:Ts.KEEP}:{policyAction:Ts.DROP})}};(function(t){t[t.DROP=0]="DROP",t[t.KEEP=1]="KEEP",t[t.KEEP_AND_SANITIZE_URL=2]="KEEP_AND_SANITIZE_URL",t[t.KEEP_AND_NORMALIZE=3]="KEEP_AND_NORMALIZE",t[t.KEEP_AND_SANITIZE_STYLE=4]="KEEP_AND_SANITIZE_STYLE",t[t.KEEP_AND_USE_RESOURCE_URL_POLICY=5]="KEEP_AND_USE_RESOURCE_URL_POLICY",t[t.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET=6]="KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET"})(Ts||(Ts={}));var MR=new Set(["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"]);function IR(t){return!MR.has(t.toUpperCase())&&/^[a-z][-_.a-z0-9]*-[-_.a-z0-9]*$/i.test(t)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var RR=["ARTICLE","SECTION","NAV","ASIDE","H1","H2","H3","H4","H5","H6","HEADER","FOOTER","ADDRESS","P","HR","PRE","BLOCKQUOTE","OL","UL","LH","LI","DL","DT","DD","FIGURE","FIGCAPTION","MAIN","DIV","EM","STRONG","SMALL","S","CITE","Q","DFN","ABBR","RUBY","RB","RT","RTC","RP","DATA","TIME","CODE","VAR","SAMP","KBD","SUB","SUP","I","B","U","MARK","BDI","BDO","SPAN","BR","WBR","NOBR","INS","DEL","PICTURE","PARAM","TRACK","MAP","TABLE","CAPTION","COLGROUP","COL","TBODY","THEAD","TFOOT","TR","TD","TH","SELECT","DATALIST","OPTGROUP","OPTION","OUTPUT","PROGRESS","METER","FIELDSET","LEGEND","DETAILS","SUMMARY","MENU","DIALOG","SLOT","CANVAS","FONT","CENTER","ACRONYM","BASEFONT","BIG","DIR","HGROUP","STRIKE","TT"],FR=[["A",new Map([["href",{policyAction:Ts.KEEP_AND_SANITIZE_URL}]])],["AREA",new Map([["href",{policyAction:Ts.KEEP_AND_SANITIZE_URL}]])],["LINK",new Map([["href",{policyAction:Ts.KEEP_AND_USE_RESOURCE_URL_POLICY,conditions:new Map([["rel",new Set(["alternate","author","bookmark","canonical","cite","help","icon","license","next","prefetch","dns-prefetch","prerender","preconnect","preload","prev","search","subresource"])]])}]])],["SOURCE",new Map([["src",{policyAction:Ts.KEEP_AND_USE_RESOURCE_URL_POLICY}],["srcset",{policyAction:Ts.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET}]])],["IMG",new Map([["src",{policyAction:Ts.KEEP_AND_USE_RESOURCE_URL_POLICY}],["srcset",{policyAction:Ts.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET}]])],["VIDEO",new Map([["src",{policyAction:Ts.KEEP_AND_USE_RESOURCE_URL_POLICY}]])],["AUDIO",new Map([["src",{policyAction:Ts.KEEP_AND_USE_RESOURCE_URL_POLICY}]])]],PR=["title","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-current","aria-disabled","aria-dropeffect","aria-expanded","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","alt","align","autocapitalize","autocomplete","autocorrect","autofocus","autoplay","bgcolor","border","cellpadding","cellspacing","checked","cite","color","cols","colspan","controls","controlslist","datetime","disabled","download","draggable","enctype","face","formenctype","frameborder","height","hreflang","hidden","ismap","label","lang","loop","max","maxlength","media","minlength","min","multiple","muted","nonce","open","placeholder","poster","preload","rel","required","reversed","role","rows","rowspan","selected","shape","size","sizes","slot","span","spellcheck","start","step","summary","translate","type","valign","value","width","wrap","itemscope","itemtype","itemid","itemprop","itemref"],zR=[["dir",{policyAction:Ts.KEEP_AND_NORMALIZE,conditions:Rc((()=>new Map([["dir",new Set(["auto","ltr","rtl"])]])))}],["async",{policyAction:Ts.KEEP_AND_NORMALIZE,conditions:Rc((()=>new Map([["async",new Set(["async"])]])))}],["loading",{policyAction:Ts.KEEP_AND_NORMALIZE,conditions:Rc((()=>new Map([["loading",new Set(["eager","lazy"])]])))}],["target",{policyAction:Ts.KEEP_AND_NORMALIZE,conditions:Rc((()=>new Map([["target",new Set(["_self","_blank"])]])))}]],DR=new Sr(new Set(RR),new Map(FR),new Set(PR),new Map(zR),void 0),OR=class{constructor(t,e,s,n,i,r){this.sanitizerTable=t,this.styleElementSanitizer=s,this.styleAttributeSanitizer=n,this.resourceUrlPolicy=i,this.openShadow=r,this.changes=[],Gf(e)}sanitizeAssertUnchanged(t){this.changes=[];const e=this.sanitize(t);if(this.changes.length!==0)throw new Error(`Unexpected change to HTML value as a result of sanitization. Input: "${t}", sanitized output: "${e}"
List of changes:${this.changes.join(`
`)}`);return e}sanitize(t){const e=document.implementation.createHTMLDocument("");return vR(this.sanitizeToFragmentInternal(t,e),e.body)}sanitizeToFragment(t){const e=document.implementation.createHTMLDocument("");return this.styleElementSanitizer&&this.styleAttributeSanitizer?this.sanitizeWithCssToFragment(t,e):this.sanitizeToFragmentInternal(t,e)}sanitizeWithCssToFragment(t,e){const s=document.createElement("safevalues-with-css"),n=this.openShadow?"open":"closed",i=s.attachShadow({mode:n}),r=this.sanitizeToFragmentInternal(t,e),o=document.createElement("style");o.textContent=LR,o.id="safevalues-internal-style",i.appendChild(o),i.appendChild(r);const a=e.createDocumentFragment();return a.appendChild(s),a}sanitizeToFragmentInternal(t,e){const s=NR(t,e),n=document.createTreeWalker(s,5,(a=>this.nodeFilter(a)));let i=n.nextNode();const r=e.createDocumentFragment();let o=r;for(;i!==null;){let a;if(rE(i))if(this.styleElementSanitizer&&o.nodeName==="STYLE"){const l=this.styleElementSanitizer(i.data);a=this.createTextNode(l)}else a=this.sanitizeTextNode(i);else{if(!oE(i)){let l="";throw l="Node is not of type text or element",new Error(l)}a=this.sanitizeElementNode(i,e)}if(o.appendChild(a),i=n.firstChild(),i)o=a;else for(;!(i=n.nextSibling())&&(i=n.parentNode());)o=o.parentNode}return r}createTextNode(t){return document.createTextNode(t)}sanitizeTextNode(t){return this.createTextNode(t.data)}sanitizeElementNode(t,e){const s=iE(t),n=e.createElement(s),i=t.attributes;for(const{name:r,value:o}of i){const a=this.sanitizerTable.getAttributePolicy(r,s);if(this.satisfiesAllConditions(a.conditions,i))switch(a.policyAction){case Ts.KEEP:Hr(n,r,o);break;case Ts.KEEP_AND_SANITIZE_URL:const l=TR(o);l!==o&&this.recordChange(`Url in attribute ${r} was modified during sanitization. Original url:"${o}" was sanitized to: "${l}"`),Hr(n,r,l);break;case Ts.KEEP_AND_NORMALIZE:Hr(n,r,o.toLowerCase());break;case Ts.KEEP_AND_SANITIZE_STYLE:this.styleAttributeSanitizer?Hr(n,r,this.styleAttributeSanitizer(o)):Hr(n,r,o);break;case Ts.KEEP_AND_USE_RESOURCE_URL_POLICY:if(this.resourceUrlPolicy){const u={type:Qg.HTML_ATTRIBUTE,attributeName:r,elementName:s},h=nE(o),g=this.resourceUrlPolicy(h,u);g&&Hr(n,r,g.toString())}else Hr(n,r,o);break;case Ts.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET:if(this.resourceUrlPolicy){const u={type:Qg.HTML_ATTRIBUTE,attributeName:r,elementName:s},h=BR(o),g={parts:[]};for(const f of h.parts){const p=nE(f.url),y=this.resourceUrlPolicy(p,u);y&&g.parts.push({url:y.toString(),descriptor:f.descriptor})}Hr(n,r,UR(g))}else Hr(n,r,o);break;case Ts.DROP:this.recordChange(`Attribute: ${r} was dropped`);break;default:GR(a.policyAction,"Unhandled AttributePolicyAction case")}else this.recordChange(`Not all conditions satisfied for attribute: ${r}.`)}return n}nodeFilter(t){if(rE(t))return 1;if(!oE(t))return 2;const e=iE(t);return e===null?(this.recordChange(`Node name was null for node: ${t}`),2):this.sanitizerTable.isAllowedElement(e)?1:(this.recordChange(`Element: ${e} was dropped`),2)}recordChange(t){this.changes.push(t)}satisfiesAllConditions(t,e){var s;if(!t)return!0;for(const[n,i]of t){const r=(s=e.getNamedItem(n))===null||s===void 0?void 0:s.value;if(r&&!i.has(r))return!1}return!0}};function Hr(t,e,s){t.setAttribute(e,s)}function BR(t){const e=[];for(const s of t.split(",")){const[n,i]=s.trim().split(/\s+/,2);e.push({url:n,descriptor:i})}return{parts:e}}function UR(t){return t.parts.map((e=>{const{url:s,descriptor:n}=e;return`${s}${n?` ${n}`:""}`})).join(" , ")}function GR(t,e=`unexpected value ${t}!`){throw new Error(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var VR=class{constructor(){this.calledBuild=!1,this.sanitizerTable=DR}onlyAllowElements(t){const e=new Set,s=new Map;for(let n of t){if(n=n.toUpperCase(),!this.sanitizerTable.isAllowedElement(n))throw new Error(`Element: ${n}, is not allowed by html5_contract.textpb`);const i=this.sanitizerTable.elementPolicies.get(n);i!==void 0?s.set(n,i):e.add(n)}return this.sanitizerTable=new Sr(e,s,this.sanitizerTable.allowedGlobalAttributes,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowCustomElement(t,e){const s=new Set(this.sanitizerTable.allowedElements),n=new Map(this.sanitizerTable.elementPolicies);if(!IR(t=t.toUpperCase()))throw new Error(`Element: ${t} is not a custom element`);if(e){const i=new Map;for(const r of e)i.set(r.toLowerCase(),{policyAction:Ts.KEEP});n.set(t,i)}else s.add(t);return this.sanitizerTable=new Sr(s,n,this.sanitizerTable.allowedGlobalAttributes,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}onlyAllowAttributes(t){const e=new Set,s=new Map,n=new Map;for(const i of t)this.sanitizerTable.allowedGlobalAttributes.has(i)&&e.add(i),this.sanitizerTable.globalAttributePolicies.has(i)&&s.set(i,this.sanitizerTable.globalAttributePolicies.get(i));for(const[i,r]of this.sanitizerTable.elementPolicies.entries()){const o=new Map;for(const[a,l]of r.entries())t.has(a)&&o.set(a,l);n.set(i,o)}return this.sanitizerTable=new Sr(this.sanitizerTable.allowedElements,n,e,s,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowDataAttributes(t){if(t===void 0){const s=new Set(this.sanitizerTable.globallyAllowedAttributePrefixes);return s.add("data-"),this.sanitizerTable=new Sr(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,this.sanitizerTable.allowedGlobalAttributes,this.sanitizerTable.globalAttributePolicies,s),this}const e=new Set(this.sanitizerTable.allowedGlobalAttributes);for(const s of t){if(s.indexOf("data-")!==0)throw new Error(`data attribute: ${s} does not begin with the prefix "data-"`);e.add(s)}return this.sanitizerTable=new Sr(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,e,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowStyleAttributes(){const t=new Map(this.sanitizerTable.globalAttributePolicies);return t.set("style",{policyAction:Ts.KEEP_AND_SANITIZE_STYLE}),this.sanitizerTable=new Sr(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,this.sanitizerTable.allowedGlobalAttributes,t,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowClassAttributes(){const t=new Set(this.sanitizerTable.allowedGlobalAttributes);return t.add("class"),this.sanitizerTable=new Sr(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,t,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowIdAttributes(){const t=new Set(this.sanitizerTable.allowedGlobalAttributes);return t.add("id"),this.sanitizerTable=new Sr(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,t,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowIdReferenceAttributes(){const t=new Set(this.sanitizerTable.allowedGlobalAttributes);return t.add("aria-activedescendant").add("aria-controls").add("aria-labelledby").add("aria-owns").add("for").add("list"),this.sanitizerTable=new Sr(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,t,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}withResourceUrlPolicy(t){return this.resourceUrlPolicy=t,this}},jR=class extends VR{build(){if(this.calledBuild)throw new Error("this sanitizer has already called build");return this.calledBuild=!0,new OR(this.sanitizerTable,_h,void 0,void 0,this.resourceUrlPolicy)}};/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HR(t){const e=_T(t).toString(),s=new Blob([e],{type:"text/javascript"});return pR(URL.createObjectURL(s))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ju(t,...e){if(e.some((s=>s!=="")))throw new Error("safeScript only allows empty string expressions to enable inline comments.");return nR(t,e.length),Nx(t.join(""))}function $R(t){return Nx(t.map(_T).join(""))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yT(t,e){const s=yh(e);s!==void 0&&(t.href=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qR(t,e){const s=yh(e);s!==void 0&&(t.href=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YR(t,e){t.href=xu(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WR(t,e){const s=yh(e);s!==void 0&&(t.formAction=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XR(t,e){t.src=xu(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZR(t,e){const s=yh(e);s!==void 0&&(t.action=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KR(t,e){t.src=xu(e).toString()}function QR(t,e){t.srcdoc=kx(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JR(t,e){const s=yh(e);s!==void 0&&(t.formAction=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tF(t,e){t.data=xu(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eF(t){return sF("script",t)}function sF(t,e=document){var s;const n=(s=e.querySelector)===null||s===void 0?void 0:s.call(e,`${t}[nonce]`);return n==null?"":n.nonce||n.getAttribute("nonce")||""}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nF(t){const e=eF(t.ownerDocument);e&&t.setAttribute("nonce",e)}function iF(t,e,s){t.src=xu(e),nF(t)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xT(t,e){oF(t)&&rF(t),t.innerHTML=kx(e)}function rF(t){let e="";const s=t.tagName;if(/^(script|style)$/i.test(s))throw e=s.toLowerCase()==="script"?"Use setScriptTextContent with a SafeScript.":"Use setStyleTextContent with a SafeStyleSheet.",new Error(e)}function oF(t){return t.nodeType===1}function aF(t,e,s){if(t.namespaceURI!=="http://www.w3.org/1999/xhtml")throw new Error(`Cannot set attribute '${e}' on '${t.tagName}'.Element is not in the HTML namespace`);switch(e=e.toLowerCase(),`${t.tagName} ${e}`){case"A href":return void yT(t,s);case"AREA href":return void qR(t,s);case"BASE href":return void YR(t,s);case"BUTTON formaction":return void WR(t,s);case"EMBED src":return void XR(t,s);case"FORM action":return void ZR(t,s);case"IFRAME src":return void KR(t,s);case"IFRAME srcdoc":return void QR(t,s);case"IFRAME sandbox":throw new Error("Can't set 'sandbox' on iframe tags. Use setIframeSrcWithIntent or setIframeSrcdocWithIntent instead");case"INPUT formaction":return void JR(t,s);case"LINK href":throw new Error("Can't set 'href' attribute on link tags. Use setLinkHrefAndRel instead");case"LINK rel":throw new Error("Can't set 'rel' attribute on link tags. Use setLinkHrefAndRel instead");case"OBJECT data":return void tF(t,s);case"SCRIPT src":return void iF(t,s);default:if(/^on./.test(e))throw new Error(`Attribute "${e}" looks like an event handler attribute. Please use a safe alternative like addEventListener instead.`);t.setAttribute(e,s)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lF(t,e){return new Worker(xu(t),e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var uF=typeof global=="object"&&global!==null&&global.it!==void 0,oo=typeof document<"u",Yo=typeof window<"u",Vf=Yo&&!window.__OGMA_HEADLESS,jf=Vf&&oo,dF=typeof navigator<"u"&&navigator.userAgent!==void 0?navigator.userAgent.toLowerCase():"",hF=Yo&&/mac/.test(dF),vT=typeof performance<"u"&&performance.now?()=>0|performance.now():()=>Date.now(),cF=vT();function $n(){return vT()-cF}function bT(){const t=new Date,e=t.getDate(),s=t.getMonth()+1;return`${t.getFullYear()}-${s<10?"0"+s:s}-${e<10?"0"+e:e}`}function ET(){const t=new Date;return`[${Fc((t.getUTCHours()-(t.getTimezoneOffset()/60|0))%24)}:${Fc(t.getUTCMinutes())}:${Fc(t.getUTCSeconds())}:${Fc(t.getUTCMilliseconds(),3)}]`}function Fc(t,e=2){let s=Math.pow(10,e-1),n=String(t);for(;s>1;)t<s&&(n="0"+n),s/=10;return n}function $o(t){uF||console.warn(ET()+" "+t)}function gF(t,e){e.forEach((s=>{Object.getOwnPropertyNames(s.prototype).forEach((n=>{Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(s.prototype,n)||Object.create(null))}))}))}var as=()=>{},Jg=()=>!1,Mx=()=>!0,tf=()=>null,ur=t=>t;function ST(t,e,s){const n=t.getObjectList(e.isNode);for(let i=0;i<e._indexes.length;++i){const r=e._indexes[i];s(n.get(r),i,e)}}function AT(t,e,s){const n=new Array(e.size),i=t.getObjectList(e.isNode);for(let r=0;r<e._indexes.length;++r){const o=e._indexes[r],a=i.get(o);n[r]=s(a,r,e)}return n}function wT(t,e,s){s=s||Mx;const n=e.isNode,i=t.acquireIndexList(n),r=t.getObjectList(n),o=t.getListFactory(n);for(let a=0;a<e._indexes.length;++a){const l=e._indexes[a],u=r.get(l);u&&s(u,a,e)&&i.push(l)}return o(i.sliceAndReset())}function TT(t,e,s){const n=t.getObjectList(e.isNode);for(let i=0;i<e._indexes.length;++i){const r=e._indexes[i];if(!s(n.get(r),i,e))return!1}return!0}function CT(t,e,s){const n=t.getObjectList(e.isNode);for(let i=0;i<e._indexes.length;++i){const r=e._indexes[i];if(s(n.get(r),i,e))return!0}return!1}function LT(t,e,s){const n=t.getObjectList(e.isNode);for(let i=0;i<e._indexes.length;++i){const r=e._indexes[i],o=n.get(r);if(s(o,i,e))return o}}function kT(t,e,s,n){const i=t.getListFactory(e.isNode);if(!s)return{valid:e,invalid:i()};const r=t.acquireIndexList(e.isNode),o=t.acquireIndexList(e.isNode),a=t.getObjectList(e.isNode);for(let l=0;l<e._indexes.length;l++){const u=e._indexes[l],h=a.get(u);h!==void 0&&(s(h,n)?r:o).pushUnchecked(u)}return{valid:i(r.sliceAndReset()),invalid:i(o.sliceAndReset())}}function NT(t,e,s,n){const i=t.getObjectList(e.isNode);let r=n;for(let o=0;o<e._indexes.length;++o){const a=e._indexes[o];r=s(r,i.get(a),o)}return r}function MT(t,e){const s=e.isNode,n=t.topology.getDeduper(s),i=t.acquireIndexList(s),r=t.getListFactory(s);for(let o=0;o<e._indexes.length;o++){const a=e._indexes[o];n.get(a)===0&&(n.set(a,1),i.push(a))}return r(i.sliceAndReset())}function IT(t,e,s){const n=e.isNode,i=s.topology.getDeduper(n),r=s.acquireIndexList(n),o=s.getListFactory(n);for(let a=0;a<e._indexes.length;a++){const l=e._indexes[a];i.set(l,1)}for(let a=0;a<t._indexes.length;a++){const l=t._indexes[a];i.get(l)===0&&r.push(l)}return o(r.sliceAndReset())}function RT(t,e){const s=e.isNode,n=t.storage.fetch(s),i=n.getFlexArray("excluded"),r=n.getMaxIndex(),o=t.topology.getDeduper(s),a=t.acquireIndexList(s),l=t.getListFactory(s);for(let u=0;u<e._indexes.length;u++)o.set(e._indexes[u],1);for(let u=1;u<=r;++u)o.get(u)===0&&i.get(u)===0&&a.push(u);return l(a.sliceAndReset())}function FT(t,e,s){const n=t.getListFactory(e.isNode),i=new Uint32Array(e._indexes.length+s._indexes.length);return i.set(e._indexes),i.set(s._indexes,e._indexes.length),n(i)}function PT(t,e){return t.getObjectList(e.isNode).getMultiple(e._indexes)}function Hf(t,e){const s=t.getStorage(e.isNode);if(e.isList){const n=new Array(e.size);for(let i=0;i<e._indexes.length;++i)n[i]=s.getId(e._indexes[i]);return n}return s.getId(e._index)}function zT(t,e){return t.topology.getExtremity(!0,e)}function DT(t,e){return t.topology.getExtremity(!1,e)}function OT(t,e,s){return t.getObjectList(e.isNode).get(e._indexes[s])}function BT(t,e,s){const n=t.getListFactory(e.isNode),i=t.getObjectList(e.isNode),r=e._indexes.slice();return r.sort(((o,a)=>{const l=i.get(o),u=i.get(a);return s(l,u)})),n(r)}var fF=[];function UT(t){typeof t=="object"&&t!==null||(t={});const e=typeof t.data=="function"?t.data:ur;return{attributes:Array.isArray(t.attributes)?t.attributes:t.attributes||fF,data:e}}function $f(t,e){for(const s of t){const n=e;Object.keys(n).forEach((i=>{const r=n[i];s.prototype[i]=function(o,a){return $o(`Deprecated method "${i}"; please use "${r}" instead.`),this[r](o,a)}}))}}function aE(t){const e=t.getFlexArray("removed"),s=t.getFlexArray("excluded"),n=t.getFlexArray("virtual");return{all:i=>e.get(i)===0,visible:i=>s.get(i)===0,excluded:i=>s.get(i)===1,raw:i=>n.get(i)===0&&e.get(i)===0,_all:i=>!0}}function lE(t,e,s){return{all:Pc(s.all,t,e),visible:Pc(s.visible,t,e),raw:Pc(s.raw,t,e),_all:Pc(s._all,t,e)}}function Pc(t,e,s){let n=null;return{getList(){if(!n){const i=e(),r=s();r.reset();for(let o=1;o<=i;++o)t(o)&&r.push(o);n=r.sliceAndReset()}return n},invalidList(){n=null}}}function pF(t){if(t===void 0)return Math.round(Math.random()*Number.MAX_SAFE_INTEGER);if(typeof t!="string"&&(typeof t!="number"||!isFinite(t)))throw new Error(`${t} is not a valid id, expected string or number`);return t}var uE=new Uint32Array(1),Mr=class{constructor(t,e){this.size=1,this.isNode=!1,this.isList=!1,this._index=t,this._ogma=e}get _indexes(){return uE[0]=this._index,uE}setAttributes(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)}setAttribute(t,e,s){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,s)}getAttributes(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)[0]}getAttribute(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)[0]}resetAttributes(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)}replaceOriginalAttributes(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)}getPreviousAttributes(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)[0]}isInView(t){return this._ogma.modules.locate.isElementInView(this,t)}hasParallelEdges(){return this._ogma.modules.graph.hasParallelEdges(this)}getParallelEdges(t){return this._ogma.modules.graph.getParallelEdges(this,t)}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)}getAdjacentElements(){const{nodes:t,edges:e}=this.fastGetAdjacentElements();return{nodes:t.dedupe(),edges:e.filter((s=>s!==this)).dedupe()}}isVisible(){return!this.isExcluded()}isExcluded(){return this._ogma.modules.graph.isExcluded(this)[0]}setExcluded(t){return this._ogma.modules.graph.setExcluded(this,t)}setVisible(t){return this.setExcluded(!t)}toList(){return this._ogma.modules.graph.edgeList(new Uint32Array([this._index]))}getId(){return Hf(this._ogma.modules.graph,this)}getSource(){return zT(this._ogma.modules.graph,this)}getTarget(){return DT(this._ogma.modules.graph,this)}getExtremities(){return this._ogma.modules.graph.nodeList(new Uint32Array([this.getSource()._index,this.getTarget()._index]))}setSource(t){this._ogma.modules.graph.setSource(this,t)}setTarget(t){this._ogma.modules.graph.setTarget(this,t)}slice(){return this.toList()}toJSON(t={}){const{attributes:e,data:s}=UT(t);return{id:this.getId(),source:this.getSource().getId(),target:this.getTarget().getId(),attributes:this.getAttributes(e),data:s(Xs(this.getData()))}}get(t){return t===0?this:void 0}setSelected(t){this._ogma.modules.selection.setActive(this,t)}isSelected(){return this._ogma.modules.selection.areActive(this)}locate(t){return this._ogma.modules.locate.locateElements(this,t)}getBoundingBox({includeTexts:t=!1,ignoreCurvature:e=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,t,t,e)}setData(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e),this}getData(t){return this._ogma.modules.data.getProperty(this,t||null)[0]}addClass(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)}addClasses(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)}removeClass(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)}removeClasses(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)}hasClass(t){return this._ogma.modules.classes.hasSingleElementClass(t,this)}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)[0]}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]}isVirtual(){return this._ogma.modules.transformations.isElementVirtual(this)}getTransformation(){return this._ogma.modules.transformations.getElementTransformation(this)}getMetaEdge(){return this._ogma.modules.transformations.getMetaEdge(this)}getSubEdges(){return this._ogma.modules.transformations.getSubEdges(this)}pulse(t){return this._ogma.modules.pulses.pulse(this,t)}};$f([Mr],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var qa=class{constructor(t,e){this.isList=!0,this.isNode=!1,this._indexes=t,this._ogma=e}get size(){return this._indexes.length}setAttributes(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)}setAttribute(t,e,s){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,s)}getAttributes(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)}getAttribute(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)}resetAttributes(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)}replaceOriginalAttributes(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)}getPreviousAttributes(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)}getPreviousAttribute(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)}getParallelEdges(t){return this._ogma.modules.graph.getParallelEdges(this,t)}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)}getAdjacentElements(){const{nodes:t,edges:e}=this.fastGetAdjacentElements();return{nodes:t.dedupe(),edges:e.subtract(this).dedupe()}}isVisible(){return this.isExcluded().map((t=>!t))}isExcluded(){return this._ogma.modules.graph.isExcluded(this)}isVirtual(){return this.map((t=>this._ogma.modules.transformations.isElementVirtual(t)))}setExcluded(t){return this._ogma.modules.graph.setExcluded(this,t)}setVisible(t){return this.setExcluded(!t)}toList(){return this}toArray(){return PT(this._ogma.modules.graph,this)}clone(){return this._ogma.modules.graph.edgeList(this._indexes.slice())}getId(){return Hf(this._ogma.modules.graph,this)}getSource(){return zT(this._ogma.modules.graph,this)}getTarget(){return DT(this._ogma.modules.graph,this)}getExtremities(){return this.getSource().concat(this.getTarget())}get(t){return OT(this._ogma.modules.graph,this,t)}forEach(t){ST(this._ogma.modules.graph,this,t)}map(t){return AT(this._ogma.modules.graph,this,t)}find(t){return LT(this._ogma.modules.graph,this,t)}some(t){return CT(this._ogma.modules.graph,this,t)}every(t){return TT(this._ogma.modules.graph,this,t)}[Symbol.iterator](){let t=-1;return{next:()=>({value:this.get(++t),done:t>=this.size})}}filter(t){return wT(this._ogma.modules.graph,this,t)}reduce(t,e){return NT(this._ogma.modules.graph,this,t,e)}concat(t){return FT(this._ogma.modules.graph,this,t)}dedupe(){return MT(this._ogma.modules.graph,this)}subtract(t){return IT(this,t,this._ogma.modules.graph)}slice(t,e){return this._ogma.modules.graph.edgeList(this._indexes.slice(t,e))}indexOf(t){return t instanceof Mr?this._indexes.indexOf(t._index):-1}includes(t){return this.indexOf(t)!==-1}sort(t){return BT(this._ogma.modules.graph,this,t)}inverse(){return RT(this._ogma.modules.graph,this)}toJSON(t={}){return this.map((e=>e.toJSON(t)))}setSelected(t){this._ogma.modules.selection.setActive(this,t)}isSelected(){return this._ogma.modules.selection.areActive(this)}locate(t){return this._ogma.modules.locate.locateElements(this,t)}getBoundingBox({includeTexts:t=!1,ignoreCurvature:e=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,t,t,e)}setData(t,e){if(arguments.length<2&&(e=t,t=null),typeof e!="function"&&!Fn(e))throw new Error(`invalid argument ${e}; expected array or function`);return this._ogma.modules.data.setProperty(this,t,e,{dispatch:!0}),this}fillData(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e,{dispatch:!1}),this}getData(t){return this._ogma.modules.data.getProperty(this,t||null)}addClass(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)}addClasses(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)}removeClass(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)}removeClasses(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)}hasClass(t){return this.map((e=>this._ogma.modules.classes.hasSingleElementClass(t,e)))}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)}getMetaEdge(){return this._ogma.modules.transformations.getMetaEdges(this)}getSubEdges(){return this.map(this._ogma.modules.transformations.getSubEdges)}pulse(t){return this._ogma.modules.pulses.pulse(this,t)}};$f([qa],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var Tr="geo.latitude",Cr="geo.longitude",dE="geo.prevLat",Um="geo.prevLng",ey=85.0511287798,mF=6378137,ef=1,_F='Map data &copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap contributors</a>',La={latitudePath:"latitude",longitudePath:"longitude",maxZoomLevel:22,minZoomLevel:0,wrapCoordinates:!0,tileUrlTemplate:"https://{s}.tile.osm.org/{z}/{x}/{y}.png",tileUrlSubdomains:"abc",attribution:null,attributionOptions:void 0,backgroundColor:"silver",opacity:1,duration:0,disableNodeDragging:!0,tileBuffer:1,sizeRatio:1,tiles:{url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png",subdomains:"abc",tms:!1,wms:!1},crs:void 0},yF={maxBoundsViscosity:1,worldCopyJump:!0,zoomControl:!1,attributionControl:!1},xF=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let s=0;for(let n=0;n<this._n&&n<32;n++){const i=e[n],r=t+i,o=Math.abs(t)<Math.abs(i)?t-(r-i):i-(r-t);o&&(e[s++]=o),t=r}return e[s]=t,this._n=s+1,this}valueOf(){const t=this._partials;let e,s,n,i=this._n,r=0;if(i>0){for(r=t[--i];i>0&&(e=r,s=t[--i],r=e+s,n=s-(r-e),!n););i>0&&(n<0&&t[i-1]<0||n>0&&t[i-1]>0)&&(s=2*n,e=r+s,s==e-r&&(r=e))}return r}};function*vF(t){for(const e of t)yield*e}function GT(t){return Array.from(vF(t))}var Is=1e-6,ps=Math.PI,ji=ps/2,hE=ps/4,dr=2*ps,$r=180/ps,wi=ps/180,on=Math.abs,bF=Math.atan,ou=Math.atan2,Ys=Math.cos,js=Math.sin,EF=Math.sign||function(t){return t>0?1:t<0?-1:0},xh=Math.sqrt;function VT(t){return t>1?0:t<-1?ps:Math.acos(t)}function au(t){return t>1?ji:t<-1?-ji:Math.asin(t)}function md(){}function sf(t,e){t&&gE.hasOwnProperty(t.type)&&gE[t.type](t,e)}var cE={Feature:function(t,e){sf(t.geometry,e)},FeatureCollection:function(t,e){for(var s=t.features,n=-1,i=s.length;++n<i;)sf(s[n].geometry,e)}},gE={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var s=t.coordinates,n=-1,i=s.length;++n<i;)t=s[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){sy(t.coordinates,e,0)},MultiLineString:function(t,e){for(var s=t.coordinates,n=-1,i=s.length;++n<i;)sy(s[n],e,0)},Polygon:function(t,e){fE(t.coordinates,e)},MultiPolygon:function(t,e){for(var s=t.coordinates,n=-1,i=s.length;++n<i;)fE(s[n],e)},GeometryCollection:function(t,e){for(var s=t.geometries,n=-1,i=s.length;++n<i;)sf(s[n],e)}};function sy(t,e,s){var n,i=-1,r=t.length-s;for(e.lineStart();++i<r;)n=t[i],e.point(n[0],n[1],n[2]);e.lineEnd()}function fE(t,e){var s=-1,n=t.length;for(e.polygonStart();++s<n;)sy(t[s],e,1);e.polygonEnd()}function SF(t,e){t&&cE.hasOwnProperty(t.type)?cE[t.type](t,e):sf(t,e)}function ny(t){return[ou(t[1],t[0]),au(t[2])]}function lu(t){var e=t[0],s=t[1],n=Ys(s);return[n*Ys(e),n*js(e),js(s)]}function zc(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function nf(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Gm(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Dc(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function iy(t){var e=xh(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function ry(t,e){function s(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(s.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),s}function oy(t,e){return on(t)>ps&&(t-=Math.round(t/dr)*dr),[t,e]}function AF(t,e,s){return(t%=dr)?e||s?ry(mE(t),_E(e,s)):mE(t):e||s?_E(e,s):oy}function pE(t){return function(e,s){return on(e+=t)>ps&&(e-=Math.round(e/dr)*dr),[e,s]}}function mE(t){var e=pE(t);return e.invert=pE(-t),e}function _E(t,e){var s=Ys(t),n=js(t),i=Ys(e),r=js(e);function o(a,l){var u=Ys(l),h=Ys(a)*u,g=js(a)*u,f=js(l),p=f*s+h*n;return[ou(g*i-p*r,h*s-f*n),au(p*i+g*r)]}return o.invert=function(a,l){var u=Ys(l),h=Ys(a)*u,g=js(a)*u,f=js(l),p=f*i-g*r;return[ou(g*i+f*r,h*s+p*n),au(p*s-h*n)]},o}function wF(t,e,s,n,i,r){if(s){var o=Ys(e),a=js(e),l=n*s;i==null?(i=e+n*dr,r=e-l/2):(i=yE(o,i),r=yE(o,r),(n>0?i<r:i>r)&&(i+=n*dr));for(var u,h=i;n>0?h>r:h<r;h-=l)u=ny([o,-a*Ys(h),-a*js(h)]),t.point(u[0],u[1])}}function yE(t,e){(e=lu(e))[0]-=t,iy(e);var s=VT(-e[1]);return((-e[2]<0?-s:s)+dr-Is)%dr}function jT(){var t,e=[];return{point:function(s,n,i){t.push([s,n,i])},lineStart:function(){e.push(t=[])},lineEnd:md,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var s=e;return e=[],t=null,s}}}function zg(t,e){return on(t[0]-e[0])<Is&&on(t[1]-e[1])<Is}function Oc(t,e,s,n){this.x=t,this.z=e,this.o=s,this.e=n,this.v=!1,this.n=this.p=null}function HT(t,e,s,n,i){var r,o,a=[],l=[];if(t.forEach((function(y){if(!((_=y.length-1)<=0)){var _,x,v=y[0],b=y[_];if(zg(v,b)){if(!v[2]&&!b[2]){for(i.lineStart(),r=0;r<_;++r)i.point((v=y[r])[0],v[1]);return void i.lineEnd()}b[0]+=2*Is}a.push(x=new Oc(v,y,null,!0)),l.push(x.o=new Oc(v,null,x,!1)),a.push(x=new Oc(b,y,null,!1)),l.push(x.o=new Oc(b,null,x,!0))}})),a.length){for(l.sort(e),xE(a),xE(l),r=0,o=l.length;r<o;++r)l[r].e=s=!s;for(var u,h,g=a[0];;){for(var f=g,p=!0;f.v;)if((f=f.n)===g)return;u=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(p)for(r=0,o=u.length;r<o;++r)i.point((h=u[r])[0],h[1]);else n(f.x,f.n.x,1,i);f=f.n}else{if(p)for(u=f.p.z,r=u.length-1;r>=0;--r)i.point((h=u[r])[0],h[1]);else n(f.x,f.p.x,-1,i);f=f.p}u=(f=f.o).z,p=!p}while(!f.v);i.lineEnd()}}}function xE(t){if(e=t.length){for(var e,s,n=0,i=t[0];++n<e;)i.n=s=t[n],s.p=i,i=s;i.n=s=t[0],s.p=i}}function Vm(t){return on(t[0])<=ps?t[0]:EF(t[0])*((on(t[0])+ps)%dr-ps)}function TF(t,e){var s=Vm(e),n=e[1],i=js(n),r=[js(s),-Ys(s),0],o=0,a=0,l=new xF;i===1?n=ji+Is:i===-1&&(n=-ji-Is);for(var u=0,h=t.length;u<h;++u)if(f=(g=t[u]).length)for(var g,f,p=g[f-1],y=Vm(p),_=p[1]/2+hE,x=js(_),v=Ys(_),b=0;b<f;++b,y=A,x=L,v=I,p=S){var S=g[b],A=Vm(S),w=S[1]/2+hE,L=js(w),I=Ys(w),F=A-y,O=F>=0?1:-1,V=O*F,j=V>ps,Z=x*L;if(l.add(ou(Z*O*js(V),v*I+Z*Ys(V))),o+=j?F+O*dr:F,j^y>=s^A>=s){var at=nf(lu(p),lu(S));iy(at);var pt=nf(r,at);iy(pt);var K=(j^F>=0?-1:1)*au(pt[2]);(n>K||n===K&&(at[0]||at[1]))&&(a+=j^F>=0?1:-1)}}return(o<-Is||o<Is&&l<-1e-12)^1&a}function $T(t,e,s,n){return function(i){var r,o,a,l=e(i),u=jT(),h=e(u),g=!1,f={point:p,lineStart:_,lineEnd:x,polygonStart:function(){f.point=v,f.lineStart=b,f.lineEnd=S,o=[],r=[]},polygonEnd:function(){f.point=p,f.lineStart=_,f.lineEnd=x,o=GT(o);var A=TF(r,n);o.length?(g||(i.polygonStart(),g=!0),HT(o,LF,A,s,i)):A&&(g||(i.polygonStart(),g=!0),i.lineStart(),s(null,null,1,i),i.lineEnd()),g&&(i.polygonEnd(),g=!1),o=r=null},sphere:function(){i.polygonStart(),i.lineStart(),s(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function p(A,w){t(A,w)&&i.point(A,w)}function y(A,w){l.point(A,w)}function _(){f.point=y,l.lineStart()}function x(){f.point=p,l.lineEnd()}function v(A,w){a.push([A,w]),h.point(A,w)}function b(){h.lineStart(),a=[]}function S(){v(a[0][0],a[0][1]),h.lineEnd();var A,w,L,I,F=h.clean(),O=u.result(),V=O.length;if(a.pop(),r.push(a),a=null,V)if(1&F){if((w=(L=O[0]).length-1)>0){for(g||(i.polygonStart(),g=!0),i.lineStart(),A=0;A<w;++A)i.point((I=L[A])[0],I[1]);i.lineEnd()}}else V>1&&2&F&&O.push(O.pop().concat(O.shift())),o.push(O.filter(CF))}return f}}function CF(t){return t.length>1}function LF(t,e){return((t=t.x)[0]<0?t[1]-ji-Is:ji-t[1])-((e=e.x)[0]<0?e[1]-ji-Is:ji-e[1])}oy.invert=oy;var vE=$T((function(){return!0}),kF,MF,[-ps,-ji]);function kF(t){var e,s=NaN,n=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(r,o){var a=r>0?ps:-ps,l=on(r-s);on(l-ps)<Is?(t.point(s,n=(n+o)/2>0?ji:-ji),t.point(i,n),t.lineEnd(),t.lineStart(),t.point(a,n),t.point(r,n),e=0):i!==a&&l>=ps&&(on(s-i)<Is&&(s-=i*Is),on(r-a)<Is&&(r-=a*Is),n=NF(s,n,r,o),t.point(i,n),t.lineEnd(),t.lineStart(),t.point(a,n),e=0),t.point(s=r,n=o),i=a},lineEnd:function(){t.lineEnd(),s=n=NaN},clean:function(){return 2-e}}}function NF(t,e,s,n){var i,r,o=js(t-s);return on(o)>Is?bF((js(e)*(r=Ys(n))*js(s)-js(n)*(i=Ys(e))*js(t))/(i*r*o)):(e+n)/2}function MF(t,e,s,n){var i;if(t==null)i=s*ji,n.point(-ps,i),n.point(0,i),n.point(ps,i),n.point(ps,0),n.point(ps,-i),n.point(0,-i),n.point(-ps,-i),n.point(-ps,0),n.point(-ps,i);else if(on(t[0]-e[0])>Is){var r=t[0]<e[0]?ps:-ps;i=s*r/2,n.point(-r,i),n.point(0,i),n.point(r,i)}else n.point(e[0],e[1])}function IF(t){var e=Ys(t),s=2*wi,n=e>0,i=on(e)>Is;function r(l,u){return Ys(l)*Ys(u)>e}function o(l,u,h){var g=[1,0,0],f=nf(lu(l),lu(u)),p=zc(f,f),y=f[0],_=p-y*y;if(!_)return!h&&l;var x=e*p/_,v=-e*y/_,b=nf(g,f),S=Dc(g,x);Gm(S,Dc(f,v));var A=b,w=zc(S,A),L=zc(A,A),I=w*w-L*(zc(S,S)-1);if(!(I<0)){var F=xh(I),O=Dc(A,(-w-F)/L);if(Gm(O,S),O=ny(O),!h)return O;var V,j=l[0],Z=u[0],at=l[1],pt=u[1];Z<j&&(V=j,j=Z,Z=V);var K=Z-j,ut=on(K-ps)<Is;if(!ut&&pt<at&&(V=at,at=pt,pt=V),ut||K<Is?ut?at+pt>0^O[1]<(on(O[0]-j)<Is?at:pt):at<=O[1]&&O[1]<=pt:K>ps^(j<=O[0]&&O[0]<=Z)){var ht=Dc(A,(-w+F)/L);return Gm(ht,S),[O,ny(ht)]}}}function a(l,u){var h=n?t:ps-t,g=0;return l<-h?g|=1:l>h&&(g|=2),u<-h?g|=4:u>h&&(g|=8),g}return $T(r,(function(u){var h,g,f,p,y;return{lineStart:function(){p=f=!1,y=1},point:function(_,x){var v,b=[_,x],S=r(_,x),A=n?S?0:a(_,x):S?a(_+(_<0?ps:-ps),x):0;if(!h&&(p=f=S)&&u.lineStart(),S!==f&&(!(v=o(h,b))||zg(h,v)||zg(b,v))&&(b[2]=1),S!==f)y=0,S?(u.lineStart(),v=o(b,h),u.point(v[0],v[1])):(v=o(h,b),u.point(v[0],v[1],2),u.lineEnd()),h=v;else if(i&&h&&n^S){var w;A&g||!(w=o(b,h,!0))||(y=0,n?(u.lineStart(),u.point(w[0][0],w[0][1]),u.point(w[1][0],w[1][1]),u.lineEnd()):(u.point(w[1][0],w[1][1]),u.lineEnd(),u.lineStart(),u.point(w[0][0],w[0][1],3)))}!S||h&&zg(h,b)||u.point(b[0],b[1]),h=b,f=S,g=A},lineEnd:function(){f&&u.lineEnd(),h=null},clean:function(){return y|(p&&f)<<1}}}),(function(u,h,g,f){wF(f,t,s,g,u,h)}),n?[0,-t]:[-ps,t-ps])}function RF(t,e,s,n,i,r){var o,a=t[0],l=t[1],u=0,h=1,g=e[0]-a,f=e[1]-l;if(o=s-a,g||!(o>0)){if(o/=g,g<0){if(o<u)return;o<h&&(h=o)}else if(g>0){if(o>h)return;o>u&&(u=o)}if(o=i-a,g||!(o<0)){if(o/=g,g<0){if(o>h)return;o>u&&(u=o)}else if(g>0){if(o<u)return;o<h&&(h=o)}if(o=n-l,f||!(o>0)){if(o/=f,f<0){if(o<u)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>u&&(u=o)}if(o=r-l,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>u&&(u=o)}else if(f>0){if(o<u)return;o<h&&(h=o)}return u>0&&(t[0]=a+u*g,t[1]=l+u*f),h<1&&(e[0]=a+h*g,e[1]=l+h*f),!0}}}}}var _d=1e9,Bc=-_d;function FF(t,e,s,n){function i(u,h){return t<=u&&u<=s&&e<=h&&h<=n}function r(u,h,g,f){var p=0,y=0;if(u==null||(p=o(u,g))!==(y=o(h,g))||l(u,h)<0^g>0)do f.point(p===0||p===3?t:s,p>1?n:e);while((p=(p+g+4)%4)!==y);else f.point(h[0],h[1])}function o(u,h){return on(u[0]-t)<Is?h>0?0:3:on(u[0]-s)<Is?h>0?2:1:on(u[1]-e)<Is?h>0?1:0:h>0?3:2}function a(u,h){return l(u.x,h.x)}function l(u,h){var g=o(u,1),f=o(h,1);return g!==f?g-f:g===0?h[1]-u[1]:g===1?u[0]-h[0]:g===2?u[1]-h[1]:h[0]-u[0]}return function(u){var h,g,f,p,y,_,x,v,b,S,A,w=u,L=jT(),I={point:F,lineStart:function(){I.point=O,g&&g.push(f=[]),S=!0,b=!1,x=v=NaN},lineEnd:function(){h&&(O(p,y),_&&b&&L.rejoin(),h.push(L.result())),I.point=F,b&&w.lineEnd()},polygonStart:function(){w=L,h=[],g=[],A=!0},polygonEnd:function(){var j=(function(){for(var K=0,ut=0,ht=g.length;ut<ht;++ut)for(var nt,ot,Nt=g[ut],Q=1,Et=Nt.length,Xt=Nt[0],Ht=Xt[0],Zt=Xt[1];Q<Et;++Q)nt=Ht,ot=Zt,Ht=(Xt=Nt[Q])[0],Zt=Xt[1],ot<=n?Zt>n&&(Ht-nt)*(n-ot)>(Zt-ot)*(t-nt)&&++K:Zt<=n&&(Ht-nt)*(n-ot)<(Zt-ot)*(t-nt)&&--K;return K})(),Z=A&&j,at=(h=GT(h)).length;(Z||at)&&(u.polygonStart(),Z&&(u.lineStart(),r(null,null,1,u),u.lineEnd()),at&&HT(h,a,j,r,u),u.polygonEnd()),w=u,h=g=f=null}};function F(V,j){i(V,j)&&w.point(V,j)}function O(V,j){var Z=i(V,j);if(g&&f.push([V,j]),S)p=V,y=j,_=Z,S=!1,Z&&(w.lineStart(),w.point(V,j));else if(Z&&b)w.point(V,j);else{var at=[x=Math.max(Bc,Math.min(_d,x)),v=Math.max(Bc,Math.min(_d,v))],pt=[V=Math.max(Bc,Math.min(_d,V)),j=Math.max(Bc,Math.min(_d,j))];RF(at,pt,t,e,s,n)?(b||(w.lineStart(),w.point(at[0],at[1])),w.point(pt[0],pt[1]),Z||w.lineEnd(),A=!1):Z&&(w.lineStart(),w.point(V,j),A=!1)}x=V,v=j,b=Z}return I}}var bE=t=>t,uu=1/0,rf=uu,Xd=-uu,of=Xd,PF={point:zF,lineStart:md,lineEnd:md,polygonStart:md,polygonEnd:md,result:function(){var t=[[uu,rf],[Xd,of]];return Xd=of=-(rf=uu=1/0),t}};function zF(t,e){t<uu&&(uu=t),t>Xd&&(Xd=t),e<rf&&(rf=e),e>of&&(of=e)}var EE=PF;function Ix(t){return function(e){var s=new ay;for(var n in t)s[n]=t[n];return s.stream=e,s}}function ay(){}function Rx(t,e,s){var n=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),n!=null&&t.clipExtent(null),SF(s,t.stream(EE)),e(EE.result()),n!=null&&t.clipExtent(n),t}function qT(t,e,s){return Rx(t,(function(n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=Math.min(i/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),a=+e[0][0]+(i-o*(n[1][0]+n[0][0]))/2,l=+e[0][1]+(r-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,l])}),s)}function DF(t,e,s){return qT(t,[[0,0],e],s)}function OF(t,e,s){return Rx(t,(function(n){var i=+e,r=i/(n[1][0]-n[0][0]),o=(i-r*(n[1][0]+n[0][0]))/2,a=-r*n[0][1];t.scale(150*r).translate([o,a])}),s)}function BF(t,e,s){return Rx(t,(function(n){var i=+e,r=i/(n[1][1]-n[0][1]),o=-r*n[0][0],a=(i-r*(n[1][1]+n[0][1]))/2;t.scale(150*r).translate([o,a])}),s)}ay.prototype={constructor:ay,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var SE=16,UF=Ys(30*wi);function AE(t,e){return+e?VF(t,e):GF(t)}function GF(t){return Ix({point:function(e,s){e=t(e,s),this.stream.point(e[0],e[1])}})}function VF(t,e){function s(n,i,r,o,a,l,u,h,g,f,p,y,_,x){var v=u-n,b=h-i,S=v*v+b*b;if(S>4*e&&_--){var A=o+f,w=a+p,L=l+y,I=xh(A*A+w*w+L*L),F=au(L/=I),O=on(on(L)-1)<Is||on(r-g)<Is?(r+g)/2:ou(w,A),V=t(O,F),j=V[0],Z=V[1],at=j-n,pt=Z-i,K=b*at-v*pt;(K*K/S>e||on((v*at+b*pt)/S-.5)>.3||o*f+a*p+l*y<UF)&&(s(n,i,r,o,a,l,j,Z,O,A/=I,w/=I,L,_,x),x.point(j,Z),s(j,Z,O,A,w,L,u,h,g,f,p,y,_,x))}}return function(n){var i,r,o,a,l,u,h,g,f,p,y,_,x={point:v,lineStart:b,lineEnd:A,polygonStart:function(){n.polygonStart(),x.lineStart=w},polygonEnd:function(){n.polygonEnd(),x.lineStart=b}};function v(F,O){F=t(F,O),n.point(F[0],F[1])}function b(){g=NaN,x.point=S,n.lineStart()}function S(F,O){var V=lu([F,O]),j=t(F,O);s(g,f,h,p,y,_,g=j[0],f=j[1],h=F,p=V[0],y=V[1],_=V[2],SE,n),n.point(g,f)}function A(){x.point=v,n.lineEnd()}function w(){b(),x.point=L,x.lineEnd=I}function L(F,O){S(i=F,O),r=g,o=f,a=p,l=y,u=_,x.point=S}function I(){s(g,f,h,p,y,_,r,o,i,a,l,u,SE,n),x.lineEnd=A,A()}return x}}var jF=Ix({point:function(t,e){this.stream.point(t*wi,e*wi)}});function HF(t){return Ix({point:function(e,s){var n=t(e,s);return this.stream.point(n[0],n[1])}})}function $F(t,e,s,n,i){function r(o,a){return[e+t*(o*=n),s-t*(a*=i)]}return r.invert=function(o,a){return[(o-e)/t*n,(s-a)/t*i]},r}function wE(t,e,s,n,i,r){if(!r)return $F(t,e,s,n,i);var o=Ys(r),a=js(r),l=o*t,u=a*t,h=o/t,g=a/t,f=(a*s-o*e)/t,p=(a*e+o*s)/t;function y(_,x){return[l*(_*=n)-u*(x*=i)+e,s-u*_-l*x]}return y.invert=function(_,x){return[n*(h*_-g*x+f),i*(p-g*_-h*x)]},y}function qF(t){return YF((function(){return t}))()}function YF(t){var e,s,n,i,r,o,a,l,u,h,g=150,f=480,p=250,y=0,_=0,x=0,v=0,b=0,S=0,A=1,w=1,L=null,I=vE,F=null,O=bE,V=.5;function j(K){return l(K[0]*wi,K[1]*wi)}function Z(K){return(K=l.invert(K[0],K[1]))&&[K[0]*$r,K[1]*$r]}function at(){var K=wE(g,0,0,A,w,S).apply(null,e(y,_)),ut=wE(g,f-K[0],p-K[1],A,w,S);return s=AF(x,v,b),a=ry(e,ut),l=ry(s,a),o=AE(a,V),pt()}function pt(){return u=h=null,j}return j.stream=function(K){return u&&h===K?u:u=jF(HF(s)(I(o(O(h=K)))))},j.preclip=function(K){return arguments.length?(I=K,L=void 0,pt()):I},j.postclip=function(K){return arguments.length?(O=K,F=n=i=r=null,pt()):O},j.clipAngle=function(K){return arguments.length?(I=+K?IF(L=K*wi):(L=null,vE),pt()):L*$r},j.clipExtent=function(K){return arguments.length?(O=K==null?(F=n=i=r=null,bE):FF(F=+K[0][0],n=+K[0][1],i=+K[1][0],r=+K[1][1]),pt()):F==null?null:[[F,n],[i,r]]},j.scale=function(K){return arguments.length?(g=+K,at()):g},j.translate=function(K){return arguments.length?(f=+K[0],p=+K[1],at()):[f,p]},j.center=function(K){return arguments.length?(y=K[0]%360*wi,_=K[1]%360*wi,at()):[y*$r,_*$r]},j.rotate=function(K){return arguments.length?(x=K[0]%360*wi,v=K[1]%360*wi,b=K.length>2?K[2]%360*wi:0,at()):[x*$r,v*$r,b*$r]},j.angle=function(K){return arguments.length?(S=K%360*wi,at()):S*$r},j.reflectX=function(K){return arguments.length?(A=K?-1:1,at()):A<0},j.reflectY=function(K){return arguments.length?(w=K?-1:1,at()):w<0},j.precision=function(K){return arguments.length?(o=AE(a,V=K*K),pt()):xh(V)},j.fitExtent=function(K,ut){return qT(j,K,ut)},j.fitSize=function(K,ut){return DF(j,K,ut)},j.fitWidth=function(K,ut){return OF(j,K,ut)},j.fitHeight=function(K,ut){return BF(j,K,ut)},function(){return e=t.apply(this,arguments),j.invert=e.invert&&Z,at()}}function WF(t){return function(e,s){var n=Ys(e),i=Ys(s),r=t(n*i);return r===1/0?[2,0]:[r*i*js(e),r*js(s)]}}function XF(t){return function(e,s){var n=xh(e*e+s*s),i=t(n),r=js(i),o=Ys(i);return[ou(e*r,n*o),au(n&&s*r/n)]}}var YT=WF((function(t){return(t=VT(t))&&t/js(t)}));function ZF(){return qF(YT).scale(79.4188).clipAngle(179.999)}YT.invert=XF((function(t){return t}));var KF=(()=>{let t=0;return typeof requestAnimationFrame<"u"?requestAnimationFrame:function(e){const s=Date.now(),n=Math.min(16,Math.max(0,16-(s-t))),i=t=s+n;return setTimeout((()=>e(i)),n)}})(),WT=50,QF=typeof cancelAnimationFrame<"u"?cancelAnimationFrame:function(t){return clearTimeout(t)};function Fx(t,e){return KF((s=>{t.call(e,s)}))}function XT(t){t&&QF(t)}var jm,Va,Px,ZT,JF={},KT=JF,Dg={},QT={},ly=t=>null;if(typeof global=="object"&&(Dg=global),typeof window=="object"&&(QT=window),typeof Md=="object"&&typeof Md.require=="function"){const t=Md.require.bind(Md);ly=e=>{try{return t(e)}catch{return null}}}else typeof Dg.require=="function"&&(ly=t=>{const e=Dg.require;try{return e(t)}catch{return null}});function $i(t,{throwOnError:e}={}){let s=null;if(!s&&t&&(s=KT[t]),!s&&t&&(s=ly(t)),!s&&t&&(s=QT[t]),!s&&t&&(s=Dg[t]),!s&&e){const n=[`unable to find module "${t}"; make sure one of these statements is true:`,`- Ogma.libraries['${t}'] is set to the right library`,`- require('${t}') returns the right library`,`- window['${t}'] is set to the right library`].join(`
`);throw new Error(n)}return s}var or,JT=(or=class{constructor(){this.method=null,this.url=null,this.status=0,this.readyState=0,this.headers={},this.responseText=null,this.response=null,or.onCreate&&or.onCreate(this)}open(e,s){this.method=e,this.url=s,or.onSend&&or.onSend(this)}respond(e,s,n){this.readyState=4,this.status=e,this.headers=s,this.responseText=n,this.response=n,this.onreadystatechange()}send(){this.readyState=4}},or.onCreate=as,or.onSend=as,or),ar,t2=(ar=class{constructor(){this.onload=as,ar.onCreate&&ar.onCreate(this)}readAsDataURL(e){this._blob=e,ar.onRead&&ar.onRead(this)}load(e){this.result=typeof e=="function"?e(this._blob):e,this.onload&&this.onload()}},ar.onCreate=as,ar.onRead=as,ar);function ao(){return Va||{createElementNS:()=>null,createElement:()=>null,implementation:{createDocument(){throw new Error('unable to create XML document; if you use Node JS install the "xmldom" package')}}}}jm=$i("@xmldom/xmldom"),Va=oo?document:jm?new jm.DOMImplementation().createDocument():null,Px=typeof XMLHttpRequest<"u"?XMLHttpRequest:JT,ZT=typeof FileReader<"u"?FileReader:t2;var tP=class{observe(){}unobserve(){}disconnect(){}},eP=typeof ResizeObserver>"u"?tP:ResizeObserver,e2=t=>new eP(t);function s2(t,e){if(document&&document.defaultView){let s=t.style[e];if((!s||s==="auto")&&ao().defaultView){const n=document.defaultView.getComputedStyle(t,null);s=n?n[e]:null}return s==="auto"?null:s?s.toString():null}return null}var n2=class{constructor(){this.onmousewheel=as,this.__dummy=!0,this.style={},this.clientWidth=0,this.clientHeight=0,this.childNodes=[],this.style={width:"0px",height:"0px",top:void 0,left:void 0,position:"",backgroundColor:void 0}}get offsetWidth(){return parseFloat(this.style.width||"0")}get offsetHeight(){return parseFloat(this.style.height||"0")}get firstChild(){return null}get parentNode(){return null}get classList(){return{length:0,value:"",add(){},remove(){},contains:t=>!1,item:null}}get innerHTML(){return""}set innerHTML(t){}appendChild(t){return this.childNodes.push(t),t}removeChild(){}addEventListener(){}removeEventListener(){}insertBefore(){}contains(t){return!1}};function af(){return new n2}var vi=Yo?()=>window.devicePixelRatio:()=>1;function i2(t){const e=";base64,";let s,n,i;if(t.indexOf(e)===-1)return s=t.split(","),n=s[0].split(":")[1],i=decodeURIComponent(s[1]),Zd(i,n);s=t.split(e),n=s[0].split(":")[1],i=window.atob(s[1]);const r=i.length,o=new Uint8Array(r);for(let a=0;a<r;++a)o[a]=i.charCodeAt(a);return Zd([o],n)}var r2=class{constructor(t,e){this.data=t,this.type=e}};function Zd(t,e){return typeof Blob<"u"?new Blob(t,{type:e}):new r2(t,e)}function sP(t){return typeof Blob<"u"&&t instanceof Blob||t instanceof r2}function nP(t,e,s="text/plain"){return e==="blob"?t:e==="dataURL"?i2(t):Zd([t],s||"text/xml")}function ta(t,e,s="text",n="text/plain"){if(!Vf)return t;let i=null,r=null,o=null;window.Blob?(i=nP(t,s,n),r=URL.createObjectURL(i)):o="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(t);const a=document.createElement("a");return yT(a,r||o||""),a.setAttribute("download",e),document.body.appendChild(a),a.click(),document.body.removeChild(a),r&&setTimeout((()=>window.URL.revokeObjectURL(r)),0),t}function lf(t,e,s,n=vi()){if(ja(t,e+"px",s+"px"),t.tagName==="IMG"||t.tagName==="CANVAS"){const i=t;i.width=e*n,i.height=s*n}}function zx(t,e){kr(e,((s,n)=>{s!==void 0&&t.setAttribute(n,s)}))}var Dx="http://www.w3.org/2000/svg",uy="http://www.w3.org/2000/xmlns/",o2="http://www.w3.org/1999/xlink",iP=1;function ys(t,e){const s=Va.createElementNS(Dx,t);return s.style||(s.style={}),e&&zx(s,e),s}function dy(t){const e=Va.createElement("div");if(e.innerHTML=t.trim().replace(/\s+/g," "),!e.firstChild||e.firstChild.nodeType!==iP)throw new Error(`Failed to create element from: "${t}". Expected an HTML string`);return e.firstChild}function Ox(t){if(Va)return Va.createTextNode(t)}function a2(t){return typeof Image>"u"?Promise.resolve(null):new Promise((e=>{const s=new Image;s.src=t,s.onload=()=>e(s),s.onerror=()=>e(null)}))}function l2(t){if(t.indexOf("http://")===0||t.indexOf("https://")===0)return t;const e=window.location.origin;if(window.location.protocol==="blob:")return t;const s=window.location.pathname,n=s.lastIndexOf("/");return n===-1?e+"/"+t:e+s.substring(0,n)+"/"+t}function vu(t){return new Promise(((e,s)=>{const n=new Px;n.open("GET",l2(t),!0),n.onreadystatechange=function(){if(n.readyState===4){const i=n.status;i===200?e(n.responseText):s(i!==0?new Error(`cannot retrieve file at url "${t}"; the server responded with status code ${i}.`):new Error(`cannot send XMLHttpRequest to url "${t}"; if you're using the local file protocol this is most likely the cause.`))}},n.onerror=function(){s(new Error(`cannot retrieve file at url "${t}"; the XMLHttpRequest failed.`))},n.send()}))}function u2(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function uf(t,e){t.style.cursor=e,t.style.cursor!==e&&(t.style.cursor=`-webkit-${e}`)}function d2(t){return new Promise(((e,s)=>{const n=new Px;n.responseType="blob",n.open("GET",l2(t),!0),n.onreadystatechange=()=>{if(n.readyState===4){if(n.status===200)return e(n.response);s(n.status)}},n.onerror=i=>s(i),n.send()}))}function h2(t){return d2(t).then((e=>new Promise(((s,n)=>{const i=new ZT;i.onerror=n,i.onload=()=>s(i.result),i.readAsDataURL(e)}))))}function jl(t,e=!0){const s=e?"&#13;":`
`;return(""+t).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,s).replace(/[\r\n]/g,s)}var Bx={0:"left",1:"middle",2:"right"};function c2(t){if(t.baseURI)return t.baseURI;const e=t.getElementsByTagName("base");return e.length>0?e[0].href:t.URL||(t.location?t.location.href:"")}function g2(t,e,s,n){return new Promise((i=>{let r=e;const o=Date.now(),a=(s-e)*Math.min(1,1/(n/16));(function l(){Date.now()-o<n?(r=Math.min(1,Math.max(0,r+a)),t.style.opacity=r.toString(),Fx(l)):i()})()}))}function ja(t,e,s){t.style.width=e,t.style.height=s}var Ux=new jR().allowClassAttributes().allowDataAttributes().allowIdAttributes().allowStyleAttributes().build();function Vo(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function qi(t,e,s){return Math.max(e,Math.min(s,t))}function hy(t,e,s){return t+(e-t)*s}function bs(t,e,s){return t*(1-s)+e*s}function Hl(t){if(!t.length)return-1/0;let e=t[0];for(let s=1,n=t.length;s<n;++s){const i=t[s];i>e&&(e=i)}return e}function Kr(t){if(!t.length)return 1/0;let e=t[0];for(let s=1,n=t.length;s<n;++s){const i=t[s];i<e&&(e=i)}return e}var f2=(t,e)=>Math.log(t)/Math.log(e),df=t=>t<-Math.PI?t+2*Math.PI:t>Math.PI?t-2*Math.PI:t;function TE(t,e){t&&e!==void 0&&isFinite(e)&&t.setOpacity&&t.setOpacity(e)}function CE(){return Yo||typeof global<"u"&&!global.process}function Hm(t){return Math.log2(t)+ef}function rP(t){return 2**(t-ef)}function LE(t){return t!=null&&!isNaN(t)}function p2(t,e){return _2(t,e,"longitude")}function m2(t,e){return _2(t,e,"latitude")}function _2(t,e,s){if(isNaN(e))throw new TypeError(`node ${t}: ${e} is not a valid ${s}`)}var oP=t=>Math.pow(2,Math.ceil(Math.log2(t)));function aP(t,e){return e==null&&t.url===La.tiles.url?_F:null}function lP(t={},e){const{tileUrlSubdomains:s,tileUrlTemplate:n,attribution:i,attributionOptions:r,latitudePath:o,longitudePath:a,sizeRatio:l,tiles:u}=t;if(n!=null&&typeof n!="string")throw new TypeError("Geo mode: tileUrlTemplate must be a URL string");if(s!=null&&typeof s!="string")throw new TypeError("Geo mode: tileUrlTemplate must be a string");if(u!=null){if(!(cn(u)||u instanceof e.Layer))throw new TypeError("Geo mode: tiles must be a object or L.Layer instance");const h=u;if(h.url!=null&&typeof h.url!="string")throw new TypeError("Geo mode: tiles.url must be a string");if(h.subdomains!=null&&typeof h.subdomains!="string")throw new TypeError("Geo mode: tiles.subdomains must be a string");if(h.tms&&typeof h.tms!="boolean")throw new TypeError("Geo mode: tiles.tms must be a boolean");if(h.wms&&typeof h.wms!="boolean")throw new TypeError("Geo mode: tiles.wms must be a boolean")}if(i!=null&&typeof i!="string")throw new TypeError("Geo mode: Map attribution must be a string");if(r!=null&&!cn(r))throw new TypeError("Geo mode: attributionOptions must to be a BrandOptions object");if(o!=null&&typeof o!="string"&&!Array.isArray(o))throw new TypeError("Geo mode: Latitude path must be a valid property path: a string or an array of strings.");if(a!=null&&typeof a!="string"&&!Array.isArray(a))throw new TypeError("Geo mode: Longitude path must be a valid property path: a string or an array of strings.");if(l!=null&&(!isFinite(l)||l<=0))throw new TypeError("Geo mode: sizeRatio must be a positive number.")}function uP(t,e={}){if(e.tiles===void 0||e.tileUrlTemplate||e.tileUrlSubdomains){const s=La.tiles;return{...e.tiles||{},...La.tiles,url:e.tileUrlTemplate||s.url,subdomains:e.tileUrlSubdomains||s.subdomains}}return cn(e.tiles)?{...t.tiles,...e.tiles}:e.tiles}function dP(t,e){return t.attribution!==e.attribution||t.tiles!==e.tiles}var hP=ao().createElement("div");function cP(t){const e=ao().createElement("div");e.className="ogma-geo-container",ja(e,"100%","100%");const s=t||hP;return s.insertBefore(e,s.firstChild),e}function gP(t){const e=[[1/0,1/0],[-1/0,-1/0]];return t.getGeoCoordinates().reduce(((s,{latitude:n,longitude:i})=>{const[r,o]=s;return r[0]=Math.min(r[0],n),r[1]=Math.min(r[1],i),o[0]=Math.max(o[0],n),o[1]=Math.max(o[1],i),s}),e)}function fP(t,e,s,n){const i=e._indexes;t.getNodeAttribute(Tr).setMultiple(i,s),t.getNodeAttribute(Cr).setMultiple(i,n)}function pP(t,e,s){const{longitudePath:n,latitudePath:i,wrapCoordinates:r}=s,[o,a]=t.getAttributes(!0,[Tr,Cr]),l=e._indexes,u=e.getId(),h=l.length,g=e.getData(i),f=e.getData(n);for(let p=0;p<h;p++){let y=f[p],_=g[p];const x=l[p],v=u[p];_!=null&&y!=null&&(p2(v,y),m2(v,_),r&&(y%=180,_=qi(+_,-ey,ey)),a.set(x,y),o.set(x,_))}}function mP(t,{longitudePath:e,latitudePath:s,wrapCoordinates:n},i){const r=t.getData(e),o=t.getData(s);return r!=null&&o!=null&&(!(!n&&!i)||Math.abs(o)<=ey&&Math.abs(r)<=180)}function Uc(t,e,s,n){_P(t,!0,e,s,n)}function _P(t,e,s,n,i){const r=t.getAttribute(e,n),o=t.getAttribute(e,i),a=s._indexes;o.setMultiple(a,r.getMultiple(a))}function yP(t){return t.reduce(((e,{nodes:s,newValues:n})=>{if(!s)return e;const i=s.filter(((r,o)=>n[o]!=null));return e?e.concat(i):i}),null)}function xP(t,e){return t.getAttributes(["text.minVisibleSize","text.size","text.scale","radius"]).forEach((({text:s,radius:n},i)=>{e[t.get(i).getId()]={"text.minVisibleSize":s.minVisibleSize,"text.size":s.size,"text.scale":s.scale,minVisibleSize:s.minVisibleSize,size:Math.max(1,Number(n))}})),e}function kE(t,e){return t.getAttributes(["text.minVisibleSize","text.size","text.scale","minVisibleSize","width"]).forEach((({text:s,minVisibleSize:n,width:i},r)=>{e[t.get(r).getId()]={"text.minVisibleSize":s.minVisibleSize,"text.size":s.size,"text.scale":s.scale,minVisibleSize:n,size:Math.max(1,Number(i))}})),e}function vP(t,e,s){if(!e||!Object.keys(e).length)return Promise.resolve();const n=t.getId().filter((i=>e[i])).map((i=>{if(!e[i])return 0;const r=Number(e[i]["text.minVisibleSize"]),o=Number(e[i].minVisibleSize),a=Number(e[i]["text.size"]),l=Number(e[i]["text.scale"]),u=Number(e[i].size)*l*s;return u<=o||u<=r?0:a}));return t.setAttribute("text.size",n)}function bP(t,e){const s=t.getId().map((n=>{const i=e[n]||{};return Number(i["text.size"])}));return t.setAttribute("text.size",s)}var EP=t=>ZF().rotate([-t.longitude,-t.latitude]).scale(mF),NE=new Uint32Array(1),yi=class{constructor(t,e){this.size=1,this.isNode=!0,this.isList=!1,this._index=t,this._ogma=e}get _indexes(){return NE[0]=this._index,NE}setAttributes(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)}setAttribute(t,e,s){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,s)}resetAttributes(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)}getAttributes(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)[0]}getAttribute(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)[0]}getPosition(){return this.getAttributes(["x","y"])}getPositionOnScreen(){return this._ogma.modules.camera.graphToScreenCoordinates(this.getPosition())}isInScreen(){const t=this.getPositionOnScreen(),e=this._ogma.modules.camera;return t.x>=0&&t.x<=e.width&&t.y>=0&&t.y<=e.height}replaceOriginalAttributes(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)}getPreviousAttributes(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)[0]}getPreviousAttribute(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)}isInView(t){return this._ogma.modules.locate.isElementInView(this,t)}getAdjacentNodes(t){return this._ogma.modules.graph.getAdjacentNodes(this,t)}getAdjacentEdges(t){return this._ogma.modules.graph.getAdjacentEdges(this,t)}getAdjacentElements(t){return{nodes:this._ogma.modules.graph.getAdjacentNodes(this,t).dedupe(),edges:this._ogma.modules.graph.getAdjacentEdges(this,t).dedupe()}}getDegree(t){return this._ogma.modules.graph.getDegree(this,t)[0]}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)}getConnectedComponent(t){return this._ogma.modules.graph.getConnectedComponentByNode(this,t)[0]}isVisible(){return!this.isExcluded()}isExcluded(){return this._ogma.modules.graph.isExcluded(this)[0]}setExcluded(t){return this._ogma.modules.graph.setExcluded(this,t)}setVisible(t){return this.setExcluded(!t)}toList(){return this._ogma.nodeList(new Uint32Array([+this._index]))}getId(){return Hf(this._ogma.modules.graph,this)}slice(){return this.toList()}toJSON(t={}){const{attributes:e,data:s}=UT(t),n=this.getAttributes(e);return{id:this.getId(),attributes:n,data:s(Xs(this.getData()))}}get(t){return t===0?this:void 0}setSelected(t){this._ogma.modules.selection.setActive(this,t)}isSelected(){return this._ogma.modules.selection.areActive(this)}locate(t){return this._ogma.modules.locate.locateElements(this,t)}getBoundingBox({includeTexts:t=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,t,t)}setData(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e),this}getData(t){return this._ogma.modules.data.getProperty(this,t||null)[0]}addClass(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)}addClasses(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)}removeClass(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)}removeClasses(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)}hasClass(t){return this._ogma.modules.classes.hasSingleElementClass(t,this)}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)[0]}getGeoCoordinates(){const t=this._ogma.modules.graph,e=t.getNodeAttribute(Tr).get(this._index),s=t.getNodeAttribute(Cr).get(this._index);return{latitude:LE(e)?e:void 0,longitude:LE(s)?s:void 0}}setGeoCoordinates(t){return this.toList().setGeoCoordinates([t]).then((()=>this))}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]}isVirtual(){return this._ogma.modules.transformations.isElementVirtual(this)}getTransformation(){return this._ogma.modules.transformations.getElementTransformation(this)}getMetaNode(){return this._ogma.modules.transformations.getMetaNode(this)}getSubNodes(){return this._ogma.modules.transformations.getSubNodes(this)}pulse(t){return this._ogma.modules.pulses.pulse(this,t)}};$f([yi],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var lo=class{constructor(t,e){this.isList=!0,this.isNode=!0,this._indexes=t,this._ogma=e}get size(){return this._indexes.length}setAttributes(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)}setAttribute(t,e,s){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,s)}getAttributes(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)}getAttribute(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)}resetAttributes(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)}getPosition(){return this.getAttributes(["x","y"])}getPositionOnScreen(){return this.getPosition().map((t=>this._ogma.modules.camera.graphToScreenCoordinates(t)))}replaceOriginalAttributes(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)}getPreviousAttributes(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)}getPreviousAttribute(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)}getAdjacentNodes(t){return this._ogma.modules.graph.getAdjacentNodes(this,t)}getAdjacentEdges(t){return this._ogma.modules.graph.getAdjacentEdges(this,t)}getAdjacentElements(t){return{nodes:this._ogma.modules.graph.getAdjacentNodes(this,t).dedupe(),edges:this._ogma.modules.graph.getAdjacentEdges(this,t).dedupe()}}getDegree(t){return this._ogma.modules.graph.getDegree(this,t)}getConnectedComponents(t){return this._ogma.modules.graph.getConnectedComponents(this,t)}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)}isVisible(){return this.isExcluded().map((t=>!t))}isExcluded(){return this._ogma.modules.graph.isExcluded(this)}isVirtual(){return this.map((t=>this._ogma.modules.transformations.isElementVirtual(t)))}setExcluded(t){return this._ogma.modules.graph.setExcluded(this,t)}setVisible(t){return this.setExcluded(!t)}toList(){return this}toArray(){return PT(this._ogma.modules.graph,this)}clone(){return this._ogma.modules.graph.nodeList(this._indexes.slice())}getId(){return Hf(this._ogma.modules.graph,this)}get(t){return OT(this._ogma.modules.graph,this,t)}forEach(t){ST(this._ogma.modules.graph,this,t)}find(t){return LT(this._ogma.modules.graph,this,t)}some(t){return CT(this._ogma.modules.graph,this,t)}every(t){return TT(this._ogma.modules.graph,this,t)}map(t){return AT(this._ogma.modules.graph,this,t)}[Symbol.iterator](){let t=-1;return{next:()=>({value:this.get(++t),done:t>=this.size})}}filter(t){return wT(this._ogma.modules.graph,this,t)}reduce(t,e){return NT(this._ogma.modules.graph,this,t,e)}concat(t){return FT(this._ogma.modules.graph,this,t)}dedupe(){return MT(this._ogma.modules.graph,this)}subtract(t){return IT(this,t,this._ogma.modules.graph)}slice(t,e){return this._ogma.modules.graph.nodeList(this._indexes.slice(t,e))}indexOf(t){return t instanceof yi?this._indexes.indexOf(t._index):-1}includes(t){return this.indexOf(t)!==-1}inverse(){return RT(this._ogma.modules.graph,this)}sort(t){return BT(this._ogma.modules.graph,this,t)}toJSON(t={}){return this.map((e=>e.toJSON(t)))}setSelected(t){this._ogma.modules.selection.setActive(this,t)}isSelected(){return this._ogma.modules.selection.areActive(this)}locate(t){return this._ogma.modules.locate.locateElements(this,t)}getBoundingBox({includeTexts:t=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,t,t)}setData(t,e){if(arguments.length<2&&(e=t,t=null),typeof e!="function"&&!Fn(e))throw new Error(`invalid argument ${e}; expected array or function`);return this._ogma.modules.data.setProperty(this,t,e,{dispatch:!0}),this}fillData(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e,{dispatch:!1}),this}getData(t){return this._ogma.modules.data.getProperty(this,t||null)}addClass(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)}addClasses(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)}removeClass(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)}removeClasses(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)}hasClass(t){return this.map((e=>this._ogma.modules.classes.hasSingleElementClass(t,e)))}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)}getGeoCoordinates(){const t=this._ogma.modules.graph,e=new Array(this._indexes.length),s=t.getNodeAttribute(Tr).getMultiple(this._indexes),n=t.getNodeAttribute(Cr).getMultiple(this._indexes);for(let i=0,r=this._indexes.length;i<r;i++)e[i]={latitude:s[i],longitude:n[i]};return e}setGeoCoordinates(t){const e=this._ogma.modules.geo,s=this.getId(),n=this._indexes,i=new Array(n.length),r=new Array(n.length);if(t===null&&(t=new Array(n.length).fill(null)),t.length!==n.length)throw new RangeError("You must provide coordinates for each node in the NodeList");for(let l=0,u=n.length;l<u;l++){let{latitude:h,longitude:g}=t[l]||{latitude:void 0,longitude:void 0};const f=s[l];h==null&&g==null?h=g=void 0:(m2(f,h),p2(f,g)),i[l]=h,r[l]=g}this.setData(e.latitudePath,i),this.setData(e.longitudePath,r);const{dom:o,graph:a}=this._ogma.modules;return fP(a,this,i,r),this._ogma.modules.geo.isEnabled()?o.afterNextFrame().then((()=>o.afterNextFrame())).then((()=>this)):o.afterNextFrame().then((()=>this))}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)}getMetaNode(){return this._ogma.modules.transformations.getMetaNodes(this)}getSubNodes(){return this.map(this._ogma.modules.transformations.getSubNodes)}pulse(t){return this._ogma.modules.pulses.pulse(this,t)}};function SP(t,e,s,n,i){return vh(t,e,s,!0,[n],i)}function AP(t,e,s,n,i){return vh(t,e,s,!1,[n],i)}function wP(t,e,s,n,i){return vh(t,e,s,!0,n,i)}function TP(t,e,s,n,i){return vh(t,e,s,!1,n,i)}async function vh(t,e,s,n,i,r={}){Array.isArray(i)||i instanceof(n?lo:qa)||(i=[i]);const{virtual:o=!1}=r;!o&&e.isRefreshing()&&await new Promise((y=>{s.once("idle",y)}));const a={elementsToRemove:t.getElements(n,i)};t.fireEvent("requestElementsToDelete",a);let{elementsToRemove:l}=a;if(!l.size)return Promise.resolve();l=l.dedupe();const u=t.storage.fetch(n),h=u.getFlexArray("removed");if(l=l.filter((y=>h.get(y._index)===0)),n){const y=l.getAdjacentEdges({filter:"all"});vh(t,e,s,!1,y,r)}const g=l._indexes,f=t.getCacheLists(n),p={virtual:o,[n?"nodes":"edges"]:l};if(t.fireEvent(n?"beforeRemoveNodes":"beforeRemoveEdges",p),f.visible.invalidList(),f.all.invalidList(),f.raw.invalidList(),t.setExcluded(l,!0),h.setMultiple(g,1),!n)for(let y=0;y<g.length;++y)t.topology.removeFromAdjacencyList(g[y]);return u.removeElements(g),t.fireEvent(n?"removeNodes":"removeEdges",p),t.fireEvent(n?"afterRemoveNodes":"afterRemoveEdges",p),Promise.resolve()}$f([lo],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var CP=class{addNodes(t,e){return this.modules.graph.addNodes(t,e)}addEdges(t,e){return this.modules.graph.addEdges(t,e)}addNode(t,e){return this.modules.graph.addNode(t,e)}addEdge(t,e){return this.modules.graph.addEdge(t,e)}removeNodes(t,e){return wP(this.modules.graph,this.modules.transformations,this.modules.events,t,e)}removeEdges(t,e){return TP(this.modules.graph,this.modules.transformations,this.modules.events,t,e)}removeNode(t,e){return SP(this.modules.graph,this.modules.transformations,this.modules.events,t,e)}removeEdge(t,e){return AP(this.modules.graph,this.modules.transformations,this.modules.events,t,e)}getNodes(t){return this.modules.graph.getNodes(t)}getEdges(t){return this.modules.graph.getEdges(t)}getNode(t){return this.modules.graph.getNode(t)}getEdge(t){return this.modules.graph.getEdge(t)}clearGraph(){this.modules.graph.clear()}setGraph(t,e){return this.modules.graph.clear(),this.addGraph(t,e)}addGraph(t,e){const s=this.modules.graph.getNodes().size===0,n=this.modules.graph.addGraph(t,e);return s?this.modules.locate.locateGraph({padding:30,ignoreZoomLimits:!1,duration:0}).then((()=>n)):n}createNodeList(){return this.getNodes([])}createEdgeList(){return this.getEdges([])}getConnectedComponents(t={}){return this.modules.graph.getConnectedComponents(this.getNodes(t.filter),t)}getConnectedComponentByNode(t,e){const s=this.modules.graph.getNode(t);if(s===void 0)throw new Error(`getComponentByNode: cannot find node ${t}`);return this.modules.graph.getConnectedComponentByNode(s,e)[0]}},Gx={};function y2(t,e,s,n,i,r){let o=0;for(let a=0;a<n;a++)for(let l=0;l<n;l++){const u=r[a],h=r[l];if(u!==h){const g=t[u][h]*i,f=1/(g*g);if(f){const p=e[u]-e[h],y=s[u]-s[h];o+=f*Math.pow(g-Math.sqrt(p*p+y*y),2)}}}return o}function x2(t,e,s,n,i,r,o){let a=0;if(i===-1)return 0;for(let l=0;l<n;l++)for(let u=0;u<n;u++){const h=o[l],g=o[u];if(h!==g&&(h===i||g===i)){const f=t[h][g]*r,p=1/(f*f);if(p){const y=e[h]-e[g],_=s[h]-s[g];a+=p*Math.pow(f-Math.sqrt(y*y+_*_),2)}}}return a}function cy(t,e,s,n,i,r,o,a){o=o||0;let l=0,u=0;for(let h=0;h<n;h++)for(let g=0;g<n;g++){const f=a[h],p=a[g];if(f!==p){const y=t[f][p]*r,_=1/(y*y);if(_){const x=e[f]-e[p],v=s[f]-s[p],b=_*Math.pow(y-Math.sqrt(x*x+v*v),2);l+=b,f!==i&&p!==i||(u+=b)}}}return(1-o)*l+o*u}function gy(t,e,s,n,i,r,o,a,l){o=o||0;const u=e,h=s;(i=i===void 0?-1:i)===-1&&(o=0);const g=e[i],f=s[i];for(let p=0;p<n;p++){const y=a[p],_=l(t[i][p]),x=o/(_*_);if(_===0)continue;let v=0,b=0,S=0;const A=e[y],w=s[y];for(let I=0;I<n;I++){const F=a[I];if(F!==y){const O=t[y][F]*r,V=1/(O*O),j=e[F],Z=s[F];if(V!==0){const at=A-j,pt=w-Z,K=at*at+pt*pt,ut=K<1e-12?0:1/Math.sqrt(K);b+=(1-o)*V*(j+O*(A-j)*ut),S+=(1-o)*V*(Z+O*(w-Z)*ut)}v+=V}}const L=(1-o)*v+x;if(L!==0){const I=A-g,F=w-f;let O=I*I+F*F;O=O<1e-12?0:1/Math.sqrt(O);const V=_===0?0:x*(_*O);u[y]=(b+V*e[y])/L,h[y]=(S+V*s[y])/L}}return{x:u,y:h}}function LP(t,e,s,n,i,r,o,a){o=o||0;const l=e,u=s;let h;(i=i===void 0?-1:i)===-1&&(o=0);for(let g=0;g<n;g++){const f=a[g];let p=0,y=0,_=0;const x=e[f],v=s[f];for(let b=0;b<n;b++){const S=a[b];let A=0;if(S!==f){let w=0;const L=t[f][S]*r,I=1/(L*L);f!==i&&S!==i||(w=I);const F=(1-o)*I+o*w;if(p+=F,I!==0){const O=e[S],V=s[S],j=x-O,Z=v-V,at=j*j+Z*Z;at>1e-6&&(A=1/Math.sqrt(at)),y+=F*(O+L*(x-O)*A),_+=F*(V+L*(v-V)*A)}}}h=p,h!==0&&(l[f]=y/h,u[f]=_/h)}return{x:l,y:u}}function qf(t=((i,r)=>i-r),e=[],s={},n=(i=>i)){let i=e.length;function r(o){for(;;){const a=2*o+1,l=a+1;let u=o;if(a<i&&t(e[a],e[u])<0&&(u=a),l<i&&t(e[l],e[u])<0&&(u=l),u===o)return o;const h=e[u];e[u]=e[o],e[o]=h,s[n(e[u])]=u,s[n(h)]=o,o=u}}return{get keys(){return s},get size(){return i},heapify:r,pop(){if(i<=0)return;if(i===1)return i--,e[0];const o=e[0];return e[0]=e[i-1],i--,r(0),o},decreaseKey(o,a){for(a!==void 0&&(e[o]=a,s[n(a)]=o);o>0;){const l=o-1>>1;if(!(t(e[l],e[o])>0))break;{const u=e[o];e[o]=e[l],e[l]=u,s[n(e[o])]=o,s[n(u)]=l,o=l}}return o},min:()=>e[0],remove(o){return this.decreaseKey(o,Number.NEGATIVE_INFINITY),this.pop()},push(o){i++;let a=i-1;for(e[a]=o;a>0;){const l=a-1>>1;if(!(t(e[l],e[a])>0))break;{const u=e[a];e[a]=e[l],e[l]=u,s[n(e[a])]=a,s[n(u)]=l,a=l}}return a},empty:()=>i<=0,toArray:()=>e.slice(0,i)}}function Vx({sources:t,targets:e,weights:s,source:n,target:i,undirected:r=!1,indexes:o,N:a}){if(!(a=o?o.length:a)||!isFinite(a)||a===0)throw new Error("Invalid number of nodes "+a);const l=new Float32Array(a),u=new Int32Array(a),h={},g=Number.POSITIVE_INFINITY;if(!s){s=[];for(let _=0;_<a;_++)s[_]=1}if(!o){o=new Uint32Array(a);for(let _=0;_<a;_++)o[_]=_+1}for(let _=0;_<a;_++)l[_]=g,u[_]=-1,h[o[_]]=_;l[h[n]]=0;let f=!1;for(let _=1;_<=a;_++){for(let x=0;x<s.length;x++){const v=t[x],b=e[x],S=h[v],A=h[b];if(S!==void 0&&A!==void 0){const w=s[x];let L=l[S]+w;l[S]!==g&&L<l[A]&&(l[A]=L,u[A]=v,f=!0),r&&(L=l[A]+w,l[A]!==g&&L<l[S]&&(l[S]=L,u[S]=b,f=!0))}}if(!f)break}if(f)for(let _=0;_<s.length;_++){const x=t[_],v=e[_],b=h[x],S=h[v];if(b!==void 0&&S!==void 0){const A=s[_];if(l[b]+A<l[S])return null}}let p=null,y=null;if(i!==void 0){const _=h[i];if(_!==void 0&&l[_]!==g){p=[];for(let x=i;x!==-1;x=u[h[x]])p.push(x);p=p.reverse(),y=l[_]}}return{distances:l,path:p,pathLength:y}}function jx(t,e,s,n,i,r,o){const a=(n=n||t.map(((x,v)=>v+1))).length,l=new Float32Array(a),u=new Int32Array(a),h=new Uint32Array(a),g=Number.POSITIVE_INFINITY,f={};if(a===0)return{distances:l,path:null,pathLength:null};if(!i){i={};for(let x=0;x<a;x++)i[n[x]]=x}for(let x=0;x<a;x++)l[x]=g,u[x]=-1,h[x]=f[x]=x;const p=qf(((x,v)=>l[x]-l[v]),h,f);for(l[i[e]]=0,p.decreaseKey(f[i[e]]);p.size!==0;){const x=p.pop(),v=l[x],b=t[x];if(v===g)break;for(let S=0,A=b.nodes.length;S<A;S++){const w=b.nodes[S],L=r?1:o?o(n[x],w):b.weights?b.weights[S]:1,I=i[w];if(I===void 0)continue;const F=v+L;F<l[I]&&(l[I]=F,u[I]=x,p.decreaseKey(f[I]))}}let y=null,_=null;if(s!==void 0){const x=i[s];if(l[x]!==g){y=[];for(let v=x;v!==-1;v=u[v])y.push(n[v]);y.reverse(),_=l[s]}}return{distances:l,path:y,pathLength:_}}function fy({sources:t,targets:e,weights:s,indexes:n,adjacency:i,undirected:r,ignoreWeights:o}){const a=Number.POSITIVE_INFINITY,l=n?n.length:i.length;if(!n){n=new Uint32Array(l);for(let _=0;_<l;_++)n[_]=_+1}const u=new Array(l),h={};for(let _=0;_<l;_++){u[_]=new Float32Array(l);for(let x=0;x<l;x++)u[_][x]=_===x?0:a;h[n[_]]=_}const g=l,f=s.length;t=t.slice(),e=e.slice(),s=s.slice();for(let _=0;_<l;_++)t[f+_]=g,e[f+_]=n[_],s[f+_]=0,o&&(s[_]=1);const p=Vx({sources:t,targets:e,weights:s,undirected:r,N:l+1,source:g});if(p===null)throw new Error("Graph has negative weight loops");const y=p.distances;for(let _=0;_<s.length;_++){const x=h[t[_]],v=h[e[_]];x!==void 0&&v!==void 0&&(s[_]=s[_]+y[x]-y[v])}t=t.slice(0,f),e=e.slice(0,f),s=s.slice(0,f);for(let _=0;_<l;_++){const x=n[_],{distances:v}=jx(i,x,void 0,n,h,!!o);for(let b=0;b<l;b++)u[_][b]=_===b?0:v[b]}return u}mh(Gx,{CyclesFinder:()=>I2,Quadtree:()=>cz,bellmanFord:()=>Vx,betweenness:()=>F2,circlePack:()=>T2,circleSpread:()=>KP,constrainedStress:()=>cy,convexhull:()=>XP,detectCyclesDirected:()=>N2,detectCyclesUndirected:()=>fz,detectCyclesUndirectedDFS:()=>pz,dijkstra:()=>jx,distanceStress:()=>x2,fisheye:()=>C2,johnson:()=>fy,kruskal:()=>R2,largestEmptyCircle:()=>b2,minDisk:()=>Eh,minHeap:()=>qf,removeRadialOverlap:()=>my,stressMinimizationStep:()=>gy,stressMinimizationStepGeneral:()=>LP,weightedStress:()=>y2});var no=11102230246251565e-32,Gn=134217729,kP=(3+8*no)*no;function $m(t,e,s,n,i){let r,o,a,l,u=e[0],h=n[0],g=0,f=0;h>u==h>-u?(r=u,u=e[++g]):(r=h,h=n[++f]);let p=0;if(g<t&&f<s)for(h>u==h>-u?(o=u+r,a=r-(o-u),u=e[++g]):(o=h+r,a=r-(o-h),h=n[++f]),r=o,a!==0&&(i[p++]=a);g<t&&f<s;)h>u==h>-u?(o=r+u,l=o-r,a=r-(o-l)+(u-l),u=e[++g]):(o=r+h,l=o-r,a=r-(o-l)+(h-l),h=n[++f]),r=o,a!==0&&(i[p++]=a);for(;g<t;)o=r+u,l=o-r,a=r-(o-l)+(u-l),u=e[++g],r=o,a!==0&&(i[p++]=a);for(;f<s;)o=r+h,l=o-r,a=r-(o-l)+(h-l),h=n[++f],r=o,a!==0&&(i[p++]=a);return r===0&&p!==0||(i[p++]=r),p}function NP(t,e){let s=e[0];for(let n=1;n<t;n++)s+=e[n];return s}function bh(t){return new Float64Array(t)}var MP=(3+16*no)*no,IP=(2+12*no)*no,RP=(9+64*no)*no*no,Tl=bh(4),ME=bh(8),IE=bh(12),RE=bh(16),ti=bh(4);function FP(t,e,s,n,i,r,o){let a,l,u,h,g,f,p,y,_,x,v,b,S,A,w,L,I,F;const O=t-i,V=s-i,j=e-r,Z=n-r;A=O*Z,f=Gn*O,p=f-(f-O),y=O-p,f=Gn*Z,_=f-(f-Z),x=Z-_,w=y*x-(A-p*_-y*_-p*x),L=j*V,f=Gn*j,p=f-(f-j),y=j-p,f=Gn*V,_=f-(f-V),x=V-_,I=y*x-(L-p*_-y*_-p*x),v=w-I,g=w-v,Tl[0]=w-(v+g)+(g-I),b=A+v,g=b-A,S=A-(b-g)+(v-g),v=S-L,g=S-v,Tl[1]=S-(v+g)+(g-L),F=b+v,g=F-b,Tl[2]=b-(F-g)+(v-g),Tl[3]=F;let at=NP(4,Tl),pt=IP*o;if(at>=pt||-at>=pt||(g=t-O,a=t-(O+g)+(g-i),g=s-V,u=s-(V+g)+(g-i),g=e-j,l=e-(j+g)+(g-r),g=n-Z,h=n-(Z+g)+(g-r),a===0&&l===0&&u===0&&h===0)||(pt=RP*o+kP*Math.abs(at),at+=O*h+Z*a-(j*u+V*l),at>=pt||-at>=pt))return at;A=a*Z,f=Gn*a,p=f-(f-a),y=a-p,f=Gn*Z,_=f-(f-Z),x=Z-_,w=y*x-(A-p*_-y*_-p*x),L=l*V,f=Gn*l,p=f-(f-l),y=l-p,f=Gn*V,_=f-(f-V),x=V-_,I=y*x-(L-p*_-y*_-p*x),v=w-I,g=w-v,ti[0]=w-(v+g)+(g-I),b=A+v,g=b-A,S=A-(b-g)+(v-g),v=S-L,g=S-v,ti[1]=S-(v+g)+(g-L),F=b+v,g=F-b,ti[2]=b-(F-g)+(v-g),ti[3]=F;const K=$m(4,Tl,4,ti,ME);A=O*h,f=Gn*O,p=f-(f-O),y=O-p,f=Gn*h,_=f-(f-h),x=h-_,w=y*x-(A-p*_-y*_-p*x),L=j*u,f=Gn*j,p=f-(f-j),y=j-p,f=Gn*u,_=f-(f-u),x=u-_,I=y*x-(L-p*_-y*_-p*x),v=w-I,g=w-v,ti[0]=w-(v+g)+(g-I),b=A+v,g=b-A,S=A-(b-g)+(v-g),v=S-L,g=S-v,ti[1]=S-(v+g)+(g-L),F=b+v,g=F-b,ti[2]=b-(F-g)+(v-g),ti[3]=F;const ut=$m(K,ME,4,ti,IE);A=a*h,f=Gn*a,p=f-(f-a),y=a-p,f=Gn*h,_=f-(f-h),x=h-_,w=y*x-(A-p*_-y*_-p*x),L=l*u,f=Gn*l,p=f-(f-l),y=l-p,f=Gn*u,_=f-(f-u),x=u-_,I=y*x-(L-p*_-y*_-p*x),v=w-I,g=w-v,ti[0]=w-(v+g)+(g-I),b=A+v,g=b-A,S=A-(b-g)+(v-g),v=S-L,g=S-v,ti[1]=S-(v+g)+(g-L),F=b+v,g=F-b,ti[2]=b-(F-g)+(v-g),ti[3]=F;const ht=$m(ut,IE,4,ti,RE);return RE[ht-1]}function Gc(t,e,s,n,i,r){const o=(e-r)*(s-i),a=(t-i)*(n-r),l=o-a,u=Math.abs(o+a);return Math.abs(l)>=MP*u?l:-FP(t,e,s,n,i,r,u)}var FE=Math.pow(2,-52),Vc=new Uint32Array(512),Hx=class v2{static from(e,s=BP,n=UP){const i=e.length,r=new Float64Array(2*i);for(let o=0;o<i;o++){const a=e[o];r[2*o]=s(a),r[2*o+1]=n(a)}return new v2(r)}constructor(e){const s=e.length>>1;if(s>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*s-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(s)),this._hullPrev=new Uint32Array(s),this._hullNext=new Uint32Array(s),this._hullTri=new Uint32Array(s),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(s),this._dists=new Float64Array(s),this.update()}update(){const{coords:e,_hullPrev:s,_hullNext:n,_hullTri:i,_hullHash:r}=this,o=e.length>>1;let a=1/0,l=1/0,u=-1/0,h=-1/0;for(let O=0;O<o;O++){const V=e[2*O],j=e[2*O+1];V<a&&(a=V),j<l&&(l=j),V>u&&(u=V),j>h&&(h=j),this._ids[O]=O}const g=(a+u)/2,f=(l+h)/2;let p,y,_;for(let O=0,V=1/0;O<o;O++){const j=qm(g,f,e[2*O],e[2*O+1]);j<V&&(p=O,V=j)}const x=e[2*p],v=e[2*p+1];for(let O=0,V=1/0;O<o;O++){if(O===p)continue;const j=qm(x,v,e[2*O],e[2*O+1]);j<V&&j>0&&(y=O,V=j)}let b=e[2*y],S=e[2*y+1],A=1/0;for(let O=0;O<o;O++){if(O===p||O===y)continue;const V=DP(x,v,b,S,e[2*O],e[2*O+1]);V<A&&(_=O,A=V)}let w=e[2*_],L=e[2*_+1];if(A===1/0){for(let j=0;j<o;j++)this._dists[j]=e[2*j]-e[0]||e[2*j+1]-e[1];$l(this._ids,this._dists,0,o-1);const O=new Uint32Array(o);let V=0;for(let j=0,Z=-1/0;j<o;j++){const at=this._ids[j],pt=this._dists[at];pt>Z&&(O[V++]=at,Z=pt)}return this.hull=O.subarray(0,V),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(Gc(x,v,b,S,w,L)<0){const O=y,V=b,j=S;y=_,b=w,S=L,_=O,w=V,L=j}const I=OP(x,v,b,S,w,L);this._cx=I.x,this._cy=I.y;for(let O=0;O<o;O++)this._dists[O]=qm(e[2*O],e[2*O+1],I.x,I.y);$l(this._ids,this._dists,0,o-1),this._hullStart=p;let F=3;n[p]=s[_]=y,n[y]=s[p]=_,n[_]=s[y]=p,i[p]=0,i[y]=1,i[_]=2,r.fill(-1),r[this._hashKey(x,v)]=p,r[this._hashKey(b,S)]=y,r[this._hashKey(w,L)]=_,this.trianglesLen=0,this._addTriangle(p,y,_,-1,-1,-1);for(let O,V,j=0;j<this._ids.length;j++){const Z=this._ids[j],at=e[2*Z],pt=e[2*Z+1];if(j>0&&Math.abs(at-O)<=FE&&Math.abs(pt-V)<=FE||(O=at,V=pt,Z===p||Z===y||Z===_))continue;let K=0;for(let Nt=0,Q=this._hashKey(at,pt);Nt<this._hashSize&&(K=r[(Q+Nt)%this._hashSize],K===-1||K===n[K]);Nt++);K=s[K];let ut,ht=K;for(;ut=n[ht],Gc(at,pt,e[2*ht],e[2*ht+1],e[2*ut],e[2*ut+1])>=0;)if(ht=ut,ht===K){ht=-1;break}if(ht===-1)continue;let nt=this._addTriangle(ht,Z,n[ht],-1,-1,i[ht]);i[Z]=this._legalize(nt+2),i[ht]=nt,F++;let ot=n[ht];for(;ut=n[ot],Gc(at,pt,e[2*ot],e[2*ot+1],e[2*ut],e[2*ut+1])<0;)nt=this._addTriangle(ot,Z,ut,i[Z],-1,i[ot]),i[Z]=this._legalize(nt+2),n[ot]=ot,F--,ot=ut;if(ht===K)for(;ut=s[ht],Gc(at,pt,e[2*ut],e[2*ut+1],e[2*ht],e[2*ht+1])<0;)nt=this._addTriangle(ut,Z,ht,-1,i[ht],i[ut]),this._legalize(nt+2),i[ut]=nt,n[ht]=ht,F--,ht=ut;this._hullStart=s[Z]=ht,n[ht]=s[ot]=Z,n[Z]=ot,r[this._hashKey(at,pt)]=Z,r[this._hashKey(e[2*ht],e[2*ht+1])]=ht}this.hull=new Uint32Array(F);for(let O=0,V=this._hullStart;O<F;O++)this.hull[O]=V,V=n[V];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,s){return Math.floor(PP(e-this._cx,s-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:s,_halfedges:n,coords:i}=this;let r=0,o=0;for(;;){const a=n[e],l=e-e%3;if(o=l+(e+2)%3,a===-1){if(r===0)break;e=Vc[--r];continue}const u=a-a%3,h=l+(e+1)%3,g=u+(a+2)%3,f=s[o],p=s[e],y=s[h],_=s[g];if(zP(i[2*f],i[2*f+1],i[2*p],i[2*p+1],i[2*y],i[2*y+1],i[2*_],i[2*_+1])){s[e]=_,s[a]=f;const x=n[g];if(x===-1){let b=this._hullStart;do{if(this._hullTri[b]===g){this._hullTri[b]=e;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(e,x),this._link(a,n[o]),this._link(o,g);const v=u+(a+1)%3;r<Vc.length&&(Vc[r++]=v)}else{if(r===0)break;e=Vc[--r]}}return o}_link(e,s){this._halfedges[e]=s,s!==-1&&(this._halfedges[s]=e)}_addTriangle(e,s,n,i,r,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=s,this._triangles[a+2]=n,this._link(a,i),this._link(a+1,r),this._link(a+2,o),this.trianglesLen+=3,a}};function PP(t,e){const s=t/(Math.abs(t)+Math.abs(e));return(e>0?3-s:1+s)/4}function qm(t,e,s,n){const i=t-s,r=e-n;return i*i+r*r}function zP(t,e,s,n,i,r,o,a){const l=t-o,u=e-a,h=s-o,g=n-a,f=i-o,p=r-a,y=h*h+g*g,_=f*f+p*p;return l*(g*_-y*p)-u*(h*_-y*f)+(l*l+u*u)*(h*p-g*f)<0}function DP(t,e,s,n,i,r){const o=s-t,a=n-e,l=i-t,u=r-e,h=o*o+a*a,g=l*l+u*u,f=.5/(o*u-a*l),p=(u*h-a*g)*f,y=(o*g-l*h)*f;return p*p+y*y}function OP(t,e,s,n,i,r){const o=s-t,a=n-e,l=i-t,u=r-e,h=o*o+a*a,g=l*l+u*u,f=.5/(o*u-a*l);return{x:t+(u*h-a*g)*f,y:e+(o*g-l*h)*f}}function $l(t,e,s,n){if(n-s<=20)for(let i=s+1;i<=n;i++){const r=t[i],o=e[r];let a=i-1;for(;a>=s&&e[t[a]]>o;)t[a+1]=t[a--];t[a+1]=r}else{let i=s+1,r=n;td(t,s+n>>1,i),e[t[s]]>e[t[n]]&&td(t,s,n),e[t[i]]>e[t[n]]&&td(t,i,n),e[t[s]]>e[t[i]]&&td(t,s,i);const o=t[i],a=e[o];for(;;){do i++;while(e[t[i]]<a);do r--;while(e[t[r]]>a);if(r<i)break;td(t,i,r)}t[s+1]=t[r],t[r]=o,n-i+1>=r-s?($l(t,e,i,n),$l(t,e,s,r-1)):($l(t,e,s,r-1),$l(t,e,i,n))}}function td(t,e,s){const n=t[e];t[e]=t[s],t[s]=n}function BP(t){return t[0]}function UP(t){return t[1]}function b2(t,e=1,s=0,n,i){if(!n||!i){const g=t.map((p=>[p.x,p.y])),f=Hx.from(g,(p=>p[0]),(p=>p[1]));n=qd(f.triangles,g),i=qd(f.hull,g)}if(!i)return[];const r=s*s,o=[],a={};for(let g=0;g<n.length;g+=3)if(GP(i,$x(n[g],n[g+1],n[g+2]))){const f=jP(n[g],n[g+1],n[g+2]);f>r&&(o.push(g),a[g]=f)}if(o.length===0)return[];o.sort(((g,f)=>a[g]-a[f]));let l=o[0],u=a[l];const h=[];for(let g=0;g<o.length;g++){const f=o[g],p=a[f];p>u&&p>r&&(l=f,u=p,h.push(l),h.length>e&&h.shift())}return h.map((g=>VP(n[g],n[g+1],n[g+2])))}function GP(t,e){const s=t.length,n=t[s-1],[i,r]=e;let[o,a]=n,l=!1;for(let u=0;u<s;u++){const h=t[u],[g,f]=h;f>r!=a>r&&i<(o-g)*(r-f)/(a-f)+g&&(l=!l),o=g,a=f}return l}function VP(t,e,s){const n=$x(t,e,s);let i=0;for(let r=0;r<3;r++){const o=arguments[r],a=o[0]-n[0],l=o[1]-n[1],u=Math.sqrt(a*a+l*l);u>i&&(i=u)}return[n[0],n[1],i]}function jP(t,e,s){const[n,i]=$x(t,e,s),[r,o]=t,a=n-r,l=i-o;return a*a+l*l}function $x(t,e,s){const n=[(t[0]+e[0])/2,(t[1]+e[1])/2],i=[(e[0]+s[0])/2,(e[1]+s[1])/2],r=-1/((e[1]-t[1])/(e[0]-t[0])),o=-1/((s[1]-e[1])/(s[0]-e[0])),a=n[1]-r*n[0],l=(a-(i[1]-o*i[0]))/(o-r);return[l,r*l+a]}function Eh(t,e,s,n){let i;if(n)i=n;else{i=new Uint32Array(t.length);for(let S=0,A=t.length;S<A;S++)i[S]=S}let r=t[i[0]],o=r,a=e[i[0]],l=a;for(let S=1;S<i.length;S++){const A=i[S],w=t[A],L=e[A];w<r&&(r=w),w>o&&(o=w),L<a&&(a=L),L>l&&(l=L)}const u=(r+o)/2,h=(a+l)/2;for(let S=0;S<i.length;S++){const A=i[S];t[A]-=u,e[A]-=h}function g(S,A,w,L,I,F){const O=w-F+1e-9*Math.max(w,F,1),V=L-S,j=I-A;return O>0&&O*O>V*V+j*j}function f(S,A,w,L,I,F,O){for(let V=0;V<L.length;++V){const j=L[V];if(!g(S,A,w,I[j],F[j],O[j]))return!1}return!0}function p(S,A,w,L,I,F){const O=L-S,V=I-A,j=F-w,Z=Math.sqrt(O*O+V*V);return[(S+L+O/Z*j)/2,(A+I+V/Z*j)/2,(Z+w+F)/2]}function y(S,A,w,L,I,F,O,V,j){const Z=(S+L+O)/3,at=(A+I+V)/3,pt=S-Z,K=A-at,ut=L-Z,ht=I-at,nt=O-Z,ot=V-at,Nt=pt-ut,Q=pt-nt,Et=K-ht,Xt=K-ot,Ht=F-w,Zt=j-w,ae=pt*pt+K*K-w*w,pe=ae-ut*ut-ht*ht+F*F,ne=ae-nt*nt-ot*ot+j*j,te=Q*Et-Nt*Xt,se=(Et*ne-Xt*pe)/(2*te)-pt,ce=(Xt*Ht-Et*Zt)/te,Ce=(Q*pe-Nt*ne)/(2*te)-K,ve=(Nt*Zt-Q*Ht)/te,Ne=ce*ce+ve*ve-1,ge=2*(w+se*ce+Ce*ve),ze=se*se+Ce*Ce-w*w,is=-(Math.abs(Ne)>1e-6?(ge+Math.sqrt(ge*ge-4*Ne*ze))/(2*Ne):ze/ge);return[Z+pt+se+ce*is,at+K+Ce+ve*is,is]}function _(S,A,w,L){switch(S.length){case 1:const I=S[0];return(function(pt,K,ut){return[pt,K,ut]})(A[I],w[I],L[I]);case 2:const[F,O]=S;return p(A[F],w[F],L[F],A[O],w[O],L[O]);case 3:const[V,j,Z]=S;return y(A[V],w[V],L[V],A[j],w[j],L[j],A[Z],w[Z],L[Z]);default:return null}}function x(S,A,w,L,I,F){const O=w-F,V=L-S,j=I-A;return O<0||O*O<V*V+j*j}function v(S,A,w,L,I){const F=w[A],O=L[A],V=I[A];if(f(F,O,V,S,w,L,I))return[A];for(let j=0;j<S.length;++j){const Z=S[j],at=w[Z],pt=L[Z],K=I[Z];if(x(F,O,V,at,pt,K)){const[ut,ht,nt]=p(at,pt,K,F,O,V);if(f(ut,ht,nt,S,w,L,I))return[S[j],A]}}for(let j=0;j<S.length-1;++j)for(let Z=j+1;Z<S.length;++Z){const at=S[j],pt=S[Z],K=w[at],ut=L[at],ht=I[at],nt=w[pt],ot=L[pt],Nt=I[pt],Q=p(K,ut,ht,nt,ot,Nt);if(x(Q[0],Q[1],Q[2],F,O,V)){const Et=p(K,ut,ht,F,O,V);if(x(Et[0],Et[1],Et[2],nt,ot,Nt)){const Xt=p(nt,ot,Nt,F,O,V);if(x(Xt[0],Xt[1],Xt[2],K,ut,ht)){const Ht=y(K,ut,ht,nt,ot,Nt,F,O,V);if(f(Ht[0],Ht[1],Ht[2],S,w,L,I))return[at,pt,A]}}}}throw new Error}i=(function(A){for(let w=A.length-1;w>=0;w--){let L=Math.floor(Math.random()*(w+1));L=Math.max(Math.min(L,w),0);const I=A[w];A[w]=A[L],A[L]=I}return A})(i),s=s||new Array(t.length).fill(0);const b=(function(A,w,L,I,F){let O=null,V=[],j=0;for(;j<w;){const Z=A[j];O&&g(O[0],O[1],O[2],L[Z],I[Z],F[Z])?j++:(V=v(V,Z,L,I,F),O=_(V,L,I,F),j=0)}return O})(i,i.length,t,e,s);b[0]+=u,b[1]+=h;for(let S=0;S<i.length;S++){const A=i[S];t[A]+=u,e[A]+=h}return b}var E2=[1/0,1/0,-1/0,-1/0];function hf(t,e,s,n,i,r={x:0,y:0}){const o=Math.cos(i),a=Math.sin(i),l=t-s,u=e-n;return r.x=o*l-a*u+s,r.y=a*l+o*u+n,r}function HP(t,e,s=0,n={x:0,y:0}){return n.x=t.x+s*Math.sin(e),n.y=t.y+s*Math.cos(e),n}var _n=(t,e,s,n)=>Math.hypot(t-s,e-n);function Og(t,e,s,n){const i=t-s,r=e-n;return i*i+r*r}function S2(t){const e=Math.sqrt(t.x*t.x+t.y*t.y);return t.x/=e,t.y/=e,t}function py(t){return 180*t/Math.PI}function $P(t){return t*Math.PI/180}function A2(t,e){return t.minX-=e,t.minY-=e,t.maxX+=e,t.maxY+=e,t.width===void 0&&(t.width=t.maxX-t.minX),t.height===void 0&&(t.height=t.maxY-t.minY),t.width+=2*e,t.height+=2*e,t}function qx(t,e,s,n,i,r){const o=n-t,a=i-e,l=Math.sqrt(o*o+a*a);if(l>s+r||l<Math.abs(s-r))return null;const u=(s*s-r*r+l*l)/(2*l),h=t+o*u/l,g=e+a*u/l,f=Math.sqrt(s*s-u*u),p=f/l*-a,y=o*(f/l);return[[h+p,g+y],[h-p,g-y]]}function Yx(t,e,s,n,i,r){if(t-i>=0&&s-i<0)return 1;if(t-i<0&&s-i>=0)return-1;if(t-i==0&&s-i==0)return e-n>=0||n-r>=0?e-n:n-e;const o=(t-i)*(n-r)-(s-i)*(e-r);return o<0?1:o>0?-1:(t-i)*(t-i)+(e-r)*(e-r)-((s-i)*(s-i)+(n-r)*(n-r))}function qP([t,e,s],n,i){const r=Math.abs(t-n),o=Math.abs(e-i);return r+o<=s||!(r>s||o>s)&&Math.sqrt(r*r+o*o)<s+1e-12}function YP(t,e,s,n){const i=t[0]-e,r=t[1]-s,o=t[2]-n;return i*i+r*r<o*o+1e-6}function Wx(t,e,s,n,i,r,o){const a=t-Math.max(n,Math.min(r,t)),l=e-Math.max(i,Math.min(o,e));return a*a+l*l<s*s}function w2(t,e,s,n,i,r,o,a={x:0,y:0}){const l=a||{x:0,y:0};let u,h,g,f;if(s===t){const v=t-i,b=o*o-v*v;if(b<0)return null;const S=Math.sqrt(b);u=t,g=t,h=r+S,f=r-S}else{const v=(n-e)/(s-t),b=e-v*t,S=b-r,A=v*v+1,w=2*(v*S-i),L=w*w-4*A*(i*i+S*S-o*o);if(L<0)return null;const I=-w,F=Math.sqrt(L),O=2*A;u=(I+F)/O,g=(I-F)/O,h=v*u+b,f=v*g+b}const p=t-u,y=e-h,_=t-g,x=e-f;return p*p+y*y<_*_+x*x?(l.x=u,l.y=h):(l.x=g,l.y=f),l}function my({X:t,Y:e,sizes:s,indexes:n,R:i,center:r,gap:o=0,epsilon:a=.001,maxLoops:l=5,inPlace:u=!0}){const h=n.length,g=r[0],f=r[1];let p=h;u||(t=t.slice(),e=e.slice());const y=qx,_=Yx,x=n.slice().sort(((V,j)=>_(t[V],e[V],t[j],e[j],g,f))),v=x[h-1],b=t[v],S=e[v];let A=!1;for(let V=0;V<p-1;V++){let j=V%h,Z=(V+1)%h;V===-1&&(j=h-1,Z=0),j=x[j],Z=x[Z];const at=t[j],pt=e[j];let K=t[Z],ut=e[Z];const ht=s[j]+s[Z]+o;let nt=_(at,pt,K,ut,g,f);if(nt===-1&&A&&(nt=1),!(ht>i)){if(nt===1||ht-_n(at,pt,K,ut)>a){const ot=y(g,f,i,at,pt,ht);if(ot){const Nt=ot[0];A=K>g&&Nt[0]<g,K=t[Z]=Nt[0],ut=e[Z]=Nt[1]}}else A=!1;if(V%h==h-2){const ot=x[h-1],Nt=x[0];if(e[ot]>f&&e[Nt]>f&&t[ot]-s[ot]<t[Nt]+s[ot]){let Q=0;for(p=Math.min(h*l,p+h);e[x[ot]]>f&&e[x[0]]>f&&t[x[ot]]<t[x[0]]&&++Q<h;){const Et=x.pop();Et&&x.unshift(Et)}}}}}const w=b-g,L=S-f,I=t[v]-g,F=e[v]-f,O=w===I?0:Math.abs(Math.acos((w*I+L*F)/(Math.sqrt(w*w+L*L)*Math.sqrt(I*I+F*F))));if(O!==0){const V=Math.sin(-O),j=Math.cos(-O);let Z;for(let at=0;at<h;at++){Z=x[at];const pt=t[Z]-g,K=e[Z]-f;t[Z]=pt*j-K*V+g,e[Z]=pt*V+K*j+f}}return{X:t,Y:e}}function PE(t,e,s,n,i,r){const o={},a=s[t];let l=a,u=0;const h=a*i;for(const g in e){const f=e[g];let p=0,y=0;for(let b=0,S=f.length;b<S;b++){const A=s[f[b]];y=Math.max(y,A),p+=2*A+n}const _=p/(2*Math.PI),x=y+l,v=r?u+Math.max(r,x):u*i;u=Math.max(x,u,_,h,v),o[g]=u,l=y}return o[0]=0,o[Number.POSITIVE_INFINITY]=u,o}function WP(t,e,s){return(e[0]-t[0])*(s[1]-t[1])-(e[1]-t[1])*(s[0]-t[0])}function zE(t){const e=t.length,s=[0,1];let n=2;for(let i=2;i<e;i++){for(;n>1&&WP(t[s[n-2]],t[s[n-1]],t[i])<=0;)--n;s[n++]=i}return s.slice(0,n)}function XP(t){const e=t.length;if(e<3)return null;const s=new Array(e),n=new Array(e);for(let g=0;g<e;g++)s[g]=[+t[g][0],+t[g][1],g];s.sort(((g,f)=>g[0]-f[0]||g[1]-f[1]));for(let g=0;g<e;g++)n[g]=[s[g][0],-s[g][1]];const i=zE(s),r=zE(n),o=r[r.length-1],a=i[i.length-1],l=r[0]===i[0],u=o===a?1:0,h=[];for(let g=i.length-1;g>=0;--g)h.push(t[s[i[g]][2]]);for(let g=+l;g<r.length-u;g++)h.push(t[s[r[g]][2]]);return h}var DE=t=>--t*t*t+1,OE=(t,e,s)=>{const n=t-s[0],i=e-s[1];return n*n+i*i},ZP=(t,e)=>{let s=1/0,n=-1/0;for(let i=0;i<t.length;i++){const r=t[i],o=e?e[r]:r;s=Math.min(o,s),n=Math.max(o,n)}return{min:s,max:n}};function KP({X:t,Y:e,R:s,center:n,maxSteps:i=1e3,padding:r=5,epsilon:o=1e-9,damping:a=2,pinned:l=-1,indexes:u,onUpdate:h,pushSmallerOut:g=!0}){const f=u?u.length:t.length;let p=u;if(p===void 0){p=new Uint32Array(f);for(let A=0;A<f;A++)p[A]=A}else p=u;if(l!==-1)n=[t[l],e[l]];else if(!n){let A=0,w=0;for(let L=0;L<f;L++)A+=t[p[L]],w+=e[p[L]];n=[A/f,w/f]}const{min:y,max:_}=ZP(p,s);function x(A,w){let L=0;for(let V=0;V<f-1;V++)for(let j=V+1;j<f;j++){if(V===j)continue;const Z=p[V],at=p[j],pt=t[Z],K=e[Z],ut=s[Z],ht=t[at],nt=e[at],ot=s[at],Nt=ht-pt,Q=nt-K,Et=ut+ot+r,Xt=Nt*Nt+Q*Q;if(Xt<Et*Et-A){const Ht=(Et-Math.sqrt(Xt))*w,Zt=1/Xt,ae=Nt*Zt*Ht,pe=Q*Zt*Ht,ne=ae*ae+pe*pe;if(at!==l){const te=ut/y;L+=ne*te,t[at]+=ae*te,e[at]+=pe*te}if(Z!==l){const te=ot/y;L+=ne*te,t[Z]-=ae*te,e[Z]-=pe*te}}}const I=A*a*(1-w),F=n[0],O=n[1];for(let V=0;V<f;V++){const j=p[V];if(j!==l){const Z=t[j],at=e[j],pt=s[j]/_,K=g?I*pt:I,ut=(Z-F)*K,ht=(at-O)*K;L+=ut*ut+ht*ht,t[j]-=ut,e[j]-=ht}}return L}p.sort(((A,w)=>s[w]*OE(t[w],e[w],n)-s[A]*OE(t[A],e[A],n)));let v=0,b=0;const S=DE(1/f);for(let A=0;A<i&&(v=x(S,DE((A+1)/i)),h&&setTimeout((()=>h(t,e))),!(Math.abs(v-b)<o));A++)b=v;return{X:t,Y:e}}var jc=t=>({data:t,next:null,prev:null});function T2(t,e=0,s=0){const n=t.length;if(n===0)return t;const i=t[0];if(i.x=e,i.y=s,n===1)return t;const r=t[1];if(i.x=e-r.radius,r.x=e+i.radius,r.y=s,n===2)return t;const o=t[2];BE(r,i,o);let a=jc(i),l=jc(r),u=jc(o);a.next=u.prev=l,l.next=a.prev=u,u.next=l.prev=a;t:for(let h=3;h<n;h++){u=jc(t[h]),BE(a.data,l.data,t[h]);let g=l.next,f=a.prev,p=l.data.radius,y=a.data.radius;do if(p<=y){if(UE(g.data,u.data)){l=g,a.next=l,l.prev=a,--h;continue t}p+=g.data.radius,g=g.next}else{if(UE(f.data,u.data)){a=f,a.next=l,l.prev=a,--h;continue t}y+=f.data.radius,f=f.prev}while(g!==f.next);u.prev=a,u.next=l,a.next=l.prev=l=u;let _=GE(a);for(;(u=u.next)!==l;){const x=GE(u);x<_&&(a=u,_=x)}l=a.next}return t}function BE(t,e,s){const n=t.x-e.x;let i,r;const o=t.y-e.y,a=n*n+o*o;let l,u;a?(r=e.radius+s.radius,r*=r,u=t.radius+s.radius,u*=u,r>u?(i=(a+u-r)/(2*a),l=Math.sqrt(Math.max(0,u/a-i*i)),s.x=t.x-i*n-l*o,s.y=t.y-i*o+l*n):(i=(a+r-u)/(2*a),l=Math.sqrt(Math.max(0,r/a-i*i)),s.x=e.x+i*n-l*o,s.y=e.y+i*o+l*n)):(s.x=e.x+s.radius,s.y=e.y)}var QP=1e-6;function UE(t,e){const s=t.radius+e.radius-QP,n=e.x-t.x,i=e.y-t.y;return s>0&&s*s>n*n+i*i}function GE(t){const e=t.data,s=t.next.data,n=e.radius+s.radius,i=(e.x*s.radius+s.x*e.radius)/n,r=(e.y*s.radius+s.y*e.radius)/n;return i*i+r*r}function JP(t,e,s,n,i){const r=t.get(e),o=t.get(s),a=i.get(r._index)||r.getAttributes(["x","y","r"]),l=i.get(o._index)||o.getAttributes(["x","y","r"]),u=Number(l.radius),h=Number(a.radius),g=_n(a.x,a.y,l.x,l.y),f=g;return n.push({source:e,target:s,weight:f}),g<=h+u+20?1:0}function tz(t){return t%3==2?t-2:t+1}function ez(t,e,s){const n=[],{triangles:i,halfedges:r}=t;for(let o=0;o<i.length;o++)o>r[o]&&JP(e,i[o],i[tz(o)],n,s);return n}var sz=(t,e)=>t.weight-e.weight;function nz(t,e){const s=new Set,n=new Array(t.length),i=[];for(const o of e)n[o.source]||(n[o.source]=[]),n[o.source].push(o),n[o.target]||(n[o.target]=[]),n[o.target].push(o);s.add(0);const r=qf(sz,n[0]);for(;r.size!==0;){const o=r.pop(),a=s.has(o.source)?s.has(o.target)?null:o.target:o.source;if(a){const l=o.source===a?o.target:o.source,u=a;i.push({source:l,target:u,weight:o.weight}),s.add(a);for(const h of n[a])r.push(h)}}return i}function VE(t,e,s){let n=t.x-e.x,i=t.y-e.y;const r=Math.sqrt(n*n+i*i);n/=r,i/=r;const o=s*n,a=s*i;t.x+=o,t.y+=a}function iz(t,e,s,n,i){const r=new Set;let o={x:0,y:0},a=-1;const l=i.map(((u,h)=>(t===s.get(h)&&(a=h,o={index:h,...u}),{x:u.x,y:u.y,r:u.radius,index:h})));if(s.size<3)return l.map(((u,h)=>{if(h===a)return u;const g=u.x-o.x,f=u.y-o.y,p=Math.sqrt(g*g+f*f),y=e*g/p,_=e*f/p;return{x:u.x+y,y:u.y+_,radius:u.r}}));for(const u of n){const h=l[u.target],g=l[u.source],f=1;g.index===a||r.has(u.source)||(VE(g,o,f*e),r.add(u.source)),h.index===a||r.has(u.target)||(VE(h,o,f*e),r.add(u.target))}return l.map((u=>({x:u.x,y:u.y})))}function C2(t,e,s,n){t.includes(e)||(t=t.concat(e.toList())),n||(n=t.getAttributes(["x","y","radius"]));const i=Hx.from(n||t.getPosition(),(l=>l.x),(l=>l.y)),r=new Map;for(let l=0;l<t.size;l++)r.set(t._indexes[l],n[l]);const o=ez(i,t,r),a=nz(t.toArray(),o);return iz(e,s,t,a,n)}var rz=class{constructor(){this._intersects=null,this._getBounds=null}setBoundsGetter(t){return this._getBounds=t,this}setIntersector(t){return this._intersects=t,this}};function oz(t,e,s,n,i,r,o,a){return t>i&&t<o&&e>r&&e<a||s>i&&s<o&&n>r&&n<a}function Wr(t,e,s,n,i,r,o,a){return n>=r&&e<=a&&s>=i&&t<=o}var qr=(t,e,s,n,i,r)=>({minX:t,minY:e,maxX:s,maxY:n,leaf:!0,level:r,parent:i,objects:[],final:!1,children:null});function L2(t){const{minX:e,minY:s,maxX:n,maxY:i}=t;return[e,s,n,i]}function yd(t,e,s,n,i,r,o,a){return t>=i&&s<=o&&e>=r&&n<=a}var az=0,lz=1,uz=2,dz=3;function Hc(t,e,s,n,i,r,o,a){const l=(r+a)/2,u=(e+n)/2;return(t+s)/2<=(i+o)/2?u<=l?az:lz:u<=l?dz:uz}var hz=t=>t,zl=class extends rz{constructor(t=hz,e=10,s,n=0){super(),this._nodeCapacity=10,this._root=null,this._objects={},this._size=0,this._rootLevel=0,this._maxLevel=30,this._idToCell={},this._nodeCapacity=e,this._root=null,this._getBounds=t,this._rootLevel=n,this._maxLevel=n+30,this._idToCell={},s&&(this._root=qr(s[0],s[1],s[2],s[3],null,n))}get size(){return this._size}get root(){return this._root}clear(){return this._root=null,this._objects={},this._size=0,this._idToCell={},this._rootLevel=0,this._maxLevel=this._rootLevel+30,this}insert(t,e,s,n,i,r=this._root){if(e||([e,s,n,i]=this._getBounds(t)),this._objects[t])return;if(this._objects[t]=!0,this._size++,!this._root){const p=Math.max(Math.abs(n-e),Math.abs(i-s));return this._root=qr(e,s,e+p,s+p,null,this._rootLevel),this._idToCell[t]=[this._root],this._root.objects=[t],t}let o,a=[r],l=!1;const u=this._nodeCapacity,h=this._idToCell,g=this._maxLevel;let f;for(;f=a.pop();){o=f;const{minX:p,minY:y,maxX:_,maxY:x}=o;Wr(e,s,n,i,p,y,_,x)&&(o.leaf?o.objects&&(o.objects.length<u||o.final)?(o.objects.push(t),h[t]?h[t].push(o):h[t]=[o],l=!0,(o.level>=g||Math.abs(_-p)<=Math.abs(n-e)||Math.abs(x-y)<=Math.abs(i-s))&&(o.final=!0)):(this.splitNode(o),a.push(o)):a.push.apply(a,o.children))}if(!yd(e,s,n,i,(r=this._root).minX,r.minY,r.maxX,r.maxY)){let p=this._rootLevel;for(;!yd(e,s,n,i,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){r=this._root;const{minX:y,minY:_,maxX:x,maxY:v}=r;let b=y,S=_,A=x,w=v;const L=Math.abs(x-y),I=Math.abs(v-_);if(I===0&&L===0)break;const F=Math.max(L,I);e<y?(b-=F,s<_?S-=F:w+=F):(A+=F,s<_?S-=F:w+=F);const O=qr(b,S,A,w,null,--p);this.splitNode(O),O.children[Hc(y,_,x,v,b,S,A,w)]=r,this._root=r.parent=O}for(a=[this._root],this._root.level=this._rootLevel;f=a.shift();)if(o=f,!o.leaf)for(let y=0;y<4;y++){const _=o.children[y];_.level=o.level+1,a.push(_)}r=this._root;for(let y=0;y<4;y++){const _=r.children[y];_&&_.leaf&&_.objects&&(_.objects.push(t),h[t]?h[t].push(_):h[t]=[_])}}return l?t:void 0}removeById(t){if(!this._objects[t])return t;this._size--;const e=this._idToCell[t];for(let s=0;s<e.length;s++){const n=e[s].objects||[];for(let i=0,r=n.length;i<r;i++)if(n[i]===t){n.splice(i,1);break}}return delete this._objects[t],delete this._idToCell[t],t}remove(t){const[e,s,n,i]=this._getBounds(t),r=[this._root];let o,a;const l=[];for(;o=r.pop();)if(Wr(e,s,n,i,o.minX,o.minY,o.maxX,o.maxY))if(o.leaf){const u=o.objects||[];for(let h=0,g=u.length;h<g;h++)if(u[h]===t){u.splice(h,1),g===1&&l.push(o);break}}else r.push.apply(r,o.children);if(delete this._idToCell[t],delete this._objects[t],this._size--,l.length)for(;a=l.pop();){let u=a.parent,h=!0;for(;u&&h;){if(!u.leaf){for(let g=0;g<4;g++)if(o=u.children[g],!o.leaf||o.objects&&o.objects.length!==0){h=!1;break}h&&(u.leaf=!0,u.children=[],u.objects=[])}u=u.parent}}return t}splitNode(t){const{minX:e,minY:s,maxX:n,maxY:i}=t,r=(e+n)/2,o=(s+i)/2,a=t.level+1,l=this._idToCell,u=this._maxLevel,h=[qr(e,s,r,o,t,a),qr(e,o,r,i,t,a),qr(r,o,n,i,t,a),qr(r,s,n,o,t,a)];if(t.objects!==null){const g=t.objects,f=this._getBounds;for(let p=0,y=g.length;p<y;p++){const _=g[p],x=f(_);let v=l[_];for(let b=0;b<4;b++){const S=h[b],{minX:A,minY:w,maxX:L,maxY:I}=S;Wr(x[0],x[1],x[2],x[3],A,w,L,I)&&(S.objects&&S.objects.push(_),(S.level>=u||Math.abs(L-A)<=Math.abs(x[2]-x[0])||Math.abs(I-w)<=Math.abs(x[3]-x[1]))&&(S.final=!0),v?v.push(S):v=[S])}v&&v.splice(v.indexOf(t),1)}}t.children=h,t.objects=null,t.leaf=!1}point(t,e,s){let n=[];const i=[this._root];let r,o,a;const l=this._getBounds;for(;r=i.pop();)if(t>=r.minX&&t<=r.maxX&&e>=r.minY&&e<=r.maxY){if(r.leaf){s&&r.objects&&(n=r.objects);const u=r.objects||[];for(let h=0,g=u.length;h<g;h++)a=u[h],o=l(a),t>=o[0]&&t<=o[2]&&e>=o[1]&&e<=o[3]&&n.push(a);break}i.push.apply(i,r.children)}return n.length?n:null}neigbours(t,e){let s,n=[];const i=[this._root];for(;s=i.pop();)if(t>=s.minX&&t<=s.maxX&&e>=s.minY&&e<=s.maxY){if(s.leaf){n=s.objects;break}i.push.apply(i,s.children)}return n}query(t,e,s,n){const i=[],r=[this._root];let o,a,l;const u=this._getBounds,h={},g=this._intersects;let f;for(;o=r.pop();)if(Wr(t,e,s,n,o.minX,o.minY,o.maxX,o.maxY))if(o.leaf){const p=o.objects||[];for(let y=0,_=p.length;y<_;y++)l=p[y],h[l]||(a=u(l),Wr(t,e,s,n,a[0],a[1],a[2],a[3])&&(g&&!g(l,t,e,s,n)||i.push(l)),h[l]=!0)}else f=Hc(t,e,s,n,o.minX,o.minY,o.maxX,o.maxY),r.push(o.children[(f+3)%4],o.children[(f+2)%4],o.children[(f+1)%4],o.children[f]);return i}traverse(t,e,s,n,i){const r=[],o=[this._root];let a,l,u;const h=this._getBounds,g={},f=this._intersects;let p;for(;a=o.pop();)if(Wr(t,e,s,n,a.minX,a.minY,a.maxX,a.maxY))if(a.leaf){const y=a.objects||[];for(let _=0,x=y.length;_<x;_++)if(u=y[_],!g[u]){if(l=h(u),Wr(t,e,s,n,l[0],l[1],l[2],l[3])&&(!f||f(u,t,e,s,n))&&(r.push(u),i(u)))return r;g[u]=!0}}else p=Hc(t,e,s,n,a.minX,a.minY,a.maxX,a.maxY),o.push(a.children[(p+3)%4],a.children[(p+2)%4],a.children[(p+1)%4],a.children[p]);return r}getOverlaps(){const t=[this._root];let e,s,n;const i=[],r=this._getBounds,o={};for(;e=t.pop();)if(e.leaf){const a=e.objects||[],l=a.length;for(let u=0;u<l;u++)for(let h=0;h<l;h++)if(s=a[u],n=a[h],u!==h&&!o[s+":"+n]&&!o[n+":"+s]){o[s+":"+n]=!0;const g=r(s),f=r(n);Wr(g[0],g[1],g[2],g[3],f[0],f[1],f[2],f[3])&&i.push(s,n)}}else t.push.apply(t,e.children);return i}cover(t,e,s,n){if(this._root===null)return this._root=qr(t,e,s,n,null,0),this;let i=this._root;if(!yd(t,e,s,n,i.minX,i.minY,i.maxX,i.maxY)){let r=this._rootLevel;for(;!yd(t,e,s,n,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){i=this._root;const{minX:u,minY:h,maxX:g,maxY:f}=i;let p=u,y=h,_=g,x=f;const v=Math.abs(g-u),b=Math.abs(f-h);if(b===0&&v===0)break;const S=Math.max(v,b);t<u?(p-=S,e<h?y-=S:x+=S):(_+=S,e<h?y-=S:x+=S);const A=qr(p,y,_,x,null,--r);this.splitNode(A),A.children[Hc(u,h,g,f,p,y,_,x)]=i,this._root=i.parent=A}const o=[this._root];let a,l;for(this._root.level=this._rootLevel;a=o.shift();)if(l=a,!l.leaf)for(let u=0;u<4;u++){const h=l.children[u];h.level=l.level+1,o.push(h)}}return this}getAll(){return Object.keys(this._objects).map((t=>Number(t)))}forEach(t,e){const s=[this._root];let n;for(;n=s.pop();)if(n.leaf&&n.objects)for(let i=0,r=n.objects.length;i<r;i++)t.call(e,n.objects[i]);else s.push.apply(s,n.children);return this}getLeafs(){const t=[this._root],e=[];let s;for(;s=t.pop();)s.leaf?e.push(s):t.push.apply(t,s.children);return e}traverseFromRoot(t,e){const s=[this._root];let n;for(;n=s.pop();)t.call(e,n,n.objects)||n.leaf||s.push.apply(s,n.children);return this}update(t,e,s,n,i){return this.remove(t),this.insert(t,e,s,n,i),this}getNodeBounds(t){return L2(t)}};zl.flatAccessor=(t,e)=>s=>{const n=e*s;return t.slice(n,n+e)},zl.inside=yd,zl.intersects=oz,zl.overlaps=Wr,zl.getNodeBBox=L2;var cz=zl;function Xx(t,e,s,n,i){const r=new Array(t.length);for(let o=0;o<e.length;o++){const a=n[e[o]],l=n[s[o]];r[a]=r[a]||[],r[a].push(l),i&&(r[l]=r[l]||[],r[l].push(a))}return r}function Kd(t,e){return t[e]===-1?e:Kd(t,t[e])}function gz(t,e,s){const n=Kd(t,e),i=Kd(t,s);t[n]=i}function fz(t,e,s,n=!1){const i=new Int32Array(t.length),r={};for(let o=0;o<t.length;o++)i[o]=-1,r[t[o]]=o;for(let o=0;o<e.length;o++){const a=r[e[o]],l=r[s[o]];if(n&&a===l)return!0;const u=Kd(i,a),h=Kd(i,l);if(u===h)return!0;gz(i,u,h)}return!1}function k2(t,e,s,n,i,r,o,a){if(n[t]=i,s[t])return!0;if(e[t])return!1;e[t]=1,s[t]=1;const l=r[t];if(l){for(const u of l)if(k2(u,e,s,n,t,r,o,a))return o.push(a[u]),!0}return s[t]=0,!1}function N2(t,e,s){const n=t.length,i=new Uint8Array(n),r=new Uint8Array(n),o=new Int32Array(n),a={};for(let u=0;u<n;u++)a[t[u]]=u;const l=Xx(t,e,s,a,!1);for(let u=0;u<n;u++){const h=[];if(k2(u,i,r,o,-1,l,h,t)&&h.length>1){const g=h[0];for(let f=1;f<h.length;f++)if(h[f]===g){h.length=f;break}return h.push(g),h.reverse()}}return!1}function M2(t,e,s,n,i,r,o){e[t]=1,n[t]=s;const a=i[t];if(a){for(const l of a)if(e[l]){if(l!==s)return n[l]=t,r.push(o[l]),!0}else if(M2(l,e,t,n,i,r,o))return r.push(o[l]),!0}return!1}function pz(t,e,s){const n=t.length,i=new Uint8Array(n),r=new Int32Array(n),o={};for(let l=0;l<n;l++)o[t[l]]=l,r[l]=-1;const a=Xx(t,e,s,o,!0);for(let l=0;l<e.length;l++){const u=o[e[l]],h=o[s[l]];a[u]=a[u]||[],a[u].push(h)}for(let l=0;l<n;l++){const u=l,h=[];if(!i[u]&&M2(u,i,-1,r,a,h,t))return!0}return!1}var I2=class{constructor(t,e,s){this.cycles=[],this.visitedLength=0,this.visitedStack=[],this.stack=[],this.idToIndex={},this.removed={},this.nodes=t,this.visited=new Uint8Array(this.nodes.length);for(let n=0;n<t.length;n++)this.idToIndex[t[n]]=n;this.adjacency=Xx(t,e,s,this.idToIndex)}getCycles(){this.visited=new Uint8Array(this.nodes.length),this.visitedStack=[];for(let t=0;t<this.nodes.length;t++)for(this.backtrack(t,t);this.visitedLength!==0;){const e=this.visitedStack.pop();e!==void 0&&this.visited[e]&&(this.visited[e]=0,this.visitedLength--)}return this.cycles}backtrack(t,e){let s=!1;this.stack.push(e),this.visited[e]||(this.visited[e]=1,this.visitedLength++),this.visitedStack.push(e);const n=this.adjacency[e]||[];for(const i of n)if(this.removed[e]=this.removed[e]||{},!this.removed[e][i]){if(i<t)this.removed[e][i]=!0;else if(i===t){s=!0;const r=[];for(let o=0,a=!1;o<this.stack.length;o++){const l=this.stack[o];t===l&&(a=!0),a&&r.push(this.nodes[l])}this.cycles.push(r)}else if(!this.visited[i]){const r=this.backtrack(t,i);s=s||r}}if(s){let i;do i=this.visitedStack.pop(),this.visited[i]&&(this.visited[i]=0,this.visitedLength--);while(i!==e)}return this.stack.pop(),s}};function mz(){return{index:{},parent:[],count:0}}function _z(t,e){t.index[e]===void 0&&(t.count+=1,t.index[e]=t.parent.push(-t.count))}function jE(t,e){let s=t.index[e];if(s===void 0)return-1;for(;s>=0;)e=s,s=t.parent[s];return e}function yz(t,e,s){t.parent[s]=e,t.count-=1}function xz(t){return t.count<=1}function R2(t,e,s,n,i){i&&e.sort(((a,l)=>i(a)-i(l)));const r=[],o=mz();t.forEach((a=>_z(o,a)));for(let a=0;a<e.length&&!xz(o);a++){const l=jE(o,s(e[a])),u=jE(o,n(e[a]));l!==u&&l>0&&u>0&&(yz(o,l,u),r.push(e[a]))}return r}function F2({adjacency:t,directed:e=!1,normalized:s=!0}){const n=[],i=[],r={},o={},a={},l={};let u;const h=new Array(t.length),g={},f={},p={};for(let b=0;b<t.length;b++){const S=t[b];p[S.id]=S.adj,g[S.id]=!0,f[S.id]=b,e||S.adj.forEach((A=>{g[A]=!0}))}const y=Object.keys(g).map((b=>+b));for(let b=0;b<y.length;b++)h[b]=0;for(let b=0;b<y.length;b++)u=y[b],v(u),x();const _=s?y.length>2?1/((y.length-1)*(y.length-2)):0:e?0:.5;if(_)for(let b=0;b<h.length;b++)h[b]*=_;return h;function x(){for(let b=0;b<y.length;b++)l[y[b]]=0;for(;i.length;){const b=i.pop(),S=(1+l[b])/a[b],A=r[b];for(let w=0;w<A.length;++w){const L=A[w];l[L]+=a[L]*S}b!==u&&(h[f[b]]+=l[b])}}function v(b){for(let S=0;S<y.length;S++){const A=y[S];r[A]=[],o[A]=-1,a[A]=0}for(o[b]=0,a[b]=1,n.push(b);n.length;){const S=n.shift();i.push(S),p[S].forEach((A=>{o[A]===-1&&(o[A]=o[S]+1,n.push(A)),o[A]===o[S]+1&&(a[A]+=a[S],r[A].push(S))}))}}}var P2=class{constructor(t){this._heap=[],this._size=0,this._keyToValue=t,this._keyToIndex=new Int32Array(t.length),this._keyToIndex.fill(-1)}add(t){let e=this._keyToIndex[t];e===-1&&(e=this._size++,this._heap[e]=t),this._keyToIndex[t]=this._bubble(e)}removeMin(){if(this._size===0)return NaN;const t=this._heap[0];return this._heap[0]=this._heap[--this._size],this._bubble(0),t}isEmpty(){return this._size===0}has(t){return this._keyToIndex[t]!==-1}_bubble(t){const e=this._indexToValue(t),s=this._getParentIndex(t),n=this._indexToValue(s);let i=t;if(t!==0&&n>e)i=this._swap(t,s);else{const r=this._getLeftChildIndex(t),o=this._getRightChildIndex(t),a=this._indexToValue(r),l=this._indexToValue(o),u=Math.min(e,a,l);u===e||(i=u===a?this._swap(t,r):this._swap(t,o))}return i===t?t:this._bubble(i)}_indexToValue(t){return t>=this._size?1/0:this._keyToValue[this._heap[t]]}_getParentIndex(t){return(t-1)/2|0}_getLeftChildIndex(t){return 2*t+1}_getRightChildIndex(t){return 2*t+2}_swap(t,e){const s=this._heap[t],n=this._heap[e];return this._heap[t]=n,this._heap[e]=s,this._keyToIndex[s]=e,this._keyToIndex[n]=t,e}},z2=Yo&&!!window.PointerEvent,Yf="pointerdown",Wf="pointermove",Xf="pointerup",Sh="pointercancel",du={},cf=0,D2=t=>t.pointerType==="mouse",O2=t=>t.pointerType!=="mouse";function vz(){if(oo&&cf===0&&z2){const t=document.documentElement;t.addEventListener(Yf,B2,!0),t.addEventListener(Wf,U2,!0),t.addEventListener(Xf,gf,!0),t.addEventListener(Sh,gf,!0)}cf++}function bz(){if(cf--,oo&&cf===0){const t=document.documentElement;t.removeEventListener(Yf,B2,!0),t.removeEventListener(Wf,U2,!0),t.removeEventListener(Xf,gf,!0),t.removeEventListener(Sh,gf,!0)}}function B2(t){du[t.pointerId]=t}function U2(t){du[t.pointerId]&&(du[t.pointerId]=t)}function gf(t){delete du[t.pointerId]}function Zf(t,e){t.touches=[];for(const s in du)t.touches.push(du[s]);t.changedTouches=[t],e(t)}function Ez(t,e,s){const n=i=>{D2(i)||(O2(i)&&i.preventDefault(),Zf(i,s))};return t(e,Yf,n,!1),n}function Sz(t,e,s){const n=i=>{O2(i)&&i.preventDefault(),Zf(i,s)};return t(e,Sh,n,!1),n}function Az(t,e,s){const n=i=>{D2(i)&&i.buttons===0||Zf(i,s)};return t(e,Wf,n,!1),n}function wz(t,e,s){const n=i=>Zf(i,s);return t(e,Xf,n,!1),t(e,Sh,n,!1),n}function HE(t,e,s,n){return s==="touchstart"?t(e,Yf,n,!1):s==="touchmove"?t(e,Wf,n,!1):s==="touchend"?(t(e,Xf,n,!1),t(e,Sh,n,!1)):void 0}var Ke=class{constructor(t){this._ogma=t}_setModules(t){this._modules=t}onMounted(){}onReady(t){}destroy(t){}},Tz=["graphics","legend","brand"],Ym=300,Wm=300,Cz=200,Lz=class extends Ke{constructor(){super(...arguments),this._width=Ym,this._height=Wm,this._resizeObserver=e2((()=>this._resize())),this._layers={},this._focus=!1,this._container=null,this._isFullScreen=!1,this._beforeNextFramePromises=[],this._afterNextFramePromises=[],this._onNextFramePromises=[],this._refreshUntil=0,this._currentTime=$n(),this._timeouts=[],this._isDestroyed=!1,this._onDetachDom=[],this._isRealBrowser=Vf,this._isDocumentReady=jf,this._inFrame=!1,this._mustRefresh=!1,this._nextFrame=null,this._onWindowFocus=()=>this.refresh(),this._onFullscreenChange=()=>{this._isFullScreen=Rd()},this._resize=t=>{if(!this._container&&!t)return;const e=this._width,s=this._height;let n=0,i=0;if(this._container){const r=this._modules.settings.get("minimumWidth"),o=this._modules.settings.get("minimumHeight"),a=this._container.clientWidth||1,l=this._container.clientHeight||1;n=Math.max(r,t?t.width:a),i=Math.max(o,t?t.height:l)}else t&&(n=t.width,i=t.height);n===e&&i===s||(this._width=n,this._height=i,kr(this._layers,(({element:r,automaticResize:o})=>{o&&lf(r,n,i)})),this._modules.events.fire("resize",{prevWidth:e,prevHeight:s,width:n,height:i,difWidth:n-e,difHeight:i-s}))}}onMounted(){this._modules.settings.register("minimumWidth",Ym,(()=>this._resize()),!1),this._modules.settings.register("minimumHeight",Wm,(()=>this._resize()),!1),this._modules.events.register(["beforeNewFrame","frame","afterNewFrame","setContainer","resize"]),this._onDetachDom=[],vz(),this.addWindowEventListener("focus",this._onWindowFocus)}onReady(t){var e,s;t.container&&this.setContainer(t.container),(e=t.options)!=null&&e.width||(s=t.options)!=null&&s.height?this._resize({width:t.options.width||Ym,height:t.options.height||Wm}):this._resize()}addWindowEventListener(t,e,s){return this._isRealBrowser&&this.addElementEventListener(window,t,e,s),this}addDirectWindowEventListener(t,e,s){this._isRealBrowser&&window.addEventListener(t,e,s)}removeDirectWindowEventListener(t,e){this._isRealBrowser&&window.removeEventListener(t,e)}addDocumentEventListener(t,e,s){return this._isDocumentReady&&this.addElementEventListener(document.documentElement,t,e,s),e}removeDocumentEventListener(t,e){this._isDocumentReady&&document.documentElement.removeEventListener(t,e)}addMediaListener(t,e){if(this._isDocumentReady&&typeof window.matchMedia=="function"){const s=window.matchMedia(t);s.addListener(e),this._onDetachDom.push((()=>s.removeListener(e)))}}addElementEventListener(t,e,s,n){return this._isDestroyed||(t.addEventListener(e,s,n),this._onDetachDom.push((()=>t.removeEventListener(e,s,n)))),s}detachFromDom(){this._onDetachDom.forEach((t=>t())),this._onDetachDom=[],this._emptyContainer()}setTimeout(t,e=0){const s=setTimeout((()=>{this._timeouts.splice(this._timeouts.indexOf(s),1),t()}),e);return this._timeouts.push(s),s}clearTimeout(t){return t&&(clearTimeout(t),this._timeouts.splice(this._timeouts.indexOf(t),1)),null}clearAllTimeouts(){this._timeouts.forEach(clearTimeout),this._timeouts=[]}stopFrames(){this._isDestroyed=!0,this._nextFrame&&(XT(this._nextFrame),this._nextFrame=null)}isDestroyed(){return this._isDestroyed}getDimensions(){return{width:this._width,height:this._height}}setDimensions(t){this._resize(t)}setLayer(t,e,{automaticResize:s=!1}={}){e?(e._ogmaLayer=t,s&&(e.style.position="absolute",e.style.top="0px",e.style.left="0px",lf(e,this._width,this._height,vi())),this._layers[t]={element:e,automaticResize:s}):e===null&&delete this._layers[t],this._updateContainerContent()}setContainer(t){let e;if(typeof t=="string"){if(e=document.getElementById(t),!e)throw new Error(`unable to find DOM element with id "${t}"`)}else e=t;if(e===this._container)return;e===null&&this._emptyContainer();const s=this._container;this._isFullScreen=!1,this._container&&this._resizeObserver.unobserve(this._container),this._container=e,this._container&&(["fullscreenchange","webkitfullscreenchange"].forEach((n=>{this.addElementEventListener(this._container,n,this._onFullscreenChange)})),this._resizeObserver.observe(this._container)),this._resize(),this._updateContainerContent(),this._modules.events.fire("setContainer",{element:e,prevElement:s})}getContainer(){return this._container}appendElement(t){this._container!==null&&this._container.appendChild(t)}focus(){this._focus=!0}blur(){this._focus=!1}hasFocus(){return this._focus}forceResize(){this._resize()}_beforeOrAfterNextFrame(t){const e=t===1?this._onNextFramePromises:t===2?this._afterNextFramePromises:this._beforeNextFramePromises,s=new Promise((n=>{e.push((()=>(n(void 0),s)))}));return this._refresh(),s}beforeNextFrame(){return this._beforeOrAfterNextFrame(0)}onNextFrame(){return this._beforeOrAfterNextFrame(1)}afterNextFrame(){return this._beforeOrAfterNextFrame(2)}refresh(t){t&&(this._refreshUntil=Math.max(this._refreshUntil,t)),this._refresh()}_emptyContainer(){if(this._container){const t=[];for(let e=0;e<this._container.childNodes.length;++e){const s=this._container.childNodes[e];s._ogmaLayer&&t.push(s)}for(let e=0;e<t.length;++e)this._container.removeChild(t[e])}}_fillContainer(){if(this._container){const t=s2(this._container,"position");t!=="absolute"&&t!=="relative"&&t!=="fixed"&&(this._container.style.position="relative");const e=this._container.firstChild;Tz.forEach((s=>{const n=this._layers[s];n&&n.element&&this._container&&this._container.insertBefore(n.element,e)}))}}_updateContainerContent(){this._emptyContainer(),this._fillContainer()}_refresh(){this._inFrame?this._mustRefresh=!0:this._nextFrame||this._isDestroyed||(this._nextFrame=Fx((()=>this._playFrame())))}_playFrame(){const t=$n(),e={elapsed:t-this._currentTime},s=this._modules.events,n=oT([this._beforeNextFramePromises,()=>s.fire("beforeNewFrame",e),()=>s.fire("frame",e),this._onNextFramePromises,()=>s.fire("afterNewFrame",e),this._afterNextFramePromises,()=>{this._inFrame=!1,(this._mustRefresh||t<this._refreshUntil+17)&&(this._mustRefresh=!1,this._refresh())}]);this._inFrame=!0,this._nextFrame=null,this._mustRefresh=!1,this._currentTime=t,this._beforeNextFramePromises=[],this._onNextFramePromises=[],this._afterNextFramePromises=[],n.reduce(((i,r)=>i.then((()=>{if(!this._isDestroyed)return r()}))),Promise.resolve())}isPlayingFrame(){return this._inFrame||!!this._nextFrame}setFullScreen(t){let e=Promise.resolve();return t!==this._isFullScreen?(this._container&&(e=t?kz(this._container):Nz()),e.then((()=>new Promise((s=>{this.setTimeout((()=>{this._isFullScreen=Rd(),s(void 0)}),Cz)}))))):e}isFullScreen(){return Rd()}debounceBeforeFrame(t){let e=!1,s=[];const n=()=>{const i=s;e=!1,s=[],t(),i.forEach((r=>r()))};return()=>new Promise((i=>{s.push(i),e||(e=!0,this.beforeNextFrame().then(n))}))}destroy(){this._resizeObserver.disconnect(),bz(),this.detachFromDom(),this.clearAllTimeouts(),this.stopFrames()}};function Rd(){return typeof document<"u"&&!!(document.fullscreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)}function kz(t){return Rd()?Promise.resolve():t.requestFullscreen?t.requestFullscreen():t.requestFullScreen?t.requestFullScreen():t.webkitRequestFullScreen?Promise.resolve(t.webkitRequestFullScreen()):t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen?t.msRequestFullscreen():Promise.resolve()}function Nz(){return Rd()?typeof document>"u"?Promise.resolve():document.exitFullscreen?document.exitFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.webkitCancelFullScreen?Promise.resolve(document.webkitCancelFullScreen()):document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():Promise.resolve():Promise.resolve()}var Mz=class extends Ke{constructor(){super(...arguments),this._nodeChanges=[],this._edgeChanges=[],this._shouldTriggerEvents=!1}onMounted(){this._nodeDataList=this._modules.graph.createAttribute(!0,{name:"data",storage:"any"},!1),this._edgeDataList=this._modules.graph.createAttribute(!1,{name:"data",storage:"any"},!1),this._nodeList=this._modules.graph.getNodeAttribute("object"),this._edgeList=this._modules.graph.getEdgeAttribute("object"),this._modules.events.register(["setData","updateNodeData","updateEdgeData"]),this._modules.events.on("addNodes",(({nodes:t,objects:e})=>this._onAddElements(t,e))).on("addEdges",(({edges:t,objects:e})=>this._onAddElements(t,e))).on("beforeNewFrame",(()=>{this._shouldTriggerEvents&&(this._shouldTriggerEvents=!1,this._triggerEvents())}))}_onAddElements(t,e){const{isNode:s,size:n,_indexes:i}=t,r=this[s?"_nodeDataList":"_edgeDataList"];for(let o=0;o<n;++o)r.set(i[o],e[o].data)}setProperty(t,e,s,{dispatch:n=!1,virtual:i=!1}={}){this._setDataProperty(t.isNode,t._indexes,e,s,n,i),this._modules.events.fire("setData",{elements:t,virtual:i})}getProperty(t,e){return this._getDataProperty(t.isNode,t._indexes,e)}_setDataProperty(t,e,s,n,i,r){i&&typeof n=="function"&&(i=!1);const o=$E(s),a=typeof n=="function",l=t?this._nodeList:this._edgeList,u=t?this._nodeDataList:this._edgeDataList,h=Iz(t?this._nodeChanges:this._edgeChanges,o);for(let g=0;g<e.length;++g){const f=e[g];let p=u.get(f);const y=l.get(f),_=i?n[g]:n;let x,v;if(o===null)x=p,v=a?_(y):_,u.set(f,v);else{p==null&&(p={},u.set(f,p));const b=o.length;for(let S=0;S<b;S++){const A=o[S];let w=p[A];S<b-1?(w==null&&(w={},p[A]=w),p=w):(x=w,v=a?_(y):_,p[A]=v)}}h.indexes.push(f),h.previousValues.push(x),h.newValues.push(v),h.virtual=r}this._scheduleEvents()}_getDataProperty(t,e,s,n){const i=$E(s);n||(n=new Array(e.length));const r=t?this._nodeDataList:this._edgeDataList;for(let o=0;o<e.length;++o){const a=e[o];let l,u=r.get(a);if(i!==null&&i.length)if(u==null)l=void 0;else{const h=i.length;for(let g=0;g<h&&u;++g)l=u=u[i[g]]}else l=u;n[o]=l}return n}_scheduleEvents(){this._shouldTriggerEvents=!0,this._modules.dom.refresh()}_triggerEvents(){const t=this._prepareEvtPayload(!0),e=this._prepareEvtPayload(!1);this._modules.events.fire("updateNodeData",t),this._modules.events.fire("updateEdgeData",e)}_prepareEvtPayload(t){const e=t?this._modules.graph.nodeList:this._modules.graph.edgeList,s=t?"_nodeChanges":"_edgeChanges";let n=[];const i=this[s];this[s]=[];const r=[];for(let o=0;o<i.length;++o){const{indexes:a,property:l,newValues:u,previousValues:h,virtual:g}=i[o];n=n.concat(a||[]),t?r.push({property:l,newValues:u,previousValues:h,virtual:g,nodes:e(a)}):r.push({property:l,newValues:u,previousValues:h,virtual:g,edges:e(a)})}return t?{nodes:e(n).dedupe(),isNode:t,changes:r}:{edges:e(n).dedupe(),isNode:t,changes:r}}};function Iz(t,e){for(let n=0;n<t.length;++n){const i=t[n],r=i.property;if(e===null&&r===null)return i;if(e&&r&&r.length===e.length){let o=!0;for(let a=0;a<r.length;++a)if(r[a]!==e[a]){o=!1;break}if(o)return i}}const s={property:e&&e.slice(),indexes:[],previousValues:[],newValues:[],nodes:null,virtual:!1,edges:null};return t.push(s),s}function $E(t){return typeof t=="string"?t.split("."):Fn(t)?t:null}var No=()=>(t,e)=>t[e],Mo=()=>(t,e,s)=>{t[e]=s},qE={1:Xm(1),2:Xm(2),4:Xm(4),8:No(),16:No(),32:No(),int8:No(),int16:No(),int32:No(),float:No(),any:No()},YE={1:Zm(1),2:Zm(2),4:Zm(4),8:Mo(),16:Mo(),32:Mo(),int8:Mo(),int16:Mo(),int32:Mo(),float:Mo(),any:Mo()};function Xm(t){const e=8/t,s=(1<<t)-1;return(n,i)=>n[i/e|0]>>i%e*t&s}function Zm(t){const e=8/t,s=Math.pow(2,t)-1;return(n,i,r)=>{const o=i%e*t,a=i/e|0,l=r<<o,u=255-(s-r<<o);n[a]=n[a]&u|l}}function Rz(t,e){return t===void 0&&e!=="any"&&e!=="resource"?0:t}var Fz={get(t){return this._getArrayElt(this._buffer,t)},set(t,e){this._setArrayElt(this._buffer,t,e)}},Pz={get(t){return this._byIndex[this._getArrayElt(this._buffer,t)]},set(t,e){let s=this._byName[e];s===void 0&&(s=this._nextIndex++,this._byIndex.push(e),this._getElementBitSize()>this._elementSize&&this.increaseElementSize(),this._byName[e]=s),this._setArrayElt(this._buffer,t,s)}},zz=0,ff=class{constructor(t){this._id=zz++,this._initialized=!1;const e=t.name,s=t.storage,n=t.size||0,i=Rz(t.default,s),r=Math.max(8,WE(n+1)),o=s==="resource"?1:s;this._name=e,this._storage=s,this._getArrayElt=qE[o],this._setArrayElt=YE[o],this._elementSize=o,this._nbElements=r,this._fallback=null,this._byName=void 0,this._byIndex=void 0,this._nextIndex=void 0,this._defaultValue=i,this._BASE_VALUE=s==="any"?void 0:0,this._methods=Fz,this._initialized=!1,this._buffer=null,s==="resource"&&(this._methods=Pz,this._byName=Object.create(null),this._byIndex=[],this._nextIndex=1,this._byName[i]=0,this._byIndex.push(i))}getValues(){return Object.keys(this._byName||{})}getName(){return this._name||""}setDefaultValue(t){this._defaultValue=t,this._storage==="resource"&&(this._byName[t]=0,this._byIndex[0]=t)}get(t){return this._get(t)}set(t,e){this._set(t,e)}_get(t){return this._defaultValue}_set(t,e){e!==this._defaultValue&&(this._initialize(),this._set(t,e))}setFallback(t){this._fallback=t,this.get=this._getWithFallback}_getWithFallback(t){const e=this._get(t);return e===void 0&&this._fallback?this._fallback.get(t):e}_initialize(){this._initialized=!0,this._buffer=Km(this._nbElements,this._elementSize),this._get=this._methods.get,this._set=this._methods.set,this._storage!=="resource"&&this._defaultValue!==this._BASE_VALUE&&this._reset(0)}grow(t){const e=WE(t+1);if(!(e<=this._nbElements)){if(this._initialized)if(this._elementSize==="any")for(let s=this._nbElements;s<e;++s)this._buffer.push(this._defaultValue);else{const s=Km(e,this._elementSize);s.set(this._buffer),this._buffer=s,this._storage!=="resource"&&this._defaultValue!==this._BASE_VALUE&&this._reset(this._nbElements)}this._nbElements=e}}increaseElementSize(){const t=this._elementSize;if(typeof t!="number"||t===32)throw new Error("FlexArray: cannot increase element size");const e=2*t,s=qE[e],n=YE[e];if(this._initialized){const i=this._nbElements,r=this._getArrayElt,o=this._buffer,a=Km(i,e);if(t>=8)a.set(o);else for(let l=0;l<i;++l)n(a,l,r(o,l));this._buffer=a}this._elementSize=e,this._getArrayElt=s,this._setArrayElt=n}buffer(){if(!this._buffer)throw new Error("FlexArray: buffer not instantiated");return this._buffer}elementBitSize(){return this._elementSize}capacity(){return this._nbElements}byteSize(){return this._nbElements*this._elementSize/8}isInitialized(){return this._initialized||this._fallback&&this._fallback.isInitialized()}getMultiple(t,e){const s=t.length;e===void 0&&(e=new Array(s));for(let n=0,i=s;n<i;++n)e[n]=this.get(t[n]);return e}fill(t,e){for(let s=0,n=t.length;s<n;++s)this.set(t[s],e)}setMultiple(t,e,s){if(s||!Array.isArray(e)&&!ArrayBuffer.isView(e))for(let n=0,i=t.length;n<i;++n)this.set(t[n],e);else for(let n=0,i=t.length;n<i;++n)this.set(t[n],e[n])}reset(){return this._initialized&&this._reset(0),this}_reset(t){const e=this._storage==="resource"?0:this._defaultValue;if(this._buffer)if(typeof this._elementSize!="number"||this._elementSize>=8)this._buffer.fill(e,t);else{const s=8/this._elementSize;let n=0;for(let i=0;i<s;++i)n<<=this._elementSize,n+=e;if(t===void 0)this._buffer.fill(n);else{const i=t+(8-t%8);for(let r=t;r<i;++r)this._setArrayElt(this._buffer,r,e);this._buffer.fill(n,i/8)}}}_getElementBitSize(){if(this._nextIndex)return Math.pow(2,Math.ceil(Math.log2(Math.log2(this._nextIndex))))}};function WE(t){let e=2;for(;e<t;)e*=2;return e}function Km(t,e){return e==="any"?new Array(t):e==="float"?new Float32Array(t):e==="int8"?new Int8Array(t):e==="int16"?new Int16Array(t):e==="int32"?new Int32Array(t):e===32?new Uint32Array(t):e===16?new Uint16Array(t):new Uint8Array(Math.ceil(t/8*e))}var XE=4,G2=class{constructor(){this._buffer=new Uint32Array(XE),this._capacity=XE,this._size=0,this._busy=!1}isBusy(){return this._busy}markBusy(){return this._busy=!0,this}sliceAndReset(){this._busy=!1;const t=this.slice(0,this._size);return this.reset(),t}reset(){return this._size=0,this}reserve(t){return t>this._capacity&&this._setCapacity(Vo(t)),this}_setCapacity(t){const e=new Uint32Array(t);e.set(this._buffer),this._buffer=e,this._capacity=t}push(t){return this._size===this._capacity&&this._setCapacity(2*this._capacity),this._buffer[this._size++]=t,this}pushUnchecked(t){return this._buffer[this._size++]=t,this}slice(t=0,e=this._size){return this._buffer.slice(t,e)}getBuffer(){return this._buffer}getLength(){return this._size}getCapacity(){return this._capacity}setLength(t){return this._size=t,this}isEmpty(){return this._size===0}},ZE=class{constructor(t){this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._flexArrays=[],this._defaultValues=[],this._flexArraysByName={},this._indexLists=[],this._name=t?"node":"edge",this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._idFlexArray=new ff({storage:"int32"}),this._idFlexArray.get=e=>this._indexToId[e],this._idFlexArray.getMultiple=e=>{const s=new Array(e.length);for(let n=0;n<e.length;++n)s[n]=this._indexToId[e[n]];return s},this._flexArraysByName.id=this._idFlexArray}addElements(t){const e=[];for(let s=0,n=t.length;s<n;++s){const i=t[s];let r=this._idToIndex[i];r===void 0&&(r=this._getNextIndex(),this._idToIndex[i]=r,this._indexToId[r]=i),e.push(r)}for(const s of this._flexArrays)s.grow(this._nextIndex);for(const s of this._indexLists)s.reserve(this._nextIndex);return new Uint32Array(e)}removeElements(t){for(let e=0,s=t.length;e<s;++e){const n=t[e],i=this._indexToId[n];i!==void 0&&(delete this._idToIndex[i],this._removeIndex(n))}}clear(){this._idToIndex=Object.create(null),this._indexToId=[void 0],this._nextIndex=1,this._freeIndexes=[];for(const t of this._flexArrays)t.reset();for(const t of this._indexLists)t.reset()}has(t){return this._indexToId[t]!==void 0}getIndex(t,e=!1){const s=this._idToIndex[t];if(s===void 0&&e)throw new Error(`${this._name} id "${t}" not found`);return s}createFlexArray(t,e){const{name:s}=t;if(s&&e&&this._flexArraysByName[s])throw new Error(`${this._name} flexArray "${s}" already exists`);let n=t.default;n===void 0&&t.storage!=="any"&&t.storage!=="resource"&&(n=0);const i=this._nextIndex,r={storage:t.storage,size:i,name:s,default:n};let o;return o=(n===void 0&&t.storage!=="any"&&t.storage,new ff(r)),this._flexArrays.push(o),this._defaultValues.push(t.default),s&&e&&(this._flexArraysByName[s]=o),o}getFlexArray(t){return this._flexArraysByName[t]}getAllFlexArrays(){return this._flexArraysByName}createIndexList(){const t=new G2;return t.reserve(this._nextIndex),this._indexLists.push(t),t}getId(t){return this._indexToId[t]}getMaxIndex(){return this._nextIndex-1}_removeIndex(t){this._indexesToBeFreed.push(t)}_getNextIndex(){let t=this._freeIndexes.pop();return t===void 0&&(t=this._nextIndex++),t}freeIndexes(){for(const t of this._indexesToBeFreed)this._indexToId[t]=void 0,this._freeIndexes.push(t);for(let t=0;t<this._flexArrays.length;++t){const e=this._flexArrays[t],s=this._defaultValues[t];for(const n of this._indexesToBeFreed)e.set(n,s)}this._indexesToBeFreed=[]}};function KE(t,e,s={},n={}){const i=Qd(t,e,[s],n);return t.fireEvent("postAddElements",{nodes:e?i:void 0,edges:e?void 0:i,virtual:n&&n.virtual}),i.get(0)}function Dz(t,{nodes:e=[],edges:s=[]},n={}){if(t.fireEvent("preAddGraph",{name:"preAddGraph"}),!n.batchSize)return Promise.all([Qd(t,!0,e,n),Qd(t,!1,s,n)]).then((([r,o])=>(t.fireEvent("postAddElements",{nodes:r,edges:o,virtual:n&&n.virtual}),t.fireEvent("postAddGraph",{name:"postAddGraph"}),t.fireEvent("addGraph",{nodes:r,edges:o}),{nodes:r,edges:o})));let i;return pf(t,!0,e,n).then((r=>(i=r,pf(t,!1,s,n)))).then((r=>({nodes:i,edges:r}))).then((r=>(t.fireEvent("postAddGraph",{name:"postAddGraph"}),t.fireEvent("addGraph",{name:"addGraph"}),r)))}function pf(t,e,s,n={}){if(n.batchSize){const i=[];for(let a=0;a<s.length;a+=n.batchSize)i.push(s.slice(a,a+n.batchSize));const r=(a,l)=>{let u;return a.then((h=>(u=h,t.getDom().afterNextFrame()))).then((()=>Qd(t,e,l,n))).then((h=>u.concat(h)))},o=e?t.nodeList():t.edgeList();return i.reduce(r,Promise.resolve(o)).then((a=>(t.fireEvent("postAddElements",{nodes:e?a:void 0,edges:e?void 0:a,virtual:n&&n.virtual}),a)))}return Promise.resolve(Qd(t,e,s,n)).then((i=>(t.fireEvent("postAddElements",{nodes:e?i:void 0,edges:e?void 0:i,virtual:n&&n.virtual}),i)))}function Qd(t,e,s,n){const{virtual:i=!1}=n;t.fireEvent("preAddElements",{name:"preAddElements",objects:s,virtual:i,isNode:e});const r=!!n.ignoreInvalid,o=t.storage.fetch(e),a=[],l=[],u=[],h=[],g=new Set;for(const w of s){if(typeof w!="object"||w===null||Array.isArray(w)){if(r)continue;throw new Error(`${w} is not a valid ${e?"node":"edge"}`)}const L=pF(w.id);if(!o.getIndex(L,!1)&&!g.has(L)){if(!e){const I=w,F=t.getExtremityIndex(L,I.source,0,r),O=t.getExtremityIndex(L,I.target,1,r);if(r&&(!F||!O))continue;u.push(F),h.push(O)}l.push(L),a.push(w),g.add(L)}}const f=o.addElements(l);e?t.topology.allocateNodes(f):t.topology.allocateEdges(f,u,h);const p=o.getFlexArray("object"),y=o.getFlexArray("excluded"),_=o.getFlexArray("removed"),x=o.getFlexArray("virtual"),v=e?t.node:t.edge,b=e?t.nodeList:t.edgeList,S=t.getCacheLists(e),A=b(f);for(let w=0;w<f.length;w++){const L=f[w];p.set(L,v(L))}return y.setMultiple(f,0),_.setMultiple(f,0),x.setMultiple(f,i?1:0),S.visible.invalidList(),S.all.invalidList(),S._all.invalidList(),i||S.raw.invalidList(),A.size!==0&&(e?t.fireEvent("addNodes",{virtual:i,objects:a,nodes:A}):t.fireEvent("addEdges",{virtual:i,objects:a,edges:A})),A}var Oz=1,Bz=2,Uz=3,Gz=4,Vz=5,jz=6,_y="_visible",yy="_data",Fd="_hovered",xy="_hoverExtremityHighlighted",Gs="_selected",vy="_selectionExtremityHighlighted",Bg="_dragged",V2="_rewirable",ka="_export",j2="_faded",H2="_transparent",Hz="_visual_groups",Ah=-1,$c="in",qc="out",Qm="both",QE=[Gs,Bg,vy,Fd,xy,V2,ka,j2,H2,Hz],$2=2,q2=3,$z=3,qz=4,Y2=-1,Yz=["hover","zoom","panning","rotation","gesture","drag","selection","tooltip","user","interactions","resizing","rewiring","connectNodes","lasso"],JE=(t,e)=>(t+e)*(t+e+1)/2+e;function ed(t,e){const s=t<e?t:e;return 67108864*s+(t+e-s)}var Wz=8,by=class{constructor(){this._BIG_LIST=255,this._MAX_LIST_SIZE=8,this._capacity=Wz,this._buffer=new Uint32Array(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._constList=new Array(this._MAX_LIST_SIZE)}addEntry(t){return t===void 0&&(t=this._nextIndex++),t>=this._capacity&&this._reserve(t+1),this._sizes[t]=0,t}get(t){const e=this._sizes[t],s=this._MAX_LIST_SIZE*t;if(e<=this._MAX_LIST_SIZE){this._constList.length=e;for(let n=0,i=e;n<i;++n)this._constList[n]=this._buffer[s+n];return this._constList}if(e===this._BIG_LIST){const n=this._buffer[s];return this._bigLists[n]}throw new Error(`Table: ${t} out of bounds (${e})`)}size(t){const e=this._sizes[t];return e<=this._MAX_LIST_SIZE?e:this._bigLists[this._buffer[t*this._MAX_LIST_SIZE]].length}sizes(t){const e=this._sizes,s=this._bigLists,n=this._buffer,i=this._MAX_LIST_SIZE,r=t.length,o=new Array(r);for(let a=0;a<r;a++){const l=t[a],u=e[l];o[a]=u<=i?u:s[n[l*i]].length}return o}addTo(t,e){const s=this._sizes[t],n=t*this._MAX_LIST_SIZE;if(s<this._MAX_LIST_SIZE)this._buffer[n+s]=e,this._sizes[t]=s+1;else if(s===this._BIG_LIST){const i=this._buffer[n];this._bigLists[i].push(e)}else{const i=new Array(this._MAX_LIST_SIZE);for(let r=0;r<this._MAX_LIST_SIZE;++r)i[r]=this._buffer[n+r];i.push(e),this._bigLists.push(i),this._sizes[t]=this._BIG_LIST,this._buffer[n]=this._bigLists.length-1}return this}removeFrom(t,e){return this.removeFromAndGetSize(t,e),this}removeFromAndGetSize(t,e){const s=this._MAX_LIST_SIZE*t;let n=this._sizes[t];if(n<=this._MAX_LIST_SIZE){for(let i=s,r=s+n;i<r;++i)if(this._buffer[i]===e)return n-=1,this._buffer[i]=this._buffer[r-1],this._sizes[t]=n,n}else if(n===this._BIG_LIST){const i=this._buffer[s],r=this._bigLists[i],o=r.indexOf(e);if(o!==-1)return r.splice(o,1),r.length}throw new Error('topology: Table: "removeFrom" failed, should not happen')}reserve(t){return this._capacity<t&&this._reserve(t),this}_reserve(t){this._capacity=Math.pow(2,Math.ceil(Math.log2(t))),this._buffer=tS(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=tS(this._sizes,this._capacity)}};function tS(t,e){const s=new t.constructor(e);return s.set(t),s}var Cl=void 0,Xz=class{constructor(t){this._neighborTable=new by,this._parallelTable=new by,this._parallelEdgesIndex=[],this._hasParallelEdges=new Set,this._fakeDeduper={get:()=>0,set:as,reset(){return this}},this._fakeInvertedDeduper={get:()=>1,set:as,reset(){return this}},this._graph=t,this.nodeDeduper=t.createNodeAttribute({storage:1},!1),this.edgeDeduper=t.createEdgeAttribute({storage:1},!1),this._sourceList=t.getEdgeAttribute("source"),this._targetList=t.getEdgeAttribute("target")}getAdjacentDirections(t){return this._neighborTable.get(t)}getEdgeIndexesInDirection(t){return this._parallelTable.get(t)}allocateNodes(t){this._neighborTable.reserve(t.length);for(let e=0;e<t.length;++e)this._neighborTable.addEntry(t[e])}allocateEdges(t,e,s){this._parallelTable.reserve(Math.floor(t.length/2));for(let n=0;n<t.length;n++){const i=t[n],r=e[n],o=s[n];this._sourceList.set(i,r),this._targetList.set(i,o),this.addToAdjacencyList(i)}}getExtremity(t,e){const s=t?this._sourceList:this._targetList;if(e.isList){const n=this._graph.acquireIndexList(!0);for(let i=0;i<e._indexes.length;i++)n.push(s.get(e._indexes[i]));return this._graph.nodeList(n.sliceAndReset())}return this._graph.getObjectList(!0).get(s.get(e._index))}setExtremities(t,e,s){for(let n=0;n<t.length;++n)this.removeFromAdjacencyList(t[n]);e!==null&&this._sourceList.setMultiple(t,e),s!==null&&this._targetList.setMultiple(t,s);for(let n=0;n<t.length;++n)this.addToAdjacencyList(t[n])}addToAdjacencyList(t){const e=this._sourceList.get(t),s=this._targetList.get(t),n=ed(e,s);let i=this._parallelEdgesIndex[n];if(i===Cl)i=this._parallelTable.addEntry(),this._parallelEdgesIndex[n]=i,this._neighborTable.addTo(e,i),e!==s&&this._neighborTable.addTo(s,i);else{this._hasParallelEdges.add(t);const r=this._parallelTable.get(+i);if(r)for(const o of r)this._hasParallelEdges.add(o)}this._parallelTable.addTo(i,t)}hasParallelEdges(t){return this._hasParallelEdges.has(t)}removeFromAdjacencyList(t){const e=this._sourceList.get(t),s=this._targetList.get(t),n=ed(e,s),i=this._parallelEdgesIndex[n];i!==Cl&&this._parallelTable.removeFromAndGetSize(i,t)===0&&(this._neighborTable.removeFrom(e,i),e!==s&&this._neighborTable.removeFrom(s,i),this._parallelEdgesIndex[n]=Cl,this._hasParallelEdges.delete(t))}getParallelEdges(t,e={}){const s=e.filter||"visible",n=this._graph.acquireIndexList(!1),i=this._graph.getFilter(!1,s);for(let r=0;r<t._indexes.length;r++){const o=t._indexes[r],a=ed(this._sourceList.get(o),this._targetList.get(o)),l=this._parallelEdgesIndex[a];if(l!==Cl){const u=this._parallelTable.get(+l);if(u)for(const h of u)i(h)&&n.push(h)}}return this._graph.edgeList(n.sliceAndReset())}fastGetNodesAdjacentElements(t){const e=this._graph.acquireIndexList(!0),s=this._graph.acquireIndexList(!1),n=this._sourceList,i=this._targetList;for(let r=0;r<t.length;r++){const o=t[r],a=this._neighborTable.get(o);for(const l of a){const u=this._parallelTable.get(l),h=u[0],g=n.get(h),f=i.get(h);if(g!==0&&f!==0){e.push(g+f-o);for(const p of u)s.push(p)}}}return{nodes:this._graph.nodeList(e.sliceAndReset()),edges:this._graph.edgeList(s.sliceAndReset())}}fastGetEdgesAdjacentElements(t){const e=this._graph.acquireIndexList(!0),s=this._graph.acquireIndexList(!1),n=this._sourceList,i=this._targetList;for(let r=0;r<t.length;r++){const o=t[r],a=n.get(o),l=i.get(o),u=ed(a,l),h=this._parallelEdgesIndex[u];if(h!==Cl){const g=this._parallelTable.get(+h);if(g)for(const f of g)s.push(f)}e.push(a),e.push(l)}return{nodes:this._graph.nodeList(e.sliceAndReset()),edges:this._graph.edgeList(s.sliceAndReset())}}getDeduper(t){return(t?this.nodeDeduper:this.edgeDeduper).reset()}collectAdjacentEdges(t,e,s,n=!1,i=!1){const r=e===$c,o=!(e===qc||r||i),a=this._graph.acquireIndexList(!1),l=this._graph.getFilter(!1,s),u=n?this.getDeduper(!1):this._fakeDeduper;let h=this._fakeInvertedDeduper;const g=this._sourceList,f=this._targetList;if(i){h=this.getDeduper(!0);for(let p=0;p<t.length;p++)h.set(t[p],1)}for(let p=0;p<t.length;p++){const y=t[p],_=this._neighborTable.get(y);for(const x of _){const v=this._parallelTable.get(x);if(o)for(const b of v)l(b)&&u.get(b)===0&&(a.push(b),u.set(b,1));else for(const b of v){const S=g.get(b),A=f.get(b),w=S+A-y;r!==(A===y)&&S!==A||!l(b)||u.get(b)!==0||h.get(w)!==1||(a.push(b),u.set(b,1))}}}return a.sliceAndReset()}collectAdjacentNodes(t,e,s,n=!1,i,r){const o=e!==$c,a=e!==qc,l=this._graph.acquireIndexList(!0),u=this._graph.getFilter(!1,s),h=n?this.getDeduper(!0):this._fakeDeduper,g=this._sourceList,f=this._targetList;if(i)for(let p=0;p<i.length;p++){const y=i[p];l.push(y),h.set(y,1)}if(r)for(let p=0;p<r.length;p++){const y=r[p];h.set(y,1)}for(let p=0;p<t.length;p++){const y=t[p],_=this._neighborTable.get(y);for(const x of _){const v=this._parallelTable.get(x);for(const b of v)if(u(b)){const S=g.get(b),A=f.get(b),w=S+A-y;if((a&&y===A||o&&y===S)&&h.get(w)===0){l.push(w),h.set(w,1);break}}}}return l.sliceAndReset()}getAdjacentElements(t,e,s={}){const n=s.direction||Qm,i=s.filter||"visible",r=s.policy||"union",o=!!s.bothExtremities;if(t){const a=r==="include-sources"?e:null,l=r==="exclude-sources"?e:null;return this.collectAdjacentNodes(e,n,i,!0,a,l)}return this.collectAdjacentEdges(e,n,i,!0,o)}getEdgesBetweenTwoNodes(t,e){const s=ed(t,e),n=this._parallelEdgesIndex[s];if(n===Cl)return new Uint32Array;const i=this._parallelTable.get(+n);return new Uint32Array(i)}getConnectedComponents(t,{filter:e="visible",returnIds:s=!1,internalIndexes:n=!1}={}){const i=this._graph,r=[],o={},a=i.acquireIndexList(!0);let l;typeof e=="string"?l=i.getFilter(!0,e):(l=e,e="visible");for(let g=0;g<t.length;g++){const f=t[g];l(f)&&a.push(f)}const u=a.sliceAndReset(),h={filter:e};for(let g=0;g<u.length;g++){const f=u[g];if(!o[f]){const p=[f],y=[];for(;p.length!==0;){const _=p.pop();!o[_]&&l(_)&&(p.push.apply(p,this.getAdjacentElements(!0,new Uint32Array([_]),h)),o[_]=!0,y.push(_))}y.length>0&&r.push(y)}}if(s){const g=i.getNodeAttribute("id");for(let f=0;f<r.length;f++)r[f]=g.getMultiple(r[f])}else if(!n)for(let g=0;g<r.length;g++)r[g]=i.nodeList(new Uint32Array(r[g]));return r}getAdjacencyList({directed:t,ids:e,weight:s,nodes:n}){const i=t?qc:Qm,r=new Array(n.length),o=this._graph;for(let y=0;y<n.length;++y)r[y]=this.collectAdjacentEdges(new Uint32Array([n[y]]),i,"all");const a=o.getEdgeAttribute("source"),l=o.getEdgeAttribute("target"),u=o.getEdgeAttribute("width"),h=o.getNodeAttribute("id"),g=[],f=typeof s=="number",p=typeof s!="function"&&!f&&!!s;for(let y=0;y<r.length;y++){const _=r[y],x=n[y],v=_.length,b=e?new Array(v):new Uint32Array(v),S=new Array(v);for(let w=0;w<v;w++){const L=_[w],I=a.get(L),F=l.get(L);let O=t||x===I?F:I;if(e&&(O=h.get(O)),b[w]=O,s){if(f&&(S[w]=s),typeof s=="function"){const V=o.getNode(I),j=o.getNode(F);S[w]=s(V,j)}p&&(S[w]=u.get(L)||1)}}const A={nodes:b,id:e?h.get(x):x,...s&&{weights:S}};g.push(A)}return g}degrees(t,e){if(e!==$c&&e!==qc)return this._neighborTable.sizes(t);const s=new Array(t.length),n=e===$c;for(let i=0,r=t.length;i<r;i++)s[i]=this._degree(t[i],n);return s}_degree(t,e){const s=this._neighborTable.get(t),n=this._sourceList,i=this._targetList;let r=0;for(let o=0;o<s.length;++o){const a=this._parallelTable.get(s[o]);for(let l=0;l<a.length;++l){const u=a[l],h=n.get(u),g=i.get(u);if(e&&g===t||!e&&h===t){r+=1;break}}}return r}getDegree(t,e){const{direction:s,filter:n}=this._getDegreeOptions(e),i=new Array(t.length),r=new Uint32Array(1);for(let o=0;o<t.length;++o)r[0]=t[o],i[o]=this.collectAdjacentNodes(r,s,n).length;return i}_getDegreeOptions(t){const e={direction:Qm,filter:"visible"};return typeof t=="string"?e.direction=t:t&&(typeof t.direction=="string"&&(e.direction=t.direction),typeof t.filter=="string"&&(e.filter=t.filter)),e}},Zz=class extends Ke{constructor(){super(...arguments),this.storage={nodes:new ZE(!0),edges:new ZE(!1),fetch(t){return t?this.nodes:this.edges}},this._promisesToResolve=[],this._nodeIndexLists=[],this._edgeIndexLists=[],this._onNewFrame=()=>{this.storage.nodes.freeIndexes(),this.storage.edges.freeIndexes()}}onMounted(){this._modules.events.register(["preAddElements","postAddElements","addNodes","addEdges","preAddGraph","postAddGraph","addGraph","excludedStateChange","clearGraph","afterRemoveNodes","beforeRemoveNodes","requestElementsToDelete","removeNodes","beforeRemoveEdges","afterRemoveEdges","removeEdges"]),[{name:"excluded",storage:1,default:1},{name:"removed",storage:1,default:1},{name:"virtual",storage:1,default:0}].forEach((t=>{this.createNodeAttribute(t,!0),this.createEdgeAttribute(t,!0)})),this.node=this._ogma.node,this.edge=this._ogma.edge,this.nodeList=this._ogma.nodeList,this.edgeList=this._ogma.edgeList,this._nodes=this.createAttribute(!0,{name:"object",storage:"any"},!0),this._edges=this.createAttribute(!1,{name:"object",storage:"any"},!0),this.createAttribute(!1,{name:"source",storage:32},!0),this.createAttribute(!1,{name:"target",storage:32},!0),this._nodeFilters=aE(this.storage.nodes),this._edgeFilters=aE(this.storage.edges),this._initialize(),this._modules.events.on("frame",this._onNewFrame)}onReady(t){if(t.graph){const{nodes:e,edges:s}=t.graph;e&&this.addNodes(e),s&&this.addEdges(s)}}createIndexList(t){return this.storage.fetch(t).createIndexList()}getDom(){return this._modules.dom}acquireIndexList(t){const e=t?this._nodeIndexLists:this._edgeIndexLists;let s=e.find((n=>!n.isBusy()));return s||(s=this.createIndexList(t),e.push(s)),s.markBusy(),s}getObjectList(t){return t?this._nodes:this._edges}getListFactory(t){return t?this.nodeList:this.edgeList}getStorage(t){return t?this.storage.nodes:this.storage.edges}getFilter(t,e){const s=t?this._nodeFilters:this._edgeFilters;return s[e]||s.visible}fireEvent(t,e){this._modules.events.fire(t,e)}getCacheLists(t){return t?this._nodeCacheLists:this._edgeCacheLists}_resolvePromises(){const t=this._promisesToResolve;this._promisesToResolve=[],t.forEach((e=>e()))}_initialize(){this._nodeCacheLists=lE((()=>this.getNodeMaxIndex()),(()=>this.acquireIndexList(!0)),this._nodeFilters),this._edgeCacheLists=lE((()=>this.getEdgeMaxIndex()),(()=>this.acquireIndexList(!1)),this._edgeFilters),this.topology=new Xz(this),this._resolvePromises()}getNodeMaxIndex(){return this.storage.nodes.getMaxIndex()}getEdgeMaxIndex(){return this.storage.edges.getMaxIndex()}isExcluded(t){return this.storage.fetch(t.isNode).getFlexArray("excluded").getMultiple(t._indexes)}setExcluded(t,e){const s=e?1:0,n=t.isNode,i=this.storage.fetch(n),r=i.getFlexArray("excluded"),o=i.getFlexArray("removed"),a=this.acquireIndexList(n),l=this.getListFactory(n);for(let h=0;h<t._indexes.length;h++){const g=t._indexes[h],f=r.get(g),p=o.get(g);s!==f&&p===0&&a.push(g)}const u=a.sliceAndReset();if(u.length){this.getCacheLists(t.isNode).visible.invalidList();const h=l(u);r.setMultiple(u,s),this._modules.events.fire("excludedStateChange",{elements:h,value:e})}}addNode(t,e){return KE(this,!0,t,e)}addEdge(t,e){return KE(this,!1,t,e)}addNodes(t,e){return pf(this,!0,t,e)}addEdges(t,e){return pf(this,!1,t,e)}addGraph(t,e){return Dz(this,t,e)}getExtremityIndex(t,e,s,n){if(e instanceof yi)return e._index;{const i=this.storage.nodes.getIndex(e);if(!i&&!n)throw new Error(`addEdge(s): invalid ${s===0?"source":"target"} for edge "${t}"; node "${e}" does not exist`);return i}}getNodes(t){return this.getElements(!0,t)}getEdges(t){return this.getElements(!1,t)}getElements(t,e){const s=t?this.nodeList:this.edgeList,n=t?lo:qa,i=t?yi:Mr;if(e&&typeof e!="string"){const r=this.acquireIndexList(t),o=this.storage.fetch(t);if(e instanceof i)r.push(e._index);else if(Fn(e)){const a=e;for(const l of a)if(l instanceof i)r.push(l._index);else{const u=o.getIndex(l);u&&r.push(u)}}else if(e instanceof n){const a=this.getFilter(t,"all"),l=e;for(let u=0;u<l._indexes.length;u++){const h=l._indexes[u];a(h)&&r.push(h)}}return s(r.sliceAndReset())}{const r=e||"visible",o=this.getCacheLists(t)[r];if(!o)throw new Error(`getNodes/getEdges: unexpected argument "${r}"`);return s(o.getList())}}getNode(t){return this._getElement(!0,t)}getEdge(t){return this._getElement(!1,t)}_getElement(t,e){if(e instanceof(t?yi:Mr))return e;const s=this.getStorage(t),n=this.getObjectList(t),i=s.getIndex(e);return i?n.get(i):void 0}clear(){this._modules.events.fire("clearGraph",{nodes:this.getNodes("all"),edges:this.getEdges("all")}),this.storage.nodes.clear(),this.storage.edges.clear(),this._initialize()}createAttribute(t,e,s=!1){return this.storage.fetch(t).createFlexArray(e,s)}createNodeAttribute(t,e){return this.createAttribute(!0,t,e)}createEdgeAttribute(t,e){return this.createAttribute(!1,t,e)}getAttribute(t,e){return this.storage.fetch(t).getFlexArray(e)}getAttributes(t,e){return e.map((s=>this.getAttribute(t,s)))}getNodeAttribute(t){return this.storage.nodes.getFlexArray(t)}getNodeAttributes(t){return this.getAttributes(!0,t)}getEdgeAttribute(t){return this.storage.edges.getFlexArray(t)}getEdgeAttributes(t){return this.getAttributes(!1,t)}getAllNodeAttributes(){return this.storage.nodes.getAllFlexArrays()}getAllEdgeAttributes(){return this.storage.edges.getAllFlexArrays()}setSource(t,e){const s=this.getNode(e);s&&this.topology.setExtremities(t._indexes,s._indexes,null)}setTarget(t,e){const s=this.getNode(e);s&&this.topology.setExtremities(t._indexes,null,s._indexes)}getParallelEdges(t,e={}){return this.topology.getParallelEdges(t,e)}hasParallelEdges(t){return this.topology.hasParallelEdges(t._index)}getEdgesBetweenTwoNodes(t,e){return this.edgeList(this.topology.getEdgesBetweenTwoNodes(t._index,e._index))}getAdjacentDirections(t){return this.topology.getAdjacentDirections(t)}getEdgeIndexesInDirection(t){return this.topology.getEdgeIndexesInDirection(t)}fastGetNodesAdjacentElements(t){const e=this._ogma.getNodes();let s=!1;if(e.size===t.size){const n=new Set(t._indexes);for(let i=0;i<e.size;i++)n.delete(e._indexes[i]);s=n.size===0}return s?{nodes:e,edges:this._ogma.getEdges()}:this.topology.fastGetNodesAdjacentElements(t._indexes)}fastGetEdgesAdjacentElements(t){const e=this._ogma.getEdges();let s=!1;if(e.size===t.size){const n=new Set(t._indexes);for(let i=0;i<e.size;i++)n.delete(e._indexes[i]);s=n.size===0}return s?{nodes:this._ogma.getNodes(),edges:e}:this.topology.fastGetEdgesAdjacentElements(t._indexes)}getAdjacentNodes(t,e){return this.nodeList(this.topology.getAdjacentElements(!0,t._indexes,e))}getAdjacentEdges(t,e){return this.edgeList(this.topology.getAdjacentElements(!1,t._indexes,e))}getDegree(t,e){return this.topology.getDegree(t._indexes,e)}degrees(t,e){return this.topology.degrees(t,e)}getAdjacencyList({directed:t=!1,internalIndexes:e=!1,weight:s=1,nodes:n,indexes:i}={}){return this.topology.getAdjacencyList({directed:t,weight:s,ids:!e,nodes:i||this.getNodes(n)._indexes})}getConnectedComponents(t,e){return this.topology.getConnectedComponents(t._indexes,e)}getConnectedComponentByNode(t,e){return this.topology.getConnectedComponents(t._indexes,e)}},Zx=512,Kx=128,W2=Math.round(Math.log2(Zx)),Qx=Math.round(Math.log2(Kx)),Kz=W2+Qx,ql=255,Qz=32767,X2=65535,Yc=16384,Ey=15,Yl=3,mf=15,Ug=32,Bo=128,Sy=8,Ay=1/16,wy=Math.round(Math.sqrt(mf+1)),Ty=Bo*wy,Hn=16,Wo=1,ir=256,Jz=128,tD=128,_f=1.5,Z2=1,hu=56,eD=16,sD=2*hu+eD,Gg=6,K2=3,Q2=3,mi=41,Kf=5,yf=5,J2=.9721,Jd=24,nD=1.4142,iD=/^rgba?\((\d+),?\s*(\d+),?\s*(\d+),?\s*((\d+)?\.?\d+)*\)$/;function Jx(t,e=[0,0,0,0]){const s=iD.exec(t);return s?(e[0]=parseInt(s[1])/255,e[1]=parseInt(s[2])/255,e[2]=parseInt(s[3])/255,e[3]=s[4]===void 0?1:parseFloat(s[4]),e):null}function Vg(t){return t<16?"0"+t.toString(16):t.toString(16)}function tC([t,e,s,n=1]){return`rgba(${256*t|0},${256*e|0},${256*s|0},${n})`}function t0(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((s,n,i,r)=>n+n+i+i+r+r));const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255,1]:null}var Jm=["AliceBlue","#F0F8FF","AntiqueWhite","#FAEBD7","Aqua","#00FFFF","Aquamarine","#7FFFD4","Azure","#F0FFFF","Beige","#F5F5DC","Bisque","#FFE4C4","Black","#000000","BlanchedAlmond","#FFEBCD","Blue","#0000FF","BlueViolet","#8A2BE2","Brown","#A52A2A","BurlyWood","#DEB887","CadetBlue","#5F9EA0","Chartreuse","#7FFF00","Chocolate","#D2691E","Coral","#FF7F50","CornflowerBlue","#6495ED","Cornsilk","#FFF8DC","Crimson","#DC143C","Cyan","#00FFFF","DarkBlue","#00008B","DarkCyan","#008B8B","DarkGoldenRod","#B8860B","DarkGray","#A9A9A9","DarkGrey","#A9A9A9","DarkGreen","#006400","DarkKhaki","#BDB76B","DarkMagenta","#8B008B","DarkOliveGreen","#556B2F","DarkOrange","#FF8C00","DarkOrchid","#9932CC","DarkRed","#8B0000","DarkSalmon","#E9967A","DarkSeaGreen","#8FBC8F","DarkSlateBlue","#483D8B","DarkSlateGray","#2F4F4F","DarkSlateGrey","#2F4F4F","DarkTurquoise","#00CED1","DarkViolet","#9400D3","DeepPink","#FF1493","DeepSkyBlue","#00BFFF","DimGray","#696969","DimGrey","#696969","DodgerBlue","#1E90FF","FireBrick","#B22222","FloralWhite","#FFFAF0","ForestGreen","#228B22","Fuchsia","#FF00FF","Gainsboro","#DCDCDC","GhostWhite","#F8F8FF","Gold","#FFD700","GoldenRod","#DAA520","Gray","#808080","Grey","#808080","Green","#008000","GreenYellow","#ADFF2F","HoneyDew","#F0FFF0","HotPink","#FF69B4","IndianRed","#CD5C5C","Indigo","#4B0082","Ivory","#FFFFF0","Khaki","#F0E68C","Lavender","#E6E6FA","LavenderBlush","#FFF0F5","LawnGreen","#7CFC00","LemonChiffon","#FFFACD","LightBlue","#ADD8E6","LightCoral","#F08080","LightCyan","#E0FFFF","LightGoldenRodYellow","#FAFAD2","LightGray","#D3D3D3","LightGrey","#D3D3D3","LightGreen","#90EE90","LightPink","#FFB6C1","LightSalmon","#FFA07A","LightSeaGreen","#20B2AA","LightSkyBlue","#87CEFA","LightSlateGray","#778899","LightSlateGrey","#778899","LightSteelBlue","#B0C4DE","LightYellow","#FFFFE0","Lime","#00FF00","LimeGreen","#32CD32","Linen","#FAF0E6","Magenta","#FF00FF","Maroon","#800000","MediumAquaMarine","#66CDAA","MediumBlue","#0000CD","MediumOrchid","#BA55D3","MediumPurple","#9370DB","MediumSeaGreen","#3CB371","MediumSlateBlue","#7B68EE","MediumSpringGreen","#00FA9A","MediumTurquoise","#48D1CC","MediumVioletRed","#C71585","MidnightBlue","#191970","MintCream","#F5FFFA","MistyRose","#FFE4E1","Moccasin","#FFE4B5","NavajoWhite","#FFDEAD","Navy","#000080","OldLace","#FDF5E6","Olive","#808000","OliveDrab","#6B8E23","Orange","#FFA500","OrangeRed","#FF4500","Orchid","#DA70D6","PaleGoldenRod","#EEE8AA","PaleGreen","#98FB98","PaleTurquoise","#AFEEEE","PaleVioletRed","#DB7093","PapayaWhip","#FFEFD5","PeachPuff","#FFDAB9","Peru","#CD853F","Pink","#FFC0CB","Plum","#DDA0DD","PowderBlue","#B0E0E6","Purple","#800080","RebeccaPurple","#663399","Red","#FF0000","RosyBrown","#BC8F8F","RoyalBlue","#4169E1","SaddleBrown","#8B4513","Salmon","#FA8072","SandyBrown","#F4A460","SeaGreen","#2E8B57","SeaShell","#FFF5EE","Sienna","#A0522D","Silver","#C0C0C0","SkyBlue","#87CEEB","SlateBlue","#6A5ACD","SlateGray","#708090","SlateGrey","#708090","Snow","#FFFAFA","SpringGreen","#00FF7F","SteelBlue","#4682B4","Tan","#D2B48C","Teal","#008080","Thistle","#D8BFD8","Tomato","#FF6347","Turquoise","#40E0D0","Violet","#EE82EE","Wheat","#F5DEB3","White","#FFFFFF","WhiteSmoke","#F5F5F5","Yellow","#FFFF00","YellowGreen","#9ACD32"],sd=[0,0,0,0],th=new Map;th.set(null,[0,0,0,0]),th.set("transparent",[0,0,0,0]);for(let t=0;t<Jm.length;t+=2){const e=Jm[t].toLowerCase(),s=Jm[t+1];th.set(e,t0(s))}var Wn=t=>{let e=th.get(t);if(e===void 0){const s=t+"",n=s.charAt(0)==="#"?t0(s):Jx(s);th.set(t,n),e=n}return e},Cy=t=>{const e=Wn(t);if(!e)return null;const[s,n,i]=e;return`#${Vg(255*s)}${Vg(255*n)}${Vg(255*i)}`},Dl=t=>{let e=1,s=t;return s&&Jx(t,sd)&&(s=`rgb(${255*+sd[0]},${255*+sd[1]},${255*+sd[2]})`,e=parseFloat(sd[3].toString())),{color:s,opacity:e}},wh=class{on(e,s){if(typeof e!="string")throw new TypeError("Event name must be string");if(typeof s!="function")throw new TypeError("Event handler must be function");const n=this._events=this._events||{};return(n[e]=n[e]||[]).push(s),this}off(e,s){if(typeof e!="string")throw new TypeError("Event name must be string");const n=this._events=this._events||{},i=n[e];if(Fn(i))if(typeof s!="function")n[e]=null;else{const r=i.indexOf(s);r!==-1&&i.splice(r,1),i.length===0&&(n[e]=null)}return this}fire(e,...s){if(typeof e!="string")throw new TypeError("Event name must be string");const n=(this._events=this._events||{})[e];if(Fn(n)){const i=s;for(let r=0;r<n.length;r++){const o=n[r];o&&o.apply(this,i)}}return this}once(e,s){const n=this,i=function(...r){s.apply(n,r),n.off(e,i)};return i.handler=s,this.on(e,i)}hasListener(e,s){if(!e||!s)return!1;const n=(this._events=this._events||{})[e];if(Fn(n))for(let i=0,r=n.length;i<r;i++){const o=n[i];if(o===s||o.handler===s)return!0}return!1}clearEvents(){this._events={}}getListeners(e){return(this._events=this._events||{})[e]}};function eC(t){if(t.keys)return Array.from(t.keys());const e=[];return t.forEach(((s,n)=>e.push(n))),e}function sC(t){if(t.values)return Array.from(t.values());const e=[];return t.forEach((s=>e.push(s))),e}var nC=class{constructor(){this._map=new Map}reset(){this._map.clear()}set(t,e,s){this._map.set(JE(t,e),s)}get(t,e){return this._map.get(JE(t,e))}},rD=class{constructor({elementSize:t,sideElementSize:e,nbSideElementsPerMainElement:s,id:n,depth:i,elementType:r,animated:o,stencilUsage:a}){this._nbCellsAllocated=0,this._nbCellsFreed=0,this._isFullyAllocated=!1,this._isFullyFreed=!1,this._mustUpdate=!0,this._capacity=Zx,this.version=0,this._id=n,this.depth=i,this.type=r,this.animated=o,this.stencilUsage=a,this.elementSize=t,this._nbSideElementsPerMainElement=s,this._totalSideElementsSize=s*e,this._byteCapacity=this._capacity*this.elementSize,this._byteArray=new Uint8Array(this._byteCapacity),this._dataView=new DataView(this._byteArray.buffer),this._sideByteCapacity=this._capacity*this._totalSideElementsSize,this._sideByteArray=new Uint8Array(this._sideByteCapacity),this._sideDataView=new DataView(this._sideByteArray.buffer)}update(){this._mustUpdate&&(this.version+=1,this._mustUpdate=!1,this._isFullyAllocated&&this._nbCellsFreed===this._nbCellsAllocated&&(this._isFullyFreed=!0))}allocate(t){let e=-1;return!this._isFullyAllocated&&this._nbCellsAllocated+t<=this._capacity?(e=this._nbCellsAllocated,this._nbCellsAllocated+=t,this._mustUpdate=!0):this._isFullyAllocated=!0,e}free(t,e){for(let s=0;s<e;s++){const n=(t+s)*this.elementSize;this._dataView.setUint16(n,0)}this._mustUpdate=!0,this._nbCellsFreed+=e}triggerUpdate(){this._mustUpdate=!0}isEmpty(){return this._nbCellsFreed===this._nbCellsAllocated}isFullyFreed(){return this._isFullyFreed}getId(){return this._id}getDataView(){return this._dataView}getByteArray(){return this._byteArray}getSize(){return this._nbCellsAllocated}getNbSideElementsPerMainElement(){return this._nbSideElementsPerMainElement}hasSideData(){return this._nbSideElementsPerMainElement>0}getSideDataView(){return this._sideDataView}getSideByteArray(){return this._sideByteArray}getTotalSideElementsSize(){return this._totalSideElementsSize}},eS=8,oD=class{constructor(){this.version=0,this.version=0,this._blockInfo={buffer:null,offset:0,size:0,address:0},this._init_()}reset(){this._init_()}_init_(){this._buffersByDepth=new Array(100),this._buffersById=[],this._buffersByAscendingDepth=[],this._buffersByDescendingDepth=[],this._mustUpdate=!0}_fillBlockInfo(t,e,s,n){return this._blockInfo.buffer=t,this._blockInfo.offset=e,this._blockInfo.size=s,this._blockInfo.address=n,this._blockInfo}_createBuffer(t,e,s,n,i){const r=e?sD:hu,o=this._buffersById.length,a=new rD({elementSize:r,sideElementSize:Gg,nbSideElementsPerMainElement:n,id:o,depth:s,elementType:t,animated:e,stencilUsage:i});return this._buffersById.push(a),a}getBlockInfo(t){return this._fillBlockInfo(this._buffersById[t>>Kz],(t>>Qx)%Zx,t%Kx,t)}allocateBlock(t,e,s,n,i,r,o){const a=lD(r,eS);this._mustUpdate=!0;let l=null,u=-1;if(t){const g=this.getBlockInfo(t),f=g.buffer,p=g.offset,y=g.size,_=g.size===i,x=f.depth===n,v=f.type===e,b=f.animated===s,S=f.getNbSideElementsPerMainElement()===a,A=f.stencilUsage===o;_&&x&&v&&b&&S&&A?(f.triggerUpdate(),l=f,u=p):f.free(p,y)}if(u===-1){const g=+s,f=a/eS,p=this._buffersByDepth[n]||Array(2);this._buffersByDepth[n]=p;const y=p[g]||[];p[g]=y;const _=y[e]||Array(16);y[e]=_;const x=_[f]||Array(4);_[f]=x;const v=x[o]||[];x[o]=v;const b=v[v.length-1];b&&(l=b,u=b.allocate(i)),u===-1&&(l=this._createBuffer(e,s,n,a,o),u=l.allocate(i),v.push(l))}const h=aD(l.getId(),u,i);return this._fillBlockInfo(l,u,i,h)}freeBlock(t){if(t){this._mustUpdate=!0;const e=this.getBlockInfo(t);e.buffer.free(e.offset,e.size)}return 0}_sortBuffersByDepth(){const t=[];for(let e=0;e<this._buffersByDepth.length;e++){const s=this._buffersByDepth[e];if(s)for(let n=0;n<s.length;n++){const i=s[n];if(i)for(let r=0;r<i.length;r++){const o=i[r];if(o)for(let a=0;a<o.length;a++){const l=o[a];if(l)for(let u=0;u<l.length;u++){const h=l[u];if(h)for(let g=0;g<h.length;g++){const f=h[g];f.update(),f.isFullyFreed()?(this._buffersById[f.getId()]=void 0,h.splice(g,1),g-=1):t.push(f)}}}}}}this._buffersByAscendingDepth=t,this._buffersByDescendingDepth=t.slice().reverse()}update(){this._mustUpdate&&(this._sortBuffersByDepth(),this.version+=1,this._mustUpdate=!1)}getBuffers(){return this._buffersById}getBuffersByAscendingDepth(){return this._buffersByAscendingDepth}getBuffersByDescendingDepth(){return this._buffersByDescendingDepth}};function aD(t,e,s){return((t<<W2)+e<<Qx)+s}function lD(t,e){let s=0;for(;s<t;)s+=e;return s}var lr=1,Pa=2,xf=3,Xn=1,qo=2,Na=3,Th=4,za=5,Da=6,Xo=7,Yi=1,Qf=2,e0=3,s0=4,Aa=5,Ma=6,eu=1,iC=2,rC=3;function sS(){return{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:Xn,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,isBadge:!1,bentEnable:!1,bentVertical:!1}}function nS(t={}){return t.pieceId=0,t.shape="",t.x1=0,t.y1=0,t.x2=0,t.y2=0,t.rectWidthOrSourceRadiusScaled=0,t.rectWidthOrSourceRadiusFixed=0,t.rectHeightOrTargetRadiusScaled=0,t.rectHeightOrTargetRadiusFixed=0,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern=t.pattern||{type:Xn,attributes:{}},t.pattern.type=Xn,t.opacity=1,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=0,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isBodyTriangle=!1,t.isSelfLoop=!1,t.isText=!1,t.adjustTextAngle=!1,t.isBadge=!1,t.bentEnable=!1,t.bentVertical=!1,t}function uD(t={}){return t.duration=0,t.beginTime=-1,t.easing="linear",t}function n0(){return{valid:!1,id:void 0,end:sS(),start:sS(),animation:{duration:0,beginTime:-1,easing:"linear"}}}function oC(t,e,s,n){t.width=e*n,t.height=s*n,ja(t,`${e}px`,`${s}px`)}function dD(t){return 1/(1+Math.exp(-t))}var hD=class{constructor(){this._capacity=Kx,this._id=0,this.size=0,this.depth=0,this.animated=!1,this.stencilUsage=eu,this.type=lr,this._list=Array(this._capacity);for(let t=0;t<this._capacity;++t)this._list[t]=n0()}reset(t,e,s,n){return this.type=t,this.animated=e,this.depth=s,n!==void 0&&(this._id=n),this.stencilUsage=eu,this.size=0,this}next(){if(this.size>=this._capacity)throw new Error("internal error: block.next() was called on a full block");return this._list[this.size++]}nextAndReset(){const t=this.next();return t.end=nS(t.end),t.start=nS(t.start),t.animation=uD(t.animation),t}forEach(t){this._list.forEach(t)}getElement(t){return this._list[t]}getCurrentElement(){return this._list[this.size-1]}getElements(){return this._list}getId(){return this._id}setGlobalAnimation(t,e,s){for(let n=0;n<this.size;++n){const i=this._list[n].animation;i.duration=t,i.beginTime=e,i.easing=s}}},cD=class{constructor(){this._version=0,this._initialize()}reset(){this._initialize()}_initialize(){this._mustUpdate=!0,this.maxCoord=0,this.maxScaledSize=0,this.maxMinVisibleSize=0,this.maxSymbolicSize=0,this.maxDashLength=0,this.maxGapLength=0,this.maxPatternScale=0}set({maxCoord:t,maxScaledSize:e,maxMinVisibleSize:s,maxSymbolicSize:n,maxDashLength:i,maxGapLength:r,maxPatternScale:o}){const a=this.maxCoord<t||this.maxScaledSize<e||this.maxMinVisibleSize<s||this.maxSymbolicSize<n||this.maxDashLength<i||this.maxGapLength<r||this.maxPatternScale<o;return a&&(this.maxCoord=t,this.maxScaledSize=e,this.maxMinVisibleSize=s,this.maxSymbolicSize=n,this.maxDashLength=i,this.maxGapLength=r,this.maxPatternScale=o,this._mustUpdate=!0),a}update(){return this._mustUpdate&&(this._version+=1,this._mustUpdate=!1),this}getVersion(){return this._version}},gD={linear:[0,1,0,0],quadraticIn:[0,0,1,0],quadraticOut:[0,2,-1,0],quadraticInOut:[0,0,2,0,-1,4,-2,0],cubicIn:[0,0,0,1],cubicOut:[0,3,-3,1],cubicInOut:[0,0,0,4,-3,12,-12,4]},fD=class{constructor(){this._linearEasing=[0,1,0,0,0,1,0,0],this._nameToPolygon={},this._polygonToName={},this.add(gD)}add(t){Object.keys(t).forEach((e=>{const s=t[e].slice();s.length<8&&(s[4]=s[0],s[5]=s[1],s[6]=s[2],s[7]=s[3]);const n=Q_(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]);this._nameToPolygon[e]=s,this._polygonToName[n]=e}))}getCoefficients(t){return this._nameToPolygon[t]||this._linearEasing}getName(t,e,s,n,i,r,o,a){const l=Q_(t,e,s,n,i,r,o,a);return this._polygonToName[l]||"linear"}},i0=new fD;function Jf(t){return typeof t=="number"&&isFinite(t)}var pD=t=>{if(t===0)return 0;if(isNaN(t))return 32256;if(!isFinite(t))return t>0?31744:64512;const e=t<0?32768:0;if((t=Math.abs(t))<6103515625e-14)return e|Math.round(4096*t);if(t>65504)return 31744|e;let s=Math.floor(Math.log2(t)),n=Math.round(1024*(t/Math.pow(2,s)-1));return n===1024&&(n=0,s++),e|s+15<<10|n},iS=t=>{const e=32768&t?-1:1,s=t>>10&31,n=1023&t;return s===0?n===0?0*e:e*Math.pow(2,-14)*(n/1024):s===31?n?NaN:e*(1/0):e*Math.pow(2,s-15)*(1+n/1024)},mD=0,_D=1,yD=2,xD=3,vD=4,bD=5,ED=6,SD=7,AD=8,wD=9,tp=10,TD=0,aC=1,lC=2,r0=30,uC=0,CD=1,LD=2,o0=3,kD=4,ND=5,a0=6,ep=1e-6,Hi=Math.PI,Pd=2*Math.PI,dC=Hi*(5/4),hC=Hi*(7/4),cC=Hi*(3/4),gC=Hi*(1/4),rS=1.1,oS=.07,MD=1,aS=1,lS=.17,ID=1,RD=-Hi/2,FD=Hi/2,PD={plain:{dash:0,gap:0},dashed:{dash:3,gap:1},dotted:{dash:1,gap:3}},zD={right:0,top:-Math.PI/2,left:Math.PI,bottom:Math.PI/2,center:0},DD={right:Math.PI,top:-Math.PI/2,left:0,bottom:Math.PI/2,center:0},Ll=8,OD=class{constructor(t,e,s,n,i){this._littleEndian=Of(),this._maxScaledSize=0,this._maxMinVisibleSize=0,this._maxSymbolicSize=0,this._maxDashLength=0,this._maxGapLength=0,this._maxPatternScale=0,this._actualScaledSizeToBytes=Qz,this._actualMinVisibleSizeToBytes=Ey,this._actualSymbolicSizeToBytes=ql,this._actualDashLengthToBytes=Yl,this._actualGapLengthToBytes=Yl,this._actualPatternScaleToBytes=ql,this._genericObject=n0(),this._shapeManager=e,this._patternManager=t,this._textManager=s,this._bufferOffsetToId=n,this._colorParser=i}resizeBoundaries(t,e,s,n,i,r){this._maxScaledSize=t,this._maxMinVisibleSize=e,this._maxSymbolicSize=s,this._maxDashLength=n,this._maxGapLength=i,this._maxPatternScale=r,this._actualScaledSizeToBytes=X2/t,this._actualMinVisibleSizeToBytes=Ey/e,this._actualSymbolicSizeToBytes=ql/s,this._actualDashLengthToBytes=Yl/n,this._actualGapLengthToBytes=Yl/i,this._actualPatternScaleToBytes=ql/r}storeGenericObject(t,e,s){const n=this._shapeManager.getIdFromName(s.shape),i=s.pieceId,r=this._dashLengthToBytes(s.dashLength),o=this._gapLengthToBytes(s.gapLength),a=+s.hasHead,l=+s.hasTail,u=+s.isBodyTriangle,h=+s.isSelfLoop,g=this._patternScaleToBytes(s.patternScale),f=this._offsetAngleToBytes(s.offsetAngle),p=+s.isText,y=+s.adjustTextAngle,_=+s.isBadge,x=+s.bentEnable,v=+s.bentVertical,b=this._opacityToBytes(s.opacity),S=this._minVisibleSizeToBytes(s.globalMinVisibleSize),A=this._minVisibleSizeToBytes(s.strokeMinVisibleSize),w=this._minVisibleSizeToBytes(s.patternMinVisibleSize),L=this._symbolicSizeToBytes(s.symbolicSize),I=this._curvatureToBytes(s.curvature),F=s.pattern.attributes.colors;F&&(s.pattern.attributes.colors=F.split(";").map((ve=>Wc(this._colorToBytes(ve.trim())))).join(";"));const O=this._patternManager.getIdFromDefinition(s.pattern),V=this._colorToBytes(s.fillColor),j=this._colorToBytes(s.strokeColor),Z=this._colorToBytes(s.patternColor),{x1:at,y1:pt,x2:K,y2:ut}=s,ht=this._fixedSizeToBytes(s.rectWidthOrSourceRadiusFixed),nt=this._fixedSizeToBytes(s.rectHeightOrTargetRadiusFixed),ot=this._scaledSizeToBytes(s.thicknessOrFontSizeScaled),Nt=this._fixedSizeToBytes(s.thicknessOrFontSizeFixed),Q=this._scaledSizeToBytes(s.strokeWidthScaled),Et=this._fixedSizeToBytes(s.strokeWidthFixed),Xt=this._scaledSizeToBytes(s.offsetScaled),Ht=this._fixedSizeToBytes(s.offsetFixed),Zt=this._fixedSizeToBytes(s.pattern.attributes.paddingTop||0),ae=this._fixedSizeToBytes(s.pattern.attributes.paddingLeft||0),pe=n+(i<<4)+(r<<8)+(o<<10)+(a<<12)+(l<<13)+(u<<14)+(h<<15),ne=g+(f<<8)+(p<<11)+(y<<12)+(_<<13)+(x<<14)+(v<<15),te=b+(S<<4)+(A<<8)+(w<<12),se=L+(I<<8),ce=s.rectWidthOrSourceRadiusScaled/this._maxScaledSize*Yc,Ce=s.rectHeightOrTargetRadiusScaled/this._maxScaledSize*Yc;this._setUint16(t,e+0,pe),this._setUint16(t,e+2,ne),this._setUint16(t,e+4,te),this._setUint16(t,e+6,se),this._setUint16(t,e+8,O),this._setUint16(t,e+10,V),this._setUint16(t,e+12,j),this._setUint16(t,e+14,Z),this._setFloat32(t,e+16,at),this._setFloat32(t,e+20,pt),this._setFloat32(t,e+24,K),this._setFloat32(t,e+28,ut),this._setFloat16(t,e+32,ce),this._setUint16(t,e+34,ht),this._setFloat16(t,e+36,Ce),this._setUint16(t,e+38,nt),this._setUint16(t,e+40,ot),this._setUint16(t,e+42,Nt),this._setUint16(t,e+44,Q),this._setUint16(t,e+46,Et),this._setUint16(t,e+48,Xt),this._setInt16(t,e+50,Ht),this._setInt16(t,e+52,Zt),this._setInt16(t,e+54,ae)}_setUint16(t,e,s){t.setUint16(e,s,this._littleEndian)}_setFloat16(t,e,s){t.setUint16(e,pD(s),this._littleEndian)}_setInt16(t,e,s){t.setUint16(e,this._signedToUnsignedInt16(s),this._littleEndian)}_setFloat32(t,e,s){t.setFloat32(e,s,this._littleEndian)}_colorToBytes(t){const e=this._colorParser(t);return Math.round(15*e[0])+(Math.round(15*e[1])<<4)+(Math.round(15*e[2])<<8)+(Math.round(15*e[3])<<12)}_scaledSizeToBytes(t){return Math.ceil(Math.min(t,this._maxScaledSize)*this._actualScaledSizeToBytes)}_fixedSizeToBytes(t){return t}_minVisibleSizeToBytes(t){return Math.round(Math.min(t,this._maxMinVisibleSize)*this._actualMinVisibleSizeToBytes)}_symbolicSizeToBytes(t){return Math.round(Math.min(t,this._maxSymbolicSize)*this._actualSymbolicSizeToBytes)}_dashLengthToBytes(t){return Math.round(Math.min(t,this._maxDashLength)*this._actualDashLengthToBytes)}_gapLengthToBytes(t){return Math.round(Math.min(t,this._maxGapLength)*this._actualGapLengthToBytes)}_patternScaleToBytes(t){return Math.round(Math.min(t,this._maxPatternScale)*this._actualPatternScaleToBytes)}_offsetAngleToBytes(t){return Math.round((t+Pd)%Pd*(8/Pd))}_opacityToBytes(t){return Math.round(15*Math.min(t,1))}_curvatureToBytes(t){return this._signedToUnsignedByte(t)}_signedToUnsignedByte(t){return qi(t,-128,127)+128}_signedToUnsignedInt16(t){return qi(t,-32768,32767)+32768}storeAnimationInformation(t,e,{beginTime:s,duration:n},i){this._setAnimationBeginTime(t,e,s),this._setAnimationDuration(t,e,n),this._setAnimationEasing(t,e,i)}_setAnimationBeginTime(t,e,s){this._setFloat32(t,e,s)}_setAnimationDuration(t,e,s){this._setFloat32(t,e+4,s)}_setAnimationEasing(t,e,s){this._setUint16(t,e+8,(s[0]+128<<8)+(s[4]+128)),this._setUint16(t,e+10,(s[1]+128<<8)+(s[5]+128)),this._setUint16(t,e+12,(s[2]+128<<8)+(s[6]+128)),this._setUint16(t,e+14,(s[3]+128<<8)+(s[7]+128))}extractGenericElement(t,e,s){const n=t.type,i=t.animated,r=t.getDataView(),o=e*t.elementSize,a=this._genericObject;if(a.valid=!1,r.getUint16(o)&&(a.valid=!0,this._extractGenericObject(a.end,r,o,s),i&&(this._extractGenericObject(a.start,r,o+hu,s),this._extractAnimationInformation(a.animation,r,o+2*hu)),a.id=this._bufferOffsetToId.get(t.getId(),e),n===Pa)){const l=t.getSideDataView(),u=e*t.getTotalSideElementsSize(),h=u+t.getTotalSideElementsSize();a.end.pattern=this._textManager.extractTextFromDataView(l,u,h)}return a}_extractGenericObject(t,e,s,{bytesToActualCoord:n,bytesToActualScaledSize:i,bytesToActualMinVisibleSize:r,bytesToActualPatternScale:o,bytesToActualSymbolicSize:a,bytesToActualDashLength:l,bytesToActualGapLength:u}){const h=e,g=s,f=this._littleEndian,p=h.getUint16(g,f),y=Us(p,0,4),_=Us(p,4,8),x=Us(p,8,10),v=Us(p,10,12),b=Us(p,12,13),S=Us(p,13,14),A=Us(p,14,15),w=Us(p,15,16),L=h.getUint16(g+2,f),I=Us(L,0,8),F=Us(L,8,11),O=Us(L,11,12),V=Us(L,12,13),j=Us(L,13,14),Z=Us(L,14,15),at=Us(L,15,16),pt=h.getUint16(g+4,f),K=Us(pt,0,4),ut=Us(pt,4,8),ht=Us(pt,8,12),nt=Us(pt,12,16),ot=h.getUint16(g+6,f),Nt=Us(ot,0,8),Q=Us(ot,8,16),Et=h.getUint16(g+8,f),Xt=h.getUint16(g+10,f),Ht=h.getUint16(g+12,f),Zt=h.getUint16(g+14,f),ae=h.getFloat32(g+16,f),pe=h.getFloat32(g+20,f),ne=h.getFloat32(g+24,f),te=h.getFloat32(g+28,f),se=h.getUint16(g+32,f),ce=h.getUint16(g+34,f),Ce=h.getUint16(g+36,f),ve=h.getUint16(g+38,f),Ne=h.getUint16(g+40,f),ge=h.getUint16(g+42,f),ze=h.getUint16(g+44,f),is=h.getUint16(g+46,f),Ge=h.getUint16(g+48,f),De=t_(h.getUint16(g+50,f)),He=t_(h.getUint16(g+52,f)),Je=t_(h.getUint16(g+54,f));t.pieceId=_,t.shape=this._shapeManager.getNameFromId(y),t.x1=br(ae,n),t.y1=br(pe,n),t.x2=br(ne,n),t.y2=br(te,n),t.rectWidthOrSourceRadiusScaled=iS(se)*this._maxScaledSize/Yc,t.rectWidthOrSourceRadiusFixed=ce,t.rectHeightOrTargetRadiusScaled=iS(Ce)*this._maxScaledSize/Yc,t.rectHeightOrTargetRadiusFixed=ve,t.thicknessOrFontSizeScaled=br(Ne,i),t.thicknessOrFontSizeFixed=ge,t.strokeWidthScaled=br(ze,i),t.strokeWidthFixed=is,t.offsetScaled=br(Ge,i),t.offsetFixed=De,t.pattern=this._patternManager.getDefinitionFromId(Et),t.pattern.attributes.paddingTop=He,t.pattern.attributes.paddingLeft=Je,t.opacity=K/15,t.fillColor=Wc(Xt),t.strokeColor=Wc(Ht),t.patternColor=Wc(Zt),t.globalMinVisibleSize=br(ut,r),t.strokeMinVisibleSize=br(ht,r),t.patternMinVisibleSize=br(nt,r),t.offsetAngle=F*(2*Math.PI/8),t.patternScale=I*o,t.symbolicSize=Nt*a,t.curvature=BD(Q),t.dashLength=x*l,t.gapLength=v*u,t.hasHead=!!b,t.hasTail=!!S,t.isBodyTriangle=!!A,t.isSelfLoop=!!w,t.isText=!!O,t.adjustTextAngle=!!V,t.isBadge=!!j,t.bentEnable=!!Z,t.bentVertical=!!at}_extractAnimationInformation(t,e,s){const n=this._littleEndian,i=e.getFloat32(s,n),r=e.getFloat32(s+4,n),o=e.getUint16(s+8,n),a=e.getUint16(s+10,n),l=e.getUint16(s+12,n),u=e.getUint16(s+14,n),h=(o>>8)-128,g=(a>>8)-128,f=(l>>8)-128,p=(u>>8)-128,y=o%256-128,_=a%256-128,x=l%256-128,v=u%256-128;t.beginTime=i,t.duration=r,t.easing=i0.getName(h,g,f,p,y,_,x,v)}};function Us(t,e,s){return t%(1<<s)>>e}function BD(t){return t-128}function t_(t){return t-32768}function br(t,e){return t*e}var uS=new Array(65535);function Wc(t){let e=uS[t];if(!e){const s=Us(t,0,4)/15,n=Us(t,4,8)/15,i=Us(t,8,12)/15,r=Us(t,12,16)/15;e=`rgba(${255*s|0}, ${255*n|0}, ${255*i|0}, ${r})`,s+n+i+r===0&&(e=null),uS[t]=e}return e}var UD={[qo]:"image",[Th]:"piechart",[Na]:"text",[za]:"icon",[Da]:"badge"},GD=class{constructor(){this._pixelRatio=1,this._nextPatternId=1,this._version=0,this._init_()}reset(){this._init_()}_init_(){this._mustUpdate=!0,this._nextPatternId=1,this._patterns=[null],this._patternsByHash={},this._pixelRatio=1,this._nullPattern={id:-1,type:Xn,attributes:{}}}_increaseNextId(){let t=this._nextPatternId++;for(t%256==255&&(t=this._nextPatternId++);this._patterns.length<=t;)this._patterns.push(void 0);return t}_createPattern({type:t,attributes:e}){const s={id:this._increaseNextId(),type:t,attributes:this._getAttributes(t,e)};return this._patterns[s.id]=s,this._mustUpdate=!0,s}_getAttributes(t,e){return t===qo?{image:e.image,scaled:e.scaled,duplicated:e.duplicated}:t===Na||t===za||t===Da?{font:e.font,size:e.size,style:e.style,text:e.text,paddingLeft:e.paddingLeft,paddingTop:e.paddingTop,align:e.align||"center",offset:e.offset||0}:t===Th&&e.colors?{colors:e.colors,colorArray:e.colors.split(";").map((s=>s.trim()))}:{}}getPatternList(){return this._patterns.filter((t=>t))}update(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)}setPixelRatio(t){t!==this._pixelRatio&&(this._pixelRatio=t,this._mustUpdate=!0)}getPixelRatio(){return this._pixelRatio}notifyUpdate(){this._mustUpdate=!0}getIdFromDefinition(t){const{type:e,attributes:s}=t,n=e===Na||e===za||e===Da;let i=0;return e&&e!==Xn&&e!==Xo&&(e!==qo||s.image)&&(!n||s.text&&s.font)&&(i=this._addPattern(t),e===Na&&s.style==="normal"&&(s.style="bold",this._addPattern(t))),i}_addPattern(t){const e=this._getPatternHash(t);let s=this._patternsByHash[e];return s||(this._nextPatternId>65500?$o("maximum number of pattern exceeded"):(s=this._createPattern(t).id,this._patternsByHash[e]=s)),s}_getPatternHash({type:t,attributes:e}){const s=[UD[t]];return t===qo?s.push(e.scaled?"scaled":"non-scaled",e.duplicated?"duplicated":"non-duplicated",e.image.src||e.image.toDataURL()):t===Na?s.push(e.text,e.font,e.style,e.size,e.align||"center",e.offset||0):t===za||t===Da?s.push(e.text,e.font,e.style,e.size,e.paddingLeft,e.paddingTop):s.push(e.colors),s.join("+")}getDefinitionFromId(t){if(t&&this._patterns[t]){const e=this._patterns[t];if(e)return e}return this._nullPattern}getVersion(){return this._version}};function dS(t){return t.map((({x:e,y:s,r:n=0})=>({x:e,y:s,r:n})))}var VD=class{constructor(){this._version=0,this._mustUpdate=!0,this._byName={},this._byId=new Array(mf+1)}register(t,{getDistanceFromStrokeVertically:e,getDistanceFromStrokeHorizontally:s,points:n,hole:i,isSimple:r}){if(this._byName[t])return;let o=r?1:Sy;const a=r?Sy-1:mf;for(;this._byId[o];)o+=1;if(o>a)throw new Error("max number of shape exceeded");const l={id:o,name:t,getDistanceFromStrokeVertically:e,getDistanceFromStrokeHorizontally:s,points:dS(n.slice()),hole:i?dS(i.slice()):null,isSimple:!!r};return this._mustUpdate=!0,this._byId[o]=l,this._byName[t]=l,l}updateShape(t,e){const s=this._byName[t];s&&(delete this._byId[s.id],delete this._byName[t],this.register(t,e))}getIdFromName(t){return this._byName[t].id}getNameFromId(t){const e=this._byId[t];return e?e.name:""}getDefinitionFromName(t){return this._byName[t]}update(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)}getVersion(){return this._version}getShapeList(){return this._byId.filter((t=>t))}},Ly=300,ky=150,fC=class{constructor(){this.style={},this.width=Ly,this.height=ky,this.__context=new pC,this.style={},this.width=Ly,this.height=ky}get __dummy(){return!0}get parentNode(){return null}getContext(t){return t==="2d"?this.__context:null}toDataURL(t="png"){return`data:image/${t};base64,`}addEventListener(){}removeEventListener(){}getBoundingClientRect(){return{left:0,top:0,bottom:0,right:0,width:this.width,height:this.height}}},pC=class{constructor(){this._fontSize=10}set font(t){const e=t.match(/\d+/);e&&(this._fontSize=parseFloat(e[0]))}set fillStyle(t){}set textBaseline(t){}set textAlign(t){}set strokeStyle(t){}set lineWidth(t){}fill(){}stroke(){}clearRect(){}fillRect(){}strokeRect(){}beginPath(){}closePath(){}moveTo(){}lineTo(){}rect(){}arc(){}save(){}restore(){}clip(){}translate(){}rotate(){}fillText(){}setLineDash(){}quadraticCurveTo(){}bezierCurveTo(){}drawImage(){}measureText(t){return{width:t.length*Math.ceil(.625*this._fontSize)}}getImageData(){return{width:0,height:0,data:new Uint8ClampedArray(0)}}},Xc=$i("canvas")||$i("canvas-prebuilt");function Pn(t=Ly,e=ky){if(oo){const n=document.createElement("canvas");return n.width=t,n.height=e,n}if(Xc){let n=null;return n="createCanvas"in Xc?Xc.createCanvas(t,e):new Xc(t,e),n.style={},n}const s=new fC;return s.width=t,s.height=e,s}function Ny(t,e,s=t.width,n=t.height){e.clearRect(0,0,s,n)}function Zo(t,e,s,n=""){t.font=`${n} ${s}px ${e}`}function mC(){return l0(Pn(),{},"webgl")!==null}var _C=t=>{const{canvas:e,width:s,height:n}={canvas:document.createElement("canvas"),width:window.innerWidth*devicePixelRatio,height:window.innerHeight*devicePixelRatio,...t};e.width=Math.ceil(s),e.height=Math.ceil(n),e.style.width=Math.ceil(s/devicePixelRatio)+"px",e.style.height=Math.ceil(n/devicePixelRatio)+"px";const i=e.getContext("webgl2",{antialias:!0});if(!i)throw new Error("WebGL 2.0 not supported");return i},yC=(t,e,s)=>{const n=_C();return n.canvas.addEventListener("webglcontextlost",s),{context:n,cleanUp:()=>{var i;n.canvas.removeEventListener("webglcontextlost",s),(i=n.getExtension("WEBGL_lose_context"))==null||i.loseContext()}}};function l0(t,e,s){let n=t.getContext(s,e);return n||(n=t.getContext("experimental-webgl",e)),n||null}function u0(t,e){if(e<2)return t;const s=t.split(`
`),n=[];for(let i=0;i<s.length;++i){const r=s[i];if(r.length<e)n.push(r);else{const o=xC(s[i],e);for(let a=0;a<o.length;++a)n.push(o[a])}}return n.join(`
`)}function xC(t,e){const s=[""],n=t.split(" ");for(let i=0;i<n.length;i++){const r=s[s.length-1],o=n[i];r.length+1+o.length<=e&&r.length?s[s.length-1]+=(r.length>0?" ":"")+o:s.push(o)}return s}function vC(t,e){if(t===null)return null;const s=(t=t.toString()).split(`
`),n=[];let i=0;for(let r=0;r<s.length;r++){let o=s[r];if(!e||e<=1||o.length<e)n.push(o),i=Math.max(i,o.length);else{const a=xC(s[r],e);for(let l=0;l<a.length;l++)o=a[l],n.push(o),i=Math.max(i,o.length)}}return{data:n,maxLength:i,lines:n.length}}function bC(){const t=$i("@mapbox/mapbox-gl-rtl-text")||$i("mapbox-gl-rtl-text"),e=t?t.processBidirectionalText:Yo?window.processBidirectionalText:null,s=t?t.applyArabicShaping:Yo?window.applyArabicShaping:null;return{processBidirectionalText:e?n=>{if(n===null||n==null)return"";const i=[];let r=0,o="";const a=n.split(`
`);for(let l=0;l<a.length;l++){const u=a[l],h=a[l].length+r;h>0&&l<a.length-1&&i.push(h),o+=l>0?""+u:u,r+=u.length}return e(o,i).join(`
`)}:n=>n,applyArabicShaping:s?n=>n==null?null:typeof n=="number"?n.toString():s(n):n=>n==null?null:n.toString()}}var e_=Of(),Zc=10,jD=1<<17,HD=65536,$D=256,hS=128,qD=25,EC=1e3,My=2,SC=["100","200","300","400","500","600","700","800","900","none","bold","italic","normal","italic bold","bold italic","100 italic","200 italic","300 italic","400 italic","500 italic","600 italic","700 italic","800 italic","900 italic"],cS=()=>{const t={};for(const e of SC)t[e]={};return t},YD=class{constructor(t){this._widthAtlases=cS(),this._patternManager=t,this._canvas=Pn(),this._ctx=this._canvas.getContext("2d",{willReadFrequently:!0}),this._processBidirectionalText=bC().processBidirectionalText,this._cornerRadius=0,this._version=0,this._textPattern={id:0,type:Xo,attributes:{text:"",font:"",size:0,style:"normal",align:"center"},dimensions:{width:0,height:0}},this._textDimensions={width:0,height:0},this._lineWidthList=new Array(64),this._init()}_init(){this._mustClear=!1,this._clear()}reset(){this._init()}clear(){this._mustClear=!0}_measureChar(t,e,s){return Zo(this._ctx,e,Jd,s),this._ctx.measureText(t).width/Jd}_getAtlas(t,e,s,n){const i=s===Ah?0:s,r=this._byFont[t]||(this._byFont[t]=SC.reduce(((l,u)=>(l[u]=void 0,l)),{})),o=r[n]||(r[n]={}),a=o[e]||(o[e]=new Array(50));return a[i]||(a[i]=new Array(256))}_getMeasurementAtlas(t,e){const s=this._widthAtlases[e];return s[t]||(s[t]=new Array(256))}measureText(t,e,s,n=1){if(!e||t===null)return this._textDimensions.width=0,this._textDimensions.height=0,this._textDimensions;const i=this._getMeasurementAtlas(e,s);let r=0,o=0,a=1;for(let l=0;l<t.length;++l){const u=t.charCodeAt(l);if(u===Zc)o>r&&(r=o),o=0,a+=1;else{let h=i[u];h===void 0&&(h=this._measureChar(t[l],e,s),i[u]=h),o+=h}}return o>r&&(r=o),this._textDimensions.width=r*n,this._textDimensions.height=a*n,this._textDimensions}_getCharInfo(t,e,s,n,i,r){let o=t[e];if(!o){const a=String.fromCharCode(e);o={ratio:this._measureChar(a,s,n),patternId:0},o.patternId=this._patternManager.getIdFromDefinition({id:0,type:Na,attributes:{text:a,font:s,style:n,size:i,align:r}}),t[e]=o}return o}storeTextInDataView(t,e,s,n){let i=e;if(n&&n.type===Xo){const{font:r,style:o,size:a,align:l}=n.attributes,u=l==="center",h=this._getAtlas(r,o,a,l);let g=0,f=1,p=0,y=0;const _=this._lineWidthList,x=this._processBidirectionalText(n.attributes.text);for(let A=0;A<x.length;++A){const w=x.charCodeAt(A);w===Zc?(p>g&&(g=p),_[y]=p,y++,p=0,f++):p+=this._getCharInfo(h,w,r,o,a,l).ratio}_[y]=p,p>g&&(g=p),y=0;let v=-(u?_[y]:g)/2,b=(1-f)/2,S=0;for(let A=0;A<x.length;++A){const w=x.charCodeAt(A),L=h[w];if(w===Zc)y+=1,v=-(u?_[y]:g)/2,b+=A===0?.5:1,S=0;else{const I=L.ratio,F=L.patternId;v+=(I+S)/2,S=I;const O=(qi(v*EC+HD,0,jD-1)<<8)+qi(b*My+hS,0,$D-1);t.setUint16(i,F,e_),t.setUint32(i+2,O,e_),i+=Gg}}}this._fillWithZeros(t,i,s)}extractTextFromDataView(t,e,s){const n=t,i=e_,r=n.getUint16(e,i),o=this._textPattern,a=this._patternManager.getDefinitionFromId(r),{font:l,style:u,size:h,align:g}=a.attributes,f=this._getAtlas(l,u,h,g),p=[];let y=0,_=0,x=0,v=null;for(let S=e;S<s;S+=Gg){const A=n.getUint16(S,i);if(!A)break;const w=(n.getUint8(S+2)-hS)/My,L=this._patternManager.getDefinitionFromId(A);if(!L||!L.attributes||!L.attributes.text)break;const I=L.attributes.text.charCodeAt(0),F=f[I];v===null?v=w:w>v&&(y>_&&(_=y),y=0,x+=1,p.push(Zc),v=w),p.push(I),F&&(y+=F.ratio)}y>_&&(_=y);const b=String.fromCharCode.apply(null,p);return o.attributes.style=u,o.attributes.font=l,o.attributes.size=h,o.attributes.align=g,o.attributes.text=this._processBidirectionalText(b),o.dimensions&&(o.dimensions.width=_,o.dimensions.height=x),o}_fillWithZeros(t,e,s){for(let n=e;n<s;n+=Gg)t.setUint16(n,0)}_clear(){this._byFont={},this._widthAtlases=cS()}update(){this._mustClear&&(this._clear(),this._mustClear=!1)}getVersion(){return this._version}getCornerRadius(){return this._cornerRadius}setCornerRadius(t){t!==this._cornerRadius&&(this._cornerRadius=t,this._version++)}},d0=()=>({minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),ri=class Ol{constructor(e={}){const{xValues:s=[],yValues:n=[],scaledSizeValues:i=[],fixedSizeValues:r=[]}=e;this.minX=Kr(s),this.minY=Kr(n),this.maxX=Hl(s),this.maxY=Hl(n),this.minScaledSize=Kr(i),this.maxScaledSize=Hl(i),this.minFixedSize=Kr(r),this.maxFixedSize=Hl(r),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY}reset(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.minScaledSize=1/0,this.maxScaledSize=-1/0,this.minFixedSize=1/0,this.maxFixedSize=-1/0,this.width=0,this.height=0,this.cx=0,this.cy=0,this}addPoint(e,s,n,i){if(!isFinite(e)||!isFinite(s))return this;this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,s),n!==void 0&&i!==void 0&&(i==="scaled"?(this.minScaledSize=Math.min(this.minScaledSize,n),this.maxScaledSize=Math.max(this.maxScaledSize,n)):(this.minFixedSize=Math.min(this.minFixedSize,n),this.maxFixedSize=Math.max(this.maxFixedSize,n)));const r=this.maxX-this.minX,o=this.maxY-this.minY;return this.cx=this.minX+r/2,this.cy=this.minY+o/2,this.width=r,this.height=o,this}computeForZoom(e){const s=Math.max(this.maxScaledSize,this.maxFixedSize/e);return Ol.from({minX:this.minX-s/2,minY:this.minY-s/2,maxX:this.maxX+s/2,maxY:this.maxY+s/2,width:this.width+s,height:this.height+s})}static from({minX:e,minY:s,maxX:n,maxY:i,width:r,height:o}={}){const a=new Ol;return e!=null&&(a.minX=e),s!=null&&(a.minY=s),n!=null&&(a.maxX=n),i!=null&&(a.maxY=i),n!=null&&e!=null&&(a.width=r||Math.abs(n-e),a.cx=(e+n)/2),i!=null&&s!=null&&(a.height=o||Math.abs(i-s),a.cy=(s+i)/2),a.maxScaledSize=a.minScaledSize=0,a}static fromValues(e,s,n){let i=1/0,r=1/0,o=-1/0,a=-1/0,l=-1/0;for(let h=0;h<e.length;h++){const g=e[h],f=s[h],p=n[h];g-p<i&&(i=g-p),f-p<r&&(r=f-p),g+p>o&&(o=g+p),f+p>a&&(a=f+p),p>l&&(l=p)}const u=Ol.from({minX:i,minY:r,maxX:o,maxY:a});return u.maxScaledSize=l,u}pad(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,this.width+=2*e,this.height+=2*e,this}isValid(){return isFinite(this.width)&&isFinite(this.height)}extend(e){let s,n,i,r;return e instanceof Ol?(s=e.minX,n=e.minY,i=e.maxX,r=e.maxY):Array.isArray(e)&&(s=e[0],n=e[1],i=e[2],r=e[3]),this.addPoint(s,n).addPoint(i,r)}bottomLeft(){return{x:this.minX,y:this.minY}}topRight(){return{x:this.maxX,y:this.maxY}}center(){return{x:this.cx,y:this.cy}}clone(){const e=new Ol;return e.minX=this.minX,e.minY=this.minY,e.maxX=this.maxX,e.maxY=this.maxY,e.minScaledSize=this.minScaledSize,e.maxScaledSize=this.maxScaledSize,e.minFixedSize=this.minFixedSize,e.maxFixedSize=this.maxFixedSize,e.cx=this.cx,e.cy=this.cy,e.width=this.width,e.height=this.height,e}},WD=1e-6,XD=1e-12;function AC(){for(var t=arguments,e=t.length-1,s=e,n=[],i=0;i<=e&&Math.abs(t[i])<=XD;i++)e--;switch(e){case 1:ZD(t[s],t[s-1],n);break;case 2:KD(t[s],t[s-1],t[s-2],n);break;case 3:QD(t[s],t[s-1],t[s-2],t[s-3],n)}return n}function ZD(t,e,s=[]){return e!==0&&s.push(-t/e),s}function KD(t,e,s,n=[]){var i=e/s,r=i*i-4*(t/s);if(r>0){var o=Math.sqrt(r);n.push(.5*(-i+o)),n.push(.5*(-i-o))}else r===0&&n.push(.5*-i);return n}function QD(t,e,s,n,i=[]){var r,o,a=s/n,l=e/n,u=(3*l-a*a)/3,h=(2*a*a*a-9*l*a+27*(t/n))/27,g=a/3,f=h*h/4+u*u*u/27,p=h/2;if(Math.abs(f)<=WD&&(f=0),f>0){var y=Math.sqrt(f);o=(r=-p+y)>=0?Math.pow(r,1/3):-Math.pow(-r,1/3),(r=-p-y)>=0?o+=Math.pow(r,1/3):o-=Math.pow(-r,1/3),i.push(o-g)}else if(f<0){var _=Math.sqrt(-u/3),x=Math.atan2(Math.sqrt(-f),-p)/3,v=Math.cos(x),b=Math.sin(x),S=Math.sqrt(3);i.push(2*_*v-g),i.push(-_*(v+S*b)-g),i.push(-_*(v-S*b)-g)}else r=p>=0?-Math.pow(p,1/3):Math.pow(-p,1/3),i.push(2*r-g),i.push(-r-g);return i}function Io(t,e,s,n,i,r,o,a,l,u,h){for(var g,f,p=Math.min(o,l),y=Math.min(a,u),_=Math.max(o,l),x=Math.max(a,u),v=AC((g=a-u)*(t+-2*s+i)+(f=l-o)*(e+-2*n+r),g*(-2*t+2*s)+f*(-2*e+2*n),g*t+f*e+(o*u-l*a)),b=0;b<v.length;b++){var S=v[b];if(0<=S&&S<=1){var A=t+(s-t)*S,w=e+(n-e)*S,L=A+(s+(i-s)*S-A)*S,I=w+(n+(r-n)*S-w)*S;if(o===l){if(y<=I&&I<=x){if(!h)return 1;h.push(L,I)}}else if(a===u){if(p<=L&&L<=_){if(!h)return 1;h.push(L,I)}}else if(L>=p&&I>=y&&L<=_&&I<=x){if(!h)return 1;h.push(L,I)}}}return h?h.length/2:0}function wC(t,e,s,n,i,r,o,a,l,u,h){return h?(Io(t,e,s,n,i,r,o,a,l,a,h),Io(t,e,s,n,i,r,l,a,l,u,h),Io(t,e,s,n,i,r,o,u,l,u,h),Io(t,e,s,n,i,r,o,a,o,u,h),h.length/2):o<=t&&l>=t&&a<=e&&u>=e||o<=i&&l>=i&&a<=r&&u>=r||Io(t,e,s,n,i,r,o,a,l,a)||Io(t,e,s,n,i,r,l,a,l,u)||Io(t,e,s,n,i,r,o,u,l,u)||Io(t,e,s,n,i,r,o,a,o,u)?1:0}function Ro(t,e,s,n,i,r,o,a,l,u,h,g,f){for(var p,y,_=Math.min(l,h),x=Math.min(u,g),v=Math.max(l,h),b=Math.max(u,g),S=AC((p=u-g)*(-1*t+3*s+-3*i+o)+(y=h-l)*(-1*e+3*n+-3*r+a),p*(3*t+-6*s+3*i)+y*(3*e+-6*n+3*r),p*(-3*t+3*s)+y*(-3*e+3*n),p*t+y*e+(l*g-h*u)),A=0;A<S.length;A++){var w=S[A];if(0<=w&&w<=1){var L=t+(s-t)*w,I=e+(n-e)*w,F=s+(i-s)*w,O=n+(r-n)*w,V=L+(F-L)*w,j=I+(O-I)*w,Z=V+(F+(i+(o-i)*w-F)*w-V)*w,at=j+(O+(r+(a-r)*w-O)*w-j)*w;if(l===h){if(x<=at&&at<=b){if(!f)return 1;f.push(Z,at)}}else if(u===g){if(_<=Z&&Z<=v){if(!f)return 1;f.push(Z,at)}}else if(Z>=_&&at>=x&&Z<=v&&at<=b){if(!f)return 1;f.push(Z,at)}}}return f?f.length/2:0}function Iy(t,e,s,n,i,r,o,a,l,u,h,g,f){return f?(Ro(t,e,s,n,i,r,o,a,l,u,h,u,f),Ro(t,e,s,n,i,r,o,a,h,u,h,g,f),Ro(t,e,s,n,i,r,o,a,l,g,h,g,f),Ro(t,e,s,n,i,r,o,a,l,u,l,g,f),f.length/2):l<=t&&h>=t&&u<=e&&g>=e||l<=o&&h>=o&&u<=a&&g>=a||Ro(t,e,s,n,i,r,o,a,l,u,h,u)||Ro(t,e,s,n,i,r,o,a,h,u,h,g)||Ro(t,e,s,n,i,r,o,a,l,g,h,g)||Ro(t,e,s,n,i,r,o,a,l,u,l,g)?1:0}function gS(t,e,s,n,i){const r=1-i;return r*r*r*t+3*i*r*r*e+3*i*i*r*s+i*i*i*n}function Wl(t,e,s,n){const i=1-n;return i*i*t+2*i*n*e+n*n*s}var JD=(t,e)=>2/(1+Math.exp(-Math.abs(t*e))),tO=5,fS=5;function sp(t,e,s,n,i,r){const o=r||{x1:0,y1:0,x2:0,y2:0},a=(n+n/fS*s)*fS,l=-i+Math.PI,u=-i+Math.PI/2;return o.x1=t+Math.cos(l)*a,o.y1=e+Math.sin(l)*a,o.x2=t+Math.cos(u)*a,o.y2=e+Math.sin(u)*a,o}function np(t,e,s,n,i,r,o,a){const l=a||{x1:0,y1:0,x2:0,y2:0};if(r){const u=dD(i);if(o){const h=u*e+(1-u)*n;l.x1=t,l.y1=h,l.x2=s,l.y2=h}else{const h=u*t+(1-u)*s;l.x1=h,l.y1=e,l.x2=h,l.y2=n}}else l.x1=t,l.y1=e,l.x2=s,l.y2=n;return l}function Ya(t,e,s,n,i,r){const o=r||{x:0,y:0},a=(t+s)/2,l=(e+n)/2,u=t-s,h=e-n,g=Math.sqrt(u*u+h*h);if(g===0)return o.x=a,o.y=l,o;const f=h/g,p=-u/g,y=-g*i/tO;return o.x=a+f*y,o.y=l+p*y,o}function ip(t,e,s,n,i,r,o,a={x:0,y:0}){return a.x=(1-t)*(1-t)*e+2*(1-t)*t*r+t*t*n,a.y=(1-t)*(1-t)*s+2*(1-t)*t*o+t*t*i,a}function h0(t,e,s,n,i,r,o,a={x:0,y:0}){return a.x=(2*t-2)*e+(2*n-4*r)*t+2*r,a.y=(2*t-2)*s+(2*i-4*o)*t+2*o,S2(a)}function TC(t,e,s,n,i,r,o,a={x:0,y:0}){return h0(t,e,s,n,i,r,s,a),hf(a.x,a.y,0,0,Math.PI/2,a),a}function CC(t,e,s,n,i,r,o,a,l,u=0,h=!1){const g=s-2*o+i,f=n-2*a+r,p=-((s-t)*f-(n-e)*g)/((2*o-2*s)*f-(2*a-2*n)*g);if(p<0||p>1)return!1;let y=l/2;h&&(y*=1-p),y+=u;const _=Wl(s,o,i,p),x=Wl(n,a,r,p);return _n(_,x,t,e)<=y}function eO(t,e){const s=t.getAttribute("curvature"),[n,i]=t.getExtremities().getAttributes(["x","y"]),r=Ya(n.x,n.y,i.x,i.y,s);return ip(e,n.x,n.y,i.x,i.y,r.x,r.y)}function sO(t,e){const s=t.getAttribute("curvature"),[n,i]=t.getExtremities().getAttributes(["x","y"]),r=Ya(n.x,n.y,i.x,i.y,s);return TC(e,n.x,n.y,i.x,i.y,r.x,r.y)}function nO(t,e){const s=t.getAttribute("curvature"),[n,i]=t.getExtremities().getAttributes(["x","y"]),r=Ya(n.x,n.y,i.x,i.y,s);return h0(e,n.x,n.y,i.x,i.y,r.x,r.y)}function eh(t,e,s,n,i,r,o,a,l,u={x:0,y:0}){const h=(1-t)*(1-t)*(1-t),g=3*t*(1-t)*(1-t),f=3*t*t*(1-t),p=t*t*t;return u.x=h*e+g*r+f*a+p*n,u.y=h*s+g*o+f*l+p*i,u}function Ry(t,e,s,n,i,r,o,a,l,u,h,g){let f=.5,p=_n(t,e,s,n)<_n(t,e,i,r)?-.01:.01,y=100;const _=eh(f,s,n,i,r,o,a,l,u);let x,v=_n(t,e,_.x,_.y);const b=h/2+g;for(;y-- >0&&f>=0&&f<=1&&v>b&&(p>.001||p<-.001);)x=v,eh(f,s,n,i,r,o,a,l,u,_),v=_n(t,e,_.x,_.y),v>x?(p=-p/2,f+=p):f+p<0||f+p>1?(p/=2,v=x):f+=p;return v<b}function c0(t,e,s,n,i,r,o=d0()){const a=t+.6666666666666666*(s-t),l=e+2/3*(n-e);return rp(t,e,a,l,a+1/3*(i-t),l+1/3*(r-e),i,r,o)}function rp(t,e,s,n,i,r,o,a,l=d0()){const{min:u,max:h,sqrt:g}=Math;let f,p,y,_,x;l.minX=u(t,o),l.maxX=h(t,o),l.minY=u(e,a),l.maxY=h(e,a);for(let v,b,S,A,w,L,I,F=0;F<2;++F)if(F===0?(p=t,y=s,_=i,x=o):(p=e,y=n,_=r,x=a),b=6*p-12*y+6*_,v=-3*p+9*y-9*_+3*x,S=3*y-3*p,b|=0,v|=0,S|=0,v!==0)w=b*b-4*S*v,w<0||(L=(-b+g(w))/(2*v),L>0&&L<1&&(f=s_(L,p,y,_,x),F===0?(l.minX=u(l.minX,f),l.maxX=h(l.maxX,f)):(l.minY=u(l.minY,f),l.maxY=h(l.maxY,f))),I=(-b-g(w))/(2*v),I>0&&I<1&&(f=s_(I,p,y,_,x),F===0?(l.minX=u(l.minX,f),l.maxX=h(l.maxX,f)):(l.minY=u(l.minY,f),l.maxY=h(l.maxY,f))));else{if(b===0)continue;A=-S/b,A>0&&A<1&&(f=s_(A,p,y,_,x),F===0?(l.minX=u(l.minX,f),l.maxX=h(l.maxX,f)):(l.minY=u(l.minY,f),l.maxY=h(l.maxY,f)))}return l}function s_(t,e,s,n,i){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*s+3*(1-t)*Math.pow(t,2)*n+Math.pow(t,3)*i}function iO(t,e,s,n,i,r){const o=t-2*s+i,a=e-2*n+r,l=2*s-2*t,u=2*n-2*e,h=4*(o*o+a*a),g=4*(o*l+a*u),f=l*l+u*u,p=2*Math.sqrt(h+g+f),y=Math.sqrt(h),_=2*h*y,x=2*Math.sqrt(f),v=g/y;return(_*p+y*g*(p-x)+(4*f*h-g*g)*Math.log((2*y+v+p)/(v+x)))/(4*_)}var eo,io=(eo=class extends wh{constructor({bufferList:e,patternManager:s,boundariesManager:n,shapeManager:i,textManager:r,memoryManager:o}){super(),this._firstFrame=!0,this._width=0,this._height=0,this._pixelRatio=0,this._viewX=0,this._viewY=0,this._viewZoom=0,this._viewAngle=0,this._viewAngleCos=0,this._viewAngleSin=0,this._currentTime=0,this._scales={bytesToActualCoord:0,bytesToActualScaledSize:0,bytesToActualMinVisibleSize:0,bytesToActualSymbolicSize:0,bytesToActualDashLength:0,bytesToActualGapLength:0,bytesToActualPatternScale:0},this._shapesVersion=0,this._patternsVersion=0,this._boundariesVersion=0,this._textsVersion=0,this._backgroundRgba=[1,1,1,0],this._renderBackground=!1,this._hideImages=!1,this._genericObject=n0(),this._littleEndian=Of(),this._bufferList=e,this._shapeManager=i,this._patternManager=s,this._boundariesManager=n,this._textManager=r,this._memoryManager=o}static createInitData(){return null}static getName(){return null}static isAvailable(){return!0}static setEdgeArrowSizeRatio(e){eo.edgeArrowSizeRatio=e}static setMinEdgeTipSize(e){eo.minEdgeTipSize=e}getDomElement(){return null}_initCanvas(e){e.style.touchAction="none"}export(e){return Promise.resolve()}extractElement(e,s){return this._memoryManager.extractGenericElement(e,s,this._scales)}_compareDimensions(e,s,n){return(e!==this._width||s!==this._height||n!==this._pixelRatio)&&(this._width=e,this._height=s,this._pixelRatio=n,!0)}_compareView(e,s,n,i){return(e!==this._viewX||s!==this._viewY||n!==this._viewZoom||i!==this._viewAngle)&&(this._viewX=e,this._viewY=s,this._viewZoom=n,this._viewAngle=i,this._viewAngleCos=Math.cos(i),this._viewAngleSin=Math.sin(i),!0)}_compareCurrentTime(e){return e!==this._currentTime&&(this._currentTime=e,!0)}_compareBackgroundColor(e,s){return(e!==this._backgroundColor||s!==this._renderBackground)&&(this._renderBackground=s,this._backgroundColor=e,this._backgroundRgba=Wn(this._backgroundColor),!0)}_compareShapes(){return this._shapesVersion!==this._shapeManager.getVersion()&&(this._shapesVersion=this._shapeManager.getVersion(),!0)}_comparePatterns(){return this._patternsVersion!==this._patternManager.getVersion()&&(this._patternsVersion=this._patternManager.getVersion(),!0)}_compareBoundaries(){return this._boundariesVersion!==this._boundariesManager.getVersion()&&(this._boundariesVersion=this._boundariesManager.getVersion(),!0)}_compareTexts(){return this._textsVersion!==this._textManager.getVersion()&&(this._textsVersion=this._textManager.getVersion(),!0)}_compareIsDisplayableBuffer(e){return this._isBufferDisplayable!==e&&(this._isBufferDisplayable=e,!0)}_compareHideImages(e){return this._hideImages!==e&&(this._hideImages=e,!0)}renderFrame({x:e,y:s,zoom:n,angle:i,width:r,height:o,pixelRatio:a,backgroundColor:l,currentTime:u,isBufferDisplayable:h,hideImages:g,renderBackground:f}){const p=this._compareShapes(),y=this._comparePatterns(),_=this._compareBoundaries(),x=this._compareTexts(),v=this._compareDimensions(r,o,a),b=this._compareView(e,s,n,i),S=this._compareCurrentTime(u),A=this._compareBackgroundColor(l,f),w=this._compareIsDisplayableBuffer(h),L=this._compareHideImages(g);if(_){const I=this._boundariesManager,F=this._scales;F.bytesToActualCoord=1,F.bytesToActualScaledSize=I.maxScaledSize/X2,F.bytesToActualMinVisibleSize=I.maxMinVisibleSize/Ey,F.bytesToActualSymbolicSize=I.maxSymbolicSize/ql,F.bytesToActualDashLength=I.maxDashLength/Yl,F.bytesToActualGapLength=I.maxGapLength/Yl,F.bytesToActualPatternScale=I.maxPatternScale/ql}this._firstFrame&&this._beforeFirstFrame(),this._render({shapesChanged:p,patternsChanged:y,boundariesChanged:_,textsChanged:x,dimensionsChanged:v,viewChanged:b,currentTimeChanged:S,backgroundColorChanged:A,isBufferDisplayableChanged:w,isHideImagesChanged:L}),this._firstFrame&&(this._afterFirstFrame(),this._firstFrame=!1)}_render(e){}_beforeFirstFrame(){}_afterFirstFrame(){}destroy(){}ensureAnimationsReady(){}getImageData(){return null}setViewportClipping(e){}},eo.edgeArrowSizeRatio=K2,eo.minEdgeTipSize=Q2,eo);function LC(t,e,s,n,i,r,o,a=0,l=!1){const u=_n(s,n,i,r),h=(o/2*(l?_n(t,e,i,r)/u:1)+a)/u,g=(i-s)*h,f=(r-n)*h,p=s+f,y=n-g,_=t-p,x=e-y,v=s-f-p,b=n+g-y,S=i+f-p,A=r-g-y,w=_*v+x*b,L=_*S+x*A;return w>0&&w<v*v+b*b&&L>0&&L<S*S+A*A}function rO(t,e,s,n,i=!1){if(i&&(Kc(t,s)||Kc(t,n)||Kc(e,s)||Kc(e,n)))return!1;let r=(t.y-s.y)*(n.x-s.x)-(t.x-s.x)*(n.y-s.y);const o=(e.x-t.x)*(n.y-s.y)-(e.y-t.y)*(n.x-s.x);if(o===0)return!1;const a=r/o;r=(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y);const l=r/o;return!(a<=0||a>=1||l<=0||l>=1)}function Kc(t,e){return t.x===e.x&&t.y===e.y}function cu(t,e,s,n){return Math.atan2(n-e,s-t)}function oO(t,e,s){const n=cu(t.x,t.y,e.x,e.y)-cu(s.x,s.y,e.x,e.y);return n<0?n+2*Math.PI:n}function aO(t,e,s,n,i,r,o,a){const l=(a-r)*(s-t)-(o-i)*(n-e);if(l===0)return null;let u=e-r;return u=((o-i)*u-(a-r)*(t-i))/l,{x:t+u*(s-t),y:e+u*(n-e)}}function xd(t,e,s,n,i,r,o,a){const l=t-s,u=e-n,h=i-o,g=r-a,f=l*g-h*u,p=(u*(t-i)-l*(e-r))/f;if(p<0||p>1)return null;const y=(h*(r-e)+g*(t-i))/f;return y>=0&&y<=1?{x:t-y*l,y:e-y*u}:null}function kC(t,e,s,n,i,r,o,a){let l;const u=[];return l=xd(t,e,s,n,i,r,i,a),l&&u.push(l),l=xd(t,e,s,n,i,a,o,a),l&&u.push(l),l=xd(t,e,s,n,o,a,o,r),l&&u.push(l),l=xd(t,e,s,n,o,r,i,r),l&&u.push(l),u}function Xl(t,e,s,n,i,r,o,a){const l=((o-i)*(e-r)-(a-r)*(t-i))/((a-r)*(s-t)-(o-i)*(n-e)),u=((s-t)*(e-r)-(n-e)*(t-i))/((a-r)*(s-t)-(o-i)*(n-e));return l>=0&&l<=1&&u>=0&&u<=1}function g0(t,e,s,n,i,r,o,a){return t>=i&&e>=r&&t<=o&&e<=a||s>=i&&n>=r&&s<=o&&n<=a||!!Xl(t,e,s,n,i,r,i,a)||!!Xl(t,e,s,n,o,r,o,a)||!!Xl(t,e,s,n,i,r,o,r)||!!Xl(t,e,s,n,i,a,o,a)}function NC(t,e,s){return Math.sqrt(f0(t.x,t.y,e.x,e.y,s.x,s.y))}function f0(t,e,s,n,i,r){const o=Og(s,n,i,r);if(o===0)return Og(t,e,s,n);let a=((t-s)*(i-s)+(e-n)*(r-n))/o;return a=Math.max(0,Math.min(1,a)),Og(t,e,s+a*(i-s),n+a*(r-n))}function MC(t,e,s,n,i,r){const o=i-s,a=r-n;if(o===0&&a===0)return{x:s,y:n};const l=((t-s)*o+(e-n)*a)/(o*o+a*a);return l<0?{x:s,y:n}:l>1?{x:i,y:r}:{x:s+l*o,y:n+l*a}}function lO(t,e,s,n,i,r){const o=i-s,a=r-n,l=((t-s)*o+(e-n)*a)/(o*o+a*a);return{x:s+o*l,y:n+a*l}}function op(t,e,s,n,i,r){const o=r||{x:0,y:0},a=(t+s)/2,l=(e+n)/2,u=t-s,h=e-n,g=Math.sqrt(u*u+h*h);if(g===0)return o.x=a,o.y=l,o;const f=h/g,p=-u/g,y=-g*i/Kf;return o.x=a+f*y,o.y=l+p*y,o}function p0(t,e,s,n,i,r){const o=r||{x1:0,y1:0,x2:0,y2:0},a=(n+n/yf*s)*yf,l=-i+Hi,u=Hi/2-i;return o.x1=t+Math.cos(l)*a,o.y1=e+Math.sin(l)*a,o.x2=t+Math.cos(u)*a,o.y2=e+Math.sin(u)*a,o}function uO(t,e,s,n){const i=Math.abs(t.x-e.x-s.x+n.x)+Math.abs(t.y-e.y-s.y+n.y)<.01,r=9*(e.x-t.x)**2,o=(-243*t.x+189*e.x+51*s.x+3*n.x)**2/1e4,a=(-48*t.x+24*e.x+21*s.x+3*n.x)**2/625,l=(-147*t.x+21*e.x+99*s.x+27*n.x)**2/1e4,u=(-27*t.x-9*e.x+24*s.x+12*n.x)**2/625,h=9/16*(s.x+n.x-t.x-e.x)**2,g=9*(e.y-t.y)**2,f=(-243*t.y+189*e.y+51*s.y+3*n.y)**2/1e4,p=(-48*t.y+24*e.y+21*s.y+3*n.y)**2/625,y=(-147*t.y+21*e.y+99*s.y+27*n.y)**2/1e4,_=(-27*t.y-9*e.y+24*s.y+12*n.y)**2/625,x=9/16*(s.y+n.y-t.y-e.y)**2,v=Math.sqrt(r+g),b=Math.sqrt(o+f),S=Math.sqrt(a+p),A=Math.sqrt(l+y),w=Math.sqrt(u+_),L=Math.sqrt(h+x);if(i)return 5/2993760*(32134*v+212600*b-97050*S+544800*A-521100*w+427368*L);const I=(-12*t.x-24*e.x+9*s.x+27*n.x)**2/625,F=(-27*t.x-99*e.x-21*s.x+147*n.x)**2/1e4,O=(-3*t.x-21*e.x-24*s.x+48*n.x)**2/625,V=(-3*t.x-51*e.x-189*s.x+243*n.x)**2/1e4,j=9*(n.x-s.x)**2,Z=(-12*t.y-24*e.y+9*s.y+27*n.y)**2/625,at=(-27*t.y-99*e.y-21*s.y+147*n.y)**2/1e4,pt=(-3*t.y-21*e.y-24*s.y+48*n.y)**2/625,K=(-3*t.y-51*e.y-189*s.y+243*n.y)**2/1e4,ut=9*(n.y-s.y)**2,ht=Math.sqrt(I+Z),nt=Math.sqrt(F+at),ot=Math.sqrt(O+pt),Nt=Math.sqrt(V+K);return 5/2993760*(16067*(v+Math.sqrt(j+ut))+106300*(b+Nt)-48525*(S+ot)+272400*(A+nt)-260550*(w+ht)+427368*L)}var dO={left:{x:-1,y:0},right:{x:1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},center:{x:0,y:0}},hO=[{name:"topLeft",dx:-1,dy:-1,cornerIndex:2},{name:"topRight",dx:1,dy:-1,cornerIndex:3},{name:"bottomLeft",dx:-1,dy:1,cornerIndex:1},{name:"bottomRight",dx:1,dy:1,cornerIndex:0}],Xr={x:0,y:0};function cO(t,e,s,n,i,r,o,a,l,u,h,g){r=r||o.getNodes()._indexes;const f=l.getZoom(),p=o.getObjectList(!0),y=a.getFlexArrays().nodes.current;let _=1/0,x=0,v=-1/0;a.update();for(let b=0;b<r.length;++b){const S=r[b];if(y.excluded.get(S)||!y.detectable.get(S)||h.has(S))continue;const A=y.x.get(S),w=y.y.get(S),L=y.layer.get(S);if(L<v)continue;Xr.x=A,Xr.y=w;const I=l.graphToScreenCoordinates(Xr),F=I.x,O=I.y,V=y.shape.get(S),j=y.scalingMethod.get(S)==="scaled",Z=y.radius.get(S)*(j?f:1),at=Z+i,pt=(t-F)/at,K=(e-O)/at;if(Xr.x=t,Xr.y=e,!(n&&IC(Xr,S,a,l,u)))if(u.checkShapeHit(V,pt,K)){const ut=o.getAttribute(!0,"virtual").get(S)!==0;if(at>_&&ut)continue;_=at}else{if(!s)continue;{const ut=g(y.text.content.get(S)||null),ht=y.textHidden.get(S),nt=y.text.minVisibleSize.get(S),ot=j?2*Z:1/0;if(ht||!ut||ot<nt)continue;const Nt=u0(ut,y.text.maxLineLength.get(S)),Q=y.innerStroke.width.get(S),Et=y.text.margin.get(S),Xt=y.text.padding.get(S),Ht=y.text.size.get(S),Zt=y.text.scale.get(S),ae=y.text.scaling.get(S),pe=y.text.font.get(S),ne=y.text.style.get(S),te=y.text.position.get(S),se=u.measureText(Nt,pe,ne,1),ce=ae?Zt*Z*2:Ht,Ce=se.width*ce/2+Xt,ve=se.height*ce/2+Xt,Ne=dO[te],ge=Q+Et+Z,ze=F+(ge+Ce)*Ne.x,is=O+(ge+ve)*Ne.y,Ge=ze+Ce,De=is-ve,He=is+ve;if(t<=ze-Ce||t>=Ge||e<=De||e>=He)continue}}x=S,v=L}return p.get(x)||null}function IC(t,e,s,n,i){const r=s.getFlexArrays().nodes.current,o=n.getZoom(),a=r.scalingMethod.get(e)==="scaled",l=r.radius.get(e)*(a?o:1),u=r.x.get(e),h=r.y.get(e),g=r.radius.get(e);for(let f=0;f<4;f++){const{name:p,cornerIndex:y}=hO[f],_=r.badges[p].scalingMethod.get(e)==="fixed",x=r.badges[p].scale.get(e),v=_?Math.min(x*l,r.radius.get(e)*x):x*l,b=r.badges[p].minVisibleSize.get(e)/2,S=r.badges[p].positionScale.get(e);if(!r.badges[p].text.content.get(e)&&!r.badges[p].image.url.get(e)||v<b)continue;const A=n.graphToScreenCoordinates({x:u+g*S*n.getCornerCos(y),y:h+g*S*n.getCornerSin(y)}),{x:w,y:L}=A,I=(t.x-w)/v,F=(t.y-L)/v;if(i.checkShapeHit("circle",I,F))return p}}function gO(t,e,s,n,i,r,o,a,l,u,h){i=i||r.getEdges()._indexes;const g=r.getObjectList(!1),f=l.getFlexArrays(),p=f.edges.current,y=f.nodes.current,_=o.getZoom(),x=o.getAngle(),v=Math.cos(x),b=Math.sin(x),S=n/_;Xr.x=t,Xr.y=e;const A=o.screenToGraphCoordinates(Xr),w=A.x,L=A.y;let I=0;l.update();for(let F=0;F<i.length;++F){const O=i[F],V=p.source.get(O),j=p.target.get(O),Z=p.excluded.get(O),at=p.detectable.get(O),pt=a.has(V),K=a.has(j);if(Z||!at||pt||K)continue;const ut=V===j,ht=p.curvature.get(O),nt=p.shape.body.get(O)==="triangle",ot=p.scalingMethod.get(O)==="scaled",Nt=p.width.get(O)/(ot?1:_),Q=y.x.get(V),Et=y.y.get(V),Xt=y.x.get(j),Ht=y.y.get(j);if(ut){const Zt=y.scalingMethod.get(V)==="scaled",ae=p0(Q,Et,ht,y.radius.get(V)/(Zt?1:_),0);if(!Ry(w,L,Q,Et,Q,Et,ae.x1,ae.y1,ae.x2,ae.y2,Nt,S))continue}else if(u){const Zt=np(Q*v-Et*b,Et*v+Q*b,Xt*v-Ht*b,Ht*v+Xt*b,ht,u,h);if(!Ry(w,L,Q,Et,Xt,Ht,Zt.x1*v+Zt.y1*b,Zt.y1*v-Zt.x1*b,Zt.x2*v+Zt.y2*b,Zt.y2*v-Zt.x2*b,Nt,S))continue}else if(ht!==0){const Zt=op(Q,Et,Xt,Ht,ht);if(!CC(w,L,Q,Et,Xt,Ht,Zt.x,Zt.y,Nt,S,nt))continue}else if(!LC(w,L,Q,Et,Xt,Ht,Nt,S,nt))continue;I=O}return g.get(I)||null}function fO(t){const e=t.getNodeAttribute("radius"),s=t.getEdgeAttribute("width"),n=t.getNodes(),i=t.getEdges();let r=0,o=0;for(let a=0;a<n._indexes.length;a++){const l=n._indexes[a],u=e.get(l);u>r&&(r=u)}for(let a=0;a<i._indexes.length;a++){const l=i._indexes[a],u=s.get(l);u>o&&(o=u)}return Math.max(2*r,o)}function pO(t){return t===null?"none":t==="webgl"?"WebGL":t==="svg"?"SVG":t==="canvas"?"Canvas":t}function RC(t,e,s,n){const i=(t-e)/s,r=i*i,o=r*i,a=i0.getCoefficients(n),l=i<.5?0:4;return qi(a[l]+a[l+1]*i+a[l+2]*r+a[l+3]*o,0,1)}function vd(t,e,s,n){if(t===e)return t;const[i,r,o,a]=Wn(t),[l,u,h,g]=Wn(e);return`rgba(${Math.round(255*bs(i,l,s))},${Math.round(255*bs(r,u,s))},${Math.round(255*bs(o,h,s))},${bs(a,g,n)})`}function mO(t,e){const[s,n,i,r]=Wn(t);return`rgba(${255*s},${255*n},${255*i},${r*e})`}var pS=1/mi,FC=class extends io{constructor(t){super(t),this._cachePoints=[],this._nextCachePoint=0,this._tmp={x1:0,y1:0,x2:0,y2:0},this._ccp={x1:0,y1:0,x2:0,y2:0},this._pointCopies=Array(128),this._clipViewport=!0}_resetCachePoints(){this._nextCachePoint=0}_point(t,e){let s=this._cachePoints[this._nextCachePoint++];return s||(s={x:0,y:0},this._cachePoints.push(s)),s.x=t,s.y=e,s}setViewportClipping(t){this._clipViewport=t}_displayBuffer(t){const e=t.getSize(),s=t.animated;for(let n=0;n<e;++n){const i=this.extractElement(t,n);i.valid&&this._displayElement(i,s)}}_mixAttributes(t,e,s){const n=RC(this._currentTime,s.beginTime,s.duration,s.easing);return t.dashLength=bs(e.dashLength,t.dashLength,n),t.gapLength=bs(e.gapLength,t.gapLength,n),t.offsetAngle=bs(e.offsetAngle,t.offsetAngle,n),t.opacity=bs(e.opacity,t.opacity,n),t.globalMinVisibleSize=bs(e.globalMinVisibleSize,t.globalMinVisibleSize,n),t.strokeMinVisibleSize=bs(e.strokeMinVisibleSize,t.strokeMinVisibleSize,n),t.patternMinVisibleSize=bs(e.patternMinVisibleSize,t.patternMinVisibleSize,n),t.symbolicSize=bs(e.symbolicSize,t.symbolicSize,n),t.curvature=bs(e.curvature,t.curvature,n),t.fillColor=vd(e.fillColor,t.fillColor,n,n),t.strokeColor=vd(e.strokeColor,t.strokeColor,n,n),t.patternColor=vd(e.patternColor,t.patternColor,n,n),t.x1=bs(e.x1,t.x1,n),t.y1=bs(e.y1,t.y1,n),t.x2=bs(e.x2,t.x2,n),t.y2=bs(e.y2,t.y2,n),t.rectWidthOrSourceRadiusScaled=bs(e.rectWidthOrSourceRadiusScaled,t.rectWidthOrSourceRadiusScaled,n),t.rectWidthOrSourceRadiusFixed=bs(e.rectWidthOrSourceRadiusFixed,t.rectWidthOrSourceRadiusFixed,n),t.rectHeightOrTargetRadiusScaled=bs(e.rectHeightOrTargetRadiusScaled,t.rectHeightOrTargetRadiusScaled,n),t.rectHeightOrTargetRadiusFixed=bs(e.rectHeightOrTargetRadiusFixed,t.rectHeightOrTargetRadiusFixed,n),t.thicknessOrFontSizeScaled=bs(e.thicknessOrFontSizeScaled,t.thicknessOrFontSizeScaled,n),t.thicknessOrFontSizeFixed=bs(e.thicknessOrFontSizeFixed,t.thicknessOrFontSizeFixed,n),t.strokeWidthScaled=bs(e.strokeWidthScaled,t.strokeWidthScaled,n),t.strokeWidthFixed=bs(e.strokeWidthFixed,t.strokeWidthFixed,n),t.offsetScaled=bs(e.offsetScaled,t.offsetScaled,n),t.offsetFixed=bs(e.offsetFixed,t.offsetFixed,n),t}_computeRenderInfo(t){const e=this._viewZoom,s=this._point(t.x1,t.y1),n=this._point(t.x2,t.y2),i=t.isBadge,r=i&&t.rectWidthOrSourceRadiusScaled&&t.rectWidthOrSourceRadiusFixed,o=r?Math.min(t.rectWidthOrSourceRadiusScaled*e,t.rectWidthOrSourceRadiusFixed):t.rectWidthOrSourceRadiusScaled*e+t.rectWidthOrSourceRadiusFixed,a=r?o:t.rectHeightOrTargetRadiusScaled*e+t.rectHeightOrTargetRadiusFixed,l=t.symbolicSize===0?1/0:t.symbolicSize*e;return{shape:this._shapeManager.getDefinitionFromName(t.shape),pieceId:t.pieceId,dashLength:t.dashLength,gapLength:t.gapLength,hasHead:t.hasHead,hasTail:t.hasTail,isBodyTriangle:t.isBodyTriangle,isSelfLoop:t.isSelfLoop,patternScale:t.patternScale,offsetAngle:df(t.offsetAngle),isText:t.isText,adjustTextAngle:t.adjustTextAngle,isBadge:i,bentEnable:t.bentEnable,bentVertical:t.bentVertical,opacity:t.opacity,globalMinVisibleSize:t.globalMinVisibleSize,strokeMinVisibleSize:t.strokeMinVisibleSize,patternMinVisibleSize:t.patternMinVisibleSize,symbolicSize:l,curvature:t.curvature,pattern:t.pattern,fillColor:t.fillColor,strokeColor:t.strokeColor,patternColor:t.patternColor,pos1OnGraph:s,pos2OnGraph:n,pos1:this._graphToScreenCoordinates(s),pos2:this._graphToScreenCoordinates(n),rectWidthOrSourceRadius:o,rectHeightOrTargetRadius:a,thicknessOrFontSize:t.thicknessOrFontSizeScaled*e+t.thicknessOrFontSizeFixed,strokeWidth:t.strokeWidthScaled*e+t.strokeWidthFixed,offset:t.offsetScaled*e+t.offsetFixed}}_applyBackgroundBlending(t){t.opacity!==1&&(t.fillColor=this._blendColor(t.fillColor,t.opacity),t.strokeColor=this._blendColor(t.strokeColor,t.opacity),t.textColor=this._blendColor(t.textColor,t.opacity))}_pointArray(t){let e=this._pointCopies[t];if(!e){e=new Array(t),this._pointCopies[t]=e;for(let s=0;s<t;++s)e[s]={x:0,y:0,r:0}}return e}_scalePoints(t,e,s,n){const i=t.shape.points.length,r=this._pointArray(i);for(let l=0;l<i;++l){const u=t.shape.points[l],h=r[l];h.x=e.x+u.x*s,h.y=e.y+u.y*n,h.r=u.r*s}const o=t.pos2OnGraph.x-t.pos1OnGraph.x,a=t.pos2OnGraph.y-t.pos1OnGraph.y;if(o!==0||a!==0){const l=Math.sqrt(o*o+a*a),u=o/l,h=a/l;for(const g of r){const f=g.x-e.x,p=g.y-e.y;g.x=e.x+u*f+h*p,g.y=e.y-h*f+u*p}}return r}_drawPoints(t,e=!1){t.length===1?this._drawCircle(t[0],t[0].r):this._drawPolygon(t,e)}_computeCenter(t){const e=Math.cos(t.offsetAngle),s=Math.sin(t.offsetAngle),n=(t.pos1.x+t.pos2.x)/2+e*t.offset,i=(t.pos1.y+t.pos2.y)/2+s*t.offset;return this._point(n,i)}_displayTextBox(t,e,s,n){const i=this._computeCenter(t),r=t.rectWidthOrSourceRadius/2,o=t.rectHeightOrTargetRadius/2;(e||n)&&this._drawRoundedRectangle(i,r,o,0,t.fillColor)}_displayNodeComponent(t,e,s,n){const i=this._computeCenter(t);if(t.pattern.type!==Xo){const r=t.rectWidthOrSourceRadius/2,o=t.rectHeightOrTargetRadius/2,a=this._scalePoints(t,i,r,o);if((e||n)&&this._drawPoints(a,!0),e&&this._fill(t.fillColor),n){if(this._startClip(),t.pattern.type===Th){let l=t.pattern.attributes.colorArray;t.opacity!==1&&(l=l.map((u=>this._blendColor(u,t.opacity)))),this._displayPieChart(i,r,l)}else if(t.pattern.type===za||t.pattern.type===Da){const u=Math.round(t.rectHeightOrTargetRadius*t.patternScale),h=t.pattern.attributes.text,g=this._blendColor(t.patternColor,t.opacity),f=t.pattern.attributes.font,p=t.pattern.attributes.style,y=t.pattern.attributes.align,_=t.rectWidthOrSourceRadius,x=t.pattern.attributes.paddingTop,v=t.pattern.attributes.paddingLeft;this._displayText(i,0,h,g,f,u,p,y,_,v,x,!0)}else if(t.pattern.type===qo){const l=t.pattern.attributes.image;if(l.isDummy||l.width&&l.height){const u=t.pattern.attributes.duplicated,h=u?1:t.patternScale,g=t.rectWidthOrSourceRadius*h,f=t.rectHeightOrTargetRadius*h,p=t.pattern.attributes.scaled,y=t.opacity;this._displayImage(i,g,f,l,p,u,y)}}this._endClip()}if(s){const l=t.strokeWidth/2,u=this._scalePoints(t,i,r+l,o+l);this._drawPoints(u),this._stroke(t.strokeColor,t.strokeWidth)}}else if(n){const o=t.thicknessOrFontSize,a=t.pattern.attributes.text,l=this._blendColor(t.patternColor,t.opacity),u=t.pattern.attributes.font,h=t.pattern.attributes.style,g=t.pattern.attributes.align,f=t.rectWidthOrSourceRadius;this._displayText(i,0,a,l,u,o,h,g,f,0,0,!1)}}_displayElement(t,e){if(!t.end||!t.end.shape||!t.end.pieceId||e&&(!t.start||!t.animation))return;this._resetCachePoints();const s=e?this._mixAttributes(t.end,t.start,t.animation):t.end,n=this._computeRenderInfo(s);if(n.symbolicSize<n.globalMinVisibleSize||n.opacity===0)return;this._applyBackgroundBlending(n);const i=!!(n.strokeColor&&n.strokeWidth>0&&n.symbolicSize>=n.strokeMinVisibleSize),r=n.pattern.type!==Xn&&n.symbolicSize>=n.patternMinVisibleSize,o=!!n.fillColor;if(n.pieceId===Yi)return this._displayNodeComponent(n,o,i,r);if(n.pieceId===Ma)return this._displayTextBox(n,o,i,r);const a=n.pos2.x-n.pos1.x,l=n.pos2.y-n.pos1.y,u=Math.sqrt(a*a+l*l);let h,g=null,f=null;if(n.bentEnable&&!n.isSelfLoop)this._tmp.x1=n.pos1.x,this._tmp.y1=n.pos1.y,this._tmp.x2=n.pos2.x,this._tmp.y2=n.pos2.y,n.pos1.x=this._tmp.x1*this._viewAngleCos-this._tmp.y1*this._viewAngleSin,n.pos1.y=this._tmp.y1*this._viewAngleCos+this._tmp.x1*this._viewAngleSin,n.pos2.x=this._tmp.x2*this._viewAngleCos-this._tmp.y2*this._viewAngleSin,n.pos2.y=this._tmp.y2*this._viewAngleCos+this._tmp.x2*this._viewAngleSin,np(n.pos1.x,n.pos1.y,n.pos2.x,n.pos2.y,n.curvature,n.bentEnable,n.bentVertical,this._ccp),n.pos1.x=this._tmp.x1,n.pos1.y=this._tmp.y1,n.pos2.x=this._tmp.x2,n.pos2.y=this._tmp.y2,this._tmp.x1=this._ccp.x1,this._tmp.y1=this._ccp.y1,this._tmp.x2=this._ccp.x2,this._tmp.y2=this._ccp.y2,this._ccp.x1=this._tmp.x1*this._viewAngleCos+this._tmp.y1*this._viewAngleSin,this._ccp.y1=this._tmp.y1*this._viewAngleCos-this._tmp.x1*this._viewAngleSin,this._ccp.x2=this._tmp.x2*this._viewAngleCos+this._tmp.y2*this._viewAngleSin,this._ccp.y2=this._tmp.y2*this._viewAngleCos-this._tmp.x2*this._viewAngleSin,g=this._point(this._ccp.x1,this._ccp.y1),f=this._point(this._ccp.x2,this._ccp.y2),h=uO(n.pos1,g,f,n.pos2);else if(n.isSelfLoop){const p=n.pieceId===Aa||n.pieceId===Aa+Ma?n.strokeWidth/2:n.rectWidthOrSourceRadius,{x1:y,y1:_,x2:x,y2:v}=this._getSelfLoopControlPoints(n.pos1,n.curvature,p);g=this._point(y,_),f=this._point(x,v),h=yO(n.pos1,g,f,n.pos2,1)}else n.curvature?(g=this._getQuadraticCurveControlPoint(n),h=_O(n.curvature,u,1)):h=u;if(n.pieceId===Aa||n.pieceId===Aa+Ma){const p=n.strokeWidth,y=this._getPointOnLine(n.pos1,g,f,n.pos2,.5),_=this._getTangentOnLine(n.pos1,g,f,n.pos2,.5);if(n.rectWidthOrSourceRadius>=h-p&&!n.isSelfLoop){if(!n.adjustTextAngle)return;_.x=1,_.y=0}let x=-Math.atan2(_.y,_.x);const v=df(n.offsetAngle-x);(!n.isSelfLoop&&v<0||n.isSelfLoop&&n.offsetAngle<0)&&(_.x*=-1,_.y*=-1),(x>Math.PI/2||x<-Math.PI/2)&&(x+=Math.PI);const b=this._getOrthogonal(_),S=y.x+b.x*n.offset,A=y.y+b.y*n.offset;if(n.pieceId===Aa+Ma){if(!n.fillColor)return;const w=n.rectWidthOrSourceRadius/2,L=n.rectHeightOrTargetRadius/2;this._drawRoundedRectangle(this._point(S,A),w,L,v+Math.PI/2,n.fillColor)}else{const w=this._point(S,A),L=x,I=n.thicknessOrFontSize,F=n.pattern.attributes.text,O=this._blendColor(n.patternColor,n.opacity),V=n.pattern.attributes.font,j=n.pattern.attributes.style,Z=n.pattern.attributes.align,at=n.rectWidthOrSourceRadius;this._displayText(w,L,F,O,V,I,j,Z,at,0,0,!1)}}else{const p=n.pieceId===e0,y=n.pieceId===s0,_=Math.cos(n.offsetAngle),x=Math.sin(n.offsetAngle);n.pos1.x+=_*n.offset,n.pos1.y+=x*n.offset,n.pos2.x+=_*n.offset,n.pos2.y+=x*n.offset;const v=n.shape.name==="line",b=n.thicknessOrFontSize,S=n.rectWidthOrSourceRadius,A=n.rectHeightOrTargetRadius,w=+n.hasHead,L=+n.hasTail,I=Math.max(io.minEdgeTipSize,b*io.edgeArrowSizeRatio),F=w*Math.min(5*S,I),O=L*Math.min(5*A,I),V=n.isSelfLoop?1/0:u-S-A,j=Math.min(0,V-F-O)/2,Z=b/2;let at=S>Z?S-Math.sqrt(S*S-Z*Z):Z;const pt=Math.max(S+O+L*j,0)-(1-w)*at;at=S>Z?A-Math.sqrt(A*A-Z*Z):Z;const K=Math.max(A+F+w*j,0)-(1-L)*at;if(p||y){const ut=y?-1:1,ht=(p?h-K:pt)-ut;let nt=null,ot=null;if((n.bentEnable||n.isSelfLoop)&&g&&f){const Nt=this._getTFromLengthOnCubicCurve(n.pos1,g,f,n.pos2,(p?K:pt)+1+n.strokeWidth/2,y);nt=this._getPointOnCubicCurve(n.pos1,g,f,n.pos2,Nt),ot=this._getTangentOnCubicCurve(n.pos1,g,f,n.pos2,Nt)}else if(n.curvature&&g){const Nt=this._getTFromLengthOnQuadraticCurve(n.pos1,g,n.pos2,ht-n.strokeWidth/2*ut);nt=this._getPointOnQuadraticCurve(n.pos1,g,n.pos2,Nt),ot=this._getTangentOnQuadraticCurve(n.pos1,g,n.pos2,Nt)}else{const Nt=ht/h;nt=this._mixPoints(n.pos1,n.pos2,Nt),ot=this._point(a/u,l/u)}if(ot.x*=ut,ot.y*=ut,o){if(n.shape.hole){const Q=this._makeEdgeExtremityPoints(nt,ot,I,n.shape.hole);this._drawPoints(Q),this._startReverseClip()}const Nt=this._makeEdgeExtremityPoints(nt,ot,I,n.shape.points);this._drawPoints(Nt),this._fill(n.fillColor),n.shape.hole&&this._endReverseClip()}if(i){if(n.shape.hole){const Et=this._makeEdgeExtremityPoints(nt,ot,I,n.shape.hole);this._drawPoints(Et),this._stroke(n.strokeColor,n.strokeWidth)}const Nt=I+n.strokeWidth/2,Q=this._makeEdgeExtremityPoints(nt,ot,Nt,n.shape.points);this._drawPoints(Q),this._stroke(n.strokeColor,n.strokeWidth)}}else{if(h-pt-K<=0)return;if(v){const ut=xO(h,b,pt,K,n.dashLength,n.gapLength);i&&(this._drawLine(n.pos1,g,f,n.pos2),this._stroke(n.strokeColor,b+2*n.strokeWidth,ut)),o&&(this._drawLine(n.pos1,g,f,n.pos2),this._stroke(n.fillColor,b,ut))}else{const ut=pt,ht=h-K;if(i){const nt=this._makeTriangleEdgeBody(n.pos1,g,f,n.pos2,ut,ht,b+n.strokeWidth/2,n.strokeWidth/2,h);this._drawPoints(nt),this._stroke(n.strokeColor,n.strokeWidth)}if(o){const nt=this._makeTriangleEdgeBody(n.pos1,g,f,n.pos2,ut,ht,b,0,h);this._drawPoints(nt),this._fill(n.fillColor)}}}}}_makeTriangleEdgeBody(t,e,s,n,i,r,o,a,l){return e?s?this._makeSelfLoopTriangleEdge(t,e,s,n,i,r,o,a,l):this._makeCurveTriangleEdge(t,e,n,i,r,o,a):this._makeStraightTriangleEdge(t,n,i,r,o,a)}_makeCurveTriangleEdge(t,e,s,n,i,r,o){const a=2*mi+2,l=this._pointArray(a),u=this._getTFromLengthOnQuadraticCurve(t,e,s,n),h=(this._getTFromLengthOnQuadraticCurve(t,e,s,i)-u)/mi,g=(o-r)/mi/2;let f=r/2,p=u;for(let y=0;y<=mi;++y){const _=this._getPointOnQuadraticCurve(t,e,s,p),x=this._getTangentOnQuadraticCurve(t,e,s,p),v=this._getOrthogonal(x),b=v.x*f,S=v.y*f,A=l[y],w=l[a-1-y];A.x=_.x+b,A.y=_.y+S,w.x=_.x-b,w.y=_.y-S,p+=h,f+=g}return l}_makeSelfLoopTriangleEdge(t,e,s,n,i,r,o,a,l){const u=2*mi+2,h=this._pointArray(u),g=this._getTFromLengthOnCubicCurve(t,e,s,n,i),f=(this._getTFromLengthOnCubicCurve(t,e,s,n,l-r,!1)-g)/mi,p=(a-o)/mi/2;let y=o/2,_=g;for(let x=0;x<=mi;++x){const v=this._getPointOnCubicCurve(t,e,s,n,_),b=this._getTangentOnCubicCurve(t,e,s,n,_),S=this._getOrthogonal(b),A=S.x*y,w=S.y*y,L=h[x],I=h[u-1-x];L.x=v.x+A,L.y=v.y+w,I.x=v.x-A,I.y=v.y-w,_+=f,y+=p}return h}_makeStraightTriangleEdge(t,e,s,n,i,r){const o=e.x-t.x,a=e.y-t.y,l=Math.sqrt(o*o+a*a),u=this._point(o/l,a/l),h=this._getOrthogonal(u),g=i/2,f=r/2,p=this._pointArray(4),y=p[0],_=p[1],x=p[2],v=p[3],b=t.x+u.x*s,S=t.y+u.y*s,A=t.x+u.x*n,w=t.y+u.y*n,L=h.x*g,I=h.y*g,F=h.x*f,O=h.y*f;return y.x=b+L,y.y=S+I,_.x=b-L,_.y=S-I,x.x=A-F,x.y=w-O,v.x=A+F,v.y=w+O,p}_makeEdgeExtremityPoints(t,e,s,n){const i=this._pointArray(n.length),r=s/2,o=t.x+e.x*r,a=t.y+e.y*r,l=e.x,u=e.y;for(let h=0;h<n.length;++h){const g=n[h],f=i[h],p=(l*g.x-u*g.y)*r,y=(u*g.x+l*g.y)*r;f.x=o+p,f.y=a+y,f.r=g.r*r}return i}_drawLine(t,e,s,n){e?s?this._drawCubicCurve(t,e,s,n):this._drawQuadraticCurve(t,e,n):this._drawStraightLine(t,n)}_getSelfLoopControlPoints(t,e,s){return p0(t.x,t.y,e,s,this._viewAngle,this._tmp)}_getQuadraticCurveControlPoint(t){return op(t.pos1.x,t.pos1.y,t.pos2.x,t.pos2.y,t.curvature,this._point(0,0))}_graphToScreenCoordinates(t){const e=this._width/2,s=this._height/2,n=(t.x-this._viewX)*this._viewZoom,i=(t.y-this._viewY)*this._viewZoom,r=this._viewAngleCos,o=this._viewAngleSin,a=r*n+o*i+e,l=-o*n+r*i+s;return this._point(a,l)}_blendColor(t,e){return t&&this._backgroundColor?vd(this._backgroundColor,t,e,1):t?mO(t,e):null}_getTangentOnLine(t,e,s,n,i){return e?s?this._getTangentOnCubicCurve(t,e,s,n,i):this._getTangentOnQuadraticCurve(t,e,n,i):this._getTangentOnStraightLine(t,n)}_getTangentOnStraightLine(t,e){const s=e.x-t.x,n=e.y-t.y,i=Math.sqrt(s*s+n*n);return this._point(s/i,n/i)}_getTangentOnQuadraticCurve(t,e,s,n){const i=1-n,r=i*e.x+n*s.x-(i*t.x+n*e.x),o=i*e.y+n*s.y-(i*t.y+n*e.y),a=Math.sqrt(r*r+o*o);return this._point(r/a,o/a)}_getTangentOnCubicCurve(t,e,s,n,i){const r=1-i,o=r*r,a=i*i,l=o*(e.x-t.x)+2*r*i*(s.x-e.x)+a*(n.x-s.x),u=o*(e.y-t.y)+2*r*i*(s.y-e.y)+a*(n.y-s.y),h=Math.sqrt(l*l+u*u);return this._point(l/h,u/h)}_mixPoints(t,e,s){const n=bs(t.x,e.x,s),i=bs(t.y,e.y,s);return this._point(n,i)}_getOrthogonal(t){return this._point(-t.y,t.x)}_getPointOnLine(t,e,s,n,i){return e?s?this._getPointOnCubicCurve(t,e,s,n,i):this._getPointOnQuadraticCurve(t,e,n,i):this._mixPoints(t,n,i)}_getPointOnQuadraticCurve(t,e,s,n){const i=Wl(t.x,e.x,s.x,n),r=Wl(t.y,e.y,s.y,n);return this._point(i,r)}_getPointOnCubicCurve(t,e,s,n,i){const r=gS(t.x,e.x,s.x,n.x,i),o=gS(t.y,e.y,s.y,n.y,i);return this._point(r,o)}_getTFromLengthOnCubicCurve(t,e,s,n,i,r=!0){if(!r)return 1-this._getTFromLengthOnCubicCurve(n,s,e,t,i,!0);let o=0,a=1,l=0;for(let u=0;u<10;u++){const h=(o+a)/2,g=h,f=this._getPointOnCubicCurve(t,e,s,n,g),p=Math.hypot(t.x-f.x,t.y-f.y);if(Math.abs(p-i)<.01)return h;p<i?(o=h,l=h):a=h}return l}_getTFromLengthOnQuadraticCurve(t,e,s,n){let i=t.x,r=t.y,o=0,a=0;for(let l=0;l<mi;++l){o+=pS;const u=Wl(t.x,e.x,s.x,o),h=Wl(t.y,e.y,s.y,o),g=u-i,f=h-r,p=Math.sqrt(g*g+f*f),y=a+p;if(y>n)return o-pS*((y-n)/p);a=y,i=u,r=h}return 1}};function _O(t,e,s){const n=Math.abs(t)/Kf+ep,i=n*n,r=s-.5,o=r*r,a=1/(16*i),l=Math.sqrt(o+a),u=.5/n*Math.sqrt(i+.25);return Math.abs(2*n)*(r*l+.5*u+a*Math.log(Math.abs((r+l)/(-.5+u))))*e}function yO(t,e,s,n,i){const r=(t.x+e.x+s.x)/3,o=(t.y+e.y+s.y)/3,a=r-e.x,l=o-e.y,u=e.x-s.x,h=e.y-s.y,g=a*a+l*l,f=(u*u+h*h)/4,p=Math.sqrt(g-f);return 2*J2*p*3.14159265359*i}function xO(t,e,s,n,i,r){const o=[];if(s&&o.push(0,s),i&&r){const a=i*e,l=r*e,u=a+l,h=t-n-s-u;let g=0;for(;g<h;)o.push(a,l),g+=u;const f=t-n-s-g,p=Math.min(a,f),y=Math.max(f-p,0);o.push(p,y)}else o.push(t-n-s,0);return n&&o.push(0,n),o}var Zl=0,zd=1,Dd=2,wa=3,mS=4,m0=0,Fy=1,vO={[Zl]:{min:"NEAREST",mag:"NEAREST",mipmap:!1},[zd]:{min:"LINEAR",mag:"LINEAR",mipmap:!1},[Dd]:{min:"LINEAR",mag:"LINEAR",mipmap:!1},[wa]:{min:"LINEAR_MIPMAP_LINEAR",mag:"LINEAR",mipmap:!0}},bO={[m0]:"ALPHA",[Fy]:"RGBA"};function gu(t){return Math.ceil((t+2*Wo)/Hn)*Hn}function EO(t,e,s,n,i){for(let r=0,o=t.length;r<o;++r){const a=t[r],l=a.x,u=a.y,h=l+n,g=u+i;let f=h<s&&g<s;if(f){for(let p=l;p<h;++p)if(e[p+u*s]===1){f=!1;break}}if(f){for(let p=u;p<g;++p)if(e[l+p*s]===1){f=!1;break}}if(f){for(let p=l;p<h;++p)for(let y=u;y<g;++y)e[p+y*s]=1;return t.splice(r,1),t.push({x:l,y:g},{x:h,y:u}),a}}return null}function _S(t,e,s,n,i,r,o){const a=4*t,l=e>>1<<7,u=e%2<<7;o[a]=s/Hn,o[a+1]=n/Hn,o[a+2]=l+i/Hn,o[a+3]=u+r/Hn}function SO(t,e,s,n,i,r,o){n|=0,i|=0,r|=0,o|=0,e|=0;for(let a=0;a<r;++a)for(let l=0;l<o;++l){const u=4*(n+a+(i+l)*e),h=4*(a+l*r);t[u]=s[h],t[u+1]=s[h+1],t[u+2]=s[h+2],t[u+3]=s[h+3]}}function AO(t,e){let s=0,n=4;for(let r=0;r<t.length;++r){const{width:o,height:a}=t[r],l=gu(o),u=gu(a);s+=l*u,n=Math.max(n,Math.max(l,u))}const i=Vo(Math.max(n,Math.sqrt(s)));return Math.min(i,e)}function yS(t,e){return Math.floor((e-t)/2)}function xS(t,e,s,n,i,r,o){const{min:a,mag:l,mipmap:u}=vO[r],h=t[bO[o]];if(o===m0){const g=new Uint8Array(i*i);for(let f=0;f<g.length;++f)g[f]=n[4*f+3];n=g}t.activeTexture(t.TEXTURE0+s),t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,h,i,i,0,h,t.UNSIGNED_BYTE,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[l]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[a]),u&&t.generateMipmap(t.TEXTURE_2D)}function PC(t,e,s,n,i){const r=new Uint8Array(s*s*4),o=Math.ceil(s/Hn),a=new Uint8Array(o*o),l=[{x:0,y:0}];for(let u=0;u<e.length;++u){const h=e[u],g=h.id,f=gu(h.width)/Hn,p=gu(h.height)/Hn,y=EO(l,a,o,f,p);if(y){const _=h.width,x=h.height,v=h.pixels,b=f*Hn,S=p*Hn,A=y.x*Hn+yS(_,b),w=y.y*Hn+yS(x,S);SO(r,s,v,A,w,_,x),_S(g,t,A,w,b,S,i)}else{if(s<n)return PC(t,e,2*s,n,i);$o(`exceeded max WebGL texture size of ${n}; some texts/icons/images won't be displayed`),_S(g,t,0,0,0,0,i)}}return{texture:r,size:s}}function wO(t,e,s,n){const{getDistanceFromStrokeVertically:i,getDistanceFromStrokeHorizontally:r}=t,o=e*(1-s)/2,a=(e-1)/2;for(let l=0;l<e;++l)for(let u=0;u<e;++u){const h=4*(u*e+l),g=(l-a)/o,f=(u-a)/o,p=qi(i(g,f),-1,1),y=qi(r(g,f),-1,1);TO(n,h,vS(p),vS(y))}}function vS(t){const e=(t+1)/2;return Math.floor(32768*e)}function TO(t,e,s,n){t[e]=s>>8,t[e+1]=s%256,t[e+2]=n>>8,t[e+3]=n%256}function zC(t,e){let s=-Math.PI/2;const n=2*Math.PI/t.length;for(const i of t){const r=s+n;e(i,s,r),s=r}}function DC(t,e,s,n,i){zC(e,((r,o,a)=>{t.beginPath(),t.moveTo(s,n),t.arc(s,n,i,o,a),t.fillStyle=r,t.fill()}))}var CO=!Pn().__dummy,LO=class extends FC{constructor(t){super(t),this._canvas=Pn(),this._imgCanvas=Pn(),this._initCanvas(this._canvas),this._ctx=this._canvas.getContext("2d"),this._imgCtx=this._imgCanvas.getContext("2d")}static getName(){return"Canvas"}static isAvailable(){return CO}getDomElement(){return this._canvas}_render({dimensionsChanged:t}){t&&oC(this._canvas,this._width,this._height,this._pixelRatio);const e=this._ctx,s=this._width*this._pixelRatio,n=this._height*this._pixelRatio;e.clearRect(0,0,s,n),this._backgroundColor&&this._renderBackground&&(e.fillStyle=this._backgroundColor,e.fillRect(0,0,s,n));const i=this._bufferList.getBuffersByAscendingDepth();for(const r of i)this._isBufferDisplayable(r)&&this._displayBuffer(r)}_drawRoundedRectangle(t,e,s,n,i){const r=this._ctx,o=this._pixelRatio,a=t.x*o,l=t.y*o;e*=o,s*=o;const u=this._textManager.getCornerRadius(),h=Math.min(u*o,s);e+=h/2,r.save(),r.translate(a,l),r.rotate(n),r.beginPath(),r.arc(e-h,s-h,h,0,Math.PI/2),r.arc(-e+h,s-h,h,Math.PI/2,Math.PI),r.arc(-e+h,-s+h,h,Math.PI,3*Math.PI/2),r.arc(e-h,-s+h,h,3*Math.PI/2,0),i&&(r.fillStyle=i,r.fill()),r.restore()}_drawCircle(t,e){const s=this._ctx,n=this._pixelRatio,i=t.x*n,r=t.y*n,o=e*n;s.beginPath(),s.arc(i,r,o,0,2*Math.PI)}_drawPolygon(t){const e=this._ctx,s=this._pixelRatio;e.beginPath();const n=t[0];e.moveTo(n.x*s,n.y*s);for(let i=1;i<t.length;++i){const r=t[i];e.lineTo(r.x*s,r.y*s)}e.closePath()}_drawStraightLine(t,e){const s=this._ctx,n=this._pixelRatio;s.beginPath(),s.moveTo(t.x*n,t.y*n),s.lineTo(e.x*n,e.y*n)}_drawQuadraticCurve(t,e,s){const n=this._ctx,i=this._pixelRatio;n.beginPath(),n.moveTo(t.x*i,t.y*i),n.quadraticCurveTo(e.x*i,e.y*i,s.x*i,s.y*i)}_drawCubicCurve(t,e,s,n){const i=this._ctx,r=this._pixelRatio;i.beginPath(),i.moveTo(t.x*r,t.y*r),i.bezierCurveTo(e.x*r,e.y*r,s.x*r,s.y*r,n.x*r,n.y*r)}_fill(t){const e=this._ctx;e.fillStyle=t,e.fill()}_stroke(t,e,s=[]){if(e===0)return;const n=this._ctx,i=this._pixelRatio;n.setLineDash(s.map((r=>r*this._pixelRatio))),n.lineWidth=e*i,n.strokeStyle=t,n.stroke()}_startClip(){this._ctx.save(),this._ctx.clip()}_endClip(){this._ctx.restore()}_startReverseClip(){this._ctx.save(),this._ctx.rect(0,0,this._canvas.width,this._canvas.height),this._ctx.clip("evenodd")}_endReverseClip(){this._ctx.restore()}_displayText(t,e,s,n,i,r,o,a,l,u,h){const g=this._ctx,f=this._pixelRatio,p=t.x*f,y=t.y*f,_=r*f,x=a==="center"?0:-l/2;if(h=h*this._viewZoom*f,u=u*this._viewZoom*f,g.save(),g.translate(p,y+f),g.rotate(-e),g.textBaseline="middle",g.textAlign=a,Zo(g,i,_,o),g.fillStyle=n,s.indexOf(`
`)!==-1){const v=s.split(`
`),b=v.length;let S=(1-b)/2*_;for(let A=0;A<b;++A)g.fillText(v[A],u+x,h+S),S+=_}else g.fillText(s,u+x,h);g.restore()}_displayImage(t,e,s,n,i,r,o){if(this._hideImages||"isDummy"in n)return;let a=n;o!==1&&(a=this._blendImageOnBackground(n,o));const l=this._ctx,u=this._pixelRatio,h=t.x*u,g=t.y*u,f=e*u,p=s*u,y=a.width*u,_=a.height*u;if(i)l.drawImage(a,h-f/2,g-p/2,f,p);else if(r){const x=h-f/2,v=g-p/2,b=h+f/2,S=g+p/2;let A=h-y/2,w=g-_/2;for(;A>x;)A-=y;for(;w>v;)w-=_;const L=w;for(;A<b;){for(;w<S;)l.drawImage(a,A,w,y,_),w+=_;A+=y,w=L}}else l.drawImage(a,h-y/2,g-_/2,y,_)}_displayPieChart(t,e,s){const n=this._ctx,i=this._pixelRatio,r=t.x*i,o=t.y*i,a=e*i*2,l=2*a;s.length===1&&(n.fillStyle=s[0],n.fillRect(r-a,o-a,l,l)),s.length>1&&DC(n,s,r,o,a)}_blendImageOnBackground(t,e){const s=this._backgroundRgba,n=`rgb(${Math.round(255*s[0])},${Math.round(255*s[1])},${Math.round(255*s[2])})`;return this._imgCanvas.width=t.width,this._imgCanvas.height=t.height,this._imgCtx.clearRect(0,0,t.width,t.height),this._imgCtx.globalAlpha=1,this._imgCtx.fillStyle=n,this._imgCtx.fillRect(0,0,t.width,t.height),this._imgCtx.globalAlpha=e,this._imgCtx.drawImage(t,0,0),this._imgCanvas}getImageData(){return this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)}},OC=!1;try{OC=!!ys("svg")}catch{}var nd="none",kO={left:"start",center:"middle",right:"end"},Vi="data-element-id",bS="data-text-component",NO="node-text",MO="edge-text",IO="badge-text";function Kl(t){return Math.round(1e3*t)/1e3}function ES(t,e,s,n,i,r){const o=ys("image");return o.setAttribute("width",Kl(n)),o.setAttribute("height",Kl(i)),o.setAttribute("x",Kl(e)),o.setAttribute("y",Kl(s)),o.setAttribute("href",t),r&&r.appendChild(o),o}function RO(t,e,s,n,i,r=1,o){const a=ys("rect");return a.setAttribute("x",t),a.setAttribute("y",e),a.setAttribute("width",s),a.setAttribute("height",n),a.setAttribute("fill",i),a.setAttribute("fill-opacity",r),o&&o.appendChild(a),a}var FO=class extends FC{constructor(t){super(t),this._svg=ys("svg"),this._defs=ys("defs"),this._styles=ys("g",{class:"styles"}),this._background=ys("rect",{width:"100%",height:"100%",fill:"none",class:"ogma-svg-background"}),this._currentElementId="0",this._currentClipPathId=null,this._clipPathCounter=0,this._defs.appendChild(this._styles),this._svg.setAttribute("pointer-events","none"),this._svg.style.userSelect="none",this._svg.appendChild(this._defs),this._svg.appendChild(this._background),this._clear()}static getName(){return"SVG"}static isAvailable(){return OC}getDomElement(){return this._svg}_render({dimensionsChanged:t}){if(t&&zx(this._svg,{width:this._width,height:this._height}),this._backgroundColor&&this._renderBackground){const s=Dl(this._backgroundColor);this._background.setAttribute("fill",s.color),this._background.setAttribute("fill-opacity",s.opacity)}const e=this._bufferList.getBuffersByAscendingDepth();this._clear(),this._svg.removeChild(this._container);for(let s=0;s<e.length;++s){const n=e[s];this._isBufferDisplayable(n)&&this._displayBuffer(n)}this._svg.appendChild(this._container)}_clear(){this._container&&this._svg.removeChild(this._container),this._container=ys("g"),this._svg.appendChild(this._container),this._clipPaths&&this._defs.removeChild(this._clipPaths),this._clipPaths=ys("g"),this._defs.appendChild(this._clipPaths),this._clipPaths.setAttribute("class","clip-paths"),this._filters&&this._defs.removeChild(this._filters),this._filters=ys("g"),this._defs.appendChild(this._filters)}_displayElement(t,e){this._currentElementId=t.id>=0?`n${t.id}`:"e"+-t.id,super._displayElement(t,e)}_addBackgroundBlendingFilter(t){const e=Wn(this._backgroundColor),s=t,n=1-t,i=[s,0,0,0,e[0]*n,0,s,0,0,e[1]*n,0,0,s,0,e[2]*n,0,0,0,1,0].join(" "),r=`filter-${this._currentElementId}`,o=ys("filter",{id:r}),a=ys("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:i});return o.appendChild(a),this._filters.appendChild(o),r}_drawRoundedRectangle(t,e,s,n,i){const r=t.x,o=t.y,a=Math.min(this._textManager.getCornerRadius(),s);e+=a/2;const l=ys("path"),u=`M ${r+e-a} ${o+s}     A ${a} ${a} 0 0 0 ${r+e} ${o+s-a}     L ${r+e} ${o-s+a}     A ${a} ${a} 0 0 0 ${r+e-a} ${o-s}     L ${r-e+a} ${o-s}     A ${a} ${a} 0 0 0 ${r-e} ${o-s+a}     L ${r-e} ${o+s-a}     A ${a} ${a} 0 0 0 ${r-e+a} ${o+s}     L ${r+e-a} ${o+s}`;l.setAttribute("d",u),l.setAttribute("fill",nd),l.setAttribute("transform",`rotate(${py(n)} ${t.x} ${t.y})`),l.setAttribute(Vi,this._currentElementId),this._container.appendChild(l),this._element=l,i&&this._fill(i)}_drawCircle(t,e){const{x:s,y:n}=t,i=`M ${s-e}, ${n} a ${e},${e} 0 1,0 ${2*e},0 a ${e},${e} 0 1,0 -${2*e},0`,r=ys("path");r.setAttribute("d",i),r.setAttribute("fill",nd),r.setAttribute(Vi,this._currentElementId),this._container.appendChild(r),this._element=r}_drawPolygon(t,e){const s=ys("path");let n="";for(let i=0;i<t.length;i++){const{x:r,y:o}=t[i];n+=`${i===0?"M":"L"}${r},${o} `}n+="Z",s.setAttribute("d",n),s.setAttribute(Vi,this._currentElementId),s.setAttribute("fill",nd),e&&s.setAttribute(bS,!0),this._container.appendChild(s),this._element=s}_drawStraightLine(t,e){const s=ys("path"),n=`M ${t.x},${t.y} L${e.x},${e.y}`;s.setAttribute("d",n),s.setAttribute(Vi,this._currentElementId),this._container.appendChild(s),this._element=s}_drawQuadraticCurve(t,e,s){const n=ys("path"),i=`M ${t.x},${t.y} Q${e.x},${e.y} ${s.x},${s.y}`;n.setAttribute("d",i),n.setAttribute("fill",nd),n.setAttribute(Vi,this._currentElementId),this._container.appendChild(n),this._element=n}_drawCubicCurve(t,e,s,n){const i=ys("path"),r=`M ${t.x},${t.y} C${e.x},${e.y} ${s.x},${s.y} ${n.x},${n.y}`;i.setAttribute("d",r),i.setAttribute("fill",nd),i.setAttribute(Vi,this._currentElementId),this._container.appendChild(i),this._element=i}_fill(t){const e=Dl(t);this._element.setAttribute("fill",e.color),this._element.setAttribute("fill-opacity",e.opacity),this._currentClipPathId&&this._element.setAttribute("clip-path",`url(#${this._currentClipPathId})`)}_stroke(t,e,s=[]){if(e===0)return;const n=this._element;n.setAttribute("stroke-width",e);const i=Dl(t);n.setAttribute("stroke",i.color),n.setAttribute("stroke-opacity",i.opacity),s.length>0&&n.setAttribute("stroke-dasharray",s.map(Kl).toString())}_startClip(){const t=ys("clipPath"),e=this._element.cloneNode(!1);this._currentClipPathId="clip-path-"+ ++this._clipPathCounter,t.appendChild(e),this._clipPaths.appendChild(t),t.setAttribute("id",this._currentClipPathId)}_endClip(){this._currentClipPathId=null}_startReverseClip(){const t=ys("clipPath"),e=this._element.cloneNode(!1),s=e.getAttribute("d");e.setAttribute("clip-rule","evenodd"),e.setAttribute("d",`${s} M 0 0 L ${this._width} 0 L ${this._width} ${this._height} L 0 ${this._height}`),this._currentClipPathId="clip-path-"+ ++this._clipPathCounter,t.appendChild(e),this._clipPaths.appendChild(t),t.setAttribute("id",this._currentClipPathId)}_endReverseClip(){this._currentClipPathId=null}_displayText(t,e,s,n,i,r,o="normal",a,l,u,h,g){const f=ys("g");f.setAttribute(Vi,this._currentElementId),f.setAttribute(bS,!0);let p=this._currentElementId[0]==="n"?NO:MO;g&&(p+=" "+IO),f.setAttribute("class",p);const y=Dl(n),_=y.opacity,x=Dl(y.color),v=t.x+u*this._viewZoom,b=t.y+1+h*this._viewZoom,S=Kl(v);if(f.setAttribute("font-family",i),f.setAttribute("font-size",r),o==="normal"||o==="italic")f.setAttribute("font-style",o);else if(o.includes("italic")){f.setAttribute("font-style","italic");const F=o.replace("italic","").trim();F&&f.setAttribute("font-weight",F)}else f.setAttribute("font-weight",o);f.setAttribute("fill",x.color),f.setAttribute("fill-opacity",_),e&&f.setAttribute("transform",`rotate(${py(-e)} ${v}, ${b})`),f.setAttribute("text-anchor",kO[a]||"middle"),f.setAttribute("dominant-baseline","middle");const A=s.split(`
`),w=A.length,L=b-(w+1)/2*r,I=a==="center"?0:-l/2;for(let F=0;F<w;F++){const O=ys("text");O.appendChild(Ox(A[F])),O.setAttribute("x",S+I),O.setAttribute("y",L+(F+1)*r),f.appendChild(O)}this._currentClipPathId&&f.setAttribute("clip-path",`url(#${this._currentClipPathId})`),this._container.appendChild(f)}_displayImage(t,e,s,n,i,r,o){const a=t.x,l=t.y;if(this._hideImages||!("isDummy"in n)&&(!n.width||!n.height))return;const u=e,h=s;let g,f=n.width,p=n.height;if(i&&(f=u,p=h),r){const y=a-u/2,_=l-h/2,x=a+u/2,v=l+h/2;let b=a-f/2,S=l-p/2;for(g=ys("g"),g.setAttribute(Vi,this._currentElementId);b>y;)b-=f;for(;S>_;)S-=p;const A=S;for(;b<x;){for(;S<v;)ES(n.src,b,S,f,p,g),S+=p;S=A,b+=f}}else g=ES(n.src,a-f/2,l-p/2,f,p),g.setAttribute(Vi,this._currentElementId);if(this._currentClipPathId&&g.setAttribute("clip-path",`url(#${this._currentClipPathId})`),o!==1){const y=this._addBackgroundBlendingFilter(o);g.setAttribute("filter",`url(#${y})`)}this._container.appendChild(g)}_displayPieChart(t,e,s){const n=2*e,i=2*n,r=t.x,o=t.y;let a;const l=ys("g");l.setAttribute(Vi,this._currentElementId),s.length===1&&(a=RO(r-n,o-n,i,i,s[0],1,l)),s.length>1&&zC(s,((u,h,g)=>{const f=r+e*Math.cos(g),p=o+e*Math.sin(g),y=r+e*Math.cos(h),_=o+e*Math.sin(h),x=g-h<=Math.PI?0:1,v=`M ${f},${p} A ${e},${e} 0 ${x} 0 ${y},${_} L ${r},${o} L ${f},${p}`;a=ys("path"),a.setAttribute("d",v),a.setAttribute("fill",u),a.setAttribute("stroke-width",0),l.appendChild(a)})),this._currentClipPathId&&l.setAttribute("clip-path",`url(#${this._currentClipPathId})`),this._container.appendChild(l)}},PO=6,zO=class{constructor({gl:t,ext:e,staticProgram:s,animationProgram:n}){this._version=0,this._used=!1,this._dataBufferChanged=!1,this._gl=t,this._ext=e,this._staticProgram=s,this._animationProgram=n,this._glBuffer=this._gl.createBuffer()}setDataBuffer(t){this._dataBuffer!==t&&(this._program=t.animated?this._animationProgram:this._staticProgram,this._dataBuffer=t,this._dataBufferChanged=!0,t.hasSideData()&&!this._sideGlBuffer?this._sideGlBuffer=this._gl.createBuffer():!t.hasSideData()&&this._sideGlBuffer&&(this._gl.deleteBuffer(this._sideGlBuffer),delete this._sideGlBuffer))}setPrograms(t,e){this._staticProgram=t,this._animationProgram=e}markAsUnused(){return this._used=!1,this}getProgram(){return this._program}markAsUsed(){return this._used=!0,this}isUsed(){return this._used}draw(){const t=this._gl,e=this._dataBuffer.type,s=e===Pa,n=s?this._dataBuffer.getNbSideElementsPerMainElement():1,i=e===xf?mi:1,r=this._dataBuffer.getSize(),o=this._dataBuffer.stencilUsage,a=this._dataBuffer.version,l=this._version!==a||this._dataBufferChanged;this._program.setupBaseAttributes({glBuffer:this._glBuffer,dataBuffer:l?this._dataBuffer.getByteArray():null,divisor:n}),this._program.setupTextAttributes({glBuffer:this._sideGlBuffer,dataBuffer:l&&s?this._dataBuffer.getSideByteArray():null,divisor:1}),this._program.setupStencil(o),l&&(this._version=a,this._dataBufferChanged=!1),this._ext.drawArraysInstancedANGLE(t.TRIANGLES,0,PO*i,r*n)}destroy(){this._gl.deleteBuffer(this._glBuffer),this._sideGlBuffer&&this._gl.deleteBuffer(this._sideGlBuffer)}},DO={byte:1,ubyte:1,short:2,ushort:2,ulong:4,float:4},OO={byte:"BYTE",ubyte:"UNSIGNED_BYTE",short:"SHORT",ushort:"UNSIGNED_SHORT",ulong:"UNSIGNED_LONG",float:"FLOAT"},SS=class{constructor({gl:t,ext:e,specialGlBuffers:s,metaData:n,programWrapper:i}){this._stencilUsage=eu,this._gl=t,this._ext=e,this._specialGlBuffers=s,this._metaData=Xs(n),this._programWrapper=i}_finishInit(){const t=this._gl,e=this._ext,s=this._programWrapper.getError();if(s)throw new Error(`WebGL compilation at step "${s.step}:
${s.message}"`);const n=this._programWrapper.getProgram();this._program=n,t.useProgram(n),this._metaData.attributes.forEach((o=>{o.location=t.getAttribLocation(this._program,o.name),o.byteSize=o.size*DO[o.type],o.glType=OO[o.type]})),this._specialAttributes=this._createSpecialAttributesFunctions();const i=[],r=[];for(const o of this._metaData.attributes)o.location!==-1&&(o.name.startsWith("a_text")?r.push(o):i.push(o));this._baseAttributes=n_(i,t,e),this._textAttributes=n_(r,t,e),this._setupUniforms=UO(this._metaData.uniforms,t,n)}_createSpecialAttributesFunctions(){return n_([{location:this._gl.getAttribLocation(this._program,this._metaData.vertexInfoAttribute),size:3,glType:"BYTE",byteSize:3,type:"byte",name:"special"}],this._gl,this._ext)}startPass(t){this._program||this._finishInit(),this._gl.useProgram(this._program),this._resetStencil(),this._setupUniforms(this._gl,t),this._specialAttributes.enable(this._gl),this._specialAttributes.setup(this._specialGlBuffers.vertexInfo,null,0)}_setupAttributes(t,{glBuffer:e,dataBuffer:s,divisor:n}){t.enabled&&!e?t.disable(this._gl):!t.enabled&&e&&t.enable(this._gl),e&&t.setup(e,s,n)}setupBaseAttributes(t){this._setupAttributes(this._baseAttributes,t)}setupTextAttributes(t){this._setupAttributes(this._textAttributes,t)}_resetStencil(){const t=this._gl;this._stencilUsage=eu,t.disable(t.STENCIL_TEST)}setupStencil(t){if(t!==this._stencilUsage){const e=this._gl;t!==eu?(e.enable(e.STENCIL_TEST),t===iC?(e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.stencilFunc(e.ALWAYS,1,1)):t===rC&&(e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.stencilFunc(e.EQUAL,0,1))):e.disable(e.STENCIL_TEST),this._stencilUsage=t}}endPass(){const t=this._gl;this._specialAttributes.disable(t),this._baseAttributes.disable(t),this._textAttributes.disable(t)}};function BO(t,e,s){return(n,i,r)=>{let o=0,a=0;for(let l=0;l<t.length;l++)a+=t[l].byteSize;e.bindBuffer(e.ARRAY_BUFFER,n),i&&e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW);for(let l=0;l<t.length;l++){const{location:u,size:h,glType:g,byteSize:f}=t[l];e.vertexAttribPointer(u,h,e[g],!1,a,o),o+=f,s.vertexAttribDivisorANGLE(u,r)}}}function UO(t,e,s){const n={};for(let i=0;i<t.length;++i){const{id:r,name:o}=t[i],a=e.getUniformLocation(s,o);a&&(n[r]=a)}return(i,r)=>{for(let o=0;o<t.length;++o){const{id:a,type:l}=t[o],u=n[a],h=r[a];if(u)switch(l){case"int":case"sampler2D":i.uniform1i(u,h);break;case"float":i.uniform1f(u,h);break;case"vec2":i.uniform2f(u,h[0],h[1]);break;case"vec3":i.uniform3f(u,h[0],h[1],h[2]);break;case"vec4":i.uniform4f(u,h[0],h[1],h[2],h[3])}}}}function GO(t){return e=>{for(let s=0;s<t.length;s++){const n=t[s].location;e.enableVertexAttribArray(n)}}}function VO(t){return e=>{for(let s=0;s<t.length;++s){const n=t[s].location;e.disableVertexAttribArray(n)}}}function n_(t,e,s){const n=GO(t),i=VO(t);return{enable(r){n(r),this.enabled=!0},disable(r){i(r),this.enabled=!1},setup:BO(t,e,s),enabled:!1}}var i_=`#define D3D9_FIX 0
precision highp float;
precision mediump int;
uniform vec3 u_backgroundColor;
uniform sampler2D u_patternNearestTexture;
uniform sampler2D u_patternLinearTexture;
uniform sampler2D u_patternLinearSdfTexture;
uniform sampler2D u_patternMipmapTexture;
uniform sampler2D u_shapeTexture;
varying vec4 a;
varying vec4 b;
varying vec4 c;
varying vec2 d;
varying vec2 e;
varying vec4 f;
varying float g;
#if D3D9_FIX
#else
varying float l;
varying vec2 m;
varying vec2 n;
varying vec2 o;
varying float p;
varying float q;
varying vec2 r;
varying vec2 s;
varying float t;
varying float u;
#endif
const float FILTER_NEAREST = 0.0;
const float FILTER_LINEAR = 0.0;
const float FILTER_LINEAR_SDF = 0.0;
const float FILTER_MIPMAP = 0.0;
const float SDF_GAMMA = 0.0;
const float EPSILON = 0.000000001;
const float SDF_BUFFER = (256.0 - 64.0) / 256.0; 
vec4 af(in vec4 ag, in vec4 ah) {
float ai = ah.a;
float aj = ag.a + EPSILON;
float ak = min(ai + aj, 1.0);
float r = ai / ak;
return vec4(mix(ag.rgb, ah.rgb, r), ak);
}
float al(in float am, in float an) {
float ao = (am * 256.0 + an) * 256.0;
float ap = ao / 32768.0;
return ap * 2.0 - 1.0;
}
bool aq(float ar, float as) {
return abs(ar - as) < EPSILON;
}
float at(float au) {
float bh = 2.;
vec2 bi = abs(c.rg) - c.ba - vec2(bh) + vec2(au);
float bj = min(max(bi.x, bi.y), 0.0) + length(max(bi, 0.0)) - au;
return smoothstep(0.1, .5, (1. - bj) / 10.);
}
void main() {
#if D3D9_FIX
#else
float br = o.x;
float bs = o.y;
float bt = r.x;
float bu = r.y;
#endif
vec4 bx = texture2D(u_shapeTexture, d);
float by = al(bx.b, bx.a) * s.x;
float bz = al(bx.r, bx.g) * s.y;
float ch = float(f.z > EPSILON);
float ci = float(f.w > EPSILON);
float cj = 1. - smoothstep(
0.01,
0.25760,
distance(f.xy * f.z - vec2(0.0586), d * f.z)
);
cj = cj * 2.5 - 1.5;
cj *= 0.5;
cj *= s.x;
float ck = at(g) ;
vec4 cl = a;
vec4 cm = b;
if (u > -EPSILON) {
vec2 cq = e;
float dd =
step(m.x, cq.x) *
step(cq.x, n.x) *
step(m.y, cq.y) *
step(cq.y, n.y);
float de = dd;
vec4 dh;
if (aq(u, FILTER_NEAREST)) {
dh = texture2D(u_patternNearestTexture, cq);
} else if (aq(u, FILTER_LINEAR)) { 
dh = texture2D(u_patternLinearTexture, cq);
} else if (aq(u, FILTER_LINEAR_SDF)) { 
dh = texture2D(u_patternLinearSdfTexture, cq);
dh.a = smoothstep(SDF_BUFFER - t, SDF_BUFFER + t, dh.a);
} else if (aq(u, FILTER_MIPMAP)) { 
dh = texture2D(u_patternMipmapTexture, cq);
}
dh.rgb += c.rgb;
dh.a *= de;
cl = af(cl, dh);
}
float dw = (1. - ch) * min(by, bz)
+ ch * cj;
dw = (1. - ci) * dw + ci * ck;
float ek = clamp(dw, 0.0, 1.0);
float en = clamp(dw - l, 0.0, 1.0);
float eo = ek - en;
eo = 1.0 - clamp(dw - l, 0.0, 1.0);
cl.a *= en;
cm.a *= eo * step(EPSILON, l);
vec4 ew = af(cl, cm);
float ex = ek;
ew.rgb = mix(u_backgroundColor, ew.rgb, br);
if (q > EPSILON) {
float fk = fract(bu) * q;
float fl = clamp(min(fk, bt - fk), 0.0, 1.0);
ex *= fl;
}
if (p < 0.0 || p > 1.0 || ex < EPSILON) {
discard;
}
ew.a *= ex;
ew.rgb *= ew.a;
gl_FragColor = ew;
}
`,r_=`#define D3D9_FIX 0
#define ANIMATED 0
precision highp float;
precision mediump int;
attribute /*ushort*/ vec4 a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;
attribute /*ushort*/ vec4 a_final_patternId_fillRGBA_strokeRGBA_patternRGBA;
attribute /*float*/ vec4 a_final_x1_y1_x2_y2;
attribute /*ushort*/ vec4 a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;
attribute /*ushort*/ vec4 a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;
attribute /*ushort*/ vec4 a_final_offsetScaled_offsetFixed_paddingTop_paddingLeft;
attribute /*ushort*/ vec4 a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;
attribute /*ushort*/ vec4 a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA;
attribute /*float*/ vec4 a_prev_x1_y1_x2_y2;
attribute /*ushort*/ vec4 a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;
attribute /*ushort*/ vec4 a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;
attribute /*ushort*/ vec4 a_prev_offsetScaled_offsetFixed_paddingTop_paddingLeft;
attribute /*float*/ vec2 a_animationBeginTime_animationDuration; 
attribute /*ushort*/ vec4 a_animationEasing; 
attribute /*ushort*/ vec3 a_text_charId_charOffsetXY; 
attribute vec3 a_vertexInfo;
uniform float u_viewWidth;
uniform float u_viewHeight;
uniform float u_viewX;
uniform float u_viewY;
uniform float u_viewAngle;
uniform float u_viewZoom;
uniform float u_currentTime;
uniform float u_pixelRatio;
uniform sampler2D u_patternInfoTexture;
varying vec4 a;
varying vec4 b;
varying vec4 c;
varying vec2 d;
varying vec2 e;
varying float g;
#if D3D9_FIX
#else
varying float l;
varying vec2 m;
varying vec2 n;
varying vec2 o;
varying float p;
varying float q;
varying vec2 r;
varying vec2 s;
varying float t;
varying float u;
#endif
varying vec4 f;
const float EPSILON = 0.000001;
const float INFINITY = 10000000.0;
const float PI = 3.14159265359;
const float P2_17 = 131072.0;
const float P2_16 = 65536.0;
const float P2_14 = 32768.0;
const float P2_12 = 4096.0;
const float P2_8 = 256.0;
const float P2_7 = 128.0;
const float P2_6 = 64.0;
const float P2_5 = 32.0;
const float P2_4 = 16.0;
const float P2_3 = 8.0;
const float P2_2 = 4.0;
const float P2_1 = 2.0;
const float MAX_FLOAT16_OFFSET = 16384.0;
const float MAX_FLOAT16 = 65535.0;
const float MAX_PROGRESS = 1.0;
uniform float BYTES_TO_COORD;
uniform float BYTES_TO_SCALED_SIZE;
uniform float BYTES_TO_MIN_VISIBLE_SIZE;
uniform float BYTES_TO_SYMBOLIC_SIZE;
uniform float BYTES_TO_CURVATURE;
uniform float BYTES_TO_DASH_LENGTH;
uniform float BYTES_TO_GAP_LENGTH;
uniform float BYTES_TO_PATTERN_SCALE;
uniform float PATTERN_POSITION_UNIT_SIZE;
uniform float PATTERN_INFO_TEXTURE_SIZE;
uniform float PATTERN_NEAREST_TEXTURE_SIZE;
uniform float PATTERN_LINEAR_TEXTURE_SIZE;
uniform float PATTERN_LINEAR_SDF_TEXTURE_SIZE;
uniform float PATTERN_MIPMAP_TEXTURE_SIZE;
uniform float ROUNDED_BOX_RADIUS;
const float BYTES_TO_OFFSET_ANGLE = 0.0;
const float BYTES_TO_COLOR = 0.0;
const float SDF_FONT_SIZE = 0.0;
const float SDF_GAMMA = 0.0;
const float CURVATURE_RATIO = 0.0;
const float PATTERN_PADDING = 0.0;
const float TEXT_WIDTH_MULTIPLIER = 0.0;
const float TEXT_HEIGHT_MULTIPLIER = 0.0;
const float SELF_LOOP_CURVATURE_RATIO = 0.0;
const float EDGE_ARROW_SIZE_RATIO = 0.0;
const float EDGE_MIN_TIP_SIZE = 0.0;
const float CURVE_SUBDIVISIONS = 0.0;
const float PIECE_NODE_COMPONENT = 0.0;
const float PIECE_TEXT_BOX = 0.0;
const float PIECE_EDGE_BODY = 0.0;
const float PIECE_EDGE_HEAD = 0.0;
const float PIECE_EDGE_TAIL = 0.0;
const float PIECE_EDGE_TEXT = 0.0;
const float MAX_TEXT_SIZE = 0.0;
const float BYTES_TO_TEXT_OFFSET_X = 0.0;
const float BYTES_TO_TEXT_OFFSET_Y = 0.0;
const float FILTER_NEAREST = 0.0;
const float FILTER_LINEAR = 0.0;
const float FILTER_LINEAR_SDF = 0.0;
const float FILTER_MIPMAP = 0.0;
const float SHAPE_TEXTURE_SIZE = 0.0;
const float SIMPLE_SHAPE_SAMPLING_SIZE = 0.0;
const float COMPLEX_SHAPE_SAMPLING_SIZE = 0.0;
const float SHAPE_SAMPLING_BUFFER_RATIO = 0.0;
const float MAX_SHAPES = 0.0;
const float FIRST_COMPLEX_SHAPE_ID = 0.0;
const float SELF_LOOP_TO_CIRCLE_APPROX = 0.0;
const float NB_SHAPES_BY_SIDE = SHAPE_TEXTURE_SIZE / COMPLEX_SHAPE_SAMPLING_SIZE;
const float SHAPE_FILL_PERCENT = 1.0 - SHAPE_SAMPLING_BUFFER_RATIO;
const float T_STEP_PER_CURVE_PIECE = 1.0 / CURVE_SUBDIVISIONS;
const float HEAD_TAIL_PX_ADJUST = 1.5;
const float SDF_SMOOTH_FACTOR = 2.0;
struct pv {
float pw;
float px;
float py;
float pz;
float qa;
float qb;
float qc;
float qd;
};
struct qe {
float qf;
float qg;
float qh;
float qi;
float qj;
float qk;
float ql;
};
struct qm {
float pw;
float px;
float py;
float pz;
float qa;
float qb;
float qc;
float qd;
float qf;
float qg;
float qh;
float qi;
float qj;
float qk;
float ql;
float dc;
float qn;
float qo;
float qp;
float qq;
float qr;
float qs;
vec4 cl;
vec4 cm;
vec4 dh;
float qt;
float qu;
float qv;
float qw;
float qx;
float qy;
float qz;
float ra;
float rb;
float rc;
float rd;
float re;
float rf;
float rg;
float rh;
float ri;
float rj;
float rk;
float rl;
};
struct rm {
float eu;
vec2 rn;
vec4 cl;
vec4 cm;
float dc;
float ro;
float rp;
float py;
float rq;
vec2 rr;
float rs;
vec2 cq;
vec2 rt;
vec2 ru;
float rv;
float rw;
vec4 dh;
vec2 bd;
float rx;
float or;
vec2 ry;
vec2 rz;
vec2 sa;
};
float sb(float nq, float sc, float sd) {
float se = mod(nq, pow(2.0, sd));
return floor(se / pow(2.0, sc));
}
pv sf(float nq) {
pv sg;
sg.pw = sb(nq, 0.0, 4.0);
sg.px = sb(nq, 4.0, 8.0);
sg.py = sb(nq, 8.0, 10.0);
sg.pz = sb(nq, 10.0, 12.0);
sg.qa = sb(nq, 12.0, 13.0);
sg.qb = sb(nq, 13.0, 14.0);
sg.qc = sb(nq, 14.0, 15.0);
sg.qd = sb(nq, 15.0, 16.0);
return sg;
}
qe sh(float nq) {
qe sg;
sg.qf = sb(nq, 0.0, 8.0);
sg.qg = sb(nq, 8.0, 11.0);
sg.qh = sb(nq, 11.0, 12.0);
sg.qi = sb(nq, 12.0, 13.0);
sg.qj = sb(nq, 13.0, 14.0);
sg.qk = sb(nq, 14.0, 15.0);
sg.ql = sb(nq, 15.0, 16.0);
return sg;
}
float si(float ll) {
float sj = mod(floor(ll / 32768.0), 2.0) == 1.0 ? -1.0 : 1.0; 
float sl = mod(floor(ll / 1024.0), 32.0); 
float sn = mod(ll, 1024.0); 
float sq = float(sl == 0.0 || sl == 31.0);
return (1. - sq)
* sj * pow(2.0, sl - 15.0) * (1.0 + sn / 1024.0);
}
vec4 sr(in float nq) {
return vec4(
sb(nq, 0.0, 4.0),
sb(nq, 4.0, 8.0),
sb(nq, 8.0, 12.0),
sb(nq, 12.0, 16.0)
);
}
vec2 ss(in float nq) {
return vec2(mod(nq, 256.0), floor(nq / 256.0));
}
vec2 st(in float nq) {
float su = floor(nq / P2_6);
float sv = nq - (su * P2_6);
return vec2(su, sv);
}
vec2 sw(in float nq) {
float sx = floor(nq / P2_7);
float sy = nq - (sx * P2_7);
return vec2(sx, sy);
}
vec2 sz(in vec2 ta, in float tb) {
float tc = cos(tb);
float td = sin(tb);
return vec2(tc * ta.x + td * ta.y, -td * ta.x + tc * ta.y);
}
vec4 te(in vec4 tf) {
return floor(tf / 256.0) - 128.0;
}
vec4 tg(in vec4 tf) {
return mod(tf, 256.0) - 128.0;
}
float th(float nq) {
return nq - 128.0;
}
vec2 th(vec2 nq) {
return nq - 128.0;
}
vec2 ti(vec2 tj) {
return vec2(-tj.y, tj.x);
}
vec2 tk(vec2 tl, vec2 ih, vec2 tm, float t) {
float tn = 1.0 - t;
return (tn * tn * tl) + (2.0 * tn * t * ih) + (t * t * tm);
}
vec2 to(vec2 tl, vec2 tp, vec2 tq, vec2 tm, float t) {
float tn = 1.0 - t;
float tr = tn * tn;
float ts = tr * tn;
float tt = t * t;
float tu = tt * t;
return (ts * tl) + (3.0 * tr * t * tp) + (3.0 * tn * tt * tq) + (tu * tm);
}
vec2 tv(vec2 tl, vec2 ih, vec2 tm, float t) {
float tn = (1.0 - t);
vec2 ta = (tn * ih + t * tm) - (tn * tl + t * ih);
return normalize(ta);
}
vec2 tw(vec2 tl, vec2 ih, vec2 tm, float t) {
return ti(tv(tl, ih, tm, t));
}
vec2 tx(vec2 tl, vec2 tp, vec2 tq, vec2 tm, float t) {
float tn = 1.0 - t;
float tr = tn * tn;
float tt = t * t;
vec2 ta = tr * (tp - tl) + 2.0 * tn * t * (tq - tp) + tt * (tm - tq);
return normalize(ta);
}
vec2 ty(vec2 tl, vec2 tp, vec2 tq, vec2 tm, float t) {
return ti(tx(tl, tp, tq, tm, t));
}
float uj(float qr, float uk, float t) {
float y = abs(qr) / CURVATURE_RATIO + EPSILON;
float qw = y * y;
float tn = t - 0.5;
float tr = tn * tn;
float ul = 1.0 / (16.0 * qw);
float um = sqrt(tr + ul);
float un = (0.5 / y) * sqrt(qw + 0.25);
float uo = (abs(2.0 * y)) * ((tn * um) + (0.5 * un) + (ul * log(abs((tn + um) / (-0.5 + un)))));
return uo * uk;
}
float uz(vec2 va, vec2 vb, vec2 vc, vec2 vd) {
bool vk = abs(va.x - vb.x - vc.x + vd.x) + abs(va.y - vb.y - vc.y + vd.y) < EPSILON;
float vl = 9.0 * pow(vb.x - va.x, 2.0); 
float vo = pow(-243.0 * va.x + 189.0 * vb.x + 51.0 * vc.x + 3.0 * vd.x, 2.0) / 10000.0; 
float vp = pow(-48.0 * va.x + 24.0 * vb.x + 21.0 * vc.x + 3.0 * vd.x, 2.0) / 625.0; 
float vq = pow(-147.0 * va.x + 21.0 * vb.x + 99.0 * vc.x + 27.0 * vd.x, 2.0) / 10000.0; 
float vr = pow(-27.0 * va.x - 9.0 * vb.x + 24.0 * vc.x + 12.0 * vd.x, 2.0) / 625.0; 
float vs = (9.0 / 16.0) * pow(vc.x + vd.x - va.x - vb.x, 2.0); 
float vt = 9.0 * pow(vb.y - va.y, 2.0); 
float vv = pow(-243.0 * va.y + 189.0 * vb.y + 51.0 * vc.y + 3.0 * vd.y, 2.0) / 10000.0; 
float vw = pow(-48.0 * va.y + 24.0 * vb.y + 21.0 * vc.y + 3.0 * vd.y, 2.0) / 625.0; 
float vx = pow(-147.0 * va.y + 21.0 * vb.y + 99.0 * vc.y + 27.0 * vd.y, 2.0) / 10000.0; 
float vy = pow(-27.0 * va.y - 9.0 * vb.y + 24.0 * vc.y + 12.0 * vd.y, 2.0) / 625.0; 
float vz = (9.0 / 16.0) * pow(vc.y + vd.y - va.y - vb.y, 2.0); 
float wa = sqrt(vl + vt); 
float wc = sqrt(vo + vv); 
float wd = sqrt(vp + vw); 
float we = sqrt(vq + vx); 
float wf = sqrt(vr + vy); 
float wg = sqrt(vs + vz); 
if(vk)
return (5.0 / 2993760.0) *
(32134.0 * wa +
212600.0 * wc -
97050.0 * wd +
544800.0 * we -
521100.0 * wf +
427368.0 * wg);
float wh = pow(-12.0 * va.x - 24.0 * vb.x + 9.0 * vc.x + 27.0 * vd.x, 2.0) / 625.0; 
float wi = pow(-27.0 * va.x - 99.0 * vb.x - 21.0 * vc.x + 147.0 * vd.x, 2.0) / 10000.0; 
float wj = pow(-3.0 * va.x - 21.0 * vb.x - 24.0 * vc.x + 48.0 * vd.x, 2.0) / 625.0; 
float wk = pow(-3.0 * va.x - 51.0 * vb.x - 189.0 * vc.x + 243.0 * vd.x, 2.0) / 10000.0; 
float wl = 9.0 * pow(vd.x - vc.x, 2.0); 
float wm = pow(-12.0 * va.y - 24.0 * vb.y + 9.0 * vc.y + 27.0 * vd.y, 2.0) / 625.0; 
float wn = pow(-27.0 * va.y - 99.0 * vb.y - 21.0 * vc.y + 147.0 * vd.y, 2.0) / 10000.0; 
float wo = pow(-3.0 * va.y - 21.0 * vb.y - 24.0 * vc.y + 48.0 * vd.y, 2.0) / 625.0; 
float wp = pow(-3.0 * va.y - 51.0 * vb.y - 189.0 * vc.y + 243.0 * vd.y, 2.0) / 10000.0; 
float wq = 9.0 * pow(vd.y - vc.y, 2.0); 
float wr = sqrt(wh + wm); 
float ws = sqrt(wi + wn); 
float wt = sqrt(wj + wo); 
float wu = sqrt(wk + wp); 
float wv = sqrt(wl + wq); 
return (5.0 / 2993760.0) *
(16067.0 * (wa + wv) +
106300.0 * (wc + wu) -
48525.0 * (wd + wt) +
272400.0 * (we + ws) -
260550.0 * (wf + wr) +
427368.0 * wg);
}
float ww(float nq) {
return nq - 32.0;
}
float wx(float nq) {
return nq - 512.0;
}
float wy(float nq) {
return nq - P2_14;
}
void wz() {
gl_Position = vec4(-10.0, -10.0, 1.0, 1.0);
}
vec4 xa(vec2 xb) {
return vec4(((vec2(xb.x, u_viewHeight - xb.y) / vec2(u_viewWidth, u_viewHeight)) * 2.0 - 1.0), 0.5, 1.0);
}
float xf(float ar, float as) {
return step(ar - EPSILON, as) * step(as, ar + EPSILON);
}
bool aq(float ar, float as) {
return abs(ar - as) < EPSILON;
}
bool xg(float nq) {
return nq > 0.5;
}
vec2 xh(vec2 xi) {
return sz((xi - vec2(u_viewX, u_viewY)) * u_viewZoom, u_viewAngle) + vec2(u_viewWidth, u_viewHeight) / 2.0;
}
float xj(float or) {
return max(EDGE_MIN_TIP_SIZE, or * EDGE_ARROW_SIZE_RATIO);
}
float xk(float xl, float xm) {
return xl * BYTES_TO_SCALED_SIZE * u_viewZoom + xm;
}
float xn(float xl, float xm) {
return xl * BYTES_TO_SCALED_SIZE * MAX_FLOAT16 / MAX_FLOAT16_OFFSET * u_viewZoom + xm;
}
float xo(float xl, float xm) {
return min(xl * BYTES_TO_SCALED_SIZE * MAX_FLOAT16 / MAX_FLOAT16_OFFSET * u_viewZoom, xm);
}
float xu(float ro, float xs, float xt) {
float xv = xt - xs;
float a = 1.0 / xv;
float b = -xs / xv;
return ro * a + b;
}
struct xw {
vec2 vb;
vec2 vc;
};
xw xx(vec2 xy, float au, float qr) {
xw ns;
float xz = (au + au / SELF_LOOP_CURVATURE_RATIO * qr) * SELF_LOOP_CURVATURE_RATIO;
float ya = -u_viewAngle + PI;
float yb = -u_viewAngle + PI / 2.0;
ns.vb = xy + vec2(cos(ya), sin(ya)) * xz;
ns.vc = xy + vec2(cos(yb), sin(yb)) * xz;
return ns;
}
float yc(vec2 yd, vec2 ye, vec2 yf, vec2 yg, float yh) {
const int MAX_ITERATIONS = 10; 
const float EPSILON = 0.01; 
float yo = 0.0;
float cf = 1.0;
float yp = 0.0;
for (int yq = 0; yq < MAX_ITERATIONS; yq++) {
float yr = (yo + cf) * 0.5;
vec2 ys = to(yd, ye, yf, yg, yr);
float yt = distance(yd, ys);
if (abs(yt - yh) < EPSILON) {
return yr;
}
if (yt < yh) {
yo = yr;
yp = yr;
} else {
cf = yr;
}
}
return yp;
}
float za(vec2 yd, vec2 ye, vec2 yf, vec2 yg, float yh, bool zb) {
if (!zb) {
return 1.0 - yc(yg, yf, ye, yd, yh);
}
return yc(yd, ye, yf, yg, yh);
}
qm ze(
vec4 zf,
vec4 zg,
vec4 zh,
vec4 zi,
vec4 zj,
vec4 zk,
vec3 zl
) {
qm a;
pv bx = sf(zf.x);
qe zm = sh(zf.y);
vec4 zn = sr(zf.z);
vec2 zo = ss(zf.w);
a.pw = bx.pw;
a.px = bx.px;
a.py = bx.py;
a.pz = bx.pz;
a.qa = bx.qa;
a.qb = bx.qb;
a.qc = bx.qc;
a.qd = bx.qd;
a.qf = zm.qf;
a.qg = zm.qg;
a.qh = zm.qh;
a.qi = zm.qi;
a.qj = zm.qj;
a.qk = zm.qk;
a.ql = zm.ql;
a.dc = zn.x;
a.qn = zn.y;
a.qo = zn.z;
a.qp = zn.w;
a.qq = zo.x;
a.qr = zo.y;
a.qs = zg.x;
a.cl = sr(zg.y);
a.cm = sr(zg.z);
a.dh = sr(zg.w);
a.qt = zh.x;
a.qu = zh.y;
a.qv = zh.z;
a.qw = zh.w;
a.qx = si(zi.x);
a.qy = zi.y;
a.qz = si(zi.z);
a.ra = zi.w;
a.rb = zj.x;
a.rc = zj.y;
a.rd = zj.z;
a.re = zj.w;
a.rf = zk.x;
a.rg = wy(zk.y);
a.rk = wy(zk.z);
a.rl = wy(zk.w);
a.rh = zl.x;
float x = zl.y;
float y = mod(x, P2_8);
if (zl.z > 0.0) x += zl.z * P2_16;
a.ri = ((x - y) / P2_8) - P2_16;
a.rj = (y - P2_7) * BYTES_TO_TEXT_OFFSET_Y;
return a;
}
bool aar(const in qm a, out rm ns) {
float pw = a.pw;
float px = a.px;
float py = a.py * BYTES_TO_DASH_LENGTH;
float pz = a.pz * BYTES_TO_GAP_LENGTH;
float qa = a.qa;
float qb = a.qb;
float qc = a.qc;
float qd = a.qd;
float qf = a.qf * BYTES_TO_PATTERN_SCALE;
float qg = a.qg * BYTES_TO_OFFSET_ANGLE;
float qh = a.qh;
float qi = a.qi;
float qj = a.qj;
float qk = a.qk;
float ql = a.ql;
float dc = a.dc * BYTES_TO_COLOR;
float qn = a.qn * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;
float qo = a.qo * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;
float qp = a.qp * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;
float qr = th(a.qr);
float qs = a.qs;
vec4 cl = a.cl * BYTES_TO_COLOR;
vec4 cm = a.cm * BYTES_TO_COLOR;
vec4 dh = a.dh * BYTES_TO_COLOR;
vec2 aas = vec2(a.qt, a.qu) * BYTES_TO_COORD;
vec2 aat = vec2(a.qv, a.qw) * BYTES_TO_COORD;
vec2 yd = xh(aas);
vec2 yg = xh(aat);
float aax = float(
qj > EPSILON &&
a.qy > EPSILON &&
a.ra > EPSILON
);
float aay = 1. - aax;
float aaz = aax * xo(
a.qx,
a.qy
) + aay * xn(
a.qx,
a.qy
);
float aba = aax * xo(
a.qz,
a.ra
) + aay * xn(
a.qz,
a.ra
);
float qq = a.qq * BYTES_TO_SYMBOLIC_SIZE * u_viewZoom +
step(a.qq, EPSILON) * INFINITY;
float abb = xk(a.rb, a.rc);
float eu = xk(a.rd, a.re);
float zt = xk(a.rf, a.rg);
vec2 abc = a_vertexInfo.xy;
vec2 abd = vec2(0.0, 0.0);
float abe = aaz;
float abf = aba;
float abg = aba * qf;
if (qh > EPSILON || dc< EPSILON) {
if (a.rh < EPSILON || dc< EPSILON) return false;
abg = abb;
qs = a.rh;
aaz = abg * TEXT_WIDTH_MULTIPLIER * u_pixelRatio;
aba = abg * TEXT_HEIGHT_MULTIPLIER * u_pixelRatio;
}
bool aca = abs(qr) > EPSILON && xf(px, PIECE_EDGE_BODY) < EPSILON;
bool acb = aca && a_vertexInfo.z > EPSILON;
if (pw < EPSILON || px < EPSILON || qq < qn || acb) {
return false;
}
eu *= step(qo, qq);
float aco = 0.0;
float acp = 1.0;
float acl = 0.0;
float acn = 1.0;
float acq = 0.0;
float ada = 1.0;
float adc = 1.0;
float adm = 0.0;
float adn = 0.0;
vec2 bd;
vec2 ry;
vec2 rz;
vec2 sa;
float or;
float rx;
float aee = 0.0;
float aef = 1.0;
bool ci = xf(px, PIECE_TEXT_BOX) > EPSILON;
if (xf(px, PIECE_NODE_COMPONENT) > EPSILON || ci) {
bd = ceil((yd + yg) / 2.0);
if(length(aat - aas) > EPSILON){
ry = normalize(aat - aas) * vec2(1.,-1.);
}else{
ry = vec2(1.0, 0.0);
}
rz = ti(ry);
sa = rz;
or = aaz;
rx = aba;
} else {
adc = 0.0;
float aev = distance(yd, yg);
vec2 aew = normalize(yg - yd);
vec2 aex = (yd + yg) / 2.0;
vec2 aey = ti(aew);
vec2 ye;
vec2 yf;
if (qk > EPSILON) {
vec2 afe = sz(yd, -u_viewAngle);
vec2 aff = sz(yg, -u_viewAngle);
float afi = 1. / (1. + exp(-qr));
if (ql > EPSILON) {
float afj = afi * afe.y + (1. - afi) * aff.y;
ye = vec2(afe.x, afj);
yf = vec2(aff.x, afj);
} else {
float afk = afi * afe.x + (1. - afi) * aff.x;
ye = vec2(afk, afe.y);
yf = vec2(afk, aff.y);
}
ye = sz(ye, u_viewAngle);
yf = sz(yf, u_viewAngle);
}
vec2 afl = aex + (aey * aev * -qr / CURVATURE_RATIO);
if (xf(px, PIECE_EDGE_TEXT) > 0.0
|| xf(px, PIECE_EDGE_TEXT + PIECE_TEXT_BOX) > 0.0
) {
ci = xf(px, PIECE_EDGE_TEXT + PIECE_TEXT_BOX) > 0.0;
float afm;
float afn = eu;
eu = 0.0;
if (qd > EPSILON) {
xw ih = xx(yd, afn / 2.0, qr);
bd = to(yd, ih.vb, ih.vc, yg, 0.5);
ry = tx(yd, ih.vb, ih.vc, yg, 0.5);
rz = ti(ry);
sa = rz;
afm = .5 * uz(yd, ih.vb, ih.vc, yg);
} else if (qk > EPSILON) {
bd = to(yd, ye, yf, yg, 0.5);
ry = tx(yd, ye, yf, yg, 0.5);
rz = ti(ry);
sa = rz;
afm = uz(yd, ye, yf, yg);
} else if (abs(qr) > EPSILON) {
bd = tk(yd, afl, yg, 0.5);
ry = tv(yd, afl, yg, 0.5);
rz = ti(ry);
sa = rz;
afm = uj(qr, aev, 1.0);
} else {
bd = aex;
ry = aew;
rz = aey;
sa = aey;
afm = aev;
}
or = aaz;
rx = aba;
if(abe > afm - afn && qd < EPSILON){
if(qi > EPSILON){
ry = vec2(1.0, 0.0);
rz = vec2(0.0, 1.0);
sa = vec2(0.0, 1.0);
} else {
ry = vec2(0,0);
rz = vec2(0.0, 0.0);
sa = vec2(0.0, 0.0);
}
} else {
float tb = -atan(ry.y, ry.x);
aee = tb;
qg -= tb;
if ((tb > PI / 2.0 || tb < -PI / 2.0)) {
qg += (1.0 - qd) * PI;
aef = -1.0;
ry *= -1.0;
rz *= -1.0;
sa *= -1.0;
}
}
} else {
float afu = aaz;
float afv = aba;
float afw = xj(abb);
float afx = qa
* min(5. * afu, afw);
float afy = qb
* min(5. * afv, afw);
float afz = xf(px, PIECE_EDGE_HEAD);
float aga = xf(px, PIECE_EDGE_TAIL);
float agb = INFINITY * qd + aev - afu - afv;
float agk = min(0., agb - afx - afy)/2.;
float agp = abb / 2.;
float agq =
afu > agp
? afu - sqrt(afu * afu - agp * agp)
: agp;
float agr = max( afu +
afy
+ qb * agk,
0.) - (1. - qa) * agq;
agq =
afv > agp
? afv - sqrt(afv * afv - agp * agp)
: agp;
float ags = max( afv +
afx
+ qa * agk
, 0.) - (1. - qb) * agq;
if(qk > EPSILON && qd < EPSILON) {
agr = afu + afy / 2.;
ags = afv + afx / 2.;
}
if (afz > EPSILON || aga > EPSILON) {
vec2 agx = afz * yg + aga * yd;
float zt = afz * ags + aga * agr + (HEAD_TAIL_PX_ADJUST - 0.5);
float agy = afz * afx + aga * afy;
vec2 agz;
if (qk > EPSILON && qd < EPSILON) {
float yh = afz > EPSILON ? ags : agr;
float t = za(yd, ye, yf, yg, yh, aga > EPSILON);
agz = to(yd, ye, yf, yg, t);
ry = normalize(agz - to(yd, ye, yf, yg, t - 0.01));
if(aga > EPSILON) ry *= -1.;
bd = agz;
} else {
if (qd > EPSILON) {
xw ih = xx(yd, afu, qr);
float yh = afz * ags + aga * agr;
float t = za(yd, ih.vb, ih.vc, yg, yh, aga > EPSILON);
agz = to(yd, ih.vb, ih.vc, yg, t);
} else {
float afm = uj(qr, aev, 1.0);
float t = (afz * (afm - ags) + aga * agr) / afm;
agz = tk(yd, afl, yg, t);
}
ry = normalize(agx - agz);
bd = agx - ry * (zt - agy / 2.0);
}
rz = ti(ry);
sa = rz;
or = agy;
rx = agy;
py = 0.0;
pz = 0.0;
} else {
float ahd;
float ahe;
float ahf;
if(qk > EPSILON && qd < EPSILON) {
float ahg = za(yd, ye, yf, yg, agr, true);
float ahh = za(yd, ye, yf, yg, ags, false);
float ahi = ahh - ahg;
float ahj = a_vertexInfo.z;
float ahk = (ahg + ahi * ahj * T_STEP_PER_CURVE_PIECE);
float tt = (ahg + ahi * (ahj + 1.) * T_STEP_PER_CURVE_PIECE);
vec2 ahl = to(yd, ye, yf, yg, ahk);
vec2 ahm = to(yd, ye, yf, yg, tt);
bd = (ahl + ahm) / 2.0;
ry = normalize(ahm - ahl);
rz = ty(yd, ye, yf, yg, ahk);
sa = ty(yd, ye, yf, yg, tt);
or = distance(ahl, ahm);
ahd = uz(yd, ye, yf, yg);
ahe = ahd * ahk;
ahf = ahd * tt;
} else {
if (abs(qr) < EPSILON) {
bd = aex;
ry = aew;
rz = aey;
sa = rz;
or = aev;
ahd = aev;
ahe = 0.0;
ahf = aev;
} else {
float ahj = a_vertexInfo.z;
float ahk = ahj * T_STEP_PER_CURVE_PIECE;
float tt = ahk + T_STEP_PER_CURVE_PIECE;
if (qd < EPSILON) {
vec2 ahl = tk(yd, afl, yg, ahk);
vec2 ahm = tk(yd, afl, yg, tt);
bd = (ahl + ahm) / 2.0;
ry = normalize(ahm - ahl);
rz = tw(yd, afl, yg, ahk);
sa = tw(yd, afl, yg, tt);
or = distance(ahl, ahm);
ahd = uj(qr, aev, 1.0);
ahe = uj(qr, aev, ahk);
ahf = uj(qr, aev, tt);
} else {
xw ih = xx(yd, afu, qr);
vec2 ye = ih.vb;
vec2 yf = ih.vc;
vec2 ahl = to(yd, ye, yf, yg, ahk);
vec2 ahm = to(yd, ye, yf, yg, tt);
bd = (ahl + ahm) / 2.0;
ry = normalize(ahm - ahl);
rz = ty(yd, ye, yf, yg, ahk);
sa = ty(yd, ye, yf, yg, tt);
or = distance(ahl, ahm);
ahd = uz(yd, ye, yf, yg);
ahe = ahk * ahd;
ahf = tt * ahd;
}
}
}
rx = abb;
if(qd > EPSILON) {
xw ih = xx(yd, afu, qr);
float ahq = za(yd, ih.vb, ih.vc, yg, agr, true);
float ahh = za(yd, ih.vb, ih.vc, yg, ags, false);
acl = ahq;
acn = ahh;
} else if(qk < EPSILON) {
acl = (agr - 1.0) / ahd;
acn = MAX_PROGRESS - (ags - HEAD_TAIL_PX_ADJUST) / ahd;
}
aco = ahe / ahd;
acp = ahf / ahd;
acq = ahd;
if (abb < EPSILON)
cl.a = 0.; 
if (qc > 0.0 && agb > 5.0) {
float ahu = (ahd * rx) / (ahd - agr);
float ahv = ahd;
float qt = agr;
float qv = ahd - ags;
float a = -ahu / ahv;
float b = ahu;
float qu = a * qt + b;
float qw = a * qv + b;
float ahw = qu / (qt - qv);
float bi = -ahw * qv;
rx = min(min(bi, afu), afv);;
adn = ahw * ahv + bi + 1.0;
}
}
}
}
vec2 cq = vec2(0.0, 0.0);
vec2 rt = vec2(EPSILON, EPSILON);
vec2 ru = vec2(-EPSILON, -EPSILON);
float rv = -1.0;
float rw = 0.0;
bool ahy = false;
vec2 ahz = vec2(0,0);
vec2 aia = vec2(0,0);
vec2 aib = vec2(0,0);
if (qs > EPSILON && qq > qp) {
float aie = floor(qs / PATTERN_INFO_TEXTURE_SIZE);
float aif = qs - (aie * PATTERN_INFO_TEXTURE_SIZE);
vec4 aig = texture2D(u_patternInfoTexture, vec2(aif, aie) / 255.0) * 255.0;
vec2 aih = sw(aig.z);
vec2 aii = sw(aig.w);
rv = aih.x * 2.0 + aii.x;
float aij = 0.0;
if (aq(rv, FILTER_NEAREST)) { 
aij = PATTERN_NEAREST_TEXTURE_SIZE;
} else if (aq(rv, FILTER_LINEAR)) { 
aij = PATTERN_LINEAR_TEXTURE_SIZE;
} else if (aq(rv, FILTER_LINEAR_SDF)) { 
aij = PATTERN_LINEAR_SDF_TEXTURE_SIZE;
ahy = true;
} else if (aq(rv, FILTER_MIPMAP)) { 
aij = PATTERN_MIPMAP_TEXTURE_SIZE;
}
float aim = 1.0 / aij;
vec2 ain = (vec2(aih.y, aii.y) * PATTERN_POSITION_UNIT_SIZE) * aim / 2.0;
aia += (aig.xy * PATTERN_POSITION_UNIT_SIZE * aim) + ain;
ain -= PATTERN_PADDING * aim * 2.0;
vec2 aio = vec2(or / 2.0, rx / 2.0) * aim;
vec2 aip = vec2(eu, eu) * aim;
float air = 1.0 * u_pixelRatio;
float ais = SDF_SMOOTH_FACTOR;
if (qf > EPSILON) {
if (ahy) { 
if (a.qj > EPSILON) {
ais = SDF_SMOOTH_FACTOR * u_pixelRatio / SDF_GAMMA;
ahz = vec2(-a.rl,-a.rk);
}
rw = ais * SDF_GAMMA / abg / u_pixelRatio;
air = SDF_FONT_SIZE / abg;
} else { 
air = (ain.y / aio.y) / qf;
}
}
aib = (aio + aip) * air;
ain += PATTERN_PADDING * aim;
rt = aia - ain;
ru = aia + ain;
}
if (qh > EPSILON) {
abd.y = (a.rj) * abg;
ada = 0.0;
adc = 0.0;
abd.x = a.ri * abg * BYTES_TO_TEXT_OFFSET_X;
abd = sz(abd, aee);
abd *= aef;
}
vec2 aix = vec2(cos(qg), sin(qg)) * zt;
vec2 aiy = bd + aix + abd;
float aiz = eu * 2.0;
float aja = or + adc * (aiz + 1.0);
float ajb = rx + ada * (aiz + 1.0);
vec2 ajc = ry * aja / 2.0;
vec2 ajd = rz * ajb / 2.0;
vec2 aje = sa * ajb / 2.0;
float ajf = (acp - aco);
float ajg = abc.x / 2.0 + 0.5;
float ro = aco + ajf * ajg;
float rs = adm + (adn - adm) * ro / 2.0;
float ajh = step(pw, FIRST_COMPLEX_SHAPE_ID - EPSILON);
float aji = ajh * SIMPLE_SHAPE_SAMPLING_SIZE + (1.0 - ajh) * COMPLEX_SHAPE_SAMPLING_SIZE;
float ajj = aji / COMPLEX_SHAPE_SAMPLING_SIZE;
float ajk = ajj * SHAPE_SAMPLING_BUFFER_RATIO / 2.0;
float ajl = ajj * (1.0 - SHAPE_SAMPLING_BUFFER_RATIO);
vec2 ajs = vec2(
mod(pw, NB_SHAPES_BY_SIDE),
floor(pw / NB_SHAPES_BY_SIDE)
);
vec2 ajt = ajs + vec2(ajk) +
vec2(aco * ajl, 0.0);
vec2 ajw = vec2(ajf, 1.0) * ajl;
vec2 rn = (ajt + ajw * (abc / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE;
vec2 rr = vec2(aja / ajf, ajb) / 2.0;
float akc = py * abb;
float akd = pz * abb;
float rp = akc + akd;
float rq = (ro * acq) / rp;
cq = aia
+ aib
* (abc + ahz / rr * u_viewZoom);
ns.rn = rn;
float ch = float(pw == 1.);
f = vec4(
(ajt + ajw * (vec2(0.5,0.5) / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE,
NB_SHAPES_BY_SIDE * (1. - qh) * ch,
float(ci)
);
ns.rr = rr;
ns.eu = eu;
ns.cl = cl;
ns.cm = cm;
ns.dc = dc;
ns.ro = xu(ro, acl, acn);
ns.rp = rp;
ns.py = akc;
ns.rq = rq;
ns.rs = rs;
ns.cq = cq;
ns.rt = rt;
ns.ru = ru;
ns.rv = rv;
ns.rw = rw;
ns.dh = dh;
ns.bd = aiy;
ns.or = aja + ch;
ns.rx = ajb + ch;
ns.ry = ry;
ns.rz = rz;
ns.sa = sa;
return true;
}
float aki(float akj, float akk, vec4 akl) {
float akm = clamp(((u_currentTime - akj) / akk), 0.0, 1.0);
float r = akm;
float akn = r * r;
float ako = akn * r;
vec4 akp = akm < 0.5 ? te(akl) : tg(akl);
float akq = akp.x;
float akr = akp.y;
float aks = akp.z;
float akt = akp.w;
float aku = akq + akr * r + aks * akn + akt * ako;
return aku;
}
void main() {
qm a_final = ze(
a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,
a_final_patternId_fillRGBA_strokeRGBA_patternRGBA,
a_final_x1_y1_x2_y2,
a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,
a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,
a_final_offsetScaled_offsetFixed_paddingTop_paddingLeft,
a_text_charId_charOffsetXY
);
#if ANIMATED
float akj = a_animationBeginTime_animationDuration.x;
float akk = a_animationBeginTime_animationDuration.y;
vec4 akl = a_animationEasing;
float aaq = aki(akj, akk, akl);
qm a_prev = ze(
a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,
a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA,
a_prev_x1_y1_x2_y2,
a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,
a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,
a_prev_offsetScaled_offsetFixed_paddingTop_paddingLeft,
a_text_charId_charOffsetXY
);
const float ONE = 1.0;
a_final.pw = mix(a_prev.pw, a_final.pw, ONE);
a_final.py = mix(a_prev.py, a_final.py, aaq);
a_final.pz = mix(a_prev.pz, a_final.pz, aaq);
a_final.qa = mix(a_prev.qa, a_final.qa, ONE);
a_final.qb = mix(a_prev.qb, a_final.qb, ONE);
a_final.px = mix(a_prev.px, a_final.px, ONE);
a_final.qf = mix(a_prev.qf, a_final.qf, ONE);
a_final.qh = mix(a_prev.qh, a_final.qh, ONE);
a_final.qi = mix(a_prev.qi, a_final.qi, ONE);
a_final.qj = mix(a_prev.qj, a_final.qj, ONE);
a_final.qk = mix(a_prev.qk, a_final.qk, ONE);
a_final.qd = mix(a_prev.qd, a_final.qd, ONE);
a_final.qg = mix(a_prev.qg, a_final.qg, aaq);
a_final.dc = mix(a_prev.dc, a_final.dc, aaq);
a_final.qn = mix(a_prev.qn, a_final.qn, aaq);
a_final.qo = mix(a_prev.qo, a_final.qo, aaq);
a_final.qp = mix(a_prev.qp, a_final.qp, aaq);
a_final.qq =mix(a_prev.qq, a_final.qq, aaq);
a_final.qr = mix(a_prev.qr, a_final.qr, aaq);
a_final.qs = mix(a_prev.qs, a_final.qs, ONE);
a_final.cl = mix(a_prev.cl, a_final.cl, aaq);
a_final.cm = mix(a_prev.cm, a_final.cm, aaq);
a_final.dh = mix(a_prev.dh, a_final.dh, aaq);
a_final.qt = mix(a_prev.qt, a_final.qt, aaq);
a_final.qu = mix(a_prev.qu, a_final.qu, aaq);
a_final.qv = mix(a_prev.qv, a_final.qv, aaq);
a_final.qw = mix(a_prev.qw, a_final.qw, aaq);
a_final.qx = mix(a_prev.qx, a_final.qx, aaq);
a_final.qy = mix(a_prev.qy, a_final.qy, aaq);
a_final.qz = mix(a_prev.qz, a_final.qz, aaq);
a_final.ra = mix(a_prev.ra, a_final.ra, aaq);
a_final.rb = mix(a_prev.rb, a_final.rb, aaq);
a_final.rc = mix(a_prev.rc, a_final.rc, aaq);
a_final.rd = mix(a_prev.rd, a_final.rd, aaq);
a_final.re = mix(a_prev.re, a_final.re, aaq);
a_final.rf = mix(a_prev.rf, a_final.rf, aaq);
a_final.rg = mix(a_prev.rg, a_final.rg, aaq);
a_final.rh = mix(a_prev.rh, a_final.rh, ONE);
a_final.ri = mix(a_prev.ri, a_final.ri, ONE);
a_final.rj = mix(a_prev.rj, a_final.rj, ONE);
#endif
rm ns;
bool aky = aar(a_final, ns);
if (!aky) {
wz();
return;
}
vec2 abc = a_vertexInfo.xy;
a = ns.cl;
b = ns.cm;
c = ns.dh;
d = ns.rn;
e = ns.cq;
#if D3D9_FIX
#else
l = ns.eu;
m = ns.rt;
n = ns.ru;
o = vec2(ns.dc, ns.rs);
p = ns.ro;
q = ns.rp;
r = vec2(ns.py, ns.rq);
s = ns.rr;
t = ns.rw;
u = ns.rv;
#endif
float alb = step(abc.x, 0.0);
float alc = 1.0 - alb;
g = min(ns.rx, ROUNDED_BOX_RADIUS * 2.) * u_pixelRatio;
vec2 xb = ns.bd
+ ns.ry * (ns.or / 2.0) * abc.x
+ (alb * ns.rz + alc * ns.sa) * ns.rx / 2.0 * abc.y;
c = c * (1. - f.w)
+ vec4(
abc.x * ns.or,
abc.y * ns.rx,
ns.or,
ns.rx
) * u_pixelRatio * f.w;
gl_Position = xa(xb);
}
`,Od=1e20,jO=class{constructor({fontSize:t=24,buffer:e=8,radius:s=6,cutoff:n=.25}={}){this._maxDimension=1,this._gridSize=1,this._fontSize=t,this._buffer=e,this._radius=s,this._cutoff=n,this._height=Math.ceil(this._fontSize+2*this._buffer*_f),this._canvas=Pn(),this._canvas.height=this._height,this._canvas.width=1;const i=this._canvas.getContext("2d",{willReadFrequently:!0});this._ctx=i,i.textBaseline="middle",i.textAlign="center",i.fillStyle="black"}setOptions({fontSize:t=24,buffer:e=8,cutoff:s=.25,radius:n=6}){this._fontSize=t,this._buffer=e,this._cutoff=s,this._radius=n,this._height=Math.ceil(this._fontSize+2*this._buffer*_f)}draw(t,e,s){Zo(this._ctx,e,this._fontSize,s);const n=HO(this._ctx.measureText(t).width+2*this._buffer)-2*Wo,i=this._height,r=n*i,o=Math.max(n,i);this._canvas.width<n&&(this._canvas.width=n,Zo(this._ctx,e,this._fontSize,s),this._ctx.textAlign="center",this._ctx.textBaseline="middle",this._ctx.fillStyle="black"),r>this._gridSize&&(this._gridOuter=new Float64Array(r),this._gridInner=new Float64Array(r),this._gridSize=r),o>this._maxDimension&&(this._f=new Float64Array(o),this._d=new Float64Array(o),this._z=new Float64Array(o+1),this._v=new Int16Array(o),this._maxDimension=o),this._ctx.clearRect(0,0,n,i),this._ctx.fillText(t,n/2,i/2);const a=this._ctx.getImageData(0,0,n,i),l=new Uint8ClampedArray(r);for(let u=0;u<r;u++){const h=a.data[4*u+3]/255;this._gridOuter[u]=h===1?0:h===0?Od:Math.pow(Math.max(0,.5-h),2),this._gridInner[u]=h===1?Od:h===0?0:Math.pow(Math.max(0,h-.5),2)}AS(this._gridOuter,n,i,this._f,this._d,this._v,this._z),AS(this._gridInner,n,i,this._f,this._d,this._v,this._z);for(let u=0;u<r;u++){const h=this._gridOuter[u]-this._gridInner[u];l[u]=Math.max(0,Math.min(255,Math.round(255-255*(h/this._radius+this._cutoff))))}return{height:i,width:n,distance:l}}};function AS(t,e,s,n,i,r,o){for(let a=0;a<e;a++){for(let l=0;l<s;l++)n[l]=t[l*e+a];wS(n,i,r,o,s);for(let l=0;l<s;l++)t[l*e+a]=i[l]}for(let a=0;a<s;a++){for(let l=0;l<e;l++)n[l]=t[a*e+l];wS(n,i,r,o,e);for(let l=0;l<e;l++)t[a*e+l]=Math.sqrt(i[l])}}function wS(t,e,s,n,i){s[0]=0,n[0]=-Od,n[1]=+Od;for(let r=1,o=0;r<i;r++){let a=(t[r]+r*r-(t[s[o]]+s[o]*s[o]))/(2*r-2*s[o]);for(;a<=n[o];)o--,a=(t[r]+r*r-(t[s[o]]+s[o]*s[o]))/(2*r-2*s[o]);o++,s[o]=r,n[o]=a,n[o+1]=+Od}for(let r=0,o=0;r<i;r++){for(;n[o+1]<r;)o++;e[r]=(r-s[o])*(r-s[o])+t[s[o]]}}function HO(t){return Math.ceil((t+2*Wo)/Hn)*Hn}var Qc=256,$O=.275,qO=.25,YO=6,WO=tD-2*Wo,XO=Jz-2*Wo,TS={fontSize:Jd,cutoff:$O,radius:YO},ZO={fontSize:Jd,cutoff:qO,radius:8},KO=class{constructor(t,e){this._patternIdToInfoTexture=new Uint8Array(Qc*Qc*4),this._glTextures=[],this._textureSizes=[],this._pixelRatio=1,this._gl=t,this._glUnit=e;const s=Pn(ir,ir),n=s.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("Pattern: could not get 2d context");this._imageCanvasContext=n,this._imageCanvas=s,this._sdfGenerator=new jO(TS),this._maxTextureSize=Math.min(4096,t.getParameter(t.MAX_TEXTURE_SIZE))}refresh(t){this._pixelRatio=t.getPixelRatio();const e=this._gl,s=this._getPatternsByFilter(t.getPatternList());for(let r=0;r<s.length;++r){const o=r,a=s[r],l=AO(a,this._maxTextureSize),{texture:u,size:h}=PC(o,a,l,this._maxTextureSize,this._patternIdToInfoTexture),g=this._glTextures[o]||(this._glTextures[o]=e.createTexture()),f=o===Zl?m0:Fy;xS(e,g,this._glUnit+1+o,u,h,o,f),this._textureSizes[o]=h}const n=this._glTextureInfo||(this._glTextureInfo=e.createTexture()),i=this._patternIdToInfoTexture;xS(e,n,this._glUnit,i,Qc,Zl,Fy)}bindMetaDataTexture(){const t=this._gl;t.activeTexture(t.TEXTURE0+this._glUnit),t.bindTexture(t.TEXTURE_2D,this._glTextureInfo)}getInfoTextureUnit(){return this._glUnit}getNearestTextureUnit(){return this._glUnit+1+Zl}getLinearTextureUnit(){return this._glUnit+1+zd}getLinearSdfTextureUnit(){return this._glUnit+1+Dd}getMipmapTextureUnit(){return this._glUnit+1+wa}getInfoTextureSize(){return Qc}getNearestTextureSize(){return this._textureSizes[Zl]}getLinearTextureSize(){return this._textureSizes[zd]}getLinearSdfTextureSize(){return this._textureSizes[Dd]}getMipmapTextureSize(){return this._textureSizes[wa]}_getPatternsByFilter(t){const e=new Array(mS);for(let s=0;s<mS;++s)e[s]=[];for(let s=0;s<t.length;++s){const n=this._getPatternPixels(t[s]);e[n.filter].push(n)}return e}_getPatternPixels({id:t,type:e,attributes:s}){let n;const{text:i,font:r,style:o,image:a,scaled:l,duplicated:u,colorArray:h}=s;switch(e){case qo:n=u?this._getDuplicatedImagePixels(a):l?this._getScaledImagePixels(a):this._getNonScaledImagePixels(a);break;case Na:n=this._getSdfTextPixels(i,r,o);break;case za:n=this._getIconPixels(i,r,o);break;case Da:n=this._getBadgeIconPixels(i,r,o);break;case Th:n=this._getPieChartPixels(h);break;default:throw new Error(`pattern type "${e}" does not exist`)}return n.id=t,n}_getScaledImagePixels(t){let e=t.width,s=t.height;if(e>0){const n=ir/Math.max(t.width,t.height);e*=n,s*=n}return e&&s&&(e=gu(e),s=gu(s)),e-=2*Wo,s-=2*Wo,this._getImagePixels(t,e,s)}_getNonScaledImagePixels(t){return this._getImagePixels(t,t.width,t.height)}_getDuplicatedImagePixels(t){if(t.width===0||t.height===0)return this._getImagePixels(t,0,0);this._canvasForDuplicatedImage||(this._canvasForDuplicatedImage=Pn(ir,ir));const e=this._canvasForDuplicatedImage,s=e.getContext("2d"),n=t.width,i=t.height;let r=(ir-n)/2,o=(ir-i)/2;for(;r>0;)r-=n;for(;o>0;)o-=i;for(let a=r;a<ir;a+=n)for(let l=o;l<ir;l+=i)s.drawImage(t,a,l);return this._getImagePixels(e,ir,ir)}_getImagePixels(t,e,s){let n;if(e===0||s===0)n=new Uint8Array(0);else{(this._imageCanvas.width<e||this._imageCanvas.height<s)&&(this._imageCanvas.width=e,this._imageCanvas.height=s);const i=this._imageCanvasContext;Ny(this._imageCanvas,i,e,s);try{i.drawImage(t,0,0,e,s)}catch{}n=i.getImageData(0,0,e,s).data}return{width:e,height:s,pixels:n,filter:wa}}_getPieChartPixels(t){const e=XO,s=this._imageCanvasContext,n=e/2,i=e/2;return Ny(this._imageCanvas,s,e,e),s.save(),s.rect(0,0,e,e),s.clip(),DC(s,t,n,i,e),s.restore(),{width:e,height:e,pixels:s.getImageData(0,0,e,e).data,filter:zd}}_getTextPixels(t,e,s,n,i,r){const o=this._imageCanvasContext,a=i*this._pixelRatio;Zo(o,s,a,n);let l=Math.ceil(o.measureText(e).width);l===0&&(l=a);let u=0,h=0;t===wa||(u=2*Math.ceil(a*_f/2),h=2*Math.ceil(l*Z2/2));const g=Math.ceil(l+h),f=Math.ceil(a+u),p=this._imageCanvas.height<f||this._imageCanvas.width<g;return this._imageCanvas.height<f&&(this._imageCanvas.height=f),this._imageCanvas.width<g&&(this._imageCanvas.width=g),p&&Zo(o,s,a,n),o.clearRect(0,0,g,f),o.fillStyle="black",o.textBaseline="middle",o.textAlign="left",o.fillText(e,r+h/2,f/2),{width:g,height:f,pixels:o.getImageData(0,0,g,f).data,filter:t}}_getIconPixels(t,e,s){return this._getTextPixels(wa,t,e,s,WO,0)}_getBadgeIconPixels(t,e,s){return this._sdfGenerator.setOptions(ZO),this._getSdfPixels(t,e,s)}_getSdfTextPixels(t,e,s){return this._sdfGenerator.setOptions(TS),this._getSdfPixels(t,e,s)}_getSdfPixels(t,e,s){const{width:n,height:i,distance:r}=this._sdfGenerator.draw(t,e,s),o=new Uint8Array(n*i*4);for(let a=0;a<r.length;++a)o[4*a+3]=r[a];return{width:n,height:i,pixels:o,filter:Dd}}},QO=class{constructor(t,e){this._gl=t,this._glTextureUnit=e,this._simpleShapePixels=new Uint8Array(Ug*Ug*4),this._complexShapePixels=new Uint8Array(Bo*Bo*4),this._shapesWritten=new Set}refresh(t){const e=t.getShapeList();for(const s of e)if(!this._shapesWritten.has(s.id)){const n=s.isSimple?Ug:Bo,i=s.isSimple?this._simpleShapePixels:this._complexShapePixels;wO(s,n,Ay,i),this._loadShapeInGpu(s.id,n,i),this._shapesWritten.add(s.id)}}_loadShapeInGpu(t,e,s){const n=this._gl,i=Ty,r=t%wy*Bo,o=Math.floor(t/wy)*Bo;if(this._texture)n.bindTexture(n.TEXTURE_2D,this._texture);else{const a=new Uint8Array(i*i*4);this._texture=n.createTexture(),n.activeTexture(n.TEXTURE0+this._glTextureUnit),n.bindTexture(n.TEXTURE_2D,this._texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,i,i,0,n.RGBA,n.UNSIGNED_BYTE,a)}n.texSubImage2D(n.TEXTURE_2D,0,r,o,e,e,n.RGBA,n.UNSIGNED_BYTE,s)}getTextureSize(){return Ty}getSamplingSize(){return Bo}getBufferRatio(){return Ay}getTextureUnit(){return this._glTextureUnit}rewriteShape(t){this._shapesWritten.delete(t)}},CS=class{constructor(t,{vertex:e,fragment:s,constants:n,macros:i}){this._state=0,this._gl=t,this._vertexSource=e,this._fragmentSource=s,this._constants=Xs(n||{}),this._macros=Xs(i||{})}setConstant(t,e){this._constants[t]=e}setMacro(t,e){this._macros[t]=e}getState(){return this._state}getProgram(){return this._program}compile(){const t=this._gl,e=LS(this._vertexSource,this._macros,this._constants),s=LS(this._fragmentSource,this._macros,this._constants);this._program&&(t.deleteProgram(this._program),t.deleteShader(this._vertexShader),t.deleteShader(this._fragmentShader));const n=t.createProgram(),i=t.createShader(t.VERTEX_SHADER),r=t.createShader(t.FRAGMENT_SHADER);if(!(n&&i&&r))throw new Error("Error instantiating WebGL program");this._program=n,this._vertexShader=i,this._fragmentShader=r,t.shaderSource(this._vertexShader,e),t.compileShader(this._vertexShader),t.attachShader(this._program,this._vertexShader),t.shaderSource(this._fragmentShader,s),t.compileShader(this._fragmentShader),t.attachShader(this._program,this._fragmentShader),t.linkProgram(this._program),this._state=1}getError(){const t=this._gl;if(!t.getShaderParameter(this._vertexShader,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(this._vertexShader)||"";let s=e;const n=e.match(/ERROR: (\d+):(\d+):(.*)\n/g);if(n&&n.length){const i=this._vertexSource.split(`
`);s=n.map((r=>{const o=r.match(/ERROR: (\d+):(\d+):(.*)\n/);if(!o)return r;const[a,l]=o.slice(2);return`${i[+a]}
${i[+a+1]}
~~~~~~~~~~~
${i[+a+2]}
 -> ${l}`})).join(`
`)}return{step:"vertex",message:s}}return t.getShaderParameter(this._fragmentShader,t.COMPILE_STATUS)?t.getProgramParameter(this._program,t.LINK_STATUS)?(this._state=2,null):{step:"link",message:t.getProgramInfoLog(this._program)||""}:{step:"fragment",message:t.getShaderInfoLog(this._fragmentShader)||""}}};function LS(t,e,s){const n=Object.keys(e),i=Object.keys(s);for(let r=0;r<n.length;++r){const o=n[r],a=e[o];t=t.replace(`#define ${o} 0`,`#define ${o} ${a}`)}for(let r=0;r<i.length;++r){const o=i[r],a=s[o],l=a+(a%1==0?".0":"");t=t.replace(`const float ${o} = 0.0;`,`const float ${o} = ${l};`)}return t}function JO(){return typeof window<"u"&&!!window.FORCE_WEBGL}/** @preserve instance id */var kS=mC(),tB={stencil:!0,antialias:!1,alpha:!0,premultipliedAlpha:!0,failIfMajorPerformanceCaveat:!JO()},eB=0,sB=1,nB={NO_WEBGL:'Unable to create a WebGL context: `canvas.getContext("webgl")` and `canvas.getContext("experimental-webgl")` returned `null`',NO_ANGLE_INSTANCED_ARRAYS:'WebGL extension "ANGLE_instanced_arrays" unavailable: `gl.getExtension("ANGLE_instanced_arrays")` returned `null`'},BC=class extends Error{};function o_(t,e){if(!t&&e){const s=new BC(nB[e]);throw s.code=e,s}}var iB=class UC extends io{constructor(e){super(e),this._2dcanvas=Pn(),this._ctx=this._2dcanvas.getContext("2d"),this._bufferDrawers=[],this._mustResize=!1,this._error=null,this._onContextLost=l=>{l.preventDefault(),this._error=new BC("WebGL context lost"),this.fire("error",this._error)};const s=UC.createInitData(),{canvas:n,gl:i,ext:r,staticProgramWrapper:o,animationProgramWrapper:a}=s;o_(i,"NO_WEBGL"),o_(r,"NO_ANGLE_INSTANCED_ARRAYS"),this._glCanvas=n,this._gl=i,this._ext=r,this._staticProgramWrapper=o,this._animationProgramWrapper=a,this._shapeTexture=new QO(this._gl,eB),this._patternTexture=new KO(this._gl,sB),this._initCanvas(this._glCanvas),this._computeShaderInfo(),this._initSpecialGlBuffers(),this._initGlPrograms(),this._initGl()}_initCanvas(e){super._initCanvas(e),e.addEventListener("webglcontextlost",this._onContextLost,!1)}static isAvailable(){return kS||o_(null,"NO_WEBGL"),kS}static createInitData(){const e=Pn(),s=l0(e,tB,"webgl"),n=s&&typeof s.getExtension=="function"?s.getExtension("ANGLE_instanced_arrays"):null,i=aB(),r=new CS(s,{vertex:r_,fragment:i_,constants:i,macros:{ANIMATED:0}}),o=new CS(s,{vertex:r_,fragment:i_,constants:i,macros:{ANIMATED:1}});return s&&n&&(r.compile(),s.flush()),{canvas:e,gl:s,ext:n,staticProgramWrapper:r,animationProgramWrapper:o}}static getName(){return"WebGL"}_beforeFirstFrame(){this._animationProgramWrapper.getState()===0&&this._animationProgramWrapper.compile()}ensureAnimationsReady(){const e=this._animationProgramWrapper.getState();e!==2&&(e===0&&this._animationProgramWrapper.compile(),this._animationProgramWrapper.getError())}getDomElement(){return this._glCanvas}_initGl(){const e=this._gl;e.clearColor(0,0,0,0),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA)}_computeShaderInfo(){this._shaderMetadata=rB(r_,i_)}_initGlPrograms(){this._staticProgram=new SS({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._staticProgramWrapper}),this._animationProgram=new SS({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._animationProgramWrapper})}_initSpecialGlBuffers(){const e=this._gl,s=e.createBuffer(),n=new Int8Array(18*mi);for(let i=0;i<mi;++i){const r=[-1,-1,i,1,-1,i,1,1,i,-1,-1,i,-1,1,i,1,1,i],o=i*r.length;for(let a=0;a<r.length;a++)n[a+o]=r[a]}e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),this._specialGlBuffers={vertexInfo:s}}_computeUniforms(){return{viewWidth:this._width,viewHeight:this._height,viewX:this._viewX,viewY:this._viewY,viewZoom:this._viewZoom,viewAngle:this._viewAngle,currentTime:this._currentTime,pixelRatio:this._pixelRatio,backgroundColor:this._backgroundRgba,patternInfoTexture:this._patternTexture.getInfoTextureUnit(),patternNearestTexture:this._patternTexture.getNearestTextureUnit(),patternLinearTexture:this._patternTexture.getLinearTextureUnit(),patternLinearSdfTexture:this._patternTexture.getLinearSdfTextureUnit(),patternMipmapTexture:this._patternTexture.getMipmapTextureUnit(),shapeTexture:this._shapeTexture.getTextureUnit(),BYTES_TO_COORD:this._scales.bytesToActualCoord,BYTES_TO_SCALED_SIZE:this._scales.bytesToActualScaledSize,BYTES_TO_MIN_VISIBLE_SIZE:this._scales.bytesToActualMinVisibleSize,BYTES_TO_SYMBOLIC_SIZE:this._scales.bytesToActualSymbolicSize,BYTES_TO_DASH_LENGTH:this._scales.bytesToActualDashLength,BYTES_TO_GAP_LENGTH:this._scales.bytesToActualGapLength,BYTES_TO_PATTERN_SCALE:this._scales.bytesToActualPatternScale,PATTERN_INFO_TEXTURE_SIZE:this._patternTexture.getInfoTextureSize(),PATTERN_NEAREST_TEXTURE_SIZE:this._patternTexture.getNearestTextureSize(),PATTERN_LINEAR_TEXTURE_SIZE:this._patternTexture.getLinearTextureSize(),PATTERN_LINEAR_SDF_TEXTURE_SIZE:this._patternTexture.getLinearSdfTextureSize(),PATTERN_MIPMAP_TEXTURE_SIZE:this._patternTexture.getMipmapTextureSize(),PATTERN_POSITION_UNIT_SIZE:Hn,ROUNDED_BOX_RADIUS:this._textManager.getCornerRadius(),SHAPE_TEXTURE_SIZE:this._shapeTexture.getTextureSize(),SHAPE_SAMPLING_SIZE:this._shapeTexture.getSamplingSize(),SHAPE_SAMPLING_BUFFER_RATIO:this._shapeTexture.getBufferRatio(),NB_SHAPES_BY_SIDE:this._shapeTexture.getTextureSize()/this._shapeTexture.getSamplingSize(),SHAPE_DIMENSIONS:this._shapeTexture.getSamplingSize()/this._shapeTexture.getTextureSize(),SHAPE_ACTUAL_RATIO:1-this._shapeTexture.getBufferRatio()}}_render({shapesChanged:e,patternsChanged:s,dimensionsChanged:n,backgroundColorChanged:i}){const r=this._gl;if(this._error)throw this._error;if(e&&(this._shapeTexture.refresh(this._shapeManager),this._patternTexture.bindMetaDataTexture()),s&&this._patternTexture.refresh(this._patternManager),n&&(this._mustResize=!0),i){const[l,u,h,g]=this._renderBackground?this._backgroundRgba:[0,0,0,0];r.clearColor(l*g,u*g,h*g,g)}const o=this._computeUniforms(),a=this._getSortedBufferList();this._mustResize&&a.length&&(lf(this._glCanvas,this._width,this._height,this._pixelRatio),r.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),this._mustResize=!1),r.clear(r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT);for(let l=0;l<a.length;++l)this._displayBuffer(a[l],o);this._endFrame()}_displayBuffer(e,s){const n=e.getProgram();n!==this._currentProgram&&(this._currentProgram&&this._currentProgram.endPass(),this._currentProgram=n,this._currentProgram.startPass(s)),e.markAsUsed(),e.draw()}_getSortedBufferList(){const e=this._bufferList.getBuffersByAscendingDepth(),s=[];for(let n=0;n<this._bufferDrawers.length;++n){const i=this._bufferDrawers[n];i&&i.markAsUnused()}for(let n=0;n<e.length;++n){const i=e[n],r=this._getBufferDrawer(i);r.markAsUsed(),!i.isEmpty()&&this._isBufferDisplayable(i)&&s.push(r)}for(let n=0;n<this._bufferDrawers.length;++n){const i=this._bufferDrawers[n];i&&!i.isUsed()&&(i.destroy(),this._bufferDrawers[n]=void 0)}return s}_endFrame(){this._currentProgram&&(this._currentProgram.endPass(),this._currentProgram=null)}_getBufferDrawer(e){const s=e.getId();let n=this._bufferDrawers[s];if(!n){for(;this._bufferDrawers.length<=s;)this._bufferDrawers.push(void 0);n=new zO({gl:this._gl,ext:this._ext,staticProgram:this._staticProgram,animationProgram:this._animationProgram}),this._bufferDrawers[s]=n}return n.setDataBuffer(e),n}destroy(){this._glCanvas&&this._glCanvas.removeEventListener("webglcontextlost",this._onContextLost);const e=this._gl.getExtension("WEBGL_lose_context");e&&e.loseContext()}getImageData(){const e=this._glCanvas.width,s=this._glCanvas.height;return(this._2dcanvas.width<e||this._2dcanvas.height<s)&&(this._2dcanvas.width=e,this._2dcanvas.height=s),this._ctx.clearRect(0,0,e,s),this._ctx.drawImage(this._glCanvas,0,0),this._ctx.getImageData(0,0,e,s)}_getImageDataFlippedYAxis(){const e=this._gl,s=this._glCanvas.width,n=this._glCanvas.height,i=this._ctx.createImageData(s,n),r=new Uint8Array(i.data.buffer);return e.readPixels(0,0,s,n,e.RGBA,e.UNSIGNED_BYTE,r),i}setConstant(e,s){this._staticProgramWrapper.setConstant(e,s),this._animationProgramWrapper.setConstant(e,s),this._staticProgramWrapper.compile(),this._animationProgramWrapper.compile(),this._initGlPrograms(),this._bufferDrawers.forEach((n=>{n==null||n.destroy()})),this._bufferDrawers=[]}getShapeTexture(){return this._shapeTexture}};function rB(t,e){const s={vertexInfoAttribute:"a_vertexInfo",attributes:[],uniforms:[]};return NS(s,t),NS(s,e),s}var oB={float:1,vec2:2,vec3:3,vec4:4};function NS(t,e){const s=/(?:attribute\s+\/\*\s*(byte|ubyte|short|ushort|float)\s*\*\/\s*(float|vec2|vec3|vec4)\s+(\w+)\s*;)|(?:#if\s*(\w+))|(?:#endif)/g,n=/uniform\s+(float|vec2|vec3|vec4|sampler2D|int)\s+(\w+)\s*;/g,i=[];let r=s.exec(e);for(;r;){const o=r[0];o==="#endif"?i.pop():o.startsWith("#if")?i.push(r[4]):t.attributes.push({name:r[3],size:oB[r[2]],type:r[1],tags:i.slice(),location:null,byteSize:0,glType:null}),r=s.exec(e)}for(r=n.exec(e);r;){if(!t.uniforms.some((({id:o})=>o===r[1]))){const o=r[1],a=r[2],l=a.replace("u_","");t.uniforms.push({id:l,name:a,type:o})}r=n.exec(e)}}function aB(){return{BYTES_TO_OFFSET_ANGLE:2*Math.PI/8,BYTES_TO_COLOR:1/15,SDF_FONT_SIZE:Jd,CURVATURE_RATIO:Kf,PATTERN_PADDING:Wo,TEXT_WIDTH_MULTIPLIER:Z2,TEXT_HEIGHT_MULTIPLIER:_f,SELF_LOOP_CURVATURE_RATIO:yf,EDGE_ARROW_SIZE_RATIO:io.edgeArrowSizeRatio,EDGE_MIN_TIP_SIZE:io.minEdgeTipSize,CURVE_SUBDIVISIONS:mi,PIECE_NODE_COMPONENT:Yi,PIECE_TEXT_BOX:Ma,PIECE_EDGE_BODY:Qf,PIECE_EDGE_HEAD:e0,PIECE_EDGE_TAIL:s0,PIECE_EDGE_TEXT:Aa,MAX_TEXT_SIZE:qD,BYTES_TO_TEXT_OFFSET_X:1/EC,BYTES_TO_TEXT_OFFSET_Y:1/My,FILTER_NEAREST:Zl,FILTER_LINEAR:zd,FILTER_LINEAR_SDF:Dd,FILTER_MIPMAP:wa,SHAPE_TEXTURE_SIZE:Ty,SIMPLE_SHAPE_SAMPLING_SIZE:Ug,COMPLEX_SHAPE_SAMPLING_SIZE:Bo,SHAPE_SAMPLING_BUFFER_RATIO:Ay,MAX_SHAPES:mf.toString(),FIRST_COMPLEX_SHAPE_ID:Sy,SELF_LOOP_TO_CIRCLE_APPROX:J2,SDF_GAMMA:nD}}var lB={x:0,y:0,zoom:1,angle:0,width:80,height:60,pixelRatio:1,backgroundColor:null,currentTime:0,isBufferDisplayable:Mx,hideImages:!1,renderBackground:!1,bentEnable:!1,bentVertical:!1},Jc={webgl:iB,canvas:LO,svg:FO},MS=[0,0,0,0],a_={webgl:null,svg:null,canvas:null},l_=class extends wh{constructor(t){super(),this._view=Xs(lB),this._domWrapper=oo?document.createElement("div"):af(),this._domElement=this._domWrapper.appendChild(oo?document.createElement("div"):af()),this._currentElementSize=0,this._currentBlockOffset=0,this._currentByteOffset=0,this._blockIdToAddress=new Uint32Array(0),this._renderersByType={},this._switchMainRenderer=!0,this._refreshTexts=!1,this._backgroundColor=null,this._initData=t||{},this._patternManager=new GD,this._shapeManager=new VD,this._boundariesManager=new cD,this._textManager=new YD(this._patternManager),this._bufferOffsetToId=new nC,this._memoryManager=new OD(this._patternManager,this._shapeManager,this._textManager,this._bufferOffsetToId,(e=>this.parseColor(e)||MS)),this._bufferList=new oD}static createInitData(){const t={};for(const e in Jc)t[e]=Jc[e].createInitData();return t}static cacheInitData(t){a_=t}static getCachedInitData(){return a_}static clearCachedInitData(){a_={webgl:null,svg:null,canvas:null}}freeBlock(t){this._checkBlockId(t);const e=this._blockIdToAddress[t],s=this._bufferList.freeBlock(e);return this._blockIdToAddress[t]=s,s}_ensureDomElementsFitParent(){const t=this._domElement.parentNode;!t||t.offsetWidth===this._view.width&&t.offsetHeight===this._view.height||ja(t,`${this._view.width}px`,`${this._view.height}px`)}_ensureCorrectBackgroundColor(){const t=this._domElement.parentNode;this._backgroundColor!==this._view.backgroundColor&&t&&(t.style.backgroundColor=this._view.backgroundColor||"",this._backgroundColor=this._view.backgroundColor)}createGroup(){return new hD}parseColor(t){return Wn(t)}clear(){this._blockIdToAddress.fill(0),this._patternManager.reset(),this._boundariesManager.reset(),this._textManager.reset(),this._bufferList.reset(),this._bufferOffsetToId.reset()}notifyFontsReloaded(){this._patternManager.notifyUpdate(),this._textManager.clear(),this._refreshTexts=!0}notifyPatternUpdate(){this._patternManager.notifyUpdate()}getShapePoints(t){return this._shapeManager.getDefinitionFromName(t).points}checkShapeHit(t,e,s){const{getDistanceFromStrokeVertically:n,getDistanceFromStrokeHorizontally:i}=this._shapeManager.getDefinitionFromName(t);return Math.min(n(e,s),i(e,s))>=0}setGlobalBoundaries(t){const{maxBlockId:e=0,maxScaledSize:s,maxMinVisibleSize:n,maxSymbolicSize:i,maxDashLength:r,maxGapLength:o,maxPatternScale:a}=t;return e>this._blockIdToAddress.length&&this._resizeBlockArray(e),!!this._boundariesManager.set(t)&&(this._memoryManager.resizeBoundaries(s,n,i,r,o,a),!0)}_resizeBlockArray(t){const e=new Uint32Array(t);e.set(this._blockIdToAddress),this._blockIdToAddress=e}registerShape(t,e){this._shapeManager.register(t,e)}updateShape(t,e){var n;this._shapeManager.updateShape(t,e);const s=(n=this._renderersByType.webgl)==null?void 0:n.getShapeTexture();s&&s.rewriteShape(this._shapeManager.getIdFromName(t))}_bindBlock(t,e,s,n,i,r,o){this._checkBlockId(t);const a=this._blockIdToAddress[t],l=this._bufferList.allocateBlock(a,e,s,n,i,r,o);return this._blockIdToAddress[t]=l.address,this._currentDataView=l.buffer.getDataView(),this._currentElementSize=l.buffer.elementSize,this._currentBlockOffset=l.offset,this._currentByteOffset=this._currentBlockOffset*this._currentElementSize,this._currentSideDataView=l.buffer.getSideDataView(),this._currentSideElementSize=l.buffer.getTotalSideElementsSize(),this._currentSideByteOffset=this._currentBlockOffset*this._currentSideElementSize,l}_setItemIndex(t){const e=this._currentBlockOffset+t;this._currentByteOffset=e*this._currentElementSize,this._currentSideByteOffset=e*this._currentSideElementSize}_checkBlockId(t){t>=this._blockIdToAddress.length&&this._resizeBlockArray(Vo(t+1))}_setTextCharacters(t){this._textManager.storeTextInDataView(this._currentSideDataView,this._currentSideByteOffset,this._currentSideByteOffset+this._currentSideElementSize,t)}_storeElement(t,e){this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset,t.end),e&&(this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset+hu,t.start),this._memoryManager.storeAnimationInformation(this._currentDataView,this._currentByteOffset+2*hu,t.animation,i0.getCoefficients(t.animation.easing)))}storeGroup(t,e){if(!e||e.size===0)return this.freeBlock(t);const s=e.type,n=e.depth,i=e.size,r=e.getElements(),o=e.animated,a=e.stencilUsage,l=e.getId();let u=0;if(s===Pa)for(let g=0;g<i;++g){const f=r[g],{start:p,end:y}=f;if(y.pattern.type===Xo){const _=y.pattern.attributes.text;u=Math.max(u,_.length)}if(o&&p.pattern.type===Xo){const _=p.pattern.attributes.text;u=Math.max(u,_.length)}}const h=this._bindBlock(t,s,o,n,i,u,a);for(let g=0;g<i;++g){const f=r[g];this._setItemIndex(g),this._storeElement(f,o),this._bufferOffsetToId.set(h.buffer.getId(),h.offset+g,l)}if(s===Pa)for(let g=0;g<i;++g){const f=r[g];this._setItemIndex(g),this._setTextCharacters(f.end.pattern)}return h.address}_refreshTextElements(){const t=this._bufferList.getBuffers();for(const e of t)if(e&&e.type===Pa){const s=e.getSideDataView(),n=e.getTotalSideElementsSize(),i=e.getSize();let r=0,o=n;for(let a=0;a<i;++a){const l=this._textManager.extractTextFromDataView(s,r,o);this._textManager.storeTextInDataView(s,r,o,l),r=o,o+=n}e.triggerUpdate()}}extractElement(t,e=0){if(!t)return null;const s=this._bufferList.getBlockInfo(t);return this._renderer.extractElement(s.buffer,s.offset+e)}getDomElement(){return this._domElement}getDomWrapper(){return this._domWrapper}measureText(t,e,s,n=1){return this._textManager.measureText(t,e,s,n)}setRenderType(t){this._renderType!==t&&(this._renderType=t,this._switchMainRenderer=!0)}setEdgeArrowSizeRatio(t){io.setEdgeArrowSizeRatio(t),this._renderersByType.webgl&&this._renderersByType.webgl.setConstant("EDGE_ARROW_SIZE_RATIO",t)}setEdgeMinTipSize(t){io.setMinEdgeTipSize(t),this._renderersByType.webgl&&this._renderersByType.webgl.setConstant("EDGE_MIN_TIP_SIZE",t)}setBentEdges(t,e){this._view.bentEnable=t,this._view.bentVertical=e}getBentEdges(){return{bentEnable:this._view.bentEnable,bentVertical:this._view.bentVertical}}_ensureMainRendererReady(){if(this._switchMainRenderer){this._renderType===null&&(this._renderType="canvas");const t=Jc[this._renderType];t&&t.isAvailable()||(this._renderType="canvas"),this._renderer=this._renderersByType[this._renderType],this._renderer||(this._renderer=this._instanciateRenderer(this._renderType),this._renderer.on("error",(e=>this.fire("error",e))),this._renderersByType[this._renderType]=this._renderer),this._updateDomElement()}}_updateDomElement(){const t=this._renderer&&this._renderer.getDomElement(),e=this._domElement;for(;e&&e.firstChild;)e.removeChild(e.firstChild);t&&this._appendDomChild(t)}_appendDomChild(t){t.style.position="absolute",t.style.left="0",t.style.top="0",this._domElement.appendChild(t)}_instanciateRenderer(t){return new(t===null?io:Jc[t])({initData:t===null?null:this._initData[t],bufferList:this._bufferList,shapeManager:this._shapeManager,patternManager:this._patternManager,boundariesManager:this._boundariesManager,textManager:this._textManager,memoryManager:this._memoryManager})}setView(t){this._view={...this._view,...t}}getTextManager(){return this._textManager}_updateManagers(){this._patternManager.setPixelRatio(this._view.pixelRatio),this._shapeManager.update(),this._patternManager.update(),this._textManager.update(),this._boundariesManager.update(),this._bufferList.update(),this._refreshTexts&&(this._refreshTexts=!1,this._refreshTextElements())}_resizeCanvas(t){oC(t,this._view.width,this._view.height,this._view.pixelRatio)}render(){this._ensureMainRendererReady(),this._ensureDomElementsFitParent(),this._ensureCorrectBackgroundColor(),this._updateManagers(),this._renderer.renderFrame(this._view)}ensureAnimationsReady(){this._ensureMainRendererReady(),this._renderer.ensureAnimationsReady()}export(t,e,s){const n=this._instanciateRenderer(t),i={...this._view,...e};return"setViewportClipping"in n&&n.setViewportClipping(!1),this._updateManagers(),n.renderFrame(i),n.export(s).then((()=>n.getDomElement()))}getCurrentTime(){return $n()}getImageData(){return this._renderer&&this._renderer.getImageData()}destroy(){for(const t of Object.keys(this._renderersByType)){const e=this._renderersByType[t];e&&e.destroy()}}transparentify(t){const e=this.parseColor(t)||MS;return`rgba(${Math.round(255*e[0])},${Math.round(255*e[1])},${Math.round(255*e[2])},0)`}initDebugRenderingLoop({triggerKey:t="r",start:e=!0}={}){let s=e;document.addEventListener("keydown",(({key:i})=>{i===t&&(s=!s)}));const n=i=>{(s||i)&&(this.setView({currentTime:$n()}),this.render()),window.requestAnimationFrame((()=>{n()}))};window.requestAnimationFrame((()=>{document.body.appendChild(this.getDomElement()),n(!0)}))}},uB=jf&&document.fonts,dB=200,u_="/qwerty/ [HELLO] ",IS="serif",hB=16,cB=class{constructor(){this._fontFaceSet=uB?document.fonts:null,this._canvas=Pn(),this._ctx=this._canvas.getContext("2d")}_measureText(t,e){return this._ctx.font=`12px ${e}`,this._ctx.measureText(t).width}check(t){if(t===IS)return!0;const e=this._measureText(u_,IS);return this._measureText(u_,t)!==e}load(t){return this._fontFaceSet&&this._fontFaceSet.load?this._fontFaceSet.load(`12px ${t}`):(this._ctx.font=`12px ${t}`,this._ctx.fillText(u_,10,50),Promise.resolve())}},gB=class{constructor(t,e){this._fontLoaderCounter=0,this._loaded=!1,this._value=null,this._timeout=0,this._fontFaceSet=t,this._fontName=e,this._loaded=!1,this._value=null,this._timeout=0,jf&&!this._fontFaceSet.check(this._fontName)||this._setLoaded()}_setLoaded(){this._loaded=!0,this._value=this._fontName}getValue(){return this._value}isLoaded(){return this._loaded}destroy(){clearTimeout(this._timeout)}load(){return this._tryLoad(dB).then((()=>this._setLoaded()))}_tryLoad(t){return this._fontFaceSet.load(this._fontName).then((()=>{if(!this._fontFaceSet.check(this._fontName)&&this._fontLoaderCounter<hB)return new Promise((e=>{t<6e4&&(this._timeout=setTimeout(e,t))})).then((()=>(this._fontLoaderCounter++,this._tryLoad(1.5*t))))}))}},fB=class{constructor(){this._fontFaceSet=new cB,this._fonts={},this._onFontLoaded=[],this._hideUntilFontsLoaded=!0}setHideUntilFontsLoaded(t){this._hideUntilFontsLoaded=t}getFont(t){let e=this._fonts[t];return e||(e=new gB(this._fontFaceSet,t),this._fonts[t]=e,e.isLoaded()||e.load().then((()=>this._triggerFontLoaded(t)))),!this._hideUntilFontsLoaded&&t||e.getValue()}onFontLoaded(t){this._onFontLoaded.push(t)}destroy(){this._onFontLoaded=[],Object.keys(this._fonts).forEach((t=>this._fonts[t].destroy()))}_triggerFontLoaded(t){this._onFontLoaded.forEach((e=>e(t)))}},Ch="shifted",pB="centered";/**
 * Ogma Parsers
 * @description Parsers for Ogma
 * @version 0.0.27 (built on Thu Apr 10 2025 15:39:50 GMT+0000 (Coordinated Universal Time))
 * @author Alexander Milevski - Leo Nicolle - Sylvain Milan - Marco Liberati
 * @license (c) Linkurious 2025. All rights reserved.
 * @preserve
 */function Fo(t,e,s){s=s||e,e in t&&(t.attributes[s]=t[e])}function GC(t,e=(s=>s)){const s=e(JSON.parse(t)),n=s.nodes||[],i=s.edges||[];for(let r=0;r<n.length;r++){const o=n[r];o.attributes||(o.attributes={}),typeof o.size=="string"&&(o.size=+o.size),typeof o.x=="string"&&(o.x=+o.x),typeof o.y=="string"&&(o.y=+o.y),Fo(o,"x"),Fo(o,"y"),Fo(o,"size","radius"),Fo(o,"color"),Fo(o,"text")}for(let r=0;r<i.length;r++){const o=i[r];o.attributes||(o.attributes={}),typeof o.size=="string"&&(o.size=+o.size),Fo(o,"size","width"),Fo(o,"color"),Fo(o,"text")}return{nodes:n,edges:i}}function mB(t){return t.type==="vertex"||t._type==="vertex"||t.inE||t.outE||t._inE||t._outE}function _B(t){return t.type==="edge"||t._type==="edge"||t.inV||t.outV||t._outV||t._inV}function bd(t,e,s){if(t&&typeof t=="object"){if(Array.isArray(t))return t.forEach((n=>bd(n,e,s)));if(mB(t)){const n={};t.properties&&Object.keys(t.properties).forEach((r=>{n[r]=t.properties[r][0].value}));const i=Py(t);e.push({id:i,data:{id:t.id+"",categories:[t.label],properties:n}});for(const r in t)r!=="properties"&&bd(t[r],e,s);return}if(_B(t)){const n=Py(t);s.push({id:n,source:RS(t,["inV","_inV"]),target:RS(t,["outV","_outV"]),data:{id:n,type:t.label,properties:t.properties||{}}});for(const i in t)i!=="properties"&&bd(t[i],e,s);return}Object.keys(t).forEach((n=>bd(t[n],e,s)))}}function RS(t,e){for(const s of e)if(t[s])return Py(t[s])}function Py(t){if(typeof t=="string"||isFinite(t))return String(t);const e=t;return String(e.id||e._id)}function yB(t){const e=[],s=[];return bd(typeof t=="string"?JSON.parse(t):t,e,s),{nodes:e,edges:s}}var ai=t=>t.charCodeAt(0),xB=ai(" "),FS=ai("<"),jg=ai(">"),PS=ai('"'),vB=ai(`
`),bB=ai("\r"),Hg=ai("/"),EB=ai("\\"),SB=ai("a"),AB=ai("z"),wB=ai("A"),TB=ai("Z"),CB=ai("0"),LB=ai("9"),kB=ai(":"),VC=-1,zy=-2,jC=-3,HC=-4;function NB(t){const e=new Int32Array(t.length);for(let s=0,n=t.length;s<n;++s)e[s]=t.charCodeAt(s);return e}function MB(t,e,s,n){const i=n.length;if(s-e!==i)return!1;for(let r=0;r<i;++r)if(t[e+r]!==n[r])return!1;return!0}function IB(t,e,s,n){return $C(t.tags,e,s,n)}function RB(t,e,s,n){return $C(t.attributes,e,s,n)}function $C(t,e,s,n){const i=t.length;for(let r=0;r<i;++r)if(MB(e,s,n,t[r]))return r;return t.push(e.slice(s,n)),i}function FB(t,e,s){let n=$g(e,s),i=e[n];if(i===jg||i===Hg)return n;let r=n;n=YC(e,n);const o=RB(t,e,r,n);for(;e[n]!==PS;)++n;for(++n,r=n;(i=e[n])!==PS;)i===EB&&++n,++n;return t.tokens.push(jC,o,r,n),n+1}function PB(t,e){let s,n;const i={tags:[],attributes:[],tokens:[]},r=i.tokens;let o=$g(t,e);for(;o<t.length;){let a=t[o];if(a===FS){if(o=$g(t,++o),t[o]===Hg)for(r.push(zy);t[++o]!==jg;);else{s=o,o=YC(t,s);const l=IB(i,t,s,o);for(r.push(VC,l),a=t[o];a!==jg&&a!==Hg;)o=FB(i,t,o),a=t[o];if(a===Hg)for(r.push(zy);t[++o]!==jg;);}o+=1}else{for(s=o;t[++o]!==FS;);for(n=o-1;qC(t[n]);)--n;r.push(HC,s,n+1)}o=$g(t,o)}return i}function qC(t){return t===xB||t===vB||t===bB}function $g(t,e){for(;qC(t[e]);)++e;return e}function zB(t){return t>=SB&&t<=AB||t>=wB&&t<=TB||t===kB||t>=CB&&t<=LB}function YC(t,e){for(;zB(t[e]);)++e;return e}function zS(t,e){const s=Object.keys(e),n={};if(s.length>0)for(let i=0;i<s.length;++i){const r=e[s[i]],o=r.title;n[o]=r.default!==void 0?JSON.stringify(r.default):void 0}return t?()=>({id:void 0,attributes:{text:void 0,color:void 0,radius:void 0,x:void 0,y:void 0},data:{...n}}):()=>({id:void 0,source:void 0,target:void 0,attributes:{color:void 0,text:void 0,width:void 0},data:{...n}})}function DS(t){return t.indexOf("\\")===-1||(t=t.replace(/\\"/g,'"')),t}function WC(t){if(t.indexOf("<gexf")===-1)throw new Error("not a GEXF file");const e=NB(t),s=PB(e,t.indexOf("<gexf ")),n={},i={};s.tags.forEach(((hs,Fe)=>{const Oe=String.fromCharCode.apply(null,hs);n[Oe]=Fe})),s.attributes.forEach(((hs,Fe)=>{const Oe=String.fromCharCode.apply(null,hs);i[Oe]=Fe}));const r=n.attributes,o=n.attribute,a=n.node,l=n.edge,u=n.default,h=n["viz:position"],g=n["viz:size"],f=n["viz:color"],p=n.attvalue,y=i.class,_=i.id,x=i.type,v=i.title,b=i.label,S=i.source,A=i.target,w=i.x,L=i.y,I=i.r,F=i.g,O=i.b,V=i.a,j=i.value,Z=i.for,at=i.weight,pt={float:1,double:1,integer:2,boolean:3,string:4,"list-string":5};let K=0;const ut=s.tokens,ht=ut.length,nt=new Array(16);let ot=0,Nt=0,Q=0,Et=!0;const Xt={},Ht={};let Zt,ae,pe="",ne="",te="",se={attributes:{}},ce=0,Ce=0,ve=0,Ne=1,ge="",ze=!1,is=!0,Ge=null,De=null;const He=[],Je=[];let ss=0,ts={};for(;K<ht;){const hs=ut[K];if(hs===VC)Nt=ot,ot=ut[K+1],nt[Q]=ot,Q+=1,ot===a?(Ge||(Ge=zS(!0,Xt)),se=Ge(),is=!0,ts=Xt):ot===l&&(De||(De=zS(!1,Ht)),se=De(),is=!1,ts=Ht),K+=2;else if(hs===zy){if(pe&&ot===o){ts=Et?Xt:Ht;const Fe=pt[ne];let Oe=Zt;Oe&&(Fe===1?Oe=+Oe:Fe===2?Oe=0|+Oe:Fe===3?Oe=Oe==="true":Fe===5&&(Oe=Oe.split(" ").filter((Cs=>Cs)))),ts[pe]={title:te||pe,default:Oe,type:Fe},pe="",te="",ne="",Zt=void 0}else if(ot===a&&Q===4)ze&&se.attributes&&(se.attributes.color=`rgba(${ce}, ${Ce}, ${ve}, ${Ne})`,ce=0,Ce=0,ve=0,Ne=1,ze=!1),se.id||(se.id=++ss),He.push(se);else if(ot===l&&Q===4)se.id||(se.id=++ss),Je.push(se);else if(ot===p&&Q===6&&ge){const Fe=(is?Xt:Ht)[ge];if(Fe){if(ae===void 0)ae=Fe.default;else{const Cs=Fe.type;Cs&&(Cs===1?ae=+ae:Cs===2?ae=0|+ae:Cs===3?ae=ae==="true":Cs===5?ae=ae.split(" ").filter((Fs=>Fs)).map((Fs=>DS(Fs))):typeof e=="string"&&(ae=DS(ae)))}se.data||(se.data={});const Oe=ts;se.data[Oe[ge].title]=ae}ge="",ae=null}Q-=1,ot=Nt,Nt=nt[Q-2],K+=1}else if(hs===jC){const Fe=ut[K+1],Oe=t.substring(ut[K+2],ut[K+3]);if(ot===r)Fe===y&&(Et=Oe!=="edge"&&Oe!=="edges");else if(ot===o)Fe===_?pe=Oe:Fe===x?ne=Oe:Fe===v&&(te=Oe);else if(ot!==a&&ot!==l||Q!==4)if(ot===h&&Q===5){if(Fe===w)se.attributes.x=parseFloat(Oe);else if(Fe===L){const Cs=parseFloat(Oe);se.attributes.y=Cs===0?Cs:-Cs}}else ot===f&&Q===5?(ze=!0,Fe===I?ce=parseInt(Oe):Fe===F?Ce=parseInt(Oe):Fe===O?ve=parseInt(Oe):Fe===V&&(Ne=parseFloat(Oe))):ot===g&&Q===5?Fe===j&&(is?se.attributes.radius=+Oe:se.attributes.width=+Oe):ot===p&&Q===6&&(Fe===Z||Fe===_?ge=Oe:Fe===j&&(ae=Oe));else Fe===_?se.id=Oe:Fe===b?se.attributes.text=Oe:Fe===S?se.source=Oe:Fe===A?se.target=Oe:Fe===at&&(se.attributes.width=+Oe);K+=4}else{if(hs!==HC)throw new Error(`at index ${K}: token ${hs}`);{const Fe=t.substring(ut[K+1],ut[K+2]);ot===u&&(Zt=Fe),K+=3}}}return{nodes:He,edges:Je}}function DB(t){for(let e=0;e<64;++e)t[e]^=1;for(let e=0;e<64&&!(t[e]^=1);++e);}function OB(t,e,s){for(let n=0;n<32;++n)s[n]=+!!(t&1<<n);for(let n=0;n<32;++n)s[n+32]=+!!(e&1<<n);return s}function OS(t,e){let s=0;for(let n=0;n<20;++n){const i=s+t[n]+e[n];s=+(i>=10),t[n]=i%10}}var BB=class{constructor(){this._decimalPowerOfTwo=new Uint8Array(20),this._binaryNumber=new Uint8Array(64),this._decimalNumber=new Uint8Array(20)}int64ToString({low:e,high:s}){if(e===0&&s===0)return"0";OB(e,s,this._binaryNumber),this._decimalNumber.fill(0),this._decimalPowerOfTwo.fill(0),this._decimalPowerOfTwo[0]=1;const n=this._binaryNumber[63]===1;n&&DB(this._binaryNumber);for(let o=0;o<64;++o)this._binaryNumber[o]&&OS(this._decimalNumber,this._decimalPowerOfTwo),OS(this._decimalPowerOfTwo,this._decimalPowerOfTwo);const i=[];let r=this._decimalNumber.length-1;for(n&&i.push("-");!this._decimalNumber[r];)r-=1;for(let o=r;o>=0;--o)i.push(String(this._decimalNumber[o]));return i.join("")}},UB=new BB;function tg(t){return UB.int64ToString(t)}function eg(t){return typeof t=="object"&&"high"in t&&"low"in t}function GB(t){return"start"in t&&"end"in t}function VB(t){if(typeof t!="object"||t===null)throw new Error("Ogma can only retrieve nodes and relationships from Neo4j. Please make sure that your Cypher query returns nodes and edges, not values.");const e=Object.keys(t.properties);for(const s of e){const n=t.properties[s];eg(n)&&(t.properties[s]=tg(n))}if(t.identity!==void 0){if(eg(t.identity)&&(t.identity=tg(t.identity)),GB(t)){const s=t.start.identity||t.start,n=t.end.identity||t.end;eg(s)&&(t.start=tg(s)),eg(n)&&(t.end=tg(n))}}else t.id&&(t.identity=t.id)}var jB=t=>"start"in t&&"end"in t&&"type"in t,HB=t=>"segments"in t;function $B(t,e,s,n){e.segments.forEach((i=>{Bd(t,i.start,s,n),Bd(t,i.end,s,n),Bd(t,i.relationship,s,n)}))}function Bd(t,e,s,n){if(e)if(Array.isArray(e))e.forEach((i=>Bd(t,i,s,n)));else if(HB(e))$B(t,e,s,n);else if(VB(e),jB(e))n.has(e.identity)||(n.add(e.identity),t.edges.push({id:e.identity,source:e.start,target:e.end,data:{neo4jType:e.type,neo4jProperties:e.properties}}));else{const i=e;s.has(i.identity)||(s.add(i.identity),t.nodes.push({id:i.identity,attributes:{},data:{neo4jLabels:i.labels,neo4jProperties:i.properties}}))}}var qB=t=>"queryKeys"in t&&"values"in t;function YB(t){const e=[];return t.values.forEach((s=>{const{nodes:n=[],relationships:i=[],segments:r=[]}=s.adapted,o=[{segments:r,properties:{}}];e.push({_fields:[...n,...i,...o]})})),{records:e}}function WB(t){let e=typeof t=="string"?JSON.parse(t):t;const s={nodes:[],edges:[]},n=new Set,i=new Set;return qB(e)&&(e=YB(e)),e.records.forEach((({_fields:r})=>r.forEach((o=>Bd(s,o,n,i))))),s}var XB={boolean:t=>t.toLowerCase()==="true",int:parseFloat,long:parseFloat,float:parseFloat,double:parseFloat,string:t=>t};function ZB(t){const e={graph:{},node:{},edge:{}},s={graph:{},node:{},edge:{}};for(let n=0;n<t.length;n++){const i=t[n],r=i.getAttribute("for")||"node",o=i.getAttribute("id"),a=i.getAttribute("attr.name"),l=i.getAttribute("attr.type")||"string",u=i.getElementsByTagName("default"),h=u.length!==0?u[0].textContent:void 0;e[r][o]={name:a,parse:XB[l]},typeof h<"u"&&(s[r][a]=h)}return{definitions:e,defaults:s}}function BS(t,e,s){const n=t.getElementsByTagName("data"),i={};for(let r=0;r<n.length;r++){const o=n[r],a=o.getAttribute("key");if(a===null)continue;const l=e[a];typeof l>"u"?i[a]=o.textContent:o.textContent&&o.textContent.length!==0&&(i[l.name]=l.parse(o.textContent))}for(const r in s)r in i||(i[r]=s[r]);return i}function d_(t){return t.color?t.color:t.r&&t.g&&t.b?`rgb(${t.r}, ${t.g}, ${t.b})`:void 0}var KB=new Set(["x","y","size","color","r","g","b","label"]);function US(t){const e={};for(const s in t)KB.has(s)||t[s]===void 0||(e[s]=t[s]);return e}function XC(t,e){if(!e){if(typeof DOMParser>"u")throw new Error("DOMParser is not available. You need to provide a DOMParser instance as second argument, if you are not in the browser environment");e=new DOMParser}const s=e.parseFromString(t,"application/xml"),n=s.getElementsByTagName("key"),i=s.getElementsByTagName("node"),r=s.getElementsByTagName("edge"),{definitions:o,defaults:a}=ZB(n),l=[],u=new Set;for(let g=0;g<i.length;g++){const f=i[g],p=f.getAttribute("id"),y=f.getAttribute("href")||void 0,_=BS(f,o.node,a.node);u.add(p);const x={id:p,attributes:{x:_.x,y:_.y,radius:_.size,color:d_(_),text:_.label},data:US(_)};_.x!==void 0&&(x.attributes.x=_.x),_.y!==void 0&&(x.attributes.y=_.y),_.size!==void 0&&(x.attributes.radius=_.size),_.label!==void 0&&(x.attributes.text=_.label);const v=d_(_);v!==void 0&&(x.attributes.color=v),y!==void 0&&(x.data.href=y),l.push(x)}const h=[];for(let g=0;g<r.length;g++){const f=r[g],p=f.getAttribute("id")||g,y=f.getAttribute("source"),_=f.getAttribute("target"),x=f.getAttribute("xlink:href")||void 0;if(!u.has(y)||!u.has(_))throw new Error(`Invalid edge: ${y} -> ${_}`);const v=BS(f,o.edge,a.edge),b={id:p,source:y,target:_,attributes:{},data:US(v)},S=d_(v);S!==void 0&&(b.attributes.color=S),x!==void 0&&(b.data.href=x),h.push(b)}return{nodes:l,edges:h}}var ZC=t=>{const e=t.split(`
`).filter((i=>!i.startsWith("%"))),[s]=e[0].split(" ").map(Number),n=e.slice(1).map((i=>i.split(" ").slice(0,2).map(Number))).filter((i=>i.length===2));return{nodes:Array.from({length:Number(s)},((i,r)=>({id:r}))),edges:n.map((([i,r])=>({source:i%s,target:r%s})))}};function QB(t,e,s,n){_0(t,e,s,n),t.thicknessOrFontSizeScaled=e.widthScaled,t.thicknessOrFontSizeFixed=e.widthFixed,t.strokeWidthScaled=e.stroke.widthScaled,t.strokeWidthFixed=e.stroke.widthFixed,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=e.color,t.strokeColor=e.stroke.color,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=e.stroke.minVisibleSize,t.offsetAngle=0,t.symbolicSize=e.widthScaled,t.dashLength=e.shape.dashLength,t.gapLength=e.shape.gapLength,t.hasHead=!!e.shape.head,t.hasTail=!!e.shape.tail,t.isBodyTriangle=e.shape.isBodyTriangle}function _0(t,e,s,n){t.pieceId=s,t.shape=n,t.x1=e.sourceX,t.y1=e.sourceY,t.x2=e.targetX,t.y2=e.targetY,t.rectWidthOrSourceRadiusScaled=e.sourceRadiusScaled,t.rectWidthOrSourceRadiusFixed=e.sourceRadiusFixed,t.rectHeightOrTargetRadiusScaled=e.targetRadiusScaled,t.rectHeightOrTargetRadiusFixed=e.targetRadiusFixed,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=Xn,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.widthScaled,t.curvature=e.curvature,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=e.isSelfLoop,t.isText=!1}function JB(t,e,s){const n=e.widthScaled+2*e.halo.widthScaled,i=e.widthFixed+2*e.halo.widthFixed;_0(t,e,s,"line"),t.thicknessOrFontSizeScaled=n,t.thicknessOrFontSizeFixed=i,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=e.halo.color,t.strokeColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.offsetAngle=0,t.symbolicSize=e.widthScaled,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isBodyTriangle=!1}function tU(t,e,s,n){_0(t,e,s,n);const i=e.widthFixed*lS+ID;t.thicknessOrFontSizeScaled=e.widthScaled*aS,t.thicknessOrFontSizeFixed=e.widthFixed*aS,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=e.widthScaled*lS,t.offsetFixed=i,t.fillColor=e.outline.color,t.strokeColor=null,t.globalMinVisibleSize=Math.max(e.minVisibleSize,e.outline.minVisibleSize),t.strokeMinVisibleSize=0,t.offsetAngle=Math.PI/2,t.symbolicSize=e.widthScaled,t.dashLength=e.shape.dashLength,t.gapLength=e.shape.gapLength,t.hasHead=!!e.shape.head,t.hasTail=!!e.shape.tail,t.isBodyTriangle=e.shape.isBodyTriangle}function eU(t,e,s){KC(t,e,s),t.pattern.type=Xo,t.pattern.attributes.text=e.content,t.pattern.attributes.size=Ah,t.pattern.attributes.font=e.font,t.pattern.attributes.style=e.style,t.pattern.attributes.align=e.align,t.patternColor=e.color,t.patternScale=1,t.thicknessOrFontSizeScaled=e.sizeScaled,t.thicknessOrFontSizeFixed=e.sizeFixed,t.isText=!0}function sU(t,e,s){KC(t,e,s),t.pieceId+=Ma,t.fillColor=e.backgroundColor,t.shape="square"}function KC(t,e,s){let n=e.position==="centered"?0:(s.widthScaled+e.heightScaled)/2+s.stroke.widthScaled,i=e.position==="centered"?0:(s.widthFixed+e.heightFixed)/2+s.stroke.widthFixed+e.padding+e.margin;if(e===s.texts.secondary&&s.texts.primary.position==="centered"&&(i=s.texts.primary.heightFixed/2+s.texts.primary.padding+s.texts.primary.margin+e.padding+e.margin,n=0),t.pieceId=Aa,t.shape="square",t.x1=s.sourceX,t.y1=s.sourceY,t.x2=s.targetX,t.y2=s.targetY,!s.isSelfLoop&&s.curvature===0){const r=Math.atan2(t.y2-t.y1,t.x2-t.x1),o=s.sourceRadiusScaled-s.targetRadiusScaled,a=Math.cos(r),l=Math.sin(r);t.x1+=a*o,t.y1+=l*o}t.rectWidthOrSourceRadiusScaled=e.widthScaled,t.rectWidthOrSourceRadiusFixed=e.widthFixed+2*e.padding+1,t.rectHeightOrTargetRadiusScaled=e.heightScaled,t.rectHeightOrTargetRadiusFixed=e.heightFixed+2*e.padding,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=s.sourceRadiusScaled+s.targetRadiusScaled,t.strokeWidthFixed=s.sourceRadiusFixed+s.targetRadiusFixed,t.offsetScaled=n,t.offsetFixed=i,t.pattern.type=Xn,t.opacity=s.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=Math.max(e.minVisibleSize,s.minVisibleSize),t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.offsetAngle,t.patternScale=0,t.symbolicSize=s.widthScaled,t.curvature=s.curvature,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=s.isSelfLoop,t.isText=!1,t.adjustTextAngle=e.adjustAngle}var nU=t=>!!t||t===0;function hr(t,e,s=0){return t==="inherit"?Array.isArray(e)?e[((s/(2*Math.PI)*e.length|0)+1)%e.length]:e:t}function iU(t,e,s){return t==="source"?Array.isArray(e)?e[0]:e:t==="target"?Array.isArray(s)?s[0]:s:t}function rU(t){const e=t.depth;return e===lC||e===aC||(e-r0)%a0>=o0}function QC(t){const e=(t.depth-r0)%a0;return e>=0&&e!==uC&&e!==o0}function GS(t,e,s,n,i,r){oU(t,e,s,n,i,r),VS(t,e,s,n.text,i.texts.primary,r.texts.primary,r),VS(t,e,s,n.text.secondary,i.texts.secondary,r.texts.secondary,r)}function oU(t,e,s,n,i,r){if(h_(i.body,r,QB),i.halo.body){const o=n.halo.width.get(s),a=+(n.halo.scalingMethod.get(s)==="scaled");r.halo.widthScaled=o*a,r.halo.widthFixed=o*(1-a),h_(i.halo,r,JB)}i.outline.body&&(r.outline.color=n.outline.color.get(s),r.outline.minVisibleSize=n.outline.minVisibleSize.get(s),h_(i.outline,r,tU))}function h_(t,e,s){s(t.body,e,Qf,e.shape.body),t.head&&e.shape.head!==null&&s(t.head,e,e0,e.shape.head),t.tail&&e.shape.tail!==null&&s(t.tail,e,s0,e.shape.tail)}function VS(t,e,s,n,i,r,o){if(i.text&&r.content){const a=n,l=a.scaling.get(s);if(r.font=e.fontManager.getFont(a.font.get(s)),r.color=hr(a.color.get(s),o.color),r.position=a.position?a.position.get(s):Ch,r.style=a.style.get(s),r.minVisibleSize=a.minVisibleSize.get(s),r.margin=a.margin.get(s),r.padding=a.padding.get(s),r.maxLineLength=a.maxLineLength.get(s),r.content=u0(r.content,r.maxLineLength),r.adjustAngle=a.adjustAngle.get(s),r.align=a.align.get(s),l){const h=a.scale.get(s);r.sizeScaled=o.widthScaled*h,r.sizeFixed=o.widthFixed*h}else r.sizeFixed=a.size.get(s),r.sizeScaled=0;const u=t.measureText(r.content,r.font,r.style);r.widthScaled=u.width*r.sizeScaled,r.widthFixed=u.width*r.sizeFixed,r.heightScaled=u.height*r.sizeScaled,r.heightFixed=u.height*r.sizeFixed,r.offsetAngle=r===o.texts.primary?RD:FD,eU(i.text,r,o),i.background&&sU(i.background,r,o)}}function jS(t,e){c_(t.body,e,!0,!0),c_(t.outline,e,e.outline.enabled,!0),c_(t.halo,e,!!e.halo.color,!1),HS(t.texts.primary,e.texts.primary),HS(t.texts.secondary,e.texts.secondary)}function c_(t,e,s,n){t.body=s,t.head=s&&n&&!!e.shape.head,t.tail=s&&n&&!!e.shape.tail}function HS(t,e){t.text=!e.hidden&&!!e.content,t.background=t.text&&!!e.backgroundColor}function $S(t,e,s,n,i,r){aU(t,e,s,n,i,r),qS(t,e.texts.primary,s.text,n,e),qS(t,e.texts.secondary,s.text.secondary,n,e)}function aU(t,e,s,n,i,r){const o=i.source,a=i.target,l=s.source.get(n),u=s.target.get(n),h=o.x.get(l),g=o.y.get(l),f=o.radius.get(l),p=o.innerStroke.width.get(l),y=+(o.innerStroke.color.get(l)!==null),_=+(o.innerStroke.scalingMethod.get(l)==="scaled"),x=o.outerStroke.width.get(l),v=+(o.outerStroke.color.get(l)!==null),b=+(o.outerStroke.scalingMethod.get(l)==="scaled"),S=o.color.get(l),A=+(o.scalingMethod.get(l)==="scaled"),w=a.x.get(u),L=a.y.get(u),I=a.radius.get(u),F=a.innerStroke.width.get(u),O=+(a.innerStroke.color.get(u)!==null),V=+(a.innerStroke.scalingMethod.get(u)==="scaled"),j=a.outerStroke.width.get(u),Z=+(a.outerStroke.color.get(u)!==null),at=+(a.outerStroke.scalingMethod.get(u)==="scaled"),pt=a.color.get(u),K=+(a.scalingMethod.get(u)==="scaled"),ut=iU(s.color.get(n),S,pt),ht=s.width.get(n),nt=s.scalingMethod.get(n)==="scaled"?1:0,ot=s.stroke.width.get(n),Nt=s.stroke.scalingMethod.get(n)==="scaled"?1:0,Q=PD[s.shape.style.get(n)],Et=s.adjustAnchors.get(n);if(e.source=l,e.target=u,e.sourceX=h,e.sourceY=g,e.targetX=w,e.targetY=L,e.sourceRadiusScaled=p*y*_+x*v*b+f*A,e.sourceRadiusFixed=p*y*(1-_)+x*v*(1-b)+f*(1-A),e.targetRadiusScaled=F*O*V+j*Z*at+I*K,e.targetRadiusFixed=F*O*(1-V)+j*Z*(1-at)+I*(1-K),e.widthScaled=ht*nt,e.widthFixed=ht*(1-nt),e.curvature=s.curvature.get(n),e.isSelfLoop=l===u,e.color=ut,e.opacity=s.opacity.get(n),e.minVisibleSize=s.minVisibleSize.get(n),e.shape.body=s.shape.body.get(n),e.shape.head=s.shape.head.get(n),e.shape.tail=s.shape.tail.get(n),e.shape.dashLength=Q.dash,e.shape.gapLength=Q.gap,e.shape.isBodyTriangle=e.shape.body==="triangle",e.stroke.color=hr(s.stroke.color.get(n),ut),e.stroke.widthScaled=ot*Nt,e.stroke.widthFixed=ot*(1-Nt),e.stroke.minVisibleSize=s.stroke.minVisibleSize.get(n),e.halo.color=s.halo.color.get(n),e.outline.enabled=s.outline.enabled.get(n),e.textHidden=s.textHidden.get(n)===1,Et&&(e.shape.head||e.shape.tail||e.shape.body==="triangle")){const Xt=e,Ht=Xt.curvature,Zt=Xt.sourceX,ae=Xt.sourceY,pe=Xt.targetX,ne=Xt.targetY;let te=1,se=1;if(Ht){if(!Xt.isSelfLoop){const ce=op(Zt,ae,pe,ne,Ht/2);te=sg(Xt,r,o,l,Zt,ae,ce.x,ce.y),se=sg(Xt,r,a,u,pe,ne,ce.x,ce.y)}}else te=sg(Xt,r,o,l,Zt,ae,pe,ne),se=sg(Xt,r,a,u,pe,ne,Zt,ae);e.sourceRadiusScaled*=te,e.sourceRadiusFixed*=te,e.targetRadiusScaled*=se,e.targetRadiusFixed*=se}}function qS(t,e,s,n,i){e.hidden=i.textHidden,e.content=t.formatText(s.content.get(n)),e.backgroundColor=hr(s.backgroundColor.get(n),i.color)}function sg(t,e,s,n,i,r,o,a){const l=e.angle||0;let u,h=Math.atan2(a-r,o-i)-l,g=1,f=0;h<-Hi?h+=Pd:h>Hi&&(h-=Pd),h<-Hi/2?(f=dC,u=s.badges.topLeft):h<0?(f=hC,u=s.badges.topRight):h<Hi/2?(f=gC,u=s.badges.bottomRight):(f=cC,u=s.badges.bottomLeft),f+=l;const p=u.text.content&&u.text.content.get(n),y=u.image.url&&u.image.url.get(n);if(nU(p)||y){const _=u.positionScale.get(n),x=u.scale.get(n),v=w2(o,a,i,r,i+Math.cos(f)*_,r+Math.sin(f)*_,x);if(v){const b=v.x-i,S=v.y-r,A=Math.sqrt(b*b+S*S);g=Math.max(g,A)}}if(s.shape.get(n)==="square"){const _=Math.abs(Math.cos(h)),x=Math.abs(Math.sin(h)),v=1/Math.max(_,x);g=Math.max(g,v)}return g}function YS(){return{source:0,target:0,sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:!1,color:"",opacity:0,minVisibleSize:0,shape:{body:"line",head:null,tail:null,dashLength:0,gapLength:0,isBodyTriangle:!1},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:!1,color:"",minVisibleSize:0},textHidden:!1,texts:{primary:WS(),secondary:WS()}}}function WS(){return{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,position:Ch,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0}}function lU(t){return t===null?t:void 0}function Rn(t){return typeof t=="boolean"||t===0||t===1?t:void 0}function Oa(t){return typeof t=="number"&&isFinite(t)?t:void 0}function Vs(t){return typeof t=="number"&&isFinite(t)&&t>=0?t:void 0}var JC=-100,uU=400,tL=t=>typeof t=="number"&&isFinite(t)&&t>=JC&&t<=uU?t:void 0;function Qr(t){return t===null||typeof t=="string"||typeof t=="number"?t:void 0}function Jr(t){return t==="fixed"||t==="scaled"?t:void 0}function jo(t){return Wn(t)?t:void 0}function dU(t){return t===pB||t===Ch?t:void 0}function jn(t){return t==="inherit"||Wn(t)?t:void 0}function hU(t){return t==="source"||t==="target"||Wn(t)?t:void 0}function su(t){return t===null?null:typeof t=="string"?t.split(",").map((e=>{const s=e.trim(),n=s.indexOf(" ")!==-1,i=s[0];return n&&i!=='"'&&i!=="'"?`"${s}"`:s})).join(","):void 0}function nu(t){return t==="none"?"normal":t==="normal"||t==="italic"||t==="bold"||t==="italic bold"||t==="bold italic"||t==="100"||t==="200"||t==="300"||t==="400"||t==="500"||t==="600"||t==="700"||t==="800"||t==="900"?t:void 0}function vf(t){return t==="left"||t==="center"?t:void 0}function cU(t){return t==="equilateral"?"pentagon":t==="triangle"?"triangleUp":t==="triangleRight"?"triangle":t==="circle"||t==="square"||t==="cross"||t==="diamond"||t==="pentagon"||t==="hexagon"||t==="star"||t==="triangleUp"||t==="triangleDown"||t==="triangleLeft"||t==="triangle"?t:void 0}var gU=new Set(["line","tapered","arrow","dashed","dotted"]);function fU(t){return gU.has(t)?t:void 0}function pU(t){return t==="line"||t==="triangle"?t:void 0}function XS(t){return t===null||t==="arrow"||t==="circle-hole-arrow"||t==="triangle-hole-arrow"||t==="short-arrow"||t==="sharp-arrow"||t==="circle"||t==="square"?t:void 0}function mU(t){return t==="plain"||t==="dashed"||t==="dotted"?t:void 0}function _U(t){return t==="top"||t==="bottom"||t==="left"||t==="right"||t==="center"?t:void 0}function yU(t){if(Wn(t))return t;if(Array.isArray(t)){if(t.length<1)return;for(let e=0;e<t.length;++e)if(!Wn(t[e]))return;return t}}function Es(t){return function(e){if(typeof e=="number")return isFinite(e)&&e>=0?e:void 0;if(typeof e!="string"||e.charAt(e.length-1)!=="%")return;const s=parseFloat(e);return isNaN(s)?void 0:t*s/100}}function y0(){return{edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0}}function sh(t,e=y0()){const s=(t-JC)*a0+r0;return e.edgeHalo=TD,e.nodeHaloStroke=aC,e.nodeHalo=lC,e.edgeBody=s+uC,e.edgeTextBackground=s+CD,e.edgeText=s+LD,e.nodeBody=s+o0,e.nodeTextBackground=s+kD,e.nodeText=s+ND,e}var xU=(t,e)=>{e.halo.body=e.halo.body||t.halo.body,e.halo.head=e.halo.head||t.halo.head,e.halo.tail=e.halo.tail||t.halo.tail,e.outline.body=e.outline.body||t.outline.body,e.outline.head=e.outline.head||t.outline.head,e.outline.tail=e.outline.tail||t.outline.tail,e.body.body=e.body.body||t.body.body,e.body.head=e.body.head||t.body.head,e.body.tail=e.body.tail||t.body.tail;const s=e.texts,n=t.texts;s.primary.text=s.primary.text||n.primary.text,s.primary.background=s.primary.background||n.primary.background,s.secondary.text=s.secondary.text||n.secondary.text,s.secondary.background=s.secondary.background||n.secondary.background},eL=t=>(e,s)=>{s.halo.body=e.halo.body[t],s.halo.head=e.halo.head[t],s.halo.tail=e.halo.tail[t],s.outline.body=e.outline.body[t],s.outline.head=e.outline.head[t],s.outline.tail=e.outline.tail[t],s.body.body=e.body.body[t],s.body.head=e.body.head[t],s.body.tail=e.body.tail[t],s.texts.primary.text=e.texts.primary.text[t],s.texts.primary.background=e.texts.primary.background[t],s.texts.secondary.text=e.texts.secondary.text[t],s.texts.secondary.background=e.texts.secondary.background[t]},vU=eL("start"),bU=eL("end"),EU=class{constructor({engine:t,imageManager:e,fontManager:s,formatText:n,view:i,attributes:r,attributesPrev:o,nodeAttributes:a,nodeAttributesPrev:l}){this._fullComponents=id(),this._startComponents=id(),this._endComponents=id(),this._startFlags=id(),this._endFlags=id(),this._startInput=YS(),this._endInput=YS(),this._depthInfo=y0(),this._nullElt={id:-1,valid:!0},this._engine=t,this._view=i,this._helper={imageManager:e,fontManager:s,formatText:n},this._attributes=r,this._attributesPrev=o,this._nodeAttributes=a,this._nodeAttributesPrev=l,this._layers=ZS((()=>t.createGroup())),this._blockIds=ZS((()=>0))}drawEdge(t){if(this._computeBlockIds(t),this._attributes.excluded.get(t))return this._freeBlocks();const e=this._engine,s=this._helper,n=-t,i=this._attributes,{bentEnable:r,bentVertical:o}=e.getBentEdges(),a=sh(i.layer.get(t)-(i.detectable.get(t)?0:1),this._depthInfo),l=i.source.get(t),u=i.target.get(t),h=i.curvature.get(t),g=this._attributesPrev.curvature.get(t),f=i.animationDuration.get(t),p=i.animationStart.get(t),y=i.animationEasing.get(t),_=f>0,x=h!==0||_&&g!==0||this._engine.getBentEdges().bentEnable;this._prepareBlocks(_,a,n,x);const v=this._extremitiesAttributes={source:this._nodeAttributes,target:this._nodeAttributes};if($S(s,this._endInput,i,t,v,this._view),jS(this._endFlags,this._endInput),_){const b=this._nodeAttributes.animationDuration.get(l)>0,S=this._nodeAttributes.animationDuration.get(u)>0;v.source=b?this._nodeAttributesPrev:this._nodeAttributes,v.target=S?this._nodeAttributesPrev:this._nodeAttributes,$S(s,this._startInput,this._attributesPrev,t,v,this._view),jS(this._startFlags,this._startInput),xU(this._endFlags,this._startFlags)}this._initComponents(this._fullComponents,this._endFlags,this._layers),bU(this._fullComponents,this._endComponents),this._endComponents.body.body.bentEnable=r,this._endComponents.body.body.bentVertical=o,this._endComponents.body.head&&(this._endComponents.body.head.bentEnable=r,this._endComponents.body.head.bentVertical=o),this._endComponents.body.tail&&(this._endComponents.body.tail.bentEnable=r,this._endComponents.body.tail.bentVertical=o),GS(e,s,t,this._attributes,this._endComponents,this._endInput),this._endComponents.texts.primary.text&&(this._endComponents.texts.primary.background&&(this._endComponents.texts.primary.background.bentEnable=r,this._endComponents.texts.primary.background.bentVertical=o),this._endComponents.texts.primary.text.bentEnable=r,this._endComponents.texts.primary.text.bentVertical=o),this._endComponents.texts.secondary.text&&(this._endComponents.texts.secondary.background&&(this._endComponents.texts.secondary.background.bentEnable=r,this._endComponents.texts.secondary.background.bentVertical=o),this._endComponents.texts.secondary.text.bentEnable=r,this._endComponents.texts.secondary.text.bentVertical=o),_&&(vU(this._fullComponents,this._startComponents),GS(e,s,t,this._attributesPrev,this._startComponents,this._startInput),this._setBlocksAnimation(f,p,y)),this._setupHaloMasking(l,u),this._storeBlocks()}_setupHaloMasking(t,e){const s=this._nodeAttributes.halo,n=this._layers,i=s.color.get(t)&&s.hideNonAdjacentEdges.get(t),r=s.color.get(e)&&s.hideNonAdjacentEdges.get(e),o=!i&&!r?rC:eu;n.body.stencilUsage=n.text.stencilUsage=n.textBg.stencilUsage=o}_computeBlockIds(t){const e=t*tp,s=this._blockIds;s.body=e+bD,s.halo=e+AD,s.text=e+ED,s.textBg=e+SD}_prepareBlocks(t,e,s,n){const i=this._layers;i.body.reset(n?xf:lr,t,e.edgeBody,s),i.halo.reset(n?xf:lr,t,e.edgeHalo,s),i.text.reset(Pa,t,e.edgeText,s),i.textBg.reset(lr,t,e.edgeTextBackground,s)}_storeBlocks(){const t=this._engine,e=this._layers,s=this._blockIds;t.storeGroup(s.body,e.body),t.storeGroup(s.halo,e.halo),t.storeGroup(s.text,e.text),t.storeGroup(s.textBg,e.textBg)}_freeBlocks(){const t=this._engine,e=this._blockIds;t.freeBlock(e.body),t.freeBlock(e.halo),t.freeBlock(e.text),t.freeBlock(e.textBg)}_setBlocksAnimation(t,e,s){const n=this._layers;n.body.setGlobalAnimation(t,e,s),n.halo.setGlobalAnimation(t,e,s),n.text.setGlobalAnimation(t,e,s),n.textBg.setGlobalAnimation(t,e,s)}_initComponents(t,e,s){this._initEdgeComponents(t.halo,e.halo,s.halo),this._initEdgeComponents(t.outline,e.outline,s.body),this._initEdgeComponents(t.body,e.body,s.body),this._initTextComponents(t.texts.primary,e.texts.primary,s),this._initTextComponents(t.texts.secondary,e.texts.secondary,s)}_initEdgeComponents(t,e,s){t.head=this._nextElement(e.head,s),t.tail=this._nextElement(e.tail,s),t.body=this._nextElement(e.body,s)}_initTextComponents(t,e,s){t.background=this._nextElement(e.background,s.textBg),t.text=this._nextElement(e.text,s.text)}_nextElement(t,e){return t?e.next():this._nullElt}};function ZS(t){return{body:t(),halo:t(),text:t(),textBg:t()}}function id(){return{halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}}}function SU(t,e,s){sL(t,e,s),e.imageContent!==null?(t.pattern.type=qo,t.pattern.attributes.image=e.imageContent,t.pattern.attributes.scaled=!0,t.pattern.attributes.duplicated=!1,t.patternScale=e.imageScale,t.patternMinVisibleSize=0,t.patternColor=null):(t.fillColor=null,t.strokeColor=null)}function AU(t,e,s){sL(t,e,s),e.textContent&&(t.pattern.type=Da,t.pattern.attributes.text=e.textContent,t.pattern.attributes.font=e.textFont,t.pattern.attributes.style=e.textStyle,t.pattern.attributes.paddingLeft=e.scale*e.textPaddingLeft*2,t.pattern.attributes.paddingTop=e.scale*e.textPaddingTop*2,t.pattern.attributes.size=Ah,t.patternMinVisibleSize=0,t.patternColor=e.textColor,t.patternScale=e.textScale,t.isBadge=!0),!e.imageUrl&&e.textContent||(t.fillColor=null,t.strokeColor=null)}function sL(t,e,s){const n=e.scalingMethod==="fixed",i=s.diameterScaled*e.scale;let r=0;const o=s.diameterScaled;n&&(r=s.diameterScaled*e.scale);const a=s.diameterScaled*e.positionScale/2,l=s.diameterFixed*e.positionScale/2;t.pieceId=Yi,t.shape="circle",t.x1=s.x,t.y1=s.y,t.x2=s.x,t.y2=s.y,t.rectWidthOrSourceRadiusScaled=i,t.rectWidthOrSourceRadiusFixed=r,t.rectHeightOrTargetRadiusScaled=i,t.rectHeightOrTargetRadiusFixed=r,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.strokeWidthScaled,t.strokeWidthFixed=e.strokeWidthFixed,t.offsetScaled=a,t.offsetFixed=l,t.pattern.type=Xn,t.opacity=s.opacity,t.fillColor=e.color,t.strokeColor=e.strokeColor,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.angle,t.patternScale=0,t.symbolicSize=o,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1,t.isBadge=!0}function wU(t,e,s){ap(t,e),t.fillColor=Array.isArray(e.color)?null:e.color,t.strokeColor=e.innerStroke.color,t.strokeMinVisibleSize=e.innerStroke.minVisibleSize,t.strokeWidthScaled=e.innerStroke.widthScaled,t.strokeWidthFixed=e.innerStroke.widthFixed,s&&(t.pattern.type=Xn)}function ap(t,e){t.pieceId=Yi,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=e.diameterScaled,t.rectWidthOrSourceRadiusFixed=e.diameterFixed,t.rectHeightOrTargetRadiusScaled=e.diameterScaled,t.rectHeightOrTargetRadiusFixed=e.diameterFixed,t.shape=e.shape,t.opacity=e.opacity,t.symbolicSize=e.diameterScaled,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=null,t.strokeColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.offsetAngle=0,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function TU(t,e){const s=e.diameterScaled+2*e.halo.widthScaled,n=e.diameterFixed+2*e.halo.widthFixed;t.pieceId=Yi,t.shape="circle",t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=s,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=s,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=Xn,t.opacity=e.opacity,t.fillColor=e.halo.color,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function CU(t,e){const s=e.diameterScaled+2*e.halo.widthScaled,n=e.diameterFixed+2*e.halo.widthFixed;t.pieceId=Yi,t.shape="circle",t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=s,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=s,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.halo.strokeWidthScaled,t.strokeWidthFixed=e.halo.strokeWidthFixed,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=Xn,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=e.halo.strokeColor,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function LU(t,e){ap(t,e),t.pattern.type=za,t.pattern.attributes.text=e.icon.content,t.pattern.attributes.font=e.icon.font,t.pattern.attributes.style=e.icon.style,t.pattern.attributes.size=Ah,t.patternMinVisibleSize=e.icon.minVisibleSize,t.patternColor=e.icon.color,t.patternScale=e.icon.scale}function kU(t,e){const s=e.image.fit&&!e.image.tile;ap(t,e),t.pattern.type=qo,t.pattern.attributes.image=e.image.content,t.pattern.attributes.scaled=s,t.pattern.attributes.duplicated=e.image.tile,t.patternScale=s?e.image.scale:0,t.patternMinVisibleSize=e.image.minVisibleSize,t.patternColor=null}function NU(t,e){const s=e.diameterScaled+2*e.innerStroke.widthScaled,n=e.diameterFixed+2*e.innerStroke.widthFixed;t.pieceId=Yi,t.shape=e.shape,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=s,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=s,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.outerStroke.widthScaled,t.strokeWidthFixed=e.outerStroke.widthFixed,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=Xn,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=e.outerStroke.color,t.patternColor=null,t.globalMinVisibleSize=e.outerStroke.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function MU(t,e){const s=e.diameterScaled*rS,n=e.diameterFixed*rS;let i=e.diameterScaled*oS,r=e.diameterFixed*oS+MD;e.outerStroke.color&&(i+=e.outerStroke.widthScaled/2,r+=e.outerStroke.widthFixed/2),t.pieceId=Yi,t.shape=e.shape,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=s,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=s,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=i,t.offsetFixed=r,t.pattern.type=Xn,t.opacity=e.opacity,t.fillColor=e.outline.color,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.outline.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=1.5707963267948966,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function IU(t,e){ap(t,e),Array.isArray(e.color)&&(t.pattern.type=Th,t.pattern.attributes.colors=e.color.join(";"),t.patternScale=1,t.patternMinVisibleSize=0,t.patternColor=null)}function RU(t,e,s){nL(t,e,s),t.pattern.type=Xo,t.pattern.attributes.text=e.content,t.pattern.attributes.font=e.font,t.pattern.attributes.style=e.style,t.pattern.attributes.align=e.align,t.patternMinVisibleSize=0,t.patternColor=e.color,t.thicknessOrFontSizeScaled=e.sizeScaled,t.thicknessOrFontSizeFixed=e.sizeFixed,t.isText=!0}function FU(t,e,s){nL(t,e,s),t.fillColor=e.backgroundColor,t.pieceId=Ma,t.shape="square"}function PU(t,e,s){const n=Math.ceil(e.margin/2),i=s.diameterScaled/2,r=s.diameterFixed/2+n,o=DD[e.position],a=Math.cos(o),l=Math.sin(o),u=e.margin<12?1:e.margin<30?1-(e.margin-12)/18*.7:.25;t.pieceId=Yi,t.shape="triangle",t.x1=s.x-a,t.y1=s.y-l,t.x2=s.x+a,t.y2=s.y+l,t.rectWidthOrSourceRadiusScaled=0,t.rectWidthOrSourceRadiusFixed=e.margin,t.rectHeightOrTargetRadiusScaled=0,t.rectHeightOrTargetRadiusFixed=e.margin*u,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=i,t.offsetFixed=r,t.pattern.type=Xn,t.opacity=s.opacity,t.fillColor=e.backgroundColor,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.positionAngle,t.patternScale=0,t.symbolicSize=s.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1}function nL(t,e,s){let n=0,i=0;if(e.isPositionCenter||(n+=s.diameterScaled/2,i+=s.diameterFixed/2+e.margin+e.paddingFixed+e.paddingScaled),e.isPositionVertical){if(n+=e.heightScaled/2,i+=e.heightFixed/2,e===s.texts.secondary&&s.texts.primary.position==="bottom"){const o=s.texts.primary;n+=o.heightScaled,i+=o.heightFixed+o.margin+2*(o.paddingFixed+o.paddingScaled)}}else e.isPositionHorizontal&&(n+=e.widthScaled/2,i+=e.widthFixed/2);const r=Ah;t.pieceId=Yi,t.shape="square",t.x1=s.x,t.y1=s.y,t.x2=s.x,t.y2=s.y,t.rectWidthOrSourceRadiusScaled=e.widthScaled+2*e.paddingScaled,t.rectWidthOrSourceRadiusFixed=e.widthFixed+2*e.paddingFixed,t.rectHeightOrTargetRadiusScaled=e.heightScaled+2*e.paddingScaled,t.rectHeightOrTargetRadiusFixed=e.heightFixed+2*e.paddingFixed,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=n,t.offsetFixed=i,t.pattern.type=Xn,t.pattern.attributes.size=r,t.opacity=s.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.positionAngle,t.patternScale=1,t.symbolicSize=s.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function KS(t,e,s,n,i,r){const o=i.badges,a=n.badges,l=r.badges;zU(t,e,s,n,i,r),QS(t,e,s,n.text,i.texts.primary,r.texts.primary,r),QS(t,e,s,n.text.secondary,i.texts.secondary,r.texts.secondary,r),ng(t,e,s,a.topLeft,o.topLeft,l.topLeft,r),ng(t,e,s,a.topRight,o.topRight,l.topRight,r),ng(t,e,s,a.bottomLeft,o.bottomLeft,l.bottomLeft,r),ng(t,e,s,a.bottomRight,o.bottomRight,l.bottomRight,r)}function zU(t,e,s,n,i,r){if(i.halo){const o=n.halo.width.get(s),a=+(n.halo.scalingMethod.get(s)==="scaled");r.halo.widthScaled=o*a,r.halo.widthFixed=o*(1-a),TU(i.halo,r),i.haloStroke&&(r.halo.strokeWidthScaled=0,r.halo.strokeWidthFixed=n.halo.strokeWidth.get(s),CU(i.haloStroke,r))}if(i.outline&&(r.outline.color=n.outline.color.get(s),r.outline.minVisibleSize=n.outline.minVisibleSize.get(s),MU(i.outline,r)),i.outerStroke&&(r.outerStroke.minVisibleSize=n.outerStroke.minVisibleSize.get(s),NU(i.outerStroke,r)),i.pieChart&&IU(i.pieChart,r),i.image&&(r.image.content=e.imageManager.getImage(r.image.url),r.image.fit=n.image.fit.get(s),r.image.tile=n.image.tile.get(s),r.image.scale=n.image.scale.get(s),r.image.minVisibleSize=n.image.minVisibleSize.get(s),kU(i.image,r)),i.icon&&(r.icon.font=e.fontManager.getFont(n.icon.font.get(s)),r.icon.style=n.icon.style.get(s),r.icon.color=n.icon.color.get(s),r.icon.scale=n.icon.scale.get(s),r.icon.minVisibleSize=n.icon.minVisibleSize.get(s),LU(i.icon,r)),i.body){const o=!i.pieChart&&!i.image&&!i.icon;wU(i.body,r,o)}}function ng(t,e,s,n,i,r,o){if(i.image||i.text){const a=n.stroke.width.get(s),l=+(n.stroke.scalingMethod.get(s)==="scaled");r.color=hr(n.color.get(s),o.color,r.angle),r.strokeColor=n.stroke.color.get(s),r.strokeWidthScaled=a*l,r.strokeWidthFixed=a*(1-l),r.minVisibleSize=n.minVisibleSize.get(s),r.positionScale=n.positionScale.get(s),r.scale=n.scale.get(s)}if(i.image&&(r.imageContent=e.imageManager.getImage(r.imageUrl),r.imageScale=n.image.scale.get(s),SU(i.image,r,o)),i.text){if(r.textFont=e.fontManager.getFont(n.text.font.get(s)),r.textStyle=n.text.style.get(s),r.textColor=hr(n.text.color.get(s),o.color),r.textScale=n.text.scale.get(s),r.textPaddingTop=n.text.paddingTop.get(s),r.textPaddingLeft=n.text.paddingLeft.get(s),t.measureText(r.textContent,r.textFont,r.textStyle,r.textScale).width>1){let a=0,l=0;for(;l<r.textContent.length&&a<1;)a+=t.measureText(r.textContent[l],r.textFont,r.textStyle,r.textScale).width,l+=1;l!==r.textContent.length&&(r.textContent=r.textContent.substring(0,l-1)+"")}AU(i.text,r,o)}}function QS(t,e,s,n,i,r,o){if(i.text&&r.content){const a=n,l=a.scaling.get(s);r.font=e.fontManager.getFont(a.font.get(s)),r.color=hr(a.color.get(s),o.color),r.style=a.style.get(s),r.align=a.align.get(s),r.minVisibleSize=a.minVisibleSize.get(s),r.margin=a.margin.get(s);const u=a.padding.get(s);if(r.maxLineLength=a.maxLineLength.get(s),r.content=u0(r.content,r.maxLineLength),l){const g=a.scale.get(s);r.paddingFixed=0,r.paddingScaled=u*g,r.sizeScaled=o.diameterScaled*g,r.sizeFixed=o.diameterFixed*g}else r.sizeFixed=a.size.get(s),r.sizeScaled=0,r.paddingFixed=u,r.paddingScaled=0;const h=t.measureText(r.content,r.font,r.style);r.widthScaled=h.width*r.sizeScaled,r.widthFixed=h.width*r.sizeFixed,r.heightScaled=h.height*r.sizeScaled,r.heightFixed=h.height*r.sizeFixed,r.positionAngle=zD[r.position],r.isPositionCenter=r.position==="center",r.isPositionVertical=r.position==="top"||r.position==="bottom",r.isPositionHorizontal=r.position==="left"||r.position==="right",RU(i.text,r,o),i.background&&(FU(i.background,r,o),i.tip&&PU(i.tip,r,o))}}function JS(t,e){DU(t,e),t1(t.texts.primary,e.texts.primary),t1(t.texts.secondary,e.texts.secondary),ig(t.badges.topLeft,e.badges.topLeft),ig(t.badges.topRight,e.badges.topRight),ig(t.badges.bottomLeft,e.badges.bottomLeft),ig(t.badges.bottomRight,e.badges.bottomRight)}function DU(t,e){t.body=!0,t.icon=!!e.icon.content,t.image=!!e.image.url,t.pieChart=Array.isArray(e.color),t.outerStroke=!!e.outerStroke.color,t.outline=!!e.outline.enabled,t.halo=!!e.halo.color,t.haloStroke=t.halo&&!!e.halo.strokeColor}function t1(t,e){t.text=!e.hidden&&!!e.content,t.background=t.text&&!!e.backgroundColor,t.tip=t.background&&e.tip&&e.position!=="center"}function ig(t,e){t.text=!!e.textContent,t.image=!!e.imageUrl}function e1(t,e,s,n){OU(t,e,s,n),s1(t,e.texts.primary,s.text,n,e),s1(t,e.texts.secondary,s.text.secondary,n,e),rg(t,e.badges.topLeft,s.badges.topLeft,n),rg(t,e.badges.topRight,s.badges.topRight,n),rg(t,e.badges.bottomLeft,s.badges.bottomLeft,n),rg(t,e.badges.bottomRight,s.badges.bottomRight,n)}function OU(t,e,s,n){const i=+(s.scalingMethod.get(n)==="scaled"),r=2*s.radius.get(n),o=s.innerStroke.width.get(n),a=+(s.innerStroke.scalingMethod.get(n)==="scaled"),l=s.outerStroke.width.get(n),u=+(s.outerStroke.scalingMethod.get(n)==="scaled");e.x=s.x.get(n),e.y=s.y.get(n),e.shape=s.shape.get(n),e.color=s.color.get(n),e.opacity=s.opacity.get(n),e.diameterScaled=r*i,e.diameterFixed=r*(1-i),e.innerStroke.color=hr(s.innerStroke.color.get(n),e.color),e.innerStroke.widthScaled=o*a,e.innerStroke.widthFixed=o*(1-a),e.innerStroke.minVisibleSize=s.innerStroke.minVisibleSize.get(n),e.outerStroke.color=hr(s.outerStroke.color.get(n),e.color),e.outerStroke.widthScaled=l*u,e.outerStroke.widthFixed=l*(1-u),e.halo.color=s.halo.color.get(n),e.halo.strokeColor=s.halo.strokeColor.get(n),e.icon.content=t.formatText(s.icon.content.get(n)),e.image.url=s.image.url.get(n),e.outline.enabled=s.outline.enabled.get(n),e.textHidden=s.textHidden.get(n)===1}function s1(t,e,s,n,i){if(e.hidden=i.textHidden,e.content=t.formatText(s.content.get(n)),e.backgroundColor=hr(s.backgroundColor.get(n),i.color),e===i.texts.primary){const r=s;e.tip=r.tip.get(n),e.position=r.position.get(n)}else e.position="bottom"}function rg(t,e,s,n){const i=s.text.content.get(n);e.textContent=t.formatText(i),e.imageUrl=s.image.url.get(n),e.scalingMethod=s.scalingMethod.get(n)}var og=t=>({angle:t,color:"",scale:0,positionScale:0,minVisibleSize:0,strokeColor:"",strokeWidthScaled:0,strokeWidthFixed:0,scalingMethod:"scaled",textContent:"",textFont:"",textColor:"",textScale:0,textStyle:"none",imageUrl:"",imageContent:null,imageScale:0,textPaddingLeft:0,textPaddingTop:0}),n1=()=>({hidden:!1,content:"",position:"",backgroundColor:"",tip:!1,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",align:"left",minVisibleSize:0,margin:0,paddingScaled:0,paddingFixed:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:!1,isPositionVertical:!1,isPositionHorizontal:!1}),i1=()=>({x:0,y:0,shape:"",color:"",opacity:0,diameterScaled:0,diameterFixed:0,innerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},outerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},icon:{content:"",font:"",color:"",scale:0,size:0,style:"none",minVisibleSize:0},image:{url:"",content:null,scale:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,color:"",strokeColor:""},outline:{enabled:!1,color:"",minVisibleSize:0},badges:{topLeft:og(dC),topRight:og(hC),bottomLeft:og(cC),bottomRight:og(gC)},textHidden:!1,texts:{primary:n1(),secondary:n1()}}),BU=(t,e)=>{e.haloStroke=e.haloStroke||t.haloStroke,e.halo=e.halo||t.halo,e.outline=e.outline||t.outline,e.outerStroke=e.outerStroke||t.outerStroke,e.body=e.body||t.body,e.pieChart=e.pieChart||t.pieChart,e.image=e.image||t.image,e.icon=e.icon||t.icon;const s=t.badges,n=e.badges;n.topLeft.text=n.topLeft.text||s.topLeft.text,n.topLeft.image=n.topLeft.image||s.topLeft.image,n.topRight.text=n.topRight.text||s.topRight.text,n.topRight.image=n.topRight.image||s.topRight.image,n.bottomLeft.text=n.bottomLeft.text||s.bottomLeft.text,n.bottomLeft.image=n.bottomLeft.image||s.bottomLeft.image,n.bottomRight.text=n.bottomRight.text||s.bottomRight.text,n.bottomRight.image=n.bottomRight.image||s.bottomRight.image;const i=t.texts,r=e.texts;r.primary.text=r.primary.text||i.primary.text,r.primary.background=r.primary.background||i.primary.background,r.primary.tip=r.primary.tip||i.primary.tip,r.secondary.text=r.secondary.text||i.secondary.text,r.secondary.background=r.secondary.background||i.secondary.background,r.secondary.tip=r.secondary.tip||i.secondary.tip},iL=t=>(e,s)=>{s.haloStroke=e.haloStroke[t],s.halo=e.halo[t],s.outline=e.outline[t],s.outerStroke=e.outerStroke[t],s.body=e.body[t],s.pieChart=e.pieChart[t],s.image=e.image[t],s.icon=e.icon[t];const n=e.badges,i=s.badges;i.topLeft.text=n.topLeft.text[t],i.topLeft.image=n.topLeft.image[t],i.topRight.text=n.topRight.text[t],i.topRight.image=n.topRight.image[t],i.bottomLeft.text=n.bottomLeft.text[t],i.bottomLeft.image=n.bottomLeft.image[t],i.bottomRight.text=n.bottomRight.text[t],i.bottomRight.image=n.bottomRight.image[t];const r=e.texts,o=s.texts;o.primary.text=r.primary.text[t],o.primary.background=r.primary.background[t],o.primary.tip=r.primary.tip[t],o.secondary.text=r.secondary.text[t],o.secondary.background=r.secondary.background[t],o.secondary.tip=r.secondary.tip[t]},UU=iL("start"),GU=iL("end"),VU=class{constructor({engine:t,imageManager:e,fontManager:s,formatText:n,attributes:i,attributesPrev:r}){this._fullComponents=rd(),this._startComponents=rd(),this._endComponents=rd(),this._startFlags=rd(),this._endFlags=rd(),this._startInput=i1(),this._endInput=i1(),this._depthInfo=y0(),this._nodePatternAssigned=!1,this._nullElt={id:-1,valid:!0},this._engine=t,this._attributes=i,this._attributesPrev=r,this._helper={imageManager:e,fontManager:s,formatText:n},this._layers=r1((()=>t.createGroup())),this._blockIds=r1((()=>0))}drawNode(t){if(this._computeBlockIds(t),this._attributes.excluded.get(t))return this._freeBlocks();const e=this._engine,s=this._helper,n=t,i=this._attributes,r=sh(i.layer.get(t)-(i.detectable.get(t)?0:1),this._depthInfo),o=i.animationDuration.get(t),a=o>0;if(this._prepareBlocks(a,r,n),e1(s,this._endInput,i,t),JS(this._endFlags,this._endInput),a&&(e1(s,this._startInput,this._attributesPrev,t),JS(this._startFlags,this._startInput),BU(this._endFlags,this._startFlags)),this._initComponents(this._fullComponents,this._endFlags,this._layers),GU(this._fullComponents,this._endComponents),KS(e,s,t,i,this._endComponents,this._endInput),a&&(UU(this._fullComponents,this._startComponents),KS(e,s,t,this._attributesPrev,this._startComponents,this._startInput)),a){const l=this._attributes.animationStart.get(t),u=this._attributes.animationEasing.get(t);this._setBlocksAnimation(o,l,u)}this._endFlags.halo&&this._attributes.halo.hideNonAdjacentEdges.get(t)&&(this._layers.halo.stencilUsage=this._layers.haloStroke.stencilUsage=iC),this._storeBlocks()}_computeBlockIds(t){const e=t*tp,s=this._blockIds;s.body=e+mD,s.text=e+_D,s.textBg=e+yD,s.halo=e+xD,s.haloStroke=e+vD}_prepareBlocks(t,e,s){const n=this._layers;n.body.reset(lr,t,e.nodeBody,s),n.text.reset(Pa,t,e.nodeText,s),n.textBg.reset(lr,t,e.nodeTextBackground,s),n.halo.reset(lr,t,e.nodeHalo,s),n.haloStroke.reset(lr,t,e.nodeHaloStroke,s)}_storeBlocks(){const t=this._engine,e=this._layers,s=this._blockIds;t.storeGroup(s.body,e.body),t.storeGroup(s.text,e.text),t.storeGroup(s.textBg,e.textBg),t.storeGroup(s.halo,e.halo),t.storeGroup(s.haloStroke,e.haloStroke)}_freeBlocks(){const t=this._engine,e=this._blockIds;t.freeBlock(e.body),t.freeBlock(e.text),t.freeBlock(e.textBg),t.freeBlock(e.halo),t.freeBlock(e.haloStroke)}_setBlocksAnimation(t,e,s){const n=this._layers;n.body.setGlobalAnimation(t,e,s),n.text.setGlobalAnimation(t,e,s),n.textBg.setGlobalAnimation(t,e,s),n.halo.setGlobalAnimation(t,e,s),n.haloStroke.setGlobalAnimation(t,e,s)}_initComponents(t,e,s){this._nodePatternAssigned=!1,this._initBaseComponents(t,e,s),this._initBadgeComponents(t.badges.topLeft,e.badges.topLeft,s),this._initBadgeComponents(t.badges.topRight,e.badges.topRight,s),this._initBadgeComponents(t.badges.bottomLeft,e.badges.bottomLeft,s),this._initBadgeComponents(t.badges.bottomRight,e.badges.bottomRight,s),this._initTextComponents(t.texts.primary,e.texts.primary,s),this._initTextComponents(t.texts.secondary,e.texts.secondary,s)}_initBaseComponents(t,e,s){t.haloStroke=this._nextElement(e.haloStroke,s.haloStroke),t.halo=this._nextElement(e.halo,s.halo),t.outline=this._nextElement(e.outline,s.body),t.outerStroke=this._nextElement(e.outerStroke,s.body),t.body=this._nextElement(e.body,s.body),t.pieChart=this._getNodePatternElement(e.pieChart,s),t.image=this._getNodePatternElement(e.image,s),t.icon=this._getNodePatternElement(e.icon,s)}_initBadgeComponents(t,e,s){t.image=this._nextElement(e.image,s.body),t.text=this._nextElement(e.text,s.body)}_initTextComponents(t,e,s){t.background=this._nextElement(e.background,s.textBg),t.tip=this._nextElement(e.tip,s.textBg),t.text=this._nextElement(e.text,s.text)}_nextElement(t,e){return t?e.next():this._nullElt}_getNodePatternElement(t,e){return t?this._nodePatternAssigned?e.body.next():(this._nodePatternAssigned=!0,e.body.getCurrentElement()):this._nullElt}};function r1(t){return{body:t(),text:t(),textBg:t(),halo:t(),haloStroke:t()}}function rd(){return{haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}}}function jU({graph:t,elements:e,engine:s,imageManager:n,fontManager:i,view:r,attributes:o,boundaries:a,formatText:l}){const{nodeAttributes:u,nodeAttributesPrev:h,edgeAttributes:g,edgeAttributesPrev:f}=HU(o),{nodes:p,edges:y}=e,{maxSize:_,maxMinVisibleSize:x}=a;if(!p.size&&!y.size)return;const v=(Math.max(t.getNodeMaxIndex(),t.getEdgeMaxIndex())+1)*tp,b=_<1024?8*_:2*_,S=s.setGlobalBoundaries({maxBlockId:Vo(v),maxScaledSize:Vo(b),maxMinVisibleSize:Vo(x),maxSymbolicSize:Vo(_),maxDashLength:3,maxGapLength:1,maxPatternScale:2,maxCoord:-1/0}),A=(S?t.getNodes("_all"):p)._indexes,w=(S?t.getEdges("_all"):y)._indexes;if(A.length){const L=new VU({engine:s,imageManager:n,fontManager:i,formatText:l,attributes:u,attributesPrev:h});for(let I=0;I<A.length;++I)L.drawNode(A[I])}if(w.length){const L=new EU({engine:s,imageManager:n,fontManager:i,formatText:l,view:r,attributes:g,attributesPrev:f,nodeAttributes:u,nodeAttributesPrev:h});for(let I=0;I<w.length;++I)L.drawEdge(w[I])}}function HU(t){const e=Vl(t.nodes.current,{text:{secondary:{scaling:t.nodes.current.text.scaling,maxLineLength:t.nodes.current.text.maxLineLength}}});return{nodeAttributes:e,nodeAttributesPrev:Vl(t.nodes.previous,{textHidden:e.textHidden,text:{secondary:{scaling:t.nodes.previous.text.scaling,maxLineLength:t.nodes.previous.text.maxLineLength}}}),edgeAttributes:Vl(t.edges.current,{text:{secondary:{scaling:t.edges.current.text.scaling,maxLineLength:t.edges.current.text.maxLineLength,adjustAngle:t.edges.current.text.adjustAngle}}}),edgeAttributesPrev:Vl(t.edges.previous,{source:t.edges.current.source,target:t.edges.current.target,textHidden:t.edges.current.textHidden,text:{secondary:{scaling:t.edges.previous.text.scaling,maxLineLength:t.edges.previous.text.maxLineLength,adjustAngle:t.edges.previous.text.adjustAngle}}})}}function nh(t,e,s){const n=s.length;let i=n-1,r=!1;for(let o=0;o<n;++o)(s[o].y<e&&s[i].y>=e||s[i].y<e&&s[o].y>=e)&&(s[o].x<=t||s[i].x<=t)&&(r=r!==s[o].x+(e-s[o].y)/(s[i].y-s[o].y)*(s[i].x-s[o].x)<t),i=o;return r}function ag(t){const e=t.x*t.x+t.y*t.y;return{x:t.x/e,y:t.y/e}}function o1(t,e){let s=1/0,n=-1/0;for(let i=0,r=t.length;i<r;i++){const o=t[i],a=o.x*e.x+o.y*e.y;a<s&&(s=a),a>n&&(n=a)}return{x:s,y:n}}function $U(t,e){let s=t[1],n=t[0],i=ag({x:s.x-n.x,y:s.y-n.y}),r=i.x;i.x=-i.y,i.y=r;const o=i;s=t[2],n=t[1],i=ag({x:s.x-n.x,y:s.y-n.y}),r=i.x,i.x=-i.y,i.y=r;const a=i;s=e[1],n=e[0],i=ag({x:s.x-n.x,y:s.y-n.y}),r=i.x,i.x=-i.y,i.y=r;const l=i;return s=e[2],n=e[1],i=ag({x:s.x-n.x,y:s.y-n.y}),r=i.x,i.x=-i.y,i.y=r,[o,a,l,i]}function rL(t,e){const s=$U(t,e);for(let n=0,i=s.length;n<i;n++){const r=s[n],o=o1(t,r),a=o1(e,r);if((o.x<=a.y&&o.y>=a.x?Math.min(o.y,a.y)-Math.max(o.x,a.x):0)===0)return!1}return!0}function qU(t){let e=0,s=0;const n=t.length;if(n===0)throw new Error("Compute centroid: at least one point is required");for(let i=0;i<n;++i){const r=t[i];e+=r.x,s+=r.y}return e/=n,s/=n,{x:e,y:s}}var oL=Lh(4),aL=Lh(5),lL=Lh(10,.4),Ho=1/3,YU=[{x:-1,y:-Ho},{x:0,y:-Ho},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:0,y:Ho},{x:-1,y:Ho}],uL=[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],WU=[{x:-1,y:-Ho},{x:-.55,y:-Ho},{x:-1,y:-1},{x:1,y:0},{x:-1,y:1},{x:-.55,y:Ho},{x:-1,y:Ho}],a1=[{x:-.6,y:-.3},{x:.1,y:0},{x:-.6,y:.3}],dL=[{x:-1,y:.31},{x:-1,y:-.31},{x:-.31,y:-.31},{x:-.31,y:-1},{x:.31,y:-1},{x:.31,y:-.31},{x:1,y:-.31},{x:1,y:.31},{x:.31,y:.31},{x:.31,y:1},{x:-.31,y:1},{x:-.31,y:.31}],Do={circle:{getDistanceFromStrokeVertically:(t,e)=>1,getDistanceFromStrokeHorizontally:(t,e)=>1-Math.sqrt(t*t+e*e),points:[{x:0,y:0,r:1}],isSimple:!0},square:{getDistanceFromStrokeVertically:(t,e)=>.996-Math.abs(e),getDistanceFromStrokeHorizontally:(t,e)=>.996-Math.abs(t),points:uL,isSimple:!0},line:{getDistanceFromStrokeVertically:(t,e)=>1-Math.abs(e),getDistanceFromStrokeHorizontally:(t,e)=>1,points:[{x:-1,y:0},{x:1,y:0}],isSimple:!0},triangle:{getDistanceFromStrokeVertically:(t,e)=>(1-t)/2-Math.abs(e),getDistanceFromStrokeHorizontally:(t,e)=>1-Math.abs(t),points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},arrow:{getDistanceFromStrokeVertically:(t,e)=>(1-t)/2-Math.abs(e),getDistanceFromStrokeHorizontally:(t,e)=>1-Math.abs(t),points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},"circle-hole-arrow":{getDistanceFromStrokeVertically:(t,e)=>Math.min(Math.sqrt((t+.4)*(t+.4)+e*e)-.27,(1-t)/2-Math.abs(e)),getDistanceFromStrokeHorizontally:(t,e)=>1-Math.abs(t),points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:[{x:-.4,y:0,r:.3}],isSimple:!0},"triangle-hole-arrow":{getDistanceFromStrokeVertically:(t,e)=>{const s=Math.min((1-t)/2-Math.abs(e),1-Math.abs(t)),n=-hL(t,e,a1);return Math.min(s,n)},getDistanceFromStrokeHorizontally:(t,e)=>1,points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:a1,isSimple:!0},"short-arrow":si(YU,!1),"sharp-arrow":si(WU,!1),cross:{getDistanceFromStrokeVertically:(t,e)=>1,getDistanceFromStrokeHorizontally:(t,e)=>{const s=Math.abs(t),n=Math.abs(e),i=.31-Math.min(s,n),r=1-Math.max(s,n);return Math.min(i,r)},points:dL,isSimple:!1},diamond:si(oL),pentagon:si(aL),star:si(lL),triangleUp:si([{x:-1,y:1},{x:1,y:1},{x:0,y:-1}],!0),triangleDown:si([{x:-1,y:-1},{x:1,y:-1},{x:0,y:1}],!0),triangleLeft:si([{x:1,y:-1},{x:1,y:1},{x:-1,y:0}],!0),hexagon:si(Lh(6,1,-Math.PI/2+ep),!1)},XU=["circle","square","triangle","line","triangleUp","triangleDown","triangleLeft"],ZU=["cross","diamond","pentagon","star","hexagon"],KU=["arrow","triangle-hole-arrow","circle-hole-arrow","short-arrow","sharp-arrow"];function l1(t,e){for(const r of XU)g_(t,r);const s=e.nodes.current.shape.getValues(),n=e.edges.current.shape.head.getValues(),i=e.edges.current.shape.tail.getValues();for(const r of ZU)s.includes(r)&&g_(t,r);for(const r of KU)r&&(n.includes(r)||i.includes(r))&&g_(t,r)}function g_(t,e){t.registerShape(e,Do[e])}function QU(t,e){Do.star=si(kl(lL,e,Ll)),Do.pentagon=si(kl(aL,e,Ll)),Do.hexagon=si(kl(Lh(6,1,-Math.PI/2+ep),e,Ll)),Do.square=si(kl(uL,e,Ll)),Do.cross=si(kl(dL,e,Ll)),Do.diamond=si(kl(oL,e,Ll)),["star","pentagon","hexagon","square","cross","diamond"].forEach((s=>t.updateShape(s,Do[s])))}function hL(t,e,s){let n=1/0;const i={x:t,y:e};for(let r=0;r<s.length;++r){const o=s[r],a=s[(r+1)%s.length];n=Math.min(n,NC(i,o,a))}return n*(nh(t,e,s)?1:-1)}function Lh(t,e=1,s=-Math.PI/2+ep){const n=[],i=2*Math.PI/t;let r=s;for(let o=0;o<t;++o){const a=o%2==1?e:1;n.push({x:Math.cos(r)*a,y:Math.sin(r)*a}),r+=i}return n}function si(t,e=!1){return{getDistanceFromStrokeVertically:()=>1,getDistanceFromStrokeHorizontally:(s,n)=>hL(s,n,t),points:t,isSimple:e}}function kl(t,e,s=5){if(e===0)return t;const n=[],i=t.length;for(let r=0;r<i;r++){const o=t[(r+i-1)%i],a=t[r%i],l=t[(r+1)%i],u=o.x-a.x,h=o.y-a.y,g=Math.sqrt(u*u+h*h),f=u/g,p=h/g,y=Math.atan2(p,f),_=l.x-a.x,x=l.y-a.y,v=Math.sqrt(_*_+x*x),b=_/v,S=x/v,A=Math.atan2(S,b),w=f*S-p*b,L=f*b-p*-S;let I=Math.asin(w<-1?-1:w>1?1:w),F=1,O=!1;L<0?I<0?I=Math.PI+I:(I=Math.PI-I,F=-1,O=!0):I>0&&(F=-1,O=!0);const V=I/2;let j=Math.abs(Math.cos(V)*e/Math.sin(V)),Z=e;j>Math.min(g/2,v/2)&&(j=Math.min(g/2,v/2),Z=Math.abs(j*Math.sin(V)/Math.cos(V)));let at=a.x+b*j,pt=a.y+S*j;at+=-S*Z*F,pt+=b*Z*F;const K=y+Math.PI/2*F;let ut=A-Math.PI/2*F-K;ut=O?ut>0?ut-2*Math.PI:ut:ut<0?ut+2*Math.PI:ut;for(let ht=0;ht<s;ht++){const nt=K+ut*(ht/(s-1)),ot=at+Z*Math.cos(nt),Nt=pt+Z*Math.sin(nt);n.push({x:ot,y:Nt})}}return n}var JU=class extends wh{constructor(t,e){super(),this.isDummy=!0,this.width=0,this.height=0,this.namespaceURI="http://www.w3.org/1999/xhtml"}setAttribute(t,e){t==="src"&&(this.src=e),t==="crossOrigin"&&(this.crossOrigin=e)}set src(t){t&&(this._src=t,setTimeout((()=>{this.onload&&this.onload.call(this),this.width=1,this.height=1,this.fire("load")}),10))}get src(){return this._src}addEventListener(t,e){this.on(t,e)}};function t3(t,e){return new(typeof Image<"u"?Image:JU)(t,e)}var e3=class{constructor(){this._images={},this._crossOrigin="anonymous",this._whenReady=[],this._onFetch=[],this._nbLoaded=0,this._nbToLoad=0}setImgCrossOrigin(t){this._crossOrigin=t}clear(){this._images={},this._nbLoaded=0,this._nbToLoad=0}getImage(t){let e=this._images[t];return e===void 0&&(this._nbToLoad+=1,e=t3(),e.crossOrigin=this._crossOrigin,e.addEventListener("load",(()=>this._onImgLoad(t))),e.addEventListener("error",(()=>{this._onImgLoad(t),this._images[t]=null})),aF(e,"src",t),this._images[t]=e),e}_onImgLoad(t){this._nbLoaded+=1,this._onFetch.forEach((e=>e(t))),this._nbLoaded===this._nbToLoad&&(this._whenReady.forEach((e=>e())),this._whenReady=[])}onFetch(t){this._onFetch.push(t)}whenReady(){return this._nbLoaded===this._nbToLoad?Promise.resolve():new Promise((t=>this._whenReady.push(t)))}destroy(){this._whenReady=[],this._onFetch=[]}},x0={};mh(x0,{BUTTON_MAPPING:()=>Bx,BoundingBox:()=>ri,DummyCanvas:()=>fC,DummyCanvasRenderingContext2D:()=>pC,DummyDomElement:()=>n2,DummyFileReader:()=>t2,DummyTextNode:()=>qL,DummyXHR:()=>JT,ElementSet:()=>kh,EventTarget:()=>wh,FlexArray:()=>ff,IndexList:()=>G2,MOUSE_WHEEL_THROTTLE:()=>WT,Map2:()=>nC,PathMap:()=>GL,PrioritySet:()=>P2,SVG_NS:()=>Dx,Table:()=>by,XLINK:()=>o2,XML_NS:()=>uy,applyCursorStyle:()=>uf,baseURI:()=>c2,binaryIndexOf:()=>aT,cancelAnimFrame:()=>XT,clamp:()=>qi,clearCanvas:()=>Ny,componentsToRGBA:()=>tC,computeMax:()=>Hl,computeMin:()=>Kr,concatenateArrays:()=>XI,createBlob:()=>Zd,createCanvas:()=>Pn,createDummyDomElement:()=>af,createDummyXmlDocument:()=>WL,createElement:()=>dy,createSvgElement:()=>ys,createTextNode:()=>Ox,createWebGL2Context:()=>_C,createWorker:()=>HL,createXmlDocument:()=>XL,dataUrlToBlob:()=>i2,debounce:()=>QI,deepCopy:()=>Xs,displayPixelsOnScreen:()=>x3,ensureTransferable:()=>Uf,escapeDOMAttribute:()=>jl,extendList:()=>eR,fadeElement:()=>g2,fetch:()=>vu,fetchBinary:()=>d2,fetchBinaryAsBase64:()=>h2,flatten:()=>Wd,flattenArray:()=>oT,fontSizeToBadgeScale:()=>UL,forEach:()=>kr,formatAngle:()=>df,formatHex:()=>Vg,formatWorkerMessage:()=>jL,getBaseLog:()=>f2,getCurrentTime:()=>$n,getDate:()=>bT,getDocument:()=>ao,getDocumentFontRules:()=>DL,getEmbeddedFontRules:()=>OL,getFlattenedKeys:()=>Ga,getGlContext:()=>yC,getImage:()=>a2,getLeafValues:()=>Bf,getOptions:()=>Ni,getPixelRatio:()=>vi,getProperty:()=>qs,getResizeObserver:()=>e2,getStyle:()=>s2,getTime:()=>ET,getValues:()=>Id,getWebglContext:()=>l0,hash8:()=>Q_,htmlSanitizer:()=>Ux,indexArrayToArray:()=>qd,indexByName:()=>sR,insertSortAsc:()=>fd,insertSortDesc:()=>WI,isArray:()=>Fn,isBlob:()=>sP,isHTMLElement:()=>u2,isInteger:()=>KI,isLittleEndian:()=>Of,isObject:()=>cn,isRawObject:()=>Ua,isWebGLSupported:()=>mC,lerp:()=>bs,lightDebounce:()=>lT,mapKeys:()=>eC,mapValues:()=>sC,merge:()=>Vl,mergeValues:()=>Kg,mix:()=>hy,nextPowerOfTwo:()=>Vo,objToValueList:()=>lp,parseColor:()=>Wn,parseColorHex:()=>t0,parseColorRgba:()=>Jx,pick:()=>ty,processQueue:()=>JI,promiseQueue:()=>dT,promptDownload:()=>ta,propertyPathToString:()=>K_,removeFromArray:()=>ZI,requestAnimFrame:()=>Fx,resizeElement:()=>lf,resolvePath:()=>BL,rgbaToRgb:()=>Dl,serializeXMLDocument:()=>T0,setAttributes:()=>zx,setCtxFont:()=>Zo,setElementSize:()=>ja,setKeys:()=>f3,setProperty:()=>so,setValues:()=>wd,smartRequire:()=>$i,throttle:()=>Yd,toArray:()=>Z_,toHexa:()=>Cy,toPropertyPath:()=>Ba,traverse:()=>cT,unflatten:()=>J_,unorderedHash:()=>tR,workerIsAvailable:()=>VL});var ni="Arial",Ko="black",bf="rgba(255,255,255,0)",fu=12,ih=3,v0=7,s3=!0,b0=10,n3=5,cL=.08,gL="rgba(255,255,255,0)",fL="normal",pL="center",mL=!1,_L=0,Dy="red",yL="rgb(220, 220, 220)",xL="red",vL="rgb(220, 220, 220)",bL="grey",EL="white",E0=2,SL=null,S0=5,Oy=0,AL="rgba(0, 0, 0, 0.36)",i3=1,r3="circle",By=12,Ed="white",Ql=40,Sd="black",Jl=2,Ad="black",A0=40,wL=null,TL=null,w0=1,CL="black",LL=1e3,kL=800,NL=1,ML=2,IL="rgba(0, 0, 0, 0.0)",RL="rgba(0, 0, 0, 0.6)",FL=50,o3=.1,Nl=12,lg=24,rh=1,Uy=rh/2,u1=.45,d1=.7,a3=10,PL=a3/2,zL=5;function l3(t){let e="";for(let s=0;s<t.length;s++)e+=t[s].cssText+`
`;return e}function DL(){const t=ao(),e=t.styleSheets||[],s=c2(t),n=[],i=[];for(let o=0;o<e.length;o++){const a=e[o];a.href==null?n.push({href:s,content:l3(a.cssRules)}):i.push(a.href)}const r=/@font-face\s*\{[^}]+\}/g;return Promise.all(i.map((o=>vu(o).then((a=>({href:o,content:a}))).catch(tf)))).then((o=>o.concat(n))).then((o=>{const a=[];for(let l=0;l<o.length;l++){const u=o[l];if(u!==null){const{href:h,content:g}=u,f=g.match(r);if(f){const p=d3(f,h);a.push.apply(a,p)}}}return a}))}function OL(t,e){return Promise.all(t.map((({formats:s,originalRule:n})=>Promise.all(s.map((({format:i,url:r})=>e?h2(r).then((o=>({format:i,src:o}))).catch(tf):{format:i,src:r}))).then((i=>{const r=[];for(const o of i)o!==null&&r.push(`url('${o.src}') format('${o.format}')`);if(r.length!==0){const o=`src: ${r.join(",")}`;return n.replace(/@font-face\s*{([^}]*);?}/,`@font-face{$1;${o}}`).replace(/\s+/," ").replace(/;+/,";")}return n})))))}var u3={"embedded-opentype":!0,svg:!0};function d3(t,e){const s=/url\(['"]?([^'")]+)['"]?\)\s+format\(['"]?([^'")]+)['"]?\)/g,n=/font-family\s*:\s*['"]?([^;'"]+)['"]?;/,i=[];for(let r=0;r<t.length;r++){const o=t[r],a=o.match(n);if(a){const l=a[1],u=[];let h;for(;h=s.exec(o);){const g=h[1],f=h[2];u3[f.toLowerCase()]||u.push({format:f,url:BL(g,e)})}i.push({name:l,formats:u,originalRule:o})}}return i}function BL(t,e){if(/^http(s)?:/.test(t))return t;if(t[0]==="/"){const i=e.match(/((\w+:\/\/)([^/]+))/);return i?i[1]+t:t}const s=t.split("/"),n=e.split("/");for(e[e.length-1]!=="/"&&n.pop();s[0]==="..";)s.shift(),n.pop();return n.concat(s).join("/").replace(/[\w](\/{2,})/g,(i=>i[0]+"/"))}function UL(t,e,s=Uy){return t/s/(2*e)}function h3(t){return t instanceof RegExp||t instanceof Date}var c3=typeof HTMLElement>"u"?t=>!1:t=>t instanceof HTMLElement,g3=function(t){return typeof t!="object"||t===null||Fn(t)||h3(t)};function lp(t,e=[],s=[]){if(!c3(t)){if(g3(t))e.push({path:s.slice(),value:t});else{const n=Object.keys(t);for(let i=0;i<n.length;++i){const r=n[i],o=s.slice();o.push(r),lp(t[r],e,o)}}return e}}var GL=class{constructor(){this._keys=[],this._values=[],this._size=0,this._cachedPath=[],this._cachedIndex=-1}get size(){return this._size}set(t,e){const s=this._getIndex(t);s!==-1?this._values[s]=e:(f_(this._cachedPath,t)&&(this._cachedIndex=this._keys.length),this._keys.push(t),this._values.push(e),this._size+=1)}get(t){const e=this._getIndex(t);if(e!==-1)return this._values[e]}has(t){return this._getIndex(t)!==-1}keys(){return this._keys.slice()}_getIndex(t){if(f_(t,this._cachedPath))return this._cachedIndex;this._cachedPath=t.slice();const e=this._keys;for(let s=0;s<e.length;++s)if(f_(e[s],t))return this._cachedIndex=s,s;return this._cachedIndex=-1,-1}};function f_(t,e){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(t[s]!==e[s])return!1;return!0}var Gy,f3=function(e){return Array.from(e.keys())},wd=function(e){return Array.from(e.values())},oh=$i("web-worker"),VL=!!oh||typeof Worker<"u"&&typeof Blob<"u";function jL(t){return oh?Vy(t):t}function Vy(t){if(ArrayBuffer.isView(t))return Array.from(t);if(Array.isArray(t)){for(let e=0;e<t.length;e++)t[e]=Vy(t[e]);return t}if(cn(t)){const e=Object.keys(t);for(const s of e)t[s]=Vy(t[s]);return t}return t}function HL(t){return oh?m3(t.toString()):p3(t)}function p3(t){return lF(HR(t))}function m3(t){if(oh)return new oh("data:application/javascript,"+t.replace(/\n/g,""))}var h1=$i("@xmldom/xmldom");Gy=typeof XMLSerializer<"u"?XMLSerializer:h1?h1.XMLSerializer:null;var _3=class $L{constructor(e){this._attributes={},this._children=[],this._name=e}setAttribute(e,s){this._attributes[e]=s}appendChild(e){this._children.push(e)}get tagName(){return this._name}get children(){return this._children}get childNodes(){return this._children}get firstChild(){return this._children[0]||null}serialize(){const e=this._name,s=this._attributes,n=this._children,i=Object.keys(s).filter((o=>s[o]!==void 0)).map((o=>` ${o}="${""+s[o]}"`)).join(""),r=n.map((o=>o.serialize())).join("");return r.length?`<${e}${i}>${r}</${e}>`:`<${e}${i}/>`}cloneNode(e){const s=new $L(this._name),n=Object.keys(this._attributes);for(const i of n)s.setAttribute(i,this._attributes[i]);if(e)for(let i=0;i<this._children.length;i++)s.appendChild(this._children[i].cloneNode(e));return s}},qL=class YL{constructor(e){this._text=e}serialize(){return this._text}cloneNode(){return new YL(this._text)}},y3=class{constructor(){this._children=[],this._meta=[],this._children=[],this._meta=[]}appendChild(t){this._children.push(t)}serialize(){return this._meta.concat(this._children.map((t=>t.serialize()))).join("")}createElement(t){return new _3(t)}createTextNode(t){return new qL(t)}},WL=()=>new y3;function T0(t){if(Gy)return new Gy().serializeToString(t)}var XL=()=>ao().implementation.createDocument("","",null),kh=class{constructor(t,e){this._graph=t,this._nodes={elementList:t.nodeList,flexArray:t.createNodeAttribute({storage:1,name:e},!!e),indexList:t.createIndexList(!0)},this._edges={elementList:t.edgeList,flexArray:t.createEdgeAttribute({storage:1,name:e},!!e),indexList:t.createIndexList(!1)}}_get(t){return t.isNode?this._nodes:this._edges}addOrRemoveElements(t,e){return e?this.addElements(t):this.removeElements(t)}addElements(t){const{elementList:e,flexArray:s,indexList:n}=this._get(t),i=n.getLength();for(let r=0;r<t._indexes.length;r++){const o=t._indexes[r];s.get(o)!==1&&(s.set(o,1),n.pushUnchecked(o))}return e(n.slice(i))}removeElements(t){const{elementList:e,flexArray:s,indexList:n}=this._get(t),i=n.getLength(),r=n.getBuffer();if(i>r.length)return this.clear(),this.addElements(t),t;let o=0;for(let a=0;a<t._indexes.length;a++){const l=t._indexes[a];s.get(l)!==0&&(s.set(l,0),o+=1)}if(o===i)return e(n.sliceAndReset());if(o===0)return e();{const a=this._graph.acquireIndexList(t.isNode);let l=0;for(let u=0;u<i;++u){const h=r[u];s.get(h)===0?(l+=1,a.pushUnchecked(h)):r[u-l]=h}return n.setLength(i-o),e(a.sliceAndReset())}}hasElement(t){return!!this._get(t).flexArray.get(t._index)}clear(){this._nodes.indexList.isEmpty()||(this._nodes.indexList.reset(),this._nodes.flexArray.reset()),this._edges.indexList.isEmpty()||(this._edges.indexList.reset(),this._edges.flexArray.reset())}isEmpty(){return this._nodes.indexList.isEmpty()&&this._edges.indexList.isEmpty()}getElements(){return{nodes:this._nodes.elementList(this._nodes.indexList.slice()),edges:this._edges.elementList(this._edges.indexList.slice())}}};function x3(t,e,s,n=0){e===void 0&&(e=s=Math.sqrt(t.length/4)),s===void 0&&(s=e);const i=document.createElement("canvas"),r=i.getContext("2d");if(r){const o=r.createImageData(e,s);i.style.imageRendering="pixelated",i.style.border="1px solid black",i.style.margin="2px",i.style.position="absolute",i.style.top=i.style.left="0px",i.width=e,i.height=s,o.data.set(t),r.putImageData(o,0,0);const a=document.getElementById("graph-container");a&&(a.style.position="static"),setTimeout((()=>document.body.appendChild(i)),n)}}var v3=class{constructor(t,e){this._attributesManager=t,this._id=e}getDefinition(){return this._attributesManager.getAttributeLayerDefinition(this._id)}update(t){this._attributesManager.updateAttributeLayer(this._id,t)}destroy(){this._attributesManager.destroyAttributeLayer(this._id)}updateElements(t){this._attributesManager.updateElementsForAttributeLayer(this._id,t)}updateAll(){this._attributesManager.updateAllForAttributeLayer(this._id)}setAttributeValues(t,e,s){this._attributesManager.setAttributeLayerValues(this._id,t,e,s)}getUsedAttributeNames(t){return this._attributesManager.getUsedAttributeLayerAttributes(this._id,t)}getFlexArrays(){return this._attributesManager.getAttributeLayerFlexArrays(this._id)}},C0={};mh(C0,{cubicIn:()=>A3,cubicInOut:()=>T3,cubicOut:()=>w3,linear:()=>Ef,quadraticIn:()=>b3,quadraticInOut:()=>S3,quadraticOut:()=>E3});var Ef=t=>t,b3=t=>t*t,E3=t=>t*(2-t),S3=t=>(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1),A3=t=>t*t*t,w3=t=>--t*t*t+1,T3=t=>(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2),C3={name:"animationStart",storage:32,default:0},L3={name:"animationDuration",storage:16,default:0},k3={name:"animationEasing",storage:"resource",default:"linear"},N3={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentNodes:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:void 0,allEdges:void 0},M3={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},extremities:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},parallelEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:void 0,allEdges:void 0},I3={x:1,y:1,radius:1,"halo.hideNonAdjacentEdges":1};function Ud(t){return typeof t=="string"}var jy=1,ZL="scaled",KL="grey",QL=1,JL=0,tk=0,ek=!0,sk=0,nk=!0,ik="line",rk=null,ok=null,ak="plain",lk="inherit",Hy=0,uk="fixed",dk=0,hk=null,$y=10,ck="fixed",gk=1e3,fk=800,pk="rgba(0, 0, 0, 0.6)",mk="rgba(0, 0, 0, 0)",_k=10,yk=1,xk=2,vk="rgba(0, 0, 0, 0.36)",bk=0,R3=1,Ek="normal",Sk="center",Ak=2,qy=2,wk=Ch,Tk=4,Ck=!0,Lk=4,Yy=2,Wy=12,kk=2;function F3(t,e,s){let n,i,r,o;s==="line"?(n="line",i="plain",r=null,o=null):s==="arrow"?(n="line",i="plain",r="arrow",o=null):s==="tapered"?(n="triangle",i="plain",r=null,o=null):s==="dashed"?(n="line",i="dashed",r=null,o=null):s==="dotted"&&(n="line",i="dotted",r=null,o=null),t.shape.body.set(e,n),t.shape.style.set(e,i),t.shape.head.set(e,r),t.shape.tail.set(e,o)}var Nk={width:{_flexArray:jy,_check:Es(jy)},scalingMethod:{_flexArray:ZL,_check:Jr},color:{_flexArray:KL,_check:hU},opacity:{_flexArray:QL,_check:Vs},minVisibleSize:{_flexArray:JL,_check:Vs},layer:{_flexArray:tk,_check:tL},detectable:{_flexArray:ek,_check:Rn},curvature:{_flexArray:sk,_check:Oa},adjustAnchors:{_flexArray:nk,_check:Rn},shape:{_check:fU,_set:F3,type:"shape.head",body:{_flexArray:ik,_check:pU},head:{_flexArray:rk,_check:XS},tail:{_flexArray:ok,_check:XS},style:{_flexArray:ak,_check:mU}},stroke:{color:{_flexArray:lk,_check:jn},width:{_flexArray:Hy,_check:Es(Hy)},scalingMethod:{_flexArray:uk,_check:Jr},minVisibleSize:{_flexArray:dk,_check:Vs}},strokeWidth:"stroke.width",halo:{_alias:"halo.color",color:{_flexArray:hk,_check:jo},width:{_flexArray:$y,_check:Es($y)},scalingMethod:{_flexArray:ck,_check:Jr},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:Rn},duration:{_flexArray:gk,_check:Vs},interval:{_flexArray:fk,_check:Vs},startColor:{_flexArray:pk,_check:jn},endColor:{_flexArray:mk,_check:jn},width:{_flexArray:_k,_check:Vs},startRatio:{_flexArray:yk,_check:Vs},endRatio:{_flexArray:xk,_check:Vs}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:Rn},color:{_flexArray:vk,_check:jo},minVisibleSize:{_flexArray:bk,_check:Vs}},text:{_alias:"text.content",content:{_flexArray:null,_check:Qr},font:{_flexArray:ni,_check:su},color:{_flexArray:Ko,_check:jo},size:{_flexArray:fu,_check:Es(fu)},scale:{_flexArray:1,_check:Vs},style:{_flexArray:Ek,_check:nu},align:{_flexArray:Sk,_check:vf},margin:{_flexArray:Ak,_check:Oa},padding:{_flexArray:qy,_check:Es(qy)},backgroundColor:{_flexArray:bf,_check:jn},minVisibleSize:{_flexArray:Tk,_check:Vs},position:{_flexArray:wk,_check:dU},adjustAngle:{_flexArray:Ck,_check:Rn},scaling:{_flexArray:mL,_check:Rn},maxLineLength:{_flexArray:_L,_check:Vs},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Qr},font:{_flexArray:ni,_check:su},color:{_flexArray:Ko,_check:jo},size:{_flexArray:Wy,_check:Es(Wy)},scale:{_flexArray:cL,_check:Vs},style:{_flexArray:fL,_check:nu},align:{_flexArray:pL,_check:vf},margin:{_flexArray:kk,_check:Oa},padding:{_flexArray:Yy,_check:Es(Yy)},backgroundColor:{_flexArray:gL,_check:jn},minVisibleSize:{_flexArray:Lk,_check:Vs}}}},P3=Es(zL),z3=Es(fu),D3=Es(b0),O3=Es(E0),B3=Es(S0),U3=Es(v0),c1=Es(ih),G3=Es(PL),V3=Es(A0),j3=Es(w0);function ug(t){return{_check:Qr,_set:(e,s,n)=>{e.badges[t].text.content.set(s,n),n==null&&e.badges[t].image.url.set(s,n)},_get:(e,s)=>e.badges[t].text.content.get(s),color:{_flexArray:Ed,_check:jn},scale:{_flexArray:u1,_check:Es(u1)},positionScale:{_flexArray:1,_check:Vs},minVisibleSize:{_flexArray:Ql,_check:Es(Ql)},scalingMethod:{_flexArray:"scaled",_check:Jr},image:{_alias:`badges.${t}.image.url`,url:{_flexArray:null,_check:Qr},scale:{_flexArray:rh,_check:Es(rh)}},stroke:{color:{_flexArray:Sd,_check:jn},width:{_flexArray:Jl,_check:Es(Jl)},scalingMethod:{_flexArray:"fixed",_check:Jr}},text:{_alias:`badges.${t}.text.content`,content:{_flexArray:null,_check:Qr},color:{_flexArray:Ad,_check:jn},font:{_flexArray:ni,_check:su},style:{_flexArray:"normal",_check:nu},scale:{_flexArray:Uy,_check:Es(Uy)},paddingLeft:{_flexArray:0,_check:Oa},paddingTop:{_flexArray:0,_check:Oa}}}}var Mk={x:{_flexArray:0,_check:Oa,_disableMemoryOptimization:!0},y:{_flexArray:0,_check:Oa,_disableMemoryOptimization:!0},radius:{_flexArray:zL,_check:P3},scalingMethod:{_flexArray:"scaled",_check:Jr},color:{_flexArray:bL,_check:yU},opacity:{_flexArray:1,_check:Vs},shape:{_flexArray:"circle",_check:cU},layer:{_flexArray:0,_check:tL},detectable:{_flexArray:!0,_check:Rn},draggable:{_flexArray:!0,_check:Rn},layoutable:{_flexArray:!0,_check:Rn},innerStroke:{_alias:"innerStroke.color",width:{_flexArray:E0,_check:O3},scalingMethod:{_flexArray:"fixed",_check:Jr},color:{_flexArray:EL,_check:jn},minVisibleSize:{_flexArray:By,_check:Es(By)}},outerStroke:{_alias:"outerStroke.color",width:{_flexArray:S0,_check:B3},scalingMethod:{_flexArray:"fixed",_check:Jr},color:{_flexArray:SL,_check:jn},minVisibleSize:{_flexArray:Oy,_check:Es(Oy)}},badges:{_check:lU,_set(t,e,s){t.badges.topLeft.text.content.set(e,s),t.badges.topLeft.image.url.set(e,s),t.badges.topRight.text.content.set(e,s),t.badges.topRight.image.url.set(e,s),t.badges.bottomLeft.text.content.set(e,s),t.badges.bottomLeft.image.url.set(e,s),t.badges.bottomRight.text.content.set(e,s),t.badges.bottomRight.image.url.set(e,s)},topLeft:ug("topLeft"),topRight:ug("topRight"),bottomLeft:ug("bottomLeft"),bottomRight:ug("bottomRight")},halo:{_alias:"halo.color",color:{_flexArray:wL,_check:jo},width:{_flexArray:A0,_check:V3},scalingMethod:{_flexArray:"fixed",_check:Jr},strokeColor:{_flexArray:TL,_check:jo},strokeWidth:{_flexArray:w0,_check:j3},clustering:{_flexArray:!1,_check:Rn},hideNonAdjacentEdges:{_flexArray:!1,_check:Rn}},pulse:{enabled:{_flexArray:!1,_check:Rn},duration:{_flexArray:LL,_check:Vs},interval:{_flexArray:kL,_check:Vs},startColor:{_flexArray:RL,_check:jn},endColor:{_flexArray:IL,_check:jn},width:{_flexArray:FL,_check:Vs},startRatio:{_flexArray:NL,_check:Vs},endRatio:{_flexArray:ML,_check:Vs}},icon:{_alias:"icon.content",content:{_flexArray:null,_check:Qr},font:{_flexArray:ni,_check:su},color:{_flexArray:CL,_check:jo},scale:{_flexArray:d1,_check:Es(d1)},style:{_flexArray:"normal",_check:nu},minVisibleSize:{_flexArray:Nl,_check:Es(Nl)}},image:{_alias:"image.url",url:{_flexArray:null,_check:Qr},scale:{_flexArray:rh,_check:Es(rh)},fit:{_flexArray:!0,_check:Rn},tile:{_flexArray:!1,_check:Rn},minVisibleSize:{_flexArray:Nl,_check:Es(Nl)}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:Rn},color:{_flexArray:AL,_check:jo},minVisibleSize:{_flexArray:Nl,_check:Es(Nl)}},text:{_alias:"text.content",content:{_flexArray:null,_check:Qr},font:{_flexArray:ni,_check:su},color:{_flexArray:Ko,_check:jn},size:{_flexArray:fu,_check:z3},scale:{_flexArray:o3,_check:Vs},style:{_flexArray:"normal",_check:nu},align:{_flexArray:"center",_check:vf},margin:{_flexArray:v0,_check:U3},padding:{_flexArray:ih,_check:c1},backgroundColor:{_flexArray:null,_check:jn},tip:{_flexArray:!0,_check:Rn},minVisibleSize:{_flexArray:lg,_check:Es(lg)},scaling:{_flexArray:!1,_check:Rn},position:{_flexArray:"bottom",_check:_U},maxLineLength:{_flexArray:0,_check:Vs},truncateLength:{_flexArray:0,_check:Vs},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Qr},font:{_flexArray:ni,_check:su},color:{_flexArray:Ko,_check:jn},size:{_flexArray:b0,_check:D3},scale:{_flexArray:.08,_check:Vs},style:{_flexArray:"normal",_check:nu},align:{_flexArray:"center",_check:vf},margin:{_flexArray:PL,_check:G3},padding:{_flexArray:ih,_check:c1},backgroundColor:{_flexArray:null,_check:jn},minVisibleSize:{_flexArray:lg,_check:Es(lg)}}}},H3=t=>(e,s)=>e[t].get(s),$3=(t,e)=>(s,n)=>s[t][e].get(n),q3=(t,e,s)=>(n,i)=>n[t][e][s].get(i),Y3=(t,e,s,n)=>(i,r)=>i[t][e][s][n].get(r),W3=t=>(e,s,n)=>e[t].set(s,n),X3=(t,e)=>(s,n,i)=>s[t][e].set(n,i),Z3=(t,e,s)=>(n,i,r)=>n[t][e][s].set(i,r),K3=(t,e,s,n)=>(i,r,o)=>i[t][e][s][n].set(r,o),Q3=[H3,$3,q3,Y3],J3=[W3,X3,Z3,K3];function g1(t,e){if(!t._check)throw new Error(`error somewhere for ${e}`);const s=e.split("."),n=s.length-1,i=Q3[n].apply(null,s),r=J3[n].apply(null,s);return{check:t._check,set:r,get:i,nested:{}}}function Sf(t,e){const s=e?Mk:Nk,n=typeof t=="string"?[t]:Ga(t,"",[]);let i=!1;const r=[];for(let o=0;o<n.length;o++){const a=n[o].split(".");let l=s[a[0]];for(let h=1;h<a.length;h++)l=l[a[h]];l.type&&(n[o]=l.type),l._alias&&(n[o]=l._alias),n[o]==="badges"&&(n[o]="badges.topLeft.text.content",i=!0);const u=a[a.length-1];u!=="topLeft"&&u!=="topRight"&&u!=="bottomLeft"&&u!=="bottomRight"||(n[o]=`badges.${u}.text.content`,r.push(`badges.${u}.image.url`)),n[o]==="strokeWidth"&&(n[o]="stroke.width")}return i&&(n.push("badges.topLeft.image.url"),n.push("badges.topRight.text.content"),n.push("badges.topRight.image.url"),n.push("badges.bottomLeft.text.content"),n.push("badges.bottomLeft.image.url"),n.push("badges.bottomRight.text.content"),n.push("badges.bottomRight.image.url")),n.push(...r),n}var dg=t=>(e,s)=>({url:e.badges[t].image.url.get(s),scale:e.badges[t].image.scale.get(s)}),hg=t=>(e,s)=>({color:e.badges[t].stroke.color.get(s),width:e.badges[t].stroke.width.get(s),scalingMethod:e.badges[t].stroke.scalingMethod.get(s)}),cg=t=>(e,s)=>({content:e.badges[t].text.content.get(s),color:e.badges[t].text.color.get(s),font:e.badges[t].text.font.get(s),style:e.badges[t].text.style.get(s),scale:e.badges[t].text.scale.get(s),paddingLeft:e.badges[t].text.paddingLeft.get(s),paddingTop:e.badges[t].text.paddingTop.get(s)}),gg=t=>(e,s)=>({color:e.badges[t].color.get(s),scale:e.badges[t].scale.get(s),positionScale:e.badges[t].positionScale.get(s),minVisibleSize:e.badges[t].minVisibleSize.get(s),image:{url:e.badges[t].image.url.get(s),scale:e.badges[t].image.scale.get(s)},stroke:{color:e.badges[t].stroke.color.get(s),width:e.badges[t].stroke.width.get(s),scalingMethod:e.badges[t].stroke.scalingMethod.get(s)},text:{content:e.badges[t].text.content.get(s),color:e.badges[t].text.color.get(s),font:e.badges[t].text.font.get(s),style:e.badges[t].text.style.get(s),scale:e.badges[t].text.scale.get(s),paddingLeft:e.badges[t].text.paddingLeft.get(s),paddingTop:e.badges[t].text.paddingTop.get(s)}}),Po={topLeft:gg("topLeft"),topRight:gg("topRight"),bottomLeft:gg("bottomLeft"),bottomRight:gg("bottomRight")},rr={stroke:(t,e)=>({color:t.stroke.color.get(e),width:t.stroke.width.get(e),scalingMethod:t.stroke.scalingMethod.get(e),minVisibleSize:t.stroke.minVisibleSize.get(e)}),innerStroke:(t,e)=>({width:t.innerStroke.width.get(e),scalingMethod:t.innerStroke.scalingMethod.get(e),color:t.innerStroke.color.get(e),minVisibleSize:t.innerStroke.minVisibleSize.get(e)}),outerStroke:(t,e)=>({width:t.outerStroke.width.get(e),scalingMethod:t.outerStroke.scalingMethod.get(e),color:t.outerStroke.color.get(e),minVisibleSize:t.outerStroke.minVisibleSize.get(e)}),pulse:(t,e)=>({enabled:t.pulse.enabled.get(e),duration:t.pulse.duration.get(e),interval:t.pulse.interval.get(e),startColor:t.pulse.startColor.get(e),endColor:t.pulse.endColor.get(e),width:t.pulse.width.get(e),startRatio:t.pulse.startRatio.get(e),endRatio:t.pulse.endRatio.get(e)}),outline:(t,e)=>({enabled:t.outline.enabled.get(e),color:t.outline.color.get(e),minVisibleSize:t.outline.minVisibleSize.get(e)}),halo:(t,e)=>({color:t.halo.color.get(e),width:t.halo.width.get(e),scalingMethod:t.halo.scalingMethod.get(e),strokeColor:t.halo.strokeColor.get(e),strokeWidth:t.halo.strokeWidth.get(e),clustering:t.halo.clustering.get(e),hideNonAdjacentEdges:t.halo.hideNonAdjacentEdges.get(e)}),"text.secondary":(t,e)=>({content:t.text.secondary.content.get(e),font:t.text.secondary.font.get(e),color:t.text.secondary.color.get(e),size:t.text.secondary.size.get(e),scale:t.text.secondary.scale.get(e),style:t.text.secondary.style.get(e),align:t.text.secondary.align.get(e),margin:t.text.secondary.margin.get(e),padding:t.text.secondary.padding.get(e),backgroundColor:t.text.secondary.backgroundColor.get(e),minVisibleSize:t.text.secondary.minVisibleSize.get(e)}),text:(t,e)=>({content:t.text.content.get(e),font:t.text.font.get(e),color:t.text.color.get(e),size:t.text.size.get(e),scale:t.text.scale.get(e),style:t.text.style.get(e),align:t.text.align.get(e),margin:t.text.margin.get(e),padding:t.text.padding.get(e),backgroundColor:t.text.backgroundColor.get(e),tip:t.text.tip.get(e),minVisibleSize:t.text.minVisibleSize.get(e),scaling:t.text.scaling.get(e),position:t.text.position.get(e),maxLineLength:t.text.maxLineLength.get(e),truncateLength:t.text.truncateLength.get(e),secondary:rr["text.secondary"](t,e)}),image:(t,e)=>({url:t.image.url.get(e),scale:t.image.scale.get(e),fit:t.image.fit.get(e),tile:t.image.tile.get(e),minVisibleSize:t.image.minVisibleSize.get(e)}),icon:(t,e)=>({content:t.icon.content.get(e),font:t.icon.font.get(e),color:t.icon.color.get(e),scale:t.icon.scale.get(e),style:t.icon.style.get(e),minVisibleSize:t.icon.minVisibleSize.get(e)}),badges:(t,e)=>({topLeft:Po.topLeft(t,e),topRight:Po.topRight(t,e),bottomLeft:Po.bottomLeft(t,e),bottomRight:Po.bottomRight(t,e)}),"badges.topLeft":Po.topLeft,"badges.topRight":Po.topRight,"badges.bottomLeft":Po.bottomLeft,"badges.bottomRight":Po.bottomRight,"badges.topLeft.image":dg("topLeft"),"badges.topLeft.stroke":hg("topLeft"),"badges.topLeft.text":cg("topLeft"),"badges.topRight.image":dg("topRight"),"badges.topRight.stroke":hg("topRight"),"badges.topRight.text":cg("topRight"),"badges.bottomLeft.image":dg("bottomLeft"),"badges.bottomLeft.stroke":hg("bottomLeft"),"badges.bottomLeft.text":cg("bottomLeft"),"badges.bottomRight.image":dg("bottomRight"),"badges.bottomRight.stroke":hg("bottomRight"),"badges.bottomRight.text":cg("bottomRight"),all:(t,e)=>({x:t.x.get(e),y:t.y.get(e),radius:t.radius.get(e),scalingMethod:t.scalingMethod.get(e),color:t.color.get(e),opacity:t.opacity.get(e),shape:t.shape.get(e),layer:t.layer.get(e),detectable:t.detectable.get(e),draggable:t.draggable.get(e),layoutable:t.layoutable.get(e),innerStroke:rr.innerStroke(t,e),outerStroke:rr.outerStroke(t,e),badges:rr.badges(t,e),halo:rr.halo(t,e),pulse:rr.pulse(t,e),icon:rr.icon(t,e),image:rr.image(t,e),outline:rr.outline(t,e),text:rr.text(t,e)})},Oo={shape:(t,e)=>({body:t.shape.body.get(e),head:t.shape.head.get(e),tail:t.shape.tail.get(e),style:t.shape.style.get(e)}),"text.secondary":(t,e)=>({content:t.text.secondary.content.get(e),font:t.text.secondary.font.get(e),color:t.text.secondary.color.get(e),size:t.text.secondary.size.get(e),scale:t.text.secondary.scale.get(e),style:t.text.secondary.style.get(e),align:t.text.secondary.align.get(e),margin:t.text.secondary.margin.get(e),padding:t.text.secondary.padding.get(e),backgroundColor:t.text.secondary.backgroundColor.get(e),minVisibleSize:t.text.secondary.minVisibleSize.get(e)}),text:(t,e)=>({content:t.text.content.get(e),font:t.text.font.get(e),color:t.text.color.get(e),size:t.text.size.get(e),scale:t.text.scale.get(e),style:t.text.style.get(e),align:t.text.align.get(e),margin:t.text.margin.get(e),padding:t.text.padding.get(e),position:t.text.position.get(e),backgroundColor:t.text.backgroundColor.get(e),minVisibleSize:t.text.minVisibleSize.get(e),adjustAngle:t.text.adjustAngle.get(e),scaling:t.text.scaling.get(e),maxLineLength:t.text.maxLineLength.get(e),secondary:Oo["text.secondary"](t,e)}),outline:(t,e)=>({enabled:t.outline.enabled.get(e),color:t.outline.color.get(e),minVisibleSize:t.outline.minVisibleSize.get(e)}),pulse:(t,e)=>({enabled:t.pulse.enabled.get(e),duration:t.pulse.duration.get(e),interval:t.pulse.interval.get(e),startColor:t.pulse.startColor.get(e),endColor:t.pulse.endColor.get(e),width:t.pulse.width.get(e),startRatio:t.pulse.startRatio.get(e),endRatio:t.pulse.endRatio.get(e)}),stroke:(t,e)=>({color:t.stroke.color.get(e),width:t.stroke.width.get(e),scalingMethod:t.stroke.scalingMethod.get(e),minVisibleSize:t.stroke.minVisibleSize.get(e)}),halo:(t,e)=>({color:t.halo.color.get(e),width:t.halo.width.get(e),scalingMethod:t.halo.scalingMethod.get(e)}),all:(t,e)=>({width:t.width.get(e),scalingMethod:t.scalingMethod.get(e),color:t.color.get(e),opacity:t.opacity.get(e),minVisibleSize:t.minVisibleSize.get(e),layer:t.layer.get(e),detectable:t.detectable.get(e),curvature:t.curvature.get(e),adjustAnchors:t.adjustAnchors.get(e),shape:Oo.shape(t,e),stroke:Oo.stroke(t,e),halo:Oo.halo(t,e),pulse:Oo.pulse(t,e),outline:Oo.outline(t,e),text:Oo.text(t,e)})};function L0(t,e,s,n=!0){if((e=e||t)._flexArray!==void 0)return g1(e,s);let i={check:ur,get:as,set:as,nested:{}};if(Ud(e)||e._alias){const r=Ud(e)?e:e._alias;i=g1(qs(t,r),r)}else{if(e._set?(i.set=e._set,i.check=e._check):(i.set=as,i.check=as),e._get)i.get=e._get;else{const r=n?rr:Oo;i.get=r[s||"all"]}i.nested={}}if(!Ud(e)){const r=Object.keys(e);for(const o of r){const a=e[o];o.startsWith("_")||(i.nested[o]=L0(t,a,s?s+"."+o:o,n))}}return i}var t4=L0(Mk,void 0,void 0,!0),e4=L0(Nk,void 0,void 0,!1),s4=[];function f1(t){let e=s4;return t.output===void 0?(typeof t.attributes=="function"&&(e="all"),cn(t.attributes)&&(e=Ga(t.attributes))):t.output&&(e=t.output.attributes),k0(e,t.allAttributePaths)}function n4(t,e,s,n){if(n>s){for(const i of e.attributes)for(const r of t.attributes)if(r===i)return!0}for(const i of e.tags)for(const r of t.tags)if(i===r)return!0;return!1}function Er(t,e,s,n,i,r){n4(s,n,i,r)&&t.push(e)}function i4(t){let e=t.dependencies;e===void 0?e=N3:cn(e)||(e={});const s=Bf(t.attributes).some((o=>typeof o=="function")),n=t.selector&&!t.standaloneSelector,i=!(!s&&!n);let r=e.adjacentEdges;return!r&&e.adjacentNodes&&(r=!0),{self:Lr(e.self,i,t.allAttributePaths),adjacentNodes:Lr(e.adjacentNodes,i,t.allAttributePaths),adjacentEdges:Lr(r,i,t.allAttributePaths),allNodes:Lr(e.allNodes,i,t.allAttributePaths),allEdges:Lr(e.allEdges,i,t.allAttributePaths)}}function r4(t){let e=t.dependencies;e===void 0?e=M3:cn(e)||(e={});const s=Bf(t.attributes).some((r=>typeof r=="function")),n=t.selector&&!t.standaloneSelector,i=!(!s&&!n);return{self:Lr(e.self,i,t.allAttributePaths),extremities:Lr(e.extremities,i,t.allAttributePaths),parallelEdges:Lr(e.parallelEdges,i,t.allAttributePaths),allNodes:Lr(e.allNodes,i,t.allAttributePaths),allEdges:Lr(e.allEdges,i,t.allAttributePaths)}}function Lr(t,e,s){if(!e)return{attributes:[],tags:[]};if(t===!0)return{attributes:[],tags:[_y]};const n={attributes:k0((t=t||{}).attributes,s),tags:l4(t.tags)};return t.data&&n.tags.push(yy),t.selection&&n.tags.push(Gs),t.hover&&n.tags.push(Fd),n}function o4(t){return Array.isArray(t)?t.join("."):t}function a4(t){return t.map(o4).filter(Ud)}function k0(t,e){if(t==="all")return e.slice();if(!Array.isArray(t))return[];const s=a4(t);return e?e.filter((n=>s.some((i=>n.startsWith(i))))):s}function l4(t){return Array.isArray(t)?t.filter(Ud):[]}var p1={storage:1,default:0},Af=class{constructor({graph:t,isNode:e,includeRemovedElements:s}){this._all=!1,this._isNode=e,this._graph=t,this._includeRemovedElements=s,this._eltList=e?this._graph.nodeList:this._graph.edgeList,this._flexArray=e?t.createNodeAttribute(p1,!1):t.createEdgeAttribute(p1,!1),this._all=!1,this._indexList=t.createIndexList(e)}_getAllIndexes(){const t=this._isNode?this._graph.getNodeMaxIndex():this._graph.getEdgeMaxIndex(),e=new Uint32Array(t);for(let s=1;s<=t;++s)e[s-1]=s;return e}addAll(){this._all=!0}add(t){if(!this._all)for(let e=0;e<t._indexes.length;e++){const s=t._indexes[e];this.addIndex(s)}}addIndex(t){this._flexArray.get(t)===0&&(this._flexArray.set(t,1),this._indexList.push(t))}isEmpty(){return!this._all&&this._indexList.isEmpty()}isFull(){return this._all}getListAndClear(){const t=this.getList();return this.clear(),t}getList(){let t;if(this._all&&!this._includeRemovedElements)t=this._isNode?this._graph.getNodes("all"):this._graph.getEdges("all");else{const e=this._all?this._getAllIndexes():this._indexList.slice();t=this._eltList(e)}return t}clear(){this._all=!1,this._indexList.isEmpty()||(this._indexList.reset(),this._flexArray.reset())}addSet(t){if(t._all)this.addAll();else{const e=t._indexList.getBuffer(),s=t._indexList.getLength();for(let n=0;n<s;++n)this.addIndex(e[n])}}};function Ik(t,e=[],s=""){return t.constructor===ff?t.isInitialized()&&e.push(s):t.constructor===Object&&Object.keys(t).forEach((n=>{Ik(t[n],e,s?s+"."+n:n)})),e}var m1=class{constructor(t,e,s){this._updatedAttributes=new Set,this._updatedAttributesTmp=new Set,this._allUsedAttributes=new Set,this._graph=t,this._eltName=e?"node":"edge",this._accessors=e?t4:e4,this._createFlexArrays=s;const n=this._createFlexArrays(t,{original:!0,useDefaultValues:!0});this._finalFlexArrays=n;const i=this._createFlexArrays(t,{original:!1,useDefaultValues:!0});this._prevFlexArrays=i;const r=this._createFlexArrays(t,{original:!1,useDefaultValues:!0});this._defaultFlexArrays=r,this._currentFlexArrays=this._defaultFlexArrays,this.setLastFlexArrays(this._defaultFlexArrays),this._elementsToRedraw=new Af({graph:t,isNode:e,includeRemovedElements:!0}),this._elementsUpdated=new Af({graph:t,isNode:e,includeRemovedElements:!1}),this._finalFlexArraysWrapped={...this._finalFlexArrays,excluded:t.getAttribute(e,"excluded"),textHidden:t.getAttribute(e,"textHidden"),animationStart:t.createAttribute(e,C3),animationDuration:t.createAttribute(e,L3),animationEasing:t.createAttribute(e,k3),id:this._graph.getAttribute(e,"id"),...!e&&{source:t.getEdgeAttribute("source"),target:t.getEdgeAttribute("target")}}}clear(){this._elementsToRedraw.clear(),this._elementsUpdated.clear(),this._updatedAttributes.clear(),this._updatedAttributesTmp.clear()}getAttributeFlexArrays(){return this._finalFlexArraysWrapped}getPrevAttributeFlexArrays(){return this._prevFlexArrays}getAnimationInformation(t){const e=t._indexes,s=Array(e.length),n=this._finalFlexArraysWrapped;for(let i=0;i<e.length;i++){const r=e[i];s[i]={duration:n.animationDuration.get(r),start:n.animationStart.get(r),easing:n.animationEasing.get(r)}}return s}setDefaultAttributes(t){Ga(t).forEach((e=>{const s=qs(this._currentFlexArrays,e),n=qs(this._prevFlexArrays,e),i=qs(this._defaultFlexArrays,e),r=qs(this._finalFlexArrays,e);if(!s)return;const o=qs(t,e);s.setDefaultValue(o),i.setDefaultValue(o),n.setDefaultValue(o),r.setDefaultValue(o)})),this.redrawAll()}startUpdate(){}prepareFlexArraysUpdate(t){this._currentFlexArrays=t.inputFlexArrays}setLastFlexArrays(t){this._lastFlexArrays=t}updateFlexArrays(t){const{attributes:e,selector:s,context:n,outputFlexArrays:i,toUpdate:r,formattedOutput:o}=t;this._elementsUpdated.addSet(r),this._elementsToRedraw.addSet(r);const a=r.getListAndClear();if(e&&a.size){const{valid:l,invalid:u}=kT(this._graph,a,s,n);for(const h of o.attributes){const g=qs(i,h);for(let f=0;f<u._indexes.length;f++){const p=u._indexes[f];g.set(p,void 0)}}this._assignAttributesToFlexArrays(this._accessors,i,l,e,n),this._addUpdatedAttributes(t)}}endUpdate(){const t=this._elementsUpdated.getList(),e=wd(this._updatedAttributesTmp);for(const s of e){const n=qs(this._lastFlexArrays,s),i=qs(this._finalFlexArrays,s);for(let r=0;r<t._indexes.length;r++){const o=t._indexes[r];i.set(o,n.get(o))}}this._updatedAttributesTmp.clear(),this._currentFlexArrays=this._finalFlexArrays}setAttributeValues(t,e,s,n,i){const r=t.outputFlexArrays,o=this._accessors;this._assignAttributesToFlexArrays(o,r,e,s,null),this._addUpdatedAttributes(t,n),this._elementsUpdated.add(e),this._elementsToRedraw.add(e)}notifyLayerDestroyed(t){this._addUpdatedAttributes(t)}_addUpdatedAttributes(t,e){const{outputFlexArrays:s,formattedOutput:n}=t,i=Array.isArray(e)?k0(e):n.attributes;for(const r of i)qs(s,r).isInitialized()&&(this._updatedAttributes.add(r),this._updatedAttributesTmp.add(r),this._allUsedAttributes.add(r))}addUpdatedAttribute(t){this._updatedAttributes.add(t),this._updatedAttributesTmp.add(t),this._allUsedAttributes.add(t)}getUsedAttributeNames(t){return Ik(t.outputFlexArrays)}redrawElements(t){this._elementsToRedraw.add(t)}redrawAll(){this._elementsToRedraw.addAll()}getAndResetElementsToRedraw(){return this._elementsToRedraw.getListAndClear()}getAndResetElementsUpdated(){return this._elementsUpdated.getListAndClear()}getAndResetAttributesUpdated(){const t=wd(this._updatedAttributes);return this._updatedAttributes.clear(),t}getUpdatedAttributes(){return this._updatedAttributes}getUpdatedElementsList(){return this._elementsUpdated.getList()}getUpdatedAttributesSet(){return new Set(this._updatedAttributes)}createFlexArrays(){return this._createFlexArrays(this._graph,{original:!1,useDefaultValues:!1})}getAttributeValues(t,e,s,n){const i=n?this._prevFlexArrays:this._currentFlexArrays;return s?this._getMultipleAttributeValues(t,e,i):this._getSingleAttributeValues(t,e,i)}_getAccessor(t=""){let e=this._accessors;const s=Ba(t);for(const n of s)if(e=e.nested[n],!e)throw new Error(`${this._eltName} attribute "${s.join("")}" does not exist`);return e}_getSingleAttributeValues(t,e,s){const n=this._getAccessor(e),i=t._indexes,r=Array(i.length);for(let o=0;o<i.length;o++)r[o]=n.get(s,i[o]);return r}_getMultipleAttributeValues(t,e,s){if(!e||e==="all")return this._getSingleAttributeValues(t,"",s);const n=Array(t.size);for(let i=0;i<n.length;++i)n[i]={};for(let i=0;i<e.length;i++){const r=e[i],o=this._getSingleAttributeValues(t,r,s);for(let a=0;a<n.length;++a)so(n[a],r,o[a])}return n}setAnimationAttributes(t,{duration:e,startTime:s,easing:n}){const i=t._indexes,r=this._finalFlexArraysWrapped,o=r.animationDuration,a=r.animationStart,l=r.animationEasing,u=wd(this._allUsedAttributes);if(e){let h=!1;for(const g of u){if(g==="x"||g==="y"){h=!0;continue}const f=qs(this._finalFlexArrays,g),p=qs(this._prevFlexArrays,g);for(let y=0;y<i.length;y++){const _=i[y];p.set(_,f.get(_))}}if(h){const g=$n(),f=this._finalFlexArrays.x,p=this._finalFlexArrays.y,y=this._prevFlexArrays.x,_=this._prevFlexArrays.y;for(let x=0;x<i.length;x++){const v=i[x],b=o.get(v);if(b){const S=a.get(v),A=l.get(v),w=(C0[A]||Ef)(Math.min((g-S)/b,1)),L=hy(y.get(v),f.get(v),w),I=hy(_.get(v),p.get(v),w);y.set(v,L),_.set(v,I)}else y.set(v,f.get(v)),_.set(v,p.get(v))}}}o.fill(i,e),a.fill(i,s),l.fill(i,n)}resetAnimationAttributes(t){this._finalFlexArraysWrapped.animationDuration.fill(t._indexes,0)}getUsedAttributes(){return wd(this._allUsedAttributes)}getDefaultFlexArrays(){return this._defaultFlexArrays}_assignAttributesToFlexArrays(t,e,s,n,i,r=[]){if(typeof n=="function"){const o=r.join(".");for(let a=0;a<s.size;++a){const l=s.get(a);if(l){const u=n(l,i,o);this._assignSingleValueToFlexArray(e,l,t,u,r)}}}else if(cn(n)){const o=Object.keys(n);for(let a=0;a<o.length;++a){const l=o[a];r.push(l);const u=this._getNestedAccessor(t,l,r),h=n[l];this._assignAttributesToFlexArrays(u,e,s,h,i,r),r.pop()}}else if((Array.isArray(n)||ArrayBuffer.isView(n))&&r[0]!=="color")if(r.length===0)for(let o=0;o<s.size;++o)this._assignSingleValueToFlexArray(e,s.get(o),t,n[o],r);else for(let o=0;o<s.size;++o){const a=s._indexes[o],l=t.check(n[o]);t.set(e,a,l)}else{const o=t.check(n);for(let a=0;a<s.size;++a){const l=s.get(a);t.set(e,l._index,o)}}}_getNestedAccessor(t,e,s){const n=t.nested[e];if(!n)throw new Error(`${this._eltName} attribute "${s.join(".")}" does not exist`);return n}_assignSingleValueToFlexArray(t,e,s,n,i){if(cn(n)){const r=Object.keys(n);for(const o of r){i.push(o);const a=n[o],l=this._getNestedAccessor(s,o,i);this._assignSingleValueToFlexArray(t,e,l,a,i),i.pop()}}else{const r=s.check(n);s.set(t,e._index,r)}}};function u4(t,{original:e,useDefaultValues:s}){const n="resource";return{width:t.createAttribute(!1,{storage:n,default:s?jy:void 0,name:"width"},e),scalingMethod:t.createAttribute(!1,{storage:n,default:s?ZL:void 0,name:"scalingMethod"},e),color:t.createAttribute(!1,{storage:n,default:s?KL:void 0,name:"color"},e),opacity:t.createAttribute(!1,{storage:n,default:s?QL:void 0,name:"opacity"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?JL:void 0,name:"minVisibleSize"},e),layer:t.createAttribute(!1,{storage:n,default:s?tk:void 0,name:"layer"},e),detectable:t.createAttribute(!1,{storage:n,default:s?ek:void 0,name:"detectable"},e),curvature:t.createAttribute(!1,{storage:n,default:s?sk:void 0,name:"curvature"},e),adjustAnchors:t.createAttribute(!1,{storage:n,default:s?nk:void 0,name:"adjustAnchors"},e),shape:{body:t.createAttribute(!1,{storage:n,default:s?ik:void 0,name:"shape.body"},e),head:t.createAttribute(!1,{storage:n,default:s?rk:void 0,name:"shape.head"},e),tail:t.createAttribute(!1,{storage:n,default:s?ok:void 0,name:"shape.tail"},e),style:t.createAttribute(!1,{storage:n,default:s?ak:void 0,name:"shape.style"},e)},stroke:{color:t.createAttribute(!1,{storage:n,default:s?lk:void 0,name:"stroke.color"},e),width:t.createAttribute(!1,{storage:n,default:s?Hy:void 0,name:"stroke.width"},e),scalingMethod:t.createAttribute(!1,{storage:n,default:s?uk:void 0,name:"stroke.scalingMethod"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?dk:void 0,name:"stroke.minVisibleSize"},e)},halo:{color:t.createAttribute(!1,{storage:n,default:s?hk:void 0,name:"halo.color"},e),width:t.createAttribute(!1,{storage:n,default:s?$y:void 0,name:"halo.width"},e),scalingMethod:t.createAttribute(!1,{storage:n,default:s?ck:void 0,name:"halo.scalingMethod"},e)},pulse:{enabled:t.createAttribute(!1,{storage:n,default:!s&&void 0,name:"pulse.enabled"},e),duration:t.createAttribute(!1,{storage:n,default:s?gk:void 0,name:"pulse.duration"},e),interval:t.createAttribute(!1,{storage:n,default:s?fk:void 0,name:"pulse.interval"},e),startColor:t.createAttribute(!1,{storage:n,default:s?pk:void 0,name:"pulse.startColor"},e),endColor:t.createAttribute(!1,{storage:n,default:s?mk:void 0,name:"pulse.endColor"},e),width:t.createAttribute(!1,{storage:n,default:s?_k:void 0,name:"pulse.width"},e),startRatio:t.createAttribute(!1,{storage:n,default:s?yk:void 0,name:"pulse.startRatio"},e),endRatio:t.createAttribute(!1,{storage:n,default:s?xk:void 0,name:"pulse.endRatio"},e)},outline:{enabled:t.createAttribute(!1,{storage:n,default:!s&&void 0,name:"outline.enabled"},e),color:t.createAttribute(!1,{storage:n,default:s?vk:void 0,name:"outline.color"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?bk:void 0,name:"outline.minVisibleSize"},e)},text:{content:t.createAttribute(!1,{storage:n,default:s?null:void 0,name:"text.content"},e),font:t.createAttribute(!1,{storage:n,default:s?ni:void 0,name:"text.font"},e),color:t.createAttribute(!1,{storage:n,default:s?Ko:void 0,name:"text.color"},e),size:t.createAttribute(!1,{storage:n,default:s?fu:void 0,name:"text.size"},e),scale:t.createAttribute(!1,{storage:n,default:s?R3:void 0,name:"text.scale"},e),style:t.createAttribute(!1,{storage:n,default:s?Ek:void 0,name:"text.style"},e),align:t.createAttribute(!1,{storage:n,default:s?Sk:void 0,name:"text.align"},e),margin:t.createAttribute(!1,{storage:n,default:s?Ak:void 0,name:"text.margin"},e),padding:t.createAttribute(!1,{storage:n,default:s?qy:void 0,name:"text.padding"},e),position:t.createAttribute(!1,{storage:n,default:s?wk:void 0,name:"text.position"},e),backgroundColor:t.createAttribute(!1,{storage:n,default:s?bf:void 0,name:"text.backgroundColor"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?Tk:void 0,name:"text.minVisibleSize"},e),adjustAngle:t.createAttribute(!1,{storage:n,default:s?Ck:void 0,name:"text.adjustAngle"},e),scaling:t.createAttribute(!1,{storage:n,default:s?mL:void 0,name:"text.scaling"},e),maxLineLength:t.createAttribute(!1,{storage:n,default:s?_L:void 0,name:"text.maxLineLength"},e),secondary:{content:t.createAttribute(!1,{storage:n,default:s?null:void 0,name:"text.secondary.content"},e),font:t.createAttribute(!1,{storage:n,default:s?ni:void 0,name:"text.secondary.font"},e),color:t.createAttribute(!1,{storage:n,default:s?Ko:void 0,name:"text.secondary.color"},e),size:t.createAttribute(!1,{storage:n,default:s?Wy:void 0,name:"text.secondary.size"},e),scale:t.createAttribute(!1,{storage:n,default:s?cL:void 0,name:"text.secondary.scale"},e),style:t.createAttribute(!1,{storage:n,default:s?fL:void 0,name:"text.secondary.style"},e),align:t.createAttribute(!1,{storage:n,default:s?pL:void 0,name:"text.secondary.align"},e),margin:t.createAttribute(!1,{storage:n,default:s?kk:void 0,name:"text.secondary.margin"},e),padding:t.createAttribute(!1,{storage:n,default:s?Yy:void 0,name:"text.secondary.padding"},e),backgroundColor:t.createAttribute(!1,{storage:n,default:s?gL:void 0,name:"text.secondary.backgroundColor"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?Lk:void 0,name:"text.secondary.minVisibleSize"},e)}}}}function d4(t,{original:e,useDefaultValues:s}){const n="resource";return{x:t.createAttribute(!0,{storage:"any",default:s?0:void 0,name:"x"},e),y:t.createAttribute(!0,{storage:"any",default:s?0:void 0,name:"y"},e),radius:t.createAttribute(!0,{storage:n,default:s?5:void 0,name:"radius"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"scalingMethod"},e),color:t.createAttribute(!0,{storage:n,default:s?bL:void 0,name:"color"},e),opacity:t.createAttribute(!0,{storage:n,default:s?i3:void 0,name:"opacity"},e),shape:t.createAttribute(!0,{storage:n,default:s?r3:void 0,name:"shape"},e),layer:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"layer"},e),detectable:t.createAttribute(!0,{storage:n,default:!!s||void 0,name:"detectable"},e),draggable:t.createAttribute(!0,{storage:n,default:!!s||void 0,name:"draggable"},e),layoutable:t.createAttribute(!0,{storage:n,default:!!s||void 0,name:"layoutable"},e),innerStroke:{width:t.createAttribute(!0,{storage:n,default:s?E0:void 0,name:"innerStroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"innerStroke.scalingMethod"},e),color:t.createAttribute(!0,{storage:n,default:s?EL:void 0,name:"innerStroke.color"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?By:void 0,name:"innerStroke.minVisibleSize"},e)},outerStroke:{width:t.createAttribute(!0,{storage:n,default:s?S0:void 0,name:"outerStroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"outerStroke.scalingMethod"},e),color:t.createAttribute(!0,{storage:n,default:s?SL:void 0,name:"outerStroke.color"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?Oy:void 0,name:"outerStroke.minVisibleSize"},e)},badges:{topLeft:{color:t.createAttribute(!0,{storage:n,default:s?Ed:void 0,name:"badges.topLeft.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.45:void 0,name:"badges.topLeft.scale"},e),positionScale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.topLeft.positionScale"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?Ql:void 0,name:"badges.topLeft.minVisibleSize"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"badges.topLeft.scalingMethod"},e),image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.topLeft.image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.topLeft.image.scale"},e)},stroke:{color:t.createAttribute(!0,{storage:n,default:s?Sd:void 0,name:"badges.topLeft.stroke.color"},e),width:t.createAttribute(!0,{storage:n,default:s?Jl:void 0,name:"badges.topLeft.stroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"badges.topLeft.stroke.scalingMethod"},e)},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.topLeft.text.content"},e),color:t.createAttribute(!0,{storage:n,default:s?Ad:void 0,name:"badges.topLeft.text.color"},e),font:t.createAttribute(!0,{storage:n,default:s?ni:void 0,name:"badges.topLeft.text.font"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"badges.topLeft.text.style"},e),scale:t.createAttribute(!0,{storage:n,default:s?.5:void 0,name:"badges.topLeft.text.scale"},e),paddingLeft:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.topLeft.text.paddging.left"},e),paddingTop:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.topLeft.text.paddging.top"},e)}},topRight:{color:t.createAttribute(!0,{storage:n,default:s?Ed:void 0,name:"badges.topRight.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.45:void 0,name:"badges.topRight.scale"},e),positionScale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.topRight.positionScale"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?Ql:void 0,name:"badges.topRight.minVisibleSize"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"badges.topRight.scalingMethod"},e),image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.topRight.image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.topRight.image.scale"},e)},stroke:{color:t.createAttribute(!0,{storage:n,default:s?Sd:void 0,name:"badges.topRight.stroke.color"},e),width:t.createAttribute(!0,{storage:n,default:s?Jl:void 0,name:"badges.topRight.stroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"badges.topRight.stroke.scalingMethod"},e)},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.topRight.text.content"},e),color:t.createAttribute(!0,{storage:n,default:s?Ad:void 0,name:"badges.topRight.text.color"},e),font:t.createAttribute(!0,{storage:n,default:s?ni:void 0,name:"badges.topRight.text.font"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"badges.topRight.text.style"},e),scale:t.createAttribute(!0,{storage:n,default:s?.5:void 0,name:"badges.topRight.text.scale"},e),paddingTop:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.topRight.text.paddging.left"},e),paddingLeft:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.topRight.text.paddging.top"},e)}},bottomLeft:{color:t.createAttribute(!0,{storage:n,default:s?Ed:void 0,name:"badges.bottomLeft.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.45:void 0,name:"badges.bottomLeft.scale"},e),positionScale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.bottomLeft.positionScale"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?Ql:void 0,name:"badges.bottomLeft.minVisibleSize"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"badges.bottomLeft.scalingMethod"},e),image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.bottomLeft.image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.bottomLeft.image.scale"},e)},stroke:{color:t.createAttribute(!0,{storage:n,default:s?Sd:void 0,name:"badges.bottomLeft.stroke.color"},e),width:t.createAttribute(!0,{storage:n,default:s?Jl:void 0,name:"badges.bottomLeft.stroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:e?"badges.bottomLeft.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.bottomLeft.text.content"},e),color:t.createAttribute(!0,{storage:n,default:s?Ad:void 0,name:"badges.bottomLeft.text.color"},e),font:t.createAttribute(!0,{storage:n,default:s?ni:void 0,name:"badges.bottomLeft.text.font"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"badges.bottomLeft.text.style"},e),scale:t.createAttribute(!0,{storage:n,default:s?.5:void 0,name:"badges.bottomLeft.text.scale"},e),paddingLeft:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.bottomLeft.text.paddging.left"},e),paddingTop:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.bottomLeft.text.paddging.top"},e)}},bottomRight:{color:t.createAttribute(!0,{storage:n,default:s?Ed:void 0,name:"badges.bottomRight.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.45:void 0,name:"badges.bottomRight.scale"},e),positionScale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.bottomRight.positionScale"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?Ql:void 0,name:"badges.bottomRight.minVisibleSize"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"badges.bottomRight.scalingMethod"},e),image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.bottomRight.image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.bottomRight.image.scale"},e)},stroke:{color:t.createAttribute(!0,{storage:n,default:s?Sd:void 0,name:"badges.bottomRight.stroke.color"},e),width:t.createAttribute(!0,{storage:n,default:s?Jl:void 0,name:"badges.bottomRight.stroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:e?"badges.bottomRight.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.bottomRight.text.content"},e),color:t.createAttribute(!0,{storage:n,default:s?Ad:void 0,name:"badges.bottomRight.text.color"},e),font:t.createAttribute(!0,{storage:n,default:s?ni:void 0,name:"badges.bottomRight.text.font"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"badges.bottomRight.text.style"},e),scale:t.createAttribute(!0,{storage:n,default:s?.5:void 0,name:"badges.bottomRight.text.scale"},e),paddingLeft:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.bottomRight.text.paddging.left"},e),paddingTop:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.bottomRight.text.paddging.top"},e)}}},halo:{color:t.createAttribute(!0,{storage:n,default:s?wL:void 0,name:"halo.color"},e),width:t.createAttribute(!0,{storage:n,default:s?A0:void 0,name:"halo.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"halo.scalingMethod"},e),strokeColor:t.createAttribute(!0,{storage:n,default:s?TL:void 0,name:"halo.strokeColor"},e),strokeWidth:t.createAttribute(!0,{storage:n,default:s?w0:void 0,name:"halo.strokeWidth"},e),clustering:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"halo.clustering"},e),hideNonAdjacentEdges:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"halo.hideNonAdjacentEdges"},e)},pulse:{enabled:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"pulse.enabled"},e),duration:t.createAttribute(!0,{storage:n,default:s?LL:void 0,name:"pulse.duration"},e),interval:t.createAttribute(!0,{storage:n,default:s?kL:void 0,name:"pulse.interval"},e),startColor:t.createAttribute(!0,{storage:n,default:s?RL:void 0,name:"pulse.startColor"},e),endColor:t.createAttribute(!0,{storage:n,default:s?IL:void 0,name:"pulse.endColor"},e),width:t.createAttribute(!0,{storage:n,default:s?FL:void 0,name:"pulse.width"},e),startRatio:t.createAttribute(!0,{storage:n,default:s?NL:void 0,name:"pulse.startRatio"},e),endRatio:t.createAttribute(!0,{storage:n,default:s?ML:void 0,name:"pulse.endRatio"},e)},icon:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"icon.content"},e),font:t.createAttribute(!0,{storage:n,default:s?ni:void 0,name:"icon.font"},e),color:t.createAttribute(!0,{storage:n,default:s?CL:void 0,name:"icon.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.7:void 0,name:"icon.scale"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"icon.style"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?12:void 0,name:"icon.minVisibleSize"},e)},image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"image.scale"},e),fit:t.createAttribute(!0,{storage:n,default:!!s||void 0,name:"image.fit"},e),tile:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"image.tile"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?12:void 0,name:"image.minVisibleSize"},e)},outline:{enabled:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"outline.enabled"},e),color:t.createAttribute(!0,{storage:n,default:s?AL:void 0,name:"outline.color"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?12:void 0,name:"outline.minVisibleSize"},e)},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"text.content"},e),font:t.createAttribute(!0,{storage:n,default:s?ni:void 0,name:"text.font"},e),color:t.createAttribute(!0,{storage:n,default:s?Ko:void 0,name:"text.color"},e),size:t.createAttribute(!0,{storage:n,default:s?fu:void 0,name:"text.size"},e),scale:t.createAttribute(!0,{storage:n,default:s?.1:void 0,name:"text.scale"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"text.style"},e),align:t.createAttribute(!0,{storage:n,default:s?"center":void 0,name:"text.align"},e),margin:t.createAttribute(!0,{storage:n,default:s?v0:void 0,name:"text.margin"},e),padding:t.createAttribute(!0,{storage:n,default:s?ih:void 0,name:"text.padding"},e),backgroundColor:t.createAttribute(!0,{storage:n,default:s?bf:void 0,name:"text.backgroundColor"},e),tip:t.createAttribute(!0,{storage:n,default:s?s3:void 0,name:"text.tip"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?24:void 0,name:"text.minVisibleSize"},e),scaling:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"text.scaling"},e),position:t.createAttribute(!0,{storage:n,default:s?"bottom":void 0,name:"text.position"},e),maxLineLength:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"text.maxLineLength"},e),truncateLength:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"text.truncateLength"},e),secondary:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"text.secondary.content"},e),font:t.createAttribute(!0,{storage:n,default:s?ni:void 0,name:"text.secondary.font"},e),color:t.createAttribute(!0,{storage:n,default:s?Ko:void 0,name:"text.secondary.color"},e),size:t.createAttribute(!0,{storage:n,default:s?b0:void 0,name:"text.secondary.size"},e),scale:t.createAttribute(!0,{storage:n,default:s?.08:void 0,name:"text.secondary.scale"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"text.secondary.style"},e),align:t.createAttribute(!0,{storage:n,default:s?"center":void 0,name:"text.secondary.align"},e),margin:t.createAttribute(!0,{storage:n,default:s?n3:void 0,name:"text.secondary.margin"},e),padding:t.createAttribute(!0,{storage:n,default:s?ih:void 0,name:"text.secondary.padding"},e),backgroundColor:t.createAttribute(!0,{storage:n,default:s?bf:void 0,name:"text.secondary.backgroundColor"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?24:void 0,name:"text.secondary.minVisibleSize"},e)}}}}var h4=class{constructor(t){this.nodes=new m1(t,!0,d4),this.edges=new m1(t,!1,u4)}setNodeDefaultAttributes(t){this.nodes.setDefaultAttributes(t)}setEdgeDefaultAttributes(t){this.edges.setDefaultAttributes(t)}getFlexArrays(){return{nodes:{current:this.nodes.getAttributeFlexArrays(),previous:this.nodes.getPrevAttributeFlexArrays()},edges:{current:this.edges.getAttributeFlexArrays(),previous:this.edges.getPrevAttributeFlexArrays()}}}redrawAll(){this.nodes.redrawAll(),this.edges.redrawAll()}clear(){this.nodes.clear(),this.edges.clear()}redrawElements(t){this._fetch(t).redrawElements(t)}getAnimationInformation(t){return this._fetch(t).getAnimationInformation(t)}redrawNodes(t){this.nodes.redrawElements(t)}getUsedAttributes(t,e){return this._fetch(e).getUsedAttributeNames(e.isNode?t.nodes:t.edges)}startUpdate(){this.nodes.startUpdate(),this.edges.startUpdate()}notifyDestroyed(t){this.nodes.notifyLayerDestroyed(t.nodes),this.edges.notifyLayerDestroyed(t.edges)}prepareUpdate(t){this.nodes.prepareFlexArraysUpdate(t.nodes),this.edges.prepareFlexArraysUpdate(t.edges)}onUpdate(t){this.nodes.updateFlexArrays(t.nodes),this.edges.updateFlexArrays(t.edges)}afterLayersUpdate(){this.nodes.endUpdate(),this.edges.endUpdate()}getAndResetElementsToRedraw(){return{nodes:this.nodes.getAndResetElementsToRedraw(),edges:this.edges.getAndResetElementsToRedraw()}}getAndResetElementsUpdated(){const t=this.nodes,e=this.edges;return{nodes:t.getAndResetElementsUpdated(),edges:e.getAndResetElementsUpdated(),nodeAttributesSet:t.getUpdatedAttributesSet(),nodeAttributes:t.getAndResetAttributesUpdated(),edgeAttributes:e.getAndResetAttributesUpdated()}}setAnimationAttributes({nodes:t,edges:e},s){this.nodes.setAnimationAttributes(t,s),this.edges.setAnimationAttributes(e,s)}resetAnimationAttributes({nodes:t,edges:e}){this.nodes.resetAnimationAttributes(t),this.edges.resetAnimationAttributes(e)}setLastOutput(t,e){this.nodes.setLastFlexArrays(t),this.edges.setLastFlexArrays(e)}getCurrentInput(){const t=Xs(this.nodes.getDefaultFlexArrays()),e=Xs(this.edges.getDefaultFlexArrays());return{currentNodeFlexArrays:t,currentEdgeFlexArrays:e,allNodeAttributePaths:Ga(t),allEdgeAttributePaths:Ga(e)}}initializeLayer(t,e,s){t.nodes.allAttributePaths=e,t.edges.allAttributePaths=s,t.nodes.formattedDependencies=i4(t.nodes),t.edges.formattedDependencies=r4(t.edges),t.nodes.formattedOutput={attributes:f1(t.nodes),tags:t.tag?[t.tag]:[]},t.edges.formattedOutput={attributes:f1(t.edges),tags:t.tag?[t.tag]:[]},t.nodes.redrawAdjacentEdges=t.nodes.formattedOutput.attributes.some((n=>I3[n])),t.initialized=!0}connectLayerInputOutput(t,e,s){const n=t.nodes.formattedOutput,i=t.edges.formattedOutput;for(const r of n.attributes){const o=qs(e,r),a=qs(t.nodes.outputFlexArrays,r);a.setFallback(o),so(e,r,a)}for(const r of i.attributes){const o=qs(s,r),a=qs(t.edges.outputFlexArrays,r);a.setFallback(o),so(s,r,a)}}setupLayerDependencies(t,e){if(t===e)return;const s=t.priority,n=e.priority,i=t.nodes.formattedOutput,r=t.edges.formattedOutput,o=e.nodes.formattedDependencies,a=e.edges.formattedDependencies;Er(t.depsNodeSelf,e,i,o.self,s,n),Er(t.depsNodeAdjacentNodes,e,i,o.adjacentNodes,s,n),Er(t.depsNodeAdjacentEdges,e,r,a.extremities,s,n),Er(t.depsNodeAllNodes,e,i,o.allNodes,s,n),Er(t.depsNodeAllEdges,e,r,a.allNodes,s,n),Er(t.depsEdgeSelf,e,r,a.self,s,n),Er(t.depsEdgeExtremities,e,i,o.adjacentEdges,s,n),Er(t.depsEdgeParallelEdges,e,r,a.parallelEdges,s,n),Er(t.depsEdgeAllNodes,e,i,o.allEdges,s,n),Er(t.depsEdgeAllEdges,e,r,a.allEdges,s,n)}createAttributeLayerData(t,e,s,{tag:n,onBeforeUpdate:i,standaloneSelectors:r}){const o=!!r;return{index:-1,id:e,name:t,tag:n||null,priority:0,depsNodeSelf:[],depsNodeAdjacentNodes:[],depsNodeAdjacentEdges:[],depsNodeAllNodes:[],depsNodeAllEdges:[],depsEdgeSelf:[],depsEdgeExtremities:[],depsEdgeParallelEdges:[],depsEdgeAllNodes:[],depsEdgeAllEdges:[],initialized:!1,onBeforeUpdate:i,nodes:{type:"node",name:t,standaloneSelector:o,toUpdate:new Af({graph:s,isNode:!0,includeRemovedElements:!1}),outputFlexArrays:this.nodes.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null},edges:{type:"edge",name:t,standaloneSelector:o,toUpdate:new Af({graph:s,isNode:!1,includeRemovedElements:!1}),outputFlexArrays:this.edges.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null}}}setAttributeValues(t,e,s,n,i){this._fetch(e).setAttributeValues(t,e,s,n,i)}getAttributeValues(t,e,s,n){return this._fetch(t).getAttributeValues(t,e,s,n)}_fetch(t){return t.isNode?this.nodes:this.edges}},c4=(t,e)=>new v3(t,e),g4=class{constructor(t,{graph:e,dom:s}){this._layerIdCounter=0,this._layers=[],this._destroyedLayers=[],this._layersNeedUpdate=!1,this._updateOngoing=!1,this._needUpdate=!1,this._ogma=t,this._graph=e,this._dom=s,this._emptySubgraph={nodes:t.nodeList(),edges:t.edgeList()},this._textHiddenSet=new kh(this._graph,"textHidden"),this._layerController=new h4(this._graph)}_getLayerById(t){for(let e=0;e<this._layers.length;++e){const s=this._layers[e];if(s.id===t)return s.index=e,s}throw new Error("usage of a destroyed style rule or class")}setDefaultAttributes(t,e){this._layerController.setNodeDefaultAttributes(t),this._layerController.setEdgeDefaultAttributes(e)}getFlexArrays(){return this._layerController.getFlexArrays()}clear(){this._updateOngoing=!1,this._needUpdate=!1,this._destroyedLayers=[],this._layerController.clear(),this.updateAllForAllAttributeLayers()}redrawElements(t){t.size&&(this._layerController.redrawElements(t),this._dom.refresh())}redrawAll(){this._layerController.redrawAll(),this._dom.refresh()}_triggerUpdate(){this._needUpdate=!0,this._dom.refresh()}_reconstructAttributeLayersIfNecessary(){return!!this._layersNeedUpdate&&(this._reconstructAttributeLayers(),this._layersNeedUpdate=!1,this._dom.refresh(),!0)}getAnimationInformation(t){return this._layerController.getAnimationInformation(t)}update(){if(!this._needUpdate||this._updateOngoing||!this._ogma._token)return!1;this._reconstructAttributeLayersIfNecessary(),this._updateOngoing=!0,this._layerController.startUpdate();for(const t of this._destroyedLayers)t.initialized&&this._layerController.notifyDestroyed(t);for(const t of this._layers)this._layerController.prepareUpdate(t),typeof t.onBeforeUpdate=="function"&&t.onBeforeUpdate(t,this,this._layerController),this._layerController.onUpdate(t);return this._layerController.afterLayersUpdate(),this._updateOngoing=!1,this._needUpdate=!1,!0}setAttributeLayerValues(t,e,s,n){const i=this._getLayerById(t),r=e.isNode?i.nodes:i.edges;this._reconstructAttributeLayersIfNecessary(),this._layerController.setAttributeValues(r,e,s,n,i),this._updateElementsForAttributeLayers([i],e)}getAttributeLayerFlexArrays(t){const e=this._getLayerById(t);return{nodes:e.nodes.outputFlexArrays,edges:e.edges.outputFlexArrays}}getUsedAttributeLayerAttributes(t,e){const s=this._getLayerById(t);return this._layerController.getUsedAttributes(s,e)}getUpdatedElements(){return{elementsToRedraw:this._layerController.getAndResetElementsToRedraw(),elementsUpdated:this._layerController.getAndResetElementsUpdated()}}addAttributeLayer(t){const{name:e,layerFactory:s=c4}=t;if(!e)throw new Error("Attribute layer must have a name");if(e&&this._layers.find((i=>i.name===e)))throw new Error(`attribute layer with name "${t.name}" already exists`);const n=this._layerController.createAttributeLayerData(e,++this._layerIdCounter,this._graph,t);return this._layers.push(n),this._updateLayer(n,t),s(this,this._layerIdCounter)}_reconstructAttributeLayers(){this._layers.sort(((i,r)=>i.priority-r.priority));const{currentNodeFlexArrays:t,currentEdgeFlexArrays:e,allNodeAttributePaths:s,allEdgeAttributePaths:n}=this._layerController.getCurrentInput();for(const i of this._layers)this._layerController.initializeLayer(i,s,n);for(const i of this._layers){i.nodes.inputFlexArrays=Xs(t),i.edges.inputFlexArrays=Xs(e),i.depsNodeSelf=[],i.depsNodeAdjacentNodes=[],i.depsNodeAdjacentEdges=[],i.depsNodeAllNodes=[],i.depsNodeAllEdges=[],i.depsEdgeSelf=[],i.depsEdgeExtremities=[],i.depsEdgeParallelEdges=[],i.depsEdgeAllNodes=[],i.depsEdgeAllEdges=[],i.nodes.toUpdate.addAll(),i.edges.toUpdate.addAll(),this._layerController.connectLayerInputOutput(i,t,e);for(const r of this._layers)this._layerController.setupLayerDependencies(i,r)}this._layerController.setLastOutput(t,e);for(const i of this._layers)i.nodes.needAdjacentElements=i.nodes.redrawAdjacentEdges||i.depsNodeAdjacentNodes.length>0||i.depsNodeAdjacentEdges.length>0,i.edges.needAdjacentElements=i.depsEdgeExtremities.length>0||i.depsEdgeParallelEdges.length>0}_updateLayer(t,{priority:e,fullOverwrite:s,nodeAttributes:n,nodeSelector:i,nodeContext:r,nodeDependencies:o,nodeOutput:a,edgeAttributes:l,edgeSelector:u,edgeContext:h,edgeDependencies:g,edgeOutput:f}={}){n!==void 0&&(t.nodes.attributes=s?n:Kg(t.nodes.attributes,n)),i!==void 0&&(t.nodes.selector=i),r!==void 0&&(t.nodes.context=r),o!==void 0&&(t.nodes.dependencies=o),a!==void 0&&(t.nodes.output=a),l!==void 0&&(t.edges.attributes=s?l:Kg(t.edges.attributes,l)),u!==void 0&&(t.edges.selector=u),h!==void 0&&(t.edges.context=h),g!==void 0&&(t.edges.dependencies=g),f!==void 0&&(t.edges.output=f),e!==void 0&&(t.priority=e),this._triggerLayerUpdate()}_triggerLayerUpdate(){this._layersNeedUpdate=!0,this._triggerUpdate()}updateAllForAttributeLayer(t){const e=this._getLayerById(t);this._updateAllForAttributeLayer(e)}updateAllForAllAttributeLayers(){for(const t of this._layers)this._updateAllForAttributeLayer(t)}_updateAllForAttributeLayer(t,e=!0,s=!0){if(e&&!t.nodes.toUpdate.isFull()){t.nodes.toUpdate.addAll();for(const n of t.depsNodeSelf)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsNodeAdjacentNodes)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsNodeAdjacentEdges)this._updateAllForAttributeLayer(n,!1,!0);for(const n of t.depsNodeAllNodes)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsNodeAllEdges)this._updateAllForAttributeLayer(n,!1,!0)}if(s&&!t.edges.toUpdate.isFull()){t.edges.toUpdate.addAll();for(const n of t.depsEdgeSelf)this._updateAllForAttributeLayer(n,!1,!0);for(const n of t.depsEdgeExtremities)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsEdgeParallelEdges)this._updateAllForAttributeLayer(n,!1,!0);for(const n of t.depsEdgeAllNodes)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsEdgeAllEdges)this._updateAllForAttributeLayer(n,!1,!0)}this._triggerUpdate()}updateElementsForAttributeLayer(t,e){const s=this._getLayerById(t);this._updateElementsForAttributeLayers([s],e)}updateForAllAttributeLayers(t){this._updateElementsForAttributeLayers(this._layers,t)}_updateElementsForAttributeLayers(t,e){let s=this._emptySubgraph;if(e.isNode){for(const n of t)if(!n.nodes.toUpdate.isFull()){n.nodes.needAdjacentElements&&(s=s===this._emptySubgraph?e.fastGetAdjacentElements():s),n.nodes.toUpdate.add(e);for(const i of n.depsNodeSelf)i.nodes.toUpdate.add(e);for(const i of n.depsNodeAdjacentNodes)i.nodes.toUpdate.add(s.nodes);for(const i of n.depsNodeAdjacentEdges)i.edges.toUpdate.add(s.edges);for(const i of n.depsNodeAllNodes)this._updateAllForAttributeLayer(i,!0,!1);for(const i of n.depsNodeAllEdges)this._updateAllForAttributeLayer(i,!1,!0);n.nodes.redrawAdjacentEdges&&this._layerController.redrawElements(s.edges)}}else for(const n of t)if(!n.edges.toUpdate.isFull()){n.edges.needAdjacentElements&&(s=s===this._emptySubgraph?e.fastGetAdjacentElements():s),n.edges.toUpdate.add(e);for(const i of n.depsEdgeSelf)i.edges.toUpdate.add(e);for(const i of n.depsEdgeExtremities)i.nodes.toUpdate.add(s.nodes);for(const i of n.depsEdgeParallelEdges)i.edges.toUpdate.add(s.edges);for(const i of n.depsEdgeAllNodes)this._updateAllForAttributeLayer(i,!0,!1);for(const i of n.depsEdgeAllEdges)this._updateAllForAttributeLayer(i,!1,!0)}this._triggerUpdate()}destroyAttributeLayer(t){const e=this._getLayerById(t);this._destroyedLayers.push(e),this._layers.splice(e.index,1),this._triggerLayerUpdate()}updateAttributeLayer(t,e){const s=this._getLayerById(t);this._updateLayer(s,e)}getAttributeLayerDefinition(t){const e=this._getLayerById(t),{priority:s,nodes:n,edges:i}=e;return{priority:s,nodeAttributes:n.attributes,nodeSelector:n.selector,nodeContext:n.context,nodeDependencies:n.dependencies,nodeOutput:n.output,edgeAttributes:i.attributes,edgeSelector:i.selector,edgeContext:i.context,edgeDependencies:i.dependencies,edgeOutput:i.output}}getAttributeValues(t,e,s,n){return this.update(),this._layerController.getAttributeValues(t,e,s,n)}setAnimationAttributes(t,e){return this._layerController.setAnimationAttributes(t,e)}resetAnimationAttributes(t){return this._layerController.resetAnimationAttributes(t)}setTextHidden(t,e){const s=this._textHiddenSet.addOrRemoveElements(t,e);this.redrawElements(s)}resetTextHidden(){const{nodes:t,edges:e}=this._textHiddenSet.getElements();this._textHiddenSet.clear(),this._layerController.redrawElements(t),this._layerController.redrawElements(e)}getUsedNodeAttributes(){return this._layerController.nodes.getUsedAttributes()}getUsedEdgeAttributes(){return this._layerController.edges.getUsedAttributes()}interpolateAttributes(t){const e=$n(),s=this._ogma.modules.graphics.getAttributesManager(),n=this._layerController,i=t.isNode?s.getUsedNodeAttributes():s.getUsedEdgeAttributes(),{animationDuration:r,animationEasing:o,animationStart:a}=n.getFlexArrays().nodes.current,l=r.getMultiple(t._indexes),u=o.getMultiple(t._indexes),h=a.getMultiple(t._indexes),g=[];for(let f=0;f<t.size;f++){const p={};i.forEach((y=>{const _=typeof y=="string"?y:y.join("."),x=qs(n.getFlexArrays().nodes.previous,y),v=qs(n.getFlexArrays().nodes.current,y);if(!v)return;const b=RC(e,h[f],l[f],u[f]);isNaN(b)?p[_]=v.get(t._indexes[f]):_.match(/color/gi)?p[_]=vd(x.get(t._indexes[f]),v.get(t._indexes[f]),b,b):p[_]=bs(x.get(t._indexes[f]),v.get(t._indexes[f]),b)})),g.push(p)}return g}},f4=1e-12;function _1(t){return((t=Math.exp(t))+1/t)/2}function p4(t){return((t=Math.exp(t))-1/t)/2}function m4(t){return((t=Math.exp(2*t))-1)/(t+1)}var _4=(function t(e,s,n){function i(r,o){var a,l,u=r[0],h=r[1],g=r[2],f=o[0],p=o[1],y=o[2],_=f-u,x=p-h,v=_*_+x*x;if(v<f4)l=Math.log(y/g)/e,a=function(I){return[u+I*_,h+I*x,g*Math.exp(e*I*l)]};else{var b=Math.sqrt(v),S=(y*y-g*g+n*v)/(2*g*s*b),A=(y*y-g*g-n*v)/(2*y*s*b),w=Math.log(Math.sqrt(S*S+1)-S),L=Math.log(Math.sqrt(A*A+1)-A);l=(L-w)/e,a=function(I){var F=I*l,O=_1(w),V=g/(s*b)*(O*m4(e*F+w)-p4(w));return[u+V*_,h+V*x,g*O/_1(e*F+w)]}}return a.duration=1e3*l*e/Math.SQRT2,a}return i.rho=function(r){var o=Math.max(.001,+r),a=o*o;return t(o,a,a*a)},i})(Math.SQRT2,2,4),y4="cubicOut",x4=({graphWidth:t,graphHeight:e,viewWidth:s,viewHeight:n})=>.2*Math.min(s/t,n/e),v4=({smallestNodeSize:t,viewWidth:e,viewHeight:s})=>t===1/0?1/0:Math.min(e,s)/t*.5;function b4(t,e,s){return e===void 0?E4(t):e==="alt"?t.altKey:e==="shift"?t.shiftKey:e==="space"?s.isPressed("space"):void 0}function E4(t){return!t.altKey&&(hF?t.metaKey:t.ctrlKey)&&!t.shiftKey}var Xy=Math.SQRT2,y1=.15,S4=class extends Ke{constructor(t,e){super(t),this._zooming=!1,this.debug=!1,this._smoothZoom=Yd(((s,n,i)=>{const r=this._modules.settings,o=r.get("interactions.zoom.duration"),a=r.get("interactions.zoom.easing"),l=this._modules.camera.getZoom(),u={duration:o,easing:a};this._zooming||(this._zooming=!0,this._updateVisibility("zoom",!0));const h=r.get("interactions.zoom.speed")||y1;let g=JD(s,h);s<0&&g!==0&&(g=1/g);const f=l*g;this._modules.camera.setZoom(f,u,{x:n,y:i}).then((()=>{this._zooming&&(this._zooming=!1,this._updateVisibility("zoom",!1))}))}),WT),this.debug=e}onMounted(){const t=this._modules.settings;t.register("interactions.zoom.enabled",!0),t.register("interactions.zoom.onDoubleClick",!1),t.register("interactions.zoom.duration",150),t.register("interactions.zoom.modifier",Xy),t.register("interactions.zoom.speed",y1),t.register("interactions.zoom.easing",y4),t.register("interactions.zoom.minValue",this.debug?null:x4),t.register("interactions.zoom.maxValue",this.debug?null:v4),t.register("interactions.zoom.hideNodes",!1),t.register("interactions.zoom.hideEdges",!1),t.register("interactions.zoom.hideNodeTexts",!1),t.register("interactions.zoom.hideEdgeTexts",!1),t.register("interactions.zoom.scrollToPan",!1),t.register("interactions.zoom.metaKey",void 0),t.register("interactions.pan.enabled",!0),t.register("interactions.pan.hideNodes",!1),t.register("interactions.pan.hideEdges",!1),t.register("interactions.pan.hideNodeTexts",!1),t.register("interactions.pan.hideEdgeTexts",!1),t.register("interactions.rotation.enabled",!0),t.register("interactions.rotation.hideNodes",!1),t.register("interactions.rotation.hideEdges",!1),t.register("interactions.rotation.hideNodeTexts",!1),t.register("interactions.rotation.hideEdgeTexts",!1),t.register("interactions.gesture.enabled",!0),t.register("interactions.gesture.hideNodes",!1),t.register("interactions.gesture.hideEdges",!1),t.register("interactions.gesture.hideNodeTexts",!1),t.register("interactions.gesture.hideEdgeTexts",!1),this._setupInteractions()}_setupInteractions(){this._modules.interactions.onMouseWheel({priority:"zoom",check:()=>!!this._modules.settings.get("interactions.zoom.enabled"),handler:({x:t,y:e,delta:s,dx:n,dy:i,domEvent:r})=>{const o=n%1!=0||i%1!=0,a=this._modules.settings;!a.get("interactions.zoom.scrollToPan")||b4(r,a.get("interactions.zoom.metaKey"),this._modules.keyboard)||o?this._smoothZoom(s,t,e):this._modules.camera.move({x:n,y:i})}}),this._modules.interactions.onDoubleClick({priority:"zoom",check:()=>{const t=this._modules.settings.get("interactions.zoom.enabled"),e=this._modules.settings.get("interactions.zoom.onDoubleClick");return!(!t||!e)},handler:({x:t,y:e})=>this._smoothZoom(1,t,e)}),this._modules.interactions.onDrag({priority:"panning",disableDetection:!0,check:({button:t})=>{const e=!!this._modules.settings.get("interactions.pan.enabled");return t==="left"&&e},onStart:()=>this._updateVisibility("pan",!0),onProgress:({dx:t,dy:e})=>this._modules.camera.move({x:-t,y:-e}),onStop:()=>this._updateVisibility("pan",!1)}),this._modules.interactions.onDrag({priority:"rotation",disableDetection:!0,check:({button:t,domEvent:e})=>(t==="right"||e&&e.buttons===2)&&!!this._modules.settings.get("interactions.rotation.enabled"),onStart:({x:t,y:e})=>{this._rotationStart={x:t,y:e},this._updateVisibility("rotation",!0)},onProgress:({x:t,y:e})=>this._rotate({x:t,y:e}),onStop:()=>this._updateVisibility("rotation",!1)}),this._modules.interactions.onGesture({priority:"gesture",disableDetection:!0,check:()=>!!this._modules.settings.get("interactions.gesture.enabled"),onStart:()=>this._updateVisibility("gesture",!0),onProgress:({dx:t,dy:e,rotation:s,scale:n,x:i,y:r})=>{this._modules.settings.get("interactions.rotation.enabled")&&this._modules.camera.rotate(-s),this._modules.camera.zoomIn({modifier:n},{x:i,y:r}),this._modules.camera.move({x:-t,y:-e})},onStop:()=>this._updateVisibility("gesture",!0)})}_rotate({x:t,y:e}){const{width:s,height:n}=this._modules.camera.getSize(),i=s/2,r=n/2,o=this._rotationStart.x-i,a=this._rotationStart.y-r,l=t-i,u=e-r,h=Math.atan2(a,o)-Math.atan2(u,l);this._rotationStart.x=t,this._rotationStart.y=e,this._modules.camera.rotate(h)}_updateVisibility(t,e){const s=!e,n=this._modules.settings,i=n.get(`interactions.${t}.hideNodes`),r=n.get(`interactions.${t}.hideEdges`),o=n.get(`interactions.${t}.hideNodeTexts`),a=n.get(`interactions.${t}.hideEdgeTexts`);i&&this._modules.graphics.setNodesVisibility(s),o&&this._modules.graphics.setNodeTextsVisibility(s),r&&this._modules.graphics.setEdgesVisibility(s),a&&this._modules.graphics.setEdgeTextsVisibility(s)}},A4=1e-8,w4=1e8,p_={duration:0,startAfter:0,ignoreZoomLimits:!1,callback:as,easing:"quadraticOut"};function fg(t){return Math.abs(t)<1e-9}var T4=80,C4=class Rk extends Ke{constructor(){super(...arguments),this._minZoom=A4,this._maxZoom=w4,this._timeout=0,this._cornerCosSin=new Float32Array([0,0,0,0,0,0,0,0])}onMounted(){this._reset(),this._modules.events.on("setContainer",(()=>{this._reset(),this._modules.events.fire("move")})).on("resize",(()=>{this._reloadDimensions(),this._modules.events.fire("move")}))}get x(){return this._x}get y(){return this._y}get zoom(){return this._zoom}get angle(){return this._angle}get width(){return this._dimensions.width}get height(){return this._dimensions.height}moveEnd(e){this._modules.dom.clearTimeout(this._timeout),this._timeout=this._modules.dom.setTimeout((()=>{this._modules.events.fire("viewChanged",{type:e})}),T4)}getSize(){return{width:this._dimensions.width,height:this._dimensions.height}}getCenter(){return{x:this._x,y:this._y}}setCenter({x:e,y:s},n){const i=this._x,r=this._y,o=e-this._x,a=s-this._y;return fg(o)&&fg(a)?Promise.resolve():new Promise((l=>{this._moveAnimation&&this._modules.animations.cancel(this._moveAnimation);const u=this._modules.animations.play((h=>{this._x=i+o*h,this._y=r+a*h,this._modules.events.fire("move").fire("pan")}),{...p_,...n,callback:()=>this.moveEnd("pan"),resolve:l});u&&(this._moveAnimation=u)}))}move({x:e,y:s},n){const i=x1({x:e,y:s},this._zoom,this._sinAngle,this._cosAngle);return this.setCenter({x:this._x+i.x,y:this._y+i.y},n)}getZoom(){return this._zoom}setZoom(e,s,n={x:void 0,y:void 0}){const{x:i,y:r}=n;let o=qi(e,this._minZoom,this._maxZoom);return s&&s.ignoreZoomLimits||(o=this._applyZoomLimits(o)),fg(this._zoom-o)?Promise.resolve():new Promise((a=>{const l={...p_,...s,callback:()=>this.moveEnd("zoom"),resolve:a},u=this._dimensions.width/2,h=this._dimensions.height/2,g=this._zoom,f=u/g-u/o;if(i!==void 0&&r!==void 0){const y=(i-u)/g-(i-u)/o,_=(r-h)/g-(r-h)/o,x=this._cosAngle,v=this._sinAngle,b=x*y-v*_,S=v*y+x*_;this.setCenter({x:this._x+b,y:this._y+S},s)}this._zoomAnimation&&this._modules.animations.cancel(this._zoomAnimation),this._modules.dom.afterNextFrame().then((()=>this._modules.events.fire("zoomStart",{duration:l.duration,easing:l.easing,startZoom:g,endZoom:o})));const p=this._modules.animations.play((y=>{this._zoom=u/(u/g-f*y),this._modules.events.fire("move").fire("zoom")}),l);p&&(this._zoomAnimation=p)}))}_applyZoomLimits(e){const s=this._modules.settings.get("interactions.zoom.minValue"),n=this._modules.settings.get("interactions.zoom.maxValue"),{minScaledSize:i,maxScaledSize:r,width:o,height:a,cx:l}=this._modules.locate.getGraphBoundingBox(),u=this._zoom,h=this.getSize();let g=e;if(!isNaN(l)){const f={smallestNodeSize:i,biggestNodeSize:r,graphWidth:o+r,graphHeight:a+r,viewWidth:h.width,viewHeight:h.height},p=s&&s(f),y=n&&n(f);v1(p)&&g<p?g<u&&(g=Math.min(u,p)):v1(y)&&g>y&&g>u&&(g=Math.max(u,y))}return g}zoomIn(e,s={x:void 0,y:void 0}){let n=1;return e===void 0&&(e={}),typeof e=="number"&&(e={modifier:e}),n=typeof e.modifier!="number"?this._modules.settings.get("interactions.zoom.modifier")||Xy:e.modifier,this.setZoom(this._zoom*n,e,s)}moveToBounds(e,s={}){const n=this._modules.locate.computeConfigForBounds(e,{ignoreZoomLimits:!0});return this.moveTo(n,s)}moveTo(e,s={}){const n=this.getZoom(),i=this.getCenter(),r=e.zoom||this._zoom;return s.duration===0?this.setView(e):new Promise((o=>{const a=Math.min(this.width,this.height),l=_4([i.x,i.y,a/n],[e.x,e.y,a/r]),u=l.duration,h=s.duration||u;this._moveAnimation&&this._modules.animations.cancel(this._moveAnimation);const g=this._modules.animations.play((f=>{const[p,y,_]=l(f);this._x=p,this._y=y,this._zoom=a/_,this._modules.events.fire("move"),this._modules.events.fire("pan")}),{duration:h,easing:s.easing,callback:()=>this.moveEnd("pan"),resolve:o});g&&(this._moveAnimation=g)}))}zoomOut(e,s={x:void 0,y:void 0}){let n=1;return e===void 0&&(e={}),typeof e=="number"&&(e={modifier:e}),n=typeof e.modifier!="number"?this._modules.settings.get("interactions.zoom.modifier")||Xy:e.modifier,this.setZoom(this._zoom/n,e,s)}getAngle(){return this._angle}setAngle(e,s){const n=this._angle,i=e-n;return fg(i)?Promise.resolve():new Promise((r=>{this._rotateAnimation&&this._modules.animations.cancel(this._rotateAnimation);const o=this._modules.animations.play((a=>{for(this._angle=n+i*a,this.calculateBoxCornerAngles();this._angle>Math.PI;)this._angle-=2*Math.PI;for(;this._angle<-Math.PI;)this._angle+=2*Math.PI;this._sinAngle=Math.sin(this._angle),this._cosAngle=Math.cos(this._angle),this._modules.events.fire("move").fire("rotate")}),{...p_,...s,callback:()=>this.moveEnd("rotate"),resolve:r});o&&(this._rotateAnimation=o)}))}rotate(e,s){return this.setAngle(this._angle+e,s)}getScreenCenter(){return{x:this._dimensions.width/2,y:this._dimensions.height/2}}graphToScreenCoordinates({x:e,y:s},n={x:0,y:0}){const i=this._dimensions.width/2,r=this._dimensions.height/2;return hf((e-this._x)*this._zoom+i,(s-this._y)*this._zoom+r,i,r,-this._angle,n)}screenToGraphCoordinates({x:e,y:s},n={x:0,y:0}){return hf(this._x+(e-this._dimensions.width/2)/this._zoom,this._y+(s-this._dimensions.height/2)/this._zoom,this._x,this._y,this._angle,n)}projectBounds(e,s=e){const n=e[0],i=e[1],r=e[2],o=e[3],a=this._x,l=this._y,u=this._dimensions.width/2,h=this._dimensions.height/2,g=this._sinAngle,f=this._cosAngle,p=1/this._zoom;let y=1/0,_=1/0,x=-1/0,v=-1/0;const b=[n,i,n,o,r,o,r,i];for(let S=0;S<b.length;S+=2){let A=b[S],w=b[S+1];A=a+(A-u)*p,w=l+(w-h)*p;const L=A-a,I=w-l;A=f*L-g*I+a,w=g*L+f*I+l,A<y&&(y=A),A>x&&(x=A),w<_&&(_=w),w>v&&(v=w)}return s[0]=y,s[1]=_,s[2]=x,s[3]=v,s}screenToGraphVector({x:e,y:s}){return x1({x:e,y:s},this._zoom,this._sinAngle,this._cosAngle)}getView(){return{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,width:this._dimensions.width,height:this._dimensions.height}}setView(e,s){const{x:n,y:i,zoom:r,angle:o}={x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,...e};return Promise.all([this.setCenter({x:n,y:i},s),this.setZoom(r,s),this.setAngle(o,s)]).then(as)}_reloadDimensions(){this._dimensions=this._modules.dom.getDimensions()}animationInProgress(){const e=this._moveAnimation,s=this._zoomAnimation,n=this._rotateAnimation;return!!(e&&!e.done||s&&!s.done||n&&!n.done)}getProjectedScreenBounds(e=0){const{width:s,height:n}=this._dimensions,i=Math.max(s,n)*e;return this.projectBounds([0-i,0-i,s+i,n+i])}calculateBoxCornerAngles(){const e=this._angle;this._cornerCosSin[0]=Math.cos(e+Math.PI/4),this._cornerCosSin[1]=Math.sin(e+Math.PI/4),this._cornerCosSin[2]=Math.cos(e+3*Math.PI/4),this._cornerCosSin[3]=Math.sin(e+3*Math.PI/4),this._cornerCosSin[4]=Math.cos(e-3*Math.PI/4),this._cornerCosSin[5]=Math.sin(e-3*Math.PI/4),this._cornerCosSin[6]=Math.cos(e-Math.PI/4),this._cornerCosSin[7]=Math.sin(e-Math.PI/4)}getCornerCos(e){return this._cornerCosSin[2*e]}getCornerSin(e){return this._cornerCosSin[2*e+1]}_reset(){this._zoom=1,this._x=0,this._y=0,this._angle=0,this.calculateBoxCornerAngles(),this._sinAngle=0,this._cosAngle=1,this._dimensions=this._modules.dom.getDimensions()}clone(e){const s=new Rk(this._ogma);return s._zoom=e.zoom||this._zoom,s._x=e.x||this._x,s._y=e.y||this._y,s._angle=e.angle||this._angle,s._sinAngle=Math.sin(s._angle),s._cosAngle=Math.cos(s._angle),s.calculateBoxCornerAngles(),s._dimensions={width:e.width||this._dimensions.width,height:e.height||this._dimensions.height},s}};function x1({x:t,y:e},s,n,i){return{x:i*(t/=s)-n*(e/=s),y:n*t+i*e}}function v1(t){return typeof t=="number"&&isFinite(t)}function L4(t){const e=t.filter((s=>isFinite(s)&&s>0));return e.length?Kr(e):1}var k4="anonymous",N4="white",M4="default",I4={maxBlockId:1024,maxCoord:-1/0,maxScaledSize:16,maxPixelSize:255,maxMinVisibleSize:64,maxDashOffset:4,maxDashLength:3,maxGapLength:1,maxSymbolicSize:0,maxPatternScale:0},R4=Vf?"webgl":null,b1=5,F4=class extends Ke{constructor(){super(...arguments),this._debug=!1,this._initDone=!1,this._boundaries={maxSize:10,maxMinVisibleSize:64},this._visibility={nodes:0,edges:0,nodeTexts:0,edgeTexts:0},this._nextAnimationId=1,this._animations=[],this._rendererState={type:null,code:null,state:"ok",message:""},this._cursorStyle=[],this._fontsNewlyLoaded=[],this._nextGeIndex=1,this._availableGeIndexes=[],this._renderOnNewFrame=!0,this._isBufferDisplayable=t=>{const e=rU(t),s=QC(t),n=e?this._visibility.nodes:this._visibility.edges,i=e?this._visibility.nodeTexts:this._visibility.edgeTexts;return n===0&&(!s||i===0)},this._onRendererChange=t=>{this._updateRendererState({type:t,state:"requested",code:null,message:void 0}),this._engine.setRenderType(t),this._modules.dom.refresh()},this._onNewFrame=()=>{this._processAnimations(),this._loadGraphInGraphicsEngine(),this._renderOnNewFrame&&this._render()},this._applyCursorStyle=()=>{const t=this._cursorStyle[this._cursorStyle.length-1]||this._modules.settings.get("cursor.default");uf(this._domWrapper,t)},this._updateImageCrossOrigin=()=>{this._imageManager.setImgCrossOrigin(this._modules.settings.get("imgCrossOrigin")||null)}}onMounted(){this._debug=this._ogma.isDebug(),this._renderOnNewFrame=!0,this._formatText=bC().applyArabicShaping,this._attributesManager=new g4(this._ogma,this._modules),this._imageManager=new e3,this._fontManager=new fB,this._engine=new l_(l_.getCachedInitData()),this._domWrapper=this._engine.getDomWrapper(),this._engine.on("error",this._onNewFrame),this._nodeAnimationMap=new Map,this._edgeAnimationMap=new Map,this._movingNodes=new Set,this._movingEdges=new Set,this._modules.events.register(["reloadFonts","rendererStateChange","beforeUpdateAttributes","updateAttributes","animate","move","pan","zoom","rotate","viewExportStart","viewExportEnd","afterImageExport","viewChanged","zoomStart"]),this._modules.settings.register("renderer",R4,this._onRendererChange),this._modules.settings.register("edgeTipRatio",K2,(t=>{this._engine.setEdgeArrowSizeRatio(t),this._modules.dom.refresh()})),this._modules.settings.register("nodeCornerRadius",0,(t=>{QU(this._engine,t),this._modules.dom.refresh()})),this._modules.settings.register("edgeMinTipSize",Q2,(t=>{this._engine.setEdgeMinTipSize(t),this._modules.dom.refresh()})),this._modules.settings.register("backgroundColor",N4,(t=>{this._engine.parseColor(t)?this._modules.dom.refresh():($o(`Invalid background color "${t}" specified; will default to black.`),this._modules.settings.set("backgroundColor","black"))})),this._modules.settings.register("texts.hideUntilFontsLoaded",!0,(t=>{this._fontManager.setHideUntilFontsLoaded(!!t)})),this._modules.settings.register("texts.cornerRadius",b1,(t=>{this._engine.getTextManager().setCornerRadius(typeof t=="number"?t:b1),this._modules.dom.refresh()})),this._modules.settings.register("imgCrossOrigin",k4,this._updateImageCrossOrigin),this._modules.settings.register("cursor.default",M4,this._applyCursorStyle),this._modules.dom.setLayer("graphics",this._domWrapper),this._engine.setGlobalBoundaries(I4),this._modules.dom.beforeNextFrame().then((()=>{this._initDone=!0,this._fireRendererStateChangeEvent()})),this._imageManager.onFetch((()=>{this._engine.notifyPatternUpdate(),this._modules.dom.refresh()})),this._fontManager.onFontLoaded((t=>{this._fontsNewlyLoaded.push(t),this._engine.notifyPatternUpdate(),this._engine.notifyFontsReloaded(),this._modules.dom.refresh()})),this._modules.dom.addMediaListener("(min-resolution: 2dppx)",(()=>this._modules.dom.refresh())),this._visibleAttributeLayer=this._attributesManager.addAttributeLayer({priority:0,name:`internal(${_y})`,tag:_y,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),this._dataAttributeLayer=this._attributesManager.addAttributeLayer({priority:0,name:`internal(${yy})`,tag:yy,nodeDependencies:void 0,edgeDependencies:void 0}),l1(this._engine,this._attributesManager.getFlexArrays()),this._modules.events.on("move",(()=>this._modules.dom.refresh())).on("frame",this._onNewFrame).on("viewExportStart",(()=>{this._renderOnNewFrame=!1})).on("viewExportEnd",(()=>{this._renderOnNewFrame=!0})).on("clearGraph",(()=>{this._nextGeIndex=1,this._availableGeIndexes=[],this._engine.clear(),this._attributesManager.clear(),this._modules.dom.refresh(),this._animations=[],this._nodeAnimationMap.clear(),this._edgeAnimationMap.clear()})).on("viewChanged",(({type:t})=>{if(t==="rotate"){const e=this._modules.graph.getEdges().filter((s=>s.getAttribute("adjustAnchors")));this._attributesManager.redrawElements(e)}})).on("addNodes",(t=>{this._attributesManager.updateForAllAttributeLayers(t.nodes)})).on("addEdges",(t=>{this._attributesManager.updateForAllAttributeLayers(t.edges)})).on("excludedStateChange",(t=>{this._visibleAttributeLayer.updateElements(t.elements)})).on("setData",(t=>{this._dataAttributeLayer.updateElements(t.elements)})),l_.clearCachedInitData(),this._modules.dom.addWindowEventListener("unload",(()=>this.destroy()))}onReady(t){t.renderer!==void 0&&this._ogma.setOptions({renderer:t.renderer}),t.imgCrossOrigin!==void 0&&this._ogma.setOptions({imgCrossOrigin:t.imgCrossOrigin})}getTransparentBackgroundColor(){const t=this._modules.settings.get("backgroundColor");return t?this._engine.transparentify(t):null}pauseRendering(){this._renderOnNewFrame=!1}resumeRendering(){this._renderOnNewFrame=!0}_render(){const t=this._modules.dom.getDimensions(),e=this._modules.camera.getView(),s=vi(),n=$n(),i=this._modules.settings.get("backgroundColor"),r=this._isBufferDisplayable;this._engine.setView({x:e.x,y:e.y,zoom:e.zoom,angle:e.angle,width:t.width,height:t.height,pixelRatio:s,currentTime:n,backgroundColor:i,isBufferDisplayable:r});try{this._engine.render(),this._rendererState.state==="requested"&&this._updateRendererState({state:"ok"})}catch(o){if(this._debug)throw o;const{message:a,code:l="OTHER"}=o,u=this._rendererState.type,h=pO(u),g=`Error while initializing the ${h} renderer`,f=`The ${h} renderer encountered an unexpected runtime error`;let p=this._rendererState.state==="requested"?g:f,y=null;u==="webgl"&&(p+="; fallbacking on canvas renderer",y="canvas"),$o(a||""),$o(p),this._updateRendererState({state:"error",code:l,message:a}),this._modules.settings.set("renderer",y)}}_fireRendererStateChangeEvent(){const t=this._rendererState;this._modules.events.fire("rendererStateChange",{type:t.type,state:t.state,code:t.code,message:t.message})}_updateRendererState({type:t,state:e,code:s,message:n}){let i=!1;t!==void 0&&this._rendererState.type!==t&&(this._rendererState.type=t,i=!0),e!==void 0&&this._rendererState.state!==e&&(this._rendererState.state=e,i=!0),s!==void 0&&this._rendererState.code!==s&&(this._rendererState.code=s,i=!0),n!==void 0&&this._rendererState.message!==n&&(this._rendererState.message=n,i=!0),i&&this._initDone&&this._fireRendererStateChangeEvent()}getImageData(){return this._modules.dom.afterNextFrame().then((()=>this._engine.getImageData()))}getNodeAttributes(){return this._attributesManager.getFlexArrays().nodes.current}getEdgeAttributes(){return this._attributesManager.getFlexArrays().edges.current}getGraphicsEngine(){return this._engine}getImageManager(){return this._imageManager}getFontManager(){return this._fontManager}allocateGraphicsEngineBlockId(){return this._availableGeIndexes.length?this._availableGeIndexes.pop():this._nextGeIndex++*tp+wD}releaseGraphicsEngineBlockId(t){this._engine.freeBlock(t),this._availableGeIndexes.push(t),this._modules.dom.refresh()}addCursorStyle(t){t&&(this._cursorStyle.push(t),this._applyCursorStyle())}removeCursorStyle(t){if(!t)return;const e=this._cursorStyle.lastIndexOf(t);e!==-1&&(this._cursorStyle.splice(e,1),this._applyCursorStyle())}reloadFonts(){this._modules.events.fire("reloadFonts"),this._engine.notifyFontsReloaded(),this._modules.dom.refresh()}getDomElement(){return this._domWrapper}setTextHidden(t,e){this._attributesManager.setTextHidden(t,e)}resetTextHidden(){this._attributesManager.resetTextHidden(),this._modules.dom.refresh()}getAttributesManager(){return this._attributesManager}_checkFontsNewlyLoaded(){return!!this._fontsNewlyLoaded.length&&(this._fontsNewlyLoaded=[],!0)}_loadGraphInGraphicsEngine(){this._attributesManager.update(),this._checkFontsNewlyLoaded()&&this._attributesManager.redrawAll(),this._modules.events.fire("beforeUpdateAttributes");const{elementsToRedraw:t,elementsUpdated:e}=this._attributesManager.getUpdatedElements(),s=e.nodes.size>0||e.edges.size>0;(e.nodeAttributesSet.has("radius")||e.edgeAttributes.includes("width"))&&(this._boundaries.maxSize=fO(this._modules.graph)),(e.nodeAttributesSet.has("shape")||e.edgeAttributes.includes("shape.head")||e.edgeAttributes.includes("shape.tail"))&&l1(this._engine,this._attributesManager.getFlexArrays()),jU({graph:this._modules.graph,elements:t,engine:this._engine,imageManager:this._imageManager,fontManager:this._fontManager,view:this._modules.camera.getView(),attributes:this._attributesManager.getFlexArrays(),boundaries:this._boundaries,formatText:this._formatText}),s&&this._modules.events.fire("updateAttributes",e)}_forceCompleteGraphRefresh(){this._attributesManager.redrawAll(),this._loadGraphInGraphicsEngine()}export(t,e,s,n){let i;return Promise.all([this._modules.graph.getNodes().addClass(ka),this._modules.graph.getEdges().addClass(ka)]).then((()=>this.resolveAtNextFrame())).then((()=>this._imageManager.whenReady())).then((()=>{s==="all"?(i=D4(this._modules.graph),this._forceCompleteGraphRefresh()):this._loadGraphInGraphicsEngine();const r=this._modules.camera.clone({...e});return this._modules.events.fire("viewExportStart",{preventOverlap:n.preventOverlap,camera:r,view:r.getView()}),this._ogma.view.afterNextFrame().then((()=>this._engine.export(t,e,n)))})).then((r=>Promise.all([this._modules.graph.getNodes().removeClass(ka),this._modules.graph.getEdges().removeClass(ka)]).then((()=>r)))).then((r=>(s==="all"&&(O4(i),this._forceCompleteGraphRefresh()),this._modules.events.fire("viewExportEnd"),r)))}addAttributeLayer(t){return this._attributesManager.addAttributeLayer(t)}getAttributeValues(t,e,s,n){return this._attributesManager.getAttributeValues(t,e,s,n)}forceAttributesComputation(){this._attributesManager.update()}resolveAtNextFrame(t){return this._modules.dom.afterNextFrame().then((()=>t))}isMoving(t){return(t.isNode?this._movingNodes:this._movingEdges).has(t._index)}animate(t,e,s,n){const i=P4(n);return i.duration&&this._engine.ensureAnimationsReady(),this._animate(t,e,s,i)}isAnimating(){return this._animations.length>0}getAnimationInformation(t){return this._attributesManager.getAnimationInformation(t)}_toSubGraph(t){if(t instanceof lo||t instanceof yi)return{nodes:t.toList(),edges:t.getAdjacentEdges()};if(t instanceof qa||t instanceof Mr)return{nodes:this._modules.graph.nodeList(),edges:t.toList()};const e=t,s={nodes:e.nodes||this._modules.graph.nodeList(),edges:e.edges||this._modules.graph.edgeList()};return s.nodes.size&&(s.edges.size?s.edges=s.edges.concat(s.nodes.getAdjacentEdges()).dedupe():s.edges=s.nodes.getAdjacentEdges()),s}_animate(t,e,s,{duration:n,easing:i}){if((!this._animations.length||s)&&!n)return e(t),Promise.resolve(t);const r=this._toSubGraph(t),o=r.nodes,a=r.edges;if(o.size===0&&a.size===0)return e(t),Promise.resolve(t);if(o.size){if(s)for(let f=0;f<o._indexes.length;f++)this._movingNodes.add(o._indexes[f]);this._modules.events.fire("animate",{elements:o,duration:n,updatesPositions:s,easing:i})}if(a.size){if(s)for(let f=0;f<a._indexes.length;f++)this._movingEdges.add(a._indexes[f]);this._modules.events.fire("animate",{elements:a,duration:n,updatesPositions:s,easing:i})}const l={id:this._nextAnimationId++,startTime:$n(),finished:!1,func:()=>e(t),duration:n,easing:i,nodes:o,edges:a,started:!1,updatesPositions:s,resolve:as};let u=l;const h=new Set;if(u=this._getLongestAnimation(u,l.nodes,h),u=this._getLongestAnimation(u,l.edges,h),u.updatesPositions){for(let f=0;f<o._indexes.length;f++)this._nodeAnimationMap.set(o._indexes[f],u);for(let f=0;f<a._indexes.length;f++)this._edgeAnimationMap.set(a._indexes[f],u);l.duration=u.duration,l.startTime=u.startTime}if(l.duration===0&&u.id===l.id)return e(t),Promise.resolve(t);const g=new Promise((f=>l.resolve=()=>f(t)));return this._animations.push(l),this._modules.dom.refresh(),n||this._processAnimations(),g}_removeFinishedAnimations(){this._animations=this._animations.filter((t=>!t.finished))}_getAnimationElements(t){return{nodes:t.nodes,edges:t.edges}}_resetAnimationAttributes({nodes:t,edges:e}){this._attributesManager.resetAnimationAttributes({nodes:t,edges:e});for(let s=0;s<t._indexes.length;s++)this._nodeAnimationMap.delete(t._indexes[s]),this._movingNodes.delete(t._indexes[s]);for(let s=0;s<e._indexes.length;s++)this._edgeAnimationMap.delete(e._indexes[s]),this._movingEdges.delete(t._indexes[s])}_getLongestAnimation(t,e,s){const n=e.isNode?this._nodeAnimationMap:this._edgeAnimationMap;for(let i=0;i<e._indexes.length;i++){const r=n.get(e._indexes[i]);r&&!s.has(r.id)&&(s.add(r.id),(t.updatesPositions||!r.updatesPositions)&&r.duration+r.startTime<t.duration+t.startTime||(t=r))}return t}_processAnimations(){if(!this._animations.length)return;const t=$n(),e=[];this._attributesManager.update();for(const s of this._animations)s.started||(s.started=!0,e.push(s.func),this._attributesManager.setAnimationAttributes(this._getAnimationElements(s),s));for(const s of e)s();for(const s of this._animations)t>=s.startTime+s.duration&&(this._resetAnimationAttributes(this._getAnimationElements(s)),s.resolve(s.elements),s.finished=!0);this._removeFinishedAnimations(),this._animations.length&&this._modules.dom.refresh()}hideTexts(){this.setNodeTextsVisibility(!1),this.setEdgeTextsVisibility(!1)}showTexts(){this.setNodeTextsVisibility(!0),this.setEdgeTextsVisibility(!0)}setNodesVisibility(t){return this._updateVisibilityCounter("nodes",t)}setNodeTextsVisibility(t){return this._updateVisibilityCounter("nodeTexts",t)}setEdgesVisibility(t){return this._updateVisibilityCounter("edges",t)}setEdgeTextsVisibility(t){return this._updateVisibilityCounter("edgeTexts",t)}_updateVisibilityCounter(t,e){this._visibility[t]+=e?-1:1,this._modules.dom.refresh()}detectNode(t,e,s,n,i,r){return cO(t,e,s,n,i,r,this._modules.graph,this._attributesManager,this._modules.camera,this._engine,this._movingNodes,this._formatText)}detectEdge(t,e,s,n,i){const{bentEnable:r,bentVertical:o}=this._modules.graphics.getGraphicsEngine().getBentEdges();return gO(t,e,s,n,i,this._modules.graph,this._modules.camera,this._movingNodes,this._attributesManager,r,o)}getVisibilityCounters(){return this._visibility}destroy(){this.getGraphicsEngine().destroy(),this.getImageManager().destroy(),this.getFontManager().destroy()}};function P4(t){return typeof t=="number"?t={duration:t}:typeof t=="object"&&t!==null||(t={duration:0}),{duration:z4(t.duration),easing:t.easing||"linear",chain:!!t.chain}}function z4(t){return typeof t!="number"||!isFinite(t)||t<0?0:t}function E1(t,e){const s=e?t.getNodeAttribute("excluded"):t.getEdgeAttribute("excluded"),n=(e?t.getNodes("all"):t.getEdges("all"))._indexes,i=s.getMultiple(n);return s.fill(n,0),{excludedList:s,indexes:n,values:i}}function S1({excludedList:t,indexes:e,values:s}){t.setMultiple(e,s)}function D4(t){return{nodes:E1(t,!0),edges:E1(t,!1)}}function O4({nodes:t,edges:e}){S1(t),S1(e)}var B4=180,U4=50,G4=class extends Ke{constructor(){super(...arguments),this._onAnyEvents=[],this._registeredEvents={},this.onIdle=Yd((()=>this.fire("idle")),U4),this.fireIdle=lT(this.onIdle,B4)}onMounted(){this._registeredEvents={},this.register(["idle"]),this._ogma.onReady((()=>{this.on(["viewChanged","layoutEnd","addNodes","addEdges","removeNodes","removeEdges","animate","setMultipleAttributes","transformationRefresh"],this.fireIdle)}))}isRegistered(t){return!!this._registeredEvents[t]}register(t,e=[]){t.forEach((s=>{this._registeredEvents[s]||(this._registeredEvents[s]=new V4(!1,s))}))}onAnyEvent(t){this._onAnyEvents.push(t)}on(t,e){return Array.isArray(t)?(t.forEach((s=>this.on(s,e))),this):this._registeredEvents[t]?(this._registeredEvents[t].on(e),this):this}off(t){return Object.values(this._registeredEvents).forEach((e=>e.off(t))),this}fire(t,e=null){const s=this._getEvent(t);return this._onAnyEvents.forEach((n=>n(e,t))),s.trigger(e),this}once(t,e){return Array.isArray(t)?(t.forEach((s=>this.once(s,e))),this):this._registeredEvents[t]?(this._registeredEvents[t].once(e),this):this}_getEvent(t){if(!(t in this._registeredEvents))throw new Error(`Event ${t} does not exist`);return this._registeredEvents[t]}destroy(){Object.values(this._registeredEvents).forEach((t=>{t.destroy()}))}},V4=class{constructor(t,e){this._subscribers=[],this._handlers=[],this._onceWrappers=new WeakMap,this._reverseOrder=t,this._name=e}trigger(t){for(const e of this._handlers)e(t,this._name);return this}on(t){if(typeof t!="function")throw new Error("handler is not a function");const e=this._reverseOrder?0:this._subscribers.length;return this._handlers.splice(e,0,t),this._subscribers.splice(e,0,t),this}once(t){if(typeof t!="function")throw new Error("handler is not a function");const e=this,s=function(){t.apply(null,arguments),e.off(s)};return this._onceWrappers.set(t,s),this.on(s),this}off(t){const e=this._onceWrappers.get(t),s=e||t;let n;for(;(n=this._subscribers.indexOf(s))!==-1;)this._subscribers.splice(n,1),this._handlers.splice(n,1);return e&&this._onceWrappers.delete(t),this}destroy(){this._subscribers=[],this._handlers=[]}},j4=class extends Ke{onMounted(){this._graphics=this._modules.graphics,this._modules.events.register(["setMultipleAttributes"]),this._modules.events.on(["addNodes","addEdges"],(({nodes:t,edges:e,objects:s})=>{this._onAddElements(t||e,s)})),this._originalAttributesLayer=this._graphics.addAttributeLayer({name:"original-attributes",priority:Oz,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),this._individualAttributesLayer=this._graphics.addAttributeLayer({name:"individual-attributes",priority:Gz,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0})}_onAddElements(t,e){const s=e.map((n=>n.attributes));this._originalAttributesLayer.setAttributeValues(t,s)}getOriginalAttributes(){return this._originalAttributesLayer.getFlexArrays()}getIndividualAttributes(){return this._individualAttributesLayer.getFlexArrays()}setMultipleAttributes(t,e,s){const n=Array.isArray(e)?e.length&&e[0]?Sf(e[0],t.isNode):[]:Sf(e,t.isNode),i=n.includes("x")||n.includes("y"),r=[];return this._modules.events.fire("setMultipleAttributes",{elements:t,values:e,updatedAttributes:n,options:s,promises:r}),this._graphics.animate(t,(()=>{this._individualAttributesLayer.setAttributeValues(t,e)}),i,s).then((o=>Promise.all(r).then((()=>o))))}setSingleAttribute(t,e,s,n){const i={};return so(i,e,s),this.setMultipleAttributes(t,i,n)}resetMultipleAttributes(t,e,s){const n=e||this._individualAttributesLayer.getUsedAttributeNames(t),i=n&&(n.includes("x")||n.includes("y")),r={};for(const o of n)so(r,o,void 0);return this._graphics.animate(t,(()=>{this._individualAttributesLayer.setAttributeValues(t,r)}),i,s)}getMultipleAttributes(t,e){return this._graphics.getAttributeValues(t,e,!0,!1)}getSingleAttribute(t,e){return this._graphics.getAttributeValues(t,e,!1,!1)}replaceOriginalAttributes(t,e,s=[]){const n={},i=this._originalAttributesLayer.getUsedAttributeNames(t).filter((r=>!s.includes(r)));for(let r=0;r<i.length;++r)so(n,i[r],void 0);this._originalAttributesLayer.setAttributeValues(t,n),this._originalAttributesLayer.setAttributeValues(t,e)}getSinglePreviousAttribute(t,e){return this._graphics.getAttributeValues(t,e,!1,!0)}getMultiplePreviousAttributes(t,e){return this._graphics.getAttributeValues(t,e,!0,!0)}},H4=class extends Ke{constructor(){super(...arguments),this._currentValue={},this._onChange={},this._defaultValues={},this._keys=[]}onReady(t){t.renderer&&this.update({renderer:t.renderer}),t.options&&this.update(t.options)}register(t,e,s,n){return n===void 0&&(n=!0),this._keys.push(t),this._currentValue[t]=e,this._defaultValues[t]=e,this._onChange[t]=s||as,s&&n&&s(e),this}update(t){t=Wd(t);const e=this._keys,s={},n=this._currentValue;for(let r=0;r<e.length;++r){const o=e[r];if(o in t){let a=t[o];a===void 0&&(a=this._defaultValues[o]),s[o]=n[o],n[o]=a}}const i=Object.keys(s);for(let r=0;r<i.length;++r){const o=i[r],a=this._currentValue[o],l=s[o];a!==l&&this._onChange[o](a,l)}return J_(s)}get(t){return arguments.length===0?J_(this._currentValue):this._currentValue[t]}set(t,e){const s=this._currentValue[t],n=this._onChange[t];this._currentValue[t]=e,n&&n(e,s)}},$4=class{constructor(t,e){this._classes=t,this._name=e}getName(){return this._name}getIndex(){return this._classes.getIndex(this._name)}setIndex(t){return this._classes.setIndex(this._name,t)}update(t){return this._classes.update(this._name,t),this}getDefinition(){return this._classes.getDefinition(this._name)}getNodes(t){return this._classes.getElementsByClass(this._name,t).nodes}getEdges(t){return this._classes.getElementsByClass(this._name,t).edges}clearNodes(t){this.getNodes(t).removeClass(this._name)}clearEdges(t){this.getEdges(t).removeClass(this._name)}add(t){t.addClass(this._name)}remove(t){t.removeClass(this._name)}destroy(){const t=this._classes.getElementsByClass(this._name);return Promise.all([t.nodes.removeClass(this._name),t.edges.removeClass(this._name)]).then((()=>this._classes.removeClass(this._name)))}},q4=1e3,Y4=.5/q4,W4=class extends Ke{constructor(){super(...arguments),this._builtinClasses=[],this._userClasses=[],this._classesByName={},this._onExcludedStateChange=({elements:t,value:e})=>{if(e){const s=this._builtinClasses.map((n=>n.name));this._addOrRemoveClassesToElements(s,t,!1)}},this._onClearGraph=()=>{this._builtinClasses.concat(this._userClasses).forEach((t=>t.elementSet.clear()))},this._onRemoveElements=({nodes:t,edges:e})=>{const s=t||e;this._builtinClasses.concat(this._userClasses).forEach((n=>n.elementSet.removeElements(s)))}}onMounted(){this._modules.events.on("excludedStateChange",this._onExcludedStateChange).on("clearGraph",this._onClearGraph).on("removeEdges",this._onRemoveElements).on("removeNodes",this._onRemoveElements)}_getClassList(t){return t?this._builtinClasses:this._userClasses}createClass({name:t,isBuiltin:e=!1,after:s,nodeAttributes:n,nodeDependencies:i,nodeOutput:r,edgeAttributes:o,edgeDependencies:a,edgeOutput:l}={}){if(typeof t!="string")throw new Error('the "name" argument should be a string');const u=this._getClassList(e),h=s?X4(u,s)+1:u.length;if(h===-1)throw new Error(`createClass: class specified as \`after\` parameter "${s}" does not exist`);if(e&&!t.startsWith("_"))throw new Error(`invalid builtin class name "${t}": builtin classes should start with '_'`);const g=new kh(this._modules.graph),f=new $4(this,t),p={name:t,elementSet:g,attributeLayer:this._modules.graphics.addAttributeLayer({name:`class(${t})`,tag:t,standaloneSelectors:!0,nodeAttributes:n||void 0,edgeAttributes:o||void 0,nodeSelector:(y,_)=>_.hasElement(y),edgeSelector:(y,_)=>_.hasElement(y),nodeContext:g,edgeContext:g,nodeOutput:r,edgeOutput:l,nodeDependencies:i,edgeDependencies:a}),isBuiltin:e,wrapper:f};return u.splice(h,0,p),e&&u.sort(((y,_)=>QE.indexOf(y.name)-QE.indexOf(_.name))),this._updatePriorities(e),this._classesByName[t]=p,this._modules.events.register([Ml(t,!0,!0),Ml(t,!0,!1),Ml(t,!1,!0),Ml(t,!1,!1)]),f}removeClass(t){const e=this._get(t),s=this._getClassList(e.isBuiltin),n=s.indexOf(e);return n!==-1&&(s.splice(n,1),e.attributeLayer.destroy(),delete this._classesByName[t],this._updatePriorities(e.isBuiltin)),Promise.resolve(void 0)}_updatePriorities(t){const e=this._getClassList(t),s=Vz+(t?.5:0);for(let n=0;n<e.length;++n){const i=e[n],r=s+Y4*n;i.attributeLayer.update({priority:r})}}_get(t){const e=this._classesByName[t];if(!e)throw new Error(`class "${t}" does not exist`);return e}getIndex(t){const e=this._get(t);return this._getClassList(e.isBuiltin).indexOf(e)}setIndex(t,e){const s=this._get(t),n=this._getClassList(s.isBuiltin),i=n.indexOf(s),r=qi(e,0,n.length-1);n.splice(i,1),n.splice(r,0,s),this._updatePriorities(s.isBuiltin)}update(t,{nodeAttributes:e,edgeAttributes:s,nodeDependencies:n,edgeDependencies:i,nodeOutput:r,edgeOutput:o,fullOverwrite:a}={}){this._get(t).attributeLayer.update({nodeAttributes:e,edgeAttributes:s,nodeDependencies:n,edgeDependencies:i,nodeOutput:r,edgeOutput:o,fullOverwrite:a})}getDefinition(t){const e=this._get(t),{nodeAttributes:s,nodeDependencies:n,nodeOutput:i,edgeAttributes:r,edgeDependencies:o,edgeOutput:a}=e.attributeLayer.getDefinition();return{nodeAttributes:s||void 0,edgeAttributes:r||void 0,nodeDependencies:n,edgeDependencies:o,nodeOutput:i,edgeOutput:a}}_addOrRemoveClassesToElements(t,e,s){const n=e.isNode;for(let i=0;i<t.length;++i){const r=t[i],{elementSet:o,attributeLayer:a}=this._get(r),l=o.addOrRemoveElements(e,s),u=Ml(r,n,s);l.size&&(a.updateElements(l),this._modules.events.fire(u,n?{nodes:l}:{edges:l}))}}_animatedAttributesUpdatePositions(t,e){for(let s=0;s<t.length;++s){const n=t[s],i=this.getDefinition(n);if(e.isNode&&i.nodeAttributes&&(i.nodeAttributes.x||i.nodeAttributes.y))return!0}return!1}_getAnimatedAtrributes(t,e){return t.reduce(((s,n)=>{const i=this.getDefinition(n);return e.isNode&&i.nodeAttributes&&s.push(...Sf(i.nodeAttributes,!0)),!e.isNode&&i.edgeAttributes&&s.push(...Sf(i.edgeAttributes,!1)),s}),[])}addClassesToElements(t,e,s){const n=e.toList(),i=this._animatedAttributesUpdatePositions(t,n);return this._modules.graphics.animate(e,(()=>{this._addOrRemoveClassesToElements(t,n,!0)}),i,s)}removeClassesFromElements(t,e,s){const n=e.toList(),i=this._animatedAttributesUpdatePositions(t,n);return this._modules.graphics.animate(e,(()=>{this._addOrRemoveClassesToElements(t,n,!1)}),i,s)}hasSingleElementClass(t,e){return!!this._classesByName[t]&&this._get(t).elementSet.hasElement(e)}getElementsClassList(t,e={}){const{includeBuiltinClasses:s=!1}=e,n=new Array(t.size);for(let i=0;i<n.length;++i)n[i]=[];return this._addClassNamesToList(n,t,this._userClasses),s&&this._addClassNamesToList(n,t,this._builtinClasses),n}_addClassNamesToList(t,e,s){const n=e.toList();for(let i=0;i<s.length;++i){const{name:r,elementSet:o}=s[i];for(let a=0;a<n.size;++a){const l=n.get(a);o.hasElement(l)&&t[a].push(r)}}}getClassByName(t,e=!1){const s=this._classesByName[t]||null;if(e&&!s)throw new Error(`class "${t}" does not exist`);return s&&s.wrapper}getClassList(){return this._userClasses.map((t=>t.wrapper))}getElementsByClass(t,e="visible"){const{elementSet:s}=this._get(t),n=s.getElements();let i=n.nodes,r=n.edges;return e==="visible"?(i=i.filter((o=>o.isVisible())),r=r.filter((o=>o.isVisible()))):e==="raw"&&(i=i.filter((o=>!o.isVirtual())),r=r.filter((o=>!o.isVirtual()))),{nodes:i,edges:r}}_onClassEvent(t,e,s,n){const i=Ml(t,s,n);this._modules.events.on(i,e)}onNodeClassAdded(t,e){this._onClassEvent(t,e,!0,!0)}onNodeClassRemoved(t,e){this._onClassEvent(t,e,!0,!1)}onEdgeClassAdded(t,e){this._onClassEvent(t,e,!1,!0)}onEdgeClassRemoved(t,e){this._onClassEvent(t,e,!1,!1)}};function Ml(t,e,s){return`${e?"node":"edge"}Class${s?"Added":"Removed"}_${t}`}function X4(t,e){for(let s=0;s<t.length;++s)if(t[s].name===e)return s;return-1}var Z4=iT(rT()),Fk=()=>({x:0,y:0,x1:0,y1:0,x2:0,y2:0});function A1(t,e,s,{cells:n=!0,boxes:i=!0,query:r=!0}={}){const o=e.keys().map((l=>e.keyToBBox(Number(l)))),a=e.getBoxes();if(n&&(t.beginPath(),t.lineWidth=1,t.strokeStyle="#707070",o.forEach((l=>{t.rect(l[0],l[1],l[2]-l[0],l[3]-l[1])})),t.stroke()),i&&(t.beginPath(),t.lineWidth=1,t.strokeStyle="#ff7070",a.forEach((l=>{t.rect(l[0],l[1],l[2]-l[0],l[3]-l[1])})),t.closePath(),t.stroke()),r&&s){const l=s;t.beginPath(),t.lineWidth=2,t.strokeStyle="#3030ff",t.rect(l[0],l[1],l[2]-l[0],l[3]-l[1]),t.closePath(),t.stroke()}}function K4(t){const[e,s,n]=t.getNodeAttributes(["x","y","radius"]),[i,r,o]=t.getEdgeAttributes(["source","target","curvature"]),a=Fk(),l=d0();return u=>{if(u<0){u=-u;const h=i.get(u),g=r.get(u),f=o.get(u),p=e.get(h),y=s.get(h),_=e.get(g),x=s.get(g);h===g?(sp(p,y,f,n.get(h),0,a),rp(p,y,a.x1,a.y1,a.x2,a.y2,_,x,l)):f===0?(l.minX=Math.min(p,_),l.minY=Math.min(y,x),l.maxX=Math.max(p,_),l.maxY=Math.max(y,x)):(Ya(p,y,_,x,f,a),c0(p,y,a.x,a.y,_,x,l))}else{const h=e.get(u),g=s.get(u),f=n.get(u);l.minX=h-f,l.minY=g-f,l.maxX=h+f,l.maxY=g+f}return[l.minX,l.minY,l.maxX,l.maxY]}}var Q4=["x","y","radius"],J4=["width","curvature"],t5=.5,w1=1,T1=128,C1=4,L1=16,e5=1e4,s5=class extends Ke{constructor(){super(...arguments),this._minCellSize=L1,this._clear=()=>{this._index.clear(),this._elementsToUpdate.clear()},this._onGraphUpdate=t=>{if(t.nodes&&(!t.nodeAttributes||t.nodeAttributes.some((e=>Q4.includes(e))))){const e=t.nodes.fastGetAdjacentElements().edges;this._elementsToUpdate.addElements(t.nodes),this._elementsToUpdate.addElements(e)}t.edges&&(t.edgeAttributes&&!t.edgeAttributes.some((e=>J4.includes(e)))||this._elementsToUpdate.addElements(t.edges))}}onMounted(){this._index=new Z4.HGrid(this._getIntersector(),K4(this._modules.graph),this._minCellSize,1e6),this._elementsToUpdate=new kh(this._modules.graph),this._removedNodes=this._modules.graph.getNodeAttribute("removed"),this._removedEdges=this._modules.graph.getEdgeAttribute("removed"),this._excludedNodes=this._modules.graph.getNodeAttribute("excluded"),this._excludedEdges=this._modules.graph.getEdgeAttribute("excluded"),this._queryResult={edges:[],nodes:[]},this._queryBounds=[0,0,0,0],this._modules.events.on(["addNodes","addEdges","removeNodes","removeEdges","updateAttributes"],this._onGraphUpdate).on("excludedStateChange",(({elements:t})=>{this._elementsToUpdate.addElements(t)})).on("clearGraph",this._clear)}_getIntersector(){const t=this._modules.graph,[e,s,n]=t.getNodeAttributes(["x","y","radius"]),[i,r,o,a]=t.getEdgeAttributes(["source","target","width","curvature"]),l=Fk(),u=this._modules.camera.getAngle(),h=Math.cos(u),g=Math.sin(u);return(f,p,y,_,x)=>{const{bentEnable:v,bentVertical:b}=this._modules.graphics.getGraphicsEngine().getBentEdges();if(f<0){f=-f;const S=i.get(f),A=r.get(f),w=a.get(f),L=o.get(f)/2,I=e.get(S),F=s.get(S),O=e.get(A),V=s.get(A);return v?(np(I*h-F*g,F*h+I*g,O*h-V*g,V*h+O*g,w,v,b,l),Iy(I,F,l.x1*h+l.y1*g,l.y1*h-l.x1*g,l.x2*h+l.y2*g,l.y2*h-l.x2*g,O,V,p-L,y-L,_+L,x+L)):S===A?(sp(I,F,w,n.get(S),0,l),Iy(I,F,l.x1,l.y1,l.x2,l.y2,O,V,p-L,y-L,_+L,x+L)):w===0?g0(I,F,O,V,p-L,y-L,_+L,x+L):(Ya(I,F,O,V,w,l),wC(I,F,l.x,l.y,O,V,p-L,y-L,_+L,x+L))}return Wx(e.get(f),s.get(f),n.get(f),p,y,_,x)}}reindex(){this._modules.graphics.forceAttributesComputation(),this._index.clear(),this._elementsToUpdate.clear(),this._updateItems(this._modules.graph.getNodes("all")._indexes,this._modules.graph.getEdges("all")._indexes)}getSize(){return this._index.size}_updateIndex(){if(this._elementsToUpdate.isEmpty())return;const{nodes:t,edges:e}=this._elementsToUpdate.getElements(),s=t._indexes.length,n=this._modules.graph.getNodes("all").size;let i=!1;if(this._index.averageCellOccupancy<w1)for(;this._index.averageCellOccupancy<w1&&this._minCellSize<e5;)this._minCellSize=this._minCellSize*C1,this._index.setMinCellSize(this._minCellSize),this.reindex(),i=!0;if(!i&&this._index.averageCellOccupancy>T1)for(;this._index.averageCellOccupancy>T1&&this._minCellSize>L1;)this._minCellSize=this._minCellSize/C1,this._index.setMinCellSize(this._minCellSize),this.reindex(),i=!0;!i&&s/n>t5&&this.reindex(),this._updateItems(t._indexes,e._indexes),this._elementsToUpdate.clear()}_updateItems(t,e){const s=this._index,n=this._removedNodes,i=this._removedEdges,r=this._excludedNodes,o=this._excludedEdges,a=[],l=[];if(n&&r)for(let u=0;u<t.length;u++){const h=t[u];n.get(h)!==0||r.get(h)!==0?a.push(h):(s.has(h)&&a.push(h),l.push(h))}if(i&&o)for(let u=0;u<e.length;u++){const h=-e[u];i.get(-h)!==0||o.get(-h)!==0?a.push(h):(s.has(h)&&a.push(h),l.push(h))}for(const u of a)s.remove(u);for(const u of l)s.insert(u)}getNodesInScreenByDistance(t){const{x:e,y:s}=t.getPositionOnScreen();return this._modules.graph.getNodes().filter((n=>n.isInScreen()&&n!==t)).sort(((n,i)=>{const r=n.getPositionOnScreen(),o=i.getPositionOnScreen();return _n(r.x,r.y,e,s)-_n(o.x,o.y,e,s)}))}getNearestNodesForNode(t,e=240,s){const{x:n,y:i}=t.getPosition();return this.getNearestNodes(n,i,e,s,t)}getNearestNodes(t,e,s,n,i){if(this._updateIndex(),n){const r=this._modules.camera.screenToGraphVector({x:s,y:s});s=_n(0,0,r.x,r.y)}return this._getNearestNodes(t,e,s,i)}_getNearestNodes(t,e,s,n){const i=[],r=s*s,o=n?n._index:0,a=this._modules.graph.getNodes()._indexes,[l,u]=this._modules.graph.getNodeAttributes(["x","y"]);for(let h=0,g=a.length;h<g;h++){const f=a[h];if(f===o)continue;const p=t-l.get(f),y=e-u.get(f);p*p+y*y<=r&&i.push(f)}return this._modules.graph.nodeList(new Uint32Array(i))}queryRaw(t,e,s,n){this._updateIndex();const i=this._queryBounds;i[0]=t,i[1]=e,i[2]=s,i[3]=n;const r=this._index.query(t,e,s,n),{nodes:o,edges:a}=this._queryResult;o.length=a.length=0;for(let l=0;l<r.length;l++){const u=r[l];u<0?a.push(-u):o.push(u)}return this._queryResult}queryRawProjected(t,e,s,n){const i=this._queryBounds;i[0]=t,i[1]=e,i[2]=s,i[3]=n,this._modules.camera.projectBounds(i);const r=this.queryRaw(i[0],i[1],i[2],i[3]);return this._modules.labels.query(i[0],i[1],i[2],i[3],r),r}query(t,e,s,n){const i=this._modules.graph,{nodes:r,edges:o}=this.queryRaw(t,e,s,n);return{nodes:i.nodeList(new Uint32Array(r.slice())),edges:i.edgeList(new Uint32Array(o.slice()))}}queryProjected(t,e,s,n){const i=this._modules.graph,{nodes:r,edges:o}=this.queryRawProjected(t,e,s,n);return{nodes:i.nodeList(new Uint32Array(r)),edges:i.edgeList(new Uint32Array(o))}}getNodesByBoundingBox(t,e,s,n,i){if(this._updateIndex(),i){let g;g=this._modules.camera.screenToGraphVector({x:t,y:e}),t=g.x,e=g.y,g=this._modules.camera.screenToGraphVector({x:s,y:n}),s=g.x,n=g.y}const r=this._modules.graph,o=r.getNodes()._indexes,a=[],l=r.getNodeAttribute("excluded"),[u,h]=r.getNodeAttributes(["x","y"]);for(let g=0,f=o.length;g<f;g++){const p=o[g];if(l&&l.get(p))continue;const y=u&&u.get(p),_=h&&h.get(p);y>=t&&y<=s&&_>=e&&_<=n&&a.push(p)}return r.nodeList(new Uint32Array(a))}toggleDebug(t){t?(this._layer=this._modules.layers.addCanvasLayer((e=>{A1(e,this._index,this._queryBounds)}),{isStatic:!1,noClear:!1}),this._layer.moveToTop()):this._layer&&(this._layer.destroy(),this._layer=null)}renderDebug(t){if(!this._layer)return this.toggleDebug(!0);this._layer.refresh((e=>{A1(e,this._index,this._queryBounds,t)}))}},Pk={};function up(t,e,s,n,i=0,r=Math.sin(i),o=Math.cos(i),a=[0,0,0,0]){const l=s/2,u=n/2,h=t+l,g=e+u;if(i===0)return a[0]=t,a[1]=e,a[2]=t+s,a[3]=e+n,a;let f,p,y,_,x,v,b,S;return y=-l,_=-u,f=h+y*o-_*r,p=g+y*r+_*o,x=b=f,v=S=p,y=-l,_=u,f=h+y*o-_*r,p=g+y*r+_*o,f<x?x=f:f>b&&(b=f),p<v?v=p:p>S&&(S=p),y=l,_=u,f=h+y*o-_*r,p=g+y*r+_*o,f<x?x=f:f>b&&(b=f),p<v?v=p:p>S&&(S=p),y=l,_=-u,f=h+y*o-_*r,p=g+y*r+_*o,f<x?x=f:f>b&&(b=f),p<v?v=p:p>S&&(S=p),a[0]=x,a[1]=v,a[2]=b,a[3]=S,a}function Nh(t,e,s,n,i=0){const r=s/2,o=n/2,a=t+r,l=e+o;if(i===0)return[{x:t,y:e},{x:t+s,y:e},{x:t+s,y:e+n},{x:t,y:e+n}];const u=Math.sin(i),h=Math.cos(i);let g,f,p,y;p=-r,y=-o,g=a+p*h-y*u,f=l+p*u+y*h;const _={x:g,y:f};p=-r,y=o,g=a+p*h-y*u,f=l+p*u+y*h;const x={x:g,y:f};p=r,y=o,g=a+p*h-y*u,f=l+p*u+y*h;const v={x:g,y:f};return p=r,y=-o,g=a+p*h-y*u,f=l+p*u+y*h,[_,x,v,{x:g,y:f}]}function Zy(t,e=0,s=1,n=E2.slice()){const i=s*Math.sin(e),r=s*Math.cos(e);return n[0]=t[0]+i,n[1]=t[1]+r,n[2]=t[2]+i,n[3]=t[3]+r,n}function n5(t,e){return A2(t,e)}function i5(t,e){return zk(t[0],t[1],t[2],t[3],e[0],e[1],e[2],e[3])}function r5(t,e,s,n,i,r,o,a){return t>i&&t<o&&e>r&&e<a||s>i&&s<o&&n>r&&n<a}function zk(t,e,s,n,i,r,o,a){return n>=r&&e<=a&&s>=i&&t<=o}mh(Pk,{angle:()=>oO,circleCircleIntersection:()=>qx,circleContainsCircle:()=>YP,circleContainsPoint:()=>qP,circleIntersectsBox:()=>Wx,circleLineIntersection:()=>w2,circleSortCompare:()=>Yx,computeCentroid:()=>qU,cubicBezierAABB:()=>Iy,defaultAABB:()=>E2,degreesToRadians:()=>$P,distToSegmentSquared:()=>f0,distance:()=>_n,distancePointSegment:()=>NC,extendBounds:()=>A2,getAABB:()=>up,getBentEdgesControlPoints:()=>np,getBezierCurveBoundingBox:()=>rp,getClosestPointOnLine:()=>lO,getClosestPointOnSegment:()=>MC,getNormalOnEdge:()=>sO,getNormalOnQuadraticCurve:()=>TC,getOBBPoints:()=>Nh,getPointOnBezierCurve:()=>eh,getPointOnEdge:()=>eO,getPointOnQuadraticCurve:()=>ip,getQuadraticBezierCurveLength:()=>iO,getQuadraticCurveBoundingBox:()=>c0,getQuadraticCurveControlPoint:()=>Ya,getSelfLoopControlPoints:()=>sp,getTangentOnEdge:()=>nO,getTangentOnQuadraticCurve:()=>h0,intersects:()=>r5,isPointInLine:()=>LC,isPointInPolygon:()=>nh,isPointOnBezierCurve:()=>Ry,isPointOnQuadraticCurve:()=>CC,lineAABB:()=>g0,lineAngle:()=>cu,lineIntersection:()=>aO,lineLine:()=>Xl,minDisk:()=>Eh,move:()=>HP,moveAABB:()=>Zy,normalize:()=>S2,overlaps:()=>zk,overlapsAABB:()=>i5,padBounds:()=>n5,polygonsIntersect:()=>rL,quadBezierAABB:()=>wC,radiansToDegrees:()=>py,rotate:()=>hf,segmentIntersection:()=>xd,segmentRectangleIntersection:()=>kC,squaredDistance:()=>Og,twoSegmentsIntersect:()=>rO});var pg=40;function Dk(t,e){const s=t.getAttribute("curvature"),n=t.getSource(),i=t.getTarget(),r=n.getPositionOnScreen();if(n===i){const _=(s+n.getAttribute("radius"))*yf*e,x=r.x,v=r.y,b=x-_,S=v,A=x,w=v+_;return[r,...[.2,.4,.6,.8].map((L=>eh(L,x,v,x,v,b,S,A,w))),r]}const o=i.getPositionOnScreen();if(s===0)return[r,o];const a=o.x-r.x,l=o.y-r.y,u=Math.sqrt(a*a+l*l),h=(r.x+o.x)/2,g=(r.y+o.y)/2,f=s*(u/Kf)*2,p=h+l/u*f,y=g+-a/u*f;return[r,...[.25,.5,.75].map((_=>ip(_,r.x,r.y,o.x,o.y,p,y))),o]}function o5(t,e,s){const n=t.getSource(),i=t.getTarget(),r=n.getPositionOnScreen(),o=i.getPositionOnScreen();if(nh(r.x,r.y,e)||nh(o.x,o.y,e))return!0;const a=Dk(t,s);for(let l=0;l<a.length-1;++l){const u=a[l],h=a[l+1];for(let g=0;g<e.length-1;++g){const f=e[g],p=e[g+1];if(Xl(u.x,u.y,h.x,h.y,f.x,f.y,p.x,p.y))return!0}}return!1}function a5(t,e,s){const n=t.getPositionOnScreen(),i=Number(t.getAttribute("radius"))*s;return Ok(n.x,n.y,i,e)}function Ok(t,e,s,n){const i=t-s,r=e-s,o=e+s;return t+s>=n.minX&&i<=n.maxX&&o>=n.minY&&r<=n.maxY}function l5(t,e,s){const n=Dk(t,s);for(let i=0;i<n.length-1;++i){const r=n[i],o=n[i+1];if(g0(r.x,r.y,o.x,o.y,e.minX,e.minY,e.maxX,e.maxY))return!0}return!1}function k1(t,e,s,n){typeof s=="number"&&(s={left:s,right:s,top:s,bottom:s});const i=s.left===void 0?pg:s.left,r=s.right===void 0?pg:s.right,o=s.top===void 0?pg:s.top,a=s.bottom===void 0?pg:s.bottom,l=i+r,u=o+a,h=t.width===0?t.maxFixedSize:t.width,g=t.height===0?t.maxFixedSize:t.height,f=L4([(e.width-l)/(h+t.maxScaledSize),(e.height-u)/(g+t.maxScaledSize),(e.width-l-t.maxFixedSize)/h,(e.height-u-t.maxFixedSize)/g,n/t.maxScaledSize||NaN]);return{x:t.cx+(r-i)/(2*f),y:t.cy+(a-o)/(2*f),zoom:f}}var u5="cubicOut",N1=200,d5=class extends Ke{constructor(){super(...arguments),this._isLocating=!1,this._cacheValid=!0,this._cachedGraphBoundingBox=new ri,this._onLocateStart=()=>{this._isLocating=!0},this._onLocated=()=>{this._isLocating=!1,this._modules.events.fire("locate")},this._invalidCache=()=>{this._cacheValid=!1}}onMounted(){this._modules.events.register(["locate"]),this._modules.events.on(["addNodes","removeNodes","addEdges","removeEdges","excludedStateChange","clearGraph","updateAttributes"],this._invalidCache)}onReady(){this.locateGraph({},!0)}locateGraph(t,e=!1){return this._onLocateStart(),e?this._locateGraph(t):this._modules.transformations.whenApplied().then((()=>this._locateGraph(t)))}_locateGraph(t){return this._locateBoundingBox(this.getGraphBoundingBox(),t).then(this._onLocated)}locateElements(t,e){return this._modules.transformations.whenApplied().then((()=>this._locateBoundingBox(this.getBoundingBox(t),e))).then(this._onLocated)}locateRawGraph(t,e){return this._onLocateStart(),this._locateBoundingBox(this.getRawGraphBoundingBox(t),e).then(this._onLocated)}isLocating(){return this._isLocating}getGraphBoundingBox(t=!1){if(t){const e=this.getBoundingBox(this._ogma.getNodes(),!0,t),s=this.getBoundingBox(this._ogma.getEdges(),!1,t);return e.extend(s)}return this._cacheValid||this._updateCache(),this._cachedGraphBoundingBox.clone()}forceInvalidCache(){this._invalidCache()}_updateCache(){this._cacheValid=!0,this._cachedGraphBoundingBox=this.getBoundingBox(this._modules.graph.getNodes()).extend(this.getBoundingBox(this._modules.graph.getEdges()))}getBoundingBox(t,e=!1,s=!1,n){let i;if(i=t.isNode?this._getNodesBoundingBox(t.toList(),e):this._getEdgesBoundingBox(t.toList(),n),s){const r=this._ogma.modules.labels.getTextsBoundingBox(t.isNode?t.toList():null,t.isNode?null:t.toList());i=i.extend(r)}return i}_getNodesBoundingBox(t,e=!1){this._modules.graphics.forceAttributesComputation();const s=this._modules.graphics.getNodeAttributes(),n=[],i=[],r=[],o=[];for(let a=0;a<t.size;++a){const l=t._indexes[a];if(s.excluded.get(l)===0){const u=s.x.get(l),h=s.y.get(l),g=s.radius.get(l),f=2*g;s.scalingMethod.get(l)==="scaled"?r.push(f):o.push(f),e?(n.push(u-g,u+g),i.push(h-g,h+g)):(n.push(u),i.push(h))}}return new ri({xValues:n,yValues:i,scaledSizeValues:r,fixedSizeValues:o})}_getEdgesBoundingBox(t,e=!1){return this._getEdgesBoundingBoxInternal(t._indexes,e)}_getEdgesBoundingBoxInternal(t,e=!1,s,n){this._modules.graphics.forceAttributesComputation();const i=this._modules.graphics.getEdgeAttributes(),r=this._modules.graphics.getNodeAttributes(),o={x1:0,y1:0,x2:0,y2:0},a={x:0,y:0},l={minX:0,minY:0,maxX:0,maxY:0},u=[],h=[],g=[],f=[],p=s||r.x,y=n||r.y;for(let _=0;_<t.length;++_){const x=t[_],v=i.source.get(x),b=i.target.get(x),S=i.curvature.get(x),A=p.get(v),w=y.get(v),L=r.scalingMethod.get(v)==="scaled",I=2*r.radius.get(v),F=p.get(b),O=y.get(b),V=r.scalingMethod.get(b)==="scaled",j=2*r.radius.get(b);L?g.push(I):f.push(I),V?g.push(j):f.push(j),e||S===0?(u.push(A,F),h.push(w,O)):v===b?(p0(A,w,S,I/2,0,o),rp(A,w,o.x1,o.y1,o.x2,o.y2,F,O,l),u.push(l.minX,l.maxX),h.push(l.minY,l.maxY)):(op(A,w,F,O,S,a),c0(A,w,a.x,a.y,F,O,l),u.push(l.minX,l.maxX),h.push(l.minY,l.maxY))}return new ri({xValues:u,yValues:h,scaledSizeValues:g,fixedSizeValues:f})}getRawGraphBoundingBox(t){const e=t.nodes.length,s=new Array(e),n=new Array(e),i=new Array(e);for(let r=0;r<e;r++){const o=t.nodes[r].attributes||{};s[r]=o.x||0,n[r]=o.y||0,i[r]=o.radius||5}return new ri({xValues:s,yValues:n,scaledSizeValues:i})}_locateBoundingBox(t,e={}){if(isNaN(t.cx))return Promise.resolve();const{padding:s={},easing:n=u5,duration:i=0,maxNodeSizeOnScreen:r=N1,ignoreZoomLimits:o=!1}=e,a=k1(t,this._modules.dom.getDimensions(),s,r),l=a.x,u=a.y,h=a.zoom,g=h/this._modules.camera.getZoom();return this._moveCamera(l,u,h,i,n,g,o)}_moveCamera(t,e,s,n,i,r,o){const a={duration:n,easing:i,ignoreZoomLimits:o},l=this._modules.camera.setCenter({x:t,y:e},a);return r>1.01||r<.99?this._modules.camera.setZoom(s,a):l}computeConfigForBounds(t,e={}){const{padding:s={},maxNodeSizeOnScreen:n=N1}=e;return k1(t,this._modules.dom.getDimensions(),s,n)}layoutDataBoundingBox({x:t,y:e,indexes:s}){const n=this._modules.graphics.getNodeAttributes(),i=[],r=[],o=[],a=[],l=new Map,u=new Map;for(let f=0;f<s.length;++f){const p=s[f],y=t[f],_=e[f];l.set(p,y),u.set(p,_);const x=2*n.radius.get(p),v=n.scalingMethod.get(p)==="scaled";i.push(y),r.push(_),v?o.push(x):a.push(x)}const h=this._modules.graph.topology.getAdjacentElements(!1,s,{bothExtremities:!0}),g=this._getEdgesBoundingBoxInternal(h,!1,l,u);return new ri({xValues:i,yValues:r,scaledSizeValues:o,fixedSizeValues:a}).extend(g)}isEdgeInPolygon(t,e){return o5(t,e,this._modules.camera.getZoom())}isElementInView(t,{margin:e=0}={}){const{width:s,height:n}=this._modules.camera.getSize(),i={minX:-e,minY:-e,maxX:s+e,maxY:n+e};return t.isNode?this.isNodeInRectangle(t,i):this.isEdgeInRectangle(t,i)}isNodeInRectangle(t,e){if(this._modules.geo.isEnabled()){const s=this._modules.geo.getContainerCoord(t);return Ok(s.x,s.y,Number(t.getAttribute("radius")),e)}return a5(t,e,this._modules.camera.getZoom())}isNodeInPolygon(t,e){const s=t.getPositionOnScreen();return nh(s.x,s.y,e)}isEdgeInRectangle(t,e){return l5(t,e,this._modules.camera.getZoom())}},h5=Yo&&typeof navigator<"u"&&"msLaunchUri"in navigator&&oo&&!("documentMode"in document);function c5(t){return h5?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/vi():t.deltaY&&t.deltaMode===1?20*-t.deltaY:t.deltaY&&t.deltaMode===2?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}var g5=6,f5=class extends Ke{constructor(){super(...arguments),this._px=0,this._py=0,this._pressX=0,this._pressY=0,this._left=!1,this._middle=!1,this._right=!1,this._clickCounter={left:0,middle:0,right:0},this._buttons={left:!1,middle:!1,right:!1},this._skipNextMove=!1,this._onMouseWheel=t=>{this._isEnabled()&&this._isWheelEnabled()&&(!this._disableWheelUntilMouseDown()||this._modules.dom.hasFocus())&&(t.preventDefault(),t.stopPropagation(),this._applyMouseWheelZoom(t))},this._onMouseMove=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=e-this._px,i=s-this._py;n===0&&i===0||(this._skipNextMove?this._skipNextMove=!1:_n(e,s,this._pressX,this._pressY)>=g5&&(this._resetClickCounter(),this._modules.events.fire("mousemoveInternal",{x:e,y:s,dx:n,dy:i,domEvent:this._evt})))},this._onDocumentMouseMove=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=this._bounds,i=e-this._px,r=s-this._py;(e<0||e>n.width||s<0||s>n.height)&&this._modules.events.fire("documentMouseMove",{x:e,y:s,dx:i,dy:r,domEvent:this._evt})},this._onMouseUp=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=this._button,i=this._evt;this._buttons[n]=!1,this._clickCounter[this._button]===1?this._modules.events.fire("clickInternal",{button:n,x:e,y:s,domEvent:i}):this._clickCounter[n]>1&&(this._modules.events.fire("doubleclickInternal",{button:n,x:e,y:s,domEvent:i}),this._resetClickCounter(n)),this._modules.events.fire("mouseupInternal",{button:n,x:e,y:s,domEvent:i})},this._onDocumentMouseup=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=this._button;this._buttons[n]=!1;const i=this._modules.dom;this._modules.events.fire("documentMouseUp",{button:n,x:e,y:s,domEvent:this._evt}),i.removeDirectWindowEventListener("mousemove",this._onDocumentMouseMove),i.removeDirectWindowEventListener("mouseup",this._onDocumentMouseup)},this._onMouseDown=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=this._button,i=this._modules.dom;this._skipNextMove=!0,this._pressX=e,this._pressY=s,this._lastMouseDownTarget=t.target,i.focus(),this._buttons[n]=!0,this._clickCounter[n]+=1;const r=n;this._dbclickTimer=i.setTimeout((()=>{this._resetClickCounter(r,0)}),this._getDoubleClickTimer()),this._modules.events.fire("mousedownInternal",{button:n,x:e,y:s,domEvent:this._evt}),i.addDirectWindowEventListener("mousemove",this._onDocumentMouseMove),i.addDirectWindowEventListener("mouseup",this._onDocumentMouseup)},this._onDrop=t=>{if(!this._isEnabled()||!this._setXY(t))return;t.preventDefault();const{x:e,y:s}=this._modules.camera.screenToGraphCoordinates(this._modules.position);this._modules.events.fire("drop",{domEvent:this._evt,x:e,y:s})}}onMounted(){this._domElt=this._modules.graphics.getDomElement(),this._modules.settings.register("mouse.enabled",!0),this._modules.settings.register("mouse.wheelEnabled",!0),this._modules.settings.register("mouse.disableWheelUntilMouseDown",!1),this._modules.settings.register("mouse.doubleClickTimer",500),this._modules.events.register(["mousedownInternal","mouseupInternal","mousemoveInternal","mousewheelInternal","clickInternal","doubleclickInternal","mouseoverInternal","mouseoutInternal","documentMouseUp","documentMouseMove","drop"]),this._modules.dom.afterNextFrame().then((()=>this._initializeListeners()))}get x(){return this._modules.position.x}get y(){return this._modules.position.y}get left(){return this._left}get right(){return this._right}get middle(){return this._middle}_isEnabled(){return this._modules.settings.get("mouse.enabled")}_isWheelEnabled(){return this._modules.settings.get("mouse.wheelEnabled")}_disableWheelUntilMouseDown(){return this._modules.settings.get("mouse.disableWheelUntilMouseDown")}_getDoubleClickTimer(){return this._modules.settings.get("mouse.doubleClickTimer")}_resetClickCounter(t,e=0){t?this._clickCounter[t]=e:(this._clickCounter.left=e,this._clickCounter.middle=e,this._clickCounter.right=e),this._modules.dom.clearTimeout(this._dbclickTimer),this._lastMouseDownTarget=null}_setXY(t){const e=this._domElt.getBoundingClientRect();return this._bounds=e,!!e&&(this._evt=t,this._button=Bx[t.button],this._px=this._modules.position.x,this._py=this._modules.position.y,this._modules.position.x=t.clientX-e.left,this._modules.position.y=t.clientY-e.top,this._left=this._buttons.left,this._right=this._buttons.right,this._middle=this._buttons.middle,!0)}_applyMouseWheelZoom(t){this._setXY(t)&&this._modules.events.fire("mousewheelInternal",{delta:c5(t),dx:t.deltaX,dy:t.deltaY,x:this._modules.position.x,y:this._modules.position.y,domEvent:this._evt})}_initializeListeners(){const t=this._domElt,e=this._modules.dom;jf&&this._modules.dom.addElementEventListener(document,"contextmenu",(n=>{this._lastMouseDownTarget&&n.target!==this._lastMouseDownTarget&&n.preventDefault()})),e.addElementEventListener(t,"contextmenu",(n=>{this._setXY(n),this._modules.dom.hasFocus()&&this._modules.settings.get("mouse.enabled")&&n.preventDefault()}),!1);const s="onwheel"in t?"wheel":t.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll";e.addElementEventListener(t,s,this._onMouseWheel,{passive:!1}),e.addElementEventListener(t,"mousemove",this._onMouseMove),e.addElementEventListener(t,"mouseleave",(n=>{if(!this._isEnabled())return;this._modules.dom.blur();const i=t.getBoundingClientRect();n.clientX>=i.left+1&&n.clientX<=i.right-1&&n.clientY>=i.top+1&&n.clientY<=i.bottom-1||this._modules.events.fire("mouseout",{domEvent:this._evt})})),e.addElementEventListener(t,"mousedown",this._onMouseDown),e.addElementEventListener(t,"mouseup",this._onMouseUp),e.addElementEventListener(t,"dragover",(n=>{n.preventDefault()})),e.addElementEventListener(t,"drop",this._onDrop)}},p5={doubleTapTimer:500},m5=class extends Ke{constructor(){super(...arguments),this._pressed=!1,this._addEvent=(t,e,s,n)=>{this._modules.dom.addElementEventListener(t,e,s,n)},this._addWinEvent=(t,e,s,n)=>{this._modules.dom.addDirectWindowEventListener(e,s,n)},this._removeWinEvent=(t,e,s)=>{this._modules.dom.removeDirectWindowEventListener(e,s)}}onMounted(){this._domElt=this._modules.graphics.getDomElement(),this._modules.settings.register("touch.enabled",!0),this._modules.events.register(["touchDown","touchUp","touchTap","touchDoubleTap","touchMove","touchStartGesture","touchProgressGesture","touchEndGesture","documentTouchMove","documentTouchUp"]),this._modules.dom.afterNextFrame().then((()=>{this._initialize(this)}))}get x(){return this._modules.position.x}get y(){return this._modules.position.y}get pressed(){return this._pressed}_listen(t,e,s){if(z2){if(e==="touchstart")return Ez(this._addEvent,t,s);if(e==="touchmove")return Az(this._addWinEvent,t,s);if(e==="touchend")return wz(this._addWinEvent,t,s);if(e==="touchcancel")return Sz(this._addWinEvent,t,s)}return this._modules.dom.addElementEventListener(t,e,s)}_initialize(t){let e=0,s=0,n=0,i=0,r=!1,o="left",a=0,l=!1,u=!1,h=0,g=1,f=null,p=null;const y=()=>{this._modules.position.x=e,this._modules.position.y=s,this._pressed=r},_=(w,L)=>{const I=this._domElt.getBoundingClientRect();if(!I||w.touches==null)return null;const[F,O]=w.touches,V=F.clientX-I.left,j=F.clientY-I.top,Z=O.clientX-I.left,at=O.clientY-I.top,pt=(V+Z)/2,K=(j+at)/2,ut=pt-e,ht=K-s,nt=_n(V,j,Z,at),ot=nt/g,Nt=cu(V,j,Z,at),Q={dx:ut,dy:ht,rotation:Nt-h,scale:ot};return((Et,Xt,Ht,Zt)=>{g=Et,h=Xt,e=Ht,s=Zt,y()})(nt,Nt,pt,K),Q},x=w=>{if(w.touches&&w.touches.length===2&&u){const L=_(w);if(L){const{dx:I,dy:F,rotation:O,scale:V}=L;this._modules.events.fire("touchProgressGesture",{dx:I,dy:F,rotation:O,scale:V,x:e,y:s,domEvent:f,button:o})}}},v=w=>{if(o=Bx[w.button],!w.touches)return!1;if(w.touches.length!==1)return r=!1,w.touches.length>1&&this._modules.events.fire("touchUp",{x:e,y:s,domEvent:f,button:o}),!1;const L=this._domElt.getBoundingClientRect();return L&&(n=e,i=s,e=w.touches[0].clientX-L.left|0,s=w.touches[0].clientY-L.top|0,r=!0,f=w,y()),!0},b=()=>{a=0,this._modules.dom.clearTimeout(p)},S=w=>{if(w.preventDefault(),!w.touches)return;if(w.touches.length!==2&&u&&(u=!1,this._modules.events.fire("touchEndGesture",{domEvent:f})),v(w),w.touches.length===0){const I={x:e,y:s,domEvent:f,button:o};a===1&&this._modules.events.fire("touchTap",I),a>1&&(this._modules.events.fire("touchDoubleTap",I),b()),this._modules.events.fire("touchUp",I)}const L=ao().documentElement;HE(this._removeWinEvent,L,"touchmove",this._onMove),HE(this._removeWinEvent,L,"touchend",this._onEnd)},A=w=>{x(w),l?l=!1:(b(),v(w)&&this._modules.events.fire("touchMove",{x:e,y:s,dx:e-n,dy:s-i,domEvent:f,button:o}))};this._listen(this._domElt,"touchstart",(w=>{if(!w.touches)return;w.touches.length!==2||u||(g=1,_(w)&&(u=!0,this._modules.events.fire("touchStartGesture",{domEvent:f}))),v(w)&&(this._modules.dom.focus(),this._modules.events.fire("touchDown",{x:e,y:s,domEvent:f,button:o}),a+=1,p=this._modules.dom.setTimeout(b,p5.doubleTapTimer),l=!0);const L=ao().documentElement;this._onMove=this._listen(L,"touchmove",A),this._onEnd=this._listen(L,"touchend",S)}))}},_5=class extends Ke{constructor(t){super(t),this.getSubElements=e=>this.api.getSubElements(e),this.getSubNodes=e=>this.api.getSubNodes(e),this.getSubEdges=e=>this.api.getSubEdges(e),this.getXYR=e=>this.api.getXYR(e),this.onGroupsUpdated=e=>this.api.onGroupsUpdated(e)}onMounted(){this._modules.classes.createClass({name:j2,isBuiltin:!0,nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0}}),this._modules.classes.createClass({name:H2,isBuiltin:!0,nodeAttributes:{opacity:0},edgeAttributes:{opacity:0}}),this._modules.settings.register("transformations.updateOnDataChange",!0),this._modules.events.register(["transformationEnabled","transformationDisabled","transformationSetIndex","transformationDestroyed","transformationRefresh"])}onReady(t){this.api=new dY(this._ogma)}destroy(){}isElementVirtual(t){return this.api.isVirtual(t._index,t.isNode)}getElementTransformation(t){return this.api.getTransformation(t._index,t.isNode)}getMetaElements(t){return t.map((e=>this.getMetaElement(e)))}getMetaElement(t){var s;const e=t.isNode?this.api.getMetaNode(t):this.api.getMetaEdge(t);return e&&((s=this.api.getTransformation(e._index,e.isNode))!=null&&s.isEnabled())?e:null}getMetaEdge(t){return this.getMetaElement(t)}getMetaNode(t){return this.getMetaElement(t)}getMetaNodes(t){return this.getMetaElements(t)}getMetaEdges(t){return this.getMetaElements(t)}getNodeFilters(){return this.api.getList().filter((t=>t.getName()===Zn.NodeFilter))}getEdgeFilters(){return this.api.getList().filter((t=>t.getName()===Zn.EdgeFilter))}whenApplied(){return this.api.afterNextUpdate()}afterNextUpdate(){return this.api.afterNextUpdate()}isRefreshing(){return this.api.isRefreshing()}triggerGroupUpdated(t){const e=t._indexes,s=this._ogma.modules.transformations.api.groupController.layoutController.shouldRelayout;for(let n=0;n<t.size;n++)s.add(e[n])}},M1={layer:$2,outline:!0,outerStroke:{color:Dy,width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:yL,minVisibleSize:0}},y5={layer:$2,color:Dy,text:{backgroundColor:yL,minVisibleSize:0},stroke:{color:Dy,width:0}},x5=class extends Ke{onMounted(){this.shouldTriggerEvents=!0,this._modules.events.register(["nodesSelected","nodesUnselected","edgesSelected","edgesUnselected"]),this._selectionExtremityHighlightedClass=this._modules.classes.createClass({name:vy,isBuiltin:!0,nodeAttributes:M1}),this._selectedClass=this._modules.classes.createClass({name:Gs,isBuiltin:!0,nodeAttributes:M1,edgeAttributes:y5}),this._modules.events.on(`nodeClassAdded_${Gs}`,(e=>{this.shouldTriggerEvents&&this._modules.events.fire("nodesSelected",e)})),this._modules.events.on(`edgeClassAdded_${Gs}`,(e=>{this.shouldTriggerEvents&&this._modules.events.fire("edgesSelected",e)})),this._modules.events.on(`nodeClassRemoved_${Gs}`,(e=>{this.shouldTriggerEvents&&this._modules.events.fire("nodesUnselected",e)})),this._modules.events.on(`edgeClassRemoved_${Gs}`,(e=>{this.shouldTriggerEvents&&this._modules.events.fire("edgesUnselected",e)})),this._modules.settings.register("interactions.selection.enabled",!0),this._modules.settings.register("interactions.selection.multiSelectionKey","ctrl"),this._modules.interactions.onClick({priority:"selection",check:({button:e})=>{const s=!!this._modules.settings.get("interactions.selection.enabled");return e==="left"&&s},handler:({target:e})=>{if(e){const s=this._modules.settings.get("interactions.selection.multiSelectionKey"),n=s&&this._modules.keyboard.isPressed(s);e.isNode?this._selectedClass.clearEdges():this._selectedClass.clearNodes(),n?e.hasClass(Gs)?e.removeClass(Gs):e.addClass(Gs):((e.isNode?this._selectedClass.getNodes():this._selectedClass.getEdges()).filter((i=>i!==e)).removeClass(Gs),e.hasClass(Gs)||e.addClass(Gs))}else this._selectedClass.clearNodes(),this._selectedClass.clearEdges()}});const t=()=>{this._selectionExtremityHighlightedClass.clearNodes(),this._selectedClass.getEdges().getExtremities().addClass(vy)};this._modules.events.on("beforeRemoveEdges",(({edges:e})=>e.setSelected(!1))).on("excludedStateChange",(({elements:e,value:s})=>{s||e.setSelected(!1)})).on(`edgeClassAdded_${Gs}`,t).on(`edgeClassRemoved_${Gs}`,t)}setNodeAttributes(t,e){this._selectedClass.update({nodeAttributes:t,fullOverwrite:e}),this._selectionExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()}setEdgeAttributes(t,e){this._selectedClass.update({edgeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()}setEdgeExtremitiesAttributes(t,e){this._selectionExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e})}_updateExtremityHighlightLayer(){const t=this._selectedClass.getDefinition().edgeAttributes,e=t?t.layer:void 0;this._selectionExtremityHighlightedClass.update({nodeAttributes:{layer:e},fullOverwrite:!1})}setActive(t,e){if(Fn(e)){const s=[],n=[];t.toList().forEach(((i,r)=>{(e[r]?s:n).push(i.getId())})),s.length!==0&&this._modules.graph.getElements(t.isNode,s).addClass(Gs),n.length!==0&&this._modules.graph.getElements(t.isNode,n).removeClass(Gs)}else t.size&&t[e?"addClass":"removeClass"](Gs)}areActive(t){return t.hasClass(Gs)}getSelectedNodes(){return this._selectedClass.getNodes()}getSelectedEdges(){return this._selectedClass.getEdges()}getNonSelectedNodes(){return this._modules.graph.getNodes().filter((t=>!t.hasClass(Gs)))}getNonSelectedEdges(){return this._modules.graph.getEdges().filter((t=>!t.hasClass(Gs)))}disableEvents(){this.shouldTriggerEvents=!1}enableEvents(){this.shouldTriggerEvents=!0}clear(){this._selectedClass.clearNodes(),this._selectedClass.clearEdges()}},v5=class extends Ke{onMounted(){this._delayedCalls=[],this._idIdle=()=>!this._modules.captor.isAnyButtonPressed()&&!this._modules.dom.isPlayingFrame(),this._modules.events.on(["mousedown","mouseup","beforeNewFrame","frame"],(()=>{this._delayedCalls.forEach((t=>t.reset()))}))}_nextTimeIdle(t){const e=new b5(this._modules.dom,this._idIdle,t);return this._delayedCalls.push(e),e.whenDone().then((()=>{this._delayedCalls.splice(this._delayedCalls.indexOf(e),1)}))}debounceIdle(t,e=0){let s=!1,n=[];const i=()=>{const r=n;s=!1,n=[],t(),r.forEach((o=>o()))};return()=>new Promise((r=>{n.push(r),s||(s=!0,this._nextTimeIdle(e).then(i))}))}},b5=class{constructor(t,e,s){this._timeout=null,this._done=!1,this._dom=t,this._promise=new Promise((n=>this._resolve=n)),this._isIdle=e,this._delay=s,this._startTimeout()}_startTimeout(){this._timeout=this._dom.setTimeout((()=>{this._isIdle()?(this._done=!0,this._resolve()):this._startTimeout()}),this._delay)}reset(){this._done||(this._dom.clearTimeout(this._timeout),this._startTimeout())}whenDone(){return this._promise}},mg=-2,E5={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:50,startRatio:1,endRatio:2,enabled:!1},S5={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:10,startRatio:1,endRatio:2,enabled:!1},A5=class extends Ke{constructor(){super(...arguments),this._nodePromiseMap=new Map,this._edgePromiseMap=new Map,this._onAttributeChange=({nodes:t,edges:e,nodeAttributes:s,edgeAttributes:n})=>{this._onElementsAttributeChange(t,s),this._onElementsAttributeChange(e,n,!1)},this._refreshPulses=()=>{const{nodes:t,edges:e}=this._hasPulses.getElements();if(t.size!==0||e.size!==0){const s=this._engine.getCurrentTime();this._refreshElementsPulses(t,s),this._refreshElementsPulses(e,s),this._modules.dom.refresh()}}}onMounted(){this._modules.events.on("updateAttributes",this._onAttributeChange).on("frame",this._refreshPulses).on("beforeRemoveEdges",(({edges:t})=>{this._removePulses(t)})).on("beforeRemoveNodes",(({nodes:t})=>{this._removePulses(t)})).on("excludedStateChange",(({elements:t,value:e})=>{e&&(this._hasPulses.removeElements(t),this._removePulses(t))})).on("clearGraph",(()=>this._hasPulses.clear())),this._engine=this._modules.graphics.getGraphicsEngine(),this._group=this._engine.createGroup(),this._nodePulses=this._modules.graph.createNodeAttribute({storage:"any"},!1),this._edgePulses=this._modules.graph.createEdgeAttribute({storage:"any"},!1),this._nodeNbPulsesRemaining=this._modules.graph.createNodeAttribute({storage:"int16",default:-1},!1),this._edgeNbPulsesRemaining=this._modules.graph.createEdgeAttribute({storage:"int16",default:-1},!1),this._nodeFlexArrays=this._modules.graphics.getNodeAttributes(),this._edgeFlexArrays=this._modules.graphics.getEdgeAttributes(),this._edgeSourceList=this._modules.graph.getEdgeAttribute("source"),this._edgeTargetList=this._modules.graph.getEdgeAttribute("target"),this._hasPulses=new kh(this._modules.graph)}_onElementsAttributeChange(t,e,s=!0){if(!e.includes("pulse.enabled"))return;const{valid:n,invalid:i}=kT(this._modules.graph,t,(o=>o.getAttribute("pulse.enabled")&&o.isVisible()));this._hasPulses.removeElements(i),this._hasPulses.addElements(n);const r=s?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining;for(let o=0;o<n.size;o++)r.get(n._indexes[o])>0||r.set(n._indexes[o],mg);this._removePulses(i)}_removePulses(t){const e=t.isNode?this._nodePulses:this._edgePulses,s=t.isNode?this._nodePromiseMap:this._edgePromiseMap;for(let n=0;n<t._indexes.length;n++){const i=t._indexes[n],r=e.get(i);if(r){for(let a=0;a<r.length;a++){const l=r[a];this._modules.graphics.releaseGraphicsEngineBlockId(l.blockId)}e.set(i,null);const o=s.get(i);o&&(o.resolve(),s.delete(i))}}}_refreshElementsPulses(t,e){const s=t.isNode,n=s?this._nodePulses:this._edgePulses,i=s?this._nodeFlexArrays.pulse.duration:this._edgeFlexArrays.pulse.duration,r=s?"_createNodePulseBlock":"_createEdgePulseBlock",o=s?this._nodeFlexArrays.pulse.interval:this._edgeFlexArrays.pulse.interval,a=s?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining;for(let l=0;l<t._indexes.length;l++){const u=t._indexes[l];let h=n.get(u);h||(h=[],n.set(u,h));for(let _=0;_<h.length;_++){const{startTime:x,duration:v,blockId:b}=h[_];e>=x+v&&(this._modules.graphics.releaseGraphicsEngineBlockId(b),h.splice(_--,1))}const g=h[h.length-1];if(g&&e<g.startTime+o.get(u))continue;const f=i.get(u),p=a.get(u);if(p<1&&p!==mg)continue;h.push({blockId:this[r](u,e,f),startTime:e,duration:f});const y=p===mg?mg:p-1;a.set(u,y)}}_createNodePulseBlock(t,e,s){const n=this._nodeFlexArrays,i=n.color.get(t),r=n.layer.get(t),o=n.x.get(t),a=n.y.get(t),l=n.radius.get(t),u=n.scalingMethod.get(t)==="scaled",h=n.pulse.startRatio.get(t),g=n.pulse.endRatio.get(t),f=n.pulse.width.get(t),p=2*l*h,y=2*l*g,_=sh(r).nodeBody,x=n.pulse.startColor.get(t),v=n.pulse.endColor.get(t),b=this._modules.graphics.allocateGraphicsEngineBlockId(),S=this._group.reset(lr,!0,_),A=S.nextAndReset(),w=hr(x,i),L=hr(v,i);return A.end.shape="circle",A.end.pieceId=Yi,A.end.x1=o,A.end.y1=a,A.end.x2=o,A.end.y2=a,A.end.rectWidthOrSourceRadiusScaled=u?y:0,A.end.rectHeightOrTargetRadiusScaled=u?y:0,A.end.rectWidthOrSourceRadiusFixed=u?0:y,A.end.rectHeightOrTargetRadiusFixed=u?0:y,A.end.strokeWidthFixed=f,A.end.strokeColor=L,A.start.shape="circle",A.start.pieceId=Yi,A.start.x1=o,A.start.y1=a,A.start.x2=o,A.start.y2=a,A.start.rectWidthOrSourceRadiusScaled=u?p:0,A.start.rectHeightOrTargetRadiusScaled=u?p:0,A.start.rectWidthOrSourceRadiusFixed=u?0:p,A.start.rectHeightOrTargetRadiusFixed=u?0:p,A.start.strokeWidthFixed=f,A.start.strokeColor=w,A.animation.duration=s,A.animation.beginTime=e,this._engine.storeGroup(b,S),b}_createEdgePulseBlock(t,e,s){const n=this._edgeFlexArrays,i=this._nodeFlexArrays,r=n.pulse.startRatio.get(t),o=n.pulse.endRatio.get(t),a=n.pulse.startColor.get(t),l=n.pulse.endColor.get(t),u=sh(n.layer.get(t)).edgeBody,h=this._edgeSourceList.get(t),g=this._edgeTargetList.get(t),f=n.curvature.get(t),p=f!==0,y=this._modules.graphics.allocateGraphicsEngineBlockId(),_=this._group.reset(p?xf:lr,!0,u),x=_.nextAndReset(),v={isSelfLoop:h===g,curvature:f,sourceX:i.x.get(h),sourceY:i.y.get(h),targetX:i.x.get(g),targetY:i.y.get(g),sourceRadius:i.radius.get(h),targetRadius:i.radius.get(g),isSourceRadiusScaled:i.scalingMethod.get(h)==="scaled",isTargetRadiusScaled:i.scalingMethod.get(g)==="scaled",width:n.width.get(t),isWidthScaled:n.scalingMethod.get(t)==="scaled",strokeWidth:n.pulse.width.get(t)};return I1(x.start,v),I1(x.end,v),x.start.strokeColor=a,x.end.strokeColor=l,x.start.thicknessOrFontSizeScaled*=r,x.start.thicknessOrFontSizeFixed*=r,x.end.thicknessOrFontSizeScaled*=o,x.end.thicknessOrFontSizeFixed*=o,x.animation.duration=s,x.animation.beginTime=e,this._engine.storeGroup(y,_),y}pulse(t,e){const s=t.isNode,n={...s?E5:S5,...s?this._nodePulseTheme:this._edgePulseTheme,...e},i=n.number,r=n.interval,o=n.duration,a=s?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,l=(i-1)*r+o;let u;n.enabled=!0,delete n.number,t.setAttributes({pulse:n}),a.setMultiple(t._indexes,i),this._modules.dom.setTimeout((()=>{t.isList?t.filter(ur).setAttribute("pulse.enabled",!1):t.setAttribute("pulse.enabled",!1),a.setMultiple(t._indexes,-1)}),l);const h=new Promise((f=>{u=()=>f(t)})),g=t.isNode?this._nodePromiseMap:this._edgePromiseMap;return t.isList?t._indexes.forEach((f=>{this._setPromise(f,g,h,u)})):this._setPromise(t._index,g,h,u),h}_setPromise(t,e,s,n){e.has(t)&&e.get(t).resolve(),e.set(t,{promise:s,resolve:n})}setTheme(t,e){this._nodePulseTheme=t,this._edgePulseTheme=e}};function I1(t,{sourceX:e,sourceY:s,targetX:n,targetY:i,isSourceRadiusScaled:r,isTargetRadiusScaled:o,targetRadius:a,sourceRadius:l,isWidthScaled:u,width:h,strokeWidth:g,curvature:f,isSelfLoop:p}){t.pieceId=Qf,t.shape="line",t.x1=e,t.y1=s,t.x2=n,t.y2=i,t.rectWidthOrSourceRadiusScaled=r?l:0,t.rectWidthOrSourceRadiusFixed=r?0:l,t.rectHeightOrTargetRadiusScaled=o?a:0,t.rectHeightOrTargetRadiusFixed=o?0:a,t.thicknessOrFontSizeScaled=u?h:0,t.thicknessOrFontSizeFixed=u?0:h,t.strokeWidthFixed=g,t.curvature=f,t.isSelfLoop=p}var w5={duration:0,easing:"linear",callback:as,resolve:as,startAfter:0},T5=0,C5=class extends Ke{constructor(){super(...arguments),this._animationList=[],this._update=()=>{if(this._animationList.length===0)return;const t=$n(),e=[];for(let s=0;s<this._animationList.length;++s){const n=this._animationList[s],i=(t-n.creationDate)/n.duration,r=n.startAfter;let o=n.easing(i);i>=1?(n.func(1),n.done=!0,n.resolve(void 0),this._animationList.splice(s,1),s-=1,e.push(n.callback)):o>=r&&(o=(o-r)*(1/(1-r)),n.func(o))}for(let s=0;s<e.length;s++)e[s](!1);this._modules.dom.refresh()}}onMounted(){this._modules.events.on("beforeNewFrame",this._update)}play(t,e){const{duration:s,easing:n,callback:i,startAfter:r,resolve:o}=Ni(e,w5);if(s<=0)return t(1),i(),o(void 0),null;const a={func:t,easing:typeof n=="function"?n:C0[n],duration:s,callback:i,resolve:o,startAfter:r,creationDate:$n(),done:!1,id:++T5};return this._animationList.push(a),this._modules.dom.refresh(),a}cancel(t){const e=this._animationList.indexOf(t);e!==-1&&(t.func(1),this._animationList.splice(e,1),t.done=!0,t.resolve(void 0))}},N0=t=>typeof t.export=="function",L5=(t,e,s,n)=>{const i=s._getMapPanePos(),r=t.getMapboxMap(),o=t.getCanvas(),a=t.getSize().round(),l=n.DomUtil.getPosition(t.getContainer()),u=l.x+i.x,h=l.y+i.y;return new Promise((g=>{function f(){e.drawImage(o,u,h,a.x,a.y),g()}if(r.loaded())return f();r.once("idle",f)}))},k5=(t,e,s,n,i)=>{if(N0(t))return t.export(e);const r=s._getMapPanePos(),o=t.getContainer();if(!o)throw new Error(`Trying to access the container of ${t} but it does not exist.`);const a=n.DomUtil.getPosition(o);s.removeLayer(t),t.options.crossOrigin="anonymous";const l=[],u=[];return t.on("tileload",(({tile:h})=>{const{x:g,y:f}=n.DomUtil.getPosition(h);l.push(h),u.push({x:g-a.x+r.x,y:f-a.y+r.y})})),s.addLayer(t),new Promise((h=>{t.once("load",(()=>{const g=t.getTileSize();l.forEach(((f,p)=>{const{x:y,y:_}=u[p];e.drawImage(f,y,_,g.x,g.y)})),h()}))}))},N5=(t,e,s,n,i,r)=>new Promise((o=>{const a=t.options.renderer;s.removeLayer(t),t.options.renderer=r,s.addLayer(t),r._updatePaths();const l=s._getMapPanePos(),u=r._container,h=n.DomUtil.getPosition(u);e.drawImage(r._container,h.x+l.x,h.y+l.y,u.width/i,u.height/i),s.removeLayer(t),t.options.renderer=a,s.addLayer(t),o()})),M5=(t,e,s,n,i)=>new Promise((r=>{if(N0(t))return t.export(e).then(r);const o=s.getPixelBounds().min,a=s.project(t.getLatLng(),s.getZoom());if(!t._icon||t._icon.tagName!=="IMG")return r();const l=/^data:/.test(t._icon.src),u=l?t._icon.src:Bk(t._icon.src),h=new Image,g=t.options.icon;if(g){const f=g.options;let p=f.iconSize||[24,24];const y=a.subtract(o);let _=f.iconAnchor||[0,0];Array.isArray(p)||(p=[p.x,p.y]),Array.isArray(_)||(_=[_.x,_.y]);const x=Math.round(y.x-(p[0]-_[0])*i),v=Math.round(y.y-_[1]*i);h.crossOrigin="";const b=()=>{e.drawImage(h,x,v,p[0]*i,p[1]*i),r()};h.onload=b,h.src=u,l&&b()}}));function I5(t){if(t.options.pane==="overlayPane"&&"getElement"in t){const e=t.getElement();return e&&e.tagName.toLowerCase()==="canvas"}return!1}var R5=(t,e,s,n,i)=>new Promise((r=>{const o=t.getElement(),a=o.width,l=o.height;e.drawImage(o,0,0,a,l),r()})),F5=(t,e,s,n,i)=>new Promise((r=>{s.removeLayer(t),t.setUrl(Bk(t.getUrl())),t.options.crossOrigin="anonymous",t.once("load",(()=>{const o=t.getBounds(),a=s.latLngToContainerPoint(o.getNorthWest()),l=s.latLngToContainerPoint(o.getSouthEast()),u=l.x-a.x,h=l.y-a.y;e.drawImage(t._image,a.x,a.y,u,h),r()})),s.addLayer(t)}));function Bk(t){return t+(t.indexOf("?")===-1?"?":"&")+"noCache="+Date.now()}var P5={tileLayers:k5,imageOverlays:F5,canvasOverlays:R5,vectorLayers:N5,markers:M5,vectorMap:L5};function z5(t,e){return t instanceof e.TileLayer||t.options.pane==="tilePane"&&N0(t)?"tileLayers":I5(t)?"canvasOverlays":t instanceof e.ImageOverlay?"imageOverlays":t instanceof e.Path?"vectorLayers":t instanceof e.Marker?"markers":"MapboxGL"in e&&t instanceof e.MapboxGL?"vectorMap":void 0}function D5(t,e,s,n,i,r){const o={vectorMap:[],tileLayers:[],vectorLayers:[],canvasOverlays:[],imageOverlays:[],markers:[]};return e.eachLayer((a=>{if(a!==t){const l=z5(a,n);if(l&&l in o){const u=P5[l];o[l].push((()=>u(a,s,e,n,i,r)))}}})),o}function O5(t){t.TileLayer.prototype.getUrl=function(){return this._url},t.ImageOverlay.prototype.getUrl=function(){return this._url};const e="leaflet-zoom-animated";t.OgmaOverlay||(t.OgmaOverlay=t.Layer.extend({options:{pane:"overlayPane",padding:0,onUpdate:()=>{}},initialize:function(s){const{container:n}=s;t.Util.setOptions(this,s),this._container=n},setLocked:function(s){return this._locked=s,this},onAdd:function(s){this._map=s,this.getPane().appendChild(this._container),this._wgsOrigin=t.latLng([0,0]),this._wgsInitialShift=s.project(this._wgsOrigin,this._initialZoom),t.DomUtil.addClass(this._container,"leaflet-layer"),this._zoomAnimated&&(t.DomUtil.addClass(this._container,e),this._container.style.position="absolute",this._container.style.zIndex=9999),this._initialZoom=(this._map.getMaxZoom()+this._map.getMinZoom())/2,this._mapInitialZoom=this._map.getZoom(),this._updateBounds(),this._update({})},_updateBounds(){const s=this.options.padding,n=this._map.getSize(),i=this._map.containerPointToLayerPoint(n.multiplyBy(-s));this._bounds=new t.Bounds(i,i.add(n.multiplyBy(1+2*s))),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},_update(s){this._updateBounds(),this._redraw(this._bounds.min,s),this._positionTimer=t.Util.requestAnimFrame((()=>{this._container&&t.DomUtil.setPosition(this._container,this._bounds.min)}))},_redraw(s,n){this.options.onUpdate()},_updateTransform(s,n){if(this._locked)return;const i=this._map.getZoomScale(n,this._zoom),r=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,n),a=r.multiplyBy(-i).add(o).subtract(this._map._getNewPixelOrigin(s,n));t.Browser.any3d?t.DomUtil.setTransform(this._container,a,i):t.DomUtil.setPosition(this._container,a)},_onZoom(s){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_onMoveEnd(s){this._update(s)},_onAnimZoom({center:s,zoom:n}){this._updateTransform(s,n)},bringToFront(){t.DomUtil.toFront(this._container)},getEvents(){return{zoom:this._onZoom,moveend:this._onMoveEnd,zoomanim:this._onAnimZoom,layeradd:this.bringToFront,zoomend:this.options.onUpdate}},onRemove:function(){t.DomUtil.removeClass(this._container,e);const s=this._container;["transform","webkitTransform","OTransform","MozTransform","msTransform","zIndex","position"].forEach((n=>s.style[n]=null)),t.Util.cancelAnimFrame(this._positionTimer),this._container=null}}))}function B5(t,e,s,n){const i=t.filter((L=>L.isVisible())),r=i.size===0,{mapX:o,mapY:a}=i.reduce(((L,I)=>{const{latitude:F,longitude:O}=I.getGeoCoordinates(),{x:V,y:j}=n(F,O);return L.mapX.push(V),L.mapY.push(j),L}),{mapX:[],mapY:[]}),l=i.getAttribute("x"),u=i.getAttribute("y"),h=i.getAttribute("radius").map(Number),g=new ri({xValues:l,yValues:u,scaledSizeValues:h}),f=new ri({xValues:o,yValues:a});r&&(g.cx=g.cy=0,g.width=g.height=0),isFinite(f.width)&&isFinite(f.height)||(f.cx=f.cy=0,f.width=f.height=0);let p=f.cx-g.cx,y=f.cy-g.cy;const _=r?1:Math.max(f.width,f.height)/Math.max(g.width,g.height),[x,v]=h.reduce(((L,I)=>(L[0]=Math.min(L[0],I*_),L[1]=Math.max(L[1],I*_),L)),[1/0,0]);f.pad(v),f.minScaledSize=x,f.maxScaledSize=v;const b=s.computeConfigForBounds(f),S=e.zoom/oP(b.zoom);p+=(g.cx-e.x)*S,y+=(g.cy-e.y)*S;const A=g.cx+p,w=g.cy+y;return{offsetChanges:{name:"graph-to-geo",nodeAttributes:{radius:L=>Number(L.getAttribute("radius"))*S,x:L=>(L.getAttribute("x")+p-A)*S+A,y:L=>(L.getAttribute("y")+y-w)*S+w},edgeAttributes:{width:L=>Number(L.getAttribute("width"))*S}},camera:{zoom:e.zoom/S,x:(e.x+p-A)*S+A,y:(e.y+y-w)*S+w,angle:0,...e.getSize()}}}function U5(t,e,s,n){const i=t.getAttributes(["x","y","radius"]),r=t.getBoundingBox(),o=t.size===0,a=t.reduce(((A,{_index:w},L)=>(A[w]=L,A)),{});n();const l=t.getAttribute("x"),u=t.getAttribute("y"),h=t.getAttribute("radius"),g=new ri({xValues:l,yValues:u,scaledSizeValues:h.map((A=>2*A))});o&&(r.reset(),g.reset());let f=g.cx-r.cx,p=g.cy-r.cy,y=0,_=0;const x=s.computeConfigForBounds(g),v=e.zoom/x.zoom;let b,S;return isNaN(r.cx)||isNaN(r.cy)?(r.cx=e.x,r.cy=e.y,b=x.x,S=x.y):(f+=(r.cx-e.x)*v,p+=(r.cy-e.y)*v,y=r.cx+f,_=r.cy+p,b=(e.x+f-y)*v+y,S=(e.y+p-_)*v+_),{offsetChanges:{name:"geo-to-graph",nodeAttributes:{x:A=>(i[a[A._index]].x+f-y)*v+y,y:A=>(i[a[A._index]].y+p-_)*v+_}},camera:{zoom:x.zoom,x:b,y:S,angle:0,...e.getSize()}}}var Uk={"top-left":"left","bottom-left":"left","top-right":"right","bottom-right":"right"},G5={"top-left":"top","bottom-left":"bottom","top-right":"top","bottom-right":"bottom"},R1={position:"bottom-right",horizontalMargin:0,verticalMargin:0,className:void 0},V5=class extends Ke{onMounted(){this._brand=null}set(t,e){let{position:s,horizontalMargin:n,verticalMargin:i,className:r}={...R1,...e};Uk[s]||(s=R1.position),this.remove();const o=document.createElement("div");return xT(o,Ux.sanitize(t)),o.style.position="absolute",Gk(o,s,n,i),o.style.zIndex="10",r&&o.setAttribute("class",r),this._brand=o,this._modules.dom.setLayer("brand",this._brand),o}remove(){this._modules.dom.setLayer("brand",null),this._brand=null}};function Gk(t,e,s,n){const i=s===void 0?"":s+"px",r=n===void 0?"":n+"px";t.style[Uk[e]]=i,t.style[G5[e]]=r}var F1={},j5=class extends Ke{constructor(){super(...arguments),this._enabled=!1,this._settings={...La},this._edgesOriginalTextStyle={},this._nodesOriginalTextStyle={},this._nodeDraggingSetting=!1,this._transition=!1,this._attribution=null,this._updating=!1,this._updateRate=50,this._x=0,this._y=0,this._onCameraUpdate=t=>{if(this.L&&this._enabled&&this._map&&this._map._loaded){const e=this._x-this._modules.camera.x,s=this._y-this._modules.camera.y;(e||s)&&this._syncMapWithCamera()}},this._syncMapWithCamera=()=>{if(!this._map)return;this._updating||(this._updating=!0,this._layer.setLocked(!0),this._map._moveStart(!0,!1));const t=this._fromPointToLatLng(this._modules.camera.x,this._modules.camera.y),e=Hm(this._modules.camera.zoom),s=this.L.latLng(t.latitude,t.longitude);this._map._move(s,e,{pinch:!0,round:!1}),clearTimeout(this._updateRequest),this._updateRequest=this._modules.dom.setTimeout((()=>{this._updating=!1,this._layer.setLocked(!1),this._map&&this._map._move(s,e,{pinch:!0})._moveEnd(!0)}),this._updateRate)},this._onNodesDragStart=()=>{this._enabled&&(this._setMapDragging(!1),this._nodeDragOffsetX=this._nodeDragOffsetY=0)},this._onNodesDragged=({nodes:t,dx:e,dy:s})=>{if(this._enabled){const n=t.map((i=>{const{x:r,y:o}=i.getAttributes(["x","y"]);return this._fromPointToLatLng(r+e-this._nodeDragOffsetX,o+s-this._nodeDragOffsetY)}));return this._nodeDragOffsetX=e,this._nodeDragOffsetY=s,t.setGeoCoordinates(n)}return Promise.resolve(this._modules.graph.nodeList())},this._onMapUpdate=()=>{if(!this._map)return Promise.resolve(void 0);const{lat:t,lng:e}=this._map.getCenter(),s=this._fromLatLngToPoint(t,e);this._x=s.x,this._y=s.y;const n=rP(this._map.getZoom());return this._modules.events.fire("beforeGeoCameraMove",{zoom:this._map.getZoom()}),this._modules.camera.setView({zoom:n,x:s.x,y:s.y},{ignoreZoomLimits:!0}).then((()=>this._adjustMinvisibleSizes()))},this.runLayout=async({type:t,nodes:e,latitudePath:s=Tr,longitudePath:n=Cr,options:i,center:r})=>{const o=EP(r),a=o([r.longitude,r.latitude]),l=e.getPosition(),u=[];return e.setAttributes(e.map((h=>{const g=h.getData(s),f=h.getData(n);if(isNaN(g)||isNaN(f))return{x:a[0],y:a[1]};const p=o([f,g]);return{x:p[0],y:p[1]}}))).then((()=>this._ogma.layouts[t]({...i,nodes:e,dryRun:!0}))).then((h=>{const g=h.positions.current,f=new Array(g.length),p=new Array(g.length),y=new Array(g.length).fill(10);g.forEach(((b,S)=>{const A=o.invert([b.x,b.y]);f[S]=A[1],p[S]=A[0],u.push({latitude:A[1],longitude:A[0]})}));const _=Eh(p,f,y),x=_[0]-r.longitude,v=_[1]-r.latitude;for(let b=0;b<u.length;b++)f[b]-=v,p[b]-=x,u[b].latitude-=v,u[b].longitude-=x;return e.setData(s,f),e.setData(n,p),e.setAttributes(l)})).then((()=>this._ogma.modules.geo._updateNodesCoordinates(e))).then((()=>u))}}onMounted(){this._modules.events.register(["geoEnabled","beforeGeoDisabled","geoDisabled","geoNodesMoved","geoLoaded","geoReady"]),CE()&&(this.L=$i("L")||$i("leaflet"),this.L&&O5(this.L)),this._modules.graph.createNodeAttribute({name:"geo.prevLat",storage:"float"},!0),this._modules.graph.createNodeAttribute({name:Um,storage:"float"},!0),this._modules.graph.createNodeAttribute({name:Tr,storage:"float"},!0),this._modules.graph.createNodeAttribute({name:Cr,storage:"float"},!0),this._modules.events.register(["beforeGeoCameraMove"]),this._modules.events.on("addNodes",(t=>{t.virtual||this._refreshOrAddNodes(t.nodes,!0)})).on("updateNodeData",(t=>{this._onDataChange(t.changes)})).on("nodesDragProgress",this._onNodesDragged).on(["nodesDragStart","lassoEnabled"],this._onNodesDragStart).on(["nodesDragEnd","lassoDisabled"],(()=>this._setMapDragging(!0))).on("viewChanged",this._onCameraUpdate)}_onDataChange(t){const e=K_(this.latitudePath),s=K_(this.longitudePath),n=t.filter((({virtual:r,property:o,newValues:a})=>!(r||!a.length)&&(o&&typeof o!="string"?o.find((l=>e.startsWith(l)||s.startsWith(l))):o===null||e.startsWith(o)||s.startsWith(o))));if(!n.length)return;const i=yP(n);i&&(this._modules.events.fire("geoNodesMoved",{nodes:i}),this._refreshOrAddNodes(i,!1))}_refreshOrAddNodes(t,e){e&&this._updatePrevNodesCoordinates(t),this._updateNodesCoordinates(t),this._enabled&&(this._cacheOriginalTextStyles(t,null),this._filter.refresh())}_updatePrevNodesCoordinates(t){Uc(this._modules.graph,t,Tr,dE),Uc(this._modules.graph,t,Cr,Um)}_restorePrevNodesCoordinates(t){Uc(this._modules.graph,t,dE,Tr),Uc(this._modules.graph,t,Um,Cr)}_updateNodesCoordinates(t){pP(this._modules.graph,t,this._settings)}_createMapTileLayer(t,e,s){if(t&&!cn(t))return t;const n=t,i=n.wms?this.L.tileLayer.wms:this.L.tileLayer,r=aP(n,e)||"";return i(n.url,{attribution:r,maxZoom:s,...t})}_setupTileLayer(t,e,s,n){const i=this._createMapTileLayer(t,e,n);return i.once("load",(()=>{this._modules.events.fire("geoLoaded")})),i.addTo(this._map),TE(i,s),i}_onSettingsChanged(t,e){var i;const s=t.wrapCoordinates!==e.wrapCoordinates,n=t.latitudePath!==e.latitudePath||t.longitudePath!==e.longitudePath;if(s||n){let r=Promise.resolve();this._enabled&&this._filter&&(r=r.then((()=>this._filter.refresh()))),r.then((()=>this._updateNodesCoordinates(this._modules.graph.getNodes("all"))))}this._enabled&&(dP(t,e)&&this._map&&(this._map.removeLayer(this._tileLayer),this._tileLayer=this._setupTileLayer(e.tiles,e.attribution,e.opacity,e.maxZoomLevel)),t.sizeRatio!==e.sizeRatio&&this._updateSizes(),t.maxZoomLevel!==e.maxZoomLevel&&(this._modules.settings.update({minZoom:1,maxZoom:Math.pow(2,e.maxZoomLevel)}),(i=this._map)==null||i.setMaxZoom(e.maxZoomLevel),this._tileLayer&&this._tileLayer.options&&(this._tileLayer.options.maxZoom=e.maxZoomLevel)),t.disableNodeDragging!==e.disableNodeDragging&&this._setDragging(!e.disableNodeDragging),t.attributionOptions!==e.attributionOptions&&this._setAttributionOptions(e.attributionOptions,e.attribution),TE(this._tileLayer,e.opacity))}_setMapDragging(t){if(this._map){const e=t?"enable":"disable";this._map.dragging[e]()}}_fromLatLngToPoint(t,e){return this._map.options.crs.latLngToPoint(this.L.latLng(t,e),ef)}_fromPointToLatLng(t,e){const{lat:s,lng:n}=this._map.options.crs.pointToLatLng(this.L.point({x:t,y:e}),ef);return{latitude:s,longitude:n}}_updateSizes(){this._enabled&&this._projection&&this._projection.updateAll()}enable(t){return this.setEnabled(!0,t)}getMap(){return this._enabled?this._map:null}getOptions(){return this._enabled?{...this._settings,tiles:cn(this._settings.tiles)?{...this._settings.tiles}:this._settings.tiles}:{...La}}setOptions(t){if(!this._enabled||this._transition)return;lP(t,this.L);const e=this._settings;this._settings={...La,...e,...t,tiles:uP(La,t)},this._onSettingsChanged(e,this._settings)}disable(t){return this.setEnabled(!1,t)}isEnabled(){return this._enabled}toggle(t={}){return this.setEnabled(!this._enabled,t)}getContainerCoords(t){return t.getGeoCoordinates().map((({latitude:e,longitude:s})=>this._map.latLngToContainerPoint([e,s])))}getContainerCoord(t){const{latitude:e,longitude:s}=t.getGeoCoordinates();return this._map.latLngToContainerPoint([e||0,s||0])}setEnabled(t,e){if(!CE())throw new Error("Ogma Geo cannot be used outside a browser");if(!this.L)throw new Error("You are trying to use Geo mode but Leaflet has not been found. Please follow our migration guide: https://bit.ly/2SYkF8A");if(this._transition||t===this._enabled)return Promise.resolve();const s=this._modules.settings;this._enabled||(this._prevSettings=s.get(),this._nodeDraggingSetting=!!s.get("interactions.drag.enabled")),this._enabled=t,this.setOptions(e),this._transition=!0;const n=this._settings;return t?this._show(e==null?void 0:e.latitude,e==null?void 0:e.longitude,e==null?void 0:e.zoom).then((()=>(this._registerTextStyle(this._modules.graph.getNodes(),this._modules.graph.getEdges()),this._setDragging(!n.disableNodeDragging),this._transition=!1,this._updating=!1,this._modules.events.fire("geoEnabled").fire("geoReady"),this._adjustMinvisibleSizes()))):this._restoreTextStyle().then((()=>this._hide())).then((()=>{this._transition=!1,this._modules.events.fire("geoDisabled"),this._setDragging(this._nodeDraggingSetting,!0)})).then((()=>this._ogma.view.afterNextFrame()))}destroy(){return this._enabled&&this._destroyMapSync(),Promise.resolve()}_cacheOriginalTextStyles(t,e){e&&(this._edgesOriginalTextStyle=kE(e,this._edgesOriginalTextStyle)),t&&(this._nodesOriginalTextStyle=xP(t,this._nodesOriginalTextStyle))}_registerTextStyle(t,e){this._cacheOriginalTextStyles(t,e);const{nodeAttributes:s,edgeAttributes:n}=this._modules.hover.getHoverClassDefinition();this._hoverEdgesOriginalTextStyle=n||null,this._hoverNodesOriginalTextStyle=s||null,this._modules.hover.updateEdgeAttributes({text:{size:i=>(this._edgesOriginalTextStyle[i.getId()]||F1)["text.size"]}}),this._modules.hover.updateNodeAttributes({text:{size:i=>(this._nodesOriginalTextStyle[i.getId()]||F1)["text.size"]}})}_restoreTextStyle(){return this._modules.hover.updateEdgeAttributes(this._hoverEdgesOriginalTextStyle,!0),this._modules.hover.updateNodeAttributes(this._hoverNodesOriginalTextStyle,!0),Promise.all([bP(this._modules.graph.getEdges(),this._edgesOriginalTextStyle)]).then((()=>{this._edgesOriginalTextStyle=kE(this._modules.graph.edgeList(),{}),this._nodesOriginalTextStyle={},this._edgesOriginalTextStyle={}}))}_setDragging(t,e=!1){this._modules.settings.update({interactions:{drag:{enabled:t,applyResult:e}}})}_setAttributionOptions(t,e){if(this._map){if(this._attribution&&(this._attribution.remove(),this._attribution=null),this._attribution=this.L.control.attribution({prefix:!1}).addTo(this._map),cn(t)){this._attribution.setPrefix(""),t.position=t.position||"bottom-right";const s=t.position.replace("-","");this._attribution.setPosition(s);const n=this._attribution.getContainer();n&&(t.className&&this.L.DomUtil.addClass(n,t.className),Gk(n,t.position||"bottom-right",t.horizontalMargin,t.verticalMargin))}e!=null&&this._attribution.addAttribution(e)}}_nodeIsVisible(t){return mP(t,this._settings,this._hasCustomProjection())}_updateSettingsForMap(){const t=this._modules.graphics.getGraphicsEngine().parseColor(this._settings.backgroundColor);t[3]=0,this._modules.settings.update({backgroundColor:tC(t),minZoom:1e-6,interactions:{rotation:{enabled:!1},drag:{enabled:!1},pan:{enabled:!1},zoom:{enabled:!1,onDoubleClick:!1}},mouse:{wheelEnabled:!1}})}getGraphPosition(t){const e=this.L.latLngBounds(gP(t));return{center:t.size>0?e.getCenter():this.L.latLng([0,0]),zoom:this._clampZoom(this._map.getBoundsZoom(e))}}_initMap(){this._updateSettingsForMap(),this._mapContainer=cP(this._modules.dom.getContainer());const t={...yF,minZoom:this._settings.minZoomLevel,maxZoom:this._settings.maxZoomLevel};this._hasCustomProjection()&&(t.crs=this._settings.crs,t.worldCopyJump=!1,t.maxBoundsViscosity=0),this._map=new this.L.Map(this._mapContainer,t),this._map.on("movestart zoomstart",(()=>{this._updating=!0})).on("moveend zoomend",(()=>{this._updating=!1})),this._setAttributionOptions(this._settings.attributionOptions,this._settings.attribution),this._setupLayers()}_clampZoom(t){let e=this._tileLayer.options.maxZoom;return e===void 0&&(e=1/0),Math.min(t,e)}_show(t,e,s){let n;return this._initMap(),this._filter?n=this.filter.enable(0):(this._filter=this._modules.transformations.api.addNodeFilter({criteria:i=>this._nodeIsVisible(i)}),this._filter.setIndex(0),n=this._filter.whenApplied()),n.then((()=>{const i=this._map,r=this._modules.graph.getNodes(),o=this._modules.graph.getEdges(),a=this.getGraphPosition(r),l=a.center;t!==void 0&&e!==void 0&&(l.lat=t,l.lng=e);const u=s??a.zoom,{offset:h,newCameraView:g}=this._transformToGeo();return this._modules.camera.setView(g,{ignoreZoomLimits:!0}).then((()=>(this._updatePrevNodesCoordinates(r),i.setView(l,u,{animate:!1}),this._modules.graphics.animate({nodes:r,edges:o},(()=>{this._projection=this._createFinalPositionLayer()}),!0,this._settings.duration)))).then((()=>h.destroy()))}))}updateProjection(){var t;(t=this._projection)==null||t.update()}_hasCustomProjection(){return this._settings.crs!=null}_setupLayers(){this._settings.tiles&&(this._tileLayer=this._setupTileLayer(this._settings.tiles,this._settings.attribution,this._settings.opacity,this._settings.maxZoomLevel)),this._layer=new this.L.OgmaOverlay({container:this._modules.graphics.getDomElement(),mapContainer:this._mapContainer,onUpdate:()=>this._onMapUpdate()}),this._layer.addTo(this._map)}_adjustMinvisibleSizes(){return Promise.all([vP(this._modules.graph.getEdges(),this._edgesOriginalTextStyle,this._map.getZoom())])}_hide(){if(!this._map)return Promise.resolve();this._modules.settings.update(this._prevSettings);const t=this._map;t.removeLayer(this._layer);const e=this._modules.dom.getContainer(),s=this._modules.graphics.getDomElement();e&&e.appendChild(s),t.getContainer().style.zIndex="0";const n=this._modules.graph.getNodes("all"),i=this._modules.graph.getEdges("all"),{offset:r,newCameraView:o}=this._transformToGraph();return this._modules.camera.setView(o||{}).then((()=>(this._modules.events.fire("beforeGeoDisabled"),Promise.all([g2(t.getContainer(),1,0,this._settings.duration/2).then((()=>this._destroyMapSync())),this._modules.graphics.animate({nodes:n,edges:i},(()=>r&&r.destroy()),!0,this._settings.duration)])))).then((()=>(this._map=null,this._filter.disable(0).then((()=>{})))))}_destroyMapSync(){if(this._map){this._layer&&this._layer._map&&this._map.removeLayer(this._layer),this._map.remove(),this._map._animatingZoom=!1,this._map=null;const t=this._mapContainer.parentNode;t&&t.removeChild(this._mapContainer)}}_transformToGeo(){const t=this._modules.graph.getNodes(),{offsetChanges:e,camera:s}=B5(t,this._modules.camera,this._modules.locate,((n,i)=>this._fromLatLngToPoint(n,i)));return{offset:this._addGraphAttributesLayer(e),newCameraView:s}}_addGraphAttributesLayer(t){return this._modules.graphics.addAttributeLayer({priority:jz,nodeSelector:e=>e.isVisible(),edgeSelector:e=>e.isVisible(),...t})}_transformToGraph(){const t=this._modules.graph.getNodes("all"),{offsetChanges:e,camera:s}=U5(t,this._modules.camera,this._modules.locate,(()=>{this._projection&&(this._projection.destroy(),this._projection=null)}));return{offset:this._addGraphAttributesLayer(e),newCameraView:s}}getPointFromLatLng(t){const{latitude:e,longitude:s}=t.getGeoCoordinates();return e==null?t.getAttributes(["x","y"]):this._fromLatLngToPoint(e,s)}_createFinalPositionLayer(){return this._addGraphAttributesLayer({name:"graph-2-geo-animation",nodeAttributes:{scalingMethod:"fixed",radius:t=>Number(t.getAttribute("radius"))*this._settings.sizeRatio,x:t=>this.getPointFromLatLng(t).x,y:t=>this.getPointFromLatLng(t).y},edgeAttributes:{scalingMethod:"fixed",width:t=>Number(t.getAttribute("width"))*this._settings.sizeRatio}})}setCenter(t,e){return this._enabled?this.setView(t,e,Hm(this._modules.camera.getZoom())):Promise.resolve()}setZoom(t){return this._enabled&&this._map?(t=this._clampZoom(t),this._map.setZoom(t),new Promise((e=>{const s=this._map;if(s.getZoom()===t)return e(void 0);s.once("moveend zoomend",e)})).then(this._onMapUpdate)):Promise.resolve()}zoomIn(){return this.setZoom(this.getZoom()+1)}zoomOut(){return this.setZoom(this.getZoom()-1)}setView(t,e,s){if(!this._enabled||!this._map)return Promise.resolve();const n=this._map;s=this._clampZoom(s);const i=this.L.latLng([t,e]);return n.setView(i,s,{animate:!1,reset:!0}),new Promise((r=>{if(n.getZoom()===s&&n.getCenter().equals(i))return r(void 0);n.once("moveend zoomend",r)})).then(this._onMapUpdate)}getView(){if(!this._enabled||!this._map)return;const t=this._map.getCenter();return{zoom:this._map.getZoom(),latitude:t.lat,longitude:t.lng}}getCenter(){if(!this._enabled||!this._map)return;const t=this._map.getCenter();return{latitude:t.lat,longitude:t.lng}}getZoom(){if(this._enabled&&this._map)return this._map.getZoom()}resetCoordinates(){if(!this._enabled||!this._projection)return;const t=this._modules.graph.getNodes();this._restorePrevNodesCoordinates(this._modules.graph.getNodes());const e=this._modules.graph.getNodeAttribute(Tr).getMultiple(t._indexes),s=this._modules.graph.getNodeAttribute(Cr).getMultiple(t._indexes);t.setData(this._settings.latitudePath,e),t.setData(this._settings.longitudePath,s),this._projection.update()}getUnprojectedCoordinates(t){this._projection&&this._projection.destroy();const e=t.getPosition();return this._projection=this._createFinalPositionLayer(),e}get latitudePath(){return this._settings.latitudePath}get longitudePath(){return this._settings.longitudePath}get filter(){return this._filter}exportBackground(t){if(!this._map)return Promise.reject("Map is not ready");const{pixelRatio:e,width:s,height:n,zoom:i,x:r,y:o}=t,a=s*e,l=n*e,u=Pn(a,l),h=u.getContext("2d"),g=this._map;if(!h)throw new Error(`Unable to get 2d context from  ${u}`);const f=this.getView(),p={zoom:Math.round(Hm(i*e)),...this._fromPointToLatLng(r,o)},y=new this.L.Canvas;g.addLayer(y);const{vectorMap:_,tileLayers:x,vectorLayers:v,canvasOverlays:b,imageOverlays:S,markers:A}=D5(this._layer,g,h,this.L,e,y),w=g.options.zoomSnap;return Promise.resolve().then((()=>(ja(this._mapContainer,a+"px",l+"px"),g.invalidateSize({animate:!1}),this.setView(p.latitude,p.longitude,p.zoom)))).then((()=>dT([..._,...x,...b,...S,...v,...A]))).then((()=>{ja(this._mapContainer,"100%","100%"),g.invalidateSize({animate:!1}),g.options.zoomSnap=w,this.setView(f.latitude,f.longitude,f.zoom)})).then((()=>new Promise((L=>this.L.Util.requestAnimFrame(L))))).then((()=>g.removeLayer(y))).then((()=>u))}},H5=class extends Ke{constructor(){super(...arguments),this._context={edgesAlwaysCurvy:!1,edgesRoutingStyle:"none",directedEdges:!1}}onMounted(){this._attributeLayer=this._addAttributeLayer(),this._modules.settings.register("edgesAlwaysCurvy",!1,(t=>{this._context.edgesAlwaysCurvy=t,this._attributeLayer.updateAll()})),this._modules.settings.register("directedEdges",!1,(t=>{this._context.directedEdges=t,this._attributeLayer.updateAll()})),this._modules.settings.register("edgesRoutingStyle","none",(t=>{var i;const e=t&&t!=="none",s=t==="vertical",n=(i=this._ogma.modules)==null?void 0:i.graphics.getGraphicsEngine();n&&n.setBentEdges(e,s),this._attributeLayer.updateAll()}))}computeCurvature(t,e="visible",s){const{edgesAlwaysCurvy:n,directedEdges:i}=this._context,r=t.getSource()===t.getTarget();if(!n&&t.hasParallelEdges()===!1&&!r)return 0;let o=t.getParallelEdges({filter:e});s&&(o=o.filter((u=>s(u))));const a=o.indexOf(t);if(a===-1)return 0;let l;if(r)l=(a+1)*Math.max(+t.getAttribute("width")||0,1);else{const u=t.getSource(),h=o.size;if(h===1&&!n)return 0;if(i){let g=0;for(let f=0;f<a;++f)o.get(f).getSource()===u&&(g+=1);l=g+1}else{const g=u!==o.get(0).getSource();l=h%2!=1||n?(1+(a/2|0))*(a%2==0?1:-1)*(g?-1:1):a===0?0:((a+1)/2|0)*(a%2==0?1:-1)*(g?-1:1)}}return l}_addAttributeLayer(){return this._modules.graphics.addAttributeLayer({name:"curvature",priority:Bz,edgeDependencies:{parallelEdges:!0},edgeContext:this._context,edgeAttributes:{curvature:t=>this.computeCurvature(t)}})}};/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $5(t){if(typeof t!="string"||t.trim()===""){let e="Calls to uncheckedconversion functions must go through security review.";throw e+=" A justification must be provided to capture what security assumptions are being made.",new Error(e)}}function od(t,e){return $5(e.justification),Nx(t)}var Vk="worker_start",jk="worker_configure",wf="worker_stop",ah="worker_update",q5=0,Hk=class extends wh{constructor(t,e){super(),this._complete=!1,this._busy=!1,this._destroyed=!1,this._data=null,this._onStart=as,this._onStop=as,this._setIdle=as,this._onPause=as,this.timer={start:0,steps:0},this._modules=e,this._busy=!1,this.id=++q5,this.configure(t)}configure({configure:t=ur,update:e=as,context:s=as,stop:n=as,isRunning:i=Jg,onStart:r=as,onStop:o=as,onPause:a=as,setIdle:l=as}){this._configure=t,this._update=e,this._createContext=s,this._isRunning=i,this._stop=n,this._onStart=r,this._onStop=o,this._setIdle=l,this._onPause=a}setData(t){this._data=t}getData(){return this._data}start(t){this.promise=new Promise(((s,n)=>{this.resolve=s,this.reject=n})),this._complete=!1,this._busy=!0,this._onStart(),this.fire(Vk,{target:this});const e=this._configure(t,this._modules);return this.fire(jk,e),this.send(e),this}stop(t=!0){return this._complete?Promise.resolve():(this._onStop(),t&&this.send({type:wf}),this.promise.then((()=>{this.fire(wf,{target:this}),this.clearEvents(),this._complete=!0})))}pause(){this._onPause()}setIdle(t){this._setIdle(t)}isBusy(){return!this._complete||this._busy}setBusy(t){this._busy=t}getPromise(){return this.promise}destroy(){this._destroyed||(this._destroyed=!0,this._modules&&(this._busy&&this.stop(),delete this._modules))}},$k=/^function\s*\(/,qk=/^\(|^\w+\s?=>/,Y5="Layout control code for the worker",ad={justification:Y5};function _g(t){const e=t.toString();return e.indexOf("function")===0||qk.test(e)?e:`function ${e}`}var W5=class extends Hk{constructor(t,e){super(t,e);const s=$R([od(X5(t.imports),ad),Ju`\nconst __CONTEXT = (`,od(_g(this._createContext),ad),Ju`)();\nconst __UPDATE_FUNC = `,od(_g(this._update),ad),Ju`\nconst __IS_RUNNING_FUNC = `,od(_g(this._isRunning),ad),Ju`\nconst __STOP_FN = `,od(_g(this._stop),ad),Ju`\nlet result;
      self.addEventListener("message", function (evt) {
        if (evt.data && evt.data.type === 'worker_stop') {
          __STOP_FN(__CONTEXT);
          return self.postMessage({ result, isRunning: false, stopped: true });
        }
        result = __UPDATE_FUNC(evt.data, __CONTEXT);
        const isRunning = __IS_RUNNING_FUNC(__CONTEXT, evt.data);
        self.postMessage({ result, isRunning });
      });
    `]);this._worker=HL(s),this._worker.addEventListener("message",(n=>{e.dom.isDestroyed()||this.onWorkerMessage(n)}))}onWorkerMessage(t){const e=t.data.isRunning,s=t.data.stopped,n={data:void 0},i={worker:this,workerMessage:t.data.result,modules:this._modules,data:n,isRunning:e};if(!s)return e?(this.fire(ah,i),this.send(n.data)):(this.fire(ah,i),this.stop());this.resolve()}destroy(){super.destroy(),this._worker.terminate()}send(t){return this._complete||this._worker.postMessage(jL(t)),this}};function X5(t={}){const e=Object.keys(t),s=[];for(let n=0,i=e.length;n<i;n++){const r=e[n],o=t[r];if(typeof o!="function")throw new Error(`Asynchronous worker: dependency "${r}" is not found`);{const a=Z5(o);a?(s.push(P1(o,r)),a!==r&&s.push(`var ${r} = ${a};`)):s.push(`var ${r} = ${P1(o,r)};`)}}return s.join(`
`)}function P1(t,e){const s=t.toString();return $k.test(s)?`function ${t.name||e} ${s.substring(s.indexOf("("))}`:qk.test(s)?`const ${t.name||e} = ${s.toString()}`:s}function Z5(t){const e=t.toString();return t.name?t.name:$k.test(e)?null:e.substring(9,e.indexOf("(")).trim()}var K5=class extends Hk{constructor(t,e){super(t,e),this._context=this._createContext()}sync(t){if(t&&t.type===wf)return this._stop(this._context),void this.resolve();const e=this._update(t,this._context),s=this._isRunning(this._context,t),n={data:void 0},i={worker:this,workerMessage:e,modules:this._modules,data:n,isRunning:s};return s?(this.fire(ah,i),this.send(n.data)):(this.fire(ah,i),this.stop())}send(t){return this._complete||this._modules.dom.setTimeout((()=>{this.sync(t)}),0),this}},Q5=3,J5=class extends Ke{constructor(){super(...arguments),this._pool={}}create(t,e){const s=e&&VL,n=this._modules,i=`${t.name||"worker"}-${s?"async":"sync"}`;let r=this._pool[i];r||(r=this._pool[i]=[]);let o=r.find((a=>!a.isBusy()));return o?o.configure(t):(o=s?new W5(t,n):new K5(t,n),this._pool[i].push(o)),o.on(wf,(()=>{this._pool[i].length<=Q5||(o.destroy(),this._pool[i]=this._pool[i].filter((a=>a!==o)))})),o}start(t,e){return t.start(e)}run(t,e,s){const n=this.create(t,s);return this.start(n,e)}destroy(){for(const t in this._pool)this._pool[t].forEach((e=>e.destroy())),delete this._pool[t]}};function tG(t,e,s,n=t.getNodes()){if(!e)return s?t.nodeList():n.filter((i=>i.getMetaNode()===null));if(!(e instanceof lo)){if(Array.isArray(e)&&e.length>0)return t.getNodes(e);throw Error("[Layout]: 'nodes' must be a NodeList or an NodeId[]")}return e}function eG(t,e,s=t.getEdges()){if(!e)return s;if(!(e instanceof qa)){if(Array.isArray(e)&&e.length>0)return t.getEdges(e);throw Error("[Layout]: 'edges' must be a EdgeList or a valid EdgeId[]")}return e}function sG(t){if(!t.size)return;const e=new Set(t.getId());return t.getAdjacentEdges().filter((s=>s.getExtremities().getId().every((n=>e.has(n)))))}function Yk(t,e={},s=!0){s||(e.edges=void 0);const n=tG(t,e.nodes,e.edges),i=eG(t,e.edges,sG(n));return{...e,nodes:n.concat(i.getExtremities()).dedupe(),edges:i}}var nG=16,z1="cubicOut",D1={duration:300,locate:!1},iG=new Set(["force"]),rG=class extends Ke{constructor(){super(...arguments),this.resolves=new Map,this._batchMode=!1,this._batchStarted=!1,this._batches=new Map,this._running=[],this._textsHidden=!1,this.onInteractionStart=()=>{this.setWorkersIdle(!0)},this.onViewChanged=()=>{this.setWorkersIdle(!1)},this.onVisibilityChange=()=>{ao().hidden?this.setWorkersIdle(!0):this.setWorkersIdle(!1)},this._onWorkerUpdate=(t,e,s,n,i)=>{const{duration:r,onSync:o,onUpdate:a,dryRun:l,locate:u}=n,h=i.workerMessage,g=i.isRunning;if(o&&this._modules.dom.setTimeout((()=>o(h,this._modules,g)),r),s){const f=s(h,this._modules,g);this._modules.events.fire("layoutComputed",{type:"layoutComputed",name:e,positions:f}),a&&a(h,f,g),this._assignNodePositions(f,r,l,n.easing).then((()=>{g||this._onWorkerComplete(t,f,h,this._layouts[e],n,t.getData())})),g||u&&f&&this._animateCamera(f,u,n.duration)}else g||t.fire("taskComplete",h)},this._onWorkerComplete=(t,e,s,n,i,r)=>{for(let f=0;f<this._running.length;f++)if(this._running[f]===t){this._running.splice(f,1);break}n.onStop&&e&&n.onStop(i,e,this._modules);const o=this._batchMode&&this._batchStarted&&this._batches.get(n.name);if(o){const f=this._batches.get(n.name),p=f.subGraphs,y=f.resolves;let _=0;for(let x=0;x<p.length;x++){const v=y[x],b=p[x].length,S=_,A=new Uint32Array(r.indexes.slice(_,_+b)),w=this._modules.graph.nodeList(A),L=i.dryRun&&e?e:this.collectNodesData(w),I=w.getId(),F={before:ld({...r,indexes:A},S),current:ld({...L,indexes:A},S)};this._modules.events.fire("layoutEnd",{type:"layoutEnd",name:n.name,positions:F,ids:I}),v({name:n.name,positions:F,ids:I}),_+=b}}const a=this._modules.graph.nodeList(new Uint32Array(r.indexes)),l=i.dryRun&&e?e:this.collectNodesData(a),u=a.getId(),h={before:ld(r),current:ld(l)};if(o||this._modules.events.fire("layoutEnd",{type:"layoutEnd",name:n.name,positions:h,ids:u}),i.onEnd&&i.onEnd(s),i.skipTextDrawing&&this._textsHidden&&(this._modules.graphics.showTexts(),this._textsHidden=!1),!this.resolves.has(t))throw new Error("Worker not found");const g=this.resolves.get(t);this.resolves.delete(t),g({name:n.name,positions:h,ids:u}),t.setBusy(!1)},this._onWorkerStart=(t,e,s)=>{e.skipTextDrawing&&!this._textsHidden&&(this._modules.graphics.hideTexts(),this._textsHidden=!0);const n=this._modules.graph.getNodes(e.nodes),i=this.collectNodesData(n),r=i.ids;s.setData(i),this._modules.events.fire("layoutStart",{type:"layoutStart",name:t.name,ids:r,worker:s})}}onMounted(){this._layouts={},this.timers=new Map,this.resolves=new Map,this._modules.events.register(["layoutGetData","layoutPrepare","layoutStart","layoutEnd","layoutComputed"]),this._modules.events.on("clearGraph",(()=>this.stop())).on(["dragStart","zoomStart"],this.onInteractionStart).on(["dragEnd","viewChanged"],this.onViewChanged),this._modules.dom.addDocumentEventListener("visibilitychange",this.onVisibilityChange)}setWorkersIdle(t){this._running.forEach((e=>e.setIdle(t)))}register(t){if(this._layouts[t.name])throw new Error(`Layout ${t.name} already exists`);this._layouts[t.name]=t}getAvailableLayouts(){return Object.keys(this._layouts)}enableBatching(){this._batchMode||(this._batches.clear(),this._batchMode=!0,this._batchStarted=!1)}runBatch(){const t=Array.from(this._batches.keys());return this._batchStarted=!0,Promise.all(t.map((e=>{const s=this._batches.get(e);return s.options.groups=s.subGraphs,this.start(e,s.options)}))).finally((()=>{this._batchStarted=!1,this._batches.clear(),this._batchMode=!1}))}_addToBatch(t,e,s){e.nodes.isList||(e.nodes=this._modules.graph.getNodes(e.nodes));const n=e.nodes.size;if(e.edges.isList||(e.edges=this._modules.graph.getEdges(e.edges)),!this._batches.has(t))return this._batches.set(t,{resolves:[s],subGraphs:[Array.from({length:n}).map(((o,a)=>a))],options:e});const i=this._batches.get(t);i.resolves.push(s);const r=i.options.nodes.size;i.options.nodes=i.options.nodes.concat(e.nodes),i.options.edges=i.options.edges.concat(e.edges),i.options.xs&&e.xs&&(i.options.xs=i.options.xs.concat(e.xs)),i.options.ys&&e.ys&&(i.options.ys=i.options.ys.concat(e.ys)),i.options.rs&&e.rs&&(i.options.rs=i.options.rs.concat(e.rs)),i.subGraphs.push(Array.from({length:n}).map(((o,a)=>a+r)))}start(t,e={}){const s=this._layouts[t];this._modules.events.fire("layoutPrepare",{name:t,params:e});const n=Yk(this._modules.graph,e,["radial","grid"].indexOf(t)===-1);return new Promise((i=>{if(!s)throw new Error(`layout ${t} does not exist`);if(this._batchMode&&!this._batchStarted&&iG.has(t))return this._addToBatch(t,n,i);n.duration=typeof n.duration=="number"?n.duration:D1.duration;const r=s.onSync;n.skipTextDrawing=n.skipTextDrawing===void 0?!0:!!n.skipTextDrawing;let o=n.locate||D1.locate;o&&typeof o=="boolean"&&(o={}),n.locate=o;const a={name:t,update:s.update,isRunning:s.isRunning,configure:s.configure,context:s.context,imports:s.imports,stop:s.stop,setIdle:s.setIdle};this._modules.graphics.forceAttributesComputation();const l=n.useWebWorker===void 0?!0:!!n.useWebWorker,u=this._modules.workers.create(a,l);this.resolves.set(u,i),u.on(Vk,(()=>{var h;(h=s.onStart)==null||h.call(s,e),this._onWorkerStart(s,n,u)})).on(jk,(h=>{this._modules.events.fire("layoutGetData",{name:t,data:h})})).on(ah,(h=>{const g=h.workerMessage,f=g.lastUpdate||-1/0,p=h.isRunning,y=$n();p&&(!n.continuous||y-f<nG)||(g.lastUpdate=y,this._onWorkerUpdate(u,t,r,n,h))})),this._modules.workers.start(u,n),this._running.push(u)}))}_animateCamera(t,e,s){if(t.indexes.length===0)return Promise.resolve();const n=this._modules.locate.layoutDataBoundingBox(t),i=this._modules.locate.computeConfigForBounds(n,e);return this._modules.camera.setView(i,{duration:s,easing:e.easing||z1,ignoreZoomLimits:!0})}stop(){for(;this._running.length!==0;){const t=this._running.pop();t.stop(),t.fire("taskComplete",null)}return Promise.resolve()}isRunning(){return this._running.length!==0}_assignNodePositions(t,e,s,n=z1){if(!t||s){const u=t?new Uint32Array(t.indexes):void 0,h=this._modules.graph.nodeList(u);return Promise.resolve(h)}const{indexes:i,x:r,y:o}=t,a=this._modules.graph.nodeList(new Uint32Array(i)),l=ld(t);for(let u=0;u<l.length;u++)l[u]={x:r[u],y:o[u]};return a.setAttributes(l,{duration:e,easing:n})}collectNodesData(t){const e=t._indexes,s=this._modules.graph.getNodeAttribute("x").getMultiple(e),n=this._modules.graph.getNodeAttribute("y").getMultiple(e);return{ids:t.getId(),indexes:e,x:s,y:n}}};function ld({x:t,y:e,indexes:s},n=0){const i=s.length,r=new Array(i);for(let o=0;o<i;o++)r[o]={x:t[o+n],y:e[o+n]};return r}function O1(t){return typeof t=="number"&&isNaN(t)}var B1=class{constructor(){this._keys=[],this._values=[]}set(t,e){const s=this._getIndex(t);return s===-1?(this._keys.push(t.slice()),this._values.push(e),!0):(this._values[s]=e,!1)}get(t){const e=this._getIndex(t);return e===-1?void 0:this._values[e]}has(t){return this._getIndex(t)!==-1}delete(t){const e=this._getIndex(t);return e!==-1&&(this._keys.splice(e,1),this._values.splice(e,1),!0)}keys(){return this._keys.map((t=>t.slice()))}values(){return this._values.slice()}_getIndex(t){for(let e=0;e<this._keys.length;e++){const s=this._keys[e];if(s.length===t.length){let n=!0;for(let i=0;i<t.length;i++){const r=s[i],o=t[i];if(!(r===o||O1(r)&&O1(o))){n=!1;break}}if(n)return e}}return-1}get size(){return this._keys.length}},oG=class{constructor(){this._map=new Map,this._arrays=new B1}clear(){return this._arrays=new B1,this._map.clear()}delete(t){return Fn(t)?this._arrays.delete(t):this._map.delete(t)}get(t){return Fn(t)?this._arrays.get(t):this._map.get(t)}set(t,e){return Fn(t)?this._arrays.set(t,e):this._map.set(t,e),this}keys(){return[...eC(this._map),...this._arrays.keys()]}values(){return[...sC(this._map),...this._arrays.values()]}get size(){return this._map.size+this._arrays.size}},aG=class{constructor(t,e,{path:s,filter:n,unwindArrays:i}){this._module=t,this._isNode=e,this._path=s||[],this._filter=n,this._unwindArrays=i,this._onUpdateHandlers=[],this._triggerUpdate=r=>{for(let o=0;o<this._onUpdateHandlers.length;++o)this._onUpdateHandlers[o](r)},this._info=t.watchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}onUpdate(t){this._onUpdateHandlers.push(t)}getPropertyInfo(){return this._info}getPath(){return this._path.slice()}destroy(){this._module.unwatchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}},lG=class{constructor(t,e,{path:s,filter:n,unwindArrays:i}){this._module=t,this._isNode=e,this._path=s,this._filter=n,this._unwindArrays=i,this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[]}get path(){return this._path}onPropertyAdded(t){return this._onAddHandlers.push(t),this}onPropertyRemoved(t){return this._onRemoveHandlers.push(t),this}onPropertyUpdated(t){return this._onUpdateHandlers.push(t),this}getPath(){return this._path.slice()}getProperties(){return this._propertyList.slice()}getPropertyInfo(t){const e=this._properties[t];return e?e.info:null}destroy(){kr(this._properties,(({handler:e},s)=>{const n=this._path.concat([s]);this._module.unwatchPropertyInformation(this._isNode,n,e,this._filter,this._unwindArrays)})),this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[];const t=this._module._objectPropertyWatchers.indexOf(this);this._module._objectPropertyWatchers.splice(t,1)}updateSubPropertiesToWatch(t,e){if(t!==this._isNode)return;const s=e.getData(this._path);for(let n=0;n<s.length;n++){const i=s[n];if(Ua(i)){const r=Object.keys(i);for(let o=0;o<r.length;o++)this._addSubPropertyToWatch(r[o])}}}_addSubPropertyToWatch(t){if(!this._properties[t]){const e=this._path.concat([t]),s=()=>this._triggerPropertyUpdate(t),n=this._unwindArrays,i=this._isNode,r=this._filter,o=this._module.watchPropertyInformation(i,e,s,r,n);this._properties[t]={handler:s,info:o},this._triggerPropertyUpdate(t)}}_triggerPropertyUpdate(t){const{info:e}=this._properties[t],s=this._propertyList.indexOf(t),n=s!==-1,i=e.getType()!=="undefined";!n&&i?(this._propertyList.push(t),this._triggerHandlers("_onAddHandlers",t,e),this._triggerHandlers("_onUpdateHandlers",t,e)):n&&!i?(this._propertyList.splice(s,1),this._triggerHandlers("_onUpdateHandlers",t,e),this._triggerHandlers("_onRemoveHandlers",t,e)):n&&i&&this._triggerHandlers("_onUpdateHandlers",t,e)}_triggerHandlers(t,e,s){const n=this[t];for(let i=0,r=n.length;i<r;i++)n[i](e,s)}},uG=class{constructor(){}setWatcher(t){this._watcher=t}isNode(){return this._watcher.isNode}getPath(){return this._watcher.property.slice()}getBoundaries(){const t=this._watcher.boundaries;return t?{min:t.min,max:t.max}:null}getValues(){return this._watcher.values.keys()}getValueCount(t){return this._watcher.values.get(t)||0}getCount(){return this._watcher.total}getType(){return this._watcher.any>0?"any":this._watcher.numbers>0?"number":"undefined"}},dG=class extends Ke{constructor(){super(...arguments),this._onExcludedStateChange=({elements:t,value:e})=>{const s=!e;for(let n=0,i=this._propertyWatchers.length;n<i;n++){const r=this._propertyWatchers[n];r.isNode===t.isNode&&r.filter==="visible"&&(s?Td(r,t.getData(r.property)):qg(r,t.getData(r.property)),yg(r))}},this._onDataChange=({isNode:t,changes:e})=>{for(let s=0;s<this._propertyWatchers.length;++s){const n=this._propertyWatchers[s],i=n.property,r=n.filter==="all";if(n.isNode===t)for(let o=0;o<e.length;++o){const a=e[o],l=gG(a.property||[],i);if(l){const u=a.nodes||a.edges,h=[],g=[];if(u)for(let f=0;f<u.size;++f){const p=u.get(f);(r||p.isVisible())&&(h.push(qs(a.newValues[f],l)),g.push(qs(a.previousValues[f],l)))}h.length&&(Td(n,h),qg(n,g),yg(n))}}}for(let s=0,n=this._objectPropertyWatchers.length;s<n;s++){const i=this._objectPropertyWatchers[s],r=i.path;for(let o=0;o<e.length;++o){const{property:a,nodes:l,edges:u}=e[o],h=l||u;if(h){const g=h.isNode;(!a||a.length<=r.length+1&&r.every(((f,p)=>f===a[p])))&&i.updateSubPropertiesToWatch(g,h)}}}},this._onElementsAdded=t=>{const e=t.nodes||t.edges;for(let s=0;s<this._propertyWatchers.length;++s){const n=this._propertyWatchers[s];if(n.isNode===e.isNode){const i=e.getData(n.property);i.length&&(Td(n,i),yg(n))}}for(let s=0;s<this._objectPropertyWatchers.length;s++)this._objectPropertyWatchers[s].updateSubPropertiesToWatch(e.isNode,e)},this._onElementsRemoved=t=>{const e=t.nodes||t.edges;for(let s=0;s<this._propertyWatchers.length;++s){const n=this._propertyWatchers[s],i=n.filter==="all";if(n.isNode===e.isNode&&i){const r=e.getData(n.property);r.length&&(qg(n,r),yg(n))}}},this._onGraphClear=()=>{this._propertyWatchers.forEach((t=>{t.numbers=0,t.any=0,t.total=0,t.boundaries=null,t.values.clear()}))}}onMounted(){this._propertyWatchers=[],this._objectPropertyWatchers=[],this._modules.events.on("excludedStateChange",this._onExcludedStateChange).on(["updateNodeData","updateEdgeData"],this._onDataChange).on(["addNodes","addEdges"],this._onElementsAdded).on(["removeNodes","removeEdges"],this._onElementsRemoved).on("clearGraph",this._onGraphClear)}watchNodeObjectProperty(t){return this._watchObjectProperty(!0,xg(t))}watchEdgeObjectProperty(t){return this._watchObjectProperty(!1,xg(t))}watchNodeNonObjectProperty(t){return this._watchNonObjectProperty(!0,xg(t))}watchEdgeNonObjectProperty(t){return this._watchNonObjectProperty(!1,xg(t))}watchPropertyInformation(t,e,s,n,i){const r=this._findWatcher(t,e,n,i)||this._createWatcher(t,e,n,i);return s&&r.onChange.push(s),r.info}unwatchPropertyInformation(t,e,s,n,i){const r=this._findWatcher(t,e,n,i);if(!r)return;const o=r.onChange,a=o.indexOf(s);if(a!==-1&&(o.splice(a,1),o.length===0)){const l=this._propertyWatchers.indexOf(r);this._propertyWatchers.splice(l,1)}}_watchObjectProperty(t,e){const s=new lG(this,t,e);return this._objectPropertyWatchers.push(s),s.updateSubPropertiesToWatch(t,this._modules.graph[t?"getNodes":"getEdges"](e.filter)),s}_watchNonObjectProperty(t,e){return new aG(this,t,e)}_findWatcher(t,e,s,n){for(let i=0;i<this._propertyWatchers.length;++i){const r=this._propertyWatchers[i];if(r.isNode===t&&r.filter===s&&r.unwindArrays===n&&cG(r.property,e))return r}return null}_createWatcher(t,e,s,n){const i={isNode:t,property:e,numbers:0,any:0,total:0,values:new oG,boundaries:null,onChange:[],filter:s,unwindArrays:n,info:new uG};return i.info.setWatcher(i),Td(i,this._modules.graph[t?"getNodes":"getEdges"](s).getData(e)),this._propertyWatchers.push(i),i}};function U1(t){return t==null?[]:Ba(t)}function hG(t){return t==="all"?"all":"visible"}function yg(t){for(let e=0;e<t.onChange.length;++e)t.onChange[e](t.info)}function cG(t,e){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(t[s]!==e[s])return!1;return!0}function gG(t,e){if(t.length>e.length)return null;let s=0;for(;s<t.length;++s)if(t[s]!==e[s])return null;return e.slice(s)}function Td(t,e,s){const n=t.values,i=!s&&t.unwindArrays;for(let r=0;r<e.length;++r){const o=e[r];if(s||o===void 0||(t.total+=1),i&&Array.isArray(o))Td(t,o,!0);else{const a=n.get(o);a?n.set(o,a+1):(n.set(o,1),Jf(o)?(t.boundaries?o<t.boundaries.min?t.boundaries.min=o:o>t.boundaries.max&&(t.boundaries.max=o):t.boundaries={min:o,max:o},t.numbers+=1):o!==void 0&&(t.any+=1))}}}function qg(t,e,s){const n=t.values,i=!s&&t.unwindArrays,r=t.boundaries;let o=!1;for(let a=0;a<e.length;++a){const l=e[a];if(s||l===void 0||(t.total-=1),i&&Array.isArray(l))o=o||qg(t,l,!0);else{const u=n.get(l);u>1?n.set(l,u-1):(n.delete(l),Jf(l)?(t.numbers-=1,!r||r.min!==l&&r.max!==l||(o=!0)):l!==void 0&&(t.any-=1))}}return!s&&o&&(t.boundaries=fG(n.keys())),o}function fG(t){let e=null,s=null;for(let n=0;n<t.length;++n){const i=t[n];Jf(i)&&((e==null||i<e)&&(e=i),(s==null||i>s)&&(s=i))}return e==null||s==null?null:{min:e,max:s}}function xg(t){return typeof t!="object"||t===null||Array.isArray(t)?{path:U1(t),filter:"visible",unwindArrays:!1}:{path:U1(t.path),filter:hG(t.filter||"visible"),unwindArrays:!!t.unwindArrays}}var pG=class extends Ke{onMounted(){this._modules.events.register(["virtualDown","virtualUp","virtualMove","virtualClick","virtualDoubleClick","virtualWheel"])}get x(){return this._modules.position.x||0}get y(){return this._modules.position.y||0}_later(){return this._modules.dom.afterNextFrame()}move({x:t,y:e}){if(t!==void 0&&e!==void 0){const s=t-this.x,n=e-this.y;this._modules.events.fire("virtualMove",{x:t,y:e,dx:s,dy:n})}return Promise.resolve()}down({x:t,y:e,button:s="left"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualDown",{x:this.x,y:this.y,button:s}),this._modules.events.fire("virtualMove",{x:this.x,y:this.y,dx:0,dy:0,button:s})}))}up({x:t,y:e,button:s="left"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualUp",{x:t,y:e,button:s})}))}click({x:t,y:e,button:s="left"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualClick",{x:t,y:e,button:s})}))}rightClick({x:t,y:e,button:s="right"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualClick",{x:t,y:e,button:s})}))}doubleclick({x:t,y:e,button:s="left"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualDoubleClick",{x:t,y:e,button:s})}))}drag(t,e){return this.down(t).then((()=>this.move(e))).then((()=>this.up(e)))}wheel({x:t,y:e,dx:s,dy:n,delta:i,metaKey:r,ctrlKey:o}){return this.move({x:t,y:e}).then((()=>(this._modules.events.fire("virtualWheel",{x:t,y:e,dx:s,dy:n,delta:i,domEvent:{metaKey:r,ctrlKey:o}}),this._later())))}};function Bi(t,e,s,n,i,r){const o=vi(),a=r.graphToScreenCoordinates(t),l=r.graphToScreenCoordinates(e);i.beginPath(),i.moveTo(a.x*o,a.y*o),i.lineTo(l.x*o,l.y*o),i.strokeStyle=n,i.lineWidth=s,i.stroke()}function G1(t,e,s,n){let i,r,o,a=0,l=t.length-1;for(;a<l&&a>-1;)if(i=(a+l)/2|0,r=Math.abs(e[t[i]]-s),o=Math.abs(e[t[i+1]]-s),o<r)a=i+1;else if(o>r)l=i;else{const u=Math.abs(e[t[a]]-s),h=Math.abs(e[t[l]]-s);if(u<h)l=i;else{if(!(u>h))return l;a=i+1}}return n?l:t[l]}function V1(t,e,s,n,i,r,o){let a,l,u,h,g,f;for(let p=0,y=t.length;p<y;p++)for(let _=0;_<y;_++){if(p===_)continue;let x=t[p],v=t[_];_<p&&(h=v,v=x,x=h);const b=e[x],S=e[v],A=r.get(x),w=r.get(v);if(b+A<n-i&&S-w>n+i&&Math.abs(Math.abs(b+A-(n-i))-Math.abs(S-w-(n+i)))<=o)return a=x,l=s,u=v,f=b+A+Math.abs(S-w-(b+A))/2,g=[b+A,f-i,f+i,S-w],{a,b:l,c:u,current:s,target:f,points:g};if(b+A<n-i&&S+w<n-i&&Math.abs(Math.abs(b+A-(S-w))-Math.abs(Math.max(b+A,S+w)-(n-i)))<=o)return a=x,l=v,u=s,f=S+A+Math.abs(Math.abs(b+A-(S-w)))+i,g=[b+A,S-w,S+w,f-i],{a,b:l,c:u,current:s,target:f,points:g};if(b-A>n+i&&S-w>n+i&&Math.abs(Math.abs(b+A-(S-w))-Math.abs(Math.min(b-A,S-w)-(n+i)))<=o)return a=s,l=x,u=v,f=b-A-Math.abs(Math.abs(b+A-(S-w)))-i,g=[f+i,b-A,b+A,S-w],{a,b:l,c:u,current:s,target:f,points:g}}return null}var m_={enabled:!1,tolerance:5,centerSnapDistance:240,sideSnapDistanceFactor:3,guidelineWidth:1,guidelineColor:"#ff0000",preferredDistance:{enabled:!0,ratio:1.13,tolerance:10,lineColor:"#00C3FF",lineWidth:1},neighbours:{enabled:!0,offset:5,tolerance:3,lineColor:"#00C3FF",lineWidth:1}},mG=class extends Ke{constructor(){super(...arguments),this._options=Xs(m_),this._enabled=!1,this._ysnap=0,this._xsnap=0,this._node=null,this._nodes=null,this._r=0,this._vguideline={start:{x:0,y:0},end:{x:0,y:0}},this._hguideline={start:{x:0,y:0},end:{x:0,y:0}},this._gridResolution=0,this._onNodeDragStart=({nodes:t})=>{t.size===1&&(this._node=t.get(0),this._cacheViewportData(),this._r=Number(this._node.getAttribute("radius")))},this._onNodeDragEnd=()=>{this._node=null,this._layer.refresh()}}onMounted(){this._options=Xs(m_),this._enabled=!1}enable(t){this._enabled||(this._options=Ni(t,m_),this._enabled=!0,this._layer=this._modules.layers.addCanvasLayer((e=>{e.clearRect(0,0,e.canvas.width,e.canvas.height)}),{isStatic:!0,noClear:!1}),this._layer.moveToTop(),this._modules.events.on("nodesDragStart",this._onNodeDragStart).on("nodesDragEnd",this._onNodeDragEnd),this._modules.settings.update({"interactions.drag.onBeforeDrag":(e,s,n,i)=>this._onBeforeDrag(s,n,i)}))}disable(){this._enabled&&(this._modules.events.off(this._onNodeDragStart).off(this._onNodeDragEnd),this._layer.destroy(),this._modules.settings.update({"interactions.drag.onBeforeDrag":null}),this._enabled=!1)}enabled(){return this._enabled}_onBeforeDrag(t,e,s){if(this._node){const n=s[0];this._layer.refresh((i=>{this._scan(i,n)})),this._node.setAttributes(n)}}_cacheViewportData(){const t=this._modules.camera,e=t.screenToGraphCoordinates({x:0,y:0}),s=t.screenToGraphCoordinates({x:t.width,y:t.height});if(this._nodes=this._modules.spatial.getNodesByBoundingBox(e.x,e.y,s.x,s.y),this._node==null)return;const n=this._node._index,i=Array.from(this._nodes._indexes);i.splice(i.indexOf(n),1);const r=this._modules.graph.getNodeAttribute("radius"),o=this._modules.graph.getNodeAttribute("x"),a=this._modules.graph.getNodeAttribute("y"),l=o.buffer(),u=a.buffer(),h=fd(i.slice(),o),g=fd(i.slice(),a),f={},p={};this._gridResolution=Number(this._node.getAttribute("radius"));const y=this._gridResolution;for(let _=0,x=i.length;_<x;_++){const v=h[_],b=g[_],S=l[v]/y|0,A=u[b]/y|0;f[S]||(f[S]=[]),p[A]||(p[A]=[]),f[S].push(v),p[A].push(b)}this._nodesByX=h,this._nodesByY=g,this._xGrid=f,this._yGrid=p,this._xList=o,this._yList=a,this._X=l,this._Y=u,this._R=r}_scan(t,e){if(this._node==null)return;const s=this._node._index,n=e.x,i=e.y,r=this._r,o=this._options,a=this._xList,l=this._yList,u=this._R,h=this._X,g=this._Y,f=this._modules.camera.zoom,p=Math.min(r,this._options.tolerance/f),y=2*r*o.sideSnapDistanceFactor,_=o.guidelineWidth,x=o.guidelineColor;let v,b,S,A,w,L,I,F,O=s,V=s,j=null,Z=!1,at=!1;if(O=G1(this._nodesByX,h,n),V=G1(this._nodesByY,g,i),Math.abs(h[O]-n)>o.centerSnapDistance&&(O=s),Math.abs(g[V]-i)>o.centerSnapDistance&&(V=s),this._xsnap=0,O!==s){v=this._vguideline.start,b=this._vguideline.end,F=O,S=h[F],A=g[F],j=u.get(F),I=Math.abs(n-S);const pt=Math.abs(n-r-(S-j)),K=Math.abs(n+r-(S+j));if(I<Math.max(r,j)){A<i?(v.y=A-j,b.y=i+r):(v.y=A+j,b.y=i-r);const ut=Math.min(pt,I,K);ut===I?(v.x=b.x=S,b.y=i,v.y=A,this._xsnap=1):Math.abs(i-A)<j+r+y&&(ut===pt?(v.x=b.x=S-j,this._xsnap=2):(v.x=b.x=S+j,this._xsnap=3)),ut<p&&(Z=!0)}this._xsnap!==0&&Bi(v,b,_,x,t,this._modules.camera)}if(this._ysnap=0,V!==s){v=this._hguideline.start,b=this._hguideline.end,F=V,S=h[F],A=g[F],j=u.get(F),I=Math.abs(i-A);const pt=Math.abs(i-r-(A-j)),K=Math.abs(i+r-(A+j));if(I<Math.max(r,j)){S<n?(v.x=S-j,b.x=n+r):(v.x=S+j,b.x=n-r);const ut=Math.min(pt,I,K);ut===I?(v.y=b.y=A,b.x=n,v.x=S,this._ysnap=1):Math.abs(n-S)<j+r+y&&(ut===pt?(v.y=b.y=A-j,this._ysnap=4):(v.y=b.y=A+j,this._ysnap=5)),ut<p&&(at=!0)}this._ysnap!==0&&Bi(v,b,_,x,t,this._modules.camera)}if(j!=null&&o.preferredDistance.enabled){const pt=o.preferredDistance.ratio,K=Math.min(o.preferredDistance.tolerance/f,r),ut=Math.max(r,j);if(O===s||this._xsnap!==0&&Z){if(V!==s&&(this._ysnap===0||!at)&&(F=V,S=h[F],A=g[F],j=u.get(F),L=Math.abs(i-A)-(r+j)*(1+pt),L<=K&&L>=-K)){const ht=i<A?-1:1;v=this._hguideline.start,b=this._hguideline.end,v.x=S-ut,b.x=S+ut,v.y=b.y=A,Bi(v,b,_,x,t,this._modules.camera),v.x=n-ut,b.x=n+ut,v.y=b.y=A+ht*(1+pt)*(r+j),Bi(v,b,_,x,t,this._modules.camera),this._ysnap=1,at=!0}}else if(F=O,S=h[F],A=g[F],j=u.get(F),w=Math.abs(n-S)-(r+j)*(1+pt),w<=K&&w>=-K){const ht=n<S?-1:1;v=this._vguideline.start,b=this._vguideline.end,v.x=b.x=S+ht*(1+pt)*(r+j),v.y=A-ut,b.y=A+ut,v.x=b.x=S,Bi(v,b,_,x,t,this._modules.camera),v.y=i-ut,b.y=i+ut,v.x=b.x=S+ht*(1+pt)*(r+j),Bi(v,b,_,x,t,this._modules.camera),this._xsnap=1,Z=!0}}if(o.neighbours.enabled){const pt=this._gridResolution,K=n/pt|0,ut=i/pt|0,ht=this._xGrid,nt=this._yGrid,ot=[],Nt=[].concat(nt[ut-1]||ot,nt[ut]||ot,nt[ut+1]||ot),Q=[].concat(ht[K-1]||ot,ht[K]||ot,ht[K+1]||ot);let Et;Nt.length>1&&(fd(Nt,a),Et=V1(Nt,h,s,n,r,u,p),Et&&(this._drawNeighbourGuidelines(t,Et,e,!1),Z=!1)),Q.length>1&&!Et&&(fd(Q,l),Et=V1(Q,g,s,i,r,u,p),Et&&(this._drawNeighbourGuidelines(t,Et,e,!0),at=!1))}(Z||at)&&this._snap(e,!Z,!at)}_drawNeighbourGuidelines(t,{a:e,b:s,c:n,points:i,target:r},o,a){const l={x:0,y:0},u={x:0,y:0},h=this._R,g=this._X,f=this._Y;let[p,y,_]=h.getMultiple([e,s,n]);const{offset:x,lineWidth:v,lineColor:b}=this._options.neighbours;let S,A;a?(o.y=r,p=-p,y=-y,_=-_,S=u.x=l.x=Math.min(g[e]+p,g[s]+y,g[n]+_)-x,A=g):(o.x=r,S=u.y=l.y=Math.max(f[e]+p,f[s]+y,f[n]+_)+x,A=f);const w=a?"y":"x",L=a?"x":"y";l[w]=i[0],u[w]=i[1],Bi(l,u,v,b,t,this._modules.camera),l[w]=i[2],u[w]=i[3],Bi(l,u,v,b,t,this._modules.camera),l[w]=i[0],l[L]=S-x/2,u[w]=i[0],l[L]=A[e]+p,Bi(l,u,v,b,t,this._modules.camera),l[w]=i[1],l[L]=S-x/2,u[w]=i[1],l[L]=A[s]+y,Bi(l,u,v,b,t,this._modules.camera),l[w]=i[2],l[L]=S-x/2,u[w]=i[2],l[L]=A[s]+y,Bi(l,u,v,b,t,this._modules.camera),l[w]=i[3],l[L]=S-x/2,u[w]=i[3],l[L]=A[n]+_,Bi(l,u,v,b,t,this._modules.camera)}_snap(t,e,s){const n=this._xsnap,i=this._ysnap;let r;e||n===0||(r=this._vguideline.end,t.x=n===2?r.x+this._r:n===3?r.x-this._r:r.x),s||i===0||(r=this._hguideline.end,t.y=i===4?r.y+this._r:i===5?r.y-this._r:r.y)}},_G=class{constructor(t,e,s){this._module=t,this._id=e,this._whenApplied=s.then((()=>this))}getId(){return this._id}whenApplied(){return this._whenApplied}refresh(){return this._module.refreshRule(this._id)}getIndex(){return this._module.getRuleIndex(this._id)}setIndex(t){return this._module.setRuleIndex(this._id,t)}update(t){return this._module.updateRule(this._id,t)}getDefinition(){return this._module.getRuleDefinition(this._id)}destroy(){return this._module.destroyRule(this._id)}},yG=1e3,xG=1/yG,vG=class extends Ke{constructor(){super(...arguments),this._idCounter=1,this._rules=[]}onMounted(){this._rules=[],this._modules.events.register(["addStyleRule","removeStyleRule","updateStyleRule","refreshStyleRule"])}_get(t){for(let e=0;e<this._rules.length;++e){const s=this._rules[e];if(s.id===t)return s.index=e,s}throw new Error("calling a method on a destroyed style rule")}_updatePriorities(){for(let t=0;t<this._rules.length;++t){const e=this._rules[t],s=Uz+t*xG;e.attributeLayer.update({priority:s})}}addRule(t={}){const e=this._idCounter++,s=this._modules.graphics.addAttributeLayer({name:`rule(${e})`,...j1(t)}),n=this._modules.dom.afterNextFrame(),i=new _G(this,e,n),r={id:e,attributeLayer:s,wrapper:i};return this._rules.push(r),this._updatePriorities(),this._modules.events.fire("addStyleRule",{rule:r,options:t,id:r.id}),i}getRuleIndex(t){const e=this._get(t);return e.index==null?null:e.index}setRuleIndex(t,e){const s=this._get(t),n=qi(e,0,this._rules.length-1);return this._rules.splice(s.index,1),this._rules.splice(n,0,s),this._updatePriorities(),this._modules.dom.afterNextFrame()}updateRule(t,e){const s=this._get(t),n=Object.assign({fullOverwrite:e.fullOverwrite},e);return s.attributeLayer.update(n),this._modules.events.fire("updateStyleRule",{rule:s,options:e}),this._modules.dom.afterNextFrame()}getRuleDefinition(t){return j1(this._get(t).attributeLayer.getDefinition())}destroyRule(t){const e=this._get(t);return this._modules.events.fire("removeStyleRule",{rule:e,id:e.id}),e.attributeLayer.destroy(),this._rules.splice(e.index,1),this._modules.dom.afterNextFrame()}refreshRule(t){const e=this._get(t);return e.attributeLayer.updateAll(),this._modules.events.fire("refreshStyleRule",{rule:e,id:t}),this._modules.dom.afterNextFrame()}refreshAllRules(){for(const t of this._rules)t.attributeLayer.updateAll(),this._modules.events.fire("refreshStyleRule",{rule:t,id:t.id});return this._modules.dom.afterNextFrame()}getRuleList(){return this._rules.map((t=>t.wrapper))}};function j1(t){return{nodeAttributes:t.nodeAttributes,edgeAttributes:t.edgeAttributes,nodeSelector:t.nodeSelector,edgeSelector:t.edgeSelector,nodeDependencies:t.nodeDependencies,edgeDependencies:t.edgeDependencies,nodeOutput:t.nodeOutput,edgeOutput:t.edgeOutput}}var Ky,H1={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:({nodes:t})=>t.setSelected(!0),bothExtremities:!1},Wk=class extends Ke{constructor(){super(...arguments),this._enabled=!1,this._points=[],this._bbox=new ri,this._onStart=({x:t,y:e})=>{this._bbox.reset(),this.savePoint(t,e,!1)},this._onStop=()=>{const{minX:t,minY:e,maxX:s,maxY:n}=this._bbox,{nodes:i,edges:r}=this._modules.spatial.queryProjected(t,e,s,n),o={},a=i.filter((h=>{const g=h.isVisible(),f=h.getAttribute("detectable"),p=g&&f&&this._modules.locate.isNodeInPolygon(h,this._points);return o[h._index]=p,p}));let l=r.filter((h=>{const g=h.isVisible(),f=h.getAttribute("detectable");return g&&f&&this._modules.locate.isEdgeInPolygon(h,this._points)}));this._options.bothExtremities&&(l=this.filterByExtremities(l,o)),this._layer.clear();const u=this._points.slice();this._points=[],this.disable(),this._options.callback({nodes:a,edges:l,points:u})}}onMounted(){this._options=Xs(H1),this._cachedCursor="",this._modules.events.isRegistered("lassoEnabled")||this._modules.events.register(["lassoEnabled","lassoDisabled"]),this._interaction=this._modules.interactions.onDrag({priority:"lasso",check:()=>this._enabled,onStart:this._onStart,onProgress:({x:t,y:e})=>this.savePoint(t,e,!0),onStop:this._onStop})}enable(t={}){var e;return this._enabled||(this._enabled=!0,this._modules.captor.setDetectionEnabled(!1),this._options=Ni(t,H1),this._layer=this._modules.layers.addCanvasLayer(as,{isStatic:!0,noClear:!1}),this._layer.moveToTop(),this._cachedCursor=((e=this._layer.element.parentElement)==null?void 0:e.style.cursor)||"",uf(this._layer.element.parentElement,this._options.cursorStyle),this._modules.captor.isLeftPressed()&&this._interaction.start(this._modules.captor.getCursorPosition()),this._modules.events.fire("lassoEnabled")),this}disable(){return this._enabled?(this._enabled=!1,this._modules.captor.setDetectionEnabled(!0),uf(this._layer.element.parentElement,this._cachedCursor),this._layer.destroy(),this._modules.events.fire("lassoDisabled"),this):this}enabled(){return this._enabled}savePoint(t,e,s){const n=vi(),i=this._options,r=this._points;if(this._bbox.addPoint(t,e),r.push({x:t,y:e}),s){const o=r[0];this._layer.refresh((a=>{a.lineWidth=i.strokeWidth,a.lineJoin="bevel",a.strokeStyle=i.strokeColor,a.fillStyle=i.fillColor,a.beginPath(),a.moveTo(o.x*n,o.y*n);for(let l=1;l<r.length;++l){const u=r[l];a.lineTo(u.x*n,u.y*n)}a.stroke(),i.fillColor&&a.fill()}))}}filterByExtremities(t,e){const s=this._modules.graph.getEdgeAttribute("source"),n=this._modules.graph.getEdgeAttribute("target");return t.filter((i=>{const r=i._index,o=s.get(r),a=n.get(r);return e[o]&&e[a]}))}},$1={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:({nodes:t,edges:e})=>{t.size?t.setSelected(!0):e.setSelected(!0)},bothExtremities:!1},bG=class extends Wk{constructor(){super(...arguments),this._onStart=({x:t,y:e})=>{var s;this._rectangle.reset(),this._start={x:t,y:e},(s=this._layer)==null||s.refresh((n=>{n.fillStyle=this._options.fillColor,n.strokeStyle=this._options.strokeColor,n.lineWidth=this._options.strokeWidth}))},this._onStop=()=>{var a;const t=this._modules.captor.getCursorPosition(),e=this._formatRectangle(t),{nodes:s,edges:n}=this._modules.spatial.queryProjected(e.minX,e.minY,e.maxX,e.maxY),i={},r=s.filter((l=>{const u=l.isVisible(),h=l.getAttribute("detectable"),g=u&&h&&this._modules.locate.isNodeInRectangle(l,e);return i[l._index]=g,g}));let o=n.filter((l=>{const u=l.isVisible(),h=l.getAttribute("detectable");return u&&h&&this._modules.locate.isEdgeInRectangle(l,e)}));this._options.bothExtremities&&(o=this.filterByExtremities(o,i)),(a=this._layer)==null||a.clear(),this.disable(),this._options.callback({nodes:r,edges:o,rectangle:{minX:e.minX,minY:e.minY,maxX:e.maxX,maxY:e.maxY,width:e.width,height:e.height,cx:e.cx,cy:e.cy}})}}onMounted(){this._options=Xs($1),this._enabled=!1,this._rectangle=new ri,this._interaction=this._modules.interactions.onDrag({priority:"lasso",disableDetection:!0,check:()=>this._enabled,onStart:this._onStart,onProgress:({x:t,y:e})=>this._refreshRectangle({x:t,y:e}),onStop:this._onStop})}enable(t){return super.enable(Ni(t,$1))}_formatRectangle(t){const e=this._start.x,s=this._start.y,n=t.x,i=t.y,r=Math.abs(e-n),o=Math.abs(s-i),a=e<n?e:n,l=s<i?s:i;return this._rectangle.reset().addPoint(a,l).addPoint(a+r,l+o)}_refreshRectangle(t){var o;const{minX:e,minY:s,width:n,height:i}=this._formatRectangle(t),r=vi();(o=this._layer)==null||o.refresh((a=>{a.strokeRect(e*r,s*r,n*r,i*r),this._options.fillColor&&a.fillRect(e*r,s*r,n*r,i*r)}))}},EG=iT(rT()),wr=6,Xk=5,Gd=1,Zk=0,Kk=0,Qy=-1;function Qk(t,e,s,n){Zk=t,Ky=s,Kk=e?1:0,Qy=n}var q1=(t,e,s,n)=>i=>{const{rects:r,bboxes:o,intersects:a,indexToLayer:l,indexToRemoveNodeText:u,indexToRemoveEdgeText:h}=n;if(o[i*wr+5]===Zk&&o[i*wr+4]===s)return!1;const g=i*Xk,f=Nh(r[g],r[g+1],r[g+2],r[g+3],r[g+4]);if(rL(Ky,f)){if(n.realIntersection=!0,Qy<=0&&a.push(Ky,f),!(l[o[i*wr+5]]<Qy))return!0;t.remove(i),n.realIntersection=!1,o[i*wr+4]===Kk?u[o[i*wr+5]]=!0:h[o[i*wr+5]]=!0}return!1};function Y1(t,e,s="#22ff00"){return Jy([[t[0],t[1]],[t[2],t[1]],[t[2],t[3]],[t[0],t[3]]].map((n=>({x:n[0],y:n[1]}))),e,s)}function Jy(t,e,s="#ff0000"){e.strokeStyle=s,e.beginPath();for(let n=0,i=t.length;n<i;n++)n===0?e.moveTo(t[n].x,t[n].y):e.lineTo(t[n].x,t[n].y);e.closePath(),e.stroke()}function SG(t,e,s,n,i){for(let a=0,l=e.length;a<l;a+=wr)Y1(e.slice(a,a+4),t,"#aaaaaa");for(let a=0;a<s.length;a+=Xk)Jy(Nh(s[a],s[a+1],s[a+2],s[a+3],s[a+4]),t,"green");const r=[i.root];let o=i.root;for(;o=r.pop();)o.leaf||r.push.apply(r,o.children),Y1(i.getNodeBounds(o),t,"rgba(0,0,0,0.2)"),o=r.pop();n.forEach((a=>Jy(a,t,"red")))}var ud={x1:0,y1:0,x2:0,y2:0},__={x:0,y:0},Il={x:0,y:0},AG=Math.PI/2,wG=0;function TG(t,e,s,n,i,r,o,a,l,u,h){const g=a.remove.nodes,f=a.remove.edges,p=a.redraw.edges,y=s.angle,_=s.zoom,x=i.x,v=i.y,b=i.radius,S=Math.PI,{source:A,target:w,scalingMethod:L}=n,I=n.width,F=n.curvature,O=n.layer,V=n.text.content,j=n.text.scaling,Z=n.text.size,at=n.text.font,pt=n.text.style,K=n.text.scale,ut=n.text.maxLineLength,ht=n.text.margin,nt=n.text.minVisibleSize,ot=n.text.padding,Nt=n.animationDuration,Q=n.text.adjustAngle,Et=n.text.position;a.indexToLayer={},a.indexToQuadIndex={},a.indexToRemoveNodeText={},a.indexToRemoveEdgeText={},a.indexToRedrawEdgeText={},a.byLayer=[];const{byLayer:Xt,indexToLayer:Ht,indexToQuadIndex:Zt,indexToRedrawEdgeText:ae,indexToRemoveNodeText:pe,indexToRemoveEdgeText:ne}=a;for(let ge=0;ge<t.length;ge++){const ze=t[ge],is=O.get(ze)-Y2;for(let Ge=1;Ge<=is;Ge++)(Xt[Ge]=Xt[Ge]||[]).push(ze);Ht[ze]=is}if(l!==null){const ge=Xt.length;for(let ze=Ht[l]+1;ze<=ge;ze++)(Xt[ze]=Xt[ze]||[]).unshift(l);Ht[l]=ge}const te=[0,0,0,0],se=[0,0,0,0,0],{bboxes:ce,rects:Ce}=a,ve=(ge,ze=-1)=>{const is=Nt.get(ge);let Ge=V?V.get(ge):"";if(Ge===null||Ge===""||is)return!1;const De=A.get(ge),He=w.get(ge);let Je=I.get(ge);const ss=F.get(ge),ts=nt.get(ge);if(Je*_<ts)return ne[ge]=!0,!1;L.get(ge)==="fixed"&&(Je/=_);let hs=(x.get(De)+x.get(He))/2,Fe=(v.get(De)+v.get(He))/2;Ge=Ge?Ge.toString():"";const Oe=!j.get(ge),Cs=K.get(ge)*(Oe?1:_),Fs=at.get(ge),Hs=(Oe?Z.get(ge):Cs*Je)*Gd,Ls=pt.get(ge),Sn=ut.get(ge),gn=Et.get(ge)===Ch;let ln=+gn*ht.get(ge)+n.text.padding.get(ge);const xs=x.get(De),Ps=v.get(De),gt=x.get(He),N=v.get(He),P=b.get(De),D=b.get(He);if(ss===0){const Ut=cu(xs,Ps,gt,N)-y,he=P-D;hs+=he*Math.cos(Ut)/2,Fe+=he*Math.sin(Ut)/2}let B;const $=De===He;if($)B=S/4-y,sp(xs,Ps,ss,P,0,ud),eh(.5,xs,Ps,gt,N,ud.x1,ud.y1,ud.x2,ud.y2,Il),hs=Il.x,Fe=Il.y,ln/=-_;else{if(xs===gt&&Ps===N)return!1;B=cu(xs,Ps,gt,N)-y,ss!==0&&(Ya(xs,Ps,gt,N,ss,__),ip(.5,xs,Ps,gt,N,__.x,__.y,Il),hs=Il.x,Fe=Il.y)}const H=ln+wG,X=vC(Ge,Sn);if(!X)return!1;const{lines:lt,data:dt}=X;let ct=r(dt[0],Fs,Ls,Hs).width*Gd;for(let Ut=1;Ut<lt;Ut++)ct=Math.max(ct,r(dt[Ut],Fs,Ls,Hs).width*Gd);const mt=lt*Hs,yt=ct/_/2,kt=mt/_/2,Tt=Math.abs(df(B))<AG?1:-1;let At=gn?$?mt/_+Je/2+ln:Tt*(H/_+Je/2+kt):0;if(!$&&ss===0&&Q.get(ge)){const Ut=ot.get(ge);_n(xs,Ps,gt,N)*_-(P+D)*(h?1:_)<ct+2*Ut+1&&(At*=Tt,B=0)}if(se[0]=hs-yt,se[1]=Fe-kt,se[2]=hs+yt,se[3]=Fe+kt,se[4]=B+y,Zy(se,-(B+y),-At,se),se[2]=se[2]-se[0],se[3]=se[3]-se[1],B=S-B-y,up(hs-yt,Fe-kt,2*yt,2*kt,B,void 0,void 0,te),Zy(te,B,At,te),a.realIntersection=!1,Qk(ge,!1,Nh(se[0],se[1],se[2],se[3],se[4]),ze),e.traverse(te[0],te[1],te[2],te[3],u),a.realIntersection&&!o)return ne[ge]=!0,!1;if(ae[ge]=!0,pe[ge]=!1,ze<=0){const Ut=ce.length/wr;Zt[ge]=Ut,ce.push(te[0],te[1],te[2],te[3],0,ge),e.insert(Ut,te[0],te[1],te[2],te[3]),Ce.push(se[0],se[1],se[2],se[3],se[4])}else e.insert(Zt[ge],te[0],te[1],te[2],te[3])};for(const ge of t)ve(ge);let Ne=!0;for(let ge=0;ge<Xt.length;ge++){const ze=Xt[ge];if(ze)if(Ne)Ne=!1;else for(const is of ze)ve(is,ge)}for(let ge=0;ge<t.length;ge++){const ze=t[ge];pe[ze]?g.push(ze):ae[ze]&&p.push(ze),ne[ze]&&f.push(ze)}return a}var CG={left:-1,right:1,top:0,bottom:0,center:0},LG={left:0,right:0,top:-1,bottom:1,center:0},kG={left:-1,right:0,top:-.5,bottom:-.5,center:-.5},NG={left:-.5,right:-.5,top:-1,bottom:0,center:-.5},MG=(t,e,s)=>vC(e,s.get(t))||{lines:0,data:[" "],maxLength:1},IG=(t,e,s,n,i,r,o)=>{const{lines:a,data:l}=MG(t,e,n);let u=s(l[0],i,r,o).width;for(let h=1;h<a;h++)u=Math.max(u,s(l[h],i,r,o).width);return[u,a*o*Gd]},RG=(t,e,s)=>{const n=e.text.content,i=e.radius,r=e.text.scaling,o=e.text.position,a=e.text.padding,l=e.text.scale,u=e.text.size,h=e.text.style,g=e.text.font,f=e.text.maxLineLength,p=e.text.margin,y=n.get(t),_=i.get(t),x=!r.get(t),v=o.get(t),b=a.get(t),S=l.get(t),A=(x?u.get(t):S*_*2)*Gd,w=h.get(t),L=g.get(t),I=b+p.get(t),F=CG[v],O=LG[v],[V,j]=IG(t,`${y}`,s,f,L,w,A),Z=V/2,at=j/2;return[kG[v]*V,NG[v]*j,F*I,O*I,F*_,O*_,V,j,Z,at]};function FG(t,e,s,n,i,r,o,a,l){const u=o.remove.nodes,h=o.remove.edges,g=o.redraw.nodes,f=s.angle,p=s.zoom,y=s.sin,_=s.cos,x=n.x,v=n.y,b=n.radius,S=n.layer,A=n.scalingMethod,w=n.text.content,L=n.text.scaling,I=n.text.minVisibleSize,F=n.animationDuration,O=n.textHidden,V=n.excluded;o.indexToLayer={},o.indexToQuadIndex={},o.indexToRemoveNodeText={},o.indexToRemoveEdgeText={},o.indexToRedrawNodeText={},o.byLayer=[];const{indexToLayer:j,indexToRedrawNodeText:Z,indexToRemoveNodeText:at,indexToRemoveEdgeText:pt,indexToQuadIndex:K,byLayer:ut}=o;for(let Ht=0;Ht<t.length;Ht++){const Zt=t[Ht],ae=S.get(Zt)-Y2;(ut[ae]=ut[ae]||[]).push(Zt),j[Zt]=ae}if(a!==null){const Ht=ut.length;for(let Zt=j[a]+1;Zt<=Ht;Zt++)(ut[Zt]=ut[Zt]||[]).unshift(a);j[a]=Ht}let ht;const nt=[0,0,0,0],ot=[0,0,0,0,0],{bboxes:Nt,rects:Q}=o,Et=(Ht,Zt=-1)=>{const ae=F.get(Ht);let pe=w.get(Ht);if(pe===null||pe===""||ae!==0)return!1;let ne=b.get(Ht);const te=I.get(Ht);if(V.get(Ht)===1)return at[Ht]=!0,!1;if(2*ne*p<te)return O.get(Ht)===0&&(at[Ht]=!0),!1;A.get(Ht)==="fixed"&&(ne/=p);const se=x.get(Ht),ce=v.get(Ht);typeof pe=="number"&&(pe=pe.toString());let[Ce,ve,Ne,ge,ze,is,Ge,De,He,Je]=i(Ht);const ss=!L.get(Ht),ts=ss?p:1,hs=A.get(Ht)==="fixed"?p:1;ss?(Ne+=He,ge+=Je,He/=p,Je/=p,Ge/=p,De/=p):(Ne+=He*p,ge+=Je*p),Ce=Ce/ts+Ne/p+ze/hs,ve=ve/ts+ge/p+is/hs,up(se-He,ce-Je,Ge,De,-f,y,-_,nt),ot[0]=se-He,ot[1]=ce-Je,ot[2]=Ge,ot[3]=De,ot[4]=f;const Fe=_*Ce-y*ve,Oe=y*Ce+_*ve;if(nt[0]+=Fe,nt[1]+=Oe,nt[2]+=Fe,nt[3]+=Oe,ot[0]+=Fe,ot[1]+=Oe,o.realIntersection=!1,Qk(Ht,!0,Nh(ot[0],ot[1],ot[2],ot[3],ot[4]),Zt),e.traverse(nt[0],nt[1],nt[2],nt[3],l),o.realIntersection&&!r)return at[Ht]=!0,!1;Z[Ht]=!0,at[Ht]=!1,Zt<=0?(ht=Nt.length/wr,K[Ht]=ht,Nt.push(nt[0],nt[1],nt[2],nt[3],1,Ht),e.insert(ht,nt[0],nt[1],nt[2],nt[3]),Q.push(ot[0],ot[1],ot[2],ot[3],ot[4])):e.insert(K[Ht],nt[0],nt[1],nt[2],nt[3])};for(const Ht of t)Et(Ht);let Xt=!0;for(let Ht=0;Ht<ut.length;Ht++){const Zt=ut[Ht];if(Zt)if(Xt)Xt=!1;else for(const ae of Zt)Et(ae,Ht)}for(let Ht=0;Ht<t.length;Ht++){const Zt=t[Ht];at[Zt]?u.push(Zt):Z[Zt]&&g.push(Zt),pt[Zt]&&h.push(Zt)}return o}var PG=1,zG="topDown",DG="bottomUp",OG=.15,BG=200,W1=80,UG=["x","y","radius","width","layer","text.content","text.minVisibleSize","text.size","text.scale","text.scaling","text.padding","text.margin","text.position","text.style"].reduce(((t,e)=>(t.add(e),t)),new Set),GG=class extends Ke{constructor(t,e){super(t),this._textBBoxes=[],this._rects=[],this._enabled=!1,this._geoEnabled=!1,this._intersects=[],this._textDisplacement={},this._textDisplacementUpdate={},this._skipFrames=!1,this._output={remove:{nodes:[],edges:[]},redraw:{nodes:[],edges:[]},rects:this._rects,bboxes:this._textBBoxes,intersects:this._intersects,realIntersection:!1,indexToLayer:{},byLayer:[],indexToRedrawEdgeText:{},indexToRemoveEdgeText:{},indexToRedrawNodeText:{},indexToRemoveNodeText:{},indexToQuadIndex:{}},this._onZoomStart=Yd((({startZoom:s,endZoom:n})=>{this._enabled&&n<s&&this._updateLabels(this._modules.camera.clone({zoom:n}))}),W1),this._onLayoutEnd=Yd((()=>{this._enabled&&this._updateLabels()}),W1),this._onAttributesChanged=s=>{if([...s.edgeAttributes,...s.nodeAttributes].some((n=>UG.has(n)))){const n=s.nodes._indexes;for(let i=0;i<n.length;i++)this._textDisplacementUpdate[n[i]]=!0;this._update()}},this._onToggle=s=>(s?this._update():this._reset(),this),this._update=()=>{(this._enabled||this._forceEnabled)&&this._updateDebounced()},this._toggleDebug=s=>{s?this._modules.layers.whenReady((()=>{this._layer=this._modules.layers.addCanvasLayer((n=>{n.lineWidth=1/this._modules.camera.getZoom(),SG(n,this._textBBoxes,this._rects,this._intersects,this._quadtree)}),{isStatic:!1,noClear:!1}),this._layer.moveToTop(),this._canvas=this._layer.element,this._ctx=this._canvas.getContext("2d"),this._update()})):this._canvas&&(this._layer.destroy(),this._canvas=this._ctx=null)},this._measureText=(s,n,i,r)=>this._engine.measureText(s,n,i,r),this._textDisplacement={},this._textDisplacementUpdate={},this._quadtree=new EG.Quadtree((s=>{const n=wr,i=n*s;return this._textBBoxes.slice(i,i+n)}),PG),e.forceEnableTextOverlapRemoval&&this.forceEnable()}onMounted(){this._engine=this._modules.graphics.getGraphicsEngine(),this._modules.events.register(["labelCollisionsRemoved"]),this.setRate(BG),this._modules.settings.register("texts.preventOverlap",!0,this._onToggle),this._modules.settings.register("texts.debug",!1,this._toggleDebug),this._modules.settings.register("texts.removalStrategy",zG);const t=this._output;this._nodeTraversal=q1(this._quadtree,!1,1,t),this._edgeTraversal=q1(this._quadtree,!1,0,t),this._modules.events.on(["layoutEnd","locate"],this._onLayoutEnd).on(["viewChanged","mouseover","mouseout"],this._update).on("updateAttributes",this._onAttributesChanged).on("setContainer",(({element:e})=>{if(e)return this._enable();this._disable()})).on("zoomStart",this._onZoomStart).on("viewExportStart",(({preventOverlap:e,camera:s})=>{e&&this.forceUpdate(s)})).on("viewExportEnd",(()=>{this.forceUpdate()})).on("geoEnabled",(()=>this._geoEnabled=!0)).on("geoDisabled",(()=>this._geoEnabled=!1))}getTextsBoundingBox(t,e){if(this._skipFrames=!0,t||e?this._updateLabels(this._modules.camera,t?Array.from(t._indexes):[],e?Array.from(e._indexes):[]):this._updateLabels(),this._skipFrames=!1,this._rects===void 0)throw new Error("this._rects is undefined");const s=this._rects,n=new ri;for(let i=0;i<s.length;i+=5){const r=s[i],o=s[i+1],a=s[i+2],l=s[i+3],u=s[i+4],[h,g,f,p]=up(r,o,a,l,u);n.addPoint(h,g).addPoint(f,p)}return n}setRate(t){this._updateDebounced=this._modules.sync.debounceIdle((e=>this._updateLabels(e)),t)}forceEnable(){this._forceEnabled=!0}update(){this._update()}forceUpdate(t=this._modules.camera){this._updateLabels(t)}query(t,e,s,n,i){const r=this._quadtree.query(t,e,s,n);for(let o=0;o<r.length;o++){const a=this._textBBoxes[6*r[o]+4],l=this._textBBoxes[6*r[o]+5];a?i.nodes.push(l):i.edges.push(l)}}_enable(){this._enabled=!0,this._update()}_disable(){this._textBBoxes=[],this._rects=[],this._intersects=[],this._enabled=!1}_onCameraMove(){this._update()}_updateLabels(t=this._modules.camera,e,s){if(!this._modules.settings.get("texts.preventOverlap"))return;const n=this._modules.graphics.getNodeAttributes(),i=this._modules.graphics.getEdgeAttributes();this._intersects=[],this._textBBoxes=[],this._rects=[];const r=t.getAngle(),o=t.getProjectedScreenBounds(OG),a=this._modules.settings.get("texts.removalStrategy")===DG,l={angle:r,zoom:t.zoom,sin:Math.sin(r),cos:Math.cos(r)};this._resetOutput();const u=this._output;if(!e||!s){const y=this._modules.spatial.queryRaw(o[0],o[1],o[2],o[3]);e=y.nodes,s=y.edges}const h=this._quadtree.clear().cover(o[0],o[1],o[2],o[3]);if(e.length+s.length===0)return;const g=this._modules.captor.getPointedElement();let f=null,p=null;g!==null&&(g.isNode?f=g._index:p=g._index);for(const y of e)!this._textDisplacementUpdate[y]&&this._textDisplacement[y]||(this._textDisplacement[y]=RG(y,n,this._measureText),this._textDisplacementUpdate[y]=!1);FG(e,h,l,n,(y=>this._textDisplacement[y]),a,u,f,this._nodeTraversal),TG(s,h,l,i,n,this._measureText,a,u,p,this._edgeTraversal,this._geoEnabled),this._skipFrames||this._clearOverlaps(this._output),this._modules.settings.get("texts.debug")&&this._layer.refresh()}_clearOverlaps(t){const e=this._modules.graph.nodeList,s=this._modules.graph.edgeList,n=this._modules.graphics,i=e(new Uint32Array(t.remove.nodes)),r=s(new Uint32Array(t.remove.edges)),o=e(new Uint32Array(t.redraw.nodes)),a=s(new Uint32Array(t.redraw.edges));n.setTextHidden(i,!0),n.setTextHidden(r,!0),n.setTextHidden(o,!1),n.setTextHidden(a,!1),this._modules.events.fire("labelCollisionsRemoved",t)}_resetOutput(){const t=this._output;t.remove.nodes=[],t.remove.edges=[],t.redraw.nodes=[],t.redraw.edges=[],t.rects=this._rects,t.bboxes=this._textBBoxes,t.intersects=this._intersects,t.realIntersection=!1,t.indexToLayer={},t.byLayer=[],t.indexToRedrawEdgeText={},t.indexToRemoveEdgeText={},t.indexToRedrawNodeText={},t.indexToRemoveNodeText={},t.indexToQuadIndex={}}_reset(){this._modules.graphics.resetTextHidden(),this._textDisplacement={},this._textDisplacementUpdate={}}},VG=class extends Ke{constructor(){super(...arguments),this._onStartInteractionEvent=(t,e)=>{const s=e==="mousewheel";if(this._current&&!s)return;const n=this._interactionsByStartEvent[e];let i;for(const r of n)r.check(t)&&(!i||r.priority>=i.priority)&&(i=r);i&&(s?i.onStart&&i.onStart(t):this._startInteraction(i,t))},this._onProgressInteractionEvent=(t,e)=>{this._current&&this._current.progressEventName===e&&this._current.onProgress&&this._current.onProgress(t)},this._onStopInteractionEvent=(t,e)=>{this._current&&this._current.stopEventName===e&&this._stopCurrentInteraction(null)}}onMounted(){this._interactionsByStartEvent={},this._boundProgressEvents={},this._boundStopEvents={}}_startInteraction(t,e){t.onStart&&t.onStart(e),t.onStop&&(this._current=t,t.disableDetection&&this._modules.captor.setDetectionEnabled(!1))}_stopCurrentInteraction(t){this._current&&this._current.disableDetection&&this._modules.captor.setDetectionEnabled(!0),this._current&&this._current.onStop&&this._current.onStop(t),this._current=void 0}_forceStartInteraction(t,e){this._current&&this._stopCurrentInteraction(e),this._startInteraction(t,e)}_createWrapper(t){return{start:e=>this._forceStartInteraction(t,e)}}_addInteraction(t,e){const s=this._interactionsByStartEvent[t];return s?s.push(e):(this._interactionsByStartEvent[t]=[e],this._modules.events.on(t,this._onStartInteractionEvent)),this._createWrapper(e)}_createProgressiveInteraction(t,e,s,n){const i={priority:X1(n.priority),check:n.check||Jg,onStart:n.onStart||as,onProgress:n.onProgress||as,onStop:n.onStop||as,disableDetection:!!n.disableDetection,progressEventName:e,stopEventName:s};return this._boundProgressEvents[e]||(this._boundProgressEvents[e]=!0,this._modules.events.on(e,this._onProgressInteractionEvent)),this._boundStopEvents[s]||(this._boundStopEvents[s]=!0,this._modules.events.on(s,this._onStopInteractionEvent)),this._addInteraction(t,i)}_createNonProgressiveInteraction(t,e){return this._addInteraction(t,{priority:X1(e.priority),check:e.check||Jg,onStart:e.handler||as,onProgress:void 0,onStop:void 0,disableDetection:!1,progressEventName:void 0,stopEventName:void 0})}onDrag(t){return this._createProgressiveInteraction("dragStart","dragProgress","dragEnd",t)}onGesture(t){return this._createProgressiveInteraction("gestureStart","gestureProgress","gestureEnd",t)}onClick(t){return this._createNonProgressiveInteraction("click",t)}onDoubleClick(t){return this._createNonProgressiveInteraction("doubleclick",t)}onHover(t){return this._createNonProgressiveInteraction("mouseover",t)}onUnhover(t){return this._createNonProgressiveInteraction("mouseout",t)}onMouseWheel(t){return this._createNonProgressiveInteraction("mousewheel",t)}onMouseDown(t){return this._createNonProgressiveInteraction("mousedown",t)}onMouseUp(t){return this._createNonProgressiveInteraction("mouseup",t)}onMouseMove(t){return this._createNonProgressiveInteraction("mousemove",t)}};function X1(t){return typeof t=="string"?Yz.indexOf(t):typeof t!="number"||isNaN(t)?0:t}var jG=["virtualUp","mouseupInternal","touchUp"],HG=["virtualDown","mousedownInternal","touchDown"],$G=["virtualMove","mousemoveInternal","touchMove"],qG=["virtualClick","clickInternal","touchTap"],YG=["virtualDoubleClick","doubleclickInternal","touchDoubleTap"],WG=["virtualWheel","mousewheelInternal"],XG=100,ZG=class extends Ke{constructor(){super(...arguments),this.spatialIndexMarginRatio=5,this._elt=null,this._hoveredElt=null,this._draggedElt=null,this._hover=!1,this._disabledCounter=0,this._accDx=0,this._accDy=0,this._prevX=0,this._prevY=0,this._buttons={left:{isPressed:!1,isDragging:!1},middle:{isPressed:!1,isDragging:!1},right:{isPressed:!1,isDragging:!1}},this._onGraphChanged=()=>{this._resetCurrent(this._modules.position.x,this._modules.position.y),this._onMove({x:this._modules.position.x,y:this._modules.position.y,source:null,domEvent:null})}}onMounted(){this._modules.events.register(["mousemove","mousedown","mouseup","click","doubleclick","mousewheel","mouseout","mouseover","dragStart","dragProgress","dragEnd","gestureStart","gestureProgress","gestureEnd"]),this._modules.settings.register("detect.nodes",!0).register("detect.edges",!0).register("detect.nodeTexts",!0).register("detect.nodeBadges",!0).register("detect.edgeTexts",!0).register("detect.nodeErrorMargin",5).register("detect.edgeErrorMargin",2).register("detect.enableSpatialIndex",!0),this._modules.events.on(["removeNodes","removeEdges","clearGraph"],this._onGraphChanged).on($G,((t,e)=>{this._onMove({...t,source:Ea(e)})})).on(HG,(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onDown({domEvent:t,x:e,y:s,button:n,source:Ea(i)})})).on(jG,(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onUp({domEvent:t,x:e,y:s,button:n,source:Ea(i)})})).on(qG,(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onClick({domEvent:t,x:e,y:s,button:n,source:Ea(i)})})).on(YG,(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onDoubleClick({domEvent:t,x:e,y:s,button:n,source:Ea(i)})})).on(WG,(({domEvent:t,x:e,y:s,delta:n,dx:i,dy:r})=>this._onWheel({domEvent:t,x:e,y:s,delta:n,source:"mouse",dx:i,dy:r}))).on("touchStartGesture",(t=>this._modules.events.fire("gestureStart",t))).on("touchProgressGesture",(t=>this._modules.events.fire("gestureProgress",t))).on("touchEndGesture",(t=>this._modules.events.fire("gestureEnd",t))).on("documentMouseMove",(({domEvent:t,x:e,y:s},n)=>{this._onDocumentMove({domEvent:t,x:e,y:s,source:Ea(n)})})).on("documentMouseUp",(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onDocumentUp({domEvent:t,x:e,y:s,source:Ea(i),button:n})}))}triggerUnhover(){this._hover=!1,this._hoveredElt=null}triggerDetection(){this._detectElement(this._modules.position.x,this._modules.position.y,!1,!1),this._elt&&(this._hoveredElt=this._elt,this._hover=!0)}getPointedElement(){return this._hoveredElt}getDraggedElement(){return this._draggedElt}isAnyButtonPressed(){return this._buttons.left.isPressed||this._buttons.right.isPressed||this._buttons.middle.isPressed}isAnyButtonDragging(){return this._buttons.left.isDragging||this._buttons.right.isDragging||this._buttons.middle.isDragging}isButtonPressed(t){return this._buttons[t].isPressed}isLeftPressed(){return this.isButtonPressed("left")}getCursorPosition(){return{x:this._modules.position.x,y:this._modules.position.y}}getCursorInformation(){return{x:this._modules.position.x,y:this._modules.position.y,target:this._hoveredElt}}setDetectionEnabled(t){this._disabledCounter=Math.max(0,this._disabledCounter+(t?-1:1))}_resetCurrent(t,e){for(const s in this._buttons){const n=this._buttons[s];n.isDragging&&this._modules.events.fire("dragEnd",{domEvent:null,x:t,y:e,button:s,target:this._draggedElt}),n.isPressed=!1,n.isDragging=!1}this._hover&&this._hoveredElt&&this._modules.events.fire("mouseout",{domEvent:null,x:t,y:e,target:this._hoveredElt}),this._hover=!1,this._hoveredElt=null,this._draggedElt=null}_onMove({domEvent:t,x:e,y:s,source:n}){let{dx:i,dy:r}=this._setPointerPosition(e,s);this._modules.events.fire("mousemove",{domEvent:t,x:e,y:s,dx:i,dy:r,source:n});for(const o in this._buttons){const a=this._buttons[o];if(a.isPressed)if(a.isDragging){const l=this._getStoredDXY();i+=l.dx,r+=l.dy,this._modules.events.fire("dragProgress",{domEvent:t,x:e,y:s,dx:i,dy:r,button:o,source:n,target:this._draggedElt})}else a.isDragging=!0,this._hoveredElt&&this._hover&&(this._modules.events.fire("mouseout",{domEvent:t,x:e,y:s,source:n,target:this._hoveredElt}),this._hover=!1),this._draggedElt||(this._draggedElt=this._hoveredElt),this._storeDXY(i,r),this._modules.events.fire("dragStart",{domEvent:t,x:e,y:s,button:o,source:n,target:this._draggedElt})}t&&!this._modules.graphics.getDomElement().contains(t.target)||this._detectElement(e,s,!1,!1),this._elt!==this._hoveredElt&&(this._hoveredElt&&this._hover&&(this._hover=!0,this._modules.events.fire("mouseout",{domEvent:t,x:e,y:s,source:n,target:this._hoveredElt})),this._hoveredElt=this._elt,this._elt&&(this._hover=!0,this._modules.events.fire("mouseover",{domEvent:t,x:e,y:s,source:n,target:this._hoveredElt})))}_onDocumentMove({domEvent:t,x:e,y:s,source:n}){for(const i in this._buttons){const{isDragging:r}=this._buttons[i];if(r){const{dx:o,dy:a}=this._setPointerPosition(e,s);this._modules.events.fire("dragProgress",{domEvent:t,x:e,y:s,dx:o,dy:a,button:i,source:n,target:this._draggedElt})}}}_onDocumentUp({domEvent:t,x:e,y:s,source:n,button:i}){if(i!=null&&this._buttons[i].isDragging){this._modules.events.fire("dragEnd",{domEvent:t,x:e,y:s,button:i,source:n,target:this._draggedElt});const r=this._buttons[i];r.isDragging=!1,r.isPressed=!1,this.isAnyButtonDragging()||(this._draggedElt=null)}}_onDown({domEvent:t,x:e,y:s,button:n,source:i}){if(n==null)return;this._detectElement(e,s,!1,!1),this._elt!==this._hoveredElt&&this._resetCurrent(e,s);const r=this._buttons[n];this._hoveredElt=this._elt,r.isPressed=!0,this._elt&&t&&(t.stopPropagation(),t.preventDefault()),this._modules.events.fire("mousedown",{domEvent:t,x:e,y:s,button:n,source:i,target:this._hoveredElt})}_onDoubleClick({domEvent:t,x:e,y:s,button:n,source:i}){n!=null&&(K1(t,"doubleclick")||this._modules.events.fire("doubleclick",{domEvent:t,x:e,y:s,button:n,source:i,target:this._hoveredElt}))}_onUp({domEvent:t,x:e,y:s,button:n,source:i}){if(n==null)return;const r=this._buttons[n];r.isPressed&&(r.isDragging&&(this._modules.events.fire("dragEnd",{domEvent:t,x:e,y:s,button:n,source:i,target:this._draggedElt}),r.isDragging=!1,this.isAnyButtonDragging()||(this._draggedElt=null)),r.isPressed=!1,this._detectElement(e,s,!1,!1),this._modules.events.fire("mouseup",{domEvent:t,x:e,y:s,button:n,source:i,target:this._elt}),this.isAnyButtonPressed()||this._hover||i==="touch"||(this._hoveredElt=this._elt,this._hoveredElt&&(this._modules.events.fire("mouseover",{domEvent:t,x:e,y:s,source:i,target:this._hoveredElt}),this._hover=!0)))}_onClick({domEvent:t,x:e,y:s,button:n,source:i}){K1(t,"click")||this._modules.events.fire("click",{domEvent:t,x:e,y:s,button:n,source:i,target:this._hoveredElt})}_onWheel({domEvent:t,x:e,y:s,delta:n,source:i,dx:r,dy:o}){this._modules.position.x=e,this._modules.position.y=s,this._modules.events.fire("mousewheel",{domEvent:t,x:e,y:s,dx:r,dy:o,delta:n,source:i,target:this._hoveredElt})}_storeDXY(t,e){this._accDx=t,this._accDy=e}_getStoredDXY(){const t=this._accDx,e=this._accDy;return this._accDx=0,this._accDy=0,{dx:t,dy:e}}_setPointerPosition(t,e){const s=t-this._prevX,n=e-this._prevY;return this._modules.position.x=t,this._modules.position.y=e,this._prevX=t,this._prevY=e,this._accDx=0,this._accDy=0,{dx:s,dy:n}}_detectElement(t,e,s,n){this._elt=this.detectElementAt(t,e,s,n)}detectElementAt(t,e,s,n){if(this._disabledCounter!==0)return null;const i=this._modules.settings,r=i.get("detect.enableSpatialIndex"),o=i.get("detect.nodeErrorMargin")||0,a=i.get("detect.edgeErrorMargin")||0;let l=i.get("detect.nodes"),u=i.get("detect.edges");n&&(l=!0,u=!0);let h=null,g=[],f=[];if(!s&&r&&(l||u)){const _=this.spatialIndexMarginRatio,x=Math.max(o*_,a*_),v=this._modules.spatial.queryRawProjected(t-x,e-x,t+x,e+x);g=v.nodes,f=v.edges}let p=null,y=null;if(l&&(p=this._modules.graphics.detectNode(t,e,!!i.get("detect.nodeTexts"),!!i.get("detect.nodeBadges"),o,g)),u&&(f.length<XG||!p)&&(y=this._modules.graphics.detectEdge(t,e,!!i.get("detect.edgeTexts"),a,f)),p&&y){const _=this._modules.graphics.getAttributesManager().getFlexArrays();h=_.nodes.current.layer.get(p._index)>=_.edges.current.layer.get(y._index)?p:y}else p?h=p:y&&(h=y);return h}};function Ea(t){return t.indexOf("touch")===0?"touch":"mouse"}var y_=!1,Z1={down:{trigger:"pointerdown",duplicate:"mousedown"},click:{trigger:"pointerdown",duplicate:"mouseup"},doubleclick:{trigger:"pointerdown",duplicate:"mouseup"}};function K1(t,e){if(t)return t.type===Z1[e].trigger&&(y_=!0),t.type===Z1[e].duplicate&&y_?(y_=!1,!0):void 0}var KG=class extends Ke{constructor(){super(...arguments),this._dragged=null,this._start=[],this._end=[],this._shouldDrag=({target:t,button:e})=>{const s=e==="left",n=this._modules.settings.get("interactions.drag.enabled"),i=t!==null&&t.isNode&&t.getAttribute("draggable")===!0;return!!(s&&n&&i)},this._onDragStart=({x:t,y:e,target:s})=>{s&&(s.isSelected()?this._dragged=this._modules.selection.getSelectedNodes().filter((n=>n.getAttribute("draggable"))):this._dragged=s.toList()),this._dragged&&(this._start=this._dragged.getPosition(),this._end=Xs(this._start),this._onBeforeDrag=this._modules.settings.get("interactions.drag.onBeforeDrag"),this._startDrag=this._modules.camera.screenToGraphCoordinates({x:t,y:e}),this._dragged.addClass(Bg),this._modules.events.fire("nodesDragStart",{nodes:this._dragged}),this._modules.graphics.addCursorStyle(this._modules.settings.get("interactions.drag.cursor")))},this._onDrag=()=>{if(!this._dragged||!this._startDrag)return;const{x:t,y:e}=this._modules.captor.getCursorInformation(),s=this._dragged._indexes,n=this._modules.camera.screenToGraphCoordinates({x:t,y:e}),i=n.x-this._startDrag.x,r=n.y-this._startDrag.y;for(let o=0;o<s.length;++o){const a=this._start[o],l=this._end[o];l.x=a.x+i,l.y=a.y+r}this._onBeforeDrag&&this._onBeforeDrag(this._dragged,t,e,this._end),this._modules.settings.get("interactions.drag.applyResult")&&this._modules.individualAttributes.setMultipleAttributes(this._dragged,this._end),this._modules.events.fire("nodesDragProgress",{nodes:this._dragged,dx:i,dy:r})},this._onDragEnd=()=>{this._dragged&&(this._dragged.removeClass(Bg),this._modules.graphics.removeCursorStyle(this._modules.settings.get("interactions.drag.cursor")),this._modules.events.fire("nodesDragEnd",{nodes:this._dragged,start:this._start,end:this._end}),this._dragged=null,this._start=[],this._end=[])}}onMounted(){this._modules.classes.createClass({name:Bg,isBuiltin:!0,nodeAttributes:{layer:$z}}),this._modules.events.register(["nodesDragStart","nodesDragProgress","nodesDragEnd"]),this._modules.settings.register("interactions.drag.enabled",!0).register("interactions.drag.cursor","move").register("interactions.drag.onBeforeDrag",void 0),this._modules.settings.register("interactions.drag.applyResult",!0),this._modules.interactions.onDrag({priority:"drag",disableDetection:!0,check:this._shouldDrag,onStart:this._onDragStart,onProgress:this._onDrag,onStop:this._onDragEnd})}},QG={color:"#00C3FF",radius:4,cursorOnHover:"grab",cursorOnDrag:"grabbing"},JG=class extends Ke{constructor(){super(...arguments),this._hoveredNode=null,this._hoverHandle=!1,this._grabHandle=!1,this._x=0,this._y=0,this._enabled=!1,this._onMouseUp=()=>this._grabHandle=!1,this._onMouseDown=()=>{this._hoverHandle&&(this._grabHandle=!0)},this._onDragProgress=()=>{this._grabHandle&&this._refreshCanvas()},this._onDragStart=()=>{if(!this._movedEdges)return;this._nodesToHighlight=this._nodesToHighlight.filter((e=>e!==this._startNode&&!e.isVirtual())),this._movedEdges.setExcluded(!0);const t=this._options.cursorOnDrag;this._prevSettings=this._modules.settings.update({edgeHover:!1,cursor:{default:t,node:t,edge:t}})},this._onDragEnd=()=>{if(!this._movedEdges)return;this._restoreSettings();const t=this._getPointedNode();t?this._movedEdges.forEach((e=>{e.getTarget()===this._startNode?e.setTarget(t):e.setSource(t)})):this._options.onMouseUpInVoid&&this._options.onMouseUpInVoid(this._modules.camera.screenToGraphCoordinates({x:this._x,y:this._y}),this._startNode,this._movedEdges,this._movedEdges.map((e=>e.getSource()===this._startNode))),this._movedEdges.setExcluded(!1),this._movedEdges.setSelected(!0),this._movedEdges=null,this._refreshHandles()},this._refreshHandles=()=>{if(!this._enabled||this._movedEdges)return;const t=this._modules.selection.getSelectedEdges();this._nodesToHighlight=t.getExtremities().dedupe().filter((e=>!e.isVirtual())),this._rewirableClass.clearEdges(),this._rewirableClass.add(t),this._refreshCanvas()},this._shouldInteractionStart=()=>{if(!this._enabled||!this._hoveredNode||!this._hoverHandle||this._hoveredNode.isVirtual())return!1;const t=this._hoveredNode.getAdjacentEdges().filter((e=>e.isSelected()));return!!t.size&&(this._movedEdges=t,this._edgeColors=this._movedEdges.getAttribute("color"),this._startNode=this._hoveredNode,!0)},this._refreshCanvas=()=>{this._enabled&&this._layer.refresh()},this._checkForHover=()=>{if(!this._enabled||!this._nodesToHighlight)return;const t=this._options.radius,e=this._nodesToHighlight.getPosition(),s=this._modules.camera.screenToGraphCoordinates(this._modules.captor.getCursorPosition());for(let n=0;n<e.length;n++){const{x:i,y:r}=e[n];if(!(i-t>s.x||i+t<s.x||r-t>s.y||r+t<s.y))return this._hoveredNode=this._nodesToHighlight.get(n),void this._enableCursorOnHover()}this._hoveredNode=null,this._disableCursorOnHover()}}onMounted(){this._rewirableClass=this._modules.classes.createClass({name:V2,isBuiltin:!0,edgeAttributes:{layer:qz}})}enable(t){this._enabled||(this._modules.events.on("move",this._checkForHover).on("mousemove",this._checkForHover).on("dragProgress",this._onDragProgress).on("nodesDragProgress",this._refreshCanvas).on("mousedown",this._onMouseDown).on("mouseup",this._onMouseUp).on("edgesSelected",this._refreshHandles).on("edgesUnselected",this._refreshHandles),this._interaction=this._modules.interactions.onDrag({priority:"rewiring",check:this._shouldInteractionStart,onStart:this._onDragStart,onProgress:({x:e,y:s})=>{this._x=e,this._y=s},onStop:this._onDragEnd}),this._options={...QG,...t},this._enabled=!0,this._layer=this._modules.layers.addCanvasLayer((e=>{if(!this._enabled||!this._nodesToHighlight)return;const s=this._modules.captor.getCursorPosition(),n=this._getPointedNode(),i=this._options.color,r=this._options.radius,o=2*r;if(this._displayMovedEdges(e),e.fillStyle=i,e.strokeStyle=i,this._nodesToHighlight.forEach((a=>{const{x:l,y:u}=a.getPosition();e.fillRect(l-r,u-r,o,o)})),this._movedEdges){const a=n?n.getPosition():s;e.fillRect(a.x-r,a.y-r,o,o)}}),{isStatic:!1,noClear:!1}),this._layer.moveToTop(),this._refreshHandles())}disable(){this._enabled&&(this._interaction&&this._interaction.stop&&this._interaction.stop(),this._interaction=void 0,this._modules.graphics.removeCursorStyle(this._options.cursorOnDrag),this._disableCursorOnHover(),this._hoveredNode=null,this._restoreSettings(),this._layer.destroy(),this._rewirableClass.clearEdges(),this._enabled=!1,[this._checkForHover,this._onDragProgress,this._refreshCanvas,this._onMouseDown,this._onMouseUp,this._refreshHandles].forEach((t=>this._ogma.events.off(t))))}enabled(){return this._enabled}_restoreSettings(){this._prevSettings&&(this._modules.settings.update(this._prevSettings),this._prevSettings=void 0)}_disableCursorOnHover(){this._hoverHandle&&!this._grabHandle&&(this._hoverHandle=!1,this._modules.graphics.removeCursorStyle(this._options.cursorOnHover))}_enableCursorOnHover(){this._hoverHandle||(this._hoverHandle=!0,this._modules.graphics.addCursorStyle(this._options.cursorOnHover))}_displayMovedEdges(t){if(!this._movedEdges)return;const e=this._x,s=this._y,n=this._modules.camera.screenToGraphCoordinates({x:e,y:s});this._movedEdges.forEach(((i,r)=>{const o=this._edgeColors[r],a=i.getSource(),l=i.getTarget(),u=this._getPointedNode(),h=l===this._startNode?a:l,g=Number(i.getAttribute("width")),f=h.getPosition(),p=u?u.getPosition():n;t.beginPath(),t.moveTo(f.x,f.y),t.lineTo(p.x,p.y),t.strokeStyle=o,t.lineWidth=g,t.stroke()}))}_getPointedNode(){const t=this._modules.captor.getPointedElement();return t&&t.isNode&&!t.isVirtual()?t:null}},Q1={cursor:"nesw-resize",color:"#00C3FF",lineWidth:1,handleSize:6,detectionMargin:5,snappingRatio:1.25,nbNodesToSnapTo:5,previewColor:"rgba(0, 0, 0, 0.2)",sizeIndicatorColor:"black",sizeIndicatorOffset:5,sizeIndicatorWidth:3,sizeIndicatorThickness:1},tV=class extends Ke{constructor(){super(...arguments),this._enabled=!1,this._nodesToHighlight=null,this._cursorEnabled=!1,this._x=0,this._y=0,this._additionalRadiuses=[],this._onSelectionChange=()=>{this._enabled&&(this._nodesToHighlight=this._modules.selection.getSelectedNodes(),this._displayHandles())},this._displayHandlesHandler=()=>this._displayHandles(),this._moveHandler=({x:t,y:e})=>{this._modules.dom.setTimeout((()=>this._detectBoundingBoxes(t,e)),0)}}onMounted(){this._engine=this._modules.graphics.getGraphicsEngine(),this._modules.interactions.onDrag({priority:"resizing",disableDetection:!0,check:()=>!(!this._enabled||!this._pointedNode),onStart:({x:t,y:e})=>{this._x=t,this._y=e,this._nodeBeingResized=this._pointedNode},onProgress:({x:t,y:e})=>{this._x=t,this._y=e,this._displayHandles()},onStop:()=>{if(this._nodesToHighlight){const t=this._modules.camera.zoom,e=this._nodesToHighlight.getAttributes(["x","y","radius"]).map((({x:s,y:n,radius:i},r)=>{const o=this._additionalRadiuses[r]/t;return{radius:+i+o,x:s+o,y:n-o}}));this._nodesToHighlight.setAttributes(e)}this._pointedNode=null,this._nodeBeingResized=null,this._displayHandles()}})}onReady(){this._modules.events.on(["nodesSelected","nodesUnselected"],this._onSelectionChange)}_enableCursor(){this._cursorEnabled||(this._modules.graphics.addCursorStyle(this._options.cursor),this._cursorEnabled=!0)}_disableCursor(){this._cursorEnabled&&(this._modules.graphics.removeCursorStyle(this._options.cursor),this._cursorEnabled=!1)}_detectBoundingBoxes(t,e){if(!this._enabled||this._nodeBeingResized||!this._nodesToHighlight)return;const s=this._options.handleSize/2,n=this._options.detectionMargin;return this._pointedNode=null,this._forEachNodeToHighlight(((i,r,o)=>{const a=r.x+o-s-n,l=r.x+o+s+n,u=r.y-o-s-n,h=r.y-o+s+n;t>=a&&t<=l&&e>=u&&e<=h&&(this._pointedNode=i)})),this._pointedNode?this._enableCursor():this._disableCursor()}_forEachNodeToHighlight(t){this._nodesToHighlight&&this._nodesToHighlight.forEach((e=>{const s=e.getPositionOnScreen(),n=this._getTotalRadius(e);t(e,s,n)}))}_displayHandles(){this._enabled&&this._nodesToHighlight&&this._layer.refresh()}_displayNodePreview(t,e,s,n,i,r){if(i*=1/this._modules.camera.getZoom(),t.beginPath(),r.length===1)t.arc(s,n,i,0,2*Math.PI);else for(let o=0;o<r.length;++o){const a=r[o],l=s+a.x*i,u=n+a.y*i;o===0?t.moveTo(l,u):t.lineTo(l,u)}t.fillStyle=this._options.previewColor,t.fill()}_getTotalRadius(t,e=!0){return Number(t.getAttribute("radius"))*(this._modules.camera.zoom*(e?1:0))+Number(t.getAttribute("innerStroke.width"))+Number(t.getAttribute("outerStroke.width"))+this._options.lineWidth/2}_snap(t,e,s){const n=this._modules.spatial.getNodesInScreenByDistance(e).filter((g=>!g.isSelected())).slice(0,this._options.nbNodesToSnapTo),i=this._getTotalRadius(e),r=i+s,o=this._options.snappingRatio,a=r/i,l=Math.round(f2(a,o));let u=i*Math.pow(o,l),h=null;if(n.forEach((g=>{const f=this._getTotalRadius(g);Math.abs(f-r)<=Math.abs(u-r)&&(u=f,h=g)})),h){t.save(),t.strokeStyle=this._options.sizeIndicatorColor,t.lineWidth=this._options.sizeIndicatorThickness/this._modules.camera.getZoom();const g=h.getAttribute("radius");this._displaySizeIndicator(t,e,u),n.filter((f=>f.getAttribute("radius")===g)).forEach((f=>this._displaySizeIndicator(t,f))),t.restore()}return u-i}_displaySizeIndicator(t,e,s){s=s||void 0;const n=this._modules.camera.getZoom(),i=e.getPosition(),r=this._getTotalRadius(e),o=(s||r)/n,a=(s?s-r:0)/n,l=a+(-this._options.sizeIndicatorOffset-(s?Number(e.getAttribute("innerStroke.width"))+Number(e.getAttribute("outerStroke.width")):0))/n,u=i.x-o+l|0,h=i.y-o-a|0,g=i.y+o-a|0,f=this._options.sizeIndicatorWidth/n;t.beginPath(),t.moveTo(u-f,h),t.lineTo(u+f,h),t.moveTo(u,h),t.lineTo(u,g),t.moveTo(u-f,g),t.lineTo(u+f,g),t.stroke()}enable(t={}){this._enabled||(this._options={...Q1,...t},this._layer=this._modules.layers.addCanvasLayer((e=>{const s=vi(),n=this._modules.camera.getZoom(),{color:i,lineWidth:r}=this._options;let o=this._options.handleSize,a=0;if(this._nodeBeingResized){const l=this._getTotalRadius(this._nodeBeingResized),u=this._nodeBeingResized.getPositionOnScreen();a=Math.max(this._x-(u.x+l),-(this._y-(u.y-l)))/2}this._additionalRadiuses=[],this._nodesToHighlight&&this._nodesToHighlight.forEach((l=>{const u=l.getPosition();let h=this._getTotalRadius(l),g=0;if(this._nodeBeingResized){g=a;const f=-h+Number(l.getAttribute("innerStroke.width"))+Number(l.getAttribute("outerStroke.width"))+r/2+1;g=g<f?f:this._snap(e,l,g),this._additionalRadiuses.push(g);const p=l.getAttribute("shape"),y=this._engine.getShapePoints(p),_=u.x+g/n,x=u.y-g/n,v=h+g;this._displayNodePreview(e,s,_,x,v,y)}e.strokeStyle=i,e.fillStyle=i,e.lineWidth=r/n,h/=n,g/=n,o/=n*s,e.strokeRect(u.x-h,u.y-h-2*g,2*(g+h),2*(g+h)),e.fillRect(u.x+h+2*g-o/2,u.y-h-2*g-o/2,o,o)}))}),{isStatic:!1,noClear:!1}),this._layer.moveToTop(),this._modules.events.on(["mousemove","mousedown"],this._moveHandler),this._enabled=!0)}disable(){this._enabled&&(this._modules.events.off(this._displayHandlesHandler).off(this._moveHandler),this._layer.destroy(),this._disableCursor(),this._reset())}_reset(){this._enabled=!1,this._nodesToHighlight=null,this._options={...Q1},this._nodeBeingResized=null,this._pointedNode=null,this._cursorEnabled=!1,this._x=0,this._y=0,this._additionalRadiuses=[]}enabled(){return this._enabled}},eV={strokeColor:"black",strokeWidth:5,dashed:!0,cursorStyle:"cell",createNodes:!0,condition:Mx,onNodeCreated:as,onEdgeCreated:as,createNode:ur,createEdge:ur,onComplete:as},sV=class extends Ke{constructor(){super(...arguments),this._enabled=!1,this._blockId=0,this._cursorEnabled=!1}onMounted(){this._engine=this._modules.graphics.getGraphicsEngine(),this._group=this._engine.createGroup(),this._depth=sh(0).edgeBody,this._modules.events.register(["connectNodes"]),this._interaction=this._modules.interactions.onDrag({priority:"connectNodes",check:({target:t,button:e="left"})=>this._enabled&&e==="left"&&t&&t.isNode&&!t.isVirtual(),onStart:({target:t})=>this._onStart(t),onProgress:({x:t,y:e})=>this._onMove(t,e),onStop:()=>this._onStop()}),this._modules.events.on("clearGraph",(()=>this.disable()))}_onStart(t){t&&(this._cursorEnabled=!0,this._startNode=t,this._startPos=t.getPosition(),this._modules.graphics.addCursorStyle(this._options.cursorStyle),this._blockId=this._modules.graphics.allocateGraphicsEngineBlockId())}_onMove(t,e){this._startNode!==null&&(this._endPos=this._modules.camera.screenToGraphCoordinates({x:t,y:e}),this._drawLine())}_onStop(){if(this._startNode===null)return;const{condition:t,onNodeCreated:e,onEdgeCreated:s,createEdge:n,createNode:i,onComplete:r,createNodes:o}=this._options;let a=this._modules.captor.getPointedElement(),l=null,u=null;if(this._modules.graphics.releaseGraphicsEngineBlockId(this._blockId),!a&&o){const h=i({attributes:{x:this._endPos.x,y:this._endPos.y}});a=this._modules.graph.addNode(h),u=a,e&&e(u)}if(a&&!a.isVirtual()&&(u||!t||t(this._startNode,a))){const h=n({source:this._startNode.getId(),target:a.getId()});l=this._modules.graph.addEdge(h),s&&s(l)}r&&(this._modules.events.fire("connectNodes",{source:this._startNode,target:a,edge:l}),r(this._startNode,a,l||void 0)),this.disable()}_drawLine(){this._group.reset(lr,!1,this._depth);const t=this._group.nextAndReset().end;t.pieceId=Qf,t.shape="line",t.x1=this._startPos.x,t.y1=this._startPos.y,t.x2=this._endPos.x,t.y2=this._endPos.y,t.fillColor=this._options.strokeColor,t.thicknessOrFontSizeFixed=this._options.strokeWidth,this._options.dashed&&(t.dashLength=3,t.gapLength=1),this._engine.storeGroup(this._blockId,this._group),this._modules.dom.refresh()}enable(t={}){return this._enabled||(this._options={...eV,...t},this._enabled=!0,this._cursorEnabled=!1,this._startNode=null,this._prevSettings=this._modules.settings.update({"cursor.node":this._options.cursorStyle,"detect.edges":!1}),this._modules.captor.isLeftPressed()&&this._interaction.start(this._modules.captor.getCursorInformation())),this}disable(){return this._enabled?(this._enabled=!1,this._modules.settings.update(this._prevSettings),this._cursorEnabled&&this._modules.graphics.removeCursorStyle(this._options.cursorStyle),this):this}enabled(){return this._enabled}},nV=["top","bottom","left","right","cssDefined"],iV=1e4,rV={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}},oV={position:"top",autoAdjust:!0,delay:100},aV={hover:{node:({target:t})=>t&&t.isNode,edge:({target:t})=>t&&!t.isNode},click:{left:{node:({target:t,button:e})=>e==="left"&&t&&t.isNode,edge:({target:t,button:e})=>e==="left"&&t&&!t.isNode,background:({target:t,button:e})=>e==="left"&&!t},right:{node:({target:t,button:e})=>e==="right"&&t&&t.isNode,edge:({target:t,button:e})=>e==="right"&&t&&!t.isNode,background:({target:t,button:e})=>e==="right"&&!t}},doubleclick:{left:{node:({target:t,button:e})=>e==="left"&&t&&t.isNode,edge:({target:t,button:e})=>e==="left"&&t&&!t.isNode,background:({target:t,button:e})=>e==="left"&&!t},right:{node:({target:t,button:e})=>e==="right"&&t&&t.isNode,edge:({target:t,button:e})=>e==="right"&&t&&!t.isNode,background:({target:t,button:e})=>e==="right"&&!t}}},lV=class extends Ke{constructor(){super(...arguments),this._x=0,this._y=0}onMounted(){this._handlers={},this._currentHandlerName=null,this._tooltip=null,this._isHover=!1,this._modules.events.register(["tooltipShow","tooltipHide"]),this._modules.events.on(["mouseup","dragStart"],(()=>{this._isHover||this._hideTooltip(!1)})).on("mouseout",(()=>{this._isHover&&this._hideTooltip(!1)})).on("clearGraph",(()=>this._hideTooltip(!1))),this._modules.interactions.onHover(this._createInteraction("hover",!0)),this._modules.interactions.onClick(this._createInteraction("click")),this._modules.interactions.onDoubleClick(this._createInteraction("doubleclick"))}hide(){this._hideTooltip(!0)}isShown(){return!!this._tooltip}refresh(){this._refreshTooltip()}show(t,{position:e="top",autoAdjust:s=!0,className:n,x:i=0,y:r=0}={}){this._showTooltip(t,{position:e,autoAdjust:s,className:n},{x:i,y:r})}setHandler(t,e,s){const n={...oV,...s};n.position&&nV.indexOf(n.position)===-1&&(n.position="top"),this._handlers[t]={handler:e,condition:qs(aV,t),settings:n}}_hideTooltip(t){if(this._timeout&&(this._modules.dom.clearTimeout(this._timeout),this._timeout=null),t&&(this._currentHandlerName=null),this._tooltip){const e=this._tooltip;this._tooltip.parentNode&&this._tooltip.parentNode.removeChild(this._tooltip),this._tooltip=null,this._modules.events.fire("tooltipHide",{tooltip:e})}}_createInteraction(t,e=!1){return{priority:"tooltip",check:s=>{const n=J1(t,s),i=this._handlers[n];return(!e||!this._modules.connectNodes.enabled())&&(!(!i||!i.condition(s))||!(e||!this._currentHandlerName||this._isHover)&&this._tooltip!==null)},handler:s=>{const{target:n,x:i,y:r}=s;this._hideTooltip(!1),this._isHover=e,this._elt=n,this._x=i,this._y=r,this._currentHandlerName=J1(t,s),this._refreshTooltip()}}}_refreshTooltip(){if(!this._currentHandlerName)return void this._hideTooltip(!1);const t=this._handlers[this._currentHandlerName];if(!t)return;const{settings:e,handler:s}=t,n=this._elt;if(n){const r=n.isNode?"node":"edge";if(this._currentHandlerName.indexOf(r)===-1)return}const i=s(n);Promise.resolve(i).then((r=>this._schedule((()=>this._showTooltip(r,e)),e.delay)))}_schedule(t,e){this._timeout&&this._modules.dom.clearTimeout(this._timeout),this._timeout=this._modules.dom.setTimeout((()=>{this._timeout=null,t()}),e)}_showTooltip(t,e,s){this._hideTooltip(!1);const{position:n,className:i,autoAdjust:r}=e;let o=this._x,a=this._y,l=this._elt;const u=this._modules.dom.getDimensions();let h=0,g=0;if(s&&(o=s.x,a=s.y,l=null),typeof t=="string")this._tooltip=uV("div"),xT(this._tooltip,Ux.sanitize(t));else{if(!u2(t))throw new Error(`invalid tooltip ${t}, expected HTML string or HTML element`);this._tooltip=t}const f=this._tooltip;if(i&&this._tooltip.classList.add(i),n!=="cssDefined"&&(f.style.position="absolute"),f.style.zIndex=iV.toString(),this._modules.dom.appendElement(f),l&&l.isNode){const _=l,x=_.getPositionOnScreen(),v=Number(_.getAttribute("radius"))*(_.getAttribute("scalingMethod")==="fixed"?1:this._modules.camera.getZoom())+Number(_.getAttribute("innerStroke.width"))+Number(_.getAttribute("outerStroke.width"));o=x.x,a=x.y,h=v,g=v}const p=f.offsetWidth/2,y=f.offsetHeight/2;if(h+=p,g+=y,n&&n!=="cssDefined"){const _=rV[n];let x=_.x,v=_.y;if(r){const b=o+h*_.x,S=a+g*_.y;(b-p<0||b+p>=u.width)&&(n==="left"||n==="right"?x*=-1:x=b-p<0?(p-b+1)/h:(u.width-(b+p)-1)/h),(S-y<0||S+y>=u.height)&&(n==="top"||n==="bottom"?v*=-1:v=S-y<0?(y-S+1)/g:(u.height-(S+y)-1)/g)}f.style.left=o+h*x-p+"px",f.style.top=a+g*v-y+"px"}this._modules.events.fire("tooltipShow",{tooltip:f})}};function J1(t,{button:e,target:s}){return`${t}${e?`.${e}`:""}.${s!==null?s.isNode?"node":"edge":"background"}`}function uV(t){return oo?document.createElement(t):af()}var Vd={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",46:"del",8:"backspace",32:"space",224:"cmd",91:"cmd",92:"cmd",93:"cmd",187:"+",189:"-"},tA=Object.keys(Vd).reduce(((t,e)=>{const s=Vd[e];return t[s]||(t[s]=[]),t[s].push(e),t}),{}),dV=38,hV=40,cV=37,gV=39,fV=187,pV=189,mV=class extends Ke{constructor(){super(...arguments),this._onKeyPress=t=>{if((t==="zoomIn"||t==="zoomOut")&&!this._modules.settings.get("interactions.zoom.keyboard")||(t==="moveUp"||t==="moveDown"||t==="moveLeft"||t==="moveRight")&&!this._modules.settings.get("interactions.pan.keyboard")||this._modules.dom.hasFocus()===!1)return;const{width:e,height:s}=this._ogma.view.getGraphBoundingBox(),n=Math.max(e,s)/10,i={duration:150,easing:"cubicOut"};if(t==="zoomIn")return this._ogma.view.zoomIn(i);if(t==="zoomOut")return this._ogma.view.zoomOut(i);const r={x:0,y:0};return t==="moveLeft"?r.x=-n:t==="moveRight"?r.x=n:t==="moveUp"?r.y=-n:t==="moveDown"&&(r.y=n),this._ogma.view.move(r,i)},this._onBlur=()=>this.resetKeys(),this._onKeyUp=t=>{const e=t.keyCode||t.which;this._pressed[e]=!1,this._modules.events.fire("keyup",{domEvent:t,key:Vd[e],code:e})},this._onKeyDown=t=>{const e=t.keyCode||t.which,s=this._binds[e];if(!this._pressed[e]){if(this._pressed[e]=!0,s)for(const n of s)n.keys.every((i=>i.some((r=>this._pressed[r]))))&&n.handler({domEvent:t});this._modules.events.fire("keydown",{domEvent:t,key:Vd[e],code:e})}}}onMounted(){this._modules.events.register(["keyup","keydown"]),this._binds=[],this._pressed=[],this._modules.dom.addWindowEventListener("keydown",this._onKeyDown).addWindowEventListener("keyup",this._onKeyUp).addWindowEventListener("visibilitychange",this._onBlur).addWindowEventListener("blur",this._onBlur,!1),this._idleTimeout=4e3,this._prevEventTimeStamp=$n(),this._modules.events.onAnyEvent((()=>{const t=$n();t-this._prevEventTimeStamp>this._idleTimeout&&this.resetKeys(),this._prevEventTimeStamp=t})),this._modules.settings.register("interactions.pan.keyboard",!0),this._modules.settings.register("interactions.zoom.keyboard",!0),this._setupManualControls()}_setupManualControls(){this.onKeyPress(fV,(()=>this._onKeyPress("zoomIn"))).onKeyPress(pV,(()=>this._onKeyPress("zoomOut"))).onKeyPress(dV,(()=>this._onKeyPress("moveUp"))).onKeyPress(hV,(()=>this._onKeyPress("moveDown"))).onKeyPress(cV,(()=>this._onKeyPress("moveLeft"))).onKeyPress(gV,(()=>this._onKeyPress("moveRight")))}setIdleTimeout(t){if(!isFinite(t)||t<=1)throw new TypeError("Idle timeout must be a positive number > 1");this._idleTimeout=t}resetKeys(){for(let t=0;t<this._pressed.length;t++)this._pressed[t]&&(this._pressed[t]=!1,this._modules.events.fire("keyup",{key:Vd[t],code:t}))}onKeyPress(t,e){let s=[];if(typeof t=="number")s=[t];else if(typeof t=="string")s=t.split(" ");else{if(!Array.isArray(t))throw new TypeError(`${t} is not a number, string or array`);s=t}if(s.length===0)throw new Error("the array should contain at least one element");const n=s.map((o=>{if(typeof o=="number")return[o];if(typeof o=="string"){const a=tA[o];if(!a)throw new Error(`${o} is not a valid key identifier`);return a}throw new TypeError(`${o} is not a valid key identifier`)})),i=n.pop(),r={keys:n,handler:e};return i&&i.forEach((o=>{this._binds[o]||(this._binds[o]=[]),this._binds[o].push(r)})),this}isPressed(t){if(typeof t=="number")return this._pressed[t];if(typeof t=="string"){const e=tA[t];if(e)return e.some((s=>this._pressed[s]))}return!1}},_V=[{name:"color",isNode:!0},{name:"shape",isNode:!0},{name:"radius",isNode:!0},{name:"icon.content",isNode:!0},{name:"image.url",isNode:!0},{name:"image",isNode:!0},{name:"color",isNode:!1},{name:"shape",isNode:!1},{name:"width",isNode:!1}],uo=Math.PI,ho=2*Math.PI,Jk=Math.cos(uo/2-ho/5),tN=Math.cos(uo/2-ho/5*2),eN=Math.cos(uo/2-ho/5*3),sN=Math.cos(uo/2-ho/5*4),nN=Math.sin(-uo/2+ho/5),iN=Math.sin(-uo/2+ho/5*2),rN=Math.sin(-uo/2+ho/5*3),oN=Math.sin(-uo/2+ho/5*4),Tf=1.6,aN=3,yV=.9,vg=.31,x_=1/3,xV=[8,3],vV=[3,3],bg={position:"bottom",widgetWidth:130,fontFamily:"Arial",fontSize:10,fontColor:"black",titleFontSize:12,titleFontColor:"black",titleMaxLength:20,titleTextAlign:"left",shapeColor:"grey",backgroundColor:"white",borderColor:"black",borderRadius:0,borderWidth:1,innerMargin:10,outerMargin:5,circleStrokeWidth:3,titleFunction:t=>t[t.length-1]},bV=["widgetWidth","fontSize","titleFontSize","borderRadius","borderWidth","innerMargin","outerMargin","circleStrokeWidth"];function lN(t){return Array.isArray(t)?t.reduce(((e,s)=>e&&lN(s)),!0):t==="undefined"||!isNaN(Number(t))}function uN(t){return Array.isArray(t)?t.reduce(((e,s)=>Math.min(e,uN(s))),1/0):typeof(t=Number(t))=="number"?isNaN(t)?1/0:+t:1/0}function dN(t){return Array.isArray(t)?t.reduce(((e,s)=>Math.max(e,dN(s))),-1/0):typeof(t=Number(t))=="number"?isNaN(t)?-1/0:+t:-1/0}function ro(t){const e=["K","M","B","T","P","E","Z","Y"];if(t>9999){let s=0;for(;s<e.length&&t>999;)t/=1e3,s++;return(eA(t,3)+e[s-1]).toString()}return eA(t,4).toString()}function eA(t,e=3){const s=e===4?10:1;return t<10?Math.round(100*t*s)/(100*s):t<100?Math.round(10*t*s)/(10*s):t<1e3?Math.round(t*s)/s:Math.round(t)}function hN(t){return t.innerMargin+(t.titleFontSize+t.fontSize)*Tf}var EV=(t,e)=>t.isNode!==e.isNode?t.isNode?-1:1:t.title<=e.title?-1:1,SV=(t,e)=>t.height-e.height,AV=(t,e)=>t.isNode!==e.isNode?t.isNode?-1:1:e.height-t.height,wV=(t,e)=>t.isNode!==e.isNode?t.isNode?-1:1:t.content[0].title<=e.content[0].title?-1:1;function TV(t,e,s){const n=e.getContext("2d"),{x:i,y:r,height:o,isNode:a,styleProperty:l,title:u,mapping:h,iconFont:g,iconFontStyle:f}=s;kV(n,t,i,r,o),NV(n,t,u,i,r);const p=t.fontSize*Tf,y=t.fontSize/2*Tf*yV,_=t.fontSize*aN,x=t.fontSize,v=LV(t,a);let b=r+hN(t);const S=i+t.innerMargin+v/2,A=i+2*t.innerMargin+v,w=Id(h),L=lN(w),I=t.fontColor,F=t.shapeColor,O=Object.keys(h);if(L&&(O.sort(((V,j)=>Kr(h[j])-Kr(h[V]))),l==="radius"||l==="width")){const V=uN(w),j=dN(w);return(a?$V:qV)(t,n,i,b,V,(V+j)/2,j,F)}O.forEach((V=>{const j=h[V];l==="color"&&(a?cN(n,S,b,y,V):IV(n,S,b,_,x,V)),l==="shape"&&(a?BV(n,S,b,y,V,F):jV(n,S,b,_,x,V,F)),l==="icon.content"&&RV(n,S,b,V,g,y,I,f),l!=="image"&&l!=="image.url"||FV(n,S,b,y,V),MV(n,t,A,b,j,L),b+=p}))}function CV(t,e,s,n,i,r){t.beginPath(),t.arc(e,s,n,0,ho),t.strokeStyle=i,t.lineWidth=r,t.stroke()}function Mh(t,e,s,n,i="left",r="normal"){t.textAlign=i,t.textBaseline="middle",t.fillStyle=n,t.font=`${r} ${s}px "${e}"`}function LV(t,e){const s=e?1:aN;return t.fontSize*s}function kV(t,e,s,n,i){return HV(t,s,n,e.widgetWidth,i,e.borderRadius,e.backgroundColor,e.borderColor,e.borderWidth)}function NV(t,e,s,n,i){Mh(t,e.fontFamily,e.titleFontSize,e.titleFontColor,e.titleTextAlign);const r=e.titleTextAlign==="center",o=e.widgetWidth-2*e.innerMargin,a=t.measureText(s).width,l=n+(r?e.widgetWidth/2:e.innerMargin),u=i+e.titleFontSize/2+e.innerMargin;if(a>o){const h=o/a,g=(s.length*h|0)-2;s=s.substr(0,g)+""}t.fillText(s,l,u)}function MV(t,e,s,n,i,r){let o=i.join();if(r)if(i.length===1)o=ro(i[0]);else{const a=Kr(i),l=Hl(i);o=`${ro(a)} - ${ro(l)}`}Mh(t,e.fontFamily,e.fontSize,e.fontColor),t.fillText(o,s,n)}function cN(t,e,s,n,i){t.beginPath(),t.arc(e,s,n,0,2*uo),t.fillStyle=i,t.fill()}function IV(t,e,s,n,i,r){t.fillStyle=r,t.fillRect(e-n/2,s-i/2,n,i)}function RV(t,e,s,n,i,r,o,a){Mh(t,i,2*r,o,"center",a),t.fillText(n,e,s)}function FV(t,e,s,n,i){if(typeof Image>"u")return;t._imgStore||(t._imgStore={});let r=t._imgStore[i];if(r)return t.drawImage(r,e-n,s-n,2*n,2*n);r=new Image,r.src=i,r.onload=()=>{t.drawImage(r,e-n,s-n,2*n,2*n)},t._imgStore[i]=r}function PV(t,e,s,n){t.fillRect(e-n,s-n*vg,2*n,2*n*vg),t.fillRect(e-n*vg,s-n,2*n*vg,2*n)}function zV(t,e,s,n){return t.beginPath(),t.moveTo(e-n,s),t.lineTo(e,s-n),t.lineTo(e+n,s),t.lineTo(e,s+n),t.fill()}function DV(t,e,s,n){t.beginPath(),t.moveTo(e,s-n),t.lineTo(e+Jk*n,s+nN*n),t.lineTo(e+tN*n,s+iN*n),t.lineTo(e+eN*n,s+rN*n),t.lineTo(e+sN*n,s+oN*n),t.fill()}function OV(t,e,s,n){t.beginPath(),t.moveTo(e,s-n),t.lineTo(e+tN*n,s+iN*n),t.lineTo(e+sN*n,s+oN*n),t.lineTo(e+Jk*n,s+nN*n),t.lineTo(e+eN*n,s+rN*n),t.fill()}function BV(t,e,s,n,i,r){switch(t.fillStyle=r,i){case"square":return t.fillRect(e-n,s-n,2*n,2*n);case"circle":return cN(t,e,s,n,r);case"cross":return PV(t,e,s,n);case"diamond":return zV(t,e,s,n);case"equilateral":return DV(t,e,s,n);case"star":return OV(t,e,s,n)}}function UV(t,e,s,n,i){t.fillRect(e-n/2,s-i/4,n*(1-x_),i/2),t.beginPath(),t.moveTo(e+n*(1-x_-.5),s-i/2),t.lineTo(e+n*(1-x_-.5),s+i/2),t.lineTo(e+n/2,s),t.fill()}function GV(t,e,s,n,i,r,o){t.beginPath(),t.moveTo(e-n/2,s),t.lineTo(e+n/2,s),t.strokeStyle=r,t.lineWidth=i/2,t.setLineDash(o==="dashed"?xV:vV),t.stroke()}function VV(t,e,s,n,i){t.beginPath(),t.moveTo(e-n/2,s-i/2),t.lineTo(e-n/2,s+i/2),t.lineTo(e+n/2,s),t.fill()}function jV(t,e,s,n,i,r,o){return t.fillStyle=o,r==="line"&&t.fillRect(e-n/2,s-i/4,n,i/2),r==="arrow"?UV(t,e,s,n,i):r==="dashed"||r==="dotted"?GV(t,e,s,n,i,o,r):r==="tapered"?VV(t,e,s,n,i):void 0}function HV(t,e,s,n,i,r,o,a,l){t.setLineDash([]),t.beginPath(),t.moveTo(e+r,s),t.lineTo(e+n-r,s),t.quadraticCurveTo(e+n,s,e+n,s+r),t.lineTo(e+n,s+i-r),t.quadraticCurveTo(e+n,s+i,e+n-r,s+i),t.lineTo(e+r,s+i),t.quadraticCurveTo(e,s+i,e,s+i-r),t.lineTo(e,s+r),t.quadraticCurveTo(e,s,e+r,s),t.closePath(),t.fillStyle=o,t.fill(),t.strokeStyle=a,t.lineWidth=l,t.stroke()}function $V(t,e,s,n,i,r,o,a){const l=.7*t.fontSize,u=3*l,h=(l+u)/2,g=s+t.innerMargin+u,f=g+u+t.innerMargin,p=n+2*u-.5*t.innerMargin,y=t.circleStrokeWidth;for(const _ of[l,h,u])CV(e,g,p-_,_,a,y);Mh(e,t.fontFamily,t.fontSize,t.fontColor,"left"),e.fillText(ro(i),f,p+l-2*l),e.fillText(ro(r),f,p+l-2*h),e.fillText(ro(o),f,p+l-2*u)}function qV(t,e,s,n,i,r,o,a){const l=(t.widgetWidth-2*t.innerMargin)/3,u=t.fontSize,h=n-t.innerMargin/2,g=h+2*u,f=s+t.innerMargin;e.fillStyle=a,e.fillRect(f,h-u/2,l+1,u),e.fillRect(f+l,h-u/3,l+1,u/1.5),e.fillRect(f+2*l,h-u/6,l,u/3),Mh(e,t.fontFamily,t.fontSize,t.fontColor,"center"),e.fillText(ro(o),f+.5*l,g),e.fillText(ro(r),f+1.5*l,g),e.fillText(ro(i),f+2.5*l,g)}function YV(t,e,s,n){const i=n.outerMargin+hN(n),r=n.fontSize*Tf,o=i-.8*n.innerMargin;return e==="radius"||e==="width"?o+r*(s?3:2):o+Object.keys(t).length*r}function WV(t,e,s){const n={width:e.width,height:e.height};let i=!1;return!!(n.width&&n.height&&s)&&(i=t.position==="top"||t.position==="bottom"?QV(n,t,s,t.position==="bottom"):XV(n,t,s,t.position==="left"),i&&s.forEach((r=>TV(t,e,r))),i)}function XV(t,e,s,n){const i=e.widgetWidth+e.outerMargin,r=Math.floor((t.width-e.outerMargin)/i),o=t.height;let a=e.outerMargin,l=n?e.outerMargin:t.width-i,u=1;s=s.slice().sort(EV);for(let h=0;h<s.length;++h){const g=s[h];if(a+g.height>o){if(a===e.outerMargin)return!1;a=e.outerMargin,u+=1,n?l+=i:l-=i}g.x=l,g.y=a,a+=g.height}return u<=r}function ZV(t,e,s){let n=null;for(let i=0;i<e.length;++i){const r=e[i];r.isNode!==t.isNode&&e.length!==1||!(n===null||r.height<e[n].height)||(n=i)}if(n!=null){const i=e[n];i.content.push(t),i.height+=t.height+s.outerMargin}}function KV(t){let e=0;for(let s=1;s<t.length;++s)t[s].height>t[e].height&&(e=s);return e}function QV(t,e,s,n){s=s.slice();const i=e.widgetWidth+e.outerMargin,r=Math.floor((t.width-e.outerMargin)/i),o=t.height-e.outerMargin,a=new Array(Math.min(r,s.length)),l=s.length;let u=0,h=0,g=0,f=0;for(let S=0;S<l;++S){const A=s[S];A.isNode?(u+=1,h+=A.height):(g+=1,f+=A.height)}const p=h+f,y=h/p,_=f/p;let x=Math.round(y*r);const v=Math.round(_*r);if(x>u?x=u:v>g&&(x=r-g),r===0)return!1;for(let S=0;S<a.length;S++)a[S]={content:[],height:0,isNode:S<x};for(let S=0;S<l;++S){const A=KV(s);ZV(s[A],a,e),s.splice(A,1)}a.every((({content:S})=>S.length===1))?a.sort(wV):a.sort(AV);let b=e.outerMargin;for(let S=0;S<a.length;++S){const A=a[S];if(A.height>o)return!1;A.content.sort(SV);let w=0;for(let L=0;L<A.content.length;++L){const I=A.content[L];I.x=b,I.y=n?t.height-w-I.height-e.outerMargin:w+e.outerMargin,w+=I.height+e.outerMargin}b+=i}return!0}var JV=class extends Ke{constructor(){super(...arguments),this._enabled=!1,this._mustRefresh=!1,this._promises=[]}onMounted(){this._modules.events.on("frame",(()=>{this._enabled&&this._mustRefresh&&this._layer.refresh()})).on(["resize","reloadFonts"],(()=>{this._mustRefresh=!0}))}enable(t={}){const e=this._settings;return this._settings={...bg,...t},this._mustRefresh=!this._enabled||!this._sameOptions(e,this._settings),this._enabled?Promise.resolve():(this._enabled=!0,this._layer=this._modules.layers.addCanvasLayer((s=>{this._drawOnCanvas(this._settings,s.canvas,vi());const n=this._promises;this._promises=[],n.forEach((i=>i())),this._mustRefresh=!1}),{isStatic:!0,noClear:!1}),this._layer.moveToTop(),this.refresh())}_afterNextUpdate(){return new Promise((t=>this._promises.push(t)))}_formatSettings(t,e){const s={...bg,...t};return bV.forEach((n=>s[n]*=e)),s}disable(){return this._enabled&&(this._enabled=!1,this._layer.destroy()),Promise.resolve()}enabled(){return this._enabled}refresh(){return this._mustRefresh=!0,this._modules.dom.refresh(),this._afterNextUpdate()}destroy(){this._enabled=!1,this._mustRefresh=!1,this._settings={...bg},this._promises=[]}getOptions(){return this._enabled?{...this._settings}:{...bg}}getCurrentOptions(){return this._settings}_sameOptions(t,e){return t===e||Object.keys(t).reduce(((s,n)=>s&&t[n]===e[n]),!0)}_drawOnCanvas(t,e,s){const n=this._formatSettings(t,s);WV(n,e,this._computeWidgetList(n))}exportOnCanvas(t,e,s){return this._drawOnCanvas(e,t,s)}export(t={}){const{width:e,height:s}={...this._modules.camera.getSize(),...t},n=vi(),i=Pn(e*n,s*n);return this._drawOnCanvas(t,i,n),Promise.resolve().then((()=>i))}_computeWidgetList(t){const e=[];return _V.forEach((({name:s,isNode:n})=>{const i=this._computeWidget(t,s,n);i&&e.push(i)})),e}_computeWidget(t,e,s){const n=this._computePropertyMapping(t,e,s);if(n){if(e!=="icon.content")return n;const i=this._getRulesForAttribute(s,"icon.font"),r=this._getRulesForAttribute(s,"icon.style");let o=null,a=null;if(i.length||(o="Arial",a="normal"),typeof i[0]=="string"&&(o=i[0],a=r[0]),o&&a)return n.iconFont=o,n.iconFontStyle=a,n}return null}_computePropertyMapping(t,e,s){const[n]=this._getRulesForAttribute(s,e),i=n&&n.mapping,r=i&&i.getValues(s);if(i&&r){const o=i.getField(),a={};return kr(r,((l,u)=>{l!==void 0&&u!=="undefined"&&(a[l]=a[l]||[],a[l].push(u))})),Object.keys(a).length===0?null:{isNode:s,title:t.titleFunction(o,e),styleProperty:e,dataProperty:o,mapping:a,height:YV(a,e,s,t)}}return null}_getRulesForAttribute(t,e){return this._modules.styleRules.getRuleList().map((s=>{const n=s.getDefinition();return qs(t?n.nodeAttributes:n.edgeAttributes,e)})).filter(ur).sort(((s,n)=>s.mapping&&n.mapping?0:s.mapping?-1:1))}},sA={layer:q2,outerStroke:{color:xL,width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:vL,minVisibleSize:0}},tj={layer:q2,color:xL,text:{backgroundColor:vL,minVisibleSize:0}},nA={duration:150,easing:"quadradicOut"},ej=class extends Ke{constructor(){super(...arguments),this._delay=16,this._manualTriggerDetection=!1,this._hovered=null,this._hoveredTextHidden=!1,this._onAnimate=({updatesPositions:t})=>{t&&this._hovered&&this._modules.graphics.isMoving(this._hovered)&&(this._manualTriggerDetection=!0,this._resetHover())},this._onBeforeNewFrame=()=>{if(this._manualTriggerDetection){this._manualTriggerDetection=!1,this._modules.captor.triggerDetection();const t=this._modules.captor.getPointedElement();t&&this._hover(t)}},this._onClear=()=>{this._hovered=null,this._timeout&&this._modules.dom.clearTimeout(this._timeout)},this._resetHover=()=>{this._hovered&&(this._unhover(this._hovered),this._modules.captor.triggerUnhover()),this._timeout&&(this._modules.dom.clearTimeout(this._timeout),this._timeout=null)}}_setAnimationOptions(t){this._animationOptions={duration:(t==null?void 0:t.duration)!==void 0?t.duration:nA.duration,easing:(t==null?void 0:t.easing)!==void 0?t.easing:nA.easing},t==null||delete t.duration,t==null||delete t.easing}setRate(t){return this._delay=t,this}replaceNullColor(t,e){t&&qs(t,e)===null&&so(t,e,this._modules.settings.get("backgroundColor"))}updateNodeAttributes(t,e){this._setAnimationOptions(t),this.replaceNullColor(t,"text.backgroundColor"),this._hoverClass.update({nodeAttributes:t,fullOverwrite:e}),this._hoverExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()}updateEdgeAttributes(t,e){this.replaceNullColor(t,"text.backgroundColor"),this.replaceNullColor(t,"text.secondary.backgroundColor"),this._setAnimationOptions(t),this._hoverClass.update({edgeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()}getHoverClassDefinition(){return this._hoverClass.getDefinition()}onMounted(){this._registerSettings(),this._setAnimationOptions(null),this._hoverExtremityHighlightedClass=this._modules.classes.createClass({name:xy,isBuiltin:!0,nodeAttributes:sA}),this._hoverClass=this._modules.classes.createClass({name:Fd,isBuiltin:!0,nodeAttributes:sA,edgeAttributes:tj}),this._modules.events.on("mouseover",(({target:t})=>t&&this._hover(t))).on("mouseout",(({target:t})=>t&&this._unhover(t))).on("animate",this._onAnimate).on("beforeNewFrame",this._onBeforeNewFrame).on("mouseout",this._resetHover).on("clearGraph",this._onClear)}_registerSettings(){this._modules.settings.register("cursor.node","pointer",((t,e)=>{this._hovered&&this._hovered.isNode&&(this._modules.graphics.removeCursorStyle(e),this._modules.graphics.addCursorStyle(t))})),this._modules.settings.register("cursor.edge","pointer",((t,e)=>{this._hovered&&!this._hovered.isNode&&(this._modules.graphics.removeCursorStyle(e),this._modules.graphics.addCursorStyle(t))})),this._modules.settings.register("nodeHover",!0,(t=>{!t&&this._hovered&&this._hovered.isNode&&this._unhover(this._hovered)})),this._modules.settings.register("edgeHover",!0,(t=>{t||!this._hovered||this._hovered.isNode||this._unhover(this._hovered)}))}setEdgeExtremitiesAttributes(t,e){this._hoverExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e})}_updateExtremityHighlightLayer(){const t=this._hoverClass.getDefinition().edgeAttributes,e=t?t.layer:void 0;this._hoverExtremityHighlightedClass.update({nodeAttributes:{layer:e},fullOverwrite:!1})}_removeTimeout(){this._timeout&&(this._modules.dom.clearTimeout(this._timeout),this._timeout=null)}_hover(t){const e=t.isNode?"nodeHover":"edgeHover";this._modules.settings.get(e)&&t&&(this._removeTimeout(),this._timeout=this._modules.dom.setTimeout((()=>{this._setElementHighlight(!0,t),this._timeout=null}),this._delay))}_unhover(t){this._removeTimeout(),this._hovered===t&&(this._setElementHighlight(!1,t),this._hoverExtremityHighlightedClass.clearNodes(),this._hovered=null)}_setElementHighlight(t,e){const s=this._modules.settings.get(e.isNode?"cursor.node":"cursor.edge");if(t?(this._modules.graphics.addCursorStyle(s),e.addClass(Fd,this._animationOptions),this._hovered=e):(this._modules.graphics.removeCursorStyle(s),e.removeClass(Fd,this._animationOptions)),e.isNode){const n=this._modules.graph.getAttribute(e.isNode,"textHidden"),i=e._index;t&&(this._hoveredTextHidden=n.get(i)!==0);const r=!t&&this._hoveredTextHidden;n.set(i,r)}else this._hoverExtremityHighlightedClass.clearNodes(),t&&e.getExtremities().addClass(xy,this._animationOptions)}},sj=class extends Ke{constructor(){super(...arguments),this.x=0,this.y=0}},nj=class{constructor(t,e){this._nodeMapping={valid:!1,values:{}},this._edgeMapping={valid:!1,values:{}},this._computeMapping=e,this._field=t,this._assignedRules=[]}getValue(t,e){const s=t.isNode,n=s?this._nodeMapping:this._edgeMapping;n.valid||(n.values=this._computeMapping(s),n.valid=!0);const i=t.getData(this._field);return Array.isArray(i)?e==="color"?i.map((r=>n.values[r])):n.values[i[0]]:n.values[i]}markAsInvalid(){this._nodeMapping.valid=!1,this._edgeMapping.valid=!1}getValues(t){return t?this._nodeMapping.values:this._edgeMapping.values}getField(){return this._field}isAssignedTo(t){return this._assignedRules.find((e=>e===t))}getAssignedRules(){return this._assignedRules.slice()}assignTo(t){this.isAssignedTo(t)||this._assignedRules.push(t)}unAssignTo(t){this._assignedRules=this._assignedRules.filter((e=>e!==t))}};function gN(t,e,s){const n=(e?t.getNodes():t.getEdges()).getData(s),i={};return n.forEach((r=>{if(!Array.isArray(r))return i[r]=1;r.forEach((o=>i[o]=1))})),Object.keys(i).sort()}function ij(t,e,s,n){const{values:i={},fallback:r}=s,o=gN(t,n,e),a={};let l=0;for(let u=0;u<o.length;++u){const h=o[u];h in i?a[h]=i[h]:(a[h]=r[l],l=(l+1)%r.length)}return a}function rj(t,{nbSlices:e,minValue:s,maxValue:n}){if(Array.isArray(t))return t.slice();const{min:i=s,max:r=n}=t,o=(r-i)/e,a=[];for(let l=1;l<e;++l)a.push(i+o*l);return a}function oj(t,e){if(Array.isArray(t))return t;const{min:s,max:n}=t,i=e.length+1,r=(n-s)/e.length,o=[];for(let a=0;a<i;a++)o.push(s+a*r);return o}function aj(t,e,s,n){const{fallback:i,stops:r={},values:o,reverse:a}=s,l=gN(t,n,e);let u=1/0,h=-1/0;for(let y=0;y<l.length;y++){const _=+l[y];Jf(_)&&(u=Math.min(u,_),h=Math.max(h,_),l[y]=_)}const g={};if(!isFinite(u)){for(let y=0;y<l.length;y++)g[l[y]]=i;return g}const f=rj(r,{nbSlices:Array.isArray(o)?o.length:o.nbSlices,minValue:u,maxValue:h}),p=oj(o,f);a&&p.reverse();for(let y=0;y<l.length;++y){const _=l[y];if(isFinite(_)){let x=0;for(;x<f.length&&f[x]<=_;)x+=1;g[_]=p[x]}else g[_]=i}return g}var lj=class extends Ke{constructor(){super(...arguments),this._mappingList=[],this._onStyleRuleRemoved=({rule:t})=>{for(const e of this._mappingList)e.unAssignTo(t.id)},this._onStyleRuleAdded=({rule:t,options:e})=>{const s=e.nodeAttributes&&typeof e.nodeAttributes!="function"?e.nodeAttributes:{},n=e.edgeAttributes&&typeof e.edgeAttributes!="function"?e.edgeAttributes:{};[...Id(s),...Id(n)].forEach((i=>{i&&this._recursiveGetMapping(i).forEach((r=>r.assignTo(t.id)))}))},this._refreshRulesAndLegend=()=>{this._mappingList.forEach((t=>{const e=t.getAssignedRules();t.markAsInvalid(),e.forEach((s=>this._modules.styleRules.refreshRule(s)))})),this._modules.legend.refresh()}}onMounted(){this._modules.events.on(["addStyleRule","updateStyleRule"],this._onStyleRuleAdded).on("removeStyleRule",this._onStyleRuleRemoved).on(["addNodes","addEdges","updateNodeData","updateEdgeData","removeNodes","beforeRemoveEdges","excludedStateChange","clearGraph"],this._refreshRulesAndLegend)}_recursiveGetMapping(t,e=[]){if(!t)return e;if(t.mapping)return e.push(t.mapping),e;if(typeof t!="object")return e;const s=Id(t).map((n=>this._recursiveGetMapping(n)));return e.concat(...s)}createMapping({field:t,values:e={},fallback:s}={field:""}){if(t=Ba(t),Array.isArray(s)?s.length===0&&(s=[void 0]):s=[s],!Ua(e))throw new Error('"mapping" should be an object');return this._createMappingFunction(ij,t,{values:e,fallback:s})}createSlices({field:t,fallback:e,stops:s={},values:n,reverse:i=!1}={field:"",values:[]}){if(t=Ba(t),Array.isArray(n)||n.nbSlices||(n.nbSlices=7),Array.isArray(s)&&Array.isArray(n)&&s.length!==n.length-1)throw new Error("there should be exactly one more value that stops");return this._createMappingFunction(aj,t,{fallback:e,stops:s,values:n,reverse:i})}_createMappingFunction(t,e,s){const n=new nj(e,(r=>t(this._modules.graph,e,s,r)));this._mappingList.push(n);const i=(r,o,a)=>n.getValue(r,a);return i.mapping=n,i}createTemplate(t){if(typeof t!="string")throw new TypeError('"template" should be a string');const e=[];let s=0,n=!1;for(;!n;){let i=-1;const r=t.indexOf("{{",s);r!==-1&&(i=t.indexOf("}}",r+2)),i!==-1?(e.push(t.substring(s,r)),e.push(t.substring(r+2,i)),s=i+2):(e.push(t.slice(s)),n=!0)}return function(i){let r=e[0];for(let o=1;o<e.length;o+=2)r+=i.getData(e[o]),r+=e[o+1];return r}}},iA=t=>t.stopPropagation(),uj=(t,e)=>{e.style.position="absolute",e.style.left="0",e.style.top="0",t.appendChild(e)},dj=t=>e=>{for(;t.firstChild;)t.removeChild(t.firstChild);for(let s=0;s<e.length;++s)uj(t,e[s])},hj=(t,e)=>{const s=document.createElement("img");return new Promise((n=>{s.addEventListener("load",(()=>{e.drawImage(s,0,0,e.canvas.width,e.canvas.height),n(e)}));const i=`data:image/svg+xml;base64,${btoa(new XMLSerializer().serializeToString(t))}`;s.src=i}))},cj=class extends Ke{constructor(){super(...arguments),this._elements=[],this._layers=[],this.readyCallbacks=[],this.render=(t,e,s,n)=>{const i=n&&n.pixelRatio?n.pixelRatio:vi(),{zoom:r,x:o,y:a,width:l,height:u}=n||this._modules.camera.getView();if(r===void 0||o===void 0||a===void 0||l===void 0||u===void 0)return null;const h=i*r;s.noClear||t.clearRect(0,0,l*i,u*i),s.isStatic||(t.save(),t.translate(l*i/2,u*i/2),t.rotate(n?-(n.angle||0):-this._modules.camera.getAngle()),t.translate(-o*h,-a*h),t.scale(h,h)),e(t),s.isStatic||t.restore()},this.createCanvas=(t,e)=>{const{width:s,height:n}=this._modules.camera.getSize(),i=e.canvas||Pn(s,n),r=e.ctx||i.getContext("2d"),o=(h=t)=>{r&&this.render(r,h,e)},a=()=>{const{width:h,height:g}=this._modules.camera.getSize(),f=vi();i.width=h*f,i.height=g*f,i.style.width=`${h}px`,i.style.height=`${g}px`,o()};let l,u;if(e.isStatic)this._modules.events.on("resize",a),l=()=>this._modules.events.off(a);else{let h=this._modules.camera.getCenter(),g=this._modules.camera.getZoom(),f=!1;const p=0;let y;const _=500,x=()=>{f||(o(),f=!0,h=this._modules.camera.getCenter(),g=this._modules.camera.getZoom())},v=()=>{f||x();const{x:A,y:w}=this._modules.camera.getCenter(),L=A-h.x,I=w-h.y,F=-L*g,O=-I*g,V=this._modules.camera.getZoom()/g,j=-this._modules.camera.getAngle();i.style.transform=`
          scale(${V})
          rotate(${-j}rad)
          translateX(${F}px)
          translateY(${O}px)
          rotate(${j}rad)
        `.replace(/\n/g,"")};u=()=>!f||(o(),f=!1,i.style.transform="scale(1) translateX(0px) translateY(0px)",!1);const b=A=>{y&&clearTimeout(y),x()},S=A=>{Date.now()<p&&y&&clearTimeout(y),y=setTimeout(u,A.duration+_),x()};this._modules.events.on("dragStart",b).on("zoomStart",S).on("dragEnd",u).on(["viewChanged","zoom","rotate","move","animate"],v),this._modules.dom.addDirectWindowEventListener("resize",u),this._modules.events.on("resize",a),l=()=>{this._modules.events.off(a).off(b).off(S).off(u).off(v),this._modules.dom.removeDirectWindowEventListener("resize",u)}}return i.style.touchAction="none",i.style.pointerEvents="none",a(),{element:i,removeListeners:l,refresh:h=>{u&&!u()||o(h)},clear:()=>r==null?void 0:r.clearRect(0,0,i.width,i.height)}},this.createSVG=t=>{const{element:e}=t;e.style["pointer-events"]="none";const s=()=>{t.draw(t.element)},n=i=>{let{zoom:r,x:o,y:a,width:l,height:u}=i||this._modules.camera.getView();if(l=Math.floor(l),u=Math.floor(u),r===void 0||o===void 0||a===void 0||l===void 0||u===void 0)return null;const h=l/2/r,g=u/2/r,f=Math.cos(-this._modules.camera.getAngle()),p=Math.sin(-this._modules.camera.getAngle()),y=f*o-p*a-h,_=p*o+f*a-g,x=l/r,v=u/r;e.style.width=`${l}px`,e.style.height=`${u}px`,e.setAttribute("width",`${l}`),e.setAttribute("height",`${u}`),e.setAttribute("viewBox",`${y} ${_} ${x} ${v}`)};return this._modules.events.on(["viewChanged","zoom","rotate","move","animate","afterImageExport"],(()=>n())),e.addEventListener("mousemove",iA),n(),s(),{element:e,removeListeners:()=>{this._modules.events.off(n)},updateTransformation:n,refresh:s}},this._createOverlay=t=>{const e=()=>{const{element:i,position:r}=t,{zoom:o,x:a,y:l,width:u,height:h}=this._modules.camera.getView();if(o===void 0||a===void 0||l===void 0||u===void 0||h===void 0)return null;const g=o,f=u/2,p=h/2,y=-this._modules.camera.getAngle(),_=(r.x-a)*g,x=(r.y-l)*g;i.style.transformOrigin="top left",i.style.transform=`translate(${f}px, ${p}px) rotate(${y}rad) translate(${_}px, ${x}px) ${t.scaled?`scale(${g}, ${g})`:""}`};this._modules.events.on(["viewChanged","zoom","rotate","move","animate","afterImageExport"],e);const{element:s,size:n}=t;return n&&(s.style.width=`${n.width}`,s.style.height=`${n.height}`),s.addEventListener("mousemove",iA),e(),{element:s,removeListeners:()=>{this._modules.events.off(e)},updateTransformation:e}},this.addLayer=(t,e="layer",s=this._elements.length)=>{const n=typeof t=="string"?dy(t):t;this._elements.push(n);const i={element:n};return i.type=e,i.getLevel=()=>this._elements.indexOf(n),i.moveTo=r=>(this._elements.splice(r,0,this._elements.splice(i.getLevel(),1)[0]),this._updateDom(this._elements),i),i.moveUp=()=>i.moveTo(i.getLevel()+1),i.moveDown=()=>i.moveTo(i.getLevel()-1),i.moveToTop=()=>i.moveTo(this._elements.length-1),i.moveToBottom=()=>i.moveTo(0),i.destroy=()=>this._removeLayer(i),i.hide=()=>(i.element&&(i.element.style.visibility="hidden"),i),i.show=()=>(i.element&&(i.element.style.visibility="visible"),i),i.isHidden=()=>i.element.style.visibility==="hidden",i.setOpacity=r=>(i.element&&(i.element.style.opacity=r.toString()),i),i.getOpacity=()=>parseFloat(i.element.style.opacity||"1"),i.setPosition=r=>{if(i.element){const o=i.element.style;o.left=`${r.x}px`,o.top=`${r.y}px`}return i},i.setSize=r=>{if(i.element&&r){const{width:o,height:a}=r,l=i.element.style;l.width=`${o}px`,l.height=`${a}px`}return i},i.moveTo(s),this._layers.push(i),i},this.addCanvasLayer=(t,e={isStatic:!1,noClear:!1},s=this._elements.length)=>{const n=this.createCanvas(t,e),{element:i,removeListeners:r,refresh:o,clear:a}=n,l=this.addLayer(i,"canvas",s);return i.classList.add("ogma-canvas-layer"),l.destroy=()=>this._removeLayer(l,r),l.refresh=o,l.clear=a,l.draw=t,l.options=e,l},this.addOverlay=(t,e=this._elements.length)=>{typeof t.element=="string"&&(t.element=dy(t.element)),t.scaled=t.scaled===void 0||t.scaled;const s=this._createOverlay(t),{element:n,removeListeners:i,updateTransformation:r}=s,o=this.addLayer(n,"overlay",e);return o._onViewChange=r,o._onDestroy=i,o.destroy=()=>this._removeLayer(o,i),o.setPosition=a=>(t.position=a,r(),o),t.size&&o.setSize(t.size),o},this.addSVGLayer=(t,e=this._elements.length)=>{const s=this.createSVG(t),{element:n,refresh:i,removeListeners:r,updateTransformation:o}=s,a=this.addLayer(n,"svg",e);return a._onViewChange=o,a._onDestroy=r,a.destroy=()=>this._removeLayer(a,r),a.refresh=i,a}}canvasToImage(t,e){const s=document.createElement("canvas");s.width=e.width,s.height=e.height;const n=s.getContext("2d");this.render(n,t.draw,{...t.options,noClear:!0},{...e,pixelRatio:1});const i=ys("image");return i.setAttribute("href",s.toDataURL("image/png")),i.setAttribute("width",s.width),i.setAttribute("height",s.height),i}exportPNG(t,e,s){const n=t.getContext("2d");let i=Promise.resolve();return e.forEach((r=>{i=i.then((()=>{var o;if(r.type!=="canvas")return(o=r._onViewChange)==null||o.call(r,s),hj(r.element,n);this.render(n,r.draw,{...r.options,noClear:!0},s)}))})),i}exportSVG(t,e,s,n){let i=Promise.resolve();return e.forEach((r=>{i=i.then((()=>{var o;return r.type==="canvas"?this.canvasToImage(r,s):((o=r._onViewChange)==null||o.call(r,s),r.element.cloneNode(!0))})).then((o=>n?t.insertBefore(o,t.querySelector(".ogma-nodes").parentNode||t.firstChild):t.appendChild(o)))})),i}export(t){const e=this._layers.sort(((i,r)=>i.getLevel()-r.getLevel())).filter((i=>i.type==="canvas"||i.type==="svg")),s=this.ogmaLayer?this.ogmaLayer.getLevel():0,n=t.below?e.filter((i=>i.getLevel()<s)):e.filter((i=>i.getLevel()>s));return t.canvas?this.exportPNG(t.canvas,n,t.view):this.exportSVG(t.svg,n,t.view,t.below)}onMounted(){const t=this._modules.graphics.getDomElement();this._updateDom=dj(t);const e=t.firstChild;e&&(this.ogmaLayer=this.addLayer(e)),this.runCallbacks()}runCallbacks(){this.ogmaLayer&&(this.readyCallbacks.forEach((t=>t())),this.readyCallbacks=[])}whenReady(t){this.readyCallbacks.push(t),this.ogmaLayer&&this.runCallbacks()}_removeLayer(t,e){return t.element&&t.element.parentNode&&(this._elements.splice(t.getLevel(),1),e&&e(),t.element=null,this._updateDom(this._elements)),this._layers=this._layers.filter((s=>s!==t)),t}destroy(){this._elements=[]}},gj=class extends Ke{onMounted(){const t=this._modules.graph;this._nodeList=t.getNodeAttribute("object"),this._edgeList=t.getEdgeAttribute("object"),this._sourceList=t.getEdgeAttribute("source"),this._targetList=t.getEdgeAttribute("target"),this._excludedList=t.getEdgeAttribute("excluded"),this._virtualList=t.getEdgeAttribute("virtual")}shortestPath(t={source:void 0,target:void 0}){const{source:e,target:s,directed:n=!1,edges:i=this._ogma.getEdges(),nodes:r=this._ogma.getNodes(),edgeCostFunction:o=(()=>1),heuristicFunction:a=(()=>0)}=t,l=i.reduce(((_,x)=>(_[x._index]=!0,_)),{}),u=r.reduce(((_,x)=>(_[x._index]=!0,_)),{}),h=this._modules.graph.getNode(e),g=this._modules.graph.getNode(s);if(!h)throw new Error("the source is not a node");if(!g)throw new Error("the target is not a node");const f=h._index,p=g._index;u[f]=!0,u[p]=!0;let y=null;if(f===p)y={nodes:h.toList(),edges:this._modules.graph.edgeList()};else{const _=this._modules.graph.getNodeMaxIndex()+1,x=new Int32Array(_),v=new Float32Array(_),b=new Float32Array(_),S=new Set,A=new P2(b);for(v.fill(1/0),b.fill(1/0),x.fill(-1),A.add(f),v[f]=0,b[f]=a(h,g);!A.isEmpty();){const w=A.removeMin();if(w===p){y=this._constructPath(x,f,p);break}S.add(w);const L=this._modules.graph.getAdjacentDirections(w);if(L)for(let I=0;I<L.length;++I){const F=L[I],O=this._modules.graph.getEdgeIndexesInDirection(F);let V=-1,j=0,Z=-1;for(let at=0;at<O.length;++at){const pt=O[at],K=this._sourceList.get(pt),ut=this._targetList.get(pt);if(K===ut||!u[K]||!u[ut]||n&&w!==K||!l[pt])continue;const ht=o(this._edgeList.get(pt));(V===-1||ht<j)&&(V=pt,j=ht,Z=K===w?ut:K)}if(Z!==-1||S.has(Z)){const at=v[w]+j;if(!A.has(Z)||at<v[Z]){const pt=this._nodeList.get(w);x[Z]=V,v[Z]=at,b[Z]=at+a(pt,g),A.add(Z)}}}}}return Promise.resolve(y)}_constructPath(t,e,s){const n=[s],i=[];let r=s;for(;r!==e;){const o=t[r],a=this._sourceList.get(o),l=this._targetList.get(o);r=r===a?l:a,n.push(r),i.push(o)}return n.reverse(),i.reverse(),{nodes:this._modules.graph.nodeList(new Uint32Array(n)),edges:this._modules.graph.edgeList(new Uint32Array(i))}}detectCycle(t,e){const s=e.getSource(),n=e.getTarget(),i=N2(t._indexes,s._indexes,n._indexes);return i?this._modules.graph.nodeList(new Uint32Array(i)).dedupe():this._modules.graph.nodeList()}getAllSimpleCycles(t,e){const s=e.getSource(),n=e.getTarget();return new I2(t._indexes,s._indexes,n._indexes).getCycles().map((i=>this._modules.graph.nodeList(new Uint32Array(i))))}minimumSpanningTree(t,e,s){const n=this._modules.graph;t=n.getNodes(t),e=n.getEdges(e);const i=new Set;t.forEach((l=>i.add(l._index)));const r=n.getConnectedComponents(t,{filter:l=>i.has(l),internalIndexes:!0}),o={};r.forEach(((l,u)=>l.forEach((h=>o[h]=u))));const a=[];return e.forEach((l=>{const u=o[l.getSource()._index];u!==void 0&&(a[u]===void 0&&(a[u]=[]),a[u].push(l._index))})),r.map(((l,u)=>{const h=R2(l,a[u]||[],(g=>n.edge(g).getSource()._index),(g=>n.edge(g).getTarget()._index),s?g=>s(n.edge(g)):void 0);return{nodes:n.nodeList(new Uint32Array(l)),edges:n.edgeList(new Uint32Array(h))}}))}bfs({root:t,onNode:e,onEdge:s=as,directed:n=!1}){const i=this._modules.graph,r=[t],o=new Set,a={direction:n?"out":"both"};for(;r.length;){const l=r.pop();if(!o.has(l._index)){if(e(l)===!0)return;o.add(l._index),i.getAdjacentEdges(l,a).forEach((u=>{if(s(u)===!1)return;const h=u.getSource()===l?u.getTarget():u.getSource();r.unshift(h)}))}}}dfs({root:t,onNode:e,onEdge:s=as,directed:n=!1}){const i=this._modules.graph,r=[t],o=new Set,a={direction:n?"out":"both"};for(;r.length;){const l=r.pop();if(!o.has(l._index)){if(e(l)===!0)return;o.add(l._index),i.getAdjacentEdges(l,a).forEach((u=>{if(s(u)===!1)return;const h=u.getSource()===l?u.getTarget():u.getSource();r.push(h)}))}}}betweenness({nodes:t,edges:e,directed:s,normalized:n}){const i=this._ogma.getNodes().subtract(t),r=this._ogma.getEdges().subtract(e).concat(i.fastGetAdjacentElements().edges).dedupe();return F2({adjacency:t.map((o=>{const a=this._ogma.edgeList(this._ogma.modules.graph.topology.getAdjacentElements(!1,o.toList()._indexes,{direction:s?"out":"both"})).subtract(r).dedupe();return{id:o._index,adj:a.map((l=>l.getSource()._index===o._index?l.getTarget()._index:l.getSource()._index))}})),directed:s,normalized:n})}fishEyeExpand(t,e,s,n){return C2(t,e,s,n)}},rA=(t,e)=>{if(!t)throw new Error("Traversal options are required");if(typeof t.onNode!="function")throw new Error("onNode callback is required");if(t.root=e.getNode(t.root),!t.root)throw new Error(`Root node '${t.root}' does not exist`);return t},Eg=()=>({nodes:void 0,edges:void 0}),fj=class extends Rs{constructor(){super(...arguments),this.shortestPath=t=>this._ogma.modules.algorithms.shortestPath(t),this.hasCycle=t=>{const{nodes:e,edges:s}=t||Eg();return this.detectCycle({nodes:e,edges:s})!==null},this.getAllSimpleCycles=t=>{let{nodes:e,edges:s}=t||Eg();return e||(e=this._ogma.getNodes()),s||(s=e.getAdjacentEdges({bothExtremities:!0})),this._ogma.modules.algorithms.getAllSimpleCycles(e,s)},this.detectCycle=t=>{let{nodes:e,edges:s}=t||Eg();e||(e=this._ogma.getNodes()),s||(s=e.getAdjacentEdges({bothExtremities:!0}));const n=this._ogma.modules.algorithms.detectCycle(e,s);return n.size?n:null},this.minimumSpanningTree=t=>{const{nodes:e,edges:s,edgeCostFunction:n}=t||{...Eg(),edgeCostFunction:void 0};return this._ogma.modules.algorithms.minimumSpanningTree(e,s,n)},this.dfs=t=>this._ogma.modules.algorithms.dfs(rA(t,this._ogma.modules.graph)),this.bfs=t=>this._ogma.modules.algorithms.bfs(rA(t,this._ogma.modules.graph)),this.betweenness=(t={})=>(t={nodes:t.nodes||this._ogma.getNodes(),edges:t.edges||this._ogma.getEdges(),directed:t.directed!==void 0&&t.directed,normalized:t.normalized===void 0||t.normalized},this._ogma.modules.algorithms.betweenness(t)),this.getMinimumEnclosingCircle=t=>{if(!t||t.size===0)throw new Error("getMinimumEnclosingCircle: no nodes provided");const e=t.getAttribute("x"),s=t.getAttribute("y"),n=t.getAttribute("radius"),[i,r,o]=Eh(e,s,n);return{x:i,y:r,radius:o}},this.circlePack=({nodes:t,margin:e=0,origin:s={x:0,y:0},duration:n=0,easing:i="linear",sort:r,dryRun:o})=>{if(!t||t.size===0)throw new Error("circlePack: no nodes provided");let a=t.map(((u,h)=>({index:h,radius:+u.getAttribute("radius")+e,id:u.getId()})));if(r)if(r==="asc")a=a.sort(((u,h)=>h.radius-u.radius));else if(r==="desc")a=a.sort(((u,h)=>u.radius-h.radius));else{if(typeof r!="function")throw new Error("circlePack: invalid sort option");a=a.sort(((u,h)=>r(t.get(u.index),t.get(h.index))))}if(s&&(!isFinite(s.x)||!isFinite(s.y)))throw new Error("circlePack: invalid origin");const l=T2(a,s.x,s.y).reduce(((u,{index:h,x:g,y:f})=>(u[h]={x:g,y:f},u)),new Array(t.size));return o?l:t.setAttributes(l,{duration:n,easing:i}).then((()=>l))},this.fishEyeExpand=({nodes:t,focusNode:e,deltaRadius:s,duration:n=0,dryRun:i=!1,easing:r="linear",xyr:o})=>{if(!t||t.size===0)throw new Error("Expand/collapse: no nodes provided");if(!(e instanceof yi))throw new Error("Expand/collapse: no focus node provided");if(!isFinite(s))throw new Error("Expand/collapse: invalid delta radius");const a=this._ogma.modules.algorithms.fishEyeExpand(t,e,s,o);return i?a:t.setAttributes(a,{duration:n,easing:r}).then((()=>a))}}},pj=class{getHoveredElement(){return this.modules.captor.getPointedElement()}getPointerInformation(){return this.modules.captor.getCursorInformation()}},mj=class{getNodesByClassName(t,e){return this.modules.classes.getClassByName(t,!0).getNodes(e)}getEdgesByClassName(t,e){return this.modules.classes.getClassByName(t,!0).getEdges(e)}},M0={};mh(M0,{gexf:()=>fN,gexfFromUrl:()=>I0,graphml:()=>yN,graphmlFromUrl:()=>xN,janus:()=>pN,json:()=>mN,jsonFromUrl:()=>R0,mtx:()=>_j,mtxFromUrl:()=>yj,neo4j:()=>_N});var fN=t=>Promise.resolve(WC(t)),I0=t=>vu(t).then((e=>WC(e))),pN=t=>Promise.resolve(yB(t)),mN=(t,e)=>Promise.resolve(GC(t,e)),R0=(t,e)=>vu(t).then((s=>GC(s,e))),_N=t=>Promise.resolve(WB(t)),yN=(t,e)=>Promise.resolve(XC(t,e)),xN=(t,e)=>vu(t).then((s=>XC(s,e))),_j=t=>Promise.resolve(ZC(t)),yj=t=>vu(t).then((e=>ZC(e))),xj=class extends Rs{constructor(){super(...arguments),this.wait=t=>new Promise((e=>setTimeout(e,t))),this.initRandomGraph=t=>this._ogma.generate.random(t).then(this._ogma.setGraph).then((()=>this._ogma.view.locateGraph())).then((()=>this._ogma.view.afterNextFrame())),this.initGrid=t=>{const e=Math.ceil(Math.sqrt(t));return this._ogma.generate.grid({rows:e,columns:e}).then((s=>this._ogma.setGraph(s))).then((()=>this._ogma.view.locateGraph()))},this.initLine=t=>(this._ogma.setGraph({nodes:[{id:0,attributes:{x:0,y:0}},{id:1,attributes:t?{x:0,y:50}:{x:50,y:0}}],edges:[{id:0,source:1,target:0}]}),this._ogma.view.locateGraph()),this.initSingleNode=()=>(this._ogma.setGraph({nodes:[{id:0,attributes:{x:0,y:0}}],edges:[]}),this._ogma.view.locateGraph()),this.initContinuousRenderLoop=({triggerKey:t="r",start:e=!0}={})=>{let s=e;const n=()=>{s&&this._ogma.modules.dom.beforeNextFrame().then(n)};document.addEventListener("keydown",(({key:i})=>{i===t&&(s=!s,n())})),n()},this.appendToBody=()=>{const t=document.createElement("div");t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.bottom="0",t.style.right="0",document.body.appendChild(t),this._ogma.setContainer(t)},this.loadFile=t=>(t.endsWith(".gexf")?I0(t):R0(t)).then((e=>this._ogma.setGraph(e))).then((()=>this._ogma.view.locateGraph())).then((()=>this._ogma.view.afterNextFrame())),this.enableLasso=t=>{this._ogma.events.on("dragStart",(()=>{this._ogma.keyboard.isKeyPressed("ctrl")&&this._ogma.tools.lasso.enable(t)}))},this.randomizeGraph=({minX:t=0,minY:e=0,maxX:s=500,maxY:n=500}={})=>this._ogma.getNodes().setAttributes(this._ogma.getNodes().map((()=>({x:t+Math.random()*(s-t),y:e+Math.random()*(n-e)}))))}},vj=class{setContainer(t){this.modules.dom.setContainer(t)}getContainer(){return this.modules.dom.getContainer()}},bj=class extends Rs{constructor(){super(...arguments),this.once=(t,e)=>(this._ogma.modules.events.once(t,e),this),this.removeListener=t=>{this._ogma.modules.events.off(t)},this.onNodesAdded=t=>(this._ogma.events.on("addNodes",t),this._ogma),this.onBeforeNodesRemoved=t=>(this._ogma.events.on("beforeRemoveNodes",t),this._ogma),this.onNodesRemoved=t=>(this._ogma.events.on("removeNodes",t),this._ogma),this.onEdgesAdded=t=>(this._ogma.events.on("addEdges",t),this._ogma),this.onBeforeEdgesRemoved=t=>(this._ogma.events.on("beforeRemoveEdges",t),this._ogma),this.onEdgesRemoved=t=>(this._ogma.events.on("removeEdges",t),this._ogma),this.onGraphCleared=t=>(this._ogma.events.on("clearGraph",t),this._ogma),this.onNodesClassAdded=(t,e)=>(this._ogma.modules.classes.onNodeClassAdded(t,e),this._ogma),this.onNodesClassRemoved=(t,e)=>(this._ogma.modules.classes.onNodeClassRemoved(t,e),this._ogma),this.onEdgesClassAdded=(t,e)=>(this._ogma.modules.classes.onEdgeClassAdded(t,e),this._ogma),this.onEdgesClassRemoved=(t,e)=>(this._ogma.modules.classes.onEdgeClassRemoved(t,e),this._ogma),this.onNodeDragStart=t=>(this._ogma.events.on("nodesDragStart",t),this._ogma),this.onNodeDragProgress=t=>(this._ogma.events.on("nodesDragProgress",t),this._ogma),this.onNodeDragEnd=t=>(this._ogma.events.on("nodesDragEnd",t),this._ogma),this.onDrop=t=>(this._ogma.events.on("drop",t),this._ogma),this.onNodesSelected=t=>this.onNodesClassAdded(Gs,t),this.onNodesUnselected=t=>this.onNodesClassRemoved(Gs,t),this.onEdgesSelected=t=>this.onEdgesClassAdded(Gs,t),this.onEdgesUnselected=t=>this.onEdgesClassRemoved(Gs,t),this.onNodeDataChange=t=>(this._ogma.events.on("updateNodeData",t),this._ogma),this.onEdgeDataChange=t=>(this._ogma.events.on("updateEdgeData",t),this._ogma),this.onAnimate=t=>(this._ogma.events.on("animate",t),this._ogma),this.onMouseMove=t=>(this._ogma.events.on("mousemove",t),this._ogma),this.onMouseButtonDown=t=>(this._ogma.events.on("mousedown",t),this._ogma),this.onMouseButtonUp=t=>(this._ogma.events.on("mouseup",t),this._ogma),this.onClick=t=>(this._ogma.events.on("click",t),this._ogma),this.onDoubleClick=t=>(this._ogma.events.on("doubleclick",t),this._ogma),this.onMouseWheel=t=>(this._ogma.events.on("mousewheel",t),this._ogma),this.onHover=t=>(this._ogma.events.on("mouseover",t),this._ogma),this.onUnhover=t=>(this._ogma.events.on("mouseout",t),this._ogma),this.onDragStart=t=>(this._ogma.events.on("dragStart",t),this._ogma),this.onDragProgress=t=>(this._ogma.events.on("dragProgress",t),this._ogma),this.onDragEnd=t=>(this._ogma.events.on("dragEnd",t),this._ogma),this.onGestureStart=t=>(this._ogma.events.on("gestureStart",t),this._ogma),this.onGestureProgress=t=>(this._ogma.events.on("gestureProgress",t),this._ogma),this.onGestureEnd=t=>(this._ogma.events.on("gestureEnd",t),this._ogma),this.onRendererStateChange=t=>(this._ogma.events.on("rendererStateChange",t),this._ogma),this.onZoomProgress=t=>(this._ogma.events.on("zoom",t),this._ogma),this.onViewChanged=t=>(this._ogma.events.on("viewChanged",t),this._ogma),this.onNodesConnected=t=>(this._ogma.events.on("connectNodes",t),this._ogma),this.onGeoModeEnabled=t=>(this._ogma.events.on("geoEnabled",t),this._ogma),this.onGeoModeDisabled=t=>(this._ogma.events.on("geoDisabled",t),this._ogma),this.onGeoModeLoaded=t=>(this._ogma.events.on("geoLoaded",t),this._ogma),this.onLayoutStart=t=>(this._ogma.events.on("layoutStart",t),this._ogma),this.onLayoutComplete=t=>(this._ogma.events.on("layoutEnd",t),this._ogma),this.onLayoutComputed=t=>(this._ogma.events.on("layoutComputed",t),this._ogma),this.onTooltipShown=t=>(this._ogma.events.on("tooltipShow",t),this._ogma),this.onTooltipHidden=t=>(this._ogma.events.on("tooltipHide",t),this._ogma),this.onTransformationEnabled=t=>(this._ogma.events.on("transformationEnabled",t),this._ogma),this.onTransformationDisabled=t=>(this._ogma.events.on("transformationDisabled",t),this._ogma),this.onTransformationSetIndex=t=>(this._ogma.events.on("transformationSetIndex",t),this._ogma),this.onTransformationDestroyed=t=>(this._ogma.modules.events.on("transformationDestroyed",t),this._ogma),this.onTransformationRefreshed=t=>(this._ogma.events.on("transformationRefresh",t),this._ogma)}on(t,e){return this._ogma.modules.events.on(t,e),this}off(t){return this._ogma.modules.events.off(t),this}onKeyPress(t,e){return this._ogma.modules.keyboard.onKeyPress(t,e),this._ogma}};function Cf(t,e,s){if(t!=null)return Array.isArray(t)?t[0]:t}function tx(t){return t==null?null:typeof t=="string"||typeof t=="number"?`${t}`:t&&tx(t.content)}function Ej(t){if(t!=null)return typeof t=="string"?t:t.style||"line"}var Sj=["color","radius","shape","text.content","x","y"],Aj=["color","width","shape.body","text.content"];function wj(t){return t!=="all"?{nodes:["x","y"],edges:[]}:{nodes:Sj,edges:Aj}}function Tj(t,{nodes:e,edges:s}){const n=t.getOriginalAttributes();return{nodes:e.reduce(((i,r)=>(i[r.getId()]={x:n.nodes.x.get(r._index),y:n.nodes.y.get(r._index),color:Cf(n.nodes.color.get(r._index)),radius:n.nodes.radius.get(r._index),shape:n.nodes.shape.get(r._index),text:{content:n.nodes.text.content.get(r._index)}},i)),{}),edges:s.reduce(((i,r)=>(i[r.getId()]={color:Cf(n.edges.color.get(r._index)),width:n.edges.width.get(r._index),shape:{type:n.edges.shape.body.get(r._index)},text:{content:n.edges.text&&n.edges.text.content&&n.edges.text.content.get(r._index)}},i)),{})}}function Cj(t){return{nodes:t.nodes.map((({id:e,attributes:s={},data:n})=>{const{color:i,radius:r,shape:o,text:a,x:l,y:u}=s;return{id:e,x:l,y:u,color:Cf(i),size:r,shape:o,text:tx(a),data:n}})),edges:t.edges.map((({id:e,source:s,target:n,attributes:i={},data:r})=>{const{color:o,width:a,text:l,shape:u}=i;return{id:e,source:s,target:n,color:Cf(o),size:a,shape:Ej(u),text:tx(l),data:r}}))}}function oA(t){return t instanceof yi?t.getId():t}function aA(t){return t instanceof Mr?t.getId():t}function lA(t){return t instanceof lo?t.getId():t instanceof yi?[t.getId()]:Fn(t)?t.map(oA):[oA(t)]}function uA(t){return t instanceof qa?t.getId():t instanceof Mr?[t.getId()]:Fn(t)?t.map(aA):[aA(t)]}var F0="visible";function Lj(t,e){return t?lA(t):typeof e=="object"?lA(e.nodes):e||F0}function kj(t,e){return t?uA(t):typeof e=="object"?uA(e.edges):e||F0}function vN(t,e,s,n){const i=Lj(e,n),r=kj(s,n);return{nodes:t.getNodes(i),edges:t.getEdges(r)}}function bN(t,{nodeAttributes:e,edgeAttributes:s,nodes:n,edges:i,filter:r,nodeData:o,edgeData:a}){const l=vN(t,n,i,r);return{nodes:l.nodes.toJSON({attributes:e,data:o}),edges:l.edges.toJSON({attributes:s,data:a})}}function dp(t,e,{styles:s,nodes:n,edges:i,filter:r,nodeData:o,edgeData:a}){const{nodes:l,edges:u}=wj(s),h=bN(t,{nodeAttributes:l,edgeAttributes:u,nodes:n,edges:i,filter:r,nodeData:o,edgeData:a});if(s==="original"){const g=Tj(e,vN(t,n,i,r));for(const f of h.nodes)f.id!=null&&(f.attributes=g[f.id]);for(const f of h.edges)f.id!=null&&(f.attributes=g[f.id])}return s==="all"&&h.edges.forEach((({source:g,target:f,attributes:p})=>{if(p){const y=t.getNode(g);if(p.color==="source"&&y){const x=y.getAttribute("color");p.color=Array.isArray(x)?x[0]:x}const _=t.getNode(f);if(p.color==="target"&&_){const x=_.getAttribute("color");p.color=Array.isArray(x)?x[0]:x}}})),Cj(h)}function Nj(t,e){for(let s=0;s<e.length;++s){if(t==null)return;t=t[e[s]]}return t}function Mj(t,e,s){for(let n=0;n<e.length-1;++n){const i=e[n];let r=t[i];r===void 0&&(r={},t[i]=r),t=r}t[e[e.length-1]]=s}function Ij(t){const e={...t[0]};for(const s of t)for(const n of Object.keys(s))n in e||(e[n]=void 0);return Object.keys(e)}function dA(t,e){return t==null||Array.isArray(t)&&!t.length?e:t}function Rj(t){return typeof t=="string"}function Fj(t,e,s,n,i){const r=e==="edges",o={};return t.forEach(((a,l)=>{const u=i.get(l),h=Z_(dA(s(u),e));if(!h.every(Rj))throw Error(`The tab ${e} function returned an invalid value.`);const g=Z_(n(a.data,h));h.forEach(((f,p)=>{const y=dA(g[p],{}),_=lp({internal___id:a.id,...r?{internal___source:a.source,internal___target:a.target}:{},...y}).reduce(((x,{path:v,value:b})=>(x[v.join(".")]=b,x)),{});o[f]=o[f]||[],o[f].push(_)}))})),o}function Pj(t){if(!t.length)return[];const e=Ij(t),s=[e];for(const n of t)s.push(e.map((i=>n[i])));return s[0]=s[0].map((n=>n.replace("internal___",""))),s}function zj(t,e,s){const n=new GL;let i=e?1:3;const r=[];for(let a=0;a<t.length;++a){const l=t[a],u=new Array(i);let h=l.data;if(s){const f={};s.forEach((p=>{const y=Ba(p),_=Nj(h,y);Mj(f,y,_)})),h=f}const g=lp(h);u[0]=l.id,e||(u[1]=l.source,u[2]=l.target);for(let f=0;f<g.length;++f){const{path:p,value:y}=g[f];p.length&&(n.has(p)?u[n.get(p)]=y:(n.set(p,i),u[i]=y,i++))}r.push(u)}const o=[];return o.push("id"),e||(o.push("source"),o.push("target")),n.keys().forEach((a=>o.push(a[a.length-1]))),r.unshift(o),r.forEach((a=>a.length=i)),r}var Dj=/[=+\-@|%]/,Oj=t=>t.length>0&&Dj.test(t[0])?!isNaN(Number(t))&&isFinite(Number(t))?`${t}`:`'${t=t.replace("|","|")}`:t;function EN(t){return t===void 0?"":t instanceof Date?t.toISOString():Oj(""+t)}var Bj={what:void 0,dataProperties:void 0,separator:",",textSeparator:'"',download:!0,filename:"graph.csv",filter:"visible",nodes:void 0,edges:void 0,nodeData:ur,edgeData:ur,styles:"none"};function Uj(t,e){const{what:s,dataProperties:n,nodes:i,edges:r,separator:o,textSeparator:a,download:l,nodeData:u,edgeData:h,filename:g,filter:f}=Ni(typeof e=="string"?{what:e}:e,Bj),p=dp(t.modules.graph,t.modules.individualAttributes,{styles:"none",nodes:i,edges:r,filter:f,nodeData:u,edgeData:h});try{const y=Gj(p,{what:s,separator:o,textSeparator:a,dataProperties:n});return l&&ta(y,g,"text","text/csv"),Promise.resolve(y)}catch(y){return Promise.reject(y)}}function Gj(t,{what:e,separator:s,textSeparator:n,dataProperties:i}){const r=new RegExp(n,"g");if(n&&n!=='"'&&n!=="'")throw new TypeError(`Invalid argument :"textSeparator" is not single-quote or double-quote, was ${n}`);if(e!=="nodes"&&e!=="edges")throw new TypeError('missing argument: "what": should have value "nodes" or "edges"');const o=e==="nodes";return zj(o?t.nodes:t.edges,o,i).map((a=>a.map((l=>(function(h){return n+EN(h).replace(r,`${n}${n}`).replace(/\n/g,"\\n").replace(/\r/g,"")+n})(l))))).map((a=>a.join(s))).join(`
`)}var Rl=t=>Math.round(255*t);function hA(t,e){if(e==="integer"&&typeof t=="number"){if(t%1!=0)return"float"}else if(typeof t!="number")return typeof t=="boolean"?"boolean":"string";return e}var ex=t=>typeof t=="object"&&t!==null&&t.constructor===Object;function sx(t,e={}){return kr(t,((s,n)=>{ex(s)?sx(s,e):e[n]=s})),e}var Vj={creator:void 0,description:void 0,styles:"all",download:!0,filename:"graph.gexf",nodes:void 0,edges:void 0,nodeData:t=>t,edgeData:t=>t,filter:"visible"};function jj(t,e={}){const{styles:s,nodes:n,edges:i,download:r,filename:o,creator:a,description:l,filter:u,nodeData:h,edgeData:g}=Ni(e,Vj),f=Hj(dp(t.modules.graph,t.modules.individualAttributes,{styles:s,nodes:n,edges:i,filter:u,nodeData:h,edgeData:g}),{creator:a,description:l});return r&&ta(f,o,"text","text/xml"),Promise.resolve(f)}function Hj(t,e){const s=WL(),n={},i={};let r,o=0,a=0;const l=s.createElement("gexf");l.setAttribute("xmlns","http://www.gexf.net/1.2draft"),l.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz"),l.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),l.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd"),l.setAttribute("version","1.2");const u=s.createElement("meta");if(u.setAttribute("lastmodifieddate",bT()),e.creator){const _=s.createElement("creator");r=s.createTextNode(""+e.creator),_.appendChild(r),u.appendChild(_)}if(e.description){const _=s.createElement("description");r=s.createTextNode(""+e.description),_.appendChild(r),u.appendChild(_)}const h=s.createElement("graph");h.setAttribute("mode","static");const g=s.createElement("nodes");t.nodes.forEach((_=>{const x=s.createElement("node");if(x.setAttribute("id",String(_.id)),_.text&&x.setAttribute("label",jl(_.text)),ex(_.data)){const b=sx(_.data),S=s.createElement("attvalues");Object.keys(b).forEach((A=>{A in n||(n[A]={id:o,type:"integer"},o++);const w=b[A];n[A].type=hA(w,n[A].type);const L=s.createElement("attvalue");L.setAttribute("for",n[A].id),L.setAttribute("value",jl(w)),S.appendChild(L)})),x.appendChild(S)}if(_.color){const b=Wn(_.color);if(b){const S=s.createElement("viz:color");S.setAttribute("r",Rl(b[0])),S.setAttribute("g",Rl(b[1])),S.setAttribute("b",Rl(b[2])),S.setAttribute("a",b[3]),x.appendChild(S)}}const v=s.createElement("viz:position");if(v.setAttribute("x",_.x),v.setAttribute("y",-_.y),x.appendChild(v),_.size){const b=s.createElement("viz:size");b.setAttribute("value",_.size),x.appendChild(b)}g.appendChild(x)}));const f=s.createElement("attributes");f.setAttribute("class","node"),Object.keys(n).forEach((_=>{const x=s.createElement("attribute");x.setAttribute("id",n[_].id),x.setAttribute("title",_),x.setAttribute("type",n[_].type),f.appendChild(x)}));const p=s.createElement("edges");t.edges.forEach((_=>{const x=s.createElement("edge");if(x.setAttribute("id",_.id.toString()),x.setAttribute("source",_.source),x.setAttribute("target",_.target),_.size&&x.setAttribute("weight",_.size),_.text&&x.setAttribute("label",jl(_.text)),ex(_.data)){const v=sx(_.data),b=s.createElement("attvalues");Object.keys(v).forEach((S=>{S in i||(i[S]={id:a,type:"integer"},a++);const A=v[S];i[S].type=hA(A,i[S].type);const w=s.createElement("attvalue");w.setAttribute("for",i[S].id),w.setAttribute("value",jl(A)),b.appendChild(w)})),x.appendChild(b)}if(_.color){const v=Wn(_.color);if(v){const b=s.createElement("viz:color");b.setAttribute("r",Rl(v[0])),b.setAttribute("g",Rl(v[1])),b.setAttribute("b",Rl(v[2])),b.setAttribute("a",v[3]),x.appendChild(b)}}if(_.size){const v=s.createElement("viz:size");v.setAttribute("value",_.size),x.appendChild(v)}p.appendChild(x)}));const y=s.createElement("attributes");return y.setAttribute("class","edge"),Object.keys(i).forEach((_=>{const x=s.createElement("attribute");x.setAttribute("id",i[_].id),x.setAttribute("title",_),x.setAttribute("type",i[_].type),y.appendChild(x)})),h.appendChild(f),h.appendChild(y),h.appendChild(g),h.appendChild(p),l.appendChild(u),l.appendChild(h),s.appendChild(l),`<?xml version="1.0" encoding="UTF-8"?>${s.serialize()}`}var $j={graphId:"G",directedEdges:!0,styles:"all",download:!0,filename:"graph.graphml",nodes:void 0,edges:void 0,nodeData:t=>t,edgeData:t=>t,filter:"visible"};function qj(t,e){const{styles:s,nodes:n,edges:i,download:r,filename:o,graphId:a,directedEdges:l,filter:u,nodeData:h,edgeData:g}=Ni(e,$j),f=Yj(dp(t.modules.graph,t.modules.individualAttributes,{styles:s,nodes:n,edges:i,filter:u,nodeData:h,edgeData:g}),{graphId:a,directedEdges:l,noStyles:s==="none"});return r&&ta(f,o,"text","text/xml"),Promise.resolve(f)}function Yj(t,e){const s=XL();function n(f,p,y,_,x){y=y||{};const v=s.createElement(p);for(const b in y){if(!Object.prototype.hasOwnProperty.call(y,b))continue;const S=y[b];S!==void 0&&v.setAttribute(b,S)}return(_!==void 0||x)&&(Object.prototype.toString.call(_)==="[object Object]"&&(_=JSON.stringify(_)),v.appendChild(s.createTextNode(_))),f.appendChild(v),v}const i=["id","source","target"],r=["size","x","y","shape","text","color"],o={size:{for:"all",type:"double"},x:{for:"node",type:"double"},y:{for:"node",type:"double"},shape:{for:"all",type:"string"},color:{for:"all",type:"string"},r:{for:"all",type:"int"},g:{for:"all",type:"int"},b:{for:"all",type:"int"},a:{for:"all",type:"double"},text:{for:"all",type:"string"}};e.noStyles&&(delete o.color,delete o.r,delete o.g,delete o.b,delete o.a,delete o.shape,r.pop());const a=[],l=[];function u(f,p){const y={id:f.id};r.forEach((_=>{let x=f[_];_==="y"&&x&&(x=-parseFloat(x)),x!==void 0&&(y[(p==="edge"?"edge_":"")+_]=x,_==="color"&&(function(b,S){const A=Wn(S);A&&(b.r=A[0],b.g=A[1],b.b=A[2])})(y,x))})),kr(f.data||{},((_,x)=>{r.indexOf(x)===-1&&i.indexOf(x)===-1&&(o[x]?o[x].for!==p&&(o[x].for="all"):o[x]={for:p,type:"string"},y[x]=_)})),p==="edge"?(y.source=f.source,y.target=f.target,l.push(y)):a.push(y)}t.nodes.forEach((f=>u(f,"node"))),t.edges.forEach((f=>u(f,"edge")));const h=n(s,"graphml",{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml","xmlns:java":"http://www.yworks.com/xml/yfiles-common/1.0/java","xmlns:sys":"http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0","xmlns:x":"http://ww.yworks.com/xml/yfiles-common/markup/2.0"});kr(o,((f,p)=>{f.for!=="node"&&f.for!=="all"||n(h,"key",{"attr.name":p,"attr.type":f.type,for:"node",id:p}),f.for!=="edge"&&f.for!=="all"||n(h,"key",{"attr.name":p,"attr.type":f.type,for:"edge",id:"edge_"+p})})),n(h,"key",{id:"nodegraphics",for:"node","yfiles.type":"nodegraphics","attr.type":"string"}),n(h,"key",{id:"edgegraphics",for:"edge","yfiles.type":"edgegraphics","attr.type":"string"});const g=n(h,"graph",{edgedefault:e.directedEdges||e.directedEdges===void 0?"directed":"undirected",id:e.graphId?e.graphId:"G","parse.nodes":t.nodes.length,"parse.edges":t.edges.length,"parse.order":"nodesfirst"});return a.forEach((f=>{const p=n(g,"node",{id:f.id});(function(_,x){const v=n(_,"data",{key:"nodegraphics"}),b=n(v,"y:ShapeNode");n(b,"y:Geometry",{x:x.x,y:x.y,width:x.size,height:x.size}),e.noStyles||n(b,"y:Fill",{color:Cy(x.color),transparent:!1}),n(b,"y:NodeLabel",null,x.text||""),n(b,"y:Shape",{type:x.shape})})(p,f),kr(f,((y,_)=>{i.indexOf(_)===-1&&n(p,"data",{key:_},y,!0)}))})),l.forEach((f=>{const p=n(g,"edge",{id:f.id,source:f.source,target:f.target});(function(_,x){const v=n(_,"data",{key:"edgegraphics"}),b=n(v,"y:PolyLineEdge");n(b,"y:LineStyle",{type:x.edge_type,color:e.noStyles?void 0:Cy(x.edge_color),width:x.edge_size}),n(b,"y:EdgeLabel",null,x.edge_label)})(p,f),kr(f,((y,_)=>{i.indexOf(_)===-1&&n(p,"data",{key:_},y,!0)}))})),`<?xml version="1.0" encoding="UTF-8"?>
${T0(s)}`}var Wj={nodeAttributes:["x","y","color","radius","shape","text"],edgeAttributes:["color","width","text"],nodeData:ur,edgeData:ur,filter:"visible",pretty:!1,download:!0,filename:"graph.json",anonymize:!1};function Xj(t,e={}){e.anonymize&&(e={nodeAttributes:"all",edgeAttributes:"all",nodeData:tf,edgeData:tf,filter:e.filter||"all",download:e.download,pretty:e.pretty,filename:e.filename});const{nodeAttributes:s,edgeAttributes:n,nodeData:i,edgeData:r,filter:o,pretty:a,download:l,filename:u}=Ni(e,Wj),h=bN(t.modules.graph,{nodeAttributes:s,edgeAttributes:n,filter:o,nodeData:i,edgeData:r}),g=a?JSON.stringify(h,null," "):JSON.stringify(h);return l&&ta(g,u,"text","application/json"),Promise.resolve(h)}function Zj(t,e){return t.getBoundingBox().computeForZoom(e).extend(ri.fromValues(t.getAttribute("x"),t.getAttribute("y"),t.map((s=>s.getAttribute("radius")+s.getAttribute("innerStroke.width")+s.getAttribute("outerStroke.width")))))}function Kj(t,e,s){const n=e.view.graphToScreenCoordinates(s.bottomLeft()),i=e.view.graphToScreenCoordinates(s.topRight()),r=Math.abs(i.x-n.x),o=Math.abs(i.y-n.y),a=Math.min(t.width/r,t.height/o);t.width=r*a,t.height=o*a}function SN(t,e={}){const s=t.view.get(),n=typeof e.margin=="number"?e.margin:0,i={pixelRatio:e.pixelRatio||vi(),angle:0,backgroundColor:null,zoom:0,x:0,y:0,width:0,height:0,hideImages:!1,renderBackground:!0,isBufferDisplayable:Jg};if(e.width&&e.height?(i.width=e.width,i.height=e.height):(i.width=s.width,i.height=s.height),e.clip)i.zoom=s.zoom,i.x=s.x,i.y=s.y;else{const r=Zj(t.getNodes(e.filter),s.zoom);if(e.texts){const o=t.modules.labels.getTextsBoundingBox();o.isValid()&&r.extend(o)}e.width!=null&&isFinite(e.width)&&e.height!=null&&isFinite(e.height)||Kj(i,t,r),i.width=Math.max(i.width,2*n),i.height=Math.max(i.height,2*n),i.x=r.cx,i.y=r.cy,i.zoom=Math.min((i.width-2*n)/r.width,(i.height-2*n)/r.height)}return t.modules.geo.isEnabled()?i.backgroundColor=null:e.background!==void 0&&(i.backgroundColor=e.background),i}function nx(t,e,s,n,i=!1){const r={...s,hideImages:i,angle:s.angle||0,currentTime:$n(),isBufferDisplayable:l=>e.texts||!QC(l),bentEnable:!1,bentVertical:!1},o={};if(e.badges===!1){const l={text:null,image:null};o.badges={topLeft:l,topRight:l,bottomRight:l,bottomLeft:l}}const a=t.styles.getClass(ka);return a&&a.update({nodeAttributes:o}),t.modules.graphics.export(n,r,e.filter||F0,e)}var Sg=t=>({download:!0,filter:"visible",filename:`graph.${t}`,clip:!1,margin:10,width:void 0,height:void 0,background:null,badges:!0,legend:void 0,texts:!0,preventOverlap:!0,images:!0,textWatermark:{content:"",fontFamily:"Arial",fontSize:48,fontStyle:void 0,fontColor:"red",repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageWatermark:{url:void 0,width:void 0,height:void 0,repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageCrossOrigin:void 0,layers:!0,pixelRatio:void 0}),Qj={png:Sg("png"),jpg:Sg("jpg"),tiff:Sg("tiff"),gif:Sg("gif")};function Jj(t){const{canvas:e,parameters:s}=t;return s.textWatermark.content&&cA(e,s.textWatermark,a6,l6),s.imageWatermark.url?a2(s.imageWatermark.url).then((n=>(n&&(s.imageWatermark.content=n,cA(e,s.imageWatermark,d6,u6)),t))):t}function t6(t){const{ogma:e,canvas:s,parameters:n}=t,i=e.modules.legend;let r=null;return n.legend===void 0&&(r=!!i.enabled()&&i.getCurrentOptions()),n.legend===!0&&(r={}),r&&i.exportOnCanvas(s,r,t.parameters.pixelRatio),t}function e6(t){const{canvas:e,parameters:s,view:n}=t;if(!n.renderBackground)return t;n.renderBackground=!1;const i=e.getContext("2d");return i.fillStyle=s.background,i.fillRect(0,0,e.width,e.height),t}function s6(t){const{ogma:e,view:s}=t;return e.modules.geo.isEnabled()?e.modules.geo.exportBackground(s).then((n=>{const i=s.width*s.pixelRatio,r=s.height*s.pixelRatio,o=Pn(i,r),a=o.getContext("2d");return a.drawImage(n,(i-n.width)/2,(r-n.height)/2),a.drawImage(t.canvas,0,0),t.canvas=o,t})):t}function n6(t){const{ogma:e,view:s,canvas:n,parameters:i}=t;return i.layers?e.modules.layers.export({view:s,canvas:n,below:!0}).then((()=>t)):t}function i6(t){const{ogma:e,view:s,canvas:n,parameters:i}=t;return i.layers?e.modules.layers.export({view:s,below:!1,canvas:n}).then((()=>t)):t}function r6(t){const{ogma:e,parameters:s,canvas:n,view:i}=t,r=n.getContext("2d");return nx(e,s,i,"canvas",!s.images).then((o=>{try{const a=o.getContext("2d");if(!a)throw new Error("Failed to render graph");return a.getImageData(0,0,1,1),r.drawImage(o,0,0,n.width,n.height),t}catch(a){return $o(a),nx(e,s,i,"canvas",!0).then((l=>(r.drawImage(l,0,0,n.width,n.height),t)))}}))}function o6({canvas:t,parameters:e,type:s}){const n=t.toDataURL("image/"+s);return e.download&&ta(n,e.filename,"dataURL","image/"+s),n}function Ag(t,e,s){const n=Ni(e,Qj[s]);n.filename.endsWith(s)||(n.filename+="."+s),n.background===null&&(n.background=t.modules.graphics.getTransparentBackgroundColor());const i=SN(t,n);n.pixelRatio=i.pixelRatio;const r=Pn(i.width*i.pixelRatio,i.height*i.pixelRatio),o={ogma:t,parameters:n,canvas:r,view:i,type:s};return Promise.resolve().then((()=>o)).then(e6).then(s6).then(n6).then(r6).then(i6).then(Jj).then(t6).then(o6).then((a=>(t.modules.events.fire("afterImageExport"),a)))}function a6(t,e,s,n){t.textAlign="center",t.textBaseline="middle",t.fillText(e,s,n)}function l6(t,e,s){return{width:t.measureText(e).width,height:s}}function u6(t,e,s,n,i){return{width:n===void 0?e.width:n,height:i===void 0?e.height:i}}function d6(t,e,s,n,i,r){t.drawImage(e,s-i/2,n-r/2,i,r)}function cA(t,e,s,n){if(!e)return;if(typeof e!="object")e={content:e};else if(!e.content)return;const{fontFamily:i,fontSize:r,fontStyle:o,fontColor:a,repeat:l,alpha:u,space:h,content:g}=e;let f=e.angle;const p=t.getContext("2d"),y=t.width,_=t.height,x=e.x===void 0?y/2:e.x,v=e.y===void 0?_/2:e.y,b=e.height,S=e.width;f=f/180*Math.PI,Zo(p,i,r,o),p.fillStyle=a,p.globalAlpha=u;const A=n(p,g,r,S,b);if(l){const w=A.width+h,L=A.height+h,I=Math.sqrt(y*y+_*_);p.save(),p.translate(0,0),p.rotate(f);for(let F=0;F<I;F+=w)for(let O=0;O<I;O+=L)s(p,g,F,O,A.width,A.height),O!==0&&s(p,g,F,-O,A.width,A.height);p.restore()}else p.save(),p.translate(x,v),p.rotate(f),s(p,g,0,0,A.width,A.height),p.restore()}var h6={download:!0,filename:"graph.svg",width:void 0,height:void 0,background:null,texts:!0,preventOverlap:!0,groupSemantically:!0,images:!0,badges:!0,embedFonts:!1,layers:!0,clip:!1,margin:10,prefix:"ogma"};function c6(t,e){const s=Ni(e,h6),{background:n,filename:i,download:r,layers:o}=s,a=t.modules.graphics;n===null&&(s.background=a.getTransparentBackgroundColor());const l=SN(t,s);return nx(t,s,l,"svg",!s.images).then((u=>(u.removeAttribute("pointer-events"),u.setAttribute("version","1.1"),u.setAttributeNS(uy,"xmlns",Dx),u.setAttributeNS(uy,"xmlns:xlink",o2),u))).then((u=>s.groupSemantically?f6(t,u,s):u)).then((u=>m6(u,s))).then((u=>g6(t,l,u))).then((u=>gA(t,l,u,o,!0))).then((u=>gA(t,l,u,o,!1))).then((u=>(t.modules.events.fire("afterImageExport"),u))).then((u=>{const h=`<?xml version="1.0" encoding="utf-8"?>${T0(u)}`;return r&&ta(h,i,"text","image/svg+xml"),h}))}function g6(t,e,s){return t.modules.geo.isEnabled()?t.modules.geo.exportBackground({...e,pixelRatio:1}).then((n=>{const i=ys("image",{width:n.width,height:n.height,x:0,y:0,href:n.toDataURL()});return s.insertBefore(i,s.children[0]),s})):Promise.resolve(s)}function gA(t,e,s,n,i=!1){return n?t.modules.layers.export({view:e,svg:s,below:i}).then((()=>s)):Promise.resolve(s)}function f6(t,e,s){const n=e.childNodes[2],i=n.childNodes,r={},o=s.prefix;for(let p=0;p<i.length;p++){const y=i[p],_=y.getAttribute(Vi);_!=null&&(r[_]=r[_]||[],r[_].push(y))}const a=Object.keys(r),l=t.modules.graph,u=l.getNodeAttribute("id"),h=l.getEdgeAttribute("id"),g=ys("g",{class:`${o}-edges`}),f=ys("g",{class:`${o}-nodes`});for(let p=0;p<a.length;p++){const y=a[p],_=y.charAt(0)==="n",x=parseInt(y.substring(1)),v=r[y],b=jl((_?u:h).get(x).toString()),S=ys("g");S.setAttribute(`data-${_?"node":"edge"}-id`,b),S.setAttribute("class",`${o}-${_?"node":"edge"}`);for(let A=0;A<v.length;A++){const w=v[A];S.appendChild(w),w.removeAttribute(Vi)}(_?f:g).appendChild(S)}return n.appendChild(g),n.appendChild(f),e}function p6(t){const e=[].concat(Array.prototype.slice.call(t.getElementsByTagName("text")||[])),s=[],n={};for(let i=0;i<e.length;i++){const r=e[i].parentNode.getAttribute("font-family");if(typeof r=="string"){const o=r.split(",");for(let a=0;a<o.length;a++){const l=o[a].replace(/['"]/g,"");l===""||n[l]||(n[l]=!0,s.push(l))}}}return{list:s,map:n}}function m6(t,e){const s=p6(t).map;return DL().then((n=>n.filter((i=>s[i.name])))).then((n=>OL(n,!!e.embedFonts))).then((n=>{if(n.length!==0){const i=ys("style");for(let r=0;r<n.length;r++)i.appendChild(Ox(n[r]));t.childNodes[0].appendChild(i)}return t}))}var _6={what:void 0,dataProperties:void 0,filter:"visible",nodes:void 0,edges:void 0,download:!0,filename:"graph.xlsx",tab:void 0,nodeData:void 0,edgeData:void 0};function y6(t,e={}){typeof e=="string"&&(e={what:e});const{what:s,nodes:n,edges:i,tab:r={nodes:()=>"nodes",edges:()=>"edges"},download:o,filename:a,dataProperties:l,filter:u,nodeData:h,edgeData:g}=Ni(e,_6);r.nodes||(r.nodes=()=>"nodes"),r.edges||(r.edges=()=>"edges");const f=dp(t.modules.graph,t.modules.individualAttributes,{styles:"none",nodes:n,edges:i,filter:u,nodeData:y=>y,edgeData:y=>y}),p=x6(f,{what:s,tabFunctions:r,tabContentFunctions:{nodes:h||(y=>ty(Wd(y||{}),l)),edges:g||(y=>ty(Wd(y||{}),l))}},{nodes:t.modules.graph.getNodes(f.nodes.map((({id:y})=>y))),edges:t.modules.graph.getEdges(f.edges.map((({id:y})=>y)))});return o&&ta(p,a,"blob","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),Promise.resolve(p)}function x6(t,{what:e,tabFunctions:s,tabContentFunctions:n},i){const r=$i("XLSX")||$i("xlsx",{throwOnError:!0});if(!r)throw Error('The xlsx exports requires the "xlsx" peer dependency to be associated');const o=new b6;if(e){if(e!=="nodes"&&e!=="edges")throw new TypeError(`Invalid argument: "what" is not "nodes" or "edges", was ${e}`);e==="nodes"&&(t.edges=[]),e==="edges"&&(t.nodes=[])}const a={};for(const l of["nodes","edges"]){const u=Fj(t[l],l,s[l],n[l],i[l]);for(const h of Object.keys(u))a[h]=[...a[h]||[],...u[h]]}for(const l of Object.keys(a))o.SheetNames.push(l),o.Sheets[l]=v6(r,Pj(a[l]));return o.SheetNames.length===0&&(o.SheetNames=["nodes","edges"],o.Sheets.nodes={},o.Sheets.edges={}),Zd([E6(r.write(o,{bookType:"xlsx",bookSST:!1,type:"binary"}))],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")}function v6(t,e){const s={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}};for(let i=0;i!==e.length;++i){const r=e[i];for(let o=0;o!==r.length;++o){const a=r[o];n.s.r>i&&(n.s.r=i),n.s.c>o&&(n.s.c=o),n.e.r<i&&(n.e.r=i),n.e.c<o&&(n.e.c=o);const l={v:a,t:"s"};typeof a=="number"?l.t="n":a instanceof Date?l.t="d":typeof a=="boolean"?l.t="b":l.v=EN(a),s[t.utils.encode_cell({c:o,r:i})]=l}}return n.s.c<1e7&&(s["!ref"]=t.utils.encode_range(n)),s}var b6=class{constructor(){this.SheetNames=[],this.Sheets={}}};function E6(t){const e=new ArrayBuffer(t.length),s=new Uint8Array(e);for(let n=0;n!==t.length;++n)s[n]=255&t.charCodeAt(n);return e}var S6=class extends Rs{constructor(t){super(t),this.csv=e=>Uj(this._ogma,e),this.xlsx=e=>(e&&e.dataProperties&&void 0,y6(this._ogma,e)),this.gexf=e=>jj(this._ogma,e),this.graphml=(e={})=>qj(this._ogma,e),this.json=(e={})=>Xj(this._ogma,e),this.svg=(e={})=>c6(this._ogma,e),this.png=(e={})=>Ag(this._ogma,e,"png"),this.jpg=(e={})=>Ag(this._ogma,e,"jpg"),this.tiff=(e={})=>Ag(this._ogma,e,"tiff"),this.gif=(e={})=>Ag(this._ogma,e,"gif"),t.styles.createClass({name:ka,isBuiltin:!0})}};/**
 * Ogma Generators
 * @description Graphs Generators for Ogma
 * @version 0.0.18 (built on Wed Aug 06 2025 13:07:32 GMT+0000 (Coordinated Universal Time))
 * @author Alexander Milevski - Leo Nicolle - Sylvain Milan - Marco Liberati
 * @license (c) Linkurious 2025. All rights reserved.
 * @preserve
 */function A6(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var fA,pA={exports:{}};function w6(){return fA||(fA=1,pA.exports=(function(){return t.importState=function(s){var n=new t;return n.importState(s),n},t;function t(){return(function(s){var n=0,i=0,r=0,o=1;s.length==0&&(s=[+new Date]);var a=e();n=a(" "),i=a(" "),r=a(" ");for(var l=0;l<s.length;l++)(n-=a(s[l]))<0&&(n+=1),(i-=a(s[l]))<0&&(i+=1),(r-=a(s[l]))<0&&(r+=1);a=null;var u=function(){var h=2091639*n+23283064365386963e-26*o;return n=i,i=r,r=h-(o=0|h)};return u.next=u,u.uint32=function(){return 4294967296*u()},u.fract53=function(){return u()+11102230246251565e-32*(2097152*u()|0)},u.version="Alea 0.9",u.args=s,u.exportState=function(){return[n,i,r,o]},u.importState=function(h){n=+h[0]||0,i=+h[1]||0,r=+h[2]||0,o=+h[3]||0},u})(Array.prototype.slice.call(arguments))}function e(){var s=4022871197,n=function(i){i=i.toString();for(var r=0;r<i.length;r++){var o=.02519603282416938*(s+=i.charCodeAt(r));o-=s=o>>>0,s=(o*=s)>>>0,s+=4294967296*(o-=s)}return 23283064365386963e-26*(s>>>0)};return n.version="Mash 0.9",n}})()),pA.exports}var T6=w6(),C6=A6(T6),L6=C6(42),hn=()=>L6.next(),k6=({nodes:t=10,edges:e=10,texts:s=!1,scale:n=100}={})=>({nodes:t,edges:e,texts:s,scale:n});function N6({nodes:t,scale:e,texts:s,edges:n}){const i=[],r=[];for(let o=0;o<t;o++)i.push({id:o,attributes:{x:hn()*e,y:hn()*e,text:s?`Node ${o}`:void 0}});for(let o=0;o<n;o++)r.push({id:o,source:hn()*t|0,target:hn()*t|0,attributes:{text:s?`Edge ${o}`:void 0}});return{nodes:i,edges:r}}var mA=Object.freeze(Object.defineProperty({__proto__:null,configure:k6,generate:N6},Symbol.toStringTag,{value:"Module"})),M6=({rows:t=4,columns:e=4,columnDistance:s=20,rowDistance:n=20,xmin:i=0,ymin:r=0}={})=>({rows:t,columns:e,columnDistance:s,rowDistance:n,xmin:i,ymin:r});function I6({rows:t,columns:e,columnDistance:s,rowDistance:n,xmin:i,ymin:r}){const o={nodes:[],edges:[]};let a=0;for(let l=0;l<t;++l)for(let u=0;u<e;++u){const h=l*e+u;o.nodes.push({id:h,attributes:{x:i+u*s,y:r+l*n}}),u!==e-1&&(o.edges.push({id:a,source:h,target:l*e+u+1}),a++),l!==t-1&&(o.edges.push({id:a,source:h,target:(l+1)*e+u}),a++)}return o}var _A=Object.freeze(Object.defineProperty({__proto__:null,configure:M6,generate:I6},Symbol.toStringTag,{value:"Module"})),R6=({length:t=5,scale:e=100}={})=>({length:t,scale:e});function F6({length:t,scale:e}){const s={nodes:[],edges:[]};if(t<=0)return s;s.nodes.push({id:0,attributes:{x:hn()*e,y:hn()*e}});for(let n=1;n<t;++n)s.nodes.push({id:n,attributes:{x:hn()*e,y:hn()*e}}),s.edges.push({id:n-1,source:n-1,target:n});return s}var yA=Object.freeze(Object.defineProperty({__proto__:null,configure:R6,generate:F6},Symbol.toStringTag,{value:"Module"}));function P6(t){return typeof t=="number"&&isFinite(t)&&t>=0?t:void 0}function z6(t){return typeof t=="number"&&isFinite(t)&&t>0?t:void 0}function Cd(t){return typeof t=="number"&&isFinite(t)?t:void 0}function D6({children:t=2,height:e=3}={}){if(!z6(t))throw new TypeError('Invalid argument: "children" is not a positive number, was '+t);if(!P6(e))throw new TypeError('Invalid argument: "height" is not a positive number, was '+e);return{children:t,height:e}}function O6({children:t,height:e}){e+=1;const s=Math.pow(t,e),n=[],i=[];let r=1,o=0,a=0;for(let l=0;l<e;++l){const u=s/(r+1)/1.5;for(let h=0;h<r;++h){const g=o++;if(n.push({id:g,attributes:{x:(h+1)*u*10,y:20*l}}),l!==e-1)for(let f=0;f<t;++f)i.push({id:a,source:g,target:g*t+f+1}),a+=1}r*=t}return{nodes:n,edges:i}}var xA=Object.freeze(Object.defineProperty({__proto__:null,configure:D6,generate:O6},Symbol.toStringTag,{value:"Module"}));function B6({nodes:t=20,edges:e,p:s,scale:n=100}={}){if(!Cd(t)||t<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+t);if(e!==void 0&&s!==void 0)throw new TypeError("Invalid argument: choose between options.edges and options.p");return e===void 0&&s===void 0&&(s=.1),s===void 0&&(s=-1),e===void 0&&(e=-1),{nodes:t,p:s,edges:e,scale:n}}function U6(t){const e={nodes:[],edges:[]},s=t.nodes,n=t.p,i=t.scale;if(n>=0){let r=0;for(let o=0;o<s;o++){e.nodes.push({id:o,attributes:{x:hn()*i,y:hn()*i}});for(let a=0;a<o;a++)hn()<n&&e.edges.push({id:r++,source:o,target:a})}}else{const r=[],o=t.edges;for(let l=0;l<s;l++){e.nodes.push({id:l,attributes:{x:100*hn(),y:100*hn()}});for(let u=l+1;u<s;u++)r.push({source:l,target:u})}let a=r.length-1;for(let l=0;l<o;l++){const u=r.splice(Math.floor(hn()*a),1)[0];u.id=l,e.edges.push(u),a--}}return e}var vA=Object.freeze(Object.defineProperty({__proto__:null,configure:B6,generate:U6},Symbol.toStringTag,{value:"Module"}));function G6({nodes:t=40,m0:e=5,m:s=1,scale:n=100}={}){if(!Cd(t)||t<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+t);if(!Cd(e)||e>=t)throw new TypeError(`Invalid argument: options.m0 is not a number < ${t}, was ${e}`);if(!Cd(e)||s>=e)throw new TypeError(`Invalid argument: options.m is not a number <= ${e}, was ${s}`);if(!Cd(n)||n<0)throw new TypeError("Invalid argument: options.scale is not a number or is less than 0");return{nodes:t,m0:e,m:s,scale:n}}function V6({scale:t,nodes:e,m0:s,m:n}){const i={nodes:[],edges:[]},r={},o=[],a=t/10;let l=0;for(let u=0;u<s;u++)i.nodes.push({id:u,attributes:{x:hn()*a,y:hn()*a}}),o[u]=0;for(let u=0;u<s;u++)for(let h=u+1;h<s;h++){const g={id:l++,source:u,target:h};r[g.source+"-"+g.target]=g,i.edges.push(g),o[u]++,o[h]++}for(let u=s;u<e;u++){i.nodes.push({id:u,attributes:{x:hn()*t,y:hn()*t}}),o[u]=0;let h=0;for(let f=0;f<u;f++)h+=o[f];let g=0;for(let f=0;f<n;f++){const p=hn();let y=0;for(let _=0;_<u;_++)if(!r[`${u}-${_}`]&&!r[`${_}-${u}`]&&(y=u===1?1:y+o[_]/h+g/(u-f),p<=y)){g+=o[_]/h;const x={id:l++,source:u,target:_};r[`${x.source}-${x.target}`]=x,i.edges.push(x),o[u]++,o[_]++;break}}}return i}var bA=Object.freeze(Object.defineProperty({__proto__:null,configure:G6,generate:V6},Symbol.toStringTag,{value:"Module"}));function j6({nodes:t=50,width:e=100,height:s=100,x:n=0,y:i=0}={}){if(!isFinite(t)||t<1)throw new RangeError("Tree generator: number of nodes must be a positive integer");return{nodes:t,width:e,height:s,x:n,y:i}}function H6({nodes:t,x:e,y:s,width:n,height:i}){const r=e-n/2,o=s-i/2;return{nodes:new Array(t).fill(0).map(((a,l)=>({id:l,attributes:{x:r+hn()*n,y:o+hn()*i}}))),edges:new Array(t-1).fill(0).map(((a,l)=>({id:l,source:Math.floor(Math.sqrt(l)),target:l+1})))}}var EA=Object.freeze(Object.defineProperty({__proto__:null,configure:j6,generate:H6},Symbol.toStringTag,{value:"Module"})),$6=5,q6=10,Y6=10,W6=2.7,X6=.2;function Z6({depth:t=3,breadth:e=3,nodes:s}){return s!==void 0?(e=5,t=Math.ceil(Math.log(s)/Math.log(5))):s=-1,{depth:t,breadth:e,nodes:s}}function K6({depth:t,breadth:e,nodes:s}){const n={id:0,attributes:{x:0,y:0,radius:wN(t+1)}},i={nodes:[n],edges:[]};return TN(i,e,t,n,1),s!==void 0&&s>=0&&(i.nodes=i.nodes.slice(0,s),i.edges=i.edges.slice(0,Math.max(s-1,0))),i}function AN(t){return Math.pow(W6,t)*q6}function wN(t){return $6+AN(t)/Y6}function TN(t,e,s,n,i){if(s===0)return i;const r=AN(s),o=wN(s),a=o*X6;let l=-Math.PI;const u=2*Math.PI/e,h=n.attributes.x||0,g=n.attributes.y||0;for(let f=0;f<e;++f){const p={id:i,attributes:{x:h+r*Math.cos(l),y:g+r*Math.sin(l),radius:o}},y={id:i,source:n.id,target:i,attributes:{width:a}};t.nodes.push(p),t.edges.push(y),i=TN(t,e,s-1,p,i+1),l+=u}return i}var SA=Object.freeze(Object.defineProperty({__proto__:null,configure:Z6,generate:K6},Symbol.toStringTag,{value:"Module"})),Q6=class extends Rs{constructor(){super(...arguments),this.balancedTree=t=>Promise.resolve(xA.generate(xA.configure(t))),this.barabasiAlbert=t=>Promise.resolve(bA.generate(bA.configure(t))),this.erdosRenyi=t=>Promise.resolve(vA.generate(vA.configure(t))),this.flower=t=>Promise.resolve(SA.generate(SA.configure(t))),this.grid=t=>Promise.resolve(_A.generate(_A.configure(t))),this.path=t=>Promise.resolve(yA.generate(yA.configure(t))),this.random=t=>Promise.resolve(mA.generate(mA.configure(t))),this.randomTree=t=>Promise.resolve(EA.generate(EA.configure(t)))}},J6=class extends Rs{constructor(){super(...arguments),this.enable=t=>this._ogma.modules.geo.enable(t),this.disable=t=>this._ogma.modules.geo.disable(t),this.setOptions=t=>this._ogma.modules.geo.setOptions(t),this.getOptions=()=>this._ogma.modules.geo.getOptions(),this.getMap=()=>this._ogma.modules.geo.getMap(),this.enabled=()=>this._ogma.modules.geo.isEnabled(),this.getCenter=()=>this._ogma.modules.geo.getCenter(),this.getView=()=>this._ogma.modules.geo.getView(),this.getZoom=()=>this._ogma.modules.geo.getZoom(),this.setZoom=t=>this._ogma.modules.geo.setZoom(t),this.setView=(t,e,s)=>this._ogma.modules.geo.setView(t,e,s),this.setCenter=(t,e)=>this._ogma.modules.geo.setCenter(t,e),this.toggle=t=>this._ogma.modules.geo.toggle(t),this.resetCoordinates=()=>this._ogma.modules.geo.resetCoordinates(),this.getUnprojectedCoordinates=t=>this._ogma.modules.geo.getUnprojectedCoordinates(this._ogma.getNodes(t)),this.runLayout=async({type:t,nodes:e,latitudePath:s=Tr,longitudePath:n=Cr,options:i,center:r})=>{if(t===void 0||i===void 0)throw new Error("Ogma.geo.runLayout: Both layout type and options are required");if(e=this._ogma.getNodes(e),r===void 0){let o=0;if(r=e.reduce(((a,l)=>{const u=l.getData(s),h=l.getData(n);return isNaN(u)||isNaN(h)||(a.latitude+=u,a.longitude+=h,o++),a}),{latitude:0,longitude:0}),isNaN(r.latitude)||isNaN(r.longitude))throw new Error("Ogma.geo.runLayout: No valid center coordinates found");r.latitude/=o,r.longitude/=o}return this._ogma.modules.geo.runLayout({center:r,nodes:e,type:t,options:i,latitudePath:s,longitudePath:n})}}},tH=class{reloadFonts(){this.modules.graphics.reloadFonts()}},eH=class extends Rs{constructor(){super(...arguments),this.gexf=t=>fN(t),this.gexfFromUrl=t=>I0(t),this.janus=t=>pN(t),this.json=(t,e)=>mN(t,e),this.jsonFromUrl=(t,e)=>R0(t,e),this.neo4j=t=>_N(t),this.graphml=(t,e)=>yN(t,e),this.graphmlFromUrl=(t,e)=>xN(t,e)}},sH=class extends Rs{constructor(){super(...arguments),this.isKeyPressed=t=>this._ogma.modules.keyboard.isPressed(t),this.resetKeys=()=>{this._ogma.modules.keyboard.resetKeys()}}},nH=class extends Rs{addLayer(t,e){return this._ogma.modules.layers.addLayer(t,"layer",e)}addCanvasLayer(t,e,s){return this._ogma.modules.layers.addCanvasLayer(t,e,s)}addOverlay(t,e){if(!t.position)throw new Error("options.position argument is required");return this._ogma.modules.layers.addOverlay(t,e)}addSVGLayer(t,e){return t.element||(t.element=document.createElementNS("http://www.w3.org/2000/svg","svg")),t.draw||(t.draw=()=>{}),this._ogma.modules.layers.addSVGLayer(t,e)}},AA={name:"concentric",configure:function(t,{graph:e,data:s}){if(t.centralNode===void 0)throw new Error('concentric layout: missing parameter "centralNode"');const n={...t,centralNode:(function(A,w){return w instanceof yi?w:A.getNode(w)})(e,t.centralNode)},{centralNode:i,nodes:r}=n,o=e.getNode(i);if(o===void 0)throw new Error('concentric layout: "centralNode" parameter is not valid');const a=o._index,{x:l,y:u}=o.getPosition(),h=r.getAttribute("layoutable"),g=e.getNodes(r)._indexes,f=Array.from(g.filter(((S,A)=>h[A])));f.indexOf(a)===-1&&f.push(a);const p=t.rs?t.rs:e.getNodeAttribute("radius").getMultiple(g),y=(function(A,w,L,I){if(w)return w==="random"?"random":w==="radius"?I.slice():w==="degree"?L.getDegree():A.getProperty(L,w)})(s,n.sortBy,r,p),_=f.reduce(((S,A,w)=>(S[A]=w,S)),{}),x=f.map(((S,A)=>A)),v=new Set(t.edges.getExtremities()._indexes),b=f.map((S=>e.topology.getAdjacentElements(!0,new Uint32Array([S])).filter((A=>v.has(A))).map((A=>_[A]))));return{sourceNodeIndex:f.indexOf(a),centerX:typeof n.centerX=="number"?n.centerX:l,centerY:typeof n.centerY=="number"?n.centerY:u,list:f,indexes:x,size:f.length,totalSize:f.length,attributes:{adjacentNodes:b,size:p},sortAttr:y,clockwise:n.clockwise===void 0||n.clockwise,circleHopRatio:n.circleHopRatio||5,allowOverlap:!!n.allowOverlap}},context:function(){return{dijkstra:function(t,e,s,n,i){const r=Math.pow(2,31)-1,o=new Int32Array(n),a=new Int32Array(n),l=new Int8Array(n);o.fill(r),a.fill(-1);for(let h=0;h<n;++h){const g=e[h];g!==void 0&&(o[g]=r,a[g]=-1)}o[i]=0;let u=0;for(;u!==-1;){let h=r;u=-1;for(let g=0;g<s;++g){const f=e[g],p=o[f];!l[f]&&p<h&&(h=p,u=f,l[f]=1)}if(u>-1){const g=t[u],f=h+1;g.forEach((p=>{const y=o[p];f<y&&(o[p]=f,a[p]=u)}))}}return o},determinePropertyType:function(t,e,s){return e.some((n=>t[n]!=="number"))?"string":"number"}}},update:function(t,e){const{attributes:s,indexes:n,size:i}=t,{sourceNodeIndex:r,centerX:o,centerY:a,sortAttr:l}=t,u=s.adjacentNodes,h=s.size,g=new Array(t.totalSize),f=new Array(t.totalSize),p=e.dijkstra(u,n,t.size,t.totalSize,r);let y=0;const _={};for(let L=0;L<i;L++){const I=h[n[L]];I>y&&(y=I)}const x=y*t.circleHopRatio;let v=0,b=0;const S=Math.PI/9;for(let L=0;L<i;L++){const I=n[L],F=p[I];let O=_[F];O||(O=[],_[F]=O),O.push(I)}const A=(function(I,F,O){if(I==="random")return function(){return Math.random()-.5};if(I)return O.determinePropertyType(I,F,F.length)==="number"?function(V,j){return I[V]-I[j]}:function(V,j){return I[V]<I[j]?-1:1}})(l,n,e),w=l==="random"||l;return Object.keys(_).sort(((L,I)=>parseInt(L)-parseInt(I))).forEach(((L,I)=>{const F=_[L],O=F.length;let V=0,j=b;const Z=2*Math.PI/O;if(I!==0&&!t.allowOverlap){const at=2*Math.PI*v;let pt=0;V+=F.reduce(((K,ut)=>K+h[ut]),0),pt=2*V*Math.SQRT2,pt>at&&(v+=pt/(2*Math.PI)-v)}w&&(F.sort(A),t.clockwise||F.reverse());for(let at=0;at<O;at++){const pt=F[at];g[pt]=Math.cos(j)*v+o,f[pt]=Math.sin(j)*v+a;const K=h[pt];j+=Z*(t.allowOverlap?1:K/V*O)}v+=x,b+=S})),{x:g,y:f,indexes:t.list}},isRunning:function(){return!1},onSync:function({indexes:t,x:e,y:s}){return{indexes:t,x:e,y:s}}},iH=t=>(t.modules.layouts.register(AA),e=>t.modules.layouts.start(AA.name,e)),rH=Object.defineProperty,Se=(t,e)=>rH(t,"name",{value:e,configurable:!0});function pu(t){let e=0,s=0;for(const o of t)e+=o.w*o.h,s=Math.max(s,o.w);t.sort(((o,a)=>a.h-o.h));const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),s),h:1/0}];let i=0,r=0;for(const o of t)for(let a=n.length-1;a>=0;a--){const l=n[a];if(!(o.w>l.w||o.h>l.h)){if(o.x=l.x,o.y=l.y,r=Math.max(r,o.y+o.h),i=Math.max(i,o.x+o.w),o.w===l.w&&o.h===l.h){const u=n.pop();a<n.length&&(n[a]=u)}else o.h===l.h?(l.x+=o.w,l.w-=o.w):o.w===l.w?(l.y+=o.h,l.h-=o.h):(n.push({x:l.x+o.w,y:l.y,w:l.w-o.w,h:o.h}),l.y+=o.h,l.h-=o.h);break}}return{w:i,h:r,fill:e/(i*r)||0}}Se(pu,"g");var wA=Se(((t,e)=>Array.from({length:t},((s,n)=>e(n)))),"me"),co=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),oH=Se((()=>({[WebGL2RenderingContext.FLOAT]:"uniform1f",[WebGL2RenderingContext.FLOAT_VEC2]:"uniform2fv",[WebGL2RenderingContext.FLOAT_VEC3]:"uniform3fv",[WebGL2RenderingContext.FLOAT_VEC4]:"uniform4fv",[WebGL2RenderingContext.INT]:"uniform1i",[WebGL2RenderingContext.INT_VEC2]:"uniform2iv",[WebGL2RenderingContext.INT_VEC3]:"uniform3iv",[WebGL2RenderingContext.INT_VEC4]:"uniform4iv",[WebGL2RenderingContext.UNSIGNED_INT]:"uniform1ui",[WebGL2RenderingContext.UNSIGNED_INT_VEC2]:"uniform2uiv",[WebGL2RenderingContext.UNSIGNED_INT_VEC3]:"uniform2uiv",[WebGL2RenderingContext.UNSIGNED_INT_VEC4]:"uniform2uiv",[WebGL2RenderingContext.FLOAT_MAT2]:"uniformMatrix2fv",[WebGL2RenderingContext.FLOAT_MAT3]:"uniformMatrix3fv",[WebGL2RenderingContext.FLOAT_MAT4]:"uniformMatrix4fv",[WebGL2RenderingContext.SAMPLER_2D]:"uniform1i",[WebGL2RenderingContext.INT_SAMPLER_2D]:"uniform1i",[WebGL2RenderingContext.UNSIGNED_INT_SAMPLER_2D]:"uniform1i",[WebGL2RenderingContext.SAMPLER_CUBE]:"uniform1i"})),"we"),wg=new Map,v_=new Map,aH=Se(((t,e,s,n)=>{wg.has(t)||wg.set(t,wg.size);const i=`${wg.get(t)}:${e}:${s}`;return v_.has(i)||v_.set(i,n()),v_.get(i)}),"ze"),Qo=Se(((t,e)=>()=>([t,e]=[e,t],[t,e])),"$"),Qe=Se(((t,e=co)=>{const s=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),s}),"b"),TA=Se(((t,e,s)=>{const n=t.createShader(e);if(n===null)throw new Error("Cannot create WebGL shader.");return t.shaderSource(n,s),t.compileShader(n),n}),"ce"),ea=Se(((t,e,s)=>aH(t,e,s,(()=>{const n=t.createProgram();if(t.attachShader(n,TA(t,t.VERTEX_SHADER,e)),t.attachShader(n,TA(t,t.FRAGMENT_SHADER,s)),t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS)){const i=t.getProgramInfoLog(n);throw t.deleteProgram(n),new Error(`Could not link WebGL program: 
${i}`)}return n}))),"q"),ii=Se(((t,{size:e,data:s,type:n,internalFormat:i=t.RGBA32F,format:r=t.RGBA})=>{const o=t.createTexture(),[a,l]=e.map((u=>Math.max(1,u)));return s instanceof Float32Array&&s.byteLength===0?s=new Float32Array(a*l*4):s instanceof Uint32Array&&s.byteLength===0&&(s=new Uint32Array(a*l*4)),t.bindTexture(t.TEXTURE_2D,o),t.texImage2D(t.TEXTURE_2D,0,i,a,l,0,r,n,s),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),{size:e,data:s,type:n,format:r,handle:o}}),"k"),Jo=Se(((t,e)=>{const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);const n=t.checkFramebufferStatus(t.FRAMEBUFFER);if(n!==t.FRAMEBUFFER_COMPLETE){const i={[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT]:"Attachment is NOT complete.",[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT]:"No valid attachment.",[t.FRAMEBUFFER_UNSUPPORTED]:"Attachment types are not supported."}[n];throw i?new Error(`Framebuffer: ${i}`):new Error(`Framebuffer: Unknown reason (status: ${n})`)}return s}),"W"),Wa=Se(((t,e,s)=>{t.useProgram(e);const n={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let r=0;r<i;r++){const o=t.getActiveUniform(e,r);if(!o)throw new Error(`Cannot get GL active uniform ${r}.`);const{name:a,size:l,type:u}=o,h=t.getUniformLocation(e,a);if(!h)throw new Error(`Cannot get GL uniform location ${a}.`);n[a]={size:l,data:s[a],type:u,location:h}}return n}),"Y");function sa(t,e,s={}){let n=0;const i=oH();return Object.entries(e).forEach((([r,{location:o,type:a,data:l}])=>{let u=s[r]!==void 0?s[r]:l;(a===t.SAMPLER_2D||a===t.INT_SAMPLER_2D||a===t.UNSIGNED_INT_SAMPLER_2D)&&(t.activeTexture(t.TEXTURE0+n),t.bindTexture(t.TEXTURE_2D,u),u=n,n++),t[i[a]](o,u)}))}Se(sa,"J");var CA=Se(((t,e=!1)=>{const s=e?1<<Math.ceil(Math.log2(Math.sqrt(t))):Math.ceil(Math.sqrt(t));return{w:s,h:s}}),"ue"),Bl=Se(((t,e,{x:s,y:n,w:i})=>{const r=s+t%i;return(n+Math.floor(t/i))*e+r}),"Q"),ix=Se((t=>{const e=new Map,s={nodes:[],edges:[]};return t.nodes.forEach(((n,i)=>{e.has(n.id)&&console.warn(`Duplicated ID ${n.id}@${i}`),s.nodes.push({...n,id:i}),e.set(n.id,i)})),t.edges.forEach((n=>{const i=e.get(n.source),r=e.get(n.target);return i===void 0?console.warn(`Missing source ${n.source}`):r===void 0?console.warn(`Missing target ${n.target}`):void s.edges.push({...n,source:Math.min(i,r),target:Math.max(i,r)})})),s.edges.sort(((n,i)=>n.source-i.source||n.target-i.target)),s}),"it"),lH=Se((({nodes:t,edges:e},[s,n]=[0,0],i=.001)=>{const r=Math.PI*(3-Math.sqrt(5)),o=t.map((l=>(l.x=(l.x||0)-s,l.y=(l.y||0)-n,l))).map((l=>({n:l,key:l.pinned?0:.5+Math.floor(l.x/i)+Math.floor(l.y/i)/i}))).sort(((l,u)=>l.key-u.key));let a=0;return o.forEach((({n:l,key:u},h)=>{if(u*h==0||u!==o[h-1].key)return a=h;const g=Math.sqrt(h-a);l.x=o[a].n.x+g*Math.cos(r*(h-a)),l.y=o[a].n.y+g*Math.sin(r*(h-a))})),{nodes:t,edges:e}}),"at"),LA=Se(((t,e)=>{const s={};return e.forEach(((n,i)=>(s[n]??(s[n]=new Set)).add(i))),[...Object.values(s)].map((n=>({nodes:[...n].map((i=>t.nodes[i])),edges:t.edges.filter((({source:i,target:r})=>n.has(i)&&n.has(r)))})))}),"st");function rx(t,e){const s=e.map((({nodes:S})=>({x:0,y:0,...CA(S.length,!0)}))),n=e.map((({edges:S})=>({x:0,y:0,...CA(2*S.length)}))),i=pu(s.slice()),r=pu(n.slice()),o=i.w*i.h,a=r.w*r.h,l=new Float32Array(4*o),u=new Uint32Array(3*o),h=new Uint32Array(2*a),g=new Float32Array(4*o),f=new Float32Array(a);e.forEach((({nodes:S,edges:A},w)=>{const L=S.length,I=A.length,F=s[w],O=n[w],V=new Uint32Array(I),j=new Uint32Array(I),Z=new Uint32Array(L);for(let ht=0;ht<I;ht++){const{source:nt,target:ot}=A[ht];V[ht]=nt,j[ht]=ot,Z[nt]++,Z[ot]++}const at=wA(L,(()=>[]));V.forEach(((ht,nt)=>{at[ht].push(j[nt]),at[j[nt]].push(ht)}));const pt=wA(L,(()=>[]));V.forEach(((ht,nt)=>{if(A[nt].stiffness!==void 0)pt[ht].push(A[nt].stiffness),pt[j[nt]].push(A[nt].stiffness);else{const ot=Z[ht],Nt=Z[j[nt]],Q=ot*Nt/(Math.min(ot,Nt)*(ot+Nt));pt[ht].push(Q),pt[j[nt]].push(Q)}}));for(let ht=0;ht<L;ht++){const nt=4*Bl(ht,i.w,F);l[nt]=S[ht].x||0,l[nt+1]=S[ht].y||0}let K=0;for(let ht=0;ht<L;ht++){const nt=3*Bl(ht,i.w,F);u[nt]=K%O.w,u[nt+1]=Math.floor(K/O.w),u[nt+2]=Z[ht],K+=Z[ht]}let ut=0;for(let ht=0;ht<L;ht++)for(const nt of at[ht]){const ot=2*Bl(ut,r.w,O);h[ot]=nt%F.w,h[ot+1]=Math.floor(nt/F.w),ut++}for(let ht=0;ht<L;ht++){const nt=4*Bl(ht,i.w,F);g[nt]=S[ht].mass||Z[ht]+1,g[nt+1]=S[ht].r||1,g[nt+2]=S[ht].pinned?1:0}ut=0;for(let ht=0;ht<L;ht++)for(const nt of pt[ht]){const ot=Bl(ut,r.w,O);f[ot]=nt,ut++}}));const p=ii(t,{size:[i.w,i.h],data:l,type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F}),y=ii(t,{size:[i.w,i.h],data:g,type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F}),_=ii(t,{size:[i.w,i.h],data:u,type:t.UNSIGNED_INT,format:t.RGB_INTEGER,internalFormat:t.RGB32UI}),x=ii(t,{size:[r.w,r.h],data:h,type:t.UNSIGNED_INT,format:t.RG_INTEGER,internalFormat:t.RG32UI}),v=ii(t,{size:[r.w,r.h],data:f,type:t.FLOAT,format:t.RED,internalFormat:t.R32F}),b=ii(t,{size:[i.w,i.h],data:g,type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F});return{items:e.map((({nodes:S,edges:A},w)=>({N:S.length,E:A.length,particlesPositionsSlot:s[w],particlesChargesSlot:s[w],adjacencyOffsetsSlot:s[w],adjacencyListsSlot:n[w],stiffnessSlot:n[w],nodesExtraPropertiesSlot:s[w]}))),texture:{particlesPositions:()=>p,particlesCharges:()=>y,adjacencyOffsets:()=>_,adjacencyLists:()=>x,stiffness:()=>v,nodesExtraProperties:()=>b}}}Se(rx,"mt");var kA=Se(((t,e)=>{t.deleteTexture(e.texture.particlesPositions().handle),t.deleteTexture(e.texture.particlesCharges().handle),t.deleteTexture(e.texture.adjacencyOffsets().handle),t.deleteTexture(e.texture.adjacencyLists().handle),t.deleteTexture(e.texture.stiffness().handle),t.deleteTexture(e.texture.nodesExtraProperties().handle)}),"ct"),jd=Se((()=>({x:0,y:0,w:0,h:0})),"Z"),uH=`#version 300 es
precision highp float;precision highp int;vec2 c(vec2 c,vec2 e){return vec2(c.x*e.x-c.y*e.y,c.x*e.y+c.y*e.x);}vec2 c(vec2 c){return c.y=-c.y,c;}vec2 c(vec2 i[8],vec2 s,vec2 a){vec2 t,o=a-s,e=vec2(1,0);for(int s;s<8;++s)t+=c(i[s],e),e=c(e,o);return t;}vec2 c(vec2 e,vec4 c){return(e-c.xy)/c.zw;}uniform float m_x,m_y,m_z,m_10,m_11,m_12,m_u,m_v,m_w;uniform highp sampler2D m_13;uniform highp usampler2D m_14,m_15;uniform highp sampler2D m_16,m_17,m_7;uniform highp usampler2D m_18,m_19;uniform highp sampler2D m_1j,m_1k;flat in uvec4 m_2b,m_2c,m_2d,m_2e,m_2f,m_26,m_29,m_28,m_1y;flat in uint m_22,m_27,m_20;out vec4 outColor;void main(){uvec2 s=uvec2(gl_FragCoord.xy)-m_2b.xy;if(m_2b.z*s.y+s.x>=m_22)return;vec3 a=texelFetch(m_16,ivec2(m_2c.xy+s),0).xyz;if(a.z>0.)return;vec4 l=texelFetch(m_13,ivec2(m_2b.xy+s),0);vec2 i=l.xy,e=l.zw;ivec4 t=ivec4(texelFetch(m_14,ivec2(m_2e.xy+s),0));vec4 o=texelFetch(m_7,ivec2(m_26.xy),0);float r=float(1u<<m_27-1u);ivec2 u=ivec2(r*c(i,o));vec2 v=(vec2(u)+.5)/r;ivec2 p=u-ivec2(1);for(int c;c<9;++c){ivec2 t=p+ivec2(c%3,c/3);if(t>>m_27-1u!=ivec2(0))continue;uvec2 s=texelFetch(m_19,ivec2(m_28.xy)+t,0).xy;for(uint c=s.x;c<s.y;c++){uint l=texelFetch(m_18,ivec2(m_29.xy)+ivec2(c%m_29.z,c/m_29.z),0).x;ivec2 o=ivec2(l%m_2b.z,l/m_2b.z);vec2 t=texelFetch(m_13,ivec2(m_2b.xy)+o,0).xy-i;float u=dot(t,t)+1e-4;if(m_11>0.&&m_u<.5){float i=texelFetch(m_16,ivec2(m_2c.xy)+o,0).y,c=max(a.y+i+m_12,.01);if(u<c*c){float s=sqrt(u);e-=(c-s)*m_11*i/c*t/s;}}float r=texelFetch(m_16,ivec2(m_2c.xy)+o,0).x;e-=m_u*m_x*r*t/u;}}if(m_27>2u){vec2 t[8];ivec2 s=ivec2(m_1y.xy)+u;vec4 a=texelFetch(m_1j,s,0),l=texelFetch(m_1k,s,0);if(t[0]=a.xy,t[1]=a.zw,t[2]=l.xy,t[3]=l.zw,m_20>4u){vec4 c=texelFetch(m_1j,s,0);t[4]=c.xy,t[5]=c.zw;}if(m_20>6u){vec4 c=texelFetch(m_1k,s,0);t[6]=c.xy,t[7]=c.zw;}vec2 r=c(c(t,v,c(i,o))/o.z);e+=m_u*m_x*r;}ivec2 n;for(int s;s<t.z;s++){n=ivec2(texelFetch(m_15,ivec2(m_2d.xy)+t.xy,0).xy);float o=texelFetch(m_17,ivec2(m_2f.xy)+t.xy,0).x;vec2 c=texelFetch(m_13,ivec2(m_2b.xy)+n,0).xy-i;if(c*=1.-m_10/(length(c)+1e-4),e+=m_u*m_z*o*c/a.x,t.x+=1,t.x>=int(m_2d.z))t.x=0,t.y+=1;}e=m_v*(e-m_u*m_y*i);float x=dot(e,e);if(x>m_w)e*=sqrt(m_w/x);outColor=vec4(i+e,e);}`,dH=`#version 300 es
precision highp int;
precision highp float;

uniform uint m_c; 
uniform uvec2 m_1b;

in vec2 position; 
in uvec4 m_1c; 
in uvec4 m_1d; 
in uvec4 m_1e; 
in uvec4 m_1f; 
in uvec4 m_1g; 
in uvec4 m_s; 
in uvec4 m_1h; 
in uvec4 m_1i; 
in uvec4 m_e; 

in uint m_5; 
in uint m_t; 
in uint m_g; 

flat out uvec4 m_2b;
flat out uvec4 m_2c;
flat out uvec4 m_2d;
flat out uvec4 m_2e;
flat out uvec4 m_2f;
flat out uvec4 m_26;
flat out uvec4 m_29;
flat out uvec4 m_28;
flat out uvec4 m_1y;

flat out uint m_22;
flat out uint m_27;
flat out uint m_20;

void main() {
  m_2b = m_1c;
  m_2c = m_1d;
  m_2d = m_1e;
  m_2e = m_1f;
  m_2f = m_1g;
  m_26 = m_s;
  m_29 = m_1h;
  m_28 = m_1i;
  m_1y = m_e;

  m_22 = m_5;
  m_27 = m_t;
  m_20 = m_g;

  
  if(m_c != m_t - 1u) {
    gl_Position = vec4(0.f, 0.f, 0.f, 1.f);
    return;
  }

  
  vec2 posPx = (position + 1.f) * vec2(m_1c.zw) * .5f + vec2(m_1c.xy);
  gl_Position = vec4(posPx / vec2(m_1b) * 2.f - 1.f, 0.f, 1.f);
}`,hH=Se(((t,e,{charge:s,gravity:n,inertia:i,edgeStrength:r,edgeLength:o,elasticity:a,margin:l,maxDisplacement:u})=>{const h=ea(t,dH,uH),g=e.texture.particlesPositions(),f=ii(t,{type:t.FLOAT,size:g.size,data:new Float32Array(g.data.buffer.slice(0)),format:t.RGBA,internalFormat:t.RGBA32F}),p=Qo(g,f),y=Jo(t,f.handle),_=Jo(t,g.handle),x=Qo(y,_),v=Wa(t,h,{m_u:1,m_v:i,m_w:u**2,m_x:s,m_y:n,m_z:r,m_10:o,m_11:a,m_12:l,m_13:g.handle,m_14:e.texture.adjacencyOffsets().handle,m_15:e.texture.adjacencyLists().handle,m_16:e.texture.nodesExtraProperties().handle,m_17:e.texture.stiffness().handle,m_c:2,m_7:e.texture.spatialBoundaries().handle,m_18:e.texture.spatialKeys().handle,m_19:e.texture.gridCells().handle,m_1a:null,m_1b:g.size});let b=g;const S=[],A=new Set;function w(I=1){t.viewport(0,0,g.size[0],g.size[1]),t.useProgram(h),t.bindFramebuffer(t.FRAMEBUFFER,x()[0]);const[F,O]=p();b=O,A.forEach((V=>{var j,Z;t.bindVertexArray(S[V]),sa(t,v,{m_u:I,m_13:F.handle,m_7:e.texture.spatialBoundaries().handle,m_18:e.texture.spatialKeys().handle,m_c:V,m_1j:(j=e.texture.localExpansions(V,0))==null?void 0:j.handle,m_1k:(Z=e.texture.localExpansions(V,1))==null?void 0:Z.handle,m_14:e.texture.adjacencyOffsets().handle,m_15:e.texture.adjacencyLists().handle,m_16:e.texture.nodesExtraProperties().handle,m_17:e.texture.stiffness().handle,m_19:e.texture.gridCells().handle}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}))}e.items.forEach((({depth:I})=>{A.add(I-1)})),A.forEach((I=>{S[I]=t.createVertexArray(),t.bindVertexArray(S[I]);const F=t.getAttribLocation(h,"position");t.enableVertexAttribArray(F),Qe(t,co),t.vertexAttribPointer(F,2,t.FLOAT,!1,0,0);const O=t.getAttribLocation(h,"m_1c");t.enableVertexAttribArray(O);const V=e.items.map((ce=>ce.particlesPositionsSlot)).map((({x:ce,y:Ce,w:ve,h:Ne})=>[ce,Ce,ve,Ne])).flat();Qe(t,new Uint32Array(V)),t.vertexAttribIPointer(O,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(O,1);const j=t.getAttribLocation(h,"m_1d");t.enableVertexAttribArray(j);const Z=e.items.map((ce=>ce.nodesExtraPropertiesSlot)).map((({x:ce,y:Ce,w:ve,h:Ne})=>[ce,Ce,ve,Ne])).flat();Qe(t,new Uint32Array(Z)),t.vertexAttribIPointer(j,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(j,1);const at=t.getAttribLocation(h,"m_1e");t.enableVertexAttribArray(at);const pt=e.items.map((ce=>ce.adjacencyListsSlot)).map((({x:ce,y:Ce,w:ve,h:Ne})=>[ce,Ce,ve,Ne])).flat();Qe(t,new Uint32Array(pt)),t.vertexAttribIPointer(at,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(at,1);const K=t.getAttribLocation(h,"m_1f");t.enableVertexAttribArray(K);const ut=e.items.map((ce=>ce.adjacencyOffsetsSlot)).map((({x:ce,y:Ce,w:ve,h:Ne})=>[ce,Ce,ve,Ne])).flat();Qe(t,new Uint32Array(ut)),t.vertexAttribIPointer(K,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(K,1);const ht=t.getAttribLocation(h,"m_1g");t.enableVertexAttribArray(ht);const nt=e.items.map((ce=>ce.stiffnessSlot)).map((({x:ce,y:Ce,w:ve,h:Ne})=>[ce,Ce,ve,Ne])).flat();Qe(t,new Uint32Array(nt)),t.vertexAttribIPointer(ht,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(ht,1);const ot=t.getAttribLocation(h,"m_s");t.enableVertexAttribArray(ot);const Nt=e.items.map((ce=>ce.spatialBoundariesSlot)).map((({x:ce,y:Ce,w:ve,h:Ne})=>[ce,Ce,ve,Ne])).flat();Qe(t,new Uint32Array(Nt)),t.vertexAttribIPointer(ot,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(ot,1);const Q=t.getAttribLocation(h,"m_1h");t.enableVertexAttribArray(Q);const Et=e.items.map((ce=>ce.spatialKeysSlot)).map((({x:ce,y:Ce,w:ve,h:Ne})=>[ce,Ce,ve,Ne])).flat();Qe(t,new Uint32Array(Et)),t.vertexAttribIPointer(Q,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(Q,1);const Xt=t.getAttribLocation(h,"m_1i");t.enableVertexAttribArray(Xt);const Ht=e.items.map((ce=>ce.gridCellsSlot)).map((({x:ce,y:Ce,w:ve,h:Ne})=>[ce,Ce,ve,Ne])).flat();Qe(t,new Uint32Array(Ht)),t.vertexAttribIPointer(Xt,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(Xt,1);const Zt=t.getAttribLocation(h,"m_e");t.enableVertexAttribArray(Zt);const ae=jd(),pe=e.items.map((ce=>ce.localExpansionsSlot[I]||ae)).map((({x:ce,y:Ce,w:ve,h:Ne})=>[ce,Ce,ve,Ne])).flat();Qe(t,new Uint32Array(pe)),t.vertexAttribIPointer(Zt,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(Zt,1);const ne=t.getAttribLocation(h,"m_5");t.enableVertexAttribArray(ne),Qe(t,new Uint32Array(e.items.map((({N:ce})=>ce)))),t.vertexAttribIPointer(ne,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(ne,1);const te=t.getAttribLocation(h,"m_t");t.enableVertexAttribArray(te),Qe(t,new Uint32Array(e.items.map((ce=>ce.depth)))),t.vertexAttribIPointer(te,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(te,1);const se=t.getAttribLocation(h,"m_g");t.enableVertexAttribArray(se),Qe(t,new Uint32Array(e.items.map((ce=>ce.order)))),t.vertexAttribIPointer(se,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(se,1)})),Se(w,"P");const L=Se((()=>{t.deleteFramebuffer(y),t.deleteFramebuffer(_),t.deleteTexture(f.handle)}),"h");return{step:w,outputs:{items:e.items.map((I=>({N:I.N,pointsSlot:I.particlesPositionsSlot}))),texture:{points:()=>b}},destroy:L}}),"Fe"),cH=`#version 300 es
precision highp float;vec2 l(vec2 l,vec2 x){return vec2(l.x*x.x-l.y*x.y,l.x*x.y+l.y*x.x);}vec2 x(vec2 x,vec2 l){return vec2(dot(x,l),x.y*l.x-x.x*l.y)/dot(l,l);}uniform uint m_c;uniform highp sampler2D m_l,m_m,m_n,m_o,m_h,m_i,m_j,m_k;flat in uvec4 m_1y,m_1z;flat in uint m_20;layout(location=0)out vec4 l01;layout(location=1)out vec4 l23;layout(location=2)out vec4 l45;layout(location=3)out vec4 l67;void main(){float a=float(1u<<m_c);uvec2 i=uvec2(gl_FragCoord.xy)-m_1y.xy;vec2 r=(vec2(i)+.5)/a,e=texelFetch(m_h,ivec2(m_1y.xy+i),0).xy;if(e.x==0.)return;if(m_c>2u){uvec2 o=i>>1u;vec2 w=r-(vec2(i&65534u)+1.)/a,x=vec2(1,0);vec4 u=texelFetch(m_l,ivec2(m_1z.xy+o),0),y=m_20>2u?texelFetch(m_m,ivec2(m_1z.xy+o),0):vec4(0),e=m_20>4u?texelFetch(m_n,ivec2(m_1z.xy+o),0):vec4(0),z=m_20>6u?texelFetch(m_o,ivec2(m_1z.xy+o),0):vec4(0);switch(m_20){case 2u:l01.xy+=l(u.xy,1.*x),l01.zw+=l(u.zw,1.*x),x=l(x,w),l01.xy+=l(u.zw,1.*x);break;case 3u:case 4u:l01.xy+=l(u.xy,1.*x),l01.zw+=l(u.zw,1.*x),l23.xy+=l(y.xy,1.*x),l23.zw+=l(y.zw,1.*x),x=l(x,w),l01.xy+=l(u.zw,1.*x),l01.zw+=l(y.xy,2.*x),l23.xy+=l(y.zw,3.*x),x=l(x,w),l01.xy+=l(y.xy,1.*x),l01.zw+=l(y.zw,3.*x),x=l(x,w),l01.xy+=l(y.zw,1.*x);break;case 5u:case 6u:l01.xy+=l(u.xy,1.*x),l01.zw+=l(u.zw,1.*x),l23.xy+=l(y.xy,1.*x),l23.zw+=l(y.zw,1.*x),l45.xy+=l(e.xy,1.*x),l45.zw+=l(e.zw,1.*x),x=l(x,w),l01.xy+=l(u.zw,1.*x),l01.zw+=l(y.xy,2.*x),l23.xy+=l(y.zw,3.*x),l23.zw+=l(e.xy,4.*x),l45.xy+=l(e.zw,5.*x),x=l(x,w),l01.xy+=l(y.xy,1.*x),l01.zw+=l(y.zw,3.*x),l23.xy+=l(e.xy,6.*x),l23.zw+=l(e.zw,10.*x),x=l(x,w),l01.xy+=l(y.zw,1.*x),l01.zw+=l(e.xy,4.*x),l23.xy+=l(e.zw,10.*x),x=l(x,w),l01.xy+=l(e.xy,1.*x),l01.zw+=l(e.zw,5.*x),x=l(x,w),l01.xy+=l(e.zw,1.*x);break;case 7u:case 8u:l01.xy+=l(u.xy,1.*x),l01.zw+=l(u.zw,1.*x),l23.xy+=l(y.xy,1.*x),l23.zw+=l(y.zw,1.*x),l45.xy+=l(e.xy,1.*x),l45.zw+=l(e.zw,1.*x),l67.xy+=l(z.xy,1.*x),l67.zw+=l(z.zw,1.*x),x=l(x,w),l01.xy+=l(u.zw,1.*x),l01.zw+=l(y.xy,2.*x),l23.xy+=l(y.zw,3.*x),l23.zw+=l(e.xy,4.*x),l45.xy+=l(e.zw,5.*x),l45.zw+=l(z.xy,6.*x),l67.xy+=l(z.zw,7.*x),x=l(x,w),l01.xy+=l(y.xy,1.*x),l01.zw+=l(y.zw,3.*x),l23.xy+=l(e.xy,6.*x),l23.zw+=l(e.zw,10.*x),l45.xy+=l(z.xy,15.*x),l45.zw+=l(z.zw,21.*x),x=l(x,w),l01.xy+=l(y.zw,1.*x),l01.zw+=l(e.xy,4.*x),l23.xy+=l(e.zw,10.*x),l23.zw+=l(z.xy,20.*x),l45.xy+=l(z.zw,35.*x),x=l(x,w),l01.xy+=l(e.xy,1.*x),l01.zw+=l(e.zw,5.*x),l23.xy+=l(z.xy,15.*x),l23.zw+=l(z.zw,35.*x),x=l(x,w),l01.xy+=l(e.zw,1.*x),l01.zw+=l(z.xy,6.*x),l23.xy+=l(z.zw,21.*x),x=l(x,w),l01.xy+=l(z.xy,1.*x),l01.zw+=l(z.zw,7.*x),x=l(x,w),l01.xy+=l(z.zw,1.*x);break;}}ivec2 y=(ivec2(i)&65534)-2;for(uint n;n<36u;n++){ivec2 t=y+ivec2(int(n)%6,int(n)/6);vec4 w=texelFetch(m_h,ivec2(m_1y.xy)+t,0);if(w.x==0.)continue;vec2 s=vec2(t-ivec2(i));if(dot(s,s)<=2.||t>>ivec2(m_c)!=ivec2(0))continue;vec2 c=x(vec2(1,0),r-(vec2(t)+.5)/a),e=c;vec4 z=m_20>2u?texelFetch(m_i,ivec2(m_1y.xy)+t,0):vec4(0),u=m_20>4u?texelFetch(m_j,ivec2(m_1y.xy)+t,0):vec4(0),o=m_20>6u?texelFetch(m_k,ivec2(m_1y.xy)+t,0):vec4(0);if(l01.xy+=l(w.xy,e),e=l(e,c),l01.xy+=l(w.zw,1.*e),l01.zw+=l(w.xy,-e),e=l(e,c),m_20>=3u)l01.xy+=l(z.xy,1.*e),l23.xy+=l(w.xy,e);if(l01.zw+=l(w.zw,-2.*e),m_20<3u)continue;if(e=l(e,c),l01.xy+=l(z.zw,1.*e),l01.zw+=l(z.xy,-3.*e),l23.xy+=l(w.zw,3.*e),l23.zw+=l(w.xy,-e),e=l(e,c),m_20>=5u)l01.xy+=l(u.xy,1.*e);if(l01.zw+=l(z.zw,-4.*e),l23.xy+=l(z.xy,6.*e),l23.zw+=l(w.zw,-4.*e),m_20>=5u)l45.xy+=l(w.xy,e);if(e=l(e,c),l23.xy+=l(z.zw,10.*e),l23.zw+=l(z.xy,-10.*e),m_20>=5u)l01.xy+=l(u.zw,1.*e),l01.zw+=l(u.xy,-5.*e),l45.xy+=l(w.zw,5.*e),l45.zw+=l(w.xy,-e);if(e=l(e,c),l23.zw+=l(z.zw,-20.*e),m_20>=7u)l01.xy+=l(o.xy,1.*e),l67.xy+=l(w.xy,e);if(m_20>=5u)l01.zw+=l(u.zw,-6.*e),l23.xy+=l(u.xy,15.*e),l45.xy+=l(z.xy,15.*e),l45.zw+=l(w.zw,-6.*e);if(m_20<5u)continue;if(e=l(e,c),m_20>=7u)l67.zw+=l(w.xy,-e),l67.xy+=l(w.zw,7.*e),l01.zw+=l(o.xy,-7.*e),l01.xy+=l(o.zw,1.*e);if(l45.zw+=l(z.xy,-21.*e),l45.xy+=l(z.zw,35.*e),l23.zw+=l(u.xy,-35.*e),l23.xy+=l(u.zw,21.*e),e=l(e,c),m_20>=7u)l67.zw+=l(w.zw,-8.*e),l67.xy+=l(z.xy,28.*e),l23.xy+=l(o.xy,28.*e),l01.zw+=l(o.zw,-8.*e);if(l45.zw+=l(z.zw,-56.*e),l45.xy+=l(u.xy,70.*e),l23.zw+=l(u.zw,-56.*e),e=l(e,c),m_20>=7u)l67.zw+=l(z.xy,-36.*e),l67.xy+=l(z.zw,84.*e),l23.zw+=l(o.xy,-84.*e),l23.xy+=l(o.zw,36.*e);if(l45.zw+=l(u.xy,-126.*e),l45.xy+=l(u.zw,126.*e),e=l(e,c),m_20>=7u)l67.zw+=l(z.zw,-120.*e),l67.xy+=l(u.xy,210.*e),l45.xy+=l(o.xy,210.*e),l23.zw+=l(o.zw,-120.*e);if(l45.zw+=l(u.zw,-252.*e),m_20<7u)continue;e=l(e,c),l67.zw+=l(u.xy,-330.*e),l67.xy+=l(u.zw,462.*e),l45.zw+=l(o.xy,-462.*e),l45.xy+=l(o.zw,330.*e),e=l(e,c),l67.zw+=l(u.zw,-792.*e),l67.xy+=l(o.xy,924.*e),l45.zw+=l(o.zw,-792.*e),e=l(e,c),l67.zw+=l(o.xy,-1716.*e),l67.xy+=l(o.zw,1716.*e),e=l(e,c),l67.zw+=l(o.zw,-3432.*e);}}`,gH=`#version 300 es
precision mediump int;
precision highp float;

uniform uvec2 m_d;

in vec2 position; 
in uvec4 m_e; 
in uvec4 m_f; 
in uint m_g; 

flat out uvec4 m_1y;
flat out uvec4 m_1z;
flat out uint m_20;

void main() {
  m_1y = m_e;
  m_1z = m_f;
  m_20 = m_g;

  
  vec2 posPx = (position + 1.f) * vec2(m_e.zw) * .5f + vec2(m_e.xy);
  gl_Position = vec4(posPx / vec2(m_d) * 2.f - 1.f, 0.f, 1.f);
}`,fH=Se(((t,e)=>{const s=ea(t,gH,cH),n=Math.max(...e.items.map((({depth:h})=>h))),i=[];e.items.forEach((({order:h,depth:g,multipolesSlot:f})=>{const p={};for(let y=n-1;y>=2;y--)p[y]=f[y];i.push({order:h,depth:g,localExpansionsSlot:p})}));const r=[];for(let h=n-1;h>=1;h--){r[h]=[];const[g,f]=h===1?[1,1]:e.texture.multipoles(h,0).size;for(let p=0;p<4;p++)r[h][p]=ii(t,{size:[g,f],data:new Float32Array(4*g*f),type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F})}const o=r.map(((h,g)=>{const f=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,f),h.forEach(((p,y)=>{t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+y,t.TEXTURE_2D,p.handle,0)})),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1,t.COLOR_ATTACHMENT2,t.COLOR_ATTACHMENT3]),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&console.error(`FBO incomplete for level ${g}`),f})),a=Wa(t,s,{m_c:2,m_d:[0,0]}),l=[];for(let h=n-1;h>=2;h--){l[h]=t.createVertexArray(),t.bindVertexArray(l[h]);const g=t.getAttribLocation(s,"position");t.enableVertexAttribArray(g),Qe(t,co),t.vertexAttribPointer(g,2,t.FLOAT,!1,0,0);const f=t.getAttribLocation(s,"m_e");t.enableVertexAttribArray(f);const p=i.map((({localExpansionsSlot:v})=>v[h])).map((({x:v,y:b,w:S,h:A})=>[v,b,S,A])).flat();Qe(t,new Uint32Array(p)),t.vertexAttribIPointer(f,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(f,1);const y=t.getAttribLocation(s,"m_f");t.enableVertexAttribArray(y);const _=i.map((({localExpansionsSlot:v})=>h>=3?v[h-1]:jd())).map((({x:v,y:b,w:S,h:A})=>[v,b,S,A])).flat();Qe(t,new Uint32Array(_)),t.vertexAttribIPointer(y,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(y,1);const x=t.getAttribLocation(s,"m_g");t.enableVertexAttribArray(x),Qe(t,new Uint32Array(e.items.map((v=>v.order)))),t.vertexAttribIPointer(x,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(x,1)}function u(){t.useProgram(s);for(let h=2;h<n;h++){t.bindVertexArray(l[h]);const g=r[h-1],f=r[h];t.viewport(0,0,...f[0].size),t.bindFramebuffer(t.FRAMEBUFFER,o[h]),sa(t,a,{m_c:h,m_h:e.texture.multipoles(h,0).handle,m_i:e.texture.multipoles(h,1).handle,m_j:e.texture.multipoles(h,2).handle,m_k:e.texture.multipoles(h,3).handle,m_l:g[0].handle,m_m:g[1].handle,m_n:g[2].handle,m_o:g[3].handle,m_d:f[0].size}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}}return Se(u,"u"),{step:u,outputs:{items:i,texture:{localExpansions:(h,g)=>r[h]&&r[h][g]}},destroy:()=>{o.forEach((h=>t.deleteFramebuffer(h))),r.forEach((h=>h.forEach((({handle:g})=>t.deleteTexture(g))))),l.forEach((h=>t.deleteVertexArray(h)))}}}),"Ie"),pH=`#version 300 es
precision highp float;precision highp int;vec2 l(vec2 l,vec2 i){return vec2(l.x*i.x-l.y*i.y,l.x*i.y+l.y*i.x);}vec2 l(vec2 i,vec4 l){return(i-l.xy)/l.zw;}uniform highp sampler2D m_13,m_1n,m_7;uniform highp usampler2D m_18,m_19;uniform uint m_c;uniform highp sampler2D m_1s,m_1t,m_1u,m_1v;flat in uvec4 m_2g,m_2h,m_2b,m_26,m_29,m_28;flat in uint m_27,m_20;layout(location=0)out vec4 m01;layout(location=1)out vec4 m23;layout(location=2)out vec4 m45;layout(location=3)out vec4 m67;void main(){float s=float(1u<<m_c);uvec2 i=uvec2(gl_FragCoord.xy)-m_2g.xy;vec2 v=(vec2(i)+.5)/s;if(m_c==m_27-1u){vec4 e=texelFetch(m_7,ivec2(m_26.xy),0);uvec2 s=texelFetch(m_19,ivec2(m_28.xy+i),0).xy;for(uint t=s.x;t<s.y;t++){uint o=texelFetch(m_18,ivec2(m_29.xy)+ivec2(t%m_29.z,t/m_29.z),0).x;ivec2 c=ivec2(m_2b.xy)+ivec2(o%m_2b.w,o/m_2b.w);vec2 u=l(texelFetch(m_13,c,0).xy,e)-v;float x=texelFetch(m_1n,c,0).x;vec2 i=vec2(x,0.);if(m01.xy+=i,i=l(i,u),m01.zw+=i,m_20<3u)continue;if(i=l(i,u),m23.xy+=i,i=l(i,u),m23.zw+=i,m_20<5u)continue;if(i=l(i,u),m45.xy+=i,i=l(i,u),m45.zw+=i,m_20<7u)continue;i=l(i,u),m67.xy+=i,i=l(i,u),m67.zw+=i;}}else for(uint y;y<4u;++y){uvec2 x=2u*i+uvec2(y&1u,y>>1u);vec2 u=(vec2(x)+.5)/s/2.-v,e=vec2(1,0);vec4 t=texelFetch(m_1s,ivec2(m_2h.xy+x),0);if(m01.xy+=l(t.xy,1.*e),e=vec2(1,0),m01.zw+=l(t.zw,1.*e),e=l(e,u),m01.zw+=l(t.xy,1.*e),m_20<3u)continue;vec4 o=texelFetch(m_1t,ivec2(m_2h.xy+x),0);if(e=vec2(1,0),m23.xy+=l(o.xy,1.*e),e=l(e,u),m23.xy+=l(t.zw,2.*e),e=l(e,u),m23.xy+=l(t.xy,1.*e),e=vec2(1,0),m23.zw+=l(o.zw,1.*e),e=l(e,u),m23.zw+=l(o.xy,3.*e),e=l(e,u),m23.zw+=l(t.zw,3.*e),e=l(e,u),m23.zw+=l(t.xy,1.*e),m_20<5u)continue;vec4 c=texelFetch(m_1u,ivec2(m_2h.xy+x),0);if(e=vec2(1,0),m45.xy+=l(c.xy,1.*e),e=l(e,u),m45.xy+=l(o.zw,4.*e),e=l(e,u),m45.xy+=l(o.xy,6.*e),e=l(e,u),m45.xy+=l(t.zw,4.*e),e=l(e,u),m45.xy+=l(t.xy,1.*e),e=vec2(1,0),m45.zw+=l(c.zw,1.*e),e=l(e,u),m45.zw+=l(c.xy,5.*e),e=l(e,u),m45.zw+=l(o.zw,10.*e),e=l(e,u),m45.zw+=l(o.xy,10.*e),e=l(e,u),m45.zw+=l(t.zw,5.*e),e=l(e,u),m45.zw+=l(t.xy,1.*e),m_20<7u)continue;vec4 m=texelFetch(m_1v,ivec2(m_2h.xy+x),0);e=vec2(1,0),m67.xy+=l(m.xy,1.*e),e=l(e,u),m67.xy+=l(c.zw,6.*e),e=l(e,u),m67.xy+=l(c.xy,15.*e),e=l(e,u),m67.xy+=l(o.zw,20.*e),e=l(e,u),m67.xy+=l(o.xy,15.*e),e=l(e,u),m67.xy+=l(t.zw,6.*e),e=l(e,u),m67.xy+=l(t.xy,1.*e),e=vec2(1,0),m67.zw+=l(m.zw,1.*e),e=l(e,u),m67.zw+=l(m.xy,7.*e),e=l(e,u),m67.zw+=l(c.zw,21.*e),e=l(e,u),m67.zw+=l(c.xy,35.*e),e=l(e,u),m67.zw+=l(o.zw,35.*e),e=l(e,u),m67.zw+=l(o.xy,21.*e),e=l(e,u),m67.zw+=l(t.zw,7.*e),e=l(e,u),m67.zw+=l(t.xy,1.*e);}}`,mH=`#version 300 es
precision highp int;
precision highp float;

uniform uvec2 m_1p;

in vec2 position; 
in uvec4 m_1q; 
in uvec4 m_1r; 
in uvec4 m_1c; 

in uvec4 m_s; 
in uvec4 m_1h; 
in uvec4 m_1i; 
in uint m_t; 
in uint m_g; 

flat out uvec4 m_2g;
flat out uvec4 m_2h;
flat out uvec4 m_2b;

flat out uvec4 m_26;
flat out uvec4 m_29;
flat out uvec4 m_28;
flat out uint m_27;
flat out uint m_20;

void main() {
  m_2g = m_1q;
  m_2h = m_1r;
  m_2b = m_1c;
  
  m_26 = m_s;
  m_29 = m_1h;
  m_28 = m_1i;
  m_27 = m_t;
  m_20 = m_g;

  
  vec2 posPx = (position + 1.f) * vec2(m_1q.zw) * .5f + vec2(m_1q.xy);
  gl_Position = vec4(posPx / vec2(m_1p) * 2.f - 1.f, 0.f, 1.f);
}`,_H=Se(((t,e)=>{const s=ea(t,mH,pH),n=Math.max(...e.items.map((({depth:h})=>h))),i=[];e.items.forEach((({order:h,depth:g})=>{const f={};for(let p=n-1;p>=2;p--)f[p]=p>=g?jd():{x:0,y:0,w:1<<p,h:1<<p};i.push({order:h,depth:g,multipolesSlot:f})}));const r=[];for(let h=n;h>=2;h--){r[h]=[];const{w:g,h:f}=pu(i.map((({multipolesSlot:p})=>p[h]||jd())));for(let p=0;p<4;p++)r[h][p]=ii(t,{size:[g,f],data:new Float32Array(4*g*f),type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F})}const o=r.map(((h,g)=>{const f=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,f),h.forEach(((p,y)=>{t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+y,t.TEXTURE_2D,p.handle,0)})),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1,t.COLOR_ATTACHMENT2,t.COLOR_ATTACHMENT3]),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&console.error(`FBO incomplete for level ${g}`),f})),a=Wa(t,s,{m_c:n-1,m_13:e.texture.particlesPositions().handle,m_1n:e.texture.particlesCharges().handle,m_7:e.texture.spatialBoundaries().handle,m_18:e.texture.spatialKeys().handle,m_19:e.texture.gridCells().handle,m_1o:null,m_1p:[0,0]}),l=[];for(let h=n-1;h>=2;h--){l[h]=t.createVertexArray(),t.bindVertexArray(l[h]);const g=t.getAttribLocation(s,"position");t.enableVertexAttribArray(g),Qe(t,co),t.vertexAttribPointer(g,2,t.FLOAT,!1,0,0);const f=t.getAttribLocation(s,"m_1q");t.enableVertexAttribArray(f);const p=i.map((({multipolesSlot:V})=>V[h])).map((({x:V,y:j,w:Z,h:at})=>[V,j,Z,at])).flat();Qe(t,new Uint32Array(p)),t.vertexAttribIPointer(f,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(f,1);const y=t.getAttribLocation(s,"m_1r");t.enableVertexAttribArray(y);const _=i.map((({multipolesSlot:V,depth:j})=>h>=j-1?jd():V[h+1])).map((({x:V,y:j,w:Z,h:at})=>[V,j,Z,at])).flat();Qe(t,new Uint32Array(_)),t.vertexAttribIPointer(y,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(y,1);const x=t.getAttribLocation(s,"m_1c");t.enableVertexAttribArray(x);const v=e.items.map((V=>V.particlesPositionsSlot)).map((({x:V,y:j,w:Z,h:at})=>[V,j,Z,at])).flat();Qe(t,new Uint32Array(v)),t.vertexAttribIPointer(x,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(x,1);const b=t.getAttribLocation(s,"m_s");t.enableVertexAttribArray(b);const S=e.items.map((V=>V.spatialBoundariesSlot)).map((({x:V,y:j,w:Z,h:at})=>[V,j,Z,at])).flat();Qe(t,new Uint32Array(S)),t.vertexAttribIPointer(b,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(b,1);const A=t.getAttribLocation(s,"m_1h");t.enableVertexAttribArray(A);const w=e.items.map((V=>V.spatialKeysSlot)).map((({x:V,y:j,w:Z,h:at})=>[V,j,Z,at])).flat();Qe(t,new Uint32Array(w)),t.vertexAttribIPointer(A,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(A,1);const L=t.getAttribLocation(s,"m_1i");t.enableVertexAttribArray(L);const I=e.items.map((V=>V.gridCellsSlot)).map((({x:V,y:j,w:Z,h:at})=>[V,j,Z,at])).flat();Qe(t,new Uint32Array(I)),t.vertexAttribIPointer(L,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(L,1);const F=t.getAttribLocation(s,"m_t");t.enableVertexAttribArray(F),Qe(t,new Uint32Array(e.items.map((V=>V.depth)))),t.vertexAttribIPointer(F,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(F,1);const O=t.getAttribLocation(s,"m_g");t.enableVertexAttribArray(O),Qe(t,new Uint32Array(e.items.map((V=>V.order)))),t.vertexAttribIPointer(O,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(O,1)}function u(){t.useProgram(s);for(let h=n-1;h>=2;h--){t.bindVertexArray(l[h]);const g=r[h+1],f=r[h][0].size;t.viewport(0,0,...f),t.bindFramebuffer(t.FRAMEBUFFER,o[h]),sa(t,a,{m_13:e.texture.particlesPositions().handle,m_7:e.texture.spatialBoundaries().handle,m_1n:e.texture.particlesCharges().handle,m_18:e.texture.spatialKeys().handle,m_19:e.texture.gridCells().handle,m_c:h,m_1s:g[0].handle,m_1t:g[1].handle,m_1u:g[2].handle,m_1v:g[3].handle,m_1p:f}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}}return Se(u,"u"),{step:u,outputs:{items:i,texture:{multipoles:(h,g)=>r[h]&&r[h][g]}},destroy:()=>{o.forEach((h=>t.deleteFramebuffer(h))),r.forEach((h=>h.forEach((({handle:g})=>t.deleteTexture(g))))),l.forEach((h=>t.deleteVertexArray(h)))}}}),"Re"),yH=`#version 300 es
precision highp int;uint u(uint u){return u&=65535u,u=(u|u<<8)&16711935u,u=(u|u<<4)&252645135u,u=(u|u<<2)&858993459u,u=(u|u<<1)&1431655765u,u;}uint u(uvec2 i){return u(i.y)<<1|u(i.x);}uniform highp usampler2D m_18;flat in uvec4 m_28,m_29;flat in uint m_22;out uvec2 outColor;uint i(uint e){uint u,i=m_22;for(;u<i;){uint t=u+i>>1,l=texelFetch(m_18,ivec2(m_29.xy)+ivec2(t%m_29.z,t/m_29.z),0).y;l<e?u=t+1u:i=t;}return u;}void main(){uvec2 t=uvec2(gl_FragCoord.xy);uint e=u((t-m_28.xy)%m_28.z);outColor=uvec2(i(e),i(e+1u));}`,xH=`#version 300 es
precision highp int;
precision mediump float;

uniform uvec2 m_1m;

in vec2 position; 
in uvec4 m_1i; 
in uvec4 m_1h; 
in uint m_5; 

flat out uvec4 m_28;
flat out uvec4 m_29;
flat out uint m_22;

void main() {
  m_28 = m_1i;
  m_29 = m_1h;
  m_22 = m_5;

  
  vec2 posPx = (position + 1.f) * vec2(m_1i.zw) * .5f + vec2(m_1i.xy);
  gl_Position = vec4(posPx / vec2(m_1m) * 2.f - 1.f, 0.f, 1.f);
}`,vH=Se(((t,e)=>{const s=ea(t,xH,yH),n=e.items.map((({depth:v})=>{const b=1<<v-1;return{x:0,y:0,w:b,h:b}})),i=pu(n.slice()),r=ii(t,{size:[i.w,i.h],data:new Uint32Array(2*i.w*i.h),type:t.UNSIGNED_INT,format:t.RG_INTEGER,internalFormat:t.RG32UI}),o=Jo(t,r.handle),a=Wa(t,s,{m_18:e.texture.spatialKeys().handle,m_1m:r.size}),l=t.createVertexArray();t.bindVertexArray(l);const u=t.getAttribLocation(s,"position");t.enableVertexAttribArray(u),Qe(t,co),t.vertexAttribPointer(u,2,t.FLOAT,!1,0,0);const h=t.getAttribLocation(s,"m_1i");t.enableVertexAttribArray(h);const g=n.map((({x:v,y:b,w:S,h:A})=>[v,b,S,A])).flat();Qe(t,new Uint32Array(g)),t.vertexAttribIPointer(h,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(h,1);const f=t.getAttribLocation(s,"m_1h");t.enableVertexAttribArray(f);const p=e.items.map((({spatialKeysSlot:v})=>v)).map((({x:v,y:b,w:S,h:A})=>[v,b,S,A])).flat();Qe(t,new Uint32Array(p)),t.vertexAttribIPointer(f,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(f,1);const y=t.getAttribLocation(s,"m_5");function _(){t.viewport(0,0,r.size[0],r.size[1]),t.useProgram(s),t.bindVertexArray(l),t.bindFramebuffer(t.FRAMEBUFFER,o),sa(t,a,{m_18:e.texture.spatialKeys().handle}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}t.enableVertexAttribArray(y),Qe(t,new Uint32Array(e.items.map((({N:v})=>v)))),t.vertexAttribIPointer(y,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(y,1),Se(_,"d");const x=Se((()=>{t.deleteFramebuffer(o),t.deleteTexture(r.handle)}),"N");return{step:_,outputs:{items:e.items.map((({N:v,depth:b},S)=>({N:v,depth:b,spatialBoundariesSlot:e.items[S].spatialBoundariesSlot,spatialKeysSlot:e.items[S].spatialKeysSlot,gridCellsSlot:n[S]}))),texture:{spatialBoundaries:e.texture.spatialBoundaries,spatialKeys:e.texture.spatialKeys,gridCells:()=>r}},destroy:x}}),"Me"),bH=`#version 300 es
precision highp int;uniform uint m_0,m_1;uniform highp usampler2D m_2;flat in uvec4 m_1w;flat in uint m_1x;out uvec2 outColor;uvec2 e(uvec2 e,uvec2 u,bool y){uvec2 t=e.x<4294967295u?texelFetch(m_2,ivec2(m_1w.xy)+ivec2(e.x%m_1w.z,e.x/m_1w.z),0).xy:e,o=u.x<4294967295u?texelFetch(m_2,ivec2(m_1w.xy)+ivec2(u.x%m_1w.z,u.x/m_1w.z),0).xy:u;if(y)return t.y<o.y?t:o;return t.y>o.y?t:o;}void main(){uvec2 u=uvec2(gl_FragCoord.xy);if(m_1x==1u){outColor=texelFetch(m_2,ivec2(u),0).xy;return;}uint t=uint(u.x-m_1w.x+m_1w.z*(u.y-m_1w.y)),s=texelFetch(m_2,ivec2(u),0).x,o=t^1u<<m_0-m_1,l=texelFetch(m_2,ivec2(m_1w.xy)+ivec2(o%m_1w.z,o/m_1w.z),0).x;bool y=(t>>m_0-m_1&1u)==0u;(t>>m_0&2u)==2u&&(y=!y),outColor=e(uvec2(t,s),uvec2(o,l),y);}`,EH=`#version 300 es
precision highp int;
precision highp float;

uniform uvec2 m_3;
uniform uint m_0;

in vec2 position; 
in uvec4 m_4; 
in uint m_5; 

flat out uvec4 m_1w;
flat out uint m_1x;

void main() {
  m_1w = m_4;
  m_1x = 0u;

  
  uint minN = 1u << m_0;
  if(minN >= m_5) {
    if(minN >= 2u * m_5) {
      gl_Position = vec4(0.f, 0.f, 0.f, 1.f);
      return;
    }
    
    m_1x = 1u;
  }

  
  vec2 posPx = (position + 1.f) * vec2(m_4.zw) * .5f + vec2(m_4.xy);
  gl_Position = vec4(posPx / vec2(m_3) * 2.f - 1.f, 0.f, 1.f);
}`,SH=Se((t=>{for(let e=0;e<t.length/2;e++)t[2*e]=e,t[2*e+1]=4294967295;return t}),"je"),CN=Se((t=>1<<Math.ceil(Math.log2(t))),"le"),AH=Se((t=>{if(t<2)return[1,1];const e=32-Math.clz32(t-1);return[1<<(e>>>1)+(1&e),1<<(e>>>1)]}),"ke"),LN=Se(((t,[e,s],n=SH(new Uint32Array(2*e*s)))=>ii(t,{size:[e,s],data:n,type:t.UNSIGNED_INT,format:t.RG_INTEGER,internalFormat:t.RG32UI})),"fe"),NA=Se(((t,[e,s],n=new Uint32Array(4*e*s))=>ii(t,{size:[e,s],data:n,type:t.UNSIGNED_INT,format:t.RGBA_INTEGER,internalFormat:t.RGBA32UI})),"xe"),wH=Se((t=>Math.max(0,Math.ceil(Math.log2(t)))),"He"),TH=Se((t=>t*(t+1)/2),"Ke"),CH=Se(((t,e)=>{const s=ea(t,EH,bH),n=e.texture.spatialKeys(),i=LN(t,n.size),r=Qo(i,n),o=Jo(t,n.handle),a=Jo(t,i.handle),l=Qo(o,a),u=Wa(t,s,{m_0:0,m_1:0,m_2:n.handle,m_3:n.size}),h=e.items.map((({N:w})=>wH(w))).reduce(((w,L)=>Math.max(w,L)),0),g=t.createVertexArray();t.bindVertexArray(g);const f=t.getAttribLocation(s,"position");t.enableVertexAttribArray(f),Qe(t,co),t.vertexAttribPointer(f,2,t.FLOAT,!1,0,0);const p=t.getAttribLocation(s,"m_4");t.enableVertexAttribArray(p);const y=e.items.map((({spatialKeysSlot:w})=>w)).map((({x:w,y:L,w:I,h:F})=>[w,L,I,F])).flat();Qe(t,new Uint32Array(y)),t.vertexAttribIPointer(p,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(p,1);const _=t.getAttribLocation(s,"m_5");t.enableVertexAttribArray(_),Qe(t,new Uint32Array(e.items.map((({N:w})=>w)))),t.vertexAttribIPointer(_,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(_,1);let x=0,v=0,b=n;function S(w=TH(h)){t.useProgram(s),t.bindVertexArray(g),t.viewport(0,0,i.size[0],i.size[1]);const L=e.texture.spatialKeys();b!==L&&(l(),r(),b=L);for(let I=0;I<w;I++){t.bindFramebuffer(t.FRAMEBUFFER,l()[0]);const[F,O]=r();b=O,sa(t,u,{m_0:x,m_1:v,m_2:F.handle}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length),v=(v+1)%(x+1),v===0&&(x=(x+1)%h)}}Se(S,"E");const A=Se((()=>{t.deleteFramebuffer(o),t.deleteFramebuffer(a),t.deleteTexture(i.handle)}),"P");return{step:S,outputs:{items:e.items,texture:{spatialKeys:()=>b}},destroy:A}}),"$e"),LH=`#version 300 es
precision highp int;uniform uint m_0,m_1;uniform highp usampler2D m_2,m_1l;flat in uvec4 m_1w,m_2a;flat in uint m_1x;layout(location=0)out uvec2 outKeys;layout(location=1)out uvec4 outIntervals;uint n(uint n,uint e,uint u,uint i){uint t=n<u?e+n:i-u+n;return texelFetch(m_2,ivec2(m_1w.xy)+ivec2(t%m_1w.z,t/m_1w.z),0).y;}void main(){ivec2 o=ivec2(gl_FragCoord.xy);if(m_1x==1u){outKeys=texelFetch(m_2,ivec2(o),0).xy;return;}uint i=m_2a.z*(uint(o.y)-m_2a.y)+(uint(o.x)-m_2a.x);uvec4 u;if(m_1==0u)u=uvec4(i&4294967294u,1u,(i&4294967294u)+1u,1u)<<m_0;else{uint n=i>>1u,t=m_2a.z==m_2a.w?m_2a.z:m_2a.z>>1u;u=texelFetch(m_1l,ivec2(m_2a.xy)+ivec2(n%t,n/t),0);}uint e=u.y+u.w>>1u,t=u.y<e?0u:u.y-e,y=u.y<e?u.y:e;for(;t<y;){uint i=t+(y-t>>1u);n(i,u.x,u.y,u.z)<n(i+e,u.x,u.y,u.z)?t=i+1u:y=i;}uvec4 l=(i&1u)==(i>>m_1+1u&1u)?uvec4(u.x,t,u.z+u.w-e+t,e-t):uvec4(u.x+t,u.y-t,u.z,u.w-e+t);if(m_0==m_1){uint n=l.y*l.x+l.w*l.z;outKeys=texelFetch(m_2,ivec2(m_1w.xy)+ivec2(n%m_1w.z,n/m_1w.z),0).xy;}else outIntervals=l;}`,kH=`#version 300 es
precision highp int;
precision highp float;

uniform uvec2 m_3;
uniform uint m_0;
uniform uint m_1;

in vec2 position; 
in uvec4 m_4; 
in uint m_5; 

flat out uvec4 m_1w;
flat out uvec4 m_2a;
flat out uint m_1x;

void main() {
  
  uint minN = 1u << m_0;
  if(minN >= m_5) {
    if(minN >= 2u * m_5) {
      gl_Position = vec4(0.f, 0.f, 0.f, 1.f);
      return;
    }
    
    m_1x = 1u;
  }

  
  uint delta = m_0 - m_1;
  uvec4 intervalSlot = m_4;
  if(intervalSlot.z == intervalSlot.w) {
    
    intervalSlot.z = intervalSlot.z >> (delta >> 1u);
    intervalSlot.w = intervalSlot.w >> ((delta + 1u) >> 1u);
  } else {
    
    intervalSlot.z = intervalSlot.z >> ((delta + 1u) >> 1u);
    intervalSlot.w = intervalSlot.w >> (delta >> 1u);
  }
  m_1w = m_4;
  m_2a = intervalSlot;

  
  vec2 posPx = (position + 1.f) * vec2(intervalSlot.zw) * .5f + vec2(intervalSlot.xy);
  gl_Position = vec4(posPx / vec2(m_3) * 2.f - 1.f, 0.f, 1.f);
}`,NH=Se((t=>Math.max(0,Math.ceil(Math.log2(t)))),"qe"),Tg=Se(((t,e,s)=>{const n=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.handle,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT1,t.TEXTURE_2D,s.handle,0),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1]),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&console.error("FBO incomplete"),{handle:n,ca0:e,ca1:s}}),"te"),MH=Se(((t,e)=>{const s=ea(t,kH,LH),n=t.getUniformLocation(s,"m_0"),i=t.getUniformLocation(s,"m_1"),r=t.getUniformLocation(s,"m_2"),o=t.getUniformLocation(s,"m_1l"),a=t.getUniformLocation(s,"m_3"),l=e.texture.spatialKeys(),u=LN(t,l.size),h=NA(t,l.size),g=NA(t,l.size),f=Qo(Tg(t,l,g),Tg(t,l,h)),p=Qo(Tg(t,u,g),Tg(t,u,h)),y=e.items.map((({N:L})=>NH(CN(L)))).reduce(((L,I)=>Math.max(L,I)),0),_=t.createVertexArray();t.bindVertexArray(_);const x=t.getAttribLocation(s,"position");t.enableVertexAttribArray(x),Qe(t,co),t.vertexAttribPointer(x,2,t.FLOAT,!1,0,0);const v=t.getAttribLocation(s,"m_4");t.enableVertexAttribArray(v);const b=e.items.map((({spatialKeysSlot:L})=>L)).map((({x:L,y:I,w:F,h:O})=>[L,I,F,O])).flat();Qe(t,new Uint32Array(b)),t.vertexAttribIPointer(v,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(v,1);const S=t.getAttribLocation(s,"m_5");function A(){t.bindVertexArray(_),t.viewport(0,0,...l.size),t.useProgram(s),t.uniform2ui(a,...l.size),t.uniform1i(r,0),t.uniform1i(o,1);for(let L=0;L<y;L++){t.activeTexture(t.TEXTURE0);const I=(1&L?u:l).handle;t.bindTexture(t.TEXTURE_2D,I),t.uniform1ui(n,L);for(let F=0;F<=L;F++){const[O,V]=1&L?f():p();t.bindFramebuffer(t.FRAMEBUFFER,O.handle),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,V.ca1.handle),t.uniform1ui(i,F),L===F?t.drawBuffers([t.COLOR_ATTACHMENT0,t.NONE]):F<2&&t.drawBuffers([t.NONE,t.COLOR_ATTACHMENT1]),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}}}t.enableVertexAttribArray(S),Qe(t,new Uint32Array(e.items.map((({N:L})=>L)))),t.vertexAttribIPointer(S,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(S,1),Se(A,"P");const w=Se((()=>{t.deleteTexture(u.handle),t.deleteTexture(g.handle),t.deleteTexture(h.handle),p().forEach((L=>t.deleteFramebuffer(L.handle))),f().forEach((L=>t.deleteFramebuffer(L.handle)))}),"h");return{step:A,outputs:{items:e.items,texture:{spatialKeys:()=>y-1&1?l:u}},destroy:w}}),"Ye"),IH=`#version 300 es
precision highp float;precision highp int;uint u(uint u){return u&=65535u,u=(u|u<<8)&16711935u,u=(u|u<<4)&252645135u,u=(u|u<<2)&858993459u,u=(u|u<<1)&1431655765u,u;}uint u(uvec2 t){return u(t.y)<<1|u(t.x);}vec2 u(vec2 t,vec4 u){return(t-u.xy)/u.zw;}uniform highp sampler2D m_b,m_7;flat in uvec4 m_24,m_25,m_26;flat in uint m_22,m_27;out uvec2 outColor;void main(){uvec2 o=uvec2(gl_FragCoord.xy);uint t=o.x-m_24.x+(o.y-m_24.y)*m_24.z;if(t>=m_22){outColor=uvec2(t,4294967295u);return;}uvec2 e=uvec2(t%m_25.z,t/m_25.z)+m_25.xy;vec4 i=texelFetch(m_7,ivec2(m_26.xy),0);vec2 n=u(texelFetch(m_b,ivec2(e),0).xy,i);outColor=uvec2(t,u(uvec2(float(1u<<m_27-1u)*n)));}`,RH=`#version 300 es
precision highp int;
precision highp float;

uniform uvec2 m_p;

in vec2 position; 
in uvec4 m_q; 
in uvec4 m_r; 
in uvec4 m_s; 
in uint m_5; 
in uint m_t; 

flat out uvec4 m_24;
flat out uvec4 m_25;
flat out uvec4 m_26;
flat out uint m_22;
flat out uint m_27;

void main() {
  m_24 = m_q;
  m_25 = m_r;
  m_26 = m_s;
  m_22 = m_5;
  m_27 = m_t;

  
  vec2 posPx = (position + 1.f) * vec2(m_q.zw) * .5f + vec2(m_q.xy);
  gl_Position = vec4(posPx / vec2(m_p) * 2.f - 1.f, 0.f, 1.f);
}`,FH=Se(((t,e)=>{const s=ea(t,RH,IH),n=e.items.map((({N:w})=>{const[L,I]=AH(CN(w));return{x:0,y:0,w:L,h:I}})),i=pu(n.slice()),r=new Uint32Array(2*i.w*i.h);n.forEach((w=>{for(let L=0;L<w.w*w.h;L++){const I=2*Bl(L,i.w,w);r[I]=L,r[I+1]=4294967295}}));const o=ii(t,{size:[i.w,i.h],data:r,type:t.UNSIGNED_INT,format:t.RG_INTEGER,internalFormat:t.RG32UI}),a=Jo(t,o.handle),l=Wa(t,s,{m_b:e.texture.points().handle,m_7:e.texture.spatialBoundaries().handle,m_p:o.size}),u=t.createVertexArray();t.bindVertexArray(u);const h=t.getAttribLocation(s,"position");t.enableVertexAttribArray(h),Qe(t,co),t.vertexAttribPointer(h,2,t.FLOAT,!1,0,0);const g=t.getAttribLocation(s,"m_q");t.enableVertexAttribArray(g);const f=n.map((({x:w,y:L,w:I,h:F})=>[w,L,I,F])).flat();Qe(t,new Uint32Array(f)),t.vertexAttribIPointer(g,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(g,1);const p=t.getAttribLocation(s,"m_r");t.enableVertexAttribArray(p);const y=e.items.map((({pointsSlot:w})=>w)).map((({x:w,y:L,w:I,h:F})=>[w,L,I,F])).flat();Qe(t,new Uint32Array(y)),t.vertexAttribIPointer(p,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(p,1);const _=t.getAttribLocation(s,"m_s");t.enableVertexAttribArray(_);const x=e.items.map((({spatialBoundariesSlot:w})=>w)).map((({x:w,y:L,w:I,h:F})=>[w,L,I,F])).flat();Qe(t,new Uint32Array(x)),t.vertexAttribIPointer(_,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(_,1);const v=t.getAttribLocation(s,"m_5");t.enableVertexAttribArray(v),Qe(t,new Uint32Array(e.items.map((({N:w})=>w)))),t.vertexAttribIPointer(v,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(v,1);const b=t.getAttribLocation(s,"m_t");function S(){t.viewport(0,0,o.size[0],o.size[1]),t.useProgram(s),t.bindVertexArray(u),t.bindFramebuffer(t.FRAMEBUFFER,a),sa(t,l,{m_b:e.texture.points().handle,m_7:e.texture.spatialBoundaries().handle}),t.drawArraysInstanced(t.TRIANGLES,0,6,n.length)}t.enableVertexAttribArray(b),Qe(t,new Uint32Array(e.items.map((({depth:w})=>w)))),t.vertexAttribIPointer(b,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(b,1),Se(S,"x");const A=Se((()=>{t.deleteFramebuffer(a),t.deleteTexture(o.handle)}),"E");return{step:S,outputs:{items:e.items.map(((w,L)=>({N:e.items[L].N,spatialKeysSlot:n[L]}))),texture:{spatialKeys:()=>o}},destroy:A}}),"Ze"),PH=`#version 300 es
precision mediump float;uniform mediump sampler2D m_b,m_7;uniform uint m_8;flat in uvec4 m_21;flat in uint m_22,m_23;out vec4 outColor;void main(){uvec2 o=uvec2(gl_FragCoord.xy);uint u=o.x-m_21.x+(o.y-m_21.y)*m_21.z;if(outColor=vec4(1e9,1e9,-1e9,-1e9),u>=m_22)return;if(m_8>=m_23){outColor=texelFetch(m_7,ivec2(o),0);return;}if(m_8==0u)outColor.xy=outColor.zw=texelFetch(m_b,ivec2(o),0).xy;else for(uint u;u<4u;u++){uvec2 e=(o-m_21.xy<<1u)+uvec2(u&1u,u>>1u)+m_21.xy;vec4 t=texelFetch(m_7,ivec2(e),0);outColor=vec4(min(outColor.xy,t.xy),max(outColor.zw,t.zw));}if(m_8==m_23-1u){vec2 o=outColor.zw-outColor.xy;outColor=vec4(outColor.xy-1.,vec2(max(o.x,o.y))+2.);}}`,zH=`#version 300 es
precision mediump int;
precision mediump float;

uniform uvec2 m_6;
uniform uint m_8;

in vec2 position; 
in uvec4 m_9; 
in uint m_5; 
in uint m_a; 

flat out uvec4 m_21;
flat out uint m_22;
flat out uint m_23;

void main() {
  uvec4 slot = uvec4(m_9.xy, m_9.zw >> min(m_8, m_23));
  m_21 = slot;
  m_22 = m_5;
  m_23 = m_a;

  
  vec2 posPx = (position + 1.f) * vec2(slot.zw) * .5f + vec2(m_21.xy);
  gl_Position = vec4(posPx / vec2(m_6) * 2.f - 1.f, 0.f, 1.f);
}`,DH=Se((t=>Math.ceil(Math.log2(Math.sqrt(t)))+1),"tt"),OH=Se(((t,e)=>{const s=ea(t,zH,PH),n=e.texture.points(),i=ii(t,{size:n.size,data:new Float32Array(n.data.buffer.slice(0)),type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F}),r=ii(t,{size:n.size,data:new Float32Array(n.data.buffer.slice(0)),type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F}),o=Qo(i,r),a=Jo(t,r.handle),l=Jo(t,i.handle),u=Qo(a,l),h=Wa(t,s,{m_6:n.size,m_7:i.handle,m_8:0}),g=e.items.map((({N:L})=>DH(L))),f=g.reduce(((L,I)=>Math.max(L,I)),0),p=t.createVertexArray();t.bindVertexArray(p);const y=t.getAttribLocation(s,"position");t.enableVertexAttribArray(y),Qe(t,co),t.vertexAttribPointer(y,2,t.FLOAT,!1,0,0);const _=t.getAttribLocation(s,"m_9");t.enableVertexAttribArray(_);const x=e.items.map((({pointsSlot:L})=>L)).map((({x:L,y:I,w:F,h:O})=>[L,I,F,O])).flat();Qe(t,new Uint32Array(x)),t.vertexAttribIPointer(_,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(_,1);const v=t.getAttribLocation(s,"m_5");t.enableVertexAttribArray(v),Qe(t,new Uint32Array(e.items.map((({N:L})=>L)))),t.vertexAttribIPointer(v,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(v,1);const b=t.getAttribLocation(s,"m_a");t.enableVertexAttribArray(b),Qe(t,new Uint32Array(g)),t.vertexAttribIPointer(b,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(b,1);let S=i;function A(){t.viewport(0,0,...i.size),t.useProgram(s),t.bindVertexArray(p);for(let L=0;L<f;L++){t.bindFramebuffer(t.FRAMEBUFFER,u()[0]);const[I,F]=o();S=F,sa(t,h,{m_b:e.texture.points().handle,m_6:e.texture.points().size,m_7:I.handle,m_8:L}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}}Se(A,"E");const w=Se((()=>{t.deleteFramebuffer(a),t.deleteFramebuffer(l),t.deleteTexture(r.handle),t.deleteTexture(i.handle)}),"P");return{step:A,outputs:{items:e.items.map((({pointsSlot:L})=>L)).map((({x:L,y:I})=>({spatialBoundariesSlot:{x:L,y:I,w:1,h:1}}))),texture:{spatialBoundaries:()=>S}},destroy:w}}),"rt"),BH=Se((t=>{let e;return()=>e||t().finally((()=>e=void 0))}),"nt"),UH=Se(((t,e)=>Math.max(.1,1-(t/Math.max(1,e-20))**7.39)),"ye"),GH=Se(((t,e=25,s=24e3)=>{const n=(s-e)/(e-1);return Math.ceil(e*n*4/(n+t))}),"ve"),MA=Se((t=>{const e=Math.max(1,Math.ceil(Math.log2(t)/2));return t>65535?e+1:e}),"_e"),IA={charge:10,edgeStrength:.5,edgeLength:30,elasticity:.9,margin:1,gravity:.01,inertia:.9,maxDisplacement:1e3,steps:200},VH=Se(((t,e)=>{let[s,n]=[0,0];const i=Se((()=>{for(let o=0;o<t;o++,s++)if(!e(s))return!0}),"i"),r=Se((o=>{i()?o(s):n=requestAnimationFrame((()=>r(o)))}),"a");return{start:BH((()=>new Promise((o=>(s=0)||r(o))))),step:i,stop:()=>cancelAnimationFrame(n)}}),"Ae"),b_=Se(((t,e,s)=>{let n=e.texture.particlesPositions();const{steps:i,batch:r,sortingMethod:o}=s,a=s.order??4,l={items:e.items.map((({N:v,particlesPositionsSlot:b})=>({N:v,pointsSlot:b}))),texture:{points:()=>n}},u=OH(t,l),h=FH(t,{items:e.items.map((({N:v},b)=>({depth:Math.max(1,s.depth??MA(v)),...l.items[b],...u.outputs.items[b]}))),texture:{...l.texture,...u.outputs.texture}}),g=(o==="ibr"?MH:CH)(t,h.outputs),f=vH(t,{items:e.items.map((({N:v},b)=>({depth:Math.max(1,s.depth??MA(v)),...u.outputs.items[b],...g.outputs.items[b]}))),texture:{...u.outputs.texture,...g.outputs.texture}}),p=_H(t,{items:e.items.map(((v,b)=>({order:a,...v,...f.outputs.items[b]}))),texture:{particlesPositions:()=>n,particlesCharges:e.texture.particlesCharges,...f.outputs.texture}}),y=fH(t,{items:p.outputs.items,texture:{...p.outputs.texture}}),_=hH(t,{items:e.items.map(((v,b)=>({...v,...f.outputs.items[b],...y.outputs.items[b]}))),texture:{...e.texture,...f.outputs.texture,...y.outputs.texture}},s),x=e.items.reduce(((v,{N:b})=>Math.max(v,b)),0);return{...VH(r??GH(x),(v=>(n=_.outputs.texture.points(),u.step(),h.step(),g.step(),f.step(),p.step(),y.step(),_.step(UH(v,i)),v<i))),destroy:()=>{u.destroy(),h.destroy(),g.destroy(),f.destroy(),p.destroy(),y.destroy(),_.destroy()}}}),"_t"),RA=0,kN=typeof window>"u",jH=typeof performance<"u"&&performance.now?performance:Date,HH=kN?t=>{const e=jH.now(),s=Math.max(0,16-(e-RA)),n=setTimeout((()=>t(e+s)),s);return RA=e+s,n}:window.requestAnimationFrame,$H=kN?t=>clearTimeout(t):window.cancelAnimationFrame;function NN(t,e,s){for(let n=0;n<t.length;n++){const i=t[n];i.x=e[n],i.y=s[n]}}Se(NN,"defaultUpdate");var qH=Se((()=>{}),"noop"),YH=.001,E_={movementRatio:7e-8,surfaceRatio:.0025},WH=.003,XH=Se(((t,e)=>WH*t**2+(e+1)),"defaultMass"),ox=class{constructor(t={}){this.onUpdate=Se((e=>{}),"onUpdate"),this.update=NN,this.nextTick=HH,this.cancelTick=$H,this.onEnd=qH,this.charge=10,this.maxIterations=200,this.minMovement=.1,this.edgeLength=30,this.edgeStrength=3,this.friction=.1,this.elasticity=.9,this.margin=1,this.cx=void 0,this.cy=void 0,this.gravity=.01,this.theta=.34,this.batch=void 0,this.inertia=.9,this.integrator=0,this.multilevel=!1,this.placement="none",this.placementOffset=10,this.alignSiblings=!1,this.bucketSize=void 0,this.maxDisplacement=1e3,this.siblingsMinAngle=0,this.siblingsOffset=.15,this.steps=200,this.scaling=1,this.defaultRadius=1,this.autoStop=E_,this.gpuAcceleration=!0,this.barnesHutOptimization=!0,"autoStop"in t?t.autoStop&&(typeof t.autoStop=="boolean"?t.autoStop=E_:t.autoStop={...t.autoStop,...E_}):t.steps;for(const e in t)t[e]===void 0&&e!=="order"&&e!=="depth"||(this[e]=t[e])}};Se(ox,"Settings");var ZH=Se((({nodes:t,edges:e})=>{const s=t.length,n=e.length,i=new Uint32Array(s);for(let r=0;r<n;r++){const{source:o,target:a}=e[r];i[o]++,i[a]++}return i}),"degrees"),KH=Se(((t,e)=>({nodes:t.nodes.map(((s,n)=>{let i=(s.mass??1)*XH(s.r||1,e[n]);return i=Math.max(i,YH),{...s,mass:i}})),edges:t.edges.map((s=>{const n=s.weight||1,i=e[s.target]+1,r=e[s.source]+1,o=n*(i*r)/Math.min(i,r)/(i+r);return{...s,stiffness:o}}))})),"defaultSettings"),Cg=Se(((t,e)=>{const s=lH(ix(t),e);return KH(s,ZH(s))}),"cleanGraph"),FA=class{constructor(t){this.promise=new Promise(t)}then(t){return this.promise.then(t)}stop(){return this.simulation.stop(),this}get iterations(){return this.simulation.iterations()}};function Yg(t,e,s={}){var x;let n,i;e.getExtension("EXT_color_buffer_float")||((x=e.getExtension("WEBGL_lose_context"))==null||x.loseContext());let r=new ox({...IA,...s});const o=t.nodes.length,a=s.cx||t.nodes.reduce(((v,b)=>v+(b.x||0)),0)/o,l=s.cy||t.nodes.reduce(((v,b)=>v+(b.y||0)),0)/o,u=[a,l],h=Array.from({length:o},((v,b)=>b)),g=Se((v=>{if(!n)throw new Error("No graph has been set");const{size:b}=n.texture.particlesPositions();if(b[0]*b[1]<=1)return{X:[0],Y:[0]};const S=[],A=[];let w=0;const L=new Float32Array(4*b[0]*b[1]);return e.readPixels(0,0,b[0],b[1],e.RGBA,e.FLOAT,L),n.items.forEach((({N:I,particlesPositionsSlot:F})=>{const{x:O,y:V,w:j}=F;for(let Z=0;Z<I;Z++){const at=O+Z%j,pt=4*((V+Math.floor(Z/j))*b[0]+at);S[h[w+Z]]=L[pt]+a,A[h[w+Z]]=L[pt+1]+l}w+=I})),v&&(f(),p()),{X:S,Y:A}}),"readLayoutData"),f=Se((()=>{i&&(i.stop(),i.destroy(),i=void 0)}),"simulationCleanup"),p=Se((()=>{n&&(kA(e,n),n=void 0)}),"graphLayoutCleanup"),y={setOptions:(v={})=>(r=new ox({...IA,...v}),n&&(f(),i=b_(e,n,r)),y),setGraph:(v={nodes:[],edges:[]})=>{let b;if(n&&kA(e,n),s.groups){const S={};Object.entries(s.groups).forEach((([A,w])=>w.forEach((L=>S[L]=Number(A))))),b=LA(ix(v),Object.values(S)),b.map((({nodes:A})=>A)).flat().forEach(((A,w)=>h[w]=A.id)),b=b.map((A=>Cg(A,u)))}else b=[Cg(v,u)];return n=rx(e,b),r&&(f(),i=b_(e,n,r)),y},start:()=>{if(!i)throw new Error("No graph has been set");return i.start().finally((()=>{var v;return(v=s.onEnd)==null?void 0:v.call(s,1)})).catch((v=>{throw new Error("Something went wrong during GPU layout: "+v)})),y},stop:()=>(i&&i.stop(),y),step:()=>{if(!i)throw new Error("No graph has been set");return i.step(),y},data:v=>g(v),iterations:()=>1};let _;if(s.groups){const v={};Object.entries(s.groups).forEach((([b,S])=>S.forEach((A=>v[A]=Number(b))))),_=LA(ix(t),Object.values(v)),_.map((({nodes:b})=>b)).flat().forEach(((b,S)=>h[S]=b.id)),_=_.map((b=>Cg(b,u)))}else _=[Cg(t,u)];return n=rx(e,_),i=b_(e,n,r),y}/**
* @preserve
* @linkurious/force-layout@1.0.9
* Ogma general-purpose force-directed layout
*/function PA(){var t=(()=>{var e=Object.defineProperty,s=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,r=(Y,et)=>e(Y,"name",{value:et,configurable:!0}),o={};((Y,et)=>{for(var J in et)e(Y,J,{get:et[J],enumerable:!0})})(o,{IntegratorType:()=>ss,force:()=>cs});var a=class{constructor(Y){let et=l();this.c=1,this.s0=et(" "),this.s1=et(" "),this.s2=et(" "),this.s0-=et(String(Y)),this.s0<0&&(this.s0+=1),this.s1-=et(String(Y)),this.s1<0&&(this.s1+=1),this.s2-=et(Y),this.s2<0&&(this.s2+=1),et=null}next(){return()=>{const Y=2091639*this.s0+23283064365386963e-26*this.c;return this.s0=this.s1,this.s1=this.s2,this.s2=Y-(this.c=0|Y)}}nextDouble(){const Y=this.next();return()=>Y()+11102230246251565e-32*(2097152*Y()|0)}nextInt32(){const Y=this.next();return()=>4294967296*Y()|0}};function l(){let Y=4022871197;return et=>{et=et.toString();for(let J=0;J<et.length;J++){Y+=et.charCodeAt(J);let tt=.02519603282416938*Y;Y=tt>>>0,tt-=Y,tt*=Y,Y=tt>>>0,tt-=Y,Y+=4294967296*tt}return 23283064365386963e-26*(Y>>>0)}}function u(Y){return new a(Y.toString()).next()}r(a,"Alea"),r(l,"Mash"),r(u,"impl");var h=u(42);function g(Y){h=u(Y)}function f(){return 1e-6*(h()-.5)}function p(Y,et,J,{edgeStrength:tt,edgeLength:ft}){const _t=J.sources,it=J.targets,vt=J.X,Ct=J.Y,Ft=J.R,Pt=J.fx,Lt=J.fy,Yt=J.degrees,$t=J.masses,Bt=J.weights;for(let Gt=0;Gt<et.length;Gt++){const qt=et[Gt],Kt=_t[qt],ee=it[qt],oe=1,re=Yt[Kt]+oe,C=Yt[ee]+oe,R=tt*Bt[qt];let U=vt[ee]+Pt[ee]-vt[Kt]-Pt[Kt]||f(),W=Ct[ee]+Lt[ee]-Ct[Kt]-Lt[Kt]||f();const St=U*U+W*W,bt=Math.sqrt(St),It=ft+Ft[Kt]+Ft[ee];if(bt<=It)continue;const Qt=It-bt,ie=Qt*(C*re/Math.min(C,re)/(C+re)),Ee=Math.min(1,Y*R*Qt/St*(ie*(C+re)/(C*re))),we=C*re/(C+re);U*=Ee,W*=Ee,Pt[Kt]+=U*we/$t[Kt],Lt[Kt]+=W*we/$t[Kt],Pt[ee]-=U*we/$t[ee],Lt[ee]-=W*we/$t[ee]}}r(g,"setSeed"),r(f,"randomize"),r(p,"attraction");var y=r(((Y,et)=>{const J=et.sources,tt=et.targets,ft=et.degrees,_t=et.weights,it=et.edgeIds,vt=et.nodeToGroup,Ct=et.hasGroups;for(let Ft=0;Ft<Y.length;Ft++){const{source:Pt,target:Lt,weight:Yt=1}=Y[Ft];J[Ft]=Pt,tt[Ft]=Lt,_t[Ft]=Yt,ft[Pt]++,ft[Lt]++,it[Ft]=Ft,_t[Ft]=Yt===void 0?1:Yt,Ct&&vt[Pt]!==vt[Lt]&&(_t[Ft]=0)}}),"initialize");function _(Y,et,J,{gravity:tt,cx:ft,cy:_t}){const it=J.X,vt=J.Y,Ct=J.fx,Ft=J.fy,Pt=J.nodeToGroup,Lt=J.cells,Yt=J.hasGroups,$t=et.length;for(let Bt=0;Bt<$t;Bt++){const Gt=et[Bt],qt=Yt?Lt[Pt[Bt]].cx:ft,Kt=Yt?Lt[Pt[Bt]].cy:_t,ee=qt-it[Gt]||f(),oe=Kt-vt[Gt]||f(),re=tt*Y;Ct[Gt]+=ee*re,Ft[Gt]+=oe*re}}p.initialize=y,r(_,"center");var x=r(((Y,et,J)=>{const{X:tt,Y:ft}=et;let _t=J.cx,it=J.cy;const vt=Y.length;if(_t===void 0||it===void 0){_t=it=0;for(let Ct=0;Ct<vt;Ct++)_t+=tt[Ct],it+=ft[Ct];_t/=vt,it/=vt}J.cx=_t,J.cy=it}),"initialize");_.initialize=x;var v=class{constructor(Y,et,J,tt){this.left=null,this.right=null,this.data=null,this.code=Y,this.data=et,this.left=J,this.right=tt}};function b(Y,et,J,tt,ft){const _t=new v(null,null,null,null),it=[_t],vt=[tt,ft];for(;it.length!==0;){const Ct=vt.pop(),Ft=vt.pop(),Pt=it.pop();if(Ct-Ft==0)Pt.code=J[Ft],Pt.data=Y[et[Ft]];else{const Lt=w(et,J,Ft,Ct);Pt.code=Lt,Ft<=Lt&&(Pt.left=new v(null,null,null,null),it.push(Pt.left),vt.push(Ft,Lt)),Ct>Lt&&(Pt.right=new v(null,null,null,null),it.push(Pt.right),vt.push(Lt+1,Ct))}}return _t}function S(Y,et,J,tt,ft,_t){const it=new v(null,null,null,null),vt=[it],Ct=[tt,ft];for(;vt.length!==0;){const Ft=Ct.pop(),Pt=Ct.pop(),Lt=vt.pop();if(Ft-Pt<_t){const Yt=new Array(Ft-Pt+1);for(let $t=Pt,Bt=0;$t<=Ft;$t++,Bt++)Yt[Bt]=Y[et[$t]];Lt.code=J[Pt],Lt.data=Yt}else{const Yt=w(et,J,Pt,Ft);Lt.code=Yt,Pt<=Yt&&(Lt.left=new v(null,null,null,null),vt.push(Lt.left),Ct.push(Pt,Yt)),Ft>Yt&&(Lt.right=new v(null,null,null,null),vt.push(Lt.right),Ct.push(Yt+1,Ft))}}return it}r(v,"Node"),r(b,"buildIterative"),r(S,"buildIterativeBuckets");var A=Math.clz32||r((function(et){let J=-2147483648;for(let tt=0;tt<31;tt+=1){if(J&et)return tt;J>>>=1}return 32}),"clz");function w(Y,et,J,tt){const ft=et[Y[J]],_t=et[Y[tt]];if(ft===_t)return J;const it=A(ft^_t);let vt,Ct,Ft,Pt=J,Lt=tt-J;do Lt=Lt+1>>1,vt=Pt+Lt,vt<tt&&(Ct=et[Y[vt]],Ft=A(ft^Ct),Ft>it&&(Pt=vt));while(Lt>1);return Pt}function L(Y,et){let J=Y^et,tt=65535^J,ft=65535^(Y|et),_t=Y&(65535^et),it=J|tt>>1,vt=J>>1^J,Ct=ft>>1^tt&_t>>1^ft,Ft=J&ft>>1^_t>>1^_t;J=it,tt=vt,ft=Ct,_t=Ft,it=J&J>>2^tt&tt>>2,vt=J&tt>>2^tt&(J^tt)>>2,Ct^=J&ft>>2^tt&_t>>2,Ft^=tt&ft>>2^(J^tt)&_t>>2,J=it,tt=vt,ft=Ct,_t=Ft,it=J&J>>4^tt&tt>>4,vt=J&tt>>4^tt&(J^tt)>>4,Ct^=J&ft>>4^tt&_t>>4,Ft^=tt&ft>>4^(J^tt)&_t>>4,J=it,tt=vt,ft=Ct,_t=Ft,Ct^=J&ft>>8^tt&_t>>8,Ft^=tt&ft>>8^(J^tt)&_t>>8,J=Ct^Ct>>1,tt=Ft^Ft>>1;let Pt=Y^et,Lt=tt|65535^(Pt|J);return Pt=16711935&(Pt|Pt<<8),Pt=252645135&(Pt|Pt<<4),Pt=858993459&(Pt|Pt<<2),Pt=1431655765&(Pt|Pt<<1),Lt=16711935&(Lt|Lt<<8),Lt=252645135&(Lt|Lt<<4),Lt=858993459&(Lt|Lt<<2),Lt=1431655765&(Lt|Lt<<1),(Lt<<1|Pt)>>>0}r(w,"findSplit"),r(L,"hilbert");var I=[0,1],F=[0,2];for(let Y=4;Y<65535;Y<<=2)for(let et=0,J=I.length;et<J;et++)I.push(I[et]|Y),F.push((I[et]|Y)<<1);function O(Y,et){return(F[255&et]|I[255&Y])+65536*(F[et>>8&255]|I[Y>>8&255])+4294967296*(F[et>>16&255]|I[Y>>16&255])}r(O,"morton");var V=new Uint32Array(1024);function j(Y,et){const J=new Uint32Array(et.length);for(let ft=0;ft<1024;ft++)V[ft]=0;const tt=255;for(let ft=0;ft<et.length;ft++){const _t=et[ft];V[_t&tt]++,V[256+(_t>>8&tt)]++,V[512+(_t>>16&tt)]++,V[768+(_t>>24&tt)]++}for(let ft=0;ft<4;ft++){let _t=0,it=0;const vt=256*ft;for(let Ct=0;Ct<256;Ct++)_t=V[Ct+vt],V[Ct+vt]=it,it+=_t}for(let ft=0;ft<et.length;ft++){const _t=et[ft];J[V[_t&tt]++]=ft}for(let ft=0;ft<et.length;ft++){const _t=J[ft],it=et[_t];Y[V[256+(it>>8&tt)]++]=_t}for(let ft=0;ft<et.length;ft++){const _t=Y[ft],it=et[_t];J[V[512+(it>>16&tt)]++]=_t}for(let ft=0;ft<et.length;ft++){const _t=J[ft],it=et[_t];Y[V[768+(it>>24&tt)]++]=_t}}r(j,"radixSort");var Z=class{constructor(Y,{getX:et,getY:J,bucketSize:tt=0,sfc:ft=1}={}){this.bucketSize=0,this._root=null;const _t=Y.length,it=new Uint32Array(_t);let vt=1/0,Ct=1/0,Ft=-1/0,Pt=-1/0;this._x=et,this._y=J;const Lt=ft===1?L:O;this._project=Lt;const Yt=new Uint32Array(_t);for(let Gt=0;Gt<_t;Gt++){const qt=Y[Gt],Kt=et(qt),ee=J(qt);Kt<vt&&(vt=Kt),ee<Ct&&(Ct=ee),Kt>Ft&&(Ft=Kt),ee>Pt&&(Pt=ee),Yt[Gt]=Gt}this._minX=vt,this._minY=Ct,this._maxX=Ft,this._maxY=Pt;const $t=65535/Math.max(Ft-vt,1),Bt=65535/Math.max(Pt-Ct,1);this._hw=$t,this._hh=Bt;for(let Gt=0;Gt<_t;Gt++){const qt=Y[Gt];it[Gt]=Lt($t*(et(qt)-vt),Bt*(J(qt)-Ct))}j(Yt,it),this._root=tt===0?b(Y,Yt,it,0,_t-1):S(Y,Yt,it,0,_t-1,tt),this.bucketSize=tt}get root(){return this._root}inOrder(Y,et){let J=this._root;const tt=[];let ft=!1;for(;!ft;)if(J)tt.push(J),J=J.left;else if(tt.length!==0){if(J=tt.pop(),Y.call(et,J))break;J=J.right}else ft=!0;return this}preOrder(Y,et){const J=[this._root];for(;J.length!==0;){const tt=J.pop();Y.call(et,tt)||(tt.right&&J.push(tt.right),tt.left&&J.push(tt.left))}return this}postOrder(Y,et){const J=[];let tt,ft=this._root;do{for(;ft;)ft.right&&J.push(ft.right),J.push(ft),ft=ft.left;ft=J.pop(),tt=J.length-1,ft.right&&J[tt]===ft.right?(J[tt]=ft,ft=ft.right):(Y.call(et,ft),ft=null)}while(J.length!==0);return this}map(Y,et){const J=[];return this.inOrder((tt=>{J.push(Y.call(et,tt))})),J}height(){return at(this._root)}toString(Y=(et=>et.code.toString())){const et=[];return pt(this._root,"",!0,(J=>et.push(J)),Y),et.join("")}size(){let Y=0;return this.preOrder((()=>{Y++})),Y}destroy(){return this._root=null,this}};function at(Y){return Y?1+Math.max(at(Y.left),at(Y.right)):0}function pt(Y,et,J,tt,ft){if(Y){tt(et+(J?"^-- ":"|-- ")+ft(Y)+`
`);const _t=et+(J?"    ":"|   ");Y.left&&pt(Y.left,_t,!1,tt,ft),Y.right&&pt(Y.right,_t,!0,tt,ft)}}function K(Y){for(let et=Y.length-1;et>=0;et--){let J=Math.floor(Math.random()*(et+1));J=Math.max(Math.min(J,et),0);const tt=Y[et];Y[et]=Y[J],Y[J]=tt}return Y}r(Z,"BVH"),r(at,"treeHeight"),r(pt,"row"),r(K,"shuffle");var ut,ht,nt,ot,Nt,Q,Et,Xt,Ht,Zt=r((Y=>Y.x),"getX"),ae=r((Y=>Y.y),"getY"),pe=r((Y=>Y.r),"getR");function ne(Y,et=Zt,J=ae,tt=pe){const ft=K(Y.slice()),_t=ft.length;let it,vt=[],Ct=0;for(;Ct<_t;){const Ft=ft[Ct];it&&ce(it,et(Ft),J(Ft),tt(Ft))?Ct++:(vt=te(vt,Ft,et,J,tt),it=ve(vt,et,J,tt),Ct=0)}return it}function te(Y,et,J,tt,ft){const _t=J(et),it=tt(et),vt=ft(et),Ct={x:_t,y:it,r:vt};if(Ce(Ct,Y,J,tt,ft))return[et];for(let Ft=0;Ft<Y.length;++Ft){const Pt=Y[Ft],Lt=J(Pt),Yt=tt(Pt),$t=ft(Pt);if(!se(Ct,Lt,Yt,$t)&&Ce(ge(Lt,Yt,$t,_t,it,vt),Y,J,tt,ft))return[Y[Ft],et]}for(let Ft=0;Ft<Y.length-1;Ft++)for(let Pt=Ft+1;Pt<Y.length;Pt++){const Lt=Y[Ft],Yt=Y[Pt],$t=J(Lt),Bt=tt(Lt),Gt=ft(Lt),qt=J(Yt),Kt=tt(Yt),ee=ft(Yt);if(!se(ge($t,Bt,Gt,qt,Kt,ee),_t,it,vt)&&!se(ge($t,Bt,Gt,_t,it,vt),qt,Kt,ee)&&!se(ge(qt,Kt,ee,_t,it,vt),$t,Bt,Gt)&&Ce(ze($t,Bt,Gt,qt,Kt,ee,_t,it,vt),Y,J,tt,ft))return[Y[Ft],Y[Pt],et]}throw new Error}function se(Y,et,J,tt){const ft=Y.r-tt,_t=et-Y.x,it=J-Y.y;return ft>=0&&ft*ft>_t*_t+it*it}function ce(Y,et,J,tt){const ft=Y.r-tt+1e-6,_t=et-Y.x,it=J-Y.y;return ft>0&&ft*ft>_t*_t+it*it}function Ce(Y,et,J,tt,ft){for(let _t=0;_t<et.length;++_t){const it=et[_t];if(!ce(Y,J(it),tt(it),ft(it)))return!1}return!0}function ve(Y,et,J,tt){return Y.length===1?Ne(et(Y[0]),J(Y[0]),tt(Y[0])):Y.length===2?ge(et(Y[0]),J(Y[0]),tt(Y[0]),et(Y[1]),J(Y[1]),tt(Y[1])):ze(et(Y[0]),J(Y[0]),tt(Y[0]),et(Y[1]),J(Y[1]),tt(Y[1]),et(Y[2]),J(Y[2]),tt(Y[2]))}function Ne(Y,et,J){return{x:Y,y:et,r:J}}function ge(Y,et,J,tt,ft,_t){const it=tt-Y,vt=ft-et,Ct=_t-J,Ft=Math.sqrt(it*it+vt*vt);return{x:(Y+tt+it/Ft*Ct)/2,y:(et+ft+vt/Ft*Ct)/2,r:(Ft+J+_t)/2}}function ze(Y,et,J,tt,ft,_t,it,vt,Ct){const Ft=(Y+tt+it)/3,Pt=(et+ft+vt)/3,Lt=Y-Ft,Yt=et-Pt,$t=tt-Ft,Bt=ft-Pt,Gt=it-Ft,qt=vt-Pt,Kt=Lt-$t,ee=Lt-Gt,oe=Yt-Bt,re=Yt-qt,C=_t-J,R=Ct-J,U=Lt*Lt+Yt*Yt-J*J,W=U-$t*$t-Bt*Bt+_t*_t,St=U-Gt*Gt-qt*qt+Ct*Ct,bt=ee*oe-Kt*re,It=(oe*St-re*W)/(2*bt)-Lt,Qt=(re*C-oe*R)/bt,ie=(ee*W-Kt*St)/(2*bt)-Yt,Ee=(Kt*R-ee*C)/bt,we=Qt*Qt+Ee*Ee-1,We=2*(J+It*Qt+ie*Ee),us=It*It+ie*ie-J*J,ms=-(Math.abs(we)>1e-6?(We+Math.sqrt(We*We-4*we*us))/(2*we):us/We);return{x:Ft+Lt+It+Qt*ms,y:Pt+Yt+ie+Ee*ms,r:ms}}function is(Y,et,J,{X:tt,Y:ft,R:_t,fx:it,fy:vt,bucketSize:Ct},{elasticity:Ft}){if(Ft===0)return J;J||(J=new Z(et,{getX:ut,getY:ht,bucketSize:Ct})).postOrder(ot);for(let Pt=0;Pt<et.length;Pt++)Q=et[Pt],Et=tt[Q]+it[Q],Xt=ft[Q]+vt[Q],Ht=_t[Q],J.preOrder(Nt);return J}r(ne,"med"),r(te,"extend"),r(se,"contains"),r(ce,"containsWeak"),r(Ce,"containsWeakAll"),r(ve,"enclose"),r(Ne,"from1"),r(ge,"from2"),r(ze,"from3"),r(is,"collisionForce");var Ge=r((Y=>{const et=Y.X,J=Y.Y,tt=Y.R,ft=Y.bucketSize;return _t=>{let it,vt,Ct,Ft;const Pt=_t.data;if(Pt!==null)if(ft!==0){const Lt=ne(Pt,ut,ht,nt);it=Lt.x,vt=Lt.y,Ct=Lt.r}else{const Lt=Pt;it=et[Lt],vt=J[Lt],Ct=tt[Lt]}else if(_t.left&&_t.right){const Lt=_t.left.cx,Yt=_t.left.cy,$t=_t.right.cx,Bt=_t.right.cy,Gt=_t.left.r,qt=_t.right.r,Kt=$t-Lt,ee=Bt-Yt,oe=qt-Gt,re=Math.sqrt(Kt*Kt+ee*ee);it=(Lt+$t+Kt/re*oe)/2,vt=(Yt+Bt+ee/re*oe)/2,Ct=(re+Gt+qt)/2}else Ft=_t.left||_t.right,Ft&&(it=Ft.cx,vt=Ft.cy,Ct=Ft.r);_t.cx=it,_t.cy=vt,_t.r=Ct}}),"getMeasureBodies"),De=r(((Y,{elasticity:et,margin:J})=>{const tt=Y.X,ft=Y.Y,_t=Y.R,it=Y.fx,vt=Y.fy,Ct=Y.bucketSize,Ft=Y.nodeToGroup,Pt=Y.cellSize,Lt=Y.hasGroups;return Yt=>{const $t=Yt.data;if($t===null){const Bt=Yt.cx-Et,Gt=Yt.cy-Xt,qt=Yt.r+Ht;return Lt?Bt*Bt+Gt*Gt>Pt*Pt:Bt*Bt+Gt*Gt>qt*qt}if(Ct!==0){const Bt=$t;for(let Gt=0;Gt<Bt.length;Gt++){const qt=Bt[Gt];if(qt>Q){const Kt=_t[qt];let ee=Et-tt[qt]-it[qt],oe=Xt-ft[qt]-vt[qt];const re=Ht+Kt+J;let C=ee*ee+oe*oe;if(C<re*re){ee===0&&(ee=f(),C+=ee*ee),oe===0&&(oe=f(),C+=oe*oe);const R=Math.sqrt(C),U=(re-R)*et/R,W=Kt/re;it[Q]+=ee*U*W,vt[Q]+=oe*U*W,it[qt]-=ee*U*(1-W),vt[qt]-=oe*U*(1-W)}}}}else{const Bt=Yt.data;if(Lt&&Ft[Q]!==Ft[Bt])return;if(Bt>Q){const Gt=_t[Bt];let qt=Et-tt[Bt],Kt=Xt-ft[Bt];const ee=Ht+Gt+J;let oe=qt*qt+Kt*Kt;if(oe<ee*ee){qt===0&&(qt=f(),oe+=qt*qt),Kt===0&&(Kt=f(),oe+=Kt*Kt);const re=Math.sqrt(oe),C=(ee-re)*et/re,R=Gt/ee;it[Q]+=qt*C*R,vt[Q]+=Kt*C*R,it[Bt]-=qt*C*(1-R),vt[Bt]-=Kt*C*(1-R)}}}}}),"getApplyForce"),He=r(((Y,et,J)=>{const{X:tt,Y:ft,R:_t}=et;ut=r((it=>tt[it]),"getX"),ht=r((it=>ft[it]),"getY"),nt=r((it=>_t[it]),"getR"),ot=Ge(et),Nt=De(et,J)}),"initialize");function Je(Y,et,{masses:J,X:tt,Y:ft,fx:_t,fy:it},{charge:vt}){const Ct=et.length;let Ft,Pt,Lt,Yt,$t,Bt,Gt,qt,Kt;for(let ee=0;ee<Ct;ee++){Ft=et[ee];for(let oe=ee+1;oe<Ct;oe++)if(ee!==oe){if(Pt=et[oe],Ft===Pt)continue;Lt=tt[Ft]-tt[Pt]||f(),Yt=ft[Ft]-ft[Pt]||f(),$t=Lt*Lt+Yt*Yt,$t<1&&($t=Math.sqrt(1*$t)),Bt=vt*J[Pt],Gt=Y*Bt/$t,qt=vt*J[Ft],Kt=Y*qt/$t,_t[Ft]+=Lt*Gt,it[Ft]+=Yt*Gt,_t[Pt]-=Lt*Kt,it[Pt]-=Yt*Kt}}}is.initialize=He,r(Je,"repulsion"),Je.initialize=()=>{};var ss=(Y=>(Y[Y.verlet=0]="verlet",Y[Y.euler=1]="euler",Y))(ss||{}),ts=0,hs=typeof window>"u",Fe=typeof performance<"u"&&performance.now?performance:Date,Oe=hs?Y=>{const et=Fe.now(),J=Math.max(0,16-(et-ts)),tt=setTimeout((()=>Y(et+J)),J);return ts=et+J,tt}:window.requestAnimationFrame,Cs=hs?Y=>clearTimeout(Y):window.cancelAnimationFrame;function Fs(Y,et,J){for(let tt=0;tt<Y.length;tt++){const ft=Y[tt];ft.x=et[tt],ft.y=J[tt]}}r(Fs,"defaultUpdate");var Hs,Ls,Sn,gn,ln,xs,Ps,gt,N,P,D,B=r((()=>{}),"noop"),$={movementRatio:7e-8,surfaceRatio:.0025},H=r(((Y,et)=>.003*Y**2+(et+1)),"defaultMass"),X=class{constructor(Y={}){this.onUpdate=r((et=>{}),"onUpdate"),this.update=Fs,this.nextTick=Oe,this.cancelTick=Cs,this.onEnd=B,this.charge=10,this.maxIterations=200,this.minMovement=.1,this.edgeLength=30,this.edgeStrength=3,this.friction=.1,this.elasticity=.9,this.margin=1,this.cx=void 0,this.cy=void 0,this.gravity=.01,this.theta=.34,this.batch=void 0,this.inertia=.9,this.integrator=0,this.multilevel=!1,this.placement="none",this.placementOffset=10,this.alignSiblings=!1,this.bucketSize=void 0,this.maxDisplacement=1e3,this.siblingsMinAngle=0,this.siblingsOffset=.15,this.steps=200,this.scaling=1,this.defaultRadius=1,this.autoStop=$,this.gpuAcceleration=!0,this.barnesHutOptimization=!0,"autoStop"in Y?Y.autoStop&&(typeof Y.autoStop=="boolean"?Y.autoStop=$:Y.autoStop={...Y.autoStop,...$}):Y.steps;for(const et in Y)Y[et]===void 0&&et!=="order"&&et!=="depth"||(this[et]=Y[et])}};r(X,"Settings");var lt=0;function dt(Y,et,J,tt){const ft=tt.X,_t=tt.Y,it=tt.R,vt=tt.masses,Ct=tt.bucketSize;lt=Y,J===null&&(J=new Z(et,{getX:Sn,getY:gn,bucketSize:Ct})).postOrder(Hs);const Ft=et.length;for(let Pt=0;Pt<Ft;Pt++)xs=et[Pt],Ps=ft[xs],gt=_t[xs],N=it[xs],P=vt[xs],D=P,J.preOrder(Ls);return J}r(dt,"repulsion");var ct=r(((Y,{charge:et,theta:J})=>{const tt=Y.fx,ft=Y.fy,_t=Y.X,it=Y.Y,vt=Y.R,Ct=Y.masses,Ft=Y.bucketSize,Pt=Y.cellSize;return Lt=>{let Yt=0,$t=0,Bt=Ps-Lt.cx||f(),Gt=gt-Lt.cy||f(),qt=Bt*Bt+Gt*Gt,Kt=N+Lt.r;const ee=Lt.data;if(ee!==null){if(ee===xs)return!1;if(Ft!==0){const oe=ee;for(let re=0;re<oe.length;re++){const C=oe[re];if(C===xs)continue;Bt=Ps-_t[C]||f(),Gt=gt-it[C]||f(),qt=Bt*Bt+Gt*Gt,Kt=N+vt[C],qt<1&&(qt=Math.sqrt(1*qt));const R=Ct[C];Yt=et*R*D,$t=lt*Yt/qt,tt[xs]+=Bt*$t/P,ft[xs]+=Gt*$t/P}}else{if(qt<1&&(qt=Math.sqrt(1*qt)),qt>(Pt/2)**2)return!0;Yt=et*Lt.mass*D,$t=lt*Yt/qt,tt[xs]+=Bt*$t/P,ft[xs]+=Gt*$t/P}}else{const oe=Kt/J;if(qt>oe*oe)return qt<1&&(qt=Math.sqrt(1*qt)),qt>(Pt/2)**2||(Yt=et*Lt.mass,Yt=et*Lt.mass*D,$t=lt*Yt/qt,tt[xs]+=Bt*$t/P,ft[xs]+=Gt*$t/P),!0}}}),"getApplyForce"),mt=r((Y=>{const et=Y.X,J=Y.Y,tt=Y.R,ft=Y.masses,_t=Y.bucketSize;return it=>{let vt,Ct,Ft=0,Pt=0,Lt=0,Yt=0;const $t=it.data;if($t!==null)if(_t!==0){const Bt=$t,Gt=ne(Bt,Sn,gn,ln);Ft=Gt.x,Pt=Gt.y,Lt=Gt.r;for(let qt=0;qt<Bt.length;qt++)Yt+=ft[Bt[qt]]}else Ct=$t,Ft=et[Ct],Pt=J[Ct],Lt=tt[Ct],Yt=ft[Ct];else if(it.left&&it.right){const Bt=it.left.cx,Gt=it.left.cy,qt=it.right.cx,Kt=it.right.cy,ee=it.left.r,oe=it.right.r,re=qt-Bt,C=Kt-Gt,R=oe-ee,U=Math.sqrt(re*re+C*C);Ft=(Bt+qt+re/U*R)/2,Pt=(Gt+Kt+C/U*R)/2,Lt=(U+ee+oe)/2,Yt=it.left.mass+it.right.mass}else vt=it.left||it.right,Ft=vt.cx,Pt=vt.cy,Lt=vt.r,Yt=vt.mass;it.cx=Ft,it.cy=Pt,it.r=Lt,it.mass=Yt}}),"getAccumulateBodies"),yt=r(((Y,et,J)=>{const tt=Y.length,ft=et.X,_t=et.Y,it=et.R,vt=et.degrees,Ct=et.pinned,Ft=et.masses,Pt=et.nodeIds,Lt=J.scaling,Yt=J.defaultRadius,$t=J.bucketSize;et.bucketSize=$t===void 0?Math.floor(Math.log(tt)):$t;let Bt=1/0,Gt=1/0,qt=-1/0,Kt=-1/0;const ee=Math.PI*(3-Math.sqrt(5));let oe=0;for(let re=0;re<Y.length;re++){const C=Y[re];let{x:R,y:U,r:W}=C,{mass:St=1}=C;if(St=Math.max(St*H(W||Yt,vt[re]),.001),isNaN(R)||isNaN(U)){const bt=5*Math.sqrt(re),It=re*ee;R=bt*Math.cos(It),U=bt*Math.sin(It)}W=W||Yt,ft[re]=R,_t[re]=U,it[re]=W,Ct[re]=C.pinned?1:0,Ft[re]=St*Lt,Pt[re]=re,W>oe&&(oe=W),R<Bt&&(Bt=R),U<Gt&&(Gt=U),R>qt&&(qt=R),U>Kt&&(Kt=U)}if(Y.length>1&&(qt-Bt<2*oe||Kt-Gt<2*oe)){const re=(Bt+qt)/2,C=(Gt+Kt)/2;for(let R=0;R<tt;R++)if(!Ct[R]){const U=5*Math.sqrt(R),W=R*ee,St=re+U*Math.cos(W),bt=C+U*Math.sin(W);ft[R]=St,_t[R]=bt,St<Bt&&(Bt=St),bt<Gt&&(Gt=bt),St>qt&&(qt=St),bt>Kt&&(Kt=bt)}}et.updateGroups(),Sn=r((re=>ft[re]),"getX"),gn=r((re=>_t[re]),"getY"),ln=r((re=>it[re]),"getR"),Hs=mt(et),Ls=ct(et,J)}),"initialize");function kt(Y,et,J,{maxDisplacement:tt}){const{X:ft,Y:_t,fx:it,fy:vt,pinned:Ct,layer:Ft,layers:Pt,surfaces:Lt,movements:Yt}=J;Yt.fill(0);let $t=0;const Bt=Y.length;let Gt=1/0,qt=1/0,Kt=-1/0,ee=-1/0;const oe=tt*tt;for(let R=0;R<Bt;R++){const U=Y[R],W=it[U]*=et,St=vt[U]*=et,bt=Ft[U];let It=W,Qt=St;const ie=ft[U],Ee=_t[U];if(It*It+Qt*Qt>oe){const We=Math.sqrt(It*It+Qt*Qt)/tt;Qt/=We,It/=We}Ct[U]||(ft[U]+=It,_t[U]+=Qt);const we=Math.sqrt(It*It+Qt*Qt);Ct[U]||(ie<Gt&&(Gt=ie),Ee<qt&&(qt=Ee),ie>Gt&&(Kt=ie),Ee>qt&&(ee=Ee),Yt[bt-1]+=we),$t+=bt*we}const re=Math.max(Kt-Gt,0),C=Math.max(ee-qt,0);for(let R=0;R<Pt.length;R++){const U=Pt[R],W=U.length;let St=1/0,bt=1/0,It=-1/0,Qt=-1/0,ie=0;for(let ds=0;ds<W;ds++){const ks=U[ds];if(Ct[ks])continue;const gs=ft[ks],Ns=_t[ks];gs<St&&(St=gs),Ns<bt&&(bt=Ns),gs>It&&(It=gs),Ns>Qt&&(Qt=Ns),ie++}const Ee=It-St,we=Qt-bt,We=Math.max(1,Math.sqrt(Ee**2+we**2));Lt[R]=We;const us=ie===0?0:Yt[R]/ie,ms=re*C||1;Yt[R]=us>ie?us/ms:0}return J.updateGroups(),$t}function Tt(Y,et,J){At(Y,et,J),Ut(J)}function At(Y,et,{sources:J,targets:tt,degrees:ft,nodeIds:_t,edgeIds:it}){const vt={};for(let Ct=0;Ct<Y.length;Ct++)vt[Ct]=_t[Ct]=Ct;for(let Ct=0;Ct<et.length;Ct++){const{source:Ft,target:Pt}=et[Ct],Lt=vt[Ft],Yt=vt[Pt];it[Ct]=Ct,J[Ct]=Lt,tt[Ct]=Yt,ft[Lt]++,ft[Yt]++}}function Ut({nodeIds:Y,edgeIds:et,sources:J,targets:tt,degrees:ft,layer:_t,layers:it,component:vt,components:Ct,cluster:Ft,parent:Pt}){let Lt=0,Yt=1;const $t=new Uint32Array(Y.length);for(let oe=0;oe<Y.length;oe++)$t[oe]=ft[oe];const Bt=new Array(Y.length);for(let oe=0;oe<et.length;oe++){const re=et[oe],C=J[re],R=tt[re];Bt[C]=Bt[C]||[],Bt[R]=Bt[R]||[],Bt[C].push(R),Bt[R].push(C)}const Gt=new Uint8Array(Y.length),qt=new Uint8Array(Y.length);Pt.fill(-1);let Kt=0;for(let oe=0;oe<Y.length;oe++)if(Gt[oe]===0){const re=[oe];for(;re.length!==0;){const C=re.pop();if(Gt[C]===0&&Bt[C]!==void 0){const R=Bt[C];for(let U=0;U<R.length;U++)re.push(R[U])}Gt[C]=1,vt[C]=Kt}Kt++}const ee=new Array(Y.length);for(let oe=0;oe<Y.length;oe++)_t[oe]=0,ee[oe]=oe;for(;ee.length!==0;){const oe=[],re=[];for(let C=0;C<ee.length;C++)$t[ee[C]]<=Lt&&(oe.push(C),re.push(ee[C]));for(let C=0;C<re.length;C++){const R=re[C];qt[R]=Lt,_t[R]=Yt;const U=Bt[R];if(U)for(let W=0;W<U.length;W++)$t[U[W]]--}for(let C=0;C<re.length;C++){const R=re[C],U=Bt[R];if(U)for(let W=0;W<U.length;W++){const St=U[W],bt=_t[St];if(bt===void 0||bt>Yt){Pt[R]=St;break}}}oe.reverse();for(let C=0;C<oe.length;C++)ee.splice(oe[C],1);if(Yt+=1,ee.length>0){let C=1/0;for(let R=0;R<ee.length;R++){const U=$t[ee[R]];U<C&&(C=U)}C>=Lt+1&&(Lt=C,Yt=1)}}Gt.fill(0);for(let oe=0;oe<Y.length;oe++){const re=Y[oe],C=_t[re];if(Pt[re]===-1||_t[Pt[re]]===C){const R=[re];for(Gt.fill(0);R.length!==0;){const U=R.pop();if(Gt[U])continue;if(_t[U]>C){Pt[re]=U;break}const W=Bt[U];if(Gt[U]=1,W)for(let St=0;St<W.length;St++)R.push(W[St])}}}for(let oe=0;oe<Y.length;oe++){const re=Y[oe],C=vt[re];Ct[C]=Ct[C]||[],Ct[C].push(re);const R=_t[re]-1;it[R]=it[R]||[],it[R].push(re),Ft[re]=Pt[re]}}dt.initialize=yt,r(kt,"velocityVerlet"),r(Tt,"topology"),r(At,"initTopology"),r(Ut,"decomposition");var he=class{constructor(Y,et=!0,J){this.bucketSize=0,this.cells=[];const tt=Y.nodes.length,ft=Y.edges.length;if(g(tt+ft),this.X=new Array(tt),this.Y=new Array(tt),this.R=new Array(tt),this.fx=new Float32Array(tt),this.fy=new Float32Array(tt),this.vx=new Float32Array(tt),this.vy=new Float32Array(tt),this.pinned=new Uint8Array(tt),this.masses=new Float32Array(tt),this.weights=new Float32Array(ft),this.lengths=new Float32Array(ft),this.sources=new Uint32Array(ft),this.targets=new Uint32Array(ft),this.degrees=new Uint32Array(tt),this.layer=new Uint32Array(tt),this.parent=new Int32Array(tt),this.cluster=new Int32Array(tt),this.component=new Uint32Array(tt),this.components=[],this.layers=[],this.nodeIds=new Array(tt),this.edgeIds=new Array(ft),this.groups=J&&J.groups||[],this.maxR=new Float32Array(Math.max(this.groups.length,1)),this.cellSize=0,this.cells=[],this.hasGroups=this.groups.length>0,this.hasGroups){this.nodeToGroup=new Int32Array(tt);for(let _t=0;_t<this.groups.length;_t++){const it=this.groups[_t];this.cells[_t]={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,ox:0,oy:0,cx:0,cy:0},this.maxR[_t]=0;for(let vt=0;vt<it.length;vt++){const Ct=it[vt];this.nodeToGroup[Ct]=_t,this.maxR[_t]=Math.max(this.maxR[_t],Y.nodes[Ct].r)}}}et&&Tt(Y.nodes,Y.edges,this),this.movements=new Array(this.layers.length).fill(0),this.surfaces=new Array(this.layers.length).fill(0),this.movementsPrev=new Array(this.layers.length).fill(0),this.surfacesPrev=new Array(this.layers.length).fill(0)}updateGroups(){if(!this.hasGroups)return void(this.cellSize=1/0);const Y=this.X,et=this.Y,J=this.groups,tt=this.cells,ft=this.maxR;let _t=0;J.forEach(((Ft,Pt)=>{const Lt=tt[Pt];Lt.minX=1/0,Lt.minY=1/0,Lt.maxX=-1/0,Lt.maxY=-1/0,Ft.forEach((Gt=>{const qt=Y[Gt],Kt=et[Gt];Lt.minX=Math.min(qt,Lt.minX),Lt.minY=Math.min(Kt,Lt.minY),Lt.maxX=Math.max(qt,Lt.maxX),Lt.maxY=Math.max(Kt,Lt.maxY)}));const Yt=ft[Pt];Lt.minX-=Yt,Lt.minY-=Yt,Lt.maxX+=Yt,Lt.maxY+=Yt;const $t=Math.abs(Lt.maxX-Lt.minX),Bt=Math.abs(Lt.maxY-Lt.minY);_t=Math.max(_t,$t,Bt),Lt.cx=(Lt.maxX+Lt.minX)/2,Lt.cy=(Lt.maxY+Lt.minY)/2})),_t=Math.ceil(2*_t+1),this.cellSize=_t;const it=Math.ceil(Math.sqrt(J.length)),vt=it*_t/2,Ct=_t/2;for(let Ft=0;Ft<J.length;Ft++){const Pt=J[Ft],Lt=Ft%it,Yt=Math.floor(Ft/it),$t=tt[Ft],Bt=(Lt+.5)*_t-vt,Gt=(Yt+.5)*_t-vt,qt=Bt-$t.cx,Kt=Gt-$t.cy;$t.cx=Bt,$t.cy=Gt,$t.minX=Bt-Ct,$t.minY=Gt-Ct,$t.maxX=Bt+Ct,$t.maxY=Gt+Ct;for(const ee of Pt)Y[ee]+=qt,et[ee]+=Kt}}};function xe(Y,et){return Y<et?Y*et+Math.pow(et-Y-1,2)/4:Y*et+Math.pow(Y-et-1,2)/4}function be(Y,et){return(Y+et)*(Y+et+1)/2+et}function ue({edgeIds:Y,sources:et,targets:J,pinned:tt,degrees:ft,X:_t,Y:it,R:vt},Ct=0,Ft=.5){const Pt={},Lt={};for(const Yt of Y){const $t=et[Yt],Bt=J[Yt];$t!==Bt&&(Pt[$t]=Pt[$t]||{},Pt[Bt]=Pt[Bt]||{},Pt[$t][Bt]=!0,Pt[Bt][$t]=!0)}Object.keys(Pt).forEach((Yt=>{const $t=Number(Yt),Bt=Object.keys(Pt[Number($t)]);if(Bt.length===2){const[Gt,qt]=Bt,Kt=xe(Number(Gt),Number(qt));Kt in Lt||(Lt[Kt]=[Number(qt),Number(Gt)]),tt[$t]||Lt[Kt].push($t)}})),Object.keys(Lt).forEach((Yt=>{const[$t,Bt,...Gt]=Lt[Number(Yt)];if(Gt.length<3)return;const qt=_t[$t],Kt=it[$t],ee=_t[Bt],oe=it[Bt],re=ft[$t],C=.25+.5*re/(re+ft[Bt]);let R=qt+(ee-qt)*C,U=Kt+(oe-Kt)*C,W=-(oe-Kt),St=ee-qt;const bt=Math.sqrt(Math.pow(qt-ee,2)+Math.pow(Kt-oe,2));W=-2*W/bt,St=-2*St/bt;const It=Math.acos(W/Math.sqrt(W*W+St*St));Ct>0&&(It<Ct||It>Math.PI-Ct&&It<=Math.PI?(W=2*Math.cos(Math.PI-Ct),St=2*Math.sin(Math.PI-Ct)):(It>2*Math.PI-Ct||It>=Math.PI&&It<Math.PI+Ct)&&(W=2*Math.cos(Ct),St=2*Math.sin(Ct)));let Qt=0,ie=1;Gt.sort(((ms,ds)=>vt[ds]-vt[ms]));let Ee=0,we=0;const We=Math.max(vt[Gt[0]],vt[Gt[1]])/2;Gt.length%2==1&&(Qt=1,R-=W*We,U-=St*We);const us=1+Ft;for(let ms=0;ms<Gt.length;ms++){const ds=(Qt+ms)%2,ks=Gt[ms],gs=ms>=2?vt[ks]:We,Ns=(ds?Ee:we)+gs;_t[ks]=R+W*ie*Ns,it[ks]=U+St*ie*Ns,ds?Ee+=gs*us:we+=gs*us,ie=-ie}}))}function _e(Y){let et=0,J=0;for(const it of Y)et+=it.w*it.h,J=Math.max(J,it.w);Y.sort(((it,vt)=>vt.h-it.h));const tt=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(et/.95)),J),h:1/0}];let ft=0,_t=0;for(const it of Y)for(let vt=tt.length-1;vt>=0;vt--){const Ct=tt[vt];if(!(it.w>Ct.w||it.h>Ct.h)){if(it.x=Ct.x,it.y=Ct.y,_t=Math.max(_t,it.y+it.h),ft=Math.max(ft,it.x+it.w),it.w===Ct.w&&it.h===Ct.h){const Ft=tt.pop();vt<tt.length&&(tt[vt]=Ft)}else it.h===Ct.h?(Ct.x+=it.w,Ct.w-=it.w):it.w===Ct.w?(Ct.y+=it.h,Ct.h-=it.h):(tt.push({x:Ct.x+it.w,y:Ct.y,w:Ct.w-it.w,h:it.h}),Ct.y+=it.h,Ct.h-=it.h);break}}}function Te(Y,et=1){return _e(Y.map((J=>(J.w+=J.maxr+et,J.h+=J.maxr+et,J))).sort(((J,tt)=>J.w*J.h-tt.w*tt.h)))}r(he,"LayoutData"),r(xe,"unorderedPair"),r(be,"orderedPair"),r(ue,"alignSiblings"),r(_e,"potpack"),r(Te,"boxpack");var Ve=class{constructor(){this.ids=[],this.xmin=1/0,this.ymin=1/0,this.xmax=-1/0,this.ymax=-1/0,this.x=0,this.y=0,this.w=0,this.h=0,this.cx=0,this.cy=0,this.radius=0,this.mx=0,this.my=0,this.m=0,this.maxr=0}add(Y,et,J,tt){this.ids.push(Y),et-tt<this.xmin&&(this.xmin=et-tt),J-tt<this.ymin&&(this.ymin=J-tt),et+tt>this.xmax&&(this.xmax=et+tt),J+tt>this.ymax&&(this.ymax=J+tt),tt>this.maxr&&(this.maxr=tt),this.mx+=tt*et,this.my+=tt*J,this.m+=tt}measure(Y=0){return this.w=this.xmax-this.xmin+2*Y,this.h=this.ymax-this.ymin+2*Y,this.cx=this.mx/this.m,this.cy=this.my/this.m,this.x=this.xmin,this.y=this.ymin,this.radius=Math.sqrt(this.w*this.w+this.h*this.h)/2,this}};function Ie(Y,et=20,J,tt,ft){for(const Bt of Y){const{x:Gt,y:qt,r:Kt}=ne(Bt.ids,(ee=>J[ee]),(ee=>tt[ee]),(ee=>ft[ee]));Bt.cx=Gt,Bt.cy=qt,Bt.radius=Kt+et}const _t=Y.slice().sort(((Bt,Gt)=>Bt.radius-Gt.radius)),it=_t.map((Bt=>({x:Bt.cx,y:Bt.cy,r:Bt.radius}))),vt=_t.pop();let Ct=3*Math.PI/2,Ft=vt.radius;const Pt=2*Math.PI,{cx:Lt,cy:Yt}=vt,$t=[vt];for(;_t.length!==0;){const Bt=_t[_t.length-1],Gt=Ft+Bt.radius,qt=Lt+Math.cos(Ct)*Gt,Kt=Yt+Math.sin(Ct)*Gt;$t.some((ee=>{const oe=ee.cx-qt,re=ee.cy-Kt;return Math.sqrt(oe*oe+re*re)<ee.radius+Bt.radius}))?Ft+=1:(Bt.x=qt-Bt.w/2,Bt.y=Kt-Bt.h/2,Bt.cx=qt,Bt.cy=Kt,it[_t.length-1].x=qt,it[_t.length-1].y=Kt,$t.push(_t.pop()),Ct+=(2*Bt.radius+1)/Gt*1%Pt)}}function je(Y,et,J,tt){let ft=0;const _t=[];for(const it of tt){const vt=new Ve;for(const Ct of it)vt.add(Ct,Y[Ct],et[Ct],J[Ct]);_t.push(vt.measure()),it.length>_t[ft].ids.length&&(ft=_t.length-1)}return{boxes:_t,biggest:ft}}function Pe(Y,et,{X:J,Y:tt,R:ft,components:_t,pinned:it,degrees:vt,sources:Ct,targets:Ft,edgeIds:Pt},{update:Lt,onUpdate:Yt,placement:$t,placementOffset:Bt,alignSiblings:Gt,siblingsMinAngle:qt,siblingsOffset:Kt}){if(Gt&&(ue({X:J,Y:tt,R:ft,degrees:vt,pinned:it,sources:Ct,targets:Ft,edgeIds:Pt},qt,Kt),Lt(Y,J,tt)),$t){const{boxes:ee,biggest:oe}=je(J,tt,ft,_t);if($t==="spiral")Ie(ee,Bt,J,tt,ft);else{if($t!=="box")return;Te(ee,Bt)}const re=ee[oe].xmin-ee[oe].x,C=ee[oe].ymin-ee[oe].y;for(const R of ee){const{xmin:U,ymin:W,x:St,y:bt,ids:It}=R,Qt=U-St-re,ie=W-bt-C;for(const Ee of It)J[Ee]-=Qt,tt[Ee]-=ie}Lt(Y,J,tt),Yt()}}function Be(Y,et,{X:J,Y:tt,R:ft,degrees:_t,nodeIds:it,edgeIds:vt,layers:Ct,layer:Ft,cluster:Pt,masses:Lt,weights:Yt,sources:$t,targets:Bt},{cx:Gt,cy:qt,nextTick:Kt,cancelTick:ee,update:oe,onUpdate:re,batch:C,maxIterations:R,steps:U,minMovement:W},St,bt){const It=Ct.slice();C=C??1;let Qt,ie=0;function Ee(){ee(Qt),oe(Y,J,tt),re(),bt(ie)}r(Ee,"stop");const we={};for(let Ss=0;Ss<et.length;Ss++)we[Number(et[Ss].id)||Ss]=Ss;const We=new Map;for(let Ss=0;Ss<vt.length;Ss++){const zs=vt[Ss];We.set(be($t[zs],Bt[zs]),zs)}for(let Ss=0;Ss<Ct.length;Ss++){const zs=Ct[Ss],yn=Ss;for(let tn=0;tn<zs.length;tn++){const Zs=zs[tn],Ds=Pt[Zs];Ds!==-1&&(Lt[Ds]+=Lt[Zs])}for(let tn=0;tn<et.length;tn++){const Zs=et[tn],Ds=Number(Zs.id)||tn,An=Zs.source,Wi=Zs.target,kn=Yt[we[Ds]];if(Ft[An]===yn&&Ft[Wi]===yn){const Xi=Pt[An],gr=Pt[Wi];if(Xi!==gr){const vs=We.get(be(Xi,gr));vs!==void 0&&(Yt[vs]+=kn)}}}}it.length=0,vt.length=0;let us=1;const ms=1-Math.pow(.1,1/U/2),ds=(us-.1)/U;let ks,gs,Ns=.5;function fn(){us+=(0-us)*ms;const Ss=St(us,it,vt);let zs=us<=Ns||Ss<W;if(ie===0||zs){const yn=It.pop();if(yn){ks&&(gs=ks.reduce(((Zs,Ds)=>Math.max(Zs,Gt-J[Ds],qt-tt[Ds])),0)),it.push.apply(it,yn);for(let Zs=0;Zs<yn.length;Zs++){const Ds=yn[Zs],An=Pt[Ds];if(An!==-1){const Wi=_t[Ds]>1?2:1,kn=ft[An]+ft[Ds];Lt[An]-=Lt[Ds],J[Ds]=J[An]+Wi*kn*(2*h()-1),tt[Ds]=tt[An]+Wi*kn*(2*h()-1)}else ks&&(J[Ds]=Gt+2*gs*(1-2*h()),tt[Ds]=qt+2*gs*(1-2*h()))}ks=yn;const tn=it.reduce(((Zs,Ds)=>(Zs[Ds]=!0,Zs)),{});vt.length=0;for(let Zs=0;Zs<et.length;Zs++){const{source:Ds,target:An,id:Wi}=et[Zs];tn[Ds]&&tn[An]&&vt.push(we[Number(Wi)])}zs=!1,It.length===0?(us=.2,Ns=.1):(us=.1+2*ds,Ns=.1)}}ie%C==0&&(oe(Y,J,tt),re()),++ie>=1/0||zs?Ee():Qt=Kt(fn)}return r(fn,"simulationStep"),{done:!1,start(){return Qt=setTimeout(fn),this},stop(){return Ee(),this},get iterations(){return ie}}}r(Ve,"Component"),r(Ie,"spiralpack"),r(je,"groupAndMeasure"),r(Pe,"postprocessing"),r(Be,"multiLevel");var Ue,es=class{constructor(Y){this.promise=new Promise(Y)}then(Y){return this.promise.then(Y)}stop(){return this.simulation.stop(),this}get iterations(){return this.simulation.iterations()}};function os(Y,et,{X:J,Y:tt,nodeIds:ft,edgeIds:_t,layers:it,movements:vt,movementsPrev:Ct,surfaces:Ft,surfacesPrev:Pt},Lt,Yt,$t){const{nextTick:Bt,cancelTick:Gt,steps:qt,minMovement:Kt,update:ee,onUpdate:oe,autoStop:re}=Lt,C=Lt.batch??1;let R=0,U=1,W,St=1-Math.pow(.05,1/qt),bt=!1;const It=r((()=>{bt=!0,Gt(W),oe(),$t(R)}),"stop");let Qt=!1;const ie=r((()=>{U+=(.001-U)*St;const Ee=Yt(U,ft,_t),we=it.length;let We=!1,us=!1;if(re){We=us=!0;const{movementRatio:ds,surfaceRatio:ks}=re;for(let gs=0;gs<we;gs++)We&&Math.abs(1-Ft[gs]/Pt[gs])>ks&&(We=!1),us&&Math.abs(vt[gs]-Ct[gs])>ds&&(us=!1)}We&&us&&!Qt&&(St=1-Math.pow(.001,1/Math.max(10,R)),Qt=!0);const ms=bt||U<.05||Ee!==0&&Ee<=Kt;if(R%C==0&&(ee(Y,J,tt),oe()),++R>=qt||ms)return It();for(let ds=0;ds<we;ds++)Ct[ds]=vt[ds],Pt[ds]=Ft[ds];W=Bt(ie)}),"simulationStep");return{done:!1,start(){return W=setTimeout(ie),this},stop(){return It(),this},get iterations(){return R}}}function cs(Y,et={}){let J,tt;const ft=r(((Yt={nodes:[],edges:[]})=>(J=Yt.nodes,tt=Yt.edges,g(be(J.length,tt.length)),new he(Yt,!0,et))),"setGraph"),_t=r(((Yt={})=>new X(Yt)),"setOptions");let it=ft(Y),vt=_t(et);y(tt,it),yt(J,it,vt),He(J,it,vt),x(J,it,vt);const Ct=kt;let Ft=null;const Pt=r(((Yt,$t,Bt)=>(Ft&&(Ft.destroy(),Ft=null),$t.length<=1?0:(vt.barnesHutOptimization?Ft=dt(Yt,$t,Ft,it):Je(Yt,$t,it,vt),p(Yt,Bt,it,vt),Ft&&vt.elasticity!==0&&is(0,$t,Ft,it,vt),_(Yt,$t,it,vt),Ct($t,vt.inertia,it,vt)))),"step");let Lt;return{setOptions:(Yt={})=>(vt=_t(Yt),this),setGraph:({nodes:Yt,edges:$t})=>(it=ft(Y),y($t,it),yt(Yt,it,vt),He(Yt,it,vt),x(Yt,it,vt),this),start(){return Lt=(vt.multilevel?Be:os)(J,tt,it,vt,Pt,(Yt=>{Lt.done||Pe(J,0,it,vt),vt.onEnd(Yt);const $t=et.groups;if($t)for(let Bt=0;Bt<$t.length;Bt++){const Gt=$t[Bt],qt=Gt.reduce(((Kt,ee)=>(Kt.x+=it.X[ee],Kt.y+=it.Y[ee],Kt)),{x:0,y:0});qt.x/=Gt.length,qt.y/=Gt.length,et.cx&&(qt.x-=et.cx),et.cy&&(qt.y-=et.cy);for(let Kt=0;Kt<Gt.length;Kt++)it.X[Gt[Kt]]-=qt.x,it.Y[Gt[Kt]]-=qt.y}Lt.done=!0})).start(),this},iterations:()=>Lt.iterations,data:()=>it,stop(){return Lt&&Lt.stop(),this},step(Yt=1){return Pt(Yt,it.nodeIds,it.edgeIds),vt.update(J,it.X,it.Y),this}}}return r(es,"SimulationPromise"),r(os,"singleLevel"),r(cs,"force"),cs.run=(Y,et)=>{let J;const tt=new es((ft=>{et.onEnd=ft,J=cs(Y,et).start()}));return tt.simulation=J,tt.stop=()=>(J.stop(),tt),tt},Ue=o,((Y,et,J,tt)=>{if(et&&typeof et=="object"||typeof et=="function")for(let ft of n(et))i.call(Y,ft)||ft===J||e(Y,ft,{get:()=>et[ft],enumerable:!(tt=s(et,ft))||tt.enumerable});return Y})(e({},"__esModule",{value:!0}),Ue)})();return t.force.apply(this,arguments)}Se(FA,"SimulationPromise"),Se(Yg,"gpuLayout"),Yg.run=(t,e,s)=>{let n;const i=new FA((r=>{s.onEnd=r,n=Yg(t,e,s).start()}));return i.simulation=n,i.stop=()=>(n.stop(),i),i};var QH=2,JH=1.25,zA=t=>{},DA={name:"force",imports:{force:PA},configure(t,{graph:e,events:s}){const n=t.nodes._indexes,i=t.xs?t.xs:e.getNodeAttribute("x").getMultiple(n),r=t.ys?t.ys:e.getNodeAttribute("y").getMultiple(n),o=t.rs?t.rs:e.getNodeAttribute("radius").getMultiple(n),a=e.getNodeAttribute("layoutable").getMultiple(n),l=t.edges,u=[],h=[],g={},f=t.edgeWeight||zA,p=t.nodeMass?x=>t.nodeMass(t.nodes.get(x)):zA;t.edgeStrength===void 0&&(t.edgeStrength=.5),t.gpu&&(t.edgeStrength/=QH),t.gravity==null&&(t.gravity=.01),t.siblingsOffset==null&&(t.siblingsOffset=0),t.theta==null&&(t.theta=.62),t.autoStop=!!t.autoStop,t.alignSiblings=!!t.alignSiblings;const y=t.radiusRatio||JH;for(let x=0;x<t.nodes._indexes.length;x++){const v=t.nodes._indexes[x];g[v]=x,u.push({id:x,x:i[x],y:r[x],r:o[x]*y,mass:p(x),pinned:!a[x]})}l.forEach((x=>{const v=g[x.getSource()._index],b=g[x.getTarget()._index];v!==b&&v!==void 0&&b!==void 0&&h.push({source:v,target:b,weight:f(x)})}));const _=Uf({...t});return delete _.nodes,delete _.edges,{graph:{nodes:u,edges:h},options:_,indexes:t.nodes._indexes,done:!1,x:i,y:r,chunkPeriod:250}},update:function(t,e){if(!e.simulation&&t){let s;e.done=!1,e.graph=t.graph,e.options=t.options,e.indexes=t.indexes;let n=!1;if(t.options.gpu){const l=yC("webgl2",{},(()=>{$o("GPU layout: WebGL context not available. Falling back on CPU."),e.simulation=void 0,e.options.gpu=!1,e.cleanUp&&e.cleanUp(),this._update(t,e)}));l&&(s=l.context,e.cleanUp=l.cleanUp),n=!!s}let i=Date.now();n||(t.options.nextTick=l=>Date.now()-i<=e.chunkPeriod?l():(i=Date.now(),setTimeout(l,0))),t.options.update=(l,u,h)=>{e.x=u,e.y=h},t.options.onEnd=()=>{if(n&&s){const{X:l,Y:u}=e.simulation.data(!0);e.x=l,e.y=u}e.done=!0,e.simulation=void 0,e.cleanUp&&e.cleanUp()},t.options.bucketSize=0;const r=n&&s?Yg(t.graph,s,t.options).start():PA(t.graph,t.options).start();e.simulation=r;const{X:o,Y:a}=n&&s?{X:new Float32Array(t.graph.nodes.length),Y:new Float32Array(t.graph.nodes.length)}:r.data();e.x=o,e.y=a}return{graph:e.graph,indexes:e.indexes,x:e.x,y:e.y}},context:function(){return{done:!1,graph:{nodes:[],edges:[]},x:null,y:null,indexes:null,chunkPeriod:250}},stop:function(t){t.done=!0,t.simulation&&(t.simulation.stop(),delete t.simulation)},isRunning:function(t){return!t.done||(t.done=!1,!1)},onSync:function({indexes:t,x:e,y:s}){return{indexes:t,x:e,y:s}}};function t$(t,e,s,n,i){return{x:t+i*(s-t),y:e+i*(n-e)}}var e$=10;function s$(t,e,s){let n,i,r=1/0;for(let o=0,a=e.length;o<a;o++){const l=e[o],u=e[(o+1)%a],h=f0(t[0],t[1],l[0],l[1],u[0],u[1]);h<r&&(r=h,n=l,i=u)}return n$(t[0],t[1],n[0],n[1],i[0],i[1],s)}function n$(t,e,s,n,i,r,o){const a=MC(t,e,s,n,i,r);let l=-(n-r),u=s-i;const h=Math.sqrt(l*l+u*u);return l/=h,u/=h,[a.x-o*l,a.y-o*u]}function i$(t,e,s,n){for(let i=0;i<t.length;i++){const[r,o]=t[i],a=Math.abs(r-e),l=Math.abs(o-s);if(a+l<=n||!(a>n||l>n)&&a*a+l*l<=n*n)return!0}return!1}function r$(t,e,s){const n=kC(s.cx,s.cy,t,e,s.minX,s.minY,s.maxX,s.maxY);let i,r=1/0,o={x:s.maxX,y:e};for(const a of n)i=_n(t,e,a.x,a.y),i<r&&(r=i,o=a);return o}function o$(t){const e=t.bottomLeft(),s=t.topRight();return[[e.x,e.y],[e.x,s.y],[s.x,s.y],[s.x,e.y]]}function a$(t,e,s,n){const i=[],r=[],o=[];return t.forEach(((a,l)=>{n[l]&&(i.push(a),r.push(e[l]),o.push(s[l]))})),{ids:i,subgraphPositions:r,radii:o}}function l$(t,e,s){const{duration:n=0,margin:i=5,referenceNodes:r,nodes:o}=e,{ids:a,subgraphPositions:l,radii:u}=a$(o.getId(),s,o.getAttribute("radius"),o.getAttribute("layoutable")),h=t.getNodes(a);let g=r;!g||g instanceof lo||(g=t.getNodes(g));const f=g||h.inverse(),p=f.getPosition().map((F=>[F.x,F.y])),y=h.getBoundingBox(),_=f.getBoundingBox();_.pad(_.maxScaledSize);const x={layoutName:"incremental",ids:h.getId(),positions:{before:l,current:l}};if(!h.size)return Promise.resolve(x);const v=Eh(l.map((F=>F.x)),l.map((F=>F.y)),u),[b,S]=v,A=v[2]+_.maxScaledSize+i;let w,L=0,I=0;if(i$(p,b,S,A))if(f.size<=3){if(Wx(b,S,v[2],_.minX,_.minY,_.maxX,_.maxY)){const F=r$(b,S,_);w=_n(_.cx,_.cy,F.x,F.y);const O=t$(_.cx,_.cy,F.x,F.y,(w+A)/w);L=O.x-b,I=O.y-S}}else{const F=Hx.from(p,(at=>at[0]),(at=>at[1])),O=qd(F.triangles,p),V=p.length>3?qd(F.hull,p):o$(_),j=b2(f.getPosition(),e$,A,O,V);let Z=s$([b,S],V,A);if(j.length>0){let at=Math.pow(b-Z[0],2)+Math.pow(S-Z[1],2);for(const pt of j)L=b-pt[0],I=S-pt[1],w=L*L+I*I,w<at&&(at=w,Z=pt.slice(0,2));L=Z[0]-b,I=Z[1]-S}else L=Z[0]-y.cx,I=Z[1]-y.cy}if(L||I){const F=l.map((O=>(O.x+=L,O.y+=I,O)));if(e.locate){typeof e.locate=="boolean"&&(e.locate={});const O=t.modules.locate.layoutDataBoundingBox({x:[...p.map((j=>j[0])),...F.map((j=>j.x))],y:[...p.map((j=>j[1])),...F.map((j=>j.y))],indexes:t.getNodes()._indexes}),V=t.modules.locate.computeConfigForBounds(O,e.locate);t.modules.camera.setView(V,{duration:n,easing:e.locate.easing,ignoreZoomLimits:!0})}return x.positions.current=F,h.setAttributes(F,n).then((()=>x))}return h.setAttributes(l,n).then((()=>x))}function u$(t,e,s){const n=Xs(e);return n.duration=0,n.dryRun=!0,n.locate=!1,delete n.incremental,s(n).then((i=>l$(t,e,i.positions.current)))}function d$(t,e,s){const{nodes:n,duration:i,centralNode:r}=e,o=n,a=o.reduce(((u,h)=>(u[h._index]=!0,u)),{}),l=t.getNodes();if(e.focusOnGroupShape)return s({nodes:o,duration:0}).then((()=>{const u=o.concat(r),h=u.getAttribute("layoutable");return u.setAttributes({layoutable:!1}),s({nodes:t.getNodes(),duration:i}).then((()=>u.setAttributes(h)))}));{const u=Xs(e);return delete u.centralNode,u.incremental=!1,u.nodes=l,u.nodeMass=(h,g)=>(g+1)*(a[h._index]?1:2),s(u)}}function MN(t,e,s){const n=Yk(e.modules.graph,t);if(typeof n.incremental!="boolean"&&"margin"in n.incremental&&!isFinite(n.incremental.margin))throw new Error("Incremental layout: margin has to be a positive number");const i=Xs(n);return typeof n.incremental!="boolean"&&(i.margin=n.incremental.margin,i.referenceNodes=n.incremental.referenceNodes),i.centralNode&&!i.centralNode.getAttribute("layoutable")?d$(e,i,s):u$(e,i,s)}var h$=t=>(t.modules.layouts.register(DA),(e={})=>{if(e.incremental)return MN(e,t,t.layouts.force);if(e.edgeStrength!==void 0&&(!isFinite(e.edgeStrength)||e.edgeStrength<0))throw new Error("force layout: edgeStrength must be a positive number");if(e.steps!==void 0&&(!isFinite(e.steps)||e.steps<=0))throw new Error("force layout: 'steps' must be a positive integer");if(e.edgeLength!==void 0&&(!isFinite(e.edgeLength)||e.edgeLength<=0))throw new Error("force layout: 'edgeLength' must be positive");if(e.gravity!==void 0&&(!isFinite(e.gravity)||e.gravity<0||e.gravity>=1))throw new Error("force layout: 'gravity' must be between 0 and 1");if(e.charge!==void 0&&!isFinite(e.charge))throw new Error("force layout: 'charge' must be a number");if(e.radiusRatio!==void 0&&(!isFinite(e.radiusRatio)||e.radiusRatio<0))throw new Error("force layout: 'radiusRatio' must be a positive number");if(e.theta!==void 0&&(!isFinite(e.theta)||e.theta<0||e.theta>1))throw new Error("force layout: 'theta' must be between 0 and 1");if(!(e.cx===void 0&&e.cy===void 0||typeof e.cx=="number"&&typeof e.cy=="number"))throw new Error("force layout: both 'cx' and 'cy' must be numbers");if(e.siblingsOffset!==void 0&&!isFinite(e.siblingsOffset))throw new Error("force layout: 'siblingsOffset' must be a number");return e.gpu=!!e.gpu,e.gpu&&(e.useWebWorker=!1),t.modules.layouts.start(DA.name,e)}),OA={name:"forceLink",configure:function(t,{graph:e,camera:s,graphics:n}){const i=t.nodes._indexes,r=t.edges._indexes,o={},a={},l=i.length,u=r.length;let h;var g=e.getObjectList(!0),f=e.getObjectList(!1);(t.nodes||t.edges)&&(delete(t=Xs(t)).nodes,delete t.edges);const p=e.getNodeAttribute("innerStroke.width").getMultiple(i),y=e.getNodeAttribute("outerStroke.width").getMultiple(i),_=e.degrees(i),x=t.xs?t.xs:e.getNodeAttribute("x").getMultiple(i),v=t.ys?t.ys:e.getNodeAttribute("y").getMultiple(i),b=t.rs?t.rs:e.getNodeAttribute("radius").getMultiple(i),S=e.nodeList(i).getAttribute("layoutable"),A=typeof t.nodeMass=="function"?t.nodeMass:function(K,ut,ht){return ut+1};delete t.nodeMass;const w=typeof t.edgeWeight=="function"?t.edgeWeight:function(K){return 1};delete t.edgeWeight,isFinite(t.scalingRatio)||delete t.scalingRatio;const L=i.reduce(((K,ut,ht)=>(S[ht]||(K[ut]=!0),K)),{});let I=0,F=0,O=0;const V=s.getZoom();for(h=0;h<i.length;++h){const K=i[h],ut=x[h],ht=v[h],nt=b[h]+(p[h]+y[h])/V;o[K]={id:K,x:ut,y:ht,degree:_[h],size:nt,pinned:!!L[K],mass:A(g.get(K),_[h],h)},O=Math.max(nt,O)}if(l>1)for(h=0;h<l;h++){const K=o[i[h]];I+=K.x,F+=K.y}I/=l,F/=l;const j={x:I,y:F},Z=e.edgeList(r),at=Z.getSource()._indexes,pt=Z.getTarget()._indexes;for(h=0;h<u;h++){const K=r[h],ut=at[h],ht=pt[h];o[ut]&&o[ht]&&(a[K]={source:ut,target:ht},a[K].weight=w(f.get(K)))}return{nodes:o,edges:a,maxSize:O,config:Uf(t),barycentre:j}},context:function(){return{chunkPeriod:250}},update:function(t,e){let s;!e.W&&t?(s={ppn:10,ppe:3,ppr:9,MAX_SUBDIVISION_RETRIES:3,maxForce:10,iterations:0,converged:!1,settings:{linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:0,scalingRatio:100,strongGravityMode:!0,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5,startingIterations:10,iterationsPerRender:10,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:!0,alignNodeSiblings:!0,nodeSiblingsScale:5,nodeSiblingsAngleMin:0}},e.W=s,(function(u,h){const g=(function(p,y){let _,x,v,b=p.nodes,S=p.edges,A=p.maxSize,w=Object.keys(p.nodes),L=Object.keys(p.edges),I=w.length*s.ppn,F=L.length*s.ppe,O={};const V=Math.pow(10,Math.log(Math.max(A,1))-6),j=V/2,Z=Math.random,at=y.randomizeFactor||1;let pt;pt=y.randomize==="locally"?ht=>ht+Z()*at:y.randomize==="globally"?ht=>Z()*at:ht=>ht+Z()*V-j;const K=new Float32Array(I),ut=new Float32Array(F);for(_=x=0,v=w.length;_<v;_++){const ht=w[_],nt=b[ht];let ot=nt.x,Nt=nt.y;nt.pinned||(ot=pt(ot),Nt=pt(Nt)),O[ht]=x,K[x]=ot,K[x+1]=Nt,K[x+2]=0,K[x+3]=0,K[x+4]=0,K[x+5]=0,K[x+6]=nt.mass,K[x+7]=1,K[x+8]=nt.size,K[x+9]=nt.pinned||0,x+=s.ppn}for(_=x=0,v=L.length;_<v;_++){const ht=S[L[_]];ut[x]=O[ht.source],ut[x+1]=O[ht.target],ut[x+2]=ht.weight||0,x+=s.ppe}return{nodes:K,edges:ut}})(u,h);e.NodeMatrix=g.nodes,e.EdgeMatrix=g.edges,s.nodesLength=e.NodeMatrix.length,s.edgesLength=e.EdgeMatrix.length})(t,t.config),s.settings=(function(u,h){for(const g in u)h[g]=u[g];return h})(t.config,s.settings),e.nodes=t.nodes,e.edges=t.edges,e.barycentre=t.barycentre):s=e.W;let n,i=e.NodeMatrix,r=e.EdgeMatrix;function o(){let l,u,h,g,f,p,y,_,x,v,b,S,A,w,L,I,F;for(h=0;h<s.nodesLength;h+=s.ppn)i[h+4]=i[h+2],i[h+5]=i[h+3],i[h+2]=0,i[h+3]=0;if(s.settings.outboundAttractionDistribution){for(x=0,h=0;h<s.nodesLength;h+=s.ppn)x+=i[h+6];x/=s.nodesLength}if(s.settings.barnesHutOptimize){let pt,K,ut,ht,nt=1/0,ot=-1/0,Nt=1/0,Q=-1/0;for(n=[],h=0;h<s.nodesLength;h+=s.ppn)nt=Math.min(nt,i[h+0]),ot=Math.max(ot,i[h+0]),Nt=Math.min(Nt,i[h+1]),Q=Math.max(Q,i[h+1]);const Et=ot-nt,Xt=Q-Nt;for(Et>Xt?(Nt-=(Et-Xt)/2,Q=Nt+Et):(nt-=(Xt-Et)/2,ot=nt+Xt),n[0]=-1,n[1]=(nt+ot)/2,n[2]=(Nt+Q)/2,n[3]=Math.max(ot-nt,Q-Nt),n[4]=-1,n[5]=-1,n[6]=0,n[7]=0,n[8]=0,l=1,h=0;h<s.nodesLength;h+=s.ppn)for(u=0,ut=s.MAX_SUBDIVISION_RETRIES;;){if(!(n[u+5]>=0)){if(n[u+0]<0){n[u+0]=h;break}if(n[u+5]=l*s.ppr,y=n[u+3]/2,_=n[u+5],n[_+0]=-1,n[_+1]=n[u+1]-y,n[_+2]=n[u+2]-y,n[_+3]=y,n[_+4]=_+s.ppr,n[_+5]=-1,n[_+6]=0,n[_+7]=0,n[_+8]=0,_+=s.ppr,n[_+0]=-1,n[_+1]=n[u+1]-y,n[_+2]=n[u+2]+y,n[_+3]=y,n[_+4]=_+s.ppr,n[_+5]=-1,n[_+6]=0,n[_+7]=0,n[_+8]=0,_+=s.ppr,n[_+0]=-1,n[_+1]=n[u+1]+y,n[_+2]=n[u+2]-y,n[_+3]=y,n[_+4]=_+s.ppr,n[_+5]=-1,n[_+6]=0,n[_+7]=0,n[_+8]=0,_+=s.ppr,n[_+0]=-1,n[_+1]=n[u+1]+y,n[_+2]=n[u+2]+y,n[_+3]=y,n[_+4]=n[u+4],n[_+5]=-1,n[_+6]=0,n[_+7]=0,n[_+8]=0,l+=4,ht=u+0,pt=i[n[ht]+0]<n[u+1]?i[n[ht]+1]<n[u+2]?n[u+5]:n[u+5]+s.ppr:i[n[ht]+1]<n[u+2]?n[u+5]+2*s.ppr:n[u+5]+3*s.ppr,n[u+6]=i[n[ht]+6],n[u+7]=i[n[ht]+0],n[u+8]=i[n[ht]+1],n[pt+0]=n[u+0],n[u+0]=-1,K=i[h+0]<n[u+1]?i[h+1]<n[u+2]?n[u+5]:n[u+5]+s.ppr:i[h+1]<n[u+2]?n[u+5]+2*s.ppr:n[u+5]+3*s.ppr,pt===K){if(ut--){u=pt;continue}ut=s.MAX_SUBDIVISION_RETRIES;break}n[K+0]=h;break}pt=i[h+0]<n[u+1]?i[h+1]<n[u+2]?n[u+5]:n[u+5]+s.ppr:i[h+1]<n[u+2]?n[u+5]+2*s.ppr:n[u+5]+3*s.ppr,n[u+7]=(n[u+7]*n[u+6]+i[h+0]*i[h+6])/(n[u+6]+i[h+6]),n[u+8]=(n[u+8]*n[u+6]+i[h+1]*i[h+6])/(n[u+6]+i[h+6]),n[u+6]+=i[h+6],u=pt}}if(s.settings.barnesHutOptimize)for(v=s.settings.scalingRatio,h=0;h<s.nodesLength;h+=s.ppn)for(u=0;;)if(n[u+5]>=0){if(I=Math.sqrt((i[h+0]-n[u+7])*(i[h+0]-n[u+7])+(i[h+1]-n[u+8])*(i[h+1]-n[u+8])),2*n[u+3]/I<s.settings.barnesHutTheta){if(b=i[h+0]-n[u+7],S=i[h+1]-n[u+8],s.settings.adjustSizes?I>0?(F=v*i[h+6]*n[u+6]/I/I,i[h+2]+=b*F,i[h+3]+=S*F):I<0&&(F=-v*i[h+6]*n[u+6]/I,i[h+2]+=b*F,i[h+3]+=S*F):I>0&&(F=v*i[h+6]*n[u+6]/I/I,i[h+2]+=b*F,i[h+3]+=S*F),n[u+4]<0)break;u=n[u+4];continue}u=n[u+5]}else{if(n[u+0]>=0&&n[u+0]!==h&&(b=i[h+0]-i[n[u+0]+0],S=i[h+1]-i[n[u+0]+1],I=Math.sqrt(b*b+S*S),s.settings.adjustSizes?I>0?(F=v*i[h+6]*i[n[u+0]+6]/I/I,i[h+2]+=b*F,i[h+3]+=S*F):I<0&&(F=-v*i[h+6]*i[n[u+0]+6]/I,i[h+2]+=b*F,i[h+3]+=S*F):I>0&&(F=v*i[h+6]*i[n[u+0]+6]/I/I,i[h+2]+=b*F,i[h+3]+=S*F)),n[u+4]<0)break;u=n[u+4]}else for(v=s.settings.scalingRatio,g=0;g<s.nodesLength;g+=s.ppn)for(f=0;f<g;f+=s.ppn)b=i[g+0]-i[f+0],S=i[g+1]-i[f+1],s.settings.adjustSizes?(I=Math.sqrt(b*b+S*S)-i[g+8]-i[f+8],I>0?(F=v*i[g+6]*i[f+6]/I/I,i[g+2]+=b*F,i[g+3]+=S*F,i[f+2]+=b*F,i[f+3]+=S*F):I<0&&(F=100*v*i[g+6]*i[f+6],i[g+2]+=b*F,i[g+3]+=S*F,i[f+2]-=b*F,i[f+3]-=S*F)):(I=Math.sqrt(b*b+S*S),I>0&&(F=v*i[g+6]*i[f+6]/I/I,i[g+2]+=b*F,i[g+3]+=S*F,i[f+2]-=b*F,i[f+3]-=S*F));for(_=s.settings.gravity/s.settings.scalingRatio,v=s.settings.scalingRatio,h=0;h<s.nodesLength;h+=s.ppn)F=0,b=i[h+0],S=i[h+1],I=Math.sqrt(b*b+S*S),s.settings.strongGravityMode?I>0&&(F=v*i[h+6]*_):I>0&&(F=v*i[h+6]*_/I),i[h+2]-=b*F,i[h+3]-=S*F;for(v=1*(s.settings.outboundAttractionDistribution?x:1),p=0;p<s.edgesLength;p+=s.ppe)g=r[p+0],f=r[p+1],y=r[p+2],L=Math.pow(y,s.settings.edgeWeightInfluence),b=i[g+0]-i[f+0],S=i[g+1]-i[f+1],s.settings.adjustSizes?(I=Math.sqrt(b*b+S*S)-i[g+8]-i[f+8],s.settings.linLogMode?s.settings.outboundAttractionDistribution?I>0&&(F=-v*L*Math.log(1+I)/I/i[g+6]):I>0&&(F=-v*L*Math.log(1+I)/I):s.settings.outboundAttractionDistribution?I>0&&(F=-v*L/i[g+6]):I>0&&(F=-v*L)):(I=Math.sqrt(b*b+S*S),s.settings.linLogMode?s.settings.outboundAttractionDistribution?I>0&&(F=-v*L*Math.log(1+I)/I/i[g+6]):I>0&&(F=-v*L*Math.log(1+I)/I):s.settings.outboundAttractionDistribution?(I=1,F=-v*L/i[g+6]):(I=1,F=-v*L)),I>0&&(i[g+2]+=b*F,i[g+3]+=S*F,i[f+2]-=b*F,i[f+3]-=S*F);let O,V,j,Z,at=0;if(s.settings.adjustSizes)for(h=0;h<s.nodesLength;h+=s.ppn)i[h+9]||(O=Math.sqrt(i[h+2]*i[h+2]+i[h+3]*i[h+3]),O>s.maxForce&&(i[h+2]=i[h+2]*s.maxForce/O,i[h+3]=i[h+3]*s.maxForce/O),V=i[h+6]*Math.sqrt((i[h+4]-i[h+2])*(i[h+4]-i[h+2])+(i[h+5]-i[h+3])*(i[h+5]-i[h+3])),j=Math.sqrt((i[h+4]+i[h+2])*(i[h+4]+i[h+2])+(i[h+5]+i[h+3])*(i[h+5]+i[h+3]))/2,Z=.1*Math.log(1+j)/(1+Math.sqrt(V)),A=i[h+0],w=i[h+1],i[h+0]=i[h+0]+i[h+2]*(Z/s.settings.slowDown),i[h+1]=i[h+1]+i[h+3]*(Z/s.settings.slowDown),b=i[h+0],S=i[h+1],I=Math.sqrt((b-A)*(b-A)+(S-w)*(S-w)),at+=I);else for(h=0;h<s.nodesLength;h+=s.ppn)i[h+9]||(V=i[h+6]*Math.sqrt((i[h+4]-i[h+2])*(i[h+4]-i[h+2])+(i[h+5]-i[h+3])*(i[h+5]-i[h+3])),j=Math.sqrt((i[h+4]+i[h+2])*(i[h+4]+i[h+2])+(i[h+5]+i[h+3])*(i[h+5]+i[h+3]))/2,Z=i[h+7]*Math.log(1+j)/(1+Math.sqrt(V)),i[h+7]=Math.min(1,Math.sqrt(Z*(i[h+2]*i[h+2]+i[h+3]*i[h+3])/(1+Math.sqrt(V)))),A=i[h+0],w=i[h+1],i[h+0]=i[h+0]+i[h+2]*(Z/s.settings.slowDown),i[h+1]=i[h+1]+i[h+3]*(Z/s.settings.slowDown),b=i[h+0],S=i[h+1],I=Math.sqrt((b-A)*(b-A)+(S-w)*(S-w)),at+=I);if(s.iterations++,s.settings.autoStop&&(s.converged=s.iterations>s.settings.maxIterations||at/s.nodesLength<s.settings.avgDistanceThreshold,s.converged&&s.settings.alignNodeSiblings)){let pt,K,ut={},ht={};for(p=0;p<s.edgesLength;p+=s.ppe)g=r[p+0],f=r[p+1],g!==f&&(ut[g]=ut[g]||{},ut[f]=ut[f]||{},ut[g][f]=!0,ut[f][g]=!0);Object.keys(ut).forEach((Ne=>{var ge=~~Ne;K=Object.keys(ut[ge]),K.length==2&&(pt=K[0]+";"+K[1],pt in ht||(pt=K[1]+";"+K[0],ht[pt]||(ht[pt]=[~~K[1],~~K[0]])),ht[pt].push(ge))}));let nt,ot,Nt,Q,Et,Xt,Ht,Zt,ae,pe,ne,te,se,ce,Ce,ve=s.settings.nodeSiblingsAngleMin;Object.keys(ht).forEach((Ne=>{if(ot=ht[Ne].shift(),Nt=ht[Ne].shift(),nt=ht[Ne].filter((Ge=>!i[Ge+9])),nt.length==1)return;if(Xt=i[ot+0],Ht=i[ot+1],Zt=i[Nt+0],ae=i[Nt+1],Q=Object.keys(ut[ot]).length,Et=Object.keys(ut[Nt]).length,pe=(function(De,He,Je,ss,ts){return(ts-ss)*(De-He)/(Je-He)+ss})(Q/(Q+Et),0,1,1/4,3/4),te=(function(De,He,Je,ss,ts){return{x:De+(Je-De)*ts,y:He+(ss-He)*ts}})(Xt,Ht,Zt,ae,pe),se=(function(De,He,Je,ss){return{xi:-(ss-He),yi:Je-De,xiPrime:ss-He,yiPrime:-(Je-De)}})(Xt,Ht,Zt,ae),ne=(function(De,He,Je,ss){const ts=Je-De,hs=ss-He;return Math.sqrt(ts*ts+hs*hs)})(Xt,Ht,Zt,ae),ce=(function(De,He){return{x:(De.xiPrime-De.xi)/He,y:(De.yiPrime-De.yi)/He}})(se,ne),Ce=(function(De){return Math.acos(De.x/Math.sqrt(De.x*De.x+De.y*De.y))})(ce),2*ve>Math.PI)throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.");ve>0&&(Ce<ve||Ce>Math.PI-ve&&Ce<=Math.PI?ce={x:2*Math.cos(Math.PI-ve),y:2*Math.sin(Math.PI-ve)}:(Ce>2*Math.PI-ve||Ce>=Math.PI&&Ce<Math.PI+ve)&&(ce={x:2*Math.cos(ve),y:2*Math.sin(ve)}));let ge=0,ze=1,is=1;nt.length%2==1&&(is=0,ge=1);for(let Ge=0;Ge<nt.length;Ge++)i[nt[Ge]+0]=te.x+ze*ce.x*is*(ge||Ge>=2?s.settings.nodeSiblingsScale:2*s.settings.nodeSiblingsScale/3),i[nt[Ge]+1]=te.y+ze*ce.y*is*(ge||Ge>=2?s.settings.nodeSiblingsScale:2*s.settings.nodeSiblingsScale/3),ze=-ze,is+=(Ge+ge)%2}))}}function a(l){const u=Object.keys(l),h={};for(let g=0;g<i.length;g+=s.ppn){const f=u[g/s.ppn];h[f]={id:f,x:i[g+0],y:i[g+1],pinned:i[g+9]}}return h}return(function(){if(s.settings.autoStop){const u=Date.now();for(;!(s.converged||Date.now()-u>=e.chunkPeriod);)o()}else{const u=s.iterations===0?s.settings.startingIterations:s.iterations+s.settings.iterationsPerRender;for(;s.iterations!==u;)o()}return{nodes:a(e.nodes),barycentre:e.barycentre}})()},isRunning:function(t){return!t.W.settings.autoStop||!t.W.converged||(t.W=void 0,!1)},stop:function(t){t.W&&(t.W.converged=!0)},onSync:function({nodes:t,barycentre:e},{graph:s}){const n=Object.keys(t),i=n.length;let r,o,a,l,u,h,g,f,p=0,y=0;const _=new Array(i),x=new Array(i),v=new Array(i),b=new Array(i),[S,A]=s.getAttributes(!0,["x","y"]);for(r=0;r<i;r++)o=n[r],a=t[o],f=parseInt(o),_[r]=f,b[r]=a.pinned,a.pinned?(l=S.get(f),u=A.get(f)):(l=a.x,u=a.y),x[r]=l,v[r]=u,p+=l,y+=u;for(h=p/i-e.x,g=y/i-e.y,r=0;r<i;r++)b[r]||(x[r]-=h,v[r]-=g);return{indexes:_,x,y:v}}},c$=t=>(t.modules.layouts.register(OA),(e={})=>e.incremental?MN(e,t,t.layouts.forceLink):t.modules.layouts.start(OA.name,e)),BA={name:"grid",configure:function(t,{graph:e,camera:s}){function n(w){return w===void 0||typeof w=="number"&&isFinite(w)&&w>0}const i=t.sortBy,r=t,o=r.nodes,a=Array.from(o._indexes),l=a.length,{rows:u,cols:h,rowDistance:g,colDistance:f}=(function(L,I,F,O,V){if(!n(I))throw new TypeError('"rows" should be a positive integer');if(!n(F))throw new TypeError('"cols" should be a positive integer');if(!n(O))throw new TypeError('"rowDistance" should be a positive number');if(!n(V))throw new TypeError('"colDistance" should be a positive number');if(I)return{rows:I,cols:Math.ceil(L/I),rowDistance:O,colDistance:V};if(F)return{cols:F,rows:Math.ceil(L/F),rowDistance:O,colDistance:V};const j=Math.ceil(Math.sqrt(L));return{cols:j,rows:Math.ceil(L/j),rowDistance:O,colDistance:V}})(l,r.rows,r.cols,r.colDistance,r.rowDistance),p=(function(L,I,F,O,V){return typeof L!="string"?O.map(((j,Z)=>Z)):L==="radius"?I.getAttribute(!0,"radius").getMultiple(O):L==="degree"?F.getDegree():L==="random"?O.map((()=>Math.random())):F.getData(L).map((j=>j||V))})(i,e,o,a,t.sortFallbackValue),y=o.getAttribute("layoutable"),_=a.reduce(((w,L,I)=>(y[I]&&w.push({id:L,attr:p[I]}),w)),[]),x=o.getAttribute("x"),v=o.getAttribute("y"),b=o.getAttribute("radius");let S=1/0,A=1/0;for(let w=0;w<a.length;w++)S=Math.min(S,x[w]),A=Math.min(A,v[w]);return{sort:!!i,nodes:_,reverse:!!r.reverse,cols:h,rows:u,minX:S,minY:A,rs:b,rowDistance:g,colDistance:f}},update:function({sort:t,nodes:e,minX:s,rs:n,minY:i,reverse:r,cols:o,rowDistance:a,colDistance:l}){const u=e.map(((v,b)=>b));t&&u.sort(((v,b)=>e[v].attr-e[b].attr)),r&&u.reverse();let h=0;for(let v=0;v<e.length;v++){const b=v>0&&(v+1)%o==0,S=v%o==0,A=b?0:n[u[v+1]]||0,w=S?0:n[u[v+o-1]]||0,L=n[u[v+o]]||0,I=b?0:n[u[v+o+1]]||0,F=n[u[v]]||0;h=Math.max(h,F+A,F+w,F+L,F+I)}let g=h+5,f=h+5;const p=s,y=i;isFinite(g)||(g=0),isFinite(f)||(f=0),a!==void 0&&isFinite(a)&&(g=h+a),l!==void 0&&isFinite(l)&&(f=h+l);let _=0,x=0;return u.forEach((v=>{const b=e[v];b.x=p+_*g,b.y=y+x*f,_+=1,_===o&&(x+=1,_=0)})),e},onSync:function(t){return{indexes:t.map((({id:e})=>e)),x:t.map((({x:e})=>e)),y:t.map((({y:e})=>e))}}},g$=t=>(t.modules.layouts.register(BA),(e={})=>t.modules.layouts.start(BA.name,e)),P0={id:"__SENTINEL__",layer:-1,sink:!1,fixed:!1,siblingIndex:-1,parentIds:[],children:[],radius:0,ref:null},Ld=t=>t.data===P0||!1,ax=t=>!Ld(t),f$=[],p$=(t,e)=>({id:t,layer:e,data:P0,children:f$,ref:void 0,x:0,y:0}),IN=(t,e)=>({id:t,layer:-1,data:e,children:[],x:0,y:0}),UA=class{constructor(t,e,s){this.data=t,this.prev=e,this.next=s}toString(){return this.data}},RN=t=>t.reduce(((e,s)=>(e[s]=!0,e)),{});function m$(t,e){const s=[t],n=RN(s),i=[t];for(;s.length;){const r=s.shift();for(const o of e.get(r))n[o]||(n[o]=!0,i.push(o),s.push(o))}return i}function z0(t){return t.reduce(((e,{source:s,target:n})=>(e.set(s,e.get(s)||[]),e.set(n,e.get(n)||[]),e.get(s).push(n),e.get(n).push(s),e)),new Map)}function _$(t){return t.reduce(((e,{source:s,target:n})=>(e[s]=e[s]||[],e[s].push(n),e)),{})}function y$(t,e,s){const n=s||z0(e||[]);return t.filter((({id:i})=>!n.has(i)))}function x$(t,e){const s=RN(e);return t.filter((n=>!(n in s)))}function Ui(t,e){t.forEach(((s,n)=>{s.forEach(((i,r,o)=>{e(i,r,o,n)}))}))}var GA=t=>{const e=Math.floor(t.length/2);return(t=[...t].sort(((s,n)=>s-n))).length%2!=0?t[e]:(t[e-1]+t[e])/2};function v$(t,e,s){const n=z0(e);let i=Array.from(n.keys());const r=[];for(;i.length;){const o=m$(i[0],n);r.push(o),i=x$(i,o)}return s.skipSingletons?r:r.concat(y$(t,e,n).map((({id:o})=>[o])))}var Wg=({id:t,layer:e,sink:s,siblingIndex:n,radius:i,layoutable:r})=>({id:t,layer:e!==void 0?e:void 0,sink:s,siblingIndex:n||0,radius:i||0,fixed:r===!1,parentIds:[],children:[],ref:null});function b$(t){const e={x:0,y:0};let s=0;for(let n=0;n<t.length;n++){const i=t[n];for(let r=0;r<i.nodes.length;r++){const o=i.nodes[r];e.x+=o.x||0,e.y+=o.y||0,s++}}return e.x/=s,e.y/=s,e}function E$(t){const e={x:0,y:0};let s=0;for(const[,{x:n,y:i}]of t)e.x+=n||0,e.y+=i||0,s++;return e.x/=s,e.y/=s,e}function S$(t,e,s){const n=b$(s),i=t.x-n.x,r=t.y-n.y;for(let o=0;o<s.length;o++){const a=s[o];for(let l=0;l<a.nodes.length;l++){const u=a.nodes[l],h=e.get(u.id);!h||u.data&&u.data.fixed||(h.x=u.x+i,h.y=u.y+r)}}}function VA(t){return Math.ceil(Math.sqrt(t))}var jA=5,A$=class{constructor(t,e,s=0,n=!1){this.groupToSubNodes=new Map,this.nodeToGroup=new Map,this.lookup=new Map,this.shouldPackSiblings=!0,this.shouldSort=!1,this.shouldPackSiblings=t,this.packSiblingsFn=e||(()=>1),this.siblingsGap=s,this.shouldSort=n}packSiblings(t){if(!this.shouldPackSiblings)return;const e=this.groupToSubNodes,s=this.nodeToGroup,n=this.siblingsGap,i=this.packSiblingsFn,r=[],o=new Set,a=new Map,l=new Map,u=this.lookup;t.nodes.forEach((h=>{u.set(h.id,h)})),t.nodes.forEach((h=>{if(!h.children.length)return;const g=[];h.children.forEach((f=>{f.id===h.id||f.children.length||g.push(f)})),!(g.length<jA)&&l.set(h.id,g)})),l.forEach(((h,g)=>{const f=new Map;h.length<jA||(h.forEach((p=>{if(a.has(p.id))return;const y=i(p.data);if(y===void 0)return;const _=`${g}-${y}`;a.set(p.id,_),f.has(_)?f.get(_).push(p):f.set(_,[p])})),f.forEach(((p,y)=>{this.shouldSort&&p.sort(((S,A)=>S.data.siblingIndex-A.data.siblingIndex));const _=VA(p.length);let x=_*n;for(let S=0;S<_;S++){let A=0;for(let w=0;w<_;w++){const L=p[S*_+w];A=Math.max(A,L?2*L.data.radius:0)}x+=A}x/=2,e.set(y,p);const v=p[0].layer,b=IN(y,Wg({id:y,layer:v,radius:x}));b.layer=v,u.set(y,b),r.push(b),p.forEach((S=>{s.set(S.id,y),o.add(S.id)}))})))})),t.nodes=t.nodes.filter((h=>o.has(h.id)===!1)),r.forEach((h=>{t.nodes.push(h)})),t.nodes.forEach((h=>{const g=new Set;h.children=h.children.filter((f=>{if(!a.has(f.id))return!0;const p=a.get(f.id);return g.add(p),!1})),h.children.push(...Array.from(g).map((f=>u.get(f))))}))}unpackSiblings(t){if(!this.shouldPackSiblings)return;const e=this.siblingsGap,s=this.groupToSubNodes,n=new Set,i=[];t.nodes.forEach((r=>{if(!s.has(r.id))return;n.add(r.id);const o=s.get(r.id)||[],a=VA(o.length),l=new Array(a).fill(0);o.forEach(((h,g)=>{i.push(h);const f=Math.floor(g/a);l[f]=Math.max(l[f],2*h.data.radius)})),l[0]-=r.data.radius;for(let h=1;h<a;h++)l[h]+=l[h-1]+e;const u=2*r.data.radius/a;o.forEach(((h,g)=>{const f=Math.floor(g/a),p=g%a;h.y=r.y+l[f],h.x=r.x-r.data.radius+p*u}))})),t.nodes=t.nodes.filter((r=>!n.has(r.id))),i.forEach((r=>{t.nodes.push(r)}))}};function w$(t){let e=0,s=0;for(const o of t)e+=o.w*o.h,s=Math.max(s,o.w);t.sort(((o,a)=>a.h-o.h));const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),s),h:1/0}];let i=0,r=0;for(const o of t)for(let a=n.length-1;a>=0;a--){const l=n[a];if(!(o.w>l.w||o.h>l.h)){if(o.x=l.x,o.y=l.y,r=Math.max(r,o.y+o.h),i=Math.max(i,o.x+o.w),o.w===l.w&&o.h===l.h){const u=n.pop();a<n.length&&(n[a]=u)}else o.h===l.h?(l.x+=o.w,l.w-=o.w):o.w===l.w?(l.y+=o.h,l.h-=o.h):(n.push({x:l.x+o.w,y:l.y,w:l.w-o.w,h:o.h}),l.y+=o.h,l.h-=o.h);break}}return{w:i,h:r,fill:e/(i*r)||0}}var T$={down:()=>{},up:t=>t.y=-t.y,left:t=>{const e=t.x;t.x=-t.y,t.y=e},right:t=>{const e=t.x;t.x=t.y,t.y=-e}},S_=(t,e)=>isFinite(t)&&t>0?t:e;function C$(t){return{nodesSeparation:S_(t.nodesSeparation,0),componentsSeparation:S_(t.componentsSeparation,25),layerSeparation:S_(t.layerSeparation,50)}}function L$(t,{componentsSeparation:e,packing:s}){const n=[];for(let i=0;i<t.length;i++){const r=t[i],o=r.nodes;if(r.isFake&&r.w!==void 0&&r.h!==void 0){n.push({w:r.w,h:r.h,x:void 0,y:void 0,dag:r});continue}if(r.nodes.length===1){const f=2*o[0].data.radius;n.push({w:f+e/2,h:f+e/2,x:void 0,y:void 0,dag:r});continue}const{minX:a,maxX:l,minY:u,maxY:h}=o.reduce(((f,{x:p,y,data:_})=>{const x=_.radius||0;return f.minX=Math.min(f.minX,p-x),f.maxX=Math.max(f.maxX,p+x),f.minY=Math.min(f.minY,y-x),f.maxY=Math.max(f.maxY,y+x),f}),{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0}),g=(l+a)/2;o.forEach((f=>{f.x-=g})),n.push({w:Math.abs(l-a)+e/2,h:Math.abs(h-u)+e/2,minX:a,x:void 0,y:void 0,dag:r})}if(s!=="singleline")w$(n);else{let i=0;for(let r=0;r<n.length;r++){const o=n[r];o.x=i,o.y=0,i+=o.w}}return n}function k$(t,e={}){const{componentsSeparation:s}=C$(e);e.direction===void 0&&(e.direction="down");const n=L$(t,{componentsSeparation:s,packing:e.packing});for(let i=0;i<n.length;i++){const{x:r=0,y:o=0,dag:a}=n[i];for(const l of a.nodes)l.x+=r,l.y+=o,T$[e.direction](l)}}var N$=t=>t.reduce(((e,{radius:s})=>Math.max(e,2*s)),0);function M$(t,e){return{nodes:t.map((s=>({...s,data:s}))),isFake:!0,...e}}function I$(t,e,s){const n=z0(e||[]),i=t.filter((({id:p})=>!n.has(p))).sort(((p,y)=>y.radius-p.radius)),r=Math.sqrt(i.length);let o=Math.floor(r),a=Math.ceil(r);o*a<i.length&&(o<a?o++:a++);const l=Math.max(1,N$(i)),u=Math.max(s.nodesGridSeparation||0,1),h=l*a+u*(a-1),g=l*o+u*Math.max(o-1,0),f=M$(i,{w:h,h:g});return f.nodes.forEach(((p,y)=>{const _=y%a,x=Math.floor(y/a);p.x=h*_/a,p.y=g*x/o})),f}function HA(t,e,s){const n=e.reduce(((o,a)=>(o.set(a.source,o.get(a.source)||[]),o.get(a.source).push(a),o)),new Map),{result:i}=t.reduce((function o(a,l){const{visited:u,stack:h,result:g}=a;if(u.has(l.id))return a;h.add(l.id),u.add(l.id);const f=n.get(l.id)||[];for(const p of f)h.has(p.target)?g.push(p):o(a,s.get(p.target));return h.delete(l.id),a}),{visited:new Set,stack:new Set,result:[]}),r=i.reduce(((o,{source:a,target:l})=>(o.set(a,o.get(a)||new Set),o.get(a).add(l),o)),new Map);return e.map((o=>{const{source:a,target:l,id:u}=o;return r.has(a)&&r.get(a).has(l)?{id:u,source:l,target:a}:o}))}function R$(t){if(!t||!t.length)throw Error("Cannot stratify empty data");for(const i of t){if(!i)throw Error('Node data is "null"');if(i.id==null)throw Error('Node id contains a "null" value')}const e=t.map((i=>IN(i.id,i))),s=e.reduce(((i,r)=>{if(i[r.id])throw Error(`The connected component contains id duplicates: ${r.id}`);return i[r.id]=r,i}),{}),n=[];for(let i=0;i<e.length;i++){const r=e[i];for(let o=0;o<r.data.parentIds.length;o++){const a=r.data.parentIds[o],l=s[a];if(!l)throw Error(`The node ${r.id} has a missing parent id ${a}`);l.children.push(r)}r.data.parentIds.length||n.push(r)}return{isFake:!1,nodes:F$(n)}}function F$(t){const e={},s=[];for(;t.length;){const n=t.pop();e[n.id]||(s.push(n),e[n.id]=!0,t.push(...n.children))}return s}var P$=t=>{var h,g,f;const e=[];if(t.nodes.forEach((p=>{if(p&&!isNaN(p.layer)&&p.layer!==null){if(p.layer<0)throw new Error("Layer must be greater than or equal to 0");e.push([p.id,p.layer])}})),e.length===0)return t.edges;e.sort(((p,y)=>p[1]-y[1]));const s=new Set;for(let p=0;p<e.length;p++)e[p][1]!==0&&s.add(e[p][0]);const n=new Map;for(const p of t.nodes)n.set(p.id,[]);for(const p of t.edges)(h=n.get(p.source))==null||h.push(p.target),(g=n.get(p.target))==null||g.push(p.source);if(!e.map((([,p])=>p)).some((p=>p===0))){e.sort(((x,v)=>x[1]-v[1]));const p=new Set,y=[e[0]];let _;for(;y.length>0;){const[x,v]=y.shift();if(v===0){_=x;break}p.add(x);const b=n.get(x)||[];for(const S of b)s.has(S)||p.has(S)||y.push([S,v-1])}if(_)e.push([_,0]);else{const x=e[0][1];for(let v=0;v<e.length;v++)e[v][1]-=x}}const i=e.filter((([,p])=>p===0)).map((([p])=>p)),r=i.slice(),o=new Map,a=new Map,l=new Map;for(const p of i)o.set(p,0),a.set(p,[]);for(;r.length>0;){const p=r.shift(),y=o.get(p),_=n.get(p)||[];for(const x of _){const v=o.get(x);v===void 0?(o.set(x,y+1),a.set(x,[p]),r.push(x)):v===y+1&&((f=a.get(x))==null||f.push(p))}}for(const[p,y]of a.entries())for(const _ of y)l.set(_,(l.get(_)||[]).concat(p));for(const[p,y]of e)if(o.get(p)!==y)if(y===0){const _=a.get(p)||[];a.set(p,[]),_.forEach((b=>{l.set(b,(l.get(b)||[]).filter((S=>S!==p)))}));const x=t.nodes.filter((b=>o.get(b.id)===0));o.clear(),x.forEach((b=>o.set(b.id,0)));const v=x.map((b=>b.id));for(;v.length>0;){const b=v.shift(),S=o.get(b),A=l.get(b)||[];for(const w of A)o.get(w)===void 0&&(o.set(w,S+1),v.push(w))}}else{const _=t.nodes.find((S=>o.get(S.id)===y-1&&S.id!==p));if(!_)continue;const x=a.get(p)||[];a.set(p,[_.id]),x.forEach((S=>{l.set(S,(l.get(S)||[]).filter((A=>A!==p)))})),l.set(_.id,(l.get(_.id)||[]).concat(p));const v=t.nodes.filter((S=>o.get(S.id)===0));o.clear(),v.forEach((S=>o.set(S.id,0)));const b=v.map((S=>S.id));for(;b.length>0;){const S=b.shift(),A=o.get(S),w=l.get(S)||[];for(const L of w)o.get(L)===void 0&&(o.set(L,A+1),b.push(L))}}const u=[];for(const[p,y]of a.entries())if(y.length>0)for(const _ of y)u.push({id:`${_}-${p}`,source:_,target:p});return u},z$=class{constructor(){this.byId={},this.byIndex={},this.length=0}append(e,s){let n;return this.head?(n=new UA(e,this.tail),this.tail=this.tail.next=n):(n=new UA(e),this.tail=this.head=n),this.byId[s]=n,this.byIndex[this.length++]=n,n}find(e){let s=this.head;do{if(s.data===e)return s;s=s.next}while(s)}forEach(e){let s=this.head,n=0;do e(s,n),n++;while(s=s.next)}},Gi=-1,sn=1e-5,A_=[],D$=class{constructor(t,e,s){this.edges=[],this.nodeMap={},this.nodeIndexTopDown={},this.nodeToLayer={},this.longEdges={},this.virt={},this.height={},this.breadth={},this.first=[],this.totalW={},this.mDist={},this.X={},this.block={},this.nodeList=new z$,this.nodeDistance=e,this.layerDistance=s,this.layers=t;const{breadth:n,virt:i,height:r,nodeToLayer:o,nodeIndexTopDown:a,nodeMap:l,longEdges:u,edges:h}=this;let g=0;Ui(this.layers,((_,x,v,b)=>{if(a[_.id]=g++,l[_.id]=_,o[_.id]=b,this.nodeList.append(_,_.id),_.children.forEach((A=>{const w=Ld(A)||Ld(_);h.push({source:_.id,target:A.id,virtual:w,id:h.length})})),u[_.id])return;const S=[_.id];if(u[_.id]=S,!ax(_))for(let A=0;A<_.children.length;A++){const w=_.children[A];if(ax(w))continue;let L=w;for(;Ld(L);)S.push(L.id),u[L.id]=S,L=L.children[0]}}));const f=this.adjacencyList=_$(h);this.N=t.reduce(((_,x)=>_+x.length),0),this.Y=new Float32Array(t.length),this.first=t.map((_=>_[0])),t.forEach(((_,x)=>r[x]=0)),Ui(this.layers,((_,x,v,b)=>{const S=f[_.id]?f[_.id].length:0;i[_.id]=Ld(_)&&S===1,this.nodeToLayer[_.id]=b,i[_.id]?n[_.id]=0:(n[_.id]=2*_.data.radius,r[b]=Math.max(r[b]||0,2*_.data.radius))}));const p={},y={};h.forEach((_=>{const x=_.source,v=_.target;p[v]=p[v]||[],p[v].push(x),y[x]=y[x]||[],y[x].push(v)})),Object.values(p).forEach((_=>{_.sort(((x,v)=>this.nodeIndexTopDown[x]-this.nodeIndexTopDown[v]))})),Object.values(y).forEach((_=>{_.sort(((x,v)=>this.nodeIndexTopDown[x]-this.nodeIndexTopDown[v]))})),this.neighbours={prev:p,next:y}}computeMinNodeDistances(){const{layers:t,totalW:e}=this;Ui(t,(s=>{e[s.id]=0})),Ui(t,(s=>e[s.data.id]=0)),this.layers.forEach((s=>{e[s[0].id]=0,s.slice(1).forEach(((n,i)=>{const r=s[i],o=n.id;e[o]=e[r.id]+r.data.radius+n.data.radius+this.nodeDistance}))}))}decrossVirtualEdges(){this.layers.forEach((t=>{let e=-1;t.forEach((s=>{if(!this.virt[s.id])return;const n=this.neighbours.next[s.id][0];if(this.virt[n])if(e!==-1&&e>this.nodeIndexTopDown[n]){const i=this.longEdges[s.id];let r=0;for(r=0;r<i.length&&i[r]!==n;r++);const o=i.slice(r);o.forEach((l=>this.longEdges[l]=o));const a=i.slice(0,r);a.forEach((l=>this.longEdges[l]=a))}else e=this.nodeIndexTopDown[n]}))}))}placeLongEdges(){const{X:t,layers:e}=this;Ui(e,(s=>t[s.id]=0));for(let s=1;s>=-1;s-=2){const n={};let i=0;const r={};Ui(e,(u=>r[u.id]=0)),r[P0.id]=0;const o=s;e.forEach((u=>{let h=o===1?u[0]:u[u.length-1];r[h.id]||(this.longEdges[h.id].forEach((p=>{r[p]=i})),i++);let g=o===1?0:u.length-1,f=g+o;for(;f>=0&&f<u.length;)h=u[f],r[h.id]||this.longEdges[h.id].forEach((p=>{r[p]=r[u[g].id]})),g=f,f+=o}));const a={};e.forEach((u=>{for(let h=o===1?0:u.length-1;o===1?h<u.length:h>=0;h+=o){const g=u[h],f=r[g.id];a[f]=a[f]||[],a[f].push(g.id)}}));const l={};this.nodeList.forEach((u=>l[u.data.id]=0));for(let u=0;u<i;u++){const h={done:!1,dist:0},g=a[u];for(let f=0;f<g.length;f++){const p=g[f];this.sortLongEdges(p,s,l,h,r,n)}if(!h.done){const f=this.layers[this.nodeToLayer[a[u][0]]],p=[];f.forEach((y=>{for(const _ of this.neighbours.prev[y.id]||A_){const x=Math.abs(l[_]-l[y.id]);p.push(x)}})),p.length!==0&&(h.dist=GA(p))}for(let f=0;f<g.length;f++)l[g[f]]-=s*h.dist}Ui(e,(u=>t[u.id]+=l[u.id]/2))}}sortLongEdges(t,e,s,n,i,r){if(r[t])return!1;let o=!1,a=0;const{nodeToLayer:l,totalW:u}=this,h=this.longEdges[t];h.forEach((g=>r[g]=!0)),h.forEach((g=>{const f=this.nodeList.byIndex[this.nodeIndexTopDown[g]-e];if(!f)return;const p=f.data.id,y=g,_=l[p]===l[y],x=i[p]===i[y];!_||!x||(this.sortLongEdges(p,e,s,n,i,r),(!o||e*(a-s[p])<e*(u[y]-u[p]))&&(o=!0,a=s[p]+u[y]-u[p]))})),h.forEach((g=>{s[g]=a;const f=this.nodeList.byId[g],p=e===1?f.next:f.prev;if(!p)return;const y=p.data.id,_=g,x=l[y]===l[_],v=i[y]!==i[_],b=e*(u[y]-u[_]-s[y]+s[_]);x&&v&&(!n.done||b>n.dist)&&(n.dist=b,n.done=!0)}))}placeNonVirtualNodes(){const t={};Ui(this.layers,(l=>t[l.id]=-1));const{X:e,totalW:s,virt:n,nodeIndexTopDown:i,mDist:r,nodeList:o}=this,a={};Ui(this.layers,((l,u,h,g)=>{if(!n[l.id])return void(a[l.id]=!1);let f=this.nodeList.byId[l.id].next;for(;f&&this.nodeToLayer[f.data.id]===g&&!n[f.data.id];)f=f.next;a[l.id]=this.nodeToLayer[f.data.id]===g&&e[f.data.id]-e[l.id]<s[f.data.id]-s[l.id]+sn})),Ui(this.layers,(({id:l})=>{a[l]&&t[l]===-1&&this.longEdges[l].forEach((u=>{u!==l&&(t[u]=i[u]<i[l]?1:0)}))})),Ui(this.layers,(({id:l})=>r[l]=s[l]));for(let l=0;l<2;l++)for(let u=l?this.layers.length-1:0;u>=0&&u<this.layers.length;l?u--:u++){let h=Gi;const g=this.layers[u];if(g.forEach((({id:f},p,y)=>{if(n[f]){if(h===Gi){this.placeSequence(Gi,f,y[0].id,o.byId[f].prev.data.id,l);for(let _=0;_<p;_++){const x=y[_].id;r[x]=r[f]-e[f]+e[x]}}else if(t[h]!==1-l){a[h]||this.placeSequence(h,f,o.byId[h].next.data.id,o.byId[f].prev.data.id,l);const _=l===1?this.neighbours.prev:this.neighbours.next,x=_[h][0],v=_[f][0];if(n[x]&&n[v])for(let b=i[x]+1;b<i[v];b++)t[o.byIndex[b].data.id]=l}h=f}})),h===Gi)this.placeSequence(Gi,Gi,g[0].id,g[g.length-1].id,l),g.forEach((({id:f})=>r[f]=e[f]));else{this.placeSequence(h,Gi,o.byId[h].next.data.id,g[g.length-1].id,l);for(let f=g.length-1;f>=0;f--){const p=g[f].id;if(p===h)break;r[p]=r[h]-e[h]+e[p]}}}}placeSequence(t,e,s,n,i,r=0){if(r===2048)return;const o=this.nodeIndexTopDown[s],a=this.nodeIndexTopDown[n],{X:l,nodeIndexTopDown:u,mDist:h}=this;if(o===a)l[s]=this.placeNode(s,t,e,l[s],i);else if(o<a){const g=Math.floor((u[s]+u[n])/2),f=this.nodeList.byIndex[g],p=f.next.data.id,y=h[p]-h[f.data.id];this.placeSequence(t,e,s,f.data.id,i,r+1),this.placeSequence(t,e,p,n,i,r+1),this.combineSequences(t,e,s,n,p,f.data.id,i,y)}}calculateBends(t,e,s,n,i,r,o,a){let l=0;const u=[],{X:h,mDist:g,neighbours:f}=this,p=this.nodeIndexTopDown[s],y=this.nodeIndexTopDown[n];for(let _=this.nodeList.byId[r],x=this.nodeIndexTopDown[_.data.id];x>=p&&x<=y&&_;_=t===-1?_.prev:_.next,x=_&&this.nodeIndexTopDown[_.data.id]){const v=_.data.id,b=(e===0?f.prev[v]:f.next[v])||A_;let S=0;for(let w=0;w<b.length;w++){const L=b[w];if(t*(h[L]-h[v])<sn)S++;else{S--;const I=h[L]+g[r]-g[v];t*(h[r]-I)>-sn?l++:(a===Gi||t*(I-h[a]+g[a]-g[r])<sn)&&t*(I-h[i])<o-sn&&u.push({value:2,key:I})}}const A=h[v]+g[r]-g[v];t*(h[r]-A)>-sn?l+=S:(a===Gi||t*(A-h[a]+g[a]-g[r])<sn)&&t*(A-h[i])<o-sn&&u.push({value:S,key:A})}return a!==Gi&&u.push({value:this.edges.length,key:h[a]-g[a]+g[r]}),u.sort((({key:_},{key:x})=>_-x)),{res:l,bends:u.reduce(((_,x,v)=>{if(v<u.length-1){const b=u[v+1];Math.abs(x.key-b.key)>sn?x.value>0&&_.push(x):x.value+=b.value}else x.value>0&&_.push(x);return _}),[])}}combineSequences(t,e,s,n,i,r,o,a){const{X:l,mDist:u,nodeIndexTopDown:h}=this;let{res:g,bends:f}=this.calculateBends(-1,o,s,n,i,r,a,t),{res:p,bends:y}=this.calculateBends(1,o,s,n,r,i,a,e);for(f.length>0&&f.reverse();l[i]-l[r]<a-sn;){let v=0,b=0;if(g<p){const S=f.length;if(S>0){const A=f.pop();v=A.value,l[r]=A.key}(S===0||l[i]-l[r]>a+sn)&&(l[r]=l[i]-a)}else if(g>p){const S=y.length;if(S>0){const A=y.pop();b=A.value,l[i]=A.key}(S===0||l[i]-l[r]>a+sn)&&(l[i]=l[r]+a)}else{let S=(a-l[i]+l[r])/2;const A=f.length===0?S+1:l[r]-f[f.length-1].key,w=y.length===0?S+1:y[y.length-1].key-l[i];A<S+sn&&A<w+sn&&(v=f.pop().value),w<S+sn&&w<A+sn&&(b=y.pop().value),S=Math.min(S,A,w),l[r]-=S,l[i]+=S}g+=v,p+=b}let _,x=this.nodeList.byId[r].prev;for(;x&&h[_=x.data.id]>=h[s]&&l[r]-l[_]<u[r]-u[_];)l[_]=l[r]-u[r]+u[_],x=x.prev;for(x=this.nodeList.byId[i].next;x&&h[_=x.data.id]<=h[n]&&l[i]-l[_]>u[i]-u[_];)l[_]=l[i]-u[i]+u[_],x=x.next}placeNode(t,e,s,n,i){const{X:r,neighbours:o,mDist:a}=this,l=((i===0?o.prev:o.next)[t]||A_).map((u=>r[u]));return l.length===0?r[t]:(n=GA(l),e!==Gi&&(n=Math.max(n,r[e]+a[t]-a[e])),s!==Gi&&(n=Math.min(n,r[s]+a[t]-a[s])),n)}moveLongEdge(t,e,s){const{X:n,virt:i,totalW:r,nodeList:o}=this,{id:a}=t.data;if(s[a]||!i[a])return;const l=this.longEdges[a];if(!l)return;l.forEach((_=>s[_]=!0));const u=l[0],h=l[l.length-1],g=[];e<0?g.push(n[u]<n[h]?n[u]:n[h],n[u]<n[h]?n[h]:n[u]):e>0?g.push(n[u]<n[h]?n[h]:n[u],n[u]<n[h]?n[u]:n[h]):g.push(n[u],n[h]);const f=g[0];let p,y=!1;for(;!y&&g.length!==0;)p=g.pop(),y=!0,l.forEach((_=>{const x=this.layers[this.nodeToLayer[_]];if(_!==x[0].id){const v=o.byId[_].prev.data;p-n[v.data.id]<r[_]-r[v.data.id]&&this.moveLongEdge(v,-1,s),y=y&&p-n[v.data.id]>=r[_]-r[v.data.id]-sn}if(_!==x[x.length-1].id){const v=o.byId[_].next.data;p-n[v.data.id]>r[_]-r[v.data.id]&&this.moveLongEdge(v,1,s),y=y&&p-n[v.data.id]<=r[_]-r[v.data.id]+sn}}));y||(p=f,l.forEach((_=>{const x=this.layers[this.nodeToLayer[_]];if(_!==x[0].id){const v=o.byId[_].prev.data;p=Math.max(p,n[v.data.id]+r[_]-r[v.data.id])}if(_!==x[x.length-1].id){const v=o.byId[_].next.data;p=Math.min(p,n[v.data.id]+r[_]-r[v.data.id])}}))),l.forEach((_=>n[_]=p))}moveLongEdges(){const t={};this.layers.forEach((e=>{const s=Math.floor(e.length/2);for(let n=s;n<e.length;n++)this.moveLongEdge(e[n],0,t);for(let n=s-1;n>=0;n--)this.moveLongEdge(e[n],0,t)}))}computeY(){const{Y:t,layers:e,height:s}=this;t[0]=0,e.slice(1).forEach(((n,i)=>{t[i+1]=t[i]+(s[i]+s[i+1])/2+this.layerDistance}))}straightenLongEdge(t,e){const{nodeList:s,longEdges:n,neighbours:i,X:r,Y:o,nodeToLayer:a,totalW:l}=this,u=n[t.id];if(e[t.id]||!i.prev[t.id]||i.prev[t.id].length!==1||!i.next[t.id]||i.next[t.id].length!==1||!(u&&u.length<2))return;e[t.id]=!0;const h=i.prev[t.id][0],g=i.next[t.id][0];if(a[g]===a[h])return;const f=r[h]+(r[g]-r[h])*(o[a[t.id]]-o[a[h]])/(o[a[g]]-o[a[h]]);if(t!==this.first[a[t.id]]){const y=s.byId[t.id].prev.data;if(f-r[y.id]<l[t.id]-l[y.id]-sn&&this.straightenLongEdge(y,e),f-r[y.id]<l[t.id]-l[y.id]-sn)return}const p=this.layers[a[t.id]];if(t!==p[p.length-1]){const y=s.byId[t.id].next.data;if(r[y.id]-f<l[y.id]-l[t.id]-sn&&this.straightenLongEdge(y,e),r[y.id]-f<l[y.id]-l[t.id]-sn)return}r[t.id]=f}straightenEdges(){const t={};this.layers.forEach((e=>{const s=Math.floor(e.length/2);for(let n=s;n<e.length;n++)this.straightenLongEdge(e[n],t);for(let n=s-1;n>=0;n--)this.straightenLongEdge(e[n],t)}))}run(){this.computeMinNodeDistances(),this.decrossVirtualEdges(),this.placeLongEdges(),this.placeNonVirtualNodes(),this.moveLongEdges(),this.computeY(),this.straightenEdges(),Ui(this.layers,((t,e,s,n)=>{t.x=this.X[t.id],t.y=this.Y[n]}))}},O$=(t,e=20,s=50)=>new D$(t,e,s).run();function B$(t){if(t.sort(((n,i)=>n-i)),t.length===0)return 0;const e=Math.floor(t.length/2),s=Math.floor(t.length/2);return(t[e]+t[s])/2}function lx(t,e,s){const n={};return e.forEach(((i,r)=>n[i.id]=r)),t.map((i=>(s[i.id]||[]).map((r=>n[r])).sort())).reduce(((i,r,o,a)=>{const l=r.length?r[r.length-1]:-1;for(let u=o+1;u<a.length;u++)i+=a[u].filter((h=>h<l)).length;return i}),0)}function U$(t,e,s,n,i){const r={};for(let o=0;o<t.length;o++)r[t[o].id]=B$((e[t[o].id]||[]).map((a=>s[a])))||0;i?t.sort(((o,a)=>{const l=r[o.id]-r[a.id],u=n[o.id]===n[a.id],h=o.data.siblingIndex,g=a.data.siblingIndex;return u&&h>-1&&g>-1?h-g:l===0?s[a.id]-s[o.id]:l})):t.sort(((o,a)=>{const l=r[o.id]-r[a.id];return l===0?s[a.id]-s[o.id]:l}))}function $A({layers:t,topDown:e,topDownAdj:s,bottomUpAdj:n,idToIndex:i,crossings:r,sortSiblings:o}){const a=e?s:n;for(let l=e?0:t.length-1;e?l<t.length:l>=0;e?l++:l--){U$(t[l],a[l]||{},i,n[l],o);const u=l>0?lx(t[l-1],t[l],s[l-1]):0,h=l<t.length-1?lx(t[l],t[l+1],s[l]):0;h+u<=(r[l]||0)+(r[l-1]||0)?(r[l]=h,l>0&&(r[l-1]=u),t[l].forEach(((g,f)=>i[g.id]=f))):t[l].sort(((g,f)=>i[g.id]-i[f.id]))}}var G$=(t,e,s)=>{if(!s&&!e)return;const n={},i=t.map((()=>({}))),r=t.map((()=>({})));if(t.forEach(((h,g)=>{h.forEach(((f,p)=>{n[f.id]=s?f.data.siblingIndex:p,f.children.forEach((y=>{const _=y.layer;_>g?(i[g][f.id]=i[g][f.id]||[],i[g][f.id].push(y.id),r[_][y.id]=r[_][y.id]||[],r[_][y.id].push(f.id)):(i[_][y.id]=i[_][y.id]||[],i[_][y.id].push(f.id),r[g][f.id]=r[g][f.id]||[],r[g][f.id].push(y.id))}))}))})),n[-1]=-1,s&&(t.forEach((h=>h.sort(((g,f)=>n[g.id]-n[f.id])))),!e))return;const o=t.slice(1).map(((h,g)=>lx(t[g],h,i[g]))),a=[[50,100],[100,10],[1e3,1],[5e3,0]],l=Math.max(...t.map((h=>h.length))),u=(a.find((([h])=>l<h))||a[a.length-1])[1];for(let h=0;h<u;h++)$A({layers:t,topDown:!0,topDownAdj:i,bottomUpAdj:r,idToIndex:n,crossings:o,sortSiblings:s}),$A({layers:t,topDown:!1,topDownAdj:i,bottomUpAdj:r,idToIndex:n,crossings:o,sortSiblings:s})};function V$(t){const e={},s={},n={};t.nodes.forEach((o=>{n[o.id]=o}));const i=o=>{if(e[o.id])return s[o.id];e[o.id]=!0;let a=1/0;for(const l of o.children)a=Math.min(a,i(n[l.id])-1);return a===1/0&&(a=0),s[o.id]=a,a};t.nodes.forEach((o=>{o.data.parentIds.length===0&&i(o)}));let r=1/0;t.nodes.forEach((o=>{r=Math.min(r,s[o.id])})),t.nodes.forEach((o=>{s[o.id]-=r,o.layer=s[o.id]})),t.nodes.forEach((o=>{typeof o.data.layer=="number"&&!isNaN(o.data.layer)&&(o.layer=o.data.layer)}))}function j$(t){const e=t.nodes.reduce(((s,n)=>n.data.fixed&&(s===null||s.layer>n.layer)?n:s),null);return e&&t.nodes.forEach((s=>s.ref=e.id)),t}function H$(t){if(t.nodes.every((e=>e.layer))){const e=t.nodes.reduce(((s,n)=>Math.min(s,n.layer)),1/0);t.nodes.forEach((s=>s.layer-=e))}}function $$(t){if(t.nodes.some((e=>e.data.sink))){const e=t.nodes.reduce(((s,n)=>Math.max(s,n.layer)),-1/0);t.nodes.forEach((s=>{s.data.sink&&(s.layer=e+1)}))}}function q$(t){const e=[];t.nodes.forEach((n=>e[n.layer]=0));const s=Array.from(e).reduce(((n,i,r)=>{if(r===0)return n.push(0),n;const o=n[r-1];return i!==void 0?(n.push(o),n):(n.push(o-1),n)}),[]);t.nodes.forEach((n=>n.layer+=s[n.layer]))}function Y$(t){return V$(t),$$(t),H$(t),q$(t),t.nodes.forEach((e=>{const{below:s,above:n}=e.children.reduce(((i,r)=>(e.layer>r.layer?i.above.push(r):i.below.push(r),i)),{above:[],below:[]});n.forEach((i=>i.children.push(e))),e.children=s})),j$(t)}var W$=(t,{nodeDistance:e,layerDistance:s,nodeLookup:n,customSort:i,customLayering:r,sortSiblings:o,siblingsPacking:a,shouldDecross:l=!0})=>{Y$(t),a.packSiblings(t),r&&r(t);const u=X$(t);return t.nodes.length>1?(G$(u,l,o),i&&u.forEach((h=>{h.sort(((g,f)=>i(n.get(g.id),n.get(f.id))))})),O$(u,e,s)):(t.nodes[0].x=0,t.nodes[0].y=0),a.unpackSiblings(t),Z$(t),t};function X$(t){return t.nodes.reduce(((e,s)=>(e[s.layer]=e[s.layer]||[],e[s.layer].push(s),s.children=s.children.map((n=>{if(n.layer===s.layer+1)return n;let i=n;for(let r=n.layer-1;r>s.layer;r--){const o=p$(`${s.id}->${n.id}@${r}`,r);o.children=[i],e[r]=e[r]||[],e[r].push(o),i=o}return i})),e)),[])}function Z$(t){t.nodes.forEach((e=>{e.data&&(e.children=e.children.filter(ax))}))}var K$=(t,e={})=>{const s=new Map,n=new Map;for(const u of t.nodes)s.set(u.id,u);const i=t.nodes.slice(),r=(t.edges||[]).filter((({source:u,target:h})=>u!==h)),o=HA(i,r,s).filter((u=>{const h=n.get(u.source);if(!h){const g=new Map;return g.set(u.target,!0),n.set(u.source,g),!0}return!h.get(u.target)&&(h.set(u.target,!0),!0)})),a=v$(i,o,{skipSingletons:e.packing==="grid"}),l=a.map((u=>{const h=u.map((f=>s.get(f))),g=o.filter((f=>u.includes(f.source)));return HA(h,P$({nodes:h,edges:g}),s)})).flat().reduce(((u,h)=>(u.has(h.source)||u.set(h.source,Wg(s.get(h.source))),u.has(h.target)||u.set(h.target,Wg(s.get(h.target))),u.get(h.target).children.push(h.source),u.get(h.target).parentIds.push(h.source),u)),new Map);return{components:a.map((u=>u.map((h=>l.get(h)||Wg(s.get(h)))))),lookup:s}};function Q$(t,e,s,n){const i=[];for(const r of t){const o=R$(r);i.push(o),W$(o,{nodeDistance:n.nodesSeparation,layerDistance:n.layerSeparation,shouldDecross:n.shouldDecross,siblingsPacking:s,customSort:n.customSort,customLayering:n.customLayering,sortSiblings:!!n.sortSiblings,nodeLookup:e})}return i}var qA=(t,e={})=>{if(!t||!t.nodes)return t;const s={direction:"down",packing:"fit",nodesGridSeparation:1,...e,shouldDecross:e.shouldDecross!==!1},n=new A$(e.shouldPackSiblings,e.siblingPacking,e.siblingsGap,e.sortSiblings),{components:i,lookup:r}=K$(t,s),o=E$(r),a=Q$(i,r,n,s);if(s.packing==="grid"){const l=I$(t.nodes,t.edges,s);a.push(l)}return k$(a,s),S$(o,r,a),t},w_={direction:"TB",nodeDistance:5,levelDistance:50,componentDistance:50,gapWidth:1,arrangeComponents:"fit",gridDistance:50,layer:"layer",siblingIndex:""},ux={name:"hierarchical",imports:{sequential:qA},configure:function(t,{graph:e,data:s}){function n(S,A,w=S.getNodes()){return A?A instanceof lo?A:S.getNodes(A):w}const i={...w_,...t,nodeList:t.nodes};i.direction=t.direction||w_.direction,i.layerSeparation=i.levelDistance,i.nodesSeparation=i.nodeDistance,i.componentsSeparation=i.componentDistance,i.gapDistance=i.gapWidth,i.packing=i.arrangeComponents;const r=t.decross!==!1,o={...i},a=i.edges,l=i.nodeList;if(["TB","BT","LR","RL"].indexOf(i.direction)===-1)throw new Error('direction should be one of the "TB", "BT", "LR", "RL"');if(["fit","grid","singleLine"].indexOf(i.packing)===-1)throw new Error('arrangeComponents should be one of the "fit", "grid", "singleLine"');i.nodesGridSeparation=t.gridDistance||w_.gridDistance;const u=l.getId(),h=l.getAttribute("layoutable").reduce(((S,A,w)=>(S[u[w]]=A,S)),{}),g=l.getAttributes(["x","y"]).reduce(((S,A,w)=>(S[u[w]]=A,S)),{}),f=t.rs?t.rs:l.getAttribute("radius");if(typeof o.layer!="string")throw new Error("'layer' should be the valid data field name");if(o.siblingIndex===void 0&&(o.siblingIndex=""),typeof o.siblingIndex!="string")throw new Error("'siblingIndex' should be the valid data field name");const p=n(e,i.roots,e.nodeList()),y=s.getProperty(i.nodeList,o.layer),_=o.siblingIndex.length?s.getProperty(i.nodeList,o.siblingIndex):[],x=p.map((S=>{let A=-1;return i.nodeList.forEach(((w,L)=>{w===S&&(A=L)})),A}));for(const S of x)y[S]=0;const v=n(e,i.sinks,e.nodeList()).toArray().reduce(((S,A)=>(S[A.getId()]=!0,S)),{}),b=u.map((S=>v[S]));return{nodes:u,edges:a.map((S=>({id:S.getId(),source:S.getSource().getId(),target:S.getTarget().getId()}))),decross:r,options:Uf(i),layoutable:h,radiuses:f,siblingIndexes:_,layers:y,sinks:b,coords:g}},context:as,update:function({nodes:t,edges:e,options:s,layoutable:n,radiuses:i,layers:r,siblingIndexes:o,decross:a,sinks:l,coords:u}){const h=e.filter((({source:p,target:y})=>p in n&&y in n)),g={nodes:t.map(((p,y)=>({id:p,radius:i[y],layer:r[y],siblingIndex:o[y],sink:l[y],layoutable:n[p],x:u[p].x,y:u[p].y}))),edges:h},{nodes:f}=qA(g,{packing:{fit:"fit",singleLine:"singleline",grid:"grid"}[s.arrangeComponents],direction:{TB:"down",BT:"up",RL:"left",LR:"right"}[s.direction],layerSeparation:s.layerSeparation,nodesSeparation:s.nodesSeparation,shouldDecross:s.decross,sortSiblings:o.length>0,componentsSeparation:s.componentsSeparation,nodesGridSeparation:s.nodesGridSeparation,evenDistribution:s.evenDistribution});return{positions:f}},isRunning:function(){return!1},onSync:function({positions:t},{graph:e}){return{indexes:t.map((({id:s})=>(e.getNode(s)||{_index:-1})._index)),x:t.map((({x:s})=>s)),y:t.map((({y:s})=>s))}}},J$=t=>(t.modules.layouts.register(ux),(e={})=>(e.useWebWorker=!1,t.modules.layouts.start(ux.name,e))),dx=(t,e)=>t-e,YA={name:"radial",imports:{minHeap:qf,bellmanFord:Vx,dijkstra:jx,johnson:fy,distance:_n,circleCircleIntersection:qx,circleSortCompare:Yx,weightedStress:y2,distanceStress:x2,constrainedStress:cy,stressMinimizationStep:gy,removeRadialOverlap:my,linear:Ef,calculateRadii:PE},configure(t,{graph:e}){let s=t.nodes;const n=s.size;function i(L,I){return L!=null&&isFinite(L)?L:I}if(t.centralNode===void 0)throw new Error('radial layout: missing parameter "centralNode"');const r=e.getNode(t.centralNode);if(r===void 0)throw new Error('radial layout: parameter "centralNode" is not valid');t.radiusRatio=i(t.radiusRatio,Math.SQRT2),t.radiusDelta=i(t.radiusDelta,0),t.nodeGap=i(t.nodeGap,10),t.repulsion=n*i(t.repulsion,1);const o=r.getPosition(),a=i(t.centerX,o.x),l=i(t.centerY,o.y),u=r._index;s.includes(r)||(s=s.concat(r.toList()));let h=s._indexes;const g=s.getAttribute("layoutable");h=h.filter(((L,I)=>g[I]||L===u)),h.sort(dx);const f=h.length,p=tq(h,e.getConnectedComponents(s,{internalIndexes:!0}),u),y=e.degrees(h),_=new Float32Array(t.xs?t.xs:e.getNodeAttribute("x").getMultiple(h)),x=new Float32Array(t.ys?t.ys:e.getNodeAttribute("y").getMultiple(h)),v=t.rs?t.rs:e.getNodeAttribute("radius").getMultiple(h),b=e.getEdges()._indexes,S=e.getEdgeAttribute("source").getMultiple(b),A=e.getEdgeAttribute("target").getMultiple(b),w=e.getAdjacencyList({internalIndexes:!0,weight:1,indexes:h});return{centerIndex:u,centerIndexPos:0,cx:a,cy:l,D:null,indexes:h,components:p,normIndexes:null,radii:null,rings:null,x:_,y:x,degree:y,size:f,attributes:{size:v,adjacency:w,weights:A.map((()=>1)),sources:S,targets:A},sortAttr:null,allowOverlap:!!t.allowOverlap,nodeGap:t.nodeGap,radiusRatio:t.radiusRatio,radiusDelta:t.radiusDelta,repulsion:t.repulsion,randomize:!("randomize"in t)||!!t.randomize,renderSteps:!!t.renderSteps,epsilon:i(t.epsilon,.001),maxSteps:i(t.maxIterations,100),iterationsPerRender:i(t.iterationsPerRender,20),step:-1,stress:Number.POSITIVE_INFINITY,prevStress:0,converged:!1,overlapRemoved:!1,done:!1}},context:()=>({data:null,gridPlacement(t,e,s=8){const n=t.length,i=new Float32Array(n),r=new Float32Array(n);let o=0;for(let f=0,p=t.length;f<p;f++){const y=e[t[f]];y>o&&(o=y)}const a=o*s,l=Math.ceil(Math.sqrt(n)),u=Math.ceil(n/l),h=-Math.floor((u-1)*a/2),g=-Math.floor((l-1)*a/2);for(let f=0;f<l;f++)for(let p=0;p<u;p++)i[f*u+p]=h+p*a,r[f*u+p]=g+f*a;return{x:i,y:r}},connectComponents(t,e,s,n,i,r){let o;function a(l,u){const h=new Uint32Array(l.length+1);return h.set(l),h[l.length]=u,h}for(let l=1;l<t.length;l++){const u=t[l];let h=0,g=0;u.forEach(((y,_)=>{const x=i.get(y);x!=null&&x>h&&(g=_,h=x)})),o=u[g];const f=e[r.get(o)];f.weights=f.weights||[],f.nodes=a(f.nodes,s),f.weights.push(n);const p=e[r.get(s)];p.weights=p.weights||[],p.nodes=a(p.nodes,o),p.weights.push(n)}},correctSubgraphsDistances(t,e,s,n,i){const r=Array.prototype.reduce.call(t[s],((a,l,u)=>(u!==s&&l<n&&l>a&&(a=l),a)),0),o=n-r-1;for(let a=1;a<e.length;a++){const l=e[a];for(let u=0,h=l.length;u<h;u++){const g=i.get(l[u]);g!=null&&(t[s][g]-=o,t[g][s]-=o)}}},initialize(t,e){t.data=e,e.step=0;const s=new Map,n=new Map;e.normIndexes=e.indexes.reduce(((u,h,g)=>(u[g]=g,s.set(h,g),n.set(h,e.degree[g]),t.data&&h===e.centerIndex&&(t.data.centerIndexPos=g),u)),new Uint32Array(e.indexes.length));const i=e.centerIndexPos,r=e.components[0].length;t.connectComponents(e.components,e.attributes.adjacency,e.centerIndex,r,n,s);const o=fy({sources:e.attributes.sources,targets:e.attributes.targets,weights:e.attributes.weights,indexes:e.indexes,adjacency:e.attributes.adjacency,undirected:!0});t.correctSubgraphsDistances(o,e.components,i,r,s),e.D=o;const a=o[i],l={};for(let u=0,h=e.normIndexes.length;u<h;u++)if(u!==i){const g=a[u];l[g]=l[g]||[],l[g].push(e.normIndexes[u])}e.rings=l,e.radii=PE(i,e.rings,e.attributes.size,e.nodeGap,e.radiusRatio,e.radiusDelta)},removeOverlaps(t,e){if(!t.data)return;const s=t.data.centerIndexPos,n=e.attributes.size,{rings:i,radii:r}=e,o=e.x[s],a=e.y[s];for(const l in i){const u=i[l];for(let h=0;h<u.length;h++){const g=u[h],f=r[l];let p=e.x[g]-o,y=e.y[g]-a;p+y===0&&(p=Math.sin(g)*Math.random()*.001,y=Math.cos(g)*Math.random()*.001);const _=Math.sqrt(p*p+y*y),x=f;if(_-x<0){const v=x/_;e.x[g]=o+p*v,e.y[g]=a+y*v}}}for(const l in i){const u=i[l],h=_n(o,a,e.x[u[0]],e.y[u[0]]);my({X:e.x,Y:e.y,sizes:n,indexes:u,center:[o,a],R:h,gap:e.nodeGap,inPlace:!0})}}}),update(t,e){t||(t=e.data);const s=t.indexes,n=t.centerIndex;let i;t.x=t.x||new Float32Array(t.size),t.y=t.y||new Float32Array(t.size),t.step===-1&&e.initialize(e,t);const r=t.repulsion,o=a=>t.radii&&t.radii[a]||1;if(t.step===0&&t.randomize&&(i=e.gridPlacement(t.indexes,t.attributes.size),t.x=i.x,t.y=i.y),!t.converged){const a=t.maxSteps,l=t.iterationsPerRender;let u=t.step;const h=Math.min(u+l,a),{D:g,x:f,y:p,size:y,centerIndexPos:_,normIndexes:x}=t;for(;u<=h&&!t.converged;){const v=Ef(Math.min(u,a)/a);t.step=u++,i=gy(g,f,p,y,_,r,v,x,o),t.x=i.x,t.y=i.y,t.prevStress=t.stress,t.stress=cy(g,f,p,y,_,r,v,x),t.converged=t.converged||Math.abs(t.stress-t.prevStress)<=t.epsilon}}if(t.converged)if(t.overlapRemoved||t.allowOverlap){t.done=!0;const a=t.rings||{};t.rings=Object.keys(a).reduce(((l,u)=>(l[u]=a[u].map((h=>s[h])),l)),{})}else e.removeOverlaps(e,t,n),t.overlapRemoved=!0;return t},isRunning:({data:t})=>!(!t||t.converged&&(t.allowOverlap||t.done))||(t&&(t.step=-1),!1),onSync(t){if(t.renderSteps||t.done)return WA(t)},onEnd:t=>WA(t)};function WA(t){const e=t.x,s=t.y,n=t.indexes.length,i=e[t.centerIndexPos]-t.cx,r=s[t.centerIndexPos]-t.cy;for(let o=0;o<n;o++)e[o]-=i,s[o]-=r;return{indexes:t.indexes,x:e,y:s}}function tq(t,e,s){const n=t.slice().sort(dx),i=[];for(let r=0,o=e.length;r<o;r++){const a=[],l=e[r];let u=!1;for(let h=0,g=l.length;h<g;h++){const f=l[h];aT(n,f)!==-1&&(f===s&&(u=!0),a.push(f))}a.length!==0&&i[u?"unshift":"push"](a.sort(dx))}return i}var eq=t=>(t.modules.layouts.register(YA),e=>{if(e.centralNode===void 0)throw new Error('concentric layout: missing parameter "centralNode"');if(e.maxIterations=e.maxIterations&&isFinite(e.maxIterations)?Math.floor(e.maxIterations):100,e.maxIterations<1)throw new RangeError("maxIterations must be a positive integer");if(e.iterationsPerRender=e.iterationsPerRender&&isFinite(e.iterationsPerRender)?Math.floor(e.iterationsPerRender):20,e.iterationsPerRender<1)throw new RangeError("iterationsPerRender must be a positive integer");if(e.epsilon=e.epsilon&&isFinite(e.epsilon)?e.epsilon:.001,e.epsilon<=0)throw new RangeError("epsilon has to be a positive number");return t.modules.layouts.start(YA.name,e)}),XA={...ux,name:"sequential"},sq=t=>(t.modules.layouts.register(XA),(e={})=>{e.useWebWorker=!1;const s={...e,evenDistribution:!0};return t.modules.layouts.start(XA.name,s)}),nq=class extends Rs{constructor(t){super(t),this.stop=()=>this._ogma.modules.layouts.stop(),this.concentric=iH(t),this.radial=eq(t),this.force=h$(t),this.forceLink=c$(t),this.hierarchical=J$(t),this.sequential=sq(t),this.grid=g$(t)}},iq=class extends Rs{constructor(){super(...arguments),this.move=t=>this._ogma.modules.virtualMouse.move(t),this.down=t=>this._ogma.modules.virtualMouse.down(t),this.up=t=>this._ogma.modules.virtualMouse.up(t),this.click=t=>this._ogma.modules.virtualMouse.click(t),this.rightClick=t=>this._ogma.modules.virtualMouse.rightClick(t),this.doubleclick=t=>this._ogma.modules.virtualMouse.doubleclick(t),this.drag=(t,e)=>this._ogma.modules.virtualMouse.drag(t,e),this.wheel=t=>this._ogma.modules.virtualMouse.wheel(t)}},rq=class extends Rs{constructor(){super(...arguments),this.map=t=>this._ogma.modules.rules.createMapping(t),this.slices=t=>this._ogma.modules.rules.createSlices(t),this.template=t=>this._ogma.modules.rules.createTemplate(t)}},oq=class extends Rs{constructor(){super(...arguments),this.watchNodeObjectProperty=t=>this._ogma.modules.watcher.watchNodeObjectProperty(t),this.watchEdgeObjectProperty=t=>this._ogma.modules.watcher.watchEdgeObjectProperty(t),this.watchNodeNonObjectProperty=t=>this._ogma.modules.watcher.watchNodeNonObjectProperty(t),this.watchEdgeNonObjectProperty=t=>this._ogma.modules.watcher.watchEdgeNonObjectProperty(t)}},aq=class{clearSelection(){return this.modules.selection.clear()}getSelectedNodes(){return this.modules.selection.getSelectedNodes()}getNonSelectedNodes(){return this.modules.selection.getNonSelectedNodes()}getSelectedEdges(){return this.modules.selection.getSelectedEdges()}getNonSelectedEdges(){return this.modules.selection.getNonSelectedEdges()}},lq=class{setOptions(t){return this.modules.settings.update(t)}getOptions(){return this.modules.settings.get()}},uq=class extends Rs{constructor(){super(...arguments),this.setNodesVisibility=t=>this._ogma.modules.graphics.setNodesVisibility(t),this.setEdgesVisibility=t=>this._ogma.modules.graphics.setEdgesVisibility(t),this.setNodeTextsVisibility=t=>this._ogma.modules.graphics.setNodeTextsVisibility(t),this.setEdgeTextsVisibility=t=>this._ogma.modules.graphics.setEdgeTextsVisibility(t),this.addRule=(t={})=>this._ogma.modules.styleRules.addRule(t),this.getRuleList=()=>this._ogma.modules.styleRules.getRuleList(),this.addNodeRule=(t,e)=>{let s,n;return e===void 0?(s=t,n=void 0):(s=e,n=t),this.addRule({nodeAttributes:s,nodeSelector:n})},this.addEdgeRule=(t,e)=>{let s,n;return e===void 0?(s=t,n=void 0):(s=e,n=t),this.addRule({edgeAttributes:s,edgeSelector:n})},this.getNodeRules=()=>this.getRuleList().filter((t=>t.getDefinition().edgeAttributes===void 0)),this.getEdgeRules=()=>this.getRuleList().filter((t=>t.getDefinition().nodeAttributes===void 0)),this.createClass=t=>this._ogma.modules.classes.createClass(t),this.getClass=t=>this._ogma.modules.classes.getClassByName(t),this.getClassList=()=>this._ogma.modules.classes.getClassList(),this.setHoveredNodeAttributes=(t,e)=>{this._ogma.modules.hover.updateNodeAttributes(t,e)},this.setHoveredEdgeAttributes=(t,e)=>{this._ogma.modules.hover.updateEdgeAttributes(t,e)},this.setHoveredEdgeExtremitiesAttributes=(t,e)=>this._ogma.modules.hover.setEdgeExtremitiesAttributes(t,!!e),this.setSelectedNodeAttributes=(t,e)=>this._ogma.modules.selection.setNodeAttributes(t,!!e),this.setSelectedEdgeAttributes=(t,e)=>this._ogma.modules.selection.setEdgeAttributes(t,!!e),this.setSelectedEdgeExtremitiesAttributes=(t,e)=>this._ogma.modules.selection.setEdgeExtremitiesAttributes(t,!!e),this.setTheme=({nodeAttributes:t,edgeAttributes:e,selectedNodeAttributes:s,selectedEdgeAttributes:n,selectedEdgeExtremitiesAttributes:i,hoveredNodeAttributes:r,hoveredEdgeAttributes:o,hoveredEdgeExtremitiesAttributes:a})=>{this._ogma.modules.pulses.setTheme(t&&t.pulse||{},e&&e.pulse||{}),this._ogma.modules.graphics.getAttributesManager().setDefaultAttributes(t||{},e||{}),this.setSelectedNodeAttributes(s||{}),this.setSelectedEdgeAttributes(n||{}),this.setHoveredNodeAttributes(r||{}),this.setHoveredEdgeAttributes(o||{}),this.setHoveredEdgeExtremitiesAttributes(a||{}),this.setSelectedEdgeExtremitiesAttributes(i||{})},this.fontSizeToBadgeScale=UL}},dq=class extends Rs{constructor(){super(...arguments),this.set=(t,e)=>this._ogma.modules.brand.set(t,e),this.remove=()=>{this._ogma.modules.brand.remove()}}},hq=class extends Rs{constructor(){super(...arguments),this.enable=t=>(this._ogma.modules.connectNodes.enable(t),this),this.disable=()=>(this._ogma.modules.connectNodes.disable(),this),this.enabled=()=>this._ogma.modules.connectNodes.enabled()}},cq=class extends Rs{constructor(){super(...arguments),this.enable=t=>(this._ogma.modules.lasso.enable(t),this),this.disable=()=>(this._ogma.modules.lasso.disable(),this),this.enabled=()=>this._ogma.modules.lasso.enabled()}},gq=class extends Rs{constructor(){super(...arguments),this.enable=t=>this._ogma.modules.legend.enable(t),this.disable=()=>this._ogma.modules.legend.disable(),this.enabled=()=>this._ogma.modules.legend.enabled(),this.getOptions=()=>this._ogma.modules.legend.getOptions(),this.export=t=>this._ogma.modules.legend.export(t)}},fq=class extends Rs{constructor(){super(...arguments),this.enable=(t={})=>{this._ogma.modules.rectangleSelect.enable(t)},this.disable=()=>{this._ogma.modules.rectangleSelect.disable()},this.enabled=()=>this._ogma.modules.rectangleSelect.enabled()}},pq=class extends Rs{constructor(){super(...arguments),this.enable=t=>{this._ogma.modules.resizing.enable(t)},this.disable=()=>{this._ogma.modules.resizing.disable()},this.enabled=()=>this._ogma.modules.resizing.enabled()}},mq=class extends Rs{constructor(){super(...arguments),this.enable=(t={})=>{this._ogma.modules.rewiring.enable(t)},this.disable=()=>{this._ogma.modules.rewiring.disable()},this.enabled=()=>this._ogma.modules.rewiring.enabled()}},_q=class extends Rs{constructor(){super(...arguments),this.enable=(t={})=>{this._ogma.modules.snapping.enable(t)},this.disable=()=>{this._ogma.modules.snapping.disable()},this.enabled=()=>this._ogma.modules.snapping.enabled()}},yq=class extends Rs{constructor(){super(...arguments),this.onNodeHover=(t,e={})=>{this._ogma.modules.tooltip.setHandler("hover.node",t,e)},this.onNodeClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.left.node",t,e)},this.onNodeRightClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.right.node",t,e)},this.onNodeDoubleClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("doubleclick.left.node",t,e)},this.onEdgeHover=(t,e={})=>{this._ogma.modules.tooltip.setHandler("hover.edge",t,e)},this.onEdgeClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.left.edge",t,e)},this.onEdgeRightClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.right.edge",t,e)},this.onEdgeDoubleClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("doubleclick.left.edge",t,e)},this.onBackgroundClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.left.background",t,e)},this.onBackgroundRightClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.right.background",t,e)},this.onBackgroundDoubleClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("doubleclick.left.background",t,e)},this.refresh=()=>this._ogma.modules.tooltip.refresh(),this.isShown=()=>this._ogma.modules.tooltip.isShown(),this.hide=()=>{this._ogma.modules.tooltip.hide()},this.show=(t,e)=>this._ogma.modules.tooltip.show(t,e)}},xq=class extends Rs{constructor(t){super(t),this.lasso=new cq(t),this.connectNodes=new hq(t),this.legend=new gq(t),this.rectangleSelect=new fq(t),this.resize=new pq(t),this.rewire=new mq(t),this.snapping=new _q(t),this.tooltip=new yq(t),this.brand=new dq(t)}},vq=class extends Rs{constructor(t){super(t),this.getList=()=>this._ogma.modules.transformations.api.getList(),this.clear=()=>this._ogma.modules.transformations.api.clear().then((()=>{})),this.getById=e=>this._ogma.modules.transformations.api.getById(e),this.afterNextUpdate=()=>this._ogma.modules.transformations.afterNextUpdate(),this.onGroupsUpdated=e=>{this._ogma.modules.transformations.onGroupsUpdated(e)},this.layoutGroups=(e,s,n=!1)=>this._ogma.modules.transformations.api.layoutGroups(e,s,n),this.triggerGroupUpdated=e=>this._ogma.modules.transformations.triggerGroupUpdated(e),this.triggerGroupsUpdated=()=>this._ogma.modules.transformations.api.triggerGroupsUpdated()}addNodeGrouping(t){return this._ogma.modules.transformations.api.addNodeGrouping(t)}addNodeClustering(t){return this._ogma.modules.transformations.api.addNodeClustering(t)}addEdgeGrouping(t){return this._ogma.modules.transformations.api.addEdgeGrouping(t)}addDrillDown(t){return this._ogma.modules.transformations.api.addDrilldown(t)}addNodeFilter(t){return this._ogma.modules.transformations.api.addNodeFilter(t)}addEdgeFilter(t){return this._ogma.modules.transformations.api.addEdgeFilter(t)}getNodeFilters(){return this._ogma.modules.transformations.getNodeFilters()}getEdgeFilters(){return this._ogma.modules.transformations.getEdgeFilters()}addNeighborGeneration(t){return this._ogma.modules.transformations.api.addNeighborGeneration(t)}addNeighborMerging(t){return this._ogma.modules.transformations.api.addNeighborMerging(t)}addNodeCollapsing(t){return this._ogma.modules.transformations.api.addNodeCollapsing(t)}addGeoClustering(t){return this._ogma.modules.transformations.api.addGeoClustering(t)}addVirtualProperties(t){return this._ogma.modules.transformations.api.addVirtualProperties(t)}getXYR(t){return this._ogma.modules.transformations.getXYR(t)}expandGroup({node:t,computeSubNodesPosition:e,onExpand:s}){return this._ogma.modules.transformations.api.fishEyeExpand(t,s,e)}collapseGroup({node:t,onCollapse:e}){return this._ogma.modules.transformations.api.fishEyeCollapse(t,e)}},bq=class extends Rs{constructor(){super(...arguments),this.setZoom=(t,e)=>this._ogma.modules.camera.setZoom(t,e),this.zoomIn=t=>this._ogma.geo.enabled()?this._ogma.modules.geo.zoomIn():this._ogma.modules.camera.zoomIn(t),this.zoomOut=t=>this._ogma.geo.enabled()?this._ogma.modules.geo.zoomOut():this._ogma.modules.camera.zoomOut(t),this.getZoom=()=>this._ogma.modules.camera.getZoom(),this.setCenter=(t,e)=>this._ogma.modules.camera.setCenter(t,e),this.move=(t,e)=>this._ogma.modules.camera.move(t,e),this.moveToBounds=(t,e)=>{if(!(t&&t instanceof ri)){if(!Fn(t)||t.length!==4)throw new Error("ogma.view.zoomToBounds requires a BoundingBox as a parameter");{const[s,n,i,r]=t;t=ri.from({minX:s,minY:n,maxX:i,maxY:r})}}return this._ogma.modules.camera.moveToBounds(t,e)},this.moveTo=(t,e)=>this._ogma.modules.camera.moveTo(t,e),this.getCenter=()=>this._ogma.modules.camera.getCenter(),this.setAngle=(t,e)=>this._ogma.modules.camera.setAngle(t,e),this.rotate=(t,e)=>this._ogma.modules.camera.rotate(t,e),this.getAngle=()=>this._ogma.modules.camera.getAngle(),this.set=(t,e)=>this._ogma.modules.camera.setView(t,e),this.get=()=>this._ogma.modules.camera.getView(),this.graphToScreenCoordinates=t=>this._ogma.modules.camera.graphToScreenCoordinates(t),this.screenToGraphCoordinates=t=>this._ogma.modules.camera.screenToGraphCoordinates(t),this.getImageData=()=>this._ogma.modules.graphics.getImageData(),this.getElementAt=t=>this._ogma.modules.captor.detectElementAt(t.x,t.y,!1,!0),this.getElementsInView=()=>{const{width:t,height:e}=this.get(),s=this.screenToGraphCoordinates({x:0,y:0}),n=this.screenToGraphCoordinates({x:t,y:e});return this._ogma.modules.spatial.query(s.x,s.y,n.x,n.y)},this.getBounds=()=>{const{width:t,height:e}=this.getSize(),s=this.screenToGraphCoordinates({x:0,y:0}),n=this.screenToGraphCoordinates({x:t,y:e});return{cx:(s.x+n.x)/2,cy:(s.y+n.y)/2,width:n.x-s.x,height:n.y-s.y,minX:s.x,minY:s.y,maxX:n.x,maxY:n.y}},this.getElementsInside=(t,e,s,n,i=!0)=>{const{spatial:r,camera:o}=this._ogma.modules;if(i){const a=o.graphToScreenCoordinates({x:t,y:e}),l=o.graphToScreenCoordinates({x:s,y:n});return r.queryProjected(a.x,a.y,l.x,l.y)}return r.queryProjected(t,e,s,n)},this.beforeNextFrame=()=>this._ogma.modules.dom.beforeNextFrame(),this.afterNextFrame=()=>this._ogma.modules.dom.afterNextFrame(),this.setFullScreen=t=>this._ogma.modules.dom.setFullScreen(t),this.isFullScreen=()=>this._ogma.modules.dom.isFullScreen(),this.forceResize=()=>this._ogma.modules.dom.forceResize(),this.getSize=()=>this._ogma.modules.dom.getDimensions(),this.setSize=t=>{if(!t||isNaN(t.width)||isNaN(t.height))throw new Error("Size must follow the format { width: number, height: number }");if(t.width<0)throw new Error("width must be positive");if(t.height<0)throw new Error("height must be positive");return this._ogma.modules.dom.setDimensions(t),Promise.resolve()},this.locateGraph=t=>this._ogma.modules.locate.locateGraph(t),this.locateRawGraph=(t,e)=>this._ogma.modules.locate.locateRawGraph(t,e),this.getGraphBoundingBox=({withTexts:t=!1}={})=>this._ogma.modules.locate.getGraphBoundingBox(t),this.animationInProgress=()=>this._ogma.modules.locate.isLocating()||this._ogma.modules.camera.animationInProgress(),this.getTextBoundingBox=t=>{if(!t)throw new Error("ogma.view.getTextBoundingBox: item must be a Node or an Edge");const e=t.getAttribute("text"),s=this._ogma.modules.labels;return e==null||e===""?null:t.isList?t.isNode?void s.getTextsBoundingBox(t):s.getTextsBoundingBox(void 0,t):t.isNode?s.getTextsBoundingBox(t.toList()):s.getTextsBoundingBox(void 0,t.toList())},this.getNodeBadgeAt=(t,e)=>{if(!t)throw new Error("ogma.view.getNodeBadgeAt: node is not defined");return IC(e,t._index,this._ogma.modules.graphics.getAttributesManager(),this._ogma.modules.camera,this._ogma.modules.graphics.getGraphicsEngine())}}},Eq=class{constructor(t,e){this._ogma=t,this.settings=new H4(t),this.events=new G4(t),this.dom=new Lz(t),this.animations=new C5(t),this.camera=new C4(t),this.graph=new Zz(t),this.data=new Mz(t),this.graphics=new F4(t),this.layers=new cj(t),this.individualAttributes=new j4(t),this.algorithms=new gj(t),this.position=new sj(t),this.touch=new m5(t),this.mouse=new f5(t),this.virtualMouse=new pG(t),this.spatial=new s5(t),this.captor=new ZG(t),this.interactions=new VG(t),this.classes=new W4(t),this.cameraInteractions=new S4(t,!!e.debug),this.hover=new ej(t),this.keyboard=new mV(t),this.selection=new x5(t),this.styleRules=new vG(t),this.legend=new JV(t),this.sync=new v5(t),this.rules=new lj(t),this.transformations=new _5(t),this.locate=new d5(t),this.drag=new KG(t),this.pulses=new A5(t),this.curvatureManager=new H5(t),this.workers=new J5(t),this.layouts=new rG(t),this.watcher=new dG(t),this.rectangleSelect=new bG(t),this.labels=new GG(t,e),this.brand=new V5(t),this.lasso=new Wk(t),this.rewiring=new JG(t),this.resizing=new tV(t),this.snapping=new mG(t),this.connectNodes=new sV(t),this.tooltip=new lV(t),this.geo=new j5(t),Object.keys(this).forEach((s=>{const n=this[s];n instanceof Ke&&(n._setModules(this),n.onMounted())})),t.onReady((()=>{Object.keys(this).forEach((s=>{const n=this[s];n instanceof Ke&&n.onReady(e)}))}))}destroy(){Object.keys(this).forEach((t=>{const e=this[t];e instanceof Ke&&e.destroy(this._ogma)}))}},Sq=1,Aq=[mj,pj,vj,CP,tH,aq,lq],hx={version:"5.3.8",commit:"aff4ac91d",buildTime:"Fri Dec 05 2025 16:07:05 GMT+0000 (Coordinated Universal Time)"},Ti,Ul=(Ti=class{constructor(e={}){this.node=s=>new yi(s,this),this.edge=s=>new Mr(s,this),this.nodeList=s=>new lo(s||new Uint32Array(0),this),this.edgeList=s=>new qa(s||new Uint32Array(0),this),this._onReady=[],this.build=hx,this._init(e)}_init(e){this._initParameters=e,this._debug=!!e.debug,this._token=Sq++,this.modules=new Eq(this,e),this.styles=new uq(this),this.algorithms=new fj(this),this.export=new S6(this),this.keyboard=new sH(this),this.generate=new Q6(this),this.layouts=new nq(this),this.parse=new eH(this),this.transformations=new vq(this),this.tools=new xq(this),this.view=new bq(this),this.mouse=new iq(this),this.events=new bj(this),this.schema=new oq(this),this.rules=new rq(this),this.geo=new J6(this),this.layers=new nH(this),this.debug=new xj(this),this._onReady.forEach((s=>s(this))),this.safelyBindToInstance(),this.modules.events.register(["destroy"]),this.build={version:"5.3.8",commit:"aff4ac91d",buildTime:"Fri Dec 05 2025 16:07:05 GMT+0000 (Coordinated Universal Time)"}}safelyBindToInstance(){for(const e of Object.getOwnPropertyNames(Ti.prototype))typeof Ti.prototype[e]=="function"&&(this[e]=this[e].bind(this))}onReady(e){this._onReady.push(e)}_destroy(){if(!this._token)throw new Error('"destroy" called twice on the same instance of Ogma');this._onReady=[],this.modules.destroy(),this.modules=null}destroy(){this.modules.events.fire("destroy",{}),this._destroy()}isDestroyed(){return!this.modules}reset(){const e=this._initParameters;this._destroy(),this._init(e)}isDebug(){return this._debug}},Ti.libraries=KT,Ti.geometry=Pk,Ti.parse=M0,Ti.build=hx,Ti.algorithms=Gx,Ti.utils=x0,Ti);Ul.algorithms=Gx,Ul.utils=x0,Ul.parse=M0,Ul.build=hx,gF(Ul,Aq);var D0=Ul,Zn=(t=>(t.NodeFilter="node-filter",t.EdgeFilter="edge-filter",t.NodeCollapsing="node-collapsing",t.VirtualProperties="virtual-properties",t.NeighborGeneration="neighbor-generation",t.NeighborMerging="neighbor-merging",t.NodeGrouping="node-grouping",t.EdgeGrouping="edge-grouping",t.NodeClustering="node-clustering",t.GeoClustering="geo-clustering",t.Unknown="unknown",t))(Zn||{}),na=class{constructor({id:t,duration:e,easing:s,ogma:n,module:i}){this.animation=s?{duration:e,easing:s}:e===void 0?0:e,this.destroyed=!1,this.id=t,this.ogma=n,this.context={},this.module=i,this.resetContext()}setOptions(t){var e;let s=typeof this.animation=="number"?this.animation:(e=this.animation)==null?void 0:e.duration,n=typeof this.animation=="object"?this.animation.easing:void 0;return typeof t.duration=="number"&&(s=t.duration),t.easing!==void 0&&(n=t.easing),this.animation=n?{duration:s,easing:n}:s===void 0?0:s,this.module.setOptions(this),this.module.afterNextUpdate()}enable(t){return this.animation=t===void 0?this.animation:t,this.module.enable(this)}disable(t){return this.animation=t===void 0?this.animation:t,this.module.disable(this)}isEnabled(){return this.module.isEnabled(this)}getId(){return this.id}whenApplied(){return this.module.afterNextUpdate().then((()=>this))}toggle(t){return this.animation=t===void 0?this.animation:t,this.isEnabled()?this.module.disable(this):this.module.enable(this)}run(t=!0){return Promise.resolve()}undo(t=!0){return Promise.resolve()}cleanup(){return this.resetContext(),Promise.resolve()}refresh(){return this.module.refreshTransformation(this),this.module.afterNextUpdate()}getIndex(){return this.module.getIndex(this)}setIndex(t){return this.module.setIndex(this,t),this.module.afterNextUpdate()}getAnimation(){return typeof this.animation=="number"?{duration:this.animation,easing:"linear"}:this.animation}getContext(){return this.context}setContent(t){this.context=t}resetContext(){this.context={}}getName(){return Zn.Unknown}destroy(t){return t!==void 0&&(this.animation=t),this.module.remove(this)}},wq=class{constructor(t){this.xs=new Map,this.ys=new Map,this.rs=new Map,this.curvatures=new Map,this.hiddenNodes=new Set,this.hiddenEdges=new Set,this.animations=[],this.before=[],this.after=[],this.applying=!1,this._onNodesRemoved=e=>{const s=e.nodes._indexes;for(const n of s)this.xs.delete(n),this.ys.delete(n),this.rs.delete(n)},this.ogma=t,this.afterMod={nodesToHide:new Set,edgesToHide:new Set},this.layer=this.ogma.modules.graphics.addAttributeLayer({name:"ogma-transformations-animations",priority:5.99999,nodeOutput:{attributes:["radius"]},edgeOutput:{attributes:["curvature"]},nodeDependencies:void 0,edgeDependencies:void 0}),this.attributeLayerData=this.layer._attributesManager._getLayerById(this.layer._id),this.initEvents()}initEvents(){this.ogma.events.on("removeNodes",this._onNodesRemoved)}apply(t){const e=Array.from(this.xs.values()),s=Array.from(this.ys.values()),n=Array.from(this.rs.values()).map((g=>({radius:g}))),i=Array.from(this.curvatures.values()).map((g=>({curvature:g}))),r=this.ogma.nodeList(Array.from(this.hiddenNodes)),o=this.ogma.edgeList(Array.from(this.hiddenEdges)),a=e.map(((g,f)=>({x:g,y:s[f]}))),l=this.ogma.nodeList(Array.from(this.xs.keys())),u=this.ogma.nodeList(Array.from(this.rs.keys())),h=this.ogma.edgeList(Array.from(this.curvatures.keys()));return this.xs.clear(),this.ys.clear(),this.rs.clear(),this.curvatures.clear(),this.hiddenNodes.clear(),this.hiddenEdges.clear(),this.before.forEach((g=>g())),this.initCurvature(h._indexes),this.applying=a.length>0||n.length>0||i.length>0,Promise.all([a.length?l.setAttributes(a,t):Promise.resolve(),n.length?this.ogma.modules.graphics.animate(u,(()=>this.layer.setAttributeValues(u,n)),!1,t):Promise.resolve(),i.length?this.ogma.modules.graphics.animate(h,(()=>this.layer.setAttributeValues(h,i)),!1,t):Promise.resolve(),...this.animations.map((g=>g()))]).then((()=>(this.ogma.nodeList(Array.from(this.afterMod.nodesToHide)).setVisible(!1),this.ogma.edgeList(Array.from(this.afterMod.edgesToHide)).setVisible(!1),Promise.all(this.after.map((g=>g())))))).then((()=>{this.deleteCurvatures(h._indexes),r.setVisible(!1),o.setVisible(!1),this.animations=[],this.before=[],this.after=[],this.afterMod.nodesToHide.clear(),this.afterMod.edgesToHide.clear(),this.applying=!1}))}setXYR(t,e,s,n){if(typeof t=="number")this.xs.set(t,e),this.ys.set(t,s),n!==void 0&&this.rs.set(t,n);else for(const i of t)this.xs.set(i,e),this.ys.set(i,s),n!==void 0&&this.rs.set(i,n)}getOpenRadius(t){return this.attributeLayerData.nodes.outputFlexArrays.radius.get(t)}getInputFlexArrays(){return this.attributeLayerData.nodes.inputFlexArrays}getCloseRadius(t){return this.attributeLayerData.nodes.inputFlexArrays.radius.get(t)}deleteOpenRadius(t){this.layer.getFlexArrays().nodes.radius.set(t,void 0)}initCurvature(t){const e=this.attributeLayerData.edges.inputFlexArrays.curvature,s=this.attributeLayerData.edges.outputFlexArrays.curvature;for(let n=0;n<t.length;n++)s.set(t[n],e.get(t[n]))}deleteCurvatures(t){const e=this.layer.getFlexArrays().edges.curvature;for(let s=0;s<t.length;s++)e.set(t[s],void 0)}hideNode(t){this.hiddenNodes.add(t)}showNode(t){this.hiddenNodes.delete(t)}hideNodes(t){for(const e of t)this.hiddenNodes.add(e)}showNodes(t){for(const e of t)this.hiddenNodes.delete(e)}hideEdge(t){this.hiddenEdges.add(t)}showEdge(t){this.hiddenEdges.delete(t)}hideEdges(t){for(const e of t)this.hiddenEdges.add(e)}showEdges(t){for(const e of t)this.hiddenEdges.delete(e)}pushBefore(t){Array.isArray(t)?this.before.push(...t):this.before.push(t)}pushAfter(t){Array.isArray(t)?this.after.push(...t):this.after.push(t)}setXY(t,e,s){this.xs.set(t,e),this.ys.set(t,s)}getXYR(t){const e=this.xs,s=this.ys,n=this.rs,i=t.getAttributes(["x","y","radius"]);for(let r=0;r<t.size;r++){const o=t._indexes[r];e.has(o)&&(i[r].x=e.get(o)),s.has(o)&&(i[r].y=s.get(o)),n.has(o)&&(i[r].radius=n.get(o))}return i}getXs(t){return this.getMapValues(t,"x",this.xs)}getYs(t){return this.getMapValues(t,"y",this.ys)}getRs(t){return this.getMapValues(t,"radius",this.rs)}getMapValues(t,e,s){const n=this.ogma.modules.graphics.getAttributesManager()._layerController.nodes._currentFlexArrays[e],i=new Array(t.size);for(let r=0;r<t.size;r++){const o=t._indexes[r];s.has(o)?i[r]=s.get(o):i[r]=n.get(o)}return i}setR(t,e){this.rs.set(t,e)}setRs(t,e){for(let s=0;s<t.length;s++)e[s]!==void 0&&this.rs.set(t[s],e[s])}setCurvatures(t,e){for(let s=0;s<t.length;s++)this.curvatures.set(t[s],e[s])}setCurvature(t,e){this.curvatures.set(t,e)}hideNodesAfter(t){for(let e=0;e<t.length;e++)this.afterMod.nodesToHide.add(t[e])}hideEdgesAfter(t){for(let e=0;e<t.length;e++)this.afterMod.edgesToHide.add(t[e])}setOpenRadius(t,e){this.attributeLayerData.nodes.outputFlexArrays.radius.set(t,e)}push(t){Array.isArray(t)?this.animations.push(...t):this.animations.push(t)}getMaxAnimation(t,e){return(typeof t=="number"?t:t.duration)>(typeof e=="number"?e:e.duration)?t:e}isApplying(){return this.applying}};function Ia(t,e,s){const n=typeof e=="string"?e.split("."):e;for(let i=0;i<n.length-1;++i){const r=n[i];let o=t[r];o||(o={},t[r]=o),t=o}t[n[n.length-1]]=s}function Tq(t){let e=0,s=0;const n=t.length;if(n===0)throw new Error("Ogma transformations: Compute centroid: at least one point is required");for(let i=0;i<n;++i){const r=t[i];e+=r.x,s+=r.y}return e/=n,s/=n,{x:e,y:s}}function Cq(t,e){const s=t.get(0);return{data:s.getData(),attributes:s.getAttributes(e)}}function Lf(t,e){return`gen_grp_${e}_${t}`}function Lq(t){return t.map((({id:e,source:s,target:n})=>({id:e,source:s,target:n})))}function kq(t,e,s,n){let i=e,r=s;return!n&&i.toString()>r.toString()&&(i=s,r=e),`${t}[${i}-${r}]`}function Nq(t){if(t===void 0)return Math.round(Math.random()*Number.MAX_SAFE_INTEGER);if(typeof t!="string"&&(typeof t!="number"||!isFinite(t)))throw new Error(`Ogma transformation: ${t} is not a valid id, expected string or number`);return t}function Lg(t){return`data.${t}`}var Mq=class{constructor(t){this.groupsByDepth=new Map,this.treeMap=new Map,this.dataMap=new Map,this.invalidEdges=new Map,this.edges=new Map,this.ogma=t.ogma,this.module=t.module,this.enabled=t.enabled===void 0||t.enabled,this.onGetSubgraph=t.onGetSubgraph,this.duration=t.duration||0,this.easing=t.easing||"quadraticOut",this.parentPath=t.parentPath||"parent",this.depthPath=t.depthPath||"depth",this.padding=t.padding||0,this.nodeGenerator=t.nodeGenerator||(()=>({})),this.showContents=t.showContents===void 0||t.showContents,this.onGroupUpdate=t.onGroupUpdate||(()=>{}),this.copyData=t.copyData===void 0||t.copyData,this.context={virtualEdges:this.ogma.edgeList()}}createGrouping(t){var e;const{ogma:s,groupsByDepth:n}=this,i=s.transformations.addNodeGrouping({selector:o=>o.getData(this.depthPath)===t,groupIdFunction:o=>o.getData(this.parentPath),showContents:o=>typeof this.showContents=="boolean"?this.showContents:this.showContents(o,t),onBeforeAddMetaEdges:(o,a)=>this.addEdges(o,a),onGroupUpdate:(o,a,l)=>this.onGroupUpdate(o,a,l,t),padding:o=>typeof this.padding=="number"?this.padding:this.padding(o,t),duration:this.duration,enabled:this.enabled,nodeGenerator:(o,a)=>{const l=this.nodeGenerator(o,a,i);return this.copyData&&(l.data||(l.data={}),l.data={...l.data,...this.dataMap.get(a)}),Ia(l,Lg(this.parentPath),this.treeMap.get(a)),Ia(l,Lg(this.depthPath),t-1),l.id=a,l}});if(!n.size)return n.set(t,i);const r=Array.from(n.keys()).reduce(((o,a)=>Math.max(o,a)));n.set(t,i),i.setIndex((e=n.get(r))==null?void 0:e.getIndex())}async drill(t){if(this.treeMap.has(t.getId()))return;const{ogma:e,groupsByDepth:s}=this;try{e.modules.graphics.pauseRendering();const n=t.getId(),i=this.getGroupId(n);this.treeMap.set(i,t.getData(this.parentPath)),this.dataMap.set(i,t.getData());const r=t.getData(this.depthPath)||0,o=t.getPosition(),a=await this.onGetSubgraph(t);this.edges.set(i,t.getAdjacentEdges().map((u=>{const h=u.getSource().getId(),g=u.getTarget().getId();return{source:h===n?i:h,target:g===n?i:g,data:{...u.getData()}}}))),a.nodes.forEach((u=>{Ia(u,Lg(this.parentPath),i),Ia(u,Lg(this.depthPath),r+1),u.attributes||(u.attributes={}),u.attributes.x=o.x,u.attributes.y=o.y})),this.module.pause(),e.removeEdges(t.getAdjacentEdges()),e.removeNode(t),await e.view.afterNextFrame(),await e.addNodes(a.nodes);const l=a.edges.filter((u=>{const h=u.source,g=u.target;if(e.getNode(h)&&e.getNode(g))return!0;const f=e.getNode(h)?g:h;return this.invalidEdges.has(f)?this.invalidEdges.get(f).push(u):this.invalidEdges.set(f,[u]),!1}));a.nodes.forEach((u=>{if(!this.invalidEdges.has(u.id))return;const{valid:h,invalid:g}=this.invalidEdges.get(u.id).reduce(((f,p)=>(e.getNode(p.source)&&e.getNode(p.target)?f.valid.push(p):f.invalid.push(p),f)),{valid:[],invalid:[]});e.addEdges(h),g.length?this.invalidEdges.set(u.id,g):this.invalidEdges.delete(u.id)})),await e.addEdges(l),s.has(r+1)||this.createGrouping(r+1),this.module.resume(),e.modules.graphics.resumeRendering(),await this.module.afterNextUpdate()}catch(n){throw e.modules.graphics.resumeRendering(),n}}async addEdges(t,e){e.forEach((s=>{const n=this.edges.get(s.getId());n&&this.ogma.addEdges(n,{virtual:!0}).then((i=>{this.context.virtualEdges=this.context.virtualEdges.concat(i)}))}))}getGroupId(t){return`ogma-group-${t}`}getMaxDepth(){return this.groupsByDepth.size}disable(t){return this.enabled=!1,this.duration=typeof t=="number"?t:this.duration,this.easing=typeof t=="object"?t.easing:this.easing,this.groupsByDepth.forEach((e=>e.disable(t))),this.module.animations.hideEdges(this.context.virtualEdges._indexes),this.context.virtualEdges.setSelected(!0),this.module.afterNextUpdate()}enable(t){return this.enabled=!0,this.duration=typeof t=="number"?t:this.duration,this.easing=typeof t=="object"?t.easing:this.easing,this.groupsByDepth.forEach((e=>e.enable(t))),this.module.animations.showEdges(this.context.virtualEdges._indexes),this.module.afterNextUpdate().then((()=>this.context.virtualEdges.setVisible(!0)))}toggle(t){return this.enabled?this.disable(t):this.enable(t)}setOptions(t){this.onGetSubgraph=t.onGetSubgraph?t.onGetSubgraph:this.onGetSubgraph,this.duration=t.duration!==void 0?t.duration:this.duration,this.easing=t.easing||this.easing,this.parentPath=t.parentPath||this.parentPath,this.depthPath=t.depthPath||this.depthPath,this.padding=t.padding!==void 0?t.padding:this.padding,this.nodeGenerator=t.nodeGenerator||this.nodeGenerator,this.showContents=t.showContents!==void 0?t.showContents:this.showContents,this.onGroupUpdate=t.onGroupUpdate||this.onGroupUpdate,this.copyData=t.copyData!==void 0?t.copyData:this.copyData;const e=this.enabled;return this.enabled=t.enabled!==void 0?t.enabled:this.enabled,this.enabled!==e&&this.groupsByDepth.forEach((s=>this.enabled?s.enable({duration:this.duration,easing:this.easing}):s.disable({duration:this.duration,easing:this.easing}))),this.groupsByDepth.forEach((s=>s.refresh())),this.module.afterNextUpdate()}onRemove(t){this.context.virtualEdges=this.context.virtualEdges.filter((e=>!t.has(e._index)))}},Iq=class{constructor(t){this.drilldowns=[],this.module=t}addDrilldown(t){this.drilldowns.push(t)}removeDrilldown(t){this.drilldowns=this.drilldowns.filter((e=>e!==t))}onRemove(t,e){e||this.drilldowns.forEach((s=>s.onRemove(t)))}},FN=2;function Rq(t){return typeof t.then=="function"}var Fq=class{constructor(t,e){this.relayouted=new Set,this.shouldRelayout=new Set,this.layoutPerGroup=new Map,this.nextLayout=new Map,this.nextOnGroupUpdate=null,this.onGroupsUpdate=()=>null,this._onLayoutPrepare=s=>{if(!s.params.nodes)return;const n=s.params.nodes,i=Array.isArray(n)?this.ogma.getNode(n[0])._index:n._indexes[0],r=this.module.nodeToMeta.get(i);if(!r)return;const o={...s,params:{...s.params}};delete o.params.nodes,delete o.params.groups,this.layoutPerGroup.set(r._index,o)},this.ogma=t,this.module=e,this.ogma.events.on("layoutPrepare",this._onLayoutPrepare)}getNodesToRecompute(t){const e=Array.from(t),s=new Set,n=[];for(;e.length>0;){const i=e.shift();if(s.has(i))continue;n.push(i),s.add(i);const r=this.module.nodeToMeta.get(i);r&&e.push(r._index)}return this.ogma.nodeList(n)}getLayoutFunction(t,e,s,n){const i=this.getNextLayout(e._index),r=this.ogma.modules.graphics.getAttributesManager()._layerController.nodes._currentFlexArrays,o={x:r.x.get(e._index),y:r.y.get(e._index)};return()=>{const a=i?i(e,s,n):t(e,s,n);return this._runLayout(a,s,o)}}_runLayout(t,e,s){let n;if(!t)return Promise.resolve(null);if(Rq(t))n=t;else{if(!t)return;{const o=this.module.animations.getXs(e),a=this.module.animations.getYs(e),l=this.module.animations.getRs(e);n=this.ogma.layouts[t.layout]({...t.params,nodes:e,dryRun:!0,xs:o,ys:a,rs:l}).then((u=>u.positions.current))}}const i=this.module.animations,r=e._indexes;return n.then((o=>{if(!o)throw new Error("Ogma tansformations, onGroupUpdated callback should return either a layout or a promise containing  positions");let a=0,l=0;if(s){let u=-1/0,h=-1/0,g=1/0,f=1/0;for(let p=0;p<r.length;p++){const y=o[p];y&&(u=Math.max(u,y.x),h=Math.max(h,y.y),g=Math.min(g,y.x),f=Math.min(f,y.y))}a=s.x-(u+g)/2,l=s.y-(h+f)/2}for(let u=0;u<r.length;u++){const h=o[u];h&&(i.xs.set(r[u],h.x+a),i.ys.set(r[u],h.y+l))}}))}handleLayoutFunctions(t){const e=!!this.ogma.modules.layouts.enableBatching;e&&this.ogma.modules.layouts.enableBatching();const s=t.map((i=>i())),n=e?this.ogma.modules.layouts.runBatch():Promise.resolve();return Promise.all(s).then((()=>n))}async handleGlobalLayout(t,e){const s=this.getNextOnGroupUpdate(),n=s?s(t,e):this.onGroupsUpdate(t,e);await this._runLayout(n,t)}async layoutGroups(t,e,s=!1){const n=new Map,i=this.ogma.getNodes(t.map((({groupId:a})=>a)));t.forEach(((a,l)=>{n.set(a.groupId,(()=>this._runLayout(a,this.module.metaToNodes.get(i.get(l)._index))))}));const r=this.getNodesToRecompute(i._indexes),o=new Map;r.forEach((a=>o.set(a._index,this.module.nodeToTransformation.get(a._index).getIndex()))),r.sort(((a,l)=>o.get(a._index)-o.get(l._index)));for(let a=0;a<r.size;a++){const l=o.get(r._indexes[a]);let u;for(u=a+1;u<r.size&&o.get(r._indexes[u])===l;u++);const h=r.slice(a,u);a=u-1,await Promise.all(h.map((g=>{this.relayouted.add(g._index);let f=Promise.resolve();if(n.has(g.getId()))f=n.get(g.getId())();else if(s&&this.layoutPerGroup.has(g._index)){const p=this.module.metaToNodes.get(g._index),y=this.layoutPerGroup.get(g._index);f=this.ogma.layouts[y.name]({...y.params,nodes:p})}return f.then((()=>{this.module.groupController.setGroupXYR(g)}))})))}return await this.module.groupController.onAfterLayouts(),this.module.animations.apply(e||0).finally((()=>{this.relayouted.clear()}))}setNextLayout(t,e){this.nextLayout.set(t,e)}getNextLayout(t){const e=this.nextLayout.get(t);return this.nextLayout.delete(t),e}setNextOnGroupUpdate(t){this.nextOnGroupUpdate=t}getNextOnGroupUpdate(){const t=this.nextOnGroupUpdate;return this.nextOnGroupUpdate=null,t}hasRelayouted(t){return this.relayouted.has(t)}clear(){this.relayouted.clear(),this.shouldRelayout.clear()}},kg=14,Pq=class{constructor(t,e){this.subNodeOffsetX=new Map,this.subNodeOffsetY=new Map,this.openRadius=new Map,this.isExpanding=new Set,this.alreadyGrouped=new Set,this.openGroups=new Set,this.closeGroups=new Set,this.fadedGroups=new Set,this.nodeGroupinCount=0,this.destroyed=!1,this.nodeLayer=new Map,this.edgeLayer=new Map,this.savedNodeLayer=new Map,this.savedEdgeLayer=new Map,this.padding=new Map,this.geoRadius=new Map,this.collapsedGroups=new Set,this.hasUpdated=new Set,this.shouldRunGroupUpdate=!1,this.runningLayouts=!1,this.onSetMultipleAttributes=({elements:n,values:i,options:r,updatedAttributes:o,promises:a})=>{if(this.module.isRefreshing()||this.destroyed||this.runningLayouts||this.module.animations.isApplying())return;const l=new Set(o),u=i;if(!n.isNode||!l.has("x")&&!l.has("y")&&!l.has("radius"))return Promise.resolve();const h=n.toList();if(!h.size)return Promise.resolve();const g=[],f=new Set,p=Array.from(h._indexes);for(;p.length;){const _=p.shift(),x=this.module.nodeToMeta.get(_);if(!x||f.has(x._index))continue;const v=this.getGroupXYR(x,this.module.getSubNodes(x),h,u);v.isGeo?g.push(x.setAttribute("radius",v.radius,r)):(delete v.isGeo,this.closeGroups.has(x._index)||this.collapsedGroups.has(x._index)?(this.openRadius.set(x._index,v.radius),this.module.animations.setXY(x._index,v.x,v.y)):this.module.animations.setXYR(x._index,v.x,v.y,v.radius),f.add(x._index)),p.push(x._index)}const y=h.map(((_,x)=>{if(!this.openGroups.has(_._index))return null;const v=_.getPosition();return Array.isArray(u)&&u[x]?(u[x].x!==void 0&&(v.x=u[x].x),u[x].y!==void 0&&(v.y=u[x].y)):(u.x!==void 0&&(v.x=u.x),u.y!==void 0&&(v.y=u.y)),{group:_,position:v}})).filter((_=>_));y.length&&y.forEach((({group:_,position:x})=>this.animateChildren(_,x))),(f.size>0||y.length)&&g.push(this.module.animations.apply(r)),a.push(...g)},this.ogma=t,this.layoutController=new Fq(t,e),this.groupLayer=this.ogma.modules.graphics.addAttributeLayer({name:"groups-layer",priority:5.98,edgeAttributes:{layer:n=>this.edgeLayer.get(n._index)},nodeAttributes:{layer:n=>this.nodeLayer.get(n._index)},nodeDependencies:void 0,edgeDependencies:void 0});const s=t.styles.getClass("_group-fading_");this.fadingClass=s||this.ogma.styles.createClass({name:"_group-fading_",nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0}}),this.module=e,t.events.on("setMultipleAttributes",this.onSetMultipleAttributes).on("beforeGeoCameraMove",(({zoom:n})=>{const i=this.ogma.nodeList(Array.from(this.geoRadius.keys())).filter((r=>r&&!this.collapsedGroups.has(r._index)&&this.openGroups.has(r._index)));i.forEach((r=>{const o=this.geoRadius.get(r._index)*2**n;this.module.animations.setOpenRadius(r._index,o)})),this.ogma.modules.geo._projection&&this.ogma.modules.geo._projection.updateElements(i)})).on(["geoEnabled","beforeGeoDisabled"],(()=>this._onToggleGeo())).on("geoNodesMoved",(({nodes:n})=>{const i=n._indexes;for(let r=0;r<i.length;r++){const o=this.module.getMetaNode(n.get(r));!o||!this.openGroups.has(o._index)||this.layoutController.shouldRelayout.add(o._index)}}))}setSubEltsLayer(t,e,s){const n=s?FN:-2;if(!this.isOpen(t))return;const i=this.module.getSubNodes(t);i.forEach((o=>{this.nodeLayer.set(o._index,e+n),this.setSubEltsLayer(o,e+n,s)}));const r=i.getAdjacentEdges({bothExtremities:!0});for(let o=0;o<r.size;o++)this.edgeLayer.set(r._indexes[o],e+n)}setNodeGroupingCount(t){this.nodeGroupinCount=t}getNodeGroupingCount(){return this.nodeGroupinCount}updateGroupLayer(t,e){this.groupLayer.updateElements(t||this.ogma.getNodes()),this.groupLayer.updateElements(e||this.ogma.getEdges())}closeGroup(t,e,s,n,i=!1){const r=[e],o=this.closeGroups.has(t._index)||this.collapsedGroups.has(t._index);this.openGroups.delete(t._index),this.closeGroups.add(t._index),i?this.fadedGroups.add(t._index):this.fadedGroups.delete(t._index),this.hasUpdated.add(t._index);const a=this.module.animations,l=i?0:a.getCloseRadius(t._index),u=a.getOpenRadius(t._index);if(u!==void 0&&!o&&this.openRadius.set(t._index,u),a.setXYR(t._index,s,n,l),i)return;for(;r.length;){const g=r.shift(),f=g._indexes,p=g.getAdjacentEdges({bothExtremities:!0}),y=new Set;for(let x=0;x<p._indexes.length;x++)y.add(p._indexes[x]);const _=g.getAdjacentEdges({bothExtremities:!1}).filter((x=>!y.has(x._index)));a.setXYR(f,s,n,l),a.hideNodesAfter(f),a.hideEdgesAfter(p._indexes),a.hideEdgesAfter(_._indexes),a.pushAfter((()=>{const x=[];a.deleteOpenRadius(t._index);for(let v=0;v<f.length;v++){const b=this.closeGroups.has(f[v]);x.push(b?l:this.openRadius.get(f[v]))}this.module.animations.setRs(g._indexes,x)}));for(let x=0;x<f.length;x++){if(!this.openGroups.has(f[x]))continue;const v=g.get(x);this.collapsedGroups.add(v._index);const b=this.module.getSubNodes(g.get(x));b.size&&r.push(b)}}const h=this.module.getMetaNode(t);h&&this.openGroups.has(h._index)&&this.layoutController.shouldRelayout.add(h._index)}setGroupXYR(t){const e=this.getGroupXYR(t,this.module.getSubNodes(t),void 0,void 0);e.isGeo?(this.setGeoLatLng(t,e.y,e.x),this.module.animations.setR(t._index,e.radius)):this.module.animations.setXYR(t._index,e.x,e.y,e.radius)}setGeoLatLng(t,e,s){this.ogma.modules.data.setProperty(t,this.ogma.modules.geo.latitudePath,e,{virtual:!0}),this.ogma.modules.data.setProperty(t,this.ogma.modules.geo.longitudePath,s,{virtual:!0})}expandGroup(t,e,s=!1){const n=this.module.animations,i=t.getPosition(),r=this.fadedGroups.has(t._index);s?this.fadedGroups.add(t._index):(this.fadedGroups.delete(t._index),this.openGroups.add(t._index),this.closeGroups.delete(t._index),this.collapsedGroups.delete(t._index)),this.isExpanding.add(t._index),this.hasUpdated.add(t._index);const o=[{subNodes:e,offset:this.getOffset(t._index),isClosed:!1,wasCollapsed:!r}];for(;o.length;){const{subNodes:l,offset:u,isClosed:h,wasCollapsed:g}=o.shift();if((h||g)&&n.pushBefore((()=>l.setAttributes(i,0))),h)continue;const f=l._indexes,p=l.getAdjacentEdges({bothExtremities:!0,filter:"all"});l.setVisible(!0),p.setVisible(!0);for(let y=0;y<f.length;y++){const _=this.closeGroups.has(f[y]);n.setXYR(f[y],i.x+u.x+this.subNodeOffsetX.get(f[y])||0,i.y+u.y+this.subNodeOffsetY.get(f[y])||0,_?this.module.animations.getCloseRadius(f[y]):this.openRadius.get(f[y])),this.collapsedGroups.delete(f[y]);const x=this.module.getSubNodes(l.get(y));x.size&&o.push({subNodes:x,isClosed:_,wasCollapsed:g||this.collapsedGroups.has(f[y]),offset:{x:u.x+this.subNodeOffsetX.get(f[y])||0,y:u.y+this.subNodeOffsetY.get(f[y])||0}})}}const a=this.module.getMetaNode(t);a&&this.openGroups.has(a._index)&&this.layoutController.shouldRelayout.add(a._index),n.setXYR(t._index,i.x,i.y,s?0:this.openRadius.get(t._index))}getOffset(t){return this.collapsedGroups.has(t)&&this.subNodeOffsetX.has(t)?{x:this.subNodeOffsetX.get(t),y:this.subNodeOffsetY.get(t)}:{x:0,y:0}}restorePositions(t,e){const s=t.getPosition(),n=(e=e.filter((o=>!o.isVirtual())))._indexes,i=this.getOffset(t._index),r=[];for(let o=0;o<n.length;o++)r.push({x:i.x+s.x+this.subNodeOffsetX.get(n[o])||0,y:i.x+s.y+this.subNodeOffsetY.get(n[o])||0});e.setAttributes(r,0)}animateChildren(t,e){const s=[{parent:t,position:e}];for(;s.length;){const{parent:n,position:i}=s.shift();if(!n.isNode)continue;const r=this.module.getSubNodes(n);r.size&&r.forEach((o=>{const a=this.subNodeOffsetX.get(o._index)||0,l=this.subNodeOffsetY.get(o._index)||0,u={x:i.x+a,y:i.y+l};this.module.animations.setXY(o._index,u.x,u.y),s.push({parent:o,position:u})}))}}addOpenGroup(t){this.openGroups.add(t._index),this.closeGroups.delete(t._index)}isOpen(t){return this.openGroups.has(t._index)}isClose(t){return this.closeGroups.has(t._index)}setPadding(t,e){const s=new Set,n=isNaN(+e),i=e;return t.forEach((r=>{const o=n?i(r):+e;this.padding.get(r._index)!==o&&s.add(r._index),this.padding.set(r._index,o)})),s}getGroupXYR(t,e,s,n){let i,r,o;const a=this.module.animations,l=this.ogma.geo.enabled();if(i=new Array(e.size).fill(0),r=new Array(e.size).fill(0),o=new Array(e.size).fill(0),l){const y=e.getData(this.ogma.modules.geo.latitudePath),_=e.getData(this.ogma.modules.geo.longitudePath);i=[],r=[],o=[];for(let x=0;x<y.length;x++){const{x:v,y:b}=this.ogma.geo.getMap().project({lat:y[x],lng:_[x]},kg);i.push(v),r.push(b),o.push(2**kg*this.geoRadius.get(e._indexes[x])||10)}}else{const y=this.ogma.modules.graphics.getAttributesManager()._layerController.nodes._currentFlexArrays,_=this.openGroups.has(t._index),x=this.isExpanding.has(t._index),v=_&&!x?y.radius:a.getInputFlexArrays().radius;for(let b=0;b<e.size;b++)i[b]=y.x.get(e._indexes[b]),r[b]=y.y.get(e._indexes[b]),o[b]=v.get(e._indexes[b])}if(s&&n&&s.isNode){const y=s._indexes,_=new Map,x=new Map,v=new Map;for(let S=0;S<y.length;S++){const A=Array.isArray(n)?n[S]:n;!isNaN(A.x)&&_.set(y[S],A.x),!isNaN(A.y)&&x.set(y[S],A.y),!isNaN(A.radius)&&v.set(y[S],A.radius)}const b=e._indexes;for(let S=0;S<b.length;S++)_.has(b[S])&&(i[S]=_.get(b[S])),x.has(b[S])&&(r[S]=x.get(b[S])),v.has(b[S])&&(o[S]=v.get(b[S]))}const u=e._indexes;for(let y=0;y<u.length;y++)!this.closeGroups.has(u[y])&&!this.collapsedGroups.has(u[y])&&this.openRadius.has(u[y])&&(o[y]=this.openRadius.get(u[y]));if(!l)for(let y=0;y<u.length;y++)a.xs.get(u[y])!==void 0&&(i[y]=a.xs.get(u[y])),a.ys.get(u[y])!==void 0&&(r[y]=a.ys.get(u[y])),a.rs.get(u[y])!==void 0&&(o[y]=a.rs.get(u[y]));let h=0,g=0,f=0;const p=D0.algorithms.minDisk(i,r,o);if(h=p[0],g=p[1],f=p[2],f+=this.padding.get(t._index)||0,l){const{lat:y,lng:_}=this.ogma.geo.getMap().unproject({x:h,y:g},kg);h=_,g=y,f/=2**kg,this.geoRadius.set(t._index,f),f*=2**this.ogma.geo.getZoom()}else this.openRadius.set(t._index,f),e.forEach(((y,_)=>{this.subNodeOffsetX.set(y._index,i[_]-h),this.subNodeOffsetY.set(y._index,r[_]-g)}));return{x:h,y:g,radius:f,isGeo:l}}async onAfterLayouts(){const t=this.module.animations,e=this.module.getList().filter((r=>r.getName()===Zn.NodeGrouping&&r.isEnabled())),s=[];let n=!1;for(let r=e.length-1;r>=0;r--)e[r].getContext().metaNodes.forEach((o=>{if(o.getMetaNode())return;n||(n=this.hasUpdated.has(o._index)||this.layoutController.relayouted.has(o._index)||this.layoutController.shouldRelayout.has(o._index));const a=!this.collapsedGroups.has(o._index)&&!this.closeGroups.has(o._index);s.push({group:o,collapsed:!a})}));if(n||this.shouldRunGroupUpdate){this.shouldRunGroupUpdate=!1;const r=this.ogma.getNodes().filter((a=>{const l=this.module.getMetaNode(a);return!l||!this.module.nodeToTransformation.get(l._index).isEnabled()})),o=new Array(r.size);for(let a=0;a<r.size;a++)o[a]=this.openRadius.get(r._indexes[a])||this.module.animations.getCloseRadius(r._indexes[a])||0;await this.layoutController.handleGlobalLayout(r,o)}const i=new Set;for(;s.length;){const{group:r,collapsed:o}=s.shift();if(i.has(r._index))continue;i.add(r._index);const a=this.module.getSubNodes(r),l=a._indexes,u=t.xs.get(r._index),h=t.ys.get(r._index);if(u!==void 0&&h!==void 0){if(o){t.deleteOpenRadius(r._index);for(let g=0;g<l.length;g++)t.setXY(l[g],u,h)}else for(let g=0;g<l.length;g++)t.setXY(l[g],u+this.subNodeOffsetX.get(l[g])||0,h+this.subNodeOffsetY.get(l[g])||0);for(let g=0;g<l.length;g++)this.module.isVirtual(l[g],!0)&&s.push({group:a.get(g),collapsed:this.collapsedGroups.has(l[g])||this.closeGroups.has(l[g])||o})}}this.hasUpdated.clear(),this.layoutController.clear(),this.isExpanding.clear()}cleanup(t,e,s){let n=t._indexes;for(let i=0;i<n.length;i++)this.padding.delete(n[i]),this.openGroups.delete(n[i]),this.closeGroups.delete(n[i]),this.nodeLayer.delete(n[i]),this.savedNodeLayer.delete(n[i]),this.savedEdgeLayer.delete(n[i]);for(let i=0;i<e.size;i++)this.edgeLayer.delete(e._indexes[i]);if(s){n=s._indexes;for(let i=0;i<n.length;i++)this.subNodeOffsetX.delete(n[i]),this.subNodeOffsetY.delete(n[i])}}getPositions(t,e){const{x:s,y:n}=t.getPosition();return e.map((i=>({x:s+(this.subNodeOffsetX.get(i._index)||0),y:n+(this.subNodeOffsetY.get(i._index)||0)})))}hideSubNodes(t){const e=[t];for(;e.length;){const s=e.pop();s.setVisible(!1);for(let n=0;n<s._indexes.length;n++)this.collapsedGroups.add(s._indexes[n]),this.openGroups.has(s._indexes[n])&&e.push(this.module.getSubNodes(s.get(n)))}}onRemove(t,e){if(!e)return;const s=[],n=new Set;for(let i=0;i<t.length;i++){const r=this.module.nodeToMeta.get(t[i]);if(!r)continue;const o=r._index;this.openRadius.delete(o),this.isExpanding.delete(o),this.alreadyGrouped.delete(o),this.collapsedGroups.delete(o),this.closeGroups.delete(o),this.openGroups.delete(o),this.padding.delete(o),this.geoRadius.delete(o),this.hasUpdated.delete(o),this.subNodeOffsetX.delete(o),this.subNodeOffsetY.delete(o),this.nodeLayer.delete(o),this.edgeLayer.delete(o),this.savedNodeLayer.delete(o),this.savedEdgeLayer.delete(o),this.openGroups.has(o)&&(this.layoutController.shouldRelayout.add(o),s.push(o))}for(;s.length;){const i=s.shift();if(n.has(i))continue;n.add(i);const r=this.module.nodeToMeta.get(i);r&&this.openGroups.has(r._index)&&(this.layoutController.shouldRelayout.add(r._index),s.push(r._index))}}async fishEyeExpand(t,e,s){if(!t.isVirtual())throw new Error("Focus node is not virtual.");const n=this.module.nodeToMeta.get(t._index);if(n&&n.isVisible())throw new Error("Focus node is not at top level.");const i=this.module.animations,r=this.ogma,o=i.getCloseRadius(t._index);s&&(this.layoutController.setNextLayout(t._index,s),this.layoutController.shouldRelayout.add(t._index)),this.layoutController.setNextOnGroupUpdate((async a=>{const l=i.getXYR(t.toList())[0].radius-o,u=i.getXYR(a);return await r.algorithms.fishEyeExpand({nodes:a,focusNode:t,dryRun:!0,deltaRadius:l,xyr:u})})),await e(),await this.module.afterNextUpdate()}setNodeLayer(t,e){this.nodeLayer.set(t,e),this.savedNodeLayer.set(t,e)}setEdgeLayer(t,e){this.edgeLayer.set(t,e),this.savedEdgeLayer.set(t,e)}async fishEyeCollapse(t,e){if(!t.isVirtual())throw new Error("Focus node is not virtual.");const s=this.module.nodeToMeta.get(t._index);if(s&&s.isVisible())throw new Error("Focus node is not at top level.");const n=this.module.animations,i=this.ogma,r=t.getAttribute("radius");this.layoutController.setNextOnGroupUpdate((async o=>{const a=n.getXYR(t.toList())[0].radius-r,l=n.getXYR(o);return await i.algorithms.fishEyeExpand({nodes:o,focusNode:t,dryRun:!0,deltaRadius:a,xyr:l})})),await e(),await this.module.afterNextUpdate()}triggerGroupsUpdate(){this.shouldRunGroupUpdate=!0}layoutGroups(t,e,s=!1){return this.runningLayouts=!0,this.layoutController.layoutGroups(t,e,s).finally((()=>{this.runningLayouts=!1}))}_onToggleGeo(){this.geoRadius.clear();const t=this.module.getList().find((s=>s.getName()===Zn.NodeGrouping));if(!t)return;const e=Array.from(this.openGroups.keys());for(let s=0;s<e.length;s++)this.layoutController.shouldRelayout.add(e[s]);t.refresh()}startRefresh(){this.alreadyGrouped.clear()}clear(){this.subNodeOffsetX.clear(),this.subNodeOffsetY.clear(),this.openRadius.clear(),this.isExpanding.clear(),this.layoutController.clear(),this.alreadyGrouped.clear(),this.openGroups.clear(),this.closeGroups.clear(),this.nodeLayer.clear(),this.edgeLayer.clear(),this.padding.clear(),this.geoRadius.clear(),this.collapsedGroups.clear(),this.hasUpdated.clear()}destroy(){this.destroyed||(this.destroyed=!0,this.ogma.events.off(this.onSetMultipleAttributes))}},zq=class{constructor(t){this.ogma=t}save(){this.selectedNodes=this.ogma.getSelectedNodes(),this.selectedEdges=this.ogma.getSelectedEdges(),this.ogma.modules.selection.disableEvents()}restore(){const t=this.selectedNodes.filter((i=>!this.ogma.getNode(i.getId()))),e=this.selectedEdges.filter((i=>!this.ogma.getEdge(i.getId()))),s=new Set,n=new Set;if(t.size){this.ogma.modules.events.fire("nodesUnselected",{nodes:t});for(let i=0;i<t.size;i++)s.add(t._indexes[i])}if(e.size){this.ogma.modules.events.fire("edgesUnselected",{edges:e});for(let i=0;i<e.size;i++)n.add(e._indexes[i])}this.selectedNodes.filter((i=>!i.isSelected()&&!s.has(i._index))).setSelected(!0),this.selectedEdges.filter((i=>!i.isSelected()&&!n.has(i._index))).setSelected(!0),this.ogma.modules.selection.enableEvents()}cleanup(){this.selectedNodes=void 0,this.selectedEdges=void 0,this.ogma.modules.selection.enableEvents&&this.ogma.modules.selection.enableEvents()}},Dq={setData:!1,addElement:!0,removeElement:!0,setOptions:!1,refresh:!1},Oq=class cx{constructor(){this.prev={},this.next={},this.prevorder=[],this.nextorder=[],this.shouldAnimate=!1,this.minRefreshIndex=0}addTransformation(e,s){this.next[e]=s,this.nextorder.push(e)}removeTransformation(e){delete this.next[e]}setIndex(e,s){const n=this.nextorder.indexOf(e);this.nextorder.splice(n,1),this.nextorder.splice(s,0,e),this.minRefreshIndex=Math.min(this.minRefreshIndex,n,s)}setEnabled(e,s){this.next[e]=s}isEnabled(e){return this.prev[e]||!1}static getDiff(e,s){const n=new Map;for(const i in e)s[i]!==void 0?s[i]!==e[i]&&n.set(+i,{shouldDo:s[i],shouldUndo:e[i]}):n.set(+i,{shouldDo:!1,shouldUndo:e[i],shouldCleanup:!0});for(const i in s)e[i]===void 0&&s[i]===!0&&n.set(+i,{shouldDo:!0,shouldUndo:!1});return n}getFirstChange(e){const{nextorder:s}=this;let n=s.length;for(let i=0;i<s.length;i++){const r=e.get(s[i]);if(r&&(r.shouldUndo||r.shouldDo)){n=i;break}}return n}refreshFrom(e,s){const{nextorder:n}=this;for(let i=s;i<this.nextorder.length;i++)e.set(n[i],{shouldUndo:this.prev[n[i]],shouldDo:this.prev[n[i]],...e.get(n[i])||{}});return e}isDirty(){const e=cx.getDiff(this.prev,this.next),s=Math.min(this.minRefreshIndex,this.getFirstChange(e));return(e.size>0||s<this.nextorder.length)&&{reason:e.size>0?"diff":"refresh",index:s}}invalidateFrom(e,s){this.shouldAnimate||(this.shouldAnimate=Dq[s]),this.minRefreshIndex=Math.min(this.minRefreshIndex,e)}step(){const e=cx.getDiff(this.prev,this.next);this.prev={...this.next};const s=Math.min(this.minRefreshIndex,this.getFirstChange(e)),n=this.nextorder.reduce(((o,a,l)=>o.set(a,l)),new Map),i=this.prevorder.reduce(((o,a,l)=>o.set(a,l)),new Map);this.nextorder=this.nextorder.filter((o=>this.prev[o]!==void 0)),this.prevorder=[...this.nextorder],this.minRefreshIndex=this.nextorder.length;const r=this.shouldAnimate;return this.shouldAnimate=!1,{diff:this.refreshFrom(e,s),nextorder:n,prevorder:i,shouldAnimate:r}}done(){}},Bq=class{constructor(t){this.transformations=[],this.addingGraph=!1,this.addingElements=!1,this.nodeToTransformation=new Map,this.edgeToTransformation=new Map,this.nodeVirtual=new Set,this.edgeVirtual=new Set,this.nodeToMeta=new Map,this.edgeToMeta=new Map,this.metaToNodes=new Map,this.metaToEdges=new Map,this._onDestroy=()=>{this.destroy()},this._onAddElements=({nodes:e,edges:s,virtual:n})=>{if(n){if(e)for(let i=0;i<e.size;i++)this.nodeVirtual.add(e._indexes[i]);if(s)for(let i=0;i<s.size;i++)this.edgeVirtual.add(s._indexes[i])}else this.addingGraph||this.addingElements||(this.state.invalidateFrom(0,"addElement"),this.invalidate())},this._onSetData=({elements:e,virtual:s})=>{if(s)return;const{isNode:n,_indexes:i}=e;let r=1/0;for(const o of i){const a=this.getTransformation(o,n);if(!a){r=0;break}r=Math.min(r,a.getIndex())}return this.state.invalidateFrom(r,"setData"),this.invalidate(),r},this._onRequestElementsToDelete=e=>{const{elementsToRemove:s}=e,n=s.isNode,i=s._indexes,r=this.getLeafElements(i,n);e.elementsToRemove=n?this.ogma.nodeList(r):this.ogma.edgeList(r)},this._onAfterRemoveElements=({nodes:e,edges:s})=>{if(!this.ogma.isDestroyed()){if(e)for(let n=0;n<e.size;n++)this.nodeVirtual.delete(e._indexes[n]);if(s)for(let n=0;n<s.size;n++)this.edgeVirtual.delete(s._indexes[n])}},this._onRemoveElements=({nodes:e,edges:s,virtual:n})=>{n||this.ogma.isDestroyed()||this._refreshPromise.then((()=>{const i=!!e,r=i?e._indexes:s._indexes,o=new Set(r);this.transformations.forEach((a=>a.onRemove(o,i))),this.groupController.onRemove(r,i),this.drilldownController.onRemove(o,i),i?(this.nodeToMeta.clear(),this.metaToNodes.clear(),this.nodeToTransformation.clear()):(this.edgeToMeta.clear(),this.metaToEdges.clear(),this.edgeToTransformation.clear()),this.state.invalidateFrom(0,"removeElement"),this.invalidate()}))},this._onClearGraph=()=>{this.transformations.forEach((e=>{e.cleanup()})),this.groupController.clear(),this.nodeToMeta.clear(),this.edgeToMeta.clear(),this.metaToNodes.clear(),this.metaToEdges.clear(),this.nodeToTransformation.clear(),this.edgeToTransformation.clear(),this.state.invalidateFrom(0,"removeElement"),this.invalidate()},this.ogma=t,this.state=new Oq,this.animations=new wq(t),this._shouldRefresh=!1,this._refreshing=!1,this.isDestroyed=!1,this.isPaused=!1,this.selection=new zq(t),this._refreshPromise=Promise.resolve(),this.groupController=new Pq(t,this),this.drilldownController=new Iq(this),this.ogma.events.on("setData",this._onSetData).on("preAddGraph",(()=>{this.addingGraph=!0})).on("postAddGraph",(()=>{this.addingGraph=!1,this.state.invalidateFrom(0,"addElement"),this.invalidate()})).on("preAddElements",(({virtual:e})=>{e||this.addingGraph||(this.addingElements=!0)})).on("postAddElements",(({virtual:e})=>{e||this.addingGraph||(this.addingElements=!1,this.state.invalidateFrom(0,"addElement"),this.invalidate())})).on(["addNodes","addEdges"],this._onAddElements).on(["removeNodes","removeEdges"],this._onRemoveElements).on("clearGraph",this._onClearGraph).on(["afterRemoveNodes","afterRemoveEdges"],this._onAfterRemoveElements).on("requestElementsToDelete",this._onRequestElementsToDelete).on("destroy",this._onDestroy)}addTransformation(t,e=!0){this.state.addTransformation(t.getId(),e),this.transformations.push(t),this.invalidate()}removeTransformation(t){const e=this.transformations.indexOf(t);e!==-1&&this.transformations.splice(e,1),this.invalidate()}async step(t=0,e={fireEnabled:[],fireDisabled:[],fireRefresh:[],fireDestroy:[],fireSetIndex:[]}){var s;if(t>5)throw new Error("Ogma transformations: Transformations refresh in loop");const{diff:n,prevorder:i,nextorder:r}=this.state.step(),{fireEnabled:o,fireDisabled:a,fireRefresh:l,fireDestroy:u,fireSetIndex:h}=e,g=[],f=[],p=[];this.groupController.startRefresh();for(const _ of this.transformations){const x=_.getId();if(!n.has(x))continue;const{shouldDo:v,shouldUndo:b,shouldCleanup:S}=n.get(x);v&&!b?o.push(_):b&&!v?a.push(_):v&&b&&l.push(_),i.has(x)&&i.get(x)!==r.get(x)&&h.push(_),b&&g.push(_),v&&f.push(_),S&&(u.push(_),p.push(_))}let y=0;g.sort(((_,x)=>i.get(x.getId())-i.get(_.getId())||0));for(const _ of g){const x=!((s=n.get(_.getId()))!=null&&s.shouldDo);x&&(y=this.animations.getMaxAnimation(y,_.getAnimation())),await _.undo(x)}f.sort(((_,x)=>r.get(_.getId())-r.get(x.getId())||0)),this.ogma.modules.graphics.pauseRendering();for(let _=0;_<f.length;_++){const x=f[_],v=_===f.length-1;v&&(y=this.animations.getMaxAnimation(y,x.getAnimation())),await x.run(v)}for(const _ of p)await _.cleanup();if((g.length||f.length||p.length)&&(this.groupController.updateGroupLayer(),await this.groupController.onAfterLayouts()),this.ogma.modules.graphics.resumeRendering(),await this.animations.apply(y),!this.isDestroyed)return this.state.isDirty()?this.step(t+1,e):e}refresh(){this.isDestroyed||this.ogma.isDestroyed()||!this._shouldRefresh||!this.transformations.length||this._refreshing||this.addingGraph||this.addingElements||this.isPaused||(this._shouldRefresh=!1,this._refreshing=!0,this._refreshPromise=this._refreshPromise.then((()=>(this.selection.save(),this.step().then((t=>{this._refreshing=!1;const{fireEnabled:e,fireDisabled:s,fireRefresh:n,fireDestroy:i,fireSetIndex:r}=t,o=this.ogma.modules.events;s.reverse().forEach((a=>o.fire("transformationDisabled",{target:a}))),e.forEach((a=>o.fire("transformationEnabled",{target:a}))),r.forEach((a=>o.fire("transformationSetIndex",{target:a}))),n.forEach((a=>o.fire("transformationRefresh",{target:a}))),i.forEach((a=>o.fire("transformationDestroyed",{target:a})))})).finally((()=>{this.selection.restore(),this.selection.cleanup(),this.ogma.modules.graphics.resumeRendering()}))))).catch((t=>{const e=this.state.isDirty();if(!e)throw new Error(`Ogma transformations, refresh failed.
${t.stack}`);const s=e.reason==="diff"?"You are constantly adding/removing/changing index of a transformation":"You are constantly adding/removing/updating nodes or edges while transformations refresh";throw new Error(`Ogma transformations, refresh failed.
${s}`)})).catch((t=>{if(!this.onRefreshError)throw t;this.onRefreshError(t)})).finally((()=>{})))}enable(t){return this.state.setEnabled(t.getId(),!0),this.invalidate(),this.afterNextUpdate()}disable(t){return this.state.setEnabled(t.getId(),!1),this.invalidate(),this.afterNextUpdate()}remove(t){return this.disable(t),this.state.removeTransformation(t.getId()),this.afterNextUpdate().then((()=>{this.transformations.splice(this.getIndex(t),1)}))}isEnabled(t){return this.state.isEnabled(t.getId())}getList(){return this.transformations.slice()}getIndex(t){for(let e=0;e<this.transformations.length;e++)if(this.transformations[e]===t)return e;return-1}setIndex(t,e){const s=this.getIndex(t);this.state.setIndex(t.getId(),e),this.transformations.splice(s,1),this.transformations.splice(e,0,t),this.invalidate()}setOptions(t){this.state.invalidateFrom(this.getIndex(t),"setOptions"),this.invalidate()}refreshTransformation(t){this.state.invalidateFrom(this.getIndex(t),"refresh"),this.invalidate()}clear(){return this.transformations.forEach((t=>t.destroy(0))),this.invalidate(),this.afterNextUpdate()}destroy(){this.transformations.forEach((t=>t.destroy(0))),this.groupController.destroy(),this._refreshPromise=Promise.resolve(),this.isDestroyed=!0}invalidate(){this.ogma.isDestroyed()||(this._shouldRefresh=!0,this.ogma.modules.dom.refresh(),this.ogma.modules.dom.onNextFrame().then((()=>{this.refresh()})))}afterNextUpdate(){return this.ogma.view.afterNextFrame().then((()=>this._refreshPromise))}getTransformation(t,e){return e?this.nodeToTransformation.get(t):this.edgeToTransformation.get(t)}setTransformation(t,e,s){s?this.nodeToTransformation.set(t,e):this.edgeToTransformation.set(t,e)}deleteTransformation(t){const e=t.isNode?this.nodeToTransformation:this.edgeToTransformation,s=t._indexes;for(const n of s)e.delete(n)}setMetaNode(t,e){this.nodeToMeta.set(t,e)}setSubNodes(t,e){this.metaToNodes.set(t,e)}setMetaElement(t,e,s){s?this.setMetaNode(t,e):this.setMetaEdge(t,e)}setSubElements(t,e,s){s?this.setSubNodes(t,e):this.setSubEdges(t,e)}removeMetaNodes(t){const e=t._indexes;for(const s of e){const n=this.metaToNodes.get(s);n&&n.forEach((i=>this.nodeToMeta.delete(i._index))),this.nodeToTransformation.delete(s),this.metaToNodes.delete(s)}}removeMetaEdges(t){const e=t._indexes;for(const s of e){const n=this.metaToEdges.get(s);n&&n.forEach((i=>this.edgeToMeta.delete(i._index))),this.edgeToTransformation.delete(s),this.metaToEdges.delete(s)}}clearSubNodes(t){this.metaToNodes.delete(t)}clearMetaNode(t){this.nodeToMeta.delete(t)}setMetaEdge(t,e){this.edgeToMeta.set(t,e)}setSubEdges(t,e){this.metaToEdges.set(t,e)}clearSubEdges(t){this.metaToEdges.delete(t)}clearMetaEdge(t){this.edgeToMeta.delete(t)}getMetaNode(t){return this.nodeToMeta.get(t._index)||null}getMetaEdge(t){return this.edgeToMeta.get(t._index)||null}getLeafElements(t,e){const s=[t],n=e?this.metaToNodes:this.metaToEdges,i=[];for(;s.length;){const r=s.pop();for(let o=0;o<r.length;o++){i.push(r[o]);const a=n.get(r[o]);a&&s.push(a._indexes)}}return i}getSubElements(t){const e=t.isNode?this.metaToNodes:this.metaToEdges,s=t.toList()._indexes;let n=0;for(let o=0;o<s.length;o++){const a=e.get(s[o]);a&&(n+=a.size)}const i=new Uint32Array(n);let r=0;for(let o=0;o<s.length;o++){const a=e.get(s[o]);if(a)for(let l=0;l<a.size;l++)i[r++]=a._indexes[l]}return t.isNode?this.ogma.nodeList(i):this.ogma.edgeList(i)}getSubNodes(t){return this.getSubElements(t)}getSubEdges(t){return this.getSubElements(t)}getById(t){return this.transformations.find((e=>e.getId()===t))}isIntraEdge(t){const e=t.getSource()._index;return this.nodeToMeta.has(e)&&this.nodeToMeta.get(e)===this.nodeToMeta.get(t.getTarget()._index)}isVirtual(t,e){return e?this.nodeVirtual.has(t):this.edgeVirtual.has(t)}isRefreshing(){return this._refreshing}pause(){this.isPaused=!0}resume(){this.isPaused=!1,this.refresh()}},ei="_transparent",mu=t=>!0,Uq=()=>{};function PN(t){if(t.keys)return Array.from(t.keys());const e=[];return t.forEach(((s,n)=>e.push(n))),e}function kf(t){if(t.values)return Array.from(t.values());const e=[];return t.forEach((s=>e.push(s))),e}function ZA(t){return!(!t||t.constructor!==Object&&t.constructor)}var Ra=(...t)=>{const e={};for(let s=0;s<t.length;s++){const n=t[s];for(const i in n)n.hasOwnProperty(i)&&(Array.isArray(e[i])&&Array.isArray(n[i])?e[i]=Array.from(new Set(e[i].concat(n[i]))):ZA(e[i])&&ZA(n[i])?e[i]=Ra(e[i],n[i]):e[i]=n[i])}return e};function Gq(t){return Array.isArray(t)?t:[t]}var gx=()=>!0,zN=()=>!1,Vq=()=>null,jq=class extends na{constructor(t){super(t),this.nodeSelector=t.criteria||mu}setOptions(t){return this.nodeSelector=t.criteria||this.nodeSelector,super.setOptions(t)}getName(){return Zn.NodeFilter}run(){const t=this.nodeSelector,e=this.ogma.getNodes().filter((a=>!t||!t(a))),s=e.getAdjacentEdges();this.module.animations.hideNodes(e._indexes),this.module.animations.hideEdges(s._indexes),e.setVisible(!1),s.setVisible(!1);const n=e.subtract(this.context.hiddenNodes),i=s.subtract(this.context.hiddenEdges),r=this.context.hiddenNodes.subtract(e),o=this.context.hiddenEdges.subtract(s);return this.module.animations.pushBefore((()=>{r.setVisible(!0),r.setVisible(!0),i.setVisible(!0),n.setVisible(!0),r.addClass(ei),o.addClass(ei)})),this.module.animations.push((()=>Promise.all([o.removeClass(ei,this.animation),r.removeClass(ei,this.animation),n.addClass(ei,this.animation),i.addClass(ei,this.animation)]))),this.context={...this.context,hiddenNodes:e,hiddenEdges:s},Promise.resolve()}undo(t=!0){const{hiddenNodes:e,hiddenEdges:s}=this.context,n=t?this.animation:0;return e.setExcluded(!1),s.setExcluded(!1),t&&(e.addClass(ei),s.addClass(ei),this.module.animations.push((()=>Promise.all([e.removeClass(ei,n),s.removeClass(ei,n)]))),this.context.hiddenNodes=this.ogma.nodeList(),this.context.hiddenEdges=this.ogma.edgeList()),Promise.resolve()}onRemove(t,e){e?this.context.hiddenNodes=this.context.hiddenNodes.filter((s=>!t.has(s._index))):this.context.hiddenEdges=this.context.hiddenEdges.filter((s=>!t.has(s._index)))}resetContext(){this.context={...this.context,hiddenEdges:this.ogma.edgeList(),hiddenNodes:this.ogma.nodeList()}}},Hq=class extends na{constructor(t){super(t),this.edgeSelector=t.criteria||mu}setOptions(t){return this.edgeSelector=t.criteria||this.edgeSelector,super.setOptions(t)}getName(){return Zn.EdgeFilter}run(){const t=this.edgeSelector,e=this.ogma.getEdges().filter((r=>!t||!t(r))),s=this.module.animations;e.setVisible(!1);const n=e.subtract(this.context.hiddenEdges),i=this.context.hiddenEdges.subtract(e);return this.module.animations.pushBefore((()=>{n.setVisible(!0),i.setVisible(!0),i.addClass(ei)})),s.hideEdges(e._indexes),s.push((()=>Promise.all([i.removeClass(ei,this.animation),n.addClass(ei,this.animation)]))),this.context={...this.context,hiddenEdges:e},Promise.resolve()}undo(t=!0){super.undo(t);const{hiddenEdges:e}=this.context,s=t?this.animation:0;return e.setExcluded(!1),t&&(e.addClass(ei),this.module.animations.push((()=>Promise.all([e.removeClass(ei,s)]))),this.context.hiddenEdges=this.ogma.edgeList()),Promise.resolve()}onRemove(t,e){e||(this.context.hiddenEdges=this.context.hiddenEdges.filter((s=>!t.has(s._index))))}resetContext(){this.context={...this.context,hiddenEdges:this.ogma.edgeList()}}},dn="_faded",$q=class extends na{constructor(t){super(t),this.selector=t.selector||zN,this.dataFunction=t.dataFunction||Uq}getName(){return Zn.NeighborMerging}run(t=!0){const{ogma:e}=this,s=t?this.animation:0,n=e.getNodes().filter(this.selector),i=[],r=new Map;for(let f=0;f<n.size;++f){const p=n.get(f),y=p.getAdjacentEdges(),_=this.dataFunction(p);for(let x=0;x<y.size;++x){const v=y.get(x),b=v.getSource(),S=v.getTarget();if(b!==S&&_!==void 0){const A=b===p?S:b;let w=r.get(A);w||(w=[],r.set(A,w)),w.push(_)}i.push(v)}}const o=e.getEdges(i),a=e.getNodes(PN(r)),l=kf(r),u=a.getData(),h=new Array(a.size);for(let f=0;f<h.length;++f){const p=l[f];let y=u[f];for(let _=0;_<p.length;++_)y=Ra(y,p[_]);h[f]=y}const g=this.module.animations;return g.hideNodes(n._indexes),g.hideEdges(o._indexes),g.push((()=>Promise.all([n.addClass(dn,s),o.addClass(dn,s)]).then((()=>{this.ogma.modules.data.setProperty(a,null,h,{dispatch:!0,virtual:!0})})))),this.context={...this.context,hiddenNodes:n,hiddenEdges:o,nodesWithDataChange:a,oldDataList:u},Promise.resolve()}resetContext(){super.resetContext(),this.context={...this.context,hiddenNodes:this.ogma.nodeList(),hiddenEdges:this.ogma.edgeList(),nodesWithDataChange:this.ogma.nodeList(),oldDataList:[]}}undo(t=!0){const{hiddenNodes:e,hiddenEdges:s,nodesWithDataChange:n,oldDataList:i}=this.context,r=t?this.animation:0,o=this.module.animations;return this.context.hiddenEdges=this.ogma.edgeList(),this.context.hiddenNodes=this.ogma.nodeList(),this.context.nodesWithDataChange=this.ogma.nodeList(),this.context.oldDataList=[],e.setVisible(!0),s.setVisible(!0),o.pushBefore((()=>{e.addClass(dn),s.addClass(dn)})),o.push((()=>Promise.all([e.removeClass(dn,r),s.removeClass(dn,r)]).then((()=>{this.ogma.modules.data.setProperty(n,null,i,{dispatch:!0,virtual:!0})})))),Promise.resolve()}onRemove(t,e){e&&(this.context.hiddenNodes=this.context.hiddenNodes.filter((s=>!t.has(s._index)))),this.context.hiddenEdges=this.context.hiddenEdges.filter((s=>!t.has(s._index)))}cleanup(){return Promise.resolve()}setOptions(t){return this.selector=t.selector||this.selector,this.dataFunction=t.dataFunction||this.dataFunction,super.setOptions(t)}};function qq(t){return t!=null}var Yq=(t,e)=>({source:t.getId(),target:e.getId()}),Wq=class extends na{constructor(t){super(t);const{selector:e=gx,neighborIdFunction:s=Vq,nodeGenerator:n=(()=>({})),edgeGenerator:i=Yq}=t;this.neighborIdFunction=s,this.selector=e,this.generateIds=r=>this.selector(r)&&this.neighborIdFunction(r)||null,this.nodeGenerator=n,this.edgeGenerator=i}getName(){return Zn.NeighborGeneration}run(t=!0){const{ogma:e,id:s}=this,n=t?this.animation:0,i=e.getNodes(),r=new Map;for(let f=0;f<i.size;++f){const p=i.get(f),y=(Xq(this.generateIds(p))||[]).filter(qq);if(y)for(const _ of y){let x=r.get(_);x||(x=[],r.set(_,x)),x.push(p)}}const o=new Array(r.size),a=[],l=PN(r),u=kf(r).map((f=>e.getNodes(f)));for(let f=0;f<o.length;++f){const p=l[f],y=u[f],_=this.nodeGenerator(p,y);_.id=`_gen_${s}_${p}`;const x=Tq(y.getPosition());_.attributes=_.attributes||{},_.attributes.x=x.x,_.attributes.y=x.y,o[f]=_}let h,g;return e.addNodes(o.map((f=>({id:f.id,attributes:f.attributes}))),{virtual:!0}).then((()=>{h=e.getNodes(o.map((p=>p.id)));const f=h._indexes;this.context.virtualNodes&&this.module.removeMetaNodes(this.context.virtualNodes);for(let p=0;p<h.size;p++)this.module.setTransformation(f[p],this,!0),this.module.setSubNodes(f[p],this.ogma.createNodeList());h.replaceOriginalAttributes(o.map((p=>p.attributes)),["x","y"]),this.ogma.modules.data.setProperty(h,null,o.map((p=>p.data)),{dispatch:!0,virtual:!0});for(let p=0;p<h.size;++p){const y=h.get(p),_=u[p];for(let x=0;x<_.size;++x){const v=_.get(x),b=this.edgeGenerator(v,y);!b.source&&!b.target&&(b.source=v.getId(),b.target=y.getId()),b.id||(b.id=`${b.source}-${b.target}`),a.push(b)}}return e.addEdges(a,{virtual:!0})})).then((()=>{g=e.getEdges(a.map((p=>p.id)));const f=g._indexes;this.context.virtualEdges&&this.module.removeMetaEdges(this.context.virtualEdges);for(let p=0;p<g.size;p++)this.module.setTransformation(f[p],this,!1),this.module.setSubEdges(f[p],this.ogma.createEdgeList());this.context={virtualEdges:g,virtualNodes:h},e.removeNodes(this.context.virtualNodes.subtract(h),{virtual:!0}),e.removeEdges(this.context.virtualEdges.subtract(g),{virtual:!0}),h.setVisible(!0),g.setVisible(!0),this.module.animations.pushBefore((()=>{h.addClass(dn),g.addClass(dn)})),this.module.animations.push((()=>Promise.all([h.removeClass(dn,n),g.removeClass(dn,n)])))}))}undo(t=!0){const{virtualNodes:e,virtualEdges:s}=this.context;if(!s||!e)return Promise.resolve(this.context);const n=t?this.animation:0,i=this.module.animations;t?(i.hideNodes(e._indexes),i.hideEdges(s._indexes),i.push((()=>Promise.all([e.addClass(dn,n),s.addClass(dn,n)])))):(e.setVisible(!1),s.setVisible(!1))}onRemove(){}cleanup(){const{virtualEdges:t,virtualNodes:e}=this.context;return t&&e&&(this.module.removeMetaNodes(e),this.module.removeMetaEdges(t),this.ogma.removeNodes(e,{virtual:!0}),this.ogma.removeEdges(t,{virtual:!0}),this.context.virtualEdges=this.ogma.edgeList(),this.context.virtualNodes=this.ogma.nodeList()),Promise.resolve()}setOptions(t){const{selector:e,neighborIdFunction:s,nodeGenerator:n,edgeGenerator:i}=t;return this.selector=e||this.selector,this.neighborIdFunction=s||this.neighborIdFunction,this.generateIds=r=>this.selector(r)&&this.neighborIdFunction(r)||null,this.nodeGenerator=n||this.nodeGenerator,this.edgeGenerator=i||this.edgeGenerator,super.setOptions(t)}resetContext(){super.resetContext(),this.context={...this.context,virtualNodes:this.ogma.nodeList(),virtualEdges:this.ogma.edgeList()}}};function Xq(t){return Array.isArray(t)?t:t?[t]:null}function Zq(t,e){return t.size===e.size&&t.filter((s=>e.includes(s))).size>0}var Kq=class extends na{constructor(t){super(t),this.selector=t.selector||zN,this.edgeGenerator=t.edgeGenerator||(()=>({}))}getName(){return Zn.NodeCollapsing}resetContext(){this.context={hiddenNodes:this.ogma.nodeList(),hiddenEdges:this.ogma.edgeList(),virtualEdges:this.ogma.edgeList()}}run(t=!0){const{ogma:e}=this,s=t?this.animation:0,n=e.getNodes().filter(this.selector),i=n.getAdjacentEdges(),r=[],o=n.map((l=>l.getAdjacentNodes().filter((u=>!this.selector(u)))));for(let l=0;l<n.size;l++)for(let u=l;u<n.size;u++){const h=n.get(l),g=n.get(u);if(this.ogma.modules.graph.getEdgesBetweenTwoNodes(h,g).size>0&&(o[l].size||o[u].size)&&!Zq(o[l],o[u]))throw Error(`addNodeCollapsing: invalid connected nodes [${h.getId()}] and [${g.getId()}] to be collapsed. The addNodeCollapsing function supports only disconnected nodes.`)}const a=new Map;for(let l=0;l<n.size;++l){const u=n.get(l),h=o[l];for(let g=0;g<h.size-1;++g){const f=h.get(g),p=this.ogma.modules.graph.getEdgesBetweenTwoNodes(u,f);if(f!==u)for(let y=g+1;y<h.size;++y){const _=h.get(y),x=this.ogma.modules.graph.getEdgesBetweenTwoNodes(u,_),v=this.edgeGenerator(u,f,_,p,x);if(v){const b=Gq(v);for(let S=0;S<b.length;++S)r.push(Qq(e,b[S],S,u,f,_,p,x)),a.set(r[r.length-1].id,p.concat(x))}}}}return e.addEdges(r,{virtual:!0}).then((()=>{const l=this.ogma.getEdges(r.map((g=>g.id)));this.context.virtualEdges&&this.module.removeMetaEdges(this.context.virtualEdges);const u=l._indexes;for(let g=0;g<l.size;g++){this.module.setTransformation(u[g],this,!1);const f=a.get(l.get(g).getId());this.module.setSubEdges(u[g],f);for(let p=0;p<f.size;p++)this.module.setMetaEdge(f._indexes[p],l.get(g))}e.removeEdges(this.context.virtualEdges.subtract(l),{virtual:!0});const h=this.module.animations;l.setVisible(!0),h.pushBefore((()=>l.addClass(dn))),h.push((()=>Promise.all([l.removeClass(dn,s),n.addClass(dn,s),i.addClass(dn,s)]))),h.hideNodes(n._indexes),h.hideEdges(i._indexes),this.context={hiddenEdges:i,hiddenNodes:n,virtualEdges:l}}))}undo(t=!0){const{hiddenNodes:e,hiddenEdges:s,virtualEdges:n}=this.context,i=t?this.animation:0,r=this.module.animations;return e.setVisible(!0),s.setVisible(!0),t?(r.hideEdges(n._indexes),r.pushBefore((()=>Promise.all([e.addClass(dn),s.addClass(dn)]))),r.push((()=>Promise.all([n.addClass(dn,i),e.removeClass(dn,i),s.removeClass(dn,i)])))):n.setVisible(!1),Promise.resolve()}cleanup(){const t=this.context.virtualEdges||this.ogma.createEdgeList();return this.module.removeMetaEdges(t),this.ogma.removeEdges(t,{virtual:!0}).then((()=>{this.resetContext()}))}onRemove(t,e){e&&(this.context.hiddenNodes=this.context.hiddenNodes.filter((s=>!t.has(s._index)))),this.context.hiddenEdges=this.context.hiddenEdges.filter((s=>!t.has(s._index)))}setOptions(t){return this.selector=t.selector||this.selector,this.edgeGenerator=t.edgeGenerator||this.edgeGenerator,super.setOptions(t)}};function Qq(t,e,s,n,i,r,o,a){let l,u;if(e.source!==void 0&&(l=t.getNode(e.source),l!==i&&l!==r))throw new Error([`addNodeCollapsing: edge generator produced RawEdge with invalid source [${e.source}]`,`expected to be [${i.getId()}] or [${r.getId()}]`].join("; "));if(e.target!==void 0&&(u=t.getNode(e.target),u!==i&&u!==r))throw new Error([`addNodeCollapsing: edge generator produced RawEdge with invalid target [${e.target}]`,`expected to be [${i.getId()}] or [${r.getId()}]`].join("; "));if(l&&u&&l===u)throw new Error(`addNodeCollapsing: edge generator produced RawEdge with same source and target [${l.getId()}]`);if(l&&!u)u=l===i?r:i;else if(u&&!l)l=u===i?r:i;else if(!l&&!u){let h=!0;for(let g=0;g<o.size;++g)o.get(g).getSource()===i&&(h=!1);for(let g=0;g<a.size;++g)a.get(g).getTarget()===r&&(h=!1);h?(l=r,u=i):(l=i,u=r)}return l&&u?{...e,id:`_gen_${n.getId()}_${l.getId()}_${u.getId()}_${s}`,source:l.getId(),target:u.getId()}:{}}var Jq=class extends na{constructor(t){super(t),this.nodeSelector=t.nodeSelector||gx,this.edgeSelector=t.edgeSelector||gx,this.nodeDataFunction=t.nodeDataFunction||null,this.edgeDataFunction=t.edgeDataFunction||null}getName(){return Zn.VirtualProperties}resetContext(){this.context={nodes:this.ogma.nodeList(),oldNodesData:[],edges:this.ogma.edgeList(),oldEdgesData:[]}}run(){const{ogma:t,context:e}=this;return this.nodeDataFunction&&(e.nodes=t.getNodes().filter(this.nodeSelector),e.oldNodesData=KA(e.nodes,this.nodeDataFunction,this.ogma)),this.edgeDataFunction&&(e.edges=t.getEdges().filter(this.edgeSelector),e.oldEdgesData=KA(e.edges,this.edgeDataFunction,this.ogma)),Promise.resolve()}undo(){const{nodes:t,oldNodesData:e,edges:s,oldEdgesData:n}=this.context,i=this.ogma.modules.data;return t&&i.setProperty(t,null,e,{dispatch:!0,virtual:!0}),s&&i.setProperty(s,null,n,{dispatch:!0,virtual:!0}),Promise.resolve()}onRemove(t,e){e&&(this.context.nodes=this.context.nodes.filter((s=>!t.has(s._index)))),this.context.edges=this.context.edges.filter((s=>!t.has(s._index)))}cleanup(){return this.resetContext(),Promise.resolve()}setOptions(t){return this.nodeSelector=t.nodeSelector||this.nodeSelector,this.edgeSelector=t.edgeSelector||this.edgeSelector,this.nodeDataFunction=t.nodeDataFunction||this.nodeDataFunction,this.edgeDataFunction=t.edgeDataFunction||this.edgeDataFunction,super.setOptions(t)}};function KA(t,e,s){const n=[],i=[];for(let r=0;r<t.size;++r){const o=t.get(r),a=o.getData(),l=e(o);i.push(Ra(a,l)),n.push(a)}return s.modules.data.setProperty(t,null,i,{dispatch:!0,virtual:!0}),n}var _u=()=>"";function lh(){return{}}var DN=class extends na{constructor(t){super(t),this.nodeSelector=t.nodeSelector||mu,this.nodeGroupIdFunction=t.nodeGroupIdFunction||_u,this.nodeGenerator=t.nodeGenerator||lh,this.edgeSelector=t.edgeSelector||mu,this.edgeGroupIdFunction=t.edgeGroupIdFunction||_u,this.edgeGenerator=t.edgeGenerator||lh,this.separateEdgesByDirection=t.separateEdgesByDirection!==void 0&&t.separateEdgesByDirection,this.groupSelfLoopEdges=!!t.groupSelfLoopEdges,this.groupEdges=t.groupEdges===void 0||t.groupEdges,this.ogma.events.on("updateNodeData",(({changes:e})=>this.checkChanges(e,!0))).on("updateEdgeData",(({changes:e})=>this.checkChanges(e,!1)))}computeNodeGroupId(t){if(this.nodeGroupIdFunction){if(!this.nodeSelector(t)||this.module.groupController.alreadyGrouped.has(t._index)||this.module.animations.hiddenNodes.has(t._index))return;const e=this.nodeGroupIdFunction(t);return e===void 0?void 0:e}}computeEdgeGroupId(t){if(this.edgeGroupIdFunction)return this.edgeSelector(t)&&!this.module.animations.hiddenEdges.has(t._index)?this.edgeGroupIdFunction(t):void 0}addMetaNodes(){const t=this.id,e=this.ogma,s=e.getNodes(),n=new Map;for(let h=0;h<s.size;++h){const g=s.get(h),f=this.computeNodeGroupId(g);if(f===void 0)continue;let p=n.get(f);p||(p={id:f,nodes:[]},n.set(f,p)),p.nodes.push(g)}const i=Array.from(n.values()),r=i.map((({nodes:h})=>e.getNodes(h))),o=[],a=[],l=new Set,{nodeDataUpdates:u}=this.context;for(let h=0;h<i.length;++h){const g=i[h].id,f=r[h],p=this.nodeGenerator(f,g,this);if(p){if(p.id===void 0&&(p.id=Lf(g,t)),l.has(p.id))throw new Error(`Ogma transformations: NodeGrouping ${this.id} is trying to create two different metaNodes with the same id.`);l.add(p.id),a.push(p.id),o.push(p)}else i.splice(h,1),r.splice(h,1),h--}return e.addNodes(o.map((({id:h})=>({id:h}))),{virtual:!0}).then((h=>{const g=e.getNodes(a);e.modules.individualAttributes.replaceOriginalAttributes(g,o.map((({attributes:p})=>p)));const f=g.getData();for(let p=0;p<f.length;p++){const y=f[p],_=o[p];f[p]=Ra(Ra(y,_.data),u.get(a[p]))}return e.modules.data.setProperty(g,null,f,{dispatch:!0,virtual:!0}),g.setVisible(!0),this.context.metaNodes&&this.module.removeMetaNodes(this.context.metaNodes),this.assignMetaSubNodes(g,r),{metaNodes:g,newNodes:h}}))}assignMetaSubNodes(t,e){const s=t._indexes;for(let n=0;n<s.length;n++){const i=e[n]._indexes,r=s[n],o=t.get(n);for(let a=0;a<i.length;a++)this.module.setMetaNode(i[a],o),this.module.groupController.alreadyGrouped.add(i[a]);this.module.setSubNodes(r,e[n]),this.module.setTransformation(r,this,!0)}}addMetaEdges(t){const e=this.id,s=this.ogma;let n,i=!1;const r=new Set;t?(n=this.module.getSubNodes(t).getAdjacentElements({bothExtremities:!1}).edges,i=!0):n=s.getEdges();const o=new Map,a=this.ogma.modules.graphics.getAttributesManager().getUsedEdgeAttributes().filter((_=>_!=="curvature")),l=new Map;for(let _=0;_<n.size;++_){const x=n.get(_),v=this.computeEdgeGroupId(x);if(v==null)continue;let b=x.getSource(),S=x.getTarget();if(i){let L=this.module.nodeToMeta.get(b._index);L&&L.getTransformation().getId()!==this.getId()&&(L=b);let I=this.module.nodeToMeta.get(S._index);if(I&&I.getTransformation().getId()!==this.getId()&&(I=S),b=L||b,S=I||S,b&&b===S&&(l.has(b._index)?l.get(b._index).push(x._index):l.set(b._index,[x._index]),!this.groupSelfLoopEdges))continue}const A=this.groupEdges?kq(v,b.getId(),S.getId(),this.separateEdgesByDirection):`${x.getId()}:${b.getId()}->${S.getId()}`;let w=o.get(A);w||(w={id:A,source:b,target:S,edges:[]},o.set(A,w)),w.edges.push(x)}const u=Array.from(o.values()),h=u.map((({edges:_})=>s.getEdges(_))),g=[],{edgeDataUpdates:f}=this.context,p=[],y=[];r.clear();for(let _=0;_<u.length;++_){const x=u[_],v=x.id,b=h[_],S=this.groupEdges?this.edgeGenerator(b,v,x.source,x.target,this):Cq(b,a);if(S){if(S.id===null)throw Error(`The id ${S.id} returned by the edgeGenerator function is not unique.`);if(S.id===void 0&&(S.id=Lf(v,e)),r.has(S.id))throw new Error(`Ogma transformations: NodeGrouping ${this.id} is trying to create two different metaEdges with the same id.`);r.add(S.id),p.push(S.id),x.source===x.target&&y.push(S.id),S.source=x.source.getId(),S.target=x.target.getId(),g.push(S)}}return s.addEdges(Lq(g),{virtual:!0}).then((()=>{const _=s.getEdges(p),x=s.getEdges(y);x.setVisible(!1),_.setVisible(!1),s.modules.individualAttributes.replaceOriginalAttributes(_,g.map((b=>b.attributes)));const v=_.getData();for(let b=0;b<v.length;b++){const S=g[b],A=v[b];v[b]=Ra(Ra(A,S.data),f.get(p[b]))}return s.modules.data.setProperty(_,null,v,{dispatch:!0,virtual:!0}),this.context.metaEdges&&this.module.removeMetaEdges(this.context.metaEdges),this.assignMetaSubEdges(_,h),{intraEdges:l,metaEdges:_,selfLoopEdges:x,subEdges:h}}))}assignMetaSubEdges(t,e){const s=t._indexes;for(let n=0;n<s.length;n++){const i=e[n]._indexes,r=s[n],o=t.get(n);for(let a=0;a<i.length;a++)this.module.setMetaEdge(i[a],o);this.module.setSubEdges(r,e[n]),this.module.setTransformation(r,this,!1)}}removeMetaEdges(t){t.forEach((e=>{const s=this.module.getSubEdges(e);if(!s)return;const n=s._indexes;for(let r=0;r<n.length;r++)this.module.clearMetaEdge(n[r]);this.module.clearSubEdges(e._index);const i=this.module.getMetaEdge(e);if(i){for(let r=0;r<n.length;r++)this.module.setMetaEdge(n[r],i);this.module.setSubEdges(i._index,this.module.getSubEdges(i).filter((r=>r!==e)).concat(s))}s.filter((r=>r.getTarget().isVisible()&&r.getSource().isVisible())).setVisible(!0)})),t.setVisible(!1)}removeMetaNodes(t){t.forEach((e=>{const s=this.module.getSubNodes(e);if(!s)return;const n=s._indexes;for(const i of n)this.module.clearMetaNode(i);this.module.clearSubNodes(e._index),s.setVisible(!0)})),t.setVisible(!1)}onRemove(t,e){}checkChanges(t,e){const s=e?this.context.nodeDataUpdates:this.context.edgeDataUpdates,n=this.module;for(let i=0;i<t.length;i++){const{property:r,newValues:o,virtual:a,nodes:l,edges:u}=t[i];if(a)continue;const h=e?l.filter((g=>n.getTransformation(g._index,e)===this)):u.filter((g=>n.getTransformation(g._index,e)===this));if(h.size)for(let g=0;g<h._indexes.length;g++){const f=h.get(g).getId();let p=s.get(f)||{};const y=o[g];r?Ia(p,r,y):p=y,s.set(f,p)}}}setOptions(t){return this.nodeSelector=t.nodeSelector||this.nodeSelector,this.nodeGroupIdFunction=t.nodeGroupIdFunction||this.nodeGroupIdFunction,this.nodeGenerator=t.nodeGenerator||this.nodeGenerator,this.edgeSelector=t.edgeSelector||this.edgeSelector,this.edgeGroupIdFunction=t.edgeGroupIdFunction||this.edgeGroupIdFunction,this.edgeGenerator=t.edgeGenerator||this.edgeGenerator,this.separateEdgesByDirection=t.separateEdgesByDirection!==void 0?!!t.separateEdgesByDirection:this.separateEdgesByDirection,this.groupSelfLoopEdges=t.groupSelfLoopEdges!==void 0?!!t.groupSelfLoopEdges:this.groupSelfLoopEdges,this.groupEdges=t.groupEdges!==void 0?!!t.groupEdges:this.groupEdges,super.setOptions(t)}resetContext(){super.resetContext(),this.context={...this.context,nodeDataUpdates:new Map,edgeDataUpdates:new Map}}},ON=class extends DN{constructor({duration:e,easing:s,id:n,ogma:i,module:r,enabled:o,padding:a=2,onBeforeAddMetaEdges:l,selector:u=mu,groupIdFunction:h=_u,edgeGroupIdFunction:g=_u,nodeGenerator:f=lh,edgeGenerator:p=lh,onGroupUpdate:y=(()=>{}),separateEdgesByDirection:_=!1,groupSelfLoopEdges:x=!1,groupEdges:v=!0,restorePositions:b=!0,showContents:S=!1}){super({id:n,ogma:i,module:r,nodeSelector:u,nodeGroupIdFunction:h,edgeGroupIdFunction:g,nodeGenerator:f,edgeSelector:A=>!(!this.module.getMetaNode(A.getSource())&&!this.module.getMetaNode(A.getTarget())),edgeGenerator:p,separateEdgesByDirection:_,groupEdges:v,groupSelfLoopEdges:x,duration:e,easing:s,enabled:o}),this.onBeforeAddMetaEdges=l||(()=>Promise.resolve()),this.onGroupUpdate=y,this._padding=a,this._showContents=typeof S!="function"?()=>S:S,this._restorePositions=b,this.module.groupController.setNodeGroupingCount(this.module.groupController.getNodeGroupingCount()+1)}getName(){return Zn.NodeGrouping}get padding(){return this._padding}set padding(e){this._padding=e,this.refresh()}resetContext(){super.resetContext(),this.context={...this.context,metaNodes:this.ogma.nodeList(),metaEdges:this.ogma.edgeList(),subNodes:this.ogma.nodeList(),intraEdges:this.ogma.edgeList(),subNodesPerMetaNode:new Map,subEdges:this.ogma.edgeList()}}run(){let e,s;const n=this.ogma,i=this.module.animations,r=this.module.groupController,o=r.layoutController;let a=n.createNodeList(),l=n.createEdgeList();const u=[];let h=n.createEdgeList();const g=new Map,f=-(this.getIndex()+FN),p=new Set,y=[],_=[],x=[];let v;const b=n.geo.enabled();return this.addMetaNodes().then((({metaNodes:S,newNodes:A})=>{v=r.setPadding(S,this._padding),e=S;for(let w=0;w<A.size;w++)p.add(A._indexes[w]);for(let w=0;w<e.size;w++)r.setNodeLayer(e._indexes[w],f);return this.onBeforeAddMetaEdges(e,A).then((()=>this.addMetaEdges(e)))})).then((({intraEdges:S,metaEdges:A,selfLoopEdges:w})=>{s=A,l=this.module.getSubEdges(s),s.filter((F=>F.getExtremities().map((O=>O.isVisible())).every((O=>O)))).setVisible(!0);for(let F=0;F<s.size;F++)r.edgeLayer.set(s._indexes[F],f);l.setVisible(!1);const L=this.context.metaNodes.subtract(e),I=this.context.metaEdges.subtract(s);return this.module.removeMetaNodes(L),this.module.removeMetaEdges(I),r.cleanup(L,I),n.removeNodes(L,{virtual:!0}).then((()=>n.removeEdges(I,{virtual:!0}))).then((()=>({intraEdges:S,metaEdges:A,selfLoopEdges:w})))})).then((({intraEdges:S,selfLoopEdges:A})=>{const w=e._indexes,L=[],I=e.getPosition();for(let F=0;F<w.length;F++){const O=e.get(F),V=r.isClose(O),j=!V&&!r.isOpen(O),Z=r.collapsedGroups.has(O._index),at=this._showContents(O),pt=this.module.getSubNodes(O),K=I[F],ut=pt._indexes,ht=new Set;if(j){const{x:Et,y:Xt}=r.getGroupXYR(O,this.module.getSubNodes(O),void 0,void 0);b?r.setGeoLatLng(O,Xt,Et):(_.push({x:Et,y:Xt}),x.push(O._index),K.x=Et,K.y=Xt)}g.set(w[F],ht);const nt=S.has(O._index)&&n.edgeList(S.get(O._index));nt&&(h=h.concat(nt),nt.setVisible(at&&!Z)),A.setVisible(!0),a=a.concat(pt);for(let Et=0;Et<ut.length;Et++)ht.add(ut[Et]);const ot=this.context.subNodesPerMetaNode.get(w[F]),Nt=v.has(O._index);let Q=!ot||o.shouldRelayout.has(O._index);if(!Q&&ot)for(const Et of ot.keys())Q||(Q=!ht.has(Et));if(!Q&&ot)for(let Et=0;Et<ut.length;Et++)Q||(Q=!ot.has(ut[Et]));if(Q&&(o.shouldRelayout.add(O._index),L.push(r.layoutController.getLayoutFunction(this.onGroupUpdate,O,pt,at))),at){if(V?r.expandGroup(O,pt):r.addOpenGroup(O),Q||Nt||V){y.push(O);const Et=this.module.getMetaNode(O);Et&&o.shouldRelayout.add(Et._index)}}else r.closeGroup(O,pt,K.x,K.y)}return x.length&&i.pushBefore((()=>{n.nodeList(x).setAttributes(_)})),r.layoutController.handleLayoutFunctions(L).then((()=>{y.forEach((F=>r.setGroupXYR(F))),b&&this.ogma.modules.geo._updateNodesCoordinates(e)}))})).then((()=>(this.context={metaNodes:e,metaEdges:s,subNodesPerMetaNode:g,subNodes:a,intraEdges:h,nodeDataUpdates:this.context.nodeDataUpdates,edgeDataUpdates:this.context.edgeDataUpdates,subEdges:l},u)))}undo(e=!0){super.undo(e);const{metaNodes:s,metaEdges:n,intraEdges:i,subNodes:r,subEdges:o}=this.context,a=this.module.animations,l=this.module.groupController;if(i.setVisible(!0),o.setVisible(!0),n.setVisible(!1),r.setVisible(!0),s.setVisible(!1),e){a.pushBefore((()=>{s.setVisible(!0),n.setVisible(!0)})),a.pushAfter((()=>{s.setVisible(!1),n.setVisible(!1)}));for(let u=0;u<n.size;u++)this.module.isVirtual(n._indexes[u],!1)||l.edgeLayer.delete(n._indexes[u]);for(let u=0;u<o.size;u++)this.module.isVirtual(o._indexes[u],!1)||l.edgeLayer.delete(o._indexes[u]);for(let u=0;u<i.size;u++)this.module.isVirtual(i._indexes[u],!1)||l.edgeLayer.delete(i._indexes[u]);for(let u=0;u<r.size;u++)this.module.isVirtual(r._indexes[u],!0)||l.nodeLayer.delete(r._indexes[u]);this.context.subNodesPerMetaNode.clear(),s.forEach((u=>{const h=this.module.getSubNodes(u);if(l.nodeLayer.delete(u._index),l.isClose(u))l.expandGroup(u,h,!0);else{const g=u.getPosition();l.closeGroup(u,h,g.x,g.y,!0)}}))}}onRemove(e,s){if(s){const n=this.context.metaNodes.size;this.context.metaNodes=this.context.metaNodes.filter((r=>!e.has(r._index)));const i=this.context.subNodes.size;this.context.subNodes=this.context.subNodes.filter((r=>!e.has(r._index))),(this.context.subNodes.size!==n||this.context.metaNodes.size!==i)&&this.context.subNodesPerMetaNode.clear()}else this.context.subEdges=this.context.subEdges.filter((n=>!e.has(n._index))),this.context.metaEdges=this.context.metaEdges.filter((n=>!e.has(n._index)))}cleanup(){const{ogma:e}=this,s=this.context,{metaNodes:n,metaEdges:i,subNodes:r}=s;return this.module.removeMetaNodes(n),this.module.removeMetaEdges(i),this.module.groupController.cleanup(n,i,r),this.module.groupController.setNodeGroupingCount(this.module.groupController.getNodeGroupingCount()-1),super.cleanup(),Promise.all([e.removeEdges(i,{virtual:!0}),e.removeNodes(n,{virtual:!0})]).then((()=>Promise.resolve()))}setOptions({duration:e,easing:s,enabled:n,padding:i,selector:r,groupIdFunction:o,nodeGenerator:a,edgeGroupIdFunction:l,edgeGenerator:u,separateEdgesByDirection:h,groupSelfLoopEdges:g,groupEdges:f,restorePositions:p,showContents:y}){return this._padding=i!==void 0?i:this.padding,this._showContents=y!==void 0?typeof y!="function"?()=>y:y:this._showContents,this._restorePositions=p===void 0?this._restorePositions:p,super.setOptions({nodeSelector:r,nodeGroupIdFunction:o,nodeGenerator:a,edgeSelector:_=>!(!this.module.getMetaNode(_.getSource())&&!this.module.getMetaNode(_.getTarget())),edgeGroupIdFunction:l,edgeGenerator:u,separateEdgesByDirection:h,groupEdges:f,groupSelfLoopEdges:g,duration:e,easing:s,enabled:n})}},tY=class extends DN{constructor({duration:t,easing:e,id:s,ogma:n,module:i,enabled:r,selector:o=mu,groupIdFunction:a=_u,generator:l=lh,separateEdgesByDirection:u=!1}){super({id:s,ogma:n,module:i,nodeSelector:null,nodeGroupIdFunction:null,nodeGenerator:null,edgeSelector:o,edgeGroupIdFunction:a,edgeGenerator:l,separateEdgesByDirection:u,groupEdges:!0,groupSelfLoopEdges:!0,duration:t,easing:e,enabled:r})}resetContext(){super.resetContext(),this.context={...this.context,metaEdges:this.ogma.edgeList(),subEdges:this.ogma.edgeList()}}getName(){return Zn.EdgeGrouping}run(){let t,e;const s=this.module.animations,n=new Set(this.context.metaEdges.getId());return this.addMetaEdges().then((({metaEdges:i})=>{t=i,e=this.module.getSubEdges(t),t.setVisible(!0),e.setVisible(!1),s.hideEdges(e._indexes);const r=t.concat(this.context.metaEdges).getParallelEdges().dedupe().filter((u=>!n.has(u.getId()))),o=new Array(r.size),a=new Map;for(let u=0;u<r.size;u++)o[u]=this.ogma.modules.curvatureManager.computeCurvature(r.get(u),"visible"),a.set(r._indexes[u],o[u]);const l=this.module.getSubEdges(r);l.setVisible(!0),this.module.animations.setCurvatures(r._indexes,o);for(let u=0;u<l._indexes.length;u++)this.module.animations.setCurvature(e._indexes[u],a.get(this.module.getMetaEdge(e.get(u))._index)||0)})).then((()=>{this.context.metaEdges=t,this.context.subEdges=e}))}undo(t=!0){super.undo(t);const{metaEdges:e,subEdges:s}=this.context;if(s.setVisible(!0),e.setVisible(!1),!t)return Promise.resolve();const n=s.getParallelEdges().dedupe(),i=new Array(n.size),r=new Map;for(let o=0;o<n.size;o++)i[o]=this.ogma.modules.curvatureManager.computeCurvature(n.get(o),"visible"),r.set(n._indexes[o],i[o]);return this.module.animations.setCurvatures(n._indexes,i),Promise.resolve()}onRemove(t,e){e||(this.context.subEdges=this.context.subEdges.filter((s=>!t.has(s._index))))}_getCurvatures(t){return t.map((e=>this.ogma.modules.curvatureManager.computeCurvature(e,"visible",(()=>!0))))}cleanup(){const{metaEdges:t}=this.context;return this.module.removeMetaEdges(t),this.ogma.removeEdges(t,{virtual:!0}).then((()=>(this.context.metaEdges=this.ogma.edgeList(),this.context.subEdges=this.ogma.edgeList(),Promise.resolve())))}setOptions({duration:t,easing:e,enabled:s,selector:n,groupIdFunction:i,generator:r,separateEdgesByDirection:o}){return super.setOptions({nodeSelector:void 0,nodeGroupIdFunction:void 0,nodeGenerator:void 0,edgeSelector:n,edgeGroupIdFunction:i,edgeGenerator:r,separateEdgesByDirection:o,groupEdges:!0,duration:t,easing:e,enabled:s})}},QA=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],T_=1,dd=8,eY=class BN{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,n]=new Uint8Array(e,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const i=n>>4;if(i!==T_)throw new Error(`Got v${i} data when expected v${T_}.`);const r=QA[15&n];if(!r)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(e,2,1),[a]=new Uint32Array(e,4,1);return new BN(a,o,r,e)}constructor(e,s=64,n=Float64Array,i){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const r=QA.indexOf(this.ArrayType),o=2*e*this.ArrayType.BYTES_PER_ELEMENT,a=e*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-a%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${n}.`);i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,dd,e),this.coords=new this.ArrayType(this.data,dd+a+l,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(dd+o+a+l),this.ids=new this.IndexArrayType(this.data,dd,e),this.coords=new this.ArrayType(this.data,dd+a+l,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(T_<<4)+r]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=e)}add(e,s){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=s,n}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return fx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,s,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:o,nodeSize:a}=this,l=[0,r.length-1,0],u=[];for(;l.length;){const h=l.pop()||0,g=l.pop()||0,f=l.pop()||0;if(g-f<=a){for(let x=f;x<=g;x++){const v=o[2*x],b=o[2*x+1];v>=e&&v<=n&&b>=s&&b<=i&&u.push(r[x])}continue}const p=f+g>>1,y=o[2*p],_=o[2*p+1];y>=e&&y<=n&&_>=s&&_<=i&&u.push(r[p]),(h===0?e<=y:s<=_)&&(l.push(f),l.push(p-1),l.push(1-h)),(h===0?n>=y:i>=_)&&(l.push(p+1),l.push(g),l.push(1-h))}return u}within(e,s,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:r,nodeSize:o}=this,a=[0,i.length-1,0],l=[],u=n*n;for(;a.length;){const h=a.pop()||0,g=a.pop()||0,f=a.pop()||0;if(g-f<=o){for(let x=f;x<=g;x++)JA(r[2*x],r[2*x+1],e,s)<=u&&l.push(i[x]);continue}const p=f+g>>1,y=r[2*p],_=r[2*p+1];JA(y,_,e,s)<=u&&l.push(i[p]),(h===0?e-n<=y:s-n<=_)&&(a.push(f),a.push(p-1),a.push(1-h)),(h===0?e+n>=y:s+n>=_)&&(a.push(p+1),a.push(g),a.push(1-h))}return l}};function fx(t,e,s,n,i,r){if(i-n<=s)return;const o=n+i>>1;UN(t,e,o,n,i,r),fx(t,e,s,n,o-1,1-r),fx(t,e,s,o+1,i,1-r)}function UN(t,e,s,n,i,r){for(;i>n;){if(i-n>600){const u=i-n+1,h=s-n+1,g=Math.log(u),f=.5*Math.exp(2*g/3),p=.5*Math.sqrt(g*f*(u-f)/u)*(h-u/2<0?-1:1);UN(t,e,s,Math.max(n,Math.floor(s-h*f/u+p)),Math.min(i,Math.floor(s+(u-h)*f/u+p)),r)}const o=e[2*s+r];let a=n,l=i;for(hd(t,e,n,s),e[2*i+r]>o&&hd(t,e,n,i);a<l;){for(hd(t,e,a,l),a++,l--;e[2*a+r]<o;)a++;for(;e[2*l+r]>o;)l--}e[2*n+r]===o?hd(t,e,n,l):(l++,hd(t,e,l,i)),l<=s&&(n=l+1),s<=l&&(i=l-1)}}function hd(t,e,s,n){C_(t,s,n),C_(e,2*s,2*n),C_(e,2*s+1,2*n+1)}function C_(t,e,s){const n=t[e];t[e]=t[s],t[s]=n}function JA(t,e,s,n){const i=t-s,r=e-n;return i*i+r*r}var sY=t=>t/360+.5,nY=t=>{const e=Math.sin(t*Math.PI/180),s=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return s<0?0:s>1?1:s},iY=t=>{const e=Math.PI-2*Math.PI*t;return 360/Math.PI*Math.atan(Math.exp(e))-90},rY=t=>360*(t-.5);function oY(t,e,s,n,i,r){let o=t._indexes.length;const a=t.getData(r.modules.geo.latitudePath),l=t.getData(r.modules.geo.longitudePath),u=new Float32Array(o),h=new Float32Array(o),g=new Uint32Array(o),f=new Uint32Array(o),p=new Map,y=new Map;let _,x=-1,v=!0;for(let L=0;L<a.length;L++){const I=a[L],F=l[L];y.set(t._indexes[L],e[L]);const O=nY(I),V=sY(F);u[L]=O,h[L]=V,g[L]=t._indexes[L],x=Math.max(x,t._indexes[L])}let b=x+1;const[S,A]=s,w=[];for(let L=0,I=A;L<20;L++,I=A-(A-S)*L/19){if(v){_=new eY(o,64,Float32Array);for(let K=0;K<o;K++)_.add(h[K],u[K]);_.finish()}v=!1;const F=n/(i*Math.pow(2,I)),O=[],V=new Set,j=new Set;for(let K=0;K<o;K++){if(V.has(g[K]))continue;const ut=_.within(h[K],u[K],F);if(ut.length===0&&ut.push(K),ut.length===1){const pe=g[ut[0]];if(V.add(pe),p.has(pe)){j.add(pe);const ne=p.get(pe);O.push(ne),p.set(ne.id,ne),y.set(ne.id,ne.groupId)}continue}const ht=b++,nt=[];let ot=0;const Nt=y.get(g[K]);let Q=0,Et=0;for(let pe=0;pe<ut.length;pe++){const ne=ut[pe];if(!V.has(g[ne])&&Nt===y.get(g[ne])){if(V.add(g[ne]),j.add(g[ne]),p.has(g[ne])){const te=p.get(g[ne]),se=te.subNodes.size;ot+=se,Q+=te.mercatorLat*se,Et+=te.mercatorLng*se}else ot+=1,Q+=u[ne],Et+=h[ne];nt.push(g[ne])}}if(Q/=ot,Et/=ot,ot<2){j.delete(g[K]);continue}const Xt=new Uint32Array(ot);let Ht=0;for(let pe=0;pe<nt.length;pe++){const ne=nt[pe];if(p.has(ne)){const te=p.get(ne);for(let se=0;se<te.subNodes.size;se++)Xt[Ht++]=te.subNodes._indexes[se]}else Xt[Ht++]=ne}const Zt=r.nodeList(Xt);y.set(ht,Nt);const ae={id:ht,groupId:Nt,zoom:I,lat:iY(Q),lng:rY(Et),mercatorLat:Q,mercatorLng:Et,subNodes:Zt};p.set(ae.id,ae),O.push(ae),v=!0}let Z=0,at=0;for(let K=0;K<o;K++)j.has(g[K])||(g[Z]=g[K],u[Z]=u[K],h[Z]=h[K],f[at]=g[K],Z++,at++);const pt=new Uint32Array(at);for(let K=0;K<at;K++)pt[K]=f[K];for(const K of O)g[Z]=K.id,u[Z]=K.mercatorLat,h[Z]=K.mercatorLng,Z++;o=at+O.length,(!(L>0)||O.length)&&w.push({zoom:I,clusters:O,unclusteredNodeIndexes:pt})}return w}var aY=256,lY=class extends ON{constructor(t){super({...t,enabled:t.enabled&&t.ogma.geo.enabled(),showContents:!1,selector:e=>{const s=this.getPosition(e);return s&&!isNaN(s.x)&&!isNaN(s.y)&&(!t.selector||t.selector(e))},groupIdFunction:t.groupIdFunction,edgeGroupIdFunction:t.edgeGroupIdFunction,nodeGenerator:t.nodeGenerator}),this._clustersByZoom=[],this._nullZoomLevel={zoom:-1/0,nodes:this.ogma.nodeList(),edges:this.ogma.edgeList(),metaNodes:this.ogma.nodeList(),subNodes:[],subEdges:[],metaEdges:this.ogma.edgeList()},this._currentClusters=this._nullZoomLevel,this._zoomLevels=t.zoomLevels?t.zoomLevels:[0,22],this._groupingRadius=t.radius===void 0?60:t.radius,this._generateIdFunction=t.groupIdFunction||(()=>""),this._shouldEnable=t.enabled,this._shouldRefreshClusters=!0,this._selectedNodes=this.ogma.nodeList(),this._selectedEdges=this.ogma.edgeList(),this.ogma.events.on("beforeGeoCameraMove",(({zoom:e})=>{!this.isEnabled()||!this.ogma.geo.enabled()||Math.abs(this.getBestZoomLevel(e).zoom-this._currentClusters.zoom)<.01||(this._shouldRefreshClusters=!1,this.refresh())})).on("geoDisabled",(()=>{this.isEnabled()&&this.disable(0).then((()=>{this._shouldEnable=!0}))})).on("geoEnabled",(()=>{this._shouldEnable&&this.enable(0)}))}getPosition(t){return{x:t.getData(this.ogma.modules.geo.latitudePath),y:t.getData(this.ogma.modules.geo.longitudePath)}}getName(){return Zn.GeoClustering}enable(t){return this.ogma&&!this.ogma.geo.enabled()?(this._shouldEnable=!0,Promise.resolve()):super.enable(t)}undo(t=!0){const{metaNodes:e,metaEdges:s}=this._currentClusters;return e.setVisible(!1),s.setVisible(!1),this._selectedNodes.setVisible(!0),this._selectedEdges.setVisible(!0),Promise.resolve()}disable(t){return this._shouldEnable=!1,super.disable(t)}async onePassCluster(){for(let i=0;i<this._clustersByZoom.length;i++){const r=this._clustersByZoom[i];this.module.removeMetaNodes(r.metaNodes),this.module.removeMetaEdges(r.metaEdges),await this.ogma.removeNodes(r.metaNodes,{virtual:!0}),await this.ogma.removeEdges(r.metaEdges,{virtual:!0})}const t=this.ogma.getNodes().filter((i=>this.nodeSelector(i)));this._selectedEdges=t.getAdjacentEdges({bothExtremities:!0});const e=[],s=t.map((i=>this._generateIdFunction(i))),n=oY(t,s,this._zoomLevels,this._groupingRadius,aY,this.ogma);for(let i=0;i<n.length;i++){const{clusters:r,zoom:o,unclusteredNodeIndexes:a}=n[i],l=r.map((({id:_,groupId:x,lat:v,lng:b,subNodes:S})=>{const A=this.nodeGenerator(S,x,this);return A.data||(A.data={}),Ia(A.data,this.ogma.modules.geo.latitudePath,v),Ia(A.data,this.ogma.modules.geo.longitudePath,b),A.id=`geo-cluster-${_}-${x}`,A}));await this.ogma.addNodes(l,{virtual:!0});const u=this.ogma.getNodes(r.map((_=>`geo-cluster-${_.id}-${_.groupId}`))),h=r.map((_=>_.subNodes));this.assignMetaSubNodes(u,h);const{metaEdges:g,subEdges:f}=await this.addMetaEdges(u),p=this.ogma.nodeList(a),y=p.getAdjacentEdges({bothExtremities:!0});this.module.removeMetaNodes(u),this.module.removeMetaEdges(g),u.setVisible(!1),g.setVisible(!1),e.push({nodes:p,edges:y,zoom:o,metaNodes:u,subNodes:h,subEdges:f,metaEdges:g})}this._clustersByZoom=e,this._selectedNodes=t}getBestZoomLevel(t){return this._clustersByZoom.reduce(((e,s)=>t<s.zoom?s:e),this._nullZoomLevel)}async run(){var t;this._shouldRefreshClusters&&await this.onePassCluster(),this._shouldRefreshClusters=!0;const e=this._currentClusters,s=((t=this.ogma.geo.getMap())==null?void 0:t.getZoom())||0,n=this.getBestZoomLevel(s);return this._currentClusters=n,e&&(this.module.removeMetaNodes(e.metaNodes),this.module.removeMetaEdges(e.metaEdges)),this._selectedEdges.setVisible(!1),this._selectedNodes.setVisible(!1),n.nodes.setVisible(!0),n.edges.setVisible(!0),n.metaNodes.setVisible(!0),n.metaEdges.setVisible(!0),this.assignMetaSubNodes(n.metaNodes,n.subNodes),this.assignMetaSubEdges(n.metaEdges,n.subEdges),this.ogma.modules.geo._updateNodesCoordinates(n.metaNodes),this.ogma.modules.geo.updateProjection(),[]}setOptions(t){const e=super.setOptions({...t,selector:s=>{const n=this.getPosition(s);return n&&!isNaN(n.x)&&!isNaN(n.y)&&(!t.selector||t.selector(s))},groupIdFunction:t.groupIdFunction,nodeGenerator:t.nodeGenerator,edgeGroupIdFunction:t.edgeGroupIdFunction});return this._groupingRadius=t.radius===void 0?this._groupingRadius:t.radius,this._generateIdFunction=t.groupIdFunction||this._generateIdFunction,this._shouldRefreshClusters=!0,this._shouldEnable=t.enabled,this._zoomLevels=t.zoomLevels!==void 0?t.zoomLevels:this._zoomLevels,e}},tw=()=>({}),uY=class extends na{constructor(t){super(t),this._groupSelfLoopEdges=!1,this._isCleaningUp=!1,this._isRunning=!1,this.shouldDo=!0,this.enabled=!1,this._onBeforeAdd=e=>{if(this._isCleaningUp||!this.enabled||e.virtual)return;const{isNode:s,objects:n}=e;if(s){const i=n;ew(i,this._groupNodes(i))}else{const i=n;ew(i,this._groupEdges(i))}this._shouldSetVirtual=!0},this._onAfterAdd=e=>{this._shouldSetVirtual&&(this._shouldSetVirtual=!1,this._setVirtual(e.nodes||e.edges,!!e.nodes))},this._onRequestElementsToDelete=e=>{if(e.virtual)return;const{ogma:s,context:n}=this,i=e.elementsToRemove.isNode,r=i?s.getNodes:s.getEdges,o=i?n.metaNodesSet:n.metaEdgesSet,a=i?n.nodeGroups:n.edgeGroups,l=i?s.removeNodes:s.removeEdges,u=e.elementsToRemove.size,h=r(Array.from(o)),g=e.elementsToRemove.slice();if(e.elementsToRemove=e.elementsToRemove.subtract(h),e.elementsToRemove.size===u)return;const f=g.subtract(e.elementsToRemove);if(f.forEach((p=>{a.delete(p.getId())})),i){const p=f.getAdjacentEdges().filter((y=>y.isVirtual()));s.removeEdges(p)}l(f,{virtual:!0})},this._nodeToGroupId=t.groupIdFunction||_u,this._groupSelfLoopEdges=!!t.groupSelfLoopEdges,this._nodeGenerator=t.nodeGenerator||tw,this._edgeGenerator=t.edgeGenerator||tw,this._shouldSetVirtual=!1,this._selector=t.selector,this.shouldDo=t.enabled===void 0||!!t.enabled,this.ogma.events.on("preAddElements",this._onBeforeAdd).on("requestElementsToDelete",this._onRequestElementsToDelete).on(["postAddGraph","addNodes","addEdges"],this._onAfterAdd),this.shouldDo&&(this.enable(),this.shouldDo=!1)}getName(){return Zn.NodeClustering}enable(){if(this.enabled)return Promise.resolve();this.enabled=!0,this.shouldDo=!0,this._isRunning=!0;const{ogma:t}=this;return t.getNodes().size?t.export.json({download:!1,edgeAttributes:"all",nodeAttributes:"all"}).then((e=>(t.clearGraph(),t.setGraph(e)))).then((()=>(this._isRunning=!1,Promise.resolve()))):(this._isRunning=!1,Promise.resolve())}disable(){return this.enabled?(this.enabled=!1,this.shouldDo=!1,super.disable()):Promise.resolve()}destroy(){return this.disable(),super.destroy()}run(){const{ogma:t}=this;return this.enabled||!this.shouldDo?Promise.resolve():t.export.json({download:!1,edgeAttributes:"all",nodeAttributes:"all"}).then((e=>(this._isCleaningUp=!0,t.clearGraph(),this._isCleaningUp=!1,t.setGraph(e))))}undo(){if(this._isRunning||this.enabled)return Promise.resolve();const{ogma:t,context:e}=this;this._isCleaningUp=!0;const s=t.getNodes(Array.from(e.metaNodesSet));this.module.removeMetaNodes(s);const n=t.getEdges(Array.from(e.metaEdgesSet));this.module.removeMetaEdges(n);const i=this._getSubNodes(),r=this._getSubEdges();return this.resetContext(),t.removeNodes(s,{virtual:!0}).then((()=>t.removeEdges(n,{virtual:!0}))).then((()=>t.addNodes(i))).then((()=>t.addEdges(r))).then((()=>{this._isCleaningUp=!1,Promise.resolve()}))}cleanup(){return this._isRunning||this.ogma.events.off(this._onBeforeAdd).off(this._onRequestElementsToDelete).off(this._onAfterAdd),Promise.resolve()}resetContext(){this._isRunning||(this.context={nodeGroups:new Map,edgeGroups:new Map,metaNodesSet:new Set,metaEdgesSet:new Set,virtualNodes:this.ogma.createNodeList(),virtualEdges:this.ogma.createEdgeList(),nodeToGroupId:new Map})}getSubNodes(t){const e=this.context.nodeGroups.get(t.getId());return e?e.nodes:[]}getSubEdges(t){const e=this.context.edgeGroups.get(t.getId());return e?e.edges:[]}_getSubNodes(){return Array.from(this.context.nodeGroups.values()).reduce(((t,{nodes:e})=>(t.push(...e),t)),[])}_getSubEdges(){return Array.from(this.context.edgeGroups.values()).reduce(((t,{edges:e})=>(t.push(...e),t)),[])}_setVirtual(t,e){if(!t)return;const{context:s}=this,n=e?s.metaNodesSet:s.metaEdgesSet,i=t.filter((r=>n.has(r.getId())));if(e)for(let r=0;r<i.size;r++)this.module.setTransformation(i._indexes[r],this,e),this.module.setSubNodes(i._indexes[r],null);else for(let r=0;r<i.size;r++)this.module.setTransformation(i._indexes[r],this,e),this.module.setSubEdges(i._indexes[r],null);e?s.virtualNodes=s.virtualNodes.concat(i):s.virtualEdges=s.virtualEdges.concat(i)}setContext(){}_computeEdgeGroupId(t,e){return t>e?`${e}:${t}`:`${t}:${e}`}_groupEdges(t){const{ogma:e,id:s,context:n}=this,i=s,r=new Map,o=n.nodeToGroupId;n.edgeGroups.forEach((h=>{h.newEdges=[],r.set(h.id,h)}));const a=[];for(let h=0;h<t.length;++h){const g=t[h];let f=n.nodeToGroupId.get(g.source),p=n.nodeToGroupId.get(g.target);if(!f&&!p){a.push(g);continue}f=f||g.source,p=p||g.target;const y=this._computeEdgeGroupId(f,p);if(y!==void 0){const _=o.get(g.source)||g.source,x=o.get(g.target)||g.target;let v=r.get(y);v||(v={id:y,source:_,target:x,edges:[],newEdges:[]},r.set(y,v)),v.edges.push(g),v.newEdges.push(g)}}const l=kf(r),u=l.map((({edges:h})=>h));for(let h=0;h<l.length;++h){const g=l[h];if(!g.newEdges.length)continue;const f=g.id,p=u[h],y=this._edgeGenerator(p,f);y.id===void 0&&(y.id=Lf(f,i)),y.source=g.source,y.target=g.target,g.metaEdge=y,n.metaEdgesSet.add(y.id),n.edgeGroups.get(y.id)||n.edgeGroups.set(y.id,g),(this._groupSelfLoopEdges||y.source!==y.target)&&a.push(y)}return e.view.afterNextFrame().then((()=>{n.edgeGroups.forEach((({newEdges:h,metaEdge:g})=>{if(!(h.length&&g&&g.id&&g.attributes))return;const f=e.getEdge(g.id);f==null||f.setAttributes(g.attributes)}))})),a}_groupNodes(t){const{id:e,context:s,ogma:n}=this,i=e,r=new Map;s.nodeGroups.forEach((g=>{g.newNodes=[],r.set(g.id,g)}));const o=[];for(let g=0;g<t.length;g++){const f=t[g];if(this._selector&&!this._selector(f)){o.push(f);continue}f.id=Nq(f.id);const p=this._nodeToGroupId(f);if(p!==void 0){let y=r.get(p);y||(y={id:p,nodes:[],newNodes:[]},r.set(p,y)),y.nodes.push(f),y.newNodes.push(f)}else s.nodeToGroupId.set(f.id,f.id)}const a=kf(r),l=a.map((({nodes:g})=>g)),u=a.map((({newNodes:g})=>g)),h=[];for(let g=0;g<a.length;++g){if(!a[g].newNodes.length)continue;const f=a[g].id,p=l[g],y=this._nodeGenerator(p,f);a[g].metaNode=y,y.id===void 0&&(y.id=Lf(f,i));for(const _ of u[g])s.nodeToGroupId.set(_.id,y.id);s.metaNodesSet.add(y.id),s.nodeGroups.get(y.id)||s.nodeGroups.set(y.id,a[g]),h.push(y)}return h.push(...o),n.view.afterNextFrame().then((()=>{s.nodeGroups.forEach((({newNodes:g,metaNode:f})=>{if(!(g.length&&f&&f.id&&f.attributes))return;const p=n.getNode(f.id);p==null||p.setAttributes(f.attributes)}))})),h}setOptions(t){return this._nodeToGroupId=t.groupIdFunction||this._nodeToGroupId,this._groupSelfLoopEdges=t.groupSelfLoopEdges!==void 0?!!t.groupSelfLoopEdges:this._groupSelfLoopEdges,this._nodeGenerator=t.nodeGenerator||this._nodeGenerator,this._edgeGenerator=t.edgeGenerator||this._edgeGenerator,this._selector=t.selector||this._selector,this.disable().then((()=>this.undo())).then((()=>this.ogma.view.afterNextFrame())).then((()=>this.enable()))}onRemove(){}};function ew(t,e){const s=e.length;return t.length=s,t.splice(0,s,...e),t}function Yr(t){return t.enabled!==!1}var dY=class extends Bq{_setOptions(t){const e=t;return e.ogma=this.ogma,e.module=this,e.id=this.transformations.length,e}addNodeGrouping(t={}){const e=new ON(this._setOptions(t));return this.addTransformation(e,Yr(t)),e}addEdgeGrouping(t={}){const e=new tY(this._setOptions(t));return this.addTransformation(e,Yr(t)),e}addGeoClustering(t={}){const e=new lY(this._setOptions(t));return this.addTransformation(e,t.enabled),e}addNodeFilter(t={}){let e={};e=typeof t=="function"?{criteria:t}:t;const s=new jq(this._setOptions(e));return this.addTransformation(s,Yr(e)),s}addEdgeFilter(t={}){let e={};e=typeof t=="function"?{criteria:t}:t;const s=new Hq(this._setOptions(e));return this.addTransformation(s,Yr(e)),s}addNeighborMerging(t){const e=new $q(this._setOptions(t));return this.addTransformation(e,Yr(t)),e}addNeighborGeneration(t){const e=new Wq(this._setOptions(t));return this.addTransformation(e,Yr(t)),e}addNodeCollapsing(t={}){const e=new Kq(this._setOptions(t));return this.addTransformation(e,Yr(t)),e}addVirtualProperties(t={}){const e=new Jq(this._setOptions(t));return this.addTransformation(e,Yr(t)),e}addNodeClustering(t={}){const e=new uY(this._setOptions(t));return this.addTransformation(e,Yr(t)),e}addDrilldown(t={onGetSubgraph:()=>Promise.resolve({nodes:[],edges:[]})}){const e=new Mq(this._setOptions(t));return this.drilldownController.addDrilldown(e),e}onGroupsUpdated(t){this.groupController.layoutController.onGroupsUpdate=t}triggerGroupsUpdated(){this.groupController.triggerGroupsUpdate()}layoutGroups(t,e,s=!1){return this.groupController.layoutGroups(t,e,s)}getXYR(t){return this.animations.getXYR(t)}fishEyeExpand(t,e,s){return this.groupController.fishEyeExpand(t,e,s)}fishEyeCollapse(t,e){return this.groupController.fishEyeCollapse(t,e)}},hY=D0,jt=ph();const rs=RI(jt);var zo={},Sa={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sw;function cY(){if(sw)return Sa;sw=1;var t=ph();function e(C){for(var R="https://reactjs.org/docs/error-decoder.html?invariant="+C,U=1;U<arguments.length;U++)R+="&args[]="+encodeURIComponent(arguments[U]);return"Minified React error #"+C+"; visit "+R+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=Object.prototype.hasOwnProperty,n=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,i={},r={};function o(C){return s.call(r,C)?!0:s.call(i,C)?!1:n.test(C)?r[C]=!0:(i[C]=!0,!1)}function a(C,R,U,W,St,bt,It){this.acceptsBooleans=R===2||R===3||R===4,this.attributeName=W,this.attributeNamespace=St,this.mustUseProperty=U,this.propertyName=C,this.type=R,this.sanitizeURL=bt,this.removeEmptyString=It}var l={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(C){l[C]=new a(C,0,!1,C,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(C){var R=C[0];l[R]=new a(R,1,!1,C[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(C){l[C]=new a(C,2,!1,C.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(C){l[C]=new a(C,2,!1,C,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(C){l[C]=new a(C,3,!1,C.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(C){l[C]=new a(C,3,!0,C,null,!1,!1)}),["capture","download"].forEach(function(C){l[C]=new a(C,4,!1,C,null,!1,!1)}),["cols","rows","size","span"].forEach(function(C){l[C]=new a(C,6,!1,C,null,!1,!1)}),["rowSpan","start"].forEach(function(C){l[C]=new a(C,5,!1,C.toLowerCase(),null,!1,!1)});var u=/[\-:]([a-z])/g;function h(C){return C[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(C){var R=C.replace(u,h);l[R]=new a(R,1,!1,C,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(C){var R=C.replace(u,h);l[R]=new a(R,1,!1,C,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(C){var R=C.replace(u,h);l[R]=new a(R,1,!1,C,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(C){l[C]=new a(C,1,!1,C.toLowerCase(),null,!1,!1)}),l.xlinkHref=new a("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(C){l[C]=new a(C,1,!1,C.toLowerCase(),null,!0,!0)});var g={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},f=["Webkit","ms","Moz","O"];Object.keys(g).forEach(function(C){f.forEach(function(R){R=R+C.charAt(0).toUpperCase()+C.substring(1),g[R]=g[C]})});var p=/["'&<>]/;function y(C){if(typeof C=="boolean"||typeof C=="number")return""+C;C=""+C;var R=p.exec(C);if(R){var U="",W,St=0;for(W=R.index;W<C.length;W++){switch(C.charCodeAt(W)){case 34:R="&quot;";break;case 38:R="&amp;";break;case 39:R="&#x27;";break;case 60:R="&lt;";break;case 62:R="&gt;";break;default:continue}St!==W&&(U+=C.substring(St,W)),St=W+1,U+=R}C=St!==W?U+C.substring(St,W):U}return C}var _=/([A-Z])/g,x=/^ms-/,v=Array.isArray;function b(C,R){return{insertionMode:C,selectedValue:R}}function S(C,R,U){switch(R){case"select":return b(1,U.value!=null?U.value:U.defaultValue);case"svg":return b(2,null);case"math":return b(3,null);case"foreignObject":return b(1,null);case"table":return b(4,null);case"thead":case"tbody":case"tfoot":return b(5,null);case"colgroup":return b(7,null);case"tr":return b(6,null)}return 4<=C.insertionMode||C.insertionMode===0?b(1,null):C}var A=new Map;function w(C,R,U){if(typeof U!="object")throw Error(e(62));R=!0;for(var W in U)if(s.call(U,W)){var St=U[W];if(St!=null&&typeof St!="boolean"&&St!==""){if(W.indexOf("--")===0){var bt=y(W);St=y((""+St).trim())}else{bt=W;var It=A.get(bt);It!==void 0||(It=y(bt.replace(_,"-$1").toLowerCase().replace(x,"-ms-")),A.set(bt,It)),bt=It,St=typeof St=="number"?St===0||s.call(g,W)?""+St:St+"px":y((""+St).trim())}R?(R=!1,C.push(' style="',bt,":",St)):C.push(";",bt,":",St)}}R||C.push('"')}function L(C,R,U,W){switch(U){case"style":w(C,R,W);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<U.length)||U[0]!=="o"&&U[0]!=="O"||U[1]!=="n"&&U[1]!=="N"){if(R=l.hasOwnProperty(U)?l[U]:null,R!==null){switch(typeof W){case"function":case"symbol":return;case"boolean":if(!R.acceptsBooleans)return}switch(U=R.attributeName,R.type){case 3:W&&C.push(" ",U,'=""');break;case 4:W===!0?C.push(" ",U,'=""'):W!==!1&&C.push(" ",U,'="',y(W),'"');break;case 5:isNaN(W)||C.push(" ",U,'="',y(W),'"');break;case 6:!isNaN(W)&&1<=W&&C.push(" ",U,'="',y(W),'"');break;default:R.sanitizeURL&&(W=""+W),C.push(" ",U,'="',y(W),'"')}}else if(o(U)){switch(typeof W){case"function":case"symbol":return;case"boolean":if(R=U.toLowerCase().slice(0,5),R!=="data-"&&R!=="aria-")return}C.push(" ",U,'="',y(W),'"')}}}function I(C,R,U){if(R!=null){if(U!=null)throw Error(e(60));if(typeof R!="object"||!("__html"in R))throw Error(e(61));R=R.__html,R!=null&&C.push(""+R)}}function F(C){var R="";return t.Children.forEach(C,function(U){U!=null&&(R+=U)}),R}function O(C,R,U,W){C.push(Z(U));var St=U=null,bt;for(bt in R)if(s.call(R,bt)){var It=R[bt];if(It!=null)switch(bt){case"children":U=It;break;case"dangerouslySetInnerHTML":St=It;break;default:L(C,W,bt,It)}}return C.push(">"),I(C,St,U),typeof U=="string"?(C.push(y(U)),null):U}var V=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,j=new Map;function Z(C){var R=j.get(C);if(R===void 0){if(!V.test(C))throw Error(e(65,C));R="<"+C,j.set(C,R)}return R}function at(C,R,U,W,St){switch(R){case"select":C.push(Z("select"));var bt=null,It=null;for(we in U)if(s.call(U,we)){var Qt=U[we];if(Qt!=null)switch(we){case"children":bt=Qt;break;case"dangerouslySetInnerHTML":It=Qt;break;case"defaultValue":case"value":break;default:L(C,W,we,Qt)}}return C.push(">"),I(C,It,bt),bt;case"option":It=St.selectedValue,C.push(Z("option"));var ie=Qt=null,Ee=null,we=null;for(bt in U)if(s.call(U,bt)){var We=U[bt];if(We!=null)switch(bt){case"children":Qt=We;break;case"selected":Ee=We;break;case"dangerouslySetInnerHTML":we=We;break;case"value":ie=We;default:L(C,W,bt,We)}}if(It!=null)if(U=ie!==null?""+ie:F(Qt),v(It)){for(W=0;W<It.length;W++)if(""+It[W]===U){C.push(' selected=""');break}}else""+It===U&&C.push(' selected=""');else Ee&&C.push(' selected=""');return C.push(">"),I(C,we,Qt),Qt;case"textarea":C.push(Z("textarea")),we=It=bt=null;for(Qt in U)if(s.call(U,Qt)&&(ie=U[Qt],ie!=null))switch(Qt){case"children":we=ie;break;case"value":bt=ie;break;case"defaultValue":It=ie;break;case"dangerouslySetInnerHTML":throw Error(e(91));default:L(C,W,Qt,ie)}if(bt===null&&It!==null&&(bt=It),C.push(">"),we!=null){if(bt!=null)throw Error(e(92));if(v(we)&&1<we.length)throw Error(e(93));bt=""+we}return typeof bt=="string"&&bt[0]===`
`&&C.push(`
`),bt!==null&&C.push(y(""+bt)),null;case"input":C.push(Z("input")),ie=we=Qt=bt=null;for(It in U)if(s.call(U,It)&&(Ee=U[It],Ee!=null))switch(It){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,"input"));case"defaultChecked":ie=Ee;break;case"defaultValue":Qt=Ee;break;case"checked":we=Ee;break;case"value":bt=Ee;break;default:L(C,W,It,Ee)}return we!==null?L(C,W,"checked",we):ie!==null&&L(C,W,"checked",ie),bt!==null?L(C,W,"value",bt):Qt!==null&&L(C,W,"value",Qt),C.push("/>"),null;case"menuitem":C.push(Z("menuitem"));for(var us in U)if(s.call(U,us)&&(bt=U[us],bt!=null))switch(us){case"children":case"dangerouslySetInnerHTML":throw Error(e(400));default:L(C,W,us,bt)}return C.push(">"),null;case"title":C.push(Z("title")),bt=null;for(We in U)if(s.call(U,We)&&(It=U[We],It!=null))switch(We){case"children":bt=It;break;case"dangerouslySetInnerHTML":throw Error(e(434));default:L(C,W,We,It)}return C.push(">"),bt;case"listing":case"pre":C.push(Z(R)),It=bt=null;for(ie in U)if(s.call(U,ie)&&(Qt=U[ie],Qt!=null))switch(ie){case"children":bt=Qt;break;case"dangerouslySetInnerHTML":It=Qt;break;default:L(C,W,ie,Qt)}if(C.push(">"),It!=null){if(bt!=null)throw Error(e(60));if(typeof It!="object"||!("__html"in It))throw Error(e(61));U=It.__html,U!=null&&(typeof U=="string"&&0<U.length&&U[0]===`
`?C.push(`
`,U):C.push(""+U))}return typeof bt=="string"&&bt[0]===`
`&&C.push(`
`),bt;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":C.push(Z(R));for(var ms in U)if(s.call(U,ms)&&(bt=U[ms],bt!=null))switch(ms){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,R));default:L(C,W,ms,bt)}return C.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return O(C,U,R,W);case"html":return St.insertionMode===0&&C.push("<!DOCTYPE html>"),O(C,U,R,W);default:if(R.indexOf("-")===-1&&typeof U.is!="string")return O(C,U,R,W);C.push(Z(R)),It=bt=null;for(Ee in U)if(s.call(U,Ee)&&(Qt=U[Ee],Qt!=null))switch(Ee){case"children":bt=Qt;break;case"dangerouslySetInnerHTML":It=Qt;break;case"style":w(C,W,Qt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:o(Ee)&&typeof Qt!="function"&&typeof Qt!="symbol"&&C.push(" ",Ee,'="',y(Qt),'"')}return C.push(">"),I(C,It,bt),bt}}function pt(C,R,U){if(C.push('<!--$?--><template id="'),U===null)throw Error(e(395));return C.push(U),C.push('"></template>')}function K(C,R,U,W){switch(U.insertionMode){case 0:case 1:return C.push('<div hidden id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 2:return C.push('<svg aria-hidden="true" style="display:none" id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 3:return C.push('<math aria-hidden="true" style="display:none" id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 4:return C.push('<table hidden id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 5:return C.push('<table hidden><tbody id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 6:return C.push('<table hidden><tr id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 7:return C.push('<table hidden><colgroup id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');default:throw Error(e(397))}}function ut(C,R){switch(R.insertionMode){case 0:case 1:return C.push("</div>");case 2:return C.push("</svg>");case 3:return C.push("</math>");case 4:return C.push("</table>");case 5:return C.push("</tbody></table>");case 6:return C.push("</tr></table>");case 7:return C.push("</colgroup></table>");default:throw Error(e(397))}}var ht=/[<\u2028\u2029]/g;function nt(C){return JSON.stringify(C).replace(ht,function(R){switch(R){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function ot(C,R){return R=R===void 0?"":R,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:R+"P:",segmentPrefix:R+"S:",boundaryPrefix:R+"B:",idPrefix:R,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:C}}function Nt(C,R,U,W){return U.generateStaticMarkup?(C.push(y(R)),!1):(R===""?C=W:(W&&C.push("<!-- -->"),C.push(y(R)),C=!0),C)}var Q=Object.assign,Et=Symbol.for("react.element"),Xt=Symbol.for("react.portal"),Ht=Symbol.for("react.fragment"),Zt=Symbol.for("react.strict_mode"),ae=Symbol.for("react.profiler"),pe=Symbol.for("react.provider"),ne=Symbol.for("react.context"),te=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),Ce=Symbol.for("react.memo"),ve=Symbol.for("react.lazy"),Ne=Symbol.for("react.scope"),ge=Symbol.for("react.debug_trace_mode"),ze=Symbol.for("react.legacy_hidden"),is=Symbol.for("react.default_value"),Ge=Symbol.iterator;function De(C){if(C==null)return null;if(typeof C=="function")return C.displayName||C.name||null;if(typeof C=="string")return C;switch(C){case Ht:return"Fragment";case Xt:return"Portal";case ae:return"Profiler";case Zt:return"StrictMode";case se:return"Suspense";case ce:return"SuspenseList"}if(typeof C=="object")switch(C.$$typeof){case ne:return(C.displayName||"Context")+".Consumer";case pe:return(C._context.displayName||"Context")+".Provider";case te:var R=C.render;return C=C.displayName,C||(C=R.displayName||R.name||"",C=C!==""?"ForwardRef("+C+")":"ForwardRef"),C;case Ce:return R=C.displayName||null,R!==null?R:De(C.type)||"Memo";case ve:R=C._payload,C=C._init;try{return De(C(R))}catch{}}return null}var He={};function Je(C,R){if(C=C.contextTypes,!C)return He;var U={},W;for(W in C)U[W]=R[W];return U}var ss=null;function ts(C,R){if(C!==R){C.context._currentValue2=C.parentValue,C=C.parent;var U=R.parent;if(C===null){if(U!==null)throw Error(e(401))}else{if(U===null)throw Error(e(401));ts(C,U)}R.context._currentValue2=R.value}}function hs(C){C.context._currentValue2=C.parentValue,C=C.parent,C!==null&&hs(C)}function Fe(C){var R=C.parent;R!==null&&Fe(R),C.context._currentValue2=C.value}function Oe(C,R){if(C.context._currentValue2=C.parentValue,C=C.parent,C===null)throw Error(e(402));C.depth===R.depth?ts(C,R):Oe(C,R)}function Cs(C,R){var U=R.parent;if(U===null)throw Error(e(402));C.depth===U.depth?ts(C,U):Cs(C,U),R.context._currentValue2=R.value}function Fs(C){var R=ss;R!==C&&(R===null?Fe(C):C===null?hs(R):R.depth===C.depth?ts(R,C):R.depth>C.depth?Oe(R,C):Cs(R,C),ss=C)}var Hs={isMounted:function(){return!1},enqueueSetState:function(C,R){C=C._reactInternals,C.queue!==null&&C.queue.push(R)},enqueueReplaceState:function(C,R){C=C._reactInternals,C.replace=!0,C.queue=[R]},enqueueForceUpdate:function(){}};function Ls(C,R,U,W){var St=C.state!==void 0?C.state:null;C.updater=Hs,C.props=U,C.state=St;var bt={queue:[],replace:!1};C._reactInternals=bt;var It=R.contextType;if(C.context=typeof It=="object"&&It!==null?It._currentValue2:W,It=R.getDerivedStateFromProps,typeof It=="function"&&(It=It(U,St),St=It==null?St:Q({},St,It),C.state=St),typeof R.getDerivedStateFromProps!="function"&&typeof C.getSnapshotBeforeUpdate!="function"&&(typeof C.UNSAFE_componentWillMount=="function"||typeof C.componentWillMount=="function"))if(R=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),R!==C.state&&Hs.enqueueReplaceState(C,C.state,null),bt.queue!==null&&0<bt.queue.length)if(R=bt.queue,It=bt.replace,bt.queue=null,bt.replace=!1,It&&R.length===1)C.state=R[0];else{for(bt=It?R[0]:C.state,St=!0,It=It?1:0;It<R.length;It++){var Qt=R[It];Qt=typeof Qt=="function"?Qt.call(C,bt,U,W):Qt,Qt!=null&&(St?(St=!1,bt=Q({},bt,Qt)):Q(bt,Qt))}C.state=bt}else bt.queue=null}var Sn={id:1,overflow:""};function gn(C,R,U){var W=C.id;C=C.overflow;var St=32-ln(W)-1;W&=~(1<<St),U+=1;var bt=32-ln(R)+St;if(30<bt){var It=St-St%5;return bt=(W&(1<<It)-1).toString(32),W>>=It,St-=It,{id:1<<32-ln(R)+St|U<<St|W,overflow:bt+C}}return{id:1<<bt|U<<St|W,overflow:C}}var ln=Math.clz32?Math.clz32:gt,xs=Math.log,Ps=Math.LN2;function gt(C){return C>>>=0,C===0?32:31-(xs(C)/Ps|0)|0}function N(C,R){return C===R&&(C!==0||1/C===1/R)||C!==C&&R!==R}var P=typeof Object.is=="function"?Object.is:N,D=null,B=null,$=null,H=null,X=!1,lt=!1,dt=0,ct=null,mt=0;function yt(){if(D===null)throw Error(e(321));return D}function kt(){if(0<mt)throw Error(e(312));return{memoizedState:null,queue:null,next:null}}function Tt(){return H===null?$===null?(X=!1,$=H=kt()):(X=!0,H=$):H.next===null?(X=!1,H=H.next=kt()):(X=!0,H=H.next),H}function At(){B=D=null,lt=!1,$=null,mt=0,H=ct=null}function Ut(C,R){return typeof R=="function"?R(C):R}function he(C,R,U){if(D=yt(),H=Tt(),X){var W=H.queue;if(R=W.dispatch,ct!==null&&(U=ct.get(W),U!==void 0)){ct.delete(W),W=H.memoizedState;do W=C(W,U.action),U=U.next;while(U!==null);return H.memoizedState=W,[W,R]}return[H.memoizedState,R]}return C=C===Ut?typeof R=="function"?R():R:U!==void 0?U(R):R,H.memoizedState=C,C=H.queue={last:null,dispatch:null},C=C.dispatch=be.bind(null,D,C),[H.memoizedState,C]}function xe(C,R){if(D=yt(),H=Tt(),R=R===void 0?null:R,H!==null){var U=H.memoizedState;if(U!==null&&R!==null){var W=U[1];t:if(W===null)W=!1;else{for(var St=0;St<W.length&&St<R.length;St++)if(!P(R[St],W[St])){W=!1;break t}W=!0}if(W)return U[0]}}return C=C(),H.memoizedState=[C,R],C}function be(C,R,U){if(25<=mt)throw Error(e(301));if(C===D)if(lt=!0,C={action:U,next:null},ct===null&&(ct=new Map),U=ct.get(R),U===void 0)ct.set(R,C);else{for(R=U;R.next!==null;)R=R.next;R.next=C}}function ue(){throw Error(e(394))}function _e(){}var Te={readContext:function(C){return C._currentValue2},useContext:function(C){return yt(),C._currentValue2},useMemo:xe,useReducer:he,useRef:function(C){D=yt(),H=Tt();var R=H.memoizedState;return R===null?(C={current:C},H.memoizedState=C):R},useState:function(C){return he(Ut,C)},useInsertionEffect:_e,useLayoutEffect:function(){},useCallback:function(C,R){return xe(function(){return C},R)},useImperativeHandle:_e,useEffect:_e,useDebugValue:_e,useDeferredValue:function(C){return yt(),C},useTransition:function(){return yt(),[!1,ue]},useId:function(){var C=B.treeContext,R=C.overflow;C=C.id,C=(C&~(1<<32-ln(C)-1)).toString(32)+R;var U=Ve;if(U===null)throw Error(e(404));return R=dt++,C=":"+U.idPrefix+"R"+C,0<R&&(C+="H"+R.toString(32)),C+":"},useMutableSource:function(C,R){return yt(),R(C._source)},useSyncExternalStore:function(C,R,U){if(U===void 0)throw Error(e(407));return U()}},Ve=null,Ie=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function je(C){return console.error(C),null}function Pe(){}function Be(C,R,U,W,St,bt,It,Qt,ie){var Ee=[],we=new Set;return R={destination:null,responseState:R,progressiveChunkSize:W===void 0?12800:W,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:we,pingedTasks:Ee,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:St===void 0?je:St,onAllReady:Pe,onShellReady:It===void 0?Pe:It,onShellError:Pe,onFatalError:Pe},U=es(R,0,null,U,!1,!1),U.parentFlushed=!0,C=Ue(R,C,null,U,we,He,null,Sn),Ee.push(C),R}function Ue(C,R,U,W,St,bt,It,Qt){C.allPendingTasks++,U===null?C.pendingRootTasks++:U.pendingTasks++;var ie={node:R,ping:function(){var Ee=C.pingedTasks;Ee.push(ie),Ee.length===1&&Lt(C)},blockedBoundary:U,blockedSegment:W,abortSet:St,legacyContext:bt,context:It,treeContext:Qt};return St.add(ie),ie}function es(C,R,U,W,St,bt){return{status:0,id:-1,index:R,parentFlushed:!1,chunks:[],children:[],formatContext:W,boundary:U,lastPushedText:St,textEmbedded:bt}}function os(C,R){if(C=C.onError(R),C!=null&&typeof C!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof C+'" instead');return C}function cs(C,R){var U=C.onShellError;U(R),U=C.onFatalError,U(R),C.destination!==null?(C.status=2,C.destination.destroy(R)):(C.status=1,C.fatalError=R)}function Y(C,R,U,W,St){for(D={},B=R,dt=0,C=U(W,St);lt;)lt=!1,dt=0,mt+=1,H=null,C=U(W,St);return At(),C}function et(C,R,U,W){var St=U.render(),bt=W.childContextTypes;if(bt!=null){var It=R.legacyContext;if(typeof U.getChildContext!="function")W=It;else{U=U.getChildContext();for(var Qt in U)if(!(Qt in bt))throw Error(e(108,De(W)||"Unknown",Qt));W=Q({},It,U)}R.legacyContext=W,ft(C,R,St),R.legacyContext=It}else ft(C,R,St)}function J(C,R){if(C&&C.defaultProps){R=Q({},R),C=C.defaultProps;for(var U in C)R[U]===void 0&&(R[U]=C[U]);return R}return R}function tt(C,R,U,W,St){if(typeof U=="function")if(U.prototype&&U.prototype.isReactComponent){St=Je(U,R.legacyContext);var bt=U.contextType;bt=new U(W,typeof bt=="object"&&bt!==null?bt._currentValue2:St),Ls(bt,U,W,St),et(C,R,bt,U)}else{bt=Je(U,R.legacyContext),St=Y(C,R,U,W,bt);var It=dt!==0;if(typeof St=="object"&&St!==null&&typeof St.render=="function"&&St.$$typeof===void 0)Ls(St,U,W,bt),et(C,R,St,U);else if(It){W=R.treeContext,R.treeContext=gn(W,1,0);try{ft(C,R,St)}finally{R.treeContext=W}}else ft(C,R,St)}else if(typeof U=="string"){switch(St=R.blockedSegment,bt=at(St.chunks,U,W,C.responseState,St.formatContext),St.lastPushedText=!1,It=St.formatContext,St.formatContext=S(It,U,W),it(C,R,bt),St.formatContext=It,U){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:St.chunks.push("</",U,">")}St.lastPushedText=!1}else{switch(U){case ze:case ge:case Zt:case ae:case Ht:ft(C,R,W.children);return;case ce:ft(C,R,W.children);return;case Ne:throw Error(e(343));case se:t:{U=R.blockedBoundary,St=R.blockedSegment,bt=W.fallback,W=W.children,It=new Set;var Qt={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:It,errorDigest:null},ie=es(C,St.chunks.length,Qt,St.formatContext,!1,!1);St.children.push(ie),St.lastPushedText=!1;var Ee=es(C,0,null,St.formatContext,!1,!1);Ee.parentFlushed=!0,R.blockedBoundary=Qt,R.blockedSegment=Ee;try{if(it(C,R,W),C.responseState.generateStaticMarkup||Ee.lastPushedText&&Ee.textEmbedded&&Ee.chunks.push("<!-- -->"),Ee.status=1,Ft(Qt,Ee),Qt.pendingTasks===0)break t}catch(we){Ee.status=4,Qt.forceClientRender=!0,Qt.errorDigest=os(C,we)}finally{R.blockedBoundary=U,R.blockedSegment=St}R=Ue(C,bt,U,ie,It,R.legacyContext,R.context,R.treeContext),C.pingedTasks.push(R)}return}if(typeof U=="object"&&U!==null)switch(U.$$typeof){case te:if(W=Y(C,R,U.render,W,St),dt!==0){U=R.treeContext,R.treeContext=gn(U,1,0);try{ft(C,R,W)}finally{R.treeContext=U}}else ft(C,R,W);return;case Ce:U=U.type,W=J(U,W),tt(C,R,U,W,St);return;case pe:if(St=W.children,U=U._context,W=W.value,bt=U._currentValue2,U._currentValue2=W,It=ss,ss=W={parent:It,depth:It===null?0:It.depth+1,context:U,parentValue:bt,value:W},R.context=W,ft(C,R,St),C=ss,C===null)throw Error(e(403));W=C.parentValue,C.context._currentValue2=W===is?C.context._defaultValue:W,C=ss=C.parent,R.context=C;return;case ne:W=W.children,W=W(U._currentValue2),ft(C,R,W);return;case ve:St=U._init,U=St(U._payload),W=J(U,W),tt(C,R,U,W,void 0);return}throw Error(e(130,U==null?U:typeof U,""))}}function ft(C,R,U){if(R.node=U,typeof U=="object"&&U!==null){switch(U.$$typeof){case Et:tt(C,R,U.type,U.props,U.ref);return;case Xt:throw Error(e(257));case ve:var W=U._init;U=W(U._payload),ft(C,R,U);return}if(v(U)){_t(C,R,U);return}if(U===null||typeof U!="object"?W=null:(W=Ge&&U[Ge]||U["@@iterator"],W=typeof W=="function"?W:null),W&&(W=W.call(U))){if(U=W.next(),!U.done){var St=[];do St.push(U.value),U=W.next();while(!U.done);_t(C,R,St)}return}throw C=Object.prototype.toString.call(U),Error(e(31,C==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":C))}typeof U=="string"?(W=R.blockedSegment,W.lastPushedText=Nt(R.blockedSegment.chunks,U,C.responseState,W.lastPushedText)):typeof U=="number"&&(W=R.blockedSegment,W.lastPushedText=Nt(R.blockedSegment.chunks,""+U,C.responseState,W.lastPushedText))}function _t(C,R,U){for(var W=U.length,St=0;St<W;St++){var bt=R.treeContext;R.treeContext=gn(bt,W,St);try{it(C,R,U[St])}finally{R.treeContext=bt}}}function it(C,R,U){var W=R.blockedSegment.formatContext,St=R.legacyContext,bt=R.context;try{return ft(C,R,U)}catch(ie){if(At(),typeof ie=="object"&&ie!==null&&typeof ie.then=="function"){U=ie;var It=R.blockedSegment,Qt=es(C,It.chunks.length,null,It.formatContext,It.lastPushedText,!0);It.children.push(Qt),It.lastPushedText=!1,C=Ue(C,R.node,R.blockedBoundary,Qt,R.abortSet,R.legacyContext,R.context,R.treeContext).ping,U.then(C,C),R.blockedSegment.formatContext=W,R.legacyContext=St,R.context=bt,Fs(bt)}else throw R.blockedSegment.formatContext=W,R.legacyContext=St,R.context=bt,Fs(bt),ie}}function vt(C){var R=C.blockedBoundary;C=C.blockedSegment,C.status=3,Pt(this,R,C)}function Ct(C,R,U){var W=C.blockedBoundary;C.blockedSegment.status=3,W===null?(R.allPendingTasks--,R.status!==2&&(R.status=2,R.destination!==null&&R.destination.push(null))):(W.pendingTasks--,W.forceClientRender||(W.forceClientRender=!0,C=U===void 0?Error(e(432)):U,W.errorDigest=R.onError(C),W.parentFlushed&&R.clientRenderedBoundaries.push(W)),W.fallbackAbortableTasks.forEach(function(St){return Ct(St,R,U)}),W.fallbackAbortableTasks.clear(),R.allPendingTasks--,R.allPendingTasks===0&&(W=R.onAllReady,W()))}function Ft(C,R){if(R.chunks.length===0&&R.children.length===1&&R.children[0].boundary===null){var U=R.children[0];U.id=R.id,U.parentFlushed=!0,U.status===1&&Ft(C,U)}else C.completedSegments.push(R)}function Pt(C,R,U){if(R===null){if(U.parentFlushed){if(C.completedRootSegment!==null)throw Error(e(389));C.completedRootSegment=U}C.pendingRootTasks--,C.pendingRootTasks===0&&(C.onShellError=Pe,R=C.onShellReady,R())}else R.pendingTasks--,R.forceClientRender||(R.pendingTasks===0?(U.parentFlushed&&U.status===1&&Ft(R,U),R.parentFlushed&&C.completedBoundaries.push(R),R.fallbackAbortableTasks.forEach(vt,C),R.fallbackAbortableTasks.clear()):U.parentFlushed&&U.status===1&&(Ft(R,U),R.completedSegments.length===1&&R.parentFlushed&&C.partialBoundaries.push(R)));C.allPendingTasks--,C.allPendingTasks===0&&(C=C.onAllReady,C())}function Lt(C){if(C.status!==2){var R=ss,U=Ie.current;Ie.current=Te;var W=Ve;Ve=C.responseState;try{var St=C.pingedTasks,bt;for(bt=0;bt<St.length;bt++){var It=St[bt],Qt=C,ie=It.blockedSegment;if(ie.status===0){Fs(It.context);try{ft(Qt,It,It.node),Qt.responseState.generateStaticMarkup||ie.lastPushedText&&ie.textEmbedded&&ie.chunks.push("<!-- -->"),It.abortSet.delete(It),ie.status=1,Pt(Qt,It.blockedBoundary,ie)}catch(ds){if(At(),typeof ds=="object"&&ds!==null&&typeof ds.then=="function"){var Ee=It.ping;ds.then(Ee,Ee)}else{It.abortSet.delete(It),ie.status=4;var we=It.blockedBoundary,We=ds,us=os(Qt,We);if(we===null?cs(Qt,We):(we.pendingTasks--,we.forceClientRender||(we.forceClientRender=!0,we.errorDigest=us,we.parentFlushed&&Qt.clientRenderedBoundaries.push(we))),Qt.allPendingTasks--,Qt.allPendingTasks===0){var ms=Qt.onAllReady;ms()}}}finally{}}}St.splice(0,bt),C.destination!==null&&Kt(C,C.destination)}catch(ds){os(C,ds),cs(C,ds)}finally{Ve=W,Ie.current=U,U===Te&&Fs(R)}}}function Yt(C,R,U){switch(U.parentFlushed=!0,U.status){case 0:var W=U.id=C.nextSegmentId++;return U.lastPushedText=!1,U.textEmbedded=!1,C=C.responseState,R.push('<template id="'),R.push(C.placeholderPrefix),C=W.toString(16),R.push(C),R.push('"></template>');case 1:U.status=2;var St=!0;W=U.chunks;var bt=0;U=U.children;for(var It=0;It<U.length;It++){for(St=U[It];bt<St.index;bt++)R.push(W[bt]);St=$t(C,R,St)}for(;bt<W.length-1;bt++)R.push(W[bt]);return bt<W.length&&(St=R.push(W[bt])),St;default:throw Error(e(390))}}function $t(C,R,U){var W=U.boundary;if(W===null)return Yt(C,R,U);if(W.parentFlushed=!0,W.forceClientRender)return C.responseState.generateStaticMarkup||(W=W.errorDigest,R.push("<!--$!-->"),R.push("<template"),W&&(R.push(' data-dgst="'),W=y(W),R.push(W),R.push('"')),R.push("></template>")),Yt(C,R,U),C=C.responseState.generateStaticMarkup?!0:R.push("<!--/$-->"),C;if(0<W.pendingTasks){W.rootSegmentID=C.nextSegmentId++,0<W.completedSegments.length&&C.partialBoundaries.push(W);var St=C.responseState,bt=St.nextSuspenseID++;return St=St.boundaryPrefix+bt.toString(16),W=W.id=St,pt(R,C.responseState,W),Yt(C,R,U),R.push("<!--/$-->")}if(W.byteSize>C.progressiveChunkSize)return W.rootSegmentID=C.nextSegmentId++,C.completedBoundaries.push(W),pt(R,C.responseState,W.id),Yt(C,R,U),R.push("<!--/$-->");if(C.responseState.generateStaticMarkup||R.push("<!--$-->"),U=W.completedSegments,U.length!==1)throw Error(e(391));return $t(C,R,U[0]),C=C.responseState.generateStaticMarkup?!0:R.push("<!--/$-->"),C}function Bt(C,R,U){return K(R,C.responseState,U.formatContext,U.id),$t(C,R,U),ut(R,U.formatContext)}function Gt(C,R,U){for(var W=U.completedSegments,St=0;St<W.length;St++)qt(C,R,U,W[St]);if(W.length=0,C=C.responseState,W=U.id,U=U.rootSegmentID,R.push(C.startInlineScript),C.sentCompleteBoundaryFunction?R.push('$RC("'):(C.sentCompleteBoundaryFunction=!0,R.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),W===null)throw Error(e(395));return U=U.toString(16),R.push(W),R.push('","'),R.push(C.segmentPrefix),R.push(U),R.push('")<\/script>')}function qt(C,R,U,W){if(W.status===2)return!0;var St=W.id;if(St===-1){if((W.id=U.rootSegmentID)===-1)throw Error(e(392));return Bt(C,R,W)}return Bt(C,R,W),C=C.responseState,R.push(C.startInlineScript),C.sentCompleteSegmentFunction?R.push('$RS("'):(C.sentCompleteSegmentFunction=!0,R.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),R.push(C.segmentPrefix),St=St.toString(16),R.push(St),R.push('","'),R.push(C.placeholderPrefix),R.push(St),R.push('")<\/script>')}function Kt(C,R){try{var U=C.completedRootSegment;if(U!==null&&C.pendingRootTasks===0){$t(C,R,U),C.completedRootSegment=null;var W=C.responseState.bootstrapChunks;for(U=0;U<W.length-1;U++)R.push(W[U]);U<W.length&&R.push(W[U])}var St=C.clientRenderedBoundaries,bt;for(bt=0;bt<St.length;bt++){var It=St[bt];W=R;var Qt=C.responseState,ie=It.id,Ee=It.errorDigest,we=It.errorMessage,We=It.errorComponentStack;if(W.push(Qt.startInlineScript),Qt.sentClientRenderFunction?W.push('$RX("'):(Qt.sentClientRenderFunction=!0,W.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),ie===null)throw Error(e(395));if(W.push(ie),W.push('"'),Ee||we||We){W.push(",");var us=nt(Ee||"");W.push(us)}if(we||We){W.push(",");var ms=nt(we||"");W.push(ms)}if(We){W.push(",");var ds=nt(We);W.push(ds)}if(!W.push(")<\/script>")){C.destination=null,bt++,St.splice(0,bt);return}}St.splice(0,bt);var ks=C.completedBoundaries;for(bt=0;bt<ks.length;bt++)if(!Gt(C,R,ks[bt])){C.destination=null,bt++,ks.splice(0,bt);return}ks.splice(0,bt);var gs=C.partialBoundaries;for(bt=0;bt<gs.length;bt++){var Ns=gs[bt];t:{St=C,It=R;var fn=Ns.completedSegments;for(Qt=0;Qt<fn.length;Qt++)if(!qt(St,It,Ns,fn[Qt])){Qt++,fn.splice(0,Qt);var Ss=!1;break t}fn.splice(0,Qt),Ss=!0}if(!Ss){C.destination=null,bt++,gs.splice(0,bt);return}}gs.splice(0,bt);var zs=C.completedBoundaries;for(bt=0;bt<zs.length;bt++)if(!Gt(C,R,zs[bt])){C.destination=null,bt++,zs.splice(0,bt);return}zs.splice(0,bt)}finally{C.allPendingTasks===0&&C.pingedTasks.length===0&&C.clientRenderedBoundaries.length===0&&C.completedBoundaries.length===0&&R.push(null)}}function ee(C,R){try{var U=C.abortableTasks;U.forEach(function(W){return Ct(W,C,R)}),U.clear(),C.destination!==null&&Kt(C,C.destination)}catch(W){os(C,W),cs(C,W)}}function oe(){}function re(C,R,U,W){var St=!1,bt=null,It="",Qt={push:function(Ee){return Ee!==null&&(It+=Ee),!0},destroy:function(Ee){St=!0,bt=Ee}},ie=!1;if(C=Be(C,ot(U,R?R.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,oe,void 0,function(){ie=!0}),Lt(C),ee(C,W),C.status===1)C.status=2,Qt.destroy(C.fatalError);else if(C.status!==2&&C.destination===null){C.destination=Qt;try{Kt(C,Qt)}catch(Ee){os(C,Ee),cs(C,Ee)}}if(St)throw bt;if(!ie)throw Error(e(426));return It}return Sa.renderToNodeStream=function(){throw Error(e(207))},Sa.renderToStaticMarkup=function(C,R){return re(C,R,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},Sa.renderToStaticNodeStream=function(){throw Error(e(208))},Sa.renderToString=function(C,R){return re(C,R,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},Sa.version="18.3.1",Sa}var Ng={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nw;function gY(){if(nw)return Ng;nw=1;var t=ph();function e(k){for(var z="https://reactjs.org/docs/error-decoder.html?invariant="+k,q=1;q<arguments.length;q++)z+="&args[]="+encodeURIComponent(arguments[q]);return"Minified React error #"+k+"; visit "+z+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=null,n=0;function i(k,z){if(z.length!==0)if(512<z.length)0<n&&(k.enqueue(new Uint8Array(s.buffer,0,n)),s=new Uint8Array(512),n=0),k.enqueue(z);else{var q=s.length-n;q<z.length&&(q===0?k.enqueue(s):(s.set(z.subarray(0,q),n),k.enqueue(s),z=z.subarray(q)),s=new Uint8Array(512),n=0),s.set(z,n),n+=z.length}}function r(k,z){return i(k,z),!0}function o(k){s&&0<n&&(k.enqueue(new Uint8Array(s.buffer,0,n)),s=null,n=0)}var a=new TextEncoder;function l(k){return a.encode(k)}function u(k){return a.encode(k)}function h(k,z){typeof k.error=="function"?k.error(z):k.close()}var g=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},y={};function _(k){return g.call(y,k)?!0:g.call(p,k)?!1:f.test(k)?y[k]=!0:(p[k]=!0,!1)}function x(k,z,q,st,Ot,Rt,Jt){this.acceptsBooleans=z===2||z===3||z===4,this.attributeName=st,this.attributeNamespace=Ot,this.mustUseProperty=q,this.propertyName=k,this.type=z,this.sanitizeURL=Rt,this.removeEmptyString=Jt}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(k){v[k]=new x(k,0,!1,k,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(k){var z=k[0];v[z]=new x(z,1,!1,k[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(k){v[k]=new x(k,2,!1,k.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(k){v[k]=new x(k,2,!1,k,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(k){v[k]=new x(k,3,!1,k.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(k){v[k]=new x(k,3,!0,k,null,!1,!1)}),["capture","download"].forEach(function(k){v[k]=new x(k,4,!1,k,null,!1,!1)}),["cols","rows","size","span"].forEach(function(k){v[k]=new x(k,6,!1,k,null,!1,!1)}),["rowSpan","start"].forEach(function(k){v[k]=new x(k,5,!1,k.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function S(k){return k[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(k){var z=k.replace(b,S);v[z]=new x(z,1,!1,k,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(k){var z=k.replace(b,S);v[z]=new x(z,1,!1,k,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(k){var z=k.replace(b,S);v[z]=new x(z,1,!1,k,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(k){v[k]=new x(k,1,!1,k.toLowerCase(),null,!1,!1)}),v.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(k){v[k]=new x(k,1,!1,k.toLowerCase(),null,!0,!0)});var A={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},w=["Webkit","ms","Moz","O"];Object.keys(A).forEach(function(k){w.forEach(function(z){z=z+k.charAt(0).toUpperCase()+k.substring(1),A[z]=A[k]})});var L=/["'&<>]/;function I(k){if(typeof k=="boolean"||typeof k=="number")return""+k;k=""+k;var z=L.exec(k);if(z){var q="",st,Ot=0;for(st=z.index;st<k.length;st++){switch(k.charCodeAt(st)){case 34:z="&quot;";break;case 38:z="&amp;";break;case 39:z="&#x27;";break;case 60:z="&lt;";break;case 62:z="&gt;";break;default:continue}Ot!==st&&(q+=k.substring(Ot,st)),Ot=st+1,q+=z}k=Ot!==st?q+k.substring(Ot,st):q}return k}var F=/([A-Z])/g,O=/^ms-/,V=Array.isArray,j=u("<script>"),Z=u("<\/script>"),at=u('<script src="'),pt=u('<script type="module" src="'),K=u('" async=""><\/script>'),ut=/(<\/|<)(s)(cript)/gi;function ht(k,z,q,st){return""+z+(q==="s"?"\\u0073":"\\u0053")+st}function nt(k,z,q,st,Ot){k=k===void 0?"":k,z=z===void 0?j:u('<script nonce="'+I(z)+'">');var Rt=[];if(q!==void 0&&Rt.push(z,l((""+q).replace(ut,ht)),Z),st!==void 0)for(q=0;q<st.length;q++)Rt.push(at,l(I(st[q])),K);if(Ot!==void 0)for(st=0;st<Ot.length;st++)Rt.push(pt,l(I(Ot[st])),K);return{bootstrapChunks:Rt,startInlineScript:z,placeholderPrefix:u(k+"P:"),segmentPrefix:u(k+"S:"),boundaryPrefix:k+"B:",idPrefix:k,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function ot(k,z){return{insertionMode:k,selectedValue:z}}function Nt(k){return ot(k==="http://www.w3.org/2000/svg"?2:k==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function Q(k,z,q){switch(z){case"select":return ot(1,q.value!=null?q.value:q.defaultValue);case"svg":return ot(2,null);case"math":return ot(3,null);case"foreignObject":return ot(1,null);case"table":return ot(4,null);case"thead":case"tbody":case"tfoot":return ot(5,null);case"colgroup":return ot(7,null);case"tr":return ot(6,null)}return 4<=k.insertionMode||k.insertionMode===0?ot(1,null):k}var Et=u("<!-- -->");function Xt(k,z,q,st){return z===""?st:(st&&k.push(Et),k.push(l(I(z))),!0)}var Ht=new Map,Zt=u(' style="'),ae=u(":"),pe=u(";");function ne(k,z,q){if(typeof q!="object")throw Error(e(62));z=!0;for(var st in q)if(g.call(q,st)){var Ot=q[st];if(Ot!=null&&typeof Ot!="boolean"&&Ot!==""){if(st.indexOf("--")===0){var Rt=l(I(st));Ot=l(I((""+Ot).trim()))}else{Rt=st;var Jt=Ht.get(Rt);Jt!==void 0||(Jt=u(I(Rt.replace(F,"-$1").toLowerCase().replace(O,"-ms-"))),Ht.set(Rt,Jt)),Rt=Jt,Ot=typeof Ot=="number"?Ot===0||g.call(A,st)?l(""+Ot):l(Ot+"px"):l(I((""+Ot).trim()))}z?(z=!1,k.push(Zt,Rt,ae,Ot)):k.push(pe,Rt,ae,Ot)}}z||k.push(ce)}var te=u(" "),se=u('="'),ce=u('"'),Ce=u('=""');function ve(k,z,q,st){switch(q){case"style":ne(k,z,st);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<q.length)||q[0]!=="o"&&q[0]!=="O"||q[1]!=="n"&&q[1]!=="N"){if(z=v.hasOwnProperty(q)?v[q]:null,z!==null){switch(typeof st){case"function":case"symbol":return;case"boolean":if(!z.acceptsBooleans)return}switch(q=l(z.attributeName),z.type){case 3:st&&k.push(te,q,Ce);break;case 4:st===!0?k.push(te,q,Ce):st!==!1&&k.push(te,q,se,l(I(st)),ce);break;case 5:isNaN(st)||k.push(te,q,se,l(I(st)),ce);break;case 6:!isNaN(st)&&1<=st&&k.push(te,q,se,l(I(st)),ce);break;default:z.sanitizeURL&&(st=""+st),k.push(te,q,se,l(I(st)),ce)}}else if(_(q)){switch(typeof st){case"function":case"symbol":return;case"boolean":if(z=q.toLowerCase().slice(0,5),z!=="data-"&&z!=="aria-")return}k.push(te,l(q),se,l(I(st)),ce)}}}var Ne=u(">"),ge=u("/>");function ze(k,z,q){if(z!=null){if(q!=null)throw Error(e(60));if(typeof z!="object"||!("__html"in z))throw Error(e(61));z=z.__html,z!=null&&k.push(l(""+z))}}function is(k){var z="";return t.Children.forEach(k,function(q){q!=null&&(z+=q)}),z}var Ge=u(' selected=""');function De(k,z,q,st){k.push(ts(q));var Ot=q=null,Rt;for(Rt in z)if(g.call(z,Rt)){var Jt=z[Rt];if(Jt!=null)switch(Rt){case"children":q=Jt;break;case"dangerouslySetInnerHTML":Ot=Jt;break;default:ve(k,st,Rt,Jt)}}return k.push(Ne),ze(k,Ot,q),typeof q=="string"?(k.push(l(I(q))),null):q}var He=u(`
`),Je=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,ss=new Map;function ts(k){var z=ss.get(k);if(z===void 0){if(!Je.test(k))throw Error(e(65,k));z=u("<"+k),ss.set(k,z)}return z}var hs=u("<!DOCTYPE html>");function Fe(k,z,q,st,Ot){switch(z){case"select":k.push(ts("select"));var Rt=null,Jt=null;for(Xe in q)if(g.call(q,Xe)){var me=q[Xe];if(me!=null)switch(Xe){case"children":Rt=me;break;case"dangerouslySetInnerHTML":Jt=me;break;case"defaultValue":case"value":break;default:ve(k,st,Xe,me)}}return k.push(Ne),ze(k,Jt,Rt),Rt;case"option":Jt=Ot.selectedValue,k.push(ts("option"));var Ye=me=null,ns=null,Xe=null;for(Rt in q)if(g.call(q,Rt)){var ws=q[Rt];if(ws!=null)switch(Rt){case"children":me=ws;break;case"selected":ns=ws;break;case"dangerouslySetInnerHTML":Xe=ws;break;case"value":Ye=ws;default:ve(k,st,Rt,ws)}}if(Jt!=null)if(q=Ye!==null?""+Ye:is(me),V(Jt)){for(st=0;st<Jt.length;st++)if(""+Jt[st]===q){k.push(Ge);break}}else""+Jt===q&&k.push(Ge);else ns&&k.push(Ge);return k.push(Ne),ze(k,Xe,me),me;case"textarea":k.push(ts("textarea")),Xe=Jt=Rt=null;for(me in q)if(g.call(q,me)&&(Ye=q[me],Ye!=null))switch(me){case"children":Xe=Ye;break;case"value":Rt=Ye;break;case"defaultValue":Jt=Ye;break;case"dangerouslySetInnerHTML":throw Error(e(91));default:ve(k,st,me,Ye)}if(Rt===null&&Jt!==null&&(Rt=Jt),k.push(Ne),Xe!=null){if(Rt!=null)throw Error(e(92));if(V(Xe)&&1<Xe.length)throw Error(e(93));Rt=""+Xe}return typeof Rt=="string"&&Rt[0]===`
`&&k.push(He),Rt!==null&&k.push(l(I(""+Rt))),null;case"input":k.push(ts("input")),Ye=Xe=me=Rt=null;for(Jt in q)if(g.call(q,Jt)&&(ns=q[Jt],ns!=null))switch(Jt){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,"input"));case"defaultChecked":Ye=ns;break;case"defaultValue":me=ns;break;case"checked":Xe=ns;break;case"value":Rt=ns;break;default:ve(k,st,Jt,ns)}return Xe!==null?ve(k,st,"checked",Xe):Ye!==null&&ve(k,st,"checked",Ye),Rt!==null?ve(k,st,"value",Rt):me!==null&&ve(k,st,"value",me),k.push(ge),null;case"menuitem":k.push(ts("menuitem"));for(var zn in q)if(g.call(q,zn)&&(Rt=q[zn],Rt!=null))switch(zn){case"children":case"dangerouslySetInnerHTML":throw Error(e(400));default:ve(k,st,zn,Rt)}return k.push(Ne),null;case"title":k.push(ts("title")),Rt=null;for(ws in q)if(g.call(q,ws)&&(Jt=q[ws],Jt!=null))switch(ws){case"children":Rt=Jt;break;case"dangerouslySetInnerHTML":throw Error(e(434));default:ve(k,st,ws,Jt)}return k.push(Ne),Rt;case"listing":case"pre":k.push(ts(z)),Jt=Rt=null;for(Ye in q)if(g.call(q,Ye)&&(me=q[Ye],me!=null))switch(Ye){case"children":Rt=me;break;case"dangerouslySetInnerHTML":Jt=me;break;default:ve(k,st,Ye,me)}if(k.push(Ne),Jt!=null){if(Rt!=null)throw Error(e(60));if(typeof Jt!="object"||!("__html"in Jt))throw Error(e(61));q=Jt.__html,q!=null&&(typeof q=="string"&&0<q.length&&q[0]===`
`?k.push(He,l(q)):k.push(l(""+q)))}return typeof Rt=="string"&&Rt[0]===`
`&&k.push(He),Rt;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":k.push(ts(z));for(var li in q)if(g.call(q,li)&&(Rt=q[li],Rt!=null))switch(li){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,z));default:ve(k,st,li,Rt)}return k.push(ge),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return De(k,q,z,st);case"html":return Ot.insertionMode===0&&k.push(hs),De(k,q,z,st);default:if(z.indexOf("-")===-1&&typeof q.is!="string")return De(k,q,z,st);k.push(ts(z)),Jt=Rt=null;for(ns in q)if(g.call(q,ns)&&(me=q[ns],me!=null))switch(ns){case"children":Rt=me;break;case"dangerouslySetInnerHTML":Jt=me;break;case"style":ne(k,st,me);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:_(ns)&&typeof me!="function"&&typeof me!="symbol"&&k.push(te,l(ns),se,l(I(me)),ce)}return k.push(Ne),ze(k,Jt,Rt),Rt}}var Oe=u("</"),Cs=u(">"),Fs=u('<template id="'),Hs=u('"></template>'),Ls=u("<!--$-->"),Sn=u('<!--$?--><template id="'),gn=u('"></template>'),ln=u("<!--$!-->"),xs=u("<!--/$-->"),Ps=u("<template"),gt=u('"'),N=u(' data-dgst="');u(' data-msg="'),u(' data-stck="');var P=u("></template>");function D(k,z,q){if(i(k,Sn),q===null)throw Error(e(395));return i(k,q),r(k,gn)}var B=u('<div hidden id="'),$=u('">'),H=u("</div>"),X=u('<svg aria-hidden="true" style="display:none" id="'),lt=u('">'),dt=u("</svg>"),ct=u('<math aria-hidden="true" style="display:none" id="'),mt=u('">'),yt=u("</math>"),kt=u('<table hidden id="'),Tt=u('">'),At=u("</table>"),Ut=u('<table hidden><tbody id="'),he=u('">'),xe=u("</tbody></table>"),be=u('<table hidden><tr id="'),ue=u('">'),_e=u("</tr></table>"),Te=u('<table hidden><colgroup id="'),Ve=u('">'),Ie=u("</colgroup></table>");function je(k,z,q,st){switch(q.insertionMode){case 0:case 1:return i(k,B),i(k,z.segmentPrefix),i(k,l(st.toString(16))),r(k,$);case 2:return i(k,X),i(k,z.segmentPrefix),i(k,l(st.toString(16))),r(k,lt);case 3:return i(k,ct),i(k,z.segmentPrefix),i(k,l(st.toString(16))),r(k,mt);case 4:return i(k,kt),i(k,z.segmentPrefix),i(k,l(st.toString(16))),r(k,Tt);case 5:return i(k,Ut),i(k,z.segmentPrefix),i(k,l(st.toString(16))),r(k,he);case 6:return i(k,be),i(k,z.segmentPrefix),i(k,l(st.toString(16))),r(k,ue);case 7:return i(k,Te),i(k,z.segmentPrefix),i(k,l(st.toString(16))),r(k,Ve);default:throw Error(e(397))}}function Pe(k,z){switch(z.insertionMode){case 0:case 1:return r(k,H);case 2:return r(k,dt);case 3:return r(k,yt);case 4:return r(k,At);case 5:return r(k,xe);case 6:return r(k,_e);case 7:return r(k,Ie);default:throw Error(e(397))}}var Be=u('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),Ue=u('$RS("'),es=u('","'),os=u('")<\/script>'),cs=u('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),Y=u('$RC("'),et=u('","'),J=u('")<\/script>'),tt=u('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),ft=u('$RX("'),_t=u('"'),it=u(")<\/script>"),vt=u(","),Ct=/[<\u2028\u2029]/g;function Ft(k){return JSON.stringify(k).replace(Ct,function(z){switch(z){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var Pt=Object.assign,Lt=Symbol.for("react.element"),Yt=Symbol.for("react.portal"),$t=Symbol.for("react.fragment"),Bt=Symbol.for("react.strict_mode"),Gt=Symbol.for("react.profiler"),qt=Symbol.for("react.provider"),Kt=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),oe=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),U=Symbol.for("react.scope"),W=Symbol.for("react.debug_trace_mode"),St=Symbol.for("react.legacy_hidden"),bt=Symbol.for("react.default_value"),It=Symbol.iterator;function Qt(k){if(k==null)return null;if(typeof k=="function")return k.displayName||k.name||null;if(typeof k=="string")return k;switch(k){case $t:return"Fragment";case Yt:return"Portal";case Gt:return"Profiler";case Bt:return"StrictMode";case oe:return"Suspense";case re:return"SuspenseList"}if(typeof k=="object")switch(k.$$typeof){case Kt:return(k.displayName||"Context")+".Consumer";case qt:return(k._context.displayName||"Context")+".Provider";case ee:var z=k.render;return k=k.displayName,k||(k=z.displayName||z.name||"",k=k!==""?"ForwardRef("+k+")":"ForwardRef"),k;case C:return z=k.displayName||null,z!==null?z:Qt(k.type)||"Memo";case R:z=k._payload,k=k._init;try{return Qt(k(z))}catch{}}return null}var ie={};function Ee(k,z){if(k=k.contextTypes,!k)return ie;var q={},st;for(st in k)q[st]=z[st];return q}var we=null;function We(k,z){if(k!==z){k.context._currentValue=k.parentValue,k=k.parent;var q=z.parent;if(k===null){if(q!==null)throw Error(e(401))}else{if(q===null)throw Error(e(401));We(k,q)}z.context._currentValue=z.value}}function us(k){k.context._currentValue=k.parentValue,k=k.parent,k!==null&&us(k)}function ms(k){var z=k.parent;z!==null&&ms(z),k.context._currentValue=k.value}function ds(k,z){if(k.context._currentValue=k.parentValue,k=k.parent,k===null)throw Error(e(402));k.depth===z.depth?We(k,z):ds(k,z)}function ks(k,z){var q=z.parent;if(q===null)throw Error(e(402));k.depth===q.depth?We(k,q):ks(k,q),z.context._currentValue=z.value}function gs(k){var z=we;z!==k&&(z===null?ms(k):k===null?us(z):z.depth===k.depth?We(z,k):z.depth>k.depth?ds(z,k):ks(z,k),we=k)}var Ns={isMounted:function(){return!1},enqueueSetState:function(k,z){k=k._reactInternals,k.queue!==null&&k.queue.push(z)},enqueueReplaceState:function(k,z){k=k._reactInternals,k.replace=!0,k.queue=[z]},enqueueForceUpdate:function(){}};function fn(k,z,q,st){var Ot=k.state!==void 0?k.state:null;k.updater=Ns,k.props=q,k.state=Ot;var Rt={queue:[],replace:!1};k._reactInternals=Rt;var Jt=z.contextType;if(k.context=typeof Jt=="object"&&Jt!==null?Jt._currentValue:st,Jt=z.getDerivedStateFromProps,typeof Jt=="function"&&(Jt=Jt(q,Ot),Ot=Jt==null?Ot:Pt({},Ot,Jt),k.state=Ot),typeof z.getDerivedStateFromProps!="function"&&typeof k.getSnapshotBeforeUpdate!="function"&&(typeof k.UNSAFE_componentWillMount=="function"||typeof k.componentWillMount=="function"))if(z=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),z!==k.state&&Ns.enqueueReplaceState(k,k.state,null),Rt.queue!==null&&0<Rt.queue.length)if(z=Rt.queue,Jt=Rt.replace,Rt.queue=null,Rt.replace=!1,Jt&&z.length===1)k.state=z[0];else{for(Rt=Jt?z[0]:k.state,Ot=!0,Jt=Jt?1:0;Jt<z.length;Jt++){var me=z[Jt];me=typeof me=="function"?me.call(k,Rt,q,st):me,me!=null&&(Ot?(Ot=!1,Rt=Pt({},Rt,me)):Pt(Rt,me))}k.state=Rt}else Rt.queue=null}var Ss={id:1,overflow:""};function zs(k,z,q){var st=k.id;k=k.overflow;var Ot=32-yn(st)-1;st&=~(1<<Ot),q+=1;var Rt=32-yn(z)+Ot;if(30<Rt){var Jt=Ot-Ot%5;return Rt=(st&(1<<Jt)-1).toString(32),st>>=Jt,Ot-=Jt,{id:1<<32-yn(z)+Ot|q<<Ot|st,overflow:Rt+k}}return{id:1<<Rt|q<<Ot|st,overflow:k}}var yn=Math.clz32?Math.clz32:Ds,tn=Math.log,Zs=Math.LN2;function Ds(k){return k>>>=0,k===0?32:31-(tn(k)/Zs|0)|0}function An(k,z){return k===z&&(k!==0||1/k===1/z)||k!==k&&z!==z}var Wi=typeof Object.is=="function"?Object.is:An,kn=null,Xi=null,gr=null,vs=null,Zi=!1,fr=!1,Ii=0,bi=null,Qa=0;function Ir(){if(kn===null)throw Error(e(321));return kn}function Ja(){if(0<Qa)throw Error(e(312));return{memoizedState:null,queue:null,next:null}}function go(){return vs===null?gr===null?(Zi=!1,gr=vs=Ja()):(Zi=!0,vs=gr):vs.next===null?(Zi=!1,vs=vs.next=Ja()):(Zi=!0,vs=vs.next),vs}function ia(){Xi=kn=null,fr=!1,gr=null,Qa=0,vs=bi=null}function bu(k,z){return typeof z=="function"?z(k):z}function Ki(k,z,q){if(kn=Ir(),vs=go(),Zi){var st=vs.queue;if(z=st.dispatch,bi!==null&&(q=bi.get(st),q!==void 0)){bi.delete(st),st=vs.memoizedState;do st=k(st,q.action),q=q.next;while(q!==null);return vs.memoizedState=st,[st,z]}return[vs.memoizedState,z]}return k=k===bu?typeof z=="function"?z():z:q!==void 0?q(z):z,vs.memoizedState=k,k=vs.queue={last:null,dispatch:null},k=k.dispatch=el.bind(null,kn,k),[vs.memoizedState,k]}function tl(k,z){if(kn=Ir(),vs=go(),z=z===void 0?null:z,vs!==null){var q=vs.memoizedState;if(q!==null&&z!==null){var st=q[1];t:if(st===null)st=!1;else{for(var Ot=0;Ot<st.length&&Ot<z.length;Ot++)if(!Wi(z[Ot],st[Ot])){st=!1;break t}st=!0}if(st)return q[0]}}return k=k(),vs.memoizedState=[k,z],k}function el(k,z,q){if(25<=Qa)throw Error(e(301));if(k===kn)if(fr=!0,k={action:q,next:null},bi===null&&(bi=new Map),q=bi.get(z),q===void 0)bi.set(z,k);else{for(z=q;z.next!==null;)z=z.next;z.next=k}}function Ih(){throw Error(e(394))}function Rr(){}var ra={readContext:function(k){return k._currentValue},useContext:function(k){return Ir(),k._currentValue},useMemo:tl,useReducer:Ki,useRef:function(k){kn=Ir(),vs=go();var z=vs.memoizedState;return z===null?(k={current:k},vs.memoizedState=k):z},useState:function(k){return Ki(bu,k)},useInsertionEffect:Rr,useLayoutEffect:function(){},useCallback:function(k,z){return tl(function(){return k},z)},useImperativeHandle:Rr,useEffect:Rr,useDebugValue:Rr,useDeferredValue:function(k){return Ir(),k},useTransition:function(){return Ir(),[!1,Ih]},useId:function(){var k=Xi.treeContext,z=k.overflow;k=k.id,k=(k&~(1<<32-yn(k)-1)).toString(32)+z;var q=oa;if(q===null)throw Error(e(404));return z=Ii++,k=":"+q.idPrefix+"R"+k,0<z&&(k+="H"+z.toString(32)),k+":"},useMutableSource:function(k,z){return Ir(),z(k._source)},useSyncExternalStore:function(k,z,q){if(q===void 0)throw Error(e(407));return q()}},oa=null,Nn=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function fo(k){return console.error(k),null}function Fr(){}function aa(k,z,q,st,Ot,Rt,Jt,me,Ye){var ns=[],Xe=new Set;return z={destination:null,responseState:z,progressiveChunkSize:st===void 0?12800:st,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:Xe,pingedTasks:ns,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Ot===void 0?fo:Ot,onAllReady:Rt===void 0?Fr:Rt,onShellReady:Jt===void 0?Fr:Jt,onShellError:me===void 0?Fr:me,onFatalError:Ye===void 0?Fr:Ye},q=po(z,0,null,q,!1,!1),q.parentFlushed=!0,k=Eu(z,k,null,q,Xe,ie,null,Ss),ns.push(k),z}function Eu(k,z,q,st,Ot,Rt,Jt,me){k.allPendingTasks++,q===null?k.pendingRootTasks++:q.pendingTasks++;var Ye={node:z,ping:function(){var ns=k.pingedTasks;ns.push(Ye),ns.length===1&&Tu(k)},blockedBoundary:q,blockedSegment:st,abortSet:Ot,legacyContext:Rt,context:Jt,treeContext:me};return Ot.add(Ye),Ye}function po(k,z,q,st,Ot,Rt){return{status:0,id:-1,index:z,parentFlushed:!1,chunks:[],children:[],formatContext:st,boundary:q,lastPushedText:Ot,textEmbedded:Rt}}function Pr(k,z){if(k=k.onError(z),k!=null&&typeof k!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof k+'" instead');return k}function pr(k,z){var q=k.onShellError;q(z),q=k.onFatalError,q(z),k.destination!==null?(k.status=2,h(k.destination,z)):(k.status=1,k.fatalError=z)}function la(k,z,q,st,Ot){for(kn={},Xi=z,Ii=0,k=q(st,Ot);fr;)fr=!1,Ii=0,Qa+=1,vs=null,k=q(st,Ot);return ia(),k}function Su(k,z,q,st){var Ot=q.render(),Rt=st.childContextTypes;if(Rt!=null){var Jt=z.legacyContext;if(typeof q.getChildContext!="function")st=Jt;else{q=q.getChildContext();for(var me in q)if(!(me in Rt))throw Error(e(108,Qt(st)||"Unknown",me));st=Pt({},Jt,q)}z.legacyContext=st,Kn(k,z,Ot),z.legacyContext=Jt}else Kn(k,z,Ot)}function Rh(k,z){if(k&&k.defaultProps){z=Pt({},z),k=k.defaultProps;for(var q in k)z[q]===void 0&&(z[q]=k[q]);return z}return z}function Au(k,z,q,st,Ot){if(typeof q=="function")if(q.prototype&&q.prototype.isReactComponent){Ot=Ee(q,z.legacyContext);var Rt=q.contextType;Rt=new q(st,typeof Rt=="object"&&Rt!==null?Rt._currentValue:Ot),fn(Rt,q,st,Ot),Su(k,z,Rt,q)}else{Rt=Ee(q,z.legacyContext),Ot=la(k,z,q,st,Rt);var Jt=Ii!==0;if(typeof Ot=="object"&&Ot!==null&&typeof Ot.render=="function"&&Ot.$$typeof===void 0)fn(Ot,q,st,Rt),Su(k,z,Ot,q);else if(Jt){st=z.treeContext,z.treeContext=zs(st,1,0);try{Kn(k,z,Ot)}finally{z.treeContext=st}}else Kn(k,z,Ot)}else if(typeof q=="string"){switch(Ot=z.blockedSegment,Rt=Fe(Ot.chunks,q,st,k.responseState,Ot.formatContext),Ot.lastPushedText=!1,Jt=Ot.formatContext,Ot.formatContext=Q(Jt,q,st),wu(k,z,Rt),Ot.formatContext=Jt,q){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Ot.chunks.push(Oe,l(q),Cs)}Ot.lastPushedText=!1}else{switch(q){case St:case W:case Bt:case Gt:case $t:Kn(k,z,st.children);return;case re:Kn(k,z,st.children);return;case U:throw Error(e(343));case oe:t:{q=z.blockedBoundary,Ot=z.blockedSegment,Rt=st.fallback,st=st.children,Jt=new Set;var me={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:Jt,errorDigest:null},Ye=po(k,Ot.chunks.length,me,Ot.formatContext,!1,!1);Ot.children.push(Ye),Ot.lastPushedText=!1;var ns=po(k,0,null,Ot.formatContext,!1,!1);ns.parentFlushed=!0,z.blockedBoundary=me,z.blockedSegment=ns;try{if(wu(k,z,st),ns.lastPushedText&&ns.textEmbedded&&ns.chunks.push(Et),ns.status=1,nl(me,ns),me.pendingTasks===0)break t}catch(Xe){ns.status=4,me.forceClientRender=!0,me.errorDigest=Pr(k,Xe)}finally{z.blockedBoundary=q,z.blockedSegment=Ot}z=Eu(k,Rt,q,Ye,Jt,z.legacyContext,z.context,z.treeContext),k.pingedTasks.push(z)}return}if(typeof q=="object"&&q!==null)switch(q.$$typeof){case ee:if(st=la(k,z,q.render,st,Ot),Ii!==0){q=z.treeContext,z.treeContext=zs(q,1,0);try{Kn(k,z,st)}finally{z.treeContext=q}}else Kn(k,z,st);return;case C:q=q.type,st=Rh(q,st),Au(k,z,q,st,Ot);return;case qt:if(Ot=st.children,q=q._context,st=st.value,Rt=q._currentValue,q._currentValue=st,Jt=we,we=st={parent:Jt,depth:Jt===null?0:Jt.depth+1,context:q,parentValue:Rt,value:st},z.context=st,Kn(k,z,Ot),k=we,k===null)throw Error(e(403));st=k.parentValue,k.context._currentValue=st===bt?k.context._defaultValue:st,k=we=k.parent,z.context=k;return;case Kt:st=st.children,st=st(q._currentValue),Kn(k,z,st);return;case R:Ot=q._init,q=Ot(q._payload),st=Rh(q,st),Au(k,z,q,st,void 0);return}throw Error(e(130,q==null?q:typeof q,""))}}function Kn(k,z,q){if(z.node=q,typeof q=="object"&&q!==null){switch(q.$$typeof){case Lt:Au(k,z,q.type,q.props,q.ref);return;case Yt:throw Error(e(257));case R:var st=q._init;q=st(q._payload),Kn(k,z,q);return}if(V(q)){sl(k,z,q);return}if(q===null||typeof q!="object"?st=null:(st=It&&q[It]||q["@@iterator"],st=typeof st=="function"?st:null),st&&(st=st.call(q))){if(q=st.next(),!q.done){var Ot=[];do Ot.push(q.value),q=st.next();while(!q.done);sl(k,z,Ot)}return}throw k=Object.prototype.toString.call(q),Error(e(31,k==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":k))}typeof q=="string"?(st=z.blockedSegment,st.lastPushedText=Xt(z.blockedSegment.chunks,q,k.responseState,st.lastPushedText)):typeof q=="number"&&(st=z.blockedSegment,st.lastPushedText=Xt(z.blockedSegment.chunks,""+q,k.responseState,st.lastPushedText))}function sl(k,z,q){for(var st=q.length,Ot=0;Ot<st;Ot++){var Rt=z.treeContext;z.treeContext=zs(Rt,st,Ot);try{wu(k,z,q[Ot])}finally{z.treeContext=Rt}}}function wu(k,z,q){var st=z.blockedSegment.formatContext,Ot=z.legacyContext,Rt=z.context;try{return Kn(k,z,q)}catch(Ye){if(ia(),typeof Ye=="object"&&Ye!==null&&typeof Ye.then=="function"){q=Ye;var Jt=z.blockedSegment,me=po(k,Jt.chunks.length,null,Jt.formatContext,Jt.lastPushedText,!0);Jt.children.push(me),Jt.lastPushedText=!1,k=Eu(k,z.node,z.blockedBoundary,me,z.abortSet,z.legacyContext,z.context,z.treeContext).ping,q.then(k,k),z.blockedSegment.formatContext=st,z.legacyContext=Ot,z.context=Rt,gs(Rt)}else throw z.blockedSegment.formatContext=st,z.legacyContext=Ot,z.context=Rt,gs(Rt),Ye}}function fp(k){var z=k.blockedBoundary;k=k.blockedSegment,k.status=3,Ph(this,z,k)}function Fh(k,z,q){var st=k.blockedBoundary;k.blockedSegment.status=3,st===null?(z.allPendingTasks--,z.status!==2&&(z.status=2,z.destination!==null&&z.destination.close())):(st.pendingTasks--,st.forceClientRender||(st.forceClientRender=!0,k=q===void 0?Error(e(432)):q,st.errorDigest=z.onError(k),st.parentFlushed&&z.clientRenderedBoundaries.push(st)),st.fallbackAbortableTasks.forEach(function(Ot){return Fh(Ot,z,q)}),st.fallbackAbortableTasks.clear(),z.allPendingTasks--,z.allPendingTasks===0&&(st=z.onAllReady,st()))}function nl(k,z){if(z.chunks.length===0&&z.children.length===1&&z.children[0].boundary===null){var q=z.children[0];q.id=z.id,q.parentFlushed=!0,q.status===1&&nl(k,q)}else k.completedSegments.push(z)}function Ph(k,z,q){if(z===null){if(q.parentFlushed){if(k.completedRootSegment!==null)throw Error(e(389));k.completedRootSegment=q}k.pendingRootTasks--,k.pendingRootTasks===0&&(k.onShellError=Fr,z=k.onShellReady,z())}else z.pendingTasks--,z.forceClientRender||(z.pendingTasks===0?(q.parentFlushed&&q.status===1&&nl(z,q),z.parentFlushed&&k.completedBoundaries.push(z),z.fallbackAbortableTasks.forEach(fp,k),z.fallbackAbortableTasks.clear()):q.parentFlushed&&q.status===1&&(nl(z,q),z.completedSegments.length===1&&z.parentFlushed&&k.partialBoundaries.push(z)));k.allPendingTasks--,k.allPendingTasks===0&&(k=k.onAllReady,k())}function Tu(k){if(k.status!==2){var z=we,q=Nn.current;Nn.current=ra;var st=oa;oa=k.responseState;try{var Ot=k.pingedTasks,Rt;for(Rt=0;Rt<Ot.length;Rt++){var Jt=Ot[Rt],me=k,Ye=Jt.blockedSegment;if(Ye.status===0){gs(Jt.context);try{Kn(me,Jt,Jt.node),Ye.lastPushedText&&Ye.textEmbedded&&Ye.chunks.push(Et),Jt.abortSet.delete(Jt),Ye.status=1,Ph(me,Jt.blockedBoundary,Ye)}catch(ui){if(ia(),typeof ui=="object"&&ui!==null&&typeof ui.then=="function"){var ns=Jt.ping;ui.then(ns,ns)}else{Jt.abortSet.delete(Jt),Ye.status=4;var Xe=Jt.blockedBoundary,ws=ui,zn=Pr(me,ws);if(Xe===null?pr(me,ws):(Xe.pendingTasks--,Xe.forceClientRender||(Xe.forceClientRender=!0,Xe.errorDigest=zn,Xe.parentFlushed&&me.clientRenderedBoundaries.push(Xe))),me.allPendingTasks--,me.allPendingTasks===0){var li=me.onAllReady;li()}}}finally{}}}Ot.splice(0,Rt),k.destination!==null&&Cu(k,k.destination)}catch(ui){Pr(k,ui),pr(k,ui)}finally{oa=st,Nn.current=q,q===ra&&gs(z)}}}function il(k,z,q){switch(q.parentFlushed=!0,q.status){case 0:var st=q.id=k.nextSegmentId++;return q.lastPushedText=!1,q.textEmbedded=!1,k=k.responseState,i(z,Fs),i(z,k.placeholderPrefix),k=l(st.toString(16)),i(z,k),r(z,Hs);case 1:q.status=2;var Ot=!0;st=q.chunks;var Rt=0;q=q.children;for(var Jt=0;Jt<q.length;Jt++){for(Ot=q[Jt];Rt<Ot.index;Rt++)i(z,st[Rt]);Ot=rl(k,z,Ot)}for(;Rt<st.length-1;Rt++)i(z,st[Rt]);return Rt<st.length&&(Ot=r(z,st[Rt])),Ot;default:throw Error(e(390))}}function rl(k,z,q){var st=q.boundary;if(st===null)return il(k,z,q);if(st.parentFlushed=!0,st.forceClientRender)st=st.errorDigest,r(z,ln),i(z,Ps),st&&(i(z,N),i(z,l(I(st))),i(z,gt)),r(z,P),il(k,z,q);else if(0<st.pendingTasks){st.rootSegmentID=k.nextSegmentId++,0<st.completedSegments.length&&k.partialBoundaries.push(st);var Ot=k.responseState,Rt=Ot.nextSuspenseID++;Ot=u(Ot.boundaryPrefix+Rt.toString(16)),st=st.id=Ot,D(z,k.responseState,st),il(k,z,q)}else if(st.byteSize>k.progressiveChunkSize)st.rootSegmentID=k.nextSegmentId++,k.completedBoundaries.push(st),D(z,k.responseState,st.id),il(k,z,q);else{if(r(z,Ls),q=st.completedSegments,q.length!==1)throw Error(e(391));rl(k,z,q[0])}return r(z,xs)}function zh(k,z,q){return je(z,k.responseState,q.formatContext,q.id),rl(k,z,q),Pe(z,q.formatContext)}function Dh(k,z,q){for(var st=q.completedSegments,Ot=0;Ot<st.length;Ot++)ol(k,z,q,st[Ot]);if(st.length=0,k=k.responseState,st=q.id,q=q.rootSegmentID,i(z,k.startInlineScript),k.sentCompleteBoundaryFunction?i(z,Y):(k.sentCompleteBoundaryFunction=!0,i(z,cs)),st===null)throw Error(e(395));return q=l(q.toString(16)),i(z,st),i(z,et),i(z,k.segmentPrefix),i(z,q),r(z,J)}function ol(k,z,q,st){if(st.status===2)return!0;var Ot=st.id;if(Ot===-1){if((st.id=q.rootSegmentID)===-1)throw Error(e(392));return zh(k,z,st)}return zh(k,z,st),k=k.responseState,i(z,k.startInlineScript),k.sentCompleteSegmentFunction?i(z,Ue):(k.sentCompleteSegmentFunction=!0,i(z,Be)),i(z,k.segmentPrefix),Ot=l(Ot.toString(16)),i(z,Ot),i(z,es),i(z,k.placeholderPrefix),i(z,Ot),r(z,os)}function Cu(k,z){s=new Uint8Array(512),n=0;try{var q=k.completedRootSegment;if(q!==null&&k.pendingRootTasks===0){rl(k,z,q),k.completedRootSegment=null;var st=k.responseState.bootstrapChunks;for(q=0;q<st.length-1;q++)i(z,st[q]);q<st.length&&r(z,st[q])}var Ot=k.clientRenderedBoundaries,Rt;for(Rt=0;Rt<Ot.length;Rt++){var Jt=Ot[Rt];st=z;var me=k.responseState,Ye=Jt.id,ns=Jt.errorDigest,Xe=Jt.errorMessage,ws=Jt.errorComponentStack;if(i(st,me.startInlineScript),me.sentClientRenderFunction?i(st,ft):(me.sentClientRenderFunction=!0,i(st,tt)),Ye===null)throw Error(e(395));i(st,Ye),i(st,_t),(ns||Xe||ws)&&(i(st,vt),i(st,l(Ft(ns||"")))),(Xe||ws)&&(i(st,vt),i(st,l(Ft(Xe||"")))),ws&&(i(st,vt),i(st,l(Ft(ws)))),r(st,it)}Ot.splice(0,Rt);var zn=k.completedBoundaries;for(Rt=0;Rt<zn.length;Rt++)Dh(k,z,zn[Rt]);zn.splice(0,Rt),o(z),s=new Uint8Array(512),n=0;var li=k.partialBoundaries;for(Rt=0;Rt<li.length;Rt++){var ui=li[Rt];t:{Ot=k,Jt=z;var ua=ui.completedSegments;for(me=0;me<ua.length;me++)if(!ol(Ot,Jt,ui,ua[me])){me++,ua.splice(0,me);var Lu=!1;break t}ua.splice(0,me),Lu=!0}if(!Lu){k.destination=null,Rt++,li.splice(0,Rt);return}}li.splice(0,Rt);var mr=k.completedBoundaries;for(Rt=0;Rt<mr.length;Rt++)Dh(k,z,mr[Rt]);mr.splice(0,Rt)}finally{o(z),k.allPendingTasks===0&&k.pingedTasks.length===0&&k.clientRenderedBoundaries.length===0&&k.completedBoundaries.length===0&&z.close()}}function Oh(k,z){try{var q=k.abortableTasks;q.forEach(function(st){return Fh(st,k,z)}),q.clear(),k.destination!==null&&Cu(k,k.destination)}catch(st){Pr(k,st),pr(k,st)}}return Ng.renderToReadableStream=function(k,z){return new Promise(function(q,st){var Ot,Rt,Jt=new Promise(function(Xe,ws){Rt=Xe,Ot=ws}),me=aa(k,nt(z?z.identifierPrefix:void 0,z?z.nonce:void 0,z?z.bootstrapScriptContent:void 0,z?z.bootstrapScripts:void 0,z?z.bootstrapModules:void 0),Nt(z?z.namespaceURI:void 0),z?z.progressiveChunkSize:void 0,z?z.onError:void 0,Rt,function(){var Xe=new ReadableStream({type:"bytes",pull:function(ws){if(me.status===1)me.status=2,h(ws,me.fatalError);else if(me.status!==2&&me.destination===null){me.destination=ws;try{Cu(me,ws)}catch(zn){Pr(me,zn),pr(me,zn)}}},cancel:function(){Oh(me)}},{highWaterMark:0});Xe.allReady=Jt,q(Xe)},function(Xe){Jt.catch(function(){}),st(Xe)},Ot);if(z&&z.signal){var Ye=z.signal,ns=function(){Oh(me,Ye.reason),Ye.removeEventListener("abort",ns)};Ye.addEventListener("abort",ns)}Tu(me)})},Ng.version="18.3.1",Ng}var iw;function fY(){if(iw)return zo;iw=1;var t,e;return t=cY(),e=gY(),zo.version=t.version,zo.renderToString=t.renderToString,zo.renderToStaticMarkup=t.renderToStaticMarkup,zo.renderToNodeStream=t.renderToNodeStream,zo.renderToStaticNodeStream=t.renderToStaticNodeStream,zo.renderToReadableStream=e.renderToReadableStream,zo}var px=fY(),uh=sT();const GN=jt.createContext(null),an=()=>{const t=jt.useContext(GN);if(!t)throw new Error("useOgma must be used within an OgmaProvider");return t.ogma};function rw(t,e){Object.keys(t).forEach(s=>{const n=t[s];n&&e(s,n)})}function pY(t){return t.startsWith("on")&&t.length>2?t[2].toLowerCase()+t.substring(3):null}function ow(t,e,s){const n={};Object.keys(e).forEach(i=>{if(!i.startsWith("on"))return;const r=pY(i),o=e[i];r&&typeof o=="function"&&(n[r]=o)}),rw(s,(i,r)=>{n[i]||(t.events.off(r),delete s[i])}),rw(n,(i,r)=>{const o=s[i];o&&o!==r&&t.events.off(o),(!o||o!==r)&&(t.events.on(i,r),s[i]=r)})}function L_(t,e){if(t===e)return!0;try{return JSON.stringify(t)===JSON.stringify(e)}catch{return!1}}const aw={},mY=(t,e)=>{const{options:s=aw,children:n,graph:i,onReady:r,theme:o,className:a="ogma-container"}=t,l=jt.useRef({}),u=jt.useRef(null),[h,g]=jt.useState(),[f,p]=jt.useState(),[y,_]=jt.useState(aw),[x,v]=jt.useState();return jt.useImperativeHandle(e,()=>h,[h]),jt.useEffect(()=>{if(!u.current||h)return;const b=new hY({container:u.current,graph:i,options:s});p(i),_(s),o&&(v(o),b.styles.setTheme(o)),ow(b,t,l.current),g(b),r&&r(b)},[u.current]),jt.useLayoutEffect(()=>{const b=()=>h==null?void 0:h.view.forceResize();return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]),jt.useEffect(()=>{h&&(i&&L_(i,f)===!1&&(p(i),h.setGraph(i)),s&&L_(s,y)===!1&&(_(s),h.setOptions(s)))},[i,s]),jt.useEffect(()=>{h&&o&&L_(o,x)===!1&&(v(o),h.styles.setTheme(o))},[o]),jt.useEffect(()=>{h&&ow(h,t,l.current)},[t]),rs.createElement("div",{style:{width:"100%",height:"100%"},className:a,ref:u},h&&rs.createElement(GN.Provider,{value:{ogma:h}},n))},_Y=jt.memo(jt.forwardRef(mY)),yY=jt.forwardRef(({selector:t,attributes:e},s)=>{const n=an(),[i,r]=jt.useState();return jt.useImperativeHandle(s,()=>i,[i]),jt.useEffect(()=>{const o=t?n.styles.addNodeRule(t,e):n.styles.addNodeRule(e);return r(o),()=>{o.destroy(),r(void 0)}},[t,e]),null}),xY=({attributes:t,fullOverwrite:e})=>{const s=an();return jt.useEffect(()=>(s.styles.setHoveredNodeAttributes(t,e),()=>{s.styles.setHoveredNodeAttributes(null)}),[t,e]),null},vY=({attributes:t,fullOverwrite:e})=>{const s=an();return jt.useEffect(()=>(s.styles.setSelectedNodeAttributes(t,e),()=>{s.styles.setSelectedNodeAttributes(null)}),[t,e]),null},bY=Object.assign(yY,{Hovered:xY,Selected:vY}),EY=jt.forwardRef(({selector:t,attributes:e},s)=>{const n=an(),[i,r]=jt.useState();return jt.useImperativeHandle(s,()=>i,[i]),jt.useEffect(()=>{const o=t?n.styles.addEdgeRule(t,e):n.styles.addEdgeRule(e);return r(o),()=>{o.destroy(),r(void 0)}},[t,e]),null}),SY=({attributes:t,fullOverwrite:e})=>{const s=an();return jt.useEffect(()=>(s.styles.setHoveredEdgeAttributes(t,e),()=>{s.styles.setHoveredEdgeAttributes(null)}),[t,e]),null},AY=({attributes:t,fullOverwrite:e})=>{const s=an();return jt.useEffect(()=>(s.styles.setSelectedEdgeAttributes(t,e),()=>{s.styles.setSelectedEdgeAttributes(null)}),[t,e]),null},wY=Object.assign(EY,{Hovered:SY,Selected:AY}),TY=jt.forwardRef(({name:t,edgeAttributes:e,edgeDependencies:s,edgeOutput:n,nodeAttributes:i,nodeDependencies:r,nodeOutput:o},a)=>{const l=an(),[u,h]=jt.useState(null);return jt.useImperativeHandle(a,()=>u,[u]),jt.useEffect(()=>{const g={edgeAttributes:e,edgeDependencies:s,edgeOutput:n,nodeAttributes:i,nodeDependencies:r,nodeOutput:o};async function f(){const p=l.styles.createClass({name:t,...g});await l.view.afterNextFrame(),h(p)}return f(),()=>{async function p(){const y=l.styles.getClass(t);y&&await y.destroy(),h(null)}p()}},[]),jt.useEffect(()=>{u&&u.update({edgeAttributes:e,edgeDependencies:s,edgeOutput:n,nodeAttributes:i,nodeDependencies:r,nodeOutput:o})},[e,s,n,i,r,o]),null}),CY=(t,e)=>t.name===e.name&&t.edgeAttributes===e.edgeAttributes&&t.edgeDependencies===e.edgeDependencies&&t.edgeOutput===e.edgeOutput&&t.nodeAttributes===e.nodeAttributes&&t.nodeDependencies===e.nodeDependencies&&t.nodeOutput===e.nodeOutput;jt.memo(TY,CY);function Xa(t,e,s){e===t.isEnabled()&&(e?t.disable(s):t.enable(s))}function Za(t,e,s){const n=({target:l})=>{l===e&&t.onEnabled&&t.onEnabled(e)},i=({target:l})=>{l===e&&t.onDisabled&&t.onDisabled(e)},r=({target:l})=>{l===e&&t.onUpdated&&t.onUpdated(e)},o=({target:l,index:u})=>{l===e&&t.onSetIndex&&t.onSetIndex(e,u)},a=({target:l})=>{l===e&&(t.onDestroyed&&t.onDestroyed(e),s.events.off(n).off(i).off(r).off(o).off(a))};return s.events.on("transformationEnabled",n).on("transformationDisabled",i).on("transformationDestroyed",a).on("transformationSetIndex",o).on("transformationRefresh",r),()=>{s.events.off(n).off(i).off(r).off(o).off(a)}}function LY(t,e){const s=an(),[n,i]=jt.useState();return jt.useImperativeHandle(e,()=>n,[n]),jt.useEffect(()=>{const r=s.transformations.addNodeGrouping({...t,enabled:!t.disabled});return Za(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),jt.useEffect(()=>{n&&Xa(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),jt.useEffect(()=>{n==null||n.setOptions(t)},[t.groupIdFunction,t.groupSelfLoopEdges,t.edgeGenerator,t.nodeGenerator,t.groupEdges,t.padding,t.selector,t.showContents,t.separateEdgesByDirection]),null}jt.forwardRef(LY);function kY(t,e){const s=an(),[n,i]=jt.useState();return jt.useImperativeHandle(e,()=>n,[n]),jt.useEffect(()=>{const r=s.transformations.addEdgeGrouping({...t,enabled:!t.disabled});return Za(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),jt.useEffect(()=>{n&&Xa(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),jt.useEffect(()=>{n==null||n.setOptions(t)},[t.selector,t.generator,t.groupIdFunction,t.separateEdgesByDirection]),null}jt.forwardRef(kY);function NY(t,e){const s=an(),[n,i]=jt.useState();return jt.useImperativeHandle(e,()=>n,[n]),jt.useEffect(()=>{const r=s.transformations.addNodeCollapsing({...t,enabled:!t.disabled});return Za(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),jt.useEffect(()=>{n&&Xa(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),jt.useEffect(()=>{n==null||n.setOptions(t)},[t.edgeGenerator,t.selector]),null}jt.forwardRef(NY);function MY(t,e){const s=an(),[n,i]=jt.useState();return jt.useImperativeHandle(e,()=>n,[n]),jt.useEffect(()=>{const r=s.transformations.addNeighborMerging({...t,enabled:!t.disabled});return Za(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),jt.useEffect(()=>{n&&Xa(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),jt.useEffect(()=>{n==null||n.setOptions(t)},[t.dataFunction,t.selector]),null}jt.forwardRef(MY);function IY(t,e){const s=an(),[n,i]=jt.useState();return jt.useImperativeHandle(e,()=>n,[n]),jt.useEffect(()=>{const r=s.transformations.addNeighborGeneration({...t,enabled:!t.disabled});return Za(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),jt.useEffect(()=>{n&&Xa(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),jt.useEffect(()=>{n==null||n.setOptions(t)},[t.edgeGenerator,t.nodeGenerator,t.neighborIdFunction,t.selector]),null}jt.forwardRef(IY);function RY(t,e){const s=an(),[n,i]=jt.useState();return jt.useImperativeHandle(e,()=>n,[n]),jt.useEffect(()=>{const r=s.transformations.addEdgeFilter({...t,enabled:!t.disabled});return Za(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),jt.useEffect(()=>{n&&Xa(n,!!t.disabled,t.duration)},[t.disabled]),jt.useEffect(()=>{n==null||n.setOptions(t)},[t.criteria]),null}jt.forwardRef(RY);function FY(t,e){const s=an(),[n,i]=jt.useState();return jt.useImperativeHandle(e,()=>n,[n]),jt.useEffect(()=>{const r=s.transformations.addNodeFilter({...t,enabled:!t.disabled});return Za(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),jt.useEffect(()=>{n&&Xa(n,!!t.disabled,t.duration)},[t.disabled]),jt.useEffect(()=>{n==null||n.setOptions(t)},[t.criteria]),null}jt.forwardRef(FY);function PY(t,e,s,n){return typeof s=="string"?s:typeof s=="function"?px.renderToString(s(t,e)):px.renderToString(n)}function Nf(t,e){return typeof t=="function"?t(e):t}const lw=(t,e)=>`${t} ${t}--${e}`;function zY(t="&times;",e){if(t){const s=typeof t=="string"?t:px.renderToString(t);return`<div class=${e}>${s}</div>`}return""}function DY(t){return t.endsWith("Doubleclick")?"doubleclick":t.toLowerCase().endsWith("click")?"click":"mouseover"}function OY(t,e){if(t instanceof yi){const s=t.getAttribute("radius"),n=uw("outer",t,e),i=uw("inner",t,e);return s+n+i}else if(t instanceof Mr)return t.size;return 0}function uw(t,e,s){const n=e.getAttribute(`${t}Stroke.width`);return e.getAttribute(`${t}Stroke.minVisibleSize`)>e.size?0:e.getAttribute(`${t}Stroke.scalingMethod`)==="fixed"?n:n/s}function dw(t,e,s){const n=OY(t,e),i={x:0,y:0};switch(s){case"top":i.y=-n;break;case"bottom":i.y=n;break;case"left":i.x=-n;break;case"right":i.x=n;break}return i}function BY(t,e,s){return t.left<0?"right":t.right>e?"left":t.top<0?"bottom":t.bottom>s?"top":null}function hw(t,e,s){switch(t||e){case"top":return`translate(calc(-50% + ${s.x}px),calc(-100% + ${s.y}px))`;case"bottom":return`translate(calc(-50% + ${s.x}px),${s.y}px)`;case"left":return`translate(calc(-100% + ${s.x}px),calc(-50% + ${s.y}px))`;default:return`translate(${s.x}px,calc(-50% + ${s.y}px))`}}const k_={x:-9999,y:-9999},UY="ogma-popup--content",GY="ogma-popup--close",VY="ogma-popup--body",jY="ogma-popup",HY=({content:t,position:e,children:s,isOpen:n=!0,closeButton:i,onClose:r=()=>{},placement:o="top",popupClass:a=jY,closeButtonClass:l=GY,contentClass:u=UY,popupBodyClass:h=VY,size:g,closeOnEsc:f=!0},p)=>{const y=an(),[_,x]=jt.useState(null);if(jt.useImperativeHandle(p,()=>_,[_]),jt.useEffect(()=>{let b=null,S=null,A=null;if(n){const w=Nf(e,y)||k_;if(b=y.layers.addOverlay({position:w||k_,element:`<div class="${lw(a,o)}"/>
          <div class="${h}">
            ${zY(i,l)}
            <div class="${u} "></div>
          </div>
        </div>`,size:g||{width:"auto",height:"auto"},scaled:!1}),A=L=>{const I=b==null?void 0:b.element.querySelector(`.${l}`);L.target&&I.contains(L.target)&&(L.stopPropagation(),L.preventDefault(),r())},S=({code:L})=>{L===27&&r()},f&&y.events.on("keyup",S),b.element.addEventListener("click",A),x(b),t&&!s){const L=b.element.querySelector(`.${u}`),I=PY(y,w,t,s);L&&(L.innerHTML=I)}x(b)}return()=>{b&&(A&&b.element.removeEventListener("click",A),S&&y.events.off(S),b.destroy(),x(null))}},[n,y]),jt.useEffect(()=>{if(_&&_.element){const b=Nf(e,y)||k_;if(_.setPosition(b),_.element.className=lw(a,o),t&&!s){const S=_.element.querySelector(`.${u}`);S&&(S.innerHTML=typeof t=="string"?t:"")}n?_.show():_.hide()}},[_,e,n,o,a,t,s]),!_||!n)return null;const v=_.element.querySelector(`.${u}`);return v&&s?uh.createPortal(s,v):null};jt.forwardRef(HY);const $Y={x:-9999,y:-9999},qY=({eventName:t,position:e,children:s,placement:n="top",bodyClass:i="ogma-tooltip--body",translate:r={x:0,y:0},size:o},a)=>{const l=an(),[u,h]=jt.useState(),[g,f]=jt.useState(),[p,y]=jt.useState(null);jt.useImperativeHandle(a,()=>p,[p]);function _(v,b){if(e)p==null||p.show();else{const w=l.geo.enabled()?l.geo.getZoom():l.view.getZoom(),L=dw(v,w,n),I={x:b.x+L.x,y:b.y+L.y};f(b),p==null||p.setPosition(I)}const S=hw(null,n,r),A=p.element.children[0];A.style.transform=S}function x(){p==null||p.hide(),h(void 0)}if(jt.useEffect(()=>{const v=l.layers.addOverlay({position:e||$Y,element:`
      <div style="pointer-events: none">
        <div class="${i}" style="pointer-events: auto">
        </div>
      </div>`,size:o||{width:"auto",height:"auto"},scaled:!1});y(v)},[]),jt.useEffect(()=>{if(!p)return;let v=()=>null,b=()=>null;const S=DY(t);return S==="mouseover"?(v=A=>{var w;if(t.startsWith("node")){if((w=A.target)!=null&&w.isNode){const L=A.target;h(L),_(L,L.getPosition())}}else if(t.startsWith("edge")&&A.target&&!A.target.isNode){const L=l.view.screenToGraphCoordinates({x:A.x,y:A.y});h(A.target),_(A.target,L)}},b=A=>{var w;(t.startsWith("node")&&((w=A.target)!=null&&w.isNode)||t.startsWith("edge")&&A.target&&!A.target.isNode)&&x()},l.events.on("mouseout",b)):(v=A=>{var w;if(!(t.endsWith("Rightclick")&&A.button==="left")){if(t.startsWith("background")){if(!A.target){const L=l.view.screenToGraphCoordinates({x:A.x,y:A.y});h(L),_("background",L)}}else if(t.startsWith("node")){if((w=A.target)!=null&&w.isNode){const L=A.target;h(L),_(L,L.getPosition())}}else if(A.target&&!A.target.isNode){const L=l.view.screenToGraphCoordinates({x:A.x,y:A.y});h(A.target),_(A.target,L)}}},b=A=>{var w;t.startsWith("node")?(w=A.target)!=null&&w.isNode||x():t.startsWith("edge")?(!A.target||A.target.isNode)&&x():t.startsWith("background")&&(A.target||t.endsWith("Rightclick")&&A.button==="left"||t.endsWith("Click")&&A.button==="right")&&x()},l.events.on("click",b)),p.hide(),l.events.on(S,v),()=>{l.events.off(v),l.events.off(b),p&&(p.destroy(),y(null))}},[p]),jt.useEffect(()=>{!p||!p.element||(e&&p.setPosition(e),(n||i)&&(p.element.firstElementChild.className="ogma-popup--body "+i),o&&p.setSize(o))},[e,n,o,i]),jt.useEffect(()=>{if(!p||!p.element||!u)return;const v=p.element,b=v.children[0].getBoundingClientRect(),S=v.ownerDocument.defaultView,A=BY(b,S.innerWidth,S.innerHeight);if(A){const w=l.geo.enabled()?l.geo.getZoom():l.view.getZoom(),L=u instanceof yi||u instanceof Mr?u:"background",I=dw(L,w,A);p==null||p.setPosition({x:g.x+I.x,y:g.y+I.y});const F=hw(A,n,r);v.children[0].style.transform=F}p.show()},[g]),!p||!p.element)return null;if(s instanceof Function){if(!u)return null;const v=s(u);return v===null?(p.hide(),null):uh.createPortal(v,p.element.firstElementChild)}else return s?uh.createPortal(s,p.element.firstElementChild):null};jt.forwardRef(qY);const YY=({noClear:t=!1,isStatic:e=!1,render:s,index:n,visible:i=!0},r)=>{const o=an(),[a,l]=jt.useState(null);return jt.useImperativeHandle(r,()=>a,[a]),jt.useEffect(()=>{const u=o.layers.addCanvasLayer(s,{isStatic:e,noClear:t},n);return l(u),()=>{u&&(u.destroy(),l(null))}},[]),jt.useEffect(()=>{a&&(n!==void 0&&isFinite(n)&&a.moveTo(n),i?a.show():a.hide())},[a,n,i]),null};jt.forwardRef(YY);const N_={x:-9999,y:-9999};jt.forwardRef(({position:t,children:e,className:s="",size:n,scaled:i,index:r},o)=>{const a=an(),[l,u]=jt.useState(null);return jt.useImperativeHandle(o,()=>l,[l]),jt.useEffect(()=>{const h=Nf(t,a)||N_,g=document.createElement("div");g.className=s;const f=a.layers.addOverlay({position:h||N_,element:g,size:n||{width:"auto",height:"auto"},scaled:i},r);return u(f),()=>{l&&(l.destroy(),u(null))}},[]),jt.useEffect(()=>{if(l){const h=Nf(t,a)||N_;s&&(l.element.className=s),r!==void 0&&isFinite(r)&&l.moveTo(r),l.setPosition(h)}},[t,s,r]),l?uh.createPortal(e,l.element):null});const WY=jt.forwardRef(({children:t,className:e="",index:s},n)=>{const i=an(),[r,o]=jt.useState(null);return jt.useImperativeHandle(n,()=>r,[r]),jt.useEffect(()=>{const a=document.createElement("div");a.className=e;const l=i.layers.addLayer(a,s);return o(l),()=>{r&&(r.destroy(),o(null))}},[]),jt.useEffect(()=>{r&&(e&&(r.element.className=e),s!==void 0&&isFinite(s)&&r.moveTo(s))},[e,s]),r?uh.createPortal(t,r.element):null}),Mg=WY;function XY(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var cw={exports:{}},gw;function ZY(){return gw||(gw=1,(function(t){var e=Object.prototype.hasOwnProperty,s="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(s=!1));function i(l,u,h){this.fn=l,this.context=u,this.once=h||!1}function r(l,u,h,g,f){if(typeof h!="function")throw new TypeError("The listener must be a function");var p=new i(h,g||l,f),y=s?s+u:u;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],p]:l._events[y].push(p):(l._events[y]=p,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,h;if(this._eventsCount===0)return l;for(h in u=this._events)e.call(u,h)&&l.push(s?h.slice(1):h);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=s?s+l:l,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var g=0,f=h.length,p=new Array(f);g<f;g++)p[g]=h[g].fn;return p},a.prototype.listenerCount=function(l){var u=s?s+l:l,h=this._events[u];return h?h.fn?1:h.length:0},a.prototype.emit=function(l,u,h,g,f,p){var y=s?s+l:l;if(!this._events[y])return!1;var _=this._events[y],x=arguments.length,v,b;if(_.fn){switch(_.once&&this.removeListener(l,_.fn,void 0,!0),x){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,u),!0;case 3:return _.fn.call(_.context,u,h),!0;case 4:return _.fn.call(_.context,u,h,g),!0;case 5:return _.fn.call(_.context,u,h,g,f),!0;case 6:return _.fn.call(_.context,u,h,g,f,p),!0}for(b=1,v=new Array(x-1);b<x;b++)v[b-1]=arguments[b];_.fn.apply(_.context,v)}else{var S=_.length,A;for(b=0;b<S;b++)switch(_[b].once&&this.removeListener(l,_[b].fn,void 0,!0),x){case 1:_[b].fn.call(_[b].context);break;case 2:_[b].fn.call(_[b].context,u);break;case 3:_[b].fn.call(_[b].context,u,h);break;case 4:_[b].fn.call(_[b].context,u,h,g);break;default:if(!v)for(A=1,v=new Array(x-1);A<x;A++)v[A-1]=arguments[A];_[b].fn.apply(_[b].context,v)}}return!0},a.prototype.on=function(l,u,h){return r(this,l,u,h,!1)},a.prototype.once=function(l,u,h){return r(this,l,u,h,!0)},a.prototype.removeListener=function(l,u,h,g){var f=s?s+l:l;if(!this._events[f])return this;if(!u)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!g||p.once)&&(!h||p.context===h)&&o(this,f);else{for(var y=0,_=[],x=p.length;y<x;y++)(p[y].fn!==u||g&&!p[y].once||h&&p[y].context!==h)&&_.push(p[y]);_.length?this._events[f]=_.length===1?_[0]:_:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=s?s+l:l,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=s,a.EventEmitter=a,t.exports=a})(cw)),cw.exports}var KY=ZY();const QY=XY(KY),hp="dragging",dh="dragstart",mx="dragend",_x="click",VN="select",jN="unselect",HN="remove",Mf="add",yx="cancelDrawing",If="completeDrawing",$N="update",JY="link",qN="history",YN=5,tW=3,O0={SHAPES:1,EDITOR:2,HANDLES:3},Ci="start",Go="end",rn={default:"default",move:"move",pointer:"pointer",crosshair:"crosshair",grab:"grab",grabbing:"grabbing",ewResize:"ew-resize",nsResize:"ns-resize",nwResize:"nw-resize",neResize:"ne-resize",swResize:"sw-resize",seResize:"se-resize"},hh="collapsed",WN="expanded",XN=1.2,eW=.2,mn={TEXT:"text",NODE:"node",COMMENT:"comment",POLYGON:"polygon"},ZN=`<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>`;let Ka=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,s)=>(s&=63,s<36?e+=s.toString(36):s<62?e+=(s-26).toString(36).toUpperCase():s>62?e+="-":e+="_",e),"");function sW(t,e){const s=t[0]-e[0],n=t[1]-e[1];return s*s+n*n}function nW(t,e,s){let n=e[0],i=e[1],r=s[0]-n,o=s[1]-i;if(r!==0||o!==0){const a=((t[0]-n)*r+(t[1]-i)*o)/(r*r+o*o);a>1?(n=s[0],i=s[1]):a>0&&(n+=r*a,i+=o*a)}return r=t[0]-n,o=t[1]-i,r*r+o*o}function iW(t,e){let s=t[0];const n=[s];let i;for(let r=1,o=t.length;r<o;r++)i=t[r],sW(i,s)>e&&(n.push(i),s=i);return s!==i&&n.push(i),n}function xx(t,e,s,n,i){let r=n,o=0;for(let a=e+1;a<s;a++){const l=nW(t[a],t[e],t[s]);l>r&&(o=a,r=l)}r>n&&(o-e>1&&xx(t,e,o,n,i),i.push(t[o]),s-o>1&&xx(t,o,s,n,i))}function rW(t,e){const s=t.length-1,n=[t[0]];return xx(t,0,s,e,n),n.push(t[s]),n}function fw(t,e,s){if(t.length<=2)return t;const n=e!==void 0?e*e:1;return t=s?t:iW(t,n),t=rW(t,n),t}function pw(t){if(t.geometry.bbox)return t.geometry.bbox;const e=t.geometry.coordinates[0];let s=1/0,n=1/0,i=-1/0,r=-1/0;for(const[o,a]of e)o<s&&(s=o),o>i&&(i=o),a<n&&(n=a),a>r&&(r=a);return[s,n,i,r]}function KN(t){const e=t.geometry.coordinates[0];let s=0,n=0;const i=e.length-1;for(let r=0;r<i;r++)s+=e[r][0],n+=e[r][1];return{x:s/i,y:n/i}}function oW(t,e,s){const n=t.geometry.coordinates.map(o=>o.map(([a,l])=>[a+e,l+s])),i=t.geometry.bbox,r=i?[i[0]+e,i[1]+s,i[2]+e,i[3]+s]:void 0;return{...t,geometry:{...t.geometry,coordinates:n,bbox:r}}}function aW(t){const e=t.geometry.coordinates[0];let s=1/0,n=1/0,i=-1/0,r=-1/0;for(const[o,a]of e)o<s&&(s=o),o>i&&(i=o),a<n&&(n=a),a>r&&(r=a);t.geometry.bbox=[s,n,i,r]}const lW="http://www.w3.org/2000/svg";function As(t){return document.createElementNS(lW,t)}function Zr(t){return t.geometry.bbox||ch(t),t.geometry.bbox}function qn(t){if("width"in t.properties&&"height"in t.properties)return{width:t.properties.width,height:t.properties.height};const e=Zr(t);return{width:e[2]-e[0],height:e[3]-e[1]}}function iu(t,e=!1,s=1){if(t.geometry.type==="Point"&&"width"in t.properties&&"height"in t.properties){const[i,r]=t.geometry.coordinates;let o=t.properties.width,a=t.properties.height;return e&&(o/=s,a/=s),{x:i-o/2,y:r-a/2}}const n=Zr(t);return{x:n[0],y:n[1]}}function _i(t){if(t.geometry.type==="Point")return{x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};const e=Zr(t);return{x:(e[0]+e[2])/2,y:(e[1]+e[3])/2}}function ch(t){if(xi(t)){const[e,s]=t.geometry.coordinates[0],[n,i]=t.geometry.coordinates[1];t.geometry.bbox=[Math.min(e,n),Math.min(s,i),Math.max(e,n),Math.max(s,i)]}else if(t.geometry.type==="Point"&&"width"in t.properties&&"height"in t.properties){const[e,s]=t.geometry.coordinates,n=t.properties.width/2,i=t.properties.height/2;t.geometry.bbox=[e-n,s-i,e+n,s+i]}else if(t.geometry.type==="Polygon"){const e=t.geometry.coordinates[0];let s=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY;for(const o of e){const a=o[0],l=o[1];a<s&&(s=a),l<n&&(n=l),a>i&&(i=a),l>r&&(r=l)}t.geometry.bbox=[s,n,i,r]}}function QN(t){const[e,s]=t.geometry.coordinates[0];return{x:e,y:s}}function Xg(t,e){const[s,n]=t.geometry.coordinates[e===Ci?0:1];return{x:s,y:n}}function JN(t){const[e,s]=t.geometry.coordinates[1];return{x:e,y:s}}function uW(t,e,s){t.geometry.coordinates[0]=[e,s]}function dW(t,e,s){t.geometry.coordinates[1]=[e,s]}function B0(t){return{start:QN(t),end:JN(t)}}function hW(t,e,s,n){e===Ci?uW(t,s,n):dW(t,s,n)}function tM(t){return Zg(t).reduce((e,s)=>(e[0]=Math.min(s[0],e[0]),e[1]=Math.min(s[1],e[1]),e[2]=Math.max(s[0],e[2]),e[3]=Math.max(s[1],e[3]),e),[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY])}function Zg(t){let e=[];if(t.type=="Point")t.bbox?e=[[t.bbox[0],t.bbox[1]],[t.bbox[2],t.bbox[3]]]:e=[t.coordinates];else if(t.type=="LineString"||t.type=="MultiPoint")e=t.coordinates;else if(t.type=="Polygon"||t.type=="MultiLineString")e=t.coordinates.reduce(function(s,n){return s.concat(n)},[]);else if(t.type=="MultiPolygon")e=t.coordinates.reduce((s,n)=>s.concat(n.reduce((i,r)=>i.concat(r),[])),[]);else if(t.type=="Feature")if(Ws(t)||Yn(t)){const s=Zr(t);e=[[s[0],s[1]],[s[2],s[3]]]}else e=Zg(t.geometry);else t.type=="GeometryCollection"?e=t.geometries.reduce((s,n)=>s.concat(Zg(n)),[]):t.type=="FeatureCollection"&&(e=t.features.reduce((s,n)=>s.concat(Zg(n)),[]));return e}function vx(t,e){if(!e)return{x:t.clientX,y:t.clientY};const s=e.getBoundingClientRect();return{x:t.clientX-s.left-e.clientLeft,y:t.clientY-s.top-e.clientTop}}function cW(t){if(t.startsWith("#")){const e=eM(t),s=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),i=parseInt(e.slice(5,7),16);return{r:s,g:n,b:i,a:1}}else{const e=t.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([0-9.]+))?\)/);if(!e)throw new Error(`Invalid RGB color: ${t}`);return{r:parseInt(e[1]),g:parseInt(e[2]),b:parseInt(e[3]),a:e[4]!==void 0?parseFloat(e[4]):1}}}function eM(t){return t.length===4?t.split("").map(e=>e+e).join(""):t}function mw(){return typeof window<"u"?window:void 0}const gW=(t,e)=>{let s=!1;return(...n)=>{s||(t(...n),s=!0,setTimeout(()=>{s=!1},e))}};function fW(t){if((Yn(t)||Ws(t))&&t.geometry.type==="Polygon"){const e=t.geometry.coordinates[0],s=e[0][0],n=e[0][1],i=e[2][0],r=e[2][1],o=i-s,a=r-n,l=s+o/2,u=n+a/2;return{...t,geometry:{type:"Point",coordinates:[l,u],bbox:[s,n,i,r]},properties:{...t.properties,width:o,height:a}}}return t}function pW(t,e){let s,n,i,r=1;const o=t.trim();if(o.startsWith("#")){const u=(o.length===4?eM(o):o).match(/#?(\w{2})(\w{2})(\w{2})/);if(!u)return t;s=parseInt(u[1],16),n=parseInt(u[2],16),i=parseInt(u[3],16)}else{const u=o.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([0-9.]+))?\)/);if(!u)return t;s=parseInt(u[1]),n=parseInt(u[2]),i=parseInt(u[3]),r=u[4]!==void 0?parseFloat(u[4]):1}const a=e*100,l=.299*s+.587*n+.114*i>186?-a/2:a;return s=Math.max(0,Math.min(255,s+Math.round(2.55*l))),n=Math.max(0,Math.min(255,n+Math.round(2.55*l))),i=Math.max(0,Math.min(255,i+Math.round(2.55*l))),`rgba(${s},${n},${i},${r})`}const cp=t=>pW(t,eW),Vn=(t,e)=>({x:t.x-e.x,y:t.y-e.y}),Ar=t=>Math.sqrt(t.x*t.x+t.y*t.y),mW=t=>({x:-t.x,y:-t.y}),Rf=t=>{const e=Ar(t);return e===0?{x:0,y:0}:{x:t.x/e,y:t.y/e}},Ha=(t,e)=>({x:t.x+e.x,y:t.y+e.y}),to=(t,e)=>({x:t.x*e,y:t.y*e}),_w=(t,e)=>{const s=Math.sin(e),n=Math.cos(e);return{x:t.x*n-t.y*s,y:t.x*s+t.y*n}},tu=(t,e)=>t.x*e.x+t.y*e.y,_W=(t,e)=>t.x*e.y-t.y*e.x,xi=t=>t.properties.type==="arrow";function sM(t,e,s){const{start:n,end:i}=B0(t),r=Vn(e,n),o=t.properties.style.strokeWidth,a=Vn(i,n),l=Ar(a),u=tu(r,Rf(a));return u>0&&u<l&&Math.abs(_W(r,Rf(a)))<o/2+s}const $a={strokeType:"plain",strokeColor:"#202020",strokeWidth:1,head:"none",tail:"none"};({...$a});const bx=(t=0,e=0,s=0,n=0,i={...$a})=>({id:Ka(),type:"Feature",properties:{type:"arrow",style:{...$a,...i}},geometry:{type:"LineString",coordinates:[[t,e],[s,n]]}}),Yn=t=>t.properties.type==="box";function yW(t,e,s=0,n=1,i=0){const r=iu(t),{width:o,height:a}=qn(t),l=e.x-r.x,u=e.y-r.y,h=l*n-u*s,g=l*s+u*n;return h>-i&&h<o+i&&g>-i&&g<a+i}const gh={background:"#f5f5f5",strokeWidth:0,borderRadius:8,padding:16,strokeType:"plain"};({...gh});const yw=(t=0,e=0,s=100,n=50,i={...gh})=>({id:Ka(),type:"Feature",properties:{type:"box",width:s,height:n,style:{...gh,...i}},geometry:{type:"Point",coordinates:[t+s/2,e+n/2]}}),Ws=t=>t.properties.type==="text",nn={font:"sans-serif",fontSize:18,color:"#505050",background:"#f5f5f5",strokeWidth:0,borderRadius:8,padding:16,strokeType:"plain",fixedSize:!1};Ka(),{...nn};const xw=(t=0,e=0,s=100,n=50,i="",r={...nn})=>({id:Ka(),type:"Feature",properties:{type:"text",content:i,width:s,height:n,style:{...nn,...r}},geometry:{type:"Point",coordinates:[t+s/2,e+n/2],bbox:[t,e,t+s,e+n]}});function nM(t,e,s=0,n=0,i=1,r=1){var x;const[o,a]=t.geometry.coordinates;let{width:l,height:u}=qn(t);(x=t.properties.style)!=null&&x.fixedSize&&(l/=r,u/=r);const h=l/2,g=u/2,f=e.x-o,p=e.y-a,y=f*i-p*n,_=f*n+p*i;return y>-h-s&&y<h+s&&_>-g-s&&_<g+s}const Ln=t=>t.properties.type==="comment",Ta={background:"#FFFACD",padding:8,borderRadius:4,strokeColor:"#DDD",strokeWidth:1,strokeType:"plain",iconColor:"#FFCB2F",iconSymbol:"",iconBorderColor:"#aaa",iconBorderWidth:2,minHeight:60,iconSize:32,color:"#333",font:"Arial, sans-serif",fontSize:12,showSendButton:!0,autoGrow:!0,fixedSize:!0},M_={mode:"expanded",width:200,height:60};function xW(t,e,s,n){const i={type:"comment",content:s,mode:(n==null?void 0:n.mode)??M_.mode,width:(n==null?void 0:n.width)??M_.width,height:(n==null?void 0:n.height)??M_.height,author:n==null?void 0:n.author,timestamp:n==null?void 0:n.timestamp,style:{...Ta,...n==null?void 0:n.style}};return{id:Ka(),type:"Feature",properties:i,geometry:{type:"Point",coordinates:[t,e]}}}function vW(t,e,s=0,n,i,r=1){if(t.properties.mode!==hh)return nM(t,e,s,n,i,r);const o=t.properties,a={...Ta,...o.style};let l=a.iconSize,u=a.iconSize;a.fixedSize&&(l/=r,u/=r);const h=l/2,g=u/2,f=e.x-t.geometry.coordinates[0],p=e.y-t.geometry.coordinates[1];return f>=-h-s&&f<=h+s&&p>=-g-s&&p<=g+s}function bW(t,e,s,n,i,r,o,a,l){const u=t-o,h=e-a,g=o+u*r-h*i,f=a+u*i+h*r,p=o+(u+s)*r-h*i,y=a+(u+s)*i+h*r,_=o+(u+s)*r-(h+n)*i,x=a+(u+s)*i+(h+n)*r,v=o+u*r-(h+n)*i,b=a+u*i+(h+n)*r;return l[0]=Math.min(g,p,_,v),l[1]=Math.min(f,y,x,b),l[2]=Math.max(g,p,_,v),l[3]=Math.max(f,y,x,b),l}function EW(t,e,s){const n=s.x-e.x,i=s.y-e.y,r=n*n+i*i;if(r===0){const g=t.x-e.x,f=t.y-e.y;return Math.sqrt(g*g+f*f)}let o=((t.x-e.x)*n+(t.y-e.y)*i)/r;o=Math.max(0,Math.min(1,o));const a=e.x+o*n,l=e.y+o*i,u=t.x-a,h=t.y-l;return Math.sqrt(u*u+h*h)}const Nr=t=>t.properties.type==="polygon";function iM(t,e,s=0){const n=t.geometry.coordinates[0],i=t.geometry.bbox;if(i){const[o,a,l,u]=i;if(e.x<o-s||e.x>l+s||e.y<a-s||e.y>u+s)return!1}let r=!1;for(let o=0,a=n.length-1;o<n.length;a=o++){const l=n[o][0],u=n[o][1],h=n[a][0],g=n[a][1];u>e.y!=g>e.y&&e.x<(h-l)*(e.y-u)/(g-u)+l&&(r=!r)}if(r)return!0;if(s>0)for(let o=0;o<n.length-1;o++){const[a,l]=n[o],[u,h]=n[o+1];if(EW(e,{x:a,y:l},{x:u,y:h})<=s)return!0}return!1}function SW(t,e){const s=t[0];s.length>0&&(s[0][0]!==s[s.length-1][0]||s[0][1]!==s[s.length-1][1])&&s.push([s[0][0],s[0][1]]);let n=1/0,i=1/0,r=-1/0,o=-1/0;for(const[g,f]of s)g<n&&(n=g),g>r&&(r=g),f<i&&(i=f),f>o&&(o=f);const a=[n,i,r,o],{id:l,style:u,...h}=e||{};return{type:"Feature",id:l||Ka(),geometry:{type:"Polygon",coordinates:t,bbox:a},properties:{type:"polygon",style:{...Ca,...u},...h}}}const Ca={...gh,strokeColor:"#000000",strokeWidth:2,background:"transparent"};({...Ca});const vw=t=>t.type==="FeatureCollection";class AW{constructor(e){this.store=e}toggleComment(e){const s=this.store.getState().getFeature(e);if(!s||!Ln(s))return;const n=s;this.store.getState().applyLiveUpdate(e,{properties:{...n.properties,mode:n.properties.mode==="collapsed"?"expanded":"collapsed"}})}updateCommentModesForZoom(e){const s=this.store.getState(),n=s.features;Object.values(n).forEach(i=>{if(Ln(i)){const r=i,o=this.getCommentZoomThreshold(r),a=e<o?hh:WN;r.properties.mode!==a&&s.applyLiveUpdate(r.id,{properties:{...r.properties,mode:a}})}})}getCommentZoomThreshold(e){const s={...e.properties.style};if(s.collapseZoomThreshold!==void 0)return s.collapseZoomThreshold;const n=80/e.properties.width;return Math.max(.1,Math.min(1,n))}}class gp extends EventTarget{constructor(s,n){super();Wt(this,"annotation",null);Wt(this,"ogma");Wt(this,"dragging",!1);Wt(this,"dragStartPoint");Wt(this,"hoveredHandle");Wt(this,"ogmaPanningOption",!1);Wt(this,"store");Wt(this,"draggingWasEnabled",!0);Wt(this,"handleMouseMove",s=>{if(!this.isActive())return;const n=this.store.getState();if(!this.dragging&&n.mousePressed&&n.mousePressPoint&&(this.detectHandle(s,this.ogma.view.getZoom()),this.hoveredHandle)){this.dragStartPoint=n.mousePressPoint,this.onDragStart(s),this.dispatchEvent(new Event(dh)),this.disablePanning();return}this.dragging?this.dragStartPoint&&this.onDrag(s):this.detectHandle(s,this.ogma.view.getZoom())});Wt(this,"handleMouseDown",s=>{!this.isActive()||this.dragging||!this.hoveredHandle||(s.preventDefault(),s.stopPropagation(),this.dragStartPoint=this.clientToCanvas(s),this.onDragStart(s),this.dispatchEvent(new Event(dh)),this.disablePanning())});Wt(this,"disablePanning",()=>{var s,n;this.ogmaPanningOption=!!((n=(s=this.ogma.getOptions().interactions)==null?void 0:s.pan)!=null&&n.enabled),this.ogma.setOptions({interactions:{pan:{enabled:!1},drag:{enabled:!1}}})});Wt(this,"restorePanning",()=>{this.ogma.setOptions({interactions:{pan:{enabled:!0},drag:{enabled:!0}}})});Wt(this,"handleMouseUp",s=>{!this.isActive()||!this.dragging||(this.restorePanning(),this.onDragEnd(s),this.dispatchEvent(new Event(mx)))});this.store=n,this.ogma=s,this.store.subscribe(i=>i.features,i=>{this.isActive()&&!i[this.annotation]&&this.stopEditing()})}cancelEdit(){!this.isActive()||this.annotation===null||this.clearDragState()}clearDragState(){this.dragging=!1,this.dragStartPoint=void 0,this.hoveredHandle=void 0,this.restorePanning(),this.setCursor(rn.default)}commitChange(){this.getAnnotation()&&this.store.getState().commitLiveUpdates()}onDrag(s){this.dispatchEvent(new Event(hp))}onDragStart(s){return this.isActive()?(this.dragging=!0,this.dragStartPoint=this.clientToCanvas(s),this.disablePanning(),!0):!1}onDragEnd(s){return this.isActive()?(this.restorePanning(),this.dragging=!1,!0):!1}clientToCanvas(s){const n=this.ogma,i=vx(s,n.getContainer());return n.view.screenToGraphCoordinates(i)}setAnnotation(s){if(this.annotation=s?s.id:null,this.annotation!==null){const n=this.ogma.getContainer();if(n){const i=mw()||n;i.addEventListener("mousemove",this.handleMouseMove),i.addEventListener("mouseup",this.handleMouseUp,!1),n.addEventListener("mousedown",this.handleMouseDown,!0)}}else{const n=this.ogma.getContainer();if(n){const i=mw()||n;i.removeEventListener("mousemove",this.handleMouseMove),i.removeEventListener("mouseup",this.handleMouseUp),n.removeEventListener("mousedown",this.handleMouseDown)}this.clearDragState(),this.setCursor(rn.default)}}getAnnotation(){return this.store.getState().getFeature(this.annotation)}setCursor(s){var i;const n=(i=this.ogma.getContainer())==null?void 0:i.firstChild;n&&(n.style.cursor=s)}stopEditing(){this.isActive()&&this.setAnnotation(null)}cancelDrawing(){if(!this.isActive())return;const s=this.store.getState();s.drawingFeature===this.annotation&&s.removeFeature(this.annotation),this.stopEditing()}isActive(){return this.annotation!==null}}class wW extends gp{constructor(s,n,i,r,o,a,l){super(s,n);Wt(this,"links");Wt(this,"snapping");Wt(this,"arrowHandler");Wt(this,"arrowStyle");Wt(this,"offsetX");Wt(this,"offsetY");Wt(this,"comment");Wt(this,"startX",0);Wt(this,"startY",0);Wt(this,"onArrowComplete",()=>{var v;this.arrowHandler.removeEventListener("dragend",this.onArrowComplete);const s=this.store.getState(),n=Array.from(s.selectedFeatures);if(n.length===0)return;const i=s.getFeature(n[0]);if(!i||!xi(i))return;const r=i.geometry.coordinates[0],o=i.geometry.coordinates[1],a=o[0]-this.startX,l=o[1]-this.startY,u=Math.sqrt(a*a+l*l);let h,g;u<5?(h=this.startX+this.offsetX,g=this.startY+this.offsetY):(h=o[0],g=o[1]);const f=this.comment;f.geometry.coordinates=[h,g],s.addFeature(f),this.store.setState({drawingFeature:f.id});const p=f.properties.height,y=h,_=g+p*.5;this.snapArrowStart(i,r[0],r[1]);const x=(v=i.properties.link)==null?void 0:v.start;s.updateFeature(i.id,{...i,geometry:{...i.geometry,coordinates:[[y,_],r]},properties:{...i.properties,link:{start:{side:Ci,id:f.id,type:mn.COMMENT,magnet:{x:0,y:.5}},end:x?{side:Go,id:x.id,type:x.type,magnet:x.magnet}:void 0}}}),this.links.add(i,Ci,f.id,mn.COMMENT,{x:0,y:.5}),x&&x.magnet&&this.links.add(i,Go,x.id,x.type,x.magnet),s.setSelectedFeatures([f.id]),this.store.setState({drawingFeature:null})});this.links=i,this.arrowHandler=o,this.snapping=r,this.offsetX=(l==null?void 0:l.offsetX)??100,this.offsetY=(l==null?void 0:l.offsetY)??-50,this.arrowStyle=l==null?void 0:l.arrowStyle,this.comment=a}detectHandle(s,n){}startDrawing(s,n,i){var o;this.startX=n,this.startY=i;const r=bx(n,i,n,i,{...$a,head:"arrow",...(o=this.arrowStyle)==null?void 0:o.style});this.store.getState().addFeature(r),this.store.setState({drawingFeature:r.id}),this.arrowHandler.addEventListener("dragend",this.onArrowComplete),this.store.getState().setSelectedFeatures([r.id]),this.arrowHandler.startDrawing(r.id,n,i)}snapArrowStart(s,n,i){const r=this.snapping.snap({x:n,y:i});r&&(s.geometry.coordinates[0]=[r.point.x,r.point.y],s.properties.link={start:{side:Ci,id:r.id,type:r.type,magnet:r.magnet}},this.links.add(s,Ci,r.id,r.type,r.magnet))}}function TW(t,e,s,n,i){const{width:r,height:o}=n.view.getSize(),a=8,l=16,u=a*l,h={width:150,height:50},g=h.width,f=h.height,p=Math.max(r,o),y=200,_={minX:0,minY:0,maxX:0,maxY:0},x=n.view.graphToScreenCoordinates({x:t,y:e});for(let v=0;v<u;v++){const b=v%a,S=Math.floor(v/a),A=2*Math.PI*(b/a),w=y+S/l*(p-y),L=Math.cos(A)*w,I=Math.sin(A)*w,F=x.x+L,O=x.y+I;if(_.minX=F,_.minY=O-f/2,_.maxX=F+g,_.maxY=O+f/2,L<0&&(_.minX-=g,_.maxX-=g),_.minX<0||_.maxX>r||_.minY<0||_.maxY>o)continue;const V=n.view.screenToGraphCoordinates({x:_.minX,y:_.minY}),j=n.view.screenToGraphCoordinates({x:_.maxX,y:_.maxY});if(_.minX=V.x,_.minY=V.y,_.maxX=j.x,_.maxY=j.y,!s.query(_).filter(Z=>Z.properties.type!=="arrow").length)return n.view.screenToGraphCoordinates({x:F,y:O})}return n.view.screenToGraphCoordinates({x:r/2,y:o/2})}class CW{constructor(e,s,n,i,r,o,a){Wt(this,"ogma");Wt(this,"store");Wt(this,"editor");Wt(this,"interactions");Wt(this,"links");Wt(this,"control");Wt(this,"index");Wt(this,"pendingDrawingListener",null);this.ogma=e,this.store=s,this.editor=n,this.interactions=i,this.links=r,this.control=o,this.index=a}cancelPendingDrawing(){this.pendingDrawingListener&&(this.ogma.events.off(this.pendingDrawingListener),this.pendingDrawingListener=null)}isDrawing(){return this.store.getState().drawingFeature!==null}enableDrawingMode(e){this.control.unselect().cancelDrawing();const s=n=>{this.ogma.events.off(s),this.pendingDrawingListener=null;const{x:i,y:r}=this.ogma.view.screenToGraphCoordinates(n);e(i,r)};return this.pendingDrawingListener=s,this.ogma.events.once("mousedown",s),this.control}enableArrowDrawing(e){return this.enableDrawingMode((s,n)=>{const i=bx(s,n,s,n,e);this.startArrow(s,n,i)})}enableTextDrawing(e){return this.enableDrawingMode((s,n)=>{const i=xw(s,n,0,0,void 0,e);this.startText(s,n,i)})}enableBoxDrawing(e){return this.enableDrawingMode((s,n)=>{const i=yw(s,n,0,0,e);this.startBox(s,n,i)})}enablePolygonDrawing(e){return this.enableDrawingMode((s,n)=>{const i=SW([[[s,n]]],{style:e});this.startPolygon(s,n,i)})}enableCommentDrawing(e={}){return this.enableDrawingMode((s,n)=>{let i=e.offsetX,r=e.offsetY;if(i===void 0&&r===void 0){const a=TW(s,n,this.index,this.ogma);i=a.x,r=a.y}const o=xW(s,n,"",e==null?void 0:e.commentStyle);this.startComment(s,n,o,{...e,offsetX:i,offsetY:r})})}startComment(e,s,n,i){this.editor.getActiveHandler()&&this.editor.getActiveHandler().stopEditing(),this.control.cancelDrawing(),this.store.setState({drawingFeature:n.id}),this.interactions.suppressClicksTemporarily(200);const r=new wW(this.ogma,this.store,this.links,this.editor.getSnapping(),this.editor.getArrowHandler(),n,i),o=a=>{var l;a.id===n.id&&(this.control.select(a.id),this.control.off(Mf,o),(l=this.editor.getActiveHandler())==null||l.startEditingText())};return this.control.on(Mf,o),r.startDrawing(n.id,e,s),this.control}startBox(e,s,n){return n||(n=yw(e,s)),this.store.setState({drawingFeature:n.id}),this.control.add(n),this.interactions.suppressClicksTemporarily(200),this.control.select(n.id),this.editor.getActiveHandler().startDrawing(n.id,e,s),this.control}startArrow(e,s,n){return n||(n=bx(e,s)),this.editor.getActiveHandler()&&this.editor.getActiveHandler().stopEditing(),this.control.cancelDrawing(),this.store.setState({drawingFeature:n.id}),this.control.add(n),this.interactions.suppressClicksTemporarily(200),this.control.select(n.id),this.editor.getActiveHandler().startDrawing(n.id,e,s),this.control}startText(e,s,n){return n||(n=xw(e,s)),this.store.setState({drawingFeature:n.id}),this.control.add(n),this.interactions.suppressClicksTemporarily(200),this.control.select(n.id),this.editor.getActiveHandler().startDrawing(n.id,e,s),this.control}startPolygon(e,s,n){return this.store.setState({drawingFeature:n.id}),this.control.add(n),this.interactions.suppressClicksTemporarily(200),this.control.select(n.id),this.editor.getActiveHandler().startDrawing(n.id,e,s),this.control}}class LW{constructor(e,s){this.store=e,this.links=s}undo(){return this.canUndo()?(this.store.temporal.getState().undo(),this.links.refresh(),!0):!1}redo(){return this.canRedo()?(this.store.temporal.getState().redo(),this.links.refresh(),!0):!1}canUndo(){return this.store.temporal.getState().pastStates.length>0}canRedo(){return this.store.temporal.getState().futureStates.length>0}clearHistory(){this.store.temporal.getState().clear()}}class kW{constructor(e){this.store=e}select(e){const s=Array.isArray(e)?e:[e];this.store.getState().setSelectedFeatures(s)}unselect(e){const s=Array.isArray(e)?e:[e];if(e===void 0)this.store.getState().setSelectedFeatures([]);else{const n=new Set(s),i=Array.from(this.store.getState().selectedFeatures).filter(r=>!n.has(r));this.store.getState().setSelectedFeatures(i)}}getSelectedAnnotations(){const e=this.store.getState();return{type:"FeatureCollection",features:Array.from(e.selectedFeatures).map(s=>e.features[s])}}getSelected(){const e=this.store.getState(),s=Array.from(e.selectedFeatures)[0];return s?e.features[s]:null}}class NW{constructor(e){this.store=e}add(e){if(vw(e))for(const s of e.features)this.add(s);else{const s=fW(e);this.store.getState().addFeature(s)}}remove(e){if(vw(e))for(const s of e.features)this.remove(s);else this.store.getState().removeFeature(e.id)}getAnnotations(){const e=this.store.getState().features;return{type:"FeatureCollection",features:Object.values(e)}}getAnnotation(e){return this.store.getState().getFeature(e)}updateStyle(e,s){const n=this.store.getState().getFeature(e);n&&this.store.getState().updateFeature(e,{id:e,properties:{...n.properties,style:{...n.properties.style,...s}}})}update(e){var i;const s=this.store.getState(),n=s.getFeature(e.id);n&&s.updateFeature(e.id,{...n,...e,properties:{...n.properties,...e.properties,style:{...n.properties.style,...(i=e.properties)==null?void 0:i.style}},geometry:{...n.geometry,...e.geometry}})}setScale(e,s,n,i){const r=this.store.getState().getFeature(e);if(!r)return;const o=this.store.getState();if(xi(r)){const a=r.geometry.coordinates.map(([l,u])=>{const h=l-n,g=u-i;return[n+h*s,i+g*s]});o.updateFeature(e,{geometry:{...r.geometry,coordinates:a}})}else if(Ws(r)||Yn(r)){const[a,l]=r.geometry.coordinates,u=a-n,h=l-i,g=n+u*s,f=i+h*s,p=r.properties.width*s,y=r.properties.height*s;o.updateFeature(e,{properties:{...r.properties,width:p,height:y},geometry:{...r.geometry,coordinates:[g,f]}})}}}function rM(t){var s,n;const e=t.properties.link;return e?((s=e.start)==null?void 0:s.type)===mn.COMMENT||((n=e.end)==null?void 0:n.type)===mn.COMMENT:!1}function MW(t){var e,s;return((s=(e=t.properties.link)==null?void 0:e.start)==null?void 0:s.type)!==mn.COMMENT}class IW extends gp{constructor(s,n,i,r){super(s,n);Wt(this,"snapping");Wt(this,"links");Wt(this,"snap",null);this.snapping=i,this.links=r}detectHandle(s){const n=this.getAnnotation(),i=this.clientToCanvas(s),r=YN,o=n.geometry.coordinates[0],a=n.geometry.coordinates[1],l=Math.sqrt(Math.pow(i.x-o[0],2)+Math.pow(i.y-o[1],2)),u=Math.sqrt(Math.pow(i.x-a[0],2)+Math.pow(i.y-a[1],2));l<r?this.grabHandle("start",o[0],o[1]):u<r?this.grabHandle("end",a[0],a[1]):sM(n,i,r)?(this.setCursor(rn.grab),this.hoveredHandle={type:"body",point:i},this.store.setState({hoveredHandle:2})):(this.store.setState({hoveredHandle:-1}),this.hoveredHandle=void 0)}grabHandle(s,n,i){this.hoveredHandle={type:s,point:{x:n,y:i}},this.store.setState({hoveredHandle:s==="start"?0:1}),this.setCursor(rn.move)}onDrag(s){var u;if(!(this.dragStartPoint||!this.hoveredHandle)||!this.isActive())return;s.stopPropagation(),s.stopImmediatePropagation();const n=this.clientToCanvas(s),i=this.hoveredHandle,r=this.getAnnotation();this.snap=this.snapping.snap(n);const o=((u=this.snap)==null?void 0:u.point)||n,a=r.properties.link||{},l=[...r.geometry.coordinates];if(i.type==="start")l[0]=[o.x,o.y],this.snap&&(a.start={side:i.type,id:this.snap.id,type:this.snap.type,magnet:this.snap.magnet});else if(i.type==="end")l[1]=[o.x,o.y],this.snap&&(a.end={side:i.type,id:this.snap.id,type:this.snap.type,magnet:this.snap.magnet});else if(i.type==="body"){const h=o.x-i.point.x,g=o.y-i.point.y,f=r.geometry.coordinates[0],p=r.geometry.coordinates[1];l[0]=[f[0]+h,f[1]+g],l[1]=[p[0]+h,p[1]+g]}this.store.getState().applyLiveUpdate(r.id,{id:r.id,properties:{...r.properties,link:a},geometry:{type:r.geometry.type,coordinates:l}}),this.dispatchEvent(new CustomEvent(hp,{detail:{point:o,annotation:this.annotation,handle:i}}))}onDragStart(s){if(!super.onDragStart(s))return!1;const n=this.getAnnotation(),i=this.hoveredHandle;return i.type==="body"&&rM(n)||i.type==="end"&&!1||i.type==="start"&&!MW(n)?(this.clearDragState(),!1):(this.store.getState().startLiveUpdate([this.annotation]),!0)}onDragEnd(s){if(!super.onDragEnd(s))return!1;if(this.snap&&this.hoveredHandle){const n=this.hoveredHandle;n.type!=="body"&&this.links.add(this.getAnnotation(),n.type,this.snap.id,this.snap.type,this.snap.magnet)}else if(this.snap===null&&this.hoveredHandle){const n=this.getAnnotation(),i=this.hoveredHandle.type;if(n.properties.link&&n.properties.link[i]){this.links.remove(n,i);const r={...n.properties.link};delete r[i],this.store.getState().applyLiveUpdate(n.id,{properties:{...n.properties,link:r}})}}return this.store.getState().drawingFeature===this.annotation&&this.store.setState({drawingFeature:null}),this.commitChange(),this.clearDragState(),this.snap=null,!0}snapDrawingStart(s,n,i){const r=this.snapping.snap({x:n,y:i});if(r){const o={geometry:{...s.geometry,coordinates:[[r.point.x,r.point.y],s.geometry.coordinates[1]]},properties:{...s.properties,link:{start:{side:Ci,id:r.id,type:r.type,magnet:r.magnet}}}},a=this.store.getState();a.applyLiveUpdate(s.id,o),a.updateFeature(s.id,o),this.links.add(s,"start",r.id,r.type,r.magnet)}}startDrawing(s,n,i){this.annotation=s;const r=this.getAnnotation();this.snapDrawingStart(r,n,i),this.grabHandle("end",n,i),this.dragging=!0,this.dragStartPoint={x:n,y:i};const o=this.ogma.view.graphToScreenCoordinates({x:n,y:i});this.onDragStart({clientX:o.x,clientY:o.y})}link(s,n,i){let r=Xg(s,i);const o=s.properties.link||{};let a=null;if(n instanceof yi)r=n.getPosition(),a=this.snapping.snapToNodes(r,n.toList());else{const l=this.store.getState().getFeature(n);if(!l)throw new Error(`Annotation with id ${n} not found`);if(Ws(l)||Yn(l))r=_i(l),a=this.snapping.snapToText(r,[l]);else if(Nr(l))r=KN(l),a=this.snapping.snapToPolygon(r,[l]);else throw new Error(`Cannot link arrow to annotation of type ${l.properties.type}`)}a&&(o[i]={side:i,id:a.id,type:a.type,magnet:a.magnet},this.links.add(s,i,a.id,a.type,a.magnet),hW(s,i,r.x,r.y),this.store.getState().updateFeature(s.id,{properties:{...s.properties,link:o},geometry:{type:s.geometry.type,coordinates:s.geometry.coordinates}}))}}class RW extends gp{constructor(s,n,i){super(s,n);Wt(this,"links");Wt(this,"isDrawingMode",!1);Wt(this,"simplificationTolerance",5);Wt(this,"handleMouseDown",s=>{!this.isActive()||this.dragging||!this.hoveredHandle||(s.preventDefault(),s.stopPropagation(),this.dragStartPoint=this.clientToCanvas(s),this.onDragStart(s),this.dispatchEvent(new Event(dh)),this.disablePanning())});this.links=i}startDrawing(s,n,i){this.annotation=s,this.isDrawingMode=!0;const r=this.store.getState();r.startLiveUpdate([s]),r.setDrawingPoints([]);const o=this.ogma.view.graphToScreenCoordinates({x:n,y:i});return this.dragStartPoint=o,this.disablePanning(),this.onDragStart({clientX:o.x,clientY:o.y}),this}cancelDrawing(){this.isDrawingMode&&(this.isDrawingMode=!1,this.annotation&&(this.store.getState().removeFeature(this.annotation),this.annotation=null)),this.restorePanning()}detectHandle(s,n=1){const i=this.getAnnotation();if(!i)return;const r=this.clientToCanvas(s),o=YN/n,a=i.geometry.coordinates[0];for(let l=0;l<a.length-1;l++){const[u,h]=a[l];if(Math.sqrt(Math.pow(r.x-u,2)+Math.pow(r.y-h,2))<o*2){this.grabHandle("vertex",u,h,l);return}}iM(i,r,o)?(this.setCursor(rn.grab),this.hoveredHandle={type:"body",point:r},this.store.setState({hoveredHandle:-1})):(this.store.setState({hoveredHandle:-1}),this.hoveredHandle=void 0)}grabHandle(s,n,i,r){this.setCursor(s==="vertex"?rn.pointer:rn.grab),this.hoveredHandle={type:s,point:{x:n,y:i},vertexIndex:r},this.store.setState({hoveredHandle:r??0})}onDragStart(s){if(this.isDrawingMode){const n=this.clientToCanvas(s);this.dragging=!0;const i=this.getAnnotation();if(i){const r=[[n.x,n.y],[n.x,n.y]],o=this.store.getState();o.setDrawingPoints(r),o.applyLiveUpdate(i.id,{...i,geometry:{type:"Polygon",coordinates:[r],bbox:[n.x,n.y,n.x,n.y]}})}return this.dragStartPoint=n,!0}return this.hoveredHandle?(this.dragging=!0,this.setCursor(rn.grabbing),this.store.getState().startLiveUpdate([this.annotation]),!0):!1}onDrag(s){if(this.isDrawingMode&&this.dragging){const a=this.clientToCanvas(s),l=this.store.getState(),u=this.getAnnotation();if(!u)return;const h=l.liveUpdates[this.annotation],g=h?{...u,...h}:u,f=l.drawingPoints.slice(0,-1),p=[...f,[a.x,a.y],f[0]];l.setDrawingPoints(p);const y=fw(p,this.simplificationTolerance,!1),_=[...y,y[0]];l.applyLiveUpdate(this.annotation,{...g,geometry:{type:"Polygon",coordinates:[_]}});return}if(!this.dragging||!this.dragStartPoint||!this.hoveredHandle)return;const n=this.clientToCanvas(s),i=n.x-this.dragStartPoint.x,r=n.y-this.dragStartPoint.y,o=this.getAnnotation();if(o){if(this.hoveredHandle.type==="body"){const a=oW(o,i,r);this.store.getState().applyLiveUpdate(o.id,a),this.links.updateLinkedArrowsDuringDrag(o.id,{x:i,y:r})}else if(this.hoveredHandle.type==="vertex"&&this.hoveredHandle.vertexIndex!==void 0){const a=o.geometry.coordinates[0].map((u,h)=>h===this.hoveredHandle.vertexIndex?[this.hoveredHandle.point.x+i,this.hoveredHandle.point.y+r]:h===o.geometry.coordinates[0].length-1&&this.hoveredHandle.vertexIndex===0?[this.hoveredHandle.point.x+i,this.hoveredHandle.point.y+r]:u),l={...o,geometry:{...o.geometry,coordinates:[a]}};aW(l),this.store.getState().applyLiveUpdate(o.id,l)}this.dispatchEvent(new Event(hp))}}onDragEnd(){if(this.isDrawingMode&&this.dragging){const s=this.store.getState(),n=this.getAnnotation();if(n){const i=s.drawingPoints;if(i.length<3)this.cancelDrawing();else{const r=fw(i.slice(1,-1),this.simplificationTolerance,!0),o={...n,geometry:{type:"Polygon",coordinates:[r]}};ch(o),this.store.getState().applyLiveUpdate(n.id,o),this.store.setState({drawingFeature:null}),this.commitChange(),this.isDrawingMode=!1,this.dragging=!1,this.restorePanning(),this.dispatchEvent(new CustomEvent(If,{detail:o}))}}return!0}return!this.dragging||(this.dragging=!1,this.dragStartPoint=void 0,!this.getAnnotation())?!1:(this.commitChange(),this.setCursor(rn.grab),!0)}getAnnotation(){if(this.annotation)return this.store.getState().getFeature(this.annotation)}}const bw=[{x:-.5,y:-.5},{x:0,y:-.5},{x:.5,y:-.5},{x:-.5,y:0},{x:.5,y:0},{x:-.5,y:.5},{x:0,y:.5},{x:.5,y:.5},{x:0,y:0}],FW=[[-.5,-.5,.5,-.5],[.5,-.5,.5,.5],[.5,.5,-.5,.5],[-.5,.5,-.5,-.5]];function Ew(t,e,s,n,i,r,o,a,l){const u=t*i,h=e*r;return l?{x:s+(u*o-h*a),y:n+(u*a+h*o)}:{x:s+u,y:n+h}}class PW extends EventTarget{constructor(s,n,i,r){super();Wt(this,"ogma");Wt(this,"options");Wt(this,"spatialIndex");Wt(this,"hoveredNode",null);Wt(this,"store");this.ogma=s,this.options=n,this.spatialIndex=i,this.store=r}snap(s){return this.findMagnet(s)||null}findMagnet(s){const n=this.options.detectMargin,i={minX:s.x-n,minY:s.y-n,maxX:s.x+n,maxY:s.y+n},r=this.spatialIndex.search(i),o=r.filter(f=>Ws(f)||Yn(f)),a=r.filter(f=>Nr(f)),l=this.ogma.view.getElementsInside(i.minX,i.minY,i.maxX,i.maxY).nodes,u=this.snapToNodes(s,l);if(u)return u;const h=this.snapToText(s,o);return h||this.snapToPolygon(s,a)||null}snapToText(s,n){const{zoom:i}=this.store.getState();for(const r of n){const o=this.snapToMagnetPoints(s,r,i)||this.snapToEdge(s,r,i);if(o)return o}return null}snapToPolygon(s,n){const i=this.options.magnetRadius,r=.5;for(const o of n){const a=o.geometry.coordinates[0].slice(0,-1);if(a.length<3)return this.snapToPolygonStraightEdges(s,o,i);for(let g=0;g<a.length;g++){const[f,p]=a[g];if(Ar(Vn({x:f,y:p},s))<i)return{point:{x:f,y:p},magnet:{x:f,y:p},type:mn.POLYGON,id:o.id}}const l=this.isPointInsidePolygon(s,a);let u=null,h=l?1/0:i;for(let g=0;g<a.length;g++){const f=a[(g-1+a.length)%a.length],p=a[g],y=a[(g+1)%a.length],_=a[(g+2)%a.length],x=p[0]+(y[0]-f[0])/6*r,v=p[1]+(y[1]-f[1])/6*r,b=y[0]-(_[0]-p[0])/6*r,S=y[1]-(_[1]-p[1])/6*r,A=this.findClosestPointOnBezierCurve(s,{x:p[0],y:p[1]},{x,y:v},{x:b,y:S},{x:y[0],y:y[1]});if(A){const w=A.distance;if(l)w<h&&(h=w,u=A.point);else if(w<i)return{point:A.point,magnet:A.point,type:mn.POLYGON,id:o.id}}}if(l&&u)return{point:u,magnet:u,type:mn.POLYGON,id:o.id}}return null}isPointInsidePolygon(s,n){let i=!1;for(let r=0,o=n.length-1;r<n.length;o=r++){const a=n[r][0],l=n[r][1],u=n[o][0],h=n[o][1];l>s.y!=h>s.y&&s.x<(u-a)*(s.y-l)/(h-l)+a&&(i=!i)}return i}snapToPolygonStraightEdges(s,n,i){const r=n.geometry.coordinates[0];for(let o=0;o<r.length-1;o++){const[a,l]=r[o];if(Ar(Vn({x:a,y:l},s))<i)return{point:{x:a,y:l},magnet:{x:a,y:l},type:mn.POLYGON,id:n.id}}for(let o=0;o<r.length-1;o++){const[a,l]=r[o],[u,h]=r[o+1],g={x:a,y:l},f=Vn({x:u,y:h},g),p=Ar(f),y={x:f.x/p,y:f.y/p},_={x:-y.y,y:y.x},x=Vn(s,g),v=Math.abs(tu(_,x)),b=tu(y,x);if(b>=0&&b<=p&&v<i){const S={x:g.x+y.x*b,y:g.y+y.y*b};return{point:S,magnet:S,type:mn.POLYGON,id:n.id}}}return null}findClosestPointOnBezierCurve(s,n,i,r,o){let a=1/0,l=null;const u=20;for(let h=0;h<=u;h++){const g=h/u,f=this.bezierPoint(g,n,i,r,o),p=Ar(Vn(f,s));p<a&&(a=p,l=f)}return l?{point:l,distance:a}:null}bezierPoint(s,n,i,r,o){const a=s*s,l=a*s,u=1-s,h=u*u,g=h*u;return{x:g*n.x+3*h*s*i.x+3*u*a*r.x+l*o.x,y:g*n.y+3*h*s*i.y+3*u*a*r.y+l*o.y}}snapToMagnetPoints(s,n,i){var h;const r=_i(n);let{width:o,height:a}=qn(n);const{sin:l,cos:u}=this.store.getState();(h=n.properties.style)!=null&&h.fixedSize&&(o/=i,a/=i);for(const g of bw){let f=g.x*o,p=g.y*a;if(!Yn(n)){const _=f*u-p*l,x=f*l+p*u;f=_,p=x}const y={x:r.x+f,y:r.y+p};if(!(Ar(Vn(y,s))>=this.options.magnetRadius))return{point:{x:y.x,y:y.y},type:mn.TEXT,magnet:g,id:n.id}}return null}snapToEdge(s,n,i){var _;const{x:r,y:o}=_i(n);let{width:a,height:l}=qn(n);const u=this.options.magnetRadius;(_=n.properties.style)!=null&&_.fixedSize&&(a/=i,l/=i);const{sin:h,cos:g}=this.store.getState(),f=!Yn(n);let p=null,y=1/0;for(let x=0;x<4;x++){const[v,b,S,A]=FW[x],w=Ew(v,b,r,o,a,l,g,h,f),L=Ew(S,A,r,o,a,l,g,h,f),I=Vn(L,w),F=Ar(I),O={x:I.x/F,y:I.y/F},V={x:-O.y,y:O.x},j=Vn(s,w),Z=tu(V,j),at=tu(O,j);if(at>=0&&at<=F){const pt=Math.abs(Z);if(pt<u||pt<y){const K=at/F,ut={point:{x:w.x+O.x*at,y:w.y+O.y*at},magnet:{x:v+(S-v)*K,y:b+(A-b)*K},type:mn.TEXT,id:n.id};if(pt<u)return ut;pt<y&&(y=pt,p=ut)}}}return p&&y<Math.max(a,l)?p:null}snapToNodes(s,n){const i=n.getAttributes(["x","y","radius"]);for(let r=0;r<i.length;r++){const o=i[r],a=Vn({x:o.x,y:o.y},s),l=Ar(a);if(l>=Number(o.radius)+Number(this.options.detectMargin))continue;const u=to(a,1/l),h=l<Number(o.radius)/2,g=h?{x:o.x,y:o.y}:Ha({x:o.x,y:o.y},to(u,-Number(o.radius))),f=h?{x:0,y:0}:u;return{point:g,id:n.get(r).getId(),magnet:f,type:mn.NODE}}return null}getHoveredNode(){return this.hoveredNode}clearHoveredNode(){var s;(s=this.hoveredNode)==null||s.setSelected(!1),this.hoveredNode=null}getMagnets(){return bw}}class zW{constructor(e,s,n,i=()=>{}){Wt(this,"layer");Wt(this,"textarea");Wt(this,"sendButton",null);Wt(this,"isFocused");Wt(this,"unsubscribe");Wt(this,"onFocus",()=>{this.isFocused=!0});Wt(this,"onBlur",()=>{this.getAnnotation()&&this.updateContent(),this.isFocused=!1});Wt(this,"onKeyup",e=>{e.key==="Escape"&&this.textarea.blur(),e.stopPropagation()});Wt(this,"onKeydown",e=>{e.stopPropagation()});Wt(this,"onInput",()=>{this.updateContent(),this.updateStyle(),this.updatePosition(),this.layer.setSize(this.getSize()),this.updateSendButtonState()});Wt(this,"onSendClick",e=>{e.preventDefault(),e.stopPropagation(),!(!this.sendButton||this.sendButton.disabled)&&(this.updateContent(),this.textarea.blur(),this.onSendHandler())});Wt(this,"update",()=>{this.getAnnotation()&&(this.updateStyle(),this.updatePosition(),this.layer.setSize(this.getSize()))});var f,p,y;this.ogma=e,this.store=s,this.annotation=n,this.onSendHandler=i;const r=this.getPosition(),o=this.getSize(),a=this.getAnnotation(),l=this.store.getState(),u=((f=l.options)==null?void 0:f.showSendButton)??!0,h=((p=l.options)==null?void 0:p.sendButtonIcon)||"",g=((y=l.options)==null?void 0:y.textPlaceholder)||"Enter text";this.layer=this.ogma.layers.addOverlay({element:`<div class="ogma-annotation-text-editor">
          <textarea wrap="on" name="annotation-text--input" spellcheck="false" placeholder="${g}"></textarea>
          ${u?`<button class="ogma-send-button" type="button" title="Send">
            <span class="ogma-send-button-icon">${h}</span>
          </button>`:""}
        </div>`,position:r,size:o},O0.EDITOR),this.textarea=this.layer.element.querySelector("textarea"),this.textarea.setAttribute("wrap","on"),this.textarea.setAttribute("spellcheck","false"),this.textarea.value=a.properties.content||"",u&&(this.sendButton=this.layer.element.querySelector(".ogma-send-button"),this.sendButton.addEventListener("click",this.onSendClick),this.updateSendButtonState()),this.isFocused=!1,this.textarea.addEventListener("focus",this.onFocus),this.textarea.addEventListener("blur",this.onBlur),this.textarea.addEventListener("input",this.onInput),this.textarea.addEventListener("keyup",this.onKeyup),this.textarea.addEventListener("keydown",this.onKeydown),this.updateStyle(),this.updatePosition(),this.textarea.focus(),this.unsubscribe=this.store.subscribe(_=>({rotation:_.rotation,zoom:_.zoom,annotation:_.features[this.annotation]}),this.update,{equalityFn:(_,x)=>_.rotation===x.rotation&&_.zoom===x.zoom&&_.annotation===x.annotation})}getAnnotation(){const e=this.store.getState();return e.liveUpdates[this.annotation]?e.liveUpdates[this.annotation]:(e.startLiveUpdate([this.annotation]),this.store.getState().getFeature(this.annotation))}getPosition(){var i;const e=this.getAnnotation();if(!e)return{x:0,y:0};const s=iu(e,(i=e.properties.style)==null?void 0:i.fixedSize,this.store.getState().zoom),n=I_(e);return{x:s.x+n,y:s.y+n}}getSize(){var a;const e=this.getAnnotation(),s=qn(e),n=I_(e),i=((a=e.properties.style)==null?void 0:a.fixedSize)||!1,r=this.store.getState().zoom,o=i?1/r:1;return{width:(s.width-n*2)*o,height:(s.height-n*2)*o}}updateStyle(){const e=this.getAnnotation();if(!e)return;const{font:s,fontSize:n=nn.fontSize,borderRadius:i,color:r,background:o,padding:a=0,fixedSize:l=nn.fixedSize}=e.properties.style||nn,u=this.textarea,h=this.store.getState().zoom,g=l?1/h:1,f=parseFloat(n.toString())*g,p=a*g,y=u.style;if(y.font=`${f} ${s}`,y.fontFamily=s||"sans-serif",y.fontSize=`${f}px`,y.padding=`${p}px`,y.lineHeight=`${f*XN}px`,y.boxSizing="border-box",y.color=r||"black",y.background=o||"transparent",y.borderRadius=`${i}px`,l&&(y.overflow="hidden",y.resize="none"),y.transformOrigin="center",y.transform=`rotate(${this.store.getState().rotation}rad)`,this.sendButton){const _=l?1/h:1;this.sendButton.style.transform=`scale(${_})`,this.sendButton.style.transformOrigin="bottom right"}}updatePosition(){this.layer.setPosition(this.getPosition())}updateContent(){var o,a;const e=this.getAnnotation();let s=e.properties.height,n=e.geometry.coordinates;const i=(o=e.properties.style)==null?void 0:o.fixedSize;if(i){const l=this.textarea.scrollHeight,u=I_(e),h=this.store.getState().zoom,g=(l+u*2/h)*h,f=((a=e.properties.style)==null?void 0:a.minHeight)||50;s=Math.max(f,g);const p=s-e.properties.height;if(Math.abs(p)>1){const[y,_]=e.geometry.coordinates;n=[y,_+p]}}const r={...e,properties:{...e.properties,content:this.textarea.value,height:s},geometry:{...e.geometry,coordinates:n}};i&&Math.abs(e.properties.height-s)>1&&(this.layer.setSize(this.getSize()),this.layer.setPosition(this.getPosition())),this.store.getState().applyLiveUpdate(this.annotation,r)}updateSendButtonState(){if(!this.sendButton)return;const e=this.textarea.value.trim().length===0;this.sendButton.disabled=e}destroy(){this.store.getState().commitLiveUpdates(new Set([this.annotation])),this.unsubscribe(),this.sendButton&&this.sendButton.removeEventListener("click",this.onSendClick),this.layer.destroy()}}function I_(t){var e;return((e=t.properties.style)==null?void 0:e.strokeWidth)||0}const Sw={x:1,y:0},Aw={x:0,y:1},DW=[["top",Aw,-.5,-.5,.5,-.5],["right",Sw,.5,-.5,.5,.5],["bottom",Aw,-.5,.5,.5,.5],["left",Sw,-.5,-.5,-.5,.5]],OW={top:[0,1],right:[1,2],bottom:[2,3],left:[3,0]},ww=[[-.5,-.5],[.5,-.5],[.5,.5],[-.5,.5]],BW=[rn.nwResize,rn.neResize,rn.seResize,rn.swResize];class R_ extends gp{constructor(s,n,i){super(s,n);Wt(this,"links");Wt(this,"textEditor",null);Wt(this,"stopEditingText",()=>{this.textEditor&&(this.store.getState().drawingFeature===this.annotation&&this.store.setState({drawingFeature:null}),this.textEditor.destroy()),this.textEditor=null});this.links=i}detectHandle(s,n){var A;const i=this.getAnnotation(),{x:r,y:o}=this.clientToCanvas(s);let{width:a,height:l}=qn(i);const u=5/n,h=_i(i),g=this.store.getState();let{revSin:f,revCos:p}=g;(Yn(i)||Ln(i))&&(f=0,p=1),this.hoveredHandle=void 0;const y=tW*(1/n),_=r-h.x,x=o-h.y,v=_*p-x*f,b=_*f+x*p,S=((A=i.properties.style)==null?void 0:A.fixedSize)===!0||Ln(i);if(S&&(a/=n,l/=n),!S){for(let w=0;w<ww.length;w++){const[L,I]=ww[w],F=a*L,O=l*I;if(v>=F-y-u&&v<=F+y+u&&b>=O-y-u&&b<=O+y+u){this.hoveredHandle={type:"corner",corner:w},this.store.setState({hoveredHandle:w}),this.setCursor(this.getCornerCursor(w));return}}for(const[w,L,I,F,O,V]of DW){const j=a*I,Z=l*F,at=a*O,pt=l*V,K=tu(L,{x:v-j,y:b-Z});if(Math.abs(K)<u&&v>=j-u&&v<=at+u&&b>=Z-u&&b<=pt+u){this.hoveredHandle={type:"edge",edge:w,corner:-1},this.store.setState({hoveredHandle:OW[w][0]+4}),this.setCursor(this.getEdgeCursor(w));return}}}if(v>=-a/2-u&&v<=a/2+u&&b>=-l/2-u&&b<=l/2+u){this.store.setState({hoveredHandle:8}),this.hoveredHandle={type:"body",corner:-1},this.setCursor(rn.grab);return}this.store.setState({hoveredHandle:-1}),this.setCursor(rn.default)}onDrag(s){if(!this.dragStartPoint||!this.hoveredHandle||!this.isActive())return;s.stopPropagation(),s.stopImmediatePropagation();const n=this.getAnnotation(),i=this.clientToCanvas(s),r={x:i.x-this.dragStartPoint.x,y:i.y-this.dragStartPoint.y},o=this.hoveredHandle,a=this.getAnnotation();let l=null;if(o.type==="corner"?l=this.dragCorner(a,r,o.corner):o.type==="edge"&&o.edge?l=this.dragEdge(a,r,o):o.type==="body"&&(l=this.dragBody(a,r)),l){const u=l;this.store.getState().applyLiveUpdate(n.id,u);const h=Vn(_i(u),_i(a));this.links.updateLinkedArrowsDuringDrag(n.id,h),this.textEditor&&this.textEditor.update()}this.dispatchEvent(new CustomEvent(hp,{detail:{point:i,annotation:this.annotation,handle:o}}))}dragBody(s,n){const i=_i(s);return{...s,geometry:{type:s.geometry.type,coordinates:[i.x+n.x,i.y+n.y]}}}dragCorner(s,n,i){const r=i===0||i===1,o=i===0||i===3,a=i===1||i===2,l=i===2||i===3,{width:u,height:h}=qn(s),g=this.store.getState();let{revSin:f,revCos:p}=g;(Yn(s)||Ln(s))&&(f=0,p=1);const y=n.x*p-n.y*f,_=n.x*f+n.y*p;let x=0,v=0;o?x=-y:a&&(x=y),r?v=-_:l&&(v=_);const b=Math.max(0,u+x),S=Math.max(0,h+v),A=_i(s),w=A.x+n.x/2,L=A.y+n.y/2;return{...s,properties:{...s.properties,width:b,height:S},geometry:{type:s.geometry.type,coordinates:[w,L]}}}dragEdge(s,n,i){const{width:r,height:o}=qn(s),a=_i(s),l=this.store.getState();let{revSin:u,revCos:h}=l;(Yn(s)||Ln(s))&&(u=0,h=1);const g=n.x*h-n.y*u,f=n.x*u+n.y*h;let p=r,y=o,_=0,x=0;switch(i.edge){case"top":y=Math.max(0,o-f),x=f/2;break;case"bottom":y=Math.max(0,o+f),x=f/2;break;case"left":p=Math.max(0,r-g),_=g/2;break;case"right":p=Math.max(0,r+g),_=g/2;break}const v=_*h+x*u,b=-_*u+x*h;return{...s,properties:{...s.properties,width:p,height:y},geometry:{type:s.geometry.type,coordinates:[a.x+v,a.y+b]}}}onDragStart(s){return super.onDragStart(s)?(this.stopEditingText(),this.store.getState().startLiveUpdate([this.annotation]),!0):!1}onClick(s){Ws(this.getAnnotation())&&this.startEditingText()}startEditingText(){this.textEditor===null&&(this.textEditor=new zW(this.ogma,this.store,this.annotation,this.stopEditingText))}onDragEnd(s){var o,a;if(!super.onDragEnd(s))return!1;this.store.getState().drawingFeature===this.annotation&&this.store.setState({drawingFeature:null});const n=this.clientToCanvas(s),i=n.x-(((o=this.dragStartPoint)==null?void 0:o.x)||0),r=n.y-(((a=this.dragStartPoint)==null?void 0:a.y)||0);return Math.abs(i)<1&&Math.abs(r)<1?(this.clearDragState(),this.onClick({clientX:s.clientX,clientY:s.clientY})):this.commitChange(),this.hoveredHandle=void 0,this.dragStartPoint=void 0,this.dragging=!1,!0}getCornerCursor(s){return BW[s]}getEdgeCursor(s){switch(s){case"top":case"bottom":return rn.nsResize;case"left":case"right":return rn.ewResize;default:return rn.default}}stopEditing(){super.stopEditing(),this.commitChange(),this.stopEditingText()}startDrawing(s,n,i){this.annotation=s,this.hoveredHandle={type:"corner",corner:2},this.store.setState({hoveredHandle:2}),this.dragging=!0;const r=this.ogma.view.graphToScreenCoordinates({x:n,y:i});this.dragStartPoint=r,this.disablePanning(),this.onDragStart({clientX:r.x,clientY:r.y})}setAnnotation(s){super.setAnnotation(s),s&&Ln(s)&&s.properties.mode===hh&&this.store.getState().updateFeature(s.id,{properties:{...s.properties,mode:WN}})}}class UW extends EventTarget{constructor(s,n,i,r,o){super();Wt(this,"handlers",new Map);Wt(this,"activeHandler");Wt(this,"interaction");Wt(this,"ogma");Wt(this,"snapping");Wt(this,"store");this.ogma=s,this.store=n,this.interaction=o,this.snapping=new PW(s,{detectMargin:10,magnetRadius:10},i,n),this.handlers.set("box",new R_(this.ogma,this.store,r)),this.handlers.set("text",new R_(this.ogma,this.store,r)),this.handlers.set("comment",new R_(this.ogma,this.store,r)),this.handlers.set("arrow",new IW(this.ogma,this.store,this.snapping,r)),this.handlers.set("polygon",new RW(this.ogma,this.store,r)),this.handlers.forEach(a=>{a.addEventListener("dragstart",()=>{this.dispatchEvent(new Event("dragstart")),this.store.setState({isDragging:!0}),this.interaction.setMode("edit")}),a.addEventListener("dragend",()=>{this.dispatchEvent(new Event("dragend")),this.store.setState({isDragging:!1}),this.interaction.suppressClicksTemporarily()})}),this.store.subscribe(a=>a.selectedFeatures,(a,l)=>{const u=Array.from(a.keys()).filter(g=>!l.has(g)),h=Array.from(l.keys()).filter(g=>!a.has(g));!u.length&&!h.length||(h.forEach(g=>this.stopEditingFeature(g)),u.forEach(g=>this.editFeature(g)))})}stopEditingFeature(s){const n=this.store.getState().features[s];if(!n)return;const i=n.properties.type,r=this.handlers.get(i);r&&r.stopEditing()}editFeature(s){var i;const n=this.store.getState().features[s];n&&(this.setActiveHandler(n.properties.type),(i=this.activeHandler)==null||i.setAnnotation(n))}getSnapping(){return this.snapping}getArrowHandler(){return this.handlers.get("arrow")}getActiveHandler(){return this.activeHandler}setActiveHandler(s){const n=this.handlers.get(s);if(!n)throw new Error(`Handler for type ${s} not found`);return this.activeHandler=n,this}destroy(){}}const GW=["x","y","radius"],VW=1;class jW{constructor(e,s,n){Wt(this,"links",new Map);Wt(this,"nodeToLink",new Map);Wt(this,"annotationToLink",new Map);Wt(this,"linksByArrowId",new Map);Wt(this,"store");Wt(this,"ogma");Wt(this,"updatedItems",new Set);Wt(this,"onLinkCreated");Wt(this,"commitTimeout");Wt(this,"onSetMultipleAttributes",({elements:e,updatedAttributes:s})=>{const n=new Set(s);!e.isNode||!n.has("x")&&!n.has("y")&&!n.has("radius")||this.requestUpdateFromNodePositions(e.toList())});Wt(this,"refresh",()=>{const e=this.store.getState(),s=new Map;this.annotationToLink.forEach((n,i)=>{var o;const r=e.getFeature(i);r&&(Ws(r)&&((o=r.properties.style)!=null&&o.fixedSize)||Ln(r))&&n.forEach(a=>{const l=this.links.get(a);if(!l)return;const u=l.arrow;s.set(u,this.linksByArrowId.get(u))})}),s.size>0&&this.update(s)});Wt(this,"commit",()=>{this.store.getState().batchUpdate(this.commitLiveUpdates),this.updatedItems.clear()});Wt(this,"commitLiveUpdates",()=>{this.store.getState().commitLiveUpdates(this.updatedItems)});Wt(this,"onAddArrow",(e,s)=>{const n=this.store.getState(),i=new Set(Object.keys(s)),r=Object.keys(e).filter(a=>!i.has(a)),o=Object.keys(s).filter(a=>!e[a]);r.forEach(a=>{var h,g;const l=n.getFeature(a);if(!l||!xi(l))return;const u=l;if((h=u.properties.link)!=null&&h.start){const f=u.properties.link.start;f.type==="node"?this.add(u,Ci,f.id,f.type,f.magnet):this.add(u,Ci,f.id,f.type,f.magnet)}if((g=u.properties.link)!=null&&g.end){const f=u.properties.link.end;f.type==="node"?this.add(u,Go,f.id,f.type,f.magnet):this.add(u,Go,f.id,f.type,f.magnet)}}),o.forEach(a=>{const l=s[a];if(xi(l)){const u=l;this.remove(u,Ci),this.remove(u,Go)}else{const u=this.annotationToLink.get(a);if(u)for(const h of u){const g=this.links.get(h);if(!g)continue;const f=n.getFeature(g.arrow);f&&this.remove(f,g.side),this.linksByArrowId.delete(g.arrow),this.links.delete(h)}}})});this.ogma=e,this.store=s,this.onLinkCreated=n,this.store.subscribe(i=>i.features,this.onAddArrow),this.store.subscribe(i=>({zoom:i.zoom,rotation:i.rotation}),this.refresh,{equalityFn:(i,r)=>i.zoom===r.zoom&&i.rotation===r.rotation}),this.ogma.events.on("setMultipleAttributes",this.onSetMultipleAttributes).on("viewChanged",this.refresh)}updateLinkedArrowsDuringDrag(e,s){const n=this.store.getState();if(!n.getFeature(e))return;const i=this.annotationToLink.get(e);if(i)for(const r of i){const o=this.links.get(r);if(!o)continue;const a=n.getFeature(o.arrow),l=Xg(a,o.side),u=Ha(l,s),h={...a.geometry,coordinates:a.geometry.coordinates.map((g,f)=>o.side===Ci&&f===0||o.side===Go&&f===1?[u.x,u.y]:[...g])};n.applyLiveUpdate(a.id,{geometry:h}),this.updatedItems.add(a.id)}}add(e,s,n,i,r){const o=Ka(),a=e.id;let l=r;if(i===mn.POLYGON){const g=this.store.getState().getFeature(n);if(g&&Nr(g)){const f=pw(g),p=f[2]-f[0],y=f[3]-f[1],_=r.x-f[0],x=r.y-f[1],v=p>0?_/p:.5,b=y>0?x/y:.5;l={x:v,y:b}}}const u={id:o,arrow:a,target:n,targetType:i,magnet:l,side:s};if(i===mn.NODE&&!this.ogma.getNode(n))return;this.remove(e,s),this.links.set(o,u);const h=i===mn.NODE?this.nodeToLink:this.annotationToLink;return h.has(n)||h.set(n,new Set),h.get(n).add(o),this.linksByArrowId.has(a)||this.linksByArrowId.set(a,{}),this.linksByArrowId.get(a)[s]=o,e.properties.link=e.properties.link||{},e.properties.link[s]={id:n,side:s,type:i,magnet:l},this.onLinkCreated&&this.onLinkCreated(e,u),this}remove(e,s){var o,a,l,u;const n=e.id,i=(o=this.linksByArrowId.get(n))==null?void 0:o[s];if((a=e.properties.link)==null||delete a[s],!i)return this;const r=this.links.get(i);return r?(this.links.delete(i),(l=this.nodeToLink.get(r.target))==null||l.delete(i),(u=this.annotationToLink.get(r.target))==null||u.delete(i),this.linksByArrowId.has(n)&&(this.linksByArrowId.get(n)[s]=void 0),this):this}requestUpdateFromNodePositions(e){setTimeout(()=>this.updateFromNodePositions(e),1)}updateFromNodePositions(e){const s=e.getId(),n=new Map;s.forEach(a=>{const l=this.nodeToLink.get(a);l&&l.forEach(u=>{const h=this.links.get(u);if(!h)return;const g=h.arrow;n.set(g,this.linksByArrowId.get(g))})});const i=e.getAttributes(GW),r=this.store.getState(),o={};for(let a=0;a<s.length;a++){const l=s[a],u=this.nodeToLink.get(l);if(u)for(const h of u){const g=this.links.get(h);if(!g)continue;const f=g.arrow,p=this.store.getState().getFeature(f),y=p.geometry.coordinates.slice(),_=Xg(p,Go),x=Xg(p,Ci),v=i[a],b=this._getNodeSnapPoint(v,to(Vn(_,x),-1),this._isLinkedToCenter(g));y[g.side===Ci?0:1]=b,o[f]={...p,geometry:{coordinates:y}},this.updatedItems.add(f),g.magnet={x:b[0]-v.x,y:b[1]-v.y},ch(o[f])}}r.applyLiveUpdates(o),this.requestCommit()}update(e=this.linksByArrowId){const s=this.store.getState(),n=Array.from(this.nodeToLink.keys()),i=new Map;n.forEach((a,l)=>i.set(a,l));const r=this.ogma.getNodes(n).getAttributes(["x","y","radius"]),o={};e.forEach((a,l)=>{const u=this.links.get(a.start),h=this.links.get(a.end),g=s.getFeature(l);let f=g.geometry.coordinates[0],p=g.geometry.coordinates[1];const y=u?u.targetType===mn.NODE?r[i.get(u.target)]:this._getAnnotationCenter(s.getFeature(u.target)):{x:f[0],y:f[1]},_=h?h.targetType===mn.NODE?r[i.get(h.target)]:this._getAnnotationCenter(s.getFeature(h.target)):{x:p[0],y:p[1]},x=Vn(_,y);if(u)if(u.targetType===mn.NODE)f=this._getNodeSnapPoint(y,x,this._isLinkedToCenter(u));else{const v=s.getFeature(u.target);f=this._getAnnotationSnapPoint(v,_,u,s.zoom)}if(h)if(h.targetType===mn.NODE)p=this._getNodeSnapPoint(_,to(x,-1),this._isLinkedToCenter(h));else{const v=s.getFeature(h.target);p=this._getAnnotationSnapPoint(v,y,h,s.zoom)}o[g.id]={properties:g.properties,geometry:{coordinates:[f,p]}},ch(o[g.id]),this.updatedItems.add(g.id)}),s.applyLiveUpdates(o),this.requestCommit()}requestCommit(){clearTimeout(this.commitTimeout),this.commitTimeout=setTimeout(this.commit,VW)}_isLinkedToCenter(e){return e.magnet.x===0&&e.magnet.y===0}_getAnnotationCenter(e){return Nr(e)?KN(e):_i(e)}_getAnnotationSnapPoint(e,s,n,i){if(Nr(e)){const r=pw(e),o=r[0]+n.magnet.x*(r[2]-r[0]),a=r[1]+n.magnet.y*(r[3]-r[1]);return[o,a]}return this._getBoxSnapPoint(e,s,n,i)}_getBoxSnapPoint(e,s,n,i){var h;const r=_i(e);let{width:o,height:a}=qn(e);(Ws(e)&&((h=e.properties.style)!=null&&h.fixedSize)||Ln(e))&&(o/=i,a/=i);let l=n.magnet.x*o,u=n.magnet.y*a;if(Ws(e)&&!Yn(e)){const{sin:g,cos:f}=this.store.getState(),p=l*f-u*g,y=l*g+u*f;l=p,u=y}else if(Ln(e)){const g={...e.properties.style}.iconSize||32,f=g/16*.5;l=n.magnet.x*g*f,u=n.magnet.y*g*f}return[r.x+l,r.y+u]}_getNodeSnapPoint(e,s,n){if(n)return[e.x,e.y];const i=Math.sqrt(s.x*s.x+s.y*s.y),r=to(s,1/i),o=i<Number(e.radius)/2?{x:e.x,y:e.y}:Ha({x:e.x,y:e.y},to(r,-Number(e.radius)));return[o.x,o.y]}destroy(){this.ogma.events.off(this.onSetMultipleAttributes)}}function F_(t){return t instanceof HTMLCanvasElement}class HW extends EventTarget{constructor(s,n,i){super();Wt(this,"query",{minX:1/0,minY:1/0,maxX:1/0,maxY:1/0});Wt(this,"suppressClickUntil",0);Wt(this,"mouseDownState",null);Wt(this,"DRAG_THRESHOLD",3);Wt(this,"onMouseMove",s=>{var u;if(!F_(s.target))return;const n=vx(s,this.ogma.getContainer()),i=this.store.getState();if(this.mouseDownState&&!i.isDragging){const h=s.clientX-this.mouseDownState.screenX,g=s.clientY-this.mouseDownState.screenY;Math.sqrt(h*h+g*g)>this.DRAG_THRESHOLD&&(this.mouseDownState.hasMoved=!0)}if(i.isDragging)return;const{x:r,y:o}=this.ogma.view.screenToGraphCoordinates(n),a=((u=this.detect(r,o))==null?void 0:u.id)??null,l=i.hoveredFeature;a!==l&&i.setHoveredFeature(a),this.setCursor(a===null?rn.default:rn.pointer)});Wt(this,"onMouseClick",()=>{Date.now()<this.suppressClickUntil});Wt(this,"onMouseDown",s=>{if(!F_(s.target)||Date.now()<this.suppressClickUntil)return;const n=vx(s,this.ogma.getContainer()),{x:i,y:r}=this.ogma.view.screenToGraphCoordinates(n),o=this.detect(i,r);this.mouseDownState={annotation:o,screenX:s.clientX,screenY:s.clientY,hasMoved:!1};const a=this.store.getState();this.store.setState({mousePressed:!0,mousePressPoint:{x:i,y:r}}),o&&!a.selectedFeatures.has(o.id)&&(s.ctrlKey||s.metaKey?a.toggleSelection(o.id):a.setSelectedFeatures([o.id]))});Wt(this,"onMouseUp",s=>{if(!F_(s.target))return;const n=this.store.getState();if(this.store.setState({mousePressed:!1,mousePressPoint:null}),this.mouseDownState&&!this.mouseDownState.hasMoved&&!n.isDragging){const i=this.mouseDownState.annotation;i?s.ctrlKey||s.metaKey?n.toggleSelection(i.id):n.selectedFeatures.has(i.id)||n.setSelectedFeatures([i.id]):!s.ctrlKey&&!s.metaKey&&n.clearSelection(),this.dispatchEvent(new Event(_x))}this.mouseDownState=null});this.ogma=s,this.store=n,this.index=i;const r=this.ogma.getContainer();r&&(r.addEventListener("mousemove",this.onMouseMove,{passive:!0,capture:!0}),r.addEventListener("click",this.onMouseClick,{passive:!0,capture:!0}),r.addEventListener("mousedown",this.onMouseDown,{passive:!0,capture:!1}),r.addEventListener("mouseup",this.onMouseUp,{passive:!0,capture:!0}))}detect(s,n,i){let r=null;const o=this.store.getState(),a=i??o.options.detectMargin;this.query.minX=s-a,this.query.minY=n-a,this.query.maxX=s+a,this.query.maxY=n+a;const l=this.index.query(this.query);if(l.length===0)return null;for(const u of l){const h=o.getFeature(u.id);if(xi(h)){if(sM(h,{x:s,y:n},a)){r=h;break}}else if(Yn(h)){if(yW(h,{x:s,y:n},0,1,a)){r=h;break}}else if(Nr(h)){if(iM(h,{x:s,y:n},a)){r=h;break}}else if(Ln(h)){if(vW(h,{x:s,y:n},a,o.sin,o.cos,o.zoom)){r=h;break}}else if(Ws(h)&&nM(h,{x:s,y:n},a,o.revSin,o.revCos,o.zoom)){r=h;break}}return r}setCursor(s){var i;const n=(i=this.ogma.getContainer())==null?void 0:i.firstChild;n&&(n.style.cursor=s)}setMode(s){var n;s==="default"?this.setCursor(((n=this.ogma.getOptions().cursor)==null?void 0:n.default)||"default"):s==="add"||s==="link"?this.setCursor(rn.crosshair):s==="rotate"&&this.setCursor(rn.alias)}suppressClicksTemporarily(s=100){this.suppressClickUntil=Date.now()+s}destroy(){const s=this.ogma.getContainer();s&&(s.removeEventListener("mousemove",this.onMouseMove),s.removeEventListener("click",this.onMouseClick))}}function oM(t,e,s=0,n=t.length-1,i=$W){for(;n>s;){if(n-s>600){const l=n-s+1,u=e-s+1,h=Math.log(l),g=.5*Math.exp(2*h/3),f=.5*Math.sqrt(h*g*(l-g)/l)*(u-l/2<0?-1:1),p=Math.max(s,Math.floor(e-u*g/l+f)),y=Math.min(n,Math.floor(e+(l-u)*g/l+f));oM(t,e,p,y,i)}const r=t[e];let o=s,a=n;for(cd(t,s,e),i(t[n],r)>0&&cd(t,s,n);o<a;){for(cd(t,o,a),o++,a--;i(t[o],r)<0;)o++;for(;i(t[a],r)>0;)a--}i(t[s],r)===0?cd(t,s,a):(a++,cd(t,a,n)),a<=e&&(s=a+1),e<=a&&(n=a-1)}}function cd(t,e,s){const n=t[e];t[e]=t[s],t[s]=n}function $W(t,e){return t<e?-1:t>e?1:0}class qW{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let s=this.data;const n=[];if(!Rg(e,s))return n;const i=this.toBBox,r=[];for(;s;){for(let o=0;o<s.children.length;o++){const a=s.children[o],l=s.leaf?i(a):a;Rg(e,l)&&(s.leaf?n.push(a):z_(e,l)?this._all(a,n):r.push(a))}s=r.pop()}return n}collides(e){let s=this.data;if(!Rg(e,s))return!1;const n=[];for(;s;){for(let i=0;i<s.children.length;i++){const r=s.children[i],o=s.leaf?this.toBBox(r):r;if(Rg(e,o)){if(s.leaf||z_(e,o))return!0;n.push(r)}}s=n.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let n=0;n<e.length;n++)this.insert(e[n]);return this}let s=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=s;else if(this.data.height===s.height)this._splitRoot(this.data,s);else{if(this.data.height<s.height){const n=this.data;this.data=s,s=n}this._insert(s,this.data.height-s.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Gl([]),this}remove(e,s){if(!e)return this;let n=this.data;const i=this.toBBox(e),r=[],o=[];let a,l,u;for(;n||r.length;){if(n||(n=r.pop(),l=r[r.length-1],a=o.pop(),u=!0),n.leaf){const h=YW(e,n.children,s);if(h!==-1)return n.children.splice(h,1),r.push(n),this._condense(r),this}!u&&!n.leaf&&z_(n,i)?(r.push(n),o.push(a),a=0,l=n,n=n.children[0]):l?(a++,n=l.children[a],u=!1):n=null}return this}toBBox(e){return e}compareMinX(e,s){return e.minX-s.minX}compareMinY(e,s){return e.minY-s.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,s){const n=[];for(;e;)e.leaf?s.push(...e.children):n.push(...e.children),e=n.pop();return s}_build(e,s,n,i){const r=n-s+1;let o=this._maxEntries,a;if(r<=o)return a=Gl(e.slice(s,n+1)),Fl(a,this.toBBox),a;i||(i=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,i-1))),a=Gl([]),a.leaf=!1,a.height=i;const l=Math.ceil(r/o),u=l*Math.ceil(Math.sqrt(o));Tw(e,s,n,u,this.compareMinX);for(let h=s;h<=n;h+=u){const g=Math.min(h+u-1,n);Tw(e,h,g,l,this.compareMinY);for(let f=h;f<=g;f+=l){const p=Math.min(f+l-1,g);a.children.push(this._build(e,f,p,i-1))}}return Fl(a,this.toBBox),a}_chooseSubtree(e,s,n,i){for(;i.push(s),!(s.leaf||i.length-1===n);){let r=1/0,o=1/0,a;for(let l=0;l<s.children.length;l++){const u=s.children[l],h=P_(u),g=ZW(e,u)-h;g<o?(o=g,r=h<r?h:r,a=u):g===o&&h<r&&(r=h,a=u)}s=a||s.children[0]}return s}_insert(e,s,n){const i=n?e:this.toBBox(e),r=[],o=this._chooseSubtree(i,this.data,s,r);for(o.children.push(e),Nd(o,i);s>=0&&r[s].children.length>this._maxEntries;)this._split(r,s),s--;this._adjustParentBBoxes(i,r,s)}_split(e,s){const n=e[s],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);const o=this._chooseSplitIndex(n,r,i),a=Gl(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,Fl(n,this.toBBox),Fl(a,this.toBBox),s?e[s-1].children.push(a):this._splitRoot(n,a)}_splitRoot(e,s){this.data=Gl([e,s]),this.data.height=e.height+1,this.data.leaf=!1,Fl(this.data,this.toBBox)}_chooseSplitIndex(e,s,n){let i,r=1/0,o=1/0;for(let a=s;a<=n-s;a++){const l=kd(e,0,a,this.toBBox),u=kd(e,a,n,this.toBBox),h=KW(l,u),g=P_(l)+P_(u);h<r?(r=h,i=a,o=g<o?g:o):h===r&&g<o&&(o=g,i=a)}return i||n-s}_chooseSplitAxis(e,s,n){const i=e.leaf?this.compareMinX:WW,r=e.leaf?this.compareMinY:XW,o=this._allDistMargin(e,s,n,i),a=this._allDistMargin(e,s,n,r);o<a&&e.children.sort(i)}_allDistMargin(e,s,n,i){e.children.sort(i);const r=this.toBBox,o=kd(e,0,s,r),a=kd(e,n-s,n,r);let l=Ig(o)+Ig(a);for(let u=s;u<n-s;u++){const h=e.children[u];Nd(o,e.leaf?r(h):h),l+=Ig(o)}for(let u=n-s-1;u>=s;u--){const h=e.children[u];Nd(a,e.leaf?r(h):h),l+=Ig(a)}return l}_adjustParentBBoxes(e,s,n){for(let i=n;i>=0;i--)Nd(s[i],e)}_condense(e){for(let s=e.length-1,n;s>=0;s--)e[s].children.length===0?s>0?(n=e[s-1].children,n.splice(n.indexOf(e[s]),1)):this.clear():Fl(e[s],this.toBBox)}}function YW(t,e,s){if(!s)return e.indexOf(t);for(let n=0;n<e.length;n++)if(s(t,e[n]))return n;return-1}function Fl(t,e){kd(t,0,t.children.length,e,t)}function kd(t,e,s,n,i){i||(i=Gl(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let r=e;r<s;r++){const o=t.children[r];Nd(i,t.leaf?n(o):o)}return i}function Nd(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function WW(t,e){return t.minX-e.minX}function XW(t,e){return t.minY-e.minY}function P_(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Ig(t){return t.maxX-t.minX+(t.maxY-t.minY)}function ZW(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function KW(t,e){const s=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,i-s)*Math.max(0,r-n)}function z_(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Rg(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Gl(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Tw(t,e,s,n,i){const r=[e,s];for(;r.length;){if(s=r.pop(),e=r.pop(),s-e<=n)continue;const o=e+Math.ceil((s-e)/n/2)*n;oM(t,o,e,s,i),r.push(e,o,o,s)}}const gd={minX:0,minY:0,maxX:0,maxY:0},Cw=(t,e)=>t.id===e.id;class QW extends qW{constructor(s){super();Wt(this,"store");Wt(this,"onRotationChange",()=>{const s=this.store.getState().getAllFeatures().filter(n=>Ws(n)||Ln(n));for(const n of s)this.updateRotatedText(n)});Wt(this,"onZoomChange",()=>{const s=this.store.getState().getAllFeatures().filter(n=>{var i;return(Ws(n)||Ln(n))&&((i=n.properties.style)==null?void 0:i.fixedSize)});for(const n of s)this.updateRotatedText(n)});this.store=s,this.store.subscribe(n=>n.features,n=>{this.clear(),Object.values(n).forEach(i=>{Ws(i)||Ln(i)?this.updateRotatedText(i):this.insert(i)})}),this.store.subscribe(n=>({features:n.features,isDragging:n.isDragging,lastChangedFeatures:n.lastChangedFeatures,rotation:n.rotation}),(n,i)=>{i&&i.isDragging&&!n.isDragging&&n.lastChangedFeatures.length>0&&n.lastChangedFeatures.forEach(r=>{const o=n.features[r];o&&(ch(o),Ws(o)||Ln(o)?this.updateRotatedText(o):(this.remove(o,Cw),this.insert(o)))})},{equalityFn:(n,i)=>n.isDragging===i.isDragging}),this.store.subscribe(n=>n.rotation,this.onRotationChange),this.store.subscribe(n=>n.zoom,this.onZoomChange)}updateRotatedText(s){var h;const n=this.store.getState();this.remove(s,Cw);const i=_i(s);let{width:r,height:o}=qn(s);if(((h=s.properties.style)==null?void 0:h.fixedSize)===!0){const g=n.invZoom;r*=g,o*=g}const a=r/2,l=o/2,u=n.getRotatedBBox(i.x-a,i.y-l,i.x+a,i.y+l);this.insert({...s,geometry:{...s.geometry,bbox:u.slice()}})}compareMinX(s,n){return Zr(s)[0]-Zr(n)[0]}compareMinY(s,n){return Zr(s)[1]-Zr(n)[1]}toBBox(s){const n=Zr(s);return gd.minX=n[0],gd.minY=n[1],gd.maxX=n[2],gd.maxY=n[3],gd}query(s){return super.search(s)}}class aM{constructor(e,s){Wt(this,"layer");this.ogma=e,this.store=s}destroy(){}}function JW(t,e,s,n,i,r){const o=Math.min(n/2,i/2),a=Math.min(r,o);t.beginPath(),t.moveTo(e+a,s),t.lineTo(e+n-a,s),t.quadraticCurveTo(e+n,s,e+n,s+a),t.lineTo(e+n,s+i-a),t.quadraticCurveTo(e+n,s+i,e+n-a,s+i),t.lineTo(e+a,s+i),t.quadraticCurveTo(e,s+i,e,s+i-a),t.lineTo(e,s+a),t.quadraticCurveTo(e,s,e+a,s),t.closePath()}const Lw=[[-.5,-.5],[.5,-.5],[.5,.5],[-.5,.5]];class tX extends aM{constructor(s,n){super(s,n);Wt(this,"handleFill","#fff");Wt(this,"handleStroke","#1A70E5");Wt(this,"handleStrokeWidth",1.5);Wt(this,"handleRadius",3);Wt(this,"handleMagnifier",1.5);Wt(this,"refresh",()=>{this.layer.refresh()});Wt(this,"render",s=>{const n=this.store.getState(),i=1/n.zoom,{hoveredHandle:r,rotation:o,liveUpdates:a,features:l}=n,u=this.handleRadius*i;s.fillStyle=this.handleFill,s.lineWidth=this.handleStrokeWidth*i,s.strokeStyle=this.handleStroke,Object.values(l).forEach(h=>{if(!n.isSelected(h.id))return;const g=a[h.id]?{...h,...a[h.id]}:h;if(xi(g))this.renderArrowHandles(g,s,u,r);else if(Yn(g)||Ws(g)){const f=Ws(g)?o:0;this.renderOutline(g,s,f,r,n.zoom),this.renderBoxHandles(g,s,u,r,f)}else Nr(g)&&this.renderPolygonHandles(g,s,u,r,n.drawingFeature===g.id)})});this.layer=s.layers.addCanvasLayer(this.render,void 0,O0.HANDLES),this.store.subscribe(i=>({selectedFeatures:i.selectedFeatures,liveUpdates:i.liveUpdates}),this.refresh),s.events.on("zoom",this.refresh)}renderOutline(s,n,i,r,o){var x,v;const a=Ws(s)&&((x=s.properties.style)==null?void 0:x.fixedSize);let{width:l,height:u}=qn(s);a&&(l/=o,u/=o);const h=iu(s,a,o),g=l/2,f=u/2,p=h.x+g,y=h.y+f;n.save(),n.translate(p,y),n.rotate(i);const _=(v=s.properties.style)==null?void 0:v.borderRadius;if(_&&_>0?(JW(n,-g,-f,l,u,_),n.stroke()):n.strokeRect(-g,-f,l,u),r>=4&&r<8){let b,S,A,w;const L=_&&_>0?_:this.handleRadius/o;switch(r){case 4:b=-g+L,S=-f,A=g-L,w=-f;break;case 5:b=g,S=-f+L,A=g,w=f-L;break;case 6:b=g-L,S=f,A=-g+L,w=f;break;case 7:b=-g,S=f-L,A=-g,w=-f+L;break}n.lineWidth=this.handleStrokeWidth*this.handleMagnifier/o,n.beginPath(),n.moveTo(b,S),n.lineTo(A,w),n.stroke(),n.lineWidth=this.handleStrokeWidth}n.restore()}renderArrowHandles(s,n,i,r){const o=QN(s),a=JN(s),l=+(r===0),u=+(r===1),h=i*(1+(this.handleMagnifier-1)*l),g=i*(1+(this.handleMagnifier-1)*u);n.beginPath(),n.moveTo(o.x,o.y),n.lineTo(a.x,a.y),n.closePath(),n.stroke(),n.beginPath(),n.moveTo(o.x-h,o.y-h),n.rect(o.x-h,o.y-h,h*2,h*2),n.moveTo(a.x-g,a.y-g),n.rect(a.x-g,a.y-g,g*2,g*2),n.closePath(),n.fill(),n.stroke()}renderBoxHandles(s,n,i,r,o){var y;if(Ws(s)&&((y=s.properties.style)!=null&&y.fixedSize))return;const{width:a,height:l}=qn(s),u=iu(s),h=a/2,g=l/2,f=u.x+h,p=u.y+g;n.save(),n.translate(f,p),n.rotate(o),n.beginPath();for(let _=0;_<Lw.length;_++){const[x,v]=Lw[_],b=a*x,S=l*v,A=r===_?i*this.handleMagnifier:i;n.rect(b-A,S-A,A*2,A*2)}n.closePath(),n.fill(),n.stroke(),n.restore()}renderPolygonHandles(s,n,i,r,o){const a=s.geometry.coordinates[0];if(!o){a.length>2&&(n.save(),n.strokeStyle=this.handleStroke,n.lineWidth=this.handleStrokeWidth/this.store.getState().zoom,this.drawSmoothPolygon(n,a,.5),n.stroke(),n.restore()),n.beginPath();for(let l=0;l<a.length-1;l++){const[u,h]=a[l],g=r===l?i*this.handleMagnifier:i;n.moveTo(u+g,h),n.arc(u,h,g,0,2*Math.PI)}n.closePath(),n.fill(),n.stroke()}}drawSmoothPolygon(s,n,i){const r=n.slice(0,-1);if(r.length<3)return;s.beginPath();const o=r.length;for(let a=0;a<o;a++){const l=r[(a-1+o)%o],u=r[a],h=r[(a+1)%o],g=r[(a+2)%o],f=u[0]+(h[0]-l[0])/6*i,p=u[1]+(h[1]-l[1])/6*i,y=h[0]-(g[0]-u[0])/6*i,_=h[1]-(g[1]-u[1])/6*i;a===0&&s.moveTo(u[0],u[1]),s.bezierCurveTo(f,p,y,_,h[0],h[1])}s.closePath()}renderCenterPoint(s,n){var r;const i=this.store.getState();if(Ws(s)){const o=iu(s,(r=s.properties.style)==null?void 0:r.fixedSize,i.zoom),a=qn(s);n.moveTo(o.x+a.width/2+5,o.y+a.height/2),n.arc(o.x+a.width/2,o.y+a.height/2,5,0,Math.PI*2,!0)}}destroy(){this.layer.destroy(),super.destroy()}}const eX=.5;function sX(t,e,s,n){const{start:i,end:r}=B0(t),o=Vn(r,i);return Math.min(n,Math.max(2*e,Ar(o)*.01,s))}function kw(t,e){return!t||t==="none"?0:t==="dot"?e*2:t==="halo-dot"?e*4:t==="arrow"||t==="arrow-plain"?e:0}function nX(t,e){if(!t){t=As("g");const s=As("path");t.classList.add("annotation-arrow"),t.setAttribute("data-annotation",`${e}`),t.setAttribute("data-annotation-type","arrow"),t.appendChild(s);const n=As("g");n.classList.add("annotation-arrow-endpoints"),t.appendChild(n)}return t}function iX(t,e,s,n,i,r){const{start:o,end:a}=B0(e),l=e.properties.style||$a,{tail:u,strokeWidth:h=0,head:g,strokeColor:f,strokeType:p}=l,y=Vn(a,o),_=rM(e)?1/r.zoom:1,x=sX(e,h,s,n)*_,v=nX(i,e.id),b=v.firstChild,S=f||"none";b.setAttribute("stroke",S),b.setAttribute("stroke-width",`${_*h}`),b.setAttribute("fill","none"),b.setAttribute("stroke-linecap","round"),b.setAttribute("stroke-linejoin","round");const A=kw(u,h*_),w=kw(g,h*_),L=Rf(y),I=Ha(o,to(L,A)),F=Ha(a,to(L,-w)),O=`M ${I.x} ${I.y} L ${F.x} ${F.y}`;b.setAttribute("d",O);const V=v.children[1];return V.innerHTML="",p==="dashed"?b.setAttribute("stroke-dasharray","5,10"):b.removeAttribute("stroke-dasharray"),Nw(V,o,y,S,u,h,_,x),Nw(V,a,mW(y),S,g,h,_,x),v.setAttribute("transform",`rotate(${-r.rotation*(180/Math.PI)})`),t.appendChild(v),v}function Nw(t,e,s,n,i,r,o,a){i==="halo-dot"&&Mw(t,e,rX(n),eX,r*o*4),(i==="dot"||i==="halo-dot")&&Mw(t,e,n,1,r*o*2),(i==="arrow"||i==="arrow-plain")&&oX(t,e,s,n,i==="arrow-plain",r*o,a)}function rX(t){return t==="none"?"none":t}function Mw(t,e,s,n,i){const r=As("circle");r.setAttribute("cx",`${e.x}`),r.setAttribute("cy",`${e.y}`),r.setAttribute("r",`${i}`),r.setAttribute("fill-opacity",`${n}`),r.setAttribute("fill",s),t.appendChild(r)}function oX(t,e,s,n,i,r,o){const a=to(Rf(s),o),l=Ha(e,_w(a,Math.PI/6)),u=Ha(e,_w(a,-Math.PI/6)),h=As("path"),g=`${e.x} ${e.y}`,f=`M ${l.x} ${l.y} L ${g} L ${u.x} ${u.y}${i?" Z":""}`;h.setAttribute("d",f),h.setAttribute("stroke",n),h.setAttribute("stroke-width",`${r}`),h.setAttribute("fill",i?n:"none"),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),t.appendChild(h)}function aX(t,e,s="box"){if(!t){t=As("g"),t.setAttribute("data-annotation",`${e}`),t.setAttribute("data-annotation-type",s),t.classList.add(`annotation-${s}`);const n=As("rect");t.appendChild(n)}return t}function lM(t,e,s,n){const i=e.id,r=`class${i}`,o=qn(e),a=aX(s,i,e.properties.type),{strokeColor:l,strokeWidth:u,strokeType:h,background:g,borderRadius:f}=e.properties.style||gh;a.classList.add("annotation-box"),a.setAttribute("fill",`${g||"transparent"}`);const p=a.firstChild;f&&(p.setAttribute("rx",`${f}`),p.setAttribute("ry",`${f}`)),h&&h!=="none"&&(p.setAttribute("stroke",l||"black"),p.setAttribute("stroke-width",`${u}`),h==="dashed"&&p.setAttribute("stroke-dasharray","5,5")),g&&g.length&&(n.hoveredFeature===e.id?p.setAttribute("fill",cp(g)):p.setAttribute("fill",g));const y=iu(e);return p.setAttribute("width",`${o.width}`),p.setAttribute("height",`${o.height}`),p.setAttribute("x",`${y.x}`),p.setAttribute("y",`${y.y}`),a.appendChild(p),a.setAttribute("transform",n.getRotationTransform(0,0)),a.classList.add(r),a.setAttribute("data-annotation",`${e.id}`),a.setAttribute("data-annotation-type",e.properties.type),t.appendChild(a),a}const lX=/^((?:[a-z\d-]+\s+)*)([\d.]+(%|em|px)|(?:x+-)?large|(?:x+-)?small|medium)(?:\s*\/\s*(normal|[\d.]+(%|px|em)?))?(\s.+)?$/,uX=/\bsmall-caps\b/,dX=/\b(?:italic|oblique)\b/,hX=/\bbold(?:er)?\b/,uM=16,Iw=13.3333333,cX=.01*uM,gX={"xx-small":9,"x-small":10,smaller:13.3333,small:13,medium:16,large:18,larger:19.2,"x-large":24,"xx-large":32},D_=new Map;function fX(t){if(D_.has(t))return D_.get(t);const e=lX.exec(t);if(!e)return;const s={};s.family=(e[6]||"").trim();let n=gX[e[2]]||parseFloat(e[2]);if(e[3]==="%"?n*=cX:e[3]==="em"?n*=uM:e[3]==="pt"&&(n*=Iw),s.size=n,e[4]==="normal"||e[4]==="inherit"||!e[4]?s.height=Math.round(n*(7/6)):!e[5]||e[5]==="em"?s.height=parseFloat(e[4]||"")*n:e[5]==="pt"?s.height=parseFloat(e[4]||"")*Iw:e[5]==="%"?s.height=n*.01:s.height=parseFloat(e[4]||""),s.variant=uX.test(e[1])?"small-caps":"normal",s.style=dX.test(e[1])?"italic":"normal",hX.test(e[1]))s.weight=700;else{const i=/\b(\d+)\b/.exec(e[1]),r=i?parseInt(i[1],10):400;r>=100&&r!==400?s.weight=r:s.weight=400}return D_.set(t,s),s}const pX="12px/14px sans-serif";class Li{constructor(e=pX){let s,n=14,i=12,r=400,o="normal",a="normal",l=0,u;if(typeof e=="string"){const h=fX(e);h&&(s=h.family,i=h.size,n=h.height||14,a=h.variant,o=h.style,r=h.weight)}else e instanceof Li&&(s=e.family,i=e.size,n=e.height,a=e.variant,r=e.weight,o=e.style,l=e.baseline,u=e.color);this.family=s||"sans-serif",this.size=i||i===0?i:12,this.height=n||n===0?n:this.size*(7/6),this.variant=a||"",this.style=o||"",this.weight=r||400,this.baseline=l||0,this.color=u||""}assign(e={}){const s=new Li(this);return e.bold&&(s.weight=700),e.weight&&(s.weight=e.weight),e.italic&&(s.style="italic"),e.family&&(s.family=e.family),e.style&&(s.style=e.style),e.color&&(s.color=e.color),typeof e.baseline=="number"&&(s.baseline=e.baseline),typeof e.size=="number"&&(s.size=e.size),s}toString(e){let s="";return this.style&&this.style!=="normal"&&(s+=this.style),this.variant&&this.variant!=="normal"&&(s+=(s?" ":"")+this.variant),this.weight&&this.weight!==400&&(s+=s?" ":"",this.weight===700?s+="bold":s+=this.weight),this.size&&(s+=(s?" ":"")+this.size+"px",this.height!==this.size&&(s+="/"+this.height+"px")),this.family&&(s+=(s?" ":"")+this.family),e&&(s+="::"+this.baseline),e&&(s+="::"+this.color),s}valueOf(){return this.toString(!0)}}const dM={"\n":.28,"\r":.28," ":.28,"":.28,"":.28,"":0,"":.5,"":1,"":.5,"":1,"":.33,"":.25,"":.16,"":.56,"":.28,"":.2,"":.15,"":0,"":.16,"":.22,"":1,"\uFEFF":0},mX=new Li,Rw={trim:!0,collapse:!0},O_={};function Ex(){return(t,e)=>{const s=new Li(e);let n=s.size;return/\bmonospace\b/.test(s.family)?n*=.6:(n*=.45,s.weight>400&&(n*=1.18)),t.length*n}}function Sx(t){if(t&&t.getContext){const e=t.getContext("2d");if(e&&typeof e.measureText=="function")return(s,n)=>(e.font=String(n),e.measureText(s).width)}}function hM(){const t=typeof document<"u"?document:null;return typeof OffscreenCanvas<"u"&&new OffscreenCanvas(100,100)||t&&t.createElement&&t.createElement("canvas")||null}let Hd=Sx(hM())||Ex();function _X(t){if(t==null)Hd=Sx(hM())||Ex();else if(t)Hd=Sx(t)||Ex();else throw new Error("setMeasureCanvas argument is not a canvas or null")}function Uo(t,e,s=Rw){typeof e=="string"?e=new Li(e):e instanceof Li?e=mX.assign(e):e=new Li().assign(e);const n=Object.assign({},Rw,s);let i=String(t);if(!i)return 0;if(i in dM){const o=e.valueOf()+"/"+i;return o in O_||(O_[o]=Hd(`_${i}_`,e)-Hd("__",e)),O_[o]}!n.trim||!n.collapse?i=i.replace(/\n/g," "):n.trim?i=i.replace(/\n/g," ").trim():n.collapse&&(i=i.replace(/\s+/g," "));const r=typeof t=="string"?0:t.tracking||0;return Hd(i,e)+e.size*r}class Js{constructor(e=""){this.value=e,this.font=null,this.href="",this.sub=!1,this.sup=!1,this.width,this.line,this.tracking,this.whitespace}clone(){const e=new Js(this.value);return Object.assign(e,this)}valueOf(){return this.value}toString(){return this.value}}class fh extends Js{}class ki extends Js{}class Fa extends Js{}const yX=/[\r\n\xA0]+/g,Fw=.7;function xX(t,e){t.sup&&(t.baseline=.45,t.size=Fw),t.sub&&(t.baseline=-.3,t.size=Fw);let s=e;return(t.style||t.weight||t.baseline||t.color||t.size||t.family)&&(s=e.assign(t)),s}function Pw(t,e,s){let n=t.width,i,r;for(;n+s.width>e&&t.length;)i=t[t.length-1],r=i.width,i.width>s.width?(i.value=i.value.slice(0,-1),i.width=Uo(i,i.font),n+=i.width):t.pop(),n-=r;t[t.length-1]instanceof Fa&&t.pop(),i=t[t.length-1]||i||{},s.font=s.font.assign(i),s.href=t.length?i.href:null,s.rel=t.length?i.rel:null,s.target=t.length?i.target:null,t.push(s)}function zw(t){return Object.assign([],{height:0,font:t,width:0,hasOverflow:!1,hasLineOverflow:!1})}function vX(t,e,s){if(!t.length)return zw(s);const n=e.height(),i=e.width(),r=e.overflowLine(),o=e.overflowWrap(),a=s.assign({bold:!0}),l=isFinite(n())?Math.floor(n()/s.height):1/0;if(!n()&&!i(0)||!l)return zw(s);let u=0,h=0,g=0;const f=[];let p=[],y=!1;for(;u<t.length&&h<l;){const w=t[u],L=xX(w,s);if(w.width=Uo(w,L),w.font=L,w.line=h,w.whitespace=w.value in dM,w.value&&(w.value=w.value.replace(yX," ")),!(!g&&w.whitespace||y&&w.whitespace))if(w instanceof ki)g=0,p=[],f.push(u+1),h++;else if(w instanceof fh||w instanceof Fa)p.push({index:u,width:g});else if(w.whitespace||g+w.width<i(h))g+=w.width;else if(p.length){let I,F;do{F=!0,I=p.pop();const O=t[I.index];let V;O instanceof Fa&&(V=Uo("-",O.font||s),I.width+V>i(h)&&(F=!p.length))}while(!F);f.push(I.index+1),g=0,h++,u=I.index,p=[]}else if(o==="break-word"){const I=i(h);if(g+w.width>I){const F=w.clone();do w.value=w.value.slice(0,-1),w.width=Uo(w,w.font||s),g+=w.width;while(w.value&&w.width>I);F.value=F.value.slice(w.value.length),t.splice(u+1,0,new fh,F)}f.push(u+1),g=0,h++}else g+=w.width;u++,y=w.whitespace}u!==f[f.length-1]&&f.push(u);let _=0,x=0;const v=f.map(w=>{let L=_,I;for(;(I=t[L])&&(I.whitespace||!I.value);)L++;let F=w,O=null;for(;F>L&&(I=t[F-1])&&(I.whitespace||!(I.value||I instanceof Fa));)I instanceof ki&&(O=I),F--;I instanceof Fa&&(I.value="-",I.width=Uo("-",I.font||s)),_=w;const V=Object.assign(t.slice(L,F).filter(j=>j.value),{width:0});return O&&V.push(O),V.width=V.reduce((j,Z)=>j+Z.width,0),V.width>x&&(x=V.width),V});let b=!1;if(r){const w=r==="ellipsis"?"":r;v.forEach((L,I)=>{const F=i(I);if(L.width>F){const O=new Js(w);O.font=s,O.width=Uo(w,a),Pw(L,F,O),b=!0}})}let S=!1;const A=e.overflow()==="ellipsis"?"":e.overflow();if(A&&u!==t.length){const w=i(v.length-1),L=v[v.length-1],I=new Js(A);I.font=s,I.width=Uo(A,a),Pw(L,w,I),S=!0}else S=!1;return Object.assign(v,{height:v.length*s.height,font:s,width:x,hasOverflow:S,hasLineOverflow:b})}function Pl(t){return Math.round(t*1e6)/1e6}const bX={center:"middle",right:"end"},EX={middle:.5,center:.5,bottom:1,end:1},B_=(t,e)=>!t&&!e||t===e;function SX(t,e){const s=[],n=e.font(),i=n.size,r=n.family,o=e.align(),a=e.createElement();if(t.length){const l=n.height,u=e.valign(),h=e.height()(),g=e.width()(0),f=!isFinite(g)&&t.length===1,p=f?null:e.x(),y=Pl(l/i);let _=f?null:Pl(l/(i*1.15+(l-i)/2));if(EX[u]&&isFinite(h)){const I=u==="bottom"?1:.5;_=(_||0)+(h*I-l*t.length*I)/i}const x=o==="justify";let v=0;o==="right"?v=g:o==="center"&&(v=g/2);let b=[],S="tspan",A=null,w="";const L=()=>{if(w){const I=a(S,A,w);b.push(I)}S="tspan",A=null,w=""};for(let I=0,F=t.length;I<F;I++){let O="",V="",j=0;const Z=t[I];if(!Z.length){s.push(a("tspan",{x:p(I),dy:Pl(I?y:_)+"em"},""));continue}b=[];let at=0,pt=0,K;for(let ut=0,ht=Z.length;ut<ht;ut++){const nt=Z[ut],ot=nt.font;nt.whitespace&&at++,pt+=nt.width,ut&&!nt.tracking&&!j&&B_(ot.id,O)&&B_(nt.class,V)&&B_(K,nt.href)?w+=nt.value:(L(),w=nt.value,A={fontFamily:ot.family!==r?ot.family:null,fontSize:ot.size!==i?ot.size:null,fontWeight:ot.weight!==400&&ot.weight||null,fontStyle:ot.style!=="normal"&&ot.style||null,fontVariant:ot.variant!=="normal"&&ot.variant||null,fill:ot.color||null,baselineShift:ot.baseline?ot.baseline*100+"%":null,className:nt.class||null,dx:0,href:null,rel:null,target:null},j&&(A.dx=Pl(j),j=0),nt.tracking&&(j=ot.size*nt.tracking),nt.href&&!K?(K=nt.href,S="a",A.href=K,A.rel=nt.rel,A.target=nt.target):K=null,O=ot.id,V=nt.class)}if(L(),f)s.push(...b);else{let ut=null;const ht=I===F-1||Z[Z.length-1]instanceof ki;if(x&&Z.length>1&&!ht){const nt=g-pt;ut=Pl(nt/at)}s.push(a("tspan",{wordSpacing:ut,x:p(I)+v,dy:Pl(I?y:_)+"em"},...b))}}}return a("text",{fontFamily:r,fontSize:i,textAnchor:bX[o]||"start"},...s)}const AX={middle:.5,center:.5,bottom:1,end:1};function wX(t,e){return t.color?t.color:e.href?"#00C":"#000"}function TX(t,e,s){if(!t.length)return;s.textBaseline="middle";const n=e.font(),i=n.height,r=n.size,o=e.valign(),a=e.height()(),l=e.width()(0),u=e.align(),h=u==="justify";let g=i*.5;const f=AX[o];if(f&&isFinite(a)){const p=t.length*i;g+=a*f-p*f}t.forEach((p,y)=>{let _=e.x()(y);const x=y*i+g;let v=0,b=0;p.forEach(w=>{w.whitespace&&v++,b+=w.width});let S=0;const A=y===t.length-1||p[p.length-1]instanceof ki;h&&p.length>1&&!A&&(S=(l-b)/v),p.forEach(w=>{s.font=w.font;const L=w.font,I=L.baseline?r*-L.baseline+r*.15:0;s.fillStyle=wX(L,w);let F=0;if(u==="right"?F+=l-b:u==="center"?F+=l/2-b/2:u==="justify"&&(w.whitespace||w instanceof ki)&&(_+=S),s.fillText(w.value,_+F,x+I),w.href){s.beginPath(),s.strokeStyle=s.fillStyle;const O=Math.floor(x+r*.45)+.5;s.moveTo(_+F,O),s.lineTo(_+F+w.width,O),s.stroke()}_+=w.width})})}function cM(t){const e={};for(let s=0;s<t.length;s++){const n=t[s];typeof n=="number"||n==null||(typeof n=="string"?e.text=n:typeof n=="function"?e.fn=n:typeof n=="object"&&n._groups?e.d3=n:n&&n.nodeType&&n.getContext?e.ctx=n.getContext("2d"):n&&n.fillText&&n.beginPath?e.ctx=n:n&&(e.text=n))}return e}const CX=Object.prototype.hasOwnProperty,U_={};function LX(t){return U_[t]||(U_[t]=t.replace(/([a-z])([A-Z])/g,(e,s,n)=>s+"-"+n.toLowerCase())),U_[t]}function gM(t,e){if(Array.isArray(e))return e.forEach(s=>gM(t,s));typeof e=="string"&&(e=document.createTextNode(e)),t.appendChild(e)}function fM(t,e,...s){if(typeof document>"u")throw new Error("No document found, cannot create elements");const n=typeof t=="string"?document.createElementNS("http://www.w3.org/2000/svg",t):t;if(e&&n.setAttribute)for(const i in e)CX.call(e,i)&&e[i]!=null&&n.setAttribute(i==="className"?"class":LX(i),String(e[i]));return s!=null&&s.length&&s.forEach(i=>{gM(n,i)}),n}const Dw=t=>typeof t=="function"?t:()=>t,kX={top:{vAnchor:-0},middle:{vAnchor:-.5},bottom:{vAnchor:-1},left:{hAnchor:-0},center:{hAnchor:-.5},right:{hAnchor:-1}},Df=class Df{constructor(e){if(this.props={width:()=>1/0,height:()=>1/0,rotation:0,vAnchor:0,hAnchor:0},e)for(const s in e)typeof this[s]=="function"&&this[s](e[s]);this.render=this.render.bind(this)}anchor(e){const{hAnchor:s,vAnchor:n,width:i,height:r}=this.props;if(!arguments.length)return[s*i(),n*r()];if(typeof e=="string"){const o=this.props;e.toLowerCase().trim().split(/\s+/).forEach(a=>Object.assign(o,kX[a]))}return this}width(e){return arguments.length?(this.props.width=Dw(e),this):this.props.width}height(e){return arguments.length?(this.props.height=Dw(e),this):this.props.height}rotate(e){return arguments.length?(this.props.rotation=e,this):this.props.rotation}createElement(e){return arguments.length?(this.props.createElement=e,this):this.props.createElement||Df.createElement}canvas(e,s){const n=e.getContext?e.getContext("2d"):e;return n.save(),n.rotate(this.rotate()*Math.PI/180),n.translate(...this.anchor()),s(n),n.restore(),n}render(...e){const s=cM(e);if(s.d3)return s.d3.attr("transform",`rotate(${this.rotate()}) translate(${this.anchor()})`);if(s.ctx)return this.canvas(s.ctx,s.fn);if(s.text){const n=typeof s.text.render=="function"?s.text.render():s.text;return this.createElement()("g",{transform:`rotate(${this.rotate()}) translate(${this.anchor()})`},n)}}};Wt(Df,"createElement",fM);let Ax=Df;const G_=/^[\n\r\t\x20\xA0\u2000-\u200B\u205F\u3000]/,NX=/^[^\n\r\t\u0020\u2000-\u200B\u205F\u3000]{2,}/,Ow=/^[\xA0\u2011\u202F\u2060\uFEFF]/,MX=/^(?:[;\xAD%?]|,(?!\d))/,IX=/^[$\u2212]/,RX="'[<{(<".split(""),FX="',,!?]>})".split(""),Bw=t=>{const e=t.charCodeAt(0);return e>=19968&&e<=40959};function Ff(t,e){e!==!1&&(t=t.trim());const s=[];let n=t.charAt(0),i,r,o=0;for(let a=1,l=t.length;a<l;a++){i=t.charAt(a),r=t.charAt(a+1);const u=G_.test(n),h=G_.test(i);let g=h||u||Bw(n)||Bw(i),f;if((IX.test(i)&&!Ow.test(n)||MX.test(n+r)&&!Ow.test(i))&&(g=!0),g&&(FX.includes(i)||RX.includes(n))&&(g=!1),(n==="-"||n===""||n===""||n==="")&&(f=G_.test(t.charAt(a-2)),f&&!h&&(g=!1),!f&&NX.test(i+r)&&(g=!0)),g){const p=t.slice(o,a);/\u00AD$/.test(p)?(s.push(new Js(p.slice(0,-1))),s.push(new Fa)):(s.push(new Js(p)),s.push(new fh)),o=a}n=i}return s.push(new Js(t.slice(o))),s}const Uw={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:""},PX=/^[\n\r\x20\u2000-\u200B\u205F\u3000]/,zX=/^<\/([a-zA-Z0-9]+)([^>]*)>/,DX=/^<([a-zA-Z0-9]+)((?:\s[^=\s/]+(?:\s*=\s*(?:"[^"]+"|'[^']+'|[^>\\s]+))?)+)?\s*(\/?)>(\n*)/,OX=/^<!--(.+?)-->/,BX=/&(?:#(\d\d{2,})|#x([\da-fA-F]{2,})|([a-zA-Z][a-zA-Z1-4]{1,8}));/g,Gw={b:t=>t.weight=700,strong:t=>t.weight=700,i:t=>t.style="italic",em:t=>t.style="italic",dfn:t=>t.style="italic",cite:t=>t.style="italic",code:t=>t.family="monospace",kbd:t=>t.family="monospace",samp:t=>t.family="monospace",var:t=>t.family="monospace",tt:t=>t.family="monospace",sub:t=>t.sub=!0,sup:t=>t.sup=!0},UX={div:1,li:1,blockquote:2,h1:2,h2:2,h3:2,h4:2,h5:2,h6:2,ul:2,ol:2,hr:2,p:2};function pM(t){return t.replace(BX,function(e,s,n,i){if(s||n){const r=s?10:16;return String.fromCharCode(parseInt(s||n,r))}else if(i in Uw)return Uw[i];return e})}function GX(t){return t&&t.length>1&&(t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'")?t.slice(1,-1):t}const VX=/^\s*([^=\s&]+)(?:\s*=\s*("[^"]+"|'[^']+'|[^>\s]+))?/;function jX(t){let e;const s={};if(t){do if(e=VX.exec(t),e){const n=pM(GX(e[2]||"")).replace(/[ \r\n\t]+/g," ").trim();if(s[e[1]]=n,t=t.slice(e[0].length),t.length&&/^\S/.test(t[0]))throw new Error("Attribute error")}while(e&&t.length);if(/\S/.test(t))throw new Error("Attribute error")}return s}function HX(t){t=String(t||"").trim();let e={weight:null,style:null,sub:!1,sup:!1,href:null,color:null,rel:null,target:null};const s=[],n=[];let i,r;const o=function(g){for(const f in e)e[f]&&(g[f]=e[f]);s.push(g)},a=()=>{n.push(e),e=Object.create(e)},l=()=>{n.length&&(e=n.pop())},u=g=>{const f=s.length;let p=UX[g];if(f&&p){let y=f-1;for(;s[y]&&(s[y]instanceof fh||PX.test(s[y].value));)y--;for(;p&&s[y]&&s[y]instanceof ki;)y--,p--;for(;p-- >0;)s.push(new ki)}};for(;t.length;){if(i=/^[^<]+/.exec(t)){const g=pM(i[0]);Ff(g,!1).forEach(o)}else if(!(i=OX.exec(t)))if(i=zX.exec(t))l(),u(i[1]);else if(i=DX.exec(t)){const g=i[1];u(g),a(),Gw[g]&&Gw[g](e);const f=jX(i[2]);g==="a"&&(f.href&&(e.href=f.href),f.rel&&(e.rel=f.rel),f.target&&(e.target=f.target)),f.class&&(e.class=e.class?e.class+" "+f.class:f.class),f.style&&(r=/(?:^|\s|;)color\s*:\s*([^;\s"']+)/.exec(f.style),r&&r[1]&&(e.color=r[1])),g==="br"&&s.push(new ki)}else i=[t.slice(0,1)],o(new Js(i[0]));t=t.slice(i[0].length)}let h=s[s.length-1];for(;h instanceof ki;)s.pop(),h=s[s.length-1];return s}const Vw={copyright:"",textcopyright:"",dag:"",textdagger:"",ddag:"",textdaggerdbl:"",guillemotleft:"",guillemotright:"",guilsinglleft:"",guilsinglright:"",ldots:"",dots:"",textellipsis:"",lq:"",P:"",textparagraph:"",pounds:"",textsterling:"",quotedblbase:"",quotesinglbase:"",rq:"",S:"",sim:"~",textasciicircum:"^",textasciitilde:"",texttildelow:"~",textasteriskcentered:"*",textbackslash:"'",textbar:"|",textbardbl:"",textbigcircle:"",textbraceleft:"{",textbraceright:"}",textbullet:"",textdollar:"$",textemdash:"",textendash:"",texteuro:"",eurosym:"",euro:"",textexclamdown:"",textgreater:">",textless:"<",textordfeminine:"",textordmasculine:"",textperiodcentered:"",cdot:"",textquestiondown:"",textquotedblleft:"",textquotedblright:"",textquoteleft:"",textquoteright:"",textquotestraightbase:"",textquotestraightdblbase:"",textregistered:"",textthreequartersemdash:"-",texttrademark:"",texttwelveudash:"-",textunderscore:"_",textvisiblespace:"",gets:"",textleftarrow:"",to:"",textrightarrow:"",textdegree:"",infty:"",triangle:"",triangledown:"",blacktriangle:"",blacktriangledown:"",angle:"",sphericalangle:"",aleph:"",hbar:"",imath:"",jmath:"",ell:"",wp:"",Re:"",Im:"",mho:"",prime:"",emptyset:"",nabla:"",surd:"",partial:"",top:"",bot:"",vdash:"",dashv:"",forall:"",exists:"",nexists:"",neg:"",lnot:"",flat:"",natural:"",sharp:"",backslash:"\\",Box:"",Diamond:"",clubsuit:"",diamondsuit:"",heartsuit:"",spadesuit:"",Join:"",blacksquare:"",bigstar:"",diagdown:"",diagup:"",blacklozenge:"",rfloor:"",lfloor:"",rceil:"",lceil:"",rangle:"",langle:"",sum:"",int:"",oint:"",prod:"",coprod:"",bigcap:"",bigcup:"",bigsqcup:"",bigvee:"",bigwedge:"",bigodot:"",bigotimes:"",bigoplus:"",biguplus:"",alpha:"",beta:"",chi:"",delta:"",epsilon:"",eta:"",gamma:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",omega:"",phi:"",pi:"",psi:"",rho:"",sigma:"",tau:"",theta:"",upsilon:"",xi:"",zeta:"",Alpha:"",Beta:"",Chi:"",Delta:"",Epsilon:"",Eta:"",Gamma:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Omega:"",Phi:"",Pi:"",Psi:"",Rho:"",Sigma:"",Tau:"",Theta:"",Upsilon:"",Xi:"",Zeta:"",aa:"",AA:"",ae:"",AE:"",dh:"",DH:"",dj:"",DJ:"",ij:"",IJ:"",l:"",L:"",ng:"",NG:"",o:"",O:"",oe:"",OE:"",ss:"",SS:"SS",th:"",TH:""},$X=/^(\^|_|\\[^#$%&~_^\\{}()\s]+)(\{)?/,qX=/^%[^\n]+(?:\n|$)/,YX=/^[^#$%&~_^\\{}]+/,WX=/^\\([&{}$%#_])/,XX=/(?:\\[\\@,!:;-]|-{2,3}|[!?]`|``?|,,|''?|~|<<|>>)/g,ZX={"---":"","--":"","!`":"","?`":"","``":"",",,":"","''":"","`":"","'":"","<<":"",">>":"","~":"","\\-":"","\\,":"","\\;":"","\\:":"","\\!":"","\\@":"\uFEFF","\\\\":"\\newline{}"},En={bf:t=>t.weight="bold",it:t=>t.style="italic",sl:t=>t.style="italic",color:(t,e)=>t.color=e,href:(t,e)=>t.href=e,"^":t=>t.sup=!0,_:t=>t.sub=!0,par:function(t){this.tokens.push(new ki,new ki)},newline:function(t){this.tokens.push(new ki)},url:function(t,e){t=this.open_context(),t.href=e,this.add_token(new Js(e)),this.close_context()}};En.textsuperscript=En["^"];En.textsubscript=En._;En.textsl=En.sl;En.mathbf=En.bf;En.mathit=En.it;En.textbf=En.bf;En.textit=En.it;En.textcolor=En.color;function KX(t){t=String(t||"").trim();const e=[0];t=t.replace(/\\verb,(.*?),/,(h,g)=>(e.push(g),"\\verb,"+(e.length-1)+",")).replace(/\\\\\n/g,()=>"\\\\").replace(XX,(h,g,f)=>f.charAt(g-1)==="\\"?h:ZX[h]).replace(/\n\s+/g,h=>/\n/.test(h.slice(1))?"\\par ":h).replace(/\\symbol\{(\d+)\}/,(h,g,f,p)=>p.charAt(f-1)==="\\"?h:String.fromCharCode(1*g)).replace(/(^|[^\\])(\^|_)(\d|[^{]\S*)/g,(h,g,f,p)=>g+f+"{"+p+"}").replace(/\\verb,(.*?),/,(h,g)=>`\\verb,${e[+g]},`);let s={weight:null,italic:null,variant:null,sub:!1,sup:!1,href:null};const n=[],i=[];let r;const o=function(h){for(const g in s)s[g]&&(h[g]=s[g]);return n.push(h),h},a=function(){i.push(s),s=Object.create(s)},l=function(){if(!i.length)throw new Error("Unexpected }");s=i.pop()},u={tokens:n,open_context:a,close_context:l,add_token:o};for(;t.length;){if(r=YX.exec(t))Ff(r[0],!1).forEach(o);else if(r=WX.exec(t))o(new Js(r[1]));else if(!(r=qX.exec(t))){if(r=/^\{/.exec(t))a();else if(r=/^\}/.exec(t))l();else if(!(r=/^\$/.exec(t)))if(r=/^\\verb,([^,]+),/.exec(t))o(new Js(r[1]));else if(r=$X.exec(t)){const h=r[1].slice(1)||r[1];let g=!!r[2];if(/^(La)?TeX$/i.test(h)){a(),s.family="serif";let f;h==="LaTeX"&&(f=o(new Js("L")),f.tracking=-.25,f=o(new Js("A")),f.size=.7,f.baseline=.3,f.tracking=-.1),f=o(new Js("T")),f.tracking=-.17,f=o(new Js("E")),f.baseline=-.22,f.tracking=-.13,f=o(new Js("X")),l()}else if(h in Vw)o(new Js(Vw[h])),g&&a();else if(h in En){const f=[];let p=En[h].length-1,y;if(p){for(g=!1,t=t.slice(r[0].length-1);p--;)if(y=/^\{([^}]+)\}/.exec(t))f.push(y[1]),t=t.slice(y[0].length);else throw new Error(h+" is missing an argument");r[0]=/^\{/.exec(t)?"{":"",g=!!r[0]}g&&a(),En[h].apply(u,[s,...f])}else o(new Js(r[1])),g&&a()}else r=[t.slice(0,1)],o(new Js(r[0]))}t=t.slice(r[0].length)}return n}const QX=new Li,V_=t=>typeof t=="function"?t:()=>t,jw={left:"left",start:"left",center:"center",middle:"center",right:"right",end:"right",justify:"justify"},bn=class bn{constructor(e){this.props={overflow:"ellipsis",overflowWrap:null,overflowLine:"",align:"left",wordBreak:null,valign:"top",width:()=>1/0,height:()=>1/0,x:()=>0,font:QX,parser:bn.defaultparser},e&&(e.font&&this.font(e.font),e.overflow&&this.overflow(e.overflow),e.overflowLine&&this.overflowLine(e.overflowLine),e.overflowWrap&&this.overflowWrap(e.overflowWrap),e.valign&&this.valign(e.valign),e.align&&this.align(e.align),e.width&&this.width(e.width),e.height&&this.height(e.height),e.x&&this.x(e.x),e.parser&&this.parser(e.parser),e.createElement&&this.createElement(e.createElement))}linebreak(e){const s=this.props.parser(String(e)),n=vX(s,this,this.font()),i=r=>this.render(n,r);return Object.assign(n,{render:i,svg:i,draw:i})}font(e){return arguments.length?(this.props.font=new Li(e),this):this.props.font||new Li}overflow(e){return arguments.length?(this.props.overflow=String(e),this):this.props.overflow}overflowLine(e){return arguments.length?(this.props.overflowLine=String(e),this):this.props.overflowLine}valign(e){return arguments.length?(this.props.valign=e,this):this.props.valign}align(e){if(!arguments.length)return this.props.align;const s=String(e).toLowerCase();return s in jw&&(this.props.align=jw[s]),this}overflowWrap(e){if(!arguments.length)return this.props.overflowWrap||"normal";const s=String(e).toLowerCase();return s==="break-word"?this.props.overflowWrap="break-word":(s==="normal"||e==null)&&(this.props.overflowWrap=null),this}width(e){return arguments.length?(this.props.width=V_(e),this):this.props.width}height(e){return arguments.length?(this.props.height=V_(e),this):this.props.height}x(e){return arguments.length?(this.props.x=V_(e),this):this.props.x}parser(e){if(!arguments.length)return this.props.parser;if(typeof e=="string"){const s=bn[e]||bn[e+"parser"];typeof s=="function"&&(e=s)}if(typeof e!="function")throw new Error("Unknown parser: "+e);return this.props.parser=e,this}createElement(e){return arguments.length?(this.props.createElement=e,this):this.props.createElement||bn.createElement}render(e,s){const n=cM([e,s]);if(typeof n.text=="string"&&(n.text=this.linebreak(n.text)),n.ctx)TX(n.text,this,n.ctx);else return SX(n.text,this)}};Wt(bn,"createElement",fM),Wt(bn,"textparser",Ff),Wt(bn,"defaultparser",Ff),Wt(bn,"htmlparser",HX),Wt(bn,"latexparser",KX),Wt(bn,"Token",Js),Wt(bn,"Break",fh),Wt(bn,"LineBreak",ki),Wt(bn,"SoftHyphen",Fa),Wt(bn,"Rotator",Ax),Wt(bn,"Font",Li),Wt(bn,"setMeasureCanvas",_X),Wt(bn,"measureText",function(e,s,n){return Uo(e,new Li(s),n)});let $d=bn;function mM(t,e,s,n){const{width:i,height:r}=qn(e),{color:o=nn.color,strokeColor:a=nn.strokeColor,strokeWidth:l=nn.strokeWidth,strokeType:u=nn.strokeType,background:h=nn.background,borderRadius:g=nn.borderRadius,fixedSize:f=nn.fixedSize}=e.properties.style||nn,p=lM(t,e,s,n);p.setAttribute("data-annotation-type",e.properties.type),p.classList.add("annotation-text"),p.setAttribute("fill",`${o}`);let y=p.firstChild;for(;y;){const S=y.nextSibling;y.nodeType===1&&y.tagName!=="rect"&&p.removeChild(y),y=S}let _=p.firstChild;_||(_=As("rect"),p.appendChild(_));const x=-i/2,v=-r/2;g&&(_.setAttribute("rx",`${g}`),_.setAttribute("ry",`${g}`)),u&&u!=="none"&&(_.setAttribute("stroke",a||"black"),_.setAttribute("stroke-width",`${l}`),u==="dashed"&&_.setAttribute("stroke-dasharray","5,5")),h&&h.length&&(n.hoveredFeature===e.id?_.setAttribute("fill",cp(h)):_.setAttribute("fill",h)),_.setAttribute("width",`${i}`),_.setAttribute("height",`${r}`);const b=_i(e);return _.setAttribute("x",`${x}`),_.setAttribute("y",`${v}`),JX(e,p,x,v),p.setAttribute("transform",n.getScreenAlignedTransform(b.x,b.y,!f)),t.appendChild(p),p}const Hw=t=>t.replace(/$/,""),$w=t=>t.children[0].innerHTML;function JX(t,e,s=0,n=0){const{width:i,height:r}=qn(t),{fontSize:o=nn.fontSize,font:a=nn.font,padding:l=0}=t.properties.style||{};if(i===r&&i===0)return;const u=parseFloat(o.toString())*XN,h=new $d({font:`${o}px/${u}px ${a}`.replace(/(px)+/g,"px"),width:i-l*2,height:r-l,align:"left",valign:"top",x:0,overflow:"ellipsis",parser:$d.htmlparser,createElement:$d.createElement});h.overflowWrap("break-word");const g=t.properties.content||"";if(g.length===0)return;const f=h.linebreak(g.replaceAll(`
`,"<br>")).svg(),p=[...f.children],y=g.match(/(https?:\/\/.*)/gm);(y?y.map(_=>_.split(" ")[0]):[]).forEach(_=>{let x=_;const v=[];for(;x.length>0;){const b=p.find(A=>!!A.children[0]&&A.children[0].tagName==="tspan"&&x.startsWith(Hw($w(A))));if(!b)break;v.push(b);const S=Hw(b.children[0].innerHTML).length;if(!S)break;x=x.slice(S)}v.forEach(b=>{const S=document.createElementNS("http://www.w3.org/2000/svg","a");S.setAttribute("href",_),S.setAttribute("target","_blank"),S.innerHTML=$w(b),b.children[0].innerHTML="",b.children[0].appendChild(S)})}),f.setAttribute("transform",`translate(${s+l}, ${n+l})`),e.appendChild(f)}function t8(t,e,s){const n={...Ta,...e.properties.style},i=n.iconSize,{iconColor:r=Ta.iconColor,iconSymbol:o=Ta.iconSymbol,iconBorderColor:a=Ta.iconBorderColor,iconBorderWidth:l=Ta.iconBorderWidth}=n;let u=t.querySelector("circle");u||(u=As("circle"),u.setAttribute("cx","0"),u.setAttribute("cy","0"),t.appendChild(u)),u.setAttribute("r",`${i/2}`),s.hoveredFeature===e.id?u.setAttribute("fill",cp(r)):u.setAttribute("fill",r),l&&l>0?(u.setAttribute("stroke",a||"#CCC"),u.setAttribute("stroke-width",`${l}`)):(u.removeAttribute("stroke"),u.removeAttribute("stroke-width"));let h=t.querySelector("text");h||(h=As("text"),h.setAttribute("x","0"),h.setAttribute("y","0"),h.setAttribute("text-anchor","middle"),h.setAttribute("dominant-baseline","central"),h.setAttribute("pointer-events","none"),t.appendChild(h)),h.setAttribute("font-size",`${i*.5}`),h.textContent=o}function e8(t,e,s){const n={...e,properties:{type:"text",content:e.properties.content,width:e.properties.width,height:e.properties.height,style:{...e.properties.style,fixedSize:!0}}},i=As("g"),r=mM(i,n,void 0,s);for(t.innerHTML="";r.firstChild;)t.appendChild(r.firstChild);t.setAttribute("filter","url(#softShadow)")}function s8(t,e,s,n){const i=e.properties.mode;let r=s;r||(r=As("g"),r.setAttribute("data-annotation",`${e.id}`),r.setAttribute("data-annotation-type","comment"));let o=r.querySelector(".comment-icon");o||(o=As("g"),o.classList.add("comment-icon"),r.appendChild(o));let a=r.querySelector(".comment-box");a||(a=As("g"),a.classList.add("comment-box"),r.appendChild(a)),t8(o,e,n),e8(a,e,n),i===hh&&!r.classList.contains("comment-collapsed")?(r.classList.add("comment-collapsed"),r.classList.remove("comment-expanded")):i!==hh&&r.classList.contains("comment-collapsed")&&(r.classList.add("comment-expanded"),r.classList.remove("comment-collapsed"));const l=_i(e);return r.setAttribute("transform",n.getScreenAlignedTransform(l.x,l.y,!1)),(!r.parentNode||r.parentNode!==t)&&t.appendChild(r),r}function n8(t,e=.5,s=!1){if(t.length<2)return"";if(t.length<3)return t.map((o,a)=>`${a===0?"M":"L"}${o[0]},${o[1]}`).join(" ")+" Z";const n=t,i=n.length-1,r=[];for(let o=0;o<i;o++){const a=n[(o-1+i)%i],l=n[o],u=n[(o+1)%i],h=n[(o+2)%i],g=l[0]+(u[0]-a[0])/6*e,f=l[1]+(u[1]-a[1])/6*e,p=u[0]-(h[0]-l[0])/6*e,y=u[1]-(h[1]-l[1])/6*e;o===0&&r.push(`M${l[0]},${l[1]}`),s&&o===i-1?r.push(`L${u[0]},${u[1]}`):r.push(`C${g},${f} ${p},${y} ${u[0]},${u[1]}`)}return r.push("Z"),r.join(" ")}const i8=(t,e,s="box")=>(t||(t=As("g"),t.setAttribute("data-annotation",`${e}`),t.classList.add(`annotation-${s}`)),t);function r8(t,e,s,n){const i=i8(s,e.id.toString(),e.properties.type);i.setAttribute("data-annotation",String(e.id));let r=i.querySelector("path");r||(r=As("path"),i.appendChild(r));const{strokeColor:o=Ca.strokeColor,strokeWidth:a=Ca.strokeWidth,background:l=Ca.background,strokeType:u=Ca.strokeType}=e.properties.style||Ca;o&&r.setAttribute("stroke",o),a!==void 0&&r.setAttribute("stroke-width",String(a)),l&&(n.hoveredFeature===e.id?r.setAttribute("fill",cp(l)):r.setAttribute("fill",l)),u==="dashed"?r.setAttribute("stroke-dasharray","5,5"):r.removeAttribute("stroke-dasharray");const h=e.geometry.coordinates[0],g=n8(h,.5,n.drawingFeature===e.id);return r.setAttribute("d",g),i.setAttribute("transform",n.getRotationTransform(0,0)),t.appendChild(i),i}class o8 extends aM{constructor(s,n){super(s,n);Wt(this,"features",new Map);Wt(this,"arrowsRoot",null);Wt(this,"shapesRoot",null);Wt(this,"commentsRoot",null);Wt(this,"annotationsRoot",null);Wt(this,"render",s=>{const{features:n,hoveredFeature:i,selectedFeatures:r,liveUpdates:o}=this.store.getState();(!this.annotationsRoot||!s.contains(this.annotationsRoot))&&(s.innerHTML="",s.appendChild(this.getDefs()),this.arrowsRoot=As("g"),this.commentsRoot=As("g"),this.annotationsRoot=As("g"),this.shapesRoot=As("g"),this.annotationsRoot.appendChild(this.arrowsRoot),this.annotationsRoot.appendChild(this.shapesRoot),this.annotationsRoot.appendChild(this.commentsRoot),s.appendChild(this.annotationsRoot)),s.removeChild(this.annotationsRoot);const a=this.arrowsRoot,l=this.annotationsRoot,u=this.commentsRoot,h=this.shapesRoot,g=this.store.getState(),f=this.getViewportBounds(),p=new Set(Object.keys(n));this.removeFeatures(p);for(let y of Object.values(n)){if(o[y.id]&&(y={...y,...o[y.id]}),!this.isFeatureVisible(y,f))continue;let _=this.features.get(y.id);Yn(y)?_=lM(h,y,_,g):Ws(y)?_=mM(h,y,_,g):Ln(y)?_=s8(u,y,_,g):Nr(y)?_=r8(h,y,_,g):xi(y)&&(_=iX(a,y,g.options.minArrowHeight,g.options.maxArrowHeight,_,g)),_&&this.features.set(y.id,_)}this.applyStateClasses(l,i,r),s.appendChild(l)});Wt(this,"throttleRender",gW(()=>this.render(this.layer.element),8));Wt(this,"refresh",()=>{this.layer.refresh()});this.layer=this.ogma.layers.addSVGLayer({draw:this.render},O0.SHAPES),this.store.subscribe(i=>({features:i.features,liveUpdates:i.liveUpdates,hoveredFeature:i.hoveredFeature,selectedFeatures:i.selectedFeatures,rotation:i.rotation,zoom:i.zoom}),this.throttleRender,{equalityFn:(i,r)=>i.features===r.features&&i.liveUpdates===r.liveUpdates&&i.hoveredFeature===r.hoveredFeature&&i.selectedFeatures===r.selectedFeatures&&i.rotation===r.rotation&&i.zoom===r.zoom})}getViewportBounds(){const s=this.ogma,{width:n,height:i}=s.view.getSize(),r=1.5,o=s.view.screenToGraphCoordinates({x:0,y:0}),a=s.view.screenToGraphCoordinates({x:n*r,y:0}),l=s.view.screenToGraphCoordinates({x:0,y:i*r}),u=s.view.screenToGraphCoordinates({x:n*r,y:i*r});return[Math.min(o.x,a.x,l.x,u.x),Math.min(o.y,a.y,l.y,u.y),Math.max(o.x,a.x,l.x,u.x),Math.max(o.y,a.y,l.y,u.y)]}isFeatureVisible(s,n){const i=s.geometry.bbox;if(!i)return!0;const[r,o,a,l]=i;return!(a<n[0]||r>n[2]||l<n[1]||o>n[3])}getDefs(){const s=As("defs"),n=As("filter");n.setAttribute("id","softShadow"),n.setAttribute("x","-50%"),n.setAttribute("y","-50%"),n.setAttribute("width","200%"),n.setAttribute("height","200%");const i=As("feGaussianBlur");i.setAttribute("in","SourceAlpha"),i.setAttribute("stdDeviation","2"),i.setAttribute("result","blur");const r=As("feOffset");r.setAttribute("in","blur"),r.setAttribute("dx","0"),r.setAttribute("dy","1"),r.setAttribute("result","offsetBlur");const o=As("feComponentTransfer");o.setAttribute("in","offsetBlur"),o.setAttribute("result","shadow");const a=As("feFuncA");a.setAttribute("type","linear"),a.setAttribute("slope","0.25"),o.appendChild(a);const l=As("feMerge"),u=As("feMergeNode");u.setAttribute("in","shadow");const h=As("feMergeNode");return h.setAttribute("in","SourceGraphic"),l.appendChild(u),l.appendChild(h),n.appendChild(i),n.appendChild(r),n.appendChild(o),n.appendChild(l),s.appendChild(n),s}removeFeatures(s){for(const n of this.features.keys())if(!s.has(n)){const i=this.features.get(n);i&&i.parentNode&&i.parentNode.removeChild(i),this.features.delete(n)}}applyStateClasses(s,n,i){if(n!==null){const r=s.querySelector(`[data-annotation="${n}"]`);r&&r.classList.add("annotation-hovered")}i.forEach(r=>{const o=s.querySelector(`[data-annotation="${r}"]`);o&&o.classList.add("annotation-selected")})}destroy(){this.features.clear(),this.layer.destroy(),super.destroy()}}const qw=t=>{let e;const s=new Set,n=(a,l)=>{const u=typeof a=="function"?a(e):a;if(!Object.is(u,e)){const h=e;e=l??(typeof u!="object"||u===null)?u:Object.assign({},e,u),s.forEach(g=>g(e,h))}},i=()=>e,r={setState:n,getState:i,getInitialState:()=>o,subscribe:a=>(s.add(a),()=>s.delete(a))},o=e=t(n,i,r);return r},_M=t=>t?qw(t):qw;var Yw=(t,e,s)=>(n,i)=>({pastStates:(s==null?void 0:s.pastStates)||[],futureStates:(s==null?void 0:s.futureStates)||[],undo:(r=1)=>{var o,a;if(i().pastStates.length){const l=((o=s==null?void 0:s.partialize)==null?void 0:o.call(s,e()))||e(),u=i().pastStates.splice(-r,r),h=u.shift();t(h),n({pastStates:i().pastStates,futureStates:i().futureStates.concat(((a=s==null?void 0:s.diff)==null?void 0:a.call(s,l,h))||l,u.reverse())})}},redo:(r=1)=>{var o,a;if(i().futureStates.length){const l=((o=s==null?void 0:s.partialize)==null?void 0:o.call(s,e()))||e(),u=i().futureStates.splice(-r,r),h=u.shift();t(h),n({pastStates:i().pastStates.concat(((a=s==null?void 0:s.diff)==null?void 0:a.call(s,l,h))||l,u.reverse()),futureStates:i().futureStates})}},clear:()=>n({pastStates:[],futureStates:[]}),isTracking:!0,pause:()=>n({isTracking:!1}),resume:()=>n({isTracking:!0}),setOnSave:r=>n({_onSave:r}),_onSave:s==null?void 0:s.onSave,_handleSet:(r,o,a,l)=>{var u,h;s!=null&&s.limit&&i().pastStates.length>=(s==null?void 0:s.limit)&&i().pastStates.shift(),(h=(u=i())._onSave)==null||h.call(u,r,a),n({pastStates:i().pastStates.concat(l||r),futureStates:[]})}}),a8=(t,e)=>(s,n,i)=>{var l,u;i.temporal=_M(((l=e==null?void 0:e.wrapTemporal)==null?void 0:l.call(e,Yw(s,n,e)))||Yw(s,n,e));const r=((u=e==null?void 0:e.handleSet)==null?void 0:u.call(e,i.temporal.getState()._handleSet))||i.temporal.getState()._handleSet,o=h=>{var p,y,_;if(!i.temporal.getState().isTracking)return;const g=((p=e==null?void 0:e.partialize)==null?void 0:p.call(e,n()))||n(),f=(y=e==null?void 0:e.diff)==null?void 0:y.call(e,h,g);f===null||(_=e==null?void 0:e.equality)!=null&&_.call(e,h,g)||r(h,void 0,g,f)},a=i.setState;return i.setState=(...h)=>{var f;const g=((f=e==null?void 0:e.partialize)==null?void 0:f.call(e,n()))||n();a(...h),o(g)},t((...h)=>{var f;const g=((f=e==null?void 0:e.partialize)==null?void 0:f.call(e,n()))||n();s(...h),o(g)},n,i)};const l8=t=>(e,s,n)=>{const i=n.subscribe;return n.subscribe=(r,o,a)=>{let l=r;if(o){const u=(a==null?void 0:a.equalityFn)||Object.is;let h=r(n.getState());l=g=>{const f=r(g);if(!u(h,f)){const p=h;o(h=f,p)}},a!=null&&a.fireImmediately&&o(h,h)}return i(l)},t(e,s,n)},u8=l8,d8=[0,0,0,0];function h8(t,e){const s=Object.keys(t.features),n=Object.keys(e.features);if(s.length!==n.length)return!1;for(const i of s)if(!(i in e.features))return!1;for(const i of s){const r=t.features[i],o=e.features[i],a=r.geometry,l=o.geometry;if(a.coordinates!==l.coordinates||r.properties!==o.properties||r.properties.style!==o.properties.style||a!==l)return!1}return t.drawingFeature===e.drawingFeature}const c8=t=>{const e=_M()(u8(a8((s,n)=>({features:{},liveUpdates:{},isDragging:!1,hoveringHandle:!1,hoveredHandle:-1,hoveredFeature:null,selectedFeatures:new Set,lastChangedFeatures:[],drawingFeature:null,drawingPoints:null,mousePressed:!1,mousePressPoint:null,rotation:0,sin:0,cos:1,revRotation:0,revSin:0,revCos:1,zoom:1,invZoom:1,options:{showSendButton:(t==null?void 0:t.showSendButton)??!0,sendButtonIcon:(t==null?void 0:t.sendButtonIcon)??ZN,minArrowHeight:(t==null?void 0:t.minArrowHeight)??20,maxArrowHeight:(t==null?void 0:t.maxArrowHeight)??30,detectMargin:(t==null?void 0:t.detectMargin)??2,magnetRadius:(t==null?void 0:t.magnetRadius)??10,magnetHandleRadius:(t==null?void 0:t.magnetHandleRadius)??5,textPlaceholder:(t==null?void 0:t.textPlaceholder)??"Type here"},setOptions:i=>s(r=>({options:{...r.options,...i}})),removeFeature:i=>s(r=>{var f,p,y,_;const o=r.features[i];if(!o)return r;const{features:a,liveUpdates:l}=r,u=new Set([i]);if((Ln(o)||Ws(o))&&Object.values(a).forEach(x=>{var v,b,S,A;xi(x)&&(((b=(v=x.properties.link)==null?void 0:v.end)==null?void 0:b.id)===i||((A=(S=x.properties.link)==null?void 0:S.start)==null?void 0:A.id)===i)&&u.add(x.id)}),xi(o)){const x=((p=(f=o.properties.link)==null?void 0:f.end)==null?void 0:p.type)==="comment"?o.properties.link.end.id:((_=(y=o.properties.link)==null?void 0:y.start)==null?void 0:_.type)==="comment"?o.properties.link.start.id:null;if(x){let v=0;if(Object.values(r.features).forEach(b=>{var S,A,w,L;xi(b)&&b.id!==i&&(((A=(S=b.properties.link)==null?void 0:S.end)==null?void 0:A.id)===x||((L=(w=b.properties.link)==null?void 0:w.start)==null?void 0:L.id)===x)&&v++}),v===0)return console.error("Cannot delete last arrow attached to comment. Delete the comment instead."),r}}const h={...a},g={...l};return u.forEach(x=>{delete h[x],delete g[x]}),{features:h,liveUpdates:g}}),addFeature:i=>s(r=>({features:{...r.features,[i.id]:i}})),startLiveUpdate:i=>{s(r=>({liveUpdates:i.reduce((o,a)=>({...o,[a]:{...r.features[a]}}),{})}))},applyLiveUpdate:(i,r)=>{s(o=>({liveUpdates:{...o.liveUpdates,[i]:{...o.liveUpdates[i],...r}}}))},applyLiveUpdates:i=>{s(r=>{const o=r.liveUpdates;for(const a in i)o[a]=i[a];return{liveUpdates:o}})},commitLiveUpdates:i=>{const{features:r,liveUpdates:o}=n(),a={...r},l=[],u=Object.keys(o);i||(i=new Set(u)),u.forEach(h=>{const g=o[h];a[h]&&Object.keys(g).length>0&&(a[h]={...a[h],...g},l.push(h))}),s({features:a,liveUpdates:{},isDragging:!1,lastChangedFeatures:l})},cancelLiveUpdates:()=>s({liveUpdates:{},isDragging:!1}),updateFeature:(i,r)=>s(o=>{const a={...o.features[i],...r},l={...o.liveUpdates};return delete l[i],{features:{...o.features,[i]:a},liveUpdates:l}}),updateFeatures:i=>s(r=>{const o={...r.features};return Object.entries(i).forEach(([a,l])=>{o[a]&&(o[a]={...o[a],...l})}),{features:o}}),batchUpdate:i=>{const r=e.temporal.getState();r.pause(),i(),r.resume()},getFeature:i=>n().features[i],getMergedFeature:i=>{const r=n().features[i],o=n().liveUpdates[i];if(r)return o?{...r,...o}:r},getAllFeatures:()=>{const{features:i,liveUpdates:r}=n();return Object.entries(i).map(([o,a])=>{const l=r[o];return l?{...a,...l}:a})},setHoveredFeature:i=>s({hoveredFeature:i}),setSelectedFeatures:i=>s({selectedFeatures:new Set(i)}),addToSelection:i=>{const{selectedFeatures:r}=n(),o=new Set(r);o.add(i),s({selectedFeatures:o})},removeFromSelection:i=>{const{selectedFeatures:r}=n(),o=new Set(r);o.delete(i),s({selectedFeatures:o})},toggleSelection:i=>{const{selectedFeatures:r}=n(),o=new Set(r);o.has(i)?o.delete(i):o.add(i),s({selectedFeatures:o})},clearSelection:()=>s({selectedFeatures:new Set}),isHovered:i=>n().hoveredFeature===i,isSelected:i=>n().selectedFeatures.has(i),setRotation:i=>{s({rotation:i,sin:Math.sin(i),cos:Math.cos(i),revRotation:-i,revSin:Math.sin(-i),revCos:Math.cos(-i)})},setZoom:i=>{s({zoom:i,invZoom:1/i})},getScreenAlignedTransform(i,r,o=!0){const a=this.revSin,l=this.revCos,u=i*l-r*a,h=i*a+r*l,g=o?1:this.invZoom;return`matrix(${g}, 0, 0, ${g}, ${u}, ${h})`},getRotationTransform(i,r){const o=this.revSin,a=this.revCos,l=i*a-r*o,u=i*o+r*a;return`matrix(${a}, ${o}, ${-o}, ${a}, ${-l}, ${-u})`},getRotatedBBox(i,r,o,a){return bW(i,r,o-i,a-r,this.sin,this.cos,i+(o-i)/2,r+(a-r)/2,d8)},setDrawingPoints:i=>s({drawingPoints:i})}),{limit:250,partialize:s=>({drawingFeature:s.drawingFeature,isDragging:s.isDragging,features:s.features,lastChangedFeatures:s.lastChangedFeatures}),equality:h8,handleSet:s=>n=>{n.drawingFeature===null&&s(n)}})));return e},g8={detectMargin:2,magnetHandleRadius:5,magnetRadius:10,textPlaceholder:"Type here",showSendButton:!0,sendButtonIcon:ZN,minArrowHeight:20,maxArrowHeight:30};class f8 extends QY{constructor(s,n={}){super();Wt(this,"ogma");Wt(this,"store");Wt(this,"renderers",{});Wt(this,"interactions");Wt(this,"editor");Wt(this,"links");Wt(this,"index");Wt(this,"drawing");Wt(this,"selectionManager");Wt(this,"historyManager");Wt(this,"updateManager");Wt(this,"commentManager");Wt(this,"onRotate",()=>this.store.getState().setRotation(this.ogma.view.getAngle()));Wt(this,"onZoom",()=>{const s=this.ogma.view.getZoom();this.store.getState().setZoom(s),this.commentManager.updateCommentModesForZoom(s)});Wt(this,"onLayout",()=>{this.links.update()});this.ogma=s;const i={...g8,...n};this.store=c8(i),this.index=new QW(this.store),this.links=new jW(this.ogma,this.store,(r,o)=>{this.emit(JY,{arrow:r,link:o})}),this.interactions=new HW(this.ogma,this.store,this.index),this.editor=new UW(this.ogma,this.store,this.index,this.links,this.interactions),this.drawing=new CW(this.ogma,this.store,this.editor,this.interactions,this.links,this,this.index),this.selectionManager=new kW(this.store),this.historyManager=new LW(this.store,this.links),this.updateManager=new NW(this.store),this.commentManager=new AW(this.store),this.initializeRenderers(),this.setupEvents()}initializeRenderers(){this.renderers.shapes=new o8(this.ogma,this.store),this.renderers.handles=new tX(this.ogma,this.store)}setupEvents(){this.ogma.events.on("rotate",this.onRotate).on("zoom",this.onZoom).on("layoutEnd",this.onLayout),this.editor.addEventListener(dh,()=>this.emit(dh)),this.editor.addEventListener(mx,()=>this.emit(mx)),this.interactions.addEventListener(_x,()=>this.emit(_x)),this.store.temporal.subscribe(s=>{this.emit(qN,{canUndo:s.pastStates.length>0,canRedo:s.futureStates.length>0})}),this.store.subscribe(s=>s.selectedFeatures,(s,n)=>{const i=Array.from(s).filter(r=>!(n!=null&&n.has(r)));if(i.length>0&&this.emit(VN,{ids:i}),n){const r=Array.from(n).filter(o=>!s.has(o));r.length>0&&this.emit(jN,{ids:r})}}),this.store.subscribe(s=>s.drawingFeature,(s,n)=>{s===null&&n!==null&&this.emit(If,{id:n})}),this.store.subscribe(s=>s.features,(s,n)=>{if(n){for(const i of Object.keys(s))n[i]?n[i]!==s[i]&&this.emit($N,s[i]):this.emit(Mf,{id:i});for(const i of Object.keys(n))s[i]||this.emit(HN,{id:i})}})}setOptions(s={}){return this.store.getState().setOptions(s),this.store.getState().options}add(s){return this.updateManager.add(s),this}remove(s){return this.updateManager.remove(s),this}undo(){return this.historyManager.undo()}redo(){return this.historyManager.redo()}canUndo(){return this.historyManager.canUndo()}canRedo(){return this.historyManager.canRedo()}clearHistory(){this.historyManager.clearHistory()}getAnnotations(){return this.updateManager.getAnnotations()}select(s){return this.selectionManager.select(s),this}unselect(s){return this.selectionManager.unselect(s),this}cancelDrawing(){var s;return this.drawing.cancelPendingDrawing(),(s=this.editor.getActiveHandler())==null||s.cancelDrawing(),this.emit(yx),this}enableArrowDrawing(s){return this.drawing.enableArrowDrawing(s),this}enableTextDrawing(s){return this.drawing.enableTextDrawing(s),this}enableBoxDrawing(s){return this.drawing.enableBoxDrawing(s),this}enablePolygonDrawing(s){return this.drawing.enablePolygonDrawing(s),this}enableCommentDrawing(s={}){return this.drawing.enableCommentDrawing(s),this}startComment(s,n,i,r){return this.drawing.startComment(s,n,i,r),this}startBox(s,n,i){return this.drawing.startBox(s,n,i),this}startArrow(s,n,i){return this.drawing.startArrow(s,n,i),this}startText(s,n,i){return this.drawing.startText(s,n,i),this}startPolygon(s,n,i){return this.drawing.startPolygon(s,n,i),this}getSelectedAnnotations(){return this.selectionManager.getSelectedAnnotations()}getSelected(){return this.selectionManager.getSelected()}getAnnotation(s){return this.updateManager.getAnnotation(s)}setScale(s,n,i,r){return this.updateManager.setScale(s,n,i,r),this}toggleComment(s){return this.commentManager.toggleComment(s),this}destroy(){this.ogma.events.off(this.onRotate).off(this.onZoom),this.links.destroy(),Object.values(this.renderers).forEach(s=>s.destroy()),this.interactions.destroy(),this.editor.destroy()}updateStyle(s,n){return this.updateManager.updateStyle(s,n),this}update(s){return this.updateManager.update(s),this}link(s,n,i=Go){const r=this.getAnnotation(s);if(!r)throw new Error(`Arrow with id ${s} not found`);return this.editor.getArrowHandler().link(r,n,i),this}isDrawing(){return this.drawing.isDrawing()}}const yu=(t,e=0,s=1)=>t>s?s:t<e?e:t,oi=(t,e=0,s=Math.pow(10,e))=>Math.round(s*t)/s,yM=({h:t,s:e,v:s,a:n})=>{const i=(200-e)*s/100;return{h:oi(t),s:oi(i>0&&i<200?e*s/100/(i<=100?i:200-i)*100:0),l:oi(i/2),a:oi(n,2)}},wx=t=>{const{h:e,s,l:n}=yM(t);return`hsl(${e}, ${s}%, ${n}%)`},j_=t=>{const{h:e,s,l:n,a:i}=yM(t);return`hsla(${e}, ${s}%, ${n}%, ${i})`},p8=({h:t,s:e,v:s,a:n})=>{t=t/360*6,e=e/100,s=s/100;const i=Math.floor(t),r=s*(1-e),o=s*(1-(t-i)*e),a=s*(1-(1-t+i)*e),l=i%6;return{r:oi([s,o,r,r,a,s][l]*255),g:oi([a,s,s,o,r,r][l]*255),b:oi([r,r,a,s,s,o][l]*255),a:oi(n,2)}},m8=({r:t,g:e,b:s,a:n})=>{const i=Math.max(t,e,s),r=i-Math.min(t,e,s),o=r?i===t?(e-s)/r:i===e?2+(s-t)/r:4+(t-e)/r:0;return{h:oi(60*(o<0?o+6:o)),s:oi(i?r/i*100:0),v:oi(i/255*100),a:n}},xM=(t,e)=>{if(t===e)return!0;for(const s in t)if(t[s]!==e[s])return!1;return!0},Ww={},vM=t=>{let e=Ww[t];return e||(e=document.createElement("template"),e.innerHTML=t,Ww[t]=e),e},U0=(t,e,s)=>{t.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:s}))};let ru=!1;const Tx=t=>"touches"in t,_8=t=>ru&&!Tx(t)?!1:(ru||(ru=Tx(t)),!0),Xw=(t,e)=>{const s=Tx(e)?e.touches[0]:e,n=t.el.getBoundingClientRect();U0(t.el,"move",t.getMove({x:yu((s.pageX-(n.left+window.pageXOffset))/n.width),y:yu((s.pageY-(n.top+window.pageYOffset))/n.height)}))},y8=(t,e)=>{const s=e.keyCode;s>40||t.xy&&s<37||s<33||(e.preventDefault(),U0(t.el,"move",t.getMove({x:s===39?.01:s===37?-.01:s===34?.05:s===33?-.05:s===35?1:s===36?-1:0,y:s===40?.01:s===38?-.01:0},!0)))};class G0{constructor(e,s,n,i){const r=vM(`<div role="slider" tabindex="0" part="${s}" ${n}><div part="${s}-pointer"></div></div>`);e.appendChild(r.content.cloneNode(!0));const o=e.querySelector(`[part=${s}]`);o.addEventListener("mousedown",this),o.addEventListener("touchstart",this),o.addEventListener("keydown",this),this.el=o,this.xy=i,this.nodes=[o.firstChild,o]}set dragging(e){const s=e?document.addEventListener:document.removeEventListener;s(ru?"touchmove":"mousemove",this),s(ru?"touchend":"mouseup",this)}handleEvent(e){switch(e.type){case"mousedown":case"touchstart":if(e.preventDefault(),!_8(e)||!ru&&e.button!=0)return;this.el.focus(),Xw(this,e),this.dragging=!0;break;case"mousemove":case"touchmove":e.preventDefault(),Xw(this,e);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":y8(this,e);break}}style(e){e.forEach((s,n)=>{for(const i in s)this.nodes[n].style.setProperty(i,s[i])})}}class x8 extends G0{constructor(e){super(e,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:e}){this.h=e,this.style([{left:`${e/360*100}%`,color:wx({h:e,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${oi(e)}`)}getMove(e,s){return{h:s?yu(this.h+e.x*360,0,360):360*e.x}}}class v8 extends G0{constructor(e){super(e,"saturation",'aria-label="Color"',!0)}update(e){this.hsva=e,this.style([{top:`${100-e.v}%`,left:`${e.s}%`,color:wx(e)},{"background-color":wx({h:e.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${oi(e.s)}%, Brightness ${oi(e.v)}%`)}getMove(e,s){return{s:s?yu(this.hsva.s+e.x*100,0,100):e.x*100,v:s?yu(this.hsva.v-e.y*100,0,100):Math.round(100-e.y*100)}}}const b8=':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',E8="[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}",S8="[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}",Fg=Symbol("same"),H_=Symbol("color"),Zw=Symbol("hsva"),$_=Symbol("update"),Kw=Symbol("parts"),Pf=Symbol("css"),zf=Symbol("sliders");class A8 extends HTMLElement{static get observedAttributes(){return["color"]}get[Pf](){return[b8,E8,S8]}get[zf](){return[v8,x8]}get color(){return this[H_]}set color(e){if(!this[Fg](e)){const s=this.colorModel.toHsva(e);this[$_](s),this[H_]=e}}constructor(){super();const e=vM(`<style>${this[Pf].join("")}</style>`),s=this.attachShadow({mode:"open"});s.appendChild(e.content.cloneNode(!0)),s.addEventListener("move",this),this[Kw]=this[zf].map(n=>new n(s))}connectedCallback(){if(this.hasOwnProperty("color")){const e=this.color;delete this.color,this.color=e}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(e,s,n){const i=this.colorModel.fromAttr(n);this[Fg](i)||(this.color=i)}handleEvent(e){const s=this[Zw],n={...s,...e.detail};this[$_](n);let i;!xM(n,s)&&!this[Fg](i=this.colorModel.fromHsva(n))&&(this[H_]=i,U0(this,"color-changed",{value:i}))}[Fg](e){return this.color&&this.colorModel.equal(e,this.color)}[$_](e){this[Zw]=e,this[Kw].forEach(s=>s.update(e))}}class w8 extends G0{constructor(e){super(e,"alpha",'aria-label="Alpha" aria-valuemin="0" aria-valuemax="1"',!1)}update(e){this.hsva=e;const s=j_({...e,a:0}),n=j_({...e,a:1}),i=e.a*100;this.style([{left:`${i}%`,color:j_(e)},{"--gradient":`linear-gradient(90deg, ${s}, ${n}`}]);const r=oi(i);this.el.setAttribute("aria-valuenow",`${r}`),this.el.setAttribute("aria-valuetext",`${r}%`)}getMove(e,s){return{a:s?yu(this.hsva.a+e.x):e.x}}}const T8=`[part=alpha]{flex:0 0 24px}[part=alpha]::after{display:block;content:"";position:absolute;top:0;left:0;right:0;bottom:0;border-radius:inherit;background-image:var(--gradient);box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part^=alpha]{background-color:#fff;background-image:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><rect x="8" width="8" height="8"/><rect y="8" width="8" height="8"/></svg>')}[part=alpha-pointer]{top:50%}`;class C8 extends A8{get[Pf](){return[...super[Pf],T8]}get[zf](){return[...super[zf],w8]}}const L8={defaultColor:{r:0,g:0,b:0,a:1},toHsva:m8,fromHsva:p8,equal:xM,fromAttr:t=>JSON.parse(t)};class k8 extends C8{get colorModel(){return L8}}class bM extends k8{}customElements.define("rgba-color-picker",bM);const Qw=[8,10,12,14,16,24,32,48,64,72],Jw="none",EM="#333333";["Roboto","Helvetica Neue","Helvetica","Arial","sans-serif","Georgia, serif","Menlo","Monaco","Consolas","Courier New","monospace"].sort((t,e)=>t.toLocaleLowerCase().localeCompare(e.toLocaleLowerCase()));const SM={head:"arrow",strokeColor:EM,strokeWidth:5},N8=.25,AM={font:"Roboto",fontSize:Qw[2],padding:Qw[2]*N8,color:EM,strokeType:Jw,background:Jw},wM=jt.createContext(void 0),cr=()=>jt.useContext(wM);function M8(t){return t.reduce((e,s)=>e+s,0)/t.length}const I8=({children:t,annotations:e})=>{const s=an(),[n,i]=jt.useState(e||{type:"FeatureCollection",features:[]}),[r,o]=jt.useState(null),[a,l]=jt.useState(SM),[u,h]=jt.useState(AM),[g,f]=jt.useState(),[p,y]=jt.useState(1),[_,x]=jt.useState(1),[v,b]=jt.useState(!1),[S,A]=jt.useState(!1);return jt.useEffect(()=>{if(!s)return;const w=new f8(s,{minArrowHeight:1}),L=M8(s.getNodes().getAttribute("radius"))/5,I=p;return l({...a,strokeWidth:(a.strokeWidth||1)*I}),y(I),x(L),w.on(VN,()=>{w.getSelectedAnnotations().features.forEach(F=>{F&&(xi(F)?l({...F.properties.style||{}}):Ws(F)&&h({...F.properties.style||{}}),o(F))})}).on(jN,()=>{o(null)}).on(Mf,()=>{i(w.getAnnotations())}).on(HN,()=>{i(w.getAnnotations())}).on($N,()=>{i(w.getAnnotations())}).on(qN,()=>{b(w.canUndo()),A(w.canRedo())}),f(w),e&&(w.add(e),w.clearHistory()),()=>{w.destroy()}},[s]),jt.useEffect(()=>{g&&r&&(r==null?void 0:r.properties.type)==="arrow"&&g.updateStyle(r.id,a)},[g,a,r]),jt.useEffect(()=>{g&&r&&(r==null?void 0:r.properties.type)==="text"&&g.updateStyle(r.id,u)},[g,u,r]),zt.jsx(wM.Provider,{value:{annotations:n,currentAnnotation:r,setCurrentAnnotation:o,textStyle:u,setTextStyle:h,arrowStyle:a,setArrowStyle:l,arrowWidthFactor:p,setArrowWidthFactor:y,textSizeFactor:_,setTextSizeFactor:x,editor:g,setEditor:f,canUndo:v,canRedo:S,undo:()=>(g==null?void 0:g.undo())||!1,redo:()=>(g==null?void 0:g.redo())||!1,clearHistory:()=>g==null?void 0:g.clearHistory(),add:w=>g==null?void 0:g.add(w),remove:w=>g==null?void 0:g.remove(w),cancelDrawing:()=>g==null?void 0:g.cancelDrawing(),select:w=>g==null?void 0:g.select(w),enableBoxDrawing:w=>g==null?void 0:g.enableBoxDrawing(w),enablePolygonDrawing:w=>g==null?void 0:g.enablePolygonDrawing(w),enableCommentDrawing:w=>g==null?void 0:g.enableCommentDrawing(w)},children:t})},q_=({annotation:t,mode:e,initialColor:s})=>{const{editor:n}=cr(),[i,r]=jt.useState(s),[o,a]=jt.useState(["#0099FF","#FF7523","#44AA99"]),[l,u]=jt.useState(0),[h,g]=jt.useState(!1),f=jt.useRef(null),p=jt.useRef(null),y=jt.useCallback(v=>{t&&(e==="arrow"?n==null||n.updateStyle(t.id,{strokeColor:v}):e==="text"?n==null||n.updateStyle(t.id,{color:v}):e==="polygon"&&(n==null||n.updateStyle(t.id,{strokeColor:v})))},[t,n,e]),_=jt.useCallback(v=>{if(o.includes(v))u(o.indexOf(v));else{const b=[v,...o.slice(0,2)];a(b),u(0)}r(v)},[o]);jt.useEffect(()=>{const v=b=>{if(h&&f.current&&!f.current.contains(b.target)){const S=document.querySelectorAll(".color-circle");Array.from(S).some(w=>w.contains(b.target))||g(!1)}};return document.addEventListener("click",v),()=>document.removeEventListener("click",v)},[h]),jt.useEffect(()=>{h&&f.current&&!p.current&&(p.current=new bM,p.current.color=cW(i),f.current.appendChild(p.current),p.current.addEventListener("color-changed",v=>{const b=R8(v.detail.value);r(b);const S=[...o];S[l]=b,a(S),y(b)})),!h&&p.current&&f.current&&(f.current.innerHTML="",p.current=null)},[h,i,l,o,y,_]),jt.useEffect(()=>{_(s)},[s,_]);const x=(v,b)=>{b.stopPropagation(),b.preventDefault();const S=l===v&&h;u(v),r(o[v]),S?g(!1):h?(g(!1),setTimeout(()=>g(!0),50)):(y(o[v]),g(!0))};return zt.jsxs(zt.Fragment,{children:[zt.jsx("div",{className:"section-header",children:zt.jsx("h3",{children:"Color"})}),zt.jsx("div",{className:"color-selector",children:o.map((v,b)=>zt.jsx("button",{className:`color-circle ${b===l?"color-circle-primary":""}`,style:{"--circle-color":v},onClick:S=>x(b,S),children:zt.jsx("div",{className:"color-inner"})},b))}),h&&zt.jsx("div",{className:"color-picker-overlay",ref:f,style:{position:"fixed",right:"240px",top:"50%",transform:"translateY(-50%)",zIndex:1e4}})]})};function R8(t){return`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`}const F8=[{value:"#f5f5f5",style:"--circle-color: #f5f5f5;"},{value:"#EDE6FF",style:"--circle-color: #EDE6FF;"},{value:"transparent",style:"--circle-color: white; border: 2px dashed #ccc;"}],tT=({annotation:t,currentBackground:e})=>{const{editor:s}=cr(),n=i=>{t&&(s==null||s.updateStyle(t.id,{background:i}))};return zt.jsxs(zt.Fragment,{children:[zt.jsx("div",{className:"section-header",children:zt.jsx("h3",{children:"Background"})}),zt.jsx("div",{className:"color-selector",children:F8.map(({value:i,style:r})=>{const o={};if(r.includes("--circle-color:")){const a=r.split(":")[1].replace(";","").trim();o["--circle-color"]=a}if(r.includes("border:")){const a=r.split("border:")[1].replace(";","").trim();o.border=a}return zt.jsx("button",{className:`color-circle ${i===e?"color-circle-primary":""}`,onClick:()=>n(i),children:zt.jsx("div",{className:"color-inner",style:o})},i)})})]})},Y_=[{value:"sans-serif",label:"Sans Serif",icon:"icon-type"},{value:"serif",label:"Serif",icon:"icon-italic"},{value:"monospace",label:"Monospace",icon:"icon-code"}],P8=({annotation:t,currentFont:e})=>{const{editor:s}=cr(),[n,i]=jt.useState(!1),r=a=>{t&&(s==null||s.updateStyle(t.id,{font:a})),i(!1)},o=Y_.find(a=>a.value===e)||Y_[0];return zt.jsxs(zt.Fragment,{children:[zt.jsx("div",{className:"section-header",children:zt.jsx("h3",{children:"Font"})}),zt.jsx("div",{className:"custom-select-section",children:zt.jsxs("div",{className:`custom-select ${n?"open":""}`,children:[zt.jsxs("div",{className:"custom-select-trigger",onClick:()=>i(!n),children:[zt.jsx("i",{className:o.icon}),zt.jsx("span",{children:o.label}),zt.jsx("i",{className:"icon-chevron-down custom-select-arrow"})]}),zt.jsx("div",{className:"custom-select-options",children:Y_.map(a=>zt.jsxs("div",{className:`custom-select-option ${a.value===e?"selected":""}`,title:a.label,onClick:()=>r(a.value),children:[zt.jsx("i",{className:a.icon}),zt.jsx("span",{children:a.label})]},a.value))})]})})]})},z8=[{value:"none",label:"None",icon:"icon-x"},{value:"arrow",label:"Open Arrow",icon:"icon-arrow-left"},{value:"arrow-plain",label:"Filled Arrow",icon:"icon-play"},{value:"halo-dot",label:"Halo Dot",icon:"icon-circle-dot"},{value:"dot",label:"Dot",icon:"icon-dot"}],D8=({annotation:t})=>{const{editor:e}=cr(),[s,n]=jt.useState(new Set),i=(a,l)=>{t&&(e==null||e.updateStyle(t.id,{[a]:l})),n(u=>{const h=new Set(u);return h.delete(a),h})},r=a=>{n(l=>{const u=new Set(l);return u.has(a)?u.delete(a):(u.clear(),u.add(a)),u})},o=a=>{var f;const l=((f=t.properties.style)==null?void 0:f[a])||"none",u=z8.map(p=>({...p,icon:p.value==="arrow"&&a==="tail"?"icon-arrow-left":p.value==="arrow"?"icon-arrow-right":p.icon,selected:p.value===l,rotate:p.value==="arrow-plain"&&a==="tail"})),h=u.find(p=>p.selected)||u[0],g=s.has(a);return zt.jsxs("div",{className:"extremity-wrapper",children:[zt.jsx("label",{children:a}),zt.jsxs("div",{className:`custom-select ${g?"open":""}`,children:[zt.jsxs("div",{className:"custom-select-trigger",onClick:()=>r(a),children:[zt.jsx("i",{className:h.icon,style:h.rotate?{transform:"rotate(180deg)"}:{}}),zt.jsx("span",{children:h.label}),zt.jsx("i",{className:"icon-chevron-down custom-select-arrow"})]}),zt.jsx("div",{className:"custom-select-options",children:u.map(p=>zt.jsxs("div",{className:`custom-select-option ${p.selected?"selected":""}`,title:p.label,onClick:()=>i(a,p.value),children:[zt.jsx("i",{className:p.icon,style:p.rotate?{transform:"rotate(180deg)"}:{}}),zt.jsx("span",{children:p.label})]},p.value))})]})]})};return zt.jsxs(zt.Fragment,{children:[zt.jsx("div",{className:"section-header",children:zt.jsx("h3",{children:"Extremities"})}),zt.jsxs("div",{className:"custom-select-section",children:[o("head"),o("tail")]})]})},Pg=({annotation:t,title:e,property:s,value:n,min:i,max:r,mode:o,currentColor:a})=>{const{editor:l}=cr(),[u,h]=rs.useState(n);rs.useEffect(()=>{h(n)},[n]);const g=f=>{t&&(s==="strokeWidth"?o==="text"&&a?l==null||l.updateStyle(t.id,{strokeWidth:f,strokeColor:a}):l==null||l.updateStyle(t.id,{strokeWidth:f}):s==="fontSize"&&(l==null||l.updateStyle(t.id,{fontSize:f})))};return zt.jsxs(zt.Fragment,{children:[zt.jsx("div",{className:"section-header",children:zt.jsx("h3",{children:e})}),zt.jsxs("div",{className:"slider-section",children:[zt.jsx("input",{type:"range",id:`${s}-slider`,className:"slider",min:i,max:r,value:u,onChange:f=>{const p=parseInt(f.target.value,10);h(p),g(p)}}),zt.jsx("div",{className:"slider-value",children:zt.jsx("span",{children:u})})]})]})},O8=[{value:"plain",icon:"icon-circle"},{value:"dashed",icon:"icon-circle-dashed"}],W_=({annotation:t,currentLineType:e})=>{const{editor:s}=cr(),n=i=>{t&&(s==null||s.updateStyle(t.id,{strokeType:i}))};return zt.jsxs(zt.Fragment,{children:[zt.jsx("div",{className:"section-header",children:zt.jsx("h3",{children:"Line type"})}),zt.jsx("div",{className:"linetype-section",children:O8.map(({value:i,icon:r})=>zt.jsx("button",{className:`linetype-button ${e===i?"active":""}`,title:i,onClick:()=>n(i),children:zt.jsx("i",{className:r})},i))})]})},B8=({visible:t,annotation:e})=>{const[s,n]=jt.useState(null);jt.useEffect(()=>{e?xi(e)?n("arrow"):Ws(e)||Yn(e)?n("text"):Nr(e)&&n("polygon"):n(null)},[e]);const i=()=>{var u,h,g;return e?s==="arrow"?((u=e.properties.style)==null?void 0:u.strokeColor)||$a.strokeColor:s==="text"?((h=e.properties.style)==null?void 0:h.color)||nn.color:s==="polygon"?((g=e.properties.style)==null?void 0:g.strokeColor)||"#000000":"#0099FF":"#0099FF"},r=u=>{const h=u.properties.style||{},g=h.strokeWidth||$a.strokeWidth,f=h.strokeType||"plain",p=i();return zt.jsxs(zt.Fragment,{children:[zt.jsx(q_,{annotation:e,mode:"arrow",initialColor:p}),zt.jsx(D8,{annotation:u}),zt.jsx(Pg,{annotation:e,title:"Stroke width",property:"strokeWidth",value:g,min:1,max:20}),zt.jsx(W_,{annotation:e,currentLineType:f})]})},o=u=>{const h=u.properties.style||{},g=typeof h.fontSize=="number"?h.fontSize:typeof nn.fontSize=="number"?nn.fontSize:18,f=h.strokeWidth||nn.strokeWidth,p=h.strokeType||"plain",y=h.background||nn.background,_=h.font||nn.font,x=i();return zt.jsxs(zt.Fragment,{children:[zt.jsx(q_,{annotation:e,mode:"text",initialColor:x}),zt.jsx(tT,{annotation:e,currentBackground:y}),zt.jsx(P8,{annotation:e,currentFont:_}),zt.jsx(Pg,{annotation:e,title:"Font size",property:"fontSize",value:g,min:8,max:72}),zt.jsx(Pg,{annotation:e,title:"Stroke width",property:"strokeWidth",value:f,min:1,max:20,mode:"text",currentColor:x}),zt.jsx(W_,{annotation:e,currentLineType:p})]})},a=u=>{const h=u.properties.style||{},g=h.strokeWidth||2,f=h.strokeType||"plain",p=h.background||"transparent",y=i();return zt.jsxs(zt.Fragment,{children:[zt.jsx(q_,{annotation:e,mode:"polygon",initialColor:y}),zt.jsx(tT,{annotation:e,currentBackground:p}),zt.jsx(Pg,{annotation:e,title:"Stroke width",property:"strokeWidth",value:g,min:1,max:20}),zt.jsx(W_,{annotation:e,currentLineType:f})]})},l=rs.useCallback(u=>{u.stopPropagation()},[]);return!t||!e?null:zt.jsx("div",{className:"annotation-panel",onClick:l,onMouseDown:l,onMouseMove:l,children:zt.jsxs("div",{className:"panel-body",children:[s==="arrow"&&xi(e)&&r(e),s==="text"&&(Ws(e)||Yn(e)||Ln(e))&&o(e),s==="polygon"&&Nr(e)&&a(e)]})})},U8=()=>{const{editor:t}=cr(),[e,s]=jt.useState(null),[n,i]=jt.useState(null),[r,o]=jt.useState(!1);return jt.useEffect(()=>{if(!t)return;const a=f=>{if(f.ids.length===1){const p=t.getAnnotation(f.ids[0]);if(!p)return;i(p);const y=()=>{n&&(s(n),o(!0),i(null))};t.isDrawing()&&t.once("cancelDrawing",y).once("completeDrawing",y)}else i(null),o(!1)},l=()=>{n&&(s(n),o(!0),i(null))},u=()=>{n&&(s(n),o(!0),i(null))},h=()=>{i(null),o(!1)},g=()=>{o(!1),s(null)};return t.on("select",a).on("click",l).on("dragend",u).on("dragstart",h).on("unselect",g),()=>{t.off("select",a).off("click",l).off("dragend",u).off("dragstart",h).off("unselect",g)}},[t,n]),zt.jsx(B8,{visible:r,annotation:e})};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G8=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),V8=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,n)=>n?n.toUpperCase():s.toLowerCase()),eT=t=>{const e=V8(t);return e.charAt(0).toUpperCase()+e.slice(1)},TM=(...t)=>t.filter((e,s,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===s).join(" ").trim(),j8=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var H8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $8=jt.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:i="",children:r,iconNode:o,...a},l)=>jt.createElement("svg",{ref:l,...H8,width:e,height:e,stroke:t,strokeWidth:n?Number(s)*24/Number(e):s,className:TM("lucide",i),...!r&&!j8(a)&&{"aria-hidden":"true"},...a},[...o.map(([u,h])=>jt.createElement(u,h)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mi=(t,e)=>{const s=jt.forwardRef(({className:n,...i},r)=>jt.createElement($8,{ref:r,iconNode:e,className:TM(`lucide-${G8(eT(t))}`,`lucide-${t}`,n),...i}));return s.displayName=eT(t),s};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Y8=Mi("arrow-right",q8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W8=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],X8=Mi("camera",W8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z8=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],K8=Mi("download",Z8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q8=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],J8=Mi("message-square",Q8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t9=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],e9=Mi("minimize",t9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s9=[["path",{d:"M10.83 2.38a2 2 0 0 1 2.34 0l8 5.74a2 2 0 0 1 .73 2.25l-3.04 9.26a2 2 0 0 1-1.9 1.37H7.04a2 2 0 0 1-1.9-1.37L2.1 10.37a2 2 0 0 1 .73-2.25z",key:"2hea0t"}]],n9=Mi("pentagon",s9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i9=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]],r9=Mi("rectangle-horizontal",i9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o9=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],a9=Mi("redo",o9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l9=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],u9=Mi("rotate-ccw",l9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d9=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],h9=Mi("rotate-cw",d9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c9=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],g9=Mi("trash",c9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f9=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],p9=Mi("type",f9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m9=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],_9=Mi("undo",m9),y9=({onSvgExport:t,onJsonExport:e})=>{const{editor:s,canUndo:n,canRedo:i,undo:r,redo:o,remove:a}=cr(),[l,u]=rs.useState(null);rs.useEffect(()=>{if(!s)return;const b=()=>{u(null)};return s.on(If,b),s.on(yx,b),()=>{s.off(If,b),s.off(yx,b)}},[s]);const h=rs.useCallback(()=>{s.enableArrowDrawing({strokeType:"plain",strokeColor:"#3A03CF",strokeWidth:2,head:"arrow"}),u("arrow")},[s]),g=rs.useCallback(()=>{s.enableTextDrawing({font:"IBM Plex Sans",fontSize:24,color:"#3A03CF",background:"#EDE6FF",borderRadius:8,padding:12}),u("text")},[s]),f=rs.useCallback(()=>{s.enableBoxDrawing({background:"#EDE6FF",borderRadius:8,padding:12}),u("box")},[s]),p=rs.useCallback(()=>{s.enablePolygonDrawing({strokeColor:"#3A03CF",strokeWidth:2,background:"rgba(58, 3, 207, 0.15)"}),u("polygon")},[s]),y=rs.useCallback(()=>{s.enableCommentDrawing({offsetX:200,offsetY:-150,commentStyle:{content:"",style:{color:"#3A03CF",background:"#EDE6FF",fontSize:16,font:"IBM Plex Sans"}},arrowStyle:{style:{strokeType:"plain",strokeColor:"#3A03CF",strokeWidth:2,head:"halo-dot"}}}),u("comment")},[s]),_=rs.useCallback(()=>{const b=s.getSelectedAnnotations();b.features.length>0&&a(b)},[s,a]),x=rs.useCallback(b=>{b.stopPropagation(),b.preventDefault()},[]),v=16;return zt.jsxs("div",{className:"add-menu",onClick:x,onMouseMove:x,children:[zt.jsx("button",{"data-tooltip":"Add arrow",onClick:h,className:l==="arrow"?"active":"",children:zt.jsx(Y8,{width:v,height:v})}),zt.jsx("button",{"data-tooltip":"Add comment",onClick:y,className:l==="comment"?"active":"",children:zt.jsx(J8,{width:v,height:v})}),zt.jsx("button",{"data-tooltip":"Add box",onClick:f,className:l==="box"?"active":"",children:zt.jsx(r9,{width:v,height:v})}),zt.jsx("button",{"data-tooltip":"Add text",onClick:g,className:l==="text"?"active":"",children:zt.jsx(p9,{width:v,height:v})}),zt.jsx("button",{"data-tooltip":"Add polygon (click points, Esc to finish)",onClick:p,className:l==="polygon"?"active":"",children:zt.jsx(n9,{width:v,height:v})}),zt.jsx("span",{className:"separator"}),zt.jsx("button",{"data-tooltip":"Undo",onClick:()=>r(),disabled:!n,children:zt.jsx(_9,{width:v,height:v})}),zt.jsx("button",{"data-tooltip":"Redo",onClick:()=>o(),disabled:!i,children:zt.jsx(a9,{width:v,height:v})}),zt.jsx("span",{className:"separator"}),zt.jsx("button",{"data-tooltip":"Delete selected",onClick:_,children:zt.jsx(g9,{width:v,height:v})}),zt.jsx("span",{className:"separator"}),zt.jsx("button",{"data-tooltip":"Export annotations",onClick:e,children:zt.jsx(K8,{width:v,height:v})}),zt.jsx("button",{"data-tooltip":"Export SVG",onClick:t,children:zt.jsx(X8,{width:v,height:v})})]})},x9=({isOpen:t,jsonContent:e,onClose:s,onDownload:n})=>{const i=rs.useCallback(o=>{o.target===o.currentTarget&&s()},[s]),r=rs.useCallback(o=>{o.stopPropagation()},[]);return t?zt.jsx("div",{className:"popup-backdrop",onClick:i,children:zt.jsxs("div",{className:"popup-content",onWheel:r,children:[zt.jsxs("div",{className:"popup-header",children:[zt.jsx("h2",{children:"JSON Export Preview"}),zt.jsx("button",{className:"popup-close",onClick:s,children:""})]}),zt.jsx("div",{className:"popup-body",children:zt.jsx("div",{className:"json-preview",children:zt.jsx("pre",{children:zt.jsx("code",{children:e})})})}),zt.jsx("div",{className:"popup-footer",children:zt.jsx("button",{className:"popup-button",onClick:n,children:"Download JSON"})})]})}):null},v9=({isOpen:t,svgContent:e,onClose:s,onDownload:n})=>{const[i,r]=rs.useState("");rs.useEffect(()=>{if(e){const a=new Blob([e],{type:"image/svg+xml"}),l=URL.createObjectURL(a);return r(l),()=>{URL.revokeObjectURL(l)}}},[e]);const o=rs.useCallback(a=>{a.target===a.currentTarget&&s()},[s]);return t?zt.jsx("div",{className:"popup-backdrop",onClick:o,children:zt.jsxs("div",{className:"popup-content",children:[zt.jsxs("div",{className:"popup-header",children:[zt.jsx("h2",{children:"SVG Export Preview"}),zt.jsx("button",{className:"popup-close",onClick:s,children:""})]}),zt.jsx("div",{className:"popup-body",children:zt.jsx("div",{className:"svg-preview",children:i&&zt.jsx("img",{src:i,alt:"Graph Export"})})}),zt.jsx("div",{className:"popup-footer",children:zt.jsx("button",{className:"popup-button",onClick:n,children:"Download SVG"})})]})}):null},b9=()=>{const t=an(),{annotations:e}=cr(),s=rs.useCallback(async()=>{const a=t.view.getGraphBoundingBox();await t.view.moveToBounds(a.extend(tM(e)),{duration:200})},[t,e]),n=rs.useCallback(async()=>{await t.view.rotate(-Math.PI/8,{duration:200})},[t]),i=rs.useCallback(async()=>{await t.view.rotate(Math.PI/8,{duration:200})},[t]),r=rs.useCallback(a=>{a.stopPropagation(),a.preventDefault()},[]);rs.useEffect(()=>{setTimeout(()=>{},2500)},[t]);const o=16;return zt.jsxs("div",{className:"view-controls",onMouseMove:r,onClick:r,children:[zt.jsx("button",{"data-tooltip":"Center view",onClick:s,children:zt.jsx(e9,{width:o,height:o})}),zt.jsx("span",{className:"separator"}),zt.jsx("button",{"data-tooltip":"Rotate clockwise",onClick:n,children:zt.jsx(h9,{width:o,height:o})}),zt.jsx("button",{"data-tooltip":"Rotate counter-clockwise",onClick:i,children:zt.jsx(u9,{width:o,height:o})})]})},X_=t=>{t.cancelable&&t.stopPropagation()},E9=t=>{const{cancelDrawing:e,remove:s,editor:n}=cr();rs.useEffect(()=>{const i=r=>{if(r.key==="Escape")e();else if(r.key==="Backspace"||r.key==="Delete"){const o=n==null?void 0:n.getSelectedAnnotations();o&&o.features.length>0&&s(o)}else r.key==="0"&&t()};return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}},[e,s,n,t])},S9=({defaultArrowStyle:t={},defaultTextStyle:e={}})=>{const{annotations:s,editor:n}=cr(),i=an(),[r,o]=rs.useState(!1),[a,l]=rs.useState(""),[u,h]=rs.useState(!1),[g,f]=rs.useState(""),p=rs.useCallback(async()=>{try{const L=await i.export.svg({clip:!0,download:!1});l(L),o(!0)}catch(L){console.error("Failed to export SVG:",L)}},[i]),y=rs.useCallback(()=>{o(!1),l("")},[]),_=rs.useCallback(()=>{if(a){const L=new Blob([a],{type:"image/svg+xml"}),I=URL.createObjectURL(L),F=document.createElement("a");document.body.appendChild(F),F.setAttribute("href",I),F.setAttribute("download","graph-with-annotations.svg"),F.click(),F.remove(),URL.revokeObjectURL(I)}},[a]),x=rs.useCallback(()=>{try{const L=n==null?void 0:n.getAnnotations();if(L){const I=JSON.stringify(L,null,2);f(I),h(!0)}}catch(L){console.error("Failed to export JSON:",L)}},[n]),v=rs.useCallback(()=>{h(!1),f("")},[]),b=rs.useCallback(()=>{if(g){const L=new Blob([g],{type:"application/json"}),I=URL.createObjectURL(L),F=document.createElement("a");document.body.appendChild(F),F.setAttribute("href",I),F.setAttribute("download","annotations.json"),F.click(),F.remove(),URL.revokeObjectURL(I)}},[g]),S=rs.useCallback(async()=>{const L=i.view.getGraphBoundingBox();await i.view.moveToBounds(L.extend(tM(s)),{duration:200})},[i,s]);E9(S);const A=rs.useCallback(X_,[]),w=rs.useCallback(L=>(L&&L.element&&L.element.addEventListener("wheel",X_,{passive:!1}),()=>{L.element.removeEventListener("wheel",X_)}),[]);return rs.useEffect(()=>{Object.assign(SM,t),Object.assign(AM,e)},[t,e]),zt.jsxs(zt.Fragment,{children:[zt.jsx(Mg,{className:"controls",ref:w,index:100,children:zt.jsx("div",{className:"container",onMouseMove:A,onClick:A,children:zt.jsx(y9,{onSvgExport:p,onJsonExport:x})})}),zt.jsx(Mg,{className:"view-controls-layer",index:100,children:zt.jsx("div",{className:"view-controls-container",children:zt.jsx(b9,{})})}),zt.jsx(Mg,{className:"svg-popup-layer",index:1e3,children:zt.jsx(v9,{isOpen:r,svgContent:a,onClose:y,onDownload:_})}),zt.jsx(Mg,{className:"json-popup-layer",index:1e3,children:zt.jsx(x9,{isOpen:u,jsonContent:g,onClose:v,onDownload:b})})," "]})};async function A9(){return await D0.parse.jsonFromUrl("./graph.json")}async function w9(){return(await fetch("annotations-test.json")).json()}function T9(){const[t,e]=rs.useState(null),[s,n]=rs.useState(null);return rs.useEffect(()=>{Promise.all([A9(),w9()]).then(([i,r])=>(e(i),n(r))).catch(i=>{console.error("Failed to load graph or annotations:",i)})},[]),!t||!s?zt.jsx("div",{children:"Loading graph..."}):zt.jsx("div",{className:"App",children:zt.jsxs(_Y,{graph:t,onReady:i=>{i.tools.brand.set(`<div class="brand">
              <a href="../react/">
                <code>ogma-annotations-react</code></a> | <a href="https://github.com/linkurious/ogma-annotations-control/tree/develop/packages/ogma-annotations-react/web/">code</a>
            </div>`,{position:"top-left",horizontalMargin:10,verticalMargin:10,className:"brand"})},children:[zt.jsx(bY,{attributes:{color:"#5B97F8"}}),zt.jsx(wY,{attributes:{color:"#C2D7FF"}}),zt.jsxs(I8,{annotations:s,children:[zt.jsx(S9,{minThickness:1,maxThickness:10,defaultArrowStyle:{strokeType:"plain",strokeColor:"#3A03CF",strokeWidth:2,head:"arrow"},defaultTextStyle:{font:"IBM Plex Sans",fontSize:24,color:"#3A03CF",background:"#EDE6FF",borderRadius:8,padding:12}}),zt.jsx(U8,{})]})]})})}GI.createRoot(document.getElementById("root")).render(zt.jsx(T9,{}))});export default C9();
