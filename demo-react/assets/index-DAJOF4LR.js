var zI=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var K9=zI((a7,Pd)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=s(i);fetch(i.href,r)}})();function DI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Pm={exports:{}},ed={},zm={exports:{}},ls={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wb;function OI(){if(Wb)return ls;Wb=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),r=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function f(Q){return Q===null||typeof Q!="object"?null:(Q=g&&Q[g]||Q["@@iterator"],typeof Q=="function"?Q:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,_={};function x(Q,Et,Xt){this.props=Q,this.context=Et,this.refs=_,this.updater=Xt||p}x.prototype.isReactComponent={},x.prototype.setState=function(Q,Et){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,Et,"setState")},x.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function v(){}v.prototype=x.prototype;function b(Q,Et,Xt){this.props=Q,this.context=Et,this.refs=_,this.updater=Xt||p}var S=b.prototype=new v;S.constructor=b,y(S,x.prototype),S.isPureReactComponent=!0;var A=Array.isArray,w=Object.prototype.hasOwnProperty,L={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function F(Q,Et,Xt){var Ht,Zt={},ae=null,pe=null;if(Et!=null)for(Ht in Et.ref!==void 0&&(pe=Et.ref),Et.key!==void 0&&(ae=""+Et.key),Et)w.call(Et,Ht)&&!M.hasOwnProperty(Ht)&&(Zt[Ht]=Et[Ht]);var ne=arguments.length-2;if(ne===1)Zt.children=Xt;else if(1<ne){for(var te=Array(ne),se=0;se<ne;se++)te[se]=arguments[se+2];Zt.children=te}if(Q&&Q.defaultProps)for(Ht in ne=Q.defaultProps,ne)Zt[Ht]===void 0&&(Zt[Ht]=ne[Ht]);return{$$typeof:t,type:Q,key:ae,ref:pe,props:Zt,_owner:L.current}}function O(Q,Et){return{$$typeof:t,type:Q.type,key:Et,ref:Q.ref,props:Q.props,_owner:Q._owner}}function G(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===t}function j(Q){var Et={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(Xt){return Et[Xt]})}var Z=/\/+/g;function at(Q,Et){return typeof Q=="object"&&Q!==null&&Q.key!=null?j(""+Q.key):Et.toString(36)}function pt(Q,Et,Xt,Ht,Zt){var ae=typeof Q;(ae==="undefined"||ae==="boolean")&&(Q=null);var pe=!1;if(Q===null)pe=!0;else switch(ae){case"string":case"number":pe=!0;break;case"object":switch(Q.$$typeof){case t:case e:pe=!0}}if(pe)return pe=Q,Zt=Zt(pe),Q=Ht===""?"."+at(pe,0):Ht,A(Zt)?(Xt="",Q!=null&&(Xt=Q.replace(Z,"$&/")+"/"),pt(Zt,Et,Xt,"",function(se){return se})):Zt!=null&&(G(Zt)&&(Zt=O(Zt,Xt+(!Zt.key||pe&&pe.key===Zt.key?"":(""+Zt.key).replace(Z,"$&/")+"/")+Q)),Et.push(Zt)),1;if(pe=0,Ht=Ht===""?".":Ht+":",A(Q))for(var ne=0;ne<Q.length;ne++){ae=Q[ne];var te=Ht+at(ae,ne);pe+=pt(ae,Et,Xt,te,Zt)}else if(te=f(Q),typeof te=="function")for(Q=te.call(Q),ne=0;!(ae=Q.next()).done;)ae=ae.value,te=Ht+at(ae,ne++),pe+=pt(ae,Et,Xt,te,Zt);else if(ae==="object")throw Et=String(Q),Error("Objects are not valid as a React child (found: "+(Et==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":Et)+"). If you meant to render a collection of children, use an array instead.");return pe}function K(Q,Et,Xt){if(Q==null)return Q;var Ht=[],Zt=0;return pt(Q,Ht,"","",function(ae){return Et.call(Xt,ae,Zt++)}),Ht}function ut(Q){if(Q._status===-1){var Et=Q._result;Et=Et(),Et.then(function(Xt){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=Xt)},function(Xt){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=Xt)}),Q._status===-1&&(Q._status=0,Q._result=Et)}if(Q._status===1)return Q._result.default;throw Q._result}var ht={current:null},nt={transition:null},ot={ReactCurrentDispatcher:ht,ReactCurrentBatchConfig:nt,ReactCurrentOwner:L};function Mt(){throw Error("act(...) is not supported in production builds of React.")}return ls.Children={map:K,forEach:function(Q,Et,Xt){K(Q,function(){Et.apply(this,arguments)},Xt)},count:function(Q){var Et=0;return K(Q,function(){Et++}),Et},toArray:function(Q){return K(Q,function(Et){return Et})||[]},only:function(Q){if(!G(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},ls.Component=x,ls.Fragment=s,ls.Profiler=i,ls.PureComponent=b,ls.StrictMode=n,ls.Suspense=l,ls.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ot,ls.act=Mt,ls.cloneElement=function(Q,Et,Xt){if(Q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Q+".");var Ht=y({},Q.props),Zt=Q.key,ae=Q.ref,pe=Q._owner;if(Et!=null){if(Et.ref!==void 0&&(ae=Et.ref,pe=L.current),Et.key!==void 0&&(Zt=""+Et.key),Q.type&&Q.type.defaultProps)var ne=Q.type.defaultProps;for(te in Et)w.call(Et,te)&&!M.hasOwnProperty(te)&&(Ht[te]=Et[te]===void 0&&ne!==void 0?ne[te]:Et[te])}var te=arguments.length-2;if(te===1)Ht.children=Xt;else if(1<te){ne=Array(te);for(var se=0;se<te;se++)ne[se]=arguments[se+2];Ht.children=ne}return{$$typeof:t,type:Q.type,key:Zt,ref:ae,props:Ht,_owner:pe}},ls.createContext=function(Q){return Q={$$typeof:o,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Q.Provider={$$typeof:r,_context:Q},Q.Consumer=Q},ls.createElement=F,ls.createFactory=function(Q){var Et=F.bind(null,Q);return Et.type=Q,Et},ls.createRef=function(){return{current:null}},ls.forwardRef=function(Q){return{$$typeof:a,render:Q}},ls.isValidElement=G,ls.lazy=function(Q){return{$$typeof:h,_payload:{_status:-1,_result:Q},_init:ut}},ls.memo=function(Q,Et){return{$$typeof:u,type:Q,compare:Et===void 0?null:Et}},ls.startTransition=function(Q){var Et=nt.transition;nt.transition={};try{Q()}finally{nt.transition=Et}},ls.unstable_act=Mt,ls.useCallback=function(Q,Et){return ht.current.useCallback(Q,Et)},ls.useContext=function(Q){return ht.current.useContext(Q)},ls.useDebugValue=function(){},ls.useDeferredValue=function(Q){return ht.current.useDeferredValue(Q)},ls.useEffect=function(Q,Et){return ht.current.useEffect(Q,Et)},ls.useId=function(){return ht.current.useId()},ls.useImperativeHandle=function(Q,Et,Xt){return ht.current.useImperativeHandle(Q,Et,Xt)},ls.useInsertionEffect=function(Q,Et){return ht.current.useInsertionEffect(Q,Et)},ls.useLayoutEffect=function(Q,Et){return ht.current.useLayoutEffect(Q,Et)},ls.useMemo=function(Q,Et){return ht.current.useMemo(Q,Et)},ls.useReducer=function(Q,Et,Xt){return ht.current.useReducer(Q,Et,Xt)},ls.useRef=function(Q){return ht.current.useRef(Q)},ls.useState=function(Q){return ht.current.useState(Q)},ls.useSyncExternalStore=function(Q,Et,Xt){return ht.current.useSyncExternalStore(Q,Et,Xt)},ls.useTransition=function(){return ht.current.useTransition()},ls.version="18.3.1",ls}var Xb;function yh(){return Xb||(Xb=1,zm.exports=OI()),zm.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zb;function BI(){if(Zb)return ed;Zb=1;var t=yh(),e=Symbol.for("react.element"),s=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,u){var h,g={},f=null,p=null;u!==void 0&&(f=""+u),l.key!==void 0&&(f=""+l.key),l.ref!==void 0&&(p=l.ref);for(h in l)n.call(l,h)&&!r.hasOwnProperty(h)&&(g[h]=l[h]);if(a&&a.defaultProps)for(h in l=a.defaultProps,l)g[h]===void 0&&(g[h]=l[h]);return{$$typeof:e,type:a,key:f,ref:p,props:g,_owner:i.current}}return ed.Fragment=s,ed.jsx=o,ed.jsxs=o,ed}var Kb;function UI(){return Kb||(Kb=1,Pm.exports=BI()),Pm.exports}var zt=UI(),Fc={},Dm={exports:{}},pi={},Om={exports:{}},Bm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qb;function GI(){return Qb||(Qb=1,(function(t){function e(nt,ot){var Mt=nt.length;nt.push(ot);t:for(;0<Mt;){var Q=Mt-1>>>1,Et=nt[Q];if(0<i(Et,ot))nt[Q]=ot,nt[Mt]=Et,Mt=Q;else break t}}function s(nt){return nt.length===0?null:nt[0]}function n(nt){if(nt.length===0)return null;var ot=nt[0],Mt=nt.pop();if(Mt!==ot){nt[0]=Mt;t:for(var Q=0,Et=nt.length,Xt=Et>>>1;Q<Xt;){var Ht=2*(Q+1)-1,Zt=nt[Ht],ae=Ht+1,pe=nt[ae];if(0>i(Zt,Mt))ae<Et&&0>i(pe,Zt)?(nt[Q]=pe,nt[ae]=Mt,Q=ae):(nt[Q]=Zt,nt[Ht]=Mt,Q=Ht);else if(ae<Et&&0>i(pe,Mt))nt[Q]=pe,nt[ae]=Mt,Q=ae;else break t}}return ot}function i(nt,ot){var Mt=nt.sortIndex-ot.sortIndex;return Mt!==0?Mt:nt.id-ot.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,g=null,f=3,p=!1,y=!1,_=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(nt){for(var ot=s(u);ot!==null;){if(ot.callback===null)n(u);else if(ot.startTime<=nt)n(u),ot.sortIndex=ot.expirationTime,e(l,ot);else break;ot=s(u)}}function A(nt){if(_=!1,S(nt),!y)if(s(l)!==null)y=!0,ut(w);else{var ot=s(u);ot!==null&&ht(A,ot.startTime-nt)}}function w(nt,ot){y=!1,_&&(_=!1,v(F),F=-1),p=!0;var Mt=f;try{for(S(ot),g=s(l);g!==null&&(!(g.expirationTime>ot)||nt&&!j());){var Q=g.callback;if(typeof Q=="function"){g.callback=null,f=g.priorityLevel;var Et=Q(g.expirationTime<=ot);ot=t.unstable_now(),typeof Et=="function"?g.callback=Et:g===s(l)&&n(l),S(ot)}else n(l);g=s(l)}if(g!==null)var Xt=!0;else{var Ht=s(u);Ht!==null&&ht(A,Ht.startTime-ot),Xt=!1}return Xt}finally{g=null,f=Mt,p=!1}}var L=!1,M=null,F=-1,O=5,G=-1;function j(){return!(t.unstable_now()-G<O)}function Z(){if(M!==null){var nt=t.unstable_now();G=nt;var ot=!0;try{ot=M(!0,nt)}finally{ot?at():(L=!1,M=null)}}else L=!1}var at;if(typeof b=="function")at=function(){b(Z)};else if(typeof MessageChannel<"u"){var pt=new MessageChannel,K=pt.port2;pt.port1.onmessage=Z,at=function(){K.postMessage(null)}}else at=function(){x(Z,0)};function ut(nt){M=nt,L||(L=!0,at())}function ht(nt,ot){F=x(function(){nt(t.unstable_now())},ot)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(nt){nt.callback=null},t.unstable_continueExecution=function(){y||p||(y=!0,ut(w))},t.unstable_forceFrameRate=function(nt){0>nt||125<nt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<nt?Math.floor(1e3/nt):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return s(l)},t.unstable_next=function(nt){switch(f){case 1:case 2:case 3:var ot=3;break;default:ot=f}var Mt=f;f=ot;try{return nt()}finally{f=Mt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(nt,ot){switch(nt){case 1:case 2:case 3:case 4:case 5:break;default:nt=3}var Mt=f;f=nt;try{return ot()}finally{f=Mt}},t.unstable_scheduleCallback=function(nt,ot,Mt){var Q=t.unstable_now();switch(typeof Mt=="object"&&Mt!==null?(Mt=Mt.delay,Mt=typeof Mt=="number"&&0<Mt?Q+Mt:Q):Mt=Q,nt){case 1:var Et=-1;break;case 2:Et=250;break;case 5:Et=1073741823;break;case 4:Et=1e4;break;default:Et=5e3}return Et=Mt+Et,nt={id:h++,callback:ot,priorityLevel:nt,startTime:Mt,expirationTime:Et,sortIndex:-1},Mt>Q?(nt.sortIndex=Mt,e(u,nt),s(l)===null&&nt===s(u)&&(_?(v(F),F=-1):_=!0,ht(A,Mt-Q))):(nt.sortIndex=Et,e(l,nt),y||p||(y=!0,ut(w))),nt},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(nt){var ot=f;return function(){var Mt=f;f=ot;try{return nt.apply(this,arguments)}finally{f=Mt}}}})(Bm)),Bm}var Jb;function VI(){return Jb||(Jb=1,Om.exports=GI()),Om.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tE;function jI(){if(tE)return pi;tE=1;var t=yh(),e=VI();function s(d){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+d,m=1;m<arguments.length;m++)c+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+d+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function r(d,c){o(d,c),o(d+"Capture",c)}function o(d,c){for(i[d]=c,d=0;d<c.length;d++)n.add(c[d])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},g={};function f(d){return l.call(g,d)?!0:l.call(h,d)?!1:u.test(d)?g[d]=!0:(h[d]=!0,!1)}function p(d,c,m,E){if(m!==null&&m.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return E?!1:m!==null?!m.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function y(d,c,m,E){if(c===null||typeof c>"u"||p(d,c,m,E))return!0;if(E)return!1;if(m!==null)switch(m.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function _(d,c,m,E,T,I,V){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=E,this.attributeNamespace=T,this.mustUseProperty=m,this.propertyName=d,this.type=c,this.sanitizeURL=I,this.removeEmptyString=V}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){x[d]=new _(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var c=d[0];x[c]=new _(c,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){x[d]=new _(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){x[d]=new _(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){x[d]=new _(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){x[d]=new _(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){x[d]=new _(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){x[d]=new _(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){x[d]=new _(d,5,!1,d.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function b(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var c=d.replace(v,b);x[c]=new _(c,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var c=d.replace(v,b);x[c]=new _(c,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var c=d.replace(v,b);x[c]=new _(c,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){x[d]=new _(d,1,!1,d.toLowerCase(),null,!1,!1)}),x.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){x[d]=new _(d,1,!1,d.toLowerCase(),null,!0,!0)});function S(d,c,m,E){var T=x.hasOwnProperty(c)?x[c]:null;(T!==null?T.type!==0:E||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(y(c,m,T,E)&&(m=null),E||T===null?f(c)&&(m===null?d.removeAttribute(c):d.setAttribute(c,""+m)):T.mustUseProperty?d[T.propertyName]=m===null?T.type===3?!1:"":m:(c=T.attributeName,E=T.attributeNamespace,m===null?d.removeAttribute(c):(T=T.type,m=T===3||T===4&&m===!0?"":""+m,E?d.setAttributeNS(E,c,m):d.setAttribute(c,m))))}var A=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),L=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),G=Symbol.for("react.provider"),j=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),at=Symbol.for("react.suspense"),pt=Symbol.for("react.suspense_list"),K=Symbol.for("react.memo"),ut=Symbol.for("react.lazy"),ht=Symbol.for("react.offscreen"),nt=Symbol.iterator;function ot(d){return d===null||typeof d!="object"?null:(d=nt&&d[nt]||d["@@iterator"],typeof d=="function"?d:null)}var Mt=Object.assign,Q;function Et(d){if(Q===void 0)try{throw Error()}catch(m){var c=m.stack.trim().match(/\n( *(at )?)/);Q=c&&c[1]||""}return`
`+Q+d}var Xt=!1;function Ht(d,c){if(!d||Xt)return"";Xt=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Vt){var E=Vt}Reflect.construct(d,[],c)}else{try{c.call()}catch(Vt){E=Vt}d.call(c.prototype)}else{try{throw Error()}catch(Vt){E=Vt}d()}}catch(Vt){if(Vt&&E&&typeof Vt.stack=="string"){for(var T=Vt.stack.split(`
`),I=E.stack.split(`
`),V=T.length-1,rt=I.length-1;1<=V&&0<=rt&&T[V]!==I[rt];)rt--;for(;1<=V&&0<=rt;V--,rt--)if(T[V]!==I[rt]){if(V!==1||rt!==1)do if(V--,rt--,0>rt||T[V]!==I[rt]){var xt=`
`+T[V].replace(" at new "," at ");return d.displayName&&xt.includes("<anonymous>")&&(xt=xt.replace("<anonymous>",d.displayName)),xt}while(1<=V&&0<=rt);break}}}finally{Xt=!1,Error.prepareStackTrace=m}return(d=d?d.displayName||d.name:"")?Et(d):""}function Zt(d){switch(d.tag){case 5:return Et(d.type);case 16:return Et("Lazy");case 13:return Et("Suspense");case 19:return Et("SuspenseList");case 0:case 2:case 15:return d=Ht(d.type,!1),d;case 11:return d=Ht(d.type.render,!1),d;case 1:return d=Ht(d.type,!0),d;default:return""}}function ae(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case M:return"Fragment";case L:return"Portal";case O:return"Profiler";case F:return"StrictMode";case at:return"Suspense";case pt:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case j:return(d.displayName||"Context")+".Consumer";case G:return(d._context.displayName||"Context")+".Provider";case Z:var c=d.render;return d=d.displayName,d||(d=c.displayName||c.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case K:return c=d.displayName||null,c!==null?c:ae(d.type)||"Memo";case ut:c=d._payload,d=d._init;try{return ae(d(c))}catch{}}return null}function pe(d){var c=d.type;switch(d.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=c.render,d=d.displayName||d.name||"",c.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ae(c);case 8:return c===F?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function ne(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function te(d){var c=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function se(d){var c=te(d)?"checked":"value",m=Object.getOwnPropertyDescriptor(d.constructor.prototype,c),E=""+d[c];if(!d.hasOwnProperty(c)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var T=m.get,I=m.set;return Object.defineProperty(d,c,{configurable:!0,get:function(){return T.call(this)},set:function(V){E=""+V,I.call(this,V)}}),Object.defineProperty(d,c,{enumerable:m.enumerable}),{getValue:function(){return E},setValue:function(V){E=""+V},stopTracking:function(){d._valueTracker=null,delete d[c]}}}}function ce(d){d._valueTracker||(d._valueTracker=se(d))}function Ce(d){if(!d)return!1;var c=d._valueTracker;if(!c)return!0;var m=c.getValue(),E="";return d&&(E=te(d)?d.checked?"true":"false":d.value),d=E,d!==m?(c.setValue(d),!0):!1}function ve(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function Me(d,c){var m=c.checked;return Mt({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??d._wrapperState.initialChecked})}function ge(d,c){var m=c.defaultValue==null?"":c.defaultValue,E=c.checked!=null?c.checked:c.defaultChecked;m=ne(c.value!=null?c.value:m),d._wrapperState={initialChecked:E,initialValue:m,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function ze(d,c){c=c.checked,c!=null&&S(d,"checked",c,!1)}function is(d,c){ze(d,c);var m=ne(c.value),E=c.type;if(m!=null)E==="number"?(m===0&&d.value===""||d.value!=m)&&(d.value=""+m):d.value!==""+m&&(d.value=""+m);else if(E==="submit"||E==="reset"){d.removeAttribute("value");return}c.hasOwnProperty("value")?De(d,c.type,m):c.hasOwnProperty("defaultValue")&&De(d,c.type,ne(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(d.defaultChecked=!!c.defaultChecked)}function Ge(d,c,m){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var E=c.type;if(!(E!=="submit"&&E!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+d._wrapperState.initialValue,m||c===d.value||(d.value=c),d.defaultValue=c}m=d.name,m!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,m!==""&&(d.name=m)}function De(d,c,m){(c!=="number"||ve(d.ownerDocument)!==d)&&(m==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+m&&(d.defaultValue=""+m))}var He=Array.isArray;function Je(d,c,m,E){if(d=d.options,c){c={};for(var T=0;T<m.length;T++)c["$"+m[T]]=!0;for(m=0;m<d.length;m++)T=c.hasOwnProperty("$"+d[m].value),d[m].selected!==T&&(d[m].selected=T),T&&E&&(d[m].defaultSelected=!0)}else{for(m=""+ne(m),c=null,T=0;T<d.length;T++){if(d[T].value===m){d[T].selected=!0,E&&(d[T].defaultSelected=!0);return}c!==null||d[T].disabled||(c=d[T])}c!==null&&(c.selected=!0)}}function ss(d,c){if(c.dangerouslySetInnerHTML!=null)throw Error(s(91));return Mt({},c,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function ts(d,c){var m=c.value;if(m==null){if(m=c.children,c=c.defaultValue,m!=null){if(c!=null)throw Error(s(92));if(He(m)){if(1<m.length)throw Error(s(93));m=m[0]}c=m}c==null&&(c=""),m=c}d._wrapperState={initialValue:ne(m)}}function hs(d,c){var m=ne(c.value),E=ne(c.defaultValue);m!=null&&(m=""+m,m!==d.value&&(d.value=m),c.defaultValue==null&&d.defaultValue!==m&&(d.defaultValue=m)),E!=null&&(d.defaultValue=""+E)}function Fe(d){var c=d.textContent;c===d._wrapperState.initialValue&&c!==""&&c!==null&&(d.value=c)}function Oe(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ns(d,c){return d==null||d==="http://www.w3.org/1999/xhtml"?Oe(c):d==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var zs,$s=(function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,m,E,T){MSApp.execUnsafeLocalFunction(function(){return d(c,m,E,T)})}:d})(function(d,c){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=c;else{for(zs=zs||document.createElement("div"),zs.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=zs.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;c.firstChild;)d.appendChild(c.firstChild)}});function Ms(d,c){if(c){var m=d.firstChild;if(m&&m===d.lastChild&&m.nodeType===3){m.nodeValue=c;return}}d.textContent=c}var An={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fn=["Webkit","ms","Moz","O"];Object.keys(An).forEach(function(d){fn.forEach(function(c){c=c+d.charAt(0).toUpperCase()+d.substring(1),An[c]=An[d]})});function un(d,c,m){return c==null||typeof c=="boolean"||c===""?"":m||typeof c!="number"||c===0||An.hasOwnProperty(d)&&An[d]?(""+c).trim():c+"px"}function xs(d,c){d=d.style;for(var m in c)if(c.hasOwnProperty(m)){var E=m.indexOf("--")===0,T=un(m,c[m],E);m==="float"&&(m="cssFloat"),E?d.setProperty(m,T):d[m]=T}}var Ds=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gt(d,c){if(c){if(Ds[d]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(s(137,d));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(s(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(s(61))}if(c.style!=null&&typeof c.style!="object")throw Error(s(62))}}function k(d,c){if(d.indexOf("-")===-1)return typeof c.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var P=null;function D(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var B=null,$=null,H=null;function X(d){if(d=Uu(d)){if(typeof B!="function")throw Error(s(280));var c=d.stateNode;c&&(c=Xh(c),B(d.stateNode,d.type,c))}}function lt(d){$?H?H.push(d):H=[d]:$=d}function dt(){if($){var d=$,c=H;if(H=$=null,X(d),c)for(d=0;d<c.length;d++)X(c[d])}}function ct(d,c){return d(c)}function mt(){}var yt=!1;function Nt(d,c,m){if(yt)return d(c,m);yt=!0;try{return ct(d,c,m)}finally{yt=!1,($!==null||H!==null)&&(mt(),dt())}}function Tt(d,c){var m=d.stateNode;if(m===null)return null;var E=Xh(m);if(E===null)return null;m=E[c];t:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(E=!E.disabled)||(d=d.type,E=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!E;break t;default:d=!1}if(d)return null;if(m&&typeof m!="function")throw Error(s(231,c,typeof m));return m}var At=!1;if(a)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){At=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch{At=!1}function he(d,c,m,E,T,I,V,rt,xt){var Vt=Array.prototype.slice.call(arguments,3);try{c.apply(m,Vt)}catch(de){this.onError(de)}}var xe=!1,be=null,ue=!1,_e=null,Te={onError:function(d){xe=!0,be=d}};function Ve(d,c,m,E,T,I,V,rt,xt){xe=!1,be=null,he.apply(Te,arguments)}function Ie(d,c,m,E,T,I,V,rt,xt){if(Ve.apply(this,arguments),xe){if(xe){var Vt=be;xe=!1,be=null}else throw Error(s(198));ue||(ue=!0,_e=Vt)}}function je(d){var c=d,m=d;if(d.alternate)for(;c.return;)c=c.return;else{d=c;do c=d,(c.flags&4098)!==0&&(m=c.return),d=c.return;while(d)}return c.tag===3?m:null}function Pe(d){if(d.tag===13){var c=d.memoizedState;if(c===null&&(d=d.alternate,d!==null&&(c=d.memoizedState)),c!==null)return c.dehydrated}return null}function Be(d){if(je(d)!==d)throw Error(s(188))}function Ue(d){var c=d.alternate;if(!c){if(c=je(d),c===null)throw Error(s(188));return c!==d?null:d}for(var m=d,E=c;;){var T=m.return;if(T===null)break;var I=T.alternate;if(I===null){if(E=T.return,E!==null){m=E;continue}break}if(T.child===I.child){for(I=T.child;I;){if(I===m)return Be(T),d;if(I===E)return Be(T),c;I=I.sibling}throw Error(s(188))}if(m.return!==E.return)m=T,E=I;else{for(var V=!1,rt=T.child;rt;){if(rt===m){V=!0,m=T,E=I;break}if(rt===E){V=!0,E=T,m=I;break}rt=rt.sibling}if(!V){for(rt=I.child;rt;){if(rt===m){V=!0,m=I,E=T;break}if(rt===E){V=!0,E=I,m=T;break}rt=rt.sibling}if(!V)throw Error(s(189))}}if(m.alternate!==E)throw Error(s(190))}if(m.tag!==3)throw Error(s(188));return m.stateNode.current===m?d:c}function es(d){return d=Ue(d),d!==null?os(d):null}function os(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var c=os(d);if(c!==null)return c;d=d.sibling}return null}var cs=e.unstable_scheduleCallback,Y=e.unstable_cancelCallback,et=e.unstable_shouldYield,J=e.unstable_requestPaint,tt=e.unstable_now,ft=e.unstable_getCurrentPriorityLevel,_t=e.unstable_ImmediatePriority,it=e.unstable_UserBlockingPriority,vt=e.unstable_NormalPriority,Ct=e.unstable_LowPriority,Ft=e.unstable_IdlePriority,Pt=null,Lt=null;function Yt(d){if(Lt&&typeof Lt.onCommitFiberRoot=="function")try{Lt.onCommitFiberRoot(Pt,d,void 0,(d.current.flags&128)===128)}catch{}}var $t=Math.clz32?Math.clz32:qt,Bt=Math.log,Gt=Math.LN2;function qt(d){return d>>>=0,d===0?32:31-(Bt(d)/Gt|0)|0}var Kt=64,ee=4194304;function oe(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function re(d,c){var m=d.pendingLanes;if(m===0)return 0;var E=0,T=d.suspendedLanes,I=d.pingedLanes,V=m&268435455;if(V!==0){var rt=V&~T;rt!==0?E=oe(rt):(I&=V,I!==0&&(E=oe(I)))}else V=m&~T,V!==0?E=oe(V):I!==0&&(E=oe(I));if(E===0)return 0;if(c!==0&&c!==E&&(c&T)===0&&(T=E&-E,I=c&-c,T>=I||T===16&&(I&4194240)!==0))return c;if((E&4)!==0&&(E|=m&16),c=d.entangledLanes,c!==0)for(d=d.entanglements,c&=E;0<c;)m=31-$t(c),T=1<<m,E|=d[m],c&=~T;return E}function C(d,c){switch(d){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function R(d,c){for(var m=d.suspendedLanes,E=d.pingedLanes,T=d.expirationTimes,I=d.pendingLanes;0<I;){var V=31-$t(I),rt=1<<V,xt=T[V];xt===-1?((rt&m)===0||(rt&E)!==0)&&(T[V]=C(rt,c)):xt<=c&&(d.expiredLanes|=rt),I&=~rt}}function U(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function W(){var d=Kt;return Kt<<=1,(Kt&4194240)===0&&(Kt=64),d}function St(d){for(var c=[],m=0;31>m;m++)c.push(d);return c}function bt(d,c,m){d.pendingLanes|=c,c!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,c=31-$t(c),d[c]=m}function It(d,c){var m=d.pendingLanes&~c;d.pendingLanes=c,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=c,d.mutableReadLanes&=c,d.entangledLanes&=c,c=d.entanglements;var E=d.eventTimes;for(d=d.expirationTimes;0<m;){var T=31-$t(m),I=1<<T;c[T]=0,E[T]=-1,d[T]=-1,m&=~I}}function Qt(d,c){var m=d.entangledLanes|=c;for(d=d.entanglements;m;){var E=31-$t(m),T=1<<E;T&c|d[E]&c&&(d[E]|=c),m&=~T}}var ie=0;function Ee(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var we,We,us,ms,ds,ks=!1,gs=[],Is=null,pn=null,Ss=null,Os=new Map,yn=new Map,en=[],Ks="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bs(d,c){switch(d){case"focusin":case"focusout":Is=null;break;case"dragenter":case"dragleave":pn=null;break;case"mouseover":case"mouseout":Ss=null;break;case"pointerover":case"pointerout":Os.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":yn.delete(c.pointerId)}}function wn(d,c,m,E,T,I){return d===null||d.nativeEvent!==I?(d={blockedOn:c,domEventName:m,eventSystemFlags:E,nativeEvent:I,targetContainers:[T]},c!==null&&(c=Uu(c),c!==null&&We(c)),d):(d.eventSystemFlags|=E,c=d.targetContainers,T!==null&&c.indexOf(T)===-1&&c.push(T),d)}function Zi(d,c,m,E,T){switch(c){case"focusin":return Is=wn(Is,d,c,m,E,T),!0;case"dragenter":return pn=wn(pn,d,c,m,E,T),!0;case"mouseover":return Ss=wn(Ss,d,c,m,E,T),!0;case"pointerover":var I=T.pointerId;return Os.set(I,wn(Os.get(I)||null,d,c,m,E,T)),!0;case"gotpointercapture":return I=T.pointerId,yn.set(I,wn(yn.get(I)||null,d,c,m,E,T)),!0}return!1}function Mn(d){var c=da(d.target);if(c!==null){var m=je(c);if(m!==null){if(c=m.tag,c===13){if(c=Pe(m),c!==null){d.blockedOn=c,ds(d.priority,function(){us(m)});return}}else if(c===3&&m.stateNode.current.memoizedState.isDehydrated){d.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Ki(d){if(d.blockedOn!==null)return!1;for(var c=d.targetContainers;0<c.length;){var m=ia(d.domEventName,d.eventSystemFlags,c[0],d.nativeEvent);if(m===null){m=d.nativeEvent;var E=new m.constructor(m.type,m);P=E,m.target.dispatchEvent(E),P=null}else return c=Uu(m),c!==null&&We(c),d.blockedOn=m,!1;c.shift()}return!0}function pr(d,c,m){Ki(d)&&m.delete(c)}function vs(){ks=!1,Is!==null&&Ki(Is)&&(Is=null),pn!==null&&Ki(pn)&&(pn=null),Ss!==null&&Ki(Ss)&&(Ss=null),Os.forEach(pr),yn.forEach(pr)}function Qi(d,c){d.blockedOn===c&&(d.blockedOn=null,ks||(ks=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,vs)))}function mr(d){function c(T){return Qi(T,d)}if(0<gs.length){Qi(gs[0],d);for(var m=1;m<gs.length;m++){var E=gs[m];E.blockedOn===d&&(E.blockedOn=null)}}for(Is!==null&&Qi(Is,d),pn!==null&&Qi(pn,d),Ss!==null&&Qi(Ss,d),Os.forEach(c),yn.forEach(c),m=0;m<en.length;m++)E=en[m],E.blockedOn===d&&(E.blockedOn=null);for(;0<en.length&&(m=en[0],m.blockedOn===null);)Mn(m),m.blockedOn===null&&en.shift()}var Ri=A.ReactCurrentBatchConfig,Ei=!0;function Ja(d,c,m,E){var T=ie,I=Ri.transition;Ri.transition=null;try{ie=1,tl(d,c,m,E)}finally{ie=T,Ri.transition=I}}function Rr(d,c,m,E){var T=ie,I=Ri.transition;Ri.transition=null;try{ie=4,tl(d,c,m,E)}finally{ie=T,Ri.transition=I}}function tl(d,c,m,E){if(Ei){var T=ia(d,c,m,E);if(T===null)wp(d,c,E,fo,m),Bs(d,E);else if(Zi(T,d,c,m,E))E.stopPropagation();else if(Bs(d,E),c&4&&-1<Ks.indexOf(d)){for(;T!==null;){var I=Uu(T);if(I!==null&&we(I),I=ia(d,c,m,E),I===null&&wp(d,c,E,fo,m),I===T)break;T=I}T!==null&&E.stopPropagation()}else wp(d,c,E,null,m)}}var fo=null;function ia(d,c,m,E){if(fo=null,d=D(E),d=da(d),d!==null)if(c=je(d),c===null)d=null;else if(m=c.tag,m===13){if(d=Pe(c),d!==null)return d;d=null}else if(m===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;d=null}else c!==d&&(d=null);return fo=d,null}function Au(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ft()){case _t:return 1;case it:return 4;case vt:case Ct:return 16;case Ft:return 536870912;default:return 16}default:return 16}}var Ji=null,el=null,sl=null;function Ph(){if(sl)return sl;var d,c=el,m=c.length,E,T="value"in Ji?Ji.value:Ji.textContent,I=T.length;for(d=0;d<m&&c[d]===T[d];d++);var V=m-d;for(E=1;E<=V&&c[m-E]===T[I-E];E++);return sl=T.slice(d,1<E?1-E:void 0)}function Fr(d){var c=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&c===13&&(d=13)):d=c,d===10&&(d=13),32<=d||d===13?d:0}function ra(){return!0}function oa(){return!1}function kn(d){function c(m,E,T,I,V){this._reactName=m,this._targetInst=T,this.type=E,this.nativeEvent=I,this.target=V,this.currentTarget=null;for(var rt in d)d.hasOwnProperty(rt)&&(m=d[rt],this[rt]=m?m(I):I[rt]);return this.isDefaultPrevented=(I.defaultPrevented!=null?I.defaultPrevented:I.returnValue===!1)?ra:oa,this.isPropagationStopped=oa,this}return Mt(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=ra)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=ra)},persist:function(){},isPersistent:ra}),c}var po={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pr=kn(po),aa=Mt({},po,{view:0,detail:0}),wu=kn(aa),mo,zr,_r,la=Mt({},aa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:al,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==_r&&(_r&&d.type==="mousemove"?(mo=d.screenX-_r.screenX,zr=d.screenY-_r.screenY):zr=mo=0,_r=d),mo)},movementY:function(d){return"movementY"in d?d.movementY:zr}}),Tu=kn(la),zh=Mt({},la,{dataTransfer:0}),Cu=kn(zh),Zn=Mt({},aa,{relatedTarget:0}),nl=kn(Zn),Lu=Mt({},po,{animationName:0,elapsedTime:0,pseudoElement:0}),pp=kn(Lu),Dh=Mt({},po,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),il=kn(Dh),Oh=Mt({},po,{data:0}),Nu=kn(Oh),rl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ol={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Uh(d){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(d):(d=Bh[d])?!!c[d]:!1}function al(){return Uh}var Mu=Mt({},aa,{key:function(d){if(d.key){var c=rl[d.key]||d.key;if(c!=="Unidentified")return c}return d.type==="keypress"?(d=Fr(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?ol[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:al,charCode:function(d){return d.type==="keypress"?Fr(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?Fr(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Gh=kn(Mu),N=Mt({},la,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),z=kn(N),q=Mt({},aa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:al}),st=kn(q),Ot=Mt({},po,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rt=kn(Ot),Jt=Mt({},la,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),me=kn(Jt),Ye=[9,13,27,32],ns=a&&"CompositionEvent"in window,Ze=null;a&&"documentMode"in document&&(Ze=document.documentMode);var ws=a&&"TextEvent"in window&&!Ze,zn=a&&(!ns||Ze&&8<Ze&&11>=Ze),li=" ",ui=!1;function ua(d,c){switch(d){case"keyup":return Ye.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ku(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var yr=!1;function Rk(d,c){switch(d){case"compositionend":return ku(c);case"keypress":return c.which!==32?null:(ui=!0,li);case"textInput":return d=c.data,d===li&&ui?null:d;default:return null}}function Fk(d,c){if(yr)return d==="compositionend"||!ns&&ua(d,c)?(d=Ph(),sl=el=Ji=null,yr=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return zn&&c.locale!=="ko"?null:c.data;default:return null}}var Pk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $0(d){var c=d&&d.nodeName&&d.nodeName.toLowerCase();return c==="input"?!!Pk[d.type]:c==="textarea"}function q0(d,c,m,E){lt(E),c=qh(c,"onChange"),0<c.length&&(m=new Pr("onChange","change",null,m,E),d.push({event:m,listeners:c}))}var Iu=null,Ru=null;function zk(d){dv(d,0)}function Vh(d){var c=cl(d);if(Ce(c))return d}function Dk(d,c){if(d==="change")return c}var Y0=!1;if(a){var mp;if(a){var _p="oninput"in document;if(!_p){var W0=document.createElement("div");W0.setAttribute("oninput","return;"),_p=typeof W0.oninput=="function"}mp=_p}else mp=!1;Y0=mp&&(!document.documentMode||9<document.documentMode)}function X0(){Iu&&(Iu.detachEvent("onpropertychange",Z0),Ru=Iu=null)}function Z0(d){if(d.propertyName==="value"&&Vh(Ru)){var c=[];q0(c,Ru,d,D(d)),Nt(zk,c)}}function Ok(d,c,m){d==="focusin"?(X0(),Iu=c,Ru=m,Iu.attachEvent("onpropertychange",Z0)):d==="focusout"&&X0()}function Bk(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return Vh(Ru)}function Uk(d,c){if(d==="click")return Vh(c)}function Gk(d,c){if(d==="input"||d==="change")return Vh(c)}function Vk(d,c){return d===c&&(d!==0||1/d===1/c)||d!==d&&c!==c}var tr=typeof Object.is=="function"?Object.is:Vk;function Fu(d,c){if(tr(d,c))return!0;if(typeof d!="object"||d===null||typeof c!="object"||c===null)return!1;var m=Object.keys(d),E=Object.keys(c);if(m.length!==E.length)return!1;for(E=0;E<m.length;E++){var T=m[E];if(!l.call(c,T)||!tr(d[T],c[T]))return!1}return!0}function K0(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function Q0(d,c){var m=K0(d);d=0;for(var E;m;){if(m.nodeType===3){if(E=d+m.textContent.length,d<=c&&E>=c)return{node:m,offset:c-d};d=E}t:{for(;m;){if(m.nextSibling){m=m.nextSibling;break t}m=m.parentNode}m=void 0}m=K0(m)}}function J0(d,c){return d&&c?d===c?!0:d&&d.nodeType===3?!1:c&&c.nodeType===3?J0(d,c.parentNode):"contains"in d?d.contains(c):d.compareDocumentPosition?!!(d.compareDocumentPosition(c)&16):!1:!1}function tv(){for(var d=window,c=ve();c instanceof d.HTMLIFrameElement;){try{var m=typeof c.contentWindow.location.href=="string"}catch{m=!1}if(m)d=c.contentWindow;else break;c=ve(d.document)}return c}function yp(d){var c=d&&d.nodeName&&d.nodeName.toLowerCase();return c&&(c==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||c==="textarea"||d.contentEditable==="true")}function jk(d){var c=tv(),m=d.focusedElem,E=d.selectionRange;if(c!==m&&m&&m.ownerDocument&&J0(m.ownerDocument.documentElement,m)){if(E!==null&&yp(m)){if(c=E.start,d=E.end,d===void 0&&(d=c),"selectionStart"in m)m.selectionStart=c,m.selectionEnd=Math.min(d,m.value.length);else if(d=(c=m.ownerDocument||document)&&c.defaultView||window,d.getSelection){d=d.getSelection();var T=m.textContent.length,I=Math.min(E.start,T);E=E.end===void 0?I:Math.min(E.end,T),!d.extend&&I>E&&(T=E,E=I,I=T),T=Q0(m,I);var V=Q0(m,E);T&&V&&(d.rangeCount!==1||d.anchorNode!==T.node||d.anchorOffset!==T.offset||d.focusNode!==V.node||d.focusOffset!==V.offset)&&(c=c.createRange(),c.setStart(T.node,T.offset),d.removeAllRanges(),I>E?(d.addRange(c),d.extend(V.node,V.offset)):(c.setEnd(V.node,V.offset),d.addRange(c)))}}for(c=[],d=m;d=d.parentNode;)d.nodeType===1&&c.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<c.length;m++)d=c[m],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var Hk=a&&"documentMode"in document&&11>=document.documentMode,ll=null,xp=null,Pu=null,vp=!1;function ev(d,c,m){var E=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;vp||ll==null||ll!==ve(E)||(E=ll,"selectionStart"in E&&yp(E)?E={start:E.selectionStart,end:E.selectionEnd}:(E=(E.ownerDocument&&E.ownerDocument.defaultView||window).getSelection(),E={anchorNode:E.anchorNode,anchorOffset:E.anchorOffset,focusNode:E.focusNode,focusOffset:E.focusOffset}),Pu&&Fu(Pu,E)||(Pu=E,E=qh(xp,"onSelect"),0<E.length&&(c=new Pr("onSelect","select",null,c,m),d.push({event:c,listeners:E}),c.target=ll)))}function jh(d,c){var m={};return m[d.toLowerCase()]=c.toLowerCase(),m["Webkit"+d]="webkit"+c,m["Moz"+d]="moz"+c,m}var ul={animationend:jh("Animation","AnimationEnd"),animationiteration:jh("Animation","AnimationIteration"),animationstart:jh("Animation","AnimationStart"),transitionend:jh("Transition","TransitionEnd")},bp={},sv={};a&&(sv=document.createElement("div").style,"AnimationEvent"in window||(delete ul.animationend.animation,delete ul.animationiteration.animation,delete ul.animationstart.animation),"TransitionEvent"in window||delete ul.transitionend.transition);function Hh(d){if(bp[d])return bp[d];if(!ul[d])return d;var c=ul[d],m;for(m in c)if(c.hasOwnProperty(m)&&m in sv)return bp[d]=c[m];return d}var nv=Hh("animationend"),iv=Hh("animationiteration"),rv=Hh("animationstart"),ov=Hh("transitionend"),av=new Map,lv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _o(d,c){av.set(d,c),r(c,[d])}for(var Ep=0;Ep<lv.length;Ep++){var Sp=lv[Ep],$k=Sp.toLowerCase(),qk=Sp[0].toUpperCase()+Sp.slice(1);_o($k,"on"+qk)}_o(nv,"onAnimationEnd"),_o(iv,"onAnimationIteration"),_o(rv,"onAnimationStart"),_o("dblclick","onDoubleClick"),_o("focusin","onFocus"),_o("focusout","onBlur"),_o(ov,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),r("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),r("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),r("onBeforeInput",["compositionend","keypress","textInput","paste"]),r("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yk=new Set("cancel close invalid load scroll toggle".split(" ").concat(zu));function uv(d,c,m){var E=d.type||"unknown-event";d.currentTarget=m,Ie(E,c,void 0,d),d.currentTarget=null}function dv(d,c){c=(c&4)!==0;for(var m=0;m<d.length;m++){var E=d[m],T=E.event;E=E.listeners;t:{var I=void 0;if(c)for(var V=E.length-1;0<=V;V--){var rt=E[V],xt=rt.instance,Vt=rt.currentTarget;if(rt=rt.listener,xt!==I&&T.isPropagationStopped())break t;uv(T,rt,Vt),I=xt}else for(V=0;V<E.length;V++){if(rt=E[V],xt=rt.instance,Vt=rt.currentTarget,rt=rt.listener,xt!==I&&T.isPropagationStopped())break t;uv(T,rt,Vt),I=xt}}}if(ue)throw d=_e,ue=!1,_e=null,d}function Us(d,c){var m=c[kp];m===void 0&&(m=c[kp]=new Set);var E=d+"__bubble";m.has(E)||(hv(c,d,2,!1),m.add(E))}function Ap(d,c,m){var E=0;c&&(E|=4),hv(m,d,E,c)}var $h="_reactListening"+Math.random().toString(36).slice(2);function Du(d){if(!d[$h]){d[$h]=!0,n.forEach(function(m){m!=="selectionchange"&&(Yk.has(m)||Ap(m,!1,d),Ap(m,!0,d))});var c=d.nodeType===9?d:d.ownerDocument;c===null||c[$h]||(c[$h]=!0,Ap("selectionchange",!1,c))}}function hv(d,c,m,E){switch(Au(c)){case 1:var T=Ja;break;case 4:T=Rr;break;default:T=tl}m=T.bind(null,c,m,d),T=void 0,!At||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(T=!0),E?T!==void 0?d.addEventListener(c,m,{capture:!0,passive:T}):d.addEventListener(c,m,!0):T!==void 0?d.addEventListener(c,m,{passive:T}):d.addEventListener(c,m,!1)}function wp(d,c,m,E,T){var I=E;if((c&1)===0&&(c&2)===0&&E!==null)t:for(;;){if(E===null)return;var V=E.tag;if(V===3||V===4){var rt=E.stateNode.containerInfo;if(rt===T||rt.nodeType===8&&rt.parentNode===T)break;if(V===4)for(V=E.return;V!==null;){var xt=V.tag;if((xt===3||xt===4)&&(xt=V.stateNode.containerInfo,xt===T||xt.nodeType===8&&xt.parentNode===T))return;V=V.return}for(;rt!==null;){if(V=da(rt),V===null)return;if(xt=V.tag,xt===5||xt===6){E=I=V;continue t}rt=rt.parentNode}}E=E.return}Nt(function(){var Vt=I,de=D(m),fe=[];t:{var le=av.get(d);if(le!==void 0){var Ae=Pr,Ne=d;switch(d){case"keypress":if(Fr(m)===0)break t;case"keydown":case"keyup":Ae=Gh;break;case"focusin":Ne="focus",Ae=nl;break;case"focusout":Ne="blur",Ae=nl;break;case"beforeblur":case"afterblur":Ae=nl;break;case"click":if(m.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ae=Tu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ae=Cu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ae=st;break;case nv:case iv:case rv:Ae=pp;break;case ov:Ae=Rt;break;case"scroll":Ae=wu;break;case"wheel":Ae=me;break;case"copy":case"cut":case"paste":Ae=il;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ae=z}var ke=(c&4)!==0,dn=!ke&&d==="scroll",kt=ke?le!==null?le+"Capture":null:le;ke=[];for(var wt=Vt,Dt;wt!==null;){Dt=wt;var ye=Dt.stateNode;if(Dt.tag===5&&ye!==null&&(Dt=ye,kt!==null&&(ye=Tt(wt,kt),ye!=null&&ke.push(Ou(wt,ye,Dt)))),dn)break;wt=wt.return}0<ke.length&&(le=new Ae(le,Ne,null,m,de),fe.push({event:le,listeners:ke}))}}if((c&7)===0){t:{if(le=d==="mouseover"||d==="pointerover",Ae=d==="mouseout"||d==="pointerout",le&&m!==P&&(Ne=m.relatedTarget||m.fromElement)&&(da(Ne)||Ne[Dr]))break t;if((Ae||le)&&(le=de.window===de?de:(le=de.ownerDocument)?le.defaultView||le.parentWindow:window,Ae?(Ne=m.relatedTarget||m.toElement,Ae=Vt,Ne=Ne?da(Ne):null,Ne!==null&&(dn=je(Ne),Ne!==dn||Ne.tag!==5&&Ne.tag!==6)&&(Ne=null)):(Ae=null,Ne=Vt),Ae!==Ne)){if(ke=Tu,ye="onMouseLeave",kt="onMouseEnter",wt="mouse",(d==="pointerout"||d==="pointerover")&&(ke=z,ye="onPointerLeave",kt="onPointerEnter",wt="pointer"),dn=Ae==null?le:cl(Ae),Dt=Ne==null?le:cl(Ne),le=new ke(ye,wt+"leave",Ae,m,de),le.target=dn,le.relatedTarget=Dt,ye=null,da(de)===Vt&&(ke=new ke(kt,wt+"enter",Ne,m,de),ke.target=Dt,ke.relatedTarget=dn,ye=ke),dn=ye,Ae&&Ne)e:{for(ke=Ae,kt=Ne,wt=0,Dt=ke;Dt;Dt=dl(Dt))wt++;for(Dt=0,ye=kt;ye;ye=dl(ye))Dt++;for(;0<wt-Dt;)ke=dl(ke),wt--;for(;0<Dt-wt;)kt=dl(kt),Dt--;for(;wt--;){if(ke===kt||kt!==null&&ke===kt.alternate)break e;ke=dl(ke),kt=dl(kt)}ke=null}else ke=null;Ae!==null&&cv(fe,le,Ae,ke,!1),Ne!==null&&dn!==null&&cv(fe,dn,Ne,ke,!0)}}t:{if(le=Vt?cl(Vt):window,Ae=le.nodeName&&le.nodeName.toLowerCase(),Ae==="select"||Ae==="input"&&le.type==="file")var Re=Dk;else if($0(le))if(Y0)Re=Gk;else{Re=Bk;var $e=Ok}else(Ae=le.nodeName)&&Ae.toLowerCase()==="input"&&(le.type==="checkbox"||le.type==="radio")&&(Re=Uk);if(Re&&(Re=Re(d,Vt))){q0(fe,Re,m,de);break t}$e&&$e(d,le,Vt),d==="focusout"&&($e=le._wrapperState)&&$e.controlled&&le.type==="number"&&De(le,"number",le.value)}switch($e=Vt?cl(Vt):window,d){case"focusin":($0($e)||$e.contentEditable==="true")&&(ll=$e,xp=Vt,Pu=null);break;case"focusout":Pu=xp=ll=null;break;case"mousedown":vp=!0;break;case"contextmenu":case"mouseup":case"dragend":vp=!1,ev(fe,m,de);break;case"selectionchange":if(Hk)break;case"keydown":case"keyup":ev(fe,m,de)}var qe;if(ns)t:{switch(d){case"compositionstart":var Ke="onCompositionStart";break t;case"compositionend":Ke="onCompositionEnd";break t;case"compositionupdate":Ke="onCompositionUpdate";break t}Ke=void 0}else yr?ua(d,m)&&(Ke="onCompositionEnd"):d==="keydown"&&m.keyCode===229&&(Ke="onCompositionStart");Ke&&(zn&&m.locale!=="ko"&&(yr||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&yr&&(qe=Ph()):(Ji=de,el="value"in Ji?Ji.value:Ji.textContent,yr=!0)),$e=qh(Vt,Ke),0<$e.length&&(Ke=new Nu(Ke,d,null,m,de),fe.push({event:Ke,listeners:$e}),qe?Ke.data=qe:(qe=ku(m),qe!==null&&(Ke.data=qe)))),(qe=ws?Rk(d,m):Fk(d,m))&&(Vt=qh(Vt,"onBeforeInput"),0<Vt.length&&(de=new Nu("onBeforeInput","beforeinput",null,m,de),fe.push({event:de,listeners:Vt}),de.data=qe))}dv(fe,c)})}function Ou(d,c,m){return{instance:d,listener:c,currentTarget:m}}function qh(d,c){for(var m=c+"Capture",E=[];d!==null;){var T=d,I=T.stateNode;T.tag===5&&I!==null&&(T=I,I=Tt(d,m),I!=null&&E.unshift(Ou(d,I,T)),I=Tt(d,c),I!=null&&E.push(Ou(d,I,T))),d=d.return}return E}function dl(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function cv(d,c,m,E,T){for(var I=c._reactName,V=[];m!==null&&m!==E;){var rt=m,xt=rt.alternate,Vt=rt.stateNode;if(xt!==null&&xt===E)break;rt.tag===5&&Vt!==null&&(rt=Vt,T?(xt=Tt(m,I),xt!=null&&V.unshift(Ou(m,xt,rt))):T||(xt=Tt(m,I),xt!=null&&V.push(Ou(m,xt,rt)))),m=m.return}V.length!==0&&d.push({event:c,listeners:V})}var Wk=/\r\n?/g,Xk=/\u0000|\uFFFD/g;function gv(d){return(typeof d=="string"?d:""+d).replace(Wk,`
`).replace(Xk,"")}function Yh(d,c,m){if(c=gv(c),gv(d)!==c&&m)throw Error(s(425))}function Wh(){}var Tp=null,Cp=null;function Lp(d,c){return d==="textarea"||d==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Np=typeof setTimeout=="function"?setTimeout:void 0,Zk=typeof clearTimeout=="function"?clearTimeout:void 0,fv=typeof Promise=="function"?Promise:void 0,Kk=typeof queueMicrotask=="function"?queueMicrotask:typeof fv<"u"?function(d){return fv.resolve(null).then(d).catch(Qk)}:Np;function Qk(d){setTimeout(function(){throw d})}function Mp(d,c){var m=c,E=0;do{var T=m.nextSibling;if(d.removeChild(m),T&&T.nodeType===8)if(m=T.data,m==="/$"){if(E===0){d.removeChild(T),mr(c);return}E--}else m!=="$"&&m!=="$?"&&m!=="$!"||E++;m=T}while(m);mr(c)}function yo(d){for(;d!=null;d=d.nextSibling){var c=d.nodeType;if(c===1||c===3)break;if(c===8){if(c=d.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return d}function pv(d){d=d.previousSibling;for(var c=0;d;){if(d.nodeType===8){var m=d.data;if(m==="$"||m==="$!"||m==="$?"){if(c===0)return d;c--}else m==="/$"&&c++}d=d.previousSibling}return null}var hl=Math.random().toString(36).slice(2),xr="__reactFiber$"+hl,Bu="__reactProps$"+hl,Dr="__reactContainer$"+hl,kp="__reactEvents$"+hl,Jk="__reactListeners$"+hl,tI="__reactHandles$"+hl;function da(d){var c=d[xr];if(c)return c;for(var m=d.parentNode;m;){if(c=m[Dr]||m[xr]){if(m=c.alternate,c.child!==null||m!==null&&m.child!==null)for(d=pv(d);d!==null;){if(m=d[xr])return m;d=pv(d)}return c}d=m,m=d.parentNode}return null}function Uu(d){return d=d[xr]||d[Dr],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function cl(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(s(33))}function Xh(d){return d[Bu]||null}var Ip=[],gl=-1;function xo(d){return{current:d}}function Gs(d){0>gl||(d.current=Ip[gl],Ip[gl]=null,gl--)}function Rs(d,c){gl++,Ip[gl]=d.current,d.current=c}var vo={},Dn=xo(vo),di=xo(!1),ha=vo;function fl(d,c){var m=d.type.contextTypes;if(!m)return vo;var E=d.stateNode;if(E&&E.__reactInternalMemoizedUnmaskedChildContext===c)return E.__reactInternalMemoizedMaskedChildContext;var T={},I;for(I in m)T[I]=c[I];return E&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=c,d.__reactInternalMemoizedMaskedChildContext=T),T}function hi(d){return d=d.childContextTypes,d!=null}function Zh(){Gs(di),Gs(Dn)}function mv(d,c,m){if(Dn.current!==vo)throw Error(s(168));Rs(Dn,c),Rs(di,m)}function _v(d,c,m){var E=d.stateNode;if(c=c.childContextTypes,typeof E.getChildContext!="function")return m;E=E.getChildContext();for(var T in E)if(!(T in c))throw Error(s(108,pe(d)||"Unknown",T));return Mt({},m,E)}function Kh(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||vo,ha=Dn.current,Rs(Dn,d),Rs(di,di.current),!0}function yv(d,c,m){var E=d.stateNode;if(!E)throw Error(s(169));m?(d=_v(d,c,ha),E.__reactInternalMemoizedMergedChildContext=d,Gs(di),Gs(Dn),Rs(Dn,d)):Gs(di),Rs(di,m)}var Or=null,Qh=!1,Rp=!1;function xv(d){Or===null?Or=[d]:Or.push(d)}function eI(d){Qh=!0,xv(d)}function bo(){if(!Rp&&Or!==null){Rp=!0;var d=0,c=ie;try{var m=Or;for(ie=1;d<m.length;d++){var E=m[d];do E=E(!0);while(E!==null)}Or=null,Qh=!1}catch(T){throw Or!==null&&(Or=Or.slice(d+1)),cs(_t,bo),T}finally{ie=c,Rp=!1}}return null}var pl=[],ml=0,Jh=null,tc=0,Fi=[],Pi=0,ca=null,Br=1,Ur="";function ga(d,c){pl[ml++]=tc,pl[ml++]=Jh,Jh=d,tc=c}function vv(d,c,m){Fi[Pi++]=Br,Fi[Pi++]=Ur,Fi[Pi++]=ca,ca=d;var E=Br;d=Ur;var T=32-$t(E)-1;E&=~(1<<T),m+=1;var I=32-$t(c)+T;if(30<I){var V=T-T%5;I=(E&(1<<V)-1).toString(32),E>>=V,T-=V,Br=1<<32-$t(c)+T|m<<T|E,Ur=I+d}else Br=1<<I|m<<T|E,Ur=d}function Fp(d){d.return!==null&&(ga(d,1),vv(d,1,0))}function Pp(d){for(;d===Jh;)Jh=pl[--ml],pl[ml]=null,tc=pl[--ml],pl[ml]=null;for(;d===ca;)ca=Fi[--Pi],Fi[Pi]=null,Ur=Fi[--Pi],Fi[Pi]=null,Br=Fi[--Pi],Fi[Pi]=null}var Si=null,Ai=null,qs=!1,er=null;function bv(d,c){var m=Bi(5,null,null,0);m.elementType="DELETED",m.stateNode=c,m.return=d,c=d.deletions,c===null?(d.deletions=[m],d.flags|=16):c.push(m)}function Ev(d,c){switch(d.tag){case 5:var m=d.type;return c=c.nodeType!==1||m.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(d.stateNode=c,Si=d,Ai=yo(c.firstChild),!0):!1;case 6:return c=d.pendingProps===""||c.nodeType!==3?null:c,c!==null?(d.stateNode=c,Si=d,Ai=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(m=ca!==null?{id:Br,overflow:Ur}:null,d.memoizedState={dehydrated:c,treeContext:m,retryLane:1073741824},m=Bi(18,null,null,0),m.stateNode=c,m.return=d,d.child=m,Si=d,Ai=null,!0):!1;default:return!1}}function zp(d){return(d.mode&1)!==0&&(d.flags&128)===0}function Dp(d){if(qs){var c=Ai;if(c){var m=c;if(!Ev(d,c)){if(zp(d))throw Error(s(418));c=yo(m.nextSibling);var E=Si;c&&Ev(d,c)?bv(E,m):(d.flags=d.flags&-4097|2,qs=!1,Si=d)}}else{if(zp(d))throw Error(s(418));d.flags=d.flags&-4097|2,qs=!1,Si=d}}}function Sv(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;Si=d}function ec(d){if(d!==Si)return!1;if(!qs)return Sv(d),qs=!0,!1;var c;if((c=d.tag!==3)&&!(c=d.tag!==5)&&(c=d.type,c=c!=="head"&&c!=="body"&&!Lp(d.type,d.memoizedProps)),c&&(c=Ai)){if(zp(d))throw Av(),Error(s(418));for(;c;)bv(d,c),c=yo(c.nextSibling)}if(Sv(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));t:{for(d=d.nextSibling,c=0;d;){if(d.nodeType===8){var m=d.data;if(m==="/$"){if(c===0){Ai=yo(d.nextSibling);break t}c--}else m!=="$"&&m!=="$!"&&m!=="$?"||c++}d=d.nextSibling}Ai=null}}else Ai=Si?yo(d.stateNode.nextSibling):null;return!0}function Av(){for(var d=Ai;d;)d=yo(d.nextSibling)}function _l(){Ai=Si=null,qs=!1}function Op(d){er===null?er=[d]:er.push(d)}var sI=A.ReactCurrentBatchConfig;function Gu(d,c,m){if(d=m.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(s(309));var E=m.stateNode}if(!E)throw Error(s(147,d));var T=E,I=""+d;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===I?c.ref:(c=function(V){var rt=T.refs;V===null?delete rt[I]:rt[I]=V},c._stringRef=I,c)}if(typeof d!="string")throw Error(s(284));if(!m._owner)throw Error(s(290,d))}return d}function sc(d,c){throw d=Object.prototype.toString.call(c),Error(s(31,d==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":d))}function wv(d){var c=d._init;return c(d._payload)}function Tv(d){function c(kt,wt){if(d){var Dt=kt.deletions;Dt===null?(kt.deletions=[wt],kt.flags|=16):Dt.push(wt)}}function m(kt,wt){if(!d)return null;for(;wt!==null;)c(kt,wt),wt=wt.sibling;return null}function E(kt,wt){for(kt=new Map;wt!==null;)wt.key!==null?kt.set(wt.key,wt):kt.set(wt.index,wt),wt=wt.sibling;return kt}function T(kt,wt){return kt=No(kt,wt),kt.index=0,kt.sibling=null,kt}function I(kt,wt,Dt){return kt.index=Dt,d?(Dt=kt.alternate,Dt!==null?(Dt=Dt.index,Dt<wt?(kt.flags|=2,wt):Dt):(kt.flags|=2,wt)):(kt.flags|=1048576,wt)}function V(kt){return d&&kt.alternate===null&&(kt.flags|=2),kt}function rt(kt,wt,Dt,ye){return wt===null||wt.tag!==6?(wt=Nm(Dt,kt.mode,ye),wt.return=kt,wt):(wt=T(wt,Dt),wt.return=kt,wt)}function xt(kt,wt,Dt,ye){var Re=Dt.type;return Re===M?de(kt,wt,Dt.props.children,ye,Dt.key):wt!==null&&(wt.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===ut&&wv(Re)===wt.type)?(ye=T(wt,Dt.props),ye.ref=Gu(kt,wt,Dt),ye.return=kt,ye):(ye=Tc(Dt.type,Dt.key,Dt.props,null,kt.mode,ye),ye.ref=Gu(kt,wt,Dt),ye.return=kt,ye)}function Vt(kt,wt,Dt,ye){return wt===null||wt.tag!==4||wt.stateNode.containerInfo!==Dt.containerInfo||wt.stateNode.implementation!==Dt.implementation?(wt=Mm(Dt,kt.mode,ye),wt.return=kt,wt):(wt=T(wt,Dt.children||[]),wt.return=kt,wt)}function de(kt,wt,Dt,ye,Re){return wt===null||wt.tag!==7?(wt=ba(Dt,kt.mode,ye,Re),wt.return=kt,wt):(wt=T(wt,Dt),wt.return=kt,wt)}function fe(kt,wt,Dt){if(typeof wt=="string"&&wt!==""||typeof wt=="number")return wt=Nm(""+wt,kt.mode,Dt),wt.return=kt,wt;if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case w:return Dt=Tc(wt.type,wt.key,wt.props,null,kt.mode,Dt),Dt.ref=Gu(kt,null,wt),Dt.return=kt,Dt;case L:return wt=Mm(wt,kt.mode,Dt),wt.return=kt,wt;case ut:var ye=wt._init;return fe(kt,ye(wt._payload),Dt)}if(He(wt)||ot(wt))return wt=ba(wt,kt.mode,Dt,null),wt.return=kt,wt;sc(kt,wt)}return null}function le(kt,wt,Dt,ye){var Re=wt!==null?wt.key:null;if(typeof Dt=="string"&&Dt!==""||typeof Dt=="number")return Re!==null?null:rt(kt,wt,""+Dt,ye);if(typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case w:return Dt.key===Re?xt(kt,wt,Dt,ye):null;case L:return Dt.key===Re?Vt(kt,wt,Dt,ye):null;case ut:return Re=Dt._init,le(kt,wt,Re(Dt._payload),ye)}if(He(Dt)||ot(Dt))return Re!==null?null:de(kt,wt,Dt,ye,null);sc(kt,Dt)}return null}function Ae(kt,wt,Dt,ye,Re){if(typeof ye=="string"&&ye!==""||typeof ye=="number")return kt=kt.get(Dt)||null,rt(wt,kt,""+ye,Re);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case w:return kt=kt.get(ye.key===null?Dt:ye.key)||null,xt(wt,kt,ye,Re);case L:return kt=kt.get(ye.key===null?Dt:ye.key)||null,Vt(wt,kt,ye,Re);case ut:var $e=ye._init;return Ae(kt,wt,Dt,$e(ye._payload),Re)}if(He(ye)||ot(ye))return kt=kt.get(Dt)||null,de(wt,kt,ye,Re,null);sc(wt,ye)}return null}function Ne(kt,wt,Dt,ye){for(var Re=null,$e=null,qe=wt,Ke=wt=0,Ln=null;qe!==null&&Ke<Dt.length;Ke++){qe.index>Ke?(Ln=qe,qe=null):Ln=qe.sibling;var _s=le(kt,qe,Dt[Ke],ye);if(_s===null){qe===null&&(qe=Ln);break}d&&qe&&_s.alternate===null&&c(kt,qe),wt=I(_s,wt,Ke),$e===null?Re=_s:$e.sibling=_s,$e=_s,qe=Ln}if(Ke===Dt.length)return m(kt,qe),qs&&ga(kt,Ke),Re;if(qe===null){for(;Ke<Dt.length;Ke++)qe=fe(kt,Dt[Ke],ye),qe!==null&&(wt=I(qe,wt,Ke),$e===null?Re=qe:$e.sibling=qe,$e=qe);return qs&&ga(kt,Ke),Re}for(qe=E(kt,qe);Ke<Dt.length;Ke++)Ln=Ae(qe,kt,Ke,Dt[Ke],ye),Ln!==null&&(d&&Ln.alternate!==null&&qe.delete(Ln.key===null?Ke:Ln.key),wt=I(Ln,wt,Ke),$e===null?Re=Ln:$e.sibling=Ln,$e=Ln);return d&&qe.forEach(function(Mo){return c(kt,Mo)}),qs&&ga(kt,Ke),Re}function ke(kt,wt,Dt,ye){var Re=ot(Dt);if(typeof Re!="function")throw Error(s(150));if(Dt=Re.call(Dt),Dt==null)throw Error(s(151));for(var $e=Re=null,qe=wt,Ke=wt=0,Ln=null,_s=Dt.next();qe!==null&&!_s.done;Ke++,_s=Dt.next()){qe.index>Ke?(Ln=qe,qe=null):Ln=qe.sibling;var Mo=le(kt,qe,_s.value,ye);if(Mo===null){qe===null&&(qe=Ln);break}d&&qe&&Mo.alternate===null&&c(kt,qe),wt=I(Mo,wt,Ke),$e===null?Re=Mo:$e.sibling=Mo,$e=Mo,qe=Ln}if(_s.done)return m(kt,qe),qs&&ga(kt,Ke),Re;if(qe===null){for(;!_s.done;Ke++,_s=Dt.next())_s=fe(kt,_s.value,ye),_s!==null&&(wt=I(_s,wt,Ke),$e===null?Re=_s:$e.sibling=_s,$e=_s);return qs&&ga(kt,Ke),Re}for(qe=E(kt,qe);!_s.done;Ke++,_s=Dt.next())_s=Ae(qe,kt,Ke,_s.value,ye),_s!==null&&(d&&_s.alternate!==null&&qe.delete(_s.key===null?Ke:_s.key),wt=I(_s,wt,Ke),$e===null?Re=_s:$e.sibling=_s,$e=_s);return d&&qe.forEach(function(PI){return c(kt,PI)}),qs&&ga(kt,Ke),Re}function dn(kt,wt,Dt,ye){if(typeof Dt=="object"&&Dt!==null&&Dt.type===M&&Dt.key===null&&(Dt=Dt.props.children),typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case w:t:{for(var Re=Dt.key,$e=wt;$e!==null;){if($e.key===Re){if(Re=Dt.type,Re===M){if($e.tag===7){m(kt,$e.sibling),wt=T($e,Dt.props.children),wt.return=kt,kt=wt;break t}}else if($e.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===ut&&wv(Re)===$e.type){m(kt,$e.sibling),wt=T($e,Dt.props),wt.ref=Gu(kt,$e,Dt),wt.return=kt,kt=wt;break t}m(kt,$e);break}else c(kt,$e);$e=$e.sibling}Dt.type===M?(wt=ba(Dt.props.children,kt.mode,ye,Dt.key),wt.return=kt,kt=wt):(ye=Tc(Dt.type,Dt.key,Dt.props,null,kt.mode,ye),ye.ref=Gu(kt,wt,Dt),ye.return=kt,kt=ye)}return V(kt);case L:t:{for($e=Dt.key;wt!==null;){if(wt.key===$e)if(wt.tag===4&&wt.stateNode.containerInfo===Dt.containerInfo&&wt.stateNode.implementation===Dt.implementation){m(kt,wt.sibling),wt=T(wt,Dt.children||[]),wt.return=kt,kt=wt;break t}else{m(kt,wt);break}else c(kt,wt);wt=wt.sibling}wt=Mm(Dt,kt.mode,ye),wt.return=kt,kt=wt}return V(kt);case ut:return $e=Dt._init,dn(kt,wt,$e(Dt._payload),ye)}if(He(Dt))return Ne(kt,wt,Dt,ye);if(ot(Dt))return ke(kt,wt,Dt,ye);sc(kt,Dt)}return typeof Dt=="string"&&Dt!==""||typeof Dt=="number"?(Dt=""+Dt,wt!==null&&wt.tag===6?(m(kt,wt.sibling),wt=T(wt,Dt),wt.return=kt,kt=wt):(m(kt,wt),wt=Nm(Dt,kt.mode,ye),wt.return=kt,kt=wt),V(kt)):m(kt,wt)}return dn}var yl=Tv(!0),Cv=Tv(!1),nc=xo(null),ic=null,xl=null,Bp=null;function Up(){Bp=xl=ic=null}function Gp(d){var c=nc.current;Gs(nc),d._currentValue=c}function Vp(d,c,m){for(;d!==null;){var E=d.alternate;if((d.childLanes&c)!==c?(d.childLanes|=c,E!==null&&(E.childLanes|=c)):E!==null&&(E.childLanes&c)!==c&&(E.childLanes|=c),d===m)break;d=d.return}}function vl(d,c){ic=d,Bp=xl=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&c)!==0&&(ci=!0),d.firstContext=null)}function zi(d){var c=d._currentValue;if(Bp!==d)if(d={context:d,memoizedValue:c,next:null},xl===null){if(ic===null)throw Error(s(308));xl=d,ic.dependencies={lanes:0,firstContext:d}}else xl=xl.next=d;return c}var fa=null;function jp(d){fa===null?fa=[d]:fa.push(d)}function Lv(d,c,m,E){var T=c.interleaved;return T===null?(m.next=m,jp(c)):(m.next=T.next,T.next=m),c.interleaved=m,Gr(d,E)}function Gr(d,c){d.lanes|=c;var m=d.alternate;for(m!==null&&(m.lanes|=c),m=d,d=d.return;d!==null;)d.childLanes|=c,m=d.alternate,m!==null&&(m.childLanes|=c),m=d,d=d.return;return m.tag===3?m.stateNode:null}var Eo=!1;function Hp(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Nv(d,c){d=d.updateQueue,c.updateQueue===d&&(c.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function Vr(d,c){return{eventTime:d,lane:c,tag:0,payload:null,callback:null,next:null}}function So(d,c,m){var E=d.updateQueue;if(E===null)return null;if(E=E.shared,(fs&2)!==0){var T=E.pending;return T===null?c.next=c:(c.next=T.next,T.next=c),E.pending=c,Gr(d,m)}return T=E.interleaved,T===null?(c.next=c,jp(E)):(c.next=T.next,T.next=c),E.interleaved=c,Gr(d,m)}function rc(d,c,m){if(c=c.updateQueue,c!==null&&(c=c.shared,(m&4194240)!==0)){var E=c.lanes;E&=d.pendingLanes,m|=E,c.lanes=m,Qt(d,m)}}function Mv(d,c){var m=d.updateQueue,E=d.alternate;if(E!==null&&(E=E.updateQueue,m===E)){var T=null,I=null;if(m=m.firstBaseUpdate,m!==null){do{var V={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};I===null?T=I=V:I=I.next=V,m=m.next}while(m!==null);I===null?T=I=c:I=I.next=c}else T=I=c;m={baseState:E.baseState,firstBaseUpdate:T,lastBaseUpdate:I,shared:E.shared,effects:E.effects},d.updateQueue=m;return}d=m.lastBaseUpdate,d===null?m.firstBaseUpdate=c:d.next=c,m.lastBaseUpdate=c}function oc(d,c,m,E){var T=d.updateQueue;Eo=!1;var I=T.firstBaseUpdate,V=T.lastBaseUpdate,rt=T.shared.pending;if(rt!==null){T.shared.pending=null;var xt=rt,Vt=xt.next;xt.next=null,V===null?I=Vt:V.next=Vt,V=xt;var de=d.alternate;de!==null&&(de=de.updateQueue,rt=de.lastBaseUpdate,rt!==V&&(rt===null?de.firstBaseUpdate=Vt:rt.next=Vt,de.lastBaseUpdate=xt))}if(I!==null){var fe=T.baseState;V=0,de=Vt=xt=null,rt=I;do{var le=rt.lane,Ae=rt.eventTime;if((E&le)===le){de!==null&&(de=de.next={eventTime:Ae,lane:0,tag:rt.tag,payload:rt.payload,callback:rt.callback,next:null});t:{var Ne=d,ke=rt;switch(le=c,Ae=m,ke.tag){case 1:if(Ne=ke.payload,typeof Ne=="function"){fe=Ne.call(Ae,fe,le);break t}fe=Ne;break t;case 3:Ne.flags=Ne.flags&-65537|128;case 0:if(Ne=ke.payload,le=typeof Ne=="function"?Ne.call(Ae,fe,le):Ne,le==null)break t;fe=Mt({},fe,le);break t;case 2:Eo=!0}}rt.callback!==null&&rt.lane!==0&&(d.flags|=64,le=T.effects,le===null?T.effects=[rt]:le.push(rt))}else Ae={eventTime:Ae,lane:le,tag:rt.tag,payload:rt.payload,callback:rt.callback,next:null},de===null?(Vt=de=Ae,xt=fe):de=de.next=Ae,V|=le;if(rt=rt.next,rt===null){if(rt=T.shared.pending,rt===null)break;le=rt,rt=le.next,le.next=null,T.lastBaseUpdate=le,T.shared.pending=null}}while(!0);if(de===null&&(xt=fe),T.baseState=xt,T.firstBaseUpdate=Vt,T.lastBaseUpdate=de,c=T.shared.interleaved,c!==null){T=c;do V|=T.lane,T=T.next;while(T!==c)}else I===null&&(T.shared.lanes=0);_a|=V,d.lanes=V,d.memoizedState=fe}}function kv(d,c,m){if(d=c.effects,c.effects=null,d!==null)for(c=0;c<d.length;c++){var E=d[c],T=E.callback;if(T!==null){if(E.callback=null,E=m,typeof T!="function")throw Error(s(191,T));T.call(E)}}}var Vu={},vr=xo(Vu),ju=xo(Vu),Hu=xo(Vu);function pa(d){if(d===Vu)throw Error(s(174));return d}function $p(d,c){switch(Rs(Hu,c),Rs(ju,d),Rs(vr,Vu),d=c.nodeType,d){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Ns(null,"");break;default:d=d===8?c.parentNode:c,c=d.namespaceURI||null,d=d.tagName,c=Ns(c,d)}Gs(vr),Rs(vr,c)}function bl(){Gs(vr),Gs(ju),Gs(Hu)}function Iv(d){pa(Hu.current);var c=pa(vr.current),m=Ns(c,d.type);c!==m&&(Rs(ju,d),Rs(vr,m))}function qp(d){ju.current===d&&(Gs(vr),Gs(ju))}var Qs=xo(0);function ac(d){for(var c=d;c!==null;){if(c.tag===13){var m=c.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===d)break;for(;c.sibling===null;){if(c.return===null||c.return===d)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Yp=[];function Wp(){for(var d=0;d<Yp.length;d++)Yp[d]._workInProgressVersionPrimary=null;Yp.length=0}var lc=A.ReactCurrentDispatcher,Xp=A.ReactCurrentBatchConfig,ma=0,Js=null,xn=null,Tn=null,uc=!1,$u=!1,qu=0,nI=0;function On(){throw Error(s(321))}function Zp(d,c){if(c===null)return!1;for(var m=0;m<c.length&&m<d.length;m++)if(!tr(d[m],c[m]))return!1;return!0}function Kp(d,c,m,E,T,I){if(ma=I,Js=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,lc.current=d===null||d.memoizedState===null?aI:lI,d=m(E,T),$u){I=0;do{if($u=!1,qu=0,25<=I)throw Error(s(301));I+=1,Tn=xn=null,c.updateQueue=null,lc.current=uI,d=m(E,T)}while($u)}if(lc.current=cc,c=xn!==null&&xn.next!==null,ma=0,Tn=xn=Js=null,uc=!1,c)throw Error(s(300));return d}function Qp(){var d=qu!==0;return qu=0,d}function br(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tn===null?Js.memoizedState=Tn=d:Tn=Tn.next=d,Tn}function Di(){if(xn===null){var d=Js.alternate;d=d!==null?d.memoizedState:null}else d=xn.next;var c=Tn===null?Js.memoizedState:Tn.next;if(c!==null)Tn=c,xn=d;else{if(d===null)throw Error(s(310));xn=d,d={memoizedState:xn.memoizedState,baseState:xn.baseState,baseQueue:xn.baseQueue,queue:xn.queue,next:null},Tn===null?Js.memoizedState=Tn=d:Tn=Tn.next=d}return Tn}function Yu(d,c){return typeof c=="function"?c(d):c}function Jp(d){var c=Di(),m=c.queue;if(m===null)throw Error(s(311));m.lastRenderedReducer=d;var E=xn,T=E.baseQueue,I=m.pending;if(I!==null){if(T!==null){var V=T.next;T.next=I.next,I.next=V}E.baseQueue=T=I,m.pending=null}if(T!==null){I=T.next,E=E.baseState;var rt=V=null,xt=null,Vt=I;do{var de=Vt.lane;if((ma&de)===de)xt!==null&&(xt=xt.next={lane:0,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null}),E=Vt.hasEagerState?Vt.eagerState:d(E,Vt.action);else{var fe={lane:de,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null};xt===null?(rt=xt=fe,V=E):xt=xt.next=fe,Js.lanes|=de,_a|=de}Vt=Vt.next}while(Vt!==null&&Vt!==I);xt===null?V=E:xt.next=rt,tr(E,c.memoizedState)||(ci=!0),c.memoizedState=E,c.baseState=V,c.baseQueue=xt,m.lastRenderedState=E}if(d=m.interleaved,d!==null){T=d;do I=T.lane,Js.lanes|=I,_a|=I,T=T.next;while(T!==d)}else T===null&&(m.lanes=0);return[c.memoizedState,m.dispatch]}function tm(d){var c=Di(),m=c.queue;if(m===null)throw Error(s(311));m.lastRenderedReducer=d;var E=m.dispatch,T=m.pending,I=c.memoizedState;if(T!==null){m.pending=null;var V=T=T.next;do I=d(I,V.action),V=V.next;while(V!==T);tr(I,c.memoizedState)||(ci=!0),c.memoizedState=I,c.baseQueue===null&&(c.baseState=I),m.lastRenderedState=I}return[I,E]}function Rv(){}function Fv(d,c){var m=Js,E=Di(),T=c(),I=!tr(E.memoizedState,T);if(I&&(E.memoizedState=T,ci=!0),E=E.queue,em(Dv.bind(null,m,E,d),[d]),E.getSnapshot!==c||I||Tn!==null&&Tn.memoizedState.tag&1){if(m.flags|=2048,Wu(9,zv.bind(null,m,E,T,c),void 0,null),Cn===null)throw Error(s(349));(ma&30)!==0||Pv(m,c,T)}return T}function Pv(d,c,m){d.flags|=16384,d={getSnapshot:c,value:m},c=Js.updateQueue,c===null?(c={lastEffect:null,stores:null},Js.updateQueue=c,c.stores=[d]):(m=c.stores,m===null?c.stores=[d]:m.push(d))}function zv(d,c,m,E){c.value=m,c.getSnapshot=E,Ov(c)&&Bv(d)}function Dv(d,c,m){return m(function(){Ov(c)&&Bv(d)})}function Ov(d){var c=d.getSnapshot;d=d.value;try{var m=c();return!tr(d,m)}catch{return!0}}function Bv(d){var c=Gr(d,1);c!==null&&rr(c,d,1,-1)}function Uv(d){var c=br();return typeof d=="function"&&(d=d()),c.memoizedState=c.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yu,lastRenderedState:d},c.queue=d,d=d.dispatch=oI.bind(null,Js,d),[c.memoizedState,d]}function Wu(d,c,m,E){return d={tag:d,create:c,destroy:m,deps:E,next:null},c=Js.updateQueue,c===null?(c={lastEffect:null,stores:null},Js.updateQueue=c,c.lastEffect=d.next=d):(m=c.lastEffect,m===null?c.lastEffect=d.next=d:(E=m.next,m.next=d,d.next=E,c.lastEffect=d)),d}function Gv(){return Di().memoizedState}function dc(d,c,m,E){var T=br();Js.flags|=d,T.memoizedState=Wu(1|c,m,void 0,E===void 0?null:E)}function hc(d,c,m,E){var T=Di();E=E===void 0?null:E;var I=void 0;if(xn!==null){var V=xn.memoizedState;if(I=V.destroy,E!==null&&Zp(E,V.deps)){T.memoizedState=Wu(c,m,I,E);return}}Js.flags|=d,T.memoizedState=Wu(1|c,m,I,E)}function Vv(d,c){return dc(8390656,8,d,c)}function em(d,c){return hc(2048,8,d,c)}function jv(d,c){return hc(4,2,d,c)}function Hv(d,c){return hc(4,4,d,c)}function $v(d,c){if(typeof c=="function")return d=d(),c(d),function(){c(null)};if(c!=null)return d=d(),c.current=d,function(){c.current=null}}function qv(d,c,m){return m=m!=null?m.concat([d]):null,hc(4,4,$v.bind(null,c,d),m)}function sm(){}function Yv(d,c){var m=Di();c=c===void 0?null:c;var E=m.memoizedState;return E!==null&&c!==null&&Zp(c,E[1])?E[0]:(m.memoizedState=[d,c],d)}function Wv(d,c){var m=Di();c=c===void 0?null:c;var E=m.memoizedState;return E!==null&&c!==null&&Zp(c,E[1])?E[0]:(d=d(),m.memoizedState=[d,c],d)}function Xv(d,c,m){return(ma&21)===0?(d.baseState&&(d.baseState=!1,ci=!0),d.memoizedState=m):(tr(m,c)||(m=W(),Js.lanes|=m,_a|=m,d.baseState=!0),c)}function iI(d,c){var m=ie;ie=m!==0&&4>m?m:4,d(!0);var E=Xp.transition;Xp.transition={};try{d(!1),c()}finally{ie=m,Xp.transition=E}}function Zv(){return Di().memoizedState}function rI(d,c,m){var E=Co(d);if(m={lane:E,action:m,hasEagerState:!1,eagerState:null,next:null},Kv(d))Qv(c,m);else if(m=Lv(d,c,m,E),m!==null){var T=Qn();rr(m,d,E,T),Jv(m,c,E)}}function oI(d,c,m){var E=Co(d),T={lane:E,action:m,hasEagerState:!1,eagerState:null,next:null};if(Kv(d))Qv(c,T);else{var I=d.alternate;if(d.lanes===0&&(I===null||I.lanes===0)&&(I=c.lastRenderedReducer,I!==null))try{var V=c.lastRenderedState,rt=I(V,m);if(T.hasEagerState=!0,T.eagerState=rt,tr(rt,V)){var xt=c.interleaved;xt===null?(T.next=T,jp(c)):(T.next=xt.next,xt.next=T),c.interleaved=T;return}}catch{}finally{}m=Lv(d,c,T,E),m!==null&&(T=Qn(),rr(m,d,E,T),Jv(m,c,E))}}function Kv(d){var c=d.alternate;return d===Js||c!==null&&c===Js}function Qv(d,c){$u=uc=!0;var m=d.pending;m===null?c.next=c:(c.next=m.next,m.next=c),d.pending=c}function Jv(d,c,m){if((m&4194240)!==0){var E=c.lanes;E&=d.pendingLanes,m|=E,c.lanes=m,Qt(d,m)}}var cc={readContext:zi,useCallback:On,useContext:On,useEffect:On,useImperativeHandle:On,useInsertionEffect:On,useLayoutEffect:On,useMemo:On,useReducer:On,useRef:On,useState:On,useDebugValue:On,useDeferredValue:On,useTransition:On,useMutableSource:On,useSyncExternalStore:On,useId:On,unstable_isNewReconciler:!1},aI={readContext:zi,useCallback:function(d,c){return br().memoizedState=[d,c===void 0?null:c],d},useContext:zi,useEffect:Vv,useImperativeHandle:function(d,c,m){return m=m!=null?m.concat([d]):null,dc(4194308,4,$v.bind(null,c,d),m)},useLayoutEffect:function(d,c){return dc(4194308,4,d,c)},useInsertionEffect:function(d,c){return dc(4,2,d,c)},useMemo:function(d,c){var m=br();return c=c===void 0?null:c,d=d(),m.memoizedState=[d,c],d},useReducer:function(d,c,m){var E=br();return c=m!==void 0?m(c):c,E.memoizedState=E.baseState=c,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:c},E.queue=d,d=d.dispatch=rI.bind(null,Js,d),[E.memoizedState,d]},useRef:function(d){var c=br();return d={current:d},c.memoizedState=d},useState:Uv,useDebugValue:sm,useDeferredValue:function(d){return br().memoizedState=d},useTransition:function(){var d=Uv(!1),c=d[0];return d=iI.bind(null,d[1]),br().memoizedState=d,[c,d]},useMutableSource:function(){},useSyncExternalStore:function(d,c,m){var E=Js,T=br();if(qs){if(m===void 0)throw Error(s(407));m=m()}else{if(m=c(),Cn===null)throw Error(s(349));(ma&30)!==0||Pv(E,c,m)}T.memoizedState=m;var I={value:m,getSnapshot:c};return T.queue=I,Vv(Dv.bind(null,E,I,d),[d]),E.flags|=2048,Wu(9,zv.bind(null,E,I,m,c),void 0,null),m},useId:function(){var d=br(),c=Cn.identifierPrefix;if(qs){var m=Ur,E=Br;m=(E&~(1<<32-$t(E)-1)).toString(32)+m,c=":"+c+"R"+m,m=qu++,0<m&&(c+="H"+m.toString(32)),c+=":"}else m=nI++,c=":"+c+"r"+m.toString(32)+":";return d.memoizedState=c},unstable_isNewReconciler:!1},lI={readContext:zi,useCallback:Yv,useContext:zi,useEffect:em,useImperativeHandle:qv,useInsertionEffect:jv,useLayoutEffect:Hv,useMemo:Wv,useReducer:Jp,useRef:Gv,useState:function(){return Jp(Yu)},useDebugValue:sm,useDeferredValue:function(d){var c=Di();return Xv(c,xn.memoizedState,d)},useTransition:function(){var d=Jp(Yu)[0],c=Di().memoizedState;return[d,c]},useMutableSource:Rv,useSyncExternalStore:Fv,useId:Zv,unstable_isNewReconciler:!1},uI={readContext:zi,useCallback:Yv,useContext:zi,useEffect:em,useImperativeHandle:qv,useInsertionEffect:jv,useLayoutEffect:Hv,useMemo:Wv,useReducer:tm,useRef:Gv,useState:function(){return tm(Yu)},useDebugValue:sm,useDeferredValue:function(d){var c=Di();return xn===null?c.memoizedState=d:Xv(c,xn.memoizedState,d)},useTransition:function(){var d=tm(Yu)[0],c=Di().memoizedState;return[d,c]},useMutableSource:Rv,useSyncExternalStore:Fv,useId:Zv,unstable_isNewReconciler:!1};function sr(d,c){if(d&&d.defaultProps){c=Mt({},c),d=d.defaultProps;for(var m in d)c[m]===void 0&&(c[m]=d[m]);return c}return c}function nm(d,c,m,E){c=d.memoizedState,m=m(E,c),m=m==null?c:Mt({},c,m),d.memoizedState=m,d.lanes===0&&(d.updateQueue.baseState=m)}var gc={isMounted:function(d){return(d=d._reactInternals)?je(d)===d:!1},enqueueSetState:function(d,c,m){d=d._reactInternals;var E=Qn(),T=Co(d),I=Vr(E,T);I.payload=c,m!=null&&(I.callback=m),c=So(d,I,T),c!==null&&(rr(c,d,T,E),rc(c,d,T))},enqueueReplaceState:function(d,c,m){d=d._reactInternals;var E=Qn(),T=Co(d),I=Vr(E,T);I.tag=1,I.payload=c,m!=null&&(I.callback=m),c=So(d,I,T),c!==null&&(rr(c,d,T,E),rc(c,d,T))},enqueueForceUpdate:function(d,c){d=d._reactInternals;var m=Qn(),E=Co(d),T=Vr(m,E);T.tag=2,c!=null&&(T.callback=c),c=So(d,T,E),c!==null&&(rr(c,d,E,m),rc(c,d,E))}};function tb(d,c,m,E,T,I,V){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(E,I,V):c.prototype&&c.prototype.isPureReactComponent?!Fu(m,E)||!Fu(T,I):!0}function eb(d,c,m){var E=!1,T=vo,I=c.contextType;return typeof I=="object"&&I!==null?I=zi(I):(T=hi(c)?ha:Dn.current,E=c.contextTypes,I=(E=E!=null)?fl(d,T):vo),c=new c(m,I),d.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=gc,d.stateNode=c,c._reactInternals=d,E&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=T,d.__reactInternalMemoizedMaskedChildContext=I),c}function sb(d,c,m,E){d=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(m,E),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(m,E),c.state!==d&&gc.enqueueReplaceState(c,c.state,null)}function im(d,c,m,E){var T=d.stateNode;T.props=m,T.state=d.memoizedState,T.refs={},Hp(d);var I=c.contextType;typeof I=="object"&&I!==null?T.context=zi(I):(I=hi(c)?ha:Dn.current,T.context=fl(d,I)),T.state=d.memoizedState,I=c.getDerivedStateFromProps,typeof I=="function"&&(nm(d,c,I,m),T.state=d.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(c=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),c!==T.state&&gc.enqueueReplaceState(T,T.state,null),oc(d,m,T,E),T.state=d.memoizedState),typeof T.componentDidMount=="function"&&(d.flags|=4194308)}function El(d,c){try{var m="",E=c;do m+=Zt(E),E=E.return;while(E);var T=m}catch(I){T=`
Error generating stack: `+I.message+`
`+I.stack}return{value:d,source:c,stack:T,digest:null}}function rm(d,c,m){return{value:d,source:null,stack:m??null,digest:c??null}}function om(d,c){try{console.error(c.value)}catch(m){setTimeout(function(){throw m})}}var dI=typeof WeakMap=="function"?WeakMap:Map;function nb(d,c,m){m=Vr(-1,m),m.tag=3,m.payload={element:null};var E=c.value;return m.callback=function(){vc||(vc=!0,bm=E),om(d,c)},m}function ib(d,c,m){m=Vr(-1,m),m.tag=3;var E=d.type.getDerivedStateFromError;if(typeof E=="function"){var T=c.value;m.payload=function(){return E(T)},m.callback=function(){om(d,c)}}var I=d.stateNode;return I!==null&&typeof I.componentDidCatch=="function"&&(m.callback=function(){om(d,c),typeof E!="function"&&(wo===null?wo=new Set([this]):wo.add(this));var V=c.stack;this.componentDidCatch(c.value,{componentStack:V!==null?V:""})}),m}function rb(d,c,m){var E=d.pingCache;if(E===null){E=d.pingCache=new dI;var T=new Set;E.set(c,T)}else T=E.get(c),T===void 0&&(T=new Set,E.set(c,T));T.has(m)||(T.add(m),d=AI.bind(null,d,c,m),c.then(d,d))}function ob(d){do{var c;if((c=d.tag===13)&&(c=d.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return d;d=d.return}while(d!==null);return null}function ab(d,c,m,E,T){return(d.mode&1)===0?(d===c?d.flags|=65536:(d.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(c=Vr(-1,1),c.tag=2,So(m,c,1))),m.lanes|=1),d):(d.flags|=65536,d.lanes=T,d)}var hI=A.ReactCurrentOwner,ci=!1;function Kn(d,c,m,E){c.child=d===null?Cv(c,null,m,E):yl(c,d.child,m,E)}function lb(d,c,m,E,T){m=m.render;var I=c.ref;return vl(c,T),E=Kp(d,c,m,E,I,T),m=Qp(),d!==null&&!ci?(c.updateQueue=d.updateQueue,c.flags&=-2053,d.lanes&=~T,jr(d,c,T)):(qs&&m&&Fp(c),c.flags|=1,Kn(d,c,E,T),c.child)}function ub(d,c,m,E,T){if(d===null){var I=m.type;return typeof I=="function"&&!Lm(I)&&I.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(c.tag=15,c.type=I,db(d,c,I,E,T)):(d=Tc(m.type,null,E,c,c.mode,T),d.ref=c.ref,d.return=c,c.child=d)}if(I=d.child,(d.lanes&T)===0){var V=I.memoizedProps;if(m=m.compare,m=m!==null?m:Fu,m(V,E)&&d.ref===c.ref)return jr(d,c,T)}return c.flags|=1,d=No(I,E),d.ref=c.ref,d.return=c,c.child=d}function db(d,c,m,E,T){if(d!==null){var I=d.memoizedProps;if(Fu(I,E)&&d.ref===c.ref)if(ci=!1,c.pendingProps=E=I,(d.lanes&T)!==0)(d.flags&131072)!==0&&(ci=!0);else return c.lanes=d.lanes,jr(d,c,T)}return am(d,c,m,E,T)}function hb(d,c,m){var E=c.pendingProps,T=E.children,I=d!==null?d.memoizedState:null;if(E.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},Rs(Al,wi),wi|=m;else{if((m&1073741824)===0)return d=I!==null?I.baseLanes|m:m,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:d,cachePool:null,transitions:null},c.updateQueue=null,Rs(Al,wi),wi|=d,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},E=I!==null?I.baseLanes:m,Rs(Al,wi),wi|=E}else I!==null?(E=I.baseLanes|m,c.memoizedState=null):E=m,Rs(Al,wi),wi|=E;return Kn(d,c,T,m),c.child}function cb(d,c){var m=c.ref;(d===null&&m!==null||d!==null&&d.ref!==m)&&(c.flags|=512,c.flags|=2097152)}function am(d,c,m,E,T){var I=hi(m)?ha:Dn.current;return I=fl(c,I),vl(c,T),m=Kp(d,c,m,E,I,T),E=Qp(),d!==null&&!ci?(c.updateQueue=d.updateQueue,c.flags&=-2053,d.lanes&=~T,jr(d,c,T)):(qs&&E&&Fp(c),c.flags|=1,Kn(d,c,m,T),c.child)}function gb(d,c,m,E,T){if(hi(m)){var I=!0;Kh(c)}else I=!1;if(vl(c,T),c.stateNode===null)pc(d,c),eb(c,m,E),im(c,m,E,T),E=!0;else if(d===null){var V=c.stateNode,rt=c.memoizedProps;V.props=rt;var xt=V.context,Vt=m.contextType;typeof Vt=="object"&&Vt!==null?Vt=zi(Vt):(Vt=hi(m)?ha:Dn.current,Vt=fl(c,Vt));var de=m.getDerivedStateFromProps,fe=typeof de=="function"||typeof V.getSnapshotBeforeUpdate=="function";fe||typeof V.UNSAFE_componentWillReceiveProps!="function"&&typeof V.componentWillReceiveProps!="function"||(rt!==E||xt!==Vt)&&sb(c,V,E,Vt),Eo=!1;var le=c.memoizedState;V.state=le,oc(c,E,V,T),xt=c.memoizedState,rt!==E||le!==xt||di.current||Eo?(typeof de=="function"&&(nm(c,m,de,E),xt=c.memoizedState),(rt=Eo||tb(c,m,rt,E,le,xt,Vt))?(fe||typeof V.UNSAFE_componentWillMount!="function"&&typeof V.componentWillMount!="function"||(typeof V.componentWillMount=="function"&&V.componentWillMount(),typeof V.UNSAFE_componentWillMount=="function"&&V.UNSAFE_componentWillMount()),typeof V.componentDidMount=="function"&&(c.flags|=4194308)):(typeof V.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=E,c.memoizedState=xt),V.props=E,V.state=xt,V.context=Vt,E=rt):(typeof V.componentDidMount=="function"&&(c.flags|=4194308),E=!1)}else{V=c.stateNode,Nv(d,c),rt=c.memoizedProps,Vt=c.type===c.elementType?rt:sr(c.type,rt),V.props=Vt,fe=c.pendingProps,le=V.context,xt=m.contextType,typeof xt=="object"&&xt!==null?xt=zi(xt):(xt=hi(m)?ha:Dn.current,xt=fl(c,xt));var Ae=m.getDerivedStateFromProps;(de=typeof Ae=="function"||typeof V.getSnapshotBeforeUpdate=="function")||typeof V.UNSAFE_componentWillReceiveProps!="function"&&typeof V.componentWillReceiveProps!="function"||(rt!==fe||le!==xt)&&sb(c,V,E,xt),Eo=!1,le=c.memoizedState,V.state=le,oc(c,E,V,T);var Ne=c.memoizedState;rt!==fe||le!==Ne||di.current||Eo?(typeof Ae=="function"&&(nm(c,m,Ae,E),Ne=c.memoizedState),(Vt=Eo||tb(c,m,Vt,E,le,Ne,xt)||!1)?(de||typeof V.UNSAFE_componentWillUpdate!="function"&&typeof V.componentWillUpdate!="function"||(typeof V.componentWillUpdate=="function"&&V.componentWillUpdate(E,Ne,xt),typeof V.UNSAFE_componentWillUpdate=="function"&&V.UNSAFE_componentWillUpdate(E,Ne,xt)),typeof V.componentDidUpdate=="function"&&(c.flags|=4),typeof V.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof V.componentDidUpdate!="function"||rt===d.memoizedProps&&le===d.memoizedState||(c.flags|=4),typeof V.getSnapshotBeforeUpdate!="function"||rt===d.memoizedProps&&le===d.memoizedState||(c.flags|=1024),c.memoizedProps=E,c.memoizedState=Ne),V.props=E,V.state=Ne,V.context=xt,E=Vt):(typeof V.componentDidUpdate!="function"||rt===d.memoizedProps&&le===d.memoizedState||(c.flags|=4),typeof V.getSnapshotBeforeUpdate!="function"||rt===d.memoizedProps&&le===d.memoizedState||(c.flags|=1024),E=!1)}return lm(d,c,m,E,I,T)}function lm(d,c,m,E,T,I){cb(d,c);var V=(c.flags&128)!==0;if(!E&&!V)return T&&yv(c,m,!1),jr(d,c,I);E=c.stateNode,hI.current=c;var rt=V&&typeof m.getDerivedStateFromError!="function"?null:E.render();return c.flags|=1,d!==null&&V?(c.child=yl(c,d.child,null,I),c.child=yl(c,null,rt,I)):Kn(d,c,rt,I),c.memoizedState=E.state,T&&yv(c,m,!0),c.child}function fb(d){var c=d.stateNode;c.pendingContext?mv(d,c.pendingContext,c.pendingContext!==c.context):c.context&&mv(d,c.context,!1),$p(d,c.containerInfo)}function pb(d,c,m,E,T){return _l(),Op(T),c.flags|=256,Kn(d,c,m,E),c.child}var um={dehydrated:null,treeContext:null,retryLane:0};function dm(d){return{baseLanes:d,cachePool:null,transitions:null}}function mb(d,c,m){var E=c.pendingProps,T=Qs.current,I=!1,V=(c.flags&128)!==0,rt;if((rt=V)||(rt=d!==null&&d.memoizedState===null?!1:(T&2)!==0),rt?(I=!0,c.flags&=-129):(d===null||d.memoizedState!==null)&&(T|=1),Rs(Qs,T&1),d===null)return Dp(c),d=c.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((c.mode&1)===0?c.lanes=1:d.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(V=E.children,d=E.fallback,I?(E=c.mode,I=c.child,V={mode:"hidden",children:V},(E&1)===0&&I!==null?(I.childLanes=0,I.pendingProps=V):I=Cc(V,E,0,null),d=ba(d,E,m,null),I.return=c,d.return=c,I.sibling=d,c.child=I,c.child.memoizedState=dm(m),c.memoizedState=um,d):hm(c,V));if(T=d.memoizedState,T!==null&&(rt=T.dehydrated,rt!==null))return cI(d,c,V,E,rt,T,m);if(I){I=E.fallback,V=c.mode,T=d.child,rt=T.sibling;var xt={mode:"hidden",children:E.children};return(V&1)===0&&c.child!==T?(E=c.child,E.childLanes=0,E.pendingProps=xt,c.deletions=null):(E=No(T,xt),E.subtreeFlags=T.subtreeFlags&14680064),rt!==null?I=No(rt,I):(I=ba(I,V,m,null),I.flags|=2),I.return=c,E.return=c,E.sibling=I,c.child=E,E=I,I=c.child,V=d.child.memoizedState,V=V===null?dm(m):{baseLanes:V.baseLanes|m,cachePool:null,transitions:V.transitions},I.memoizedState=V,I.childLanes=d.childLanes&~m,c.memoizedState=um,E}return I=d.child,d=I.sibling,E=No(I,{mode:"visible",children:E.children}),(c.mode&1)===0&&(E.lanes=m),E.return=c,E.sibling=null,d!==null&&(m=c.deletions,m===null?(c.deletions=[d],c.flags|=16):m.push(d)),c.child=E,c.memoizedState=null,E}function hm(d,c){return c=Cc({mode:"visible",children:c},d.mode,0,null),c.return=d,d.child=c}function fc(d,c,m,E){return E!==null&&Op(E),yl(c,d.child,null,m),d=hm(c,c.pendingProps.children),d.flags|=2,c.memoizedState=null,d}function cI(d,c,m,E,T,I,V){if(m)return c.flags&256?(c.flags&=-257,E=rm(Error(s(422))),fc(d,c,V,E)):c.memoizedState!==null?(c.child=d.child,c.flags|=128,null):(I=E.fallback,T=c.mode,E=Cc({mode:"visible",children:E.children},T,0,null),I=ba(I,T,V,null),I.flags|=2,E.return=c,I.return=c,E.sibling=I,c.child=E,(c.mode&1)!==0&&yl(c,d.child,null,V),c.child.memoizedState=dm(V),c.memoizedState=um,I);if((c.mode&1)===0)return fc(d,c,V,null);if(T.data==="$!"){if(E=T.nextSibling&&T.nextSibling.dataset,E)var rt=E.dgst;return E=rt,I=Error(s(419)),E=rm(I,E,void 0),fc(d,c,V,E)}if(rt=(V&d.childLanes)!==0,ci||rt){if(E=Cn,E!==null){switch(V&-V){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=(T&(E.suspendedLanes|V))!==0?0:T,T!==0&&T!==I.retryLane&&(I.retryLane=T,Gr(d,T),rr(E,d,T,-1))}return Cm(),E=rm(Error(s(421))),fc(d,c,V,E)}return T.data==="$?"?(c.flags|=128,c.child=d.child,c=wI.bind(null,d),T._reactRetry=c,null):(d=I.treeContext,Ai=yo(T.nextSibling),Si=c,qs=!0,er=null,d!==null&&(Fi[Pi++]=Br,Fi[Pi++]=Ur,Fi[Pi++]=ca,Br=d.id,Ur=d.overflow,ca=c),c=hm(c,E.children),c.flags|=4096,c)}function _b(d,c,m){d.lanes|=c;var E=d.alternate;E!==null&&(E.lanes|=c),Vp(d.return,c,m)}function cm(d,c,m,E,T){var I=d.memoizedState;I===null?d.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:E,tail:m,tailMode:T}:(I.isBackwards=c,I.rendering=null,I.renderingStartTime=0,I.last=E,I.tail=m,I.tailMode=T)}function yb(d,c,m){var E=c.pendingProps,T=E.revealOrder,I=E.tail;if(Kn(d,c,E.children,m),E=Qs.current,(E&2)!==0)E=E&1|2,c.flags|=128;else{if(d!==null&&(d.flags&128)!==0)t:for(d=c.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&_b(d,m,c);else if(d.tag===19)_b(d,m,c);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break t;for(;d.sibling===null;){if(d.return===null||d.return===c)break t;d=d.return}d.sibling.return=d.return,d=d.sibling}E&=1}if(Rs(Qs,E),(c.mode&1)===0)c.memoizedState=null;else switch(T){case"forwards":for(m=c.child,T=null;m!==null;)d=m.alternate,d!==null&&ac(d)===null&&(T=m),m=m.sibling;m=T,m===null?(T=c.child,c.child=null):(T=m.sibling,m.sibling=null),cm(c,!1,T,m,I);break;case"backwards":for(m=null,T=c.child,c.child=null;T!==null;){if(d=T.alternate,d!==null&&ac(d)===null){c.child=T;break}d=T.sibling,T.sibling=m,m=T,T=d}cm(c,!0,m,null,I);break;case"together":cm(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function pc(d,c){(c.mode&1)===0&&d!==null&&(d.alternate=null,c.alternate=null,c.flags|=2)}function jr(d,c,m){if(d!==null&&(c.dependencies=d.dependencies),_a|=c.lanes,(m&c.childLanes)===0)return null;if(d!==null&&c.child!==d.child)throw Error(s(153));if(c.child!==null){for(d=c.child,m=No(d,d.pendingProps),c.child=m,m.return=c;d.sibling!==null;)d=d.sibling,m=m.sibling=No(d,d.pendingProps),m.return=c;m.sibling=null}return c.child}function gI(d,c,m){switch(c.tag){case 3:fb(c),_l();break;case 5:Iv(c);break;case 1:hi(c.type)&&Kh(c);break;case 4:$p(c,c.stateNode.containerInfo);break;case 10:var E=c.type._context,T=c.memoizedProps.value;Rs(nc,E._currentValue),E._currentValue=T;break;case 13:if(E=c.memoizedState,E!==null)return E.dehydrated!==null?(Rs(Qs,Qs.current&1),c.flags|=128,null):(m&c.child.childLanes)!==0?mb(d,c,m):(Rs(Qs,Qs.current&1),d=jr(d,c,m),d!==null?d.sibling:null);Rs(Qs,Qs.current&1);break;case 19:if(E=(m&c.childLanes)!==0,(d.flags&128)!==0){if(E)return yb(d,c,m);c.flags|=128}if(T=c.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),Rs(Qs,Qs.current),E)break;return null;case 22:case 23:return c.lanes=0,hb(d,c,m)}return jr(d,c,m)}var xb,gm,vb,bb;xb=function(d,c){for(var m=c.child;m!==null;){if(m.tag===5||m.tag===6)d.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===c)break;for(;m.sibling===null;){if(m.return===null||m.return===c)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},gm=function(){},vb=function(d,c,m,E){var T=d.memoizedProps;if(T!==E){d=c.stateNode,pa(vr.current);var I=null;switch(m){case"input":T=Me(d,T),E=Me(d,E),I=[];break;case"select":T=Mt({},T,{value:void 0}),E=Mt({},E,{value:void 0}),I=[];break;case"textarea":T=ss(d,T),E=ss(d,E),I=[];break;default:typeof T.onClick!="function"&&typeof E.onClick=="function"&&(d.onclick=Wh)}gt(m,E);var V;m=null;for(Vt in T)if(!E.hasOwnProperty(Vt)&&T.hasOwnProperty(Vt)&&T[Vt]!=null)if(Vt==="style"){var rt=T[Vt];for(V in rt)rt.hasOwnProperty(V)&&(m||(m={}),m[V]="")}else Vt!=="dangerouslySetInnerHTML"&&Vt!=="children"&&Vt!=="suppressContentEditableWarning"&&Vt!=="suppressHydrationWarning"&&Vt!=="autoFocus"&&(i.hasOwnProperty(Vt)?I||(I=[]):(I=I||[]).push(Vt,null));for(Vt in E){var xt=E[Vt];if(rt=T!=null?T[Vt]:void 0,E.hasOwnProperty(Vt)&&xt!==rt&&(xt!=null||rt!=null))if(Vt==="style")if(rt){for(V in rt)!rt.hasOwnProperty(V)||xt&&xt.hasOwnProperty(V)||(m||(m={}),m[V]="");for(V in xt)xt.hasOwnProperty(V)&&rt[V]!==xt[V]&&(m||(m={}),m[V]=xt[V])}else m||(I||(I=[]),I.push(Vt,m)),m=xt;else Vt==="dangerouslySetInnerHTML"?(xt=xt?xt.__html:void 0,rt=rt?rt.__html:void 0,xt!=null&&rt!==xt&&(I=I||[]).push(Vt,xt)):Vt==="children"?typeof xt!="string"&&typeof xt!="number"||(I=I||[]).push(Vt,""+xt):Vt!=="suppressContentEditableWarning"&&Vt!=="suppressHydrationWarning"&&(i.hasOwnProperty(Vt)?(xt!=null&&Vt==="onScroll"&&Us("scroll",d),I||rt===xt||(I=[])):(I=I||[]).push(Vt,xt))}m&&(I=I||[]).push("style",m);var Vt=I;(c.updateQueue=Vt)&&(c.flags|=4)}},bb=function(d,c,m,E){m!==E&&(c.flags|=4)};function Xu(d,c){if(!qs)switch(d.tailMode){case"hidden":c=d.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?d.tail=null:m.sibling=null;break;case"collapsed":m=d.tail;for(var E=null;m!==null;)m.alternate!==null&&(E=m),m=m.sibling;E===null?c||d.tail===null?d.tail=null:d.tail.sibling=null:E.sibling=null}}function Bn(d){var c=d.alternate!==null&&d.alternate.child===d.child,m=0,E=0;if(c)for(var T=d.child;T!==null;)m|=T.lanes|T.childLanes,E|=T.subtreeFlags&14680064,E|=T.flags&14680064,T.return=d,T=T.sibling;else for(T=d.child;T!==null;)m|=T.lanes|T.childLanes,E|=T.subtreeFlags,E|=T.flags,T.return=d,T=T.sibling;return d.subtreeFlags|=E,d.childLanes=m,c}function fI(d,c,m){var E=c.pendingProps;switch(Pp(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(c),null;case 1:return hi(c.type)&&Zh(),Bn(c),null;case 3:return E=c.stateNode,bl(),Gs(di),Gs(Dn),Wp(),E.pendingContext&&(E.context=E.pendingContext,E.pendingContext=null),(d===null||d.child===null)&&(ec(c)?c.flags|=4:d===null||d.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,er!==null&&(Am(er),er=null))),gm(d,c),Bn(c),null;case 5:qp(c);var T=pa(Hu.current);if(m=c.type,d!==null&&c.stateNode!=null)vb(d,c,m,E,T),d.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!E){if(c.stateNode===null)throw Error(s(166));return Bn(c),null}if(d=pa(vr.current),ec(c)){E=c.stateNode,m=c.type;var I=c.memoizedProps;switch(E[xr]=c,E[Bu]=I,d=(c.mode&1)!==0,m){case"dialog":Us("cancel",E),Us("close",E);break;case"iframe":case"object":case"embed":Us("load",E);break;case"video":case"audio":for(T=0;T<zu.length;T++)Us(zu[T],E);break;case"source":Us("error",E);break;case"img":case"image":case"link":Us("error",E),Us("load",E);break;case"details":Us("toggle",E);break;case"input":ge(E,I),Us("invalid",E);break;case"select":E._wrapperState={wasMultiple:!!I.multiple},Us("invalid",E);break;case"textarea":ts(E,I),Us("invalid",E)}gt(m,I),T=null;for(var V in I)if(I.hasOwnProperty(V)){var rt=I[V];V==="children"?typeof rt=="string"?E.textContent!==rt&&(I.suppressHydrationWarning!==!0&&Yh(E.textContent,rt,d),T=["children",rt]):typeof rt=="number"&&E.textContent!==""+rt&&(I.suppressHydrationWarning!==!0&&Yh(E.textContent,rt,d),T=["children",""+rt]):i.hasOwnProperty(V)&&rt!=null&&V==="onScroll"&&Us("scroll",E)}switch(m){case"input":ce(E),Ge(E,I,!0);break;case"textarea":ce(E),Fe(E);break;case"select":case"option":break;default:typeof I.onClick=="function"&&(E.onclick=Wh)}E=T,c.updateQueue=E,E!==null&&(c.flags|=4)}else{V=T.nodeType===9?T:T.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=Oe(m)),d==="http://www.w3.org/1999/xhtml"?m==="script"?(d=V.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof E.is=="string"?d=V.createElement(m,{is:E.is}):(d=V.createElement(m),m==="select"&&(V=d,E.multiple?V.multiple=!0:E.size&&(V.size=E.size))):d=V.createElementNS(d,m),d[xr]=c,d[Bu]=E,xb(d,c,!1,!1),c.stateNode=d;t:{switch(V=k(m,E),m){case"dialog":Us("cancel",d),Us("close",d),T=E;break;case"iframe":case"object":case"embed":Us("load",d),T=E;break;case"video":case"audio":for(T=0;T<zu.length;T++)Us(zu[T],d);T=E;break;case"source":Us("error",d),T=E;break;case"img":case"image":case"link":Us("error",d),Us("load",d),T=E;break;case"details":Us("toggle",d),T=E;break;case"input":ge(d,E),T=Me(d,E),Us("invalid",d);break;case"option":T=E;break;case"select":d._wrapperState={wasMultiple:!!E.multiple},T=Mt({},E,{value:void 0}),Us("invalid",d);break;case"textarea":ts(d,E),T=ss(d,E),Us("invalid",d);break;default:T=E}gt(m,T),rt=T;for(I in rt)if(rt.hasOwnProperty(I)){var xt=rt[I];I==="style"?xs(d,xt):I==="dangerouslySetInnerHTML"?(xt=xt?xt.__html:void 0,xt!=null&&$s(d,xt)):I==="children"?typeof xt=="string"?(m!=="textarea"||xt!=="")&&Ms(d,xt):typeof xt=="number"&&Ms(d,""+xt):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(i.hasOwnProperty(I)?xt!=null&&I==="onScroll"&&Us("scroll",d):xt!=null&&S(d,I,xt,V))}switch(m){case"input":ce(d),Ge(d,E,!1);break;case"textarea":ce(d),Fe(d);break;case"option":E.value!=null&&d.setAttribute("value",""+ne(E.value));break;case"select":d.multiple=!!E.multiple,I=E.value,I!=null?Je(d,!!E.multiple,I,!1):E.defaultValue!=null&&Je(d,!!E.multiple,E.defaultValue,!0);break;default:typeof T.onClick=="function"&&(d.onclick=Wh)}switch(m){case"button":case"input":case"select":case"textarea":E=!!E.autoFocus;break t;case"img":E=!0;break t;default:E=!1}}E&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Bn(c),null;case 6:if(d&&c.stateNode!=null)bb(d,c,d.memoizedProps,E);else{if(typeof E!="string"&&c.stateNode===null)throw Error(s(166));if(m=pa(Hu.current),pa(vr.current),ec(c)){if(E=c.stateNode,m=c.memoizedProps,E[xr]=c,(I=E.nodeValue!==m)&&(d=Si,d!==null))switch(d.tag){case 3:Yh(E.nodeValue,m,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&Yh(E.nodeValue,m,(d.mode&1)!==0)}I&&(c.flags|=4)}else E=(m.nodeType===9?m:m.ownerDocument).createTextNode(E),E[xr]=c,c.stateNode=E}return Bn(c),null;case 13:if(Gs(Qs),E=c.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(qs&&Ai!==null&&(c.mode&1)!==0&&(c.flags&128)===0)Av(),_l(),c.flags|=98560,I=!1;else if(I=ec(c),E!==null&&E.dehydrated!==null){if(d===null){if(!I)throw Error(s(318));if(I=c.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(s(317));I[xr]=c}else _l(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Bn(c),I=!1}else er!==null&&(Am(er),er=null),I=!0;if(!I)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=m,c):(E=E!==null,E!==(d!==null&&d.memoizedState!==null)&&E&&(c.child.flags|=8192,(c.mode&1)!==0&&(d===null||(Qs.current&1)!==0?vn===0&&(vn=3):Cm())),c.updateQueue!==null&&(c.flags|=4),Bn(c),null);case 4:return bl(),gm(d,c),d===null&&Du(c.stateNode.containerInfo),Bn(c),null;case 10:return Gp(c.type._context),Bn(c),null;case 17:return hi(c.type)&&Zh(),Bn(c),null;case 19:if(Gs(Qs),I=c.memoizedState,I===null)return Bn(c),null;if(E=(c.flags&128)!==0,V=I.rendering,V===null)if(E)Xu(I,!1);else{if(vn!==0||d!==null&&(d.flags&128)!==0)for(d=c.child;d!==null;){if(V=ac(d),V!==null){for(c.flags|=128,Xu(I,!1),E=V.updateQueue,E!==null&&(c.updateQueue=E,c.flags|=4),c.subtreeFlags=0,E=m,m=c.child;m!==null;)I=m,d=E,I.flags&=14680066,V=I.alternate,V===null?(I.childLanes=0,I.lanes=d,I.child=null,I.subtreeFlags=0,I.memoizedProps=null,I.memoizedState=null,I.updateQueue=null,I.dependencies=null,I.stateNode=null):(I.childLanes=V.childLanes,I.lanes=V.lanes,I.child=V.child,I.subtreeFlags=0,I.deletions=null,I.memoizedProps=V.memoizedProps,I.memoizedState=V.memoizedState,I.updateQueue=V.updateQueue,I.type=V.type,d=V.dependencies,I.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),m=m.sibling;return Rs(Qs,Qs.current&1|2),c.child}d=d.sibling}I.tail!==null&&tt()>wl&&(c.flags|=128,E=!0,Xu(I,!1),c.lanes=4194304)}else{if(!E)if(d=ac(V),d!==null){if(c.flags|=128,E=!0,m=d.updateQueue,m!==null&&(c.updateQueue=m,c.flags|=4),Xu(I,!0),I.tail===null&&I.tailMode==="hidden"&&!V.alternate&&!qs)return Bn(c),null}else 2*tt()-I.renderingStartTime>wl&&m!==1073741824&&(c.flags|=128,E=!0,Xu(I,!1),c.lanes=4194304);I.isBackwards?(V.sibling=c.child,c.child=V):(m=I.last,m!==null?m.sibling=V:c.child=V,I.last=V)}return I.tail!==null?(c=I.tail,I.rendering=c,I.tail=c.sibling,I.renderingStartTime=tt(),c.sibling=null,m=Qs.current,Rs(Qs,E?m&1|2:m&1),c):(Bn(c),null);case 22:case 23:return Tm(),E=c.memoizedState!==null,d!==null&&d.memoizedState!==null!==E&&(c.flags|=8192),E&&(c.mode&1)!==0?(wi&1073741824)!==0&&(Bn(c),c.subtreeFlags&6&&(c.flags|=8192)):Bn(c),null;case 24:return null;case 25:return null}throw Error(s(156,c.tag))}function pI(d,c){switch(Pp(c),c.tag){case 1:return hi(c.type)&&Zh(),d=c.flags,d&65536?(c.flags=d&-65537|128,c):null;case 3:return bl(),Gs(di),Gs(Dn),Wp(),d=c.flags,(d&65536)!==0&&(d&128)===0?(c.flags=d&-65537|128,c):null;case 5:return qp(c),null;case 13:if(Gs(Qs),d=c.memoizedState,d!==null&&d.dehydrated!==null){if(c.alternate===null)throw Error(s(340));_l()}return d=c.flags,d&65536?(c.flags=d&-65537|128,c):null;case 19:return Gs(Qs),null;case 4:return bl(),null;case 10:return Gp(c.type._context),null;case 22:case 23:return Tm(),null;case 24:return null;default:return null}}var mc=!1,Un=!1,mI=typeof WeakSet=="function"?WeakSet:Set,Le=null;function Sl(d,c){var m=d.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(E){sn(d,c,E)}else m.current=null}function fm(d,c,m){try{m()}catch(E){sn(d,c,E)}}var Eb=!1;function _I(d,c){if(Tp=Ei,d=tv(),yp(d)){if("selectionStart"in d)var m={start:d.selectionStart,end:d.selectionEnd};else t:{m=(m=d.ownerDocument)&&m.defaultView||window;var E=m.getSelection&&m.getSelection();if(E&&E.rangeCount!==0){m=E.anchorNode;var T=E.anchorOffset,I=E.focusNode;E=E.focusOffset;try{m.nodeType,I.nodeType}catch{m=null;break t}var V=0,rt=-1,xt=-1,Vt=0,de=0,fe=d,le=null;e:for(;;){for(var Ae;fe!==m||T!==0&&fe.nodeType!==3||(rt=V+T),fe!==I||E!==0&&fe.nodeType!==3||(xt=V+E),fe.nodeType===3&&(V+=fe.nodeValue.length),(Ae=fe.firstChild)!==null;)le=fe,fe=Ae;for(;;){if(fe===d)break e;if(le===m&&++Vt===T&&(rt=V),le===I&&++de===E&&(xt=V),(Ae=fe.nextSibling)!==null)break;fe=le,le=fe.parentNode}fe=Ae}m=rt===-1||xt===-1?null:{start:rt,end:xt}}else m=null}m=m||{start:0,end:0}}else m=null;for(Cp={focusedElem:d,selectionRange:m},Ei=!1,Le=c;Le!==null;)if(c=Le,d=c.child,(c.subtreeFlags&1028)!==0&&d!==null)d.return=c,Le=d;else for(;Le!==null;){c=Le;try{var Ne=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Ne!==null){var ke=Ne.memoizedProps,dn=Ne.memoizedState,kt=c.stateNode,wt=kt.getSnapshotBeforeUpdate(c.elementType===c.type?ke:sr(c.type,ke),dn);kt.__reactInternalSnapshotBeforeUpdate=wt}break;case 3:var Dt=c.stateNode.containerInfo;Dt.nodeType===1?Dt.textContent="":Dt.nodeType===9&&Dt.documentElement&&Dt.removeChild(Dt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(ye){sn(c,c.return,ye)}if(d=c.sibling,d!==null){d.return=c.return,Le=d;break}Le=c.return}return Ne=Eb,Eb=!1,Ne}function Zu(d,c,m){var E=c.updateQueue;if(E=E!==null?E.lastEffect:null,E!==null){var T=E=E.next;do{if((T.tag&d)===d){var I=T.destroy;T.destroy=void 0,I!==void 0&&fm(c,m,I)}T=T.next}while(T!==E)}}function _c(d,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var m=c=c.next;do{if((m.tag&d)===d){var E=m.create;m.destroy=E()}m=m.next}while(m!==c)}}function pm(d){var c=d.ref;if(c!==null){var m=d.stateNode;switch(d.tag){case 5:d=m;break;default:d=m}typeof c=="function"?c(d):c.current=d}}function Sb(d){var c=d.alternate;c!==null&&(d.alternate=null,Sb(c)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(c=d.stateNode,c!==null&&(delete c[xr],delete c[Bu],delete c[kp],delete c[Jk],delete c[tI])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function Ab(d){return d.tag===5||d.tag===3||d.tag===4}function wb(d){t:for(;;){for(;d.sibling===null;){if(d.return===null||Ab(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue t;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function mm(d,c,m){var E=d.tag;if(E===5||E===6)d=d.stateNode,c?m.nodeType===8?m.parentNode.insertBefore(d,c):m.insertBefore(d,c):(m.nodeType===8?(c=m.parentNode,c.insertBefore(d,m)):(c=m,c.appendChild(d)),m=m._reactRootContainer,m!=null||c.onclick!==null||(c.onclick=Wh));else if(E!==4&&(d=d.child,d!==null))for(mm(d,c,m),d=d.sibling;d!==null;)mm(d,c,m),d=d.sibling}function _m(d,c,m){var E=d.tag;if(E===5||E===6)d=d.stateNode,c?m.insertBefore(d,c):m.appendChild(d);else if(E!==4&&(d=d.child,d!==null))for(_m(d,c,m),d=d.sibling;d!==null;)_m(d,c,m),d=d.sibling}var In=null,nr=!1;function Ao(d,c,m){for(m=m.child;m!==null;)Tb(d,c,m),m=m.sibling}function Tb(d,c,m){if(Lt&&typeof Lt.onCommitFiberUnmount=="function")try{Lt.onCommitFiberUnmount(Pt,m)}catch{}switch(m.tag){case 5:Un||Sl(m,c);case 6:var E=In,T=nr;In=null,Ao(d,c,m),In=E,nr=T,In!==null&&(nr?(d=In,m=m.stateNode,d.nodeType===8?d.parentNode.removeChild(m):d.removeChild(m)):In.removeChild(m.stateNode));break;case 18:In!==null&&(nr?(d=In,m=m.stateNode,d.nodeType===8?Mp(d.parentNode,m):d.nodeType===1&&Mp(d,m),mr(d)):Mp(In,m.stateNode));break;case 4:E=In,T=nr,In=m.stateNode.containerInfo,nr=!0,Ao(d,c,m),In=E,nr=T;break;case 0:case 11:case 14:case 15:if(!Un&&(E=m.updateQueue,E!==null&&(E=E.lastEffect,E!==null))){T=E=E.next;do{var I=T,V=I.destroy;I=I.tag,V!==void 0&&((I&2)!==0||(I&4)!==0)&&fm(m,c,V),T=T.next}while(T!==E)}Ao(d,c,m);break;case 1:if(!Un&&(Sl(m,c),E=m.stateNode,typeof E.componentWillUnmount=="function"))try{E.props=m.memoizedProps,E.state=m.memoizedState,E.componentWillUnmount()}catch(rt){sn(m,c,rt)}Ao(d,c,m);break;case 21:Ao(d,c,m);break;case 22:m.mode&1?(Un=(E=Un)||m.memoizedState!==null,Ao(d,c,m),Un=E):Ao(d,c,m);break;default:Ao(d,c,m)}}function Cb(d){var c=d.updateQueue;if(c!==null){d.updateQueue=null;var m=d.stateNode;m===null&&(m=d.stateNode=new mI),c.forEach(function(E){var T=TI.bind(null,d,E);m.has(E)||(m.add(E),E.then(T,T))})}}function ir(d,c){var m=c.deletions;if(m!==null)for(var E=0;E<m.length;E++){var T=m[E];try{var I=d,V=c,rt=V;t:for(;rt!==null;){switch(rt.tag){case 5:In=rt.stateNode,nr=!1;break t;case 3:In=rt.stateNode.containerInfo,nr=!0;break t;case 4:In=rt.stateNode.containerInfo,nr=!0;break t}rt=rt.return}if(In===null)throw Error(s(160));Tb(I,V,T),In=null,nr=!1;var xt=T.alternate;xt!==null&&(xt.return=null),T.return=null}catch(Vt){sn(T,c,Vt)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)Lb(c,d),c=c.sibling}function Lb(d,c){var m=d.alternate,E=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(ir(c,d),Er(d),E&4){try{Zu(3,d,d.return),_c(3,d)}catch(ke){sn(d,d.return,ke)}try{Zu(5,d,d.return)}catch(ke){sn(d,d.return,ke)}}break;case 1:ir(c,d),Er(d),E&512&&m!==null&&Sl(m,m.return);break;case 5:if(ir(c,d),Er(d),E&512&&m!==null&&Sl(m,m.return),d.flags&32){var T=d.stateNode;try{Ms(T,"")}catch(ke){sn(d,d.return,ke)}}if(E&4&&(T=d.stateNode,T!=null)){var I=d.memoizedProps,V=m!==null?m.memoizedProps:I,rt=d.type,xt=d.updateQueue;if(d.updateQueue=null,xt!==null)try{rt==="input"&&I.type==="radio"&&I.name!=null&&ze(T,I),k(rt,V);var Vt=k(rt,I);for(V=0;V<xt.length;V+=2){var de=xt[V],fe=xt[V+1];de==="style"?xs(T,fe):de==="dangerouslySetInnerHTML"?$s(T,fe):de==="children"?Ms(T,fe):S(T,de,fe,Vt)}switch(rt){case"input":is(T,I);break;case"textarea":hs(T,I);break;case"select":var le=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!I.multiple;var Ae=I.value;Ae!=null?Je(T,!!I.multiple,Ae,!1):le!==!!I.multiple&&(I.defaultValue!=null?Je(T,!!I.multiple,I.defaultValue,!0):Je(T,!!I.multiple,I.multiple?[]:"",!1))}T[Bu]=I}catch(ke){sn(d,d.return,ke)}}break;case 6:if(ir(c,d),Er(d),E&4){if(d.stateNode===null)throw Error(s(162));T=d.stateNode,I=d.memoizedProps;try{T.nodeValue=I}catch(ke){sn(d,d.return,ke)}}break;case 3:if(ir(c,d),Er(d),E&4&&m!==null&&m.memoizedState.isDehydrated)try{mr(c.containerInfo)}catch(ke){sn(d,d.return,ke)}break;case 4:ir(c,d),Er(d);break;case 13:ir(c,d),Er(d),T=d.child,T.flags&8192&&(I=T.memoizedState!==null,T.stateNode.isHidden=I,!I||T.alternate!==null&&T.alternate.memoizedState!==null||(vm=tt())),E&4&&Cb(d);break;case 22:if(de=m!==null&&m.memoizedState!==null,d.mode&1?(Un=(Vt=Un)||de,ir(c,d),Un=Vt):ir(c,d),Er(d),E&8192){if(Vt=d.memoizedState!==null,(d.stateNode.isHidden=Vt)&&!de&&(d.mode&1)!==0)for(Le=d,de=d.child;de!==null;){for(fe=Le=de;Le!==null;){switch(le=Le,Ae=le.child,le.tag){case 0:case 11:case 14:case 15:Zu(4,le,le.return);break;case 1:Sl(le,le.return);var Ne=le.stateNode;if(typeof Ne.componentWillUnmount=="function"){E=le,m=le.return;try{c=E,Ne.props=c.memoizedProps,Ne.state=c.memoizedState,Ne.componentWillUnmount()}catch(ke){sn(E,m,ke)}}break;case 5:Sl(le,le.return);break;case 22:if(le.memoizedState!==null){kb(fe);continue}}Ae!==null?(Ae.return=le,Le=Ae):kb(fe)}de=de.sibling}t:for(de=null,fe=d;;){if(fe.tag===5){if(de===null){de=fe;try{T=fe.stateNode,Vt?(I=T.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none"):(rt=fe.stateNode,xt=fe.memoizedProps.style,V=xt!=null&&xt.hasOwnProperty("display")?xt.display:null,rt.style.display=un("display",V))}catch(ke){sn(d,d.return,ke)}}}else if(fe.tag===6){if(de===null)try{fe.stateNode.nodeValue=Vt?"":fe.memoizedProps}catch(ke){sn(d,d.return,ke)}}else if((fe.tag!==22&&fe.tag!==23||fe.memoizedState===null||fe===d)&&fe.child!==null){fe.child.return=fe,fe=fe.child;continue}if(fe===d)break t;for(;fe.sibling===null;){if(fe.return===null||fe.return===d)break t;de===fe&&(de=null),fe=fe.return}de===fe&&(de=null),fe.sibling.return=fe.return,fe=fe.sibling}}break;case 19:ir(c,d),Er(d),E&4&&Cb(d);break;case 21:break;default:ir(c,d),Er(d)}}function Er(d){var c=d.flags;if(c&2){try{t:{for(var m=d.return;m!==null;){if(Ab(m)){var E=m;break t}m=m.return}throw Error(s(160))}switch(E.tag){case 5:var T=E.stateNode;E.flags&32&&(Ms(T,""),E.flags&=-33);var I=wb(d);_m(d,I,T);break;case 3:case 4:var V=E.stateNode.containerInfo,rt=wb(d);mm(d,rt,V);break;default:throw Error(s(161))}}catch(xt){sn(d,d.return,xt)}d.flags&=-3}c&4096&&(d.flags&=-4097)}function yI(d,c,m){Le=d,Nb(d)}function Nb(d,c,m){for(var E=(d.mode&1)!==0;Le!==null;){var T=Le,I=T.child;if(T.tag===22&&E){var V=T.memoizedState!==null||mc;if(!V){var rt=T.alternate,xt=rt!==null&&rt.memoizedState!==null||Un;rt=mc;var Vt=Un;if(mc=V,(Un=xt)&&!Vt)for(Le=T;Le!==null;)V=Le,xt=V.child,V.tag===22&&V.memoizedState!==null?Ib(T):xt!==null?(xt.return=V,Le=xt):Ib(T);for(;I!==null;)Le=I,Nb(I),I=I.sibling;Le=T,mc=rt,Un=Vt}Mb(d)}else(T.subtreeFlags&8772)!==0&&I!==null?(I.return=T,Le=I):Mb(d)}}function Mb(d){for(;Le!==null;){var c=Le;if((c.flags&8772)!==0){var m=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Un||_c(5,c);break;case 1:var E=c.stateNode;if(c.flags&4&&!Un)if(m===null)E.componentDidMount();else{var T=c.elementType===c.type?m.memoizedProps:sr(c.type,m.memoizedProps);E.componentDidUpdate(T,m.memoizedState,E.__reactInternalSnapshotBeforeUpdate)}var I=c.updateQueue;I!==null&&kv(c,I,E);break;case 3:var V=c.updateQueue;if(V!==null){if(m=null,c.child!==null)switch(c.child.tag){case 5:m=c.child.stateNode;break;case 1:m=c.child.stateNode}kv(c,V,m)}break;case 5:var rt=c.stateNode;if(m===null&&c.flags&4){m=rt;var xt=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":xt.autoFocus&&m.focus();break;case"img":xt.src&&(m.src=xt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var Vt=c.alternate;if(Vt!==null){var de=Vt.memoizedState;if(de!==null){var fe=de.dehydrated;fe!==null&&mr(fe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}Un||c.flags&512&&pm(c)}catch(le){sn(c,c.return,le)}}if(c===d){Le=null;break}if(m=c.sibling,m!==null){m.return=c.return,Le=m;break}Le=c.return}}function kb(d){for(;Le!==null;){var c=Le;if(c===d){Le=null;break}var m=c.sibling;if(m!==null){m.return=c.return,Le=m;break}Le=c.return}}function Ib(d){for(;Le!==null;){var c=Le;try{switch(c.tag){case 0:case 11:case 15:var m=c.return;try{_c(4,c)}catch(xt){sn(c,m,xt)}break;case 1:var E=c.stateNode;if(typeof E.componentDidMount=="function"){var T=c.return;try{E.componentDidMount()}catch(xt){sn(c,T,xt)}}var I=c.return;try{pm(c)}catch(xt){sn(c,I,xt)}break;case 5:var V=c.return;try{pm(c)}catch(xt){sn(c,V,xt)}}}catch(xt){sn(c,c.return,xt)}if(c===d){Le=null;break}var rt=c.sibling;if(rt!==null){rt.return=c.return,Le=rt;break}Le=c.return}}var xI=Math.ceil,yc=A.ReactCurrentDispatcher,ym=A.ReactCurrentOwner,Oi=A.ReactCurrentBatchConfig,fs=0,Cn=null,mn=null,Rn=0,wi=0,Al=xo(0),vn=0,Ku=null,_a=0,xc=0,xm=0,Qu=null,gi=null,vm=0,wl=1/0,Hr=null,vc=!1,bm=null,wo=null,bc=!1,To=null,Ec=0,Ju=0,Em=null,Sc=-1,Ac=0;function Qn(){return(fs&6)!==0?tt():Sc!==-1?Sc:Sc=tt()}function Co(d){return(d.mode&1)===0?1:(fs&2)!==0&&Rn!==0?Rn&-Rn:sI.transition!==null?(Ac===0&&(Ac=W()),Ac):(d=ie,d!==0||(d=window.event,d=d===void 0?16:Au(d.type)),d)}function rr(d,c,m,E){if(50<Ju)throw Ju=0,Em=null,Error(s(185));bt(d,m,E),((fs&2)===0||d!==Cn)&&(d===Cn&&((fs&2)===0&&(xc|=m),vn===4&&Lo(d,Rn)),fi(d,E),m===1&&fs===0&&(c.mode&1)===0&&(wl=tt()+500,Qh&&bo()))}function fi(d,c){var m=d.callbackNode;R(d,c);var E=re(d,d===Cn?Rn:0);if(E===0)m!==null&&Y(m),d.callbackNode=null,d.callbackPriority=0;else if(c=E&-E,d.callbackPriority!==c){if(m!=null&&Y(m),c===1)d.tag===0?eI(Fb.bind(null,d)):xv(Fb.bind(null,d)),Kk(function(){(fs&6)===0&&bo()}),m=null;else{switch(Ee(E)){case 1:m=_t;break;case 4:m=it;break;case 16:m=vt;break;case 536870912:m=Ft;break;default:m=vt}m=Vb(m,Rb.bind(null,d))}d.callbackPriority=c,d.callbackNode=m}}function Rb(d,c){if(Sc=-1,Ac=0,(fs&6)!==0)throw Error(s(327));var m=d.callbackNode;if(Tl()&&d.callbackNode!==m)return null;var E=re(d,d===Cn?Rn:0);if(E===0)return null;if((E&30)!==0||(E&d.expiredLanes)!==0||c)c=wc(d,E);else{c=E;var T=fs;fs|=2;var I=zb();(Cn!==d||Rn!==c)&&(Hr=null,wl=tt()+500,xa(d,c));do try{EI();break}catch(rt){Pb(d,rt)}while(!0);Up(),yc.current=I,fs=T,mn!==null?c=0:(Cn=null,Rn=0,c=vn)}if(c!==0){if(c===2&&(T=U(d),T!==0&&(E=T,c=Sm(d,T))),c===1)throw m=Ku,xa(d,0),Lo(d,E),fi(d,tt()),m;if(c===6)Lo(d,E);else{if(T=d.current.alternate,(E&30)===0&&!vI(T)&&(c=wc(d,E),c===2&&(I=U(d),I!==0&&(E=I,c=Sm(d,I))),c===1))throw m=Ku,xa(d,0),Lo(d,E),fi(d,tt()),m;switch(d.finishedWork=T,d.finishedLanes=E,c){case 0:case 1:throw Error(s(345));case 2:va(d,gi,Hr);break;case 3:if(Lo(d,E),(E&130023424)===E&&(c=vm+500-tt(),10<c)){if(re(d,0)!==0)break;if(T=d.suspendedLanes,(T&E)!==E){Qn(),d.pingedLanes|=d.suspendedLanes&T;break}d.timeoutHandle=Np(va.bind(null,d,gi,Hr),c);break}va(d,gi,Hr);break;case 4:if(Lo(d,E),(E&4194240)===E)break;for(c=d.eventTimes,T=-1;0<E;){var V=31-$t(E);I=1<<V,V=c[V],V>T&&(T=V),E&=~I}if(E=T,E=tt()-E,E=(120>E?120:480>E?480:1080>E?1080:1920>E?1920:3e3>E?3e3:4320>E?4320:1960*xI(E/1960))-E,10<E){d.timeoutHandle=Np(va.bind(null,d,gi,Hr),E);break}va(d,gi,Hr);break;case 5:va(d,gi,Hr);break;default:throw Error(s(329))}}}return fi(d,tt()),d.callbackNode===m?Rb.bind(null,d):null}function Sm(d,c){var m=Qu;return d.current.memoizedState.isDehydrated&&(xa(d,c).flags|=256),d=wc(d,c),d!==2&&(c=gi,gi=m,c!==null&&Am(c)),d}function Am(d){gi===null?gi=d:gi.push.apply(gi,d)}function vI(d){for(var c=d;;){if(c.flags&16384){var m=c.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var E=0;E<m.length;E++){var T=m[E],I=T.getSnapshot;T=T.value;try{if(!tr(I(),T))return!1}catch{return!1}}}if(m=c.child,c.subtreeFlags&16384&&m!==null)m.return=c,c=m;else{if(c===d)break;for(;c.sibling===null;){if(c.return===null||c.return===d)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Lo(d,c){for(c&=~xm,c&=~xc,d.suspendedLanes|=c,d.pingedLanes&=~c,d=d.expirationTimes;0<c;){var m=31-$t(c),E=1<<m;d[m]=-1,c&=~E}}function Fb(d){if((fs&6)!==0)throw Error(s(327));Tl();var c=re(d,0);if((c&1)===0)return fi(d,tt()),null;var m=wc(d,c);if(d.tag!==0&&m===2){var E=U(d);E!==0&&(c=E,m=Sm(d,E))}if(m===1)throw m=Ku,xa(d,0),Lo(d,c),fi(d,tt()),m;if(m===6)throw Error(s(345));return d.finishedWork=d.current.alternate,d.finishedLanes=c,va(d,gi,Hr),fi(d,tt()),null}function wm(d,c){var m=fs;fs|=1;try{return d(c)}finally{fs=m,fs===0&&(wl=tt()+500,Qh&&bo())}}function ya(d){To!==null&&To.tag===0&&(fs&6)===0&&Tl();var c=fs;fs|=1;var m=Oi.transition,E=ie;try{if(Oi.transition=null,ie=1,d)return d()}finally{ie=E,Oi.transition=m,fs=c,(fs&6)===0&&bo()}}function Tm(){wi=Al.current,Gs(Al)}function xa(d,c){d.finishedWork=null,d.finishedLanes=0;var m=d.timeoutHandle;if(m!==-1&&(d.timeoutHandle=-1,Zk(m)),mn!==null)for(m=mn.return;m!==null;){var E=m;switch(Pp(E),E.tag){case 1:E=E.type.childContextTypes,E!=null&&Zh();break;case 3:bl(),Gs(di),Gs(Dn),Wp();break;case 5:qp(E);break;case 4:bl();break;case 13:Gs(Qs);break;case 19:Gs(Qs);break;case 10:Gp(E.type._context);break;case 22:case 23:Tm()}m=m.return}if(Cn=d,mn=d=No(d.current,null),Rn=wi=c,vn=0,Ku=null,xm=xc=_a=0,gi=Qu=null,fa!==null){for(c=0;c<fa.length;c++)if(m=fa[c],E=m.interleaved,E!==null){m.interleaved=null;var T=E.next,I=m.pending;if(I!==null){var V=I.next;I.next=T,E.next=V}m.pending=E}fa=null}return d}function Pb(d,c){do{var m=mn;try{if(Up(),lc.current=cc,uc){for(var E=Js.memoizedState;E!==null;){var T=E.queue;T!==null&&(T.pending=null),E=E.next}uc=!1}if(ma=0,Tn=xn=Js=null,$u=!1,qu=0,ym.current=null,m===null||m.return===null){vn=1,Ku=c,mn=null;break}t:{var I=d,V=m.return,rt=m,xt=c;if(c=Rn,rt.flags|=32768,xt!==null&&typeof xt=="object"&&typeof xt.then=="function"){var Vt=xt,de=rt,fe=de.tag;if((de.mode&1)===0&&(fe===0||fe===11||fe===15)){var le=de.alternate;le?(de.updateQueue=le.updateQueue,de.memoizedState=le.memoizedState,de.lanes=le.lanes):(de.updateQueue=null,de.memoizedState=null)}var Ae=ob(V);if(Ae!==null){Ae.flags&=-257,ab(Ae,V,rt,I,c),Ae.mode&1&&rb(I,Vt,c),c=Ae,xt=Vt;var Ne=c.updateQueue;if(Ne===null){var ke=new Set;ke.add(xt),c.updateQueue=ke}else Ne.add(xt);break t}else{if((c&1)===0){rb(I,Vt,c),Cm();break t}xt=Error(s(426))}}else if(qs&&rt.mode&1){var dn=ob(V);if(dn!==null){(dn.flags&65536)===0&&(dn.flags|=256),ab(dn,V,rt,I,c),Op(El(xt,rt));break t}}I=xt=El(xt,rt),vn!==4&&(vn=2),Qu===null?Qu=[I]:Qu.push(I),I=V;do{switch(I.tag){case 3:I.flags|=65536,c&=-c,I.lanes|=c;var kt=nb(I,xt,c);Mv(I,kt);break t;case 1:rt=xt;var wt=I.type,Dt=I.stateNode;if((I.flags&128)===0&&(typeof wt.getDerivedStateFromError=="function"||Dt!==null&&typeof Dt.componentDidCatch=="function"&&(wo===null||!wo.has(Dt)))){I.flags|=65536,c&=-c,I.lanes|=c;var ye=ib(I,rt,c);Mv(I,ye);break t}}I=I.return}while(I!==null)}Ob(m)}catch(Re){c=Re,mn===m&&m!==null&&(mn=m=m.return);continue}break}while(!0)}function zb(){var d=yc.current;return yc.current=cc,d===null?cc:d}function Cm(){(vn===0||vn===3||vn===2)&&(vn=4),Cn===null||(_a&268435455)===0&&(xc&268435455)===0||Lo(Cn,Rn)}function wc(d,c){var m=fs;fs|=2;var E=zb();(Cn!==d||Rn!==c)&&(Hr=null,xa(d,c));do try{bI();break}catch(T){Pb(d,T)}while(!0);if(Up(),fs=m,yc.current=E,mn!==null)throw Error(s(261));return Cn=null,Rn=0,vn}function bI(){for(;mn!==null;)Db(mn)}function EI(){for(;mn!==null&&!et();)Db(mn)}function Db(d){var c=Gb(d.alternate,d,wi);d.memoizedProps=d.pendingProps,c===null?Ob(d):mn=c,ym.current=null}function Ob(d){var c=d;do{var m=c.alternate;if(d=c.return,(c.flags&32768)===0){if(m=fI(m,c,wi),m!==null){mn=m;return}}else{if(m=pI(m,c),m!==null){m.flags&=32767,mn=m;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{vn=6,mn=null;return}}if(c=c.sibling,c!==null){mn=c;return}mn=c=d}while(c!==null);vn===0&&(vn=5)}function va(d,c,m){var E=ie,T=Oi.transition;try{Oi.transition=null,ie=1,SI(d,c,m,E)}finally{Oi.transition=T,ie=E}return null}function SI(d,c,m,E){do Tl();while(To!==null);if((fs&6)!==0)throw Error(s(327));m=d.finishedWork;var T=d.finishedLanes;if(m===null)return null;if(d.finishedWork=null,d.finishedLanes=0,m===d.current)throw Error(s(177));d.callbackNode=null,d.callbackPriority=0;var I=m.lanes|m.childLanes;if(It(d,I),d===Cn&&(mn=Cn=null,Rn=0),(m.subtreeFlags&2064)===0&&(m.flags&2064)===0||bc||(bc=!0,Vb(vt,function(){return Tl(),null})),I=(m.flags&15990)!==0,(m.subtreeFlags&15990)!==0||I){I=Oi.transition,Oi.transition=null;var V=ie;ie=1;var rt=fs;fs|=4,ym.current=null,_I(d,m),Lb(m,d),jk(Cp),Ei=!!Tp,Cp=Tp=null,d.current=m,yI(m),J(),fs=rt,ie=V,Oi.transition=I}else d.current=m;if(bc&&(bc=!1,To=d,Ec=T),I=d.pendingLanes,I===0&&(wo=null),Yt(m.stateNode),fi(d,tt()),c!==null)for(E=d.onRecoverableError,m=0;m<c.length;m++)T=c[m],E(T.value,{componentStack:T.stack,digest:T.digest});if(vc)throw vc=!1,d=bm,bm=null,d;return(Ec&1)!==0&&d.tag!==0&&Tl(),I=d.pendingLanes,(I&1)!==0?d===Em?Ju++:(Ju=0,Em=d):Ju=0,bo(),null}function Tl(){if(To!==null){var d=Ee(Ec),c=Oi.transition,m=ie;try{if(Oi.transition=null,ie=16>d?16:d,To===null)var E=!1;else{if(d=To,To=null,Ec=0,(fs&6)!==0)throw Error(s(331));var T=fs;for(fs|=4,Le=d.current;Le!==null;){var I=Le,V=I.child;if((Le.flags&16)!==0){var rt=I.deletions;if(rt!==null){for(var xt=0;xt<rt.length;xt++){var Vt=rt[xt];for(Le=Vt;Le!==null;){var de=Le;switch(de.tag){case 0:case 11:case 15:Zu(8,de,I)}var fe=de.child;if(fe!==null)fe.return=de,Le=fe;else for(;Le!==null;){de=Le;var le=de.sibling,Ae=de.return;if(Sb(de),de===Vt){Le=null;break}if(le!==null){le.return=Ae,Le=le;break}Le=Ae}}}var Ne=I.alternate;if(Ne!==null){var ke=Ne.child;if(ke!==null){Ne.child=null;do{var dn=ke.sibling;ke.sibling=null,ke=dn}while(ke!==null)}}Le=I}}if((I.subtreeFlags&2064)!==0&&V!==null)V.return=I,Le=V;else t:for(;Le!==null;){if(I=Le,(I.flags&2048)!==0)switch(I.tag){case 0:case 11:case 15:Zu(9,I,I.return)}var kt=I.sibling;if(kt!==null){kt.return=I.return,Le=kt;break t}Le=I.return}}var wt=d.current;for(Le=wt;Le!==null;){V=Le;var Dt=V.child;if((V.subtreeFlags&2064)!==0&&Dt!==null)Dt.return=V,Le=Dt;else t:for(V=wt;Le!==null;){if(rt=Le,(rt.flags&2048)!==0)try{switch(rt.tag){case 0:case 11:case 15:_c(9,rt)}}catch(Re){sn(rt,rt.return,Re)}if(rt===V){Le=null;break t}var ye=rt.sibling;if(ye!==null){ye.return=rt.return,Le=ye;break t}Le=rt.return}}if(fs=T,bo(),Lt&&typeof Lt.onPostCommitFiberRoot=="function")try{Lt.onPostCommitFiberRoot(Pt,d)}catch{}E=!0}return E}finally{ie=m,Oi.transition=c}}return!1}function Bb(d,c,m){c=El(m,c),c=nb(d,c,1),d=So(d,c,1),c=Qn(),d!==null&&(bt(d,1,c),fi(d,c))}function sn(d,c,m){if(d.tag===3)Bb(d,d,m);else for(;c!==null;){if(c.tag===3){Bb(c,d,m);break}else if(c.tag===1){var E=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(wo===null||!wo.has(E))){d=El(m,d),d=ib(c,d,1),c=So(c,d,1),d=Qn(),c!==null&&(bt(c,1,d),fi(c,d));break}}c=c.return}}function AI(d,c,m){var E=d.pingCache;E!==null&&E.delete(c),c=Qn(),d.pingedLanes|=d.suspendedLanes&m,Cn===d&&(Rn&m)===m&&(vn===4||vn===3&&(Rn&130023424)===Rn&&500>tt()-vm?xa(d,0):xm|=m),fi(d,c)}function Ub(d,c){c===0&&((d.mode&1)===0?c=1:(c=ee,ee<<=1,(ee&130023424)===0&&(ee=4194304)));var m=Qn();d=Gr(d,c),d!==null&&(bt(d,c,m),fi(d,m))}function wI(d){var c=d.memoizedState,m=0;c!==null&&(m=c.retryLane),Ub(d,m)}function TI(d,c){var m=0;switch(d.tag){case 13:var E=d.stateNode,T=d.memoizedState;T!==null&&(m=T.retryLane);break;case 19:E=d.stateNode;break;default:throw Error(s(314))}E!==null&&E.delete(c),Ub(d,m)}var Gb;Gb=function(d,c,m){if(d!==null)if(d.memoizedProps!==c.pendingProps||di.current)ci=!0;else{if((d.lanes&m)===0&&(c.flags&128)===0)return ci=!1,gI(d,c,m);ci=(d.flags&131072)!==0}else ci=!1,qs&&(c.flags&1048576)!==0&&vv(c,tc,c.index);switch(c.lanes=0,c.tag){case 2:var E=c.type;pc(d,c),d=c.pendingProps;var T=fl(c,Dn.current);vl(c,m),T=Kp(null,c,E,d,T,m);var I=Qp();return c.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,hi(E)?(I=!0,Kh(c)):I=!1,c.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,Hp(c),T.updater=gc,c.stateNode=T,T._reactInternals=c,im(c,E,d,m),c=lm(null,c,E,!0,I,m)):(c.tag=0,qs&&I&&Fp(c),Kn(null,c,T,m),c=c.child),c;case 16:E=c.elementType;t:{switch(pc(d,c),d=c.pendingProps,T=E._init,E=T(E._payload),c.type=E,T=c.tag=LI(E),d=sr(E,d),T){case 0:c=am(null,c,E,d,m);break t;case 1:c=gb(null,c,E,d,m);break t;case 11:c=lb(null,c,E,d,m);break t;case 14:c=ub(null,c,E,sr(E.type,d),m);break t}throw Error(s(306,E,""))}return c;case 0:return E=c.type,T=c.pendingProps,T=c.elementType===E?T:sr(E,T),am(d,c,E,T,m);case 1:return E=c.type,T=c.pendingProps,T=c.elementType===E?T:sr(E,T),gb(d,c,E,T,m);case 3:t:{if(fb(c),d===null)throw Error(s(387));E=c.pendingProps,I=c.memoizedState,T=I.element,Nv(d,c),oc(c,E,null,m);var V=c.memoizedState;if(E=V.element,I.isDehydrated)if(I={element:E,isDehydrated:!1,cache:V.cache,pendingSuspenseBoundaries:V.pendingSuspenseBoundaries,transitions:V.transitions},c.updateQueue.baseState=I,c.memoizedState=I,c.flags&256){T=El(Error(s(423)),c),c=pb(d,c,E,m,T);break t}else if(E!==T){T=El(Error(s(424)),c),c=pb(d,c,E,m,T);break t}else for(Ai=yo(c.stateNode.containerInfo.firstChild),Si=c,qs=!0,er=null,m=Cv(c,null,E,m),c.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(_l(),E===T){c=jr(d,c,m);break t}Kn(d,c,E,m)}c=c.child}return c;case 5:return Iv(c),d===null&&Dp(c),E=c.type,T=c.pendingProps,I=d!==null?d.memoizedProps:null,V=T.children,Lp(E,T)?V=null:I!==null&&Lp(E,I)&&(c.flags|=32),cb(d,c),Kn(d,c,V,m),c.child;case 6:return d===null&&Dp(c),null;case 13:return mb(d,c,m);case 4:return $p(c,c.stateNode.containerInfo),E=c.pendingProps,d===null?c.child=yl(c,null,E,m):Kn(d,c,E,m),c.child;case 11:return E=c.type,T=c.pendingProps,T=c.elementType===E?T:sr(E,T),lb(d,c,E,T,m);case 7:return Kn(d,c,c.pendingProps,m),c.child;case 8:return Kn(d,c,c.pendingProps.children,m),c.child;case 12:return Kn(d,c,c.pendingProps.children,m),c.child;case 10:t:{if(E=c.type._context,T=c.pendingProps,I=c.memoizedProps,V=T.value,Rs(nc,E._currentValue),E._currentValue=V,I!==null)if(tr(I.value,V)){if(I.children===T.children&&!di.current){c=jr(d,c,m);break t}}else for(I=c.child,I!==null&&(I.return=c);I!==null;){var rt=I.dependencies;if(rt!==null){V=I.child;for(var xt=rt.firstContext;xt!==null;){if(xt.context===E){if(I.tag===1){xt=Vr(-1,m&-m),xt.tag=2;var Vt=I.updateQueue;if(Vt!==null){Vt=Vt.shared;var de=Vt.pending;de===null?xt.next=xt:(xt.next=de.next,de.next=xt),Vt.pending=xt}}I.lanes|=m,xt=I.alternate,xt!==null&&(xt.lanes|=m),Vp(I.return,m,c),rt.lanes|=m;break}xt=xt.next}}else if(I.tag===10)V=I.type===c.type?null:I.child;else if(I.tag===18){if(V=I.return,V===null)throw Error(s(341));V.lanes|=m,rt=V.alternate,rt!==null&&(rt.lanes|=m),Vp(V,m,c),V=I.sibling}else V=I.child;if(V!==null)V.return=I;else for(V=I;V!==null;){if(V===c){V=null;break}if(I=V.sibling,I!==null){I.return=V.return,V=I;break}V=V.return}I=V}Kn(d,c,T.children,m),c=c.child}return c;case 9:return T=c.type,E=c.pendingProps.children,vl(c,m),T=zi(T),E=E(T),c.flags|=1,Kn(d,c,E,m),c.child;case 14:return E=c.type,T=sr(E,c.pendingProps),T=sr(E.type,T),ub(d,c,E,T,m);case 15:return db(d,c,c.type,c.pendingProps,m);case 17:return E=c.type,T=c.pendingProps,T=c.elementType===E?T:sr(E,T),pc(d,c),c.tag=1,hi(E)?(d=!0,Kh(c)):d=!1,vl(c,m),eb(c,E,T),im(c,E,T,m),lm(null,c,E,!0,d,m);case 19:return yb(d,c,m);case 22:return hb(d,c,m)}throw Error(s(156,c.tag))};function Vb(d,c){return cs(d,c)}function CI(d,c,m,E){this.tag=d,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bi(d,c,m,E){return new CI(d,c,m,E)}function Lm(d){return d=d.prototype,!(!d||!d.isReactComponent)}function LI(d){if(typeof d=="function")return Lm(d)?1:0;if(d!=null){if(d=d.$$typeof,d===Z)return 11;if(d===K)return 14}return 2}function No(d,c){var m=d.alternate;return m===null?(m=Bi(d.tag,c,d.key,d.mode),m.elementType=d.elementType,m.type=d.type,m.stateNode=d.stateNode,m.alternate=d,d.alternate=m):(m.pendingProps=c,m.type=d.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=d.flags&14680064,m.childLanes=d.childLanes,m.lanes=d.lanes,m.child=d.child,m.memoizedProps=d.memoizedProps,m.memoizedState=d.memoizedState,m.updateQueue=d.updateQueue,c=d.dependencies,m.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},m.sibling=d.sibling,m.index=d.index,m.ref=d.ref,m}function Tc(d,c,m,E,T,I){var V=2;if(E=d,typeof d=="function")Lm(d)&&(V=1);else if(typeof d=="string")V=5;else t:switch(d){case M:return ba(m.children,T,I,c);case F:V=8,T|=8;break;case O:return d=Bi(12,m,c,T|2),d.elementType=O,d.lanes=I,d;case at:return d=Bi(13,m,c,T),d.elementType=at,d.lanes=I,d;case pt:return d=Bi(19,m,c,T),d.elementType=pt,d.lanes=I,d;case ht:return Cc(m,T,I,c);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case G:V=10;break t;case j:V=9;break t;case Z:V=11;break t;case K:V=14;break t;case ut:V=16,E=null;break t}throw Error(s(130,d==null?d:typeof d,""))}return c=Bi(V,m,c,T),c.elementType=d,c.type=E,c.lanes=I,c}function ba(d,c,m,E){return d=Bi(7,d,E,c),d.lanes=m,d}function Cc(d,c,m,E){return d=Bi(22,d,E,c),d.elementType=ht,d.lanes=m,d.stateNode={isHidden:!1},d}function Nm(d,c,m){return d=Bi(6,d,null,c),d.lanes=m,d}function Mm(d,c,m){return c=Bi(4,d.children!==null?d.children:[],d.key,c),c.lanes=m,c.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},c}function NI(d,c,m,E,T){this.tag=c,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=St(0),this.expirationTimes=St(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=St(0),this.identifierPrefix=E,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function km(d,c,m,E,T,I,V,rt,xt){return d=new NI(d,c,m,rt,xt),c===1?(c=1,I===!0&&(c|=8)):c=0,I=Bi(3,null,null,c),d.current=I,I.stateNode=d,I.memoizedState={element:E,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hp(I),d}function MI(d,c,m){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:E==null?null:""+E,children:d,containerInfo:c,implementation:m}}function jb(d){if(!d)return vo;d=d._reactInternals;t:{if(je(d)!==d||d.tag!==1)throw Error(s(170));var c=d;do{switch(c.tag){case 3:c=c.stateNode.context;break t;case 1:if(hi(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break t}}c=c.return}while(c!==null);throw Error(s(171))}if(d.tag===1){var m=d.type;if(hi(m))return _v(d,m,c)}return c}function Hb(d,c,m,E,T,I,V,rt,xt){return d=km(m,E,!0,d,T,I,V,rt,xt),d.context=jb(null),m=d.current,E=Qn(),T=Co(m),I=Vr(E,T),I.callback=c??null,So(m,I,T),d.current.lanes=T,bt(d,T,E),fi(d,E),d}function Lc(d,c,m,E){var T=c.current,I=Qn(),V=Co(T);return m=jb(m),c.context===null?c.context=m:c.pendingContext=m,c=Vr(I,V),c.payload={element:d},E=E===void 0?null:E,E!==null&&(c.callback=E),d=So(T,c,V),d!==null&&(rr(d,T,V,I),rc(d,T,V)),V}function Nc(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function $b(d,c){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var m=d.retryLane;d.retryLane=m!==0&&m<c?m:c}}function Im(d,c){$b(d,c),(d=d.alternate)&&$b(d,c)}function kI(){return null}var qb=typeof reportError=="function"?reportError:function(d){console.error(d)};function Rm(d){this._internalRoot=d}Mc.prototype.render=Rm.prototype.render=function(d){var c=this._internalRoot;if(c===null)throw Error(s(409));Lc(d,c,null,null)},Mc.prototype.unmount=Rm.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var c=d.containerInfo;ya(function(){Lc(null,d,null,null)}),c[Dr]=null}};function Mc(d){this._internalRoot=d}Mc.prototype.unstable_scheduleHydration=function(d){if(d){var c=ms();d={blockedOn:null,target:d,priority:c};for(var m=0;m<en.length&&c!==0&&c<en[m].priority;m++);en.splice(m,0,d),m===0&&Mn(d)}};function Fm(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function kc(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function Yb(){}function II(d,c,m,E,T){if(T){if(typeof E=="function"){var I=E;E=function(){var Vt=Nc(V);I.call(Vt)}}var V=Hb(c,E,d,0,null,!1,!1,"",Yb);return d._reactRootContainer=V,d[Dr]=V.current,Du(d.nodeType===8?d.parentNode:d),ya(),V}for(;T=d.lastChild;)d.removeChild(T);if(typeof E=="function"){var rt=E;E=function(){var Vt=Nc(xt);rt.call(Vt)}}var xt=km(d,0,!1,null,null,!1,!1,"",Yb);return d._reactRootContainer=xt,d[Dr]=xt.current,Du(d.nodeType===8?d.parentNode:d),ya(function(){Lc(c,xt,m,E)}),xt}function Ic(d,c,m,E,T){var I=m._reactRootContainer;if(I){var V=I;if(typeof T=="function"){var rt=T;T=function(){var xt=Nc(V);rt.call(xt)}}Lc(c,V,d,T)}else V=II(m,c,d,T,E);return Nc(V)}we=function(d){switch(d.tag){case 3:var c=d.stateNode;if(c.current.memoizedState.isDehydrated){var m=oe(c.pendingLanes);m!==0&&(Qt(c,m|1),fi(c,tt()),(fs&6)===0&&(wl=tt()+500,bo()))}break;case 13:ya(function(){var E=Gr(d,1);if(E!==null){var T=Qn();rr(E,d,1,T)}}),Im(d,1)}},We=function(d){if(d.tag===13){var c=Gr(d,134217728);if(c!==null){var m=Qn();rr(c,d,134217728,m)}Im(d,134217728)}},us=function(d){if(d.tag===13){var c=Co(d),m=Gr(d,c);if(m!==null){var E=Qn();rr(m,d,c,E)}Im(d,c)}},ms=function(){return ie},ds=function(d,c){var m=ie;try{return ie=d,c()}finally{ie=m}},B=function(d,c,m){switch(c){case"input":if(is(d,m),c=m.name,m.type==="radio"&&c!=null){for(m=d;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<m.length;c++){var E=m[c];if(E!==d&&E.form===d.form){var T=Xh(E);if(!T)throw Error(s(90));Ce(E),is(E,T)}}}break;case"textarea":hs(d,m);break;case"select":c=m.value,c!=null&&Je(d,!!m.multiple,c,!1)}},ct=wm,mt=ya;var RI={usingClientEntryPoint:!1,Events:[Uu,cl,Xh,lt,dt,wm]},td={findFiberByHostInstance:da,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},FI={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=es(d),d===null?null:d.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||kI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rc.isDisabled&&Rc.supportsFiber)try{Pt=Rc.inject(FI),Lt=Rc}catch{}}return pi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=RI,pi.createPortal=function(d,c){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fm(c))throw Error(s(200));return MI(d,c,null,m)},pi.createRoot=function(d,c){if(!Fm(d))throw Error(s(299));var m=!1,E="",T=qb;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(E=c.identifierPrefix),c.onRecoverableError!==void 0&&(T=c.onRecoverableError)),c=km(d,1,!1,null,null,m,!1,E,T),d[Dr]=c.current,Du(d.nodeType===8?d.parentNode:d),new Rm(c)},pi.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var c=d._reactInternals;if(c===void 0)throw typeof d.render=="function"?Error(s(188)):(d=Object.keys(d).join(","),Error(s(268,d)));return d=es(c),d=d===null?null:d.stateNode,d},pi.flushSync=function(d){return ya(d)},pi.hydrate=function(d,c,m){if(!kc(c))throw Error(s(200));return Ic(null,d,c,!0,m)},pi.hydrateRoot=function(d,c,m){if(!Fm(d))throw Error(s(405));var E=m!=null&&m.hydratedSources||null,T=!1,I="",V=qb;if(m!=null&&(m.unstable_strictMode===!0&&(T=!0),m.identifierPrefix!==void 0&&(I=m.identifierPrefix),m.onRecoverableError!==void 0&&(V=m.onRecoverableError)),c=Hb(c,null,d,1,m??null,T,!1,I,V),d[Dr]=c.current,Du(d),E)for(d=0;d<E.length;d++)m=E[d],T=m._getVersion,T=T(m._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[m,T]:c.mutableSourceEagerHydrationData.push(m,T);return new Mc(c)},pi.render=function(d,c,m){if(!kc(c))throw Error(s(200));return Ic(null,d,c,!1,m)},pi.unmountComponentAtNode=function(d){if(!kc(d))throw Error(s(40));return d._reactRootContainer?(ya(function(){Ic(null,null,d,!1,function(){d._reactRootContainer=null,d[Dr]=null})}),!0):!1},pi.unstable_batchedUpdates=wm,pi.unstable_renderSubtreeIntoContainer=function(d,c,m,E){if(!kc(m))throw Error(s(200));if(d==null||d._reactInternals===void 0)throw Error(s(38));return Ic(d,c,m,!1,E)},pi.version="18.3.1-next-f1338f8080-20240426",pi}var eE;function iT(){if(eE)return Dm.exports;eE=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Dm.exports=jI(),Dm.exports}var sE;function HI(){if(sE)return Fc;sE=1;var t=iT();return Fc.createRoot=t.createRoot,Fc.hydrateRoot=t.hydrateRoot,Fc}var $I=HI(),qI=Object.create,Nx=Object.defineProperty,YI=Object.getOwnPropertyDescriptor,rT=Object.getOwnPropertyNames,WI=Object.getPrototypeOf,XI=Object.prototype.hasOwnProperty,ZI=(t,e)=>function(){return e||(0,t[rT(t)[0]])((e={exports:{}}).exports,e),e.exports},xh=(t,e)=>{for(var s in e)Nx(t,s,{get:e[s],enumerable:!0})},KI=(t,e,s,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of rT(e))XI.call(t,i)||i===s||Nx(t,i,{get:()=>e[i],enumerable:!(n=YI(e,i))||n.enumerable});return t},oT=(t,e,s)=>(s=t!=null?qI(WI(t)):{},KI(t&&t.__esModule?s:Nx(s,"default",{value:t,enumerable:!0}),t)),aT=ZI({"node_modules/@linkurious/spatial-index/dist/esm/index.js"(t,e){/**
     * @linkurious/spatial-index v0.5.8
     * Ogma spatial index data structures
     *
     * @author Alexander Milevski
     * @license ISC
     * @preserve
     */var s,n;s=t,n=function(i){function r(gt,k,P,D,B){const $=Math.abs(P-gt),H=gt<P?1:-1,X=-Math.abs(D-k),lt=k<D?1:-1;let dt,ct=$+X;for(;;){if(B(gt,k),dt=2*ct,dt>=X){if(gt===P)break;ct+=X,gt+=H}if(dt<=$){if(k===D)break;ct+=$,k+=lt}}}function o(gt,k="assert error"){if(!gt)throw new Error(k)}function a(gt,k,P,D,B,$,H){var X,lt,dt,ct,mt,yt=B-P,Nt=$-D,Tt=gt-P,At=k-D,Ut=Tt*Nt-At*yt;if(yt*yt+Nt*Nt>Tt*Tt+At*At&&(B=gt,gt=yt+P,$=k,k=Nt+D,Ut=-Ut),Ut!=0){Tt+=yt,At+=Nt,X=2*(Tt*=yt=gt<B?1:-1)*(At*=Nt=k<$?1:-1),Tt*=Tt,At*=At,Ut*yt*Nt<0&&(Tt=-Tt,At=-At,X=-X,Ut=-Ut),lt=4*Nt*(P-gt)*Ut+Tt-X,dt=4*yt*(k-D)*Ut+At-X,Tt+=Tt,At+=At,ct=lt+dt+X;do{if(Ut=Math.min(lt+X,-X-dt),mt=Math.max(lt+X,-X-dt),mt+=2*mt*Ut*Ut/(4*mt*mt+Ut*Ut),H(gt,k,255*Math.abs(ct-lt-dt-X)/mt),gt==B||k==$)break;P=gt,Ut=lt-ct,D=+(2*ct+dt<0),2*ct+lt>0&&(ct-dt<mt&&H(gt,k+Nt,255*Math.abs(ct-dt)/mt),gt+=yt,lt-=X,ct+=dt+=At),D&&(Ut<mt&&H(P+yt,k,255*Math.abs(Ut)/mt),k+=Nt,dt-=X,ct+=lt+=Tt)}while(dt<lt)}(function(xe,be,ue,_e,Te){const Ve=xe<ue?1:-1,Ie=be<_e?1:-1;let je,Pe=Math.abs(ue-xe),Be=Math.abs(_e-be),Ue=Pe*Pe+Be*Be,es=Ue===0?1:1/Math.sqrt(Ue);for(Pe*=es,Be*=es,Ue=Pe-Be;;){if(Te(xe,be,Math.abs(Ue-(Pe+Be))>>16),es=Ue,je=xe,2*es>=-Pe){if(xe===ue)break;es+Be<16711680&&Te(xe,be+Ie,es+Be>>16),Ue-=Be,xe+=Ve}if(2*es<=Be){if(be===_e)break;Pe-es<16711680&&Te(je+Ve,be,Pe-es>>16),Ue+=Pe,be+=Ie}}})(gt,k,B,$,H)}function l(gt,k,P,D,B,$,H,X,lt){var dt,ct,mt,yt=1;let Nt,Tt,At,Ut,he,xe,be,ue,_e,Te,Ve,Ie=gt<H?1:-1,je=k<X?1:-1,Pe=-Math.abs(gt+P-B-H),Be=Pe-4*Ie*(P-B),Ue=Ie*(gt-P-B+H),es=-Math.abs(k+D-$-X),os=es-4*je*(D-$),cs=je*(k-D-$+X),Y=.01;if(o((P-gt)*(B-H)<Y&&((H-gt)*(P-B)<Y||Ue*Ue<Be*Pe+Y),"slope change"),o((D-k)*($-X)<Y&&((X-k)*(D-$)<Y||cs*cs<os*es+Y),"slope change"),Be==0&&os==0)return Ie=Math.floor((3*P-gt+1)/2),je=Math.floor((3*D-k+1)/2),(function(J,tt,ft,_t,it,vt,Ct){var Ft,Pt,Lt,Yt,$t=it-ft,Bt=vt-_t,Gt=J-ft,qt=tt-_t,Kt=Gt*Bt-qt*$t;if(o(Gt*$t<=0&&qt*Bt<=0,"sign of gradient must not change"),$t*$t+Bt*Bt>Gt*Gt+qt*qt&&(it=J,J=$t+ft,vt=tt,tt=Bt+_t,Kt=-Kt),Kt!=0){Gt+=$t,qt+=Bt,Ft=2*(Gt*=$t=J<it?1:-1)*(qt*=Bt=tt<vt?1:-1),Gt*=Gt,qt*=qt,Kt*$t*Bt<0&&(Gt=-Gt,qt=-qt,Ft=-Ft,Kt=-Kt),Pt=4*Bt*Kt*(ft-J)+Gt-Ft,Lt=4*$t*Kt*(tt-_t)+qt-Ft,Gt+=Gt,qt+=qt,Yt=Pt+Lt+Ft;do{if(Ct(J,tt),J==it&&tt==vt)return;_t=+(2*Yt<Pt),2*Yt>Lt&&(J+=$t,Pt-=Ft,Yt+=Lt+=qt),_t&&(tt+=Bt,Lt-=Ft,Yt+=Pt+=Gt)}while(Lt<0&&Pt>0)}r(J,tt,it,vt,Ct)})(gt,k,Ie,je,H,X,lt);P=(P-gt)*(P-gt)+(D-k)*(D-k)+1,B=(B-H)*(B-H)+($-X)*($-X)+1;do{Nt=Be*cs-Ue*os,Tt=Be*es-Pe*os,At=Ue*es-Pe*cs,Te=Nt*(Nt+Tt-3*At)+Tt*Tt,Nt*=dt=Te>0?1:Math.sqrt(1+1024/P),Tt*=dt,At*=dt,Te*=dt*dt,xe=9*(Nt+Tt+At)/8,Ut=8*(Be-os),ue=27*(8*Nt*(cs*cs-os*es)+Te*(os+2*cs+es))/64-os*os*(xe-os),_e=27*(8*Nt*(Ue*Ue-Be*Pe)-Te*(Be+2*Ue+Pe))/64-Be*Be*(xe+Be),he=3*(3*Nt*(3*cs*cs-os*os-2*os*es)-os*(3*Tt*(os+cs)+os*Ut))/4,be=3*(3*Nt*(3*Ue*Ue-Be*Be-2*Be*Pe)-Be*(3*Tt*(Be+Ue)+Be*Ut))/4,xe=Be*os*(6*Nt+6*Tt-3*At+Ut),Tt=os*os,Ut=Be*Be,xe=3*(xe+9*dt*(Ut*cs*es-Ue*Pe*Tt)-18*Ue*cs*Nt)/8,Te<0&&(ue=-ue,_e=-_e,he=-he,be=-be,xe=-xe,Tt=-Tt,Ut=-Ut),Nt=6*os*Tt,Tt*=-6*Be,At=6*os*Ut,Ut*=-6*Be,ue+=xe,Te=ue+_e,_e+=xe;t:for(Ve=xe,ct=mt=dt;gt!=H&&k!=X;){lt(gt,k);do{if(ue>Ve||_e<Ve)break t;D=2*Te-_e,2*Te>=ue&&(ct--,Te+=ue+=he,_e+=xe+=Tt,be+=At,he+=Nt),D<=0&&(mt--,Te+=_e+=be,ue+=xe+=At,he+=Tt,be+=Ut)}while(ct>0&&mt>0);2*ct<=dt&&(gt+=Ie,ct+=dt),2*mt<=dt&&(k+=je,mt+=dt),Ve==xe&&ue<0&&_e>0&&(Ve=Y)}he=gt,gt=H,H=he,Ie=-Ie,Ue=-Ue,be=k,k=X,X=be,je=-je,cs=-cs,P=B}while(yt--);r(gt,k,H,X,lt)}function u(gt,k,P,D,B,$,H,X,lt){(function(ct,mt,yt,Nt,Tt,At,Ut,he,xe,be){let ue=0,_e=0,Te=ct+yt-Tt-Ut,Ve=Te-4*(yt-Tt),Ie=ct-yt-Tt+Ut,je=Ie+4*(yt+Tt),Pe=mt+Nt-At-he,Be=Pe-4*(Nt-At),Ue=mt-Nt-At+he,es=Ue+4*(Nt+At);var os,cs,Y,et,J,tt,ft=ct,_t=mt;let it,vt=Ie*Ie-Ve*Te;const Ct=[0,0,0,0,0];for(Ve==0?Math.abs(Te)<2*Math.abs(Ie)&&(Ct[ue++]=Te/(2*Ie)):vt>0&&(it=Math.sqrt(vt),vt=(Ie-it)/Ve,Math.abs(vt)<1&&(Ct[ue++]=vt),vt=(Ie+it)/Ve,Math.abs(vt)<1&&(Ct[ue++]=vt)),vt=Ue*Ue-Be*Pe,Be==0?Math.abs(Pe)<2*Math.abs(Ue)&&(Ct[ue++]=Pe/(2*Ue)):vt>0&&(it=Math.sqrt(vt),vt=(Ue-it)/Be,Math.abs(vt)<1&&(Ct[ue++]=vt),vt=(Ue+it)/Be,Math.abs(vt)<1&&(Ct[ue++]=vt)),_e=1;_e<ue;_e++)(vt=Ct[_e-1])>Ct[_e]&&(Ct[_e-1]=Ct[_e],Ct[_e]=vt,_e=0);for(vt=-1,Ct[ue]=1,_e=0;_e<=ue;_e++)it=Ct[_e],os=(vt*(vt*Ie-2*Te)-it*(vt*(vt*Ve-2*Ie)+Te)+je)/8-ft,et=(vt*(vt*Ue-2*Pe)-it*(vt*(vt*Be-2*Ue)+Pe)+es)/8-_t,cs=(it*(it*Ie-2*Te)-vt*(it*(it*Ve-2*Ie)+Te)+je)/8-ft,J=(it*(it*Ue-2*Pe)-vt*(it*(it*Be-2*Ue)+Pe)+es)/8-_t,ft-=Y=(it*(it*(3*Ie-it*Ve)-3*Te)+je)/8,_t-=tt=(it*(it*(3*Ue-it*Be)-3*Pe)+es)/8,Ut=Math.floor(Y+.5),he=Math.floor(tt+.5),ft!=0&&(os*=ft=(ct-Ut)/ft,cs*=ft),_t!=0&&(et*=_t=(mt-he)/_t,J*=_t),(ct!=Ut||mt!=he)&&xe(ct,mt,ct+os,mt+et,ct+cs,mt+J,Ut,he,be),ct=Ut,mt=he,ft=Y,_t=tt,vt=it})(gt,k,P,D,B,$,H,X,l,lt)}for(var h=Object.freeze({__proto__:null,AABB:0,SEGMENT:1,CURVE:3,LOOP:4,POINT:5}),g=[0,1],f=[0,2],p=4;p<65535;p<<=2)for(var y=0,_=g.length;y<_;y++)g.push(g[y]|p),f.push((g[y]|p)<<1);function x(gt,k){return(f[255&k]|g[255&gt])+65536*(f[k>>8&255]|g[gt>>8&255])+4294967296*(f[k>>16&255]|g[gt>>16&255])}let v,b;function S(gt,k=[0,0]){if(gt>0xffffffffffff)throw"Only morton codes up to 48 bits are supported.";if(!v){v={},b={};for(var P=0;P<256;P++)v[x(P,0)]=P,b[x(0,P)]=P}var D=v[21845&gt],B=b[43690&gt];return gt>65535&&(D|=v[21845&(gt/=65536)]<<8,B|=b[43690&gt]<<8,gt>65535&&(D|=v[21845&(gt/=65536)]<<16,B|=b[43690&gt]<<16)),k[0]=D,k[1]=B,k}x.code=function(k,P,D){if(k>24)throw"Morton codes are only supported up to Z=24";var B=1<<24-k;return x(P*B,D*B)},x.range=function(k,P,D){if(k>24)throw"Morton ranges are only supported up to Z=24";var B=1<<24-k,$=x(P*B,D*B);return[$,$+B*B-1]},x.reverse=S,x.decode=function(k,P){var D=S(P),B=1<<24-k;return[D[0]/B,D[1]/B]},x.min=function(k,P){var D=1431655765&k,B=1431655765&P,$=2863311530&k,H=2863311530&P;return Math.min(D,B)+Math.min($,H)};const A=x;let w,L,M;function F(gt,k,P){const D=1<<P;return[gt=~~(D*((gt+M)/L)),k=~~(D*((k+M)/L))]}function O(gt,k,P){const D=1<<P;return[gt=D*((gt+M)/L),k=D*((k+M)/L)]}function G(gt,k,P,D,B,$){const H=F(gt,k,B),X=F(P,D,B);for(let lt=H[0];lt<=X[0];lt++)for(let dt=H[1];dt<=X[1];dt++)$.push(A(lt,dt))}function j(gt,k,P){const[D,B]=F(gt[0],gt[1],k),[$,H]=F(gt[2],gt[3],k),[X,lt]=F(gt[4],gt[5],k);(function(ct,mt,yt,Nt,Tt,At,Ut){var he,xe=ct-yt,be=mt-Nt,ue=ct-2*yt+Tt;xe*(Tt-yt)>0&&(be*(At-Nt)>0&&Math.abs((mt-2*Nt+At)/ue*xe)>Math.abs(be)&&(ct=Tt,Tt=xe+yt,mt=At,At=be+Nt),he=(1-(ue=(ct-yt)/ue))*((1-ue)*mt+2*ue*Nt)+ue*ue*At,ue=(ct*Tt-yt*yt)*ue/(ct-yt),xe=Math.floor(ue+.5),be=Math.floor(he+.5),he=(Nt-mt)*(ue-ct)/(yt-ct)+mt,a(ct,mt,xe,Math.floor(he+.5),xe,be,Ut),he=(Nt-At)*(ue-Tt)/(yt-Tt)+At,ct=yt=xe,mt=be,Nt=Math.floor(he+.5)),(mt-Nt)*(At-Nt)>0&&(he=(1-(ue=(mt-Nt)/(ue=mt-2*Nt+At)))*((1-ue)*ct+2*ue*yt)+ue*ue*Tt,ue=(mt*At-Nt*Nt)*ue/(mt-Nt),xe=Math.floor(he+.5),be=Math.floor(ue+.5),he=(yt-ct)*(ue-mt)/(Nt-mt)+ct,a(ct,mt,Math.floor(he+.5),be,xe,be,Ut),he=(yt-Tt)*(ue-At)/(Nt-At)+Tt,ct=xe,yt=Math.floor(he+.5),mt=Nt=be),a(ct,mt,yt,Nt,Tt,At,Ut)})(D,B,$,H,X,lt,((dt,ct)=>{P.push(A(dt,ct))}))}(function(k){w=k,L=1<<w,M=1<<w-1})(14);const Z=[[0,0],[0,0]];function at(gt,k){const P=gt.type,D=gt.coordinates,B=[];switch(P){case 1:Z[0][0]=D[0],Z[0][1]=D[1],Z[1][0]=D[2],Z[1][1]=D[3],(function(H,X,lt,dt){for(var ct,mt,yt=0;yt<H.length-1;yt++){var Nt=O(H[yt][0],H[yt][1],X),Tt=O(H[yt+1][0],H[yt+1][1],X),At=Nt[0],Ut=Nt[1],he=Tt[0]-At,xe=Tt[1]-Ut;if(xe!==0||he!==0){var be=he>0?1:-1,ue=xe>0?1:-1,_e=Math.floor(At),Te=Math.floor(Ut),Ve=he===0?1/0:Math.abs(((he>0?1:0)+_e-At)/he),Ie=xe===0?1/0:Math.abs(((xe>0?1:0)+Te-Ut)/xe),je=Math.abs(be/he),Pe=Math.abs(ue/xe);for(_e===ct&&Te===mt||(dt.push(A(_e,Te)),ct=_e,mt=Te);Ve<1||Ie<1;)Ve<Ie?(Ve+=je,_e+=be):(Ie+=Pe,Te+=ue),dt.push(A(_e,Te)),ct=_e,mt=Te}}})(Z,k,void 0,B);break;case 0:G(D[0],D[1],D[2],D[3],k,B);break;case 5:G(D[0]-D[2],D[1]-D[2],D[0]+D[2],D[1]+D[2],k,B);break;case 3:j(D,k,B);break;case 4:(function(H,X,lt){const[dt,ct]=F(H[0],H[1],X),[mt,yt]=F(H[2],H[3],X),[Nt,Tt]=F(H[4],H[5],X),[At,Ut]=F(H[6],H[7],X);u(dt,ct,mt,yt,Nt,Tt,At,Ut,((he,xe)=>{lt.push(A(he,xe))}))})(D,k,B)}return B}class pt{constructor(k=Int32Array,P=16,D=8){this._BIG_LIST=new Uint8Array([-1])[0],this._ArrayType=k,this._capacity=P,this._MAX_LIST_SIZE=D,this._freeIndex=-1,this.clear()}clear(){this._buffer=new this._ArrayType(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._idToIndex=new Map,this._constList=new Array(this._MAX_LIST_SIZE)}addEntry(k){let P;return this._freeIndex===-1?P=this._nextIndex++:(P=this._freeIndex,this._freeIndex=-1),this._idToIndex.set(k,P),P>=this._capacity&&this._expand(P+1),this._sizes[P]=0,P}getItems(k){const P=this._idToIndex.get(k);if(P===void 0)return;const D=this._sizes[P],B=this._MAX_LIST_SIZE*P;if(D<=this._MAX_LIST_SIZE){this._constList.length=D;for(let $=0,H=D;$<H;++$)this._constList[$]=this._buffer[B+$];return this._constList}if(D===this._BIG_LIST){const $=this._buffer[B];return this._bigLists[$]}}removeEntry(k){const P=this._idToIndex.get(k);if(this._sizes[P]===this._BIG_LIST){const D=this._MAX_LIST_SIZE*P,B=this._buffer[D];this._bigLists[B].length=0}this._sizes[P]=0,this._freeIndex=P}size(k){const P=this._idToIndex.get(k),D=this._sizes[P];return D<=this._MAX_LIST_SIZE?D:this._bigLists[this._buffer[P*this._MAX_LIST_SIZE]].length}sizes(k){const P=this._sizes,D=this._bigLists,B=this._buffer,$=this._MAX_LIST_SIZE,H=k.length,X=new Array(H);for(let lt=0;lt<H;lt++){const dt=this._idToIndex.get(k[lt]),ct=P[dt];X[lt]=ct<=$?ct:D[B[dt*$]].length}return X}addTo(k,P){const D=this._idToIndex.get(k),B=this._sizes[D],$=D*this._MAX_LIST_SIZE;if(B<this._MAX_LIST_SIZE)this._buffer[$+B]=P,this._sizes[D]=B+1;else if(B===this._BIG_LIST){const H=this._buffer[$];this._bigLists[H].push(P)}else{const H=new Array(this._MAX_LIST_SIZE);for(let X=0;X<this._MAX_LIST_SIZE;++X)H[X]=this._buffer[$+X];H.push(P),this._bigLists.push(H),this._sizes[D]=this._BIG_LIST,this._buffer[$]=this._bigLists.length-1}}removeFrom(k,P){this.removeFromAndGetSize(k,P)}removeFromAndGetSize(k,P){const D=this._idToIndex.get(k);let B=this._sizes[D];const $=this._MAX_LIST_SIZE*D;if(B<=this._MAX_LIST_SIZE){for(let H=$,X=$+B;H<X;++H)if(this._buffer[H]===P)return B-=1,this._buffer[H]=this._buffer[X-1],this._sizes[D]=B,B}else if(B===this._BIG_LIST){const H=this._buffer[$],X=this._bigLists[H],lt=X.indexOf(P);if(lt!==-1)return X.splice(lt,1),X.length}}reserve(k){this._capacity<k&&this._expand(k)}_expand(k){this._capacity=Math.pow(2,Math.ceil(Math.log2(k))),this._buffer=K(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=K(this._sizes,this._capacity)}has(k){const P=this._idToIndex.get(k);return!(P===void 0||P>=this._capacity)&&this._sizes[P]!==0}keys(){return Array.from(this._idToIndex.keys())}get averageSize(){let k=0;for(let P=0;P<this._capacity;P++)k+=this._sizes[P];return k/this._capacity}}function K(gt,k){const P=new gt.constructor(k);return P.set(gt),P}function ut(){for(var gt=arguments,k=gt.length-1,P=k,D=[],B=0;B<=k&&Math.abs(gt[B])<=1e-12;B++)k--;switch(k){case 1:ht(gt[P],gt[P-1],D);break;case 2:nt(gt[P],gt[P-1],gt[P-2],D);break;case 3:ot(gt[P],gt[P-1],gt[P-2],gt[P-3],D)}return D}function ht(gt,k,P=[]){return k!==0&&P.push(-gt/k),P}function nt(gt,k,P,D=[]){var B=k/P,$=B*B-gt/P*4;if($>0){var H=Math.sqrt($);D.push(.5*(-B+H)),D.push(.5*(-B-H))}else $===0&&D.push(.5*-B);return D}function ot(gt,k,P,D,B=[]){var $,H,X=P/D,lt=k/D,dt=(3*lt-X*X)/3,ct=(2*X*X*X-9*lt*X+gt/D*27)/27,mt=X/3,yt=ct*ct/4+dt*dt*dt/27,Nt=ct/2;if(Math.abs(yt)<=1e-6&&(yt=0),yt>0){var Tt=Math.sqrt(yt);H=($=-Nt+Tt)>=0?Math.pow($,1/3):-Math.pow(-$,1/3),($=-Nt-Tt)>=0?H+=Math.pow($,1/3):H-=Math.pow(-$,1/3),B.push(H-mt)}else if(yt<0){var At=Math.sqrt(-dt/3),Ut=Math.atan2(Math.sqrt(-yt),-Nt)/3,he=Math.cos(Ut),xe=Math.sin(Ut),be=Math.sqrt(3);B.push(2*At*he-mt),B.push(-At*(he+be*xe)-mt),B.push(-At*(he-be*xe)-mt)}else $=Nt>=0?-Math.pow(Nt,1/3):Math.pow(-Nt,1/3),B.push(2*$-mt),B.push(-$-mt);return B}function Mt(gt,k,P,D,B,$,H,X,lt,dt,ct){for(var mt,yt,Nt=Math.min(H,lt),Tt=Math.min(X,dt),At=Math.max(H,lt),Ut=Math.max(X,dt),he=ut((mt=X-dt)*(gt+-2*P+B)+(yt=lt-H)*(k+-2*D+$),mt*(-2*gt+2*P)+yt*(-2*k+2*D),mt*gt+yt*k+(H*dt-lt*X)),xe=0;xe<he.length;xe++){var be=he[xe];if(0<=be&&be<=1){var ue=gt+(P-gt)*be,_e=k+(D-k)*be,Te=ue+(P+(B-P)*be-ue)*be,Ve=_e+(D+($-D)*be-_e)*be;if(H===lt){if(Tt<=Ve&&Ve<=Ut)return 1}else if(X===dt){if(Nt<=Te&&Te<=At)return 1}else if(Te>=Nt&&Ve>=Tt&&Te<=At&&Ve<=Ut)return 1}}return ct?ct.length/2:0}function Q(gt,k,P,D,B,$,H,X,lt,dt,ct,mt,yt){for(var Nt,Tt,At=Math.min(lt,ct),Ut=Math.min(dt,mt),he=Math.max(lt,ct),xe=Math.max(dt,mt),be=ut((Nt=dt-mt)*(-1*gt+3*P+-3*B+H)+(Tt=ct-lt)*(-1*k+3*D+-3*$+X),Nt*(3*gt+-6*P+3*B)+Tt*(3*k+-6*D+3*$),Nt*(-3*gt+3*P)+Tt*(-3*k+3*D),Nt*gt+Tt*k+(lt*mt-ct*dt)),ue=0;ue<be.length;ue++){var _e=be[ue];if(0<=_e&&_e<=1){var Te=gt+(P-gt)*_e,Ve=k+(D-k)*_e,Ie=P+(B-P)*_e,je=D+($-D)*_e,Pe=Te+(Ie-Te)*_e,Be=Ve+(je-Ve)*_e,Ue=Pe+(Ie+(B+(H-B)*_e-Ie)*_e-Pe)*_e,es=Be+(je+($+(X-$)*_e-je)*_e-Be)*_e;if(lt===ct){if(Ut<=es&&es<=xe)return 1}else if(dt===mt){if(At<=Ue&&Ue<=he)return 1}else if(Ue>=At&&es>=Ut&&Ue<=he&&es<=xe)return 1}}return yt?yt.length/2:0}const Et=function(k,P,D,B,$,H,X,lt,dt,ct,mt){return X<=k&&dt>=k&&lt<=P&&ct>=P||X<=$&&dt>=$&&lt<=H&&ct>=H||Mt(k,P,D,B,$,H,X,lt,dt,lt)||Mt(k,P,D,B,$,H,dt,lt,dt,ct)||Mt(k,P,D,B,$,H,X,ct,dt,ct)||Mt(k,P,D,B,$,H,X,lt,X,ct)?1:0},Xt=function(k,P,D,B,$,H,X,lt,dt,ct,mt,yt,Nt){return dt<=k&&mt>=k&&ct<=P&&yt>=P||dt<=X&&mt>=X&&ct<=lt&&yt>=lt||Q(k,P,D,B,$,H,X,lt,dt,ct,mt,ct)||Q(k,P,D,B,$,H,X,lt,mt,ct,mt,yt)||Q(k,P,D,B,$,H,X,lt,dt,yt,mt,yt)||Q(k,P,D,B,$,H,X,lt,dt,ct,dt,yt)?1:0};function Ht(gt,k,P){return Math.min(Math.max(k,gt),P)}function Zt(gt,k,P,D,B,$,H,X){const lt=((H-B)*(k-$)-(X-$)*(gt-B))/((X-$)*(P-gt)-(H-B)*(D-k)),dt=((P-gt)*(k-$)-(D-k)*(gt-B))/((X-$)*(P-gt)-(H-B)*(D-k));return lt>=0&&lt<=1&&dt>=0&&dt<=1}function ae(gt,k,P,D,B){const $=gt.type,H=gt.coordinates;return $===5?(function(lt,dt,ct,mt,yt,Nt,Tt){const At=lt-Ht(lt,mt,Nt),Ut=dt-Ht(dt,yt,Tt);return At*At+Ut*Ut<ct*ct})(H[0],H[1],H[2],k,P,D,B):$===1?(function(lt,dt,ct,mt,yt,Nt,Tt,At){return lt>=yt&&dt>=Nt&&lt<=Tt&&dt<=At||ct>=yt&&mt>=Nt&&ct<=Tt&&mt<=At||!!Zt(lt,dt,ct,mt,yt,Nt,yt,At)||!!Zt(lt,dt,ct,mt,Tt,Nt,Tt,At)||!!Zt(lt,dt,ct,mt,yt,Nt,Tt,Nt)||!!Zt(lt,dt,ct,mt,yt,At,Tt,At)})(H[0],H[1],H[2],H[3],k,P,D,B):$===3?Et(H[0],H[1],H[2],H[3],H[4],H[5],k,P,D,B):$===4?Xt(H[0],H[1],H[2],H[3],H[4],H[5],H[6],H[7],k,P,D,B):(function(lt,dt){return lt[3]>dt[1]&&lt[1]<dt[3]&&lt[2]>dt[0]&&lt[0]<dt[2]})(H,[k,P,D,B])}const pe=2863311530,ne=4294967295,te=31;function se(gt,k,P){let D=k;for(let B=te;B>=0;B--){const $=1<<B,H=((P&$)<<2|(gt&$)<<1|k&$)>>B;if(H===1)D=gt&~(pe>>>te-B)&ne|1<<B,k=(k|pe>>>te-B&~(ne<<B)&ne)&~(1<<B)&ne;else{if(H===3)return gt;if(H===4)return D;H===5&&(gt=gt&~(pe>>>te-B)&ne|1<<B)}}return D}function ce(gt,k,P){for(let D=te;D>=0;D--){const B=1<<D,$=((P&B)<<2|(gt&B)<<1|k&B)>>D;if($===1)k=(k|pe>>>te-D&~(ne<<D)&ne)&~(1<<D)&ne;else{if($===3||$===4)return!1;$===5&&(gt=gt&~(pe>>>te-D)&ne|1<<D)}}return!0}function Ce(gt,k,P){const D=P+1;let B=0;for(let $=te;$>=0;$--){const H=1<<$,X=(D&H)>>$,lt=(gt&H)>>$,dt=(k&H)>>$,ct=1&$,mt=B&3<<2*ct;if(mt===0&&X>dt&&lt<=dt){B|=2<<2*ct;break}if(mt===0&&X<lt){B|=1<<2*ct;break}}return B===0?D:se(gt,k,P)}class ve{constructor(k,P){this.key=k,this.data=P,this.left=null,this.right=null}}function Me(gt,k){return gt>k?1:gt<k?-1:0}function ge(gt,k,P){if(k===null)return k;let D,B,$;const H=new ve;for(D=B=H;;){const X=P(gt,k.key);if(X<0){if(k.left===null||P(gt,k.left.key)<0&&($=k.left,k.left=$.right,$.right=k,(k=$).left===null))break;B.left=k,B=k,k=k.left}else{if(!(X>0)||k.right===null||P(gt,k.right.key)>0&&($=k.right,k.right=$.left,$.left=k,(k=$).right===null))break;D.right=k,D=k,k=k.right}}return D.right=k.left,B.left=k.right,k.left=H.right,k.right=H.left,k}function ze(gt,k,P,D,B){const $=new ve(gt,k);if(B._size++,P===null)return $.left=$.right=null,$;const H=D(gt,(P=ge(gt,P,D)).key);return H<0?($.left=P.left,$.right=P,P.left=null):H>=0&&($.right=P.right,$.left=P,P.right=null),$}function is(gt,k,P,D){let B;return k===null?null:P(gt,(k=ge(gt,k,P)).key)===0?(k.left===null?B=k.right:(B=ge(gt,k.left,P),B.right=k.right),D._size--,B):k}function Ge(gt,k,P){let D,B;if(k===null)D=B=null;else{const $=P((k=ge(gt,k,P)).key,gt);$===0?(D=k.left,B=k.right):$<0?(B=k.right,k.right=null,D=k):(D=k.left,k.left=null,B=k)}return{left:D,right:B}}function De(gt,k,P,D,B){if(gt){D(`${k}${P?" ":" "}${B(gt)}
`);const $=k+(P?"    ":"   ");gt.left&&De(gt.left,$,!1,D,B),gt.right&&De(gt.right,$,!0,D,B)}}class He{constructor(k=Me){this._comparator=k,this._root=null,this._size=0}insert(k,P){return this._root=ze(k,P,this._root,this._comparator,this)}add(k,P){return this._root=(function(B,$,H,X,lt){const dt=new ve(B,$);if(H===null)return dt.left=dt.right=null,lt._size++,dt;const ct=X(B,(H=ge(B,H,X)).key);return ct===0?H:(ct<0?(dt.left=H.left,dt.right=H,H.left=null):ct>0&&(dt.right=H.right,dt.left=H,H.right=null),lt._size++,dt)})(k,P,this._root,this._comparator,this)}remove(k){this._root=is(k,this._root,this._comparator,this)}pop(){let k=this._root;if(k){for(;k.left;)k=k.left;return this._root=ge(k.key,this._root,this._comparator),this._root=is(k.key,this._root,this._comparator,this),{key:k.key,data:k.data}}return null}findStatic(k){let P=this._root;const D=this._comparator;for(;P;){const B=D(k,P.key);if(B===0)return P;P=B<0?P.left:P.right}return null}find(k){return this._root&&(this._root=ge(k,this._root,this._comparator),this._comparator(k,this._root.key)!==0)?null:this._root}contains(k){let P=this._root;const D=this._comparator;for(;P;){const B=D(k,P.key);if(B===0)return!0;P=B<0?P.left:P.right}return!1}forEach(k,P){let D=this._root;const B=[];let $=!1;for(;!$;)D!==null?(B.push(D),D=D.left):B.length!==0?(D=B.pop(),k.call(P,D),D=D.right):$=!0;return this}range(k,P,D,B){const $=[],H=this._comparator;let X,lt=this._root;for(;$.length!==0||lt;)if(lt)$.push(lt),lt=lt.left;else{if(lt=$.pop(),X=H(lt.key,P),X>0)break;if(H(lt.key,k)>=0&&D.call(B,lt))return this;lt=lt.right}return this}keys(){const k=[];return this.forEach((({key:P})=>k.push(P))),k}values(){const k=[];return this.forEach((({data:P})=>k.push(P))),k}min(){return this._root?this.minNode(this._root).key:null}max(){return this._root?this.maxNode(this._root).key:null}minNode(k=this._root){if(k)for(;k.left;)k=k.left;return k}maxNode(k=this._root){if(k)for(;k.right;)k=k.right;return k}at(k){let P=this._root,D=!1,B=0;const $=[];for(;!D;)if(P)$.push(P),P=P.left;else if($.length>0){if(P=$.pop(),B===k)return P;B++,P=P.right}else D=!0;return null}next(k){let P=this._root,D=null;if(k.right){for(D=k.right;D.left;)D=D.left;return D}const B=this._comparator;for(;P;){const $=B(k.key,P.key);if($===0)break;$<0?(D=P,P=P.left):P=P.right}return D}prev(k){let P=this._root,D=null;if(k.left!==null){for(D=k.left;D.right;)D=D.right;return D}const B=this._comparator;for(;P;){const $=B(k.key,P.key);if($===0)break;$<0?P=P.left:(D=P,P=P.right)}return D}clear(){return this._root=null,this._size=0,this}toList(){return(function(P){var D=P,B=[],$=!1;const H={next:null};let X=H;for(;!$;)D?(B.push(D),D=D.left):B.length>0?D=(D=X=X.next=B.pop()).right:$=!0;return X.next=null,H.next})(this._root)}load(k=[],P=[],D=!1){let B=k.length;const $=this._comparator;if(D&&ts(k,P,0,B-1,$),this._root===null)this._root=Je(this._root,k,P,0,B),this._size=B;else{const H=(function(lt,dt,ct=((mt,yt)=>mt-yt)){const mt={};let yt=mt,Nt=lt,Tt=dt;for(;Nt!==null&&Tt!==null;)ct(Nt.key,Tt.key)<0?(yt.next=Nt,Nt=Nt.next):(yt.next=Tt,Tt=Tt.next),yt=yt.next;return Nt!==null?yt.next=Nt:Tt!==null&&(yt.next=Tt),mt.next})(this.toList(),(function(lt,dt){const ct={next:null};let mt=ct;for(let yt=0;yt<lt.length;yt++)mt=mt.next={key:lt[yt],data:dt[yt]};return mt.next=null,ct.next})(k,P),$);B=this._size+B,this._root=ss({head:H},0,B)}return this}isEmpty(){return this._root===null}get size(){return this._size}toString(k=(P=>P.key)){const P=[];return De(this._root,"",!0,(D=>P.push(D)),k),P.join("")}update(k,P,D){const B=this._comparator;let{left:$,right:H}=Ge(k,this._root,B);this._size--,B(k,P)<0?H=ze(P,D,H,B,this):$=ze(P,D,$,B,this),this._root=(function(lt,dt,ct){return dt===null?lt:(lt===null||((dt=ge(lt.key,dt,ct)).left=lt),dt)})($,H,B)}split(k){return Ge(k,this._root,this._comparator)}}function Je(gt,k,P,D,B){const $=B-D;if($>0){const H=D+Math.floor($/2),X={key:k[H],data:P[H],parent:gt};return X.left=Je(X,k,P,D,H),X.right=Je(X,k,P,H+1,B),X}return null}function ss(gt,k,P){const D=P-k;if(D>0){const B=k+Math.floor(D/2),$=ss(gt,k,B),H=gt.head;return H.left=$,gt.head=gt.head.next,H.right=ss(gt,B+1,P),H}return null}function ts(gt,k,P,D,B){if(P>=D)return;const $=gt[P+D>>1];let H=P-1,X=D+1;for(;;){do H++;while(B(gt[H],$)<0);do X--;while(B(gt[X],$)>0);if(H>=X)break;let lt=gt[H];gt[H]=gt[X],gt[X]=lt,lt=k[H],k[H]=k[X],k[X]=lt}ts(gt,k,P,X,B),ts(gt,k,X+1,D,B)}class hs extends He{constructor(k){super(k)}lte(k){const P=this._comparator;let D,B=this._root;for(;B;){if(D=P(B.key,k),B.left===null&&B.right===null&&D>0)return null;if(D<=0&&B.right===null||D<=0&&P(B.right.key,k)>0)return B;B=D>=0?B.left:B.right}return B}gte(k){const P=[],D=this._comparator;let B=this._root;for(;P.length!==0||B;)if(B)P.push(B),B=B.left;else{if(B=P.pop(),D(B.key,k)>=0)break;B=B.right}return B}clear(){return this._root=null,this._size=0,this}}class Fe{constructor(k,P=8){this.setLevel(P),this.setAccessor(k),this._tree=new hs(((D,B)=>D-B)),this._nodeToId=new pt(Uint32Array,1e3,16),this._idToNode=new pt(Uint32Array,16,8),this._size=0,this._checkedNodes=[],this._codeCache=[0,0]}setAccessor(k){return this._getGeometry=k,this}load(k){const P=[],D=this._nodeToId,B=this._idToNode,$=this._level,H=this._getGeometry;for(let X=0;X<k.length;X++){const lt=k[X],dt=at(H(lt),$);B.addEntry(lt);for(let ct=0;ct<dt.length;ct++){const mt=dt[ct];D.has(mt)||(D.addEntry(mt),P.push(mt)),D.addTo(mt,lt),B.addTo(lt,mt)}}return this._tree.load(P,[],!0),this._size+=k.length,this}addToPage(){}removeFromPage(){}insert(k){const P=at(this._getGeometry(k),this._level),D=this._idToNode,B=this._nodeToId,$=this._tree;this._size++,D.addEntry(k);for(let H=0;H<P.length;H++){const X=P[H];B.has(X)||($.insert(X),B.addEntry(X)),B.addTo(X,k),D.addTo(k,X)}}remove(k){const P=this._idToNode.getItems(k),D=this._nodeToId,B=this._tree;if(P)for(let $=0;$<P.length;$++){const H=P[$];D.removeFromAndGetSize(H,k)===0&&B.remove(H)}return this._idToNode.removeEntry(k),this._size--,this}update(k){return this.remove(k),this.insert(k),this}forEach(k){return this._tree.forEach(k),this}all(){const k=[];return this._tree.forEach((P=>{k.push(P)})),k}clear(){return this._tree.clear(),this._nodeToId.clear(),this._idToNode.clear(),this}setLevel(k){return this._level=k,this}traverse(k,P,D,B,$){const[H,X]=O(k,P,this._level),[lt,dt]=O(D,B,this._level),ct=x(H,X),mt=x(lt,dt);let yt=this._tree._root;const Nt=[];let Tt=ct;for(;Nt.length>0||yt;)if(yt)Nt.push(yt),yt=yt.left;else{yt=Nt.pop();const At=yt.key;if(At>mt)break;if(At>=ct&&At>=Tt&&(Tt=Ce(ct,mt,At),$(yt)))return this;yt=yt.right}return this}getKeys(k){const[P,D,B,$]=k,[H,X]=O(P,D,this._level),[lt,dt]=O(B,$,this._level),ct=x(H,X),mt=x(lt,dt);let yt=this._tree._root;const Nt=[];let Tt=ct;for(;Nt.length>0||yt;)if(yt)Nt.push(yt),yt=yt.left;else{yt=Nt.pop();const At=yt.key;if(At>mt)break;At>=ct&&At>=Tt&&(Tt=Ce(ct,mt,At)),yt=yt.right}return this}traverseDescend(k,P,D,B,$){const H=O(P,D,this._level),X=O(B,$,this._level),lt=x(H[0],H[1]),dt=x(X[0],X[1]);return this._recurse(this._tree._root,lt,dt,lt,dt,k),this}traverseRange(k,P,D,B,$){const[H,X]=O(P,D,this._level),[lt,dt]=O(B,$,this._level),ct=x(H,X),mt=x(lt,dt);return this._tree.range(ct,mt,(yt=>{const Nt=yt.key;if(ce(ct,mt,Nt)&&k(yt))return!0})),this}_recurse(k,P,D,B,$,H){if(k===null)return;const X=k.key;if(X<P)return this._recurse(k.right,P,D,B,$,H);if(X>D)return this._recurse(k.left,P,D,B,$,H);if(ce(B,$,X)){if(this._recurse(k.left,P,X,B,$,H),H(k))return;this._recurse(k.right,X,D,B,$,H)}else{const lt=se(B,$,X),dt=(function(mt,yt,Nt){let Tt=mt;for(let At=te;At>=0;At--){const Ut=1<<At,he=((Nt&Ut)<<2|(mt&Ut)<<1|yt&Ut)>>At;if(he===1)yt=(yt|pe>>>te-At&~(ne<<At)&ne)&~(1<<At)&ne;else{if(he===3)return Tt;if(he===4)return yt;he===5&&(Tt=(yt|pe>>>te-At&~(ne<<At)&ne)&~(1<<At)&ne,mt=mt&~(pe>>>te-At)&ne|1<<At)}}return Tt})(B,$,X);this._recurse(k.left,P,dt,B,$,H),this._recurse(k.right,lt,D,B,$,H)}}query(k,P,D,B){const $=[],H=[];this.traverse(k,P,D,B,(dt=>{$.push(dt)}));const X={},lt=this._getGeometry;this._intersectionChecks=0;for(let dt=0;dt<$.length;dt++){const ct=$[dt],mt=this._nodeToId.getItems(ct.key);for(let yt=0;yt<mt.length;yt++){const Nt=mt[yt];if(!X[Nt]){const Tt=lt(Nt);this._intersectionChecks++,ae(Tt,k,P,D,B)&&H.push(Nt),X[Nt]=!0}}}return this._checkedNodes=$,H}getItems(k){return this._nodeToId.getItems(k)}get intersectionChecks(){return this._intersectionChecks}get level(){return this._level}get size(){return this._size}keyToBBox(k){const P=(function(){return w})(),[D,B]=x.reverse(k),$=1<<12-this._level+(P-12),H=1<<P-1;return[D*$-H,B*$-H,(D+1)*$-H,(B+1)*$-H]}}Fe.MAX_ZOOM=12;var Oe=typeof Map>"u"?class{constructor(){this._values={},this._size=0}get size(){return this._size}has(k){return!!this._values[k]}set(k,P){k in this._values||this._size++,this._values[k]=P}get(k){return this._values[k]}delete(k){k in this._values&&(delete this._values[k],this._size--)}keys(){return Object.keys(this._values)}clear(){this._values={},this._size=0}}:Map,Ns=typeof Set>"u"?class{constructor(){this._values={},this._size=0}get size(){return this._size}has(k){return!!this._values[k]}add(k){k in this._values||this._size++,this._values[k]=!0}delete(k){k in this._values&&(delete this._values[k],this._size--)}keys(){return Object.keys(this._values)}clear(){this._values={},this._size=0}}:Set;class zs{constructor(){this._intersects=null,this._getBounds=null}setBoundsGetter(k){return this._getBounds=k,this}setIntersector(k){return this._intersects=k,this}}function $s(gt,k,P,D,B,$,H,X){return D>=$&&k<=X&&P>=B&&gt<=H}const Ms=(gt,k,P,D,B,$)=>({minX:gt,minY:k,maxX:P,maxY:D,leaf:!0,level:$,parent:B,objects:[],final:!1,children:null});function An(gt){const{minX:k,minY:P,maxX:D,maxY:B}=gt;return[k,P,D,B]}function fn(gt,k,P,D,B,$,H,X){return gt>=B&&P<=H&&k>=$&&D<=X}function un(gt,k,P,D,B,$,H,X){const lt=($+X)/2,dt=(k+D)/2;return(gt+P)/2<=(B+H)/2?dt<=lt?0:1:dt<=lt?3:2}const xs=gt=>gt;class Ds extends zs{constructor(k=xs,P=10,D,B=0){super(),this._nodeCapacity=10,this._root=null,this._objects={},this._size=0,this._rootLevel=0,this._maxLevel=30,this._idToCell={},this._nodeCapacity=P,this._root=null,this._getBounds=k,this._rootLevel=B,this._maxLevel=B+30,this._idToCell={},D&&(this._root=Ms(D[0],D[1],D[2],D[3],null,B))}get size(){return this._size}get root(){return this._root}clear(){return this._root=null,this._objects={},this._size=0,this._idToCell={},this._rootLevel=0,this._maxLevel=this._rootLevel+30,this}insert(k,P,D,B,$,H=this._root){if(P||([P,D,B,$]=this._getBounds(k)),this._objects[k])return;if(this._objects[k]=!0,this._size++,!this._root){const Tt=Math.max(Math.abs(B-P),Math.abs($-D));return this._root=Ms(P,D,P+Tt,D+Tt,null,this._rootLevel),this._idToCell[k]=[this._root],this._root.objects=[k],k}let X,lt=[H],dt=!1;const ct=this._nodeCapacity,mt=this._idToCell,yt=this._maxLevel;let Nt;for(;Nt=lt.pop();){X=Nt;const{minX:Tt,minY:At,maxX:Ut,maxY:he}=X;$s(P,D,B,$,Tt,At,Ut,he)&&(X.leaf?X.objects&&(X.objects.length<ct||X.final)?(X.objects.push(k),mt[k]?mt[k].push(X):mt[k]=[X],dt=!0,(X.level>=yt||Math.abs(Ut-Tt)<=Math.abs(B-P)||Math.abs(he-At)<=Math.abs($-D))&&(X.final=!0)):(this.splitNode(X),lt.push(X)):lt.push.apply(lt,X.children))}if(!fn(P,D,B,$,(H=this._root).minX,H.minY,H.maxX,H.maxY)){let Tt=this._rootLevel;for(;!fn(P,D,B,$,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){H=this._root;const{minX:At,minY:Ut,maxX:he,maxY:xe}=H;let be=At,ue=Ut,_e=he,Te=xe;const Ve=Math.abs(he-At),Ie=Math.abs(xe-Ut);if(Ie===0&&Ve===0)break;const je=Math.max(Ve,Ie);P<At?(be-=je,D<Ut?ue-=je:Te+=je):(_e+=je,D<Ut?ue-=je:Te+=je);const Pe=Ms(be,ue,_e,Te,null,--Tt);this.splitNode(Pe),Pe.children[un(At,Ut,he,xe,be,ue,_e,Te)]=H,this._root=H.parent=Pe}for(lt=[this._root],this._root.level=this._rootLevel;Nt=lt.shift();)if(X=Nt,!X.leaf)for(let At=0;At<4;At++){const Ut=X.children[At];Ut.level=X.level+1,lt.push(Ut)}H=this._root;for(let At=0;At<4;At++){const Ut=H.children[At];Ut&&Ut.leaf&&Ut.objects&&(Ut.objects.push(k),mt[k]?mt[k].push(Ut):mt[k]=[Ut])}}return dt?k:void 0}removeById(k){if(!this._objects[k])return k;this._size--;const P=this._idToCell[k];for(let D=0;D<P.length;D++){const B=P[D].objects||[];for(let $=0,H=B.length;$<H;$++)if(B[$]===k){B.splice($,1);break}}return delete this._objects[k],delete this._idToCell[k],k}remove(k){const[P,D,B,$]=this._getBounds(k),H=[this._root];let X,lt;const dt=[];for(;X=H.pop();)if($s(P,D,B,$,X.minX,X.minY,X.maxX,X.maxY))if(X.leaf){const ct=X.objects||[];for(let mt=0,yt=ct.length;mt<yt;mt++)if(ct[mt]===k){ct.splice(mt,1),yt===1&&dt.push(X);break}}else H.push.apply(H,X.children);if(delete this._idToCell[k],delete this._objects[k],this._size--,dt.length)for(;lt=dt.pop();){let ct=lt.parent,mt=!0;for(;ct&&mt;){if(!ct.leaf){for(let yt=0;yt<4;yt++)if(X=ct.children[yt],!X.leaf||X.objects&&X.objects.length!==0){mt=!1;break}mt&&(ct.leaf=!0,ct.children=[],ct.objects=[])}ct=ct.parent}}return k}splitNode(k){const{minX:P,minY:D,maxX:B,maxY:$}=k,H=(P+B)/2,X=(D+$)/2,lt=k.level+1,dt=this._idToCell,ct=this._maxLevel,mt=[Ms(P,D,H,X,k,lt),Ms(P,X,H,$,k,lt),Ms(H,X,B,$,k,lt),Ms(H,D,B,X,k,lt)];if(k.objects!==null){const yt=k.objects,Nt=this._getBounds;for(let Tt=0,At=yt.length;Tt<At;Tt++){const Ut=yt[Tt],he=Nt(Ut);let xe=dt[Ut];for(let be=0;be<4;be++){const ue=mt[be],{minX:_e,minY:Te,maxX:Ve,maxY:Ie}=ue;$s(he[0],he[1],he[2],he[3],_e,Te,Ve,Ie)&&(ue.objects&&ue.objects.push(Ut),(ue.level>=ct||Math.abs(Ve-_e)<=Math.abs(he[2]-he[0])||Math.abs(Ie-Te)<=Math.abs(he[3]-he[1]))&&(ue.final=!0),xe?xe.push(ue):xe=[ue])}xe&&xe.splice(xe.indexOf(k),1)}}k.children=mt,k.objects=null,k.leaf=!1}point(k,P,D){let B=[];const $=[this._root];let H,X,lt;const dt=this._getBounds;for(;H=$.pop();)if(k>=H.minX&&k<=H.maxX&&P>=H.minY&&P<=H.maxY){if(H.leaf){D&&H.objects&&(B=H.objects);const ct=H.objects||[];for(let mt=0,yt=ct.length;mt<yt;mt++)lt=ct[mt],X=dt(lt),k>=X[0]&&k<=X[2]&&P>=X[1]&&P<=X[3]&&B.push(lt);break}$.push.apply($,H.children)}return B.length?B:null}neigbours(k,P){let D,B=[];const $=[this._root];for(;D=$.pop();)if(k>=D.minX&&k<=D.maxX&&P>=D.minY&&P<=D.maxY){if(D.leaf){B=D.objects;break}$.push.apply($,D.children)}return B}query(k,P,D,B){const $=[],H=[this._root];let X,lt,dt;const ct=this._getBounds,mt={},yt=this._intersects;let Nt;for(;X=H.pop();)if($s(k,P,D,B,X.minX,X.minY,X.maxX,X.maxY))if(X.leaf){const Tt=X.objects||[];for(let At=0,Ut=Tt.length;At<Ut;At++)dt=Tt[At],mt[dt]||(lt=ct(dt),$s(k,P,D,B,lt[0],lt[1],lt[2],lt[3])&&(yt&&!yt(dt,k,P,D,B)||$.push(dt)),mt[dt]=!0)}else Nt=un(k,P,D,B,X.minX,X.minY,X.maxX,X.maxY),H.push(X.children[(Nt+3)%4],X.children[(Nt+2)%4],X.children[(Nt+1)%4],X.children[Nt]);return $}traverse(k,P,D,B,$){const H=[],X=[this._root];let lt,dt,ct;const mt=this._getBounds,yt={},Nt=this._intersects;let Tt;for(;lt=X.pop();)if($s(k,P,D,B,lt.minX,lt.minY,lt.maxX,lt.maxY))if(lt.leaf){const At=lt.objects||[];for(let Ut=0,he=At.length;Ut<he;Ut++)if(ct=At[Ut],!yt[ct]){if(dt=mt(ct),$s(k,P,D,B,dt[0],dt[1],dt[2],dt[3])&&(!Nt||Nt(ct,k,P,D,B))&&(H.push(ct),$(ct)))return H;yt[ct]=!0}}else Tt=un(k,P,D,B,lt.minX,lt.minY,lt.maxX,lt.maxY),X.push(lt.children[(Tt+3)%4],lt.children[(Tt+2)%4],lt.children[(Tt+1)%4],lt.children[Tt]);return H}getOverlaps(){const k=[this._root];let P,D,B;const $=[],H=this._getBounds,X={};for(;P=k.pop();)if(P.leaf){const lt=P.objects||[],dt=lt.length;for(let ct=0;ct<dt;ct++)for(let mt=0;mt<dt;mt++)if(D=lt[ct],B=lt[mt],ct!==mt&&!X[D+":"+B]&&!X[B+":"+D]){X[D+":"+B]=!0;const yt=H(D),Nt=H(B);$s(yt[0],yt[1],yt[2],yt[3],Nt[0],Nt[1],Nt[2],Nt[3])&&$.push(D,B)}}else k.push.apply(k,P.children);return $}cover(k,P,D,B){if(this._root===null)return this._root=Ms(k,P,D,B,null,0),this;let $=this._root;if(!fn(k,P,D,B,$.minX,$.minY,$.maxX,$.maxY)){let H=this._rootLevel;for(;!fn(k,P,D,B,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){$=this._root;const{minX:ct,minY:mt,maxX:yt,maxY:Nt}=$;let Tt=ct,At=mt,Ut=yt,he=Nt;const xe=Math.abs(yt-ct),be=Math.abs(Nt-mt);if(be===0&&xe===0)break;const ue=Math.max(xe,be);k<ct?(Tt-=ue,P<mt?At-=ue:he+=ue):(Ut+=ue,P<mt?At-=ue:he+=ue);const _e=Ms(Tt,At,Ut,he,null,--H);this.splitNode(_e),_e.children[un(ct,mt,yt,Nt,Tt,At,Ut,he)]=$,this._root=$.parent=_e}const X=[this._root];let lt,dt;for(this._root.level=this._rootLevel;lt=X.shift();)if(dt=lt,!dt.leaf)for(let ct=0;ct<4;ct++){const mt=dt.children[ct];mt.level=dt.level+1,X.push(mt)}}return this}getAll(){return Object.keys(this._objects).map((k=>Number(k)))}forEach(k,P){const D=[this._root];let B;for(;B=D.pop();)if(B.leaf&&B.objects)for(let $=0,H=B.objects.length;$<H;$++)k.call(P,B.objects[$]);else D.push.apply(D,B.children);return this}getLeafs(){const k=[this._root],P=[];let D;for(;D=k.pop();)D.leaf?P.push(D):k.push.apply(k,D.children);return P}traverseFromRoot(k,P){const D=[this._root];let B;for(;B=D.pop();)k.call(P,B,B.objects)||B.leaf||D.push.apply(D,B.children);return this}update(k,P,D,B,$){return this.remove(k),this.insert(k,P,D,B,$),this}getNodeBounds(k){return An(k)}}Ds.flatAccessor=(gt,k)=>P=>{const D=k*P;return gt.slice(D,D+k)},Ds.inside=fn,Ds.intersects=function(k,P,D,B,$,H,X,lt){return k>$&&k<X&&P>H&&P<lt||D>$&&D<X&&B>H&&B<lt},Ds.overlaps=$s,Ds.getNodeBBox=An,i.GeometryTypes=h,i.HGrid=class extends zs{constructor(k,P,D=16,B=65536,$=Int32Array,H=16){super(),this._occupied=0,this._idToCode=new Oe,this._codeCache=[0,0,0],this.code=(X,lt,dt)=>dt|x(X,lt)<<this._bitsForZoom,this.decode=(X,lt)=>(x.reverse(X>>this._bitsForZoom,lt),lt[2]=X&this._zoomMask,lt),this._intersects=k,this._getBounds=P,this._cells=new pt($),this._offset=B,this._maxLevels=H,this._mortonMax=(1<<this._maxLevels)-1,this._bitsForZoom=Math.log2(this._maxLevels),this._zoomMask=(1<<this._bitsForZoom)-1,this._objectsAtLevel=new Array(this._maxLevels).fill(0),this._min=-B,this._max=B,this._resolution=this._mortonMax/(this._max-this._min),this._minCellSize=D*this._resolution,this._bounds=new Array(4*this._maxLevels);for(let X=0;X<this._maxLevels;X++)this._bounds[4*X]=1/0,this._bounds[4*X+1]=1/0,this._bounds[4*X+2]=-1/0,this._bounds[4*X+3]=-1/0}setMinCellSize(k){return this._minCellSize=k,this}setOffset(k){return this._offset=k,this._min=-k,this._max=k,this._resolution=this._mortonMax/(this._max-this._min),this}insert(k,P,D,B,$){P===void 0&&([P,D,B,$]=this._getBounds(k));const H=Math.max(B-P,$-D);let X,lt=this._minCellSize;for(X=0;lt<H&&X<this._maxLevels-1;X++)lt*=2;const dt=this._resolution,ct=this._min,mt=dt*(.5*(B+P)-ct)/lt|0,yt=dt*(.5*($+D)-ct)/lt|0,Nt=this.code(mt,yt,X);this._cells.has(Nt)||this._cells.addEntry(Nt),this._cells.addTo(Nt,k),this._objectsAtLevel[X]++,this._occupied|=1<<X;const Tt=4*X,At=this._bounds;return mt<At[Tt]&&(At[Tt]=mt),yt<At[Tt+1]&&(At[Tt+1]=yt),mt>At[Tt+2]&&(At[Tt+2]=mt),yt>At[Tt+3]&&(At[Tt+3]=yt),this._idToCode.set(k,Nt),Nt}has(k){return this._idToCode.has(k)}update(k,P,D,B,$){return this.remove(k),this.insert(k,P,D,B,$)}remove(k){const P=this._idToCode.get(k);this.decode(P,this._codeCache);const D=this._codeCache[2];return--this._objectsAtLevel[D]==0&&(this._occupied&=~(1<<D),this._bounds[4*D]=1/0,this._bounds[4*D+1]=1/0,this._bounds[4*D+2]=-1/0,this._bounds[4*D+3]=-1/0),this._cells.removeFrom(P,k),this._idToCode.delete(k),this}query(k,P,D,B){const $=this._cells,H=this._bounds,X=this._intersects,lt=this._min,dt=this._resolution;let ct=this._minCellSize,mt=this._occupied;const yt=[];for(let Nt=0;Nt<this._maxLevels&&mt!==0;ct*=2,mt>>=1,Nt++){if((1&mt)==0)continue;const Tt=1/ct,At=4*Nt,Ut=Math.max(H[At],dt*(k-lt)*Tt-1>>0),he=Math.max(H[At+1],dt*(P-lt)*Tt-1>>0),xe=Math.min(H[At+2],dt*(D-lt)*Tt+1>>0),be=Math.min(H[At+3],dt*(B-lt)*Tt+1>>0);for(let ue=Ut;ue<=xe;ue++)for(let _e=he;_e<=be;_e++){const Te=this.code(ue,_e,Nt);if(!$.has(Te))continue;const Ve=$.getItems(Te);if(Ve!==void 0)for(let Ie=0;Ie<Ve.length;Ie++){const je=Ve[Ie];X(je,k,P,D,B)&&yt.push(je)}}}return yt}traverse(k,P,D,B,$){const H=this._cells,X=this._bounds,lt=this._intersects,dt=this._min,ct=this._resolution;let mt=this._minCellSize,yt=this._occupied;const Nt=[];for(let Tt=0;Tt<this._maxLevels&&yt!==0;mt*=2,yt>>=1,Tt++){if((1&yt)==0)continue;const At=1/mt,Ut=4*Tt,he=Math.max(X[Ut],ct*(k-dt)*At-1>>0),xe=Math.max(X[Ut+1],ct*(P-dt)*At-1>>0),be=Math.min(X[Ut+2],ct*(D-dt)*At+1>>0),ue=Math.min(X[Ut+3],ct*(B-dt)*At+1>>0);for(let _e=he;_e<=be;_e++)for(let Te=xe;Te<=ue;Te++){const Ve=this.code(_e,Te,Tt),Ie=H.getItems(Ve);if(Ie!==void 0)for(let je=0;je<Ie.length;je++){const Pe=Ie[je];if(lt(Pe,k,P,D,B)&&(Nt.push(Pe),$(Pe)))return Nt}}}return Nt}collisions(k,P=this._getBounds){if(typeof P!="function")throw new Error("getBounds function is required to get the object bounds");const D=Array.from(this._idToCode.keys()),B=this._min,$=this._resolution,H=this._cells,X=new Oe,lt=[];for(let dt=0;dt<D.length;dt++){let ct=0,mt=this._minCellSize,yt=this._occupied;const Nt=D[dt];let[Tt,At,Ut,he]=P(Nt);const xe=Math.max(Ut-Tt,he-At);for(ct=0;mt<xe;ct++)mt*=2,yt>>=1;Tt=$*(Tt-B),At=$*(At-B),Ut=$*(Ut-B),he=$*(he-B);for(let be=ct;be<this._maxLevels&&yt!==0;mt*=2,yt>>=1,be++){if((1&yt)==0)continue;const ue=1/mt,_e=At*ue-1>>0,Te=Ut*ue+1>>0,Ve=he*ue+1>>0;for(let Ie=Tt*ue-1>>0;Ie<=Te;Ie++)for(let je=_e;je<=Ve;je++){const Pe=this.code(Ie,je,be);if(X.get(Pe)===dt)continue;X.set(Pe,dt);const Be=H.getItems(Pe);if(Be!==void 0)for(let Ue=0;Ue<Be.length;Ue++){const es=Be[Ue],[os,cs,Y,et]=this._getBounds(es);es!==Nt&&k(Nt,os,cs,Y,et)&&lt.push(Nt,es)}}}}return(function(ct){const mt=new Ns,yt=[];for(let Nt=0;Nt<ct.length;Nt+=2){const Tt=ct[Nt],At=ct[Nt+1],Ut=Tt<At?Tt*At+(At-Tt-1)*(At-Tt-1)/4:Tt*At+(Tt-At-1)*(Tt-At-1)/4;mt.has(Ut)||(mt.add(Ut),yt.push(Tt,At))}return yt})(lt)}clear(){this._occupied=0,this._cells.clear(),this._idToCode.clear(),this._objectsAtLevel=new Array(this._maxLevels).fill(0),this._bounds=new Array(4*this._maxLevels);for(let k=0;k<this._maxLevels;k++)this._bounds[4*k]=1/0,this._bounds[4*k+1]=1/0,this._bounds[4*k+2]=-1/0,this._bounds[4*k+3]=-1/0;return this}keyToBBox(k){const[P,D,B]=this.decode(k,[0,0,0]),$=this._minCellSize*(1<<B),H=this._min,X=this._resolution;return[P*$/X+H,D*$/X+H,(P+1)*$/X+H,(D+1)*$/X+H]}keys(){return this._cells.keys()}get averageCellOccupancy(){return this._cells.averageSize}get size(){return this._idToCode.size}getBoxes(){return Array.from(this._idToCode.keys()).map((k=>this._getBounds(k)))}},i.Quadtree=Ds,i.SGrid=class extends zs{constructor(k,P,D){super();const B=this.cells=[];if(k instanceof ArrayBuffer){this.arrayBuffer=k;const H=new Int32Array(this.arrayBuffer);k=H[0],P=H[1],D=H[2],this.d=P+2*D;for(let dt=0;dt<this.d*this.d;dt++){const ct=H[3+dt],mt=H[3+dt+1];B.push(ct===mt?null:H.subarray(ct,mt))}const X=H[3+B.length],lt=H[3+B.length+1];this.keys=H.subarray(X,lt),this.bboxes=H.subarray(lt),this.insert=this._insertReadonly}else{this.d=P+2*D;for(let H=0;H<this.d*this.d;H++)B.push([]);this.keys=[],this.bboxes=[]}this.n=P,this.extent=k,this.padding=D,this.scale=P/k,this.uid=0;const $=D/P*k;this.min=-$,this.max=k+$}insert(k,P,D,B,$){return P===void 0&&([P,D,B,$]=this._getBounds(k)),this._forEachCell(P,D,B,$,this._insertCell,this.uid++),this.keys.push(k),this.bboxes.push(P),this.bboxes.push(D),this.bboxes.push(B),this.bboxes.push($),this}_insertReadonly(k,P,D,B,$){throw"Cannot insert into a GridIndex created from an ArrayBuffer."}_insertCell(k,P,D,B,$,H){this.cells[$].push(H)}query(k,P,D,B,$){const H=this.min,X=this.max;if(k<=H&&P<=H&&X<=D&&X<=B&&!$)return Array.prototype.slice.call(this.keys);{const lt=[],dt={};return this._forEachCell(k,P,D,B,this._queryCell,lt,dt,$),lt}}traverse(k,P,D,B,$,H){const X=this.min,lt=this.max;if(k<=X&&P<=X&&lt<=D&&lt<=B&&!H)return Array.prototype.slice.call(this.keys);{const dt=[],ct={};return this._forEachCell(k,P,D,B,this._queryCellEarlyStop,dt,ct,$,H),dt}}_queryCell(k,P,D,B,$,H,X,lt){const dt=this.cells[$];if(dt!==null){const ct=this.keys,mt=this.bboxes,yt=this._intersects;for(let Nt=0;Nt<dt.length;Nt++){const Tt=dt[Nt];if(X[Tt]===void 0){const At=4*Tt;!(lt?lt(mt[At+0],mt[At+1],mt[At+2],mt[At+3]):k<=mt[At+2]&&P<=mt[At+3]&&D>=mt[At+0]&&B>=mt[At+1])||yt&&!yt(Tt,k,P,D,B)?yt&&!yt(Tt,k,P,D,B)||(X[Tt]=!1):(X[Tt]=!0,H.push(ct[Tt]))}}}}_queryCellEarlyStop(k,P,D,B,$,H,X,lt,dt){const ct=this.cells[$];if(ct!==null){const mt=this.keys,yt=this.bboxes,Nt=this._intersects;for(let Tt=0;Tt<ct.length;Tt++){const At=ct[Tt];if(X[At]===void 0){const Ut=4*At;if(!(dt?dt(yt[Ut+0],yt[Ut+1],yt[Ut+2],yt[Ut+3]):k<=yt[Ut+2]&&P<=yt[Ut+3]&&D>=yt[Ut+0]&&B>=yt[Ut+1])||Nt&&!Nt(At,k,P,D,B))Nt&&!Nt(At,k,P,D,B)||(X[At]=!1);else if(X[At]=!0,H.push(mt[At]),lt(At))return!0}}}}remove(k){throw new Error("Method not implemented yet.")}update(k,P,D,B,$){throw new Error("Method not implemented yet.")}clear(){const k=this.cells=[];if(this.arrayBuffer){for(let P=0;P<this.d*this.d;P++)k.push(null);this.keys=new Int32Array([]),this.bboxes=new Int32Array([])}else{for(let P=0;P<this.d*this.d;P++)k.push([]);this.keys=[],this.bboxes=[]}return this.uid=0,this}_forEachCell(k,P,D,B,$,H,X,lt,dt){const ct=this._convertToCellCoord(k),mt=this._convertToCellCoord(P),yt=this._convertToCellCoord(D),Nt=this._convertToCellCoord(B);for(let Tt=ct;Tt<=yt;Tt++)for(let At=mt;At<=Nt;At++){const Ut=this.d*At+Tt;if((!dt||dt(this._convertFromCellCoord(Tt),this._convertFromCellCoord(At),this._convertFromCellCoord(Tt+1),this._convertFromCellCoord(At+1)))&&$.call(this,k,P,D,B,Ut,H,X,lt,dt))return}}_convertFromCellCoord(k){return(k-this.padding)/this.scale}_convertToCellCoord(k){return Math.max(0,Math.min(this.d-1,Math.floor(k*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const k=this.cells,P=3+this.cells.length+1+1;let D=0;for(let H=0;H<this.cells.length;H++)D+=this.cells[H].length;const B=new Int32Array(P+D+this.keys.length+this.bboxes.length);B[0]=this.extent,B[1]=this.n,B[2]=this.padding;let $=P;for(let H=0;H<k.length;H++){const X=k[H];B[3+H]=$,B.set(X,$),$+=X.length}return B[3+k.length]=$,B.set(this.keys,$),$+=this.keys.length,B[3+k.length+1]=$,B.set(this.bboxes,$),$+=this.bboxes.length,B.buffer}},i.UBTree=Fe,i.morton=x,Object.defineProperty(i,"__esModule",{value:!0})},typeof t=="object"&&e!==void 0?n(t):typeof define=="function"&&define.amd?define(["exports"],n):n((s=typeof globalThis<"u"?globalThis:s||self).SpatialIndex={})}}),Ps=class{constructor(t){this._ogma=t}};function _d(t,e){for(let s=1,n=t.length;s<n;s++){const i=t[s];let r=s;for(;r>0&&e.get(t[r-1])>e.get(i);)t[r]=t[r-1],--r;t[r]=i}return t}function QI(t,e){for(let s=1,n=t.length;s<n;s++){const i=t[s];let r=s;for(;r>0&&e.get(t[r-1])<e.get(i);)t[r]=t[r-1],--r;t[r]=i}return t}function Nn(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Q_(t){return Array.isArray(t)?t:[t]}function lT(t){const e=[];for(let s=0;s<t.length;++s){const n=t[s];if(Array.isArray(n))for(let i=0;i<n.length;++i)e.push(n[i]);else e.push(n)}return e}function JI(...t){if(t.length===0)return[];const e=t[0].constructor;let s=0;for(const r of t)s+=r.length;const n=new e(s);let i=0;for(const r of t){for(let o=0;o<r.length;o++)n[i+o]=r[o];i+=r.length}return n}function tR(t,e){const s=t.indexOf(e);return s!==-1&&(t.splice(s,1),!0)}function uT(t,e){let s,n,i=0,r=t.length-1;for(;i<=r;)if(s=(i+r)/2|0,n=t[s],n<e)i=s+1;else{if(!(n>e))return s;r=s-1}return-1}var Xd=(t,e)=>{const s=new Array(t.length);for(let n=0;n<t.length;n++)s[n]=e[t[n]];return s};function eR(t){return typeof t=="number"&&t%1==0}function J_(t){return Array.isArray(t)?t.join("."):t}function Ua(t){if(!t)return[];if(typeof t=="string")return t.split(".");if(Array.isArray(t)){for(let e=0;e<t.length;++e)if(typeof t[e]!="string")throw new TypeError(`${t[e]} is not a string`);return t.slice()}throw new TypeError(`invalid property path "${t}": expected string or array of strings`)}function Zd(t,e,s){let n,i,r;if(e===0)return function(){t.apply(s,arguments)};const o=function(){n=!1,i&&(r.apply(s,i),i=null)};return r=function(){let a;return n?i=arguments:(a=t.apply(s,arguments),setTimeout(o,e),n=!0),a},r}function dT(t,e){let s,n=!1;return function i(){s?n=!0:s=setTimeout((()=>{if(s=null,n)return i(),void(n=!1);n=!1,t()}),e)}}function sR(t,e,s){let n,i,r,o,a;const l=e===0||e===void 0?100:e;function u(){const g=Date.now()-o;g<l&&g>=0?n=setTimeout(u,l-g):(n=null,s||(a=t.apply(r,i),r=i=null))}const h=function(){r=this,i=arguments,o=Date.now();const g=s&&!n;return n||(n=setTimeout(u,e)),g&&(a=t.apply(r,i),r=i=null),a};return h.clear=function(){n&&(clearTimeout(n),n=null)},h.flush=function(){n&&(a=t.apply(r,i),r=i=null,clearTimeout(n),n=null)},h}function hT(t,e,s,n,i){s(t[e],e,t,n,i).then((r=>{e===t.length-1?n(r):hT(t,e+1,s,n,i)})).catch(i)}function nR(t,e){return new Promise(((s,n)=>hT(t,0,e,s,n)))}function Bf(){return new Uint8Array(new Uint32Array([305419896]).buffer)[0]===120}function cT(t){return t.reduce(((e,s)=>e.then(s)),Promise.resolve())}function ty(t,e,s,n,i,r,o,a){return t+i+256*(e+r)+65536*(s+o)+16777216*(n+a)}function iR(t,e){return t<e?t*e+Math.pow(e-t-1,2)/4:t*e+Math.pow(t-e-1,2)/4}function Ga(t){return!(t===null||typeof t!="object"||Nn(t)||t instanceof RegExp||typeof HTMLElement<"u"&&t instanceof HTMLElement)}function zd(t){const e=Object.keys(t),s=new Array(e.length);for(let n=0;n<e.length;++n)s[n]=t[e[n]];return s}function Mr(t,e,s){if(Array.isArray(t))return t.forEach(e,s);if(!Ga(t))throw new Error("forEach: invalid argument "+JSON.stringify(t));const n=Object.keys(t);if(s!==void 0)for(let i=0;i<n.length;++i){const r=n[i];e.call(s,t[r],r)}else for(let i=0;i<n.length;++i){const r=n[i];e(t[r],r)}}function Zs(t){if(Array.isArray(t)){const n=new Array(t.length);for(let i=0;i<t.length;++i)n[i]=Zs(t[i]);return n}if(!gn(t))return t;const e={},s=Object.keys(t);for(const n of s)e[n]=Zs(t[n]);return e}function rR(t,e){e.forEach((s=>{t.indexOf(s)===-1&&t.push(s)}))}function no(t,e,s){const n=typeof e=="string"?e.split("."):e;for(let i=0;i<n.length-1;++i){const r=n[i];let o=t[r];o||(o={},t[r]=o),t=o}t[n[n.length-1]]=s}function Ys(t,e){const s=Ua(e);if(!s.length)return t;if(t){for(let n=0;n<s.length-1;++n){const i=t[s[n]];if(!i)return;t=i}return t[s[s.length-1]]}}function Kd(t,e,s="."){e||(e=r=>!Ga(r));const n={},i=Object.keys(t);for(let r=0;r<i.length;++r){const o=i[r],a=t[o];if(a instanceof Date)n[o]=a;else if(e(a))n[o]=a;else{const l=Kd(a,e),u=Object.keys(l);for(let h=0;h<u.length;h++){const g=u[h];n[`${o}${s}${g}`]=l[g]}}}return n}function ey(t){const e={},s=Object.keys(t);for(let n=0;n<s.length;++n){const i=s[n];no(e,i,t[i])}return e}function Va(t,e,s=[]){const n=Object.keys(t);for(let i=0;i<n.length;++i){const r=n[i],o=t[r],a=e?e+r:r;gn(o)?Va(o,a+".",s):s.push(a)}return s}var gT=Object.prototype.hasOwnProperty;function fT(t,e){const s=[t];let n;for(;s.length>0;)if(n=s.pop(),n)if(gn(n))for(const i in n)gT.call(n,i)&&s.push(n[i]);else e(n)}function oR(t){const e={};return fT(t,(s=>e[s.getName()]=s)),e}function Uf(t,e=[]){if(gn(t)){const s=Object.keys(t);for(const n of s)Uf(t[n],e)}else e.push(t);return e}function Gf(t){for(const e in t)typeof t[e]=="function"&&delete t[e];return t}function ki(t,e){if(t===void 0)return Zs(e);if(!Ga(t))return t;const s={},n=Object.keys(e);for(const i of n){const r=e[i],o=t[i];Ga(r)?s[i]=ki(o,r):s[i]=o===void 0?Zs(r):o}return s}function gn(t){return t&&(t.constructor===Object||!t.constructor)}function Jg(t,e){if(!gn(e)||!gn(t))return e;const s=Object.assign({},t),n=Object.keys(e);for(const i of n)s[i]=Jg(s[i],e[i]);return s}function sy(t,e){return e==null?t:e.reduce(((s,n)=>(s[n]=t[n],s)),{})}var Hl=(...t)=>{const e={};for(let s=0;s<t.length;s++){const n=t[s];for(const i in n)gT.call(n,i)&&(Array.isArray(e[i])&&Array.isArray(n[i])?e[i]=Array.from(new Set(e[i].concat(n[i]))):gn(e[i])&&gn(n[i])?e[i]=Hl(e[i],n[i]):e[i]=n[i])}return e},vh={};/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vf(t){if(t!==vh)throw new Error("Bad secret")}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aR(t,e){if(!uR(t)||e+1!==t.length)throw new TypeError(`
    ############################## ERROR ##############################

    It looks like you are trying to call a template tag function (fn\`...\`)
    using the normal function syntax (fn(...)), which is not supported.

    The functions in the safevalues library are not designed to be called
    like normal functions, and doing so invalidates the security guarantees
    that safevalues provides.

    If you are stuck and not sure how to proceed, please reach out to us
    instead through:
     - https://github.com/google/safevalues/issues

    ############################## ERROR ##############################`)}function yd(t){return Object.isFrozen(t)&&Object.isFrozen(t.raw)}function Pc(t){return t.toString().indexOf("`")===-1}var nE=Pc((t=>t``))||Pc((t=>t`\0`))||Pc((t=>t`\n`))||Pc((t=>t`\u0000`)),lR=yd``&&yd`\0`&&yd`\n`&&yd`\u0000`;function uR(t){return!(!Array.isArray(t)||!Array.isArray(t.raw))&&t.length===t.raw.length&&!(!nE&&t===t.raw)&&!!(nE&&!lR||yd(t))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Um,dR="google#safe",hR=dR,cR=globalThis.trustedTypes,iE=cR;function gR(){let t=null;if(!iE)return t;try{const e=s=>s;t=iE.createPolicy(hR,{createHTML:e,createScript:e,createScriptURL:e})}catch(e){throw e}return t}function Mx(){return Um===void 0&&(Um=gR()),Um}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zc(t){return{valueOf:t}.valueOf()}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var pT=class{constructor(t,e){Vf(t),this.privateDoNotAccessOrElseWrappedHtml=e}toString(){return this.privateDoNotAccessOrElseWrappedHtml+""}},fR=pT;function pR(t){return new fR(vh,t)}function mT(t){const e=t,s=Mx();return pR(s?s.createHTML(e):e)}function mR(t){return t instanceof pT}function kx(t){if(mR(t))return t.privateDoNotAccessOrElseWrappedHtml;{let e="";throw e="Unexpected type when unwrapping SafeHtml",new Error(e)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var _T=class{constructor(t,e){Vf(t),this.privateDoNotAccessOrElseWrappedResourceUrl=e}toString(){return this.privateDoNotAccessOrElseWrappedResourceUrl+""}},_R=_T;function yR(t){return new _R(vh,t)}function xR(t){const e=t,s=Mx();return yR(s?s.createScriptURL(e):e)}function vR(t){return t instanceof _T}function Eu(t){if(vR(t))return t.privateDoNotAccessOrElseWrappedResourceUrl;{let e="";throw e="Unexpected type when unwrapping TrustedResourceUrl",new Error(e)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var tf,rE,yT=class{constructor(t,e){Vf(t),this.privateDoNotAccessOrElseWrappedScript=e}toString(){return this.privateDoNotAccessOrElseWrappedScript+""}},bR=yT;function ER(t){return new bR(vh,t)}function Ix(t){const e=t,s=Mx();return ER(s?s.createScript(e):e)}function SR(t){return t instanceof yT}function xT(t){if(SR(t))return t.privateDoNotAccessOrElseWrappedScript;{let e="";throw e="Unexpected type when unwrapping SafeScript",new Error(e)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AR(t,e){e.appendChild(t);let s=new XMLSerializer().serializeToString(e);return s=s.slice(s.indexOf(">")+1,s.lastIndexOf("</")),mT(s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oE(t){try{return new URL(t,window.document.baseURI)}catch{return new URL("about:invalid")}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wR(t){let e;try{e=new URL(t)}catch{return"https:"}return e.protocol}(function(t){t[t.STYLE_ELEMENT=0]="STYLE_ELEMENT",t[t.STYLE_ATTRIBUTE=1]="STYLE_ATTRIBUTE",t[t.HTML_ATTRIBUTE=2]="HTML_ATTRIBUTE"})(tf||(tf={})),(function(t){t[t.AT_KEYWORD=0]="AT_KEYWORD",t[t.CDC=1]="CDC",t[t.CDO=2]="CDO",t[t.CLOSE_CURLY=3]="CLOSE_CURLY",t[t.CLOSE_PAREN=4]="CLOSE_PAREN",t[t.CLOSE_SQUARE=5]="CLOSE_SQUARE",t[t.COLON=6]="COLON",t[t.COMMA=7]="COMMA",t[t.DELIM=8]="DELIM",t[t.DIMENSION=9]="DIMENSION",t[t.EOF=10]="EOF",t[t.FUNCTION=11]="FUNCTION",t[t.HASH=12]="HASH",t[t.IDENT=13]="IDENT",t[t.NUMBER=14]="NUMBER",t[t.OPEN_CURLY=15]="OPEN_CURLY",t[t.OPEN_PAREN=16]="OPEN_PAREN",t[t.OPEN_SQUARE=17]="OPEN_SQUARE",t[t.PERCENTAGE=18]="PERCENTAGE",t[t.SEMICOLON=19]="SEMICOLON",t[t.STRING=20]="STRING",t[t.WHITESPACE=21]="WHITESPACE"})(rE||(rE={}));var TR=["data:","http:","https:","mailto:","ftp:"],CR=/^\s*(?!javascript:)(?:[\w+.-]+:|[^:/?#]*(?:[/?#]|$))/i;function LR(t){const e=!CR.test(t);return e&&console.error(`A URL with content '${t}' was sanitized away.`),e}function NR(t){if(!LR(t))return t}function bh(t){return NR(t)}function MR(t){const e=wR(t);return e!==void 0&&TR.indexOf(e.toLowerCase())!==-1?t:"about:invalid#zClosurez"}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var kR="display:inline-block;clip-path:inset(0);overflow:hidden;vertical-align:top;text-decoration:inherit",IR=`:host{${kR}}`;/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RR(t,e){return t.createContextualFragment(kx(e))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function FR(t,e){if(e.defaultView)throw new Error("createInertFragment called with non-inert document");const s=e.createRange();return s.selectNode(e.body),RR(s,mT(t))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aE(t){const e=t.nodeName;return typeof e=="string"?e:"FORM"}function lE(t){return t.nodeType===3}function uE(t){const e=t.nodeType;return e===1||typeof e!="number"}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ls,wr=class{constructor(t,e,s,n,i){this.allowedElements=t,this.elementPolicies=e,this.allowedGlobalAttributes=s,this.globalAttributePolicies=n,this.globallyAllowedAttributePrefixes=i}isAllowedElement(t){return t!=="FORM"&&(this.allowedElements.has(t)||this.elementPolicies.has(t))}getAttributePolicy(t,e){const s=this.elementPolicies.get(e);return s!=null&&s.has(t)?s.get(t):this.allowedGlobalAttributes.has(t)?{policyAction:Ls.KEEP}:this.globalAttributePolicies.get(t)||(this.globallyAllowedAttributePrefixes&&[...this.globallyAllowedAttributePrefixes].some((i=>t.indexOf(i)===0))?{policyAction:Ls.KEEP}:{policyAction:Ls.DROP})}};(function(t){t[t.DROP=0]="DROP",t[t.KEEP=1]="KEEP",t[t.KEEP_AND_SANITIZE_URL=2]="KEEP_AND_SANITIZE_URL",t[t.KEEP_AND_NORMALIZE=3]="KEEP_AND_NORMALIZE",t[t.KEEP_AND_SANITIZE_STYLE=4]="KEEP_AND_SANITIZE_STYLE",t[t.KEEP_AND_USE_RESOURCE_URL_POLICY=5]="KEEP_AND_USE_RESOURCE_URL_POLICY",t[t.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET=6]="KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET"})(Ls||(Ls={}));var PR=new Set(["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"]);function zR(t){return!PR.has(t.toUpperCase())&&/^[a-z][-_.a-z0-9]*-[-_.a-z0-9]*$/i.test(t)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var DR=["ARTICLE","SECTION","NAV","ASIDE","H1","H2","H3","H4","H5","H6","HEADER","FOOTER","ADDRESS","P","HR","PRE","BLOCKQUOTE","OL","UL","LH","LI","DL","DT","DD","FIGURE","FIGCAPTION","MAIN","DIV","EM","STRONG","SMALL","S","CITE","Q","DFN","ABBR","RUBY","RB","RT","RTC","RP","DATA","TIME","CODE","VAR","SAMP","KBD","SUB","SUP","I","B","U","MARK","BDI","BDO","SPAN","BR","WBR","NOBR","INS","DEL","PICTURE","PARAM","TRACK","MAP","TABLE","CAPTION","COLGROUP","COL","TBODY","THEAD","TFOOT","TR","TD","TH","SELECT","DATALIST","OPTGROUP","OPTION","OUTPUT","PROGRESS","METER","FIELDSET","LEGEND","DETAILS","SUMMARY","MENU","DIALOG","SLOT","CANVAS","FONT","CENTER","ACRONYM","BASEFONT","BIG","DIR","HGROUP","STRIKE","TT"],OR=[["A",new Map([["href",{policyAction:Ls.KEEP_AND_SANITIZE_URL}]])],["AREA",new Map([["href",{policyAction:Ls.KEEP_AND_SANITIZE_URL}]])],["LINK",new Map([["href",{policyAction:Ls.KEEP_AND_USE_RESOURCE_URL_POLICY,conditions:new Map([["rel",new Set(["alternate","author","bookmark","canonical","cite","help","icon","license","next","prefetch","dns-prefetch","prerender","preconnect","preload","prev","search","subresource"])]])}]])],["SOURCE",new Map([["src",{policyAction:Ls.KEEP_AND_USE_RESOURCE_URL_POLICY}],["srcset",{policyAction:Ls.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET}]])],["IMG",new Map([["src",{policyAction:Ls.KEEP_AND_USE_RESOURCE_URL_POLICY}],["srcset",{policyAction:Ls.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET}]])],["VIDEO",new Map([["src",{policyAction:Ls.KEEP_AND_USE_RESOURCE_URL_POLICY}]])],["AUDIO",new Map([["src",{policyAction:Ls.KEEP_AND_USE_RESOURCE_URL_POLICY}]])]],BR=["title","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-current","aria-disabled","aria-dropeffect","aria-expanded","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","alt","align","autocapitalize","autocomplete","autocorrect","autofocus","autoplay","bgcolor","border","cellpadding","cellspacing","checked","cite","color","cols","colspan","controls","controlslist","datetime","disabled","download","draggable","enctype","face","formenctype","frameborder","height","hreflang","hidden","ismap","label","lang","loop","max","maxlength","media","minlength","min","multiple","muted","nonce","open","placeholder","poster","preload","rel","required","reversed","role","rows","rowspan","selected","shape","size","sizes","slot","span","spellcheck","start","step","summary","translate","type","valign","value","width","wrap","itemscope","itemtype","itemid","itemprop","itemref"],UR=[["dir",{policyAction:Ls.KEEP_AND_NORMALIZE,conditions:zc((()=>new Map([["dir",new Set(["auto","ltr","rtl"])]])))}],["async",{policyAction:Ls.KEEP_AND_NORMALIZE,conditions:zc((()=>new Map([["async",new Set(["async"])]])))}],["loading",{policyAction:Ls.KEEP_AND_NORMALIZE,conditions:zc((()=>new Map([["loading",new Set(["eager","lazy"])]])))}],["target",{policyAction:Ls.KEEP_AND_NORMALIZE,conditions:zc((()=>new Map([["target",new Set(["_self","_blank"])]])))}]],GR=new wr(new Set(DR),new Map(OR),new Set(BR),new Map(UR),void 0),VR=class{constructor(t,e,s,n,i,r){this.sanitizerTable=t,this.styleElementSanitizer=s,this.styleAttributeSanitizer=n,this.resourceUrlPolicy=i,this.openShadow=r,this.changes=[],Vf(e)}sanitizeAssertUnchanged(t){this.changes=[];const e=this.sanitize(t);if(this.changes.length!==0)throw new Error(`Unexpected change to HTML value as a result of sanitization. Input: "${t}", sanitized output: "${e}"
List of changes:${this.changes.join(`
`)}`);return e}sanitize(t){const e=document.implementation.createHTMLDocument("");return AR(this.sanitizeToFragmentInternal(t,e),e.body)}sanitizeToFragment(t){const e=document.implementation.createHTMLDocument("");return this.styleElementSanitizer&&this.styleAttributeSanitizer?this.sanitizeWithCssToFragment(t,e):this.sanitizeToFragmentInternal(t,e)}sanitizeWithCssToFragment(t,e){const s=document.createElement("safevalues-with-css"),n=this.openShadow?"open":"closed",i=s.attachShadow({mode:n}),r=this.sanitizeToFragmentInternal(t,e),o=document.createElement("style");o.textContent=IR,o.id="safevalues-internal-style",i.appendChild(o),i.appendChild(r);const a=e.createDocumentFragment();return a.appendChild(s),a}sanitizeToFragmentInternal(t,e){const s=FR(t,e),n=document.createTreeWalker(s,5,(a=>this.nodeFilter(a)));let i=n.nextNode();const r=e.createDocumentFragment();let o=r;for(;i!==null;){let a;if(lE(i))if(this.styleElementSanitizer&&o.nodeName==="STYLE"){const l=this.styleElementSanitizer(i.data);a=this.createTextNode(l)}else a=this.sanitizeTextNode(i);else{if(!uE(i)){let l="";throw l="Node is not of type text or element",new Error(l)}a=this.sanitizeElementNode(i,e)}if(o.appendChild(a),i=n.firstChild(),i)o=a;else for(;!(i=n.nextSibling())&&(i=n.parentNode());)o=o.parentNode}return r}createTextNode(t){return document.createTextNode(t)}sanitizeTextNode(t){return this.createTextNode(t.data)}sanitizeElementNode(t,e){const s=aE(t),n=e.createElement(s),i=t.attributes;for(const{name:r,value:o}of i){const a=this.sanitizerTable.getAttributePolicy(r,s);if(this.satisfiesAllConditions(a.conditions,i))switch(a.policyAction){case Ls.KEEP:$r(n,r,o);break;case Ls.KEEP_AND_SANITIZE_URL:const l=MR(o);l!==o&&this.recordChange(`Url in attribute ${r} was modified during sanitization. Original url:"${o}" was sanitized to: "${l}"`),$r(n,r,l);break;case Ls.KEEP_AND_NORMALIZE:$r(n,r,o.toLowerCase());break;case Ls.KEEP_AND_SANITIZE_STYLE:this.styleAttributeSanitizer?$r(n,r,this.styleAttributeSanitizer(o)):$r(n,r,o);break;case Ls.KEEP_AND_USE_RESOURCE_URL_POLICY:if(this.resourceUrlPolicy){const u={type:tf.HTML_ATTRIBUTE,attributeName:r,elementName:s},h=oE(o),g=this.resourceUrlPolicy(h,u);g&&$r(n,r,g.toString())}else $r(n,r,o);break;case Ls.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET:if(this.resourceUrlPolicy){const u={type:tf.HTML_ATTRIBUTE,attributeName:r,elementName:s},h=jR(o),g={parts:[]};for(const f of h.parts){const p=oE(f.url),y=this.resourceUrlPolicy(p,u);y&&g.parts.push({url:y.toString(),descriptor:f.descriptor})}$r(n,r,HR(g))}else $r(n,r,o);break;case Ls.DROP:this.recordChange(`Attribute: ${r} was dropped`);break;default:$R(a.policyAction,"Unhandled AttributePolicyAction case")}else this.recordChange(`Not all conditions satisfied for attribute: ${r}.`)}return n}nodeFilter(t){if(lE(t))return 1;if(!uE(t))return 2;const e=aE(t);return e===null?(this.recordChange(`Node name was null for node: ${t}`),2):this.sanitizerTable.isAllowedElement(e)?1:(this.recordChange(`Element: ${e} was dropped`),2)}recordChange(t){this.changes.push(t)}satisfiesAllConditions(t,e){var s;if(!t)return!0;for(const[n,i]of t){const r=(s=e.getNamedItem(n))===null||s===void 0?void 0:s.value;if(r&&!i.has(r))return!1}return!0}};function $r(t,e,s){t.setAttribute(e,s)}function jR(t){const e=[];for(const s of t.split(",")){const[n,i]=s.trim().split(/\s+/,2);e.push({url:n,descriptor:i})}return{parts:e}}function HR(t){return t.parts.map((e=>{const{url:s,descriptor:n}=e;return`${s}${n?` ${n}`:""}`})).join(" , ")}function $R(t,e=`unexpected value ${t}!`){throw new Error(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var qR=class{constructor(){this.calledBuild=!1,this.sanitizerTable=GR}onlyAllowElements(t){const e=new Set,s=new Map;for(let n of t){if(n=n.toUpperCase(),!this.sanitizerTable.isAllowedElement(n))throw new Error(`Element: ${n}, is not allowed by html5_contract.textpb`);const i=this.sanitizerTable.elementPolicies.get(n);i!==void 0?s.set(n,i):e.add(n)}return this.sanitizerTable=new wr(e,s,this.sanitizerTable.allowedGlobalAttributes,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowCustomElement(t,e){const s=new Set(this.sanitizerTable.allowedElements),n=new Map(this.sanitizerTable.elementPolicies);if(!zR(t=t.toUpperCase()))throw new Error(`Element: ${t} is not a custom element`);if(e){const i=new Map;for(const r of e)i.set(r.toLowerCase(),{policyAction:Ls.KEEP});n.set(t,i)}else s.add(t);return this.sanitizerTable=new wr(s,n,this.sanitizerTable.allowedGlobalAttributes,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}onlyAllowAttributes(t){const e=new Set,s=new Map,n=new Map;for(const i of t)this.sanitizerTable.allowedGlobalAttributes.has(i)&&e.add(i),this.sanitizerTable.globalAttributePolicies.has(i)&&s.set(i,this.sanitizerTable.globalAttributePolicies.get(i));for(const[i,r]of this.sanitizerTable.elementPolicies.entries()){const o=new Map;for(const[a,l]of r.entries())t.has(a)&&o.set(a,l);n.set(i,o)}return this.sanitizerTable=new wr(this.sanitizerTable.allowedElements,n,e,s,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowDataAttributes(t){if(t===void 0){const s=new Set(this.sanitizerTable.globallyAllowedAttributePrefixes);return s.add("data-"),this.sanitizerTable=new wr(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,this.sanitizerTable.allowedGlobalAttributes,this.sanitizerTable.globalAttributePolicies,s),this}const e=new Set(this.sanitizerTable.allowedGlobalAttributes);for(const s of t){if(s.indexOf("data-")!==0)throw new Error(`data attribute: ${s} does not begin with the prefix "data-"`);e.add(s)}return this.sanitizerTable=new wr(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,e,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowStyleAttributes(){const t=new Map(this.sanitizerTable.globalAttributePolicies);return t.set("style",{policyAction:Ls.KEEP_AND_SANITIZE_STYLE}),this.sanitizerTable=new wr(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,this.sanitizerTable.allowedGlobalAttributes,t,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowClassAttributes(){const t=new Set(this.sanitizerTable.allowedGlobalAttributes);return t.add("class"),this.sanitizerTable=new wr(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,t,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowIdAttributes(){const t=new Set(this.sanitizerTable.allowedGlobalAttributes);return t.add("id"),this.sanitizerTable=new wr(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,t,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowIdReferenceAttributes(){const t=new Set(this.sanitizerTable.allowedGlobalAttributes);return t.add("aria-activedescendant").add("aria-controls").add("aria-labelledby").add("aria-owns").add("for").add("list"),this.sanitizerTable=new wr(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,t,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}withResourceUrlPolicy(t){return this.resourceUrlPolicy=t,this}},YR=class extends qR{build(){if(this.calledBuild)throw new Error("this sanitizer has already called build");return this.calledBuild=!0,new VR(this.sanitizerTable,vh,void 0,void 0,this.resourceUrlPolicy)}};/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WR(t){const e=xT(t).toString(),s=new Blob([e],{type:"text/javascript"});return xR(URL.createObjectURL(s))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sd(t,...e){if(e.some((s=>s!=="")))throw new Error("safeScript only allows empty string expressions to enable inline comments.");return aR(t,e.length),Ix(t.join(""))}function XR(t){return Ix(t.map(xT).join(""))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vT(t,e){const s=bh(e);s!==void 0&&(t.href=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZR(t,e){const s=bh(e);s!==void 0&&(t.href=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KR(t,e){t.href=Eu(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QR(t,e){const s=bh(e);s!==void 0&&(t.formAction=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JR(t,e){t.src=Eu(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tF(t,e){const s=bh(e);s!==void 0&&(t.action=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eF(t,e){t.src=Eu(e).toString()}function sF(t,e){t.srcdoc=kx(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nF(t,e){const s=bh(e);s!==void 0&&(t.formAction=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iF(t,e){t.data=Eu(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rF(t){return oF("script",t)}function oF(t,e=document){var s;const n=(s=e.querySelector)===null||s===void 0?void 0:s.call(e,`${t}[nonce]`);return n==null?"":n.nonce||n.getAttribute("nonce")||""}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aF(t){const e=rF(t.ownerDocument);e&&t.setAttribute("nonce",e)}function lF(t,e,s){t.src=Eu(e),aF(t)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bT(t,e){dF(t)&&uF(t),t.innerHTML=kx(e)}function uF(t){let e="";const s=t.tagName;if(/^(script|style)$/i.test(s))throw e=s.toLowerCase()==="script"?"Use setScriptTextContent with a SafeScript.":"Use setStyleTextContent with a SafeStyleSheet.",new Error(e)}function dF(t){return t.nodeType===1}function hF(t,e,s){if(t.namespaceURI!=="http://www.w3.org/1999/xhtml")throw new Error(`Cannot set attribute '${e}' on '${t.tagName}'.Element is not in the HTML namespace`);switch(e=e.toLowerCase(),`${t.tagName} ${e}`){case"A href":return void vT(t,s);case"AREA href":return void ZR(t,s);case"BASE href":return void KR(t,s);case"BUTTON formaction":return void QR(t,s);case"EMBED src":return void JR(t,s);case"FORM action":return void tF(t,s);case"IFRAME src":return void eF(t,s);case"IFRAME srcdoc":return void sF(t,s);case"IFRAME sandbox":throw new Error("Can't set 'sandbox' on iframe tags. Use setIframeSrcWithIntent or setIframeSrcdocWithIntent instead");case"INPUT formaction":return void nF(t,s);case"LINK href":throw new Error("Can't set 'href' attribute on link tags. Use setLinkHrefAndRel instead");case"LINK rel":throw new Error("Can't set 'rel' attribute on link tags. Use setLinkHrefAndRel instead");case"OBJECT data":return void iF(t,s);case"SCRIPT src":return void lF(t,s);default:if(/^on./.test(e))throw new Error(`Attribute "${e}" looks like an event handler attribute. Please use a safe alternative like addEventListener instead.`);t.setAttribute(e,s)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cF(t,e){return new Worker(Eu(t),e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var gF=typeof global=="object"&&global!==null&&global.it!==void 0,ao=typeof document<"u",Yo=typeof window<"u",jf=Yo&&!window.__OGMA_HEADLESS,Hf=jf&&ao,fF=typeof navigator<"u"&&navigator.userAgent!==void 0?navigator.userAgent.toLowerCase():"",pF=Yo&&/mac/.test(fF),ET=typeof performance<"u"&&performance.now?()=>0|performance.now():()=>Date.now(),mF=ET();function Hn(){return ET()-mF}function ST(){const t=new Date,e=t.getDate(),s=t.getMonth()+1;return`${t.getFullYear()}-${s<10?"0"+s:s}-${e<10?"0"+e:e}`}function AT(){const t=new Date;return`[${Dc((t.getUTCHours()-(t.getTimezoneOffset()/60|0))%24)}:${Dc(t.getUTCMinutes())}:${Dc(t.getUTCSeconds())}:${Dc(t.getUTCMilliseconds(),3)}]`}function Dc(t,e=2){let s=Math.pow(10,e-1),n=String(t);for(;s>1;)t<s&&(n="0"+n),s/=10;return n}function $o(t){gF||console.warn(AT()+" "+t)}function _F(t,e){e.forEach((s=>{Object.getOwnPropertyNames(s.prototype).forEach((n=>{Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(s.prototype,n)||Object.create(null))}))}))}var as=()=>{},ef=()=>!1,Rx=()=>!0,sf=()=>null,hr=t=>t;function wT(t,e,s){const n=t.getObjectList(e.isNode);for(let i=0;i<e._indexes.length;++i){const r=e._indexes[i];s(n.get(r),i,e)}}function TT(t,e,s){const n=new Array(e.size),i=t.getObjectList(e.isNode);for(let r=0;r<e._indexes.length;++r){const o=e._indexes[r],a=i.get(o);n[r]=s(a,r,e)}return n}function CT(t,e,s){s=s||Rx;const n=e.isNode,i=t.acquireIndexList(n),r=t.getObjectList(n),o=t.getListFactory(n);for(let a=0;a<e._indexes.length;++a){const l=e._indexes[a],u=r.get(l);u&&s(u,a,e)&&i.push(l)}return o(i.sliceAndReset())}function LT(t,e,s){const n=t.getObjectList(e.isNode);for(let i=0;i<e._indexes.length;++i){const r=e._indexes[i];if(!s(n.get(r),i,e))return!1}return!0}function NT(t,e,s){const n=t.getObjectList(e.isNode);for(let i=0;i<e._indexes.length;++i){const r=e._indexes[i];if(s(n.get(r),i,e))return!0}return!1}function MT(t,e,s){const n=t.getObjectList(e.isNode);for(let i=0;i<e._indexes.length;++i){const r=e._indexes[i],o=n.get(r);if(s(o,i,e))return o}}function kT(t,e,s,n){const i=t.getListFactory(e.isNode);if(!s)return{valid:e,invalid:i()};const r=t.acquireIndexList(e.isNode),o=t.acquireIndexList(e.isNode),a=t.getObjectList(e.isNode);for(let l=0;l<e._indexes.length;l++){const u=e._indexes[l],h=a.get(u);h!==void 0&&(s(h,n)?r:o).pushUnchecked(u)}return{valid:i(r.sliceAndReset()),invalid:i(o.sliceAndReset())}}function IT(t,e,s,n){const i=t.getObjectList(e.isNode);let r=n;for(let o=0;o<e._indexes.length;++o){const a=e._indexes[o];r=s(r,i.get(a),o)}return r}function RT(t,e){const s=e.isNode,n=t.topology.getDeduper(s),i=t.acquireIndexList(s),r=t.getListFactory(s);for(let o=0;o<e._indexes.length;o++){const a=e._indexes[o];n.get(a)===0&&(n.set(a,1),i.push(a))}return r(i.sliceAndReset())}function FT(t,e,s){const n=e.isNode,i=s.topology.getDeduper(n),r=s.acquireIndexList(n),o=s.getListFactory(n);for(let a=0;a<e._indexes.length;a++){const l=e._indexes[a];i.set(l,1)}for(let a=0;a<t._indexes.length;a++){const l=t._indexes[a];i.get(l)===0&&r.push(l)}return o(r.sliceAndReset())}function PT(t,e){const s=e.isNode,n=t.storage.fetch(s),i=n.getFlexArray("excluded"),r=n.getMaxIndex(),o=t.topology.getDeduper(s),a=t.acquireIndexList(s),l=t.getListFactory(s);for(let u=0;u<e._indexes.length;u++)o.set(e._indexes[u],1);for(let u=1;u<=r;++u)o.get(u)===0&&i.get(u)===0&&a.push(u);return l(a.sliceAndReset())}function zT(t,e,s){const n=t.getListFactory(e.isNode),i=new Uint32Array(e._indexes.length+s._indexes.length);return i.set(e._indexes),i.set(s._indexes,e._indexes.length),n(i)}function DT(t,e){return t.getObjectList(e.isNode).getMultiple(e._indexes)}function $f(t,e){const s=t.getStorage(e.isNode);if(e.isList){const n=new Array(e.size);for(let i=0;i<e._indexes.length;++i)n[i]=s.getId(e._indexes[i]);return n}return s.getId(e._index)}function OT(t,e){return t.topology.getExtremity(!0,e)}function BT(t,e){return t.topology.getExtremity(!1,e)}function UT(t,e,s){return t.getObjectList(e.isNode).get(e._indexes[s])}function GT(t,e,s){const n=t.getListFactory(e.isNode),i=t.getObjectList(e.isNode),r=e._indexes.slice();return r.sort(((o,a)=>{const l=i.get(o),u=i.get(a);return s(l,u)})),n(r)}var yF=[];function VT(t){typeof t=="object"&&t!==null||(t={});const e=typeof t.data=="function"?t.data:hr;return{attributes:Array.isArray(t.attributes)?t.attributes:t.attributes||yF,data:e}}function qf(t,e){for(const s of t){const n=e;Object.keys(n).forEach((i=>{const r=n[i];s.prototype[i]=function(o,a){return $o(`Deprecated method "${i}"; please use "${r}" instead.`),this[r](o,a)}}))}}function dE(t){const e=t.getFlexArray("removed"),s=t.getFlexArray("excluded"),n=t.getFlexArray("virtual");return{all:i=>e.get(i)===0,visible:i=>s.get(i)===0,excluded:i=>s.get(i)===1,raw:i=>n.get(i)===0&&e.get(i)===0,_all:i=>!0}}function hE(t,e,s){return{all:Oc(s.all,t,e),visible:Oc(s.visible,t,e),raw:Oc(s.raw,t,e),_all:Oc(s._all,t,e)}}function Oc(t,e,s){let n=null;return{getList(){if(!n){const i=e(),r=s();r.reset();for(let o=1;o<=i;++o)t(o)&&r.push(o);n=r.sliceAndReset()}return n},invalidList(){n=null}}}function xF(t){if(t===void 0)return Math.round(Math.random()*Number.MAX_SAFE_INTEGER);if(typeof t!="string"&&(typeof t!="number"||!isFinite(t)))throw new Error(`${t} is not a valid id, expected string or number`);return t}var cE=new Uint32Array(1),Ir=class{constructor(t,e){this.size=1,this.isNode=!1,this.isList=!1,this._index=t,this._ogma=e}get _indexes(){return cE[0]=this._index,cE}setAttributes(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)}setAttribute(t,e,s){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,s)}getAttributes(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)[0]}getAttribute(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)[0]}resetAttributes(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)}replaceOriginalAttributes(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)}getPreviousAttributes(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)[0]}isInView(t){return this._ogma.modules.locate.isElementInView(this,t)}hasParallelEdges(){return this._ogma.modules.graph.hasParallelEdges(this)}getParallelEdges(t){return this._ogma.modules.graph.getParallelEdges(this,t)}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)}getAdjacentElements(){const{nodes:t,edges:e}=this.fastGetAdjacentElements();return{nodes:t.dedupe(),edges:e.filter((s=>s!==this)).dedupe()}}isVisible(){return!this.isExcluded()}isExcluded(){return this._ogma.modules.graph.isExcluded(this)[0]}setExcluded(t){return this._ogma.modules.graph.setExcluded(this,t)}setVisible(t){return this.setExcluded(!t)}toList(){return this._ogma.modules.graph.edgeList(new Uint32Array([this._index]))}getId(){return $f(this._ogma.modules.graph,this)}getSource(){return OT(this._ogma.modules.graph,this)}getTarget(){return BT(this._ogma.modules.graph,this)}getExtremities(){return this._ogma.modules.graph.nodeList(new Uint32Array([this.getSource()._index,this.getTarget()._index]))}setSource(t){this._ogma.modules.graph.setSource(this,t)}setTarget(t){this._ogma.modules.graph.setTarget(this,t)}slice(){return this.toList()}toJSON(t={}){const{attributes:e,data:s}=VT(t);return{id:this.getId(),source:this.getSource().getId(),target:this.getTarget().getId(),attributes:this.getAttributes(e),data:s(Zs(this.getData()))}}get(t){return t===0?this:void 0}setSelected(t){this._ogma.modules.selection.setActive(this,t)}isSelected(){return this._ogma.modules.selection.areActive(this)}setDisabled(t){this._ogma.modules.disabled.setActive(this,t)}isDisabled(){return this._ogma.modules.disabled.areActive(this)}locate(t){return this._ogma.modules.locate.locateElements(this,t)}getBoundingBox({includeTexts:t=!1,ignoreCurvature:e=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,t,t,e)}setData(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e),this}getData(t){return this._ogma.modules.data.getProperty(this,t||null)[0]}addClass(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)}addClasses(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)}removeClass(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)}removeClasses(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)}hasClass(t){return this._ogma.modules.classes.hasSingleElementClass(t,this)}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)[0]}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]}isVirtual(){return this._ogma.modules.transformations.isElementVirtual(this)}getTransformation(){return this._ogma.modules.transformations.getElementTransformation(this)}getMetaEdge(){return this._ogma.modules.transformations.getMetaEdge(this)}getSubEdges(){return this._ogma.modules.transformations.getSubEdges(this)}pulse(t){return this._ogma.modules.pulses.pulse(this,t)}};qf([Ir],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var Ya=class{constructor(t,e){this.isList=!0,this.isNode=!1,this._indexes=t,this._ogma=e}get size(){return this._indexes.length}setAttributes(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)}setAttribute(t,e,s){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,s)}getAttributes(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)}getAttribute(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)}resetAttributes(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)}replaceOriginalAttributes(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)}getPreviousAttributes(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)}getPreviousAttribute(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)}getParallelEdges(t){return this._ogma.modules.graph.getParallelEdges(this,t)}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)}getAdjacentElements(){const{nodes:t,edges:e}=this.fastGetAdjacentElements();return{nodes:t.dedupe(),edges:e.subtract(this).dedupe()}}isVisible(){return this.isExcluded().map((t=>!t))}isExcluded(){return this._ogma.modules.graph.isExcluded(this)}isVirtual(){return this.map((t=>this._ogma.modules.transformations.isElementVirtual(t)))}setExcluded(t){return this._ogma.modules.graph.setExcluded(this,t)}setVisible(t){return this.setExcluded(!t)}toList(){return this}toArray(){return DT(this._ogma.modules.graph,this)}clone(){return this._ogma.modules.graph.edgeList(this._indexes.slice())}getId(){return $f(this._ogma.modules.graph,this)}getSource(){return OT(this._ogma.modules.graph,this)}getTarget(){return BT(this._ogma.modules.graph,this)}getExtremities(){return this.getSource().concat(this.getTarget())}get(t){return UT(this._ogma.modules.graph,this,t)}forEach(t){wT(this._ogma.modules.graph,this,t)}map(t){return TT(this._ogma.modules.graph,this,t)}find(t){return MT(this._ogma.modules.graph,this,t)}some(t){return NT(this._ogma.modules.graph,this,t)}every(t){return LT(this._ogma.modules.graph,this,t)}[Symbol.iterator](){let t=-1;return{next:()=>({value:this.get(++t),done:t>=this.size})}}filter(t){return CT(this._ogma.modules.graph,this,t)}reduce(t,e){return IT(this._ogma.modules.graph,this,t,e)}concat(t){return zT(this._ogma.modules.graph,this,t)}dedupe(){return RT(this._ogma.modules.graph,this)}subtract(t){return FT(this,t,this._ogma.modules.graph)}slice(t,e){return this._ogma.modules.graph.edgeList(this._indexes.slice(t,e))}indexOf(t){return t instanceof Ir?this._indexes.indexOf(t._index):-1}includes(t){return this.indexOf(t)!==-1}sort(t){return GT(this._ogma.modules.graph,this,t)}inverse(){return PT(this._ogma.modules.graph,this)}toJSON(t={}){return this.map((e=>e.toJSON(t)))}setSelected(t){this._ogma.modules.selection.setActive(this,t)}isSelected(){return this._ogma.modules.selection.areActive(this)}setDisabled(t){this._ogma.modules.disabled.setActive(this,t)}isDisabled(){return this._ogma.modules.disabled.areActive(this)}locate(t){return this._ogma.modules.locate.locateElements(this,t)}getBoundingBox({includeTexts:t=!1,ignoreCurvature:e=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,t,t,e)}setData(t,e){if(arguments.length<2&&(e=t,t=null),typeof e!="function"&&!Nn(e))throw new Error(`invalid argument ${e}; expected array or function`);return this._ogma.modules.data.setProperty(this,t,e,{dispatch:!0}),this}fillData(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e,{dispatch:!1}),this}getData(t){return this._ogma.modules.data.getProperty(this,t||null)}addClass(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)}addClasses(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)}removeClass(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)}removeClasses(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)}hasClass(t){return this.map((e=>this._ogma.modules.classes.hasSingleElementClass(t,e)))}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)}getMetaEdge(){return this._ogma.modules.transformations.getMetaEdges(this)}getSubEdges(){return this.map(this._ogma.modules.transformations.getSubEdges)}pulse(t){return this._ogma.modules.pulses.pulse(this,t)}};qf([Ya],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var Cr="geo.latitude",Lr="geo.longitude",gE="geo.prevLat",Gm="geo.prevLng",ny=85.0511287798,vF=6378137,nf=1,bF='Map data &copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap contributors</a>',La={latitudePath:"latitude",longitudePath:"longitude",maxZoomLevel:22,minZoomLevel:0,wrapCoordinates:!0,tileUrlTemplate:"https://{s}.tile.osm.org/{z}/{x}/{y}.png",tileUrlSubdomains:"abc",attribution:null,attributionOptions:void 0,backgroundColor:"silver",opacity:1,duration:0,disableNodeDragging:!0,tileBuffer:1,sizeRatio:1,tiles:{url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png",subdomains:"abc",tms:!1,wms:!1},crs:void 0},EF={maxBoundsViscosity:1,worldCopyJump:!0,zoomControl:!1,attributionControl:!1},SF=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let s=0;for(let n=0;n<this._n&&n<32;n++){const i=e[n],r=t+i,o=Math.abs(t)<Math.abs(i)?t-(r-i):i-(r-t);o&&(e[s++]=o),t=r}return e[s]=t,this._n=s+1,this}valueOf(){const t=this._partials;let e,s,n,i=this._n,r=0;if(i>0){for(r=t[--i];i>0&&(e=r,s=t[--i],r=e+s,n=s-(r-e),!n););i>0&&(n<0&&t[i-1]<0||n>0&&t[i-1]>0)&&(s=2*n,e=r+s,s==e-r&&(r=e))}return r}};function*AF(t){for(const e of t)yield*e}function jT(t){return Array.from(AF(t))}var Fs=1e-6,ps=Math.PI,$i=ps/2,fE=ps/4,cr=2*ps,qr=180/ps,Ti=ps/180,an=Math.abs,wF=Math.atan,au=Math.atan2,Ws=Math.cos,Hs=Math.sin,TF=Math.sign||function(t){return t>0?1:t<0?-1:0},Eh=Math.sqrt;function HT(t){return t>1?0:t<-1?ps:Math.acos(t)}function lu(t){return t>1?$i:t<-1?-$i:Math.asin(t)}function xd(){}function rf(t,e){t&&mE.hasOwnProperty(t.type)&&mE[t.type](t,e)}var pE={Feature:function(t,e){rf(t.geometry,e)},FeatureCollection:function(t,e){for(var s=t.features,n=-1,i=s.length;++n<i;)rf(s[n].geometry,e)}},mE={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var s=t.coordinates,n=-1,i=s.length;++n<i;)t=s[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){iy(t.coordinates,e,0)},MultiLineString:function(t,e){for(var s=t.coordinates,n=-1,i=s.length;++n<i;)iy(s[n],e,0)},Polygon:function(t,e){_E(t.coordinates,e)},MultiPolygon:function(t,e){for(var s=t.coordinates,n=-1,i=s.length;++n<i;)_E(s[n],e)},GeometryCollection:function(t,e){for(var s=t.geometries,n=-1,i=s.length;++n<i;)rf(s[n],e)}};function iy(t,e,s){var n,i=-1,r=t.length-s;for(e.lineStart();++i<r;)n=t[i],e.point(n[0],n[1],n[2]);e.lineEnd()}function _E(t,e){var s=-1,n=t.length;for(e.polygonStart();++s<n;)iy(t[s],e,1);e.polygonEnd()}function CF(t,e){t&&pE.hasOwnProperty(t.type)?pE[t.type](t,e):rf(t,e)}function ry(t){return[au(t[1],t[0]),lu(t[2])]}function uu(t){var e=t[0],s=t[1],n=Ws(s);return[n*Ws(e),n*Hs(e),Hs(s)]}function Bc(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function of(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Vm(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Uc(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function oy(t){var e=Eh(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function ay(t,e){function s(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(s.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),s}function ly(t,e){return an(t)>ps&&(t-=Math.round(t/cr)*cr),[t,e]}function LF(t,e,s){return(t%=cr)?e||s?ay(xE(t),vE(e,s)):xE(t):e||s?vE(e,s):ly}function yE(t){return function(e,s){return an(e+=t)>ps&&(e-=Math.round(e/cr)*cr),[e,s]}}function xE(t){var e=yE(t);return e.invert=yE(-t),e}function vE(t,e){var s=Ws(t),n=Hs(t),i=Ws(e),r=Hs(e);function o(a,l){var u=Ws(l),h=Ws(a)*u,g=Hs(a)*u,f=Hs(l),p=f*s+h*n;return[au(g*i-p*r,h*s-f*n),lu(p*i+g*r)]}return o.invert=function(a,l){var u=Ws(l),h=Ws(a)*u,g=Hs(a)*u,f=Hs(l),p=f*i-g*r;return[au(g*i+f*r,h*s+p*n),lu(p*s-h*n)]},o}function NF(t,e,s,n,i,r){if(s){var o=Ws(e),a=Hs(e),l=n*s;i==null?(i=e+n*cr,r=e-l/2):(i=bE(o,i),r=bE(o,r),(n>0?i<r:i>r)&&(i+=n*cr));for(var u,h=i;n>0?h>r:h<r;h-=l)u=ry([o,-a*Ws(h),-a*Hs(h)]),t.point(u[0],u[1])}}function bE(t,e){(e=uu(e))[0]-=t,oy(e);var s=HT(-e[1]);return((-e[2]<0?-s:s)+cr-Fs)%cr}function $T(){var t,e=[];return{point:function(s,n,i){t.push([s,n,i])},lineStart:function(){e.push(t=[])},lineEnd:xd,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var s=e;return e=[],t=null,s}}}function Og(t,e){return an(t[0]-e[0])<Fs&&an(t[1]-e[1])<Fs}function Gc(t,e,s,n){this.x=t,this.z=e,this.o=s,this.e=n,this.v=!1,this.n=this.p=null}function qT(t,e,s,n,i){var r,o,a=[],l=[];if(t.forEach((function(y){if(!((_=y.length-1)<=0)){var _,x,v=y[0],b=y[_];if(Og(v,b)){if(!v[2]&&!b[2]){for(i.lineStart(),r=0;r<_;++r)i.point((v=y[r])[0],v[1]);return void i.lineEnd()}b[0]+=2*Fs}a.push(x=new Gc(v,y,null,!0)),l.push(x.o=new Gc(v,null,x,!1)),a.push(x=new Gc(b,y,null,!1)),l.push(x.o=new Gc(b,null,x,!0))}})),a.length){for(l.sort(e),EE(a),EE(l),r=0,o=l.length;r<o;++r)l[r].e=s=!s;for(var u,h,g=a[0];;){for(var f=g,p=!0;f.v;)if((f=f.n)===g)return;u=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(p)for(r=0,o=u.length;r<o;++r)i.point((h=u[r])[0],h[1]);else n(f.x,f.n.x,1,i);f=f.n}else{if(p)for(u=f.p.z,r=u.length-1;r>=0;--r)i.point((h=u[r])[0],h[1]);else n(f.x,f.p.x,-1,i);f=f.p}u=(f=f.o).z,p=!p}while(!f.v);i.lineEnd()}}}function EE(t){if(e=t.length){for(var e,s,n=0,i=t[0];++n<e;)i.n=s=t[n],s.p=i,i=s;i.n=s=t[0],s.p=i}}function jm(t){return an(t[0])<=ps?t[0]:TF(t[0])*((an(t[0])+ps)%cr-ps)}function MF(t,e){var s=jm(e),n=e[1],i=Hs(n),r=[Hs(s),-Ws(s),0],o=0,a=0,l=new SF;i===1?n=$i+Fs:i===-1&&(n=-$i-Fs);for(var u=0,h=t.length;u<h;++u)if(f=(g=t[u]).length)for(var g,f,p=g[f-1],y=jm(p),_=p[1]/2+fE,x=Hs(_),v=Ws(_),b=0;b<f;++b,y=A,x=L,v=M,p=S){var S=g[b],A=jm(S),w=S[1]/2+fE,L=Hs(w),M=Ws(w),F=A-y,O=F>=0?1:-1,G=O*F,j=G>ps,Z=x*L;if(l.add(au(Z*O*Hs(G),v*M+Z*Ws(G))),o+=j?F+O*cr:F,j^y>=s^A>=s){var at=of(uu(p),uu(S));oy(at);var pt=of(r,at);oy(pt);var K=(j^F>=0?-1:1)*lu(pt[2]);(n>K||n===K&&(at[0]||at[1]))&&(a+=j^F>=0?1:-1)}}return(o<-Fs||o<Fs&&l<-1e-12)^1&a}function YT(t,e,s,n){return function(i){var r,o,a,l=e(i),u=$T(),h=e(u),g=!1,f={point:p,lineStart:_,lineEnd:x,polygonStart:function(){f.point=v,f.lineStart=b,f.lineEnd=S,o=[],r=[]},polygonEnd:function(){f.point=p,f.lineStart=_,f.lineEnd=x,o=jT(o);var A=MF(r,n);o.length?(g||(i.polygonStart(),g=!0),qT(o,IF,A,s,i)):A&&(g||(i.polygonStart(),g=!0),i.lineStart(),s(null,null,1,i),i.lineEnd()),g&&(i.polygonEnd(),g=!1),o=r=null},sphere:function(){i.polygonStart(),i.lineStart(),s(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function p(A,w){t(A,w)&&i.point(A,w)}function y(A,w){l.point(A,w)}function _(){f.point=y,l.lineStart()}function x(){f.point=p,l.lineEnd()}function v(A,w){a.push([A,w]),h.point(A,w)}function b(){h.lineStart(),a=[]}function S(){v(a[0][0],a[0][1]),h.lineEnd();var A,w,L,M,F=h.clean(),O=u.result(),G=O.length;if(a.pop(),r.push(a),a=null,G)if(1&F){if((w=(L=O[0]).length-1)>0){for(g||(i.polygonStart(),g=!0),i.lineStart(),A=0;A<w;++A)i.point((M=L[A])[0],M[1]);i.lineEnd()}}else G>1&&2&F&&O.push(O.pop().concat(O.shift())),o.push(O.filter(kF))}return f}}function kF(t){return t.length>1}function IF(t,e){return((t=t.x)[0]<0?t[1]-$i-Fs:$i-t[1])-((e=e.x)[0]<0?e[1]-$i-Fs:$i-e[1])}ly.invert=ly;var SE=YT((function(){return!0}),RF,PF,[-ps,-$i]);function RF(t){var e,s=NaN,n=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(r,o){var a=r>0?ps:-ps,l=an(r-s);an(l-ps)<Fs?(t.point(s,n=(n+o)/2>0?$i:-$i),t.point(i,n),t.lineEnd(),t.lineStart(),t.point(a,n),t.point(r,n),e=0):i!==a&&l>=ps&&(an(s-i)<Fs&&(s-=i*Fs),an(r-a)<Fs&&(r-=a*Fs),n=FF(s,n,r,o),t.point(i,n),t.lineEnd(),t.lineStart(),t.point(a,n),e=0),t.point(s=r,n=o),i=a},lineEnd:function(){t.lineEnd(),s=n=NaN},clean:function(){return 2-e}}}function FF(t,e,s,n){var i,r,o=Hs(t-s);return an(o)>Fs?wF((Hs(e)*(r=Ws(n))*Hs(s)-Hs(n)*(i=Ws(e))*Hs(t))/(i*r*o)):(e+n)/2}function PF(t,e,s,n){var i;if(t==null)i=s*$i,n.point(-ps,i),n.point(0,i),n.point(ps,i),n.point(ps,0),n.point(ps,-i),n.point(0,-i),n.point(-ps,-i),n.point(-ps,0),n.point(-ps,i);else if(an(t[0]-e[0])>Fs){var r=t[0]<e[0]?ps:-ps;i=s*r/2,n.point(-r,i),n.point(0,i),n.point(r,i)}else n.point(e[0],e[1])}function zF(t){var e=Ws(t),s=2*Ti,n=e>0,i=an(e)>Fs;function r(l,u){return Ws(l)*Ws(u)>e}function o(l,u,h){var g=[1,0,0],f=of(uu(l),uu(u)),p=Bc(f,f),y=f[0],_=p-y*y;if(!_)return!h&&l;var x=e*p/_,v=-e*y/_,b=of(g,f),S=Uc(g,x);Vm(S,Uc(f,v));var A=b,w=Bc(S,A),L=Bc(A,A),M=w*w-L*(Bc(S,S)-1);if(!(M<0)){var F=Eh(M),O=Uc(A,(-w-F)/L);if(Vm(O,S),O=ry(O),!h)return O;var G,j=l[0],Z=u[0],at=l[1],pt=u[1];Z<j&&(G=j,j=Z,Z=G);var K=Z-j,ut=an(K-ps)<Fs;if(!ut&&pt<at&&(G=at,at=pt,pt=G),ut||K<Fs?ut?at+pt>0^O[1]<(an(O[0]-j)<Fs?at:pt):at<=O[1]&&O[1]<=pt:K>ps^(j<=O[0]&&O[0]<=Z)){var ht=Uc(A,(-w+F)/L);return Vm(ht,S),[O,ry(ht)]}}}function a(l,u){var h=n?t:ps-t,g=0;return l<-h?g|=1:l>h&&(g|=2),u<-h?g|=4:u>h&&(g|=8),g}return YT(r,(function(u){var h,g,f,p,y;return{lineStart:function(){p=f=!1,y=1},point:function(_,x){var v,b=[_,x],S=r(_,x),A=n?S?0:a(_,x):S?a(_+(_<0?ps:-ps),x):0;if(!h&&(p=f=S)&&u.lineStart(),S!==f&&(!(v=o(h,b))||Og(h,v)||Og(b,v))&&(b[2]=1),S!==f)y=0,S?(u.lineStart(),v=o(b,h),u.point(v[0],v[1])):(v=o(h,b),u.point(v[0],v[1],2),u.lineEnd()),h=v;else if(i&&h&&n^S){var w;A&g||!(w=o(b,h,!0))||(y=0,n?(u.lineStart(),u.point(w[0][0],w[0][1]),u.point(w[1][0],w[1][1]),u.lineEnd()):(u.point(w[1][0],w[1][1]),u.lineEnd(),u.lineStart(),u.point(w[0][0],w[0][1],3)))}!S||h&&Og(h,b)||u.point(b[0],b[1]),h=b,f=S,g=A},lineEnd:function(){f&&u.lineEnd(),h=null},clean:function(){return y|(p&&f)<<1}}}),(function(u,h,g,f){NF(f,t,s,g,u,h)}),n?[0,-t]:[-ps,t-ps])}function DF(t,e,s,n,i,r){var o,a=t[0],l=t[1],u=0,h=1,g=e[0]-a,f=e[1]-l;if(o=s-a,g||!(o>0)){if(o/=g,g<0){if(o<u)return;o<h&&(h=o)}else if(g>0){if(o>h)return;o>u&&(u=o)}if(o=i-a,g||!(o<0)){if(o/=g,g<0){if(o>h)return;o>u&&(u=o)}else if(g>0){if(o<u)return;o<h&&(h=o)}if(o=n-l,f||!(o>0)){if(o/=f,f<0){if(o<u)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>u&&(u=o)}if(o=r-l,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>u&&(u=o)}else if(f>0){if(o<u)return;o<h&&(h=o)}return u>0&&(t[0]=a+u*g,t[1]=l+u*f),h<1&&(e[0]=a+h*g,e[1]=l+h*f),!0}}}}}var vd=1e9,Vc=-vd;function OF(t,e,s,n){function i(u,h){return t<=u&&u<=s&&e<=h&&h<=n}function r(u,h,g,f){var p=0,y=0;if(u==null||(p=o(u,g))!==(y=o(h,g))||l(u,h)<0^g>0)do f.point(p===0||p===3?t:s,p>1?n:e);while((p=(p+g+4)%4)!==y);else f.point(h[0],h[1])}function o(u,h){return an(u[0]-t)<Fs?h>0?0:3:an(u[0]-s)<Fs?h>0?2:1:an(u[1]-e)<Fs?h>0?1:0:h>0?3:2}function a(u,h){return l(u.x,h.x)}function l(u,h){var g=o(u,1),f=o(h,1);return g!==f?g-f:g===0?h[1]-u[1]:g===1?u[0]-h[0]:g===2?u[1]-h[1]:h[0]-u[0]}return function(u){var h,g,f,p,y,_,x,v,b,S,A,w=u,L=$T(),M={point:F,lineStart:function(){M.point=O,g&&g.push(f=[]),S=!0,b=!1,x=v=NaN},lineEnd:function(){h&&(O(p,y),_&&b&&L.rejoin(),h.push(L.result())),M.point=F,b&&w.lineEnd()},polygonStart:function(){w=L,h=[],g=[],A=!0},polygonEnd:function(){var j=(function(){for(var K=0,ut=0,ht=g.length;ut<ht;++ut)for(var nt,ot,Mt=g[ut],Q=1,Et=Mt.length,Xt=Mt[0],Ht=Xt[0],Zt=Xt[1];Q<Et;++Q)nt=Ht,ot=Zt,Ht=(Xt=Mt[Q])[0],Zt=Xt[1],ot<=n?Zt>n&&(Ht-nt)*(n-ot)>(Zt-ot)*(t-nt)&&++K:Zt<=n&&(Ht-nt)*(n-ot)<(Zt-ot)*(t-nt)&&--K;return K})(),Z=A&&j,at=(h=jT(h)).length;(Z||at)&&(u.polygonStart(),Z&&(u.lineStart(),r(null,null,1,u),u.lineEnd()),at&&qT(h,a,j,r,u),u.polygonEnd()),w=u,h=g=f=null}};function F(G,j){i(G,j)&&w.point(G,j)}function O(G,j){var Z=i(G,j);if(g&&f.push([G,j]),S)p=G,y=j,_=Z,S=!1,Z&&(w.lineStart(),w.point(G,j));else if(Z&&b)w.point(G,j);else{var at=[x=Math.max(Vc,Math.min(vd,x)),v=Math.max(Vc,Math.min(vd,v))],pt=[G=Math.max(Vc,Math.min(vd,G)),j=Math.max(Vc,Math.min(vd,j))];DF(at,pt,t,e,s,n)?(b||(w.lineStart(),w.point(at[0],at[1])),w.point(pt[0],pt[1]),Z||w.lineEnd(),A=!1):Z&&(w.lineStart(),w.point(G,j),A=!1)}x=G,v=j,b=Z}return M}}var AE=t=>t,du=1/0,af=du,Qd=-du,lf=Qd,BF={point:UF,lineStart:xd,lineEnd:xd,polygonStart:xd,polygonEnd:xd,result:function(){var t=[[du,af],[Qd,lf]];return Qd=lf=-(af=du=1/0),t}};function UF(t,e){t<du&&(du=t),t>Qd&&(Qd=t),e<af&&(af=e),e>lf&&(lf=e)}var wE=BF;function Fx(t){return function(e){var s=new uy;for(var n in t)s[n]=t[n];return s.stream=e,s}}function uy(){}function Px(t,e,s){var n=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),n!=null&&t.clipExtent(null),CF(s,t.stream(wE)),e(wE.result()),n!=null&&t.clipExtent(n),t}function WT(t,e,s){return Px(t,(function(n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=Math.min(i/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),a=+e[0][0]+(i-o*(n[1][0]+n[0][0]))/2,l=+e[0][1]+(r-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,l])}),s)}function GF(t,e,s){return WT(t,[[0,0],e],s)}function VF(t,e,s){return Px(t,(function(n){var i=+e,r=i/(n[1][0]-n[0][0]),o=(i-r*(n[1][0]+n[0][0]))/2,a=-r*n[0][1];t.scale(150*r).translate([o,a])}),s)}function jF(t,e,s){return Px(t,(function(n){var i=+e,r=i/(n[1][1]-n[0][1]),o=-r*n[0][0],a=(i-r*(n[1][1]+n[0][1]))/2;t.scale(150*r).translate([o,a])}),s)}uy.prototype={constructor:uy,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var TE=16,HF=Ws(30*Ti);function CE(t,e){return+e?qF(t,e):$F(t)}function $F(t){return Fx({point:function(e,s){e=t(e,s),this.stream.point(e[0],e[1])}})}function qF(t,e){function s(n,i,r,o,a,l,u,h,g,f,p,y,_,x){var v=u-n,b=h-i,S=v*v+b*b;if(S>4*e&&_--){var A=o+f,w=a+p,L=l+y,M=Eh(A*A+w*w+L*L),F=lu(L/=M),O=an(an(L)-1)<Fs||an(r-g)<Fs?(r+g)/2:au(w,A),G=t(O,F),j=G[0],Z=G[1],at=j-n,pt=Z-i,K=b*at-v*pt;(K*K/S>e||an((v*at+b*pt)/S-.5)>.3||o*f+a*p+l*y<HF)&&(s(n,i,r,o,a,l,j,Z,O,A/=M,w/=M,L,_,x),x.point(j,Z),s(j,Z,O,A,w,L,u,h,g,f,p,y,_,x))}}return function(n){var i,r,o,a,l,u,h,g,f,p,y,_,x={point:v,lineStart:b,lineEnd:A,polygonStart:function(){n.polygonStart(),x.lineStart=w},polygonEnd:function(){n.polygonEnd(),x.lineStart=b}};function v(F,O){F=t(F,O),n.point(F[0],F[1])}function b(){g=NaN,x.point=S,n.lineStart()}function S(F,O){var G=uu([F,O]),j=t(F,O);s(g,f,h,p,y,_,g=j[0],f=j[1],h=F,p=G[0],y=G[1],_=G[2],TE,n),n.point(g,f)}function A(){x.point=v,n.lineEnd()}function w(){b(),x.point=L,x.lineEnd=M}function L(F,O){S(i=F,O),r=g,o=f,a=p,l=y,u=_,x.point=S}function M(){s(g,f,h,p,y,_,r,o,i,a,l,u,TE,n),x.lineEnd=A,A()}return x}}var YF=Fx({point:function(t,e){this.stream.point(t*Ti,e*Ti)}});function WF(t){return Fx({point:function(e,s){var n=t(e,s);return this.stream.point(n[0],n[1])}})}function XF(t,e,s,n,i){function r(o,a){return[e+t*(o*=n),s-t*(a*=i)]}return r.invert=function(o,a){return[(o-e)/t*n,(s-a)/t*i]},r}function LE(t,e,s,n,i,r){if(!r)return XF(t,e,s,n,i);var o=Ws(r),a=Hs(r),l=o*t,u=a*t,h=o/t,g=a/t,f=(a*s-o*e)/t,p=(a*e+o*s)/t;function y(_,x){return[l*(_*=n)-u*(x*=i)+e,s-u*_-l*x]}return y.invert=function(_,x){return[n*(h*_-g*x+f),i*(p-g*_-h*x)]},y}function ZF(t){return KF((function(){return t}))()}function KF(t){var e,s,n,i,r,o,a,l,u,h,g=150,f=480,p=250,y=0,_=0,x=0,v=0,b=0,S=0,A=1,w=1,L=null,M=SE,F=null,O=AE,G=.5;function j(K){return l(K[0]*Ti,K[1]*Ti)}function Z(K){return(K=l.invert(K[0],K[1]))&&[K[0]*qr,K[1]*qr]}function at(){var K=LE(g,0,0,A,w,S).apply(null,e(y,_)),ut=LE(g,f-K[0],p-K[1],A,w,S);return s=LF(x,v,b),a=ay(e,ut),l=ay(s,a),o=CE(a,G),pt()}function pt(){return u=h=null,j}return j.stream=function(K){return u&&h===K?u:u=YF(WF(s)(M(o(O(h=K)))))},j.preclip=function(K){return arguments.length?(M=K,L=void 0,pt()):M},j.postclip=function(K){return arguments.length?(O=K,F=n=i=r=null,pt()):O},j.clipAngle=function(K){return arguments.length?(M=+K?zF(L=K*Ti):(L=null,SE),pt()):L*qr},j.clipExtent=function(K){return arguments.length?(O=K==null?(F=n=i=r=null,AE):OF(F=+K[0][0],n=+K[0][1],i=+K[1][0],r=+K[1][1]),pt()):F==null?null:[[F,n],[i,r]]},j.scale=function(K){return arguments.length?(g=+K,at()):g},j.translate=function(K){return arguments.length?(f=+K[0],p=+K[1],at()):[f,p]},j.center=function(K){return arguments.length?(y=K[0]%360*Ti,_=K[1]%360*Ti,at()):[y*qr,_*qr]},j.rotate=function(K){return arguments.length?(x=K[0]%360*Ti,v=K[1]%360*Ti,b=K.length>2?K[2]%360*Ti:0,at()):[x*qr,v*qr,b*qr]},j.angle=function(K){return arguments.length?(S=K%360*Ti,at()):S*qr},j.reflectX=function(K){return arguments.length?(A=K?-1:1,at()):A<0},j.reflectY=function(K){return arguments.length?(w=K?-1:1,at()):w<0},j.precision=function(K){return arguments.length?(o=CE(a,G=K*K),pt()):Eh(G)},j.fitExtent=function(K,ut){return WT(j,K,ut)},j.fitSize=function(K,ut){return GF(j,K,ut)},j.fitWidth=function(K,ut){return VF(j,K,ut)},j.fitHeight=function(K,ut){return jF(j,K,ut)},function(){return e=t.apply(this,arguments),j.invert=e.invert&&Z,at()}}function QF(t){return function(e,s){var n=Ws(e),i=Ws(s),r=t(n*i);return r===1/0?[2,0]:[r*i*Hs(e),r*Hs(s)]}}function JF(t){return function(e,s){var n=Eh(e*e+s*s),i=t(n),r=Hs(i),o=Ws(i);return[au(e*r,n*o),lu(n&&s*r/n)]}}var XT=QF((function(t){return(t=HT(t))&&t/Hs(t)}));function tP(){return ZF(XT).scale(79.4188).clipAngle(179.999)}XT.invert=JF((function(t){return t}));var eP=(()=>{let t=0;return typeof requestAnimationFrame<"u"?requestAnimationFrame:function(e){const s=Date.now(),n=Math.min(16,Math.max(0,16-(s-t))),i=t=s+n;return setTimeout((()=>e(i)),n)}})(),ZT=50,sP=typeof cancelAnimationFrame<"u"?cancelAnimationFrame:function(t){return clearTimeout(t)};function zx(t,e){return eP((s=>{t.call(e,s)}))}function KT(t){t&&sP(t)}var Hm,ja,Dx,QT,nP={},JT=nP,Bg={},t2={},dy=t=>null;if(typeof global=="object"&&(Bg=global),typeof window=="object"&&(t2=window),typeof Pd=="object"&&typeof Pd.require=="function"){const t=Pd.require.bind(Pd);dy=e=>{try{return t(e)}catch{return null}}}else typeof Bg.require=="function"&&(dy=t=>{const e=Bg.require;try{return e(t)}catch{return null}});function Yi(t,{throwOnError:e}={}){let s=null;if(!s&&t&&(s=JT[t]),!s&&t&&(s=dy(t)),!s&&t&&(s=t2[t]),!s&&t&&(s=Bg[t]),!s&&e){const n=[`unable to find module "${t}"; make sure one of these statements is true:`,`- Ogma.libraries['${t}'] is set to the right library`,`- require('${t}') returns the right library`,`- window['${t}'] is set to the right library`].join(`
`);throw new Error(n)}return s}var lr,e2=(lr=class{constructor(){this.method=null,this.url=null,this.status=0,this.readyState=0,this.headers={},this.responseText=null,this.response=null,lr.onCreate&&lr.onCreate(this)}open(e,s){this.method=e,this.url=s,lr.onSend&&lr.onSend(this)}respond(e,s,n){this.readyState=4,this.status=e,this.headers=s,this.responseText=n,this.response=n,this.onreadystatechange()}send(){this.readyState=4}},lr.onCreate=as,lr.onSend=as,lr),ur,s2=(ur=class{constructor(){this.onload=as,ur.onCreate&&ur.onCreate(this)}readAsDataURL(e){this._blob=e,ur.onRead&&ur.onRead(this)}load(e){this.result=typeof e=="function"?e(this._blob):e,this.onload&&this.onload()}},ur.onCreate=as,ur.onRead=as,ur);function lo(){return ja||{createElementNS:()=>null,createElement:()=>null,implementation:{createDocument(){throw new Error('unable to create XML document; if you use Node JS install the "xmldom" package')}}}}Hm=Yi("@xmldom/xmldom"),ja=ao?document:Hm?new Hm.DOMImplementation().createDocument():null,Dx=typeof XMLHttpRequest<"u"?XMLHttpRequest:e2,QT=typeof FileReader<"u"?FileReader:s2;var iP=class{observe(){}unobserve(){}disconnect(){}},rP=typeof ResizeObserver>"u"?iP:ResizeObserver,n2=t=>new rP(t);function i2(t,e){if(document&&document.defaultView){let s=t.style[e];if((!s||s==="auto")&&lo().defaultView){const n=document.defaultView.getComputedStyle(t,null);s=n?n[e]:null}return s==="auto"?null:s?s.toString():null}return null}var r2=class{constructor(){this.onmousewheel=as,this.__dummy=!0,this.style={},this.clientWidth=0,this.clientHeight=0,this.childNodes=[],this.style={width:"0px",height:"0px",top:void 0,left:void 0,position:"",backgroundColor:void 0}}get offsetWidth(){return parseFloat(this.style.width||"0")}get offsetHeight(){return parseFloat(this.style.height||"0")}get firstChild(){return null}get parentNode(){return null}get classList(){return{length:0,value:"",add(){},remove(){},contains:t=>!1,item:null}}get innerHTML(){return""}set innerHTML(t){}appendChild(t){return this.childNodes.push(t),t}removeChild(){}addEventListener(){}removeEventListener(){}insertBefore(){}contains(t){return!1}};function uf(){return new r2}var bi=Yo?()=>window.devicePixelRatio:()=>1;function o2(t){const e=";base64,";let s,n,i;if(t.indexOf(e)===-1)return s=t.split(","),n=s[0].split(":")[1],i=decodeURIComponent(s[1]),Jd(i,n);s=t.split(e),n=s[0].split(":")[1],i=window.atob(s[1]);const r=i.length,o=new Uint8Array(r);for(let a=0;a<r;++a)o[a]=i.charCodeAt(a);return Jd([o],n)}var a2=class{constructor(t,e){this.data=t,this.type=e}};function Jd(t,e){return typeof Blob<"u"?new Blob(t,{type:e}):new a2(t,e)}function oP(t){return typeof Blob<"u"&&t instanceof Blob||t instanceof a2}function aP(t,e,s="text/plain"){return e==="blob"?t:e==="dataURL"?o2(t):Jd([t],s||"text/xml")}function ta(t,e,s="text",n="text/plain"){if(!jf)return t;let i=null,r=null,o=null;window.Blob?(i=aP(t,s,n),r=URL.createObjectURL(i)):o="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(t);const a=document.createElement("a");return vT(a,r||o||""),a.setAttribute("download",e),document.body.appendChild(a),a.click(),document.body.removeChild(a),r&&setTimeout((()=>window.URL.revokeObjectURL(r)),0),t}function df(t,e,s,n=bi()){if(Ha(t,e+"px",s+"px"),t.tagName==="IMG"||t.tagName==="CANVAS"){const i=t;i.width=e*n,i.height=s*n}}function Ox(t,e){Mr(e,((s,n)=>{s!==void 0&&t.setAttribute(n,s)}))}var Bx="http://www.w3.org/2000/svg",hy="http://www.w3.org/2000/xmlns/",l2="http://www.w3.org/1999/xlink",lP=1;function ys(t,e){const s=ja.createElementNS(Bx,t);return s.style||(s.style={}),e&&Ox(s,e),s}function cy(t){const e=ja.createElement("div");if(e.innerHTML=t.trim().replace(/\s+/g," "),!e.firstChild||e.firstChild.nodeType!==lP)throw new Error(`Failed to create element from: "${t}". Expected an HTML string`);return e.firstChild}function Ux(t){if(ja)return ja.createTextNode(t)}function u2(t){return typeof Image>"u"?Promise.resolve(null):new Promise((e=>{const s=new Image;s.src=t,s.onload=()=>e(s),s.onerror=()=>e(null)}))}function d2(t){if(t.indexOf("http://")===0||t.indexOf("https://")===0)return t;const e=window.location.origin;if(window.location.protocol==="blob:")return t;const s=window.location.pathname,n=s.lastIndexOf("/");return n===-1?e+"/"+t:e+s.substring(0,n)+"/"+t}function Su(t){return new Promise(((e,s)=>{const n=new Dx;n.open("GET",d2(t),!0),n.onreadystatechange=function(){if(n.readyState===4){const i=n.status;i===200?e(n.responseText):s(i!==0?new Error(`cannot retrieve file at url "${t}"; the server responded with status code ${i}.`):new Error(`cannot send XMLHttpRequest to url "${t}"; if you're using the local file protocol this is most likely the cause.`))}},n.onerror=function(){s(new Error(`cannot retrieve file at url "${t}"; the XMLHttpRequest failed.`))},n.send()}))}function h2(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function hf(t,e){t.style.cursor=e,t.style.cursor!==e&&(t.style.cursor=`-webkit-${e}`)}function c2(t){return new Promise(((e,s)=>{const n=new Dx;n.responseType="blob",n.open("GET",d2(t),!0),n.onreadystatechange=()=>{if(n.readyState===4){if(n.status===200)return e(n.response);s(n.status)}},n.onerror=i=>s(i),n.send()}))}function g2(t){return c2(t).then((e=>new Promise(((s,n)=>{const i=new QT;i.onerror=n,i.onload=()=>s(i.result),i.readAsDataURL(e)}))))}function $l(t,e=!0){const s=e?"&#13;":`
`;return(""+t).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,s).replace(/[\r\n]/g,s)}var Gx={0:"left",1:"middle",2:"right"};function f2(t){if(t.baseURI)return t.baseURI;const e=t.getElementsByTagName("base");return e.length>0?e[0].href:t.URL||(t.location?t.location.href:"")}function p2(t,e,s,n){return new Promise((i=>{let r=e;const o=Date.now(),a=(s-e)*Math.min(1,1/(n/16));(function l(){Date.now()-o<n?(r=Math.min(1,Math.max(0,r+a)),t.style.opacity=r.toString(),zx(l)):i()})()}))}function Ha(t,e,s){t.style.width=e,t.style.height=s}var Vx=new YR().allowClassAttributes().allowDataAttributes().allowIdAttributes().allowStyleAttributes().build();function Vo(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function Wi(t,e,s){return Math.max(e,Math.min(s,t))}function gy(t,e,s){return t+(e-t)*s}function bs(t,e,s){return t*(1-s)+e*s}function ql(t){if(!t.length)return-1/0;let e=t[0];for(let s=1,n=t.length;s<n;++s){const i=t[s];i>e&&(e=i)}return e}function Qr(t){if(!t.length)return 1/0;let e=t[0];for(let s=1,n=t.length;s<n;++s){const i=t[s];i<e&&(e=i)}return e}var m2=(t,e)=>Math.log(t)/Math.log(e),cf=t=>t<-Math.PI?t+2*Math.PI:t>Math.PI?t-2*Math.PI:t;function NE(t,e){t&&e!==void 0&&isFinite(e)&&t.setOpacity&&t.setOpacity(e)}function ME(){return Yo||typeof global<"u"&&!global.process}function $m(t){return Math.log2(t)+nf}function uP(t){return 2**(t-nf)}function kE(t){return t!=null&&!isNaN(t)}function _2(t,e){return x2(t,e,"longitude")}function y2(t,e){return x2(t,e,"latitude")}function x2(t,e,s){if(isNaN(e))throw new TypeError(`node ${t}: ${e} is not a valid ${s}`)}var dP=t=>Math.pow(2,Math.ceil(Math.log2(t)));function hP(t,e){return e==null&&t.url===La.tiles.url?bF:null}function cP(t={},e){const{tileUrlSubdomains:s,tileUrlTemplate:n,attribution:i,attributionOptions:r,latitudePath:o,longitudePath:a,sizeRatio:l,tiles:u}=t;if(n!=null&&typeof n!="string")throw new TypeError("Geo mode: tileUrlTemplate must be a URL string");if(s!=null&&typeof s!="string")throw new TypeError("Geo mode: tileUrlTemplate must be a string");if(u!=null){if(!(gn(u)||u instanceof e.Layer))throw new TypeError("Geo mode: tiles must be a object or L.Layer instance");const h=u;if(h.url!=null&&typeof h.url!="string")throw new TypeError("Geo mode: tiles.url must be a string");if(h.subdomains!=null&&typeof h.subdomains!="string")throw new TypeError("Geo mode: tiles.subdomains must be a string");if(h.tms&&typeof h.tms!="boolean")throw new TypeError("Geo mode: tiles.tms must be a boolean");if(h.wms&&typeof h.wms!="boolean")throw new TypeError("Geo mode: tiles.wms must be a boolean")}if(i!=null&&typeof i!="string")throw new TypeError("Geo mode: Map attribution must be a string");if(r!=null&&!gn(r))throw new TypeError("Geo mode: attributionOptions must to be a BrandOptions object");if(o!=null&&typeof o!="string"&&!Array.isArray(o))throw new TypeError("Geo mode: Latitude path must be a valid property path: a string or an array of strings.");if(a!=null&&typeof a!="string"&&!Array.isArray(a))throw new TypeError("Geo mode: Longitude path must be a valid property path: a string or an array of strings.");if(l!=null&&(!isFinite(l)||l<=0))throw new TypeError("Geo mode: sizeRatio must be a positive number.")}function gP(t,e={}){if(e.tiles===void 0||e.tileUrlTemplate||e.tileUrlSubdomains){const s=La.tiles;return{...e.tiles||{},...La.tiles,url:e.tileUrlTemplate||s.url,subdomains:e.tileUrlSubdomains||s.subdomains}}return gn(e.tiles)?{...t.tiles,...e.tiles}:e.tiles}function fP(t,e){return t.attribution!==e.attribution||t.tiles!==e.tiles}var pP=lo().createElement("div");function mP(t){const e=lo().createElement("div");e.className="ogma-geo-container",Ha(e,"100%","100%");const s=t||pP;return s.insertBefore(e,s.firstChild),e}function _P(t){const e=[[1/0,1/0],[-1/0,-1/0]];return t.getGeoCoordinates().reduce(((s,{latitude:n,longitude:i})=>{const[r,o]=s;return r[0]=Math.min(r[0],n),r[1]=Math.min(r[1],i),o[0]=Math.max(o[0],n),o[1]=Math.max(o[1],i),s}),e)}function yP(t,e,s,n){const i=e._indexes;t.getNodeAttribute(Cr).setMultiple(i,s),t.getNodeAttribute(Lr).setMultiple(i,n)}function xP(t,e,s){const{longitudePath:n,latitudePath:i,wrapCoordinates:r}=s,[o,a]=t.getAttributes(!0,[Cr,Lr]),l=e._indexes,u=e.getId(),h=l.length,g=e.getData(i),f=e.getData(n);for(let p=0;p<h;p++){let y=f[p],_=g[p];const x=l[p],v=u[p];_!=null&&y!=null&&(_2(v,y),y2(v,_),r&&(y%=180,_=Wi(+_,-ny,ny)),a.set(x,y),o.set(x,_))}}function vP(t,{longitudePath:e,latitudePath:s,wrapCoordinates:n},i){const r=t.getData(e),o=t.getData(s);return r!=null&&o!=null&&(!(!n&&!i)||Math.abs(o)<=ny&&Math.abs(r)<=180)}function jc(t,e,s,n){bP(t,!0,e,s,n)}function bP(t,e,s,n,i){const r=t.getAttribute(e,n),o=t.getAttribute(e,i),a=s._indexes;o.setMultiple(a,r.getMultiple(a))}function EP(t){return t.reduce(((e,{nodes:s,newValues:n})=>{if(!s)return e;const i=s.filter(((r,o)=>n[o]!=null));return e?e.concat(i):i}),null)}function SP(t,e){return t.getAttributes(["text.minVisibleSize","text.size","text.scale","radius"]).forEach((({text:s,radius:n},i)=>{e[t.get(i).getId()]={"text.minVisibleSize":s.minVisibleSize,"text.size":s.size,"text.scale":s.scale,minVisibleSize:s.minVisibleSize,size:Math.max(1,Number(n))}})),e}function IE(t,e){return t.getAttributes(["text.minVisibleSize","text.size","text.scale","minVisibleSize","width"]).forEach((({text:s,minVisibleSize:n,width:i},r)=>{e[t.get(r).getId()]={"text.minVisibleSize":s.minVisibleSize,"text.size":s.size,"text.scale":s.scale,minVisibleSize:n,size:Math.max(1,Number(i))}})),e}function AP(t,e,s){if(!e||!Object.keys(e).length)return Promise.resolve();const n=t.getId().filter((i=>e[i])).map((i=>{if(!e[i])return 0;const r=Number(e[i]["text.minVisibleSize"]),o=Number(e[i].minVisibleSize),a=Number(e[i]["text.size"]),l=Number(e[i]["text.scale"]),u=Number(e[i].size)*l*s;return u<=o||u<=r?0:a}));return t.setAttribute("text.size",n)}function wP(t,e){const s=t.getId().map((n=>{const i=e[n]||{};return Number(i["text.size"])}));return t.setAttribute("text.size",s)}var TP=t=>tP().rotate([-t.longitude,-t.latitude]).scale(vF),RE=new Uint32Array(1),xi=class{constructor(t,e){this.size=1,this.isNode=!0,this.isList=!1,this._index=t,this._ogma=e}get _indexes(){return RE[0]=this._index,RE}setAttributes(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)}setAttribute(t,e,s){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,s)}resetAttributes(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)}getAttributes(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)[0]}getAttribute(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)[0]}getPosition(){return this.getAttributes(["x","y"])}getPositionOnScreen(){return this._ogma.modules.camera.graphToScreenCoordinates(this.getPosition())}isInScreen(){const t=this.getPositionOnScreen(),e=this._ogma.modules.camera;return t.x>=0&&t.x<=e.width&&t.y>=0&&t.y<=e.height}replaceOriginalAttributes(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)}getPreviousAttributes(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)[0]}getPreviousAttribute(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)}isInView(t){return this._ogma.modules.locate.isElementInView(this,t)}getAdjacentNodes(t){return this._ogma.modules.graph.getAdjacentNodes(this,t)}getAdjacentEdges(t){return this._ogma.modules.graph.getAdjacentEdges(this,t)}getAdjacentElements(t){return{nodes:this._ogma.modules.graph.getAdjacentNodes(this,t).dedupe(),edges:this._ogma.modules.graph.getAdjacentEdges(this,t).dedupe()}}getDegree(t){return this._ogma.modules.graph.getDegree(this,t)[0]}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)}getConnectedComponent(t){return this._ogma.modules.graph.getConnectedComponentByNode(this,t)[0]}isVisible(){return!this.isExcluded()}isExcluded(){return this._ogma.modules.graph.isExcluded(this)[0]}setExcluded(t){return this._ogma.modules.graph.setExcluded(this,t)}setVisible(t){return this.setExcluded(!t)}toList(){return this._ogma.nodeList(new Uint32Array([+this._index]))}getId(){return $f(this._ogma.modules.graph,this)}slice(){return this.toList()}toJSON(t={}){const{attributes:e,data:s}=VT(t),n=this.getAttributes(e);return{id:this.getId(),attributes:n,data:s(Zs(this.getData()))}}get(t){return t===0?this:void 0}setSelected(t){this._ogma.modules.selection.setActive(this,t)}isSelected(){return this._ogma.modules.selection.areActive(this)}setDisabled(t){this._ogma.modules.disabled.setActive(this,t)}isDisabled(){return this._ogma.modules.disabled.areActive(this)}locate(t){return this._ogma.modules.locate.locateElements(this,t)}getBoundingBox({includeTexts:t=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,t,t)}setData(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e),this}getData(t){return this._ogma.modules.data.getProperty(this,t||null)[0]}addClass(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)}addClasses(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)}removeClass(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)}removeClasses(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)}hasClass(t){return this._ogma.modules.classes.hasSingleElementClass(t,this)}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)[0]}getGeoCoordinates(){const t=this._ogma.modules.graph,e=t.getNodeAttribute(Cr).get(this._index),s=t.getNodeAttribute(Lr).get(this._index);return{latitude:kE(e)?e:void 0,longitude:kE(s)?s:void 0}}setGeoCoordinates(t){return this.toList().setGeoCoordinates([t]).then((()=>this))}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]}isVirtual(){return this._ogma.modules.transformations.isElementVirtual(this)}getTransformation(){return this._ogma.modules.transformations.getElementTransformation(this)}getMetaNode(){return this._ogma.modules.transformations.getMetaNode(this)}getSubNodes(){return this._ogma.modules.transformations.getSubNodes(this)}pulse(t){return this._ogma.modules.pulses.pulse(this,t)}};qf([xi],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var uo=class{constructor(t,e){this.isList=!0,this.isNode=!0,this._indexes=t,this._ogma=e}get size(){return this._indexes.length}setAttributes(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)}setAttribute(t,e,s){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,s)}getAttributes(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)}getAttribute(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)}resetAttributes(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)}getPosition(){return this.getAttributes(["x","y"])}getPositionOnScreen(){return this.getPosition().map((t=>this._ogma.modules.camera.graphToScreenCoordinates(t)))}replaceOriginalAttributes(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)}getPreviousAttributes(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)}getPreviousAttribute(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)}getAdjacentNodes(t){return this._ogma.modules.graph.getAdjacentNodes(this,t)}getAdjacentEdges(t){return this._ogma.modules.graph.getAdjacentEdges(this,t)}getAdjacentElements(t){return{nodes:this._ogma.modules.graph.getAdjacentNodes(this,t).dedupe(),edges:this._ogma.modules.graph.getAdjacentEdges(this,t).dedupe()}}getDegree(t){return this._ogma.modules.graph.getDegree(this,t)}getConnectedComponents(t){return this._ogma.modules.graph.getConnectedComponents(this,t)}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)}isVisible(){return this.isExcluded().map((t=>!t))}isExcluded(){return this._ogma.modules.graph.isExcluded(this)}isVirtual(){return this.map((t=>this._ogma.modules.transformations.isElementVirtual(t)))}setExcluded(t){return this._ogma.modules.graph.setExcluded(this,t)}setVisible(t){return this.setExcluded(!t)}toList(){return this}toArray(){return DT(this._ogma.modules.graph,this)}clone(){return this._ogma.modules.graph.nodeList(this._indexes.slice())}getId(){return $f(this._ogma.modules.graph,this)}get(t){return UT(this._ogma.modules.graph,this,t)}forEach(t){wT(this._ogma.modules.graph,this,t)}find(t){return MT(this._ogma.modules.graph,this,t)}some(t){return NT(this._ogma.modules.graph,this,t)}every(t){return LT(this._ogma.modules.graph,this,t)}map(t){return TT(this._ogma.modules.graph,this,t)}[Symbol.iterator](){let t=-1;return{next:()=>({value:this.get(++t),done:t>=this.size})}}filter(t){return CT(this._ogma.modules.graph,this,t)}reduce(t,e){return IT(this._ogma.modules.graph,this,t,e)}concat(t){return zT(this._ogma.modules.graph,this,t)}dedupe(){return RT(this._ogma.modules.graph,this)}subtract(t){return FT(this,t,this._ogma.modules.graph)}slice(t,e){return this._ogma.modules.graph.nodeList(this._indexes.slice(t,e))}indexOf(t){return t instanceof xi?this._indexes.indexOf(t._index):-1}includes(t){return this.indexOf(t)!==-1}inverse(){return PT(this._ogma.modules.graph,this)}sort(t){return GT(this._ogma.modules.graph,this,t)}toJSON(t={}){return this.map((e=>e.toJSON(t)))}setSelected(t){this._ogma.modules.selection.setActive(this,t)}isSelected(){return this._ogma.modules.selection.areActive(this)}setDisabled(t){this._ogma.modules.disabled.setActive(this,t)}isDisabled(){return this._ogma.modules.disabled.areActive(this)}locate(t){return this._ogma.modules.locate.locateElements(this,t)}getBoundingBox({includeTexts:t=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,t,t)}setData(t,e){if(arguments.length<2&&(e=t,t=null),typeof e!="function"&&!Nn(e))throw new Error(`invalid argument ${e}; expected array or function`);return this._ogma.modules.data.setProperty(this,t,e,{dispatch:!0}),this}fillData(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e,{dispatch:!1}),this}getData(t){return this._ogma.modules.data.getProperty(this,t||null)}addClass(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)}addClasses(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)}removeClass(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)}removeClasses(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)}hasClass(t){return this.map((e=>this._ogma.modules.classes.hasSingleElementClass(t,e)))}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)}getGeoCoordinates(){const t=this._ogma.modules.graph,e=new Array(this._indexes.length),s=t.getNodeAttribute(Cr).getMultiple(this._indexes),n=t.getNodeAttribute(Lr).getMultiple(this._indexes);for(let i=0,r=this._indexes.length;i<r;i++)e[i]={latitude:s[i],longitude:n[i]};return e}setGeoCoordinates(t){const e=this._ogma.modules.geo,s=this.getId(),n=this._indexes,i=new Array(n.length),r=new Array(n.length);if(t===null&&(t=new Array(n.length).fill(null)),t.length!==n.length)throw new RangeError("You must provide coordinates for each node in the NodeList");for(let l=0,u=n.length;l<u;l++){let{latitude:h,longitude:g}=t[l]||{latitude:void 0,longitude:void 0};const f=s[l];h==null&&g==null?h=g=void 0:(y2(f,h),_2(f,g)),i[l]=h,r[l]=g}this.setData(e.latitudePath,i),this.setData(e.longitudePath,r);const{dom:o,graph:a}=this._ogma.modules;return yP(a,this,i,r),this._ogma.modules.geo.isEnabled()?o.afterNextFrame().then((()=>o.afterNextFrame())).then((()=>this)):o.afterNextFrame().then((()=>this))}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)}getMetaNode(){return this._ogma.modules.transformations.getMetaNodes(this)}getSubNodes(){return this.map(this._ogma.modules.transformations.getSubNodes)}pulse(t){return this._ogma.modules.pulses.pulse(this,t)}};function CP(t,e,s,n,i){return Sh(t,e,s,!0,[n],i)}function LP(t,e,s,n,i){return Sh(t,e,s,!1,[n],i)}function NP(t,e,s,n,i){return Sh(t,e,s,!0,n,i)}function MP(t,e,s,n,i){return Sh(t,e,s,!1,n,i)}async function Sh(t,e,s,n,i,r={}){Array.isArray(i)||i instanceof(n?uo:Ya)||(i=[i]);const{virtual:o=!1}=r;!o&&e.isRefreshing()&&await new Promise((y=>{s.once("idle",y)}));const a={elementsToRemove:t.getElements(n,i)};t.fireEvent("requestElementsToDelete",a);let{elementsToRemove:l}=a;if(!l.size)return Promise.resolve();l=l.dedupe();const u=t.storage.fetch(n),h=u.getFlexArray("removed");if(l=l.filter((y=>h.get(y._index)===0)),n){const y=l.getAdjacentEdges({filter:"all"});Sh(t,e,s,!1,y,r)}const g=l._indexes,f=t.getCacheLists(n),p={virtual:o,[n?"nodes":"edges"]:l};if(t.fireEvent(n?"beforeRemoveNodes":"beforeRemoveEdges",p),f.visible.invalidList(),f.all.invalidList(),f.raw.invalidList(),t.setExcluded(l,!0),h.setMultiple(g,1),!n)for(let y=0;y<g.length;++y)t.topology.removeFromAdjacencyList(g[y]);return u.removeElements(g),t.fireEvent(n?"removeNodes":"removeEdges",p),t.fireEvent(n?"afterRemoveNodes":"afterRemoveEdges",p),Promise.resolve()}qf([uo],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var kP=class{addNodes(t,e){return this.modules.graph.addNodes(t,e)}addEdges(t,e){return this.modules.graph.addEdges(t,e)}addNode(t,e){return this.modules.graph.addNode(t,e)}addEdge(t,e){return this.modules.graph.addEdge(t,e)}removeNodes(t,e){return NP(this.modules.graph,this.modules.transformations,this.modules.events,t,e)}removeEdges(t,e){return MP(this.modules.graph,this.modules.transformations,this.modules.events,t,e)}removeNode(t,e){return CP(this.modules.graph,this.modules.transformations,this.modules.events,t,e)}removeEdge(t,e){return LP(this.modules.graph,this.modules.transformations,this.modules.events,t,e)}getNodes(t){return this.modules.graph.getNodes(t)}getEdges(t){return this.modules.graph.getEdges(t)}getNode(t){return this.modules.graph.getNode(t)}getEdge(t){return this.modules.graph.getEdge(t)}clearGraph(){this.modules.graph.clear()}setGraph(t,e){return this.modules.graph.clear(),this.addGraph(t,e)}addGraph(t,e){const s=this.modules.graph.getNodes().size===0,n=this.modules.graph.addGraph(t,e);return s?this.modules.locate.locateGraph({padding:30,ignoreZoomLimits:!1,duration:0}).then((()=>n)):n}createNodeList(){return this.getNodes([])}createEdgeList(){return this.getEdges([])}getConnectedComponents(t={}){return this.modules.graph.getConnectedComponents(this.getNodes(t.filter),t)}getConnectedComponentByNode(t,e){const s=this.modules.graph.getNode(t);if(s===void 0)throw new Error(`getComponentByNode: cannot find node ${t}`);return this.modules.graph.getConnectedComponentByNode(s,e)[0]}},jx={};function v2(t,e,s,n,i,r){let o=0;for(let a=0;a<n;a++)for(let l=0;l<n;l++){const u=r[a],h=r[l];if(u!==h){const g=t[u][h]*i,f=1/(g*g);if(f){const p=e[u]-e[h],y=s[u]-s[h];o+=f*Math.pow(g-Math.sqrt(p*p+y*y),2)}}}return o}function b2(t,e,s,n,i,r,o){let a=0;if(i===-1)return 0;for(let l=0;l<n;l++)for(let u=0;u<n;u++){const h=o[l],g=o[u];if(h!==g&&(h===i||g===i)){const f=t[h][g]*r,p=1/(f*f);if(p){const y=e[h]-e[g],_=s[h]-s[g];a+=p*Math.pow(f-Math.sqrt(y*y+_*_),2)}}}return a}function fy(t,e,s,n,i,r,o,a){o=o||0;let l=0,u=0;for(let h=0;h<n;h++)for(let g=0;g<n;g++){const f=a[h],p=a[g];if(f!==p){const y=t[f][p]*r,_=1/(y*y);if(_){const x=e[f]-e[p],v=s[f]-s[p],b=_*Math.pow(y-Math.sqrt(x*x+v*v),2);l+=b,f!==i&&p!==i||(u+=b)}}}return(1-o)*l+o*u}function py(t,e,s,n,i,r,o,a,l){o=o||0;const u=e,h=s;(i=i===void 0?-1:i)===-1&&(o=0);const g=e[i],f=s[i];for(let p=0;p<n;p++){const y=a[p],_=l(t[i][p]),x=o/(_*_);if(_===0)continue;let v=0,b=0,S=0;const A=e[y],w=s[y];for(let M=0;M<n;M++){const F=a[M];if(F!==y){const O=t[y][F]*r,G=1/(O*O),j=e[F],Z=s[F];if(G!==0){const at=A-j,pt=w-Z,K=at*at+pt*pt,ut=K<1e-12?0:1/Math.sqrt(K);b+=(1-o)*G*(j+O*(A-j)*ut),S+=(1-o)*G*(Z+O*(w-Z)*ut)}v+=G}}const L=(1-o)*v+x;if(L!==0){const M=A-g,F=w-f;let O=M*M+F*F;O=O<1e-12?0:1/Math.sqrt(O);const G=_===0?0:x*(_*O);u[y]=(b+G*e[y])/L,h[y]=(S+G*s[y])/L}}return{x:u,y:h}}function IP(t,e,s,n,i,r,o,a){o=o||0;const l=e,u=s;let h;(i=i===void 0?-1:i)===-1&&(o=0);for(let g=0;g<n;g++){const f=a[g];let p=0,y=0,_=0;const x=e[f],v=s[f];for(let b=0;b<n;b++){const S=a[b];let A=0;if(S!==f){let w=0;const L=t[f][S]*r,M=1/(L*L);f!==i&&S!==i||(w=M);const F=(1-o)*M+o*w;if(p+=F,M!==0){const O=e[S],G=s[S],j=x-O,Z=v-G,at=j*j+Z*Z;at>1e-6&&(A=1/Math.sqrt(at)),y+=F*(O+L*(x-O)*A),_+=F*(G+L*(v-G)*A)}}}h=p,h!==0&&(l[f]=y/h,u[f]=_/h)}return{x:l,y:u}}function Yf(t=((i,r)=>i-r),e=[],s={},n=(i=>i)){let i=e.length;function r(o){for(;;){const a=2*o+1,l=a+1;let u=o;if(a<i&&t(e[a],e[u])<0&&(u=a),l<i&&t(e[l],e[u])<0&&(u=l),u===o)return o;const h=e[u];e[u]=e[o],e[o]=h,s[n(e[u])]=u,s[n(h)]=o,o=u}}return{get keys(){return s},get size(){return i},heapify:r,pop(){if(i<=0)return;if(i===1)return i--,e[0];const o=e[0];return e[0]=e[i-1],i--,r(0),o},decreaseKey(o,a){for(a!==void 0&&(e[o]=a,s[n(a)]=o);o>0;){const l=o-1>>1;if(!(t(e[l],e[o])>0))break;{const u=e[o];e[o]=e[l],e[l]=u,s[n(e[o])]=o,s[n(u)]=l,o=l}}return o},min:()=>e[0],remove(o){return this.decreaseKey(o,Number.NEGATIVE_INFINITY),this.pop()},push(o){i++;let a=i-1;for(e[a]=o;a>0;){const l=a-1>>1;if(!(t(e[l],e[a])>0))break;{const u=e[a];e[a]=e[l],e[l]=u,s[n(e[a])]=a,s[n(u)]=l,a=l}}return a},empty:()=>i<=0,toArray:()=>e.slice(0,i)}}function Hx({sources:t,targets:e,weights:s,source:n,target:i,undirected:r=!1,indexes:o,N:a}){if(!(a=o?o.length:a)||!isFinite(a)||a===0)throw new Error("Invalid number of nodes "+a);const l=new Float32Array(a),u=new Int32Array(a),h={},g=Number.POSITIVE_INFINITY;if(!s){s=[];for(let _=0;_<a;_++)s[_]=1}if(!o){o=new Uint32Array(a);for(let _=0;_<a;_++)o[_]=_+1}for(let _=0;_<a;_++)l[_]=g,u[_]=-1,h[o[_]]=_;l[h[n]]=0;let f=!1;for(let _=1;_<=a;_++){for(let x=0;x<s.length;x++){const v=t[x],b=e[x],S=h[v],A=h[b];if(S!==void 0&&A!==void 0){const w=s[x];let L=l[S]+w;l[S]!==g&&L<l[A]&&(l[A]=L,u[A]=v,f=!0),r&&(L=l[A]+w,l[A]!==g&&L<l[S]&&(l[S]=L,u[S]=b,f=!0))}}if(!f)break}if(f)for(let _=0;_<s.length;_++){const x=t[_],v=e[_],b=h[x],S=h[v];if(b!==void 0&&S!==void 0){const A=s[_];if(l[b]+A<l[S])return null}}let p=null,y=null;if(i!==void 0){const _=h[i];if(_!==void 0&&l[_]!==g){p=[];for(let x=i;x!==-1;x=u[h[x]])p.push(x);p=p.reverse(),y=l[_]}}return{distances:l,path:p,pathLength:y}}function $x(t,e,s,n,i,r,o){const a=(n=n||t.map(((x,v)=>v+1))).length,l=new Float32Array(a),u=new Int32Array(a),h=new Uint32Array(a),g=Number.POSITIVE_INFINITY,f={};if(a===0)return{distances:l,path:null,pathLength:null};if(!i){i={};for(let x=0;x<a;x++)i[n[x]]=x}for(let x=0;x<a;x++)l[x]=g,u[x]=-1,h[x]=f[x]=x;const p=Yf(((x,v)=>l[x]-l[v]),h,f);for(l[i[e]]=0,p.decreaseKey(f[i[e]]);p.size!==0;){const x=p.pop(),v=l[x],b=t[x];if(v===g)break;for(let S=0,A=b.nodes.length;S<A;S++){const w=b.nodes[S],L=r?1:o?o(n[x],w):b.weights?b.weights[S]:1,M=i[w];if(M===void 0)continue;const F=v+L;F<l[M]&&(l[M]=F,u[M]=x,p.decreaseKey(f[M]))}}let y=null,_=null;if(s!==void 0){const x=i[s];if(l[x]!==g){y=[];for(let v=x;v!==-1;v=u[v])y.push(n[v]);y.reverse(),_=l[s]}}return{distances:l,path:y,pathLength:_}}function my({sources:t,targets:e,weights:s,indexes:n,adjacency:i,undirected:r,ignoreWeights:o}){const a=Number.POSITIVE_INFINITY,l=n?n.length:i.length;if(!n){n=new Uint32Array(l);for(let _=0;_<l;_++)n[_]=_+1}const u=new Array(l),h={};for(let _=0;_<l;_++){u[_]=new Float32Array(l);for(let x=0;x<l;x++)u[_][x]=_===x?0:a;h[n[_]]=_}const g=l,f=s.length;t=t.slice(),e=e.slice(),s=s.slice();for(let _=0;_<l;_++)t[f+_]=g,e[f+_]=n[_],s[f+_]=0,o&&(s[_]=1);const p=Hx({sources:t,targets:e,weights:s,undirected:r,N:l+1,source:g});if(p===null)throw new Error("Graph has negative weight loops");const y=p.distances;for(let _=0;_<s.length;_++){const x=h[t[_]],v=h[e[_]];x!==void 0&&v!==void 0&&(s[_]=s[_]+y[x]-y[v])}t=t.slice(0,f),e=e.slice(0,f),s=s.slice(0,f);for(let _=0;_<l;_++){const x=n[_],{distances:v}=$x(i,x,void 0,n,h,!!o);for(let b=0;b<l;b++)u[_][b]=_===b?0:v[b]}return u}xh(jx,{CyclesFinder:()=>F2,Quadtree:()=>mz,bellmanFord:()=>Hx,betweenness:()=>z2,circlePack:()=>L2,circleSpread:()=>ez,constrainedStress:()=>fy,convexhull:()=>JP,detectCyclesDirected:()=>I2,detectCyclesUndirected:()=>yz,detectCyclesUndirectedDFS:()=>xz,dijkstra:()=>$x,distanceStress:()=>b2,fisheye:()=>N2,johnson:()=>my,kruskal:()=>P2,largestEmptyCircle:()=>S2,minDisk:()=>wh,minHeap:()=>Yf,removeRadialOverlap:()=>yy,stressMinimizationStep:()=>py,stressMinimizationStepGeneral:()=>IP,weightedStress:()=>v2});var io=11102230246251565e-32,Gn=134217729,RP=(3+8*io)*io;function qm(t,e,s,n,i){let r,o,a,l,u=e[0],h=n[0],g=0,f=0;h>u==h>-u?(r=u,u=e[++g]):(r=h,h=n[++f]);let p=0;if(g<t&&f<s)for(h>u==h>-u?(o=u+r,a=r-(o-u),u=e[++g]):(o=h+r,a=r-(o-h),h=n[++f]),r=o,a!==0&&(i[p++]=a);g<t&&f<s;)h>u==h>-u?(o=r+u,l=o-r,a=r-(o-l)+(u-l),u=e[++g]):(o=r+h,l=o-r,a=r-(o-l)+(h-l),h=n[++f]),r=o,a!==0&&(i[p++]=a);for(;g<t;)o=r+u,l=o-r,a=r-(o-l)+(u-l),u=e[++g],r=o,a!==0&&(i[p++]=a);for(;f<s;)o=r+h,l=o-r,a=r-(o-l)+(h-l),h=n[++f],r=o,a!==0&&(i[p++]=a);return r===0&&p!==0||(i[p++]=r),p}function FP(t,e){let s=e[0];for(let n=1;n<t;n++)s+=e[n];return s}function Ah(t){return new Float64Array(t)}var PP=(3+16*io)*io,zP=(2+12*io)*io,DP=(9+64*io)*io*io,Cl=Ah(4),FE=Ah(8),PE=Ah(12),zE=Ah(16),Jn=Ah(4);function OP(t,e,s,n,i,r,o){let a,l,u,h,g,f,p,y,_,x,v,b,S,A,w,L,M,F;const O=t-i,G=s-i,j=e-r,Z=n-r;A=O*Z,f=Gn*O,p=f-(f-O),y=O-p,f=Gn*Z,_=f-(f-Z),x=Z-_,w=y*x-(A-p*_-y*_-p*x),L=j*G,f=Gn*j,p=f-(f-j),y=j-p,f=Gn*G,_=f-(f-G),x=G-_,M=y*x-(L-p*_-y*_-p*x),v=w-M,g=w-v,Cl[0]=w-(v+g)+(g-M),b=A+v,g=b-A,S=A-(b-g)+(v-g),v=S-L,g=S-v,Cl[1]=S-(v+g)+(g-L),F=b+v,g=F-b,Cl[2]=b-(F-g)+(v-g),Cl[3]=F;let at=FP(4,Cl),pt=zP*o;if(at>=pt||-at>=pt||(g=t-O,a=t-(O+g)+(g-i),g=s-G,u=s-(G+g)+(g-i),g=e-j,l=e-(j+g)+(g-r),g=n-Z,h=n-(Z+g)+(g-r),a===0&&l===0&&u===0&&h===0)||(pt=DP*o+RP*Math.abs(at),at+=O*h+Z*a-(j*u+G*l),at>=pt||-at>=pt))return at;A=a*Z,f=Gn*a,p=f-(f-a),y=a-p,f=Gn*Z,_=f-(f-Z),x=Z-_,w=y*x-(A-p*_-y*_-p*x),L=l*G,f=Gn*l,p=f-(f-l),y=l-p,f=Gn*G,_=f-(f-G),x=G-_,M=y*x-(L-p*_-y*_-p*x),v=w-M,g=w-v,Jn[0]=w-(v+g)+(g-M),b=A+v,g=b-A,S=A-(b-g)+(v-g),v=S-L,g=S-v,Jn[1]=S-(v+g)+(g-L),F=b+v,g=F-b,Jn[2]=b-(F-g)+(v-g),Jn[3]=F;const K=qm(4,Cl,4,Jn,FE);A=O*h,f=Gn*O,p=f-(f-O),y=O-p,f=Gn*h,_=f-(f-h),x=h-_,w=y*x-(A-p*_-y*_-p*x),L=j*u,f=Gn*j,p=f-(f-j),y=j-p,f=Gn*u,_=f-(f-u),x=u-_,M=y*x-(L-p*_-y*_-p*x),v=w-M,g=w-v,Jn[0]=w-(v+g)+(g-M),b=A+v,g=b-A,S=A-(b-g)+(v-g),v=S-L,g=S-v,Jn[1]=S-(v+g)+(g-L),F=b+v,g=F-b,Jn[2]=b-(F-g)+(v-g),Jn[3]=F;const ut=qm(K,FE,4,Jn,PE);A=a*h,f=Gn*a,p=f-(f-a),y=a-p,f=Gn*h,_=f-(f-h),x=h-_,w=y*x-(A-p*_-y*_-p*x),L=l*u,f=Gn*l,p=f-(f-l),y=l-p,f=Gn*u,_=f-(f-u),x=u-_,M=y*x-(L-p*_-y*_-p*x),v=w-M,g=w-v,Jn[0]=w-(v+g)+(g-M),b=A+v,g=b-A,S=A-(b-g)+(v-g),v=S-L,g=S-v,Jn[1]=S-(v+g)+(g-L),F=b+v,g=F-b,Jn[2]=b-(F-g)+(v-g),Jn[3]=F;const ht=qm(ut,PE,4,Jn,zE);return zE[ht-1]}function Hc(t,e,s,n,i,r){const o=(e-r)*(s-i),a=(t-i)*(n-r),l=o-a,u=Math.abs(o+a);return Math.abs(l)>=PP*u?l:-OP(t,e,s,n,i,r,u)}var DE=Math.pow(2,-52),$c=new Uint32Array(512),qx=class E2{static from(e,s=jP,n=HP){const i=e.length,r=new Float64Array(2*i);for(let o=0;o<i;o++){const a=e[o];r[2*o]=s(a),r[2*o+1]=n(a)}return new E2(r)}constructor(e){const s=e.length>>1;if(s>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*s-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(s)),this._hullPrev=new Uint32Array(s),this._hullNext=new Uint32Array(s),this._hullTri=new Uint32Array(s),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(s),this._dists=new Float64Array(s),this.update()}update(){const{coords:e,_hullPrev:s,_hullNext:n,_hullTri:i,_hullHash:r}=this,o=e.length>>1;let a=1/0,l=1/0,u=-1/0,h=-1/0;for(let O=0;O<o;O++){const G=e[2*O],j=e[2*O+1];G<a&&(a=G),j<l&&(l=j),G>u&&(u=G),j>h&&(h=j),this._ids[O]=O}const g=(a+u)/2,f=(l+h)/2;let p,y,_;for(let O=0,G=1/0;O<o;O++){const j=Ym(g,f,e[2*O],e[2*O+1]);j<G&&(p=O,G=j)}const x=e[2*p],v=e[2*p+1];for(let O=0,G=1/0;O<o;O++){if(O===p)continue;const j=Ym(x,v,e[2*O],e[2*O+1]);j<G&&j>0&&(y=O,G=j)}let b=e[2*y],S=e[2*y+1],A=1/0;for(let O=0;O<o;O++){if(O===p||O===y)continue;const G=GP(x,v,b,S,e[2*O],e[2*O+1]);G<A&&(_=O,A=G)}let w=e[2*_],L=e[2*_+1];if(A===1/0){for(let j=0;j<o;j++)this._dists[j]=e[2*j]-e[0]||e[2*j+1]-e[1];Yl(this._ids,this._dists,0,o-1);const O=new Uint32Array(o);let G=0;for(let j=0,Z=-1/0;j<o;j++){const at=this._ids[j],pt=this._dists[at];pt>Z&&(O[G++]=at,Z=pt)}return this.hull=O.subarray(0,G),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(Hc(x,v,b,S,w,L)<0){const O=y,G=b,j=S;y=_,b=w,S=L,_=O,w=G,L=j}const M=VP(x,v,b,S,w,L);this._cx=M.x,this._cy=M.y;for(let O=0;O<o;O++)this._dists[O]=Ym(e[2*O],e[2*O+1],M.x,M.y);Yl(this._ids,this._dists,0,o-1),this._hullStart=p;let F=3;n[p]=s[_]=y,n[y]=s[p]=_,n[_]=s[y]=p,i[p]=0,i[y]=1,i[_]=2,r.fill(-1),r[this._hashKey(x,v)]=p,r[this._hashKey(b,S)]=y,r[this._hashKey(w,L)]=_,this.trianglesLen=0,this._addTriangle(p,y,_,-1,-1,-1);for(let O,G,j=0;j<this._ids.length;j++){const Z=this._ids[j],at=e[2*Z],pt=e[2*Z+1];if(j>0&&Math.abs(at-O)<=DE&&Math.abs(pt-G)<=DE||(O=at,G=pt,Z===p||Z===y||Z===_))continue;let K=0;for(let Mt=0,Q=this._hashKey(at,pt);Mt<this._hashSize&&(K=r[(Q+Mt)%this._hashSize],K===-1||K===n[K]);Mt++);K=s[K];let ut,ht=K;for(;ut=n[ht],Hc(at,pt,e[2*ht],e[2*ht+1],e[2*ut],e[2*ut+1])>=0;)if(ht=ut,ht===K){ht=-1;break}if(ht===-1)continue;let nt=this._addTriangle(ht,Z,n[ht],-1,-1,i[ht]);i[Z]=this._legalize(nt+2),i[ht]=nt,F++;let ot=n[ht];for(;ut=n[ot],Hc(at,pt,e[2*ot],e[2*ot+1],e[2*ut],e[2*ut+1])<0;)nt=this._addTriangle(ot,Z,ut,i[Z],-1,i[ot]),i[Z]=this._legalize(nt+2),n[ot]=ot,F--,ot=ut;if(ht===K)for(;ut=s[ht],Hc(at,pt,e[2*ut],e[2*ut+1],e[2*ht],e[2*ht+1])<0;)nt=this._addTriangle(ut,Z,ht,-1,i[ht],i[ut]),this._legalize(nt+2),i[ut]=nt,n[ht]=ht,F--,ht=ut;this._hullStart=s[Z]=ht,n[ht]=s[ot]=Z,n[Z]=ot,r[this._hashKey(at,pt)]=Z,r[this._hashKey(e[2*ht],e[2*ht+1])]=ht}this.hull=new Uint32Array(F);for(let O=0,G=this._hullStart;O<F;O++)this.hull[O]=G,G=n[G];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,s){return Math.floor(BP(e-this._cx,s-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:s,_halfedges:n,coords:i}=this;let r=0,o=0;for(;;){const a=n[e],l=e-e%3;if(o=l+(e+2)%3,a===-1){if(r===0)break;e=$c[--r];continue}const u=a-a%3,h=l+(e+1)%3,g=u+(a+2)%3,f=s[o],p=s[e],y=s[h],_=s[g];if(UP(i[2*f],i[2*f+1],i[2*p],i[2*p+1],i[2*y],i[2*y+1],i[2*_],i[2*_+1])){s[e]=_,s[a]=f;const x=n[g];if(x===-1){let b=this._hullStart;do{if(this._hullTri[b]===g){this._hullTri[b]=e;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(e,x),this._link(a,n[o]),this._link(o,g);const v=u+(a+1)%3;r<$c.length&&($c[r++]=v)}else{if(r===0)break;e=$c[--r]}}return o}_link(e,s){this._halfedges[e]=s,s!==-1&&(this._halfedges[s]=e)}_addTriangle(e,s,n,i,r,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=s,this._triangles[a+2]=n,this._link(a,i),this._link(a+1,r),this._link(a+2,o),this.trianglesLen+=3,a}};function BP(t,e){const s=t/(Math.abs(t)+Math.abs(e));return(e>0?3-s:1+s)/4}function Ym(t,e,s,n){const i=t-s,r=e-n;return i*i+r*r}function UP(t,e,s,n,i,r,o,a){const l=t-o,u=e-a,h=s-o,g=n-a,f=i-o,p=r-a,y=h*h+g*g,_=f*f+p*p;return l*(g*_-y*p)-u*(h*_-y*f)+(l*l+u*u)*(h*p-g*f)<0}function GP(t,e,s,n,i,r){const o=s-t,a=n-e,l=i-t,u=r-e,h=o*o+a*a,g=l*l+u*u,f=.5/(o*u-a*l),p=(u*h-a*g)*f,y=(o*g-l*h)*f;return p*p+y*y}function VP(t,e,s,n,i,r){const o=s-t,a=n-e,l=i-t,u=r-e,h=o*o+a*a,g=l*l+u*u,f=.5/(o*u-a*l);return{x:t+(u*h-a*g)*f,y:e+(o*g-l*h)*f}}function Yl(t,e,s,n){if(n-s<=20)for(let i=s+1;i<=n;i++){const r=t[i],o=e[r];let a=i-1;for(;a>=s&&e[t[a]]>o;)t[a+1]=t[a--];t[a+1]=r}else{let i=s+1,r=n;nd(t,s+n>>1,i),e[t[s]]>e[t[n]]&&nd(t,s,n),e[t[i]]>e[t[n]]&&nd(t,i,n),e[t[s]]>e[t[i]]&&nd(t,s,i);const o=t[i],a=e[o];for(;;){do i++;while(e[t[i]]<a);do r--;while(e[t[r]]>a);if(r<i)break;nd(t,i,r)}t[s+1]=t[r],t[r]=o,n-i+1>=r-s?(Yl(t,e,i,n),Yl(t,e,s,r-1)):(Yl(t,e,s,r-1),Yl(t,e,i,n))}}function nd(t,e,s){const n=t[e];t[e]=t[s],t[s]=n}function jP(t){return t[0]}function HP(t){return t[1]}function S2(t,e=1,s=0,n,i){if(!n||!i){const g=t.map((p=>[p.x,p.y])),f=qx.from(g,(p=>p[0]),(p=>p[1]));n=Xd(f.triangles,g),i=Xd(f.hull,g)}if(!i)return[];const r=s*s,o=[],a={};for(let g=0;g<n.length;g+=3)if($P(i,Yx(n[g],n[g+1],n[g+2]))){const f=YP(n[g],n[g+1],n[g+2]);f>r&&(o.push(g),a[g]=f)}if(o.length===0)return[];o.sort(((g,f)=>a[g]-a[f]));let l=o[0],u=a[l];const h=[];for(let g=0;g<o.length;g++){const f=o[g],p=a[f];p>u&&p>r&&(l=f,u=p,h.push(l),h.length>e&&h.shift())}return h.map((g=>qP(n[g],n[g+1],n[g+2])))}function $P(t,e){const s=t.length,n=t[s-1],[i,r]=e;let[o,a]=n,l=!1;for(let u=0;u<s;u++){const h=t[u],[g,f]=h;f>r!=a>r&&i<(o-g)*(r-f)/(a-f)+g&&(l=!l),o=g,a=f}return l}function qP(t,e,s){const n=Yx(t,e,s);let i=0;for(let r=0;r<3;r++){const o=arguments[r],a=o[0]-n[0],l=o[1]-n[1],u=Math.sqrt(a*a+l*l);u>i&&(i=u)}return[n[0],n[1],i]}function YP(t,e,s){const[n,i]=Yx(t,e,s),[r,o]=t,a=n-r,l=i-o;return a*a+l*l}function Yx(t,e,s){const n=[(t[0]+e[0])/2,(t[1]+e[1])/2],i=[(e[0]+s[0])/2,(e[1]+s[1])/2],r=-1/((e[1]-t[1])/(e[0]-t[0])),o=-1/((s[1]-e[1])/(s[0]-e[0])),a=n[1]-r*n[0],l=(a-(i[1]-o*i[0]))/(o-r);return[l,r*l+a]}function wh(t,e,s,n){let i;if(n)i=n;else{i=new Uint32Array(t.length);for(let S=0,A=t.length;S<A;S++)i[S]=S}let r=t[i[0]],o=r,a=e[i[0]],l=a;for(let S=1;S<i.length;S++){const A=i[S],w=t[A],L=e[A];w<r&&(r=w),w>o&&(o=w),L<a&&(a=L),L>l&&(l=L)}const u=(r+o)/2,h=(a+l)/2;for(let S=0;S<i.length;S++){const A=i[S];t[A]-=u,e[A]-=h}function g(S,A,w,L,M,F){const O=w-F+1e-9*Math.max(w,F,1),G=L-S,j=M-A;return O>0&&O*O>G*G+j*j}function f(S,A,w,L,M,F,O){for(let G=0;G<L.length;++G){const j=L[G];if(!g(S,A,w,M[j],F[j],O[j]))return!1}return!0}function p(S,A,w,L,M,F){const O=L-S,G=M-A,j=F-w,Z=Math.sqrt(O*O+G*G);return[(S+L+O/Z*j)/2,(A+M+G/Z*j)/2,(Z+w+F)/2]}function y(S,A,w,L,M,F,O,G,j){const Z=(S+L+O)/3,at=(A+M+G)/3,pt=S-Z,K=A-at,ut=L-Z,ht=M-at,nt=O-Z,ot=G-at,Mt=pt-ut,Q=pt-nt,Et=K-ht,Xt=K-ot,Ht=F-w,Zt=j-w,ae=pt*pt+K*K-w*w,pe=ae-ut*ut-ht*ht+F*F,ne=ae-nt*nt-ot*ot+j*j,te=Q*Et-Mt*Xt,se=(Et*ne-Xt*pe)/(2*te)-pt,ce=(Xt*Ht-Et*Zt)/te,Ce=(Q*pe-Mt*ne)/(2*te)-K,ve=(Mt*Zt-Q*Ht)/te,Me=ce*ce+ve*ve-1,ge=2*(w+se*ce+Ce*ve),ze=se*se+Ce*Ce-w*w,is=-(Math.abs(Me)>1e-6?(ge+Math.sqrt(ge*ge-4*Me*ze))/(2*Me):ze/ge);return[Z+pt+se+ce*is,at+K+Ce+ve*is,is]}function _(S,A,w,L){switch(S.length){case 1:const M=S[0];return(function(pt,K,ut){return[pt,K,ut]})(A[M],w[M],L[M]);case 2:const[F,O]=S;return p(A[F],w[F],L[F],A[O],w[O],L[O]);case 3:const[G,j,Z]=S;return y(A[G],w[G],L[G],A[j],w[j],L[j],A[Z],w[Z],L[Z]);default:return null}}function x(S,A,w,L,M,F){const O=w-F,G=L-S,j=M-A;return O<0||O*O<G*G+j*j}function v(S,A,w,L,M){const F=w[A],O=L[A],G=M[A];if(f(F,O,G,S,w,L,M))return[A];for(let j=0;j<S.length;++j){const Z=S[j],at=w[Z],pt=L[Z],K=M[Z];if(x(F,O,G,at,pt,K)){const[ut,ht,nt]=p(at,pt,K,F,O,G);if(f(ut,ht,nt,S,w,L,M))return[S[j],A]}}for(let j=0;j<S.length-1;++j)for(let Z=j+1;Z<S.length;++Z){const at=S[j],pt=S[Z],K=w[at],ut=L[at],ht=M[at],nt=w[pt],ot=L[pt],Mt=M[pt],Q=p(K,ut,ht,nt,ot,Mt);if(x(Q[0],Q[1],Q[2],F,O,G)){const Et=p(K,ut,ht,F,O,G);if(x(Et[0],Et[1],Et[2],nt,ot,Mt)){const Xt=p(nt,ot,Mt,F,O,G);if(x(Xt[0],Xt[1],Xt[2],K,ut,ht)){const Ht=y(K,ut,ht,nt,ot,Mt,F,O,G);if(f(Ht[0],Ht[1],Ht[2],S,w,L,M))return[at,pt,A]}}}}throw new Error}i=(function(A){for(let w=A.length-1;w>=0;w--){let L=Math.floor(Math.random()*(w+1));L=Math.max(Math.min(L,w),0);const M=A[w];A[w]=A[L],A[L]=M}return A})(i),s=s||new Array(t.length).fill(0);const b=(function(A,w,L,M,F){let O=null,G=[],j=0;for(;j<w;){const Z=A[j];O&&g(O[0],O[1],O[2],L[Z],M[Z],F[Z])?j++:(G=v(G,Z,L,M,F),O=_(G,L,M,F),j=0)}return O})(i,i.length,t,e,s);b[0]+=u,b[1]+=h;for(let S=0;S<i.length;S++){const A=i[S];t[A]+=u,e[A]+=h}return b}var A2=[1/0,1/0,-1/0,-1/0];function gf(t,e,s,n,i,r={x:0,y:0}){const o=Math.cos(i),a=Math.sin(i),l=t-s,u=e-n;return r.x=o*l-a*u+s,r.y=a*l+o*u+n,r}function WP(t,e,s=0,n={x:0,y:0}){return n.x=t.x+s*Math.sin(e),n.y=t.y+s*Math.cos(e),n}var _n=(t,e,s,n)=>Math.hypot(t-s,e-n);function Ug(t,e,s,n){const i=t-s,r=e-n;return i*i+r*r}function w2(t){const e=Math.sqrt(t.x*t.x+t.y*t.y);return t.x/=e,t.y/=e,t}function _y(t){return 180*t/Math.PI}function XP(t){return t*Math.PI/180}function T2(t,e){return t.minX-=e,t.minY-=e,t.maxX+=e,t.maxY+=e,t.width===void 0&&(t.width=t.maxX-t.minX),t.height===void 0&&(t.height=t.maxY-t.minY),t.width+=2*e,t.height+=2*e,t}function Wx(t,e,s,n,i,r){const o=n-t,a=i-e,l=Math.sqrt(o*o+a*a);if(l>s+r||l<Math.abs(s-r))return null;const u=(s*s-r*r+l*l)/(2*l),h=t+o*u/l,g=e+a*u/l,f=Math.sqrt(s*s-u*u),p=f/l*-a,y=o*(f/l);return[[h+p,g+y],[h-p,g-y]]}function Xx(t,e,s,n,i,r){if(t-i>=0&&s-i<0)return 1;if(t-i<0&&s-i>=0)return-1;if(t-i==0&&s-i==0)return e-n>=0||n-r>=0?e-n:n-e;const o=(t-i)*(n-r)-(s-i)*(e-r);return o<0?1:o>0?-1:(t-i)*(t-i)+(e-r)*(e-r)-((s-i)*(s-i)+(n-r)*(n-r))}function ZP([t,e,s],n,i){const r=Math.abs(t-n),o=Math.abs(e-i);return r+o<=s||!(r>s||o>s)&&Math.sqrt(r*r+o*o)<s+1e-12}function KP(t,e,s,n){const i=t[0]-e,r=t[1]-s,o=t[2]-n;return i*i+r*r<o*o+1e-6}function Zx(t,e,s,n,i,r,o){const a=t-Math.max(n,Math.min(r,t)),l=e-Math.max(i,Math.min(o,e));return a*a+l*l<s*s}function C2(t,e,s,n,i,r,o,a={x:0,y:0}){const l=a||{x:0,y:0};let u,h,g,f;if(s===t){const v=t-i,b=o*o-v*v;if(b<0)return null;const S=Math.sqrt(b);u=t,g=t,h=r+S,f=r-S}else{const v=(n-e)/(s-t),b=e-v*t,S=b-r,A=v*v+1,w=2*(v*S-i),L=w*w-4*A*(i*i+S*S-o*o);if(L<0)return null;const M=-w,F=Math.sqrt(L),O=2*A;u=(M+F)/O,g=(M-F)/O,h=v*u+b,f=v*g+b}const p=t-u,y=e-h,_=t-g,x=e-f;return p*p+y*y<_*_+x*x?(l.x=u,l.y=h):(l.x=g,l.y=f),l}function yy({X:t,Y:e,sizes:s,indexes:n,R:i,center:r,gap:o=0,epsilon:a=.001,maxLoops:l=5,inPlace:u=!0}){const h=n.length,g=r[0],f=r[1];let p=h;u||(t=t.slice(),e=e.slice());const y=Wx,_=Xx,x=n.slice().sort(((G,j)=>_(t[G],e[G],t[j],e[j],g,f))),v=x[h-1],b=t[v],S=e[v];let A=!1;for(let G=0;G<p-1;G++){let j=G%h,Z=(G+1)%h;G===-1&&(j=h-1,Z=0),j=x[j],Z=x[Z];const at=t[j],pt=e[j];let K=t[Z],ut=e[Z];const ht=s[j]+s[Z]+o;let nt=_(at,pt,K,ut,g,f);if(nt===-1&&A&&(nt=1),!(ht>i)){if(nt===1||ht-_n(at,pt,K,ut)>a){const ot=y(g,f,i,at,pt,ht);if(ot){const Mt=ot[0];A=K>g&&Mt[0]<g,K=t[Z]=Mt[0],ut=e[Z]=Mt[1]}}else A=!1;if(G%h==h-2){const ot=x[h-1],Mt=x[0];if(e[ot]>f&&e[Mt]>f&&t[ot]-s[ot]<t[Mt]+s[ot]){let Q=0;for(p=Math.min(h*l,p+h);e[x[ot]]>f&&e[x[0]]>f&&t[x[ot]]<t[x[0]]&&++Q<h;){const Et=x.pop();Et&&x.unshift(Et)}}}}}const w=b-g,L=S-f,M=t[v]-g,F=e[v]-f,O=w===M?0:Math.abs(Math.acos((w*M+L*F)/(Math.sqrt(w*w+L*L)*Math.sqrt(M*M+F*F))));if(O!==0){const G=Math.sin(-O),j=Math.cos(-O);let Z;for(let at=0;at<h;at++){Z=x[at];const pt=t[Z]-g,K=e[Z]-f;t[Z]=pt*j-K*G+g,e[Z]=pt*G+K*j+f}}return{X:t,Y:e}}function OE(t,e,s,n,i,r){const o={},a=s[t];let l=a,u=0;const h=a*i;for(const g in e){const f=e[g];let p=0,y=0;for(let b=0,S=f.length;b<S;b++){const A=s[f[b]];y=Math.max(y,A),p+=2*A+n}const _=p/(2*Math.PI),x=y+l,v=r?u+Math.max(r,x):u*i;u=Math.max(x,u,_,h,v),o[g]=u,l=y}return o[0]=0,o[Number.POSITIVE_INFINITY]=u,o}function QP(t,e,s){return(e[0]-t[0])*(s[1]-t[1])-(e[1]-t[1])*(s[0]-t[0])}function BE(t){const e=t.length,s=[0,1];let n=2;for(let i=2;i<e;i++){for(;n>1&&QP(t[s[n-2]],t[s[n-1]],t[i])<=0;)--n;s[n++]=i}return s.slice(0,n)}function JP(t){const e=t.length;if(e<3)return null;const s=new Array(e),n=new Array(e);for(let g=0;g<e;g++)s[g]=[+t[g][0],+t[g][1],g];s.sort(((g,f)=>g[0]-f[0]||g[1]-f[1]));for(let g=0;g<e;g++)n[g]=[s[g][0],-s[g][1]];const i=BE(s),r=BE(n),o=r[r.length-1],a=i[i.length-1],l=r[0]===i[0],u=o===a?1:0,h=[];for(let g=i.length-1;g>=0;--g)h.push(t[s[i[g]][2]]);for(let g=+l;g<r.length-u;g++)h.push(t[s[r[g]][2]]);return h}var UE=t=>--t*t*t+1,GE=(t,e,s)=>{const n=t-s[0],i=e-s[1];return n*n+i*i},tz=(t,e)=>{let s=1/0,n=-1/0;for(let i=0;i<t.length;i++){const r=t[i],o=e?e[r]:r;s=Math.min(o,s),n=Math.max(o,n)}return{min:s,max:n}};function ez({X:t,Y:e,R:s,center:n,maxSteps:i=1e3,padding:r=5,epsilon:o=1e-9,damping:a=2,pinned:l=-1,indexes:u,onUpdate:h,pushSmallerOut:g=!0}){const f=u?u.length:t.length;let p=u;if(p===void 0){p=new Uint32Array(f);for(let A=0;A<f;A++)p[A]=A}else p=u;if(l!==-1)n=[t[l],e[l]];else if(!n){let A=0,w=0;for(let L=0;L<f;L++)A+=t[p[L]],w+=e[p[L]];n=[A/f,w/f]}const{min:y,max:_}=tz(p,s);function x(A,w){let L=0;for(let G=0;G<f-1;G++)for(let j=G+1;j<f;j++){if(G===j)continue;const Z=p[G],at=p[j],pt=t[Z],K=e[Z],ut=s[Z],ht=t[at],nt=e[at],ot=s[at],Mt=ht-pt,Q=nt-K,Et=ut+ot+r,Xt=Mt*Mt+Q*Q;if(Xt<Et*Et-A){const Ht=(Et-Math.sqrt(Xt))*w,Zt=1/Xt,ae=Mt*Zt*Ht,pe=Q*Zt*Ht,ne=ae*ae+pe*pe;if(at!==l){const te=ut/y;L+=ne*te,t[at]+=ae*te,e[at]+=pe*te}if(Z!==l){const te=ot/y;L+=ne*te,t[Z]-=ae*te,e[Z]-=pe*te}}}const M=A*a*(1-w),F=n[0],O=n[1];for(let G=0;G<f;G++){const j=p[G];if(j!==l){const Z=t[j],at=e[j],pt=s[j]/_,K=g?M*pt:M,ut=(Z-F)*K,ht=(at-O)*K;L+=ut*ut+ht*ht,t[j]-=ut,e[j]-=ht}}return L}p.sort(((A,w)=>s[w]*GE(t[w],e[w],n)-s[A]*GE(t[A],e[A],n)));let v=0,b=0;const S=UE(1/f);for(let A=0;A<i&&(v=x(S,UE((A+1)/i)),h&&setTimeout((()=>h(t,e))),!(Math.abs(v-b)<o));A++)b=v;return{X:t,Y:e}}var qc=t=>({data:t,next:null,prev:null});function L2(t,e=0,s=0){const n=t.length;if(n===0)return t;const i=t[0];if(i.x=e,i.y=s,n===1)return t;const r=t[1];if(i.x=e-r.radius,r.x=e+i.radius,r.y=s,n===2)return t;const o=t[2];VE(r,i,o);let a=qc(i),l=qc(r),u=qc(o);a.next=u.prev=l,l.next=a.prev=u,u.next=l.prev=a;t:for(let h=3;h<n;h++){u=qc(t[h]),VE(a.data,l.data,t[h]);let g=l.next,f=a.prev,p=l.data.radius,y=a.data.radius;do if(p<=y){if(jE(g.data,u.data)){l=g,a.next=l,l.prev=a,--h;continue t}p+=g.data.radius,g=g.next}else{if(jE(f.data,u.data)){a=f,a.next=l,l.prev=a,--h;continue t}y+=f.data.radius,f=f.prev}while(g!==f.next);u.prev=a,u.next=l,a.next=l.prev=l=u;let _=HE(a);for(;(u=u.next)!==l;){const x=HE(u);x<_&&(a=u,_=x)}l=a.next}return t}function VE(t,e,s){const n=t.x-e.x;let i,r;const o=t.y-e.y,a=n*n+o*o;let l,u;a?(r=e.radius+s.radius,r*=r,u=t.radius+s.radius,u*=u,r>u?(i=(a+u-r)/(2*a),l=Math.sqrt(Math.max(0,u/a-i*i)),s.x=t.x-i*n-l*o,s.y=t.y-i*o+l*n):(i=(a+r-u)/(2*a),l=Math.sqrt(Math.max(0,r/a-i*i)),s.x=e.x+i*n-l*o,s.y=e.y+i*o+l*n)):(s.x=e.x+s.radius,s.y=e.y)}var sz=1e-6;function jE(t,e){const s=t.radius+e.radius-sz,n=e.x-t.x,i=e.y-t.y;return s>0&&s*s>n*n+i*i}function HE(t){const e=t.data,s=t.next.data,n=e.radius+s.radius,i=(e.x*s.radius+s.x*e.radius)/n,r=(e.y*s.radius+s.y*e.radius)/n;return i*i+r*r}function nz(t,e,s,n,i){const r=t.get(e),o=t.get(s),a=i.get(r._index)||r.getAttributes(["x","y","r"]),l=i.get(o._index)||o.getAttributes(["x","y","r"]),u=Number(l.radius),h=Number(a.radius),g=_n(a.x,a.y,l.x,l.y),f=g;return n.push({source:e,target:s,weight:f}),g<=h+u+20?1:0}function iz(t){return t%3==2?t-2:t+1}function rz(t,e,s){const n=[],{triangles:i,halfedges:r}=t;for(let o=0;o<i.length;o++)o>r[o]&&nz(e,i[o],i[iz(o)],n,s);return n}var oz=(t,e)=>t.weight-e.weight;function az(t,e){const s=new Set,n=new Array(t.length),i=[];for(const o of e)n[o.source]||(n[o.source]=[]),n[o.source].push(o),n[o.target]||(n[o.target]=[]),n[o.target].push(o);s.add(0);const r=Yf(oz,n[0]);for(;r.size!==0;){const o=r.pop(),a=s.has(o.source)?s.has(o.target)?null:o.target:o.source;if(a){const l=o.source===a?o.target:o.source,u=a;i.push({source:l,target:u,weight:o.weight}),s.add(a);for(const h of n[a])r.push(h)}}return i}function $E(t,e,s){let n=t.x-e.x,i=t.y-e.y;const r=Math.sqrt(n*n+i*i);n/=r,i/=r;const o=s*n,a=s*i;t.x+=o,t.y+=a}function lz(t,e,s,n,i){const r=new Set;let o={x:0,y:0},a=-1;const l=i.map(((u,h)=>(t===s.get(h)&&(a=h,o={index:h,...u}),{x:u.x,y:u.y,r:u.radius,index:h})));if(s.size<3)return l.map(((u,h)=>{if(h===a)return u;const g=u.x-o.x,f=u.y-o.y,p=Math.sqrt(g*g+f*f),y=e*g/p,_=e*f/p;return{x:u.x+y,y:u.y+_,radius:u.r}}));for(const u of n){const h=l[u.target],g=l[u.source],f=1;g.index===a||r.has(u.source)||($E(g,o,f*e),r.add(u.source)),h.index===a||r.has(u.target)||($E(h,o,f*e),r.add(u.target))}return l.map((u=>({x:u.x,y:u.y})))}function N2(t,e,s,n){t.includes(e)||(t=t.concat(e.toList())),n||(n=t.getAttributes(["x","y","radius"]));const i=qx.from(n||t.getPosition(),(l=>l.x),(l=>l.y)),r=new Map;for(let l=0;l<t.size;l++)r.set(t._indexes[l],n[l]);const o=rz(i,t,r),a=az(t.toArray(),o);return lz(e,s,t,a,n)}var uz=class{constructor(){this._intersects=null,this._getBounds=null}setBoundsGetter(t){return this._getBounds=t,this}setIntersector(t){return this._intersects=t,this}};function dz(t,e,s,n,i,r,o,a){return t>i&&t<o&&e>r&&e<a||s>i&&s<o&&n>r&&n<a}function Xr(t,e,s,n,i,r,o,a){return n>=r&&e<=a&&s>=i&&t<=o}var Yr=(t,e,s,n,i,r)=>({minX:t,minY:e,maxX:s,maxY:n,leaf:!0,level:r,parent:i,objects:[],final:!1,children:null});function M2(t){const{minX:e,minY:s,maxX:n,maxY:i}=t;return[e,s,n,i]}function bd(t,e,s,n,i,r,o,a){return t>=i&&s<=o&&e>=r&&n<=a}var hz=0,cz=1,gz=2,fz=3;function Yc(t,e,s,n,i,r,o,a){const l=(r+a)/2,u=(e+n)/2;return(t+s)/2<=(i+o)/2?u<=l?hz:cz:u<=l?fz:gz}var pz=t=>t,Ol=class extends uz{constructor(t=pz,e=10,s,n=0){super(),this._nodeCapacity=10,this._root=null,this._objects={},this._size=0,this._rootLevel=0,this._maxLevel=30,this._idToCell={},this._nodeCapacity=e,this._root=null,this._getBounds=t,this._rootLevel=n,this._maxLevel=n+30,this._idToCell={},s&&(this._root=Yr(s[0],s[1],s[2],s[3],null,n))}get size(){return this._size}get root(){return this._root}clear(){return this._root=null,this._objects={},this._size=0,this._idToCell={},this._rootLevel=0,this._maxLevel=this._rootLevel+30,this}insert(t,e,s,n,i,r=this._root){if(e||([e,s,n,i]=this._getBounds(t)),this._objects[t])return;if(this._objects[t]=!0,this._size++,!this._root){const p=Math.max(Math.abs(n-e),Math.abs(i-s));return this._root=Yr(e,s,e+p,s+p,null,this._rootLevel),this._idToCell[t]=[this._root],this._root.objects=[t],t}let o,a=[r],l=!1;const u=this._nodeCapacity,h=this._idToCell,g=this._maxLevel;let f;for(;f=a.pop();){o=f;const{minX:p,minY:y,maxX:_,maxY:x}=o;Xr(e,s,n,i,p,y,_,x)&&(o.leaf?o.objects&&(o.objects.length<u||o.final)?(o.objects.push(t),h[t]?h[t].push(o):h[t]=[o],l=!0,(o.level>=g||Math.abs(_-p)<=Math.abs(n-e)||Math.abs(x-y)<=Math.abs(i-s))&&(o.final=!0)):(this.splitNode(o),a.push(o)):a.push.apply(a,o.children))}if(!bd(e,s,n,i,(r=this._root).minX,r.minY,r.maxX,r.maxY)){let p=this._rootLevel;for(;!bd(e,s,n,i,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){r=this._root;const{minX:y,minY:_,maxX:x,maxY:v}=r;let b=y,S=_,A=x,w=v;const L=Math.abs(x-y),M=Math.abs(v-_);if(M===0&&L===0)break;const F=Math.max(L,M);e<y?(b-=F,s<_?S-=F:w+=F):(A+=F,s<_?S-=F:w+=F);const O=Yr(b,S,A,w,null,--p);this.splitNode(O),O.children[Yc(y,_,x,v,b,S,A,w)]=r,this._root=r.parent=O}for(a=[this._root],this._root.level=this._rootLevel;f=a.shift();)if(o=f,!o.leaf)for(let y=0;y<4;y++){const _=o.children[y];_.level=o.level+1,a.push(_)}r=this._root;for(let y=0;y<4;y++){const _=r.children[y];_&&_.leaf&&_.objects&&(_.objects.push(t),h[t]?h[t].push(_):h[t]=[_])}}return l?t:void 0}removeById(t){if(!this._objects[t])return t;this._size--;const e=this._idToCell[t];for(let s=0;s<e.length;s++){const n=e[s].objects||[];for(let i=0,r=n.length;i<r;i++)if(n[i]===t){n.splice(i,1);break}}return delete this._objects[t],delete this._idToCell[t],t}remove(t){const[e,s,n,i]=this._getBounds(t),r=[this._root];let o,a;const l=[];for(;o=r.pop();)if(Xr(e,s,n,i,o.minX,o.minY,o.maxX,o.maxY))if(o.leaf){const u=o.objects||[];for(let h=0,g=u.length;h<g;h++)if(u[h]===t){u.splice(h,1),g===1&&l.push(o);break}}else r.push.apply(r,o.children);if(delete this._idToCell[t],delete this._objects[t],this._size--,l.length)for(;a=l.pop();){let u=a.parent,h=!0;for(;u&&h;){if(!u.leaf){for(let g=0;g<4;g++)if(o=u.children[g],!o.leaf||o.objects&&o.objects.length!==0){h=!1;break}h&&(u.leaf=!0,u.children=[],u.objects=[])}u=u.parent}}return t}splitNode(t){const{minX:e,minY:s,maxX:n,maxY:i}=t,r=(e+n)/2,o=(s+i)/2,a=t.level+1,l=this._idToCell,u=this._maxLevel,h=[Yr(e,s,r,o,t,a),Yr(e,o,r,i,t,a),Yr(r,o,n,i,t,a),Yr(r,s,n,o,t,a)];if(t.objects!==null){const g=t.objects,f=this._getBounds;for(let p=0,y=g.length;p<y;p++){const _=g[p],x=f(_);let v=l[_];for(let b=0;b<4;b++){const S=h[b],{minX:A,minY:w,maxX:L,maxY:M}=S;Xr(x[0],x[1],x[2],x[3],A,w,L,M)&&(S.objects&&S.objects.push(_),(S.level>=u||Math.abs(L-A)<=Math.abs(x[2]-x[0])||Math.abs(M-w)<=Math.abs(x[3]-x[1]))&&(S.final=!0),v?v.push(S):v=[S])}v&&v.splice(v.indexOf(t),1)}}t.children=h,t.objects=null,t.leaf=!1}point(t,e,s){let n=[];const i=[this._root];let r,o,a;const l=this._getBounds;for(;r=i.pop();)if(t>=r.minX&&t<=r.maxX&&e>=r.minY&&e<=r.maxY){if(r.leaf){s&&r.objects&&(n=r.objects);const u=r.objects||[];for(let h=0,g=u.length;h<g;h++)a=u[h],o=l(a),t>=o[0]&&t<=o[2]&&e>=o[1]&&e<=o[3]&&n.push(a);break}i.push.apply(i,r.children)}return n.length?n:null}neigbours(t,e){let s,n=[];const i=[this._root];for(;s=i.pop();)if(t>=s.minX&&t<=s.maxX&&e>=s.minY&&e<=s.maxY){if(s.leaf){n=s.objects;break}i.push.apply(i,s.children)}return n}query(t,e,s,n){const i=[],r=[this._root];let o,a,l;const u=this._getBounds,h={},g=this._intersects;let f;for(;o=r.pop();)if(Xr(t,e,s,n,o.minX,o.minY,o.maxX,o.maxY))if(o.leaf){const p=o.objects||[];for(let y=0,_=p.length;y<_;y++)l=p[y],h[l]||(a=u(l),Xr(t,e,s,n,a[0],a[1],a[2],a[3])&&(g&&!g(l,t,e,s,n)||i.push(l)),h[l]=!0)}else f=Yc(t,e,s,n,o.minX,o.minY,o.maxX,o.maxY),r.push(o.children[(f+3)%4],o.children[(f+2)%4],o.children[(f+1)%4],o.children[f]);return i}traverse(t,e,s,n,i){const r=[],o=[this._root];let a,l,u;const h=this._getBounds,g={},f=this._intersects;let p;for(;a=o.pop();)if(Xr(t,e,s,n,a.minX,a.minY,a.maxX,a.maxY))if(a.leaf){const y=a.objects||[];for(let _=0,x=y.length;_<x;_++)if(u=y[_],!g[u]){if(l=h(u),Xr(t,e,s,n,l[0],l[1],l[2],l[3])&&(!f||f(u,t,e,s,n))&&(r.push(u),i(u)))return r;g[u]=!0}}else p=Yc(t,e,s,n,a.minX,a.minY,a.maxX,a.maxY),o.push(a.children[(p+3)%4],a.children[(p+2)%4],a.children[(p+1)%4],a.children[p]);return r}getOverlaps(){const t=[this._root];let e,s,n;const i=[],r=this._getBounds,o={};for(;e=t.pop();)if(e.leaf){const a=e.objects||[],l=a.length;for(let u=0;u<l;u++)for(let h=0;h<l;h++)if(s=a[u],n=a[h],u!==h&&!o[s+":"+n]&&!o[n+":"+s]){o[s+":"+n]=!0;const g=r(s),f=r(n);Xr(g[0],g[1],g[2],g[3],f[0],f[1],f[2],f[3])&&i.push(s,n)}}else t.push.apply(t,e.children);return i}cover(t,e,s,n){if(this._root===null)return this._root=Yr(t,e,s,n,null,0),this;let i=this._root;if(!bd(t,e,s,n,i.minX,i.minY,i.maxX,i.maxY)){let r=this._rootLevel;for(;!bd(t,e,s,n,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){i=this._root;const{minX:u,minY:h,maxX:g,maxY:f}=i;let p=u,y=h,_=g,x=f;const v=Math.abs(g-u),b=Math.abs(f-h);if(b===0&&v===0)break;const S=Math.max(v,b);t<u?(p-=S,e<h?y-=S:x+=S):(_+=S,e<h?y-=S:x+=S);const A=Yr(p,y,_,x,null,--r);this.splitNode(A),A.children[Yc(u,h,g,f,p,y,_,x)]=i,this._root=i.parent=A}const o=[this._root];let a,l;for(this._root.level=this._rootLevel;a=o.shift();)if(l=a,!l.leaf)for(let u=0;u<4;u++){const h=l.children[u];h.level=l.level+1,o.push(h)}}return this}getAll(){return Object.keys(this._objects).map((t=>Number(t)))}forEach(t,e){const s=[this._root];let n;for(;n=s.pop();)if(n.leaf&&n.objects)for(let i=0,r=n.objects.length;i<r;i++)t.call(e,n.objects[i]);else s.push.apply(s,n.children);return this}getLeafs(){const t=[this._root],e=[];let s;for(;s=t.pop();)s.leaf?e.push(s):t.push.apply(t,s.children);return e}traverseFromRoot(t,e){const s=[this._root];let n;for(;n=s.pop();)t.call(e,n,n.objects)||n.leaf||s.push.apply(s,n.children);return this}update(t,e,s,n,i){return this.remove(t),this.insert(t,e,s,n,i),this}getNodeBounds(t){return M2(t)}};Ol.flatAccessor=(t,e)=>s=>{const n=e*s;return t.slice(n,n+e)},Ol.inside=bd,Ol.intersects=dz,Ol.overlaps=Xr,Ol.getNodeBBox=M2;var mz=Ol;function Kx(t,e,s,n,i){const r=new Array(t.length);for(let o=0;o<e.length;o++){const a=n[e[o]],l=n[s[o]];r[a]=r[a]||[],r[a].push(l),i&&(r[l]=r[l]||[],r[l].push(a))}return r}function th(t,e){return t[e]===-1?e:th(t,t[e])}function _z(t,e,s){const n=th(t,e),i=th(t,s);t[n]=i}function yz(t,e,s,n=!1){const i=new Int32Array(t.length),r={};for(let o=0;o<t.length;o++)i[o]=-1,r[t[o]]=o;for(let o=0;o<e.length;o++){const a=r[e[o]],l=r[s[o]];if(n&&a===l)return!0;const u=th(i,a),h=th(i,l);if(u===h)return!0;_z(i,u,h)}return!1}function k2(t,e,s,n,i,r,o,a){if(n[t]=i,s[t])return!0;if(e[t])return!1;e[t]=1,s[t]=1;const l=r[t];if(l){for(const u of l)if(k2(u,e,s,n,t,r,o,a))return o.push(a[u]),!0}return s[t]=0,!1}function I2(t,e,s){const n=t.length,i=new Uint8Array(n),r=new Uint8Array(n),o=new Int32Array(n),a={};for(let u=0;u<n;u++)a[t[u]]=u;const l=Kx(t,e,s,a,!1);for(let u=0;u<n;u++){const h=[];if(k2(u,i,r,o,-1,l,h,t)&&h.length>1){const g=h[0];for(let f=1;f<h.length;f++)if(h[f]===g){h.length=f;break}return h.push(g),h.reverse()}}return!1}function R2(t,e,s,n,i,r,o){e[t]=1,n[t]=s;const a=i[t];if(a){for(const l of a)if(e[l]){if(l!==s)return n[l]=t,r.push(o[l]),!0}else if(R2(l,e,t,n,i,r,o))return r.push(o[l]),!0}return!1}function xz(t,e,s){const n=t.length,i=new Uint8Array(n),r=new Int32Array(n),o={};for(let l=0;l<n;l++)o[t[l]]=l,r[l]=-1;const a=Kx(t,e,s,o,!0);for(let l=0;l<e.length;l++){const u=o[e[l]],h=o[s[l]];a[u]=a[u]||[],a[u].push(h)}for(let l=0;l<n;l++){const u=l,h=[];if(!i[u]&&R2(u,i,-1,r,a,h,t))return!0}return!1}var F2=class{constructor(t,e,s){this.cycles=[],this.visitedLength=0,this.visitedStack=[],this.stack=[],this.idToIndex={},this.removed={},this.nodes=t,this.visited=new Uint8Array(this.nodes.length);for(let n=0;n<t.length;n++)this.idToIndex[t[n]]=n;this.adjacency=Kx(t,e,s,this.idToIndex)}getCycles(){this.visited=new Uint8Array(this.nodes.length),this.visitedStack=[];for(let t=0;t<this.nodes.length;t++)for(this.backtrack(t,t);this.visitedLength!==0;){const e=this.visitedStack.pop();e!==void 0&&this.visited[e]&&(this.visited[e]=0,this.visitedLength--)}return this.cycles}backtrack(t,e){let s=!1;this.stack.push(e),this.visited[e]||(this.visited[e]=1,this.visitedLength++),this.visitedStack.push(e);const n=this.adjacency[e]||[];for(const i of n)if(this.removed[e]=this.removed[e]||{},!this.removed[e][i]){if(i<t)this.removed[e][i]=!0;else if(i===t){s=!0;const r=[];for(let o=0,a=!1;o<this.stack.length;o++){const l=this.stack[o];t===l&&(a=!0),a&&r.push(this.nodes[l])}this.cycles.push(r)}else if(!this.visited[i]){const r=this.backtrack(t,i);s=s||r}}if(s){let i;do i=this.visitedStack.pop(),this.visited[i]&&(this.visited[i]=0,this.visitedLength--);while(i!==e)}return this.stack.pop(),s}};function vz(){return{index:{},parent:[],count:0}}function bz(t,e){t.index[e]===void 0&&(t.count+=1,t.index[e]=t.parent.push(-t.count))}function qE(t,e){let s=t.index[e];if(s===void 0)return-1;for(;s>=0;)e=s,s=t.parent[s];return e}function Ez(t,e,s){t.parent[s]=e,t.count-=1}function Sz(t){return t.count<=1}function P2(t,e,s,n,i){i&&e.sort(((a,l)=>i(a)-i(l)));const r=[],o=vz();t.forEach((a=>bz(o,a)));for(let a=0;a<e.length&&!Sz(o);a++){const l=qE(o,s(e[a])),u=qE(o,n(e[a]));l!==u&&l>0&&u>0&&(Ez(o,l,u),r.push(e[a]))}return r}function z2({adjacency:t,directed:e=!1,normalized:s=!0}){const n=[],i=[],r={},o={},a={},l={};let u;const h=new Array(t.length),g={},f={},p={};for(let b=0;b<t.length;b++){const S=t[b];p[S.id]=S.adj,g[S.id]=!0,f[S.id]=b,e||S.adj.forEach((A=>{g[A]=!0}))}const y=Object.keys(g).map((b=>+b));for(let b=0;b<y.length;b++)h[b]=0;for(let b=0;b<y.length;b++)u=y[b],v(u),x();const _=s?y.length>2?1/((y.length-1)*(y.length-2)):0:e?0:.5;if(_)for(let b=0;b<h.length;b++)h[b]*=_;return h;function x(){for(let b=0;b<y.length;b++)l[y[b]]=0;for(;i.length;){const b=i.pop(),S=(1+l[b])/a[b],A=r[b];for(let w=0;w<A.length;++w){const L=A[w];l[L]+=a[L]*S}b!==u&&(h[f[b]]+=l[b])}}function v(b){for(let S=0;S<y.length;S++){const A=y[S];r[A]=[],o[A]=-1,a[A]=0}for(o[b]=0,a[b]=1,n.push(b);n.length;){const S=n.shift();i.push(S),p[S].forEach((A=>{o[A]===-1&&(o[A]=o[S]+1,n.push(A)),o[A]===o[S]+1&&(a[A]+=a[S],r[A].push(S))}))}}}var D2=class{constructor(t){this._heap=[],this._size=0,this._keyToValue=t,this._keyToIndex=new Int32Array(t.length),this._keyToIndex.fill(-1)}add(t){let e=this._keyToIndex[t];e===-1&&(e=this._size++,this._heap[e]=t),this._keyToIndex[t]=this._bubble(e)}removeMin(){if(this._size===0)return NaN;const t=this._heap[0];return this._heap[0]=this._heap[--this._size],this._bubble(0),t}isEmpty(){return this._size===0}has(t){return this._keyToIndex[t]!==-1}_bubble(t){const e=this._indexToValue(t),s=this._getParentIndex(t),n=this._indexToValue(s);let i=t;if(t!==0&&n>e)i=this._swap(t,s);else{const r=this._getLeftChildIndex(t),o=this._getRightChildIndex(t),a=this._indexToValue(r),l=this._indexToValue(o),u=Math.min(e,a,l);u===e||(i=u===a?this._swap(t,r):this._swap(t,o))}return i===t?t:this._bubble(i)}_indexToValue(t){return t>=this._size?1/0:this._keyToValue[this._heap[t]]}_getParentIndex(t){return(t-1)/2|0}_getLeftChildIndex(t){return 2*t+1}_getRightChildIndex(t){return 2*t+2}_swap(t,e){const s=this._heap[t],n=this._heap[e];return this._heap[t]=n,this._heap[e]=s,this._keyToIndex[s]=e,this._keyToIndex[n]=t,e}},O2=Yo&&!!window.PointerEvent,Wf="pointerdown",Xf="pointermove",Zf="pointerup",Th="pointercancel",hu={},ff=0,B2=t=>t.pointerType==="mouse",U2=t=>t.pointerType!=="mouse";function Az(){if(ao&&ff===0&&O2){const t=document.documentElement;t.addEventListener(Wf,G2,!0),t.addEventListener(Xf,V2,!0),t.addEventListener(Zf,pf,!0),t.addEventListener(Th,pf,!0)}ff++}function wz(){if(ff--,ao&&ff===0){const t=document.documentElement;t.removeEventListener(Wf,G2,!0),t.removeEventListener(Xf,V2,!0),t.removeEventListener(Zf,pf,!0),t.removeEventListener(Th,pf,!0)}}function G2(t){hu[t.pointerId]=t}function V2(t){hu[t.pointerId]&&(hu[t.pointerId]=t)}function pf(t){delete hu[t.pointerId]}function Kf(t,e){t.touches=[];for(const s in hu)t.touches.push(hu[s]);t.changedTouches=[t],e(t)}function Tz(t,e,s){const n=i=>{B2(i)||(U2(i)&&i.preventDefault(),Kf(i,s))};return t(e,Wf,n,!1),n}function Cz(t,e,s){const n=i=>{U2(i)&&i.preventDefault(),Kf(i,s)};return t(e,Th,n,!1),n}function Lz(t,e,s){const n=i=>{B2(i)&&i.buttons===0||Kf(i,s)};return t(e,Xf,n,!1),n}function Nz(t,e,s){const n=i=>Kf(i,s);return t(e,Zf,n,!1),t(e,Th,n,!1),n}function YE(t,e,s,n){return s==="touchstart"?t(e,Wf,n,!1):s==="touchmove"?t(e,Xf,n,!1):s==="touchend"?(t(e,Zf,n,!1),t(e,Th,n,!1)):void 0}var Xe=class{constructor(t){this._ogma=t}_setModules(t){this._modules=t}onMounted(){}onReady(t){}destroy(t){}},Mz=["graphics","legend","brand"],Wm=300,Xm=300,kz=200,Iz=class extends Xe{constructor(){super(...arguments),this._width=Wm,this._height=Xm,this._resizeObserver=n2((()=>this._resize())),this._layers={},this._focus=!1,this._container=null,this._isFullScreen=!1,this._beforeNextFramePromises=[],this._afterNextFramePromises=[],this._onNextFramePromises=[],this._refreshUntil=0,this._currentTime=Hn(),this._timeouts=[],this._isDestroyed=!1,this._onDetachDom=[],this._isRealBrowser=jf,this._isDocumentReady=Hf,this._inFrame=!1,this._mustRefresh=!1,this._nextFrame=null,this._onWindowFocus=()=>this.refresh(),this._onFullscreenChange=()=>{this._isFullScreen=Dd()},this._resize=t=>{if(!this._container&&!t)return;const e=this._width,s=this._height;let n=0,i=0;if(this._container){const r=this._modules.settings.get("minimumWidth"),o=this._modules.settings.get("minimumHeight"),a=this._container.clientWidth||1,l=this._container.clientHeight||1;n=Math.max(r,t?t.width:a),i=Math.max(o,t?t.height:l)}else t&&(n=t.width,i=t.height);n===e&&i===s||(this._width=n,this._height=i,Mr(this._layers,(({element:r,automaticResize:o})=>{o&&df(r,n,i)})),this._modules.events.fire("resize",{prevWidth:e,prevHeight:s,width:n,height:i,difWidth:n-e,difHeight:i-s}))}}onMounted(){this._modules.settings.register("minimumWidth",Wm,(()=>this._resize()),!1),this._modules.settings.register("minimumHeight",Xm,(()=>this._resize()),!1),this._modules.events.register(["beforeNewFrame","frame","afterNewFrame","setContainer","resize"]),this._onDetachDom=[],Az(),this.addWindowEventListener("focus",this._onWindowFocus)}onReady(t){var e,s;t.container&&this.setContainer(t.container),(e=t.options)!=null&&e.width||(s=t.options)!=null&&s.height?this._resize({width:t.options.width||Wm,height:t.options.height||Xm}):this._resize()}addWindowEventListener(t,e,s){return this._isRealBrowser&&this.addElementEventListener(window,t,e,s),this}addDirectWindowEventListener(t,e,s){this._isRealBrowser&&window.addEventListener(t,e,s)}removeDirectWindowEventListener(t,e){this._isRealBrowser&&window.removeEventListener(t,e)}addDocumentEventListener(t,e,s){return this._isDocumentReady&&this.addElementEventListener(document.documentElement,t,e,s),e}removeDocumentEventListener(t,e){this._isDocumentReady&&document.documentElement.removeEventListener(t,e)}addMediaListener(t,e){if(this._isDocumentReady&&typeof window.matchMedia=="function"){const s=window.matchMedia(t);s.addListener(e),this._onDetachDom.push((()=>s.removeListener(e)))}}addElementEventListener(t,e,s,n){return this._isDestroyed||(t.addEventListener(e,s,n),this._onDetachDom.push((()=>t.removeEventListener(e,s,n)))),s}detachFromDom(){this._onDetachDom.forEach((t=>t())),this._onDetachDom=[],this._emptyContainer()}setTimeout(t,e=0){const s=setTimeout((()=>{this._timeouts.splice(this._timeouts.indexOf(s),1),t()}),e);return this._timeouts.push(s),s}clearTimeout(t){return t&&(clearTimeout(t),this._timeouts.splice(this._timeouts.indexOf(t),1)),null}clearAllTimeouts(){this._timeouts.forEach(clearTimeout),this._timeouts=[]}stopFrames(){this._isDestroyed=!0,this._nextFrame&&(KT(this._nextFrame),this._nextFrame=null)}isDestroyed(){return this._isDestroyed}getDimensions(){return{width:this._width,height:this._height}}setDimensions(t){this._resize(t)}setLayer(t,e,{automaticResize:s=!1}={}){e?(e._ogmaLayer=t,s&&(e.style.position="absolute",e.style.top="0px",e.style.left="0px",df(e,this._width,this._height,bi())),this._layers[t]={element:e,automaticResize:s}):e===null&&delete this._layers[t],this._updateContainerContent()}setContainer(t){let e;if(typeof t=="string"){if(e=document.getElementById(t),!e)throw new Error(`unable to find DOM element with id "${t}"`)}else e=t;if(e===this._container)return;e===null&&this._emptyContainer();const s=this._container;this._isFullScreen=!1,this._container&&this._resizeObserver.unobserve(this._container),this._container=e,this._container&&(["fullscreenchange","webkitfullscreenchange"].forEach((n=>{this.addElementEventListener(this._container,n,this._onFullscreenChange)})),this._resizeObserver.observe(this._container)),this._resize(),this._updateContainerContent(),this._modules.events.fire("setContainer",{element:e,prevElement:s})}getContainer(){return this._container}appendElement(t){this._container!==null&&this._container.appendChild(t)}focus(){this._focus=!0}blur(){this._focus=!1}hasFocus(){return this._focus}forceResize(){this._resize()}_beforeOrAfterNextFrame(t){const e=t===1?this._onNextFramePromises:t===2?this._afterNextFramePromises:this._beforeNextFramePromises,s=new Promise((n=>{e.push((()=>(n(void 0),s)))}));return this._refresh(),s}beforeNextFrame(){return this._beforeOrAfterNextFrame(0)}onNextFrame(){return this._beforeOrAfterNextFrame(1)}afterNextFrame(){return this._beforeOrAfterNextFrame(2)}refresh(t){t&&(this._refreshUntil=Math.max(this._refreshUntil,t)),this._refresh()}_emptyContainer(){if(this._container){const t=[];for(let e=0;e<this._container.childNodes.length;++e){const s=this._container.childNodes[e];s._ogmaLayer&&t.push(s)}for(let e=0;e<t.length;++e)this._container.removeChild(t[e])}}_fillContainer(){if(this._container){const t=i2(this._container,"position");t!=="absolute"&&t!=="relative"&&t!=="fixed"&&(this._container.style.position="relative");const e=this._container.firstChild;Mz.forEach((s=>{const n=this._layers[s];n&&n.element&&this._container&&this._container.insertBefore(n.element,e)}))}}_updateContainerContent(){this._emptyContainer(),this._fillContainer()}_refresh(){this._inFrame?this._mustRefresh=!0:this._nextFrame||this._isDestroyed||(this._nextFrame=zx((()=>this._playFrame())))}_playFrame(){const t=Hn(),e={elapsed:t-this._currentTime},s=this._modules.events,n=lT([this._beforeNextFramePromises,()=>s.fire("beforeNewFrame",e),()=>s.fire("frame",e),this._onNextFramePromises,()=>s.fire("afterNewFrame",e),this._afterNextFramePromises,()=>{this._inFrame=!1,(this._mustRefresh||t<this._refreshUntil+17)&&(this._mustRefresh=!1,this._refresh())}]);this._inFrame=!0,this._nextFrame=null,this._mustRefresh=!1,this._currentTime=t,this._beforeNextFramePromises=[],this._onNextFramePromises=[],this._afterNextFramePromises=[],n.reduce(((i,r)=>i.then((()=>{if(!this._isDestroyed)return r()}))),Promise.resolve())}isPlayingFrame(){return this._inFrame||!!this._nextFrame}setFullScreen(t){let e=Promise.resolve();return t!==this._isFullScreen?(this._container&&(e=t?Rz(this._container):Fz()),e.then((()=>new Promise((s=>{this.setTimeout((()=>{this._isFullScreen=Dd(),s(void 0)}),kz)}))))):e}isFullScreen(){return Dd()}debounceBeforeFrame(t){let e=!1,s=[];const n=()=>{const i=s;e=!1,s=[],t(),i.forEach((r=>r()))};return()=>new Promise((i=>{s.push(i),e||(e=!0,this.beforeNextFrame().then(n))}))}destroy(){this._resizeObserver.disconnect(),wz(),this.detachFromDom(),this.clearAllTimeouts(),this.stopFrames()}};function Dd(){return typeof document<"u"&&!!(document.fullscreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)}function Rz(t){return Dd()?Promise.resolve():t.requestFullscreen?t.requestFullscreen():t.requestFullScreen?t.requestFullScreen():t.webkitRequestFullScreen?Promise.resolve(t.webkitRequestFullScreen()):t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen?t.msRequestFullscreen():Promise.resolve()}function Fz(){return Dd()?typeof document>"u"?Promise.resolve():document.exitFullscreen?document.exitFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.webkitCancelFullScreen?Promise.resolve(document.webkitCancelFullScreen()):document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():Promise.resolve():Promise.resolve()}var Pz=class extends Xe{constructor(){super(...arguments),this._nodeChanges=[],this._edgeChanges=[],this._shouldTriggerEvents=!1}onMounted(){this._nodeDataList=this._modules.graph.createAttribute(!0,{name:"data",storage:"any"},!1),this._edgeDataList=this._modules.graph.createAttribute(!1,{name:"data",storage:"any"},!1),this._nodeList=this._modules.graph.getNodeAttribute("object"),this._edgeList=this._modules.graph.getEdgeAttribute("object"),this._modules.events.register(["setData","updateNodeData","updateEdgeData"]),this._modules.events.on("addNodes",(({nodes:t,objects:e})=>this._onAddElements(t,e))).on("addEdges",(({edges:t,objects:e})=>this._onAddElements(t,e))).on("beforeNewFrame",(()=>{this._shouldTriggerEvents&&(this._shouldTriggerEvents=!1,this._triggerEvents())}))}_onAddElements(t,e){const{isNode:s,size:n,_indexes:i}=t,r=this[s?"_nodeDataList":"_edgeDataList"];for(let o=0;o<n;++o)r.set(i[o],e[o].data)}setProperty(t,e,s,{dispatch:n=!1,virtual:i=!1}={}){this._setDataProperty(t.isNode,t._indexes,e,s,n,i),this._modules.events.fire("setData",{elements:t,virtual:i})}getProperty(t,e){return this._getDataProperty(t.isNode,t._indexes,e)}_setDataProperty(t,e,s,n,i,r){i&&typeof n=="function"&&(i=!1);const o=WE(s),a=typeof n=="function",l=t?this._nodeList:this._edgeList,u=t?this._nodeDataList:this._edgeDataList,h=zz(t?this._nodeChanges:this._edgeChanges,o);for(let g=0;g<e.length;++g){const f=e[g];let p=u.get(f);const y=l.get(f),_=i?n[g]:n;let x,v;if(o===null)x=p,v=a?_(y):_,u.set(f,v);else{p==null&&(p={},u.set(f,p));const b=o.length;for(let S=0;S<b;S++){const A=o[S];let w=p[A];S<b-1?(w==null&&(w={},p[A]=w),p=w):(x=w,v=a?_(y):_,p[A]=v)}}h.indexes.push(f),h.previousValues.push(x),h.newValues.push(v),h.virtual=r}this._scheduleEvents()}_getDataProperty(t,e,s,n){const i=WE(s);n||(n=new Array(e.length));const r=t?this._nodeDataList:this._edgeDataList;for(let o=0;o<e.length;++o){const a=e[o];let l,u=r.get(a);if(i!==null&&i.length)if(u==null)l=void 0;else{const h=i.length;for(let g=0;g<h&&u;++g)l=u=u[i[g]]}else l=u;n[o]=l}return n}_scheduleEvents(){this._shouldTriggerEvents=!0,this._modules.dom.refresh()}_triggerEvents(){const t=this._prepareEvtPayload(!0),e=this._prepareEvtPayload(!1);this._modules.events.fire("updateNodeData",t),this._modules.events.fire("updateEdgeData",e)}_prepareEvtPayload(t){const e=t?this._modules.graph.nodeList:this._modules.graph.edgeList,s=t?"_nodeChanges":"_edgeChanges";let n=[];const i=this[s];this[s]=[];const r=[];for(let o=0;o<i.length;++o){const{indexes:a,property:l,newValues:u,previousValues:h,virtual:g}=i[o];n=n.concat(a||[]),t?r.push({property:l,newValues:u,previousValues:h,virtual:g,nodes:e(a)}):r.push({property:l,newValues:u,previousValues:h,virtual:g,edges:e(a)})}return t?{nodes:e(n).dedupe(),isNode:t,changes:r}:{edges:e(n).dedupe(),isNode:t,changes:r}}};function zz(t,e){for(let n=0;n<t.length;++n){const i=t[n],r=i.property;if(e===null&&r===null)return i;if(e&&r&&r.length===e.length){let o=!0;for(let a=0;a<r.length;++a)if(r[a]!==e[a]){o=!1;break}if(o)return i}}const s={property:e&&e.slice(),indexes:[],previousValues:[],newValues:[],nodes:null,virtual:!1,edges:null};return t.push(s),s}function WE(t){return typeof t=="string"?t.split("."):Nn(t)?t:null}var ko=()=>(t,e)=>t[e],Io=()=>(t,e,s)=>{t[e]=s},XE={1:Zm(1),2:Zm(2),4:Zm(4),8:ko(),16:ko(),32:ko(),int8:ko(),int16:ko(),int32:ko(),float:ko(),any:ko()},ZE={1:Km(1),2:Km(2),4:Km(4),8:Io(),16:Io(),32:Io(),int8:Io(),int16:Io(),int32:Io(),float:Io(),any:Io()};function Zm(t){const e=8/t,s=(1<<t)-1;return(n,i)=>n[i/e|0]>>i%e*t&s}function Km(t){const e=8/t,s=Math.pow(2,t)-1;return(n,i,r)=>{const o=i%e*t,a=i/e|0,l=r<<o,u=255-(s-r<<o);n[a]=n[a]&u|l}}function Dz(t,e){return t===void 0&&e!=="any"&&e!=="resource"?0:t}var Oz={get(t){return this._getArrayElt(this._buffer,t)},set(t,e){this._setArrayElt(this._buffer,t,e)}},Bz={get(t){return this._byIndex[this._getArrayElt(this._buffer,t)]},set(t,e){let s=this._byName[e];s===void 0&&(s=this._nextIndex++,this._byIndex.push(e),this._getElementBitSize()>this._elementSize&&this.increaseElementSize(),this._byName[e]=s),this._setArrayElt(this._buffer,t,s)}},Uz=0,mf=class{constructor(t){this._id=Uz++,this._initialized=!1;const e=t.name,s=t.storage,n=t.size||0,i=Dz(t.default,s),r=Math.max(8,KE(n+1)),o=s==="resource"?1:s;this._name=e,this._storage=s,this._getArrayElt=XE[o],this._setArrayElt=ZE[o],this._elementSize=o,this._nbElements=r,this._fallback=null,this._byName=void 0,this._byIndex=void 0,this._nextIndex=void 0,this._defaultValue=i,this._BASE_VALUE=s==="any"?void 0:0,this._methods=Oz,this._initialized=!1,this._buffer=null,s==="resource"&&(this._methods=Bz,this._byName=Object.create(null),this._byIndex=[],this._nextIndex=1,this._byName[i]=0,this._byIndex.push(i))}getValues(){return Object.keys(this._byName||{})}getName(){return this._name||""}setDefaultValue(t){this._defaultValue=t,this._storage==="resource"&&(this._byName[t]=0,this._byIndex[0]=t)}get(t){return this._get(t)}set(t,e){this._set(t,e)}_get(t){return this._defaultValue}_set(t,e){e!==this._defaultValue&&(this._initialize(),this._set(t,e))}setFallback(t){this._fallback=t,this.get=this._getWithFallback}_getWithFallback(t){const e=this._get(t);return e===void 0&&this._fallback?this._fallback.get(t):e}_initialize(){this._initialized=!0,this._buffer=Qm(this._nbElements,this._elementSize),this._get=this._methods.get,this._set=this._methods.set,this._storage!=="resource"&&this._defaultValue!==this._BASE_VALUE&&this._reset(0)}grow(t){const e=KE(t+1);if(!(e<=this._nbElements)){if(this._initialized)if(this._elementSize==="any")for(let s=this._nbElements;s<e;++s)this._buffer.push(this._defaultValue);else{const s=Qm(e,this._elementSize);s.set(this._buffer),this._buffer=s,this._storage!=="resource"&&this._defaultValue!==this._BASE_VALUE&&this._reset(this._nbElements)}this._nbElements=e}}increaseElementSize(){const t=this._elementSize;if(typeof t!="number"||t===32)throw new Error("FlexArray: cannot increase element size");const e=2*t,s=XE[e],n=ZE[e];if(this._initialized){const i=this._nbElements,r=this._getArrayElt,o=this._buffer,a=Qm(i,e);if(t>=8)a.set(o);else for(let l=0;l<i;++l)n(a,l,r(o,l));this._buffer=a}this._elementSize=e,this._getArrayElt=s,this._setArrayElt=n}buffer(){if(!this._buffer)throw new Error("FlexArray: buffer not instantiated");return this._buffer}elementBitSize(){return this._elementSize}capacity(){return this._nbElements}byteSize(){return this._nbElements*this._elementSize/8}isInitialized(){return this._initialized||this._fallback&&this._fallback.isInitialized()}getMultiple(t,e){const s=t.length;e===void 0&&(e=new Array(s));for(let n=0,i=s;n<i;++n)e[n]=this.get(t[n]);return e}fill(t,e){for(let s=0,n=t.length;s<n;++s)this.set(t[s],e)}setMultiple(t,e,s){if(s||!Array.isArray(e)&&!ArrayBuffer.isView(e))for(let n=0,i=t.length;n<i;++n)this.set(t[n],e);else for(let n=0,i=t.length;n<i;++n)this.set(t[n],e[n])}reset(){return this._initialized&&this._reset(0),this}_reset(t){const e=this._storage==="resource"?0:this._defaultValue;if(this._buffer)if(typeof this._elementSize!="number"||this._elementSize>=8)this._buffer.fill(e,t);else{const s=8/this._elementSize;let n=0;for(let i=0;i<s;++i)n<<=this._elementSize,n+=e;if(t===void 0)this._buffer.fill(n);else{const i=t+(8-t%8);for(let r=t;r<i;++r)this._setArrayElt(this._buffer,r,e);this._buffer.fill(n,i/8)}}}_getElementBitSize(){if(this._nextIndex)return Math.pow(2,Math.ceil(Math.log2(Math.log2(this._nextIndex))))}};function KE(t){let e=2;for(;e<t;)e*=2;return e}function Qm(t,e){return e==="any"?new Array(t):e==="float"?new Float32Array(t):e==="int8"?new Int8Array(t):e==="int16"?new Int16Array(t):e==="int32"?new Int32Array(t):e===32?new Uint32Array(t):e===16?new Uint16Array(t):new Uint8Array(Math.ceil(t/8*e))}var QE=4,j2=class{constructor(){this._buffer=new Uint32Array(QE),this._capacity=QE,this._size=0,this._busy=!1}isBusy(){return this._busy}markBusy(){return this._busy=!0,this}sliceAndReset(){this._busy=!1;const t=this.slice(0,this._size);return this.reset(),t}reset(){return this._size=0,this}reserve(t){return t>this._capacity&&this._setCapacity(Vo(t)),this}_setCapacity(t){const e=new Uint32Array(t);e.set(this._buffer),this._buffer=e,this._capacity=t}push(t){return this._size===this._capacity&&this._setCapacity(2*this._capacity),this._buffer[this._size++]=t,this}pushUnchecked(t){return this._buffer[this._size++]=t,this}slice(t=0,e=this._size){return this._buffer.slice(t,e)}getBuffer(){return this._buffer}getLength(){return this._size}getCapacity(){return this._capacity}setLength(t){return this._size=t,this}isEmpty(){return this._size===0}},JE=class{constructor(t){this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._flexArrays=[],this._defaultValues=[],this._flexArraysByName={},this._indexLists=[],this._name=t?"node":"edge",this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._idFlexArray=new mf({storage:"int32"}),this._idFlexArray.get=e=>this._indexToId[e],this._idFlexArray.getMultiple=e=>{const s=new Array(e.length);for(let n=0;n<e.length;++n)s[n]=this._indexToId[e[n]];return s},this._flexArraysByName.id=this._idFlexArray}addElements(t){const e=[];for(let s=0,n=t.length;s<n;++s){const i=t[s];let r=this._idToIndex[i];r===void 0&&(r=this._getNextIndex(),this._idToIndex[i]=r,this._indexToId[r]=i),e.push(r)}for(const s of this._flexArrays)s.grow(this._nextIndex);for(const s of this._indexLists)s.reserve(this._nextIndex);return new Uint32Array(e)}removeElements(t){for(let e=0,s=t.length;e<s;++e){const n=t[e],i=this._indexToId[n];i!==void 0&&(delete this._idToIndex[i],this._removeIndex(n))}}clear(){this._idToIndex=Object.create(null),this._indexToId=[void 0],this._nextIndex=1,this._freeIndexes=[];for(const t of this._flexArrays)t.reset();for(const t of this._indexLists)t.reset()}has(t){return this._indexToId[t]!==void 0}getIndex(t,e=!1){const s=this._idToIndex[t];if(s===void 0&&e)throw new Error(`${this._name} id "${t}" not found`);return s}createFlexArray(t,e){const{name:s}=t;if(s&&e&&this._flexArraysByName[s])throw new Error(`${this._name} flexArray "${s}" already exists`);let n=t.default;n===void 0&&t.storage!=="any"&&t.storage!=="resource"&&(n=0);const i=this._nextIndex,r={storage:t.storage,size:i,name:s,default:n};let o;return o=(n===void 0&&t.storage!=="any"&&t.storage,new mf(r)),this._flexArrays.push(o),this._defaultValues.push(t.default),s&&e&&(this._flexArraysByName[s]=o),o}getFlexArray(t){return this._flexArraysByName[t]}getAllFlexArrays(){return this._flexArraysByName}createIndexList(){const t=new j2;return t.reserve(this._nextIndex),this._indexLists.push(t),t}getId(t){return this._indexToId[t]}getMaxIndex(){return this._nextIndex-1}_removeIndex(t){this._indexesToBeFreed.push(t)}_getNextIndex(){let t=this._freeIndexes.pop();return t===void 0&&(t=this._nextIndex++),t}freeIndexes(){for(const t of this._indexesToBeFreed)this._indexToId[t]=void 0,this._freeIndexes.push(t);for(let t=0;t<this._flexArrays.length;++t){const e=this._flexArrays[t],s=this._defaultValues[t];for(const n of this._indexesToBeFreed)e.set(n,s)}this._indexesToBeFreed=[]}};function tS(t,e,s={},n={}){const i=eh(t,e,[s],n);return t.fireEvent("postAddElements",{nodes:e?i:void 0,edges:e?void 0:i,virtual:n&&n.virtual}),i.get(0)}function Gz(t,{nodes:e=[],edges:s=[]},n={}){if(t.fireEvent("preAddGraph",{name:"preAddGraph"}),!n.batchSize)return Promise.all([eh(t,!0,e,n),eh(t,!1,s,n)]).then((([r,o])=>(t.fireEvent("postAddElements",{nodes:r,edges:o,virtual:n&&n.virtual}),t.fireEvent("postAddGraph",{name:"postAddGraph"}),t.fireEvent("addGraph",{nodes:r,edges:o}),{nodes:r,edges:o})));let i;return _f(t,!0,e,n).then((r=>(i=r,_f(t,!1,s,n)))).then((r=>({nodes:i,edges:r}))).then((r=>(t.fireEvent("postAddGraph",{name:"postAddGraph"}),t.fireEvent("addGraph",{name:"addGraph"}),r)))}function _f(t,e,s,n={}){if(n.batchSize){const i=[];for(let a=0;a<s.length;a+=n.batchSize)i.push(s.slice(a,a+n.batchSize));const r=(a,l)=>{let u;return a.then((h=>(u=h,t.getDom().afterNextFrame()))).then((()=>eh(t,e,l,n))).then((h=>u.concat(h)))},o=e?t.nodeList():t.edgeList();return i.reduce(r,Promise.resolve(o)).then((a=>(t.fireEvent("postAddElements",{nodes:e?a:void 0,edges:e?void 0:a,virtual:n&&n.virtual}),a)))}return Promise.resolve(eh(t,e,s,n)).then((i=>(t.fireEvent("postAddElements",{nodes:e?i:void 0,edges:e?void 0:i,virtual:n&&n.virtual}),i)))}function eh(t,e,s,n){const{virtual:i=!1}=n;t.fireEvent("preAddElements",{name:"preAddElements",objects:s,virtual:i,isNode:e});const r=!!n.ignoreInvalid,o=t.storage.fetch(e),a=[],l=[],u=[],h=[],g=new Set;for(const w of s){if(typeof w!="object"||w===null||Array.isArray(w)){if(r)continue;throw new Error(`${w} is not a valid ${e?"node":"edge"}`)}const L=xF(w.id);if(!o.getIndex(L,!1)&&!g.has(L)){if(!e){const M=w,F=t.getExtremityIndex(L,M.source,0,r),O=t.getExtremityIndex(L,M.target,1,r);if(r&&(!F||!O))continue;u.push(F),h.push(O)}l.push(L),a.push(w),g.add(L)}}const f=o.addElements(l);e?t.topology.allocateNodes(f):t.topology.allocateEdges(f,u,h);const p=o.getFlexArray("object"),y=o.getFlexArray("excluded"),_=o.getFlexArray("removed"),x=o.getFlexArray("virtual"),v=e?t.node:t.edge,b=e?t.nodeList:t.edgeList,S=t.getCacheLists(e),A=b(f);for(let w=0;w<f.length;w++){const L=f[w];p.set(L,v(L))}return y.setMultiple(f,0),_.setMultiple(f,0),x.setMultiple(f,i?1:0),S.visible.invalidList(),S.all.invalidList(),S._all.invalidList(),i||S.raw.invalidList(),A.size!==0&&(e?t.fireEvent("addNodes",{virtual:i,objects:a,nodes:A}):t.fireEvent("addEdges",{virtual:i,objects:a,edges:A})),A}var Vz=1,jz=2,Hz=3,$z=4,qz=5,Yz=6,xy="_visible",vy="_data",Od="_hovered",by="_hoverExtremityHighlighted",Ts="_selected",Ey="_selectionExtremityHighlighted",ti="_disabled",Gg="_dragged",H2="_rewirable",Na="_export",$2="_faded",q2="_transparent",Wz="_visual_groups",Ch=-1,Wc="in",Xc="out",Jm="both",eS=[Ts,Gg,Ey,Od,by,H2,Na,$2,q2,ti,Wz],Y2=2,W2=3,Xz=3,Zz=4,X2=-1,Z2=-1,Kz=["hover","zoom","panning","rotation","gesture","drag","selection","tooltip","user","interactions","resizing","rewiring","connectNodes","lasso"],sS=(t,e)=>(t+e)*(t+e+1)/2+e;function id(t,e){const s=t<e?t:e;return 67108864*s+(t+e-s)}var Qz=8,Sy=class{constructor(){this._BIG_LIST=255,this._MAX_LIST_SIZE=8,this._capacity=Qz,this._buffer=new Uint32Array(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._constList=new Array(this._MAX_LIST_SIZE)}addEntry(t){return t===void 0&&(t=this._nextIndex++),t>=this._capacity&&this._reserve(t+1),this._sizes[t]=0,t}get(t){const e=this._sizes[t],s=this._MAX_LIST_SIZE*t;if(e<=this._MAX_LIST_SIZE){this._constList.length=e;for(let n=0,i=e;n<i;++n)this._constList[n]=this._buffer[s+n];return this._constList}if(e===this._BIG_LIST){const n=this._buffer[s];return this._bigLists[n]}throw new Error(`Table: ${t} out of bounds (${e})`)}size(t){const e=this._sizes[t];return e<=this._MAX_LIST_SIZE?e:this._bigLists[this._buffer[t*this._MAX_LIST_SIZE]].length}sizes(t){const e=this._sizes,s=this._bigLists,n=this._buffer,i=this._MAX_LIST_SIZE,r=t.length,o=new Array(r);for(let a=0;a<r;a++){const l=t[a],u=e[l];o[a]=u<=i?u:s[n[l*i]].length}return o}addTo(t,e){const s=this._sizes[t],n=t*this._MAX_LIST_SIZE;if(s<this._MAX_LIST_SIZE)this._buffer[n+s]=e,this._sizes[t]=s+1;else if(s===this._BIG_LIST){const i=this._buffer[n];this._bigLists[i].push(e)}else{const i=new Array(this._MAX_LIST_SIZE);for(let r=0;r<this._MAX_LIST_SIZE;++r)i[r]=this._buffer[n+r];i.push(e),this._bigLists.push(i),this._sizes[t]=this._BIG_LIST,this._buffer[n]=this._bigLists.length-1}return this}removeFrom(t,e){return this.removeFromAndGetSize(t,e),this}removeFromAndGetSize(t,e){const s=this._MAX_LIST_SIZE*t;let n=this._sizes[t];if(n<=this._MAX_LIST_SIZE){for(let i=s,r=s+n;i<r;++i)if(this._buffer[i]===e)return n-=1,this._buffer[i]=this._buffer[r-1],this._sizes[t]=n,n}else if(n===this._BIG_LIST){const i=this._buffer[s],r=this._bigLists[i],o=r.indexOf(e);if(o!==-1)return r.splice(o,1),r.length}throw new Error('topology: Table: "removeFrom" failed, should not happen')}reserve(t){return this._capacity<t&&this._reserve(t),this}_reserve(t){this._capacity=Math.pow(2,Math.ceil(Math.log2(t))),this._buffer=nS(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=nS(this._sizes,this._capacity)}};function nS(t,e){const s=new t.constructor(e);return s.set(t),s}var Ll=void 0,Jz=class{constructor(t){this._neighborTable=new Sy,this._parallelTable=new Sy,this._parallelEdgesIndex=[],this._hasParallelEdges=new Set,this._fakeDeduper={get:()=>0,set:as,reset(){return this}},this._fakeInvertedDeduper={get:()=>1,set:as,reset(){return this}},this._graph=t,this.nodeDeduper=t.createNodeAttribute({storage:1},!1),this.edgeDeduper=t.createEdgeAttribute({storage:1},!1),this._sourceList=t.getEdgeAttribute("source"),this._targetList=t.getEdgeAttribute("target")}getAdjacentDirections(t){return this._neighborTable.get(t)}getEdgeIndexesInDirection(t){return this._parallelTable.get(t)}allocateNodes(t){this._neighborTable.reserve(t.length);for(let e=0;e<t.length;++e)this._neighborTable.addEntry(t[e])}allocateEdges(t,e,s){this._parallelTable.reserve(Math.floor(t.length/2));for(let n=0;n<t.length;n++){const i=t[n],r=e[n],o=s[n];this._sourceList.set(i,r),this._targetList.set(i,o),this.addToAdjacencyList(i)}}getExtremity(t,e){const s=t?this._sourceList:this._targetList;if(e.isList){const n=this._graph.acquireIndexList(!0);for(let i=0;i<e._indexes.length;i++)n.push(s.get(e._indexes[i]));return this._graph.nodeList(n.sliceAndReset())}return this._graph.getObjectList(!0).get(s.get(e._index))}setExtremities(t,e,s){for(let n=0;n<t.length;++n)this.removeFromAdjacencyList(t[n]);e!==null&&this._sourceList.setMultiple(t,e),s!==null&&this._targetList.setMultiple(t,s);for(let n=0;n<t.length;++n)this.addToAdjacencyList(t[n])}addToAdjacencyList(t){const e=this._sourceList.get(t),s=this._targetList.get(t),n=id(e,s);let i=this._parallelEdgesIndex[n];if(i===Ll)i=this._parallelTable.addEntry(),this._parallelEdgesIndex[n]=i,this._neighborTable.addTo(e,i),e!==s&&this._neighborTable.addTo(s,i);else{this._hasParallelEdges.add(t);const r=this._parallelTable.get(+i);if(r)for(const o of r)this._hasParallelEdges.add(o)}this._parallelTable.addTo(i,t)}hasParallelEdges(t){return this._hasParallelEdges.has(t)}removeFromAdjacencyList(t){const e=this._sourceList.get(t),s=this._targetList.get(t),n=id(e,s),i=this._parallelEdgesIndex[n];i!==Ll&&this._parallelTable.removeFromAndGetSize(i,t)===0&&(this._neighborTable.removeFrom(e,i),e!==s&&this._neighborTable.removeFrom(s,i),this._parallelEdgesIndex[n]=Ll,this._hasParallelEdges.delete(t))}getParallelEdges(t,e={}){const s=e.filter||"visible",n=this._graph.acquireIndexList(!1),i=this._graph.getFilter(!1,s);for(let r=0;r<t._indexes.length;r++){const o=t._indexes[r],a=id(this._sourceList.get(o),this._targetList.get(o)),l=this._parallelEdgesIndex[a];if(l!==Ll){const u=this._parallelTable.get(+l);if(u)for(const h of u)i(h)&&n.push(h)}}return this._graph.edgeList(n.sliceAndReset())}fastGetNodesAdjacentElements(t){const e=this._graph.acquireIndexList(!0),s=this._graph.acquireIndexList(!1),n=this._sourceList,i=this._targetList;for(let r=0;r<t.length;r++){const o=t[r],a=this._neighborTable.get(o);for(const l of a){const u=this._parallelTable.get(l),h=u[0],g=n.get(h),f=i.get(h);if(g!==0&&f!==0){e.push(g+f-o);for(const p of u)s.push(p)}}}return{nodes:this._graph.nodeList(e.sliceAndReset()),edges:this._graph.edgeList(s.sliceAndReset())}}fastGetEdgesAdjacentElements(t){const e=this._graph.acquireIndexList(!0),s=this._graph.acquireIndexList(!1),n=this._sourceList,i=this._targetList;for(let r=0;r<t.length;r++){const o=t[r],a=n.get(o),l=i.get(o),u=id(a,l),h=this._parallelEdgesIndex[u];if(h!==Ll){const g=this._parallelTable.get(+h);if(g)for(const f of g)s.push(f)}e.push(a),e.push(l)}return{nodes:this._graph.nodeList(e.sliceAndReset()),edges:this._graph.edgeList(s.sliceAndReset())}}getDeduper(t){return(t?this.nodeDeduper:this.edgeDeduper).reset()}collectAdjacentEdges(t,e,s,n=!1,i=!1){const r=e===Wc,o=!(e===Xc||r||i),a=this._graph.acquireIndexList(!1),l=this._graph.getFilter(!1,s),u=n?this.getDeduper(!1):this._fakeDeduper;let h=this._fakeInvertedDeduper;const g=this._sourceList,f=this._targetList;if(i){h=this.getDeduper(!0);for(let p=0;p<t.length;p++)h.set(t[p],1)}for(let p=0;p<t.length;p++){const y=t[p],_=this._neighborTable.get(y);for(const x of _){const v=this._parallelTable.get(x);if(o)for(const b of v)l(b)&&u.get(b)===0&&(a.push(b),u.set(b,1));else for(const b of v){const S=g.get(b),A=f.get(b),w=S+A-y;r!==(A===y)&&S!==A||!l(b)||u.get(b)!==0||h.get(w)!==1||(a.push(b),u.set(b,1))}}}return a.sliceAndReset()}collectAdjacentNodes(t,e,s,n=!1,i,r){const o=e!==Wc,a=e!==Xc,l=this._graph.acquireIndexList(!0),u=this._graph.getFilter(!1,s),h=n?this.getDeduper(!0):this._fakeDeduper,g=this._sourceList,f=this._targetList;if(i)for(let p=0;p<i.length;p++){const y=i[p];l.push(y),h.set(y,1)}if(r)for(let p=0;p<r.length;p++){const y=r[p];h.set(y,1)}for(let p=0;p<t.length;p++){const y=t[p],_=this._neighborTable.get(y);for(const x of _){const v=this._parallelTable.get(x);for(const b of v)if(u(b)){const S=g.get(b),A=f.get(b),w=S+A-y;if((a&&y===A||o&&y===S)&&h.get(w)===0){l.push(w),h.set(w,1);break}}}}return l.sliceAndReset()}getAdjacentElements(t,e,s={}){const n=s.direction||Jm,i=s.filter||"visible",r=s.policy||"union",o=!!s.bothExtremities;if(t){const a=r==="include-sources"?e:null,l=r==="exclude-sources"?e:null;return this.collectAdjacentNodes(e,n,i,!0,a,l)}return this.collectAdjacentEdges(e,n,i,!0,o)}getEdgesBetweenTwoNodes(t,e){const s=id(t,e),n=this._parallelEdgesIndex[s];if(n===Ll)return new Uint32Array;const i=this._parallelTable.get(+n);return new Uint32Array(i)}getConnectedComponents(t,{filter:e="visible",returnIds:s=!1,internalIndexes:n=!1}={}){const i=this._graph,r=[],o={},a=i.acquireIndexList(!0);let l;typeof e=="string"?l=i.getFilter(!0,e):(l=e,e="visible");for(let g=0;g<t.length;g++){const f=t[g];l(f)&&a.push(f)}const u=a.sliceAndReset(),h={filter:e};for(let g=0;g<u.length;g++){const f=u[g];if(!o[f]){const p=[f],y=[];for(;p.length!==0;){const _=p.pop();!o[_]&&l(_)&&(p.push.apply(p,this.getAdjacentElements(!0,new Uint32Array([_]),h)),o[_]=!0,y.push(_))}y.length>0&&r.push(y)}}if(s){const g=i.getNodeAttribute("id");for(let f=0;f<r.length;f++)r[f]=g.getMultiple(r[f])}else if(!n)for(let g=0;g<r.length;g++)r[g]=i.nodeList(new Uint32Array(r[g]));return r}getAdjacencyList({directed:t,ids:e,weight:s,nodes:n}){const i=t?Xc:Jm,r=new Array(n.length),o=this._graph;for(let y=0;y<n.length;++y)r[y]=this.collectAdjacentEdges(new Uint32Array([n[y]]),i,"all");const a=o.getEdgeAttribute("source"),l=o.getEdgeAttribute("target"),u=o.getEdgeAttribute("width"),h=o.getNodeAttribute("id"),g=[],f=typeof s=="number",p=typeof s!="function"&&!f&&!!s;for(let y=0;y<r.length;y++){const _=r[y],x=n[y],v=_.length,b=e?new Array(v):new Uint32Array(v),S=new Array(v);for(let w=0;w<v;w++){const L=_[w],M=a.get(L),F=l.get(L);let O=t||x===M?F:M;if(e&&(O=h.get(O)),b[w]=O,s){if(f&&(S[w]=s),typeof s=="function"){const G=o.getNode(M),j=o.getNode(F);S[w]=s(G,j)}p&&(S[w]=u.get(L)||1)}}const A={nodes:b,id:e?h.get(x):x,...s&&{weights:S}};g.push(A)}return g}degrees(t,e){if(e!==Wc&&e!==Xc)return this._neighborTable.sizes(t);const s=new Array(t.length),n=e===Wc;for(let i=0,r=t.length;i<r;i++)s[i]=this._degree(t[i],n);return s}_degree(t,e){const s=this._neighborTable.get(t),n=this._sourceList,i=this._targetList;let r=0;for(let o=0;o<s.length;++o){const a=this._parallelTable.get(s[o]);for(let l=0;l<a.length;++l){const u=a[l],h=n.get(u),g=i.get(u);if(e&&g===t||!e&&h===t){r+=1;break}}}return r}getDegree(t,e){const{direction:s,filter:n}=this._getDegreeOptions(e),i=new Array(t.length),r=new Uint32Array(1);for(let o=0;o<t.length;++o)r[0]=t[o],i[o]=this.collectAdjacentNodes(r,s,n).length;return i}_getDegreeOptions(t){const e={direction:Jm,filter:"visible"};return typeof t=="string"?e.direction=t:t&&(typeof t.direction=="string"&&(e.direction=t.direction),typeof t.filter=="string"&&(e.filter=t.filter)),e}},tD=class extends Xe{constructor(){super(...arguments),this.storage={nodes:new JE(!0),edges:new JE(!1),fetch(t){return t?this.nodes:this.edges}},this._promisesToResolve=[],this._nodeIndexLists=[],this._edgeIndexLists=[],this._onNewFrame=()=>{this.storage.nodes.freeIndexes(),this.storage.edges.freeIndexes()}}onMounted(){this._modules.events.register(["preAddElements","postAddElements","addNodes","addEdges","preAddGraph","postAddGraph","addGraph","excludedStateChange","clearGraph","afterRemoveNodes","beforeRemoveNodes","requestElementsToDelete","removeNodes","beforeRemoveEdges","afterRemoveEdges","removeEdges"]),[{name:"excluded",storage:1,default:1},{name:"removed",storage:1,default:1},{name:"virtual",storage:1,default:0}].forEach((t=>{this.createNodeAttribute(t,!0),this.createEdgeAttribute(t,!0)})),this.node=this._ogma.node,this.edge=this._ogma.edge,this.nodeList=this._ogma.nodeList,this.edgeList=this._ogma.edgeList,this._nodes=this.createAttribute(!0,{name:"object",storage:"any"},!0),this._edges=this.createAttribute(!1,{name:"object",storage:"any"},!0),this.createAttribute(!1,{name:"source",storage:32},!0),this.createAttribute(!1,{name:"target",storage:32},!0),this._nodeFilters=dE(this.storage.nodes),this._edgeFilters=dE(this.storage.edges),this._initialize(),this._modules.events.on("frame",this._onNewFrame)}onReady(t){if(t.graph){const{nodes:e,edges:s}=t.graph;e&&this.addNodes(e),s&&this.addEdges(s)}}createIndexList(t){return this.storage.fetch(t).createIndexList()}getDom(){return this._modules.dom}acquireIndexList(t){const e=t?this._nodeIndexLists:this._edgeIndexLists;let s=e.find((n=>!n.isBusy()));return s||(s=this.createIndexList(t),e.push(s)),s.markBusy(),s}getObjectList(t){return t?this._nodes:this._edges}getListFactory(t){return t?this.nodeList:this.edgeList}getStorage(t){return t?this.storage.nodes:this.storage.edges}getFilter(t,e){const s=t?this._nodeFilters:this._edgeFilters;return s[e]||s.visible}fireEvent(t,e){this._modules.events.fire(t,e)}getCacheLists(t){return t?this._nodeCacheLists:this._edgeCacheLists}_resolvePromises(){const t=this._promisesToResolve;this._promisesToResolve=[],t.forEach((e=>e()))}_initialize(){this._nodeCacheLists=hE((()=>this.getNodeMaxIndex()),(()=>this.acquireIndexList(!0)),this._nodeFilters),this._edgeCacheLists=hE((()=>this.getEdgeMaxIndex()),(()=>this.acquireIndexList(!1)),this._edgeFilters),this.topology=new Jz(this),this._resolvePromises()}getNodeMaxIndex(){return this.storage.nodes.getMaxIndex()}getEdgeMaxIndex(){return this.storage.edges.getMaxIndex()}isExcluded(t){return this.storage.fetch(t.isNode).getFlexArray("excluded").getMultiple(t._indexes)}setExcluded(t,e){const s=e?1:0,n=t.isNode,i=this.storage.fetch(n),r=i.getFlexArray("excluded"),o=i.getFlexArray("removed"),a=this.acquireIndexList(n),l=this.getListFactory(n);for(let h=0;h<t._indexes.length;h++){const g=t._indexes[h],f=r.get(g),p=o.get(g);s!==f&&p===0&&a.push(g)}const u=a.sliceAndReset();if(u.length){this.getCacheLists(t.isNode).visible.invalidList();const h=l(u);r.setMultiple(u,s),this._modules.events.fire("excludedStateChange",{elements:h,value:e})}}addNode(t,e){return tS(this,!0,t,e)}addEdge(t,e){return tS(this,!1,t,e)}addNodes(t,e){return _f(this,!0,t,e)}addEdges(t,e){return _f(this,!1,t,e)}addGraph(t,e){return Gz(this,t,e)}getExtremityIndex(t,e,s,n){if(e instanceof xi)return e._index;{const i=this.storage.nodes.getIndex(e);if(!i&&!n)throw new Error(`addEdge(s): invalid ${s===0?"source":"target"} for edge "${t}"; node "${e}" does not exist`);return i}}getNodes(t){return this.getElements(!0,t)}getEdges(t){return this.getElements(!1,t)}getElements(t,e){const s=t?this.nodeList:this.edgeList,n=t?uo:Ya,i=t?xi:Ir;if(e&&typeof e!="string"){const r=this.acquireIndexList(t),o=this.storage.fetch(t);if(e instanceof i)r.push(e._index);else if(Nn(e)){const a=e;for(const l of a)if(l instanceof i)r.push(l._index);else{const u=o.getIndex(l);u&&r.push(u)}}else if(e instanceof n){const a=this.getFilter(t,"all"),l=e;for(let u=0;u<l._indexes.length;u++){const h=l._indexes[u];a(h)&&r.push(h)}}return s(r.sliceAndReset())}{const r=e||"visible",o=this.getCacheLists(t)[r];if(!o)throw new Error(`getNodes/getEdges: unexpected argument "${r}"`);return s(o.getList())}}getNode(t){return this._getElement(!0,t)}getEdge(t){return this._getElement(!1,t)}_getElement(t,e){if(e instanceof(t?xi:Ir))return e;const s=this.getStorage(t),n=this.getObjectList(t),i=s.getIndex(e);return i?n.get(i):void 0}clear(){this._modules.events.fire("clearGraph",{nodes:this.getNodes("all"),edges:this.getEdges("all")}),this.storage.nodes.clear(),this.storage.edges.clear(),this._initialize()}createAttribute(t,e,s=!1){return this.storage.fetch(t).createFlexArray(e,s)}createNodeAttribute(t,e){return this.createAttribute(!0,t,e)}createEdgeAttribute(t,e){return this.createAttribute(!1,t,e)}getAttribute(t,e){return this.storage.fetch(t).getFlexArray(e)}getAttributes(t,e){return e.map((s=>this.getAttribute(t,s)))}getNodeAttribute(t){return this.storage.nodes.getFlexArray(t)}getNodeAttributes(t){return this.getAttributes(!0,t)}getEdgeAttribute(t){return this.storage.edges.getFlexArray(t)}getEdgeAttributes(t){return this.getAttributes(!1,t)}getAllNodeAttributes(){return this.storage.nodes.getAllFlexArrays()}getAllEdgeAttributes(){return this.storage.edges.getAllFlexArrays()}setSource(t,e){const s=this.getNode(e);s&&this.topology.setExtremities(t._indexes,s._indexes,null)}setTarget(t,e){const s=this.getNode(e);s&&this.topology.setExtremities(t._indexes,null,s._indexes)}getParallelEdges(t,e={}){return this.topology.getParallelEdges(t,e)}hasParallelEdges(t){return this.topology.hasParallelEdges(t._index)}getEdgesBetweenTwoNodes(t,e){return this.edgeList(this.topology.getEdgesBetweenTwoNodes(t._index,e._index))}getAdjacentDirections(t){return this.topology.getAdjacentDirections(t)}getEdgeIndexesInDirection(t){return this.topology.getEdgeIndexesInDirection(t)}fastGetNodesAdjacentElements(t){const e=this._ogma.getNodes();let s=!1;if(e.size===t.size){const n=new Set(t._indexes);for(let i=0;i<e.size;i++)n.delete(e._indexes[i]);s=n.size===0}return s?{nodes:e,edges:this._ogma.getEdges()}:this.topology.fastGetNodesAdjacentElements(t._indexes)}fastGetEdgesAdjacentElements(t){const e=this._ogma.getEdges();let s=!1;if(e.size===t.size){const n=new Set(t._indexes);for(let i=0;i<e.size;i++)n.delete(e._indexes[i]);s=n.size===0}return s?{nodes:this._ogma.getNodes(),edges:e}:this.topology.fastGetEdgesAdjacentElements(t._indexes)}getAdjacentNodes(t,e){return this.nodeList(this.topology.getAdjacentElements(!0,t._indexes,e))}getAdjacentEdges(t,e){return this.edgeList(this.topology.getAdjacentElements(!1,t._indexes,e))}getDegree(t,e){return this.topology.getDegree(t._indexes,e)}degrees(t,e){return this.topology.degrees(t,e)}getAdjacencyList({directed:t=!1,internalIndexes:e=!1,weight:s=1,nodes:n,indexes:i}={}){return this.topology.getAdjacencyList({directed:t,weight:s,ids:!e,nodes:i||this.getNodes(n)._indexes})}getConnectedComponents(t,e){return this.topology.getConnectedComponents(t._indexes,e)}getConnectedComponentByNode(t,e){return this.topology.getConnectedComponents(t._indexes,e)}},Qx=512,Jx=128,K2=Math.round(Math.log2(Qx)),t0=Math.round(Math.log2(Jx)),eD=K2+t0,Wl=255,sD=32767,Q2=65535,Zc=16384,Ay=15,Xl=3,yf=15,Vg=32,Uo=128,wy=8,Ty=1/16,Cy=Math.round(Math.sqrt(yf+1)),Ly=Uo*Cy,jn=16,Wo=1,or=256,nD=128,iD=128,xf=1.5,J2=1,cu=56,rD=16,oD=2*cu+rD,jg=6,tC=3,eC=3,_i=41,Qf=5,vf=5,sC=.9721,sh=24,aD=1.4142,lD=/^rgba?\((\d+),?\s*(\d+),?\s*(\d+),?\s*((\d+)?\.?\d+)*\)$/;function e0(t,e=[0,0,0,0]){const s=lD.exec(t);return s?(e[0]=parseInt(s[1])/255,e[1]=parseInt(s[2])/255,e[2]=parseInt(s[3])/255,e[3]=s[4]===void 0?1:parseFloat(s[4]),e):null}function Hg(t){return t<16?"0"+t.toString(16):t.toString(16)}function nC([t,e,s,n=1]){return`rgba(${256*t|0},${256*e|0},${256*s|0},${n})`}function s0(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((s,n,i,r)=>n+n+i+i+r+r));const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255,1]:null}var t_=["AliceBlue","#F0F8FF","AntiqueWhite","#FAEBD7","Aqua","#00FFFF","Aquamarine","#7FFFD4","Azure","#F0FFFF","Beige","#F5F5DC","Bisque","#FFE4C4","Black","#000000","BlanchedAlmond","#FFEBCD","Blue","#0000FF","BlueViolet","#8A2BE2","Brown","#A52A2A","BurlyWood","#DEB887","CadetBlue","#5F9EA0","Chartreuse","#7FFF00","Chocolate","#D2691E","Coral","#FF7F50","CornflowerBlue","#6495ED","Cornsilk","#FFF8DC","Crimson","#DC143C","Cyan","#00FFFF","DarkBlue","#00008B","DarkCyan","#008B8B","DarkGoldenRod","#B8860B","DarkGray","#A9A9A9","DarkGrey","#A9A9A9","DarkGreen","#006400","DarkKhaki","#BDB76B","DarkMagenta","#8B008B","DarkOliveGreen","#556B2F","DarkOrange","#FF8C00","DarkOrchid","#9932CC","DarkRed","#8B0000","DarkSalmon","#E9967A","DarkSeaGreen","#8FBC8F","DarkSlateBlue","#483D8B","DarkSlateGray","#2F4F4F","DarkSlateGrey","#2F4F4F","DarkTurquoise","#00CED1","DarkViolet","#9400D3","DeepPink","#FF1493","DeepSkyBlue","#00BFFF","DimGray","#696969","DimGrey","#696969","DodgerBlue","#1E90FF","FireBrick","#B22222","FloralWhite","#FFFAF0","ForestGreen","#228B22","Fuchsia","#FF00FF","Gainsboro","#DCDCDC","GhostWhite","#F8F8FF","Gold","#FFD700","GoldenRod","#DAA520","Gray","#808080","Grey","#808080","Green","#008000","GreenYellow","#ADFF2F","HoneyDew","#F0FFF0","HotPink","#FF69B4","IndianRed","#CD5C5C","Indigo","#4B0082","Ivory","#FFFFF0","Khaki","#F0E68C","Lavender","#E6E6FA","LavenderBlush","#FFF0F5","LawnGreen","#7CFC00","LemonChiffon","#FFFACD","LightBlue","#ADD8E6","LightCoral","#F08080","LightCyan","#E0FFFF","LightGoldenRodYellow","#FAFAD2","LightGray","#D3D3D3","LightGrey","#D3D3D3","LightGreen","#90EE90","LightPink","#FFB6C1","LightSalmon","#FFA07A","LightSeaGreen","#20B2AA","LightSkyBlue","#87CEFA","LightSlateGray","#778899","LightSlateGrey","#778899","LightSteelBlue","#B0C4DE","LightYellow","#FFFFE0","Lime","#00FF00","LimeGreen","#32CD32","Linen","#FAF0E6","Magenta","#FF00FF","Maroon","#800000","MediumAquaMarine","#66CDAA","MediumBlue","#0000CD","MediumOrchid","#BA55D3","MediumPurple","#9370DB","MediumSeaGreen","#3CB371","MediumSlateBlue","#7B68EE","MediumSpringGreen","#00FA9A","MediumTurquoise","#48D1CC","MediumVioletRed","#C71585","MidnightBlue","#191970","MintCream","#F5FFFA","MistyRose","#FFE4E1","Moccasin","#FFE4B5","NavajoWhite","#FFDEAD","Navy","#000080","OldLace","#FDF5E6","Olive","#808000","OliveDrab","#6B8E23","Orange","#FFA500","OrangeRed","#FF4500","Orchid","#DA70D6","PaleGoldenRod","#EEE8AA","PaleGreen","#98FB98","PaleTurquoise","#AFEEEE","PaleVioletRed","#DB7093","PapayaWhip","#FFEFD5","PeachPuff","#FFDAB9","Peru","#CD853F","Pink","#FFC0CB","Plum","#DDA0DD","PowderBlue","#B0E0E6","Purple","#800080","RebeccaPurple","#663399","Red","#FF0000","RosyBrown","#BC8F8F","RoyalBlue","#4169E1","SaddleBrown","#8B4513","Salmon","#FA8072","SandyBrown","#F4A460","SeaGreen","#2E8B57","SeaShell","#FFF5EE","Sienna","#A0522D","Silver","#C0C0C0","SkyBlue","#87CEEB","SlateBlue","#6A5ACD","SlateGray","#708090","SlateGrey","#708090","Snow","#FFFAFA","SpringGreen","#00FF7F","SteelBlue","#4682B4","Tan","#D2B48C","Teal","#008080","Thistle","#D8BFD8","Tomato","#FF6347","Turquoise","#40E0D0","Violet","#EE82EE","Wheat","#F5DEB3","White","#FFFFFF","WhiteSmoke","#F5F5F5","Yellow","#FFFF00","YellowGreen","#9ACD32"],rd=[0,0,0,0],nh=new Map;nh.set(null,[0,0,0,0]),nh.set("transparent",[0,0,0,0]);for(let t=0;t<t_.length;t+=2){const e=t_[t].toLowerCase(),s=t_[t+1];nh.set(e,s0(s))}var Yn=t=>{let e=nh.get(t);if(e===void 0){const s=t+"",n=s.charAt(0)==="#"?s0(s):e0(s);nh.set(t,n),e=n}return e},Ny=t=>{const e=Yn(t);if(!e)return null;const[s,n,i]=e;return`#${Hg(255*s)}${Hg(255*n)}${Hg(255*i)}`},Bl=t=>{let e=1,s=t;return s&&e0(t,rd)&&(s=`rgb(${255*+rd[0]},${255*+rd[1]},${255*+rd[2]})`,e=parseFloat(rd[3].toString())),{color:s,opacity:e}},Lh=class{on(e,s){if(typeof e!="string")throw new TypeError("Event name must be string");if(typeof s!="function")throw new TypeError("Event handler must be function");const n=this._events=this._events||{};return(n[e]=n[e]||[]).push(s),this}off(e,s){if(typeof e!="string")throw new TypeError("Event name must be string");const n=this._events=this._events||{},i=n[e];if(Nn(i))if(typeof s!="function")n[e]=null;else{const r=i.indexOf(s);r!==-1&&i.splice(r,1),i.length===0&&(n[e]=null)}return this}fire(e,...s){if(typeof e!="string")throw new TypeError("Event name must be string");const n=(this._events=this._events||{})[e];if(Nn(n)){const i=s;for(let r=0;r<n.length;r++){const o=n[r];o&&o.apply(this,i)}}return this}once(e,s){const n=this,i=function(...r){s.apply(n,r),n.off(e,i)};return i.handler=s,this.on(e,i)}hasListener(e,s){if(!e||!s)return!1;const n=(this._events=this._events||{})[e];if(Nn(n))for(let i=0,r=n.length;i<r;i++){const o=n[i];if(o===s||o.handler===s)return!0}return!1}clearEvents(){this._events={}}getListeners(e){return(this._events=this._events||{})[e]}};function iC(t){if(t.keys)return Array.from(t.keys());const e=[];return t.forEach(((s,n)=>e.push(n))),e}function rC(t){if(t.values)return Array.from(t.values());const e=[];return t.forEach((s=>e.push(s))),e}var oC=class{constructor(){this._map=new Map}reset(){this._map.clear()}set(t,e,s){this._map.set(sS(t,e),s)}get(t,e){return this._map.get(sS(t,e))}},uD=class{constructor({elementSize:t,sideElementSize:e,nbSideElementsPerMainElement:s,id:n,depth:i,elementType:r,animated:o,stencilUsage:a}){this._nbCellsAllocated=0,this._nbCellsFreed=0,this._isFullyAllocated=!1,this._isFullyFreed=!1,this._mustUpdate=!0,this._capacity=Qx,this.version=0,this._id=n,this.depth=i,this.type=r,this.animated=o,this.stencilUsage=a,this.elementSize=t,this._nbSideElementsPerMainElement=s,this._totalSideElementsSize=s*e,this._byteCapacity=this._capacity*this.elementSize,this._byteArray=new Uint8Array(this._byteCapacity),this._dataView=new DataView(this._byteArray.buffer),this._sideByteCapacity=this._capacity*this._totalSideElementsSize,this._sideByteArray=new Uint8Array(this._sideByteCapacity),this._sideDataView=new DataView(this._sideByteArray.buffer)}update(){this._mustUpdate&&(this.version+=1,this._mustUpdate=!1,this._isFullyAllocated&&this._nbCellsFreed===this._nbCellsAllocated&&(this._isFullyFreed=!0))}allocate(t){let e=-1;return!this._isFullyAllocated&&this._nbCellsAllocated+t<=this._capacity?(e=this._nbCellsAllocated,this._nbCellsAllocated+=t,this._mustUpdate=!0):this._isFullyAllocated=!0,e}free(t,e){for(let s=0;s<e;s++){const n=(t+s)*this.elementSize;this._dataView.setUint16(n,0)}this._mustUpdate=!0,this._nbCellsFreed+=e}triggerUpdate(){this._mustUpdate=!0}isEmpty(){return this._nbCellsFreed===this._nbCellsAllocated}isFullyFreed(){return this._isFullyFreed}getId(){return this._id}getDataView(){return this._dataView}getByteArray(){return this._byteArray}getSize(){return this._nbCellsAllocated}getNbSideElementsPerMainElement(){return this._nbSideElementsPerMainElement}hasSideData(){return this._nbSideElementsPerMainElement>0}getSideDataView(){return this._sideDataView}getSideByteArray(){return this._sideByteArray}getTotalSideElementsSize(){return this._totalSideElementsSize}},iS=8,dD=class{constructor(){this.version=0,this.version=0,this._blockInfo={buffer:null,offset:0,size:0,address:0},this._init_()}reset(){this._init_()}_init_(){this._buffersByDepth=new Array(100),this._buffersById=[],this._buffersByAscendingDepth=[],this._buffersByDescendingDepth=[],this._mustUpdate=!0}_fillBlockInfo(t,e,s,n){return this._blockInfo.buffer=t,this._blockInfo.offset=e,this._blockInfo.size=s,this._blockInfo.address=n,this._blockInfo}_createBuffer(t,e,s,n,i){const r=e?oD:cu,o=this._buffersById.length,a=new uD({elementSize:r,sideElementSize:jg,nbSideElementsPerMainElement:n,id:o,depth:s,elementType:t,animated:e,stencilUsage:i});return this._buffersById.push(a),a}getBlockInfo(t){return this._fillBlockInfo(this._buffersById[t>>eD],(t>>t0)%Qx,t%Jx,t)}allocateBlock(t,e,s,n,i,r,o){const a=cD(r,iS);this._mustUpdate=!0;let l=null,u=-1;if(t){const g=this.getBlockInfo(t),f=g.buffer,p=g.offset,y=g.size,_=g.size===i,x=f.depth===n,v=f.type===e,b=f.animated===s,S=f.getNbSideElementsPerMainElement()===a,A=f.stencilUsage===o;_&&x&&v&&b&&S&&A?(f.triggerUpdate(),l=f,u=p):f.free(p,y)}if(u===-1){const g=+s,f=a/iS,p=this._buffersByDepth[n]||Array(2);this._buffersByDepth[n]=p;const y=p[g]||[];p[g]=y;const _=y[e]||Array(16);y[e]=_;const x=_[f]||Array(4);_[f]=x;const v=x[o]||[];x[o]=v;const b=v[v.length-1];b&&(l=b,u=b.allocate(i)),u===-1&&(l=this._createBuffer(e,s,n,a,o),u=l.allocate(i),v.push(l))}const h=hD(l.getId(),u,i);return this._fillBlockInfo(l,u,i,h)}freeBlock(t){if(t){this._mustUpdate=!0;const e=this.getBlockInfo(t);e.buffer.free(e.offset,e.size)}return 0}_sortBuffersByDepth(){const t=[];for(let e=0;e<this._buffersByDepth.length;e++){const s=this._buffersByDepth[e];if(s)for(let n=0;n<s.length;n++){const i=s[n];if(i)for(let r=0;r<i.length;r++){const o=i[r];if(o)for(let a=0;a<o.length;a++){const l=o[a];if(l)for(let u=0;u<l.length;u++){const h=l[u];if(h)for(let g=0;g<h.length;g++){const f=h[g];f.update(),f.isFullyFreed()?(this._buffersById[f.getId()]=void 0,h.splice(g,1),g-=1):t.push(f)}}}}}}this._buffersByAscendingDepth=t,this._buffersByDescendingDepth=t.slice().reverse()}update(){this._mustUpdate&&(this._sortBuffersByDepth(),this.version+=1,this._mustUpdate=!1)}getBuffers(){return this._buffersById}getBuffersByAscendingDepth(){return this._buffersByAscendingDepth}getBuffersByDescendingDepth(){return this._buffersByDescendingDepth}};function hD(t,e,s){return((t<<K2)+e<<t0)+s}function cD(t,e){let s=0;for(;s<t;)s+=e;return s}var dr=1,za=2,bf=3,Wn=1,qo=2,Ma=3,Nh=4,Da=5,Oa=6,Xo=7,Xi=1,Jf=2,n0=3,i0=4,Aa=5,ka=6,su=1,aC=2,lC=3;function rS(){return{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:Wn,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,isBadge:!1,bentEnable:!1,bentVertical:!1}}function oS(t={}){return t.pieceId=0,t.shape="",t.x1=0,t.y1=0,t.x2=0,t.y2=0,t.rectWidthOrSourceRadiusScaled=0,t.rectWidthOrSourceRadiusFixed=0,t.rectHeightOrTargetRadiusScaled=0,t.rectHeightOrTargetRadiusFixed=0,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern=t.pattern||{type:Wn,attributes:{}},t.pattern.type=Wn,t.opacity=1,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=0,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isBodyTriangle=!1,t.isSelfLoop=!1,t.isText=!1,t.adjustTextAngle=!1,t.isBadge=!1,t.bentEnable=!1,t.bentVertical=!1,t}function gD(t={}){return t.duration=0,t.beginTime=-1,t.easing="linear",t}function r0(){return{valid:!1,id:void 0,end:rS(),start:rS(),animation:{duration:0,beginTime:-1,easing:"linear"}}}function uC(t,e,s,n){t.width=e*n,t.height=s*n,Ha(t,`${e}px`,`${s}px`)}function fD(t){return 1/(1+Math.exp(-t))}var pD=class{constructor(){this._capacity=Jx,this._id=0,this.size=0,this.depth=0,this.animated=!1,this.stencilUsage=su,this.type=dr,this._list=Array(this._capacity);for(let t=0;t<this._capacity;++t)this._list[t]=r0()}reset(t,e,s,n){return this.type=t,this.animated=e,this.depth=s,n!==void 0&&(this._id=n),this.stencilUsage=su,this.size=0,this}next(){if(this.size>=this._capacity)throw new Error("internal error: block.next() was called on a full block");return this._list[this.size++]}nextAndReset(){const t=this.next();return t.end=oS(t.end),t.start=oS(t.start),t.animation=gD(t.animation),t}forEach(t){this._list.forEach(t)}getElement(t){return this._list[t]}getCurrentElement(){return this._list[this.size-1]}getElements(){return this._list}getId(){return this._id}setGlobalAnimation(t,e,s){for(let n=0;n<this.size;++n){const i=this._list[n].animation;i.duration=t,i.beginTime=e,i.easing=s}}},mD=class{constructor(){this._version=0,this._initialize()}reset(){this._initialize()}_initialize(){this._mustUpdate=!0,this.maxCoord=0,this.maxScaledSize=0,this.maxMinVisibleSize=0,this.maxSymbolicSize=0,this.maxDashLength=0,this.maxGapLength=0,this.maxPatternScale=0}set({maxCoord:t,maxScaledSize:e,maxMinVisibleSize:s,maxSymbolicSize:n,maxDashLength:i,maxGapLength:r,maxPatternScale:o}){const a=this.maxCoord<t||this.maxScaledSize<e||this.maxMinVisibleSize<s||this.maxSymbolicSize<n||this.maxDashLength<i||this.maxGapLength<r||this.maxPatternScale<o;return a&&(this.maxCoord=t,this.maxScaledSize=e,this.maxMinVisibleSize=s,this.maxSymbolicSize=n,this.maxDashLength=i,this.maxGapLength=r,this.maxPatternScale=o,this._mustUpdate=!0),a}update(){return this._mustUpdate&&(this._version+=1,this._mustUpdate=!1),this}getVersion(){return this._version}},_D={linear:[0,1,0,0],quadraticIn:[0,0,1,0],quadraticOut:[0,2,-1,0],quadraticInOut:[0,0,2,0,-1,4,-2,0],cubicIn:[0,0,0,1],cubicOut:[0,3,-3,1],cubicInOut:[0,0,0,4,-3,12,-12,4]},yD=class{constructor(){this._linearEasing=[0,1,0,0,0,1,0,0],this._nameToPolygon={},this._polygonToName={},this.add(_D)}add(t){Object.keys(t).forEach((e=>{const s=t[e].slice();s.length<8&&(s[4]=s[0],s[5]=s[1],s[6]=s[2],s[7]=s[3]);const n=ty(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]);this._nameToPolygon[e]=s,this._polygonToName[n]=e}))}getCoefficients(t){return this._nameToPolygon[t]||this._linearEasing}getName(t,e,s,n,i,r,o,a){const l=ty(t,e,s,n,i,r,o,a);return this._polygonToName[l]||"linear"}},o0=new yD;function tp(t){return typeof t=="number"&&isFinite(t)}var xD=t=>{if(t===0)return 0;if(isNaN(t))return 32256;if(!isFinite(t))return t>0?31744:64512;const e=t<0?32768:0;if((t=Math.abs(t))<6103515625e-14)return e|Math.round(4096*t);if(t>65504)return 31744|e;let s=Math.floor(Math.log2(t)),n=Math.round(1024*(t/Math.pow(2,s)-1));return n===1024&&(n=0,s++),e|s+15<<10|n},aS=t=>{const e=32768&t?-1:1,s=t>>10&31,n=1023&t;return s===0?n===0?0*e:e*Math.pow(2,-14)*(n/1024):s===31?n?NaN:e*(1/0):e*Math.pow(2,s-15)*(1+n/1024)},vD=0,bD=1,ED=2,SD=3,AD=4,wD=5,TD=6,CD=7,LD=8,ND=9,ep=10,MD=0,dC=1,hC=2,a0=30,cC=0,kD=1,ID=2,l0=3,RD=4,FD=5,u0=6,sp=1e-6,qi=Math.PI,Bd=2*Math.PI,gC=qi*(5/4),fC=qi*(7/4),pC=qi*(3/4),mC=qi*(1/4),lS=1.1,uS=.07,PD=1,dS=1,hS=.17,zD=1,DD=-qi/2,OD=qi/2,BD={plain:{dash:0,gap:0},dashed:{dash:3,gap:1},dotted:{dash:1,gap:3}},UD={right:0,top:-Math.PI/2,left:Math.PI,bottom:Math.PI/2,center:0},GD={right:Math.PI,top:-Math.PI/2,left:0,bottom:Math.PI/2,center:0},Nl=8,VD=class{constructor(t,e,s,n,i){this._littleEndian=Bf(),this._maxScaledSize=0,this._maxMinVisibleSize=0,this._maxSymbolicSize=0,this._maxDashLength=0,this._maxGapLength=0,this._maxPatternScale=0,this._actualScaledSizeToBytes=sD,this._actualMinVisibleSizeToBytes=Ay,this._actualSymbolicSizeToBytes=Wl,this._actualDashLengthToBytes=Xl,this._actualGapLengthToBytes=Xl,this._actualPatternScaleToBytes=Wl,this._genericObject=r0(),this._shapeManager=e,this._patternManager=t,this._textManager=s,this._bufferOffsetToId=n,this._colorParser=i}resizeBoundaries(t,e,s,n,i,r){this._maxScaledSize=t,this._maxMinVisibleSize=e,this._maxSymbolicSize=s,this._maxDashLength=n,this._maxGapLength=i,this._maxPatternScale=r,this._actualScaledSizeToBytes=Q2/t,this._actualMinVisibleSizeToBytes=Ay/e,this._actualSymbolicSizeToBytes=Wl/s,this._actualDashLengthToBytes=Xl/n,this._actualGapLengthToBytes=Xl/i,this._actualPatternScaleToBytes=Wl/r}storeGenericObject(t,e,s){const n=this._shapeManager.getIdFromName(s.shape),i=s.pieceId,r=this._dashLengthToBytes(s.dashLength),o=this._gapLengthToBytes(s.gapLength),a=+s.hasHead,l=+s.hasTail,u=+s.isBodyTriangle,h=+s.isSelfLoop,g=this._patternScaleToBytes(s.patternScale),f=this._offsetAngleToBytes(s.offsetAngle),p=+s.isText,y=+s.adjustTextAngle,_=+s.isBadge,x=+s.bentEnable,v=+s.bentVertical,b=this._opacityToBytes(s.opacity),S=this._minVisibleSizeToBytes(s.globalMinVisibleSize),A=this._minVisibleSizeToBytes(s.strokeMinVisibleSize),w=this._minVisibleSizeToBytes(s.patternMinVisibleSize),L=this._symbolicSizeToBytes(s.symbolicSize),M=this._curvatureToBytes(s.curvature),F=s.pattern.attributes.colors;F&&(s.pattern.attributes.colors=F.split(";").map((ve=>Kc(this._colorToBytes(ve.trim())))).join(";"));const O=this._patternManager.getIdFromDefinition(s.pattern),G=this._colorToBytes(s.fillColor),j=this._colorToBytes(s.strokeColor),Z=this._colorToBytes(s.patternColor),{x1:at,y1:pt,x2:K,y2:ut}=s,ht=this._fixedSizeToBytes(s.rectWidthOrSourceRadiusFixed),nt=this._fixedSizeToBytes(s.rectHeightOrTargetRadiusFixed),ot=this._scaledSizeToBytes(s.thicknessOrFontSizeScaled),Mt=this._fixedSizeToBytes(s.thicknessOrFontSizeFixed),Q=this._scaledSizeToBytes(s.strokeWidthScaled),Et=this._fixedSizeToBytes(s.strokeWidthFixed),Xt=this._scaledSizeToBytes(s.offsetScaled),Ht=this._fixedSizeToBytes(s.offsetFixed),Zt=this._fixedSizeToBytes(s.pattern.attributes.paddingTop||0),ae=this._fixedSizeToBytes(s.pattern.attributes.paddingLeft||0),pe=n+(i<<4)+(r<<8)+(o<<10)+(a<<12)+(l<<13)+(u<<14)+(h<<15),ne=g+(f<<8)+(p<<11)+(y<<12)+(_<<13)+(x<<14)+(v<<15),te=b+(S<<4)+(A<<8)+(w<<12),se=L+(M<<8),ce=s.rectWidthOrSourceRadiusScaled/this._maxScaledSize*Zc,Ce=s.rectHeightOrTargetRadiusScaled/this._maxScaledSize*Zc;this._setUint16(t,e+0,pe),this._setUint16(t,e+2,ne),this._setUint16(t,e+4,te),this._setUint16(t,e+6,se),this._setUint16(t,e+8,O),this._setUint16(t,e+10,G),this._setUint16(t,e+12,j),this._setUint16(t,e+14,Z),this._setFloat32(t,e+16,at),this._setFloat32(t,e+20,pt),this._setFloat32(t,e+24,K),this._setFloat32(t,e+28,ut),this._setFloat16(t,e+32,ce),this._setUint16(t,e+34,ht),this._setFloat16(t,e+36,Ce),this._setUint16(t,e+38,nt),this._setUint16(t,e+40,ot),this._setUint16(t,e+42,Mt),this._setUint16(t,e+44,Q),this._setUint16(t,e+46,Et),this._setUint16(t,e+48,Xt),this._setInt16(t,e+50,Ht),this._setInt16(t,e+52,Zt),this._setInt16(t,e+54,ae)}_setUint16(t,e,s){t.setUint16(e,s,this._littleEndian)}_setFloat16(t,e,s){t.setUint16(e,xD(s),this._littleEndian)}_setInt16(t,e,s){t.setUint16(e,this._signedToUnsignedInt16(s),this._littleEndian)}_setFloat32(t,e,s){t.setFloat32(e,s,this._littleEndian)}_colorToBytes(t){const e=this._colorParser(t);return Math.round(15*e[0])+(Math.round(15*e[1])<<4)+(Math.round(15*e[2])<<8)+(Math.round(15*e[3])<<12)}_scaledSizeToBytes(t){return Math.ceil(Math.min(t,this._maxScaledSize)*this._actualScaledSizeToBytes)}_fixedSizeToBytes(t){return t}_minVisibleSizeToBytes(t){return Math.round(Math.min(t,this._maxMinVisibleSize)*this._actualMinVisibleSizeToBytes)}_symbolicSizeToBytes(t){return Math.round(Math.min(t,this._maxSymbolicSize)*this._actualSymbolicSizeToBytes)}_dashLengthToBytes(t){return Math.round(Math.min(t,this._maxDashLength)*this._actualDashLengthToBytes)}_gapLengthToBytes(t){return Math.round(Math.min(t,this._maxGapLength)*this._actualGapLengthToBytes)}_patternScaleToBytes(t){return Math.round(Math.min(t,this._maxPatternScale)*this._actualPatternScaleToBytes)}_offsetAngleToBytes(t){return Math.round((t+Bd)%Bd*(8/Bd))}_opacityToBytes(t){return Math.round(15*Math.min(t,1))}_curvatureToBytes(t){return this._signedToUnsignedByte(t)}_signedToUnsignedByte(t){return Wi(t,-128,127)+128}_signedToUnsignedInt16(t){return Wi(t,-32768,32767)+32768}storeAnimationInformation(t,e,{beginTime:s,duration:n},i){this._setAnimationBeginTime(t,e,s),this._setAnimationDuration(t,e,n),this._setAnimationEasing(t,e,i)}_setAnimationBeginTime(t,e,s){this._setFloat32(t,e,s)}_setAnimationDuration(t,e,s){this._setFloat32(t,e+4,s)}_setAnimationEasing(t,e,s){this._setUint16(t,e+8,(s[0]+128<<8)+(s[4]+128)),this._setUint16(t,e+10,(s[1]+128<<8)+(s[5]+128)),this._setUint16(t,e+12,(s[2]+128<<8)+(s[6]+128)),this._setUint16(t,e+14,(s[3]+128<<8)+(s[7]+128))}extractGenericElement(t,e,s){const n=t.type,i=t.animated,r=t.getDataView(),o=e*t.elementSize,a=this._genericObject;if(a.valid=!1,r.getUint16(o)&&(a.valid=!0,this._extractGenericObject(a.end,r,o,s),i&&(this._extractGenericObject(a.start,r,o+cu,s),this._extractAnimationInformation(a.animation,r,o+2*cu)),a.id=this._bufferOffsetToId.get(t.getId(),e),n===za)){const l=t.getSideDataView(),u=e*t.getTotalSideElementsSize(),h=u+t.getTotalSideElementsSize();a.end.pattern=this._textManager.extractTextFromDataView(l,u,h)}return a}_extractGenericObject(t,e,s,{bytesToActualCoord:n,bytesToActualScaledSize:i,bytesToActualMinVisibleSize:r,bytesToActualPatternScale:o,bytesToActualSymbolicSize:a,bytesToActualDashLength:l,bytesToActualGapLength:u}){const h=e,g=s,f=this._littleEndian,p=h.getUint16(g,f),y=Vs(p,0,4),_=Vs(p,4,8),x=Vs(p,8,10),v=Vs(p,10,12),b=Vs(p,12,13),S=Vs(p,13,14),A=Vs(p,14,15),w=Vs(p,15,16),L=h.getUint16(g+2,f),M=Vs(L,0,8),F=Vs(L,8,11),O=Vs(L,11,12),G=Vs(L,12,13),j=Vs(L,13,14),Z=Vs(L,14,15),at=Vs(L,15,16),pt=h.getUint16(g+4,f),K=Vs(pt,0,4),ut=Vs(pt,4,8),ht=Vs(pt,8,12),nt=Vs(pt,12,16),ot=h.getUint16(g+6,f),Mt=Vs(ot,0,8),Q=Vs(ot,8,16),Et=h.getUint16(g+8,f),Xt=h.getUint16(g+10,f),Ht=h.getUint16(g+12,f),Zt=h.getUint16(g+14,f),ae=h.getFloat32(g+16,f),pe=h.getFloat32(g+20,f),ne=h.getFloat32(g+24,f),te=h.getFloat32(g+28,f),se=h.getUint16(g+32,f),ce=h.getUint16(g+34,f),Ce=h.getUint16(g+36,f),ve=h.getUint16(g+38,f),Me=h.getUint16(g+40,f),ge=h.getUint16(g+42,f),ze=h.getUint16(g+44,f),is=h.getUint16(g+46,f),Ge=h.getUint16(g+48,f),De=e_(h.getUint16(g+50,f)),He=e_(h.getUint16(g+52,f)),Je=e_(h.getUint16(g+54,f));t.pieceId=_,t.shape=this._shapeManager.getNameFromId(y),t.x1=Sr(ae,n),t.y1=Sr(pe,n),t.x2=Sr(ne,n),t.y2=Sr(te,n),t.rectWidthOrSourceRadiusScaled=aS(se)*this._maxScaledSize/Zc,t.rectWidthOrSourceRadiusFixed=ce,t.rectHeightOrTargetRadiusScaled=aS(Ce)*this._maxScaledSize/Zc,t.rectHeightOrTargetRadiusFixed=ve,t.thicknessOrFontSizeScaled=Sr(Me,i),t.thicknessOrFontSizeFixed=ge,t.strokeWidthScaled=Sr(ze,i),t.strokeWidthFixed=is,t.offsetScaled=Sr(Ge,i),t.offsetFixed=De,t.pattern=this._patternManager.getDefinitionFromId(Et),t.pattern.attributes.paddingTop=He,t.pattern.attributes.paddingLeft=Je,t.opacity=K/15,t.fillColor=Kc(Xt),t.strokeColor=Kc(Ht),t.patternColor=Kc(Zt),t.globalMinVisibleSize=Sr(ut,r),t.strokeMinVisibleSize=Sr(ht,r),t.patternMinVisibleSize=Sr(nt,r),t.offsetAngle=F*(2*Math.PI/8),t.patternScale=M*o,t.symbolicSize=Mt*a,t.curvature=jD(Q),t.dashLength=x*l,t.gapLength=v*u,t.hasHead=!!b,t.hasTail=!!S,t.isBodyTriangle=!!A,t.isSelfLoop=!!w,t.isText=!!O,t.adjustTextAngle=!!G,t.isBadge=!!j,t.bentEnable=!!Z,t.bentVertical=!!at}_extractAnimationInformation(t,e,s){const n=this._littleEndian,i=e.getFloat32(s,n),r=e.getFloat32(s+4,n),o=e.getUint16(s+8,n),a=e.getUint16(s+10,n),l=e.getUint16(s+12,n),u=e.getUint16(s+14,n),h=(o>>8)-128,g=(a>>8)-128,f=(l>>8)-128,p=(u>>8)-128,y=o%256-128,_=a%256-128,x=l%256-128,v=u%256-128;t.beginTime=i,t.duration=r,t.easing=o0.getName(h,g,f,p,y,_,x,v)}};function Vs(t,e,s){return t%(1<<s)>>e}function jD(t){return t-128}function e_(t){return t-32768}function Sr(t,e){return t*e}var cS=new Array(65535);function Kc(t){let e=cS[t];if(!e){const s=Vs(t,0,4)/15,n=Vs(t,4,8)/15,i=Vs(t,8,12)/15,r=Vs(t,12,16)/15;e=`rgba(${255*s|0}, ${255*n|0}, ${255*i|0}, ${r})`,s+n+i+r===0&&(e=null),cS[t]=e}return e}var HD={[qo]:"image",[Nh]:"piechart",[Ma]:"text",[Da]:"icon",[Oa]:"badge"},$D=class{constructor(){this._pixelRatio=1,this._nextPatternId=1,this._version=0,this._init_()}reset(){this._init_()}_init_(){this._mustUpdate=!0,this._nextPatternId=1,this._patterns=[null],this._patternsByHash={},this._pixelRatio=1,this._nullPattern={id:-1,type:Wn,attributes:{}}}_increaseNextId(){let t=this._nextPatternId++;for(t%256==255&&(t=this._nextPatternId++);this._patterns.length<=t;)this._patterns.push(void 0);return t}_createPattern({type:t,attributes:e}){const s={id:this._increaseNextId(),type:t,attributes:this._getAttributes(t,e)};return this._patterns[s.id]=s,this._mustUpdate=!0,s}_getAttributes(t,e){return t===qo?{image:e.image,scaled:e.scaled,duplicated:e.duplicated}:t===Ma||t===Da||t===Oa?{font:e.font,size:e.size,style:e.style,text:e.text,paddingLeft:e.paddingLeft,paddingTop:e.paddingTop,align:e.align||"center",offset:e.offset||0}:t===Nh&&e.colors?{colors:e.colors,colorArray:e.colors.split(";").map((s=>s.trim()))}:{}}getPatternList(){return this._patterns.filter((t=>t))}update(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)}setPixelRatio(t){t!==this._pixelRatio&&(this._pixelRatio=t,this._mustUpdate=!0)}getPixelRatio(){return this._pixelRatio}notifyUpdate(){this._mustUpdate=!0}getIdFromDefinition(t){const{type:e,attributes:s}=t,n=e===Ma||e===Da||e===Oa;let i=0;return e&&e!==Wn&&e!==Xo&&(e!==qo||s.image)&&(!n||s.text&&s.font)&&(i=this._addPattern(t),e===Ma&&s.style==="normal"&&(s.style="bold",this._addPattern(t))),i}_addPattern(t){const e=this._getPatternHash(t);let s=this._patternsByHash[e];return s||(this._nextPatternId>65500?$o("maximum number of pattern exceeded"):(s=this._createPattern(t).id,this._patternsByHash[e]=s)),s}_getPatternHash({type:t,attributes:e}){const s=[HD[t]];return t===qo?s.push(e.scaled?"scaled":"non-scaled",e.duplicated?"duplicated":"non-duplicated",e.image.src||e.image.toDataURL()):t===Ma?s.push(e.text,e.font,e.style,e.size,e.align||"center",e.offset||0):t===Da||t===Oa?s.push(e.text,e.font,e.style,e.size,e.paddingLeft,e.paddingTop):s.push(e.colors),s.join("+")}getDefinitionFromId(t){if(t&&this._patterns[t]){const e=this._patterns[t];if(e)return e}return this._nullPattern}getVersion(){return this._version}};function gS(t){return t.map((({x:e,y:s,r:n=0})=>({x:e,y:s,r:n})))}var qD=class{constructor(){this._version=0,this._mustUpdate=!0,this._byName={},this._byId=new Array(yf+1)}register(t,{getDistanceFromStrokeVertically:e,getDistanceFromStrokeHorizontally:s,points:n,hole:i,isSimple:r}){if(this._byName[t])return;let o=r?1:wy;const a=r?wy-1:yf;for(;this._byId[o];)o+=1;if(o>a)throw new Error("max number of shape exceeded");const l={id:o,name:t,getDistanceFromStrokeVertically:e,getDistanceFromStrokeHorizontally:s,points:gS(n.slice()),hole:i?gS(i.slice()):null,isSimple:!!r};return this._mustUpdate=!0,this._byId[o]=l,this._byName[t]=l,l}updateShape(t,e){const s=this._byName[t];s&&(delete this._byId[s.id],delete this._byName[t],this.register(t,e))}getIdFromName(t){return this._byName[t].id}getNameFromId(t){const e=this._byId[t];return e?e.name:""}getDefinitionFromName(t){return this._byName[t]}update(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)}getVersion(){return this._version}getShapeList(){return this._byId.filter((t=>t))}},My=300,ky=150,_C=class{constructor(){this.style={},this.width=My,this.height=ky,this.__context=new yC,this.style={},this.width=My,this.height=ky}get __dummy(){return!0}get parentNode(){return null}getContext(t){return t==="2d"?this.__context:null}toDataURL(t="png"){return`data:image/${t};base64,`}addEventListener(){}removeEventListener(){}getBoundingClientRect(){return{left:0,top:0,bottom:0,right:0,width:this.width,height:this.height}}},yC=class{constructor(){this._fontSize=10}set font(t){const e=t.match(/\d+/);e&&(this._fontSize=parseFloat(e[0]))}set fillStyle(t){}set textBaseline(t){}set textAlign(t){}set strokeStyle(t){}set lineWidth(t){}fill(){}stroke(){}clearRect(){}fillRect(){}strokeRect(){}beginPath(){}closePath(){}moveTo(){}lineTo(){}rect(){}arc(){}save(){}restore(){}clip(){}translate(){}rotate(){}fillText(){}setLineDash(){}quadraticCurveTo(){}bezierCurveTo(){}drawImage(){}measureText(t){return{width:t.length*Math.ceil(.625*this._fontSize)}}getImageData(){return{width:0,height:0,data:new Uint8ClampedArray(0)}}},Qc=Yi("canvas")||Yi("canvas-prebuilt");function Pn(t=My,e=ky){if(ao){const n=document.createElement("canvas");return n.width=t,n.height=e,n}if(Qc){let n=null;return n="createCanvas"in Qc?Qc.createCanvas(t,e):new Qc(t,e),n.style={},n}const s=new _C;return s.width=t,s.height=e,s}function Iy(t,e,s=t.width,n=t.height){e.clearRect(0,0,s,n)}function Zo(t,e,s,n=""){t.font=`${n} ${s}px ${e}`}function xC(){return d0(Pn(),{},"webgl")!==null}var vC=t=>{const{canvas:e,width:s,height:n}={canvas:document.createElement("canvas"),width:window.innerWidth*devicePixelRatio,height:window.innerHeight*devicePixelRatio,...t};e.width=Math.ceil(s),e.height=Math.ceil(n),e.style.width=Math.ceil(s/devicePixelRatio)+"px",e.style.height=Math.ceil(n/devicePixelRatio)+"px";const i=e.getContext("webgl2",{antialias:!0});if(!i)throw new Error("WebGL 2.0 not supported");return i},bC=(t,e,s)=>{const n=vC();return n.canvas.addEventListener("webglcontextlost",s),{context:n,cleanUp:()=>{var i;n.canvas.removeEventListener("webglcontextlost",s),(i=n.getExtension("WEBGL_lose_context"))==null||i.loseContext()}}};function d0(t,e,s){let n=t.getContext(s,e);return n||(n=t.getContext("experimental-webgl",e)),n||null}function h0(t,e){if(e<2)return t;const s=t.split(`
`),n=[];for(let i=0;i<s.length;++i){const r=s[i];if(r.length<e)n.push(r);else{const o=EC(s[i],e);for(let a=0;a<o.length;++a)n.push(o[a])}}return n.join(`
`)}function EC(t,e){const s=[""],n=t.split(" ");for(let i=0;i<n.length;i++){const r=s[s.length-1],o=n[i];r.length+1+o.length<=e&&r.length?s[s.length-1]+=(r.length>0?" ":"")+o:s.push(o)}return s}function SC(t,e){if(t===null)return null;const s=(t=t.toString()).split(`
`),n=[];let i=0;for(let r=0;r<s.length;r++){let o=s[r];if(!e||e<=1||o.length<e)n.push(o),i=Math.max(i,o.length);else{const a=EC(s[r],e);for(let l=0;l<a.length;l++)o=a[l],n.push(o),i=Math.max(i,o.length)}}return{data:n,maxLength:i,lines:n.length}}function AC(){const t=Yi("@mapbox/mapbox-gl-rtl-text")||Yi("mapbox-gl-rtl-text"),e=t?t.processBidirectionalText:Yo?window.processBidirectionalText:null,s=t?t.applyArabicShaping:Yo?window.applyArabicShaping:null;return{processBidirectionalText:e?n=>{if(n===null||n==null)return"";const i=[];let r=0,o="";const a=n.split(`
`),l=[],u=[];for(let p=0;p<a.length;p++)a[p].length>0&&l.push(p);for(let p=0;p<l.length;p++){const y=l[p],_=(p<l.length-1?l[p+1]:a.length)-y-1;u.push(_)}const h=l.map((p=>a[p]));for(let p=0;p<h.length;p++){const y=h[p],_=y.length+r;_>0&&p<h.length-1&&i.push(_),o+=p>0?""+y:y,r+=y.length}const g=e(o,i);let f="";for(let p=0;p<g.length;p++)if(f+=g[p],p<g.length-1){const y=u[p]||0;f+=`
`.repeat(1+y)}return f}:n=>n,applyArabicShaping:s?n=>n==null?null:typeof n=="number"?n.toString():s(n):n=>n==null?null:n.toString()}}var s_=Bf(),Jc=10,YD=1<<17,WD=65536,XD=256,fS=128,ZD=25,wC=1e3,Ry=2,TC=["100","200","300","400","500","600","700","800","900","none","bold","italic","normal","italic bold","bold italic","100 italic","200 italic","300 italic","400 italic","500 italic","600 italic","700 italic","800 italic","900 italic"],pS=()=>{const t={};for(const e of TC)t[e]={};return t},KD=class{constructor(t){this._widthAtlases=pS(),this._patternManager=t,this._canvas=Pn(),this._ctx=this._canvas.getContext("2d",{willReadFrequently:!0}),this._processBidirectionalText=AC().processBidirectionalText,this._cornerRadius=0,this._version=0,this._textPattern={id:0,type:Xo,attributes:{text:"",font:"",size:0,style:"normal",align:"center"},dimensions:{width:0,height:0}},this._textDimensions={width:0,height:0},this._lineWidthList=new Array(64),this._init()}_init(){this._mustClear=!1,this._clear()}reset(){this._init()}clear(){this._mustClear=!0}_measureChar(t,e,s){return Zo(this._ctx,e,sh,s),this._ctx.measureText(t).width/sh}_getAtlas(t,e,s,n){const i=s===Ch?0:s,r=this._byFont[t]||(this._byFont[t]=TC.reduce(((l,u)=>(l[u]=void 0,l)),{})),o=r[n]||(r[n]={}),a=o[e]||(o[e]=new Array(50));return a[i]||(a[i]=new Array(256))}_getMeasurementAtlas(t,e){const s=this._widthAtlases[e];return s[t]||(s[t]=new Array(256))}measureText(t,e,s,n=1){if(!e||t===null)return this._textDimensions.width=0,this._textDimensions.height=0,this._textDimensions;const i=this._getMeasurementAtlas(e,s);let r=0,o=0,a=1;for(let l=0;l<t.length;++l){const u=t.charCodeAt(l);if(u===Jc)o>r&&(r=o),o=0,a+=1;else{let h=i[u];h===void 0&&(h=this._measureChar(t[l],e,s),i[u]=h),o+=h}}return o>r&&(r=o),this._textDimensions.width=r*n,this._textDimensions.height=a*n,this._textDimensions}_getCharInfo(t,e,s,n,i,r){let o=t[e];if(!o){const a=String.fromCharCode(e);o={ratio:this._measureChar(a,s,n),patternId:0},o.patternId=this._patternManager.getIdFromDefinition({id:0,type:Ma,attributes:{text:a,font:s,style:n,size:i,align:r}}),t[e]=o}return o}storeTextInDataView(t,e,s,n){let i=e;if(n&&n.type===Xo){const{font:r,style:o,size:a,align:l}=n.attributes,u=l==="center",h=this._getAtlas(r,o,a,l);let g=0,f=1,p=0,y=0;const _=this._lineWidthList,x=this._processBidirectionalText(n.attributes.text);for(let A=0;A<x.length;++A){const w=x.charCodeAt(A);w===Jc?(p>g&&(g=p),_[y]=p,y++,p=0,f++):p+=this._getCharInfo(h,w,r,o,a,l).ratio}_[y]=p,p>g&&(g=p),y=0;let v=-(u?_[y]:g)/2,b=(1-f)/2,S=0;for(let A=0;A<x.length;++A){const w=x.charCodeAt(A),L=h[w];if(w===Jc)y+=1,v=-(u?_[y]:g)/2,b+=A===0?.5:1,S=0;else{const M=L.ratio,F=L.patternId;v+=(M+S)/2,S=M;const O=(Wi(v*wC+WD,0,YD-1)<<8)+Wi(b*Ry+fS,0,XD-1);t.setUint16(i,F,s_),t.setUint32(i+2,O,s_),i+=jg}}}this._fillWithZeros(t,i,s)}extractTextFromDataView(t,e,s){const n=t,i=s_,r=n.getUint16(e,i),o=this._textPattern,a=this._patternManager.getDefinitionFromId(r),{font:l,style:u,size:h,align:g}=a.attributes,f=this._getAtlas(l,u,h,g),p=[];let y=0,_=0,x=0,v=null,b=null,S=null;for(let w=e;w<s;w+=jg){const L=n.getUint16(w,i);if(!L)break;const M=(n.getUint8(w+2)-fS)/Ry,F=this._patternManager.getDefinitionFromId(L);if(!F||!F.attributes||!F.attributes.text)break;const O=F.attributes.text.charCodeAt(0),G=f[O];if(v===null)v=M,b=M;else if(M>v){y>_&&(_=y),y=0;const j=M-v;for(let Z=0;Z<j;Z++)x+=1,p.push(Jc);v=M}S=M,p.push(O),G&&(y+=G.ratio)}y>_&&(_=y);let A=String.fromCharCode.apply(null,p);if(b!==null&&S!==null&&x>0){const w=x+1,L=(w-1)/2,M=b-(1-w)/2;let F=0;M>.25&&(F=Math.round(2*M));const O=L-S;let G=0;O>.25&&(G=Math.round(O)),F>0&&(A=`
`.repeat(F)+A,x+=F),G>0&&(A+=`
`.repeat(G),x+=G)}return o.attributes.style=u,o.attributes.font=l,o.attributes.size=h,o.attributes.align=g,o.attributes.text=A,o.dimensions&&(o.dimensions.width=_,o.dimensions.height=x),o}_fillWithZeros(t,e,s){for(let n=e;n<s;n+=jg)t.setUint16(n,0)}_clear(){this._byFont={},this._widthAtlases=pS()}update(){this._mustClear&&(this._clear(),this._mustClear=!1)}getVersion(){return this._version}getCornerRadius(){return this._cornerRadius}setCornerRadius(t){t!==this._cornerRadius&&(this._cornerRadius=t,this._version++)}},c0=()=>({minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),ri=class Ul{constructor(e={}){const{xValues:s=[],yValues:n=[],scaledSizeValues:i=[],fixedSizeValues:r=[]}=e;this.minX=Qr(s),this.minY=Qr(n),this.maxX=ql(s),this.maxY=ql(n),this.minScaledSize=Qr(i),this.maxScaledSize=ql(i),this.minFixedSize=Qr(r),this.maxFixedSize=ql(r),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY}reset(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.minScaledSize=1/0,this.maxScaledSize=-1/0,this.minFixedSize=1/0,this.maxFixedSize=-1/0,this.width=0,this.height=0,this.cx=0,this.cy=0,this}addPoint(e,s,n,i){if(!isFinite(e)||!isFinite(s))return this;this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,s),n!==void 0&&i!==void 0&&(i==="scaled"?(this.minScaledSize=Math.min(this.minScaledSize,n),this.maxScaledSize=Math.max(this.maxScaledSize,n)):(this.minFixedSize=Math.min(this.minFixedSize,n),this.maxFixedSize=Math.max(this.maxFixedSize,n)));const r=this.maxX-this.minX,o=this.maxY-this.minY;return this.cx=this.minX+r/2,this.cy=this.minY+o/2,this.width=r,this.height=o,this}computeForZoom(e){const s=Math.max(this.maxScaledSize,this.maxFixedSize/e);return Ul.from({minX:this.minX-s/2,minY:this.minY-s/2,maxX:this.maxX+s/2,maxY:this.maxY+s/2,width:this.width+s,height:this.height+s})}static from({minX:e,minY:s,maxX:n,maxY:i,width:r,height:o}={}){const a=new Ul;return e!=null&&(a.minX=e),s!=null&&(a.minY=s),n!=null&&(a.maxX=n),i!=null&&(a.maxY=i),n!=null&&e!=null&&(a.width=r||Math.abs(n-e),a.cx=(e+n)/2),i!=null&&s!=null&&(a.height=o||Math.abs(i-s),a.cy=(s+i)/2),a.maxScaledSize=a.minScaledSize=0,a}static fromValues(e,s,n){let i=1/0,r=1/0,o=-1/0,a=-1/0,l=-1/0;for(let h=0;h<e.length;h++){const g=e[h],f=s[h],p=n[h];g-p<i&&(i=g-p),f-p<r&&(r=f-p),g+p>o&&(o=g+p),f+p>a&&(a=f+p),p>l&&(l=p)}const u=Ul.from({minX:i,minY:r,maxX:o,maxY:a});return u.maxScaledSize=l,u}pad(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,this.width+=2*e,this.height+=2*e,this}isValid(){return isFinite(this.width)&&isFinite(this.height)}extend(e){let s,n,i,r;return e instanceof Ul?(s=e.minX,n=e.minY,i=e.maxX,r=e.maxY):Array.isArray(e)&&(s=e[0],n=e[1],i=e[2],r=e[3]),this.addPoint(s,n).addPoint(i,r)}bottomLeft(){return{x:this.minX,y:this.minY}}topRight(){return{x:this.maxX,y:this.maxY}}center(){return{x:this.cx,y:this.cy}}clone(){const e=new Ul;return e.minX=this.minX,e.minY=this.minY,e.maxX=this.maxX,e.maxY=this.maxY,e.minScaledSize=this.minScaledSize,e.maxScaledSize=this.maxScaledSize,e.minFixedSize=this.minFixedSize,e.maxFixedSize=this.maxFixedSize,e.cx=this.cx,e.cy=this.cy,e.width=this.width,e.height=this.height,e}},QD=1e-6,JD=1e-12;function CC(){for(var t=arguments,e=t.length-1,s=e,n=[],i=0;i<=e&&Math.abs(t[i])<=JD;i++)e--;switch(e){case 1:tO(t[s],t[s-1],n);break;case 2:eO(t[s],t[s-1],t[s-2],n);break;case 3:sO(t[s],t[s-1],t[s-2],t[s-3],n)}return n}function tO(t,e,s=[]){return e!==0&&s.push(-t/e),s}function eO(t,e,s,n=[]){var i=e/s,r=i*i-4*(t/s);if(r>0){var o=Math.sqrt(r);n.push(.5*(-i+o)),n.push(.5*(-i-o))}else r===0&&n.push(.5*-i);return n}function sO(t,e,s,n,i=[]){var r,o,a=s/n,l=e/n,u=(3*l-a*a)/3,h=(2*a*a*a-9*l*a+27*(t/n))/27,g=a/3,f=h*h/4+u*u*u/27,p=h/2;if(Math.abs(f)<=QD&&(f=0),f>0){var y=Math.sqrt(f);o=(r=-p+y)>=0?Math.pow(r,1/3):-Math.pow(-r,1/3),(r=-p-y)>=0?o+=Math.pow(r,1/3):o-=Math.pow(-r,1/3),i.push(o-g)}else if(f<0){var _=Math.sqrt(-u/3),x=Math.atan2(Math.sqrt(-f),-p)/3,v=Math.cos(x),b=Math.sin(x),S=Math.sqrt(3);i.push(2*_*v-g),i.push(-_*(v+S*b)-g),i.push(-_*(v-S*b)-g)}else r=p>=0?-Math.pow(p,1/3):Math.pow(-p,1/3),i.push(2*r-g),i.push(-r-g);return i}function Ro(t,e,s,n,i,r,o,a,l,u,h){for(var g,f,p=Math.min(o,l),y=Math.min(a,u),_=Math.max(o,l),x=Math.max(a,u),v=CC((g=a-u)*(t+-2*s+i)+(f=l-o)*(e+-2*n+r),g*(-2*t+2*s)+f*(-2*e+2*n),g*t+f*e+(o*u-l*a)),b=0;b<v.length;b++){var S=v[b];if(0<=S&&S<=1){var A=t+(s-t)*S,w=e+(n-e)*S,L=A+(s+(i-s)*S-A)*S,M=w+(n+(r-n)*S-w)*S;if(o===l){if(y<=M&&M<=x){if(!h)return 1;h.push(L,M)}}else if(a===u){if(p<=L&&L<=_){if(!h)return 1;h.push(L,M)}}else if(L>=p&&M>=y&&L<=_&&M<=x){if(!h)return 1;h.push(L,M)}}}return h?h.length/2:0}function LC(t,e,s,n,i,r,o,a,l,u,h){return h?(Ro(t,e,s,n,i,r,o,a,l,a,h),Ro(t,e,s,n,i,r,l,a,l,u,h),Ro(t,e,s,n,i,r,o,u,l,u,h),Ro(t,e,s,n,i,r,o,a,o,u,h),h.length/2):o<=t&&l>=t&&a<=e&&u>=e||o<=i&&l>=i&&a<=r&&u>=r||Ro(t,e,s,n,i,r,o,a,l,a)||Ro(t,e,s,n,i,r,l,a,l,u)||Ro(t,e,s,n,i,r,o,u,l,u)||Ro(t,e,s,n,i,r,o,a,o,u)?1:0}function Fo(t,e,s,n,i,r,o,a,l,u,h,g,f){for(var p,y,_=Math.min(l,h),x=Math.min(u,g),v=Math.max(l,h),b=Math.max(u,g),S=CC((p=u-g)*(-1*t+3*s+-3*i+o)+(y=h-l)*(-1*e+3*n+-3*r+a),p*(3*t+-6*s+3*i)+y*(3*e+-6*n+3*r),p*(-3*t+3*s)+y*(-3*e+3*n),p*t+y*e+(l*g-h*u)),A=0;A<S.length;A++){var w=S[A];if(0<=w&&w<=1){var L=t+(s-t)*w,M=e+(n-e)*w,F=s+(i-s)*w,O=n+(r-n)*w,G=L+(F-L)*w,j=M+(O-M)*w,Z=G+(F+(i+(o-i)*w-F)*w-G)*w,at=j+(O+(r+(a-r)*w-O)*w-j)*w;if(l===h){if(x<=at&&at<=b){if(!f)return 1;f.push(Z,at)}}else if(u===g){if(_<=Z&&Z<=v){if(!f)return 1;f.push(Z,at)}}else if(Z>=_&&at>=x&&Z<=v&&at<=b){if(!f)return 1;f.push(Z,at)}}}return f?f.length/2:0}function Fy(t,e,s,n,i,r,o,a,l,u,h,g,f){return f?(Fo(t,e,s,n,i,r,o,a,l,u,h,u,f),Fo(t,e,s,n,i,r,o,a,h,u,h,g,f),Fo(t,e,s,n,i,r,o,a,l,g,h,g,f),Fo(t,e,s,n,i,r,o,a,l,u,l,g,f),f.length/2):l<=t&&h>=t&&u<=e&&g>=e||l<=o&&h>=o&&u<=a&&g>=a||Fo(t,e,s,n,i,r,o,a,l,u,h,u)||Fo(t,e,s,n,i,r,o,a,h,u,h,g)||Fo(t,e,s,n,i,r,o,a,l,g,h,g)||Fo(t,e,s,n,i,r,o,a,l,u,l,g)?1:0}function mS(t,e,s,n,i){const r=1-i;return r*r*r*t+3*i*r*r*e+3*i*i*r*s+i*i*i*n}function Zl(t,e,s,n){const i=1-n;return i*i*t+2*i*n*e+n*n*s}var nO=(t,e)=>2/(1+Math.exp(-Math.abs(t*e))),iO=5,_S=5;function np(t,e,s,n,i,r){const o=r||{x1:0,y1:0,x2:0,y2:0},a=(n+n/_S*s)*_S,l=-i+Math.PI,u=-i+Math.PI/2;return o.x1=t+Math.cos(l)*a,o.y1=e+Math.sin(l)*a,o.x2=t+Math.cos(u)*a,o.y2=e+Math.sin(u)*a,o}function ip(t,e,s,n,i,r,o,a){const l=a||{x1:0,y1:0,x2:0,y2:0};if(r){const u=fD(i);if(o){const h=u*e+(1-u)*n;l.x1=t,l.y1=h,l.x2=s,l.y2=h}else{const h=u*t+(1-u)*s;l.x1=h,l.y1=e,l.x2=h,l.y2=n}}else l.x1=t,l.y1=e,l.x2=s,l.y2=n;return l}function Wa(t,e,s,n,i,r){const o=r||{x:0,y:0},a=(t+s)/2,l=(e+n)/2,u=t-s,h=e-n,g=Math.sqrt(u*u+h*h);if(g===0)return o.x=a,o.y=l,o;const f=h/g,p=-u/g,y=-g*i/iO;return o.x=a+f*y,o.y=l+p*y,o}function rp(t,e,s,n,i,r,o,a={x:0,y:0}){return a.x=(1-t)*(1-t)*e+2*(1-t)*t*r+t*t*n,a.y=(1-t)*(1-t)*s+2*(1-t)*t*o+t*t*i,a}function g0(t,e,s,n,i,r,o,a={x:0,y:0}){return a.x=(2*t-2)*e+(2*n-4*r)*t+2*r,a.y=(2*t-2)*s+(2*i-4*o)*t+2*o,w2(a)}function NC(t,e,s,n,i,r,o,a={x:0,y:0}){return g0(t,e,s,n,i,r,s,a),gf(a.x,a.y,0,0,Math.PI/2,a),a}function MC(t,e,s,n,i,r,o,a,l,u=0,h=!1){const g=s-2*o+i,f=n-2*a+r,p=-((s-t)*f-(n-e)*g)/((2*o-2*s)*f-(2*a-2*n)*g);if(p<0||p>1)return!1;let y=l/2;h&&(y*=1-p),y+=u;const _=Zl(s,o,i,p),x=Zl(n,a,r,p);return _n(_,x,t,e)<=y}function rO(t,e){const s=t.getAttribute("curvature"),[n,i]=t.getExtremities().getAttributes(["x","y"]),r=Wa(n.x,n.y,i.x,i.y,s);return rp(e,n.x,n.y,i.x,i.y,r.x,r.y)}function oO(t,e){const s=t.getAttribute("curvature"),[n,i]=t.getExtremities().getAttributes(["x","y"]),r=Wa(n.x,n.y,i.x,i.y,s);return NC(e,n.x,n.y,i.x,i.y,r.x,r.y)}function aO(t,e){const s=t.getAttribute("curvature"),[n,i]=t.getExtremities().getAttributes(["x","y"]),r=Wa(n.x,n.y,i.x,i.y,s);return g0(e,n.x,n.y,i.x,i.y,r.x,r.y)}function ih(t,e,s,n,i,r,o,a,l,u={x:0,y:0}){const h=(1-t)*(1-t)*(1-t),g=3*t*(1-t)*(1-t),f=3*t*t*(1-t),p=t*t*t;return u.x=h*e+g*r+f*a+p*n,u.y=h*s+g*o+f*l+p*i,u}function Py(t,e,s,n,i,r,o,a,l,u,h,g){let f=.5,p=_n(t,e,s,n)<_n(t,e,i,r)?-.01:.01,y=100;const _=ih(f,s,n,i,r,o,a,l,u);let x,v=_n(t,e,_.x,_.y);const b=h/2+g;for(;y-- >0&&f>=0&&f<=1&&v>b&&(p>.001||p<-.001);)x=v,ih(f,s,n,i,r,o,a,l,u,_),v=_n(t,e,_.x,_.y),v>x?(p=-p/2,f+=p):f+p<0||f+p>1?(p/=2,v=x):f+=p;return v<b}function f0(t,e,s,n,i,r,o=c0()){const a=t+.6666666666666666*(s-t),l=e+2/3*(n-e);return op(t,e,a,l,a+1/3*(i-t),l+1/3*(r-e),i,r,o)}function op(t,e,s,n,i,r,o,a,l=c0()){const{min:u,max:h,sqrt:g}=Math;let f,p,y,_,x;l.minX=u(t,o),l.maxX=h(t,o),l.minY=u(e,a),l.maxY=h(e,a);for(let v,b,S,A,w,L,M,F=0;F<2;++F)if(F===0?(p=t,y=s,_=i,x=o):(p=e,y=n,_=r,x=a),b=6*p-12*y+6*_,v=-3*p+9*y-9*_+3*x,S=3*y-3*p,b|=0,v|=0,S|=0,v!==0)w=b*b-4*S*v,w<0||(L=(-b+g(w))/(2*v),L>0&&L<1&&(f=n_(L,p,y,_,x),F===0?(l.minX=u(l.minX,f),l.maxX=h(l.maxX,f)):(l.minY=u(l.minY,f),l.maxY=h(l.maxY,f))),M=(-b-g(w))/(2*v),M>0&&M<1&&(f=n_(M,p,y,_,x),F===0?(l.minX=u(l.minX,f),l.maxX=h(l.maxX,f)):(l.minY=u(l.minY,f),l.maxY=h(l.maxY,f))));else{if(b===0)continue;A=-S/b,A>0&&A<1&&(f=n_(A,p,y,_,x),F===0?(l.minX=u(l.minX,f),l.maxX=h(l.maxX,f)):(l.minY=u(l.minY,f),l.maxY=h(l.maxY,f)))}return l}function n_(t,e,s,n,i){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*s+3*(1-t)*Math.pow(t,2)*n+Math.pow(t,3)*i}function lO(t,e,s,n,i,r){const o=t-2*s+i,a=e-2*n+r,l=2*s-2*t,u=2*n-2*e,h=4*(o*o+a*a),g=4*(o*l+a*u),f=l*l+u*u,p=2*Math.sqrt(h+g+f),y=Math.sqrt(h),_=2*h*y,x=2*Math.sqrt(f),v=g/y;return(_*p+y*g*(p-x)+(4*f*h-g*g)*Math.log((2*y+v+p)/(v+x)))/(4*_)}var so,ro=(so=class extends Lh{constructor({bufferList:e,patternManager:s,boundariesManager:n,shapeManager:i,textManager:r,memoryManager:o}){super(),this._firstFrame=!0,this._width=0,this._height=0,this._pixelRatio=0,this._viewX=0,this._viewY=0,this._viewZoom=0,this._viewAngle=0,this._viewAngleCos=0,this._viewAngleSin=0,this._currentTime=0,this._scales={bytesToActualCoord:0,bytesToActualScaledSize:0,bytesToActualMinVisibleSize:0,bytesToActualSymbolicSize:0,bytesToActualDashLength:0,bytesToActualGapLength:0,bytesToActualPatternScale:0},this._shapesVersion=0,this._patternsVersion=0,this._boundariesVersion=0,this._textsVersion=0,this._backgroundRgba=[1,1,1,0],this._renderBackground=!1,this._hideImages=!1,this._genericObject=r0(),this._littleEndian=Bf(),this._bufferList=e,this._shapeManager=i,this._patternManager=s,this._boundariesManager=n,this._textManager=r,this._memoryManager=o}static createInitData(){return null}static getName(){return null}static isAvailable(){return!0}static setEdgeArrowSizeRatio(e){so.edgeArrowSizeRatio=e}static setMinEdgeTipSize(e){so.minEdgeTipSize=e}getDomElement(){return null}_initCanvas(e){e.style.touchAction="none"}export(e){return Promise.resolve()}extractElement(e,s){return this._memoryManager.extractGenericElement(e,s,this._scales)}_compareDimensions(e,s,n){return(e!==this._width||s!==this._height||n!==this._pixelRatio)&&(this._width=e,this._height=s,this._pixelRatio=n,!0)}_compareView(e,s,n,i){return(e!==this._viewX||s!==this._viewY||n!==this._viewZoom||i!==this._viewAngle)&&(this._viewX=e,this._viewY=s,this._viewZoom=n,this._viewAngle=i,this._viewAngleCos=Math.cos(i),this._viewAngleSin=Math.sin(i),!0)}_compareCurrentTime(e){return e!==this._currentTime&&(this._currentTime=e,!0)}_compareBackgroundColor(e,s){return(e!==this._backgroundColor||s!==this._renderBackground)&&(this._renderBackground=s,this._backgroundColor=e,this._backgroundRgba=Yn(this._backgroundColor),!0)}_compareShapes(){return this._shapesVersion!==this._shapeManager.getVersion()&&(this._shapesVersion=this._shapeManager.getVersion(),!0)}_comparePatterns(){return this._patternsVersion!==this._patternManager.getVersion()&&(this._patternsVersion=this._patternManager.getVersion(),!0)}_compareBoundaries(){return this._boundariesVersion!==this._boundariesManager.getVersion()&&(this._boundariesVersion=this._boundariesManager.getVersion(),!0)}_compareTexts(){return this._textsVersion!==this._textManager.getVersion()&&(this._textsVersion=this._textManager.getVersion(),!0)}_compareIsDisplayableBuffer(e){return this._isBufferDisplayable!==e&&(this._isBufferDisplayable=e,!0)}_compareHideImages(e){return this._hideImages!==e&&(this._hideImages=e,!0)}renderFrame({x:e,y:s,zoom:n,angle:i,width:r,height:o,pixelRatio:a,backgroundColor:l,currentTime:u,isBufferDisplayable:h,hideImages:g,renderBackground:f}){const p=this._compareShapes(),y=this._comparePatterns(),_=this._compareBoundaries(),x=this._compareTexts(),v=this._compareDimensions(r,o,a),b=this._compareView(e,s,n,i),S=this._compareCurrentTime(u),A=this._compareBackgroundColor(l,f),w=this._compareIsDisplayableBuffer(h),L=this._compareHideImages(g);if(_){const M=this._boundariesManager,F=this._scales;F.bytesToActualCoord=1,F.bytesToActualScaledSize=M.maxScaledSize/Q2,F.bytesToActualMinVisibleSize=M.maxMinVisibleSize/Ay,F.bytesToActualSymbolicSize=M.maxSymbolicSize/Wl,F.bytesToActualDashLength=M.maxDashLength/Xl,F.bytesToActualGapLength=M.maxGapLength/Xl,F.bytesToActualPatternScale=M.maxPatternScale/Wl}this._firstFrame&&this._beforeFirstFrame(),this._render({shapesChanged:p,patternsChanged:y,boundariesChanged:_,textsChanged:x,dimensionsChanged:v,viewChanged:b,currentTimeChanged:S,backgroundColorChanged:A,isBufferDisplayableChanged:w,isHideImagesChanged:L}),this._firstFrame&&(this._afterFirstFrame(),this._firstFrame=!1)}_render(e){}_beforeFirstFrame(){}_afterFirstFrame(){}destroy(){}ensureAnimationsReady(){}getImageData(){return null}setViewportClipping(e){}},so.edgeArrowSizeRatio=tC,so.minEdgeTipSize=eC,so);function kC(t,e,s,n,i,r,o,a=0,l=!1){const u=_n(s,n,i,r),h=(o/2*(l?_n(t,e,i,r)/u:1)+a)/u,g=(i-s)*h,f=(r-n)*h,p=s+f,y=n-g,_=t-p,x=e-y,v=s-f-p,b=n+g-y,S=i+f-p,A=r-g-y,w=_*v+x*b,L=_*S+x*A;return w>0&&w<v*v+b*b&&L>0&&L<S*S+A*A}function uO(t,e,s,n,i=!1){if(i&&(tg(t,s)||tg(t,n)||tg(e,s)||tg(e,n)))return!1;let r=(t.y-s.y)*(n.x-s.x)-(t.x-s.x)*(n.y-s.y);const o=(e.x-t.x)*(n.y-s.y)-(e.y-t.y)*(n.x-s.x);if(o===0)return!1;const a=r/o;r=(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y);const l=r/o;return!(a<=0||a>=1||l<=0||l>=1)}function tg(t,e){return t.x===e.x&&t.y===e.y}function gu(t,e,s,n){return Math.atan2(n-e,s-t)}function dO(t,e,s){const n=gu(t.x,t.y,e.x,e.y)-gu(s.x,s.y,e.x,e.y);return n<0?n+2*Math.PI:n}function hO(t,e,s,n,i,r,o,a){const l=(a-r)*(s-t)-(o-i)*(n-e);if(l===0)return null;let u=e-r;return u=((o-i)*u-(a-r)*(t-i))/l,{x:t+u*(s-t),y:e+u*(n-e)}}function Ed(t,e,s,n,i,r,o,a){const l=t-s,u=e-n,h=i-o,g=r-a,f=l*g-h*u,p=(u*(t-i)-l*(e-r))/f;if(p<0||p>1)return null;const y=(h*(r-e)+g*(t-i))/f;return y>=0&&y<=1?{x:t-y*l,y:e-y*u}:null}function IC(t,e,s,n,i,r,o,a){let l;const u=[];return l=Ed(t,e,s,n,i,r,i,a),l&&u.push(l),l=Ed(t,e,s,n,i,a,o,a),l&&u.push(l),l=Ed(t,e,s,n,o,a,o,r),l&&u.push(l),l=Ed(t,e,s,n,o,r,i,r),l&&u.push(l),u}function Kl(t,e,s,n,i,r,o,a){const l=((o-i)*(e-r)-(a-r)*(t-i))/((a-r)*(s-t)-(o-i)*(n-e)),u=((s-t)*(e-r)-(n-e)*(t-i))/((a-r)*(s-t)-(o-i)*(n-e));return l>=0&&l<=1&&u>=0&&u<=1}function p0(t,e,s,n,i,r,o,a){return t>=i&&e>=r&&t<=o&&e<=a||s>=i&&n>=r&&s<=o&&n<=a||!!Kl(t,e,s,n,i,r,i,a)||!!Kl(t,e,s,n,o,r,o,a)||!!Kl(t,e,s,n,i,r,o,r)||!!Kl(t,e,s,n,i,a,o,a)}function RC(t,e,s){return Math.sqrt(m0(t.x,t.y,e.x,e.y,s.x,s.y))}function m0(t,e,s,n,i,r){const o=Ug(s,n,i,r);if(o===0)return Ug(t,e,s,n);let a=((t-s)*(i-s)+(e-n)*(r-n))/o;return a=Math.max(0,Math.min(1,a)),Ug(t,e,s+a*(i-s),n+a*(r-n))}function FC(t,e,s,n,i,r){const o=i-s,a=r-n;if(o===0&&a===0)return{x:s,y:n};const l=((t-s)*o+(e-n)*a)/(o*o+a*a);return l<0?{x:s,y:n}:l>1?{x:i,y:r}:{x:s+l*o,y:n+l*a}}function cO(t,e,s,n,i,r){const o=i-s,a=r-n,l=((t-s)*o+(e-n)*a)/(o*o+a*a);return{x:s+o*l,y:n+a*l}}function ap(t,e,s,n,i,r){const o=r||{x:0,y:0},a=(t+s)/2,l=(e+n)/2,u=t-s,h=e-n,g=Math.sqrt(u*u+h*h);if(g===0)return o.x=a,o.y=l,o;const f=h/g,p=-u/g,y=-g*i/Qf;return o.x=a+f*y,o.y=l+p*y,o}function _0(t,e,s,n,i,r){const o=r||{x1:0,y1:0,x2:0,y2:0},a=(n+n/vf*s)*vf,l=-i+qi,u=qi/2-i;return o.x1=t+Math.cos(l)*a,o.y1=e+Math.sin(l)*a,o.x2=t+Math.cos(u)*a,o.y2=e+Math.sin(u)*a,o}function gO(t,e,s,n){const i=Math.abs(t.x-e.x-s.x+n.x)+Math.abs(t.y-e.y-s.y+n.y)<.01,r=9*(e.x-t.x)**2,o=(-243*t.x+189*e.x+51*s.x+3*n.x)**2/1e4,a=(-48*t.x+24*e.x+21*s.x+3*n.x)**2/625,l=(-147*t.x+21*e.x+99*s.x+27*n.x)**2/1e4,u=(-27*t.x-9*e.x+24*s.x+12*n.x)**2/625,h=9/16*(s.x+n.x-t.x-e.x)**2,g=9*(e.y-t.y)**2,f=(-243*t.y+189*e.y+51*s.y+3*n.y)**2/1e4,p=(-48*t.y+24*e.y+21*s.y+3*n.y)**2/625,y=(-147*t.y+21*e.y+99*s.y+27*n.y)**2/1e4,_=(-27*t.y-9*e.y+24*s.y+12*n.y)**2/625,x=9/16*(s.y+n.y-t.y-e.y)**2,v=Math.sqrt(r+g),b=Math.sqrt(o+f),S=Math.sqrt(a+p),A=Math.sqrt(l+y),w=Math.sqrt(u+_),L=Math.sqrt(h+x);if(i)return 5/2993760*(32134*v+212600*b-97050*S+544800*A-521100*w+427368*L);const M=(-12*t.x-24*e.x+9*s.x+27*n.x)**2/625,F=(-27*t.x-99*e.x-21*s.x+147*n.x)**2/1e4,O=(-3*t.x-21*e.x-24*s.x+48*n.x)**2/625,G=(-3*t.x-51*e.x-189*s.x+243*n.x)**2/1e4,j=9*(n.x-s.x)**2,Z=(-12*t.y-24*e.y+9*s.y+27*n.y)**2/625,at=(-27*t.y-99*e.y-21*s.y+147*n.y)**2/1e4,pt=(-3*t.y-21*e.y-24*s.y+48*n.y)**2/625,K=(-3*t.y-51*e.y-189*s.y+243*n.y)**2/1e4,ut=9*(n.y-s.y)**2,ht=Math.sqrt(M+Z),nt=Math.sqrt(F+at),ot=Math.sqrt(O+pt),Mt=Math.sqrt(G+K);return 5/2993760*(16067*(v+Math.sqrt(j+ut))+106300*(b+Mt)-48525*(S+ot)+272400*(A+nt)-260550*(w+ht)+427368*L)}var fO={left:{x:-1,y:0},right:{x:1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},center:{x:0,y:0}},pO=[{name:"topLeft",dx:-1,dy:-1,cornerIndex:2},{name:"topRight",dx:1,dy:-1,cornerIndex:3},{name:"bottomLeft",dx:-1,dy:1,cornerIndex:1},{name:"bottomRight",dx:1,dy:1,cornerIndex:0}],Zr={x:0,y:0};function mO(t,e,s,n,i,r,o,a,l,u,h,g){r=r||o.getNodes()._indexes;const f=l.getZoom(),p=o.getObjectList(!0),y=a.getFlexArrays().nodes.current;let _=1/0,x=0,v=-1/0;a.update();for(let b=0;b<r.length;++b){const S=r[b];if(y.excluded.get(S)||!y.detectable.get(S)||h.has(S))continue;const A=y.x.get(S),w=y.y.get(S),L=y.layer.get(S);if(L<v)continue;Zr.x=A,Zr.y=w;const M=l.graphToScreenCoordinates(Zr),F=M.x,O=M.y,G=y.shape.get(S),j=y.scalingMethod.get(S)==="scaled",Z=y.radius.get(S)*(j?f:1),at=Z+i,pt=(t-F)/at,K=(e-O)/at;if(Zr.x=t,Zr.y=e,!(n&&PC(Zr,S,a,l,u)))if(u.checkShapeHit(G,pt,K)){const ut=o.getAttribute(!0,"virtual").get(S)!==0;if(at>_&&ut)continue;_=at}else{if(!s)continue;{const ut=g(y.text.content.get(S)||null),ht=y.textHidden.get(S),nt=y.text.minVisibleSize.get(S),ot=j?2*Z:1/0;if(ht||!ut||ot<nt)continue;const Mt=h0(ut,y.text.maxLineLength.get(S)),Q=y.innerStroke.width.get(S),Et=y.text.margin.get(S),Xt=y.text.padding.get(S),Ht=y.text.size.get(S),Zt=y.text.scale.get(S),ae=y.text.scaling.get(S),pe=y.text.font.get(S),ne=y.text.style.get(S),te=y.text.position.get(S),se=u.measureText(Mt,pe,ne,1),ce=ae?Zt*Z*2:Ht,Ce=se.width*ce/2+Xt,ve=se.height*ce/2+Xt,Me=fO[te],ge=Q+Et+Z,ze=F+(ge+Ce)*Me.x,is=O+(ge+ve)*Me.y,Ge=ze+Ce,De=is-ve,He=is+ve;if(t<=ze-Ce||t>=Ge||e<=De||e>=He)continue}}x=S,v=L}return p.get(x)||null}function PC(t,e,s,n,i){const r=s.getFlexArrays().nodes.current,o=n.getZoom(),a=r.scalingMethod.get(e)==="scaled",l=r.radius.get(e)*(a?o:1),u=r.x.get(e),h=r.y.get(e),g=r.radius.get(e);for(let f=0;f<4;f++){const{name:p,cornerIndex:y}=pO[f],_=r.badges[p].scalingMethod.get(e)==="fixed",x=r.badges[p].scale.get(e),v=_?Math.min(x*l,r.radius.get(e)*x):x*l,b=r.badges[p].minVisibleSize.get(e)/2,S=r.badges[p].positionScale.get(e);if(!r.badges[p].text.content.get(e)&&!r.badges[p].image.url.get(e)||v<b)continue;const A=n.graphToScreenCoordinates({x:u+g*S*n.getCornerCos(y),y:h+g*S*n.getCornerSin(y)}),{x:w,y:L}=A,M=(t.x-w)/v,F=(t.y-L)/v;if(i.checkShapeHit("circle",M,F))return p}}function _O(t,e,s,n,i,r,o,a,l,u,h){i=i||r.getEdges()._indexes;const g=r.getObjectList(!1),f=l.getFlexArrays(),p=f.edges.current,y=f.nodes.current,_=o.getZoom(),x=o.getAngle(),v=Math.cos(x),b=Math.sin(x),S=n/_;Zr.x=t,Zr.y=e;const A=o.screenToGraphCoordinates(Zr),w=A.x,L=A.y;let M=0;l.update();for(let F=0;F<i.length;++F){const O=i[F],G=p.source.get(O),j=p.target.get(O),Z=p.excluded.get(O),at=p.detectable.get(O),pt=a.has(G),K=a.has(j);if(Z||!at||pt||K)continue;const ut=G===j,ht=p.curvature.get(O),nt=p.shape.body.get(O)==="triangle",ot=p.scalingMethod.get(O)==="scaled",Mt=p.width.get(O)/(ot?1:_),Q=y.x.get(G),Et=y.y.get(G),Xt=y.x.get(j),Ht=y.y.get(j);if(ut){const Zt=y.scalingMethod.get(G)==="scaled",ae=_0(Q,Et,ht,y.radius.get(G)/(Zt?1:_),0);if(!Py(w,L,Q,Et,Q,Et,ae.x1,ae.y1,ae.x2,ae.y2,Mt,S))continue}else if(u){const Zt=ip(Q*v-Et*b,Et*v+Q*b,Xt*v-Ht*b,Ht*v+Xt*b,ht,u,h);if(!Py(w,L,Q,Et,Xt,Ht,Zt.x1*v+Zt.y1*b,Zt.y1*v-Zt.x1*b,Zt.x2*v+Zt.y2*b,Zt.y2*v-Zt.x2*b,Mt,S))continue}else if(ht!==0){const Zt=ap(Q,Et,Xt,Ht,ht);if(!MC(w,L,Q,Et,Xt,Ht,Zt.x,Zt.y,Mt,S,nt))continue}else if(!kC(w,L,Q,Et,Xt,Ht,Mt,S,nt))continue;M=O}return g.get(M)||null}function yO(t){const e=t.getNodeAttribute("radius"),s=t.getEdgeAttribute("width"),n=t.getNodes(),i=t.getEdges();let r=0,o=0;for(let a=0;a<n._indexes.length;a++){const l=n._indexes[a],u=e.get(l);u>r&&(r=u)}for(let a=0;a<i._indexes.length;a++){const l=i._indexes[a],u=s.get(l);u>o&&(o=u)}return Math.max(2*r,o)}function xO(t){return t===null?"none":t==="webgl"?"WebGL":t==="svg"?"SVG":t==="canvas"?"Canvas":t}function zC(t,e,s,n){const i=(t-e)/s,r=i*i,o=r*i,a=o0.getCoefficients(n),l=i<.5?0:4;return Wi(a[l]+a[l+1]*i+a[l+2]*r+a[l+3]*o,0,1)}function Sd(t,e,s,n){if(t===e)return t;const[i,r,o,a]=Yn(t),[l,u,h,g]=Yn(e);return`rgba(${Math.round(255*bs(i,l,s))},${Math.round(255*bs(r,u,s))},${Math.round(255*bs(o,h,s))},${bs(a,g,n)})`}function vO(t,e){const[s,n,i,r]=Yn(t);return`rgba(${255*s},${255*n},${255*i},${r*e})`}var yS=1/_i,DC=class extends ro{constructor(t){super(t),this._cachePoints=[],this._nextCachePoint=0,this._tmp={x1:0,y1:0,x2:0,y2:0},this._ccp={x1:0,y1:0,x2:0,y2:0},this._pointCopies=Array(128),this._clipViewport=!0}_resetCachePoints(){this._nextCachePoint=0}_point(t,e){let s=this._cachePoints[this._nextCachePoint++];return s||(s={x:0,y:0},this._cachePoints.push(s)),s.x=t,s.y=e,s}setViewportClipping(t){this._clipViewport=t}_displayBuffer(t){const e=t.getSize(),s=t.animated;for(let n=0;n<e;++n){const i=this.extractElement(t,n);i.valid&&this._displayElement(i,s)}}_mixAttributes(t,e,s){const n=zC(this._currentTime,s.beginTime,s.duration,s.easing);return t.dashLength=bs(e.dashLength,t.dashLength,n),t.gapLength=bs(e.gapLength,t.gapLength,n),t.offsetAngle=bs(e.offsetAngle,t.offsetAngle,n),t.opacity=bs(e.opacity,t.opacity,n),t.globalMinVisibleSize=bs(e.globalMinVisibleSize,t.globalMinVisibleSize,n),t.strokeMinVisibleSize=bs(e.strokeMinVisibleSize,t.strokeMinVisibleSize,n),t.patternMinVisibleSize=bs(e.patternMinVisibleSize,t.patternMinVisibleSize,n),t.symbolicSize=bs(e.symbolicSize,t.symbolicSize,n),t.curvature=bs(e.curvature,t.curvature,n),t.fillColor=Sd(e.fillColor,t.fillColor,n,n),t.strokeColor=Sd(e.strokeColor,t.strokeColor,n,n),t.patternColor=Sd(e.patternColor,t.patternColor,n,n),t.x1=bs(e.x1,t.x1,n),t.y1=bs(e.y1,t.y1,n),t.x2=bs(e.x2,t.x2,n),t.y2=bs(e.y2,t.y2,n),t.rectWidthOrSourceRadiusScaled=bs(e.rectWidthOrSourceRadiusScaled,t.rectWidthOrSourceRadiusScaled,n),t.rectWidthOrSourceRadiusFixed=bs(e.rectWidthOrSourceRadiusFixed,t.rectWidthOrSourceRadiusFixed,n),t.rectHeightOrTargetRadiusScaled=bs(e.rectHeightOrTargetRadiusScaled,t.rectHeightOrTargetRadiusScaled,n),t.rectHeightOrTargetRadiusFixed=bs(e.rectHeightOrTargetRadiusFixed,t.rectHeightOrTargetRadiusFixed,n),t.thicknessOrFontSizeScaled=bs(e.thicknessOrFontSizeScaled,t.thicknessOrFontSizeScaled,n),t.thicknessOrFontSizeFixed=bs(e.thicknessOrFontSizeFixed,t.thicknessOrFontSizeFixed,n),t.strokeWidthScaled=bs(e.strokeWidthScaled,t.strokeWidthScaled,n),t.strokeWidthFixed=bs(e.strokeWidthFixed,t.strokeWidthFixed,n),t.offsetScaled=bs(e.offsetScaled,t.offsetScaled,n),t.offsetFixed=bs(e.offsetFixed,t.offsetFixed,n),t}_computeRenderInfo(t){const e=this._viewZoom,s=this._point(t.x1,t.y1),n=this._point(t.x2,t.y2),i=t.isBadge,r=i&&t.rectWidthOrSourceRadiusScaled&&t.rectWidthOrSourceRadiusFixed,o=r?Math.min(t.rectWidthOrSourceRadiusScaled*e,t.rectWidthOrSourceRadiusFixed):t.rectWidthOrSourceRadiusScaled*e+t.rectWidthOrSourceRadiusFixed,a=r?o:t.rectHeightOrTargetRadiusScaled*e+t.rectHeightOrTargetRadiusFixed,l=t.symbolicSize===0?1/0:t.symbolicSize*e;return{shape:this._shapeManager.getDefinitionFromName(t.shape),pieceId:t.pieceId,dashLength:t.dashLength,gapLength:t.gapLength,hasHead:t.hasHead,hasTail:t.hasTail,isBodyTriangle:t.isBodyTriangle,isSelfLoop:t.isSelfLoop,patternScale:t.patternScale,offsetAngle:cf(t.offsetAngle),isText:t.isText,adjustTextAngle:t.adjustTextAngle,isBadge:i,bentEnable:t.bentEnable,bentVertical:t.bentVertical,opacity:t.opacity,globalMinVisibleSize:t.globalMinVisibleSize,strokeMinVisibleSize:t.strokeMinVisibleSize,patternMinVisibleSize:t.patternMinVisibleSize,symbolicSize:l,curvature:t.curvature,pattern:t.pattern,fillColor:t.fillColor,strokeColor:t.strokeColor,patternColor:t.patternColor,pos1OnGraph:s,pos2OnGraph:n,pos1:this._graphToScreenCoordinates(s),pos2:this._graphToScreenCoordinates(n),rectWidthOrSourceRadius:o,rectHeightOrTargetRadius:a,thicknessOrFontSize:t.thicknessOrFontSizeScaled*e+t.thicknessOrFontSizeFixed,strokeWidth:t.strokeWidthScaled*e+t.strokeWidthFixed,offset:t.offsetScaled*e+t.offsetFixed}}_applyBackgroundBlending(t){t.opacity!==1&&(t.fillColor=this._blendColor(t.fillColor,t.opacity),t.strokeColor=this._blendColor(t.strokeColor,t.opacity),t.textColor=this._blendColor(t.textColor,t.opacity))}_pointArray(t){let e=this._pointCopies[t];if(!e){e=new Array(t),this._pointCopies[t]=e;for(let s=0;s<t;++s)e[s]={x:0,y:0,r:0}}return e}_scalePoints(t,e,s,n){const i=t.shape.points.length,r=this._pointArray(i);for(let l=0;l<i;++l){const u=t.shape.points[l],h=r[l];h.x=e.x+u.x*s,h.y=e.y+u.y*n,h.r=u.r*s}const o=t.pos2OnGraph.x-t.pos1OnGraph.x,a=t.pos2OnGraph.y-t.pos1OnGraph.y;if(o!==0||a!==0){const l=Math.sqrt(o*o+a*a),u=o/l,h=a/l;for(const g of r){const f=g.x-e.x,p=g.y-e.y;g.x=e.x+u*f+h*p,g.y=e.y-h*f+u*p}}return r}_drawPoints(t,e=!1){t.length===1?this._drawCircle(t[0],t[0].r):this._drawPolygon(t,e)}_computeCenter(t){const e=Math.cos(t.offsetAngle),s=Math.sin(t.offsetAngle),n=(t.pos1.x+t.pos2.x)/2+e*t.offset,i=(t.pos1.y+t.pos2.y)/2+s*t.offset;return this._point(n,i)}_displayTextBox(t,e,s,n){const i=this._computeCenter(t),r=t.rectWidthOrSourceRadius/2,o=t.rectHeightOrTargetRadius/2;(e||n)&&this._drawRoundedRectangle(i,r,o,0,t.fillColor)}_displayNodeComponent(t,e,s,n){const i=this._computeCenter(t);if(t.pattern.type!==Xo){const r=t.rectWidthOrSourceRadius/2,o=t.rectHeightOrTargetRadius/2,a=this._scalePoints(t,i,r,o);if((e||n)&&this._drawPoints(a,!0),e&&this._fill(t.fillColor),n){if(this._startClip(),t.pattern.type===Nh){let l=t.pattern.attributes.colorArray;t.opacity!==1&&(l=l.map((u=>this._blendColor(u,t.opacity)))),this._displayPieChart(i,r,l)}else if(t.pattern.type===Da||t.pattern.type===Oa){const u=Math.round(t.rectHeightOrTargetRadius*t.patternScale),h=t.pattern.attributes.text,g=this._blendColor(t.patternColor,t.opacity),f=t.pattern.attributes.font,p=t.pattern.attributes.style,y=t.pattern.attributes.align,_=t.rectWidthOrSourceRadius,x=t.pattern.attributes.paddingTop,v=t.pattern.attributes.paddingLeft;this._displayText(i,0,h,g,f,u,p,y,_,v,x,!0)}else if(t.pattern.type===qo){const l=t.pattern.attributes.image;if(l.isDummy||l.width&&l.height){const u=t.pattern.attributes.duplicated,h=u?1:t.patternScale,g=t.rectWidthOrSourceRadius*h,f=t.rectHeightOrTargetRadius*h,p=t.pattern.attributes.scaled,y=t.opacity;this._displayImage(i,g,f,l,p,u,y)}}this._endClip()}if(s){const l=t.strokeWidth/2,u=this._scalePoints(t,i,r+l,o+l);this._drawPoints(u),this._stroke(t.strokeColor,t.strokeWidth)}}else if(n){const o=t.thicknessOrFontSize,a=t.pattern.attributes.text,l=this._blendColor(t.patternColor,t.opacity),u=t.pattern.attributes.font,h=t.pattern.attributes.style,g=t.pattern.attributes.align,f=t.rectWidthOrSourceRadius;this._displayText(i,0,a,l,u,o,h,g,f,0,0,!1)}}_displayElement(t,e){if(!t.end||!t.end.shape||!t.end.pieceId||e&&(!t.start||!t.animation))return;this._resetCachePoints();const s=e?this._mixAttributes(t.end,t.start,t.animation):t.end,n=this._computeRenderInfo(s);if(n.symbolicSize<n.globalMinVisibleSize||n.opacity===0)return;this._applyBackgroundBlending(n);const i=!!(n.strokeColor&&n.strokeWidth>0&&n.symbolicSize>=n.strokeMinVisibleSize),r=n.pattern.type!==Wn&&n.symbolicSize>=n.patternMinVisibleSize,o=!!n.fillColor;if(n.pieceId===Xi)return this._displayNodeComponent(n,o,i,r);if(n.pieceId===ka)return this._displayTextBox(n,o,i,r);const a=n.pos2.x-n.pos1.x,l=n.pos2.y-n.pos1.y,u=Math.sqrt(a*a+l*l);let h,g=null,f=null;if(n.bentEnable&&!n.isSelfLoop)this._tmp.x1=n.pos1.x,this._tmp.y1=n.pos1.y,this._tmp.x2=n.pos2.x,this._tmp.y2=n.pos2.y,n.pos1.x=this._tmp.x1*this._viewAngleCos-this._tmp.y1*this._viewAngleSin,n.pos1.y=this._tmp.y1*this._viewAngleCos+this._tmp.x1*this._viewAngleSin,n.pos2.x=this._tmp.x2*this._viewAngleCos-this._tmp.y2*this._viewAngleSin,n.pos2.y=this._tmp.y2*this._viewAngleCos+this._tmp.x2*this._viewAngleSin,ip(n.pos1.x,n.pos1.y,n.pos2.x,n.pos2.y,n.curvature,n.bentEnable,n.bentVertical,this._ccp),n.pos1.x=this._tmp.x1,n.pos1.y=this._tmp.y1,n.pos2.x=this._tmp.x2,n.pos2.y=this._tmp.y2,this._tmp.x1=this._ccp.x1,this._tmp.y1=this._ccp.y1,this._tmp.x2=this._ccp.x2,this._tmp.y2=this._ccp.y2,this._ccp.x1=this._tmp.x1*this._viewAngleCos+this._tmp.y1*this._viewAngleSin,this._ccp.y1=this._tmp.y1*this._viewAngleCos-this._tmp.x1*this._viewAngleSin,this._ccp.x2=this._tmp.x2*this._viewAngleCos+this._tmp.y2*this._viewAngleSin,this._ccp.y2=this._tmp.y2*this._viewAngleCos-this._tmp.x2*this._viewAngleSin,g=this._point(this._ccp.x1,this._ccp.y1),f=this._point(this._ccp.x2,this._ccp.y2),h=gO(n.pos1,g,f,n.pos2);else if(n.isSelfLoop){const p=n.pieceId===Aa||n.pieceId===Aa+ka?n.strokeWidth/2:n.rectWidthOrSourceRadius,{x1:y,y1:_,x2:x,y2:v}=this._getSelfLoopControlPoints(n.pos1,n.curvature,p);g=this._point(y,_),f=this._point(x,v),h=EO(n.pos1,g,f,n.pos2,1)}else n.curvature?(g=this._getQuadraticCurveControlPoint(n),h=bO(n.curvature,u,1)):h=u;if(n.pieceId===Aa||n.pieceId===Aa+ka){const p=n.strokeWidth,y=this._getPointOnLine(n.pos1,g,f,n.pos2,.5),_=this._getTangentOnLine(n.pos1,g,f,n.pos2,.5);if(n.rectWidthOrSourceRadius>=h-p&&!n.isSelfLoop){if(!n.adjustTextAngle)return;_.x=1,_.y=0}let x=-Math.atan2(_.y,_.x);const v=cf(n.offsetAngle-x);(!n.isSelfLoop&&v<0||n.isSelfLoop&&n.offsetAngle<0)&&(_.x*=-1,_.y*=-1),(x>Math.PI/2||x<-Math.PI/2)&&(x+=Math.PI);const b=this._getOrthogonal(_),S=y.x+b.x*n.offset,A=y.y+b.y*n.offset;if(n.pieceId===Aa+ka){if(!n.fillColor)return;const w=n.rectWidthOrSourceRadius/2,L=n.rectHeightOrTargetRadius/2;this._drawRoundedRectangle(this._point(S,A),w,L,v+Math.PI/2,n.fillColor)}else{const w=this._point(S,A),L=x,M=n.thicknessOrFontSize,F=n.pattern.attributes.text,O=this._blendColor(n.patternColor,n.opacity),G=n.pattern.attributes.font,j=n.pattern.attributes.style,Z=n.pattern.attributes.align,at=n.rectWidthOrSourceRadius;this._displayText(w,L,F,O,G,M,j,Z,at,0,0,!1)}}else{const p=n.pieceId===n0,y=n.pieceId===i0,_=Math.cos(n.offsetAngle),x=Math.sin(n.offsetAngle);n.pos1.x+=_*n.offset,n.pos1.y+=x*n.offset,n.pos2.x+=_*n.offset,n.pos2.y+=x*n.offset;const v=n.shape.name==="line",b=n.thicknessOrFontSize,S=n.rectWidthOrSourceRadius,A=n.rectHeightOrTargetRadius,w=+n.hasHead,L=+n.hasTail,M=Math.max(ro.minEdgeTipSize,b*ro.edgeArrowSizeRatio),F=w*Math.min(5*S,M),O=L*Math.min(5*A,M),G=n.isSelfLoop?1/0:u-S-A,j=Math.min(0,G-F-O)/2,Z=b/2;let at=S>Z?S-Math.sqrt(S*S-Z*Z):Z;const pt=Math.max(S+O+L*j,0)-(1-w)*at;at=S>Z?A-Math.sqrt(A*A-Z*Z):Z;const K=Math.max(A+F+w*j,0)-(1-L)*at;if(p||y){const ut=y?-1:1,ht=(p?h-K:pt)-ut;let nt=null,ot=null;if((n.bentEnable||n.isSelfLoop)&&g&&f){const Mt=this._getTFromLengthOnCubicCurve(n.pos1,g,f,n.pos2,(p?K:pt)+1+n.strokeWidth/2,y);nt=this._getPointOnCubicCurve(n.pos1,g,f,n.pos2,Mt),ot=this._getTangentOnCubicCurve(n.pos1,g,f,n.pos2,Mt)}else if(n.curvature&&g){const Mt=this._getTFromLengthOnQuadraticCurve(n.pos1,g,n.pos2,ht-n.strokeWidth/2*ut);nt=this._getPointOnQuadraticCurve(n.pos1,g,n.pos2,Mt),ot=this._getTangentOnQuadraticCurve(n.pos1,g,n.pos2,Mt)}else{const Mt=ht/h;nt=this._mixPoints(n.pos1,n.pos2,Mt),ot=this._point(a/u,l/u)}if(ot.x*=ut,ot.y*=ut,o){if(n.shape.hole){const Q=this._makeEdgeExtremityPoints(nt,ot,M,n.shape.hole);this._drawPoints(Q),this._startReverseClip()}const Mt=this._makeEdgeExtremityPoints(nt,ot,M,n.shape.points);this._drawPoints(Mt),this._fill(n.fillColor),n.shape.hole&&this._endReverseClip()}if(i){if(n.shape.hole){const Et=this._makeEdgeExtremityPoints(nt,ot,M,n.shape.hole);this._drawPoints(Et),this._stroke(n.strokeColor,n.strokeWidth)}const Mt=M+n.strokeWidth/2,Q=this._makeEdgeExtremityPoints(nt,ot,Mt,n.shape.points);this._drawPoints(Q),this._stroke(n.strokeColor,n.strokeWidth)}}else{if(h-pt-K<=0)return;if(v){const ut=SO(h,b,pt,K,n.dashLength,n.gapLength);i&&(this._drawLine(n.pos1,g,f,n.pos2),this._stroke(n.strokeColor,b+2*n.strokeWidth,ut)),o&&(this._drawLine(n.pos1,g,f,n.pos2),this._stroke(n.fillColor,b,ut))}else{const ut=pt,ht=h-K;if(i){const nt=this._makeTriangleEdgeBody(n.pos1,g,f,n.pos2,ut,ht,b+n.strokeWidth/2,n.strokeWidth/2,h);this._drawPoints(nt),this._stroke(n.strokeColor,n.strokeWidth)}if(o){const nt=this._makeTriangleEdgeBody(n.pos1,g,f,n.pos2,ut,ht,b,0,h);this._drawPoints(nt),this._fill(n.fillColor)}}}}}_makeTriangleEdgeBody(t,e,s,n,i,r,o,a,l){return e?s?this._makeSelfLoopTriangleEdge(t,e,s,n,i,r,o,a,l):this._makeCurveTriangleEdge(t,e,n,i,r,o,a):this._makeStraightTriangleEdge(t,n,i,r,o,a)}_makeCurveTriangleEdge(t,e,s,n,i,r,o){const a=2*_i+2,l=this._pointArray(a),u=this._getTFromLengthOnQuadraticCurve(t,e,s,n),h=(this._getTFromLengthOnQuadraticCurve(t,e,s,i)-u)/_i,g=(o-r)/_i/2;let f=r/2,p=u;for(let y=0;y<=_i;++y){const _=this._getPointOnQuadraticCurve(t,e,s,p),x=this._getTangentOnQuadraticCurve(t,e,s,p),v=this._getOrthogonal(x),b=v.x*f,S=v.y*f,A=l[y],w=l[a-1-y];A.x=_.x+b,A.y=_.y+S,w.x=_.x-b,w.y=_.y-S,p+=h,f+=g}return l}_makeSelfLoopTriangleEdge(t,e,s,n,i,r,o,a,l){const u=2*_i+2,h=this._pointArray(u),g=this._getTFromLengthOnCubicCurve(t,e,s,n,i),f=(this._getTFromLengthOnCubicCurve(t,e,s,n,l-r,!1)-g)/_i,p=(a-o)/_i/2;let y=o/2,_=g;for(let x=0;x<=_i;++x){const v=this._getPointOnCubicCurve(t,e,s,n,_),b=this._getTangentOnCubicCurve(t,e,s,n,_),S=this._getOrthogonal(b),A=S.x*y,w=S.y*y,L=h[x],M=h[u-1-x];L.x=v.x+A,L.y=v.y+w,M.x=v.x-A,M.y=v.y-w,_+=f,y+=p}return h}_makeStraightTriangleEdge(t,e,s,n,i,r){const o=e.x-t.x,a=e.y-t.y,l=Math.sqrt(o*o+a*a),u=this._point(o/l,a/l),h=this._getOrthogonal(u),g=i/2,f=r/2,p=this._pointArray(4),y=p[0],_=p[1],x=p[2],v=p[3],b=t.x+u.x*s,S=t.y+u.y*s,A=t.x+u.x*n,w=t.y+u.y*n,L=h.x*g,M=h.y*g,F=h.x*f,O=h.y*f;return y.x=b+L,y.y=S+M,_.x=b-L,_.y=S-M,x.x=A-F,x.y=w-O,v.x=A+F,v.y=w+O,p}_makeEdgeExtremityPoints(t,e,s,n){const i=this._pointArray(n.length),r=s/2,o=t.x+e.x*r,a=t.y+e.y*r,l=e.x,u=e.y;for(let h=0;h<n.length;++h){const g=n[h],f=i[h],p=(l*g.x-u*g.y)*r,y=(u*g.x+l*g.y)*r;f.x=o+p,f.y=a+y,f.r=g.r*r}return i}_drawLine(t,e,s,n){e?s?this._drawCubicCurve(t,e,s,n):this._drawQuadraticCurve(t,e,n):this._drawStraightLine(t,n)}_getSelfLoopControlPoints(t,e,s){return _0(t.x,t.y,e,s,this._viewAngle,this._tmp)}_getQuadraticCurveControlPoint(t){return ap(t.pos1.x,t.pos1.y,t.pos2.x,t.pos2.y,t.curvature,this._point(0,0))}_graphToScreenCoordinates(t){const e=this._width/2,s=this._height/2,n=(t.x-this._viewX)*this._viewZoom,i=(t.y-this._viewY)*this._viewZoom,r=this._viewAngleCos,o=this._viewAngleSin,a=r*n+o*i+e,l=-o*n+r*i+s;return this._point(a,l)}_blendColor(t,e){return t&&this._backgroundColor?Sd(this._backgroundColor,t,e,1):t?vO(t,e):null}_getTangentOnLine(t,e,s,n,i){return e?s?this._getTangentOnCubicCurve(t,e,s,n,i):this._getTangentOnQuadraticCurve(t,e,n,i):this._getTangentOnStraightLine(t,n)}_getTangentOnStraightLine(t,e){const s=e.x-t.x,n=e.y-t.y,i=Math.sqrt(s*s+n*n);return this._point(s/i,n/i)}_getTangentOnQuadraticCurve(t,e,s,n){const i=1-n,r=i*e.x+n*s.x-(i*t.x+n*e.x),o=i*e.y+n*s.y-(i*t.y+n*e.y),a=Math.sqrt(r*r+o*o);return this._point(r/a,o/a)}_getTangentOnCubicCurve(t,e,s,n,i){const r=1-i,o=r*r,a=i*i,l=o*(e.x-t.x)+2*r*i*(s.x-e.x)+a*(n.x-s.x),u=o*(e.y-t.y)+2*r*i*(s.y-e.y)+a*(n.y-s.y),h=Math.sqrt(l*l+u*u);return this._point(l/h,u/h)}_mixPoints(t,e,s){const n=bs(t.x,e.x,s),i=bs(t.y,e.y,s);return this._point(n,i)}_getOrthogonal(t){return this._point(-t.y,t.x)}_getPointOnLine(t,e,s,n,i){return e?s?this._getPointOnCubicCurve(t,e,s,n,i):this._getPointOnQuadraticCurve(t,e,n,i):this._mixPoints(t,n,i)}_getPointOnQuadraticCurve(t,e,s,n){const i=Zl(t.x,e.x,s.x,n),r=Zl(t.y,e.y,s.y,n);return this._point(i,r)}_getPointOnCubicCurve(t,e,s,n,i){const r=mS(t.x,e.x,s.x,n.x,i),o=mS(t.y,e.y,s.y,n.y,i);return this._point(r,o)}_getTFromLengthOnCubicCurve(t,e,s,n,i,r=!0){if(!r)return 1-this._getTFromLengthOnCubicCurve(n,s,e,t,i,!0);let o=0,a=1,l=0;for(let u=0;u<10;u++){const h=(o+a)/2,g=h,f=this._getPointOnCubicCurve(t,e,s,n,g),p=Math.hypot(t.x-f.x,t.y-f.y);if(Math.abs(p-i)<.01)return h;p<i?(o=h,l=h):a=h}return l}_getTFromLengthOnQuadraticCurve(t,e,s,n){let i=t.x,r=t.y,o=0,a=0;for(let l=0;l<_i;++l){o+=yS;const u=Zl(t.x,e.x,s.x,o),h=Zl(t.y,e.y,s.y,o),g=u-i,f=h-r,p=Math.sqrt(g*g+f*f),y=a+p;if(y>n)return o-yS*((y-n)/p);a=y,i=u,r=h}return 1}};function bO(t,e,s){const n=Math.abs(t)/Qf+sp,i=n*n,r=s-.5,o=r*r,a=1/(16*i),l=Math.sqrt(o+a),u=.5/n*Math.sqrt(i+.25);return Math.abs(2*n)*(r*l+.5*u+a*Math.log(Math.abs((r+l)/(-.5+u))))*e}function EO(t,e,s,n,i){const r=(t.x+e.x+s.x)/3,o=(t.y+e.y+s.y)/3,a=r-e.x,l=o-e.y,u=e.x-s.x,h=e.y-s.y,g=a*a+l*l,f=(u*u+h*h)/4,p=Math.sqrt(g-f);return 2*sC*p*3.14159265359*i}function SO(t,e,s,n,i,r){const o=[];if(s&&o.push(0,s),i&&r){const a=i*e,l=r*e,u=a+l,h=t-n-s-u;let g=0;for(;g<h;)o.push(a,l),g+=u;const f=t-n-s-g,p=Math.min(a,f),y=Math.max(f-p,0);o.push(p,y)}else o.push(t-n-s,0);return n&&o.push(0,n),o}var Ql=0,Ud=1,Gd=2,wa=3,xS=4,y0=0,zy=1,AO={[Ql]:{min:"NEAREST",mag:"NEAREST",mipmap:!1},[Ud]:{min:"LINEAR",mag:"LINEAR",mipmap:!1},[Gd]:{min:"LINEAR",mag:"LINEAR",mipmap:!1},[wa]:{min:"LINEAR_MIPMAP_LINEAR",mag:"LINEAR",mipmap:!0}},wO={[y0]:"ALPHA",[zy]:"RGBA"};function fu(t){return Math.ceil((t+2*Wo)/jn)*jn}function TO(t,e,s,n,i){for(let r=0,o=t.length;r<o;++r){const a=t[r],l=a.x,u=a.y,h=l+n,g=u+i;let f=h<s&&g<s;if(f){for(let p=l;p<h;++p)if(e[p+u*s]===1){f=!1;break}}if(f){for(let p=u;p<g;++p)if(e[l+p*s]===1){f=!1;break}}if(f){for(let p=l;p<h;++p)for(let y=u;y<g;++y)e[p+y*s]=1;return t.splice(r,1),t.push({x:l,y:g},{x:h,y:u}),a}}return null}function vS(t,e,s,n,i,r,o){const a=4*t,l=e>>1<<7,u=e%2<<7;o[a]=s/jn,o[a+1]=n/jn,o[a+2]=l+i/jn,o[a+3]=u+r/jn}function CO(t,e,s,n,i,r,o){n|=0,i|=0,r|=0,o|=0,e|=0;for(let a=0;a<r;++a)for(let l=0;l<o;++l){const u=4*(n+a+(i+l)*e),h=4*(a+l*r);t[u]=s[h],t[u+1]=s[h+1],t[u+2]=s[h+2],t[u+3]=s[h+3]}}function LO(t,e){let s=0,n=4;for(let r=0;r<t.length;++r){const{width:o,height:a}=t[r],l=fu(o),u=fu(a);s+=l*u,n=Math.max(n,Math.max(l,u))}const i=Vo(Math.max(n,Math.sqrt(s)));return Math.min(i,e)}function bS(t,e){return Math.floor((e-t)/2)}function ES(t,e,s,n,i,r,o){const{min:a,mag:l,mipmap:u}=AO[r],h=t[wO[o]];if(o===y0){const g=new Uint8Array(i*i);for(let f=0;f<g.length;++f)g[f]=n[4*f+3];n=g}t.activeTexture(t.TEXTURE0+s),t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,h,i,i,0,h,t.UNSIGNED_BYTE,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[l]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[a]),u&&t.generateMipmap(t.TEXTURE_2D)}function OC(t,e,s,n,i){const r=new Uint8Array(s*s*4),o=Math.ceil(s/jn),a=new Uint8Array(o*o),l=[{x:0,y:0}];for(let u=0;u<e.length;++u){const h=e[u],g=h.id,f=fu(h.width)/jn,p=fu(h.height)/jn,y=TO(l,a,o,f,p);if(y){const _=h.width,x=h.height,v=h.pixels,b=f*jn,S=p*jn,A=y.x*jn+bS(_,b),w=y.y*jn+bS(x,S);CO(r,s,v,A,w,_,x),vS(g,t,A,w,b,S,i)}else{if(s<n)return OC(t,e,2*s,n,i);$o(`exceeded max WebGL texture size of ${n}; some texts/icons/images won't be displayed`),vS(g,t,0,0,0,0,i)}}return{texture:r,size:s}}function NO(t,e,s,n){const{getDistanceFromStrokeVertically:i,getDistanceFromStrokeHorizontally:r}=t,o=e*(1-s)/2,a=(e-1)/2;for(let l=0;l<e;++l)for(let u=0;u<e;++u){const h=4*(u*e+l),g=(l-a)/o,f=(u-a)/o,p=Wi(i(g,f),-1,1),y=Wi(r(g,f),-1,1);MO(n,h,SS(p),SS(y))}}function SS(t){const e=(t+1)/2;return Math.floor(32768*e)}function MO(t,e,s,n){t[e]=s>>8,t[e+1]=s%256,t[e+2]=n>>8,t[e+3]=n%256}function BC(t,e){let s=-Math.PI/2;const n=2*Math.PI/t.length;for(const i of t){const r=s+n;e(i,s,r),s=r}}function UC(t,e,s,n,i){BC(e,((r,o,a)=>{t.beginPath(),t.moveTo(s,n),t.arc(s,n,i,o,a),t.fillStyle=r,t.fill()}))}var kO=!Pn().__dummy,IO=class extends DC{constructor(t){super(t),this._canvas=Pn(),this._imgCanvas=Pn(),this._initCanvas(this._canvas),this._ctx=this._canvas.getContext("2d"),this._imgCtx=this._imgCanvas.getContext("2d")}static getName(){return"Canvas"}static isAvailable(){return kO}getDomElement(){return this._canvas}_render({dimensionsChanged:t}){t&&uC(this._canvas,this._width,this._height,this._pixelRatio);const e=this._ctx,s=this._width*this._pixelRatio,n=this._height*this._pixelRatio;e.clearRect(0,0,s,n),this._backgroundColor&&this._renderBackground&&(e.fillStyle=this._backgroundColor,e.fillRect(0,0,s,n));const i=this._bufferList.getBuffersByAscendingDepth();for(const r of i)this._isBufferDisplayable(r)&&this._displayBuffer(r)}_drawRoundedRectangle(t,e,s,n,i){const r=this._ctx,o=this._pixelRatio,a=t.x*o,l=t.y*o;e*=o,s*=o;const u=this._textManager.getCornerRadius(),h=Math.min(u*o,s);e+=h/2,r.save(),r.translate(a,l),r.rotate(n),r.beginPath(),r.arc(e-h,s-h,h,0,Math.PI/2),r.arc(-e+h,s-h,h,Math.PI/2,Math.PI),r.arc(-e+h,-s+h,h,Math.PI,3*Math.PI/2),r.arc(e-h,-s+h,h,3*Math.PI/2,0),i&&(r.fillStyle=i,r.fill()),r.restore()}_drawCircle(t,e){const s=this._ctx,n=this._pixelRatio,i=t.x*n,r=t.y*n,o=e*n;s.beginPath(),s.arc(i,r,o,0,2*Math.PI)}_drawPolygon(t){const e=this._ctx,s=this._pixelRatio;e.beginPath();const n=t[0];e.moveTo(n.x*s,n.y*s);for(let i=1;i<t.length;++i){const r=t[i];e.lineTo(r.x*s,r.y*s)}e.closePath()}_drawStraightLine(t,e){const s=this._ctx,n=this._pixelRatio;s.beginPath(),s.moveTo(t.x*n,t.y*n),s.lineTo(e.x*n,e.y*n)}_drawQuadraticCurve(t,e,s){const n=this._ctx,i=this._pixelRatio;n.beginPath(),n.moveTo(t.x*i,t.y*i),n.quadraticCurveTo(e.x*i,e.y*i,s.x*i,s.y*i)}_drawCubicCurve(t,e,s,n){const i=this._ctx,r=this._pixelRatio;i.beginPath(),i.moveTo(t.x*r,t.y*r),i.bezierCurveTo(e.x*r,e.y*r,s.x*r,s.y*r,n.x*r,n.y*r)}_fill(t){const e=this._ctx;e.fillStyle=t,e.fill()}_stroke(t,e,s=[]){if(e===0)return;const n=this._ctx,i=this._pixelRatio;n.setLineDash(s.map((r=>r*this._pixelRatio))),n.lineWidth=e*i,n.strokeStyle=t,n.stroke()}_startClip(){this._ctx.save(),this._ctx.clip()}_endClip(){this._ctx.restore()}_startReverseClip(){this._ctx.save(),this._ctx.rect(0,0,this._canvas.width,this._canvas.height),this._ctx.clip("evenodd")}_endReverseClip(){this._ctx.restore()}_displayText(t,e,s,n,i,r,o,a,l,u,h){const g=this._ctx,f=this._pixelRatio,p=t.x*f,y=t.y*f,_=r*f,x=a==="center"?0:-l/2;if(h=h*this._viewZoom*f,u=u*this._viewZoom*f,g.save(),g.translate(p,y+f),g.rotate(-e),g.textBaseline="middle",g.textAlign=a,Zo(g,i,_,o),g.fillStyle=n,s.indexOf(`
`)!==-1){const v=s.split(`
`),b=v.length;let S=(1-b)/2*_;for(let A=0;A<b;++A)g.fillText(v[A],u+x,h+S),S+=_}else g.fillText(s,u+x,h);g.restore()}_displayImage(t,e,s,n,i,r,o){if(this._hideImages||"isDummy"in n)return;let a=n;o!==1&&(a=this._blendImageOnBackground(n,o));const l=this._ctx,u=this._pixelRatio,h=t.x*u,g=t.y*u,f=e*u,p=s*u,y=a.width*u,_=a.height*u;if(i)l.drawImage(a,h-f/2,g-p/2,f,p);else if(r){const x=h-f/2,v=g-p/2,b=h+f/2,S=g+p/2;let A=h-y/2,w=g-_/2;for(;A>x;)A-=y;for(;w>v;)w-=_;const L=w;for(;A<b;){for(;w<S;)l.drawImage(a,A,w,y,_),w+=_;A+=y,w=L}}else l.drawImage(a,h-y/2,g-_/2,y,_)}_displayPieChart(t,e,s){const n=this._ctx,i=this._pixelRatio,r=t.x*i,o=t.y*i,a=e*i*2,l=2*a;s.length===1&&(n.fillStyle=s[0],n.fillRect(r-a,o-a,l,l)),s.length>1&&UC(n,s,r,o,a)}_blendImageOnBackground(t,e){const s=this._backgroundRgba,n=`rgb(${Math.round(255*s[0])},${Math.round(255*s[1])},${Math.round(255*s[2])})`;return this._imgCanvas.width=t.width,this._imgCanvas.height=t.height,this._imgCtx.clearRect(0,0,t.width,t.height),this._imgCtx.globalAlpha=1,this._imgCtx.fillStyle=n,this._imgCtx.fillRect(0,0,t.width,t.height),this._imgCtx.globalAlpha=e,this._imgCtx.drawImage(t,0,0),this._imgCanvas}getImageData(){return this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)}},GC=!1;try{GC=!!ys("svg")}catch{}var od="none",RO={left:"start",center:"middle",right:"end"},ji="data-element-id",AS="data-text-component",FO="node-text",PO="edge-text",zO="badge-text";function Jl(t){return Math.round(1e3*t)/1e3}function wS(t,e,s,n,i,r){const o=ys("image");return o.setAttribute("width",Jl(n)),o.setAttribute("height",Jl(i)),o.setAttribute("x",Jl(e)),o.setAttribute("y",Jl(s)),o.setAttribute("href",t),r&&r.appendChild(o),o}function DO(t,e,s,n,i,r=1,o){const a=ys("rect");return a.setAttribute("x",t),a.setAttribute("y",e),a.setAttribute("width",s),a.setAttribute("height",n),a.setAttribute("fill",i),a.setAttribute("fill-opacity",r),o&&o.appendChild(a),a}var OO=class extends DC{constructor(t){super(t),this._svg=ys("svg"),this._defs=ys("defs"),this._styles=ys("g",{class:"styles"}),this._background=ys("rect",{width:"100%",height:"100%",fill:"none",class:"ogma-svg-background"}),this._currentElementId="0",this._currentClipPathId=null,this._clipPathCounter=0,this._defs.appendChild(this._styles),this._svg.setAttribute("pointer-events","none"),this._svg.style.userSelect="none",this._svg.appendChild(this._defs),this._svg.appendChild(this._background),this._clear()}static getName(){return"SVG"}static isAvailable(){return GC}getDomElement(){return this._svg}_render({dimensionsChanged:t}){if(t&&Ox(this._svg,{width:this._width,height:this._height}),this._backgroundColor&&this._renderBackground){const s=Bl(this._backgroundColor);this._background.setAttribute("fill",s.color),this._background.setAttribute("fill-opacity",s.opacity)}const e=this._bufferList.getBuffersByAscendingDepth();this._clear(),this._svg.removeChild(this._container);for(let s=0;s<e.length;++s){const n=e[s];this._isBufferDisplayable(n)&&this._displayBuffer(n)}this._svg.appendChild(this._container)}_clear(){this._container&&this._svg.removeChild(this._container),this._container=ys("g"),this._svg.appendChild(this._container),this._clipPaths&&this._defs.removeChild(this._clipPaths),this._clipPaths=ys("g"),this._defs.appendChild(this._clipPaths),this._clipPaths.setAttribute("class","clip-paths"),this._filters&&this._defs.removeChild(this._filters),this._filters=ys("g"),this._defs.appendChild(this._filters)}_displayElement(t,e){this._currentElementId=t.id>=0?`n${t.id}`:"e"+-t.id,super._displayElement(t,e)}_addBackgroundBlendingFilter(t){const e=Yn(this._backgroundColor),s=t,n=1-t,i=[s,0,0,0,e[0]*n,0,s,0,0,e[1]*n,0,0,s,0,e[2]*n,0,0,0,1,0].join(" "),r=`filter-${this._currentElementId}`,o=ys("filter",{id:r}),a=ys("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:i});return o.appendChild(a),this._filters.appendChild(o),r}_drawRoundedRectangle(t,e,s,n,i){const r=t.x,o=t.y,a=Math.min(this._textManager.getCornerRadius(),s);e+=a/2;const l=ys("path"),u=`M ${r+e-a} ${o+s}     A ${a} ${a} 0 0 0 ${r+e} ${o+s-a}     L ${r+e} ${o-s+a}     A ${a} ${a} 0 0 0 ${r+e-a} ${o-s}     L ${r-e+a} ${o-s}     A ${a} ${a} 0 0 0 ${r-e} ${o-s+a}     L ${r-e} ${o+s-a}     A ${a} ${a} 0 0 0 ${r-e+a} ${o+s}     L ${r+e-a} ${o+s}`;l.setAttribute("d",u),l.setAttribute("fill",od),l.setAttribute("transform",`rotate(${_y(n)} ${t.x} ${t.y})`),l.setAttribute(ji,this._currentElementId),this._container.appendChild(l),this._element=l,i&&this._fill(i)}_drawCircle(t,e){const{x:s,y:n}=t,i=`M ${s-e}, ${n} a ${e},${e} 0 1,0 ${2*e},0 a ${e},${e} 0 1,0 -${2*e},0`,r=ys("path");r.setAttribute("d",i),r.setAttribute("fill",od),r.setAttribute(ji,this._currentElementId),this._container.appendChild(r),this._element=r}_drawPolygon(t,e){const s=ys("path");let n="";for(let i=0;i<t.length;i++){const{x:r,y:o}=t[i];n+=`${i===0?"M":"L"}${r},${o} `}n+="Z",s.setAttribute("d",n),s.setAttribute(ji,this._currentElementId),s.setAttribute("fill",od),e&&s.setAttribute(AS,!0),this._container.appendChild(s),this._element=s}_drawStraightLine(t,e){const s=ys("path"),n=`M ${t.x},${t.y} L${e.x},${e.y}`;s.setAttribute("d",n),s.setAttribute(ji,this._currentElementId),this._container.appendChild(s),this._element=s}_drawQuadraticCurve(t,e,s){const n=ys("path"),i=`M ${t.x},${t.y} Q${e.x},${e.y} ${s.x},${s.y}`;n.setAttribute("d",i),n.setAttribute("fill",od),n.setAttribute(ji,this._currentElementId),this._container.appendChild(n),this._element=n}_drawCubicCurve(t,e,s,n){const i=ys("path"),r=`M ${t.x},${t.y} C${e.x},${e.y} ${s.x},${s.y} ${n.x},${n.y}`;i.setAttribute("d",r),i.setAttribute("fill",od),i.setAttribute(ji,this._currentElementId),this._container.appendChild(i),this._element=i}_fill(t){const e=Bl(t);this._element.setAttribute("fill",e.color),this._element.setAttribute("fill-opacity",e.opacity),this._currentClipPathId&&this._element.setAttribute("clip-path",`url(#${this._currentClipPathId})`)}_stroke(t,e,s=[]){if(e===0)return;const n=this._element;n.setAttribute("stroke-width",e);const i=Bl(t);n.setAttribute("stroke",i.color),n.setAttribute("stroke-opacity",i.opacity),s.length>0&&n.setAttribute("stroke-dasharray",s.map(Jl).toString())}_startClip(){const t=ys("clipPath"),e=this._element.cloneNode(!1);this._currentClipPathId="clip-path-"+ ++this._clipPathCounter,t.appendChild(e),this._clipPaths.appendChild(t),t.setAttribute("id",this._currentClipPathId)}_endClip(){this._currentClipPathId=null}_startReverseClip(){const t=ys("clipPath"),e=this._element.cloneNode(!1),s=e.getAttribute("d");e.setAttribute("clip-rule","evenodd"),e.setAttribute("d",`${s} M 0 0 L ${this._width} 0 L ${this._width} ${this._height} L 0 ${this._height}`),this._currentClipPathId="clip-path-"+ ++this._clipPathCounter,t.appendChild(e),this._clipPaths.appendChild(t),t.setAttribute("id",this._currentClipPathId)}_endReverseClip(){this._currentClipPathId=null}_displayText(t,e,s,n,i,r,o="normal",a,l,u,h,g){const f=ys("g");f.setAttribute(ji,this._currentElementId),f.setAttribute(AS,!0);let p=this._currentElementId[0]==="n"?FO:PO;g&&(p+=" "+zO),f.setAttribute("class",p);const y=Bl(n),_=y.opacity,x=Bl(y.color),v=t.x+u*this._viewZoom,b=t.y+1+h*this._viewZoom,S=Jl(v);if(f.setAttribute("font-family",i),f.setAttribute("font-size",r),o==="normal"||o==="italic")f.setAttribute("font-style",o);else if(o.includes("italic")){f.setAttribute("font-style","italic");const F=o.replace("italic","").trim();F&&f.setAttribute("font-weight",F)}else f.setAttribute("font-weight",o);f.setAttribute("fill",x.color),f.setAttribute("fill-opacity",_),e&&f.setAttribute("transform",`rotate(${_y(-e)} ${v}, ${b})`),f.setAttribute("text-anchor",RO[a]||"middle"),f.setAttribute("dominant-baseline","middle");const A=s.split(`
`),w=A.length,L=b-(w+1)/2*r,M=a==="center"?0:-l/2;for(let F=0;F<w;F++){const O=ys("text");O.appendChild(Ux(A[F])),O.setAttribute("x",S+M),O.setAttribute("y",L+(F+1)*r),f.appendChild(O)}this._currentClipPathId&&f.setAttribute("clip-path",`url(#${this._currentClipPathId})`),this._container.appendChild(f)}_displayImage(t,e,s,n,i,r,o){const a=t.x,l=t.y;if(this._hideImages||!("isDummy"in n)&&(!n.width||!n.height))return;const u=e,h=s;let g,f=n.width,p=n.height;if(i&&(f=u,p=h),r){const y=a-u/2,_=l-h/2,x=a+u/2,v=l+h/2;let b=a-f/2,S=l-p/2;for(g=ys("g"),g.setAttribute(ji,this._currentElementId);b>y;)b-=f;for(;S>_;)S-=p;const A=S;for(;b<x;){for(;S<v;)wS(n.src,b,S,f,p,g),S+=p;S=A,b+=f}}else g=wS(n.src,a-f/2,l-p/2,f,p),g.setAttribute(ji,this._currentElementId);if(this._currentClipPathId&&g.setAttribute("clip-path",`url(#${this._currentClipPathId})`),o!==1){const y=this._addBackgroundBlendingFilter(o);g.setAttribute("filter",`url(#${y})`)}this._container.appendChild(g)}_displayPieChart(t,e,s){const n=2*e,i=2*n,r=t.x,o=t.y;let a;const l=ys("g");l.setAttribute(ji,this._currentElementId),s.length===1&&(a=DO(r-n,o-n,i,i,s[0],1,l)),s.length>1&&BC(s,((u,h,g)=>{const f=r+e*Math.cos(g),p=o+e*Math.sin(g),y=r+e*Math.cos(h),_=o+e*Math.sin(h),x=g-h<=Math.PI?0:1,v=`M ${f},${p} A ${e},${e} 0 ${x} 0 ${y},${_} L ${r},${o} L ${f},${p}`;a=ys("path"),a.setAttribute("d",v),a.setAttribute("fill",u),a.setAttribute("stroke-width",0),l.appendChild(a)})),this._currentClipPathId&&l.setAttribute("clip-path",`url(#${this._currentClipPathId})`),this._container.appendChild(l)}},BO=6,UO=class{constructor({gl:t,ext:e,staticProgram:s,animationProgram:n}){this._version=0,this._used=!1,this._dataBufferChanged=!1,this._gl=t,this._ext=e,this._staticProgram=s,this._animationProgram=n,this._glBuffer=this._gl.createBuffer()}setDataBuffer(t){this._dataBuffer!==t&&(this._program=t.animated?this._animationProgram:this._staticProgram,this._dataBuffer=t,this._dataBufferChanged=!0,t.hasSideData()&&!this._sideGlBuffer?this._sideGlBuffer=this._gl.createBuffer():!t.hasSideData()&&this._sideGlBuffer&&(this._gl.deleteBuffer(this._sideGlBuffer),delete this._sideGlBuffer))}setPrograms(t,e){this._staticProgram=t,this._animationProgram=e}markAsUnused(){return this._used=!1,this}getProgram(){return this._program}markAsUsed(){return this._used=!0,this}isUsed(){return this._used}draw(){const t=this._gl,e=this._dataBuffer.type,s=e===za,n=s?this._dataBuffer.getNbSideElementsPerMainElement():1,i=e===bf?_i:1,r=this._dataBuffer.getSize(),o=this._dataBuffer.stencilUsage,a=this._dataBuffer.version,l=this._version!==a||this._dataBufferChanged;this._program.setupBaseAttributes({glBuffer:this._glBuffer,dataBuffer:l?this._dataBuffer.getByteArray():null,divisor:n}),this._program.setupTextAttributes({glBuffer:this._sideGlBuffer,dataBuffer:l&&s?this._dataBuffer.getSideByteArray():null,divisor:1}),this._program.setupStencil(o),l&&(this._version=a,this._dataBufferChanged=!1),this._ext.drawArraysInstancedANGLE(t.TRIANGLES,0,BO*i,r*n)}destroy(){this._gl.deleteBuffer(this._glBuffer),this._sideGlBuffer&&this._gl.deleteBuffer(this._sideGlBuffer)}},GO={byte:1,ubyte:1,short:2,ushort:2,ulong:4,float:4},VO={byte:"BYTE",ubyte:"UNSIGNED_BYTE",short:"SHORT",ushort:"UNSIGNED_SHORT",ulong:"UNSIGNED_LONG",float:"FLOAT"},TS=class{constructor({gl:t,ext:e,specialGlBuffers:s,metaData:n,programWrapper:i}){this._stencilUsage=su,this._gl=t,this._ext=e,this._specialGlBuffers=s,this._metaData=Zs(n),this._programWrapper=i}_finishInit(){const t=this._gl,e=this._ext,s=this._programWrapper.getError();if(s)throw new Error(`WebGL compilation at step "${s.step}:
${s.message}"`);const n=this._programWrapper.getProgram();this._program=n,t.useProgram(n),this._metaData.attributes.forEach((o=>{o.location=t.getAttribLocation(this._program,o.name),o.byteSize=o.size*GO[o.type],o.glType=VO[o.type]})),this._specialAttributes=this._createSpecialAttributesFunctions();const i=[],r=[];for(const o of this._metaData.attributes)o.location!==-1&&(o.name.startsWith("a_text")?r.push(o):i.push(o));this._baseAttributes=i_(i,t,e),this._textAttributes=i_(r,t,e),this._setupUniforms=HO(this._metaData.uniforms,t,n)}_createSpecialAttributesFunctions(){return i_([{location:this._gl.getAttribLocation(this._program,this._metaData.vertexInfoAttribute),size:3,glType:"BYTE",byteSize:3,type:"byte",name:"special"}],this._gl,this._ext)}startPass(t){this._program||this._finishInit(),this._gl.useProgram(this._program),this._resetStencil(),this._setupUniforms(this._gl,t),this._specialAttributes.enable(this._gl),this._specialAttributes.setup(this._specialGlBuffers.vertexInfo,null,0)}_setupAttributes(t,{glBuffer:e,dataBuffer:s,divisor:n}){t.enabled&&!e?t.disable(this._gl):!t.enabled&&e&&t.enable(this._gl),e&&t.setup(e,s,n)}setupBaseAttributes(t){this._setupAttributes(this._baseAttributes,t)}setupTextAttributes(t){this._setupAttributes(this._textAttributes,t)}_resetStencil(){const t=this._gl;this._stencilUsage=su,t.disable(t.STENCIL_TEST)}setupStencil(t){if(t!==this._stencilUsage){const e=this._gl;t!==su?(e.enable(e.STENCIL_TEST),t===aC?(e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.stencilFunc(e.ALWAYS,1,1)):t===lC&&(e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.stencilFunc(e.EQUAL,0,1))):e.disable(e.STENCIL_TEST),this._stencilUsage=t}}endPass(){const t=this._gl;this._specialAttributes.disable(t),this._baseAttributes.disable(t),this._textAttributes.disable(t)}};function jO(t,e,s){return(n,i,r)=>{let o=0,a=0;for(let l=0;l<t.length;l++)a+=t[l].byteSize;e.bindBuffer(e.ARRAY_BUFFER,n),i&&e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW);for(let l=0;l<t.length;l++){const{location:u,size:h,glType:g,byteSize:f}=t[l];e.vertexAttribPointer(u,h,e[g],!1,a,o),o+=f,s.vertexAttribDivisorANGLE(u,r)}}}function HO(t,e,s){const n={};for(let i=0;i<t.length;++i){const{id:r,name:o}=t[i],a=e.getUniformLocation(s,o);a&&(n[r]=a)}return(i,r)=>{for(let o=0;o<t.length;++o){const{id:a,type:l}=t[o],u=n[a],h=r[a];if(u)switch(l){case"int":case"sampler2D":i.uniform1i(u,h);break;case"float":i.uniform1f(u,h);break;case"vec2":i.uniform2f(u,h[0],h[1]);break;case"vec3":i.uniform3f(u,h[0],h[1],h[2]);break;case"vec4":i.uniform4f(u,h[0],h[1],h[2],h[3])}}}}function $O(t){return e=>{for(let s=0;s<t.length;s++){const n=t[s].location;e.enableVertexAttribArray(n)}}}function qO(t){return e=>{for(let s=0;s<t.length;++s){const n=t[s].location;e.disableVertexAttribArray(n)}}}function i_(t,e,s){const n=$O(t),i=qO(t);return{enable(r){n(r),this.enabled=!0},disable(r){i(r),this.enabled=!1},setup:jO(t,e,s),enabled:!1}}var r_=`#define D3D9_FIX 0
precision highp float;
precision mediump int;
uniform vec3 u_backgroundColor;
uniform sampler2D u_patternNearestTexture;
uniform sampler2D u_patternLinearTexture;
uniform sampler2D u_patternLinearSdfTexture;
uniform sampler2D u_patternMipmapTexture;
uniform sampler2D u_shapeTexture;
varying vec4 a;
varying vec4 b;
varying vec4 c;
varying vec2 d;
varying vec2 e;
varying vec4 f;
varying float g;
#if D3D9_FIX
#else
varying float l;
varying vec2 m;
varying vec2 n;
varying vec2 o;
varying float p;
varying float q;
varying vec2 r;
varying vec2 s;
varying float t;
varying float u;
#endif
const float FILTER_NEAREST = 0.0;
const float FILTER_LINEAR = 0.0;
const float FILTER_LINEAR_SDF = 0.0;
const float FILTER_MIPMAP = 0.0;
const float SDF_GAMMA = 0.0;
const float EPSILON = 0.000000001;
const float SDF_BUFFER = (256.0 - 64.0) / 256.0; 
vec4 af(in vec4 ag, in vec4 ah) {
float ai = ah.a;
float aj = ag.a + EPSILON;
float ak = min(ai + aj, 1.0);
float r = ai / ak;
return vec4(mix(ag.rgb, ah.rgb, r), ak);
}
float al(in float am, in float an) {
float ao = (am * 256.0 + an) * 256.0;
float ap = ao / 32768.0;
return ap * 2.0 - 1.0;
}
bool aq(float ar, float as) {
return abs(ar - as) < EPSILON;
}
float at(float au) {
float bh = 2.;
vec2 bi = abs(c.rg) - c.ba - vec2(bh) + vec2(au);
float bj = min(max(bi.x, bi.y), 0.0) + length(max(bi, 0.0)) - au;
return smoothstep(0.1, .5, (1. - bj) / 10.);
}
void main() {
#if D3D9_FIX
#else
float br = o.x;
float bs = o.y;
float bt = r.x;
float bu = r.y;
#endif
vec4 bx = texture2D(u_shapeTexture, d);
float by = al(bx.b, bx.a) * s.x;
float bz = al(bx.r, bx.g) * s.y;
float ch = float(f.z > EPSILON);
float ci = float(f.w > EPSILON);
float cj = 1. - smoothstep(
0.01,
0.25760,
distance(f.xy * f.z - vec2(0.0586), d * f.z)
);
cj = cj * 2.5 - 1.5;
cj *= 0.5;
cj *= s.x;
float ck = at(g) ;
vec4 cl = a;
vec4 cm = b;
if (u > -EPSILON) {
vec2 cq = e;
float dd =
step(m.x, cq.x) *
step(cq.x, n.x) *
step(m.y, cq.y) *
step(cq.y, n.y);
float de = dd;
vec4 dh;
if (aq(u, FILTER_NEAREST)) {
dh = texture2D(u_patternNearestTexture, cq);
} else if (aq(u, FILTER_LINEAR)) { 
dh = texture2D(u_patternLinearTexture, cq);
} else if (aq(u, FILTER_LINEAR_SDF)) { 
dh = texture2D(u_patternLinearSdfTexture, cq);
dh.a = smoothstep(SDF_BUFFER - t, SDF_BUFFER + t, dh.a);
} else if (aq(u, FILTER_MIPMAP)) { 
dh = texture2D(u_patternMipmapTexture, cq);
}
dh.rgb += c.rgb;
dh.a *= de;
cl = af(cl, dh);
}
float dw = (1. - ch) * min(by, bz)
+ ch * cj;
dw = (1. - ci) * dw + ci * ck;
float ek = clamp(dw, 0.0, 1.0);
float en = clamp(dw - l, 0.0, 1.0);
float eo = ek - en;
eo = 1.0 - clamp(dw - l, 0.0, 1.0);
cl.a *= en;
cm.a *= eo * step(EPSILON, l);
vec4 ew = af(cl, cm);
float ex = ek;
ew.rgb = mix(u_backgroundColor, ew.rgb, br);
if (q > EPSILON) {
float fk = fract(bu) * q;
float fl = clamp(min(fk, bt - fk), 0.0, 1.0);
ex *= fl;
}
if (p < 0.0 || p > 1.0 || ex < EPSILON) {
discard;
}
ew.a *= ex;
ew.rgb *= ew.a;
gl_FragColor = ew;
}
`,o_=`#define D3D9_FIX 0
#define ANIMATED 0
precision highp float;
precision mediump int;
attribute /*ushort*/ vec4 a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;
attribute /*ushort*/ vec4 a_final_patternId_fillRGBA_strokeRGBA_patternRGBA;
attribute /*float*/ vec4 a_final_x1_y1_x2_y2;
attribute /*ushort*/ vec4 a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;
attribute /*ushort*/ vec4 a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;
attribute /*ushort*/ vec4 a_final_offsetScaled_offsetFixed_paddingTop_paddingLeft;
attribute /*ushort*/ vec4 a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;
attribute /*ushort*/ vec4 a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA;
attribute /*float*/ vec4 a_prev_x1_y1_x2_y2;
attribute /*ushort*/ vec4 a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;
attribute /*ushort*/ vec4 a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;
attribute /*ushort*/ vec4 a_prev_offsetScaled_offsetFixed_paddingTop_paddingLeft;
attribute /*float*/ vec2 a_animationBeginTime_animationDuration; 
attribute /*ushort*/ vec4 a_animationEasing; 
attribute /*ushort*/ vec3 a_text_charId_charOffsetXY; 
attribute vec3 a_vertexInfo;
uniform float u_viewWidth;
uniform float u_viewHeight;
uniform float u_viewX;
uniform float u_viewY;
uniform float u_viewAngle;
uniform float u_viewZoom;
uniform float u_currentTime;
uniform float u_pixelRatio;
uniform sampler2D u_patternInfoTexture;
varying vec4 a;
varying vec4 b;
varying vec4 c;
varying vec2 d;
varying vec2 e;
varying float g;
#if D3D9_FIX
#else
varying float l;
varying vec2 m;
varying vec2 n;
varying vec2 o;
varying float p;
varying float q;
varying vec2 r;
varying vec2 s;
varying float t;
varying float u;
#endif
varying vec4 f;
const float EPSILON = 0.000001;
const float INFINITY = 10000000.0;
const float PI = 3.14159265359;
const float P2_17 = 131072.0;
const float P2_16 = 65536.0;
const float P2_14 = 32768.0;
const float P2_12 = 4096.0;
const float P2_8 = 256.0;
const float P2_7 = 128.0;
const float P2_6 = 64.0;
const float P2_5 = 32.0;
const float P2_4 = 16.0;
const float P2_3 = 8.0;
const float P2_2 = 4.0;
const float P2_1 = 2.0;
const float MAX_FLOAT16_OFFSET = 16384.0;
const float MAX_FLOAT16 = 65535.0;
const float MAX_PROGRESS = 1.0;
uniform float BYTES_TO_COORD;
uniform float BYTES_TO_SCALED_SIZE;
uniform float BYTES_TO_MIN_VISIBLE_SIZE;
uniform float BYTES_TO_SYMBOLIC_SIZE;
uniform float BYTES_TO_CURVATURE;
uniform float BYTES_TO_DASH_LENGTH;
uniform float BYTES_TO_GAP_LENGTH;
uniform float BYTES_TO_PATTERN_SCALE;
uniform float PATTERN_POSITION_UNIT_SIZE;
uniform float PATTERN_INFO_TEXTURE_SIZE;
uniform float PATTERN_NEAREST_TEXTURE_SIZE;
uniform float PATTERN_LINEAR_TEXTURE_SIZE;
uniform float PATTERN_LINEAR_SDF_TEXTURE_SIZE;
uniform float PATTERN_MIPMAP_TEXTURE_SIZE;
uniform float ROUNDED_BOX_RADIUS;
const float BYTES_TO_OFFSET_ANGLE = 0.0;
const float BYTES_TO_COLOR = 0.0;
const float SDF_FONT_SIZE = 0.0;
const float SDF_GAMMA = 0.0;
const float CURVATURE_RATIO = 0.0;
const float PATTERN_PADDING = 0.0;
const float TEXT_WIDTH_MULTIPLIER = 0.0;
const float TEXT_HEIGHT_MULTIPLIER = 0.0;
const float SELF_LOOP_CURVATURE_RATIO = 0.0;
const float EDGE_ARROW_SIZE_RATIO = 0.0;
const float EDGE_MIN_TIP_SIZE = 0.0;
const float CURVE_SUBDIVISIONS = 0.0;
const float PIECE_NODE_COMPONENT = 0.0;
const float PIECE_TEXT_BOX = 0.0;
const float PIECE_EDGE_BODY = 0.0;
const float PIECE_EDGE_HEAD = 0.0;
const float PIECE_EDGE_TAIL = 0.0;
const float PIECE_EDGE_TEXT = 0.0;
const float MAX_TEXT_SIZE = 0.0;
const float BYTES_TO_TEXT_OFFSET_X = 0.0;
const float BYTES_TO_TEXT_OFFSET_Y = 0.0;
const float FILTER_NEAREST = 0.0;
const float FILTER_LINEAR = 0.0;
const float FILTER_LINEAR_SDF = 0.0;
const float FILTER_MIPMAP = 0.0;
const float SHAPE_TEXTURE_SIZE = 0.0;
const float SIMPLE_SHAPE_SAMPLING_SIZE = 0.0;
const float COMPLEX_SHAPE_SAMPLING_SIZE = 0.0;
const float SHAPE_SAMPLING_BUFFER_RATIO = 0.0;
const float MAX_SHAPES = 0.0;
const float FIRST_COMPLEX_SHAPE_ID = 0.0;
const float SELF_LOOP_TO_CIRCLE_APPROX = 0.0;
const float NB_SHAPES_BY_SIDE = SHAPE_TEXTURE_SIZE / COMPLEX_SHAPE_SAMPLING_SIZE;
const float SHAPE_FILL_PERCENT = 1.0 - SHAPE_SAMPLING_BUFFER_RATIO;
const float T_STEP_PER_CURVE_PIECE = 1.0 / CURVE_SUBDIVISIONS;
const float HEAD_TAIL_PX_ADJUST = 1.5;
const float SDF_SMOOTH_FACTOR = 2.0;
struct pv {
float pw;
float px;
float py;
float pz;
float qa;
float qb;
float qc;
float qd;
};
struct qe {
float qf;
float qg;
float qh;
float qi;
float qj;
float qk;
float ql;
};
struct qm {
float pw;
float px;
float py;
float pz;
float qa;
float qb;
float qc;
float qd;
float qf;
float qg;
float qh;
float qi;
float qj;
float qk;
float ql;
float dc;
float qn;
float qo;
float qp;
float qq;
float qr;
float qs;
vec4 cl;
vec4 cm;
vec4 dh;
float qt;
float qu;
float qv;
float qw;
float qx;
float qy;
float qz;
float ra;
float rb;
float rc;
float rd;
float re;
float rf;
float rg;
float rh;
float ri;
float rj;
float rk;
float rl;
};
struct rm {
float eu;
vec2 rn;
vec4 cl;
vec4 cm;
float dc;
float ro;
float rp;
float py;
float rq;
vec2 rr;
float rs;
vec2 cq;
vec2 rt;
vec2 ru;
float rv;
float rw;
vec4 dh;
vec2 bd;
float rx;
float or;
vec2 ry;
vec2 rz;
vec2 sa;
};
float sb(float nq, float sc, float sd) {
float se = mod(nq, pow(2.0, sd));
return floor(se / pow(2.0, sc));
}
pv sf(float nq) {
pv sg;
sg.pw = sb(nq, 0.0, 4.0);
sg.px = sb(nq, 4.0, 8.0);
sg.py = sb(nq, 8.0, 10.0);
sg.pz = sb(nq, 10.0, 12.0);
sg.qa = sb(nq, 12.0, 13.0);
sg.qb = sb(nq, 13.0, 14.0);
sg.qc = sb(nq, 14.0, 15.0);
sg.qd = sb(nq, 15.0, 16.0);
return sg;
}
qe sh(float nq) {
qe sg;
sg.qf = sb(nq, 0.0, 8.0);
sg.qg = sb(nq, 8.0, 11.0);
sg.qh = sb(nq, 11.0, 12.0);
sg.qi = sb(nq, 12.0, 13.0);
sg.qj = sb(nq, 13.0, 14.0);
sg.qk = sb(nq, 14.0, 15.0);
sg.ql = sb(nq, 15.0, 16.0);
return sg;
}
float si(float ll) {
float sj = mod(floor(ll / 32768.0), 2.0) == 1.0 ? -1.0 : 1.0; 
float sl = mod(floor(ll / 1024.0), 32.0); 
float sn = mod(ll, 1024.0); 
float sq = float(sl == 0.0 || sl == 31.0);
return (1. - sq)
* sj * pow(2.0, sl - 15.0) * (1.0 + sn / 1024.0);
}
vec4 sr(in float nq) {
return vec4(
sb(nq, 0.0, 4.0),
sb(nq, 4.0, 8.0),
sb(nq, 8.0, 12.0),
sb(nq, 12.0, 16.0)
);
}
vec2 ss(in float nq) {
return vec2(mod(nq, 256.0), floor(nq / 256.0));
}
vec2 st(in float nq) {
float su = floor(nq / P2_6);
float sv = nq - (su * P2_6);
return vec2(su, sv);
}
vec2 sw(in float nq) {
float sx = floor(nq / P2_7);
float sy = nq - (sx * P2_7);
return vec2(sx, sy);
}
vec2 sz(in vec2 ta, in float tb) {
float tc = cos(tb);
float td = sin(tb);
return vec2(tc * ta.x + td * ta.y, -td * ta.x + tc * ta.y);
}
vec4 te(in vec4 tf) {
return floor(tf / 256.0) - 128.0;
}
vec4 tg(in vec4 tf) {
return mod(tf, 256.0) - 128.0;
}
float th(float nq) {
return nq - 128.0;
}
vec2 th(vec2 nq) {
return nq - 128.0;
}
vec2 ti(vec2 tj) {
return vec2(-tj.y, tj.x);
}
vec2 tk(vec2 tl, vec2 ih, vec2 tm, float t) {
float tn = 1.0 - t;
return (tn * tn * tl) + (2.0 * tn * t * ih) + (t * t * tm);
}
vec2 to(vec2 tl, vec2 tp, vec2 tq, vec2 tm, float t) {
float tn = 1.0 - t;
float tr = tn * tn;
float ts = tr * tn;
float tt = t * t;
float tu = tt * t;
return (ts * tl) + (3.0 * tr * t * tp) + (3.0 * tn * tt * tq) + (tu * tm);
}
vec2 tv(vec2 tl, vec2 ih, vec2 tm, float t) {
float tn = (1.0 - t);
vec2 ta = (tn * ih + t * tm) - (tn * tl + t * ih);
return normalize(ta);
}
vec2 tw(vec2 tl, vec2 ih, vec2 tm, float t) {
return ti(tv(tl, ih, tm, t));
}
vec2 tx(vec2 tl, vec2 tp, vec2 tq, vec2 tm, float t) {
float tn = 1.0 - t;
float tr = tn * tn;
float tt = t * t;
vec2 ta = tr * (tp - tl) + 2.0 * tn * t * (tq - tp) + tt * (tm - tq);
return normalize(ta);
}
vec2 ty(vec2 tl, vec2 tp, vec2 tq, vec2 tm, float t) {
return ti(tx(tl, tp, tq, tm, t));
}
float uj(float qr, float uk, float t) {
float y = abs(qr) / CURVATURE_RATIO + EPSILON;
float qw = y * y;
float tn = t - 0.5;
float tr = tn * tn;
float ul = 1.0 / (16.0 * qw);
float um = sqrt(tr + ul);
float un = (0.5 / y) * sqrt(qw + 0.25);
float uo = (abs(2.0 * y)) * ((tn * um) + (0.5 * un) + (ul * log(abs((tn + um) / (-0.5 + un)))));
return uo * uk;
}
float uz(vec2 va, vec2 vb, vec2 vc, vec2 vd) {
bool vk = abs(va.x - vb.x - vc.x + vd.x) + abs(va.y - vb.y - vc.y + vd.y) < EPSILON;
float vl = 9.0 * pow(vb.x - va.x, 2.0); 
float vo = pow(-243.0 * va.x + 189.0 * vb.x + 51.0 * vc.x + 3.0 * vd.x, 2.0) / 10000.0; 
float vp = pow(-48.0 * va.x + 24.0 * vb.x + 21.0 * vc.x + 3.0 * vd.x, 2.0) / 625.0; 
float vq = pow(-147.0 * va.x + 21.0 * vb.x + 99.0 * vc.x + 27.0 * vd.x, 2.0) / 10000.0; 
float vr = pow(-27.0 * va.x - 9.0 * vb.x + 24.0 * vc.x + 12.0 * vd.x, 2.0) / 625.0; 
float vs = (9.0 / 16.0) * pow(vc.x + vd.x - va.x - vb.x, 2.0); 
float vt = 9.0 * pow(vb.y - va.y, 2.0); 
float vv = pow(-243.0 * va.y + 189.0 * vb.y + 51.0 * vc.y + 3.0 * vd.y, 2.0) / 10000.0; 
float vw = pow(-48.0 * va.y + 24.0 * vb.y + 21.0 * vc.y + 3.0 * vd.y, 2.0) / 625.0; 
float vx = pow(-147.0 * va.y + 21.0 * vb.y + 99.0 * vc.y + 27.0 * vd.y, 2.0) / 10000.0; 
float vy = pow(-27.0 * va.y - 9.0 * vb.y + 24.0 * vc.y + 12.0 * vd.y, 2.0) / 625.0; 
float vz = (9.0 / 16.0) * pow(vc.y + vd.y - va.y - vb.y, 2.0); 
float wa = sqrt(vl + vt); 
float wc = sqrt(vo + vv); 
float wd = sqrt(vp + vw); 
float we = sqrt(vq + vx); 
float wf = sqrt(vr + vy); 
float wg = sqrt(vs + vz); 
if(vk)
return (5.0 / 2993760.0) *
(32134.0 * wa +
212600.0 * wc -
97050.0 * wd +
544800.0 * we -
521100.0 * wf +
427368.0 * wg);
float wh = pow(-12.0 * va.x - 24.0 * vb.x + 9.0 * vc.x + 27.0 * vd.x, 2.0) / 625.0; 
float wi = pow(-27.0 * va.x - 99.0 * vb.x - 21.0 * vc.x + 147.0 * vd.x, 2.0) / 10000.0; 
float wj = pow(-3.0 * va.x - 21.0 * vb.x - 24.0 * vc.x + 48.0 * vd.x, 2.0) / 625.0; 
float wk = pow(-3.0 * va.x - 51.0 * vb.x - 189.0 * vc.x + 243.0 * vd.x, 2.0) / 10000.0; 
float wl = 9.0 * pow(vd.x - vc.x, 2.0); 
float wm = pow(-12.0 * va.y - 24.0 * vb.y + 9.0 * vc.y + 27.0 * vd.y, 2.0) / 625.0; 
float wn = pow(-27.0 * va.y - 99.0 * vb.y - 21.0 * vc.y + 147.0 * vd.y, 2.0) / 10000.0; 
float wo = pow(-3.0 * va.y - 21.0 * vb.y - 24.0 * vc.y + 48.0 * vd.y, 2.0) / 625.0; 
float wp = pow(-3.0 * va.y - 51.0 * vb.y - 189.0 * vc.y + 243.0 * vd.y, 2.0) / 10000.0; 
float wq = 9.0 * pow(vd.y - vc.y, 2.0); 
float wr = sqrt(wh + wm); 
float ws = sqrt(wi + wn); 
float wt = sqrt(wj + wo); 
float wu = sqrt(wk + wp); 
float wv = sqrt(wl + wq); 
return (5.0 / 2993760.0) *
(16067.0 * (wa + wv) +
106300.0 * (wc + wu) -
48525.0 * (wd + wt) +
272400.0 * (we + ws) -
260550.0 * (wf + wr) +
427368.0 * wg);
}
float ww(float nq) {
return nq - 32.0;
}
float wx(float nq) {
return nq - 512.0;
}
float wy(float nq) {
return nq - P2_14;
}
void wz() {
gl_Position = vec4(-10.0, -10.0, 1.0, 1.0);
}
vec4 xa(vec2 xb) {
return vec4(((vec2(xb.x, u_viewHeight - xb.y) / vec2(u_viewWidth, u_viewHeight)) * 2.0 - 1.0), 0.5, 1.0);
}
float xf(float ar, float as) {
return step(ar - EPSILON, as) * step(as, ar + EPSILON);
}
bool aq(float ar, float as) {
return abs(ar - as) < EPSILON;
}
bool xg(float nq) {
return nq > 0.5;
}
vec2 xh(vec2 xi) {
return sz((xi - vec2(u_viewX, u_viewY)) * u_viewZoom, u_viewAngle) + vec2(u_viewWidth, u_viewHeight) / 2.0;
}
float xj(float or) {
return max(EDGE_MIN_TIP_SIZE, or * EDGE_ARROW_SIZE_RATIO);
}
float xk(float xl, float xm) {
return xl * BYTES_TO_SCALED_SIZE * u_viewZoom + xm;
}
float xn(float xl, float xm) {
return xl * BYTES_TO_SCALED_SIZE * MAX_FLOAT16 / MAX_FLOAT16_OFFSET * u_viewZoom + xm;
}
float xo(float xl, float xm) {
return min(xl * BYTES_TO_SCALED_SIZE * MAX_FLOAT16 / MAX_FLOAT16_OFFSET * u_viewZoom, xm);
}
float xu(float ro, float xs, float xt) {
float xv = xt - xs;
float a = 1.0 / xv;
float b = -xs / xv;
return ro * a + b;
}
struct xw {
vec2 vb;
vec2 vc;
};
xw xx(vec2 xy, float au, float qr) {
xw ns;
float xz = (au + au / SELF_LOOP_CURVATURE_RATIO * qr) * SELF_LOOP_CURVATURE_RATIO;
float ya = -u_viewAngle + PI;
float yb = -u_viewAngle + PI / 2.0;
ns.vb = xy + vec2(cos(ya), sin(ya)) * xz;
ns.vc = xy + vec2(cos(yb), sin(yb)) * xz;
return ns;
}
float yc(vec2 yd, vec2 ye, vec2 yf, vec2 yg, float yh) {
const int MAX_ITERATIONS = 10; 
const float EPSILON = 0.01; 
float yo = 0.0;
float cf = 1.0;
float yp = 0.0;
for (int yq = 0; yq < MAX_ITERATIONS; yq++) {
float yr = (yo + cf) * 0.5;
vec2 ys = to(yd, ye, yf, yg, yr);
float yt = distance(yd, ys);
if (abs(yt - yh) < EPSILON) {
return yr;
}
if (yt < yh) {
yo = yr;
yp = yr;
} else {
cf = yr;
}
}
return yp;
}
float za(vec2 yd, vec2 ye, vec2 yf, vec2 yg, float yh, bool zb) {
if (!zb) {
return 1.0 - yc(yg, yf, ye, yd, yh);
}
return yc(yd, ye, yf, yg, yh);
}
qm ze(
vec4 zf,
vec4 zg,
vec4 zh,
vec4 zi,
vec4 zj,
vec4 zk,
vec3 zl
) {
qm a;
pv bx = sf(zf.x);
qe zm = sh(zf.y);
vec4 zn = sr(zf.z);
vec2 zo = ss(zf.w);
a.pw = bx.pw;
a.px = bx.px;
a.py = bx.py;
a.pz = bx.pz;
a.qa = bx.qa;
a.qb = bx.qb;
a.qc = bx.qc;
a.qd = bx.qd;
a.qf = zm.qf;
a.qg = zm.qg;
a.qh = zm.qh;
a.qi = zm.qi;
a.qj = zm.qj;
a.qk = zm.qk;
a.ql = zm.ql;
a.dc = zn.x;
a.qn = zn.y;
a.qo = zn.z;
a.qp = zn.w;
a.qq = zo.x;
a.qr = zo.y;
a.qs = zg.x;
a.cl = sr(zg.y);
a.cm = sr(zg.z);
a.dh = sr(zg.w);
a.qt = zh.x;
a.qu = zh.y;
a.qv = zh.z;
a.qw = zh.w;
a.qx = si(zi.x);
a.qy = zi.y;
a.qz = si(zi.z);
a.ra = zi.w;
a.rb = zj.x;
a.rc = zj.y;
a.rd = zj.z;
a.re = zj.w;
a.rf = zk.x;
a.rg = wy(zk.y);
a.rk = wy(zk.z);
a.rl = wy(zk.w);
a.rh = zl.x;
float x = zl.y;
float y = mod(x, P2_8);
if (zl.z > 0.0) x += zl.z * P2_16;
a.ri = ((x - y) / P2_8) - P2_16;
a.rj = (y - P2_7) * BYTES_TO_TEXT_OFFSET_Y;
return a;
}
bool aar(const in qm a, out rm ns) {
float pw = a.pw;
float px = a.px;
float py = a.py * BYTES_TO_DASH_LENGTH;
float pz = a.pz * BYTES_TO_GAP_LENGTH;
float qa = a.qa;
float qb = a.qb;
float qc = a.qc;
float qd = a.qd;
float qf = a.qf * BYTES_TO_PATTERN_SCALE;
float qg = a.qg * BYTES_TO_OFFSET_ANGLE;
float qh = a.qh;
float qi = a.qi;
float qj = a.qj;
float qk = a.qk;
float ql = a.ql;
float dc = a.dc * BYTES_TO_COLOR;
float qn = a.qn * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;
float qo = a.qo * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;
float qp = a.qp * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;
float qr = th(a.qr);
float qs = a.qs;
vec4 cl = a.cl * BYTES_TO_COLOR;
vec4 cm = a.cm * BYTES_TO_COLOR;
vec4 dh = a.dh * BYTES_TO_COLOR;
vec2 aas = vec2(a.qt, a.qu) * BYTES_TO_COORD;
vec2 aat = vec2(a.qv, a.qw) * BYTES_TO_COORD;
vec2 yd = xh(aas);
vec2 yg = xh(aat);
float aax = float(
qj > EPSILON &&
a.qy > EPSILON &&
a.ra > EPSILON
);
float aay = 1. - aax;
float aaz = aax * xo(
a.qx,
a.qy
) + aay * xn(
a.qx,
a.qy
);
float aba = aax * xo(
a.qz,
a.ra
) + aay * xn(
a.qz,
a.ra
);
float qq = a.qq * BYTES_TO_SYMBOLIC_SIZE * u_viewZoom +
step(a.qq, EPSILON) * INFINITY;
float abb = xk(a.rb, a.rc);
float eu = xk(a.rd, a.re);
float zt = xk(a.rf, a.rg);
vec2 abc = a_vertexInfo.xy;
vec2 abd = vec2(0.0, 0.0);
float abe = aaz;
float abf = aba;
float abg = aba * qf;
if (qh > EPSILON || dc< EPSILON) {
if (a.rh < EPSILON || dc< EPSILON) return false;
abg = abb;
qs = a.rh;
aaz = abg * TEXT_WIDTH_MULTIPLIER * u_pixelRatio;
aba = abg * TEXT_HEIGHT_MULTIPLIER * u_pixelRatio;
}
bool aca = abs(qr) > EPSILON && xf(px, PIECE_EDGE_BODY) < EPSILON;
bool acb = aca && a_vertexInfo.z > EPSILON;
if (pw < EPSILON || px < EPSILON || qq < qn || acb) {
return false;
}
eu *= step(qo, qq);
float aco = 0.0;
float acp = 1.0;
float acl = 0.0;
float acn = 1.0;
float acq = 0.0;
float ada = 1.0;
float adc = 1.0;
float adm = 0.0;
float adn = 0.0;
vec2 bd;
vec2 ry;
vec2 rz;
vec2 sa;
float or;
float rx;
float aee = 0.0;
float aef = 1.0;
bool ci = xf(px, PIECE_TEXT_BOX) > EPSILON;
if (xf(px, PIECE_NODE_COMPONENT) > EPSILON || ci) {
bd = ceil((yd + yg) / 2.0);
if(length(aat - aas) > EPSILON){
ry = normalize(aat - aas) * vec2(1.,-1.);
}else{
ry = vec2(1.0, 0.0);
}
rz = ti(ry);
sa = rz;
or = aaz;
rx = aba;
} else {
adc = 0.0;
float aev = distance(yd, yg);
vec2 aew = normalize(yg - yd);
vec2 aex = (yd + yg) / 2.0;
vec2 aey = ti(aew);
vec2 ye;
vec2 yf;
if (qk > EPSILON) {
vec2 afe = sz(yd, -u_viewAngle);
vec2 aff = sz(yg, -u_viewAngle);
float afi = 1. / (1. + exp(-qr));
if (ql > EPSILON) {
float afj = afi * afe.y + (1. - afi) * aff.y;
ye = vec2(afe.x, afj);
yf = vec2(aff.x, afj);
} else {
float afk = afi * afe.x + (1. - afi) * aff.x;
ye = vec2(afk, afe.y);
yf = vec2(afk, aff.y);
}
ye = sz(ye, u_viewAngle);
yf = sz(yf, u_viewAngle);
}
vec2 afl = aex + (aey * aev * -qr / CURVATURE_RATIO);
if (xf(px, PIECE_EDGE_TEXT) > 0.0
|| xf(px, PIECE_EDGE_TEXT + PIECE_TEXT_BOX) > 0.0
) {
ci = xf(px, PIECE_EDGE_TEXT + PIECE_TEXT_BOX) > 0.0;
float afm;
float afn = eu;
eu = 0.0;
if (qd > EPSILON) {
xw ih = xx(yd, afn / 2.0, qr);
bd = to(yd, ih.vb, ih.vc, yg, 0.5);
ry = tx(yd, ih.vb, ih.vc, yg, 0.5);
rz = ti(ry);
sa = rz;
afm = .5 * uz(yd, ih.vb, ih.vc, yg);
} else if (qk > EPSILON) {
bd = to(yd, ye, yf, yg, 0.5);
ry = tx(yd, ye, yf, yg, 0.5);
rz = ti(ry);
sa = rz;
afm = uz(yd, ye, yf, yg);
} else if (abs(qr) > EPSILON) {
bd = tk(yd, afl, yg, 0.5);
ry = tv(yd, afl, yg, 0.5);
rz = ti(ry);
sa = rz;
afm = uj(qr, aev, 1.0);
} else {
bd = aex;
ry = aew;
rz = aey;
sa = aey;
afm = aev;
}
or = aaz;
rx = aba;
if(abe > afm - afn && qd < EPSILON){
if(qi > EPSILON){
ry = vec2(1.0, 0.0);
rz = vec2(0.0, 1.0);
sa = vec2(0.0, 1.0);
} else {
ry = vec2(0,0);
rz = vec2(0.0, 0.0);
sa = vec2(0.0, 0.0);
}
} else {
float tb = -atan(ry.y, ry.x);
aee = tb;
qg -= tb;
if ((tb > PI / 2.0 || tb < -PI / 2.0)) {
qg += (1.0 - qd) * PI;
aef = -1.0;
ry *= -1.0;
rz *= -1.0;
sa *= -1.0;
}
}
} else {
float afu = aaz;
float afv = aba;
float afw = xj(abb);
float afx = qa
* min(5. * afu, afw);
float afy = qb
* min(5. * afv, afw);
float afz = xf(px, PIECE_EDGE_HEAD);
float aga = xf(px, PIECE_EDGE_TAIL);
float agb = INFINITY * qd + aev - afu - afv;
float agk = min(0., agb - afx - afy)/2.;
float agp = abb / 2.;
float agq =
afu > agp
? afu - sqrt(afu * afu - agp * agp)
: agp;
float agr = max( afu +
afy
+ qb * agk,
0.) - (1. - qa) * agq;
agq =
afv > agp
? afv - sqrt(afv * afv - agp * agp)
: agp;
float ags = max( afv +
afx
+ qa * agk
, 0.) - (1. - qb) * agq;
if(qk > EPSILON && qd < EPSILON) {
agr = afu + afy / 2.;
ags = afv + afx / 2.;
}
if (afz > EPSILON || aga > EPSILON) {
vec2 agx = afz * yg + aga * yd;
float zt = afz * ags + aga * agr + (HEAD_TAIL_PX_ADJUST - 0.5);
float agy = afz * afx + aga * afy;
vec2 agz;
if (qk > EPSILON && qd < EPSILON) {
float yh = afz > EPSILON ? ags : agr;
float t = za(yd, ye, yf, yg, yh, aga > EPSILON);
agz = to(yd, ye, yf, yg, t);
ry = normalize(agz - to(yd, ye, yf, yg, t - 0.01));
if(aga > EPSILON) ry *= -1.;
bd = agz;
} else {
if (qd > EPSILON) {
xw ih = xx(yd, afu, qr);
float yh = afz * ags + aga * agr;
float t = za(yd, ih.vb, ih.vc, yg, yh, aga > EPSILON);
agz = to(yd, ih.vb, ih.vc, yg, t);
} else {
float afm = uj(qr, aev, 1.0);
float t = (afz * (afm - ags) + aga * agr) / afm;
agz = tk(yd, afl, yg, t);
}
ry = normalize(agx - agz);
bd = agx - ry * (zt - agy / 2.0);
}
rz = ti(ry);
sa = rz;
or = agy;
rx = agy;
py = 0.0;
pz = 0.0;
} else {
float ahd;
float ahe;
float ahf;
if(qk > EPSILON && qd < EPSILON) {
float ahg = za(yd, ye, yf, yg, agr, true);
float ahh = za(yd, ye, yf, yg, ags, false);
float ahi = ahh - ahg;
float ahj = a_vertexInfo.z;
float ahk = (ahg + ahi * ahj * T_STEP_PER_CURVE_PIECE);
float tt = (ahg + ahi * (ahj + 1.) * T_STEP_PER_CURVE_PIECE);
vec2 ahl = to(yd, ye, yf, yg, ahk);
vec2 ahm = to(yd, ye, yf, yg, tt);
bd = (ahl + ahm) / 2.0;
ry = normalize(ahm - ahl);
rz = ty(yd, ye, yf, yg, ahk);
sa = ty(yd, ye, yf, yg, tt);
or = distance(ahl, ahm);
ahd = uz(yd, ye, yf, yg);
ahe = ahd * ahk;
ahf = ahd * tt;
} else {
if (abs(qr) < EPSILON) {
bd = aex;
ry = aew;
rz = aey;
sa = rz;
or = aev;
ahd = aev;
ahe = 0.0;
ahf = aev;
} else {
float ahj = a_vertexInfo.z;
float ahk = ahj * T_STEP_PER_CURVE_PIECE;
float tt = ahk + T_STEP_PER_CURVE_PIECE;
if (qd < EPSILON) {
vec2 ahl = tk(yd, afl, yg, ahk);
vec2 ahm = tk(yd, afl, yg, tt);
bd = (ahl + ahm) / 2.0;
ry = normalize(ahm - ahl);
rz = tw(yd, afl, yg, ahk);
sa = tw(yd, afl, yg, tt);
or = distance(ahl, ahm);
ahd = uj(qr, aev, 1.0);
ahe = uj(qr, aev, ahk);
ahf = uj(qr, aev, tt);
} else {
xw ih = xx(yd, afu, qr);
vec2 ye = ih.vb;
vec2 yf = ih.vc;
vec2 ahl = to(yd, ye, yf, yg, ahk);
vec2 ahm = to(yd, ye, yf, yg, tt);
bd = (ahl + ahm) / 2.0;
ry = normalize(ahm - ahl);
rz = ty(yd, ye, yf, yg, ahk);
sa = ty(yd, ye, yf, yg, tt);
or = distance(ahl, ahm);
ahd = uz(yd, ye, yf, yg);
ahe = ahk * ahd;
ahf = tt * ahd;
}
}
}
rx = abb;
if(qd > EPSILON) {
xw ih = xx(yd, afu, qr);
float ahq = za(yd, ih.vb, ih.vc, yg, agr, true);
float ahh = za(yd, ih.vb, ih.vc, yg, ags, false);
acl = ahq;
acn = ahh;
} else if(qk < EPSILON) {
acl = (agr - 1.0) / ahd;
acn = MAX_PROGRESS - (ags - HEAD_TAIL_PX_ADJUST) / ahd;
}
aco = ahe / ahd;
acp = ahf / ahd;
acq = ahd;
if (abb < EPSILON)
cl.a = 0.; 
if (qc > 0.0 && agb > 5.0) {
float ahu = (ahd * rx) / (ahd - agr);
float ahv = ahd;
float qt = agr;
float qv = ahd - ags;
float a = -ahu / ahv;
float b = ahu;
float qu = a * qt + b;
float qw = a * qv + b;
float ahw = qu / (qt - qv);
float bi = -ahw * qv;
rx = min(min(bi, afu), afv);;
adn = ahw * ahv + bi + 1.0;
}
}
}
}
vec2 cq = vec2(0.0, 0.0);
vec2 rt = vec2(EPSILON, EPSILON);
vec2 ru = vec2(-EPSILON, -EPSILON);
float rv = -1.0;
float rw = 0.0;
bool ahy = false;
vec2 ahz = vec2(0,0);
vec2 aia = vec2(0,0);
vec2 aib = vec2(0,0);
if (qs > EPSILON && qq > qp) {
float aie = floor(qs / PATTERN_INFO_TEXTURE_SIZE);
float aif = qs - (aie * PATTERN_INFO_TEXTURE_SIZE);
vec4 aig = texture2D(u_patternInfoTexture, vec2(aif, aie) / 255.0) * 255.0;
vec2 aih = sw(aig.z);
vec2 aii = sw(aig.w);
rv = aih.x * 2.0 + aii.x;
float aij = 0.0;
if (aq(rv, FILTER_NEAREST)) { 
aij = PATTERN_NEAREST_TEXTURE_SIZE;
} else if (aq(rv, FILTER_LINEAR)) { 
aij = PATTERN_LINEAR_TEXTURE_SIZE;
} else if (aq(rv, FILTER_LINEAR_SDF)) { 
aij = PATTERN_LINEAR_SDF_TEXTURE_SIZE;
ahy = true;
} else if (aq(rv, FILTER_MIPMAP)) { 
aij = PATTERN_MIPMAP_TEXTURE_SIZE;
}
float aim = 1.0 / aij;
vec2 ain = (vec2(aih.y, aii.y) * PATTERN_POSITION_UNIT_SIZE) * aim / 2.0;
aia += (aig.xy * PATTERN_POSITION_UNIT_SIZE * aim) + ain;
ain -= PATTERN_PADDING * aim * 2.0;
vec2 aio = vec2(or / 2.0, rx / 2.0) * aim;
vec2 aip = vec2(eu, eu) * aim;
float air = 1.0 * u_pixelRatio;
float ais = SDF_SMOOTH_FACTOR;
if (qf > EPSILON) {
if (ahy) { 
if (a.qj > EPSILON) {
ais = SDF_SMOOTH_FACTOR * u_pixelRatio / SDF_GAMMA;
ahz = vec2(-a.rl,-a.rk);
}
rw = ais * SDF_GAMMA / abg / u_pixelRatio;
air = SDF_FONT_SIZE / abg;
} else { 
air = (ain.y / aio.y) / qf;
}
}
aib = (aio + aip) * air;
ain += PATTERN_PADDING * aim;
rt = aia - ain;
ru = aia + ain;
}
if (qh > EPSILON) {
abd.y = (a.rj) * abg;
ada = 0.0;
adc = 0.0;
abd.x = a.ri * abg * BYTES_TO_TEXT_OFFSET_X;
abd = sz(abd, aee);
abd *= aef;
}
vec2 aix = vec2(cos(qg), sin(qg)) * zt;
vec2 aiy = bd + aix + abd;
float aiz = eu * 2.0;
float aja = or + adc * (aiz + 1.0);
float ajb = rx + ada * (aiz + 1.0);
vec2 ajc = ry * aja / 2.0;
vec2 ajd = rz * ajb / 2.0;
vec2 aje = sa * ajb / 2.0;
float ajf = (acp - aco);
float ajg = abc.x / 2.0 + 0.5;
float ro = aco + ajf * ajg;
float rs = adm + (adn - adm) * ro / 2.0;
float ajh = step(pw, FIRST_COMPLEX_SHAPE_ID - EPSILON);
float aji = ajh * SIMPLE_SHAPE_SAMPLING_SIZE + (1.0 - ajh) * COMPLEX_SHAPE_SAMPLING_SIZE;
float ajj = aji / COMPLEX_SHAPE_SAMPLING_SIZE;
float ajk = ajj * SHAPE_SAMPLING_BUFFER_RATIO / 2.0;
float ajl = ajj * (1.0 - SHAPE_SAMPLING_BUFFER_RATIO);
vec2 ajs = vec2(
mod(pw, NB_SHAPES_BY_SIDE),
floor(pw / NB_SHAPES_BY_SIDE)
);
vec2 ajt = ajs + vec2(ajk) +
vec2(aco * ajl, 0.0);
vec2 ajw = vec2(ajf, 1.0) * ajl;
vec2 rn = (ajt + ajw * (abc / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE;
vec2 rr = vec2(aja / ajf, ajb) / 2.0;
float akc = py * abb;
float akd = pz * abb;
float rp = akc + akd;
float rq = (ro * acq) / rp;
cq = aia
+ aib
* (abc + ahz / rr * u_viewZoom);
ns.rn = rn;
float ch = float(pw == 1.);
f = vec4(
(ajt + ajw * (vec2(0.5,0.5) / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE,
NB_SHAPES_BY_SIDE * (1. - qh) * ch,
float(ci)
);
ns.rr = rr;
ns.eu = eu;
ns.cl = cl;
ns.cm = cm;
ns.dc = dc;
ns.ro = xu(ro, acl, acn);
ns.rp = rp;
ns.py = akc;
ns.rq = rq;
ns.rs = rs;
ns.cq = cq;
ns.rt = rt;
ns.ru = ru;
ns.rv = rv;
ns.rw = rw;
ns.dh = dh;
ns.bd = aiy;
ns.or = aja + ch;
ns.rx = ajb + ch;
ns.ry = ry;
ns.rz = rz;
ns.sa = sa;
return true;
}
float aki(float akj, float akk, vec4 akl) {
float akm = clamp(((u_currentTime - akj) / akk), 0.0, 1.0);
float r = akm;
float akn = r * r;
float ako = akn * r;
vec4 akp = akm < 0.5 ? te(akl) : tg(akl);
float akq = akp.x;
float akr = akp.y;
float aks = akp.z;
float akt = akp.w;
float aku = akq + akr * r + aks * akn + akt * ako;
return aku;
}
void main() {
qm a_final = ze(
a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,
a_final_patternId_fillRGBA_strokeRGBA_patternRGBA,
a_final_x1_y1_x2_y2,
a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,
a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,
a_final_offsetScaled_offsetFixed_paddingTop_paddingLeft,
a_text_charId_charOffsetXY
);
#if ANIMATED
float akj = a_animationBeginTime_animationDuration.x;
float akk = a_animationBeginTime_animationDuration.y;
vec4 akl = a_animationEasing;
float aaq = aki(akj, akk, akl);
qm a_prev = ze(
a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,
a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA,
a_prev_x1_y1_x2_y2,
a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,
a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,
a_prev_offsetScaled_offsetFixed_paddingTop_paddingLeft,
a_text_charId_charOffsetXY
);
const float ONE = 1.0;
a_final.pw = mix(a_prev.pw, a_final.pw, ONE);
a_final.py = mix(a_prev.py, a_final.py, aaq);
a_final.pz = mix(a_prev.pz, a_final.pz, aaq);
a_final.qa = mix(a_prev.qa, a_final.qa, ONE);
a_final.qb = mix(a_prev.qb, a_final.qb, ONE);
a_final.px = mix(a_prev.px, a_final.px, ONE);
a_final.qf = mix(a_prev.qf, a_final.qf, ONE);
a_final.qh = mix(a_prev.qh, a_final.qh, ONE);
a_final.qi = mix(a_prev.qi, a_final.qi, ONE);
a_final.qj = mix(a_prev.qj, a_final.qj, ONE);
a_final.qk = mix(a_prev.qk, a_final.qk, ONE);
a_final.qd = mix(a_prev.qd, a_final.qd, ONE);
a_final.qg = mix(a_prev.qg, a_final.qg, aaq);
a_final.dc = mix(a_prev.dc, a_final.dc, aaq);
a_final.qn = mix(a_prev.qn, a_final.qn, aaq);
a_final.qo = mix(a_prev.qo, a_final.qo, aaq);
a_final.qp = mix(a_prev.qp, a_final.qp, aaq);
a_final.qq =mix(a_prev.qq, a_final.qq, aaq);
a_final.qr = mix(a_prev.qr, a_final.qr, aaq);
a_final.qs = mix(a_prev.qs, a_final.qs, ONE);
a_final.cl = mix(a_prev.cl, a_final.cl, aaq);
a_final.cm = mix(a_prev.cm, a_final.cm, aaq);
a_final.dh = mix(a_prev.dh, a_final.dh, aaq);
a_final.qt = mix(a_prev.qt, a_final.qt, aaq);
a_final.qu = mix(a_prev.qu, a_final.qu, aaq);
a_final.qv = mix(a_prev.qv, a_final.qv, aaq);
a_final.qw = mix(a_prev.qw, a_final.qw, aaq);
a_final.qx = mix(a_prev.qx, a_final.qx, aaq);
a_final.qy = mix(a_prev.qy, a_final.qy, aaq);
a_final.qz = mix(a_prev.qz, a_final.qz, aaq);
a_final.ra = mix(a_prev.ra, a_final.ra, aaq);
a_final.rb = mix(a_prev.rb, a_final.rb, aaq);
a_final.rc = mix(a_prev.rc, a_final.rc, aaq);
a_final.rd = mix(a_prev.rd, a_final.rd, aaq);
a_final.re = mix(a_prev.re, a_final.re, aaq);
a_final.rf = mix(a_prev.rf, a_final.rf, aaq);
a_final.rg = mix(a_prev.rg, a_final.rg, aaq);
a_final.rh = mix(a_prev.rh, a_final.rh, ONE);
a_final.ri = mix(a_prev.ri, a_final.ri, ONE);
a_final.rj = mix(a_prev.rj, a_final.rj, ONE);
#endif
rm ns;
bool aky = aar(a_final, ns);
if (!aky) {
wz();
return;
}
vec2 abc = a_vertexInfo.xy;
a = ns.cl;
b = ns.cm;
c = ns.dh;
d = ns.rn;
e = ns.cq;
#if D3D9_FIX
#else
l = ns.eu;
m = ns.rt;
n = ns.ru;
o = vec2(ns.dc, ns.rs);
p = ns.ro;
q = ns.rp;
r = vec2(ns.py, ns.rq);
s = ns.rr;
t = ns.rw;
u = ns.rv;
#endif
float alb = step(abc.x, 0.0);
float alc = 1.0 - alb;
g = min(ns.rx, ROUNDED_BOX_RADIUS * 2.) * u_pixelRatio;
vec2 xb = ns.bd
+ ns.ry * (ns.or / 2.0) * abc.x
+ (alb * ns.rz + alc * ns.sa) * ns.rx / 2.0 * abc.y;
c = c * (1. - f.w)
+ vec4(
abc.x * ns.or,
abc.y * ns.rx,
ns.or,
ns.rx
) * u_pixelRatio * f.w;
gl_Position = xa(xb);
}
`,Vd=1e20,YO=class{constructor({fontSize:t=24,buffer:e=8,radius:s=6,cutoff:n=.25}={}){this._maxDimension=1,this._gridSize=1,this._fontSize=t,this._buffer=e,this._radius=s,this._cutoff=n,this._height=Math.ceil(this._fontSize+2*this._buffer*xf),this._canvas=Pn(),this._canvas.height=this._height,this._canvas.width=1;const i=this._canvas.getContext("2d",{willReadFrequently:!0});this._ctx=i,i.textBaseline="middle",i.textAlign="center",i.fillStyle="black"}setOptions({fontSize:t=24,buffer:e=8,cutoff:s=.25,radius:n=6}){this._fontSize=t,this._buffer=e,this._cutoff=s,this._radius=n,this._height=Math.ceil(this._fontSize+2*this._buffer*xf)}draw(t,e,s){Zo(this._ctx,e,this._fontSize,s);const n=WO(this._ctx.measureText(t).width+2*this._buffer)-2*Wo,i=this._height,r=n*i,o=Math.max(n,i);this._canvas.width<n&&(this._canvas.width=n,Zo(this._ctx,e,this._fontSize,s),this._ctx.textAlign="center",this._ctx.textBaseline="middle",this._ctx.fillStyle="black"),r>this._gridSize&&(this._gridOuter=new Float64Array(r),this._gridInner=new Float64Array(r),this._gridSize=r),o>this._maxDimension&&(this._f=new Float64Array(o),this._d=new Float64Array(o),this._z=new Float64Array(o+1),this._v=new Int16Array(o),this._maxDimension=o),this._ctx.clearRect(0,0,n,i),this._ctx.fillText(t,n/2,i/2);const a=this._ctx.getImageData(0,0,n,i),l=new Uint8ClampedArray(r);for(let u=0;u<r;u++){const h=a.data[4*u+3]/255;this._gridOuter[u]=h===1?0:h===0?Vd:Math.pow(Math.max(0,.5-h),2),this._gridInner[u]=h===1?Vd:h===0?0:Math.pow(Math.max(0,h-.5),2)}CS(this._gridOuter,n,i,this._f,this._d,this._v,this._z),CS(this._gridInner,n,i,this._f,this._d,this._v,this._z);for(let u=0;u<r;u++){const h=this._gridOuter[u]-this._gridInner[u];l[u]=Math.max(0,Math.min(255,Math.round(255-255*(h/this._radius+this._cutoff))))}return{height:i,width:n,distance:l}}};function CS(t,e,s,n,i,r,o){for(let a=0;a<e;a++){for(let l=0;l<s;l++)n[l]=t[l*e+a];LS(n,i,r,o,s);for(let l=0;l<s;l++)t[l*e+a]=i[l]}for(let a=0;a<s;a++){for(let l=0;l<e;l++)n[l]=t[a*e+l];LS(n,i,r,o,e);for(let l=0;l<e;l++)t[a*e+l]=Math.sqrt(i[l])}}function LS(t,e,s,n,i){s[0]=0,n[0]=-Vd,n[1]=+Vd;for(let r=1,o=0;r<i;r++){let a=(t[r]+r*r-(t[s[o]]+s[o]*s[o]))/(2*r-2*s[o]);for(;a<=n[o];)o--,a=(t[r]+r*r-(t[s[o]]+s[o]*s[o]))/(2*r-2*s[o]);o++,s[o]=r,n[o]=a,n[o+1]=+Vd}for(let r=0,o=0;r<i;r++){for(;n[o+1]<r;)o++;e[r]=(r-s[o])*(r-s[o])+t[s[o]]}}function WO(t){return Math.ceil((t+2*Wo)/jn)*jn}var eg=256,XO=.275,ZO=.25,KO=6,QO=iD-2*Wo,JO=nD-2*Wo,NS={fontSize:sh,cutoff:XO,radius:KO},tB={fontSize:sh,cutoff:ZO,radius:8},eB=class{constructor(t,e){this._patternIdToInfoTexture=new Uint8Array(eg*eg*4),this._glTextures=[],this._textureSizes=[],this._pixelRatio=1,this._gl=t,this._glUnit=e;const s=Pn(or,or),n=s.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("Pattern: could not get 2d context");this._imageCanvasContext=n,this._imageCanvas=s,this._sdfGenerator=new YO(NS),this._maxTextureSize=Math.min(4096,t.getParameter(t.MAX_TEXTURE_SIZE))}refresh(t){this._pixelRatio=t.getPixelRatio();const e=this._gl,s=this._getPatternsByFilter(t.getPatternList());for(let r=0;r<s.length;++r){const o=r,a=s[r],l=LO(a,this._maxTextureSize),{texture:u,size:h}=OC(o,a,l,this._maxTextureSize,this._patternIdToInfoTexture),g=this._glTextures[o]||(this._glTextures[o]=e.createTexture()),f=o===Ql?y0:zy;ES(e,g,this._glUnit+1+o,u,h,o,f),this._textureSizes[o]=h}const n=this._glTextureInfo||(this._glTextureInfo=e.createTexture()),i=this._patternIdToInfoTexture;ES(e,n,this._glUnit,i,eg,Ql,zy)}bindMetaDataTexture(){const t=this._gl;t.activeTexture(t.TEXTURE0+this._glUnit),t.bindTexture(t.TEXTURE_2D,this._glTextureInfo)}getInfoTextureUnit(){return this._glUnit}getNearestTextureUnit(){return this._glUnit+1+Ql}getLinearTextureUnit(){return this._glUnit+1+Ud}getLinearSdfTextureUnit(){return this._glUnit+1+Gd}getMipmapTextureUnit(){return this._glUnit+1+wa}getInfoTextureSize(){return eg}getNearestTextureSize(){return this._textureSizes[Ql]}getLinearTextureSize(){return this._textureSizes[Ud]}getLinearSdfTextureSize(){return this._textureSizes[Gd]}getMipmapTextureSize(){return this._textureSizes[wa]}_getPatternsByFilter(t){const e=new Array(xS);for(let s=0;s<xS;++s)e[s]=[];for(let s=0;s<t.length;++s){const n=this._getPatternPixels(t[s]);e[n.filter].push(n)}return e}_getPatternPixels({id:t,type:e,attributes:s}){let n;const{text:i,font:r,style:o,image:a,scaled:l,duplicated:u,colorArray:h}=s;switch(e){case qo:n=u?this._getDuplicatedImagePixels(a):l?this._getScaledImagePixels(a):this._getNonScaledImagePixels(a);break;case Ma:n=this._getSdfTextPixels(i,r,o);break;case Da:n=this._getIconPixels(i,r,o);break;case Oa:n=this._getBadgeIconPixels(i,r,o);break;case Nh:n=this._getPieChartPixels(h);break;default:throw new Error(`pattern type "${e}" does not exist`)}return n.id=t,n}_getScaledImagePixels(t){let e=t.width,s=t.height;if(e>0){const n=or/Math.max(t.width,t.height);e*=n,s*=n}return e&&s&&(e=fu(e),s=fu(s)),e-=2*Wo,s-=2*Wo,this._getImagePixels(t,e,s)}_getNonScaledImagePixels(t){return this._getImagePixels(t,t.width,t.height)}_getDuplicatedImagePixels(t){if(t.width===0||t.height===0)return this._getImagePixels(t,0,0);this._canvasForDuplicatedImage||(this._canvasForDuplicatedImage=Pn(or,or));const e=this._canvasForDuplicatedImage,s=e.getContext("2d"),n=t.width,i=t.height;let r=(or-n)/2,o=(or-i)/2;for(;r>0;)r-=n;for(;o>0;)o-=i;for(let a=r;a<or;a+=n)for(let l=o;l<or;l+=i)s.drawImage(t,a,l);return this._getImagePixels(e,or,or)}_getImagePixels(t,e,s){let n;if(e===0||s===0)n=new Uint8Array(0);else{(this._imageCanvas.width<e||this._imageCanvas.height<s)&&(this._imageCanvas.width=e,this._imageCanvas.height=s);const i=this._imageCanvasContext;Iy(this._imageCanvas,i,e,s);try{i.drawImage(t,0,0,e,s)}catch{}n=i.getImageData(0,0,e,s).data}return{width:e,height:s,pixels:n,filter:wa}}_getPieChartPixels(t){const e=JO,s=this._imageCanvasContext,n=e/2,i=e/2;return Iy(this._imageCanvas,s,e,e),s.save(),s.rect(0,0,e,e),s.clip(),UC(s,t,n,i,e),s.restore(),{width:e,height:e,pixels:s.getImageData(0,0,e,e).data,filter:Ud}}_getTextPixels(t,e,s,n,i,r){const o=this._imageCanvasContext,a=i*this._pixelRatio;Zo(o,s,a,n);let l=Math.ceil(o.measureText(e).width);l===0&&(l=a);let u=0,h=0;t===wa||(u=2*Math.ceil(a*xf/2),h=2*Math.ceil(l*J2/2));const g=Math.ceil(l+h),f=Math.ceil(a+u),p=this._imageCanvas.height<f||this._imageCanvas.width<g;return this._imageCanvas.height<f&&(this._imageCanvas.height=f),this._imageCanvas.width<g&&(this._imageCanvas.width=g),p&&Zo(o,s,a,n),o.clearRect(0,0,g,f),o.fillStyle="black",o.textBaseline="middle",o.textAlign="left",o.fillText(e,r+h/2,f/2),{width:g,height:f,pixels:o.getImageData(0,0,g,f).data,filter:t}}_getIconPixels(t,e,s){return this._getTextPixels(wa,t,e,s,QO,0)}_getBadgeIconPixels(t,e,s){return this._sdfGenerator.setOptions(tB),this._getSdfPixels(t,e,s)}_getSdfTextPixels(t,e,s){return this._sdfGenerator.setOptions(NS),this._getSdfPixels(t,e,s)}_getSdfPixels(t,e,s){const{width:n,height:i,distance:r}=this._sdfGenerator.draw(t,e,s),o=new Uint8Array(n*i*4);for(let a=0;a<r.length;++a)o[4*a+3]=r[a];return{width:n,height:i,pixels:o,filter:Gd}}},sB=class{constructor(t,e){this._gl=t,this._glTextureUnit=e,this._simpleShapePixels=new Uint8Array(Vg*Vg*4),this._complexShapePixels=new Uint8Array(Uo*Uo*4),this._shapesWritten=new Set}refresh(t){const e=t.getShapeList();for(const s of e)if(!this._shapesWritten.has(s.id)){const n=s.isSimple?Vg:Uo,i=s.isSimple?this._simpleShapePixels:this._complexShapePixels;NO(s,n,Ty,i),this._loadShapeInGpu(s.id,n,i),this._shapesWritten.add(s.id)}}_loadShapeInGpu(t,e,s){const n=this._gl,i=Ly,r=t%Cy*Uo,o=Math.floor(t/Cy)*Uo;if(this._texture)n.bindTexture(n.TEXTURE_2D,this._texture);else{const a=new Uint8Array(i*i*4);this._texture=n.createTexture(),n.activeTexture(n.TEXTURE0+this._glTextureUnit),n.bindTexture(n.TEXTURE_2D,this._texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,i,i,0,n.RGBA,n.UNSIGNED_BYTE,a)}n.texSubImage2D(n.TEXTURE_2D,0,r,o,e,e,n.RGBA,n.UNSIGNED_BYTE,s)}getTextureSize(){return Ly}getSamplingSize(){return Uo}getBufferRatio(){return Ty}getTextureUnit(){return this._glTextureUnit}rewriteShape(t){this._shapesWritten.delete(t)}},MS=class{constructor(t,{vertex:e,fragment:s,constants:n,macros:i}){this._state=0,this._gl=t,this._vertexSource=e,this._fragmentSource=s,this._constants=Zs(n||{}),this._macros=Zs(i||{})}setConstant(t,e){this._constants[t]=e}setMacro(t,e){this._macros[t]=e}getState(){return this._state}getProgram(){return this._program}compile(){const t=this._gl,e=kS(this._vertexSource,this._macros,this._constants),s=kS(this._fragmentSource,this._macros,this._constants);this._program&&(t.deleteProgram(this._program),t.deleteShader(this._vertexShader),t.deleteShader(this._fragmentShader));const n=t.createProgram(),i=t.createShader(t.VERTEX_SHADER),r=t.createShader(t.FRAGMENT_SHADER);if(!(n&&i&&r))throw new Error("Error instantiating WebGL program");this._program=n,this._vertexShader=i,this._fragmentShader=r,t.shaderSource(this._vertexShader,e),t.compileShader(this._vertexShader),t.attachShader(this._program,this._vertexShader),t.shaderSource(this._fragmentShader,s),t.compileShader(this._fragmentShader),t.attachShader(this._program,this._fragmentShader),t.linkProgram(this._program),this._state=1}getError(){const t=this._gl;if(!t.getShaderParameter(this._vertexShader,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(this._vertexShader)||"";let s=e;const n=e.match(/ERROR: (\d+):(\d+):(.*)\n/g);if(n&&n.length){const i=this._vertexSource.split(`
`);s=n.map((r=>{const o=r.match(/ERROR: (\d+):(\d+):(.*)\n/);if(!o)return r;const[a,l]=o.slice(2);return`${i[+a]}
${i[+a+1]}
~~~~~~~~~~~
${i[+a+2]}
 -> ${l}`})).join(`
`)}return{step:"vertex",message:s}}return t.getShaderParameter(this._fragmentShader,t.COMPILE_STATUS)?t.getProgramParameter(this._program,t.LINK_STATUS)?(this._state=2,null):{step:"link",message:t.getProgramInfoLog(this._program)||""}:{step:"fragment",message:t.getShaderInfoLog(this._fragmentShader)||""}}};function kS(t,e,s){const n=Object.keys(e),i=Object.keys(s);for(let r=0;r<n.length;++r){const o=n[r],a=e[o];t=t.replace(`#define ${o} 0`,`#define ${o} ${a}`)}for(let r=0;r<i.length;++r){const o=i[r],a=s[o],l=a+(a%1==0?".0":"");t=t.replace(`const float ${o} = 0.0;`,`const float ${o} = ${l};`)}return t}function nB(){return typeof window<"u"&&!!window.FORCE_WEBGL}/** @preserve instance id */var IS=xC(),iB={stencil:!0,antialias:!1,alpha:!0,premultipliedAlpha:!0,failIfMajorPerformanceCaveat:!nB()},rB=0,oB=1,aB={NO_WEBGL:'Unable to create a WebGL context: `canvas.getContext("webgl")` and `canvas.getContext("experimental-webgl")` returned `null`',NO_ANGLE_INSTANCED_ARRAYS:'WebGL extension "ANGLE_instanced_arrays" unavailable: `gl.getExtension("ANGLE_instanced_arrays")` returned `null`'},VC=class extends Error{};function a_(t,e){if(!t&&e){const s=new VC(aB[e]);throw s.code=e,s}}var lB=class jC extends ro{constructor(e){super(e),this._2dcanvas=Pn(),this._ctx=this._2dcanvas.getContext("2d"),this._bufferDrawers=[],this._mustResize=!1,this._error=null,this._onContextLost=l=>{l.preventDefault(),this._error=new VC("WebGL context lost"),this.fire("error",this._error)};const s=jC.createInitData(),{canvas:n,gl:i,ext:r,staticProgramWrapper:o,animationProgramWrapper:a}=s;a_(i,"NO_WEBGL"),a_(r,"NO_ANGLE_INSTANCED_ARRAYS"),this._glCanvas=n,this._gl=i,this._ext=r,this._staticProgramWrapper=o,this._animationProgramWrapper=a,this._shapeTexture=new sB(this._gl,rB),this._patternTexture=new eB(this._gl,oB),this._initCanvas(this._glCanvas),this._computeShaderInfo(),this._initSpecialGlBuffers(),this._initGlPrograms(),this._initGl()}_initCanvas(e){super._initCanvas(e),e.addEventListener("webglcontextlost",this._onContextLost,!1)}static isAvailable(){return IS||a_(null,"NO_WEBGL"),IS}static createInitData(){const e=Pn(),s=d0(e,iB,"webgl"),n=s&&typeof s.getExtension=="function"?s.getExtension("ANGLE_instanced_arrays"):null,i=hB(),r=new MS(s,{vertex:o_,fragment:r_,constants:i,macros:{ANIMATED:0}}),o=new MS(s,{vertex:o_,fragment:r_,constants:i,macros:{ANIMATED:1}});return s&&n&&(r.compile(),s.flush()),{canvas:e,gl:s,ext:n,staticProgramWrapper:r,animationProgramWrapper:o}}static getName(){return"WebGL"}_beforeFirstFrame(){this._animationProgramWrapper.getState()===0&&this._animationProgramWrapper.compile()}ensureAnimationsReady(){const e=this._animationProgramWrapper.getState();e!==2&&(e===0&&this._animationProgramWrapper.compile(),this._animationProgramWrapper.getError())}getDomElement(){return this._glCanvas}_initGl(){const e=this._gl;e.clearColor(0,0,0,0),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA)}_computeShaderInfo(){this._shaderMetadata=uB(o_,r_)}_initGlPrograms(){this._staticProgram=new TS({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._staticProgramWrapper}),this._animationProgram=new TS({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._animationProgramWrapper})}_initSpecialGlBuffers(){const e=this._gl,s=e.createBuffer(),n=new Int8Array(18*_i);for(let i=0;i<_i;++i){const r=[-1,-1,i,1,-1,i,1,1,i,-1,-1,i,-1,1,i,1,1,i],o=i*r.length;for(let a=0;a<r.length;a++)n[a+o]=r[a]}e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),this._specialGlBuffers={vertexInfo:s}}_computeUniforms(){return{viewWidth:this._width,viewHeight:this._height,viewX:this._viewX,viewY:this._viewY,viewZoom:this._viewZoom,viewAngle:this._viewAngle,currentTime:this._currentTime,pixelRatio:this._pixelRatio,backgroundColor:this._backgroundRgba,patternInfoTexture:this._patternTexture.getInfoTextureUnit(),patternNearestTexture:this._patternTexture.getNearestTextureUnit(),patternLinearTexture:this._patternTexture.getLinearTextureUnit(),patternLinearSdfTexture:this._patternTexture.getLinearSdfTextureUnit(),patternMipmapTexture:this._patternTexture.getMipmapTextureUnit(),shapeTexture:this._shapeTexture.getTextureUnit(),BYTES_TO_COORD:this._scales.bytesToActualCoord,BYTES_TO_SCALED_SIZE:this._scales.bytesToActualScaledSize,BYTES_TO_MIN_VISIBLE_SIZE:this._scales.bytesToActualMinVisibleSize,BYTES_TO_SYMBOLIC_SIZE:this._scales.bytesToActualSymbolicSize,BYTES_TO_DASH_LENGTH:this._scales.bytesToActualDashLength,BYTES_TO_GAP_LENGTH:this._scales.bytesToActualGapLength,BYTES_TO_PATTERN_SCALE:this._scales.bytesToActualPatternScale,PATTERN_INFO_TEXTURE_SIZE:this._patternTexture.getInfoTextureSize(),PATTERN_NEAREST_TEXTURE_SIZE:this._patternTexture.getNearestTextureSize(),PATTERN_LINEAR_TEXTURE_SIZE:this._patternTexture.getLinearTextureSize(),PATTERN_LINEAR_SDF_TEXTURE_SIZE:this._patternTexture.getLinearSdfTextureSize(),PATTERN_MIPMAP_TEXTURE_SIZE:this._patternTexture.getMipmapTextureSize(),PATTERN_POSITION_UNIT_SIZE:jn,ROUNDED_BOX_RADIUS:this._textManager.getCornerRadius(),SHAPE_TEXTURE_SIZE:this._shapeTexture.getTextureSize(),SHAPE_SAMPLING_SIZE:this._shapeTexture.getSamplingSize(),SHAPE_SAMPLING_BUFFER_RATIO:this._shapeTexture.getBufferRatio(),NB_SHAPES_BY_SIDE:this._shapeTexture.getTextureSize()/this._shapeTexture.getSamplingSize(),SHAPE_DIMENSIONS:this._shapeTexture.getSamplingSize()/this._shapeTexture.getTextureSize(),SHAPE_ACTUAL_RATIO:1-this._shapeTexture.getBufferRatio()}}_render({shapesChanged:e,patternsChanged:s,dimensionsChanged:n,backgroundColorChanged:i}){const r=this._gl;if(this._error)throw this._error;if(e&&(this._shapeTexture.refresh(this._shapeManager),this._patternTexture.bindMetaDataTexture()),s&&this._patternTexture.refresh(this._patternManager),n&&(this._mustResize=!0),i){const[l,u,h,g]=this._renderBackground?this._backgroundRgba:[0,0,0,0];r.clearColor(l*g,u*g,h*g,g)}const o=this._computeUniforms(),a=this._getSortedBufferList();this._mustResize&&a.length&&(df(this._glCanvas,this._width,this._height,this._pixelRatio),r.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),this._mustResize=!1),r.clear(r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT);for(let l=0;l<a.length;++l)this._displayBuffer(a[l],o);this._endFrame()}_displayBuffer(e,s){const n=e.getProgram();n!==this._currentProgram&&(this._currentProgram&&this._currentProgram.endPass(),this._currentProgram=n,this._currentProgram.startPass(s)),e.markAsUsed(),e.draw()}_getSortedBufferList(){const e=this._bufferList.getBuffersByAscendingDepth(),s=[];for(let n=0;n<this._bufferDrawers.length;++n){const i=this._bufferDrawers[n];i&&i.markAsUnused()}for(let n=0;n<e.length;++n){const i=e[n],r=this._getBufferDrawer(i);r.markAsUsed(),!i.isEmpty()&&this._isBufferDisplayable(i)&&s.push(r)}for(let n=0;n<this._bufferDrawers.length;++n){const i=this._bufferDrawers[n];i&&!i.isUsed()&&(i.destroy(),this._bufferDrawers[n]=void 0)}return s}_endFrame(){this._currentProgram&&(this._currentProgram.endPass(),this._currentProgram=null)}_getBufferDrawer(e){const s=e.getId();let n=this._bufferDrawers[s];if(!n){for(;this._bufferDrawers.length<=s;)this._bufferDrawers.push(void 0);n=new UO({gl:this._gl,ext:this._ext,staticProgram:this._staticProgram,animationProgram:this._animationProgram}),this._bufferDrawers[s]=n}return n.setDataBuffer(e),n}destroy(){this._glCanvas&&this._glCanvas.removeEventListener("webglcontextlost",this._onContextLost);const e=this._gl.getExtension("WEBGL_lose_context");e&&e.loseContext()}getImageData(){const e=this._glCanvas.width,s=this._glCanvas.height;return(this._2dcanvas.width<e||this._2dcanvas.height<s)&&(this._2dcanvas.width=e,this._2dcanvas.height=s),this._ctx.clearRect(0,0,e,s),this._ctx.drawImage(this._glCanvas,0,0),this._ctx.getImageData(0,0,e,s)}_getImageDataFlippedYAxis(){const e=this._gl,s=this._glCanvas.width,n=this._glCanvas.height,i=this._ctx.createImageData(s,n),r=new Uint8Array(i.data.buffer);return e.readPixels(0,0,s,n,e.RGBA,e.UNSIGNED_BYTE,r),i}setConstant(e,s){this._staticProgramWrapper.setConstant(e,s),this._animationProgramWrapper.setConstant(e,s),this._staticProgramWrapper.compile(),this._animationProgramWrapper.compile(),this._initGlPrograms(),this._bufferDrawers.forEach((n=>{n==null||n.destroy()})),this._bufferDrawers=[]}getShapeTexture(){return this._shapeTexture}};function uB(t,e){const s={vertexInfoAttribute:"a_vertexInfo",attributes:[],uniforms:[]};return RS(s,t),RS(s,e),s}var dB={float:1,vec2:2,vec3:3,vec4:4};function RS(t,e){const s=/(?:attribute\s+\/\*\s*(byte|ubyte|short|ushort|float)\s*\*\/\s*(float|vec2|vec3|vec4)\s+(\w+)\s*;)|(?:#if\s*(\w+))|(?:#endif)/g,n=/uniform\s+(float|vec2|vec3|vec4|sampler2D|int)\s+(\w+)\s*;/g,i=[];let r=s.exec(e);for(;r;){const o=r[0];o==="#endif"?i.pop():o.startsWith("#if")?i.push(r[4]):t.attributes.push({name:r[3],size:dB[r[2]],type:r[1],tags:i.slice(),location:null,byteSize:0,glType:null}),r=s.exec(e)}for(r=n.exec(e);r;){if(!t.uniforms.some((({id:o})=>o===r[1]))){const o=r[1],a=r[2],l=a.replace("u_","");t.uniforms.push({id:l,name:a,type:o})}r=n.exec(e)}}function hB(){return{BYTES_TO_OFFSET_ANGLE:2*Math.PI/8,BYTES_TO_COLOR:1/15,SDF_FONT_SIZE:sh,CURVATURE_RATIO:Qf,PATTERN_PADDING:Wo,TEXT_WIDTH_MULTIPLIER:J2,TEXT_HEIGHT_MULTIPLIER:xf,SELF_LOOP_CURVATURE_RATIO:vf,EDGE_ARROW_SIZE_RATIO:ro.edgeArrowSizeRatio,EDGE_MIN_TIP_SIZE:ro.minEdgeTipSize,CURVE_SUBDIVISIONS:_i,PIECE_NODE_COMPONENT:Xi,PIECE_TEXT_BOX:ka,PIECE_EDGE_BODY:Jf,PIECE_EDGE_HEAD:n0,PIECE_EDGE_TAIL:i0,PIECE_EDGE_TEXT:Aa,MAX_TEXT_SIZE:ZD,BYTES_TO_TEXT_OFFSET_X:1/wC,BYTES_TO_TEXT_OFFSET_Y:1/Ry,FILTER_NEAREST:Ql,FILTER_LINEAR:Ud,FILTER_LINEAR_SDF:Gd,FILTER_MIPMAP:wa,SHAPE_TEXTURE_SIZE:Ly,SIMPLE_SHAPE_SAMPLING_SIZE:Vg,COMPLEX_SHAPE_SAMPLING_SIZE:Uo,SHAPE_SAMPLING_BUFFER_RATIO:Ty,MAX_SHAPES:yf.toString(),FIRST_COMPLEX_SHAPE_ID:wy,SELF_LOOP_TO_CIRCLE_APPROX:sC,SDF_GAMMA:aD}}var cB={x:0,y:0,zoom:1,angle:0,width:80,height:60,pixelRatio:1,backgroundColor:null,currentTime:0,isBufferDisplayable:Rx,hideImages:!1,renderBackground:!1,bentEnable:!1,bentVertical:!1},sg={webgl:lB,canvas:IO,svg:OO},FS=[0,0,0,0],l_={webgl:null,svg:null,canvas:null},u_=class extends Lh{constructor(t){super(),this._view=Zs(cB),this._domWrapper=ao?document.createElement("div"):uf(),this._domElement=this._domWrapper.appendChild(ao?document.createElement("div"):uf()),this._currentElementSize=0,this._currentBlockOffset=0,this._currentByteOffset=0,this._blockIdToAddress=new Uint32Array(0),this._renderersByType={},this._switchMainRenderer=!0,this._refreshTexts=!1,this._backgroundColor=null,this._initData=t||{},this._patternManager=new $D,this._shapeManager=new qD,this._boundariesManager=new mD,this._textManager=new KD(this._patternManager),this._bufferOffsetToId=new oC,this._memoryManager=new VD(this._patternManager,this._shapeManager,this._textManager,this._bufferOffsetToId,(e=>this.parseColor(e)||FS)),this._bufferList=new dD}static createInitData(){const t={};for(const e in sg)t[e]=sg[e].createInitData();return t}static cacheInitData(t){l_=t}static getCachedInitData(){return l_}static clearCachedInitData(){l_={webgl:null,svg:null,canvas:null}}freeBlock(t){this._checkBlockId(t);const e=this._blockIdToAddress[t],s=this._bufferList.freeBlock(e);return this._blockIdToAddress[t]=s,s}_ensureDomElementsFitParent(){const t=this._domElement.parentNode;!t||t.offsetWidth===this._view.width&&t.offsetHeight===this._view.height||Ha(t,`${this._view.width}px`,`${this._view.height}px`)}_ensureCorrectBackgroundColor(){const t=this._domElement.parentNode;this._backgroundColor!==this._view.backgroundColor&&t&&(t.style.backgroundColor=this._view.backgroundColor||"",this._backgroundColor=this._view.backgroundColor)}createGroup(){return new pD}parseColor(t){return Yn(t)}clear(){this._blockIdToAddress.fill(0),this._patternManager.reset(),this._boundariesManager.reset(),this._textManager.reset(),this._bufferList.reset(),this._bufferOffsetToId.reset()}notifyFontsReloaded(){this._patternManager.notifyUpdate(),this._textManager.clear(),this._refreshTexts=!0}notifyPatternUpdate(){this._patternManager.notifyUpdate()}getShapePoints(t){return this._shapeManager.getDefinitionFromName(t).points}checkShapeHit(t,e,s){const{getDistanceFromStrokeVertically:n,getDistanceFromStrokeHorizontally:i}=this._shapeManager.getDefinitionFromName(t);return Math.min(n(e,s),i(e,s))>=0}setGlobalBoundaries(t){const{maxBlockId:e=0,maxScaledSize:s,maxMinVisibleSize:n,maxSymbolicSize:i,maxDashLength:r,maxGapLength:o,maxPatternScale:a}=t;return e>this._blockIdToAddress.length&&this._resizeBlockArray(e),!!this._boundariesManager.set(t)&&(this._memoryManager.resizeBoundaries(s,n,i,r,o,a),!0)}_resizeBlockArray(t){const e=new Uint32Array(t);e.set(this._blockIdToAddress),this._blockIdToAddress=e}registerShape(t,e){this._shapeManager.register(t,e)}updateShape(t,e){var n;this._shapeManager.updateShape(t,e);const s=(n=this._renderersByType.webgl)==null?void 0:n.getShapeTexture();s&&s.rewriteShape(this._shapeManager.getIdFromName(t))}_bindBlock(t,e,s,n,i,r,o){this._checkBlockId(t);const a=this._blockIdToAddress[t],l=this._bufferList.allocateBlock(a,e,s,n,i,r,o);return this._blockIdToAddress[t]=l.address,this._currentDataView=l.buffer.getDataView(),this._currentElementSize=l.buffer.elementSize,this._currentBlockOffset=l.offset,this._currentByteOffset=this._currentBlockOffset*this._currentElementSize,this._currentSideDataView=l.buffer.getSideDataView(),this._currentSideElementSize=l.buffer.getTotalSideElementsSize(),this._currentSideByteOffset=this._currentBlockOffset*this._currentSideElementSize,l}_setItemIndex(t){const e=this._currentBlockOffset+t;this._currentByteOffset=e*this._currentElementSize,this._currentSideByteOffset=e*this._currentSideElementSize}_checkBlockId(t){t>=this._blockIdToAddress.length&&this._resizeBlockArray(Vo(t+1))}_setTextCharacters(t){this._textManager.storeTextInDataView(this._currentSideDataView,this._currentSideByteOffset,this._currentSideByteOffset+this._currentSideElementSize,t)}_storeElement(t,e){this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset,t.end),e&&(this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset+cu,t.start),this._memoryManager.storeAnimationInformation(this._currentDataView,this._currentByteOffset+2*cu,t.animation,o0.getCoefficients(t.animation.easing)))}storeGroup(t,e){if(!e||e.size===0)return this.freeBlock(t);const s=e.type,n=e.depth,i=e.size,r=e.getElements(),o=e.animated,a=e.stencilUsage,l=e.getId();let u=0;if(s===za)for(let g=0;g<i;++g){const f=r[g],{start:p,end:y}=f;if(y.pattern.type===Xo){const _=y.pattern.attributes.text;u=Math.max(u,_.length)}if(o&&p.pattern.type===Xo){const _=p.pattern.attributes.text;u=Math.max(u,_.length)}}const h=this._bindBlock(t,s,o,n,i,u,a);for(let g=0;g<i;++g){const f=r[g];this._setItemIndex(g),this._storeElement(f,o),this._bufferOffsetToId.set(h.buffer.getId(),h.offset+g,l)}if(s===za)for(let g=0;g<i;++g){const f=r[g];this._setItemIndex(g),this._setTextCharacters(f.end.pattern)}return h.address}_refreshTextElements(){const t=this._bufferList.getBuffers();for(const e of t)if(e&&e.type===za){const s=e.getSideDataView(),n=e.getTotalSideElementsSize(),i=e.getSize();let r=0,o=n;for(let a=0;a<i;++a){const l=this._textManager.extractTextFromDataView(s,r,o);this._textManager.storeTextInDataView(s,r,o,l),r=o,o+=n}e.triggerUpdate()}}extractElement(t,e=0){if(!t)return null;const s=this._bufferList.getBlockInfo(t);return this._renderer.extractElement(s.buffer,s.offset+e)}getDomElement(){return this._domElement}getDomWrapper(){return this._domWrapper}measureText(t,e,s,n=1){return this._textManager.measureText(t,e,s,n)}setRenderType(t){this._renderType!==t&&(this._renderType=t,this._switchMainRenderer=!0)}setEdgeArrowSizeRatio(t){ro.setEdgeArrowSizeRatio(t),this._renderersByType.webgl&&this._renderersByType.webgl.setConstant("EDGE_ARROW_SIZE_RATIO",t)}setEdgeMinTipSize(t){ro.setMinEdgeTipSize(t),this._renderersByType.webgl&&this._renderersByType.webgl.setConstant("EDGE_MIN_TIP_SIZE",t)}setBentEdges(t,e){this._view.bentEnable=t,this._view.bentVertical=e}getBentEdges(){return{bentEnable:this._view.bentEnable,bentVertical:this._view.bentVertical}}_ensureMainRendererReady(){if(this._switchMainRenderer){this._renderType===null&&(this._renderType="canvas");const t=sg[this._renderType];t&&t.isAvailable()||(this._renderType="canvas"),this._renderer=this._renderersByType[this._renderType],this._renderer||(this._renderer=this._instanciateRenderer(this._renderType),this._renderer.on("error",(e=>this.fire("error",e))),this._renderersByType[this._renderType]=this._renderer),this._updateDomElement()}}_updateDomElement(){const t=this._renderer&&this._renderer.getDomElement(),e=this._domElement;for(;e&&e.firstChild;)e.removeChild(e.firstChild);t&&this._appendDomChild(t)}_appendDomChild(t){t.style.position="absolute",t.style.left="0",t.style.top="0",this._domElement.appendChild(t)}_instanciateRenderer(t){return new(t===null?ro:sg[t])({initData:t===null?null:this._initData[t],bufferList:this._bufferList,shapeManager:this._shapeManager,patternManager:this._patternManager,boundariesManager:this._boundariesManager,textManager:this._textManager,memoryManager:this._memoryManager})}setView(t){this._view={...this._view,...t}}getTextManager(){return this._textManager}_updateManagers(){this._patternManager.setPixelRatio(this._view.pixelRatio),this._shapeManager.update(),this._patternManager.update(),this._textManager.update(),this._boundariesManager.update(),this._bufferList.update(),this._refreshTexts&&(this._refreshTexts=!1,this._refreshTextElements())}_resizeCanvas(t){uC(t,this._view.width,this._view.height,this._view.pixelRatio)}render(){this._ensureMainRendererReady(),this._ensureDomElementsFitParent(),this._ensureCorrectBackgroundColor(),this._updateManagers(),this._renderer.renderFrame(this._view)}ensureAnimationsReady(){this._ensureMainRendererReady(),this._renderer.ensureAnimationsReady()}export(t,e,s){const n=this._instanciateRenderer(t),i={...this._view,...e};return"setViewportClipping"in n&&n.setViewportClipping(!1),this._updateManagers(),n.renderFrame(i),n.export(s).then((()=>n.getDomElement()))}getCurrentTime(){return Hn()}getImageData(){return this._renderer&&this._renderer.getImageData()}destroy(){for(const t of Object.keys(this._renderersByType)){const e=this._renderersByType[t];e&&e.destroy()}}transparentify(t){const e=this.parseColor(t)||FS;return`rgba(${Math.round(255*e[0])},${Math.round(255*e[1])},${Math.round(255*e[2])},0)`}initDebugRenderingLoop({triggerKey:t="r",start:e=!0}={}){let s=e;document.addEventListener("keydown",(({key:i})=>{i===t&&(s=!s)}));const n=i=>{(s||i)&&(this.setView({currentTime:Hn()}),this.render()),window.requestAnimationFrame((()=>{n()}))};window.requestAnimationFrame((()=>{document.body.appendChild(this.getDomElement()),n(!0)}))}},gB=Hf&&document.fonts,fB=200,d_="/qwerty/ [HELLO] ",PS="serif",pB=16,mB=class{constructor(){this._fontFaceSet=gB?document.fonts:null,this._canvas=Pn(),this._ctx=this._canvas.getContext("2d")}_measureText(t,e){return this._ctx.font=`12px ${e}`,this._ctx.measureText(t).width}check(t){if(t===PS)return!0;const e=this._measureText(d_,PS);return this._measureText(d_,t)!==e}load(t){return this._fontFaceSet&&this._fontFaceSet.load?this._fontFaceSet.load(`12px ${t}`):(this._ctx.font=`12px ${t}`,this._ctx.fillText(d_,10,50),Promise.resolve())}},_B=class{constructor(t,e){this._fontLoaderCounter=0,this._loaded=!1,this._value=null,this._timeout=0,this._fontFaceSet=t,this._fontName=e,this._loaded=!1,this._value=null,this._timeout=0,Hf&&!this._fontFaceSet.check(this._fontName)||this._setLoaded()}_setLoaded(){this._loaded=!0,this._value=this._fontName}getValue(){return this._value}isLoaded(){return this._loaded}destroy(){clearTimeout(this._timeout)}load(){return this._tryLoad(fB).then((()=>this._setLoaded()))}_tryLoad(t){return this._fontFaceSet.load(this._fontName).then((()=>{if(!this._fontFaceSet.check(this._fontName)&&this._fontLoaderCounter<pB)return new Promise((e=>{t<6e4&&(this._timeout=setTimeout(e,t))})).then((()=>(this._fontLoaderCounter++,this._tryLoad(1.5*t))))}))}},yB=class{constructor(){this._fontFaceSet=new mB,this._fonts={},this._onFontLoaded=[],this._hideUntilFontsLoaded=!0}setHideUntilFontsLoaded(t){this._hideUntilFontsLoaded=t}getFont(t){let e=this._fonts[t];return e||(e=new _B(this._fontFaceSet,t),this._fonts[t]=e,e.isLoaded()||e.load().then((()=>this._triggerFontLoaded(t)))),!this._hideUntilFontsLoaded&&t||e.getValue()}onFontLoaded(t){this._onFontLoaded.push(t)}destroy(){this._onFontLoaded=[],Object.keys(this._fonts).forEach((t=>this._fonts[t].destroy()))}_triggerFontLoaded(t){this._onFontLoaded.forEach((e=>e(t)))}},Mh="shifted",xB="centered";/**
 * Ogma Parsers
 * @description Parsers for Ogma
 * @version 0.0.27 (built on Thu Apr 10 2025 15:39:50 GMT+0000 (Coordinated Universal Time))
 * @author Alexander Milevski - Leo Nicolle - Sylvain Milan - Marco Liberati
 * @license (c) Linkurious 2025. All rights reserved.
 * @preserve
 */function Po(t,e,s){s=s||e,e in t&&(t.attributes[s]=t[e])}function HC(t,e=(s=>s)){const s=e(JSON.parse(t)),n=s.nodes||[],i=s.edges||[];for(let r=0;r<n.length;r++){const o=n[r];o.attributes||(o.attributes={}),typeof o.size=="string"&&(o.size=+o.size),typeof o.x=="string"&&(o.x=+o.x),typeof o.y=="string"&&(o.y=+o.y),Po(o,"x"),Po(o,"y"),Po(o,"size","radius"),Po(o,"color"),Po(o,"text")}for(let r=0;r<i.length;r++){const o=i[r];o.attributes||(o.attributes={}),typeof o.size=="string"&&(o.size=+o.size),Po(o,"size","width"),Po(o,"color"),Po(o,"text")}return{nodes:n,edges:i}}function vB(t){return t.type==="vertex"||t._type==="vertex"||t.inE||t.outE||t._inE||t._outE}function bB(t){return t.type==="edge"||t._type==="edge"||t.inV||t.outV||t._outV||t._inV}function Ad(t,e,s){if(t&&typeof t=="object"){if(Array.isArray(t))return t.forEach((n=>Ad(n,e,s)));if(vB(t)){const n={};t.properties&&Object.keys(t.properties).forEach((r=>{n[r]=t.properties[r][0].value}));const i=Dy(t);e.push({id:i,data:{id:t.id+"",categories:[t.label],properties:n}});for(const r in t)r!=="properties"&&Ad(t[r],e,s);return}if(bB(t)){const n=Dy(t);s.push({id:n,source:zS(t,["inV","_inV"]),target:zS(t,["outV","_outV"]),data:{id:n,type:t.label,properties:t.properties||{}}});for(const i in t)i!=="properties"&&Ad(t[i],e,s);return}Object.keys(t).forEach((n=>Ad(t[n],e,s)))}}function zS(t,e){for(const s of e)if(t[s])return Dy(t[s])}function Dy(t){if(typeof t=="string"||isFinite(t))return String(t);const e=t;return String(e.id||e._id)}function EB(t){const e=[],s=[];return Ad(typeof t=="string"?JSON.parse(t):t,e,s),{nodes:e,edges:s}}var ai=t=>t.charCodeAt(0),SB=ai(" "),DS=ai("<"),$g=ai(">"),OS=ai('"'),AB=ai(`
`),wB=ai("\r"),qg=ai("/"),TB=ai("\\"),CB=ai("a"),LB=ai("z"),NB=ai("A"),MB=ai("Z"),kB=ai("0"),IB=ai("9"),RB=ai(":"),$C=-1,Oy=-2,qC=-3,YC=-4;function FB(t){const e=new Int32Array(t.length);for(let s=0,n=t.length;s<n;++s)e[s]=t.charCodeAt(s);return e}function PB(t,e,s,n){const i=n.length;if(s-e!==i)return!1;for(let r=0;r<i;++r)if(t[e+r]!==n[r])return!1;return!0}function zB(t,e,s,n){return WC(t.tags,e,s,n)}function DB(t,e,s,n){return WC(t.attributes,e,s,n)}function WC(t,e,s,n){const i=t.length;for(let r=0;r<i;++r)if(PB(e,s,n,t[r]))return r;return t.push(e.slice(s,n)),i}function OB(t,e,s){let n=Yg(e,s),i=e[n];if(i===$g||i===qg)return n;let r=n;n=ZC(e,n);const o=DB(t,e,r,n);for(;e[n]!==OS;)++n;for(++n,r=n;(i=e[n])!==OS;)i===TB&&++n,++n;return t.tokens.push(qC,o,r,n),n+1}function BB(t,e){let s,n;const i={tags:[],attributes:[],tokens:[]},r=i.tokens;let o=Yg(t,e);for(;o<t.length;){let a=t[o];if(a===DS){if(o=Yg(t,++o),t[o]===qg)for(r.push(Oy);t[++o]!==$g;);else{s=o,o=ZC(t,s);const l=zB(i,t,s,o);for(r.push($C,l),a=t[o];a!==$g&&a!==qg;)o=OB(i,t,o),a=t[o];if(a===qg)for(r.push(Oy);t[++o]!==$g;);}o+=1}else{for(s=o;t[++o]!==DS;);for(n=o-1;XC(t[n]);)--n;r.push(YC,s,n+1)}o=Yg(t,o)}return i}function XC(t){return t===SB||t===AB||t===wB}function Yg(t,e){for(;XC(t[e]);)++e;return e}function UB(t){return t>=CB&&t<=LB||t>=NB&&t<=MB||t===RB||t>=kB&&t<=IB}function ZC(t,e){for(;UB(t[e]);)++e;return e}function BS(t,e){const s=Object.keys(e),n={};if(s.length>0)for(let i=0;i<s.length;++i){const r=e[s[i]],o=r.title;n[o]=r.default!==void 0?JSON.stringify(r.default):void 0}return t?()=>({id:void 0,attributes:{text:void 0,color:void 0,radius:void 0,x:void 0,y:void 0},data:{...n}}):()=>({id:void 0,source:void 0,target:void 0,attributes:{color:void 0,text:void 0,width:void 0},data:{...n}})}function US(t){return t.indexOf("\\")===-1||(t=t.replace(/\\"/g,'"')),t}function KC(t){if(t.indexOf("<gexf")===-1)throw new Error("not a GEXF file");const e=FB(t),s=BB(e,t.indexOf("<gexf ")),n={},i={};s.tags.forEach(((hs,Fe)=>{const Oe=String.fromCharCode.apply(null,hs);n[Oe]=Fe})),s.attributes.forEach(((hs,Fe)=>{const Oe=String.fromCharCode.apply(null,hs);i[Oe]=Fe}));const r=n.attributes,o=n.attribute,a=n.node,l=n.edge,u=n.default,h=n["viz:position"],g=n["viz:size"],f=n["viz:color"],p=n.attvalue,y=i.class,_=i.id,x=i.type,v=i.title,b=i.label,S=i.source,A=i.target,w=i.x,L=i.y,M=i.r,F=i.g,O=i.b,G=i.a,j=i.value,Z=i.for,at=i.weight,pt={float:1,double:1,integer:2,boolean:3,string:4,"list-string":5};let K=0;const ut=s.tokens,ht=ut.length,nt=new Array(16);let ot=0,Mt=0,Q=0,Et=!0;const Xt={},Ht={};let Zt,ae,pe="",ne="",te="",se={attributes:{}},ce=0,Ce=0,ve=0,Me=1,ge="",ze=!1,is=!0,Ge=null,De=null;const He=[],Je=[];let ss=0,ts={};for(;K<ht;){const hs=ut[K];if(hs===$C)Mt=ot,ot=ut[K+1],nt[Q]=ot,Q+=1,ot===a?(Ge||(Ge=BS(!0,Xt)),se=Ge(),is=!0,ts=Xt):ot===l&&(De||(De=BS(!1,Ht)),se=De(),is=!1,ts=Ht),K+=2;else if(hs===Oy){if(pe&&ot===o){ts=Et?Xt:Ht;const Fe=pt[ne];let Oe=Zt;Oe&&(Fe===1?Oe=+Oe:Fe===2?Oe=0|+Oe:Fe===3?Oe=Oe==="true":Fe===5&&(Oe=Oe.split(" ").filter((Ns=>Ns)))),ts[pe]={title:te||pe,default:Oe,type:Fe},pe="",te="",ne="",Zt=void 0}else if(ot===a&&Q===4)ze&&se.attributes&&(se.attributes.color=`rgba(${ce}, ${Ce}, ${ve}, ${Me})`,ce=0,Ce=0,ve=0,Me=1,ze=!1),se.id||(se.id=++ss),He.push(se);else if(ot===l&&Q===4)se.id||(se.id=++ss),Je.push(se);else if(ot===p&&Q===6&&ge){const Fe=(is?Xt:Ht)[ge];if(Fe){if(ae===void 0)ae=Fe.default;else{const Ns=Fe.type;Ns&&(Ns===1?ae=+ae:Ns===2?ae=0|+ae:Ns===3?ae=ae==="true":Ns===5?ae=ae.split(" ").filter((zs=>zs)).map((zs=>US(zs))):typeof e=="string"&&(ae=US(ae)))}se.data||(se.data={});const Oe=ts;se.data[Oe[ge].title]=ae}ge="",ae=null}Q-=1,ot=Mt,Mt=nt[Q-2],K+=1}else if(hs===qC){const Fe=ut[K+1],Oe=t.substring(ut[K+2],ut[K+3]);if(ot===r)Fe===y&&(Et=Oe!=="edge"&&Oe!=="edges");else if(ot===o)Fe===_?pe=Oe:Fe===x?ne=Oe:Fe===v&&(te=Oe);else if(ot!==a&&ot!==l||Q!==4)if(ot===h&&Q===5){if(Fe===w)se.attributes.x=parseFloat(Oe);else if(Fe===L){const Ns=parseFloat(Oe);se.attributes.y=Ns===0?Ns:-Ns}}else ot===f&&Q===5?(ze=!0,Fe===M?ce=parseInt(Oe):Fe===F?Ce=parseInt(Oe):Fe===O?ve=parseInt(Oe):Fe===G&&(Me=parseFloat(Oe))):ot===g&&Q===5?Fe===j&&(is?se.attributes.radius=+Oe:se.attributes.width=+Oe):ot===p&&Q===6&&(Fe===Z||Fe===_?ge=Oe:Fe===j&&(ae=Oe));else Fe===_?se.id=Oe:Fe===b?se.attributes.text=Oe:Fe===S?se.source=Oe:Fe===A?se.target=Oe:Fe===at&&(se.attributes.width=+Oe);K+=4}else{if(hs!==YC)throw new Error(`at index ${K}: token ${hs}`);{const Fe=t.substring(ut[K+1],ut[K+2]);ot===u&&(Zt=Fe),K+=3}}}return{nodes:He,edges:Je}}function GB(t){for(let e=0;e<64;++e)t[e]^=1;for(let e=0;e<64&&!(t[e]^=1);++e);}function VB(t,e,s){for(let n=0;n<32;++n)s[n]=+!!(t&1<<n);for(let n=0;n<32;++n)s[n+32]=+!!(e&1<<n);return s}function GS(t,e){let s=0;for(let n=0;n<20;++n){const i=s+t[n]+e[n];s=+(i>=10),t[n]=i%10}}var jB=class{constructor(){this._decimalPowerOfTwo=new Uint8Array(20),this._binaryNumber=new Uint8Array(64),this._decimalNumber=new Uint8Array(20)}int64ToString({low:e,high:s}){if(e===0&&s===0)return"0";VB(e,s,this._binaryNumber),this._decimalNumber.fill(0),this._decimalPowerOfTwo.fill(0),this._decimalPowerOfTwo[0]=1;const n=this._binaryNumber[63]===1;n&&GB(this._binaryNumber);for(let o=0;o<64;++o)this._binaryNumber[o]&&GS(this._decimalNumber,this._decimalPowerOfTwo),GS(this._decimalPowerOfTwo,this._decimalPowerOfTwo);const i=[];let r=this._decimalNumber.length-1;for(n&&i.push("-");!this._decimalNumber[r];)r-=1;for(let o=r;o>=0;--o)i.push(String(this._decimalNumber[o]));return i.join("")}},HB=new jB;function ng(t){return HB.int64ToString(t)}function ig(t){return typeof t=="object"&&"high"in t&&"low"in t}function $B(t){return"start"in t&&"end"in t}function qB(t){if(typeof t!="object"||t===null)throw new Error("Ogma can only retrieve nodes and relationships from Neo4j. Please make sure that your Cypher query returns nodes and edges, not values.");const e=Object.keys(t.properties);for(const s of e){const n=t.properties[s];ig(n)&&(t.properties[s]=ng(n))}if(t.identity!==void 0){if(ig(t.identity)&&(t.identity=ng(t.identity)),$B(t)){const s=t.start.identity||t.start,n=t.end.identity||t.end;ig(s)&&(t.start=ng(s)),ig(n)&&(t.end=ng(n))}}else t.id&&(t.identity=t.id)}var YB=t=>"start"in t&&"end"in t&&"type"in t,WB=t=>"segments"in t;function XB(t,e,s,n){e.segments.forEach((i=>{jd(t,i.start,s,n),jd(t,i.end,s,n),jd(t,i.relationship,s,n)}))}function jd(t,e,s,n){if(e)if(Array.isArray(e))e.forEach((i=>jd(t,i,s,n)));else if(WB(e))XB(t,e,s,n);else if(qB(e),YB(e))n.has(e.identity)||(n.add(e.identity),t.edges.push({id:e.identity,source:e.start,target:e.end,data:{neo4jType:e.type,neo4jProperties:e.properties}}));else{const i=e;s.has(i.identity)||(s.add(i.identity),t.nodes.push({id:i.identity,attributes:{},data:{neo4jLabels:i.labels,neo4jProperties:i.properties}}))}}var ZB=t=>"queryKeys"in t&&"values"in t;function KB(t){const e=[];return t.values.forEach((s=>{const{nodes:n=[],relationships:i=[],segments:r=[]}=s.adapted,o=[{segments:r,properties:{}}];e.push({_fields:[...n,...i,...o]})})),{records:e}}function QB(t){let e=typeof t=="string"?JSON.parse(t):t;const s={nodes:[],edges:[]},n=new Set,i=new Set;return ZB(e)&&(e=KB(e)),e.records.forEach((({_fields:r})=>r.forEach((o=>jd(s,o,n,i))))),s}var JB={boolean:t=>t.toLowerCase()==="true",int:parseFloat,long:parseFloat,float:parseFloat,double:parseFloat,string:t=>t};function tU(t){const e={graph:{},node:{},edge:{}},s={graph:{},node:{},edge:{}};for(let n=0;n<t.length;n++){const i=t[n],r=i.getAttribute("for")||"node",o=i.getAttribute("id"),a=i.getAttribute("attr.name"),l=i.getAttribute("attr.type")||"string",u=i.getElementsByTagName("default"),h=u.length!==0?u[0].textContent:void 0;e[r][o]={name:a,parse:JB[l]},typeof h<"u"&&(s[r][a]=h)}return{definitions:e,defaults:s}}function VS(t,e,s){const n=t.getElementsByTagName("data"),i={};for(let r=0;r<n.length;r++){const o=n[r],a=o.getAttribute("key");if(a===null)continue;const l=e[a];typeof l>"u"?i[a]=o.textContent:o.textContent&&o.textContent.length!==0&&(i[l.name]=l.parse(o.textContent))}for(const r in s)r in i||(i[r]=s[r]);return i}function h_(t){return t.color?t.color:t.r&&t.g&&t.b?`rgb(${t.r}, ${t.g}, ${t.b})`:void 0}var eU=new Set(["x","y","size","color","r","g","b","label"]);function jS(t){const e={};for(const s in t)eU.has(s)||t[s]===void 0||(e[s]=t[s]);return e}function QC(t,e){if(!e){if(typeof DOMParser>"u")throw new Error("DOMParser is not available. You need to provide a DOMParser instance as second argument, if you are not in the browser environment");e=new DOMParser}const s=e.parseFromString(t,"application/xml"),n=s.getElementsByTagName("key"),i=s.getElementsByTagName("node"),r=s.getElementsByTagName("edge"),{definitions:o,defaults:a}=tU(n),l=[],u=new Set;for(let g=0;g<i.length;g++){const f=i[g],p=f.getAttribute("id"),y=f.getAttribute("href")||void 0,_=VS(f,o.node,a.node);u.add(p);const x={id:p,attributes:{x:_.x,y:_.y,radius:_.size,color:h_(_),text:_.label},data:jS(_)};_.x!==void 0&&(x.attributes.x=_.x),_.y!==void 0&&(x.attributes.y=_.y),_.size!==void 0&&(x.attributes.radius=_.size),_.label!==void 0&&(x.attributes.text=_.label);const v=h_(_);v!==void 0&&(x.attributes.color=v),y!==void 0&&(x.data.href=y),l.push(x)}const h=[];for(let g=0;g<r.length;g++){const f=r[g],p=f.getAttribute("id")||g,y=f.getAttribute("source"),_=f.getAttribute("target"),x=f.getAttribute("xlink:href")||void 0;if(!u.has(y)||!u.has(_))throw new Error(`Invalid edge: ${y} -> ${_}`);const v=VS(f,o.edge,a.edge),b={id:p,source:y,target:_,attributes:{},data:jS(v)},S=h_(v);S!==void 0&&(b.attributes.color=S),x!==void 0&&(b.data.href=x),h.push(b)}return{nodes:l,edges:h}}var JC=t=>{const e=t.split(`
`).filter((i=>!i.startsWith("%"))),[s]=e[0].split(" ").map(Number),n=e.slice(1).map((i=>i.split(" ").slice(0,2).map(Number))).filter((i=>i.length===2));return{nodes:Array.from({length:Number(s)},((i,r)=>({id:r}))),edges:n.map((([i,r])=>({source:i%s,target:r%s})))}};function sU(t,e,s,n){x0(t,e,s,n),t.thicknessOrFontSizeScaled=e.widthScaled,t.thicknessOrFontSizeFixed=e.widthFixed,t.strokeWidthScaled=e.stroke.widthScaled,t.strokeWidthFixed=e.stroke.widthFixed,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=e.color,t.strokeColor=e.stroke.color,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=e.stroke.minVisibleSize,t.offsetAngle=0,t.symbolicSize=e.widthScaled,t.dashLength=e.shape.dashLength,t.gapLength=e.shape.gapLength,t.hasHead=!!e.shape.head,t.hasTail=!!e.shape.tail,t.isBodyTriangle=e.shape.isBodyTriangle}function x0(t,e,s,n){t.pieceId=s,t.shape=n,t.x1=e.sourceX,t.y1=e.sourceY,t.x2=e.targetX,t.y2=e.targetY,t.rectWidthOrSourceRadiusScaled=e.sourceRadiusScaled,t.rectWidthOrSourceRadiusFixed=e.sourceRadiusFixed,t.rectHeightOrTargetRadiusScaled=e.targetRadiusScaled,t.rectHeightOrTargetRadiusFixed=e.targetRadiusFixed,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=Wn,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.widthScaled,t.curvature=e.curvature,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=e.isSelfLoop,t.isText=!1}function nU(t,e,s){const n=e.widthScaled+2*e.halo.widthScaled,i=e.widthFixed+2*e.halo.widthFixed;x0(t,e,s,"line"),t.thicknessOrFontSizeScaled=n,t.thicknessOrFontSizeFixed=i,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=e.halo.color,t.strokeColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.offsetAngle=0,t.symbolicSize=e.widthScaled,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isBodyTriangle=!1}function iU(t,e,s,n){x0(t,e,s,n);const i=e.widthFixed*hS+zD;t.thicknessOrFontSizeScaled=e.widthScaled*dS,t.thicknessOrFontSizeFixed=e.widthFixed*dS,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=e.widthScaled*hS,t.offsetFixed=i,t.fillColor=e.outline.color,t.strokeColor=null,t.globalMinVisibleSize=Math.max(e.minVisibleSize,e.outline.minVisibleSize),t.strokeMinVisibleSize=0,t.offsetAngle=Math.PI/2,t.symbolicSize=e.widthScaled,t.dashLength=e.shape.dashLength,t.gapLength=e.shape.gapLength,t.hasHead=!!e.shape.head,t.hasTail=!!e.shape.tail,t.isBodyTriangle=e.shape.isBodyTriangle}function rU(t,e,s){tL(t,e,s),t.pattern.type=Xo,t.pattern.attributes.text=e.content,t.pattern.attributes.size=Ch,t.pattern.attributes.font=e.font,t.pattern.attributes.style=e.style,t.pattern.attributes.align=e.align,t.patternColor=e.color,t.patternScale=1,t.thicknessOrFontSizeScaled=e.sizeScaled,t.thicknessOrFontSizeFixed=e.sizeFixed,t.isText=!0}function oU(t,e,s){tL(t,e,s),t.pieceId+=ka,t.fillColor=e.backgroundColor,t.shape="square"}function tL(t,e,s){let n=e.position==="centered"?0:(s.widthScaled+e.heightScaled)/2+s.stroke.widthScaled,i=e.position==="centered"?0:(s.widthFixed+e.heightFixed)/2+s.stroke.widthFixed+e.padding+e.margin;if(e===s.texts.secondary&&s.texts.primary.position==="centered"&&(i=s.texts.primary.heightFixed/2+e.heightFixed/2+s.texts.primary.padding+s.texts.primary.margin+e.padding+e.margin,n=(s.texts.primary.heightScaled+e.heightScaled)/2),t.pieceId=Aa,t.shape="square",t.x1=s.sourceX,t.y1=s.sourceY,t.x2=s.targetX,t.y2=s.targetY,!s.isSelfLoop&&s.curvature===0){const r=Math.atan2(t.y2-t.y1,t.x2-t.x1),o=s.sourceRadiusScaled-s.targetRadiusScaled,a=Math.cos(r),l=Math.sin(r);t.x1+=a*o,t.y1+=l*o}t.rectWidthOrSourceRadiusScaled=e.widthScaled,t.rectWidthOrSourceRadiusFixed=e.widthFixed+2*e.padding+1,t.rectHeightOrTargetRadiusScaled=e.heightScaled,t.rectHeightOrTargetRadiusFixed=e.heightFixed+2*e.padding,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=s.sourceRadiusScaled+s.targetRadiusScaled,t.strokeWidthFixed=s.sourceRadiusFixed+s.targetRadiusFixed,t.offsetScaled=n,t.offsetFixed=i,t.pattern.type=Wn,t.opacity=s.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=Math.max(e.minVisibleSize,s.minVisibleSize),t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.offsetAngle,t.patternScale=0,t.symbolicSize=s.widthScaled,t.curvature=s.curvature,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=s.isSelfLoop,t.isText=!1,t.adjustTextAngle=e.adjustAngle}var aU=t=>!!t||t===0;function gr(t,e,s=0){return t==="inherit"?Array.isArray(e)?e[((s/(2*Math.PI)*e.length|0)+1)%e.length]:e:t}function lU(t,e,s){return t==="source"?Array.isArray(e)?e[0]:e:t==="target"?Array.isArray(s)?s[0]:s:t}function uU(t){const e=t.depth;return e===hC||e===dC||(e-a0)%u0>=l0}function eL(t){const e=(t.depth-a0)%u0;return e>=0&&e!==cC&&e!==l0}function HS(t,e,s,n,i,r){dU(t,e,s,n,i,r),$S(t,e,s,n.text,i.texts.primary,r.texts.primary,r),$S(t,e,s,n.text.secondary,i.texts.secondary,r.texts.secondary,r)}function dU(t,e,s,n,i,r){if(c_(i.body,r,sU),i.halo.body){const o=n.halo.width.get(s),a=+(n.halo.scalingMethod.get(s)==="scaled");r.halo.widthScaled=o*a,r.halo.widthFixed=o*(1-a),c_(i.halo,r,nU)}i.outline.body&&(r.outline.color=n.outline.color.get(s),r.outline.minVisibleSize=n.outline.minVisibleSize.get(s),c_(i.outline,r,iU))}function c_(t,e,s){s(t.body,e,Jf,e.shape.body),t.head&&e.shape.head!==null&&s(t.head,e,n0,e.shape.head),t.tail&&e.shape.tail!==null&&s(t.tail,e,i0,e.shape.tail)}function $S(t,e,s,n,i,r,o){if(i.text&&r.content){const a=n,l=a.scaling.get(s);if(r.font=e.fontManager.getFont(a.font.get(s)),r.color=gr(a.color.get(s),o.color),r.position=a.position?a.position.get(s):Mh,r.style=a.style.get(s),r.minVisibleSize=a.minVisibleSize.get(s),r.margin=a.margin.get(s),r.padding=a.padding.get(s),r.maxLineLength=a.maxLineLength.get(s),r.content=h0(r.content,r.maxLineLength),r.adjustAngle=a.adjustAngle.get(s),r.align=a.align.get(s),l){const h=a.scale.get(s);r.sizeScaled=o.widthScaled*h,r.sizeFixed=o.widthFixed*h}else r.sizeFixed=a.size.get(s),r.sizeScaled=0;const u=t.measureText(r.content,r.font,r.style);r.widthScaled=u.width*r.sizeScaled,r.widthFixed=u.width*r.sizeFixed,r.heightScaled=u.height*r.sizeScaled,r.heightFixed=u.height*r.sizeFixed,r.offsetAngle=r===o.texts.primary?DD:OD,rU(i.text,r,o),i.background&&oU(i.background,r,o)}}function qS(t,e){g_(t.body,e,!0,!0),g_(t.outline,e,e.outline.enabled,!0),g_(t.halo,e,!!e.halo.color,!1),YS(t.texts.primary,e.texts.primary),YS(t.texts.secondary,e.texts.secondary)}function g_(t,e,s,n){t.body=s,t.head=s&&n&&!!e.shape.head,t.tail=s&&n&&!!e.shape.tail}function YS(t,e){t.text=!e.hidden&&!!e.content,t.background=t.text&&!!e.backgroundColor}function WS(t,e,s,n,i,r){hU(t,e,s,n,i,r),XS(t,e.texts.primary,s.text,n,e),XS(t,e.texts.secondary,s.text.secondary,n,e)}function hU(t,e,s,n,i,r){const o=i.source,a=i.target,l=s.source.get(n),u=s.target.get(n),h=o.x.get(l),g=o.y.get(l),f=o.radius.get(l),p=o.innerStroke.width.get(l),y=+(o.innerStroke.color.get(l)!==null),_=+(o.innerStroke.scalingMethod.get(l)==="scaled"),x=o.outerStroke.width.get(l),v=+(o.outerStroke.color.get(l)!==null),b=+(o.outerStroke.scalingMethod.get(l)==="scaled"),S=o.color.get(l),A=+(o.scalingMethod.get(l)==="scaled"),w=a.x.get(u),L=a.y.get(u),M=a.radius.get(u),F=a.innerStroke.width.get(u),O=+(a.innerStroke.color.get(u)!==null),G=+(a.innerStroke.scalingMethod.get(u)==="scaled"),j=a.outerStroke.width.get(u),Z=+(a.outerStroke.color.get(u)!==null),at=+(a.outerStroke.scalingMethod.get(u)==="scaled"),pt=a.color.get(u),K=+(a.scalingMethod.get(u)==="scaled"),ut=lU(s.color.get(n),S,pt),ht=s.width.get(n),nt=s.scalingMethod.get(n)==="scaled"?1:0,ot=s.stroke.width.get(n),Mt=s.stroke.scalingMethod.get(n)==="scaled"?1:0,Q=BD[s.shape.style.get(n)],Et=s.adjustAnchors.get(n);if(e.source=l,e.target=u,e.sourceX=h,e.sourceY=g,e.targetX=w,e.targetY=L,e.sourceRadiusScaled=p*y*_+x*v*b+f*A,e.sourceRadiusFixed=p*y*(1-_)+x*v*(1-b)+f*(1-A),e.targetRadiusScaled=F*O*G+j*Z*at+M*K,e.targetRadiusFixed=F*O*(1-G)+j*Z*(1-at)+M*(1-K),e.widthScaled=ht*nt,e.widthFixed=ht*(1-nt),e.curvature=s.curvature.get(n),e.isSelfLoop=l===u,e.color=ut,e.opacity=s.opacity.get(n),e.minVisibleSize=s.minVisibleSize.get(n),e.shape.body=s.shape.body.get(n),e.shape.head=s.shape.head.get(n),e.shape.tail=s.shape.tail.get(n),e.shape.dashLength=Q.dash,e.shape.gapLength=Q.gap,e.shape.isBodyTriangle=e.shape.body==="triangle",e.stroke.color=gr(s.stroke.color.get(n),ut),e.stroke.widthScaled=ot*Mt,e.stroke.widthFixed=ot*(1-Mt),e.stroke.minVisibleSize=s.stroke.minVisibleSize.get(n),e.halo.color=s.halo.color.get(n),e.outline.enabled=s.outline.enabled.get(n),e.textHidden=s.textHidden.get(n)===1,Et&&(e.shape.head||e.shape.tail||e.shape.body==="triangle")){const Xt=e,Ht=Xt.curvature,Zt=Xt.sourceX,ae=Xt.sourceY,pe=Xt.targetX,ne=Xt.targetY;let te=1,se=1;if(Ht){if(!Xt.isSelfLoop){const ce=ap(Zt,ae,pe,ne,Ht/2);te=rg(Xt,r,o,l,Zt,ae,ce.x,ce.y),se=rg(Xt,r,a,u,pe,ne,ce.x,ce.y)}}else te=rg(Xt,r,o,l,Zt,ae,pe,ne),se=rg(Xt,r,a,u,pe,ne,Zt,ae);e.sourceRadiusScaled*=te,e.sourceRadiusFixed*=te,e.targetRadiusScaled*=se,e.targetRadiusFixed*=se}}function XS(t,e,s,n,i){e.hidden=i.textHidden,e.content=t.formatText(s.content.get(n)),e.backgroundColor=gr(s.backgroundColor.get(n),i.color)}function rg(t,e,s,n,i,r,o,a){const l=e.angle||0;let u,h=Math.atan2(a-r,o-i)-l,g=1,f=0;h<-qi?h+=Bd:h>qi&&(h-=Bd),h<-qi/2?(f=gC,u=s.badges.topLeft):h<0?(f=fC,u=s.badges.topRight):h<qi/2?(f=mC,u=s.badges.bottomRight):(f=pC,u=s.badges.bottomLeft),f+=l;const p=u.text.content&&u.text.content.get(n),y=u.image.url&&u.image.url.get(n);if(aU(p)||y){const _=u.positionScale.get(n),x=u.scale.get(n),v=C2(o,a,i,r,i+Math.cos(f)*_,r+Math.sin(f)*_,x);if(v){const b=v.x-i,S=v.y-r,A=Math.sqrt(b*b+S*S);g=Math.max(g,A)}}if(s.shape.get(n)==="square"){const _=Math.abs(Math.cos(h)),x=Math.abs(Math.sin(h)),v=1/Math.max(_,x);g=Math.max(g,v)}return g}function ZS(){return{source:0,target:0,sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:!1,color:"",opacity:0,minVisibleSize:0,shape:{body:"line",head:null,tail:null,dashLength:0,gapLength:0,isBodyTriangle:!1},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:!1,color:"",minVisibleSize:0},textHidden:!1,texts:{primary:KS(),secondary:KS()}}}function KS(){return{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,position:Mh,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0}}function cU(t){return t===null?t:void 0}function Fn(t){return typeof t=="boolean"||t===0||t===1?t:void 0}function Ba(t){return typeof t=="number"&&isFinite(t)?t:void 0}function js(t){return typeof t=="number"&&isFinite(t)&&t>=0?t:void 0}var sL=-100,gU=400,nL=t=>typeof t=="number"&&isFinite(t)&&t>=sL&&t<=gU?t:void 0;function Jr(t){return t===null||typeof t=="string"||typeof t=="number"?t:void 0}function to(t){return t==="fixed"||t==="scaled"?t:void 0}function jo(t){return Yn(t)?t:void 0}function fU(t){return t===xB||t===Mh?t:void 0}function Vn(t){return t==="inherit"||Yn(t)?t:void 0}function pU(t){return t==="source"||t==="target"||Yn(t)?t:void 0}function nu(t){return t===null?null:typeof t=="string"?t.split(",").map((e=>{const s=e.trim(),n=s.indexOf(" ")!==-1,i=s[0];return n&&i!=='"'&&i!=="'"?`"${s}"`:s})).join(","):void 0}function iu(t){return t==="none"?"normal":t==="normal"||t==="italic"||t==="bold"||t==="italic bold"||t==="bold italic"||t==="100"||t==="200"||t==="300"||t==="400"||t==="500"||t==="600"||t==="700"||t==="800"||t==="900"?t:void 0}function Ef(t){return t==="left"||t==="center"?t:void 0}function mU(t){return t==="equilateral"?"pentagon":t==="triangle"?"triangleUp":t==="triangleRight"?"triangle":t==="circle"||t==="square"||t==="cross"||t==="diamond"||t==="pentagon"||t==="hexagon"||t==="star"||t==="triangleUp"||t==="triangleDown"||t==="triangleLeft"||t==="triangle"?t:void 0}var _U=new Set(["line","tapered","arrow","dashed","dotted"]);function yU(t){return _U.has(t)?t:void 0}function xU(t){return t==="line"||t==="triangle"?t:void 0}function QS(t){return t===null||t==="arrow"||t==="circle-hole-arrow"||t==="triangle-hole-arrow"||t==="short-arrow"||t==="sharp-arrow"||t==="circle"||t==="square"?t:void 0}function vU(t){return t==="plain"||t==="dashed"||t==="dotted"?t:void 0}function bU(t){return t==="top"||t==="bottom"||t==="left"||t==="right"||t==="center"?t:void 0}function EU(t){if(Yn(t))return t;if(Array.isArray(t)){if(t.length<1)return;for(let e=0;e<t.length;++e)if(!Yn(t[e]))return;return t}}function Es(t){return function(e){if(typeof e=="number")return isFinite(e)&&e>=0?e:void 0;if(typeof e!="string"||e.charAt(e.length-1)!=="%")return;const s=parseFloat(e);return isNaN(s)?void 0:t*s/100}}function v0(){return{edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0}}function rh(t,e=v0()){const s=(t-sL)*u0+a0;return e.edgeHalo=MD,e.nodeHaloStroke=dC,e.nodeHalo=hC,e.edgeBody=s+cC,e.edgeTextBackground=s+kD,e.edgeText=s+ID,e.nodeBody=s+l0,e.nodeTextBackground=s+RD,e.nodeText=s+FD,e}var SU=(t,e)=>{e.halo.body=e.halo.body||t.halo.body,e.halo.head=e.halo.head||t.halo.head,e.halo.tail=e.halo.tail||t.halo.tail,e.outline.body=e.outline.body||t.outline.body,e.outline.head=e.outline.head||t.outline.head,e.outline.tail=e.outline.tail||t.outline.tail,e.body.body=e.body.body||t.body.body,e.body.head=e.body.head||t.body.head,e.body.tail=e.body.tail||t.body.tail;const s=e.texts,n=t.texts;s.primary.text=s.primary.text||n.primary.text,s.primary.background=s.primary.background||n.primary.background,s.secondary.text=s.secondary.text||n.secondary.text,s.secondary.background=s.secondary.background||n.secondary.background},iL=t=>(e,s)=>{s.halo.body=e.halo.body[t],s.halo.head=e.halo.head[t],s.halo.tail=e.halo.tail[t],s.outline.body=e.outline.body[t],s.outline.head=e.outline.head[t],s.outline.tail=e.outline.tail[t],s.body.body=e.body.body[t],s.body.head=e.body.head[t],s.body.tail=e.body.tail[t],s.texts.primary.text=e.texts.primary.text[t],s.texts.primary.background=e.texts.primary.background[t],s.texts.secondary.text=e.texts.secondary.text[t],s.texts.secondary.background=e.texts.secondary.background[t]},AU=iL("start"),wU=iL("end"),TU=class{constructor({engine:t,imageManager:e,fontManager:s,formatText:n,view:i,attributes:r,attributesPrev:o,nodeAttributes:a,nodeAttributesPrev:l}){this._fullComponents=ad(),this._startComponents=ad(),this._endComponents=ad(),this._startFlags=ad(),this._endFlags=ad(),this._startInput=ZS(),this._endInput=ZS(),this._depthInfo=v0(),this._nullElt={id:-1,valid:!0},this._engine=t,this._view=i,this._helper={imageManager:e,fontManager:s,formatText:n},this._attributes=r,this._attributesPrev=o,this._nodeAttributes=a,this._nodeAttributesPrev=l,this._layers=JS((()=>t.createGroup())),this._blockIds=JS((()=>0))}drawEdge(t){if(this._computeBlockIds(t),this._attributes.excluded.get(t))return this._freeBlocks();const e=this._engine,s=this._helper,n=-t,i=this._attributes,{bentEnable:r,bentVertical:o}=e.getBentEdges(),a=rh(i.layer.get(t)-(i.detectable.get(t)?0:1),this._depthInfo),l=i.source.get(t),u=i.target.get(t),h=i.curvature.get(t),g=this._attributesPrev.curvature.get(t),f=i.animationDuration.get(t),p=i.animationStart.get(t),y=i.animationEasing.get(t),_=f>0,x=h!==0||_&&g!==0||this._engine.getBentEdges().bentEnable;this._prepareBlocks(_,a,n,x);const v=this._extremitiesAttributes={source:this._nodeAttributes,target:this._nodeAttributes};if(WS(s,this._endInput,i,t,v,this._view),qS(this._endFlags,this._endInput),_){const b=this._nodeAttributes.animationDuration.get(l)>0,S=this._nodeAttributes.animationDuration.get(u)>0;v.source=b?this._nodeAttributesPrev:this._nodeAttributes,v.target=S?this._nodeAttributesPrev:this._nodeAttributes,WS(s,this._startInput,this._attributesPrev,t,v,this._view),qS(this._startFlags,this._startInput),SU(this._endFlags,this._startFlags)}this._initComponents(this._fullComponents,this._endFlags,this._layers),wU(this._fullComponents,this._endComponents),this._endComponents.body.body.bentEnable=r,this._endComponents.body.body.bentVertical=o,this._endComponents.body.head&&(this._endComponents.body.head.bentEnable=r,this._endComponents.body.head.bentVertical=o),this._endComponents.body.tail&&(this._endComponents.body.tail.bentEnable=r,this._endComponents.body.tail.bentVertical=o),HS(e,s,t,this._attributes,this._endComponents,this._endInput),this._endComponents.texts.primary.text&&(this._endComponents.texts.primary.background&&(this._endComponents.texts.primary.background.bentEnable=r,this._endComponents.texts.primary.background.bentVertical=o),this._endComponents.texts.primary.text.bentEnable=r,this._endComponents.texts.primary.text.bentVertical=o),this._endComponents.texts.secondary.text&&(this._endComponents.texts.secondary.background&&(this._endComponents.texts.secondary.background.bentEnable=r,this._endComponents.texts.secondary.background.bentVertical=o),this._endComponents.texts.secondary.text.bentEnable=r,this._endComponents.texts.secondary.text.bentVertical=o),_&&(AU(this._fullComponents,this._startComponents),HS(e,s,t,this._attributesPrev,this._startComponents,this._startInput),this._setBlocksAnimation(f,p,y)),this._setupHaloMasking(l,u),this._storeBlocks()}_setupHaloMasking(t,e){const s=this._nodeAttributes.halo,n=this._layers,i=s.color.get(t)&&s.hideNonAdjacentEdges.get(t),r=s.color.get(e)&&s.hideNonAdjacentEdges.get(e),o=!i&&!r?lC:su;n.body.stencilUsage=n.text.stencilUsage=n.textBg.stencilUsage=o}_computeBlockIds(t){const e=t*ep,s=this._blockIds;s.body=e+wD,s.halo=e+LD,s.text=e+TD,s.textBg=e+CD}_prepareBlocks(t,e,s,n){const i=this._layers;i.body.reset(n?bf:dr,t,e.edgeBody,s),i.halo.reset(n?bf:dr,t,e.edgeHalo,s),i.text.reset(za,t,e.edgeText,s),i.textBg.reset(dr,t,e.edgeTextBackground,s)}_storeBlocks(){const t=this._engine,e=this._layers,s=this._blockIds;t.storeGroup(s.body,e.body),t.storeGroup(s.halo,e.halo),t.storeGroup(s.text,e.text),t.storeGroup(s.textBg,e.textBg)}_freeBlocks(){const t=this._engine,e=this._blockIds;t.freeBlock(e.body),t.freeBlock(e.halo),t.freeBlock(e.text),t.freeBlock(e.textBg)}_setBlocksAnimation(t,e,s){const n=this._layers;n.body.setGlobalAnimation(t,e,s),n.halo.setGlobalAnimation(t,e,s),n.text.setGlobalAnimation(t,e,s),n.textBg.setGlobalAnimation(t,e,s)}_initComponents(t,e,s){this._initEdgeComponents(t.halo,e.halo,s.halo),this._initEdgeComponents(t.outline,e.outline,s.body),this._initEdgeComponents(t.body,e.body,s.body),this._initTextComponents(t.texts.primary,e.texts.primary,s),this._initTextComponents(t.texts.secondary,e.texts.secondary,s)}_initEdgeComponents(t,e,s){t.head=this._nextElement(e.head,s),t.tail=this._nextElement(e.tail,s),t.body=this._nextElement(e.body,s)}_initTextComponents(t,e,s){t.background=this._nextElement(e.background,s.textBg),t.text=this._nextElement(e.text,s.text)}_nextElement(t,e){return t?e.next():this._nullElt}};function JS(t){return{body:t(),halo:t(),text:t(),textBg:t()}}function ad(){return{halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}}}function CU(t,e,s){rL(t,e,s),e.imageContent!==null?(t.pattern.type=qo,t.pattern.attributes.image=e.imageContent,t.pattern.attributes.scaled=!0,t.pattern.attributes.duplicated=!1,t.patternScale=e.imageScale,t.patternMinVisibleSize=0,t.patternColor=null):(t.fillColor=null,t.strokeColor=null)}function LU(t,e,s){rL(t,e,s),e.textContent&&(t.pattern.type=Oa,t.pattern.attributes.text=e.textContent,t.pattern.attributes.font=e.textFont,t.pattern.attributes.style=e.textStyle,t.pattern.attributes.paddingLeft=e.scale*e.textPaddingLeft*2,t.pattern.attributes.paddingTop=e.scale*e.textPaddingTop*2,t.pattern.attributes.size=Ch,t.patternMinVisibleSize=0,t.patternColor=e.textColor,t.patternScale=e.textScale,t.isBadge=!0),!e.imageUrl&&e.textContent||(t.fillColor=null,t.strokeColor=null)}function rL(t,e,s){const n=e.scalingMethod==="fixed",i=s.diameterScaled*e.scale;let r=0;const o=s.diameterScaled;n&&(r=s.diameterScaled*e.scale);const a=s.diameterScaled*e.positionScale/2,l=s.diameterFixed*e.positionScale/2;t.pieceId=Xi,t.shape="circle",t.x1=s.x,t.y1=s.y,t.x2=s.x,t.y2=s.y,t.rectWidthOrSourceRadiusScaled=i,t.rectWidthOrSourceRadiusFixed=r,t.rectHeightOrTargetRadiusScaled=i,t.rectHeightOrTargetRadiusFixed=r,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.strokeWidthScaled,t.strokeWidthFixed=e.strokeWidthFixed,t.offsetScaled=a,t.offsetFixed=l,t.pattern.type=Wn,t.opacity=s.opacity,t.fillColor=e.color,t.strokeColor=e.strokeColor,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.angle,t.patternScale=0,t.symbolicSize=o,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1,t.isBadge=!0}function NU(t,e,s){lp(t,e),t.fillColor=Array.isArray(e.color)?null:e.color,t.strokeColor=e.innerStroke.color,t.strokeMinVisibleSize=e.innerStroke.minVisibleSize,t.strokeWidthScaled=e.innerStroke.widthScaled,t.strokeWidthFixed=e.innerStroke.widthFixed,s&&(t.pattern.type=Wn)}function lp(t,e){t.pieceId=Xi,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=e.diameterScaled,t.rectWidthOrSourceRadiusFixed=e.diameterFixed,t.rectHeightOrTargetRadiusScaled=e.diameterScaled,t.rectHeightOrTargetRadiusFixed=e.diameterFixed,t.shape=e.shape,t.opacity=e.opacity,t.symbolicSize=e.diameterScaled,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=null,t.strokeColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.offsetAngle=0,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function MU(t,e){const s=e.diameterScaled+2*e.halo.widthScaled,n=e.diameterFixed+2*e.halo.widthFixed;t.pieceId=Xi,t.shape="circle",t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=s,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=s,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=Wn,t.opacity=e.opacity,t.fillColor=e.halo.color,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function kU(t,e){const s=e.diameterScaled+2*e.halo.widthScaled,n=e.diameterFixed+2*e.halo.widthFixed;t.pieceId=Xi,t.shape="circle",t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=s,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=s,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.halo.strokeWidthScaled,t.strokeWidthFixed=e.halo.strokeWidthFixed,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=Wn,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=e.halo.strokeColor,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function IU(t,e){lp(t,e),t.pattern.type=Da,t.pattern.attributes.text=e.icon.content,t.pattern.attributes.font=e.icon.font,t.pattern.attributes.style=e.icon.style,t.pattern.attributes.size=Ch,t.patternMinVisibleSize=e.icon.minVisibleSize,t.patternColor=e.icon.color,t.patternScale=e.icon.scale}function RU(t,e){const s=e.image.fit&&!e.image.tile;lp(t,e),t.pattern.type=qo,t.pattern.attributes.image=e.image.content,t.pattern.attributes.scaled=s,t.pattern.attributes.duplicated=e.image.tile,t.patternScale=s?e.image.scale:0,t.patternMinVisibleSize=e.image.minVisibleSize,t.patternColor=null}function FU(t,e){const s=e.diameterScaled+2*e.innerStroke.widthScaled,n=e.diameterFixed+2*e.innerStroke.widthFixed;t.pieceId=Xi,t.shape=e.shape,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=s,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=s,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.outerStroke.widthScaled,t.strokeWidthFixed=e.outerStroke.widthFixed,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=Wn,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=e.outerStroke.color,t.patternColor=null,t.globalMinVisibleSize=e.outerStroke.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function PU(t,e){const s=e.diameterScaled*lS,n=e.diameterFixed*lS;let i=e.diameterScaled*uS,r=e.diameterFixed*uS+PD;e.outerStroke.color&&(i+=e.outerStroke.widthScaled/2,r+=e.outerStroke.widthFixed/2),t.pieceId=Xi,t.shape=e.shape,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=s,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=s,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=i,t.offsetFixed=r,t.pattern.type=Wn,t.opacity=e.opacity,t.fillColor=e.outline.color,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.outline.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=1.5707963267948966,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function zU(t,e){lp(t,e),Array.isArray(e.color)&&(t.pattern.type=Nh,t.pattern.attributes.colors=e.color.join(";"),t.patternScale=1,t.patternMinVisibleSize=0,t.patternColor=null)}function DU(t,e,s){oL(t,e,s),t.pattern.type=Xo,t.pattern.attributes.text=e.content,t.pattern.attributes.font=e.font,t.pattern.attributes.style=e.style,t.pattern.attributes.align=e.align,t.patternMinVisibleSize=0,t.patternColor=e.color,t.thicknessOrFontSizeScaled=e.sizeScaled,t.thicknessOrFontSizeFixed=e.sizeFixed,t.isText=!0}function OU(t,e,s){oL(t,e,s),t.fillColor=e.backgroundColor,t.pieceId=ka,t.shape="square"}function BU(t,e,s){const n=Math.ceil(e.margin/2),i=s.diameterScaled/2,r=s.diameterFixed/2+n,o=GD[e.position],a=Math.cos(o),l=Math.sin(o),u=e.margin<12?1:e.margin<30?1-(e.margin-12)/18*.7:.25;t.pieceId=Xi,t.shape="triangle",t.x1=s.x-a,t.y1=s.y-l,t.x2=s.x+a,t.y2=s.y+l,t.rectWidthOrSourceRadiusScaled=0,t.rectWidthOrSourceRadiusFixed=e.margin,t.rectHeightOrTargetRadiusScaled=0,t.rectHeightOrTargetRadiusFixed=e.margin*u,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=i,t.offsetFixed=r,t.pattern.type=Wn,t.opacity=s.opacity,t.fillColor=e.backgroundColor,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.positionAngle,t.patternScale=0,t.symbolicSize=s.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1}function oL(t,e,s){let n=0,i=0;const r=e.sizeScaled===0;if(e.isPositionCenter||(r?(n=s.diameterScaled/2,i+=s.diameterFixed/2+e.margin+e.paddingFixed):(n+=s.diameterScaled/2+e.paddingScaled,i+=s.diameterFixed/2+e.margin)),e.isPositionVertical){if(n+=e.heightScaled/2,i+=e.heightFixed/2,e===s.texts.secondary&&s.texts.primary.position==="bottom"){const a=s.texts.primary;n+=a.heightScaled,i+=a.heightFixed+a.margin+2*(a.paddingScaled+a.paddingFixed)}}else e.isPositionHorizontal&&(n+=e.widthScaled/2,i+=e.widthFixed/2);const o=Ch;t.pieceId=Xi,t.shape="square",t.x1=s.x,t.y1=s.y,t.x2=s.x,t.y2=s.y,t.rectWidthOrSourceRadiusScaled=e.widthScaled+2*e.paddingScaled,t.rectWidthOrSourceRadiusFixed=e.widthFixed+2*e.paddingFixed,t.rectHeightOrTargetRadiusScaled=e.heightScaled+2*e.paddingScaled,t.rectHeightOrTargetRadiusFixed=e.heightFixed+2*e.paddingFixed,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=n,t.offsetFixed=i,t.pattern.type=Wn,t.pattern.attributes.size=o,t.opacity=s.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.positionAngle,t.patternScale=1,t.symbolicSize=s.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function tA(t,e,s,n,i,r){const o=i.badges,a=n.badges,l=r.badges;UU(t,e,s,n,i,r),eA(t,e,s,n.text,i.texts.primary,r.texts.primary,r),eA(t,e,s,n.text.secondary,i.texts.secondary,r.texts.secondary,r),og(t,e,s,a.topLeft,o.topLeft,l.topLeft,r),og(t,e,s,a.topRight,o.topRight,l.topRight,r),og(t,e,s,a.bottomLeft,o.bottomLeft,l.bottomLeft,r),og(t,e,s,a.bottomRight,o.bottomRight,l.bottomRight,r)}function UU(t,e,s,n,i,r){if(i.halo){const o=n.halo.width.get(s),a=+(n.halo.scalingMethod.get(s)==="scaled");r.halo.widthScaled=o*a,r.halo.widthFixed=o*(1-a),MU(i.halo,r),i.haloStroke&&(r.halo.strokeWidthScaled=0,r.halo.strokeWidthFixed=n.halo.strokeWidth.get(s),kU(i.haloStroke,r))}if(i.outline&&(r.outline.color=n.outline.color.get(s),r.outline.minVisibleSize=n.outline.minVisibleSize.get(s),PU(i.outline,r)),i.outerStroke&&(r.outerStroke.minVisibleSize=n.outerStroke.minVisibleSize.get(s),FU(i.outerStroke,r)),i.pieChart&&zU(i.pieChart,r),i.image&&(r.image.content=e.imageManager.getImage(r.image.url),r.image.fit=n.image.fit.get(s),r.image.tile=n.image.tile.get(s),r.image.scale=n.image.scale.get(s),r.image.minVisibleSize=n.image.minVisibleSize.get(s),RU(i.image,r)),i.icon&&(r.icon.font=e.fontManager.getFont(n.icon.font.get(s)),r.icon.style=n.icon.style.get(s),r.icon.color=n.icon.color.get(s),r.icon.scale=n.icon.scale.get(s),r.icon.minVisibleSize=n.icon.minVisibleSize.get(s),IU(i.icon,r)),i.body){const o=!i.pieChart&&!i.image&&!i.icon;NU(i.body,r,o)}}function og(t,e,s,n,i,r,o){if(i.image||i.text){const a=n.stroke.width.get(s),l=+(n.stroke.scalingMethod.get(s)==="scaled");r.color=gr(n.color.get(s),o.color,r.angle),r.strokeColor=n.stroke.color.get(s),r.strokeWidthScaled=a*l,r.strokeWidthFixed=a*(1-l),r.minVisibleSize=n.minVisibleSize.get(s),r.positionScale=n.positionScale.get(s),r.scale=n.scale.get(s)}if(i.image&&(r.imageContent=e.imageManager.getImage(r.imageUrl),r.imageScale=n.image.scale.get(s),CU(i.image,r,o)),i.text){if(r.textFont=e.fontManager.getFont(n.text.font.get(s)),r.textStyle=n.text.style.get(s),r.textColor=gr(n.text.color.get(s),o.color),r.textScale=n.text.scale.get(s),r.textPaddingTop=n.text.paddingTop.get(s),r.textPaddingLeft=n.text.paddingLeft.get(s),t.measureText(r.textContent,r.textFont,r.textStyle,r.textScale).width>1){let a=0,l=0;for(;l<r.textContent.length&&a<1;)a+=t.measureText(r.textContent[l],r.textFont,r.textStyle,r.textScale).width,l+=1;l!==r.textContent.length&&(r.textContent=r.textContent.substring(0,l-1)+"")}LU(i.text,r,o)}}function eA(t,e,s,n,i,r,o){if(i.text&&r.content){const a=n,l=a.scaling.get(s);r.font=e.fontManager.getFont(a.font.get(s)),r.color=gr(a.color.get(s),o.color),r.style=a.style.get(s),r.align=a.align.get(s),r.minVisibleSize=a.minVisibleSize.get(s),r.margin=a.margin.get(s);const u=a.padding.get(s);if(r.maxLineLength=a.maxLineLength.get(s),r.content=h0(r.content,r.maxLineLength),l){const g=a.scale.get(s);r.paddingFixed=0,r.paddingScaled=u*g,r.sizeScaled=o.diameterScaled*g,r.sizeFixed=o.diameterFixed*g}else r.sizeFixed=a.size.get(s),r.sizeScaled=0,r.paddingFixed=u,r.paddingScaled=0;const h=t.measureText(r.content,r.font,r.style);r.widthScaled=h.width*r.sizeScaled,r.widthFixed=h.width*r.sizeFixed,r.heightScaled=h.height*r.sizeScaled,r.heightFixed=h.height*r.sizeFixed,r.positionAngle=UD[r.position],r.isPositionCenter=r.position==="center",r.isPositionVertical=r.position==="top"||r.position==="bottom",r.isPositionHorizontal=r.position==="left"||r.position==="right",DU(i.text,r,o),i.background&&(OU(i.background,r,o),i.tip&&BU(i.tip,r,o))}}function sA(t,e){GU(t,e),nA(t.texts.primary,e.texts.primary),nA(t.texts.secondary,e.texts.secondary),ag(t.badges.topLeft,e.badges.topLeft),ag(t.badges.topRight,e.badges.topRight),ag(t.badges.bottomLeft,e.badges.bottomLeft),ag(t.badges.bottomRight,e.badges.bottomRight)}function GU(t,e){t.body=!0,t.icon=!!e.icon.content,t.image=!!e.image.url,t.pieChart=Array.isArray(e.color),t.outerStroke=!!e.outerStroke.color,t.outline=!!e.outline.enabled,t.halo=!!e.halo.color,t.haloStroke=t.halo&&!!e.halo.strokeColor}function nA(t,e){t.text=!e.hidden&&!!e.content,t.background=t.text&&!!e.backgroundColor,t.tip=t.background&&e.tip&&e.position!=="center"}function ag(t,e){t.text=!!e.textContent,t.image=!!e.imageUrl}function iA(t,e,s,n){VU(t,e,s,n),rA(t,e.texts.primary,s.text,n,e),rA(t,e.texts.secondary,s.text.secondary,n,e),lg(t,e.badges.topLeft,s.badges.topLeft,n),lg(t,e.badges.topRight,s.badges.topRight,n),lg(t,e.badges.bottomLeft,s.badges.bottomLeft,n),lg(t,e.badges.bottomRight,s.badges.bottomRight,n)}function VU(t,e,s,n){const i=+(s.scalingMethod.get(n)==="scaled"),r=2*s.radius.get(n),o=s.innerStroke.width.get(n),a=+(s.innerStroke.scalingMethod.get(n)==="scaled"),l=s.outerStroke.width.get(n),u=+(s.outerStroke.scalingMethod.get(n)==="scaled");e.x=s.x.get(n),e.y=s.y.get(n),e.shape=s.shape.get(n),e.color=s.color.get(n),e.opacity=s.opacity.get(n),e.diameterScaled=r*i,e.diameterFixed=r*(1-i),e.innerStroke.color=gr(s.innerStroke.color.get(n),e.color),e.innerStroke.widthScaled=o*a,e.innerStroke.widthFixed=o*(1-a),e.innerStroke.minVisibleSize=s.innerStroke.minVisibleSize.get(n),e.outerStroke.color=gr(s.outerStroke.color.get(n),e.color),e.outerStroke.widthScaled=l*u,e.outerStroke.widthFixed=l*(1-u),e.halo.color=s.halo.color.get(n),e.halo.strokeColor=s.halo.strokeColor.get(n),e.icon.content=t.formatText(s.icon.content.get(n)),e.image.url=s.image.url.get(n),e.outline.enabled=s.outline.enabled.get(n),e.textHidden=s.textHidden.get(n)===1}function rA(t,e,s,n,i){if(e.hidden=i.textHidden,e.content=t.formatText(s.content.get(n)),e.backgroundColor=gr(s.backgroundColor.get(n),i.color),e===i.texts.primary){const r=s;e.tip=r.tip.get(n),e.position=r.position.get(n)}else e.position="bottom"}function lg(t,e,s,n){const i=s.text.content.get(n);e.textContent=t.formatText(i),e.imageUrl=s.image.url.get(n),e.scalingMethod=s.scalingMethod.get(n)}var ug=t=>({angle:t,color:"",scale:0,positionScale:0,minVisibleSize:0,strokeColor:"",strokeWidthScaled:0,strokeWidthFixed:0,scalingMethod:"scaled",textContent:"",textFont:"",textColor:"",textScale:0,textStyle:"none",imageUrl:"",imageContent:null,imageScale:0,textPaddingLeft:0,textPaddingTop:0}),oA=()=>({hidden:!1,content:"",position:"",backgroundColor:"",tip:!1,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",align:"left",minVisibleSize:0,margin:0,paddingScaled:0,paddingFixed:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:!1,isPositionVertical:!1,isPositionHorizontal:!1}),aA=()=>({x:0,y:0,shape:"",color:"",opacity:0,diameterScaled:0,diameterFixed:0,innerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},outerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},icon:{content:"",font:"",color:"",scale:0,size:0,style:"none",minVisibleSize:0},image:{url:"",content:null,scale:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,color:"",strokeColor:""},outline:{enabled:!1,color:"",minVisibleSize:0},badges:{topLeft:ug(gC),topRight:ug(fC),bottomLeft:ug(pC),bottomRight:ug(mC)},textHidden:!1,texts:{primary:oA(),secondary:oA()}}),jU=(t,e)=>{e.haloStroke=e.haloStroke||t.haloStroke,e.halo=e.halo||t.halo,e.outline=e.outline||t.outline,e.outerStroke=e.outerStroke||t.outerStroke,e.body=e.body||t.body,e.pieChart=e.pieChart||t.pieChart,e.image=e.image||t.image,e.icon=e.icon||t.icon;const s=t.badges,n=e.badges;n.topLeft.text=n.topLeft.text||s.topLeft.text,n.topLeft.image=n.topLeft.image||s.topLeft.image,n.topRight.text=n.topRight.text||s.topRight.text,n.topRight.image=n.topRight.image||s.topRight.image,n.bottomLeft.text=n.bottomLeft.text||s.bottomLeft.text,n.bottomLeft.image=n.bottomLeft.image||s.bottomLeft.image,n.bottomRight.text=n.bottomRight.text||s.bottomRight.text,n.bottomRight.image=n.bottomRight.image||s.bottomRight.image;const i=t.texts,r=e.texts;r.primary.text=r.primary.text||i.primary.text,r.primary.background=r.primary.background||i.primary.background,r.primary.tip=r.primary.tip||i.primary.tip,r.secondary.text=r.secondary.text||i.secondary.text,r.secondary.background=r.secondary.background||i.secondary.background,r.secondary.tip=r.secondary.tip||i.secondary.tip},aL=t=>(e,s)=>{s.haloStroke=e.haloStroke[t],s.halo=e.halo[t],s.outline=e.outline[t],s.outerStroke=e.outerStroke[t],s.body=e.body[t],s.pieChart=e.pieChart[t],s.image=e.image[t],s.icon=e.icon[t];const n=e.badges,i=s.badges;i.topLeft.text=n.topLeft.text[t],i.topLeft.image=n.topLeft.image[t],i.topRight.text=n.topRight.text[t],i.topRight.image=n.topRight.image[t],i.bottomLeft.text=n.bottomLeft.text[t],i.bottomLeft.image=n.bottomLeft.image[t],i.bottomRight.text=n.bottomRight.text[t],i.bottomRight.image=n.bottomRight.image[t];const r=e.texts,o=s.texts;o.primary.text=r.primary.text[t],o.primary.background=r.primary.background[t],o.primary.tip=r.primary.tip[t],o.secondary.text=r.secondary.text[t],o.secondary.background=r.secondary.background[t],o.secondary.tip=r.secondary.tip[t]},HU=aL("start"),$U=aL("end"),qU=class{constructor({engine:t,imageManager:e,fontManager:s,formatText:n,attributes:i,attributesPrev:r}){this._fullComponents=ld(),this._startComponents=ld(),this._endComponents=ld(),this._startFlags=ld(),this._endFlags=ld(),this._startInput=aA(),this._endInput=aA(),this._depthInfo=v0(),this._nodePatternAssigned=!1,this._nullElt={id:-1,valid:!0},this._engine=t,this._attributes=i,this._attributesPrev=r,this._helper={imageManager:e,fontManager:s,formatText:n},this._layers=lA((()=>t.createGroup())),this._blockIds=lA((()=>0))}drawNode(t){if(this._computeBlockIds(t),this._attributes.excluded.get(t))return this._freeBlocks();const e=this._engine,s=this._helper,n=t,i=this._attributes,r=rh(i.layer.get(t)-(i.detectable.get(t)?0:1),this._depthInfo),o=i.animationDuration.get(t),a=o>0;if(this._prepareBlocks(a,r,n),iA(s,this._endInput,i,t),sA(this._endFlags,this._endInput),a&&(iA(s,this._startInput,this._attributesPrev,t),sA(this._startFlags,this._startInput),jU(this._endFlags,this._startFlags)),this._initComponents(this._fullComponents,this._endFlags,this._layers),$U(this._fullComponents,this._endComponents),tA(e,s,t,i,this._endComponents,this._endInput),a&&(HU(this._fullComponents,this._startComponents),tA(e,s,t,this._attributesPrev,this._startComponents,this._startInput)),a){const l=this._attributes.animationStart.get(t),u=this._attributes.animationEasing.get(t);this._setBlocksAnimation(o,l,u)}this._endFlags.halo&&this._attributes.halo.hideNonAdjacentEdges.get(t)&&(this._layers.halo.stencilUsage=this._layers.haloStroke.stencilUsage=aC),this._storeBlocks()}_computeBlockIds(t){const e=t*ep,s=this._blockIds;s.body=e+vD,s.text=e+bD,s.textBg=e+ED,s.halo=e+SD,s.haloStroke=e+AD}_prepareBlocks(t,e,s){const n=this._layers;n.body.reset(dr,t,e.nodeBody,s),n.text.reset(za,t,e.nodeText,s),n.textBg.reset(dr,t,e.nodeTextBackground,s),n.halo.reset(dr,t,e.nodeHalo,s),n.haloStroke.reset(dr,t,e.nodeHaloStroke,s)}_storeBlocks(){const t=this._engine,e=this._layers,s=this._blockIds;t.storeGroup(s.body,e.body),t.storeGroup(s.text,e.text),t.storeGroup(s.textBg,e.textBg),t.storeGroup(s.halo,e.halo),t.storeGroup(s.haloStroke,e.haloStroke)}_freeBlocks(){const t=this._engine,e=this._blockIds;t.freeBlock(e.body),t.freeBlock(e.text),t.freeBlock(e.textBg),t.freeBlock(e.halo),t.freeBlock(e.haloStroke)}_setBlocksAnimation(t,e,s){const n=this._layers;n.body.setGlobalAnimation(t,e,s),n.text.setGlobalAnimation(t,e,s),n.textBg.setGlobalAnimation(t,e,s),n.halo.setGlobalAnimation(t,e,s),n.haloStroke.setGlobalAnimation(t,e,s)}_initComponents(t,e,s){this._nodePatternAssigned=!1,this._initBaseComponents(t,e,s),this._initBadgeComponents(t.badges.topLeft,e.badges.topLeft,s),this._initBadgeComponents(t.badges.topRight,e.badges.topRight,s),this._initBadgeComponents(t.badges.bottomLeft,e.badges.bottomLeft,s),this._initBadgeComponents(t.badges.bottomRight,e.badges.bottomRight,s),this._initTextComponents(t.texts.primary,e.texts.primary,s),this._initTextComponents(t.texts.secondary,e.texts.secondary,s)}_initBaseComponents(t,e,s){t.haloStroke=this._nextElement(e.haloStroke,s.haloStroke),t.halo=this._nextElement(e.halo,s.halo),t.outline=this._nextElement(e.outline,s.body),t.outerStroke=this._nextElement(e.outerStroke,s.body),t.body=this._nextElement(e.body,s.body),t.pieChart=this._getNodePatternElement(e.pieChart,s),t.image=this._getNodePatternElement(e.image,s),t.icon=this._getNodePatternElement(e.icon,s)}_initBadgeComponents(t,e,s){t.image=this._nextElement(e.image,s.body),t.text=this._nextElement(e.text,s.body)}_initTextComponents(t,e,s){t.background=this._nextElement(e.background,s.textBg),t.tip=this._nextElement(e.tip,s.textBg),t.text=this._nextElement(e.text,s.text)}_nextElement(t,e){return t?e.next():this._nullElt}_getNodePatternElement(t,e){return t?this._nodePatternAssigned?e.body.next():(this._nodePatternAssigned=!0,e.body.getCurrentElement()):this._nullElt}};function lA(t){return{body:t(),text:t(),textBg:t(),halo:t(),haloStroke:t()}}function ld(){return{haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}}}function YU({graph:t,elements:e,engine:s,imageManager:n,fontManager:i,view:r,attributes:o,boundaries:a,formatText:l}){const{nodeAttributes:u,nodeAttributesPrev:h,edgeAttributes:g,edgeAttributesPrev:f}=WU(o),{nodes:p,edges:y}=e,{maxSize:_,maxMinVisibleSize:x}=a;if(!p.size&&!y.size)return;const v=(Math.max(t.getNodeMaxIndex(),t.getEdgeMaxIndex())+1)*ep,b=_<1024?8*_:2*_,S=s.setGlobalBoundaries({maxBlockId:Vo(v),maxScaledSize:Vo(b),maxMinVisibleSize:Vo(x),maxSymbolicSize:Vo(_),maxDashLength:3,maxGapLength:1,maxPatternScale:2,maxCoord:-1/0}),A=(S?t.getNodes("_all"):p)._indexes,w=(S?t.getEdges("_all"):y)._indexes;if(A.length){const L=new qU({engine:s,imageManager:n,fontManager:i,formatText:l,attributes:u,attributesPrev:h});for(let M=0;M<A.length;++M)L.drawNode(A[M])}if(w.length){const L=new TU({engine:s,imageManager:n,fontManager:i,formatText:l,view:r,attributes:g,attributesPrev:f,nodeAttributes:u,nodeAttributesPrev:h});for(let M=0;M<w.length;++M)L.drawEdge(w[M])}}function WU(t){const e=Hl(t.nodes.current,{text:{secondary:{scaling:t.nodes.current.text.scaling,maxLineLength:t.nodes.current.text.maxLineLength}}});return{nodeAttributes:e,nodeAttributesPrev:Hl(t.nodes.previous,{textHidden:e.textHidden,text:{secondary:{scaling:t.nodes.previous.text.scaling,maxLineLength:t.nodes.previous.text.maxLineLength}}}),edgeAttributes:Hl(t.edges.current,{text:{secondary:{scaling:t.edges.current.text.scaling,maxLineLength:t.edges.current.text.maxLineLength,adjustAngle:t.edges.current.text.adjustAngle}}}),edgeAttributesPrev:Hl(t.edges.previous,{source:t.edges.current.source,target:t.edges.current.target,textHidden:t.edges.current.textHidden,text:{secondary:{scaling:t.edges.previous.text.scaling,maxLineLength:t.edges.previous.text.maxLineLength,adjustAngle:t.edges.previous.text.adjustAngle}}})}}function oh(t,e,s){const n=s.length;let i=n-1,r=!1;for(let o=0;o<n;++o)(s[o].y<e&&s[i].y>=e||s[i].y<e&&s[o].y>=e)&&(s[o].x<=t||s[i].x<=t)&&(r=r!==s[o].x+(e-s[o].y)/(s[i].y-s[o].y)*(s[i].x-s[o].x)<t),i=o;return r}function dg(t){const e=t.x*t.x+t.y*t.y;return{x:t.x/e,y:t.y/e}}function uA(t,e){let s=1/0,n=-1/0;for(let i=0,r=t.length;i<r;i++){const o=t[i],a=o.x*e.x+o.y*e.y;a<s&&(s=a),a>n&&(n=a)}return{x:s,y:n}}function XU(t,e){let s=t[1],n=t[0],i=dg({x:s.x-n.x,y:s.y-n.y}),r=i.x;i.x=-i.y,i.y=r;const o=i;s=t[2],n=t[1],i=dg({x:s.x-n.x,y:s.y-n.y}),r=i.x,i.x=-i.y,i.y=r;const a=i;s=e[1],n=e[0],i=dg({x:s.x-n.x,y:s.y-n.y}),r=i.x,i.x=-i.y,i.y=r;const l=i;return s=e[2],n=e[1],i=dg({x:s.x-n.x,y:s.y-n.y}),r=i.x,i.x=-i.y,i.y=r,[o,a,l,i]}function lL(t,e){const s=XU(t,e);for(let n=0,i=s.length;n<i;n++){const r=s[n],o=uA(t,r),a=uA(e,r);if((o.x<=a.y&&o.y>=a.x?Math.min(o.y,a.y)-Math.max(o.x,a.x):0)===0)return!1}return!0}function ZU(t){let e=0,s=0;const n=t.length;if(n===0)throw new Error("Compute centroid: at least one point is required");for(let i=0;i<n;++i){const r=t[i];e+=r.x,s+=r.y}return e/=n,s/=n,{x:e,y:s}}var uL=kh(4),dL=kh(5),hL=kh(10,.4),Ho=1/3,KU=[{x:-1,y:-Ho},{x:0,y:-Ho},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:0,y:Ho},{x:-1,y:Ho}],cL=[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],QU=[{x:-1,y:-Ho},{x:-.55,y:-Ho},{x:-1,y:-1},{x:1,y:0},{x:-1,y:1},{x:-.55,y:Ho},{x:-1,y:Ho}],dA=[{x:-.6,y:-.3},{x:.1,y:0},{x:-.6,y:.3}],gL=[{x:-1,y:.31},{x:-1,y:-.31},{x:-.31,y:-.31},{x:-.31,y:-1},{x:.31,y:-1},{x:.31,y:-.31},{x:1,y:-.31},{x:1,y:.31},{x:.31,y:.31},{x:.31,y:1},{x:-.31,y:1},{x:-.31,y:.31}],Oo={circle:{getDistanceFromStrokeVertically:(t,e)=>1,getDistanceFromStrokeHorizontally:(t,e)=>1-Math.sqrt(t*t+e*e),points:[{x:0,y:0,r:1}],isSimple:!0},square:{getDistanceFromStrokeVertically:(t,e)=>.996-Math.abs(e),getDistanceFromStrokeHorizontally:(t,e)=>.996-Math.abs(t),points:cL,isSimple:!0},line:{getDistanceFromStrokeVertically:(t,e)=>1-Math.abs(e),getDistanceFromStrokeHorizontally:(t,e)=>1,points:[{x:-1,y:0},{x:1,y:0}],isSimple:!0},triangle:{getDistanceFromStrokeVertically:(t,e)=>(1-t)/2-Math.abs(e),getDistanceFromStrokeHorizontally:(t,e)=>1-Math.abs(t),points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},arrow:{getDistanceFromStrokeVertically:(t,e)=>(1-t)/2-Math.abs(e),getDistanceFromStrokeHorizontally:(t,e)=>1-Math.abs(t),points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},"circle-hole-arrow":{getDistanceFromStrokeVertically:(t,e)=>Math.min(Math.sqrt((t+.4)*(t+.4)+e*e)-.27,(1-t)/2-Math.abs(e)),getDistanceFromStrokeHorizontally:(t,e)=>1-Math.abs(t),points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:[{x:-.4,y:0,r:.3}],isSimple:!0},"triangle-hole-arrow":{getDistanceFromStrokeVertically:(t,e)=>{const s=Math.min((1-t)/2-Math.abs(e),1-Math.abs(t)),n=-fL(t,e,dA);return Math.min(s,n)},getDistanceFromStrokeHorizontally:(t,e)=>1,points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:dA,isSimple:!0},"short-arrow":si(KU,!1),"sharp-arrow":si(QU,!1),cross:{getDistanceFromStrokeVertically:(t,e)=>1,getDistanceFromStrokeHorizontally:(t,e)=>{const s=Math.abs(t),n=Math.abs(e),i=.31-Math.min(s,n),r=1-Math.max(s,n);return Math.min(i,r)},points:gL,isSimple:!1},diamond:si(uL),pentagon:si(dL),star:si(hL),triangleUp:si([{x:-1,y:1},{x:1,y:1},{x:0,y:-1}],!0),triangleDown:si([{x:-1,y:-1},{x:1,y:-1},{x:0,y:1}],!0),triangleLeft:si([{x:1,y:-1},{x:1,y:1},{x:-1,y:0}],!0),hexagon:si(kh(6,1,-Math.PI/2+sp),!1)},JU=["circle","square","triangle","line","triangleUp","triangleDown","triangleLeft"],t3=["cross","diamond","pentagon","star","hexagon"],e3=["arrow","triangle-hole-arrow","circle-hole-arrow","short-arrow","sharp-arrow"];function hA(t,e){for(const r of JU)f_(t,r);const s=e.nodes.current.shape.getValues(),n=e.edges.current.shape.head.getValues(),i=e.edges.current.shape.tail.getValues();for(const r of t3)s.includes(r)&&f_(t,r);for(const r of e3)r&&(n.includes(r)||i.includes(r))&&f_(t,r)}function f_(t,e){t.registerShape(e,Oo[e])}function s3(t,e){Oo.star=si(Ml(hL,e,Nl)),Oo.pentagon=si(Ml(dL,e,Nl)),Oo.hexagon=si(Ml(kh(6,1,-Math.PI/2+sp),e,Nl)),Oo.square=si(Ml(cL,e,Nl)),Oo.cross=si(Ml(gL,e,Nl)),Oo.diamond=si(Ml(uL,e,Nl)),["star","pentagon","hexagon","square","cross","diamond"].forEach((s=>t.updateShape(s,Oo[s])))}function fL(t,e,s){let n=1/0;const i={x:t,y:e};for(let r=0;r<s.length;++r){const o=s[r],a=s[(r+1)%s.length];n=Math.min(n,RC(i,o,a))}return n*(oh(t,e,s)?1:-1)}function kh(t,e=1,s=-Math.PI/2+sp){const n=[],i=2*Math.PI/t;let r=s;for(let o=0;o<t;++o){const a=o%2==1?e:1;n.push({x:Math.cos(r)*a,y:Math.sin(r)*a}),r+=i}return n}function si(t,e=!1){return{getDistanceFromStrokeVertically:()=>1,getDistanceFromStrokeHorizontally:(s,n)=>fL(s,n,t),points:t,isSimple:e}}function Ml(t,e,s=5){if(e===0)return t;const n=[],i=t.length;for(let r=0;r<i;r++){const o=t[(r+i-1)%i],a=t[r%i],l=t[(r+1)%i],u=o.x-a.x,h=o.y-a.y,g=Math.sqrt(u*u+h*h),f=u/g,p=h/g,y=Math.atan2(p,f),_=l.x-a.x,x=l.y-a.y,v=Math.sqrt(_*_+x*x),b=_/v,S=x/v,A=Math.atan2(S,b),w=f*S-p*b,L=f*b-p*-S;let M=Math.asin(w<-1?-1:w>1?1:w),F=1,O=!1;L<0?M<0?M=Math.PI+M:(M=Math.PI-M,F=-1,O=!0):M>0&&(F=-1,O=!0);const G=M/2;let j=Math.abs(Math.cos(G)*e/Math.sin(G)),Z=e;j>Math.min(g/2,v/2)&&(j=Math.min(g/2,v/2),Z=Math.abs(j*Math.sin(G)/Math.cos(G)));let at=a.x+b*j,pt=a.y+S*j;at+=-S*Z*F,pt+=b*Z*F;const K=y+Math.PI/2*F;let ut=A-Math.PI/2*F-K;ut=O?ut>0?ut-2*Math.PI:ut:ut<0?ut+2*Math.PI:ut;for(let ht=0;ht<s;ht++){const nt=K+ut*(ht/(s-1)),ot=at+Z*Math.cos(nt),Mt=pt+Z*Math.sin(nt);n.push({x:ot,y:Mt})}}return n}var n3=class extends Lh{constructor(t,e){super(),this.isDummy=!0,this.width=0,this.height=0,this.namespaceURI="http://www.w3.org/1999/xhtml"}setAttribute(t,e){t==="src"&&(this.src=e),t==="crossOrigin"&&(this.crossOrigin=e)}set src(t){t&&(this._src=t,setTimeout((()=>{this.onload&&this.onload.call(this),this.width=1,this.height=1,this.fire("load")}),10))}get src(){return this._src}addEventListener(t,e){this.on(t,e)}};function i3(t,e){return new(typeof Image<"u"?Image:n3)(t,e)}var r3=class{constructor(){this._images={},this._crossOrigin="anonymous",this._whenReady=[],this._onFetch=[],this._nbLoaded=0,this._nbToLoad=0}setImgCrossOrigin(t){this._crossOrigin=t}clear(){this._images={},this._nbLoaded=0,this._nbToLoad=0}getImage(t){let e=this._images[t];return e===void 0&&(this._nbToLoad+=1,e=i3(),e.crossOrigin=this._crossOrigin,e.addEventListener("load",(()=>this._onImgLoad(t))),e.addEventListener("error",(()=>{this._onImgLoad(t),this._images[t]=null})),hF(e,"src",t),this._images[t]=e),e}_onImgLoad(t){this._nbLoaded+=1,this._onFetch.forEach((e=>e(t))),this._nbLoaded===this._nbToLoad&&(this._whenReady.forEach((e=>e())),this._whenReady=[])}onFetch(t){this._onFetch.push(t)}whenReady(){return this._nbLoaded===this._nbToLoad?Promise.resolve():new Promise((t=>this._whenReady.push(t)))}destroy(){this._whenReady=[],this._onFetch=[]}},b0={};xh(b0,{BUTTON_MAPPING:()=>Gx,BoundingBox:()=>ri,DummyCanvas:()=>_C,DummyCanvasRenderingContext2D:()=>yC,DummyDomElement:()=>r2,DummyFileReader:()=>s2,DummyTextNode:()=>XL,DummyXHR:()=>e2,ElementSet:()=>Ih,EventTarget:()=>Lh,FlexArray:()=>mf,IndexList:()=>j2,MOUSE_WHEEL_THROTTLE:()=>ZT,Map2:()=>oC,PathMap:()=>HL,PrioritySet:()=>D2,SVG_NS:()=>Bx,Table:()=>Sy,XLINK:()=>l2,XML_NS:()=>hy,applyCursorStyle:()=>hf,baseURI:()=>f2,binaryIndexOf:()=>uT,cancelAnimFrame:()=>KT,clamp:()=>Wi,clearCanvas:()=>Iy,componentsToRGBA:()=>nC,computeMax:()=>ql,computeMin:()=>Qr,concatenateArrays:()=>JI,createBlob:()=>Jd,createCanvas:()=>Pn,createDummyDomElement:()=>uf,createDummyXmlDocument:()=>KL,createElement:()=>cy,createSvgElement:()=>ys,createTextNode:()=>Ux,createWebGL2Context:()=>vC,createWorker:()=>YL,createXmlDocument:()=>QL,dataUrlToBlob:()=>o2,debounce:()=>sR,deepCopy:()=>Zs,displayPixelsOnScreen:()=>A3,ensureTransferable:()=>Gf,escapeDOMAttribute:()=>$l,extendList:()=>rR,fadeElement:()=>p2,fetch:()=>Su,fetchBinary:()=>c2,fetchBinaryAsBase64:()=>g2,flatten:()=>Kd,flattenArray:()=>lT,fontSizeToBadgeScale:()=>jL,forEach:()=>Mr,formatAngle:()=>cf,formatHex:()=>Hg,formatWorkerMessage:()=>qL,getBaseLog:()=>m2,getCurrentTime:()=>Hn,getDate:()=>ST,getDocument:()=>lo,getDocumentFontRules:()=>UL,getEmbeddedFontRules:()=>GL,getFlattenedKeys:()=>Va,getGlContext:()=>bC,getImage:()=>u2,getLeafValues:()=>Uf,getOptions:()=>ki,getPixelRatio:()=>bi,getProperty:()=>Ys,getResizeObserver:()=>n2,getStyle:()=>i2,getTime:()=>AT,getValues:()=>zd,getWebglContext:()=>d0,hash8:()=>ty,htmlSanitizer:()=>Vx,indexArrayToArray:()=>Xd,indexByName:()=>oR,insertSortAsc:()=>_d,insertSortDesc:()=>QI,isArray:()=>Nn,isBlob:()=>oP,isHTMLElement:()=>h2,isInteger:()=>eR,isLittleEndian:()=>Bf,isObject:()=>gn,isRawObject:()=>Ga,isWebGLSupported:()=>xC,lerp:()=>bs,lightDebounce:()=>dT,mapKeys:()=>iC,mapValues:()=>rC,merge:()=>Hl,mergeValues:()=>Jg,mix:()=>gy,nextPowerOfTwo:()=>Vo,objToValueList:()=>up,parseColor:()=>Yn,parseColorHex:()=>s0,parseColorRgba:()=>e0,pick:()=>sy,processQueue:()=>nR,promiseQueue:()=>cT,promptDownload:()=>ta,propertyPathToString:()=>J_,removeFromArray:()=>tR,requestAnimFrame:()=>zx,resizeElement:()=>df,resolvePath:()=>VL,rgbaToRgb:()=>Bl,serializeXMLDocument:()=>N0,setAttributes:()=>Ox,setCtxFont:()=>Zo,setElementSize:()=>Ha,setKeys:()=>x3,setProperty:()=>no,setValues:()=>Ld,smartRequire:()=>Yi,throttle:()=>Zd,toArray:()=>Q_,toHexa:()=>Ny,toPropertyPath:()=>Ua,traverse:()=>fT,unflatten:()=>ey,unorderedHash:()=>iR,workerIsAvailable:()=>$L});var ni="Arial",Ko="black",Sf="rgba(255,255,255,0)",pu=12,ah=3,E0=7,o3=!0,S0=10,a3=5,pL=1,mL="rgba(255,255,255,0)",_L="normal",yL="center",xL=!1,vL=0,By="red",bL="rgb(220, 220, 220)",EL="red",SL="rgb(220, 220, 220)",Uy="rgba(153, 161, 175, 0.2)",A0="rgba(153, 161, 175, 0.3)",l3=A0,AL="grey",wL="white",w0=2,TL=null,T0=5,Gy=0,CL="rgba(0, 0, 0, 0.36)",u3=1,d3="circle",Vy=12,wd="white",tu=40,Td="black",eu=2,Cd="black",C0=40,LL=null,NL=null,L0=1,ML="black",kL=1e3,IL=800,RL=1,FL=2,PL="rgba(0, 0, 0, 0.0)",zL="rgba(0, 0, 0, 0.6)",DL=50,h3=.1,kl=12,hg=24,lh=1,jy=lh/2,cA=.45,gA=.7,c3=10,OL=c3/2,BL=5;function g3(t){let e="";for(let s=0;s<t.length;s++)e+=t[s].cssText+`
`;return e}function UL(){const t=lo(),e=t.styleSheets||[],s=f2(t),n=[],i=[];for(let o=0;o<e.length;o++){const a=e[o];a.href==null?n.push({href:s,content:g3(a.cssRules)}):i.push(a.href)}const r=/@font-face\s*\{[^}]+\}/g;return Promise.all(i.map((o=>Su(o).then((a=>({href:o,content:a}))).catch(sf)))).then((o=>o.concat(n))).then((o=>{const a=[];for(let l=0;l<o.length;l++){const u=o[l];if(u!==null){const{href:h,content:g}=u,f=g.match(r);if(f){const p=p3(f,h);a.push.apply(a,p)}}}return a}))}function GL(t,e){return Promise.all(t.map((({formats:s,originalRule:n})=>Promise.all(s.map((({format:i,url:r})=>e?g2(r).then((o=>({format:i,src:o}))).catch(sf):{format:i,src:r}))).then((i=>{const r=[];for(const o of i)o!==null&&r.push(`url('${o.src}') format('${o.format}')`);if(r.length!==0){const o=`src: ${r.join(",")}`;return n.replace(/@font-face\s*{([^}]*);?}/,`@font-face{$1;${o}}`).replace(/\s+/," ").replace(/;+/,";")}return n})))))}var f3={"embedded-opentype":!0,svg:!0};function p3(t,e){const s=/url\(['"]?([^'")]+)['"]?\)\s+format\(['"]?([^'")]+)['"]?\)/g,n=/font-family\s*:\s*['"]?([^;'"]+)['"]?;/,i=[];for(let r=0;r<t.length;r++){const o=t[r],a=o.match(n);if(a){const l=a[1],u=[];let h;for(;h=s.exec(o);){const g=h[1],f=h[2];f3[f.toLowerCase()]||u.push({format:f,url:VL(g,e)})}i.push({name:l,formats:u,originalRule:o})}}return i}function VL(t,e){if(/^http(s)?:/.test(t))return t;if(t[0]==="/"){const i=e.match(/((\w+:\/\/)([^/]+))/);return i?i[1]+t:t}const s=t.split("/"),n=e.split("/");for(e[e.length-1]!=="/"&&n.pop();s[0]==="..";)s.shift(),n.pop();return n.concat(s).join("/").replace(/[\w](\/{2,})/g,(i=>i[0]+"/"))}function jL(t,e,s=jy){return t/s/(2*e)}function m3(t){return t instanceof RegExp||t instanceof Date}var _3=typeof HTMLElement>"u"?t=>!1:t=>t instanceof HTMLElement,y3=function(t){return typeof t!="object"||t===null||Nn(t)||m3(t)};function up(t,e=[],s=[]){if(!_3(t)){if(y3(t))e.push({path:s.slice(),value:t});else{const n=Object.keys(t);for(let i=0;i<n.length;++i){const r=n[i],o=s.slice();o.push(r),up(t[r],e,o)}}return e}}var HL=class{constructor(){this._keys=[],this._values=[],this._size=0,this._cachedPath=[],this._cachedIndex=-1}get size(){return this._size}set(t,e){const s=this._getIndex(t);s!==-1?this._values[s]=e:(p_(this._cachedPath,t)&&(this._cachedIndex=this._keys.length),this._keys.push(t),this._values.push(e),this._size+=1)}get(t){const e=this._getIndex(t);if(e!==-1)return this._values[e]}has(t){return this._getIndex(t)!==-1}keys(){return this._keys.slice()}_getIndex(t){if(p_(t,this._cachedPath))return this._cachedIndex;this._cachedPath=t.slice();const e=this._keys;for(let s=0;s<e.length;++s)if(p_(e[s],t))return this._cachedIndex=s,s;return this._cachedIndex=-1,-1}};function p_(t,e){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(t[s]!==e[s])return!1;return!0}var Hy,x3=function(e){return Array.from(e.keys())},Ld=function(e){return Array.from(e.values())},uh=Yi("web-worker"),$L=!!uh||typeof Worker<"u"&&typeof Blob<"u";function qL(t){return uh?$y(t):t}function $y(t){if(ArrayBuffer.isView(t))return Array.from(t);if(Array.isArray(t)){for(let e=0;e<t.length;e++)t[e]=$y(t[e]);return t}if(gn(t)){const e=Object.keys(t);for(const s of e)t[s]=$y(t[s]);return t}return t}function YL(t){return uh?b3(t.toString()):v3(t)}function v3(t){return cF(WR(t))}function b3(t){if(uh)return new uh("data:application/javascript,"+t.replace(/\n/g,""))}var fA=Yi("@xmldom/xmldom");Hy=typeof XMLSerializer<"u"?XMLSerializer:fA?fA.XMLSerializer:null;var E3=class WL{constructor(e){this._attributes={},this._children=[],this._name=e}setAttribute(e,s){this._attributes[e]=s}appendChild(e){this._children.push(e)}get tagName(){return this._name}get children(){return this._children}get childNodes(){return this._children}get firstChild(){return this._children[0]||null}serialize(){const e=this._name,s=this._attributes,n=this._children,i=Object.keys(s).filter((o=>s[o]!==void 0)).map((o=>` ${o}="${""+s[o]}"`)).join(""),r=n.map((o=>o.serialize())).join("");return r.length?`<${e}${i}>${r}</${e}>`:`<${e}${i}/>`}cloneNode(e){const s=new WL(this._name),n=Object.keys(this._attributes);for(const i of n)s.setAttribute(i,this._attributes[i]);if(e)for(let i=0;i<this._children.length;i++)s.appendChild(this._children[i].cloneNode(e));return s}},XL=class ZL{constructor(e){this._text=e}serialize(){return this._text}cloneNode(){return new ZL(this._text)}},S3=class{constructor(){this._children=[],this._meta=[],this._children=[],this._meta=[]}appendChild(t){this._children.push(t)}serialize(){return this._meta.concat(this._children.map((t=>t.serialize()))).join("")}createElement(t){return new E3(t)}createTextNode(t){return new XL(t)}},KL=()=>new S3;function N0(t){if(Hy)return new Hy().serializeToString(t)}var QL=()=>lo().implementation.createDocument("","",null),Ih=class{constructor(t,e){this._graph=t,this._nodes={elementList:t.nodeList,flexArray:t.createNodeAttribute({storage:1,name:e},!!e),indexList:t.createIndexList(!0)},this._edges={elementList:t.edgeList,flexArray:t.createEdgeAttribute({storage:1,name:e},!!e),indexList:t.createIndexList(!1)}}_get(t){return t.isNode?this._nodes:this._edges}addOrRemoveElements(t,e){return e?this.addElements(t):this.removeElements(t)}addElements(t){const{elementList:e,flexArray:s,indexList:n}=this._get(t),i=n.getLength();for(let r=0;r<t._indexes.length;r++){const o=t._indexes[r];s.get(o)!==1&&(s.set(o,1),n.pushUnchecked(o))}return e(n.slice(i))}removeElements(t){const{elementList:e,flexArray:s,indexList:n}=this._get(t),i=n.getLength(),r=n.getBuffer();if(i>r.length)return this.clear(),this.addElements(t),t;let o=0;for(let a=0;a<t._indexes.length;a++){const l=t._indexes[a];s.get(l)!==0&&(s.set(l,0),o+=1)}if(o===i)return e(n.sliceAndReset());if(o===0)return e();{const a=this._graph.acquireIndexList(t.isNode);let l=0;for(let u=0;u<i;++u){const h=r[u];s.get(h)===0?(l+=1,a.pushUnchecked(h)):r[u-l]=h}return n.setLength(i-o),e(a.sliceAndReset())}}hasElement(t){return!!this._get(t).flexArray.get(t._index)}clear(){this._nodes.indexList.isEmpty()||(this._nodes.indexList.reset(),this._nodes.flexArray.reset()),this._edges.indexList.isEmpty()||(this._edges.indexList.reset(),this._edges.flexArray.reset())}isEmpty(){return this._nodes.indexList.isEmpty()&&this._edges.indexList.isEmpty()}getElements(){return{nodes:this._nodes.elementList(this._nodes.indexList.slice()),edges:this._edges.elementList(this._edges.indexList.slice())}}};function A3(t,e,s,n=0){e===void 0&&(e=s=Math.sqrt(t.length/4)),s===void 0&&(s=e);const i=document.createElement("canvas"),r=i.getContext("2d");if(r){const o=r.createImageData(e,s);i.style.imageRendering="pixelated",i.style.border="1px solid black",i.style.margin="2px",i.style.position="absolute",i.style.top=i.style.left="0px",i.width=e,i.height=s,o.data.set(t),r.putImageData(o,0,0);const a=document.getElementById("graph-container");a&&(a.style.position="static"),setTimeout((()=>document.body.appendChild(i)),n)}}var w3=class{constructor(t,e){this._attributesManager=t,this._id=e}getDefinition(){return this._attributesManager.getAttributeLayerDefinition(this._id)}update(t){this._attributesManager.updateAttributeLayer(this._id,t)}destroy(){this._attributesManager.destroyAttributeLayer(this._id)}updateElements(t){this._attributesManager.updateElementsForAttributeLayer(this._id,t)}updateAll(){this._attributesManager.updateAllForAttributeLayer(this._id)}setAttributeValues(t,e,s){this._attributesManager.setAttributeLayerValues(this._id,t,e,s)}getUsedAttributeNames(t){return this._attributesManager.getUsedAttributeLayerAttributes(this._id,t)}getFlexArrays(){return this._attributesManager.getAttributeLayerFlexArrays(this._id)}},M0={};xh(M0,{cubicIn:()=>N3,cubicInOut:()=>k3,cubicOut:()=>M3,linear:()=>Af,quadraticIn:()=>T3,quadraticInOut:()=>L3,quadraticOut:()=>C3});var Af=t=>t,T3=t=>t*t,C3=t=>t*(2-t),L3=t=>(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1),N3=t=>t*t*t,M3=t=>--t*t*t+1,k3=t=>(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2),I3={name:"animationStart",storage:32,default:0},R3={name:"animationDuration",storage:16,default:0},F3={name:"animationEasing",storage:"resource",default:"linear"},P3={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentNodes:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:void 0,allEdges:void 0},z3={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},extremities:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},parallelEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:void 0,allEdges:void 0},D3={x:1,y:1,radius:1,"halo.hideNonAdjacentEdges":1};function Hd(t){return typeof t=="string"}var qy=1,JL="scaled",tN="grey",eN=1,sN=0,nN=0,iN=!0,rN=0,oN=!0,aN="line",lN=null,uN=null,dN="plain",hN="inherit",Yy=0,cN="fixed",gN=0,fN=null,Wy=10,pN="fixed",mN=1e3,_N=800,yN="rgba(0, 0, 0, 0.6)",xN="rgba(0, 0, 0, 0)",vN=10,bN=1,EN=2,SN="rgba(0, 0, 0, 0.36)",AN=0,O3=1,wN="normal",TN="center",CN=2,Xy=2,LN=Mh,NN=4,MN=!0,kN=4,Zy=2,Ky=12,IN=2;function B3(t,e,s){let n,i,r,o;s==="line"?(n="line",i="plain",r=null,o=null):s==="arrow"?(n="line",i="plain",r="arrow",o=null):s==="tapered"?(n="triangle",i="plain",r=null,o=null):s==="dashed"?(n="line",i="dashed",r=null,o=null):s==="dotted"&&(n="line",i="dotted",r=null,o=null),t.shape.body.set(e,n),t.shape.style.set(e,i),t.shape.head.set(e,r),t.shape.tail.set(e,o)}var RN={width:{_flexArray:qy,_check:Es(qy)},scalingMethod:{_flexArray:JL,_check:to},color:{_flexArray:tN,_check:pU},opacity:{_flexArray:eN,_check:js},minVisibleSize:{_flexArray:sN,_check:js},layer:{_flexArray:nN,_check:nL},detectable:{_flexArray:iN,_check:Fn},curvature:{_flexArray:rN,_check:Ba},adjustAnchors:{_flexArray:oN,_check:Fn},shape:{_check:yU,_set:B3,type:"shape.head",body:{_flexArray:aN,_check:xU},head:{_flexArray:lN,_check:QS},tail:{_flexArray:uN,_check:QS},style:{_flexArray:dN,_check:vU}},stroke:{color:{_flexArray:hN,_check:Vn},width:{_flexArray:Yy,_check:Es(Yy)},scalingMethod:{_flexArray:cN,_check:to},minVisibleSize:{_flexArray:gN,_check:js}},strokeWidth:"stroke.width",halo:{_alias:"halo.color",color:{_flexArray:fN,_check:jo},width:{_flexArray:Wy,_check:Es(Wy)},scalingMethod:{_flexArray:pN,_check:to},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:Fn},duration:{_flexArray:mN,_check:js},interval:{_flexArray:_N,_check:js},startColor:{_flexArray:yN,_check:Vn},endColor:{_flexArray:xN,_check:Vn},width:{_flexArray:vN,_check:js},startRatio:{_flexArray:bN,_check:js},endRatio:{_flexArray:EN,_check:js}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:Fn},color:{_flexArray:SN,_check:jo},minVisibleSize:{_flexArray:AN,_check:js}},text:{_alias:"text.content",content:{_flexArray:null,_check:Jr},font:{_flexArray:ni,_check:nu},color:{_flexArray:Ko,_check:jo},size:{_flexArray:pu,_check:Es(pu)},scale:{_flexArray:1,_check:js},style:{_flexArray:wN,_check:iu},align:{_flexArray:TN,_check:Ef},margin:{_flexArray:CN,_check:Ba},padding:{_flexArray:Xy,_check:Es(Xy)},backgroundColor:{_flexArray:Sf,_check:Vn},minVisibleSize:{_flexArray:NN,_check:js},position:{_flexArray:LN,_check:fU},adjustAngle:{_flexArray:MN,_check:Fn},scaling:{_flexArray:xL,_check:Fn},maxLineLength:{_flexArray:vL,_check:js},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Jr},font:{_flexArray:ni,_check:nu},color:{_flexArray:Ko,_check:jo},size:{_flexArray:Ky,_check:Es(Ky)},scale:{_flexArray:pL,_check:js},style:{_flexArray:_L,_check:iu},align:{_flexArray:yL,_check:Ef},margin:{_flexArray:IN,_check:Ba},padding:{_flexArray:Zy,_check:Es(Zy)},backgroundColor:{_flexArray:mL,_check:Vn},minVisibleSize:{_flexArray:kN,_check:js}}}},U3=Es(BL),G3=Es(pu),V3=Es(S0),j3=Es(w0),H3=Es(T0),$3=Es(E0),pA=Es(ah),q3=Es(OL),Y3=Es(C0),W3=Es(L0);function cg(t){return{_check:Jr,_set:(e,s,n)=>{e.badges[t].text.content.set(s,n),n==null&&e.badges[t].image.url.set(s,n)},_get:(e,s)=>e.badges[t].text.content.get(s),color:{_flexArray:wd,_check:Vn},scale:{_flexArray:cA,_check:Es(cA)},positionScale:{_flexArray:1,_check:js},minVisibleSize:{_flexArray:tu,_check:Es(tu)},scalingMethod:{_flexArray:"scaled",_check:to},image:{_alias:`badges.${t}.image.url`,url:{_flexArray:null,_check:Jr},scale:{_flexArray:lh,_check:Es(lh)}},stroke:{color:{_flexArray:Td,_check:Vn},width:{_flexArray:eu,_check:Es(eu)},scalingMethod:{_flexArray:"fixed",_check:to}},text:{_alias:`badges.${t}.text.content`,content:{_flexArray:null,_check:Jr},color:{_flexArray:Cd,_check:Vn},font:{_flexArray:ni,_check:nu},style:{_flexArray:"normal",_check:iu},scale:{_flexArray:jy,_check:Es(jy)},paddingLeft:{_flexArray:0,_check:Ba},paddingTop:{_flexArray:0,_check:Ba}}}}var FN={x:{_flexArray:0,_check:Ba,_disableMemoryOptimization:!0},y:{_flexArray:0,_check:Ba,_disableMemoryOptimization:!0},radius:{_flexArray:BL,_check:U3},scalingMethod:{_flexArray:"scaled",_check:to},color:{_flexArray:AL,_check:EU},opacity:{_flexArray:1,_check:js},shape:{_flexArray:"circle",_check:mU},layer:{_flexArray:0,_check:nL},detectable:{_flexArray:!0,_check:Fn},draggable:{_flexArray:!0,_check:Fn},layoutable:{_flexArray:!0,_check:Fn},innerStroke:{_alias:"innerStroke.color",width:{_flexArray:w0,_check:j3},scalingMethod:{_flexArray:"fixed",_check:to},color:{_flexArray:wL,_check:Vn},minVisibleSize:{_flexArray:Vy,_check:Es(Vy)}},outerStroke:{_alias:"outerStroke.color",width:{_flexArray:T0,_check:H3},scalingMethod:{_flexArray:"fixed",_check:to},color:{_flexArray:TL,_check:Vn},minVisibleSize:{_flexArray:Gy,_check:Es(Gy)}},badges:{_check:cU,_set(t,e,s){t.badges.topLeft.text.content.set(e,s),t.badges.topLeft.image.url.set(e,s),t.badges.topRight.text.content.set(e,s),t.badges.topRight.image.url.set(e,s),t.badges.bottomLeft.text.content.set(e,s),t.badges.bottomLeft.image.url.set(e,s),t.badges.bottomRight.text.content.set(e,s),t.badges.bottomRight.image.url.set(e,s)},topLeft:cg("topLeft"),topRight:cg("topRight"),bottomLeft:cg("bottomLeft"),bottomRight:cg("bottomRight")},halo:{_alias:"halo.color",color:{_flexArray:LL,_check:jo},width:{_flexArray:C0,_check:Y3},scalingMethod:{_flexArray:"fixed",_check:to},strokeColor:{_flexArray:NL,_check:jo},strokeWidth:{_flexArray:L0,_check:W3},clustering:{_flexArray:!1,_check:Fn},hideNonAdjacentEdges:{_flexArray:!1,_check:Fn}},pulse:{enabled:{_flexArray:!1,_check:Fn},duration:{_flexArray:kL,_check:js},interval:{_flexArray:IL,_check:js},startColor:{_flexArray:zL,_check:Vn},endColor:{_flexArray:PL,_check:Vn},width:{_flexArray:DL,_check:js},startRatio:{_flexArray:RL,_check:js},endRatio:{_flexArray:FL,_check:js}},icon:{_alias:"icon.content",content:{_flexArray:null,_check:Jr},font:{_flexArray:ni,_check:nu},color:{_flexArray:ML,_check:jo},scale:{_flexArray:gA,_check:Es(gA)},style:{_flexArray:"normal",_check:iu},minVisibleSize:{_flexArray:kl,_check:Es(kl)}},image:{_alias:"image.url",url:{_flexArray:null,_check:Jr},scale:{_flexArray:lh,_check:Es(lh)},fit:{_flexArray:!0,_check:Fn},tile:{_flexArray:!1,_check:Fn},minVisibleSize:{_flexArray:kl,_check:Es(kl)}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:Fn},color:{_flexArray:CL,_check:jo},minVisibleSize:{_flexArray:kl,_check:Es(kl)}},text:{_alias:"text.content",content:{_flexArray:null,_check:Jr},font:{_flexArray:ni,_check:nu},color:{_flexArray:Ko,_check:Vn},size:{_flexArray:pu,_check:G3},scale:{_flexArray:h3,_check:js},style:{_flexArray:"normal",_check:iu},align:{_flexArray:"center",_check:Ef},margin:{_flexArray:E0,_check:$3},padding:{_flexArray:ah,_check:pA},backgroundColor:{_flexArray:null,_check:Vn},tip:{_flexArray:!0,_check:Fn},minVisibleSize:{_flexArray:hg,_check:Es(hg)},scaling:{_flexArray:!1,_check:Fn},position:{_flexArray:"bottom",_check:bU},maxLineLength:{_flexArray:0,_check:js},truncateLength:{_flexArray:0,_check:js},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Jr},font:{_flexArray:ni,_check:nu},color:{_flexArray:Ko,_check:Vn},size:{_flexArray:S0,_check:V3},scale:{_flexArray:.08,_check:js},style:{_flexArray:"normal",_check:iu},align:{_flexArray:"center",_check:Ef},margin:{_flexArray:OL,_check:q3},padding:{_flexArray:ah,_check:pA},backgroundColor:{_flexArray:null,_check:Vn},minVisibleSize:{_flexArray:hg,_check:Es(hg)}}}},X3=t=>(e,s)=>e[t].get(s),Z3=(t,e)=>(s,n)=>s[t][e].get(n),K3=(t,e,s)=>(n,i)=>n[t][e][s].get(i),Q3=(t,e,s,n)=>(i,r)=>i[t][e][s][n].get(r),J3=t=>(e,s,n)=>e[t].set(s,n),t4=(t,e)=>(s,n,i)=>s[t][e].set(n,i),e4=(t,e,s)=>(n,i,r)=>n[t][e][s].set(i,r),s4=(t,e,s,n)=>(i,r,o)=>i[t][e][s][n].set(r,o),n4=[X3,Z3,K3,Q3],i4=[J3,t4,e4,s4];function mA(t,e){if(!t._check)throw new Error(`error somewhere for ${e}`);const s=e.split("."),n=s.length-1,i=n4[n].apply(null,s),r=i4[n].apply(null,s);return{check:t._check,set:r,get:i,nested:{}}}function wf(t,e){const s=e?FN:RN,n=typeof t=="string"?[t]:Va(t,"",[]);let i=!1;const r=[];for(let o=0;o<n.length;o++){const a=n[o].split(".");let l=s[a[0]];for(let h=1;h<a.length;h++)l=l[a[h]];l.type&&(n[o]=l.type),l._alias&&(n[o]=l._alias),n[o]==="badges"&&(n[o]="badges.topLeft.text.content",i=!0);const u=a[a.length-1];u!=="topLeft"&&u!=="topRight"&&u!=="bottomLeft"&&u!=="bottomRight"||(n[o]=`badges.${u}.text.content`,r.push(`badges.${u}.image.url`)),n[o]==="strokeWidth"&&(n[o]="stroke.width")}return i&&(n.push("badges.topLeft.image.url"),n.push("badges.topRight.text.content"),n.push("badges.topRight.image.url"),n.push("badges.bottomLeft.text.content"),n.push("badges.bottomLeft.image.url"),n.push("badges.bottomRight.text.content"),n.push("badges.bottomRight.image.url")),n.push(...r),n}var gg=t=>(e,s)=>({url:e.badges[t].image.url.get(s),scale:e.badges[t].image.scale.get(s)}),fg=t=>(e,s)=>({color:e.badges[t].stroke.color.get(s),width:e.badges[t].stroke.width.get(s),scalingMethod:e.badges[t].stroke.scalingMethod.get(s)}),pg=t=>(e,s)=>({content:e.badges[t].text.content.get(s),color:e.badges[t].text.color.get(s),font:e.badges[t].text.font.get(s),style:e.badges[t].text.style.get(s),scale:e.badges[t].text.scale.get(s),paddingLeft:e.badges[t].text.paddingLeft.get(s),paddingTop:e.badges[t].text.paddingTop.get(s)}),mg=t=>(e,s)=>({color:e.badges[t].color.get(s),scale:e.badges[t].scale.get(s),positionScale:e.badges[t].positionScale.get(s),minVisibleSize:e.badges[t].minVisibleSize.get(s),image:{url:e.badges[t].image.url.get(s),scale:e.badges[t].image.scale.get(s)},stroke:{color:e.badges[t].stroke.color.get(s),width:e.badges[t].stroke.width.get(s),scalingMethod:e.badges[t].stroke.scalingMethod.get(s)},text:{content:e.badges[t].text.content.get(s),color:e.badges[t].text.color.get(s),font:e.badges[t].text.font.get(s),style:e.badges[t].text.style.get(s),scale:e.badges[t].text.scale.get(s),paddingLeft:e.badges[t].text.paddingLeft.get(s),paddingTop:e.badges[t].text.paddingTop.get(s)}}),zo={topLeft:mg("topLeft"),topRight:mg("topRight"),bottomLeft:mg("bottomLeft"),bottomRight:mg("bottomRight")},ar={stroke:(t,e)=>({color:t.stroke.color.get(e),width:t.stroke.width.get(e),scalingMethod:t.stroke.scalingMethod.get(e),minVisibleSize:t.stroke.minVisibleSize.get(e)}),innerStroke:(t,e)=>({width:t.innerStroke.width.get(e),scalingMethod:t.innerStroke.scalingMethod.get(e),color:t.innerStroke.color.get(e),minVisibleSize:t.innerStroke.minVisibleSize.get(e)}),outerStroke:(t,e)=>({width:t.outerStroke.width.get(e),scalingMethod:t.outerStroke.scalingMethod.get(e),color:t.outerStroke.color.get(e),minVisibleSize:t.outerStroke.minVisibleSize.get(e)}),pulse:(t,e)=>({enabled:t.pulse.enabled.get(e),duration:t.pulse.duration.get(e),interval:t.pulse.interval.get(e),startColor:t.pulse.startColor.get(e),endColor:t.pulse.endColor.get(e),width:t.pulse.width.get(e),startRatio:t.pulse.startRatio.get(e),endRatio:t.pulse.endRatio.get(e)}),outline:(t,e)=>({enabled:t.outline.enabled.get(e),color:t.outline.color.get(e),minVisibleSize:t.outline.minVisibleSize.get(e)}),halo:(t,e)=>({color:t.halo.color.get(e),width:t.halo.width.get(e),scalingMethod:t.halo.scalingMethod.get(e),strokeColor:t.halo.strokeColor.get(e),strokeWidth:t.halo.strokeWidth.get(e),clustering:t.halo.clustering.get(e),hideNonAdjacentEdges:t.halo.hideNonAdjacentEdges.get(e)}),"text.secondary":(t,e)=>({content:t.text.secondary.content.get(e),font:t.text.secondary.font.get(e),color:t.text.secondary.color.get(e),size:t.text.secondary.size.get(e),scale:t.text.secondary.scale.get(e),style:t.text.secondary.style.get(e),align:t.text.secondary.align.get(e),margin:t.text.secondary.margin.get(e),padding:t.text.secondary.padding.get(e),backgroundColor:t.text.secondary.backgroundColor.get(e),minVisibleSize:t.text.secondary.minVisibleSize.get(e)}),text:(t,e)=>({content:t.text.content.get(e),font:t.text.font.get(e),color:t.text.color.get(e),size:t.text.size.get(e),scale:t.text.scale.get(e),style:t.text.style.get(e),align:t.text.align.get(e),margin:t.text.margin.get(e),padding:t.text.padding.get(e),backgroundColor:t.text.backgroundColor.get(e),tip:t.text.tip.get(e),minVisibleSize:t.text.minVisibleSize.get(e),scaling:t.text.scaling.get(e),position:t.text.position.get(e),maxLineLength:t.text.maxLineLength.get(e),truncateLength:t.text.truncateLength.get(e),secondary:ar["text.secondary"](t,e)}),image:(t,e)=>({url:t.image.url.get(e),scale:t.image.scale.get(e),fit:t.image.fit.get(e),tile:t.image.tile.get(e),minVisibleSize:t.image.minVisibleSize.get(e)}),icon:(t,e)=>({content:t.icon.content.get(e),font:t.icon.font.get(e),color:t.icon.color.get(e),scale:t.icon.scale.get(e),style:t.icon.style.get(e),minVisibleSize:t.icon.minVisibleSize.get(e)}),badges:(t,e)=>({topLeft:zo.topLeft(t,e),topRight:zo.topRight(t,e),bottomLeft:zo.bottomLeft(t,e),bottomRight:zo.bottomRight(t,e)}),"badges.topLeft":zo.topLeft,"badges.topRight":zo.topRight,"badges.bottomLeft":zo.bottomLeft,"badges.bottomRight":zo.bottomRight,"badges.topLeft.image":gg("topLeft"),"badges.topLeft.stroke":fg("topLeft"),"badges.topLeft.text":pg("topLeft"),"badges.topRight.image":gg("topRight"),"badges.topRight.stroke":fg("topRight"),"badges.topRight.text":pg("topRight"),"badges.bottomLeft.image":gg("bottomLeft"),"badges.bottomLeft.stroke":fg("bottomLeft"),"badges.bottomLeft.text":pg("bottomLeft"),"badges.bottomRight.image":gg("bottomRight"),"badges.bottomRight.stroke":fg("bottomRight"),"badges.bottomRight.text":pg("bottomRight"),all:(t,e)=>({x:t.x.get(e),y:t.y.get(e),radius:t.radius.get(e),scalingMethod:t.scalingMethod.get(e),color:t.color.get(e),opacity:t.opacity.get(e),shape:t.shape.get(e),layer:t.layer.get(e),detectable:t.detectable.get(e),draggable:t.draggable.get(e),layoutable:t.layoutable.get(e),innerStroke:ar.innerStroke(t,e),outerStroke:ar.outerStroke(t,e),badges:ar.badges(t,e),halo:ar.halo(t,e),pulse:ar.pulse(t,e),icon:ar.icon(t,e),image:ar.image(t,e),outline:ar.outline(t,e),text:ar.text(t,e)})},Bo={shape:(t,e)=>({body:t.shape.body.get(e),head:t.shape.head.get(e),tail:t.shape.tail.get(e),style:t.shape.style.get(e)}),"text.secondary":(t,e)=>({content:t.text.secondary.content.get(e),font:t.text.secondary.font.get(e),color:t.text.secondary.color.get(e),size:t.text.secondary.size.get(e),scale:t.text.secondary.scale.get(e),style:t.text.secondary.style.get(e),align:t.text.secondary.align.get(e),margin:t.text.secondary.margin.get(e),padding:t.text.secondary.padding.get(e),backgroundColor:t.text.secondary.backgroundColor.get(e),minVisibleSize:t.text.secondary.minVisibleSize.get(e)}),text:(t,e)=>({content:t.text.content.get(e),font:t.text.font.get(e),color:t.text.color.get(e),size:t.text.size.get(e),scale:t.text.scale.get(e),style:t.text.style.get(e),align:t.text.align.get(e),margin:t.text.margin.get(e),padding:t.text.padding.get(e),position:t.text.position.get(e),backgroundColor:t.text.backgroundColor.get(e),minVisibleSize:t.text.minVisibleSize.get(e),adjustAngle:t.text.adjustAngle.get(e),scaling:t.text.scaling.get(e),maxLineLength:t.text.maxLineLength.get(e),secondary:Bo["text.secondary"](t,e)}),outline:(t,e)=>({enabled:t.outline.enabled.get(e),color:t.outline.color.get(e),minVisibleSize:t.outline.minVisibleSize.get(e)}),pulse:(t,e)=>({enabled:t.pulse.enabled.get(e),duration:t.pulse.duration.get(e),interval:t.pulse.interval.get(e),startColor:t.pulse.startColor.get(e),endColor:t.pulse.endColor.get(e),width:t.pulse.width.get(e),startRatio:t.pulse.startRatio.get(e),endRatio:t.pulse.endRatio.get(e)}),stroke:(t,e)=>({color:t.stroke.color.get(e),width:t.stroke.width.get(e),scalingMethod:t.stroke.scalingMethod.get(e),minVisibleSize:t.stroke.minVisibleSize.get(e)}),halo:(t,e)=>({color:t.halo.color.get(e),width:t.halo.width.get(e),scalingMethod:t.halo.scalingMethod.get(e)}),all:(t,e)=>({width:t.width.get(e),scalingMethod:t.scalingMethod.get(e),color:t.color.get(e),opacity:t.opacity.get(e),minVisibleSize:t.minVisibleSize.get(e),layer:t.layer.get(e),detectable:t.detectable.get(e),curvature:t.curvature.get(e),adjustAnchors:t.adjustAnchors.get(e),shape:Bo.shape(t,e),stroke:Bo.stroke(t,e),halo:Bo.halo(t,e),pulse:Bo.pulse(t,e),outline:Bo.outline(t,e),text:Bo.text(t,e)})};function k0(t,e,s,n=!0){if((e=e||t)._flexArray!==void 0)return mA(e,s);let i={check:hr,get:as,set:as,nested:{}};if(Hd(e)||e._alias){const r=Hd(e)?e:e._alias;i=mA(Ys(t,r),r)}else{if(e._set?(i.set=e._set,i.check=e._check):(i.set=as,i.check=as),e._get)i.get=e._get;else{const r=n?ar:Bo;i.get=r[s||"all"]}i.nested={}}if(!Hd(e)){const r=Object.keys(e);for(const o of r){const a=e[o];o.startsWith("_")||(i.nested[o]=k0(t,a,s?s+"."+o:o,n))}}return i}var r4=k0(FN,void 0,void 0,!0),o4=k0(RN,void 0,void 0,!1),a4=[];function _A(t){let e=a4;return t.output===void 0?(typeof t.attributes=="function"&&(e="all"),gn(t.attributes)&&(e=Va(t.attributes))):t.output&&(e=t.output.attributes),I0(e,t.allAttributePaths)}function l4(t,e,s,n){if(n>s){for(const i of e.attributes)for(const r of t.attributes)if(r===i)return!0}for(const i of e.tags)for(const r of t.tags)if(i===r)return!0;return!1}function Ar(t,e,s,n,i,r){l4(s,n,i,r)&&t.push(e)}function u4(t){let e=t.dependencies;e===void 0?e=P3:gn(e)||(e={});const s=Uf(t.attributes).some((o=>typeof o=="function")),n=t.selector&&!t.standaloneSelector,i=!(!s&&!n);let r=e.adjacentEdges;return!r&&e.adjacentNodes&&(r=!0),{self:Nr(e.self,i,t.allAttributePaths),adjacentNodes:Nr(e.adjacentNodes,i,t.allAttributePaths),adjacentEdges:Nr(r,i,t.allAttributePaths),allNodes:Nr(e.allNodes,i,t.allAttributePaths),allEdges:Nr(e.allEdges,i,t.allAttributePaths)}}function d4(t){let e=t.dependencies;e===void 0?e=z3:gn(e)||(e={});const s=Uf(t.attributes).some((r=>typeof r=="function")),n=t.selector&&!t.standaloneSelector,i=!(!s&&!n);return{self:Nr(e.self,i,t.allAttributePaths),extremities:Nr(e.extremities,i,t.allAttributePaths),parallelEdges:Nr(e.parallelEdges,i,t.allAttributePaths),allNodes:Nr(e.allNodes,i,t.allAttributePaths),allEdges:Nr(e.allEdges,i,t.allAttributePaths)}}function Nr(t,e,s){if(!e)return{attributes:[],tags:[]};if(t===!0)return{attributes:[],tags:[xy]};const n={attributes:I0((t=t||{}).attributes,s),tags:g4(t.tags)};return t.data&&n.tags.push(vy),t.selection&&n.tags.push(Ts),t.hover&&n.tags.push(Od),n}function h4(t){return Array.isArray(t)?t.join("."):t}function c4(t){return t.map(h4).filter(Hd)}function I0(t,e){if(t==="all")return e.slice();if(!Array.isArray(t))return[];const s=c4(t);return e?e.filter((n=>s.some((i=>n.startsWith(i))))):s}function g4(t){return Array.isArray(t)?t.filter(Hd):[]}var yA={storage:1,default:0},Tf=class{constructor({graph:t,isNode:e,includeRemovedElements:s}){this._all=!1,this._isNode=e,this._graph=t,this._includeRemovedElements=s,this._eltList=e?this._graph.nodeList:this._graph.edgeList,this._flexArray=e?t.createNodeAttribute(yA,!1):t.createEdgeAttribute(yA,!1),this._all=!1,this._indexList=t.createIndexList(e)}_getAllIndexes(){const t=this._isNode?this._graph.getNodeMaxIndex():this._graph.getEdgeMaxIndex(),e=new Uint32Array(t);for(let s=1;s<=t;++s)e[s-1]=s;return e}addAll(){this._all=!0}add(t){if(!this._all)for(let e=0;e<t._indexes.length;e++){const s=t._indexes[e];this.addIndex(s)}}addIndex(t){this._flexArray.get(t)===0&&(this._flexArray.set(t,1),this._indexList.push(t))}isEmpty(){return!this._all&&this._indexList.isEmpty()}isFull(){return this._all}getListAndClear(){const t=this.getList();return this.clear(),t}getList(){let t;if(this._all&&!this._includeRemovedElements)t=this._isNode?this._graph.getNodes("all"):this._graph.getEdges("all");else{const e=this._all?this._getAllIndexes():this._indexList.slice();t=this._eltList(e)}return t}clear(){this._all=!1,this._indexList.isEmpty()||(this._indexList.reset(),this._flexArray.reset())}addSet(t){if(t._all)this.addAll();else{const e=t._indexList.getBuffer(),s=t._indexList.getLength();for(let n=0;n<s;++n)this.addIndex(e[n])}}};function PN(t,e=[],s=""){return t.constructor===mf?t.isInitialized()&&e.push(s):t.constructor===Object&&Object.keys(t).forEach((n=>{PN(t[n],e,s?s+"."+n:n)})),e}var xA=class{constructor(t,e,s){this._updatedAttributes=new Set,this._updatedAttributesTmp=new Set,this._allUsedAttributes=new Set,this._graph=t,this._eltName=e?"node":"edge",this._accessors=e?r4:o4,this._createFlexArrays=s;const n=this._createFlexArrays(t,{original:!0,useDefaultValues:!0});this._finalFlexArrays=n;const i=this._createFlexArrays(t,{original:!1,useDefaultValues:!0});this._prevFlexArrays=i;const r=this._createFlexArrays(t,{original:!1,useDefaultValues:!0});this._defaultFlexArrays=r,this._currentFlexArrays=this._defaultFlexArrays,this.setLastFlexArrays(this._defaultFlexArrays),this._elementsToRedraw=new Tf({graph:t,isNode:e,includeRemovedElements:!0}),this._elementsUpdated=new Tf({graph:t,isNode:e,includeRemovedElements:!1}),this._finalFlexArraysWrapped={...this._finalFlexArrays,excluded:t.getAttribute(e,"excluded"),textHidden:t.getAttribute(e,"textHidden"),animationStart:t.createAttribute(e,I3),animationDuration:t.createAttribute(e,R3),animationEasing:t.createAttribute(e,F3),id:this._graph.getAttribute(e,"id"),...!e&&{source:t.getEdgeAttribute("source"),target:t.getEdgeAttribute("target")}}}clear(){this._elementsToRedraw.clear(),this._elementsUpdated.clear(),this._updatedAttributes.clear(),this._updatedAttributesTmp.clear()}getAttributeFlexArrays(){return this._finalFlexArraysWrapped}getPrevAttributeFlexArrays(){return this._prevFlexArrays}getAnimationInformation(t){const e=t._indexes,s=Array(e.length),n=this._finalFlexArraysWrapped;for(let i=0;i<e.length;i++){const r=e[i];s[i]={duration:n.animationDuration.get(r),start:n.animationStart.get(r),easing:n.animationEasing.get(r)}}return s}setDefaultAttributes(t){Va(t).forEach((e=>{const s=Ys(this._currentFlexArrays,e),n=Ys(this._prevFlexArrays,e),i=Ys(this._defaultFlexArrays,e),r=Ys(this._finalFlexArrays,e);if(!s)return;const o=Ys(t,e);s.setDefaultValue(o),i.setDefaultValue(o),n.setDefaultValue(o),r.setDefaultValue(o)})),this.redrawAll()}startUpdate(){}prepareFlexArraysUpdate(t){this._currentFlexArrays=t.inputFlexArrays}setLastFlexArrays(t){this._lastFlexArrays=t}updateFlexArrays(t){const{attributes:e,selector:s,context:n,outputFlexArrays:i,toUpdate:r,formattedOutput:o}=t;this._elementsUpdated.addSet(r),this._elementsToRedraw.addSet(r);const a=r.getListAndClear();if(e&&a.size){const{valid:l,invalid:u}=kT(this._graph,a,s,n);for(const h of o.attributes){const g=Ys(i,h);for(let f=0;f<u._indexes.length;f++){const p=u._indexes[f];g.set(p,void 0)}}this._assignAttributesToFlexArrays(this._accessors,i,l,e,n),this._addUpdatedAttributes(t)}}endUpdate(){const t=this._elementsUpdated.getList(),e=Ld(this._updatedAttributesTmp);for(const s of e){const n=Ys(this._lastFlexArrays,s),i=Ys(this._finalFlexArrays,s);for(let r=0;r<t._indexes.length;r++){const o=t._indexes[r];i.set(o,n.get(o))}}this._updatedAttributesTmp.clear(),this._currentFlexArrays=this._finalFlexArrays}setAttributeValues(t,e,s,n,i){const r=t.outputFlexArrays,o=this._accessors;this._assignAttributesToFlexArrays(o,r,e,s,null),this._addUpdatedAttributes(t,n),this._elementsUpdated.add(e),this._elementsToRedraw.add(e)}notifyLayerDestroyed(t){this._addUpdatedAttributes(t)}_addUpdatedAttributes(t,e){const{outputFlexArrays:s,formattedOutput:n}=t,i=Array.isArray(e)?I0(e):n.attributes;for(const r of i)Ys(s,r).isInitialized()&&(this._updatedAttributes.add(r),this._updatedAttributesTmp.add(r),this._allUsedAttributes.add(r))}addUpdatedAttribute(t){this._updatedAttributes.add(t),this._updatedAttributesTmp.add(t),this._allUsedAttributes.add(t)}getUsedAttributeNames(t){return PN(t.outputFlexArrays)}redrawElements(t){this._elementsToRedraw.add(t)}redrawAll(){this._elementsToRedraw.addAll()}getAndResetElementsToRedraw(){return this._elementsToRedraw.getListAndClear()}getAndResetElementsUpdated(){return this._elementsUpdated.getListAndClear()}getAndResetAttributesUpdated(){const t=Ld(this._updatedAttributes);return this._updatedAttributes.clear(),t}getUpdatedAttributes(){return this._updatedAttributes}getUpdatedElementsList(){return this._elementsUpdated.getList()}getUpdatedAttributesSet(){return new Set(this._updatedAttributes)}createFlexArrays(){return this._createFlexArrays(this._graph,{original:!1,useDefaultValues:!1})}getAttributeValues(t,e,s,n){const i=n?this._prevFlexArrays:this._currentFlexArrays;return s?this._getMultipleAttributeValues(t,e,i):this._getSingleAttributeValues(t,e,i)}_getAccessor(t=""){let e=this._accessors;const s=Ua(t);for(const n of s)if(e=e.nested[n],!e)throw new Error(`${this._eltName} attribute "${s.join("")}" does not exist`);return e}_getSingleAttributeValues(t,e,s){const n=this._getAccessor(e),i=t._indexes,r=Array(i.length);for(let o=0;o<i.length;o++)r[o]=n.get(s,i[o]);return r}_getMultipleAttributeValues(t,e,s){if(!e||e==="all")return this._getSingleAttributeValues(t,"",s);const n=Array(t.size);for(let i=0;i<n.length;++i)n[i]={};for(let i=0;i<e.length;i++){const r=e[i],o=this._getSingleAttributeValues(t,r,s);for(let a=0;a<n.length;++a)no(n[a],r,o[a])}return n}setAnimationAttributes(t,{duration:e,startTime:s,easing:n}){const i=t._indexes,r=this._finalFlexArraysWrapped,o=r.animationDuration,a=r.animationStart,l=r.animationEasing,u=Ld(this._allUsedAttributes);if(e){let h=!1;for(const g of u){if(g==="x"||g==="y"){h=!0;continue}const f=Ys(this._finalFlexArrays,g),p=Ys(this._prevFlexArrays,g);for(let y=0;y<i.length;y++){const _=i[y];p.set(_,f.get(_))}}if(h){const g=Hn(),f=this._finalFlexArrays.x,p=this._finalFlexArrays.y,y=this._prevFlexArrays.x,_=this._prevFlexArrays.y;for(let x=0;x<i.length;x++){const v=i[x],b=o.get(v);if(b){const S=a.get(v),A=l.get(v),w=(M0[A]||Af)(Math.min((g-S)/b,1)),L=gy(y.get(v),f.get(v),w),M=gy(_.get(v),p.get(v),w);y.set(v,L),_.set(v,M)}else y.set(v,f.get(v)),_.set(v,p.get(v))}}}o.fill(i,e),a.fill(i,s),l.fill(i,n)}resetAnimationAttributes(t){this._finalFlexArraysWrapped.animationDuration.fill(t._indexes,0)}getUsedAttributes(){return Ld(this._allUsedAttributes)}getDefaultFlexArrays(){return this._defaultFlexArrays}_assignAttributesToFlexArrays(t,e,s,n,i,r=[]){if(typeof n=="function"){const o=r.join(".");for(let a=0;a<s.size;++a){const l=s.get(a);if(l){const u=n(l,i,o);this._assignSingleValueToFlexArray(e,l,t,u,r)}}}else if(gn(n)){const o=Object.keys(n);for(let a=0;a<o.length;++a){const l=o[a];r.push(l);const u=this._getNestedAccessor(t,l,r),h=n[l];this._assignAttributesToFlexArrays(u,e,s,h,i,r),r.pop()}}else if((Array.isArray(n)||ArrayBuffer.isView(n))&&r[0]!=="color")if(r.length===0)for(let o=0;o<s.size;++o)this._assignSingleValueToFlexArray(e,s.get(o),t,n[o],r);else for(let o=0;o<s.size;++o){const a=s._indexes[o],l=t.check(n[o]);t.set(e,a,l)}else{const o=t.check(n);for(let a=0;a<s.size;++a){const l=s.get(a);t.set(e,l._index,o)}}}_getNestedAccessor(t,e,s){const n=t.nested[e];if(!n)throw new Error(`${this._eltName} attribute "${s.join(".")}" does not exist`);return n}_assignSingleValueToFlexArray(t,e,s,n,i){if(gn(n)){const r=Object.keys(n);for(const o of r){i.push(o);const a=n[o],l=this._getNestedAccessor(s,o,i);this._assignSingleValueToFlexArray(t,e,l,a,i),i.pop()}}else{const r=s.check(n);s.set(t,e._index,r)}}};function f4(t,{original:e,useDefaultValues:s}){const n="resource";return{width:t.createAttribute(!1,{storage:n,default:s?qy:void 0,name:"width"},e),scalingMethod:t.createAttribute(!1,{storage:n,default:s?JL:void 0,name:"scalingMethod"},e),color:t.createAttribute(!1,{storage:n,default:s?tN:void 0,name:"color"},e),opacity:t.createAttribute(!1,{storage:n,default:s?eN:void 0,name:"opacity"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?sN:void 0,name:"minVisibleSize"},e),layer:t.createAttribute(!1,{storage:n,default:s?nN:void 0,name:"layer"},e),detectable:t.createAttribute(!1,{storage:n,default:s?iN:void 0,name:"detectable"},e),curvature:t.createAttribute(!1,{storage:n,default:s?rN:void 0,name:"curvature"},e),adjustAnchors:t.createAttribute(!1,{storage:n,default:s?oN:void 0,name:"adjustAnchors"},e),shape:{body:t.createAttribute(!1,{storage:n,default:s?aN:void 0,name:"shape.body"},e),head:t.createAttribute(!1,{storage:n,default:s?lN:void 0,name:"shape.head"},e),tail:t.createAttribute(!1,{storage:n,default:s?uN:void 0,name:"shape.tail"},e),style:t.createAttribute(!1,{storage:n,default:s?dN:void 0,name:"shape.style"},e)},stroke:{color:t.createAttribute(!1,{storage:n,default:s?hN:void 0,name:"stroke.color"},e),width:t.createAttribute(!1,{storage:n,default:s?Yy:void 0,name:"stroke.width"},e),scalingMethod:t.createAttribute(!1,{storage:n,default:s?cN:void 0,name:"stroke.scalingMethod"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?gN:void 0,name:"stroke.minVisibleSize"},e)},halo:{color:t.createAttribute(!1,{storage:n,default:s?fN:void 0,name:"halo.color"},e),width:t.createAttribute(!1,{storage:n,default:s?Wy:void 0,name:"halo.width"},e),scalingMethod:t.createAttribute(!1,{storage:n,default:s?pN:void 0,name:"halo.scalingMethod"},e)},pulse:{enabled:t.createAttribute(!1,{storage:n,default:!s&&void 0,name:"pulse.enabled"},e),duration:t.createAttribute(!1,{storage:n,default:s?mN:void 0,name:"pulse.duration"},e),interval:t.createAttribute(!1,{storage:n,default:s?_N:void 0,name:"pulse.interval"},e),startColor:t.createAttribute(!1,{storage:n,default:s?yN:void 0,name:"pulse.startColor"},e),endColor:t.createAttribute(!1,{storage:n,default:s?xN:void 0,name:"pulse.endColor"},e),width:t.createAttribute(!1,{storage:n,default:s?vN:void 0,name:"pulse.width"},e),startRatio:t.createAttribute(!1,{storage:n,default:s?bN:void 0,name:"pulse.startRatio"},e),endRatio:t.createAttribute(!1,{storage:n,default:s?EN:void 0,name:"pulse.endRatio"},e)},outline:{enabled:t.createAttribute(!1,{storage:n,default:!s&&void 0,name:"outline.enabled"},e),color:t.createAttribute(!1,{storage:n,default:s?SN:void 0,name:"outline.color"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?AN:void 0,name:"outline.minVisibleSize"},e)},text:{content:t.createAttribute(!1,{storage:n,default:s?null:void 0,name:"text.content"},e),font:t.createAttribute(!1,{storage:n,default:s?ni:void 0,name:"text.font"},e),color:t.createAttribute(!1,{storage:n,default:s?Ko:void 0,name:"text.color"},e),size:t.createAttribute(!1,{storage:n,default:s?pu:void 0,name:"text.size"},e),scale:t.createAttribute(!1,{storage:n,default:s?O3:void 0,name:"text.scale"},e),style:t.createAttribute(!1,{storage:n,default:s?wN:void 0,name:"text.style"},e),align:t.createAttribute(!1,{storage:n,default:s?TN:void 0,name:"text.align"},e),margin:t.createAttribute(!1,{storage:n,default:s?CN:void 0,name:"text.margin"},e),padding:t.createAttribute(!1,{storage:n,default:s?Xy:void 0,name:"text.padding"},e),position:t.createAttribute(!1,{storage:n,default:s?LN:void 0,name:"text.position"},e),backgroundColor:t.createAttribute(!1,{storage:n,default:s?Sf:void 0,name:"text.backgroundColor"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?NN:void 0,name:"text.minVisibleSize"},e),adjustAngle:t.createAttribute(!1,{storage:n,default:s?MN:void 0,name:"text.adjustAngle"},e),scaling:t.createAttribute(!1,{storage:n,default:s?xL:void 0,name:"text.scaling"},e),maxLineLength:t.createAttribute(!1,{storage:n,default:s?vL:void 0,name:"text.maxLineLength"},e),secondary:{content:t.createAttribute(!1,{storage:n,default:s?null:void 0,name:"text.secondary.content"},e),font:t.createAttribute(!1,{storage:n,default:s?ni:void 0,name:"text.secondary.font"},e),color:t.createAttribute(!1,{storage:n,default:s?Ko:void 0,name:"text.secondary.color"},e),size:t.createAttribute(!1,{storage:n,default:s?Ky:void 0,name:"text.secondary.size"},e),scale:t.createAttribute(!1,{storage:n,default:s?pL:void 0,name:"text.secondary.scale"},e),style:t.createAttribute(!1,{storage:n,default:s?_L:void 0,name:"text.secondary.style"},e),align:t.createAttribute(!1,{storage:n,default:s?yL:void 0,name:"text.secondary.align"},e),margin:t.createAttribute(!1,{storage:n,default:s?IN:void 0,name:"text.secondary.margin"},e),padding:t.createAttribute(!1,{storage:n,default:s?Zy:void 0,name:"text.secondary.padding"},e),backgroundColor:t.createAttribute(!1,{storage:n,default:s?mL:void 0,name:"text.secondary.backgroundColor"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?kN:void 0,name:"text.secondary.minVisibleSize"},e)}}}}function p4(t,{original:e,useDefaultValues:s}){const n="resource";return{x:t.createAttribute(!0,{storage:"any",default:s?0:void 0,name:"x"},e),y:t.createAttribute(!0,{storage:"any",default:s?0:void 0,name:"y"},e),radius:t.createAttribute(!0,{storage:n,default:s?5:void 0,name:"radius"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"scalingMethod"},e),color:t.createAttribute(!0,{storage:n,default:s?AL:void 0,name:"color"},e),opacity:t.createAttribute(!0,{storage:n,default:s?u3:void 0,name:"opacity"},e),shape:t.createAttribute(!0,{storage:n,default:s?d3:void 0,name:"shape"},e),layer:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"layer"},e),detectable:t.createAttribute(!0,{storage:n,default:!!s||void 0,name:"detectable"},e),draggable:t.createAttribute(!0,{storage:n,default:!!s||void 0,name:"draggable"},e),layoutable:t.createAttribute(!0,{storage:n,default:!!s||void 0,name:"layoutable"},e),innerStroke:{width:t.createAttribute(!0,{storage:n,default:s?w0:void 0,name:"innerStroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"innerStroke.scalingMethod"},e),color:t.createAttribute(!0,{storage:n,default:s?wL:void 0,name:"innerStroke.color"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?Vy:void 0,name:"innerStroke.minVisibleSize"},e)},outerStroke:{width:t.createAttribute(!0,{storage:n,default:s?T0:void 0,name:"outerStroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"outerStroke.scalingMethod"},e),color:t.createAttribute(!0,{storage:n,default:s?TL:void 0,name:"outerStroke.color"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?Gy:void 0,name:"outerStroke.minVisibleSize"},e)},badges:{topLeft:{color:t.createAttribute(!0,{storage:n,default:s?wd:void 0,name:"badges.topLeft.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.45:void 0,name:"badges.topLeft.scale"},e),positionScale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.topLeft.positionScale"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?tu:void 0,name:"badges.topLeft.minVisibleSize"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"badges.topLeft.scalingMethod"},e),image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.topLeft.image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.topLeft.image.scale"},e)},stroke:{color:t.createAttribute(!0,{storage:n,default:s?Td:void 0,name:"badges.topLeft.stroke.color"},e),width:t.createAttribute(!0,{storage:n,default:s?eu:void 0,name:"badges.topLeft.stroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"badges.topLeft.stroke.scalingMethod"},e)},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.topLeft.text.content"},e),color:t.createAttribute(!0,{storage:n,default:s?Cd:void 0,name:"badges.topLeft.text.color"},e),font:t.createAttribute(!0,{storage:n,default:s?ni:void 0,name:"badges.topLeft.text.font"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"badges.topLeft.text.style"},e),scale:t.createAttribute(!0,{storage:n,default:s?.5:void 0,name:"badges.topLeft.text.scale"},e),paddingLeft:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.topLeft.text.paddging.left"},e),paddingTop:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.topLeft.text.paddging.top"},e)}},topRight:{color:t.createAttribute(!0,{storage:n,default:s?wd:void 0,name:"badges.topRight.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.45:void 0,name:"badges.topRight.scale"},e),positionScale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.topRight.positionScale"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?tu:void 0,name:"badges.topRight.minVisibleSize"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"badges.topRight.scalingMethod"},e),image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.topRight.image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.topRight.image.scale"},e)},stroke:{color:t.createAttribute(!0,{storage:n,default:s?Td:void 0,name:"badges.topRight.stroke.color"},e),width:t.createAttribute(!0,{storage:n,default:s?eu:void 0,name:"badges.topRight.stroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"badges.topRight.stroke.scalingMethod"},e)},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.topRight.text.content"},e),color:t.createAttribute(!0,{storage:n,default:s?Cd:void 0,name:"badges.topRight.text.color"},e),font:t.createAttribute(!0,{storage:n,default:s?ni:void 0,name:"badges.topRight.text.font"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"badges.topRight.text.style"},e),scale:t.createAttribute(!0,{storage:n,default:s?.5:void 0,name:"badges.topRight.text.scale"},e),paddingTop:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.topRight.text.paddging.left"},e),paddingLeft:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.topRight.text.paddging.top"},e)}},bottomLeft:{color:t.createAttribute(!0,{storage:n,default:s?wd:void 0,name:"badges.bottomLeft.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.45:void 0,name:"badges.bottomLeft.scale"},e),positionScale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.bottomLeft.positionScale"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?tu:void 0,name:"badges.bottomLeft.minVisibleSize"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"badges.bottomLeft.scalingMethod"},e),image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.bottomLeft.image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.bottomLeft.image.scale"},e)},stroke:{color:t.createAttribute(!0,{storage:n,default:s?Td:void 0,name:"badges.bottomLeft.stroke.color"},e),width:t.createAttribute(!0,{storage:n,default:s?eu:void 0,name:"badges.bottomLeft.stroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:e?"badges.bottomLeft.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.bottomLeft.text.content"},e),color:t.createAttribute(!0,{storage:n,default:s?Cd:void 0,name:"badges.bottomLeft.text.color"},e),font:t.createAttribute(!0,{storage:n,default:s?ni:void 0,name:"badges.bottomLeft.text.font"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"badges.bottomLeft.text.style"},e),scale:t.createAttribute(!0,{storage:n,default:s?.5:void 0,name:"badges.bottomLeft.text.scale"},e),paddingLeft:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.bottomLeft.text.paddging.left"},e),paddingTop:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.bottomLeft.text.paddging.top"},e)}},bottomRight:{color:t.createAttribute(!0,{storage:n,default:s?wd:void 0,name:"badges.bottomRight.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.45:void 0,name:"badges.bottomRight.scale"},e),positionScale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.bottomRight.positionScale"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?tu:void 0,name:"badges.bottomRight.minVisibleSize"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"badges.bottomRight.scalingMethod"},e),image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.bottomRight.image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.bottomRight.image.scale"},e)},stroke:{color:t.createAttribute(!0,{storage:n,default:s?Td:void 0,name:"badges.bottomRight.stroke.color"},e),width:t.createAttribute(!0,{storage:n,default:s?eu:void 0,name:"badges.bottomRight.stroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:e?"badges.bottomRight.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.bottomRight.text.content"},e),color:t.createAttribute(!0,{storage:n,default:s?Cd:void 0,name:"badges.bottomRight.text.color"},e),font:t.createAttribute(!0,{storage:n,default:s?ni:void 0,name:"badges.bottomRight.text.font"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"badges.bottomRight.text.style"},e),scale:t.createAttribute(!0,{storage:n,default:s?.5:void 0,name:"badges.bottomRight.text.scale"},e),paddingLeft:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.bottomRight.text.paddging.left"},e),paddingTop:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.bottomRight.text.paddging.top"},e)}}},halo:{color:t.createAttribute(!0,{storage:n,default:s?LL:void 0,name:"halo.color"},e),width:t.createAttribute(!0,{storage:n,default:s?C0:void 0,name:"halo.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"halo.scalingMethod"},e),strokeColor:t.createAttribute(!0,{storage:n,default:s?NL:void 0,name:"halo.strokeColor"},e),strokeWidth:t.createAttribute(!0,{storage:n,default:s?L0:void 0,name:"halo.strokeWidth"},e),clustering:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"halo.clustering"},e),hideNonAdjacentEdges:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"halo.hideNonAdjacentEdges"},e)},pulse:{enabled:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"pulse.enabled"},e),duration:t.createAttribute(!0,{storage:n,default:s?kL:void 0,name:"pulse.duration"},e),interval:t.createAttribute(!0,{storage:n,default:s?IL:void 0,name:"pulse.interval"},e),startColor:t.createAttribute(!0,{storage:n,default:s?zL:void 0,name:"pulse.startColor"},e),endColor:t.createAttribute(!0,{storage:n,default:s?PL:void 0,name:"pulse.endColor"},e),width:t.createAttribute(!0,{storage:n,default:s?DL:void 0,name:"pulse.width"},e),startRatio:t.createAttribute(!0,{storage:n,default:s?RL:void 0,name:"pulse.startRatio"},e),endRatio:t.createAttribute(!0,{storage:n,default:s?FL:void 0,name:"pulse.endRatio"},e)},icon:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"icon.content"},e),font:t.createAttribute(!0,{storage:n,default:s?ni:void 0,name:"icon.font"},e),color:t.createAttribute(!0,{storage:n,default:s?ML:void 0,name:"icon.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.7:void 0,name:"icon.scale"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"icon.style"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?12:void 0,name:"icon.minVisibleSize"},e)},image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"image.scale"},e),fit:t.createAttribute(!0,{storage:n,default:!!s||void 0,name:"image.fit"},e),tile:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"image.tile"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?12:void 0,name:"image.minVisibleSize"},e)},outline:{enabled:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"outline.enabled"},e),color:t.createAttribute(!0,{storage:n,default:s?CL:void 0,name:"outline.color"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?12:void 0,name:"outline.minVisibleSize"},e)},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"text.content"},e),font:t.createAttribute(!0,{storage:n,default:s?ni:void 0,name:"text.font"},e),color:t.createAttribute(!0,{storage:n,default:s?Ko:void 0,name:"text.color"},e),size:t.createAttribute(!0,{storage:n,default:s?pu:void 0,name:"text.size"},e),scale:t.createAttribute(!0,{storage:n,default:s?.1:void 0,name:"text.scale"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"text.style"},e),align:t.createAttribute(!0,{storage:n,default:s?"center":void 0,name:"text.align"},e),margin:t.createAttribute(!0,{storage:n,default:s?E0:void 0,name:"text.margin"},e),padding:t.createAttribute(!0,{storage:n,default:s?ah:void 0,name:"text.padding"},e),backgroundColor:t.createAttribute(!0,{storage:n,default:s?Sf:void 0,name:"text.backgroundColor"},e),tip:t.createAttribute(!0,{storage:n,default:s?o3:void 0,name:"text.tip"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?24:void 0,name:"text.minVisibleSize"},e),scaling:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"text.scaling"},e),position:t.createAttribute(!0,{storage:n,default:s?"bottom":void 0,name:"text.position"},e),maxLineLength:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"text.maxLineLength"},e),truncateLength:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"text.truncateLength"},e),secondary:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"text.secondary.content"},e),font:t.createAttribute(!0,{storage:n,default:s?ni:void 0,name:"text.secondary.font"},e),color:t.createAttribute(!0,{storage:n,default:s?Ko:void 0,name:"text.secondary.color"},e),size:t.createAttribute(!0,{storage:n,default:s?S0:void 0,name:"text.secondary.size"},e),scale:t.createAttribute(!0,{storage:n,default:s?.08:void 0,name:"text.secondary.scale"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"text.secondary.style"},e),align:t.createAttribute(!0,{storage:n,default:s?"center":void 0,name:"text.secondary.align"},e),margin:t.createAttribute(!0,{storage:n,default:s?a3:void 0,name:"text.secondary.margin"},e),padding:t.createAttribute(!0,{storage:n,default:s?ah:void 0,name:"text.secondary.padding"},e),backgroundColor:t.createAttribute(!0,{storage:n,default:s?Sf:void 0,name:"text.secondary.backgroundColor"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?24:void 0,name:"text.secondary.minVisibleSize"},e)}}}}var m4=class{constructor(t){this.nodes=new xA(t,!0,p4),this.edges=new xA(t,!1,f4)}setNodeDefaultAttributes(t){this.nodes.setDefaultAttributes(t)}setEdgeDefaultAttributes(t){this.edges.setDefaultAttributes(t)}getFlexArrays(){return{nodes:{current:this.nodes.getAttributeFlexArrays(),previous:this.nodes.getPrevAttributeFlexArrays()},edges:{current:this.edges.getAttributeFlexArrays(),previous:this.edges.getPrevAttributeFlexArrays()}}}redrawAll(){this.nodes.redrawAll(),this.edges.redrawAll()}clear(){this.nodes.clear(),this.edges.clear()}redrawElements(t){this._fetch(t).redrawElements(t)}getAnimationInformation(t){return this._fetch(t).getAnimationInformation(t)}redrawNodes(t){this.nodes.redrawElements(t)}getUsedAttributes(t,e){return this._fetch(e).getUsedAttributeNames(e.isNode?t.nodes:t.edges)}startUpdate(){this.nodes.startUpdate(),this.edges.startUpdate()}notifyDestroyed(t){this.nodes.notifyLayerDestroyed(t.nodes),this.edges.notifyLayerDestroyed(t.edges)}prepareUpdate(t){this.nodes.prepareFlexArraysUpdate(t.nodes),this.edges.prepareFlexArraysUpdate(t.edges)}onUpdate(t){this.nodes.updateFlexArrays(t.nodes),this.edges.updateFlexArrays(t.edges)}afterLayersUpdate(){this.nodes.endUpdate(),this.edges.endUpdate()}getAndResetElementsToRedraw(){return{nodes:this.nodes.getAndResetElementsToRedraw(),edges:this.edges.getAndResetElementsToRedraw()}}getAndResetElementsUpdated(){const t=this.nodes,e=this.edges;return{nodes:t.getAndResetElementsUpdated(),edges:e.getAndResetElementsUpdated(),nodeAttributesSet:t.getUpdatedAttributesSet(),nodeAttributes:t.getAndResetAttributesUpdated(),edgeAttributes:e.getAndResetAttributesUpdated()}}setAnimationAttributes({nodes:t,edges:e},s){this.nodes.setAnimationAttributes(t,s),this.edges.setAnimationAttributes(e,s)}resetAnimationAttributes({nodes:t,edges:e}){this.nodes.resetAnimationAttributes(t),this.edges.resetAnimationAttributes(e)}setLastOutput(t,e){this.nodes.setLastFlexArrays(t),this.edges.setLastFlexArrays(e)}getCurrentInput(){const t=Zs(this.nodes.getDefaultFlexArrays()),e=Zs(this.edges.getDefaultFlexArrays());return{currentNodeFlexArrays:t,currentEdgeFlexArrays:e,allNodeAttributePaths:Va(t),allEdgeAttributePaths:Va(e)}}initializeLayer(t,e,s){t.nodes.allAttributePaths=e,t.edges.allAttributePaths=s,t.nodes.formattedDependencies=u4(t.nodes),t.edges.formattedDependencies=d4(t.edges),t.nodes.formattedOutput={attributes:_A(t.nodes),tags:t.tag?[t.tag]:[]},t.edges.formattedOutput={attributes:_A(t.edges),tags:t.tag?[t.tag]:[]},t.nodes.redrawAdjacentEdges=t.nodes.formattedOutput.attributes.some((n=>D3[n])),t.initialized=!0}connectLayerInputOutput(t,e,s){const n=t.nodes.formattedOutput,i=t.edges.formattedOutput;for(const r of n.attributes){const o=Ys(e,r),a=Ys(t.nodes.outputFlexArrays,r);a.setFallback(o),no(e,r,a)}for(const r of i.attributes){const o=Ys(s,r),a=Ys(t.edges.outputFlexArrays,r);a.setFallback(o),no(s,r,a)}}setupLayerDependencies(t,e){if(t===e)return;const s=t.priority,n=e.priority,i=t.nodes.formattedOutput,r=t.edges.formattedOutput,o=e.nodes.formattedDependencies,a=e.edges.formattedDependencies;Ar(t.depsNodeSelf,e,i,o.self,s,n),Ar(t.depsNodeAdjacentNodes,e,i,o.adjacentNodes,s,n),Ar(t.depsNodeAdjacentEdges,e,r,a.extremities,s,n),Ar(t.depsNodeAllNodes,e,i,o.allNodes,s,n),Ar(t.depsNodeAllEdges,e,r,a.allNodes,s,n),Ar(t.depsEdgeSelf,e,r,a.self,s,n),Ar(t.depsEdgeExtremities,e,i,o.adjacentEdges,s,n),Ar(t.depsEdgeParallelEdges,e,r,a.parallelEdges,s,n),Ar(t.depsEdgeAllNodes,e,i,o.allEdges,s,n),Ar(t.depsEdgeAllEdges,e,r,a.allEdges,s,n)}createAttributeLayerData(t,e,s,{tag:n,onBeforeUpdate:i,standaloneSelectors:r}){const o=!!r;return{index:-1,id:e,name:t,tag:n||null,priority:0,depsNodeSelf:[],depsNodeAdjacentNodes:[],depsNodeAdjacentEdges:[],depsNodeAllNodes:[],depsNodeAllEdges:[],depsEdgeSelf:[],depsEdgeExtremities:[],depsEdgeParallelEdges:[],depsEdgeAllNodes:[],depsEdgeAllEdges:[],initialized:!1,onBeforeUpdate:i,nodes:{type:"node",name:t,standaloneSelector:o,toUpdate:new Tf({graph:s,isNode:!0,includeRemovedElements:!1}),outputFlexArrays:this.nodes.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null},edges:{type:"edge",name:t,standaloneSelector:o,toUpdate:new Tf({graph:s,isNode:!1,includeRemovedElements:!1}),outputFlexArrays:this.edges.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null}}}setAttributeValues(t,e,s,n,i){this._fetch(e).setAttributeValues(t,e,s,n,i)}getAttributeValues(t,e,s,n){return this._fetch(t).getAttributeValues(t,e,s,n)}_fetch(t){return t.isNode?this.nodes:this.edges}},_4=(t,e)=>new w3(t,e),y4=class{constructor(t,{graph:e,dom:s}){this._layerIdCounter=0,this._layers=[],this._destroyedLayers=[],this._layersNeedUpdate=!1,this._updateOngoing=!1,this._needUpdate=!1,this._ogma=t,this._graph=e,this._dom=s,this._emptySubgraph={nodes:t.nodeList(),edges:t.edgeList()},this._textHiddenSet=new Ih(this._graph,"textHidden"),this._layerController=new m4(this._graph)}_getLayerById(t){for(let e=0;e<this._layers.length;++e){const s=this._layers[e];if(s.id===t)return s.index=e,s}throw new Error("usage of a destroyed style rule or class")}setDefaultAttributes(t,e){this._layerController.setNodeDefaultAttributes(t),this._layerController.setEdgeDefaultAttributes(e)}getFlexArrays(){return this._layerController.getFlexArrays()}clear(){this._updateOngoing=!1,this._needUpdate=!1,this._destroyedLayers=[],this._layerController.clear(),this.updateAllForAllAttributeLayers()}redrawElements(t){t.size&&(this._layerController.redrawElements(t),this._dom.refresh())}redrawAll(){this._layerController.redrawAll(),this._dom.refresh()}_triggerUpdate(){this._needUpdate=!0,this._dom.refresh()}_reconstructAttributeLayersIfNecessary(){return!!this._layersNeedUpdate&&(this._reconstructAttributeLayers(),this._layersNeedUpdate=!1,this._dom.refresh(),!0)}getAnimationInformation(t){return this._layerController.getAnimationInformation(t)}update(){if(!this._needUpdate||this._updateOngoing||!this._ogma._token)return!1;this._reconstructAttributeLayersIfNecessary(),this._updateOngoing=!0,this._layerController.startUpdate();for(const t of this._destroyedLayers)t.initialized&&this._layerController.notifyDestroyed(t);for(const t of this._layers)this._layerController.prepareUpdate(t),typeof t.onBeforeUpdate=="function"&&t.onBeforeUpdate(t,this,this._layerController),this._layerController.onUpdate(t);return this._layerController.afterLayersUpdate(),this._updateOngoing=!1,this._needUpdate=!1,!0}setAttributeLayerValues(t,e,s,n){const i=this._getLayerById(t),r=e.isNode?i.nodes:i.edges;this._reconstructAttributeLayersIfNecessary(),this._layerController.setAttributeValues(r,e,s,n,i),this._updateElementsForAttributeLayers([i],e)}getAttributeLayerFlexArrays(t){const e=this._getLayerById(t);return{nodes:e.nodes.outputFlexArrays,edges:e.edges.outputFlexArrays}}getUsedAttributeLayerAttributes(t,e){const s=this._getLayerById(t);return this._layerController.getUsedAttributes(s,e)}getUpdatedElements(){return{elementsToRedraw:this._layerController.getAndResetElementsToRedraw(),elementsUpdated:this._layerController.getAndResetElementsUpdated()}}addAttributeLayer(t){const{name:e,layerFactory:s=_4}=t;if(!e)throw new Error("Attribute layer must have a name");if(e&&this._layers.find((i=>i.name===e)))throw new Error(`attribute layer with name "${t.name}" already exists`);const n=this._layerController.createAttributeLayerData(e,++this._layerIdCounter,this._graph,t);return this._layers.push(n),this._updateLayer(n,t),s(this,this._layerIdCounter)}_reconstructAttributeLayers(){this._layers.sort(((i,r)=>i.priority-r.priority));const{currentNodeFlexArrays:t,currentEdgeFlexArrays:e,allNodeAttributePaths:s,allEdgeAttributePaths:n}=this._layerController.getCurrentInput();for(const i of this._layers)this._layerController.initializeLayer(i,s,n);for(const i of this._layers){i.nodes.inputFlexArrays=Zs(t),i.edges.inputFlexArrays=Zs(e),i.depsNodeSelf=[],i.depsNodeAdjacentNodes=[],i.depsNodeAdjacentEdges=[],i.depsNodeAllNodes=[],i.depsNodeAllEdges=[],i.depsEdgeSelf=[],i.depsEdgeExtremities=[],i.depsEdgeParallelEdges=[],i.depsEdgeAllNodes=[],i.depsEdgeAllEdges=[],i.nodes.toUpdate.addAll(),i.edges.toUpdate.addAll(),this._layerController.connectLayerInputOutput(i,t,e);for(const r of this._layers)this._layerController.setupLayerDependencies(i,r)}this._layerController.setLastOutput(t,e);for(const i of this._layers)i.nodes.needAdjacentElements=i.nodes.redrawAdjacentEdges||i.depsNodeAdjacentNodes.length>0||i.depsNodeAdjacentEdges.length>0,i.edges.needAdjacentElements=i.depsEdgeExtremities.length>0||i.depsEdgeParallelEdges.length>0}_updateLayer(t,{priority:e,fullOverwrite:s,nodeAttributes:n,nodeSelector:i,nodeContext:r,nodeDependencies:o,nodeOutput:a,edgeAttributes:l,edgeSelector:u,edgeContext:h,edgeDependencies:g,edgeOutput:f}={}){n!==void 0&&(t.nodes.attributes=s?n:Jg(t.nodes.attributes,n)),i!==void 0&&(t.nodes.selector=i),r!==void 0&&(t.nodes.context=r),o!==void 0&&(t.nodes.dependencies=o),a!==void 0&&(t.nodes.output=a),l!==void 0&&(t.edges.attributes=s?l:Jg(t.edges.attributes,l)),u!==void 0&&(t.edges.selector=u),h!==void 0&&(t.edges.context=h),g!==void 0&&(t.edges.dependencies=g),f!==void 0&&(t.edges.output=f),e!==void 0&&(t.priority=e),this._triggerLayerUpdate()}_triggerLayerUpdate(){this._layersNeedUpdate=!0,this._triggerUpdate()}updateAllForAttributeLayer(t){const e=this._getLayerById(t);this._updateAllForAttributeLayer(e)}updateAllForAllAttributeLayers(){for(const t of this._layers)this._updateAllForAttributeLayer(t)}_updateAllForAttributeLayer(t,e=!0,s=!0){if(e&&!t.nodes.toUpdate.isFull()){t.nodes.toUpdate.addAll();for(const n of t.depsNodeSelf)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsNodeAdjacentNodes)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsNodeAdjacentEdges)this._updateAllForAttributeLayer(n,!1,!0);for(const n of t.depsNodeAllNodes)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsNodeAllEdges)this._updateAllForAttributeLayer(n,!1,!0)}if(s&&!t.edges.toUpdate.isFull()){t.edges.toUpdate.addAll();for(const n of t.depsEdgeSelf)this._updateAllForAttributeLayer(n,!1,!0);for(const n of t.depsEdgeExtremities)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsEdgeParallelEdges)this._updateAllForAttributeLayer(n,!1,!0);for(const n of t.depsEdgeAllNodes)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsEdgeAllEdges)this._updateAllForAttributeLayer(n,!1,!0)}this._triggerUpdate()}updateElementsForAttributeLayer(t,e){const s=this._getLayerById(t);this._updateElementsForAttributeLayers([s],e)}updateForAllAttributeLayers(t){this._updateElementsForAttributeLayers(this._layers,t)}_updateElementsForAttributeLayers(t,e){let s=this._emptySubgraph;if(e.isNode){for(const n of t)if(!n.nodes.toUpdate.isFull()){n.nodes.needAdjacentElements&&(s=s===this._emptySubgraph?e.fastGetAdjacentElements():s),n.nodes.toUpdate.add(e);for(const i of n.depsNodeSelf)i.nodes.toUpdate.add(e);for(const i of n.depsNodeAdjacentNodes)i.nodes.toUpdate.add(s.nodes);for(const i of n.depsNodeAdjacentEdges)i.edges.toUpdate.add(s.edges);for(const i of n.depsNodeAllNodes)this._updateAllForAttributeLayer(i,!0,!1);for(const i of n.depsNodeAllEdges)this._updateAllForAttributeLayer(i,!1,!0);n.nodes.redrawAdjacentEdges&&this._layerController.redrawElements(s.edges)}}else for(const n of t)if(!n.edges.toUpdate.isFull()){n.edges.needAdjacentElements&&(s=s===this._emptySubgraph?e.fastGetAdjacentElements():s),n.edges.toUpdate.add(e);for(const i of n.depsEdgeSelf)i.edges.toUpdate.add(e);for(const i of n.depsEdgeExtremities)i.nodes.toUpdate.add(s.nodes);for(const i of n.depsEdgeParallelEdges)i.edges.toUpdate.add(s.edges);for(const i of n.depsEdgeAllNodes)this._updateAllForAttributeLayer(i,!0,!1);for(const i of n.depsEdgeAllEdges)this._updateAllForAttributeLayer(i,!1,!0)}this._triggerUpdate()}destroyAttributeLayer(t){const e=this._getLayerById(t);this._destroyedLayers.push(e),this._layers.splice(e.index,1),this._triggerLayerUpdate()}updateAttributeLayer(t,e){const s=this._getLayerById(t);this._updateLayer(s,e)}getAttributeLayerDefinition(t){const e=this._getLayerById(t),{priority:s,nodes:n,edges:i}=e;return{priority:s,nodeAttributes:n.attributes,nodeSelector:n.selector,nodeContext:n.context,nodeDependencies:n.dependencies,nodeOutput:n.output,edgeAttributes:i.attributes,edgeSelector:i.selector,edgeContext:i.context,edgeDependencies:i.dependencies,edgeOutput:i.output}}getAttributeValues(t,e,s,n){return this.update(),this._layerController.getAttributeValues(t,e,s,n)}setAnimationAttributes(t,e){return this._layerController.setAnimationAttributes(t,e)}resetAnimationAttributes(t){return this._layerController.resetAnimationAttributes(t)}setTextHidden(t,e){const s=this._textHiddenSet.addOrRemoveElements(t,e);this.redrawElements(s)}resetTextHidden(){const{nodes:t,edges:e}=this._textHiddenSet.getElements();this._textHiddenSet.clear(),this._layerController.redrawElements(t),this._layerController.redrawElements(e)}getUsedNodeAttributes(){return this._layerController.nodes.getUsedAttributes()}getUsedEdgeAttributes(){return this._layerController.edges.getUsedAttributes()}interpolateAttributes(t){const e=Hn(),s=this._ogma.modules.graphics.getAttributesManager(),n=this._layerController,i=t.isNode?s.getUsedNodeAttributes():s.getUsedEdgeAttributes(),{animationDuration:r,animationEasing:o,animationStart:a}=n.getFlexArrays().nodes.current,l=r.getMultiple(t._indexes),u=o.getMultiple(t._indexes),h=a.getMultiple(t._indexes),g=[];for(let f=0;f<t.size;f++){const p={};i.forEach((y=>{const _=typeof y=="string"?y:y.join("."),x=Ys(n.getFlexArrays().nodes.previous,y),v=Ys(n.getFlexArrays().nodes.current,y);if(!v)return;const b=zC(e,h[f],l[f],u[f]);isNaN(b)?p[_]=v.get(t._indexes[f]):_.match(/color/gi)?p[_]=Sd(x.get(t._indexes[f]),v.get(t._indexes[f]),b,b):p[_]=bs(x.get(t._indexes[f]),v.get(t._indexes[f]),b)})),g.push(p)}return g}},x4=1e-12;function vA(t){return((t=Math.exp(t))+1/t)/2}function v4(t){return((t=Math.exp(t))-1/t)/2}function b4(t){return((t=Math.exp(2*t))-1)/(t+1)}var E4=(function t(e,s,n){function i(r,o){var a,l,u=r[0],h=r[1],g=r[2],f=o[0],p=o[1],y=o[2],_=f-u,x=p-h,v=_*_+x*x;if(v<x4)l=Math.log(y/g)/e,a=function(M){return[u+M*_,h+M*x,g*Math.exp(e*M*l)]};else{var b=Math.sqrt(v),S=(y*y-g*g+n*v)/(2*g*s*b),A=(y*y-g*g-n*v)/(2*y*s*b),w=Math.log(Math.sqrt(S*S+1)-S),L=Math.log(Math.sqrt(A*A+1)-A);l=(L-w)/e,a=function(M){var F=M*l,O=vA(w),G=g/(s*b)*(O*b4(e*F+w)-v4(w));return[u+G*_,h+G*x,g*O/vA(e*F+w)]}}return a.duration=1e3*l*e/Math.SQRT2,a}return i.rho=function(r){var o=Math.max(.001,+r),a=o*o;return t(o,a,a*a)},i})(Math.SQRT2,2,4),S4="cubicOut",A4=({graphWidth:t,graphHeight:e,viewWidth:s,viewHeight:n})=>.2*Math.min(s/t,n/e),w4=({smallestNodeSize:t,viewWidth:e,viewHeight:s})=>t===1/0?1/0:Math.min(e,s)/t*.5;function T4(t,e,s){return e===void 0?C4(t):e==="alt"?t.altKey:e==="shift"?t.shiftKey:e==="space"?s.isPressed("space"):void 0}function C4(t){return!t.altKey&&(pF?t.metaKey:t.ctrlKey)&&!t.shiftKey}var Qy=Math.SQRT2,bA=.15,L4=class extends Xe{constructor(t,e){super(t),this._zooming=!1,this.debug=!1,this._smoothZoom=Zd(((s,n,i)=>{const r=this._modules.settings,o=r.get("interactions.zoom.duration"),a=r.get("interactions.zoom.easing"),l=this._modules.camera.getZoom(),u={duration:o,easing:a};this._zooming||(this._zooming=!0,this._updateVisibility("zoom",!0));const h=r.get("interactions.zoom.speed")||bA;let g=nO(s,h);s<0&&g!==0&&(g=1/g);const f=l*g;this._modules.camera.setZoom(f,u,{x:n,y:i}).then((()=>{this._zooming&&(this._zooming=!1,this._updateVisibility("zoom",!1))}))}),ZT),this.debug=e}onMounted(){const t=this._modules.settings;t.register("interactions.zoom.enabled",!0),t.register("interactions.zoom.onDoubleClick",!1),t.register("interactions.zoom.duration",150),t.register("interactions.zoom.modifier",Qy),t.register("interactions.zoom.speed",bA),t.register("interactions.zoom.easing",S4),t.register("interactions.zoom.minValue",this.debug?null:A4),t.register("interactions.zoom.maxValue",this.debug?null:w4),t.register("interactions.zoom.hideNodes",!1),t.register("interactions.zoom.hideEdges",!1),t.register("interactions.zoom.hideNodeTexts",!1),t.register("interactions.zoom.hideEdgeTexts",!1),t.register("interactions.zoom.scrollToPan",!1),t.register("interactions.zoom.metaKey",void 0),t.register("interactions.pan.enabled",!0),t.register("interactions.pan.hideNodes",!1),t.register("interactions.pan.hideEdges",!1),t.register("interactions.pan.hideNodeTexts",!1),t.register("interactions.pan.hideEdgeTexts",!1),t.register("interactions.rotation.enabled",!0),t.register("interactions.rotation.hideNodes",!1),t.register("interactions.rotation.hideEdges",!1),t.register("interactions.rotation.hideNodeTexts",!1),t.register("interactions.rotation.hideEdgeTexts",!1),t.register("interactions.gesture.enabled",!0),t.register("interactions.gesture.hideNodes",!1),t.register("interactions.gesture.hideEdges",!1),t.register("interactions.gesture.hideNodeTexts",!1),t.register("interactions.gesture.hideEdgeTexts",!1),this._setupInteractions()}_setupInteractions(){this._modules.interactions.onMouseWheel({priority:"zoom",check:()=>!!this._modules.settings.get("interactions.zoom.enabled"),handler:({x:t,y:e,delta:s,dx:n,dy:i,domEvent:r})=>{const o=n%1!=0||i%1!=0,a=this._modules.settings;!a.get("interactions.zoom.scrollToPan")||T4(r,a.get("interactions.zoom.metaKey"),this._modules.keyboard)||o?this._smoothZoom(s,t,e):this._modules.camera.move({x:n,y:i})}}),this._modules.interactions.onDoubleClick({priority:"zoom",check:()=>{const t=this._modules.settings.get("interactions.zoom.enabled"),e=this._modules.settings.get("interactions.zoom.onDoubleClick");return!(!t||!e)},handler:({x:t,y:e})=>this._smoothZoom(1,t,e)}),this._modules.interactions.onDrag({priority:"panning",disableDetection:!0,check:({button:t})=>{const e=!!this._modules.settings.get("interactions.pan.enabled");return t==="left"&&e},onStart:()=>this._updateVisibility("pan",!0),onProgress:({dx:t,dy:e})=>this._modules.camera.move({x:-t,y:-e}),onStop:()=>this._updateVisibility("pan",!1)}),this._modules.interactions.onDrag({priority:"rotation",disableDetection:!0,check:({button:t,domEvent:e})=>(t==="right"||e&&e.buttons===2)&&!!this._modules.settings.get("interactions.rotation.enabled"),onStart:({x:t,y:e})=>{this._rotationStart={x:t,y:e},this._updateVisibility("rotation",!0)},onProgress:({x:t,y:e})=>this._rotate({x:t,y:e}),onStop:()=>this._updateVisibility("rotation",!1)}),this._modules.interactions.onGesture({priority:"gesture",disableDetection:!0,check:()=>!!this._modules.settings.get("interactions.gesture.enabled"),onStart:()=>this._updateVisibility("gesture",!0),onProgress:({dx:t,dy:e,rotation:s,scale:n,x:i,y:r})=>{this._modules.settings.get("interactions.rotation.enabled")&&this._modules.camera.rotate(-s),this._modules.camera.zoomIn({modifier:n},{x:i,y:r}),this._modules.camera.move({x:-t,y:-e})},onStop:()=>this._updateVisibility("gesture",!0)})}_rotate({x:t,y:e}){const{width:s,height:n}=this._modules.camera.getSize(),i=s/2,r=n/2,o=this._rotationStart.x-i,a=this._rotationStart.y-r,l=t-i,u=e-r,h=Math.atan2(a,o)-Math.atan2(u,l);this._rotationStart.x=t,this._rotationStart.y=e,this._modules.camera.rotate(h)}_updateVisibility(t,e){const s=!e,n=this._modules.settings,i=n.get(`interactions.${t}.hideNodes`),r=n.get(`interactions.${t}.hideEdges`),o=n.get(`interactions.${t}.hideNodeTexts`),a=n.get(`interactions.${t}.hideEdgeTexts`);i&&this._modules.graphics.setNodesVisibility(s),o&&this._modules.graphics.setNodeTextsVisibility(s),r&&this._modules.graphics.setEdgesVisibility(s),a&&this._modules.graphics.setEdgeTextsVisibility(s)}},N4=1e-8,M4=1e8,m_={duration:0,startAfter:0,ignoreZoomLimits:!1,callback:as,easing:"quadraticOut"};function Il(t){return Math.abs(t)<1e-8}var k4=80,I4=class zN extends Xe{constructor(){super(...arguments),this._minZoom=N4,this._maxZoom=M4,this._timeout=0,this._cornerCosSin=new Float32Array([0,0,0,0,0,0,0,0])}onMounted(){this._reset(),this._modules.events.on("setContainer",(()=>{this._reset(),this._modules.events.fire("move")})).on("resize",(()=>{this._reloadDimensions(),this._modules.events.fire("move")}))}get x(){return this._x}get y(){return this._y}get zoom(){return this._zoom}get angle(){return this._angle}get width(){return this._dimensions.width}get height(){return this._dimensions.height}moveEnd(e){this._modules.dom.clearTimeout(this._timeout),this._timeout=this._modules.dom.setTimeout((()=>{this._modules.events.fire("viewChanged",{type:e})}),k4)}getSize(){return{width:this._dimensions.width,height:this._dimensions.height}}getCenter(){return{x:this._x,y:this._y}}setCenter({x:e,y:s},n){const i=this._x,r=this._y;let o=e-this._x,a=s-this._y;return isNaN(o)&&(o=0),isNaN(a)&&(a=0),Il(o)&&Il(a)?Promise.resolve():new Promise((l=>{this._moveAnimation&&this._modules.animations.cancel(this._moveAnimation);const u=this._modules.animations.play((h=>{this._x=i+o*h,this._y=r+a*h,this._modules.events.fire("move").fire("pan")}),{...m_,...n,callback:()=>this.moveEnd("pan"),resolve:l});u&&(this._moveAnimation=u)}))}move({x:e,y:s},n){const i=EA({x:e,y:s},this._zoom,this._sinAngle,this._cosAngle);return this.setCenter({x:this._x+i.x,y:this._y+i.y},n)}getZoom(){return this._zoom}setZoom(e,s,n={x:void 0,y:void 0}){const{x:i,y:r}=n;let o=Wi(e,this._minZoom,this._maxZoom);return s&&s.ignoreZoomLimits||(o=this._applyZoomLimits(o)),isNaN(o)||Il(this._zoom-o)?Promise.resolve():new Promise((a=>{const l={...m_,...s,callback:()=>this.moveEnd("zoom"),resolve:a},u=this._dimensions.width/2,h=this._dimensions.height/2,g=this._zoom,f=u/g-u/o;if(i!==void 0&&r!==void 0){const y=(i-u)/g-(i-u)/o,_=(r-h)/g-(r-h)/o,x=this._cosAngle,v=this._sinAngle,b=x*y-v*_,S=v*y+x*_;this.setCenter({x:this._x+b,y:this._y+S},s)}this._zoomAnimation&&this._modules.animations.cancel(this._zoomAnimation),this._modules.dom.afterNextFrame().then((()=>this._modules.events.fire("zoomStart",{duration:l.duration,easing:l.easing,startZoom:g,endZoom:o})));const p=this._modules.animations.play((y=>{this._zoom=u/(u/g-f*y),this._modules.events.fire("move").fire("zoom")}),l);p&&(this._zoomAnimation=p)}))}_applyZoomLimits(e){const s=this._modules.settings.get("interactions.zoom.minValue"),n=this._modules.settings.get("interactions.zoom.maxValue"),{minScaledSize:i,maxScaledSize:r,width:o,height:a,cx:l}=this._modules.locate.getGraphBoundingBox(),u=this._zoom,h=this.getSize();let g=e;if(!isNaN(l)){const f={smallestNodeSize:i,biggestNodeSize:r,graphWidth:o+r,graphHeight:a+r,viewWidth:h.width,viewHeight:h.height},p=s&&s(f),y=n&&n(f);SA(p)&&g<p?g<u&&(g=Math.min(u,p)):SA(y)&&g>y&&g>u&&(g=Math.max(u,y))}return g}zoomIn(e,s={x:void 0,y:void 0}){let n=1;return e===void 0&&(e={}),typeof e=="number"&&(e={modifier:e}),n=typeof e.modifier!="number"?this._modules.settings.get("interactions.zoom.modifier")||Qy:e.modifier,this.setZoom(this._zoom*n,e,s)}moveToBounds(e,s={}){const n=this._modules.locate.computeConfigForBounds(e,{ignoreZoomLimits:!0});return this.moveTo(n,s)}moveTo(e,s={}){const n=this.getZoom(),i=this.getCenter(),r=e.zoom||this._zoom;return isNaN(e.x)&&(e.x=i.x),isNaN(e.y)&&(e.y=i.y),Il(e.x-i.x)&&Il(e.y-i.y)?Promise.resolve():s.duration===0?this.setView(e):new Promise((o=>{const a=Math.min(this.width,this.height),l=E4([i.x,i.y,a/n],[e.x,e.y,a/r]),u=l.duration,h=s.duration||u;this._moveAnimation&&this._modules.animations.cancel(this._moveAnimation);const g=this._modules.animations.play((f=>{const[p,y,_]=l(f);this._x=p,this._y=y,this._zoom=a/_,this._modules.events.fire("move"),this._modules.events.fire("pan")}),{duration:h,easing:s.easing,callback:()=>this.moveEnd("pan"),resolve:o});g&&(this._moveAnimation=g)}))}zoomOut(e,s={x:void 0,y:void 0}){let n=1;return e===void 0&&(e={}),typeof e=="number"&&(e={modifier:e}),n=typeof e.modifier!="number"?this._modules.settings.get("interactions.zoom.modifier")||Qy:e.modifier,this.setZoom(this._zoom/n,e,s)}getAngle(){return this._angle}setAngle(e,s){const n=this._angle,i=e-n;return Il(i)?Promise.resolve():new Promise((r=>{this._rotateAnimation&&this._modules.animations.cancel(this._rotateAnimation);const o=this._modules.animations.play((a=>{for(this._angle=n+i*a,this.calculateBoxCornerAngles();this._angle>Math.PI;)this._angle-=2*Math.PI;for(;this._angle<-Math.PI;)this._angle+=2*Math.PI;this._sinAngle=Math.sin(this._angle),this._cosAngle=Math.cos(this._angle),this._modules.events.fire("move").fire("rotate")}),{...m_,...s,callback:()=>this.moveEnd("rotate"),resolve:r});o&&(this._rotateAnimation=o)}))}rotate(e,s){return this.setAngle(this._angle+e,s)}getScreenCenter(){return{x:this._dimensions.width/2,y:this._dimensions.height/2}}graphToScreenCoordinates({x:e,y:s},n={x:0,y:0}){const i=this._dimensions.width/2,r=this._dimensions.height/2;return gf((e-this._x)*this._zoom+i,(s-this._y)*this._zoom+r,i,r,-this._angle,n)}screenToGraphCoordinates({x:e,y:s},n={x:0,y:0}){return gf(this._x+(e-this._dimensions.width/2)/this._zoom,this._y+(s-this._dimensions.height/2)/this._zoom,this._x,this._y,this._angle,n)}projectBounds(e,s=e){const n=e[0],i=e[1],r=e[2],o=e[3],a=this._x,l=this._y,u=this._dimensions.width/2,h=this._dimensions.height/2,g=this._sinAngle,f=this._cosAngle,p=1/this._zoom;let y=1/0,_=1/0,x=-1/0,v=-1/0;const b=[n,i,n,o,r,o,r,i];for(let S=0;S<b.length;S+=2){let A=b[S],w=b[S+1];A=a+(A-u)*p,w=l+(w-h)*p;const L=A-a,M=w-l;A=f*L-g*M+a,w=g*L+f*M+l,A<y&&(y=A),A>x&&(x=A),w<_&&(_=w),w>v&&(v=w)}return s[0]=y,s[1]=_,s[2]=x,s[3]=v,s}screenToGraphVector({x:e,y:s}){return EA({x:e,y:s},this._zoom,this._sinAngle,this._cosAngle)}getView(){return{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,width:this._dimensions.width,height:this._dimensions.height}}setView(e,s){let{x:n,y:i,zoom:r,angle:o}={x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,...e};return isNaN(n)&&(n=this._x),isNaN(i)&&(i=this._y),isNaN(r)&&(r=this._zoom),isNaN(o)&&(o=this._angle),Promise.all([this.setCenter({x:n,y:i},s),this.setZoom(r,s),this.setAngle(o,s)]).then(as)}_reloadDimensions(){this._dimensions=this._modules.dom.getDimensions()}animationInProgress(){const e=this._moveAnimation,s=this._zoomAnimation,n=this._rotateAnimation;return!!(e&&!e.done||s&&!s.done||n&&!n.done)}getProjectedScreenBounds(e=0){const{width:s,height:n}=this._dimensions,i=Math.max(s,n)*e;return this.projectBounds([0-i,0-i,s+i,n+i])}calculateBoxCornerAngles(){const e=this._angle;this._cornerCosSin[0]=Math.cos(e+Math.PI/4),this._cornerCosSin[1]=Math.sin(e+Math.PI/4),this._cornerCosSin[2]=Math.cos(e+3*Math.PI/4),this._cornerCosSin[3]=Math.sin(e+3*Math.PI/4),this._cornerCosSin[4]=Math.cos(e-3*Math.PI/4),this._cornerCosSin[5]=Math.sin(e-3*Math.PI/4),this._cornerCosSin[6]=Math.cos(e-Math.PI/4),this._cornerCosSin[7]=Math.sin(e-Math.PI/4)}getCornerCos(e){return this._cornerCosSin[2*e]}getCornerSin(e){return this._cornerCosSin[2*e+1]}_reset(){this._zoom=1,this._x=0,this._y=0,this._angle=0,this.calculateBoxCornerAngles(),this._sinAngle=0,this._cosAngle=1,this._dimensions=this._modules.dom.getDimensions()}clone(e){const s=new zN(this._ogma);return s._zoom=e.zoom||this._zoom,s._x=e.x||this._x,s._y=e.y||this._y,s._angle=e.angle||this._angle,s._sinAngle=Math.sin(s._angle),s._cosAngle=Math.cos(s._angle),s.calculateBoxCornerAngles(),s._dimensions={width:e.width||this._dimensions.width,height:e.height||this._dimensions.height},s}};function EA({x:t,y:e},s,n,i){return{x:i*(t/=s)-n*(e/=s),y:n*t+i*e}}function SA(t){return typeof t=="number"&&isFinite(t)}function R4(t){const e=t.filter((s=>isFinite(s)&&s>0));return e.length?Qr(e):1}var F4="anonymous",P4="white",z4="default",D4={maxBlockId:1024,maxCoord:-1/0,maxScaledSize:16,maxPixelSize:255,maxMinVisibleSize:64,maxDashOffset:4,maxDashLength:3,maxGapLength:1,maxSymbolicSize:0,maxPatternScale:0},O4=jf?"webgl":null,AA=5,B4=class extends Xe{constructor(){super(...arguments),this._debug=!1,this._initDone=!1,this._boundaries={maxSize:10,maxMinVisibleSize:64},this._visibility={nodes:0,edges:0,nodeTexts:0,edgeTexts:0},this._nextAnimationId=1,this._animations=[],this._rendererState={type:null,code:null,state:"ok",message:""},this._cursorStyle=[],this._fontsNewlyLoaded=[],this._nextGeIndex=1,this._availableGeIndexes=[],this._renderOnNewFrame=!0,this._isBufferDisplayable=t=>{const e=uU(t),s=eL(t),n=e?this._visibility.nodes:this._visibility.edges,i=e?this._visibility.nodeTexts:this._visibility.edgeTexts;return n===0&&(!s||i===0)},this._onRendererChange=t=>{this._updateRendererState({type:t,state:"requested",code:null,message:void 0}),this._engine.setRenderType(t),this._modules.dom.refresh()},this._onNewFrame=()=>{this._processAnimations(),this._loadGraphInGraphicsEngine(),this._renderOnNewFrame&&this._render()},this._applyCursorStyle=()=>{const t=this._cursorStyle[this._cursorStyle.length-1]||this._modules.settings.get("cursor.default");hf(this._domWrapper,t)},this._updateImageCrossOrigin=()=>{this._imageManager.setImgCrossOrigin(this._modules.settings.get("imgCrossOrigin")||null)}}onMounted(){this._debug=this._ogma.isDebug(),this._renderOnNewFrame=!0,this._formatText=AC().applyArabicShaping,this._attributesManager=new y4(this._ogma,this._modules),this._imageManager=new r3,this._fontManager=new yB,this._engine=new u_(u_.getCachedInitData()),this._domWrapper=this._engine.getDomWrapper(),this._engine.on("error",this._onNewFrame),this._nodeAnimationMap=new Map,this._edgeAnimationMap=new Map,this._movingNodes=new Set,this._movingEdges=new Set,this._modules.events.register(["reloadFonts","rendererStateChange","beforeUpdateAttributes","updateAttributes","animate","move","pan","zoom","rotate","viewExportStart","viewExportEnd","afterImageExport","viewChanged","zoomStart"]),this._modules.settings.register("renderer",O4,this._onRendererChange),this._modules.settings.register("edgeTipRatio",tC,(t=>{this._engine.setEdgeArrowSizeRatio(t),this._modules.dom.refresh()})),this._modules.settings.register("nodeCornerRadius",0,(t=>{s3(this._engine,t),this._modules.dom.refresh()})),this._modules.settings.register("edgeMinTipSize",eC,(t=>{this._engine.setEdgeMinTipSize(t),this._modules.dom.refresh()})),this._modules.settings.register("backgroundColor",P4,(t=>{this._engine.parseColor(t)?this._modules.dom.refresh():($o(`Invalid background color "${t}" specified; will default to black.`),this._modules.settings.set("backgroundColor","black"))})),this._modules.settings.register("texts.hideUntilFontsLoaded",!0,(t=>{this._fontManager.setHideUntilFontsLoaded(!!t)})),this._modules.settings.register("texts.cornerRadius",AA,(t=>{this._engine.getTextManager().setCornerRadius(typeof t=="number"?t:AA),this._modules.dom.refresh()})),this._modules.settings.register("imgCrossOrigin",F4,this._updateImageCrossOrigin),this._modules.settings.register("cursor.default",z4,this._applyCursorStyle),this._modules.dom.setLayer("graphics",this._domWrapper),this._engine.setGlobalBoundaries(D4),this._modules.dom.beforeNextFrame().then((()=>{this._initDone=!0,this._fireRendererStateChangeEvent()})),this._imageManager.onFetch((()=>{this._engine.notifyPatternUpdate(),this._modules.dom.refresh()})),this._fontManager.onFontLoaded((t=>{this._fontsNewlyLoaded.push(t),this._engine.notifyPatternUpdate(),this._engine.notifyFontsReloaded(),this._modules.dom.refresh()})),this._modules.dom.addMediaListener("(min-resolution: 2dppx)",(()=>this._modules.dom.refresh())),this._visibleAttributeLayer=this._attributesManager.addAttributeLayer({priority:0,name:`internal(${xy})`,tag:xy,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),this._dataAttributeLayer=this._attributesManager.addAttributeLayer({priority:0,name:`internal(${vy})`,tag:vy,nodeDependencies:void 0,edgeDependencies:void 0}),hA(this._engine,this._attributesManager.getFlexArrays()),this._modules.events.on("move",(()=>this._modules.dom.refresh())).on("frame",this._onNewFrame).on("viewExportStart",(()=>{this._renderOnNewFrame=!1})).on("viewExportEnd",(()=>{this._renderOnNewFrame=!0})).on("clearGraph",(()=>{this._nextGeIndex=1,this._availableGeIndexes=[],this._engine.clear(),this._attributesManager.clear(),this._modules.dom.refresh(),this._animations=[],this._nodeAnimationMap.clear(),this._edgeAnimationMap.clear()})).on("viewChanged",(({type:t})=>{if(t==="rotate"){const e=this._modules.graph.getEdges().filter((s=>s.getAttribute("adjustAnchors")));this._attributesManager.redrawElements(e)}})).on("addNodes",(t=>{this._attributesManager.updateForAllAttributeLayers(t.nodes)})).on("addEdges",(t=>{this._attributesManager.updateForAllAttributeLayers(t.edges)})).on("excludedStateChange",(t=>{this._visibleAttributeLayer.updateElements(t.elements)})).on("setData",(t=>{this._dataAttributeLayer.updateElements(t.elements)})),u_.clearCachedInitData(),this._modules.dom.addWindowEventListener("unload",(()=>this.destroy()))}onReady(t){t.renderer!==void 0&&this._ogma.setOptions({renderer:t.renderer}),t.imgCrossOrigin!==void 0&&this._ogma.setOptions({imgCrossOrigin:t.imgCrossOrigin})}getTransparentBackgroundColor(){const t=this._modules.settings.get("backgroundColor");return t?this._engine.transparentify(t):null}pauseRendering(){this._renderOnNewFrame=!1}resumeRendering(){this._renderOnNewFrame=!0}_render(){const t=this._modules.dom.getDimensions(),e=this._modules.camera.getView(),s=bi(),n=Hn(),i=this._modules.settings.get("backgroundColor"),r=this._isBufferDisplayable;this._engine.setView({x:e.x,y:e.y,zoom:e.zoom,angle:e.angle,width:t.width,height:t.height,pixelRatio:s,currentTime:n,backgroundColor:i,isBufferDisplayable:r});try{this._engine.render(),this._rendererState.state==="requested"&&this._updateRendererState({state:"ok"})}catch(o){if(this._debug)throw o;const{message:a,code:l="OTHER"}=o,u=this._rendererState.type,h=xO(u),g=`Error while initializing the ${h} renderer`,f=`The ${h} renderer encountered an unexpected runtime error`;let p=this._rendererState.state==="requested"?g:f,y=null;u==="webgl"&&(p+="; fallbacking on canvas renderer",y="canvas"),$o(a||""),$o(p),this._updateRendererState({state:"error",code:l,message:a}),this._modules.settings.set("renderer",y)}}_fireRendererStateChangeEvent(){const t=this._rendererState;this._modules.events.fire("rendererStateChange",{type:t.type,state:t.state,code:t.code,message:t.message})}_updateRendererState({type:t,state:e,code:s,message:n}){let i=!1;t!==void 0&&this._rendererState.type!==t&&(this._rendererState.type=t,i=!0),e!==void 0&&this._rendererState.state!==e&&(this._rendererState.state=e,i=!0),s!==void 0&&this._rendererState.code!==s&&(this._rendererState.code=s,i=!0),n!==void 0&&this._rendererState.message!==n&&(this._rendererState.message=n,i=!0),i&&this._initDone&&this._fireRendererStateChangeEvent()}getImageData(){return this._modules.dom.afterNextFrame().then((()=>this._engine.getImageData()))}getNodeAttributes(){return this._attributesManager.getFlexArrays().nodes.current}getEdgeAttributes(){return this._attributesManager.getFlexArrays().edges.current}getGraphicsEngine(){return this._engine}getImageManager(){return this._imageManager}getFontManager(){return this._fontManager}allocateGraphicsEngineBlockId(){return this._availableGeIndexes.length?this._availableGeIndexes.pop():this._nextGeIndex++*ep+ND}releaseGraphicsEngineBlockId(t){this._engine.freeBlock(t),this._availableGeIndexes.push(t),this._modules.dom.refresh()}addCursorStyle(t){t&&(this._cursorStyle.push(t),this._applyCursorStyle())}removeCursorStyle(t){if(!t)return;const e=this._cursorStyle.lastIndexOf(t);e!==-1&&(this._cursorStyle.splice(e,1),this._applyCursorStyle())}reloadFonts(){this._modules.events.fire("reloadFonts"),this._engine.notifyFontsReloaded(),this._modules.dom.refresh()}getDomElement(){return this._domWrapper}setTextHidden(t,e){this._attributesManager.setTextHidden(t,e)}resetTextHidden(){this._attributesManager.resetTextHidden(),this._modules.dom.refresh()}getAttributesManager(){return this._attributesManager}_checkFontsNewlyLoaded(){return!!this._fontsNewlyLoaded.length&&(this._fontsNewlyLoaded=[],!0)}_loadGraphInGraphicsEngine(){this._attributesManager.update(),this._checkFontsNewlyLoaded()&&this._attributesManager.redrawAll(),this._modules.events.fire("beforeUpdateAttributes");const{elementsToRedraw:t,elementsUpdated:e}=this._attributesManager.getUpdatedElements(),s=e.nodes.size>0||e.edges.size>0;(e.nodeAttributesSet.has("radius")||e.edgeAttributes.includes("width"))&&(this._boundaries.maxSize=yO(this._modules.graph)),(e.nodeAttributesSet.has("shape")||e.edgeAttributes.includes("shape.head")||e.edgeAttributes.includes("shape.tail"))&&hA(this._engine,this._attributesManager.getFlexArrays()),YU({graph:this._modules.graph,elements:t,engine:this._engine,imageManager:this._imageManager,fontManager:this._fontManager,view:this._modules.camera.getView(),attributes:this._attributesManager.getFlexArrays(),boundaries:this._boundaries,formatText:this._formatText}),s&&this._modules.events.fire("updateAttributes",e)}_forceCompleteGraphRefresh(){this._attributesManager.redrawAll(),this._loadGraphInGraphicsEngine()}export(t,e,s,n){let i;return Promise.all([this._modules.graph.getNodes().addClass(Na),this._modules.graph.getEdges().addClass(Na)]).then((()=>this.resolveAtNextFrame())).then((()=>this._imageManager.whenReady())).then((()=>{s==="all"?(i=V4(this._modules.graph),this._forceCompleteGraphRefresh()):this._loadGraphInGraphicsEngine();const r=this._modules.camera.clone({...e});return this._modules.events.fire("viewExportStart",{preventOverlap:n.preventOverlap,camera:r,view:r.getView()}),this._ogma.view.afterNextFrame().then((()=>this._engine.export(t,e,n)))})).then((r=>Promise.all([this._modules.graph.getNodes().removeClass(Na),this._modules.graph.getEdges().removeClass(Na)]).then((()=>r)))).then((r=>(s==="all"&&(j4(i),this._forceCompleteGraphRefresh()),this._modules.events.fire("viewExportEnd"),r)))}addAttributeLayer(t){return this._attributesManager.addAttributeLayer(t)}getAttributeValues(t,e,s,n){return this._attributesManager.getAttributeValues(t,e,s,n)}forceAttributesComputation(){this._attributesManager.update()}resolveAtNextFrame(t){return this._modules.dom.afterNextFrame().then((()=>t))}isMoving(t){return(t.isNode?this._movingNodes:this._movingEdges).has(t._index)}animate(t,e,s,n){const i=U4(n);return i.duration&&this._engine.ensureAnimationsReady(),this._animate(t,e,s,i)}isAnimating(){return this._animations.length>0}getAnimationInformation(t){return this._attributesManager.getAnimationInformation(t)}_toSubGraph(t){if(t instanceof uo||t instanceof xi)return{nodes:t.toList(),edges:t.getAdjacentEdges()};if(t instanceof Ya||t instanceof Ir)return{nodes:this._modules.graph.nodeList(),edges:t.toList()};const e=t,s={nodes:e.nodes||this._modules.graph.nodeList(),edges:e.edges||this._modules.graph.edgeList()};return s.nodes.size&&(s.edges.size?s.edges=s.edges.concat(s.nodes.getAdjacentEdges()).dedupe():s.edges=s.nodes.getAdjacentEdges()),s}_animate(t,e,s,{duration:n,easing:i}){if((!this._animations.length||s)&&!n)return e(t),Promise.resolve(t);const r=this._toSubGraph(t),o=r.nodes,a=r.edges;if(o.size===0&&a.size===0)return e(t),Promise.resolve(t);if(o.size){if(s)for(let f=0;f<o._indexes.length;f++)this._movingNodes.add(o._indexes[f]);this._modules.events.fire("animate",{elements:o,duration:n,updatesPositions:s,easing:i})}if(a.size){if(s)for(let f=0;f<a._indexes.length;f++)this._movingEdges.add(a._indexes[f]);this._modules.events.fire("animate",{elements:a,duration:n,updatesPositions:s,easing:i})}const l={id:this._nextAnimationId++,startTime:Hn(),finished:!1,func:()=>e(t),duration:n,easing:i,nodes:o,edges:a,started:!1,updatesPositions:s,resolve:as};let u=l;const h=new Set;if(u=this._getLongestAnimation(u,l.nodes,h),u=this._getLongestAnimation(u,l.edges,h),u.updatesPositions){for(let f=0;f<o._indexes.length;f++)this._nodeAnimationMap.set(o._indexes[f],u);for(let f=0;f<a._indexes.length;f++)this._edgeAnimationMap.set(a._indexes[f],u);l.duration=u.duration,l.startTime=u.startTime}if(l.duration===0&&u.id===l.id)return e(t),Promise.resolve(t);const g=new Promise((f=>l.resolve=()=>f(t)));return this._animations.push(l),this._modules.dom.refresh(),n||this._processAnimations(),g}_removeFinishedAnimations(){this._animations=this._animations.filter((t=>!t.finished))}_getAnimationElements(t){return{nodes:t.nodes,edges:t.edges}}_resetAnimationAttributes({nodes:t,edges:e}){this._attributesManager.resetAnimationAttributes({nodes:t,edges:e});for(let s=0;s<t._indexes.length;s++)this._nodeAnimationMap.delete(t._indexes[s]),this._movingNodes.delete(t._indexes[s]);for(let s=0;s<e._indexes.length;s++)this._edgeAnimationMap.delete(e._indexes[s]),this._movingEdges.delete(t._indexes[s])}_getLongestAnimation(t,e,s){const n=e.isNode?this._nodeAnimationMap:this._edgeAnimationMap;for(let i=0;i<e._indexes.length;i++){const r=n.get(e._indexes[i]);r&&!s.has(r.id)&&(s.add(r.id),(t.updatesPositions||!r.updatesPositions)&&r.duration+r.startTime<t.duration+t.startTime||(t=r))}return t}_processAnimations(){if(!this._animations.length)return;const t=Hn(),e=[];this._attributesManager.update();for(const s of this._animations)s.started||(s.started=!0,e.push(s.func),this._attributesManager.setAnimationAttributes(this._getAnimationElements(s),s));for(const s of e)s();for(const s of this._animations)t>=s.startTime+s.duration&&(this._resetAnimationAttributes(this._getAnimationElements(s)),s.resolve(s.elements),s.finished=!0);this._removeFinishedAnimations(),this._animations.length&&this._modules.dom.refresh()}hideTexts(){this.setNodeTextsVisibility(!1),this.setEdgeTextsVisibility(!1)}showTexts(){this.setNodeTextsVisibility(!0),this.setEdgeTextsVisibility(!0)}setNodesVisibility(t){return this._updateVisibilityCounter("nodes",t)}setNodeTextsVisibility(t){return this._updateVisibilityCounter("nodeTexts",t)}setEdgesVisibility(t){return this._updateVisibilityCounter("edges",t)}setEdgeTextsVisibility(t){return this._updateVisibilityCounter("edgeTexts",t)}_updateVisibilityCounter(t,e){this._visibility[t]+=e?-1:1,this._modules.dom.refresh()}detectNode(t,e,s,n,i,r){return mO(t,e,s,n,i,r,this._modules.graph,this._attributesManager,this._modules.camera,this._engine,this._movingNodes,this._formatText)}detectEdge(t,e,s,n,i){const{bentEnable:r,bentVertical:o}=this._modules.graphics.getGraphicsEngine().getBentEdges();return _O(t,e,s,n,i,this._modules.graph,this._modules.camera,this._movingNodes,this._attributesManager,r,o)}getVisibilityCounters(){return this._visibility}destroy(){this.getGraphicsEngine().destroy(),this.getImageManager().destroy(),this.getFontManager().destroy()}};function U4(t){return typeof t=="number"?t={duration:t}:typeof t=="object"&&t!==null||(t={duration:0}),{duration:G4(t.duration),easing:t.easing||"linear",chain:!!t.chain}}function G4(t){return typeof t!="number"||!isFinite(t)||t<0?0:t}function wA(t,e){const s=e?t.getNodeAttribute("excluded"):t.getEdgeAttribute("excluded"),n=(e?t.getNodes("all"):t.getEdges("all"))._indexes,i=s.getMultiple(n);return s.fill(n,0),{excludedList:s,indexes:n,values:i}}function TA({excludedList:t,indexes:e,values:s}){t.setMultiple(e,s)}function V4(t){return{nodes:wA(t,!0),edges:wA(t,!1)}}function j4({nodes:t,edges:e}){TA(t),TA(e)}var H4=180,$4=50,q4=class extends Xe{constructor(){super(...arguments),this._onAnyEvents=[],this._registeredEvents={},this.onIdle=Zd((()=>this.fire("idle")),$4),this.fireIdle=dT(this.onIdle,H4)}onMounted(){this._registeredEvents={},this.register(["idle"]),this._ogma.onReady((()=>{this.on(["viewChanged","layoutEnd","addNodes","addEdges","removeNodes","removeEdges","animate","setMultipleAttributes","transformationRefresh"],this.fireIdle)}))}isRegistered(t){return!!this._registeredEvents[t]}register(t,e=[]){t.forEach((s=>{this._registeredEvents[s]||(this._registeredEvents[s]=new Y4(!1,s))}))}onAnyEvent(t){this._onAnyEvents.push(t)}on(t,e){return Array.isArray(t)?(t.forEach((s=>this.on(s,e))),this):this._registeredEvents[t]?(this._registeredEvents[t].on(e),this):this}off(t){return Object.values(this._registeredEvents).forEach((e=>e.off(t))),this}fire(t,e=null){const s=this._getEvent(t);return this._onAnyEvents.forEach((n=>n(e,t))),s.trigger(e),this}once(t,e){return Array.isArray(t)?(t.forEach((s=>this.once(s,e))),this):this._registeredEvents[t]?(this._registeredEvents[t].once(e),this):this}_getEvent(t){if(!(t in this._registeredEvents))throw new Error(`Event ${t} does not exist`);return this._registeredEvents[t]}destroy(){Object.values(this._registeredEvents).forEach((t=>{t.destroy()}))}},Y4=class{constructor(t,e){this._subscribers=[],this._handlers=[],this._onceWrappers=new WeakMap,this._reverseOrder=t,this._name=e}trigger(t){for(const e of this._handlers)e(t,this._name);return this}on(t){if(typeof t!="function")throw new Error("handler is not a function");const e=this._reverseOrder?0:this._subscribers.length;return this._handlers.splice(e,0,t),this._subscribers.splice(e,0,t),this}once(t){if(typeof t!="function")throw new Error("handler is not a function");const e=this,s=function(){t.apply(null,arguments),e.off(s)};return this._onceWrappers.set(t,s),this.on(s),this}off(t){const e=this._onceWrappers.get(t),s=e||t;let n;for(;(n=this._subscribers.indexOf(s))!==-1;)this._subscribers.splice(n,1),this._handlers.splice(n,1);return e&&this._onceWrappers.delete(t),this}destroy(){this._subscribers=[],this._handlers=[]}},W4=class extends Xe{onMounted(){this._graphics=this._modules.graphics,this._modules.events.register(["setMultipleAttributes"]),this._modules.events.on(["addNodes","addEdges"],(({nodes:t,edges:e,objects:s})=>{this._onAddElements(t||e,s)})),this._originalAttributesLayer=this._graphics.addAttributeLayer({name:"original-attributes",priority:Vz,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),this._individualAttributesLayer=this._graphics.addAttributeLayer({name:"individual-attributes",priority:$z,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0})}_onAddElements(t,e){const s=e.map((n=>n.attributes));this._originalAttributesLayer.setAttributeValues(t,s)}getOriginalAttributes(){return this._originalAttributesLayer.getFlexArrays()}getIndividualAttributes(){return this._individualAttributesLayer.getFlexArrays()}setMultipleAttributes(t,e,s){const n=Array.isArray(e)?e.length&&e[0]?wf(e[0],t.isNode):[]:wf(e,t.isNode),i=n.includes("x")||n.includes("y"),r=[];return this._modules.events.fire("setMultipleAttributes",{elements:t,values:e,updatedAttributes:n,options:s,promises:r}),this._graphics.animate(t,(()=>{this._individualAttributesLayer.setAttributeValues(t,e)}),i,s).then((o=>Promise.all(r).then((()=>o))))}setSingleAttribute(t,e,s,n){const i={};return no(i,e,s),this.setMultipleAttributes(t,i,n)}resetMultipleAttributes(t,e,s){const n=e||this._individualAttributesLayer.getUsedAttributeNames(t),i=n&&(n.includes("x")||n.includes("y")),r={};for(const o of n)no(r,o,void 0);return this._graphics.animate(t,(()=>{this._individualAttributesLayer.setAttributeValues(t,r)}),i,s)}getMultipleAttributes(t,e){return this._graphics.getAttributeValues(t,e,!0,!1)}getSingleAttribute(t,e){return this._graphics.getAttributeValues(t,e,!1,!1)}replaceOriginalAttributes(t,e,s=[]){const n={},i=this._originalAttributesLayer.getUsedAttributeNames(t).filter((r=>!s.includes(r)));for(let r=0;r<i.length;++r)no(n,i[r],void 0);this._originalAttributesLayer.setAttributeValues(t,n),this._originalAttributesLayer.setAttributeValues(t,e)}getSinglePreviousAttribute(t,e){return this._graphics.getAttributeValues(t,e,!1,!0)}getMultiplePreviousAttributes(t,e){return this._graphics.getAttributeValues(t,e,!0,!0)}},X4=class extends Xe{constructor(){super(...arguments),this._currentValue={},this._onChange={},this._defaultValues={},this._keys=[]}onReady(t){t.renderer&&this.update({renderer:t.renderer}),t.options&&this.update(t.options)}register(t,e,s,n){return n===void 0&&(n=!0),this._keys.push(t),this._currentValue[t]=e,this._defaultValues[t]=e,this._onChange[t]=s||as,s&&n&&s(e),this}update(t){t=Kd(t);const e=this._keys,s={},n=this._currentValue;for(let r=0;r<e.length;++r){const o=e[r];if(o in t){let a=t[o];a===void 0&&(a=this._defaultValues[o]),s[o]=n[o],n[o]=a}}const i=Object.keys(s);for(let r=0;r<i.length;++r){const o=i[r],a=this._currentValue[o],l=s[o];a!==l&&this._onChange[o](a,l)}return ey(s)}get(t){return arguments.length===0?ey(this._currentValue):this._currentValue[t]}set(t,e){const s=this._currentValue[t],n=this._onChange[t];this._currentValue[t]=e,n&&n(e,s)}},Z4=class{constructor(t,e){this._classes=t,this._name=e}getName(){return this._name}getIndex(){return this._classes.getIndex(this._name)}setIndex(t){return this._classes.setIndex(this._name,t)}update(t){return this._classes.update(this._name,t),this}getDefinition(){return this._classes.getDefinition(this._name)}getNodes(t){return this._classes.getElementsByClass(this._name,t).nodes}getEdges(t){return this._classes.getElementsByClass(this._name,t).edges}clearNodes(t){this.getNodes(t).removeClass(this._name)}clearEdges(t){this.getEdges(t).removeClass(this._name)}add(t){t.addClass(this._name)}remove(t){t.removeClass(this._name)}destroy(){const t=this._classes.getElementsByClass(this._name);return Promise.all([t.nodes.removeClass(this._name),t.edges.removeClass(this._name)]).then((()=>this._classes.removeClass(this._name)))}},K4=1e3,Q4=.5/K4,J4=class extends Xe{constructor(){super(...arguments),this._builtinClasses=[],this._userClasses=[],this._classesByName={},this._onExcludedStateChange=({elements:t,value:e})=>{if(e){const s=this._builtinClasses.map((n=>n.name));this._addOrRemoveClassesToElements(s,t,!1)}},this._onClearGraph=()=>{this._builtinClasses.concat(this._userClasses).forEach((t=>t.elementSet.clear()))},this._onRemoveElements=({nodes:t,edges:e})=>{const s=t||e;this._builtinClasses.concat(this._userClasses).forEach((n=>n.elementSet.removeElements(s)))}}onMounted(){this._modules.events.on("excludedStateChange",this._onExcludedStateChange).on("clearGraph",this._onClearGraph).on("removeEdges",this._onRemoveElements).on("removeNodes",this._onRemoveElements)}_getClassList(t){return t?this._builtinClasses:this._userClasses}createClass({name:t,isBuiltin:e=!1,after:s,nodeAttributes:n,nodeDependencies:i,nodeOutput:r,edgeAttributes:o,edgeDependencies:a,edgeOutput:l}={}){if(typeof t!="string")throw new Error('the "name" argument should be a string');const u=this._getClassList(e),h=s?t5(u,s)+1:u.length;if(h===-1)throw new Error(`createClass: class specified as \`after\` parameter "${s}" does not exist`);if(e&&!t.startsWith("_"))throw new Error(`invalid builtin class name "${t}": builtin classes should start with '_'`);const g=new Ih(this._modules.graph),f=new Z4(this,t),p={name:t,elementSet:g,attributeLayer:this._modules.graphics.addAttributeLayer({name:`class(${t})`,tag:t,standaloneSelectors:!0,nodeAttributes:n||void 0,edgeAttributes:o||void 0,nodeSelector:(y,_)=>_.hasElement(y),edgeSelector:(y,_)=>_.hasElement(y),nodeContext:g,edgeContext:g,nodeOutput:r,edgeOutput:l,nodeDependencies:i,edgeDependencies:a}),isBuiltin:e,wrapper:f};return u.splice(h,0,p),e&&u.sort(((y,_)=>eS.indexOf(y.name)-eS.indexOf(_.name))),this._updatePriorities(e),this._classesByName[t]=p,this._modules.events.register([Rl(t,!0,!0),Rl(t,!0,!1),Rl(t,!1,!0),Rl(t,!1,!1)]),f}removeClass(t){const e=this._get(t),s=this._getClassList(e.isBuiltin),n=s.indexOf(e);return n!==-1&&(s.splice(n,1),e.attributeLayer.destroy(),delete this._classesByName[t],this._updatePriorities(e.isBuiltin)),Promise.resolve(void 0)}_updatePriorities(t){const e=this._getClassList(t),s=qz+(t?.5:0);for(let n=0;n<e.length;++n){const i=e[n],r=s+Q4*n;i.attributeLayer.update({priority:r})}}_get(t){const e=this._classesByName[t];if(!e)throw new Error(`class "${t}" does not exist`);return e}getIndex(t){const e=this._get(t);return this._getClassList(e.isBuiltin).indexOf(e)}setIndex(t,e){const s=this._get(t),n=this._getClassList(s.isBuiltin),i=n.indexOf(s),r=Wi(e,0,n.length-1);n.splice(i,1),n.splice(r,0,s),this._updatePriorities(s.isBuiltin)}update(t,{nodeAttributes:e,edgeAttributes:s,nodeDependencies:n,edgeDependencies:i,nodeOutput:r,edgeOutput:o,fullOverwrite:a}={}){this._get(t).attributeLayer.update({nodeAttributes:e,edgeAttributes:s,nodeDependencies:n,edgeDependencies:i,nodeOutput:r,edgeOutput:o,fullOverwrite:a})}getDefinition(t){const e=this._get(t),{nodeAttributes:s,nodeDependencies:n,nodeOutput:i,edgeAttributes:r,edgeDependencies:o,edgeOutput:a}=e.attributeLayer.getDefinition();return{nodeAttributes:s||void 0,edgeAttributes:r||void 0,nodeDependencies:n,edgeDependencies:o,nodeOutput:i,edgeOutput:a}}_addOrRemoveClassesToElements(t,e,s){const n=e.isNode;for(let i=0;i<t.length;++i){const r=t[i],{elementSet:o,attributeLayer:a}=this._get(r),l=o.addOrRemoveElements(e,s),u=Rl(r,n,s);l.size&&(a.updateElements(l),this._modules.events.fire(u,n?{nodes:l}:{edges:l}))}}_animatedAttributesUpdatePositions(t,e){for(let s=0;s<t.length;++s){const n=t[s],i=this.getDefinition(n);if(e.isNode&&i.nodeAttributes&&(i.nodeAttributes.x||i.nodeAttributes.y))return!0}return!1}_getAnimatedAtrributes(t,e){return t.reduce(((s,n)=>{const i=this.getDefinition(n);return e.isNode&&i.nodeAttributes&&s.push(...wf(i.nodeAttributes,!0)),!e.isNode&&i.edgeAttributes&&s.push(...wf(i.edgeAttributes,!1)),s}),[])}addClassesToElements(t,e,s){const n=e.toList(),i=this._animatedAttributesUpdatePositions(t,n);return this._modules.graphics.animate(e,(()=>{this._addOrRemoveClassesToElements(t,n,!0)}),i,s)}removeClassesFromElements(t,e,s){const n=e.toList(),i=this._animatedAttributesUpdatePositions(t,n);return this._modules.graphics.animate(e,(()=>{this._addOrRemoveClassesToElements(t,n,!1)}),i,s)}hasSingleElementClass(t,e){return!!this._classesByName[t]&&this._get(t).elementSet.hasElement(e)}getElementsClassList(t,e={}){const{includeBuiltinClasses:s=!1}=e,n=new Array(t.size);for(let i=0;i<n.length;++i)n[i]=[];return this._addClassNamesToList(n,t,this._userClasses),s&&this._addClassNamesToList(n,t,this._builtinClasses),n}_addClassNamesToList(t,e,s){const n=e.toList();for(let i=0;i<s.length;++i){const{name:r,elementSet:o}=s[i];for(let a=0;a<n.size;++a){const l=n.get(a);o.hasElement(l)&&t[a].push(r)}}}getClassByName(t,e=!1){const s=this._classesByName[t]||null;if(e&&!s)throw new Error(`class "${t}" does not exist`);return s&&s.wrapper}getClassList(){return this._userClasses.map((t=>t.wrapper))}getElementsByClass(t,e="visible"){const{elementSet:s}=this._get(t),n=s.getElements();let i=n.nodes,r=n.edges;return e==="visible"?(i=i.filter((o=>o.isVisible())),r=r.filter((o=>o.isVisible()))):e==="raw"&&(i=i.filter((o=>!o.isVirtual())),r=r.filter((o=>!o.isVirtual()))),{nodes:i,edges:r}}_onClassEvent(t,e,s,n){const i=Rl(t,s,n);this._modules.events.on(i,e)}onNodeClassAdded(t,e){this._onClassEvent(t,e,!0,!0)}onNodeClassRemoved(t,e){this._onClassEvent(t,e,!0,!1)}onEdgeClassAdded(t,e){this._onClassEvent(t,e,!1,!0)}onEdgeClassRemoved(t,e){this._onClassEvent(t,e,!1,!1)}};function Rl(t,e,s){return`${e?"node":"edge"}Class${s?"Added":"Removed"}_${t}`}function t5(t,e){for(let s=0;s<t.length;++s)if(t[s].name===e)return s;return-1}var e5=oT(aT()),DN=()=>({x:0,y:0,x1:0,y1:0,x2:0,y2:0});function CA(t,e,s,{cells:n=!0,boxes:i=!0,query:r=!0}={}){const o=e.keys().map((l=>e.keyToBBox(Number(l)))),a=e.getBoxes();if(n&&(t.beginPath(),t.lineWidth=1,t.strokeStyle="#707070",o.forEach((l=>{t.rect(l[0],l[1],l[2]-l[0],l[3]-l[1])})),t.stroke()),i&&(t.beginPath(),t.lineWidth=1,t.strokeStyle="#ff7070",a.forEach((l=>{t.rect(l[0],l[1],l[2]-l[0],l[3]-l[1])})),t.closePath(),t.stroke()),r&&s){const l=s;t.beginPath(),t.lineWidth=2,t.strokeStyle="#3030ff",t.rect(l[0],l[1],l[2]-l[0],l[3]-l[1]),t.closePath(),t.stroke()}}function s5(t){const[e,s,n]=t.getNodeAttributes(["x","y","radius"]),[i,r,o]=t.getEdgeAttributes(["source","target","curvature"]),a=DN(),l=c0();return u=>{if(u<0){u=-u;const h=i.get(u),g=r.get(u),f=o.get(u),p=e.get(h),y=s.get(h),_=e.get(g),x=s.get(g);h===g?(np(p,y,f,n.get(h),0,a),op(p,y,a.x1,a.y1,a.x2,a.y2,_,x,l)):f===0?(l.minX=Math.min(p,_),l.minY=Math.min(y,x),l.maxX=Math.max(p,_),l.maxY=Math.max(y,x)):(Wa(p,y,_,x,f,a),f0(p,y,a.x,a.y,_,x,l))}else{const h=e.get(u),g=s.get(u),f=n.get(u);l.minX=h-f,l.minY=g-f,l.maxX=h+f,l.maxY=g+f}return[l.minX,l.minY,l.maxX,l.maxY]}}var n5=["x","y","radius"],i5=["width","curvature"],r5=.5,LA=1,NA=128,MA=4,kA=16,o5=1e4,a5=class extends Xe{constructor(){super(...arguments),this._minCellSize=kA,this._clear=()=>{this._index.clear(),this._elementsToUpdate.clear()},this._onGraphUpdate=t=>{if(t.nodes&&(!t.nodeAttributes||t.nodeAttributes.some((e=>n5.includes(e))))){const e=t.nodes.fastGetAdjacentElements().edges;this._elementsToUpdate.addElements(t.nodes),this._elementsToUpdate.addElements(e)}t.edges&&(t.edgeAttributes&&!t.edgeAttributes.some((e=>i5.includes(e)))||this._elementsToUpdate.addElements(t.edges))}}onMounted(){this._index=new e5.HGrid(this._getIntersector(),s5(this._modules.graph),this._minCellSize,1e6),this._elementsToUpdate=new Ih(this._modules.graph),this._removedNodes=this._modules.graph.getNodeAttribute("removed"),this._removedEdges=this._modules.graph.getEdgeAttribute("removed"),this._excludedNodes=this._modules.graph.getNodeAttribute("excluded"),this._excludedEdges=this._modules.graph.getEdgeAttribute("excluded"),this._queryResult={edges:[],nodes:[]},this._queryBounds=[0,0,0,0],this._modules.events.on(["addNodes","addEdges","removeNodes","removeEdges","updateAttributes"],this._onGraphUpdate).on("excludedStateChange",(({elements:t})=>{this._elementsToUpdate.addElements(t)})).on("clearGraph",this._clear)}_getIntersector(){const t=this._modules.graph,[e,s,n]=t.getNodeAttributes(["x","y","radius"]),[i,r,o,a]=t.getEdgeAttributes(["source","target","width","curvature"]),l=DN(),u=this._modules.camera.getAngle(),h=Math.cos(u),g=Math.sin(u);return(f,p,y,_,x)=>{const{bentEnable:v,bentVertical:b}=this._modules.graphics.getGraphicsEngine().getBentEdges();if(f<0){f=-f;const S=i.get(f),A=r.get(f),w=a.get(f),L=o.get(f)/2,M=e.get(S),F=s.get(S),O=e.get(A),G=s.get(A);return v?(ip(M*h-F*g,F*h+M*g,O*h-G*g,G*h+O*g,w,v,b,l),Fy(M,F,l.x1*h+l.y1*g,l.y1*h-l.x1*g,l.x2*h+l.y2*g,l.y2*h-l.x2*g,O,G,p-L,y-L,_+L,x+L)):S===A?(np(M,F,w,n.get(S),0,l),Fy(M,F,l.x1,l.y1,l.x2,l.y2,O,G,p-L,y-L,_+L,x+L)):w===0?p0(M,F,O,G,p-L,y-L,_+L,x+L):(Wa(M,F,O,G,w,l),LC(M,F,l.x,l.y,O,G,p-L,y-L,_+L,x+L))}return Zx(e.get(f),s.get(f),n.get(f),p,y,_,x)}}reindex(){this._modules.graphics.forceAttributesComputation(),this._index.clear(),this._elementsToUpdate.clear(),this._updateItems(this._modules.graph.getNodes("all")._indexes,this._modules.graph.getEdges("all")._indexes)}getSize(){return this._index.size}_updateIndex(){if(this._elementsToUpdate.isEmpty())return;const{nodes:t,edges:e}=this._elementsToUpdate.getElements(),s=t._indexes.length,n=this._modules.graph.getNodes("all").size;let i=!1;if(this._index.averageCellOccupancy<LA)for(;this._index.averageCellOccupancy<LA&&this._minCellSize<o5;)this._minCellSize=this._minCellSize*MA,this._index.setMinCellSize(this._minCellSize),this.reindex(),i=!0;if(!i&&this._index.averageCellOccupancy>NA)for(;this._index.averageCellOccupancy>NA&&this._minCellSize>kA;)this._minCellSize=this._minCellSize/MA,this._index.setMinCellSize(this._minCellSize),this.reindex(),i=!0;!i&&s/n>r5?this.reindex():(this._updateItems(t._indexes,e._indexes),this._elementsToUpdate.clear())}_updateItems(t,e){const s=this._index,n=this._removedNodes,i=this._removedEdges,r=this._excludedNodes,o=this._excludedEdges,a=[],l=[];if(n&&r)for(let u=0;u<t.length;u++){const h=t[u];n.get(h)!==0||r.get(h)!==0?a.push(h):(s.has(h)&&a.push(h),l.push(h))}if(i&&o)for(let u=0;u<e.length;u++){const h=-e[u];i.get(-h)!==0||o.get(-h)!==0?a.push(h):(s.has(h)&&a.push(h),l.push(h))}for(const u of a)s.remove(u);for(const u of l)s.insert(u)}getNodesInScreenByDistance(t){const{x:e,y:s}=t.getPositionOnScreen();return this._modules.graph.getNodes().filter((n=>n.isInScreen()&&n!==t)).sort(((n,i)=>{const r=n.getPositionOnScreen(),o=i.getPositionOnScreen();return _n(r.x,r.y,e,s)-_n(o.x,o.y,e,s)}))}getNearestNodesForNode(t,e=240,s){const{x:n,y:i}=t.getPosition();return this.getNearestNodes(n,i,e,s,t)}getNearestNodes(t,e,s,n,i){if(this._updateIndex(),n){const r=this._modules.camera.screenToGraphVector({x:s,y:s});s=_n(0,0,r.x,r.y)}return this._getNearestNodes(t,e,s,i)}_getNearestNodes(t,e,s,n){const i=[],r=s*s,o=n?n._index:0,a=this._modules.graph.getNodes()._indexes,[l,u]=this._modules.graph.getNodeAttributes(["x","y"]);for(let h=0,g=a.length;h<g;h++){const f=a[h];if(f===o)continue;const p=t-l.get(f),y=e-u.get(f);p*p+y*y<=r&&i.push(f)}return this._modules.graph.nodeList(new Uint32Array(i))}queryRaw(t,e,s,n){this._updateIndex();const i=this._queryBounds;i[0]=t,i[1]=e,i[2]=s,i[3]=n;const r=this._index.query(t,e,s,n),{nodes:o,edges:a}=this._queryResult;o.length=a.length=0;for(let l=0;l<r.length;l++){const u=r[l];u<0?a.push(-u):o.push(u)}return this._queryResult}queryRawProjected(t,e,s,n){const i=this._queryBounds;i[0]=t,i[1]=e,i[2]=s,i[3]=n,this._modules.camera.projectBounds(i);const r=this.queryRaw(i[0],i[1],i[2],i[3]);return this._modules.labels.query(i[0],i[1],i[2],i[3],r),r}query(t,e,s,n){const i=this._modules.graph,{nodes:r,edges:o}=this.queryRaw(t,e,s,n);return{nodes:i.nodeList(new Uint32Array(r.slice())),edges:i.edgeList(new Uint32Array(o.slice()))}}queryProjected(t,e,s,n){const i=this._modules.graph,{nodes:r,edges:o}=this.queryRawProjected(t,e,s,n);return{nodes:i.nodeList(new Uint32Array(r)),edges:i.edgeList(new Uint32Array(o))}}getNodesByBoundingBox(t,e,s,n,i){if(this._updateIndex(),i){let g;g=this._modules.camera.screenToGraphVector({x:t,y:e}),t=g.x,e=g.y,g=this._modules.camera.screenToGraphVector({x:s,y:n}),s=g.x,n=g.y}const r=this._modules.graph,o=r.getNodes()._indexes,a=[],l=r.getNodeAttribute("excluded"),[u,h]=r.getNodeAttributes(["x","y"]);for(let g=0,f=o.length;g<f;g++){const p=o[g];if(l&&l.get(p))continue;const y=u&&u.get(p),_=h&&h.get(p);y>=t&&y<=s&&_>=e&&_<=n&&a.push(p)}return r.nodeList(new Uint32Array(a))}toggleDebug(t){t?(this._layer=this._modules.layers.addCanvasLayer((e=>{CA(e,this._index,this._queryBounds)}),{isStatic:!1,noClear:!1}),this._layer.moveToTop()):this._layer&&(this._layer.destroy(),this._layer=null)}renderDebug(t){if(!this._layer)return this.toggleDebug(!0);this._layer.refresh((e=>{CA(e,this._index,this._queryBounds,t)}))}},mu={};function dp(t,e,s,n,i=0,r=Math.sin(i),o=Math.cos(i),a=[0,0,0,0]){const l=s/2,u=n/2,h=t+l,g=e+u;if(i===0)return a[0]=t,a[1]=e,a[2]=t+s,a[3]=e+n,a;let f,p,y,_,x,v,b,S;return y=-l,_=-u,f=h+y*o-_*r,p=g+y*r+_*o,x=b=f,v=S=p,y=-l,_=u,f=h+y*o-_*r,p=g+y*r+_*o,f<x?x=f:f>b&&(b=f),p<v?v=p:p>S&&(S=p),y=l,_=u,f=h+y*o-_*r,p=g+y*r+_*o,f<x?x=f:f>b&&(b=f),p<v?v=p:p>S&&(S=p),y=l,_=-u,f=h+y*o-_*r,p=g+y*r+_*o,f<x?x=f:f>b&&(b=f),p<v?v=p:p>S&&(S=p),a[0]=x,a[1]=v,a[2]=b,a[3]=S,a}function Rh(t,e,s,n,i=0){const r=s/2,o=n/2,a=t+r,l=e+o;if(i===0)return[{x:t,y:e},{x:t+s,y:e},{x:t+s,y:e+n},{x:t,y:e+n}];const u=Math.sin(i),h=Math.cos(i);let g,f,p,y;p=-r,y=-o,g=a+p*h-y*u,f=l+p*u+y*h;const _={x:g,y:f};p=-r,y=o,g=a+p*h-y*u,f=l+p*u+y*h;const x={x:g,y:f};p=r,y=o,g=a+p*h-y*u,f=l+p*u+y*h;const v={x:g,y:f};return p=r,y=-o,g=a+p*h-y*u,f=l+p*u+y*h,[_,x,v,{x:g,y:f}]}function Jy(t,e=0,s=1,n=A2.slice()){const i=s*Math.sin(e),r=s*Math.cos(e);return n[0]=t[0]+i,n[1]=t[1]+r,n[2]=t[2]+i,n[3]=t[3]+r,n}function l5(t,e){return T2(t,e)}function u5(t,e){return ON(t[0],t[1],t[2],t[3],e[0],e[1],e[2],e[3])}function d5(t,e,s,n,i,r,o,a){return t>i&&t<o&&e>r&&e<a||s>i&&s<o&&n>r&&n<a}function ON(t,e,s,n,i,r,o,a){return n>=r&&e<=a&&s>=i&&t<=o}xh(mu,{angle:()=>dO,circleCircleIntersection:()=>Wx,circleContainsCircle:()=>KP,circleContainsPoint:()=>ZP,circleIntersectsBox:()=>Zx,circleLineIntersection:()=>C2,circleSortCompare:()=>Xx,computeCentroid:()=>ZU,cubicBezierAABB:()=>Fy,defaultAABB:()=>A2,degreesToRadians:()=>XP,distToSegmentSquared:()=>m0,distance:()=>_n,distancePointSegment:()=>RC,extendBounds:()=>T2,getAABB:()=>dp,getBentEdgesControlPoints:()=>ip,getBezierCurveBoundingBox:()=>op,getClosestPointOnLine:()=>cO,getClosestPointOnSegment:()=>FC,getNormalOnEdge:()=>oO,getNormalOnQuadraticCurve:()=>NC,getOBBPoints:()=>Rh,getPointOnBezierCurve:()=>ih,getPointOnEdge:()=>rO,getPointOnQuadraticCurve:()=>rp,getQuadraticBezierCurveLength:()=>lO,getQuadraticCurveBoundingBox:()=>f0,getQuadraticCurveControlPoint:()=>Wa,getSelfLoopControlPoints:()=>np,getTangentOnEdge:()=>aO,getTangentOnQuadraticCurve:()=>g0,intersects:()=>d5,isPointInLine:()=>kC,isPointInPolygon:()=>oh,isPointOnBezierCurve:()=>Py,isPointOnQuadraticCurve:()=>MC,lineAABB:()=>p0,lineAngle:()=>gu,lineIntersection:()=>hO,lineLine:()=>Kl,minDisk:()=>wh,move:()=>WP,moveAABB:()=>Jy,normalize:()=>w2,overlaps:()=>ON,overlapsAABB:()=>u5,padBounds:()=>l5,polygonsIntersect:()=>lL,quadBezierAABB:()=>LC,radiansToDegrees:()=>_y,rotate:()=>gf,segmentIntersection:()=>Ed,segmentRectangleIntersection:()=>IC,squaredDistance:()=>Ug,twoSegmentsIntersect:()=>uO});var _g=40;function BN(t,e){const s=t.getAttribute("curvature"),n=t.getSource(),i=t.getTarget(),r=n.getPositionOnScreen();if(n===i){const _=(s+n.getAttribute("radius"))*vf*e,x=r.x,v=r.y,b=x-_,S=v,A=x,w=v+_;return[r,...[.2,.4,.6,.8].map((L=>ih(L,x,v,x,v,b,S,A,w))),r]}const o=i.getPositionOnScreen();if(s===0)return[r,o];const a=o.x-r.x,l=o.y-r.y,u=Math.sqrt(a*a+l*l),h=(r.x+o.x)/2,g=(r.y+o.y)/2,f=s*(u/Qf)*2,p=h+l/u*f,y=g+-a/u*f;return[r,...[.25,.5,.75].map((_=>rp(_,r.x,r.y,o.x,o.y,p,y))),o]}function h5(t,e,s){const n=t.getSource(),i=t.getTarget(),r=n.getPositionOnScreen(),o=i.getPositionOnScreen();if(oh(r.x,r.y,e)||oh(o.x,o.y,e))return!0;const a=BN(t,s);for(let l=0;l<a.length-1;++l){const u=a[l],h=a[l+1];for(let g=0;g<e.length-1;++g){const f=e[g],p=e[g+1];if(Kl(u.x,u.y,h.x,h.y,f.x,f.y,p.x,p.y))return!0}}return!1}function c5(t,e,s){const n=t.getPositionOnScreen(),i=Number(t.getAttribute("radius"))*s;return UN(n.x,n.y,i,e)}function UN(t,e,s,n){const i=t-s,r=e-s,o=e+s;return t+s>=n.minX&&i<=n.maxX&&o>=n.minY&&r<=n.maxY}function g5(t,e,s){const n=BN(t,s);for(let i=0;i<n.length-1;++i){const r=n[i],o=n[i+1];if(p0(r.x,r.y,o.x,o.y,e.minX,e.minY,e.maxX,e.maxY))return!0}return!1}function IA(t,e,s,n){typeof s=="number"&&(s={left:s,right:s,top:s,bottom:s});const i=s.left===void 0?_g:s.left,r=s.right===void 0?_g:s.right,o=s.top===void 0?_g:s.top,a=s.bottom===void 0?_g:s.bottom,l=i+r,u=o+a,h=t.width===0?t.maxFixedSize:t.width,g=t.height===0?t.maxFixedSize:t.height,f=R4([(e.width-l)/(h+t.maxScaledSize),(e.height-u)/(g+t.maxScaledSize),(e.width-l-t.maxFixedSize)/h,(e.height-u-t.maxFixedSize)/g,n/t.maxScaledSize||NaN]);return{x:t.cx+(r-i)/(2*f),y:t.cy+(a-o)/(2*f),zoom:f}}var f5="cubicOut",RA=200,p5=class extends Xe{constructor(){super(...arguments),this._isLocating=!1,this._cacheValid=!0,this._cachedGraphBoundingBox=new ri,this._onLocateStart=()=>{this._isLocating=!0},this._onLocated=()=>{this._isLocating=!1,this._modules.events.fire("locate")},this._invalidCache=()=>{this._cacheValid=!1}}onMounted(){this._modules.events.register(["locate"]),this._modules.events.on(["addNodes","removeNodes","addEdges","removeEdges","excludedStateChange","clearGraph","updateAttributes"],this._invalidCache)}onReady(){this.locateGraph({},!0)}locateGraph(t,e=!1){return this._onLocateStart(),e?this._locateGraph(t):this._modules.transformations.whenApplied().then((()=>this._locateGraph(t)))}_locateGraph(t){return this._locateBoundingBox(this.getGraphBoundingBox(),t).then(this._onLocated)}locateElements(t,e){return this._modules.transformations.whenApplied().then((()=>this._locateBoundingBox(this.getBoundingBox(t),e))).then(this._onLocated)}locateRawGraph(t,e){return this._onLocateStart(),this._locateBoundingBox(this.getRawGraphBoundingBox(t),e).then(this._onLocated)}isLocating(){return this._isLocating}getGraphBoundingBox(t=!1){if(t){const e=this.getBoundingBox(this._ogma.getNodes(),!0,t),s=this.getBoundingBox(this._ogma.getEdges(),!1,t);return e.extend(s)}return this._cacheValid||this._updateCache(),this._cachedGraphBoundingBox.clone()}forceInvalidCache(){this._invalidCache()}_updateCache(){this._cacheValid=!0,this._cachedGraphBoundingBox=this.getBoundingBox(this._modules.graph.getNodes()).extend(this.getBoundingBox(this._modules.graph.getEdges()))}getBoundingBox(t,e=!1,s=!1,n){let i;if(i=t.isNode?this._getNodesBoundingBox(t.toList(),e):this._getEdgesBoundingBox(t.toList(),n),s){const r=this._ogma.modules.labels.getTextsBoundingBox(t.isNode?t.toList():null,t.isNode?null:t.toList());i=i.extend(r)}return i}_getNodesBoundingBox(t,e=!1){this._modules.graphics.forceAttributesComputation();const s=this._modules.graphics.getNodeAttributes(),n=[],i=[],r=[],o=[];for(let a=0;a<t.size;++a){const l=t._indexes[a];if(s.excluded.get(l)===0){const u=s.x.get(l),h=s.y.get(l),g=s.radius.get(l),f=2*g;s.scalingMethod.get(l)==="scaled"?r.push(f):o.push(f),e?(n.push(u-g,u+g),i.push(h-g,h+g)):(n.push(u),i.push(h))}}return new ri({xValues:n,yValues:i,scaledSizeValues:r,fixedSizeValues:o})}_getEdgesBoundingBox(t,e=!1){return this._getEdgesBoundingBoxInternal(t._indexes,e)}_getEdgesBoundingBoxInternal(t,e=!1,s,n){this._modules.graphics.forceAttributesComputation();const i=this._modules.graphics.getEdgeAttributes(),r=this._modules.graphics.getNodeAttributes(),o={x1:0,y1:0,x2:0,y2:0},a={x:0,y:0},l={minX:0,minY:0,maxX:0,maxY:0},u=[],h=[],g=[],f=[],p=s||r.x,y=n||r.y;for(let _=0;_<t.length;++_){const x=t[_],v=i.source.get(x),b=i.target.get(x),S=i.curvature.get(x),A=p.get(v),w=y.get(v),L=r.scalingMethod.get(v)==="scaled",M=2*r.radius.get(v),F=p.get(b),O=y.get(b),G=r.scalingMethod.get(b)==="scaled",j=2*r.radius.get(b);L?g.push(M):f.push(M),G?g.push(j):f.push(j),e||S===0?(u.push(A,F),h.push(w,O)):v===b?(_0(A,w,S,M/2,0,o),op(A,w,o.x1,o.y1,o.x2,o.y2,F,O,l),u.push(l.minX,l.maxX),h.push(l.minY,l.maxY)):(ap(A,w,F,O,S,a),f0(A,w,a.x,a.y,F,O,l),u.push(l.minX,l.maxX),h.push(l.minY,l.maxY))}return new ri({xValues:u,yValues:h,scaledSizeValues:g,fixedSizeValues:f})}getRawGraphBoundingBox(t){const e=t.nodes.length,s=new Array(e),n=new Array(e),i=new Array(e);for(let r=0;r<e;r++){const o=t.nodes[r].attributes||{};s[r]=o.x||0,n[r]=o.y||0,i[r]=o.radius||5}return new ri({xValues:s,yValues:n,scaledSizeValues:i})}_locateBoundingBox(t,e={}){if(isNaN(t.cx))return Promise.resolve();const{padding:s={},easing:n=f5,duration:i=0,maxNodeSizeOnScreen:r=RA,ignoreZoomLimits:o=!1}=e,a=IA(t,this._modules.dom.getDimensions(),s,r),l=a.x,u=a.y,h=a.zoom,g=h/this._modules.camera.getZoom();return this._moveCamera(l,u,h,i,n,g,o)}_moveCamera(t,e,s,n,i,r,o){const a={duration:n,easing:i,ignoreZoomLimits:o},l=this._modules.camera.setCenter({x:t,y:e},a);return r>1.01||r<.99?this._modules.camera.setZoom(s,a):l}computeConfigForBounds(t,e={}){const{padding:s={},maxNodeSizeOnScreen:n=RA}=e;return IA(t,this._modules.dom.getDimensions(),s,n)}layoutDataBoundingBox({x:t,y:e,indexes:s}){const n=this._modules.graphics.getNodeAttributes(),i=[],r=[],o=[],a=[],l=new Map,u=new Map;for(let f=0;f<s.length;++f){const p=s[f],y=t[f],_=e[f];l.set(p,y),u.set(p,_);const x=2*n.radius.get(p),v=n.scalingMethod.get(p)==="scaled";i.push(y),r.push(_),v?o.push(x):a.push(x)}const h=this._modules.graph.topology.getAdjacentElements(!1,s,{bothExtremities:!0}),g=this._getEdgesBoundingBoxInternal(h,!1,l,u);return new ri({xValues:i,yValues:r,scaledSizeValues:o,fixedSizeValues:a}).extend(g)}isEdgeInPolygon(t,e){return h5(t,e,this._modules.camera.getZoom())}isElementInView(t,{margin:e=0}={}){const{width:s,height:n}=this._modules.camera.getSize(),i={minX:-e,minY:-e,maxX:s+e,maxY:n+e};return t.isNode?this.isNodeInRectangle(t,i):this.isEdgeInRectangle(t,i)}isNodeInRectangle(t,e){if(this._modules.geo.isEnabled()){const s=this._modules.geo.getContainerCoord(t);return UN(s.x,s.y,Number(t.getAttribute("radius")),e)}return c5(t,e,this._modules.camera.getZoom())}isNodeInPolygon(t,e){const s=t.getPositionOnScreen();return oh(s.x,s.y,e)}isEdgeInRectangle(t,e){return g5(t,e,this._modules.camera.getZoom())}},m5=Yo&&typeof navigator<"u"&&"msLaunchUri"in navigator&&ao&&!("documentMode"in document);function _5(t){return m5?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/bi():t.deltaY&&t.deltaMode===1?20*-t.deltaY:t.deltaY&&t.deltaMode===2?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}var y5=6,x5=class extends Xe{constructor(){super(...arguments),this._px=0,this._py=0,this._pressX=0,this._pressY=0,this._left=!1,this._middle=!1,this._right=!1,this._clickCounter={left:0,middle:0,right:0},this._buttons={left:!1,middle:!1,right:!1},this._skipNextMove=!1,this._onMouseWheel=t=>{this._isEnabled()&&this._isWheelEnabled()&&(!this._disableWheelUntilMouseDown()||this._modules.dom.hasFocus())&&(t.preventDefault(),t.stopPropagation(),this._applyMouseWheelZoom(t))},this._onMouseMove=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=e-this._px,i=s-this._py;n===0&&i===0||(this._skipNextMove?this._skipNextMove=!1:_n(e,s,this._pressX,this._pressY)>=y5&&(this._resetClickCounter(),this._modules.events.fire("mousemoveInternal",{x:e,y:s,dx:n,dy:i,domEvent:this._evt})))},this._onDocumentMouseMove=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=this._bounds,i=e-this._px,r=s-this._py;(e<0||e>n.width||s<0||s>n.height)&&this._modules.events.fire("documentMouseMove",{x:e,y:s,dx:i,dy:r,domEvent:this._evt})},this._onMouseUp=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=this._button,i=this._evt;this._buttons[n]=!1,this._clickCounter[this._button]===1?this._modules.events.fire("clickInternal",{button:n,x:e,y:s,domEvent:i}):this._clickCounter[n]>1&&(this._modules.events.fire("doubleclickInternal",{button:n,x:e,y:s,domEvent:i}),this._resetClickCounter(n)),this._modules.events.fire("mouseupInternal",{button:n,x:e,y:s,domEvent:i})},this._onDocumentMouseup=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=this._button;this._buttons[n]=!1;const i=this._modules.dom;this._modules.events.fire("documentMouseUp",{button:n,x:e,y:s,domEvent:this._evt}),i.removeDirectWindowEventListener("mousemove",this._onDocumentMouseMove),i.removeDirectWindowEventListener("mouseup",this._onDocumentMouseup)},this._onMouseDown=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=this._button,i=this._modules.dom;this._skipNextMove=!0,this._pressX=e,this._pressY=s,this._lastMouseDownTarget=t.target,i.focus(),this._buttons[n]=!0,this._clickCounter[n]+=1;const r=n;this._dbclickTimer=i.setTimeout((()=>{this._resetClickCounter(r,0)}),this._getDoubleClickTimer()),this._modules.events.fire("mousedownInternal",{button:n,x:e,y:s,domEvent:this._evt}),i.addDirectWindowEventListener("mousemove",this._onDocumentMouseMove),i.addDirectWindowEventListener("mouseup",this._onDocumentMouseup)},this._onDrop=t=>{if(!this._isEnabled()||!this._setXY(t))return;t.preventDefault();const{x:e,y:s}=this._modules.camera.screenToGraphCoordinates(this._modules.position);this._modules.events.fire("drop",{domEvent:this._evt,x:e,y:s})}}onMounted(){this._domElt=this._modules.graphics.getDomElement(),this._modules.settings.register("mouse.enabled",!0),this._modules.settings.register("mouse.wheelEnabled",!0),this._modules.settings.register("mouse.disableWheelUntilMouseDown",!1),this._modules.settings.register("mouse.doubleClickTimer",500),this._modules.events.register(["mousedownInternal","mouseupInternal","mousemoveInternal","mousewheelInternal","clickInternal","doubleclickInternal","mouseoverInternal","mouseoutInternal","documentMouseUp","documentMouseMove","drop"]),this._modules.dom.afterNextFrame().then((()=>this._initializeListeners()))}get x(){return this._modules.position.x}get y(){return this._modules.position.y}get left(){return this._left}get right(){return this._right}get middle(){return this._middle}_isEnabled(){return this._modules.settings.get("mouse.enabled")}_isWheelEnabled(){return this._modules.settings.get("mouse.wheelEnabled")}_disableWheelUntilMouseDown(){return this._modules.settings.get("mouse.disableWheelUntilMouseDown")}_getDoubleClickTimer(){return this._modules.settings.get("mouse.doubleClickTimer")}_resetClickCounter(t,e=0){t?this._clickCounter[t]=e:(this._clickCounter.left=e,this._clickCounter.middle=e,this._clickCounter.right=e),this._modules.dom.clearTimeout(this._dbclickTimer),this._lastMouseDownTarget=null}_setXY(t){const e=this._domElt.getBoundingClientRect();return this._bounds=e,!!e&&(this._evt=t,this._button=Gx[t.button],this._px=this._modules.position.x,this._py=this._modules.position.y,this._modules.position.x=t.clientX-e.left,this._modules.position.y=t.clientY-e.top,this._left=this._buttons.left,this._right=this._buttons.right,this._middle=this._buttons.middle,!0)}_applyMouseWheelZoom(t){this._setXY(t)&&this._modules.events.fire("mousewheelInternal",{delta:_5(t),dx:t.deltaX,dy:t.deltaY,x:this._modules.position.x,y:this._modules.position.y,domEvent:this._evt})}_initializeListeners(){const t=this._domElt,e=this._modules.dom;Hf&&this._modules.dom.addElementEventListener(document,"contextmenu",(n=>{this._lastMouseDownTarget&&n.target!==this._lastMouseDownTarget&&n.preventDefault()})),e.addElementEventListener(t,"contextmenu",(n=>{this._setXY(n),this._modules.dom.hasFocus()&&this._modules.settings.get("mouse.enabled")&&n.preventDefault()}),!1);const s="onwheel"in t?"wheel":t.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll";e.addElementEventListener(t,s,this._onMouseWheel,{passive:!1}),e.addElementEventListener(t,"mousemove",this._onMouseMove),e.addElementEventListener(t,"mouseleave",(n=>{if(!this._isEnabled())return;this._modules.dom.blur();const i=t.getBoundingClientRect();n.clientX>=i.left+1&&n.clientX<=i.right-1&&n.clientY>=i.top+1&&n.clientY<=i.bottom-1||this._modules.events.fire("mouseout",{domEvent:this._evt})})),e.addElementEventListener(t,"mousedown",this._onMouseDown),e.addElementEventListener(t,"mouseup",this._onMouseUp),e.addElementEventListener(t,"dragover",(n=>{n.preventDefault()})),e.addElementEventListener(t,"drop",this._onDrop)}},v5={doubleTapTimer:500},b5=class extends Xe{constructor(){super(...arguments),this._pressed=!1,this._addEvent=(t,e,s,n)=>{this._modules.dom.addElementEventListener(t,e,s,n)},this._addWinEvent=(t,e,s,n)=>{this._modules.dom.addDirectWindowEventListener(e,s,n)},this._removeWinEvent=(t,e,s)=>{this._modules.dom.removeDirectWindowEventListener(e,s)}}onMounted(){this._domElt=this._modules.graphics.getDomElement(),this._modules.settings.register("touch.enabled",!0),this._modules.events.register(["touchDown","touchUp","touchTap","touchDoubleTap","touchMove","touchStartGesture","touchProgressGesture","touchEndGesture","documentTouchMove","documentTouchUp"]),this._modules.dom.afterNextFrame().then((()=>{this._initialize(this)}))}get x(){return this._modules.position.x}get y(){return this._modules.position.y}get pressed(){return this._pressed}_listen(t,e,s){if(O2){if(e==="touchstart")return Tz(this._addEvent,t,s);if(e==="touchmove")return Lz(this._addWinEvent,t,s);if(e==="touchend")return Nz(this._addWinEvent,t,s);if(e==="touchcancel")return Cz(this._addWinEvent,t,s)}return this._modules.dom.addElementEventListener(t,e,s)}_initialize(t){let e=0,s=0,n=0,i=0,r=!1,o="left",a=0,l=!1,u=!1,h=0,g=1,f=null,p=null;const y=()=>{this._modules.position.x=e,this._modules.position.y=s,this._pressed=r},_=(w,L)=>{const M=this._domElt.getBoundingClientRect();if(!M||w.touches==null)return null;const[F,O]=w.touches,G=F.clientX-M.left,j=F.clientY-M.top,Z=O.clientX-M.left,at=O.clientY-M.top,pt=(G+Z)/2,K=(j+at)/2,ut=pt-e,ht=K-s,nt=_n(G,j,Z,at),ot=nt/g,Mt=gu(G,j,Z,at),Q={dx:ut,dy:ht,rotation:Mt-h,scale:ot};return((Et,Xt,Ht,Zt)=>{g=Et,h=Xt,e=Ht,s=Zt,y()})(nt,Mt,pt,K),Q},x=w=>{if(w.touches&&w.touches.length===2&&u){const L=_(w);if(L){const{dx:M,dy:F,rotation:O,scale:G}=L;this._modules.events.fire("touchProgressGesture",{dx:M,dy:F,rotation:O,scale:G,x:e,y:s,domEvent:f,button:o})}}},v=w=>{if(o=Gx[w.button],!w.touches)return!1;if(w.touches.length!==1)return r=!1,w.touches.length>1&&this._modules.events.fire("touchUp",{x:e,y:s,domEvent:f,button:o}),!1;const L=this._domElt.getBoundingClientRect();return L&&(n=e,i=s,e=w.touches[0].clientX-L.left|0,s=w.touches[0].clientY-L.top|0,r=!0,f=w,y()),!0},b=()=>{a=0,this._modules.dom.clearTimeout(p)},S=w=>{if(w.preventDefault(),!w.touches)return;if(w.touches.length!==2&&u&&(u=!1,this._modules.events.fire("touchEndGesture",{domEvent:f})),v(w),w.touches.length===0){const M={x:e,y:s,domEvent:f,button:o};a===1&&this._modules.events.fire("touchTap",M),a>1&&(this._modules.events.fire("touchDoubleTap",M),b()),this._modules.events.fire("touchUp",M)}const L=lo().documentElement;YE(this._removeWinEvent,L,"touchmove",this._onMove),YE(this._removeWinEvent,L,"touchend",this._onEnd)},A=w=>{x(w),l?l=!1:(b(),v(w)&&this._modules.events.fire("touchMove",{x:e,y:s,dx:e-n,dy:s-i,domEvent:f,button:o}))};this._listen(this._domElt,"touchstart",(w=>{if(!w.touches)return;w.touches.length!==2||u||(g=1,_(w)&&(u=!0,this._modules.events.fire("touchStartGesture",{domEvent:f}))),v(w)&&(this._modules.dom.focus(),this._modules.events.fire("touchDown",{x:e,y:s,domEvent:f,button:o}),a+=1,p=this._modules.dom.setTimeout(b,v5.doubleTapTimer),l=!0);const L=lo().documentElement;this._onMove=this._listen(L,"touchmove",A),this._onEnd=this._listen(L,"touchend",S)}))}},E5=class extends Xe{constructor(t){super(t),this.getSubElements=e=>this.api.getSubElements(e),this.getSubNodes=e=>this.api.getSubNodes(e),this.getSubEdges=e=>this.api.getSubEdges(e),this.getXYR=e=>this.api.getXYR(e),this.onGroupsUpdated=e=>this.api.onGroupsUpdated(e)}onMounted(){this._modules.classes.createClass({name:$2,isBuiltin:!0,nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0}}),this._modules.classes.createClass({name:q2,isBuiltin:!0,nodeAttributes:{opacity:0},edgeAttributes:{opacity:0}}),this._modules.settings.register("transformations.updateOnDataChange",!0),this._modules.events.register(["transformationEnabled","transformationDisabled","transformationSetIndex","transformationDestroyed","transformationRefresh"])}onReady(t){this.api=new xY(this._ogma)}destroy(){}isElementVirtual(t){return this.api.isVirtual(t._index,t.isNode)}getElementTransformation(t){return this.api.getTransformation(t._index,t.isNode)}getMetaElements(t){return t.map((e=>this.getMetaElement(e)))}getMetaElement(t){var s;const e=t.isNode?this.api.getMetaNode(t):this.api.getMetaEdge(t);return e&&((s=this.api.getTransformation(e._index,e.isNode))!=null&&s.isEnabled())?e:null}getMetaEdge(t){return this.getMetaElement(t)}getMetaNode(t){return this.getMetaElement(t)}getMetaNodes(t){return this.getMetaElements(t)}getMetaEdges(t){return this.getMetaElements(t)}getNodeFilters(){return this.api.getList().filter((t=>t.getName()===Xn.NodeFilter))}getEdgeFilters(){return this.api.getList().filter((t=>t.getName()===Xn.EdgeFilter))}whenApplied(){return this.api.afterNextUpdate()}afterNextUpdate(){return this.api.afterNextUpdate()}isRefreshing(){return this.api.isRefreshing()}triggerGroupUpdated(t){const e=t._indexes,s=this._ogma.modules.transformations.api.groupController.layoutController.shouldRelayout;for(let n=0;n<t.size;n++)s.add(e[n])}},FA={layer:Y2,outline:!0,outerStroke:{color:By,width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:bL,minVisibleSize:0}},S5={layer:Y2,color:By,text:{backgroundColor:bL,minVisibleSize:0},stroke:{color:By,width:0}},A5=class extends Xe{onMounted(){this.shouldTriggerEvents=!0,this._modules.events.register(["nodesSelected","nodesUnselected","edgesSelected","edgesUnselected"]),this._selectionExtremityHighlightedClass=this._modules.classes.createClass({name:Ey,isBuiltin:!0,nodeAttributes:FA}),this._selectedClass=this._modules.classes.createClass({name:Ts,isBuiltin:!0,nodeAttributes:FA,edgeAttributes:S5}),this._modules.events.on(`nodeClassAdded_${Ts}`,(e=>{this.shouldTriggerEvents&&this._modules.events.fire("nodesSelected",e)})),this._modules.events.on(`edgeClassAdded_${Ts}`,(e=>{this.shouldTriggerEvents&&this._modules.events.fire("edgesSelected",e)})),this._modules.events.on(`nodeClassRemoved_${Ts}`,(e=>{this.shouldTriggerEvents&&this._modules.events.fire("nodesUnselected",e)})),this._modules.events.on(`edgeClassRemoved_${Ts}`,(e=>{this.shouldTriggerEvents&&this._modules.events.fire("edgesUnselected",e)})),this._modules.settings.register("interactions.selection.enabled",!0),this._modules.settings.register("interactions.selection.multiSelectionKey","ctrl"),this._modules.interactions.onClick({priority:"selection",check:({button:e,target:s})=>{const n=!!this._modules.settings.get("interactions.selection.enabled"),i=s&&s.hasClass(ti);return e==="left"&&n&&!i},handler:({target:e})=>{if(e){const s=this._modules.settings.get("interactions.selection.multiSelectionKey"),n=s&&this._modules.keyboard.isPressed(s);e.isNode?this._selectedClass.clearEdges():this._selectedClass.clearNodes(),n?e.hasClass(Ts)?e.removeClass(Ts):e.addClass(Ts):((e.isNode?this._selectedClass.getNodes():this._selectedClass.getEdges()).filter((i=>i!==e)).removeClass(Ts),e.hasClass(Ts)||e.addClass(Ts))}else this._selectedClass.clearNodes(),this._selectedClass.clearEdges()}});const t=()=>{this._selectionExtremityHighlightedClass.clearNodes(),this._selectedClass.getEdges().getExtremities().filter((e=>!e.isDisabled())).addClass(Ey)};this._modules.events.on("beforeRemoveEdges",(({edges:e})=>e.setSelected(!1))).on("excludedStateChange",(({elements:e,value:s})=>{s||e.setSelected(!1)})).on(`edgeClassAdded_${Ts}`,t).on(`edgeClassRemoved_${Ts}`,t)}setNodeAttributes(t,e){this._selectedClass.update({nodeAttributes:t,fullOverwrite:e}),this._selectionExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()}setEdgeAttributes(t,e){this._selectedClass.update({edgeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()}setEdgeExtremitiesAttributes(t,e){this._selectionExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e})}_updateExtremityHighlightLayer(){const t=this._selectedClass.getDefinition().edgeAttributes,e=t?t.layer:void 0;this._selectionExtremityHighlightedClass.update({nodeAttributes:{layer:e},fullOverwrite:!1})}setActive(t,e){if(Nn(e)){const s=[],n=[];t.toList().forEach(((i,r)=>{(e[r]?s:n).push(i.getId())})),s.length!==0&&this._modules.graph.getElements(t.isNode,s).addClass(Ts),n.length!==0&&this._modules.graph.getElements(t.isNode,n).removeClass(Ts)}else t.size&&t[e?"addClass":"removeClass"](Ts)}areActive(t){return t.hasClass(Ts)}getSelectedNodes(){return this._selectedClass.getNodes()}getSelectedEdges(){return this._selectedClass.getEdges()}getNonSelectedNodes(){return this._modules.graph.getNodes().filter((t=>!t.hasClass(Ts)))}getNonSelectedEdges(){return this._modules.graph.getEdges().filter((t=>!t.hasClass(Ts)))}disableEvents(){this.shouldTriggerEvents=!1}enableEvents(){this.shouldTriggerEvents=!0}clear(){this._selectedClass.clearNodes(),this._selectedClass.clearEdges()}},w5=class extends Xe{onMounted(){this._delayedCalls=[],this._idIdle=()=>!this._modules.captor.isAnyButtonPressed()&&!this._modules.dom.isPlayingFrame(),this._modules.events.on(["mousedown","mouseup","beforeNewFrame","frame"],(()=>{this._delayedCalls.forEach((t=>t.reset()))}))}_nextTimeIdle(t){const e=new T5(this._modules.dom,this._idIdle,t);return this._delayedCalls.push(e),e.whenDone().then((()=>{this._delayedCalls.splice(this._delayedCalls.indexOf(e),1)}))}debounceIdle(t,e=0){let s=!1,n=[];const i=()=>{const r=n;s=!1,n=[],t(),r.forEach((o=>o()))};return()=>new Promise((r=>{n.push(r),s||(s=!0,this._nextTimeIdle(e).then(i))}))}},T5=class{constructor(t,e,s){this._timeout=null,this._done=!1,this._dom=t,this._promise=new Promise((n=>this._resolve=n)),this._isIdle=e,this._delay=s,this._startTimeout()}_startTimeout(){this._timeout=this._dom.setTimeout((()=>{this._isIdle()?(this._done=!0,this._resolve()):this._startTimeout()}),this._delay)}reset(){this._done||(this._dom.clearTimeout(this._timeout),this._startTimeout())}whenDone(){return this._promise}},yg=-2,C5={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:50,startRatio:1,endRatio:2,enabled:!1},L5={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:10,startRatio:1,endRatio:2,enabled:!1},N5=class extends Xe{constructor(){super(...arguments),this._nodePromiseMap=new Map,this._edgePromiseMap=new Map,this._onAttributeChange=({nodes:t,edges:e,nodeAttributes:s,edgeAttributes:n})=>{this._onElementsAttributeChange(t,s),this._onElementsAttributeChange(e,n,!1)},this._refreshPulses=()=>{const{nodes:t,edges:e}=this._hasPulses.getElements();if(t.size!==0||e.size!==0){const s=this._engine.getCurrentTime();this._refreshElementsPulses(t,s),this._refreshElementsPulses(e,s),this._modules.dom.refresh()}}}onMounted(){this._modules.events.on("updateAttributes",this._onAttributeChange).on("frame",this._refreshPulses).on("beforeRemoveEdges",(({edges:t})=>{this._removePulses(t)})).on("beforeRemoveNodes",(({nodes:t})=>{this._removePulses(t)})).on("excludedStateChange",(({elements:t,value:e})=>{e&&(this._hasPulses.removeElements(t),this._removePulses(t))})).on("clearGraph",(()=>this._hasPulses.clear())),this._engine=this._modules.graphics.getGraphicsEngine(),this._group=this._engine.createGroup(),this._nodePulses=this._modules.graph.createNodeAttribute({storage:"any"},!1),this._edgePulses=this._modules.graph.createEdgeAttribute({storage:"any"},!1),this._nodeNbPulsesRemaining=this._modules.graph.createNodeAttribute({storage:"int16",default:-1},!1),this._edgeNbPulsesRemaining=this._modules.graph.createEdgeAttribute({storage:"int16",default:-1},!1),this._nodeFlexArrays=this._modules.graphics.getNodeAttributes(),this._edgeFlexArrays=this._modules.graphics.getEdgeAttributes(),this._edgeSourceList=this._modules.graph.getEdgeAttribute("source"),this._edgeTargetList=this._modules.graph.getEdgeAttribute("target"),this._hasPulses=new Ih(this._modules.graph)}_onElementsAttributeChange(t,e,s=!0){if(!e.includes("pulse.enabled"))return;const{valid:n,invalid:i}=kT(this._modules.graph,t,(o=>o.getAttribute("pulse.enabled")&&o.isVisible()));this._hasPulses.removeElements(i),this._hasPulses.addElements(n);const r=s?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining;for(let o=0;o<n.size;o++)r.get(n._indexes[o])>0||r.set(n._indexes[o],yg);this._removePulses(i)}_removePulses(t){const e=t.isNode?this._nodePulses:this._edgePulses,s=t.isNode?this._nodePromiseMap:this._edgePromiseMap;for(let n=0;n<t._indexes.length;n++){const i=t._indexes[n],r=e.get(i);if(r){for(let a=0;a<r.length;a++){const l=r[a];this._modules.graphics.releaseGraphicsEngineBlockId(l.blockId)}e.set(i,null);const o=s.get(i);o&&(o.resolve(),s.delete(i))}}}_refreshElementsPulses(t,e){const s=t.isNode,n=s?this._nodePulses:this._edgePulses,i=s?this._nodeFlexArrays.pulse.duration:this._edgeFlexArrays.pulse.duration,r=s?"_createNodePulseBlock":"_createEdgePulseBlock",o=s?this._nodeFlexArrays.pulse.interval:this._edgeFlexArrays.pulse.interval,a=s?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining;for(let l=0;l<t._indexes.length;l++){const u=t._indexes[l];let h=n.get(u);h||(h=[],n.set(u,h));for(let _=0;_<h.length;_++){const{startTime:x,duration:v,blockId:b}=h[_];e>=x+v&&(this._modules.graphics.releaseGraphicsEngineBlockId(b),h.splice(_--,1))}const g=h[h.length-1];if(g&&e<g.startTime+o.get(u))continue;const f=i.get(u),p=a.get(u);if(p<1&&p!==yg)continue;h.push({blockId:this[r](u,e,f),startTime:e,duration:f});const y=p===yg?yg:p-1;a.set(u,y)}}_createNodePulseBlock(t,e,s){const n=this._nodeFlexArrays,i=n.color.get(t),r=n.layer.get(t),o=n.x.get(t),a=n.y.get(t),l=n.radius.get(t),u=n.scalingMethod.get(t)==="scaled",h=n.pulse.startRatio.get(t),g=n.pulse.endRatio.get(t),f=n.pulse.width.get(t),p=2*l*h,y=2*l*g,_=rh(r).nodeBody,x=n.pulse.startColor.get(t),v=n.pulse.endColor.get(t),b=this._modules.graphics.allocateGraphicsEngineBlockId(),S=this._group.reset(dr,!0,_),A=S.nextAndReset(),w=gr(x,i),L=gr(v,i);return A.end.shape="circle",A.end.pieceId=Xi,A.end.x1=o,A.end.y1=a,A.end.x2=o,A.end.y2=a,A.end.rectWidthOrSourceRadiusScaled=u?y:0,A.end.rectHeightOrTargetRadiusScaled=u?y:0,A.end.rectWidthOrSourceRadiusFixed=u?0:y,A.end.rectHeightOrTargetRadiusFixed=u?0:y,A.end.strokeWidthFixed=f,A.end.strokeColor=L,A.start.shape="circle",A.start.pieceId=Xi,A.start.x1=o,A.start.y1=a,A.start.x2=o,A.start.y2=a,A.start.rectWidthOrSourceRadiusScaled=u?p:0,A.start.rectHeightOrTargetRadiusScaled=u?p:0,A.start.rectWidthOrSourceRadiusFixed=u?0:p,A.start.rectHeightOrTargetRadiusFixed=u?0:p,A.start.strokeWidthFixed=f,A.start.strokeColor=w,A.animation.duration=s,A.animation.beginTime=e,this._engine.storeGroup(b,S),b}_createEdgePulseBlock(t,e,s){const n=this._edgeFlexArrays,i=this._nodeFlexArrays,r=n.pulse.startRatio.get(t),o=n.pulse.endRatio.get(t),a=n.pulse.startColor.get(t),l=n.pulse.endColor.get(t),u=rh(n.layer.get(t)).edgeBody,h=this._edgeSourceList.get(t),g=this._edgeTargetList.get(t),f=n.curvature.get(t),p=f!==0,y=this._modules.graphics.allocateGraphicsEngineBlockId(),_=this._group.reset(p?bf:dr,!0,u),x=_.nextAndReset(),v={isSelfLoop:h===g,curvature:f,sourceX:i.x.get(h),sourceY:i.y.get(h),targetX:i.x.get(g),targetY:i.y.get(g),sourceRadius:i.radius.get(h),targetRadius:i.radius.get(g),isSourceRadiusScaled:i.scalingMethod.get(h)==="scaled",isTargetRadiusScaled:i.scalingMethod.get(g)==="scaled",width:n.width.get(t),isWidthScaled:n.scalingMethod.get(t)==="scaled",strokeWidth:n.pulse.width.get(t)};return PA(x.start,v),PA(x.end,v),x.start.strokeColor=a,x.end.strokeColor=l,x.start.thicknessOrFontSizeScaled*=r,x.start.thicknessOrFontSizeFixed*=r,x.end.thicknessOrFontSizeScaled*=o,x.end.thicknessOrFontSizeFixed*=o,x.animation.duration=s,x.animation.beginTime=e,this._engine.storeGroup(y,_),y}pulse(t,e){const s=t.isNode,n={...s?C5:L5,...s?this._nodePulseTheme:this._edgePulseTheme,...e},i=n.number,r=n.interval,o=n.duration,a=s?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,l=(i-1)*r+o;let u;n.enabled=!0,delete n.number,t.setAttributes({pulse:n}),a.setMultiple(t._indexes,i),this._modules.dom.setTimeout((()=>{t.isList?t.filter(hr).setAttribute("pulse.enabled",!1):t.setAttribute("pulse.enabled",!1),a.setMultiple(t._indexes,-1)}),l);const h=new Promise((f=>{u=()=>f(t)})),g=t.isNode?this._nodePromiseMap:this._edgePromiseMap;return t.isList?t._indexes.forEach((f=>{this._setPromise(f,g,h,u)})):this._setPromise(t._index,g,h,u),h}_setPromise(t,e,s,n){e.has(t)&&e.get(t).resolve(),e.set(t,{promise:s,resolve:n})}setTheme(t,e){this._nodePulseTheme=t,this._edgePulseTheme=e}};function PA(t,{sourceX:e,sourceY:s,targetX:n,targetY:i,isSourceRadiusScaled:r,isTargetRadiusScaled:o,targetRadius:a,sourceRadius:l,isWidthScaled:u,width:h,strokeWidth:g,curvature:f,isSelfLoop:p}){t.pieceId=Jf,t.shape="line",t.x1=e,t.y1=s,t.x2=n,t.y2=i,t.rectWidthOrSourceRadiusScaled=r?l:0,t.rectWidthOrSourceRadiusFixed=r?0:l,t.rectHeightOrTargetRadiusScaled=o?a:0,t.rectHeightOrTargetRadiusFixed=o?0:a,t.thicknessOrFontSizeScaled=u?h:0,t.thicknessOrFontSizeFixed=u?0:h,t.strokeWidthFixed=g,t.curvature=f,t.isSelfLoop=p}var M5={duration:0,easing:"linear",callback:as,resolve:as,startAfter:0},k5=0,I5=class extends Xe{constructor(){super(...arguments),this._animationList=[],this._update=()=>{if(this._animationList.length===0)return;const t=Hn(),e=[];for(let s=0;s<this._animationList.length;++s){const n=this._animationList[s],i=(t-n.creationDate)/n.duration,r=n.startAfter;let o=n.easing(i);i>=1?(n.func(1),n.done=!0,n.resolve(void 0),this._animationList.splice(s,1),s-=1,e.push(n.callback)):o>=r&&(o=(o-r)*(1/(1-r)),n.func(o))}for(let s=0;s<e.length;s++)e[s](!1);this._modules.dom.refresh()}}onMounted(){this._modules.events.on("beforeNewFrame",this._update)}play(t,e){const{duration:s,easing:n,callback:i,startAfter:r,resolve:o}=ki(e,M5);if(s<=0)return t(1),i(),o(void 0),null;const a={func:t,easing:typeof n=="function"?n:M0[n],duration:s,callback:i,resolve:o,startAfter:r,creationDate:Hn(),done:!1,id:++k5};return this._animationList.push(a),this._modules.dom.refresh(),a}cancel(t){const e=this._animationList.indexOf(t);e!==-1&&(t.func(1),this._animationList.splice(e,1),t.done=!0,t.resolve(void 0))}},R0=t=>typeof t.export=="function",R5=(t,e,s,n)=>{const i=s._getMapPanePos(),r=t.getMapboxMap(),o=t.getCanvas(),a=t.getSize().round(),l=n.DomUtil.getPosition(t.getContainer()),u=l.x+i.x,h=l.y+i.y;return new Promise((g=>{function f(){e.drawImage(o,u,h,a.x,a.y),g()}if(r.loaded())return f();r.once("idle",f)}))},F5=(t,e,s,n,i)=>{if(R0(t))return t.export(e);const r=s._getMapPanePos(),o=t.getContainer();if(!o)throw new Error(`Trying to access the container of ${t} but it does not exist.`);const a=n.DomUtil.getPosition(o);s.removeLayer(t),t.options.crossOrigin="anonymous";const l=[],u=[];return t.on("tileload",(({tile:h})=>{const{x:g,y:f}=n.DomUtil.getPosition(h);l.push(h),u.push({x:g-a.x+r.x,y:f-a.y+r.y})})),s.addLayer(t),new Promise((h=>{t.once("load",(()=>{const g=t.getTileSize();l.forEach(((f,p)=>{const{x:y,y:_}=u[p];e.drawImage(f,y,_,g.x,g.y)})),h()}))}))},P5=(t,e,s,n,i,r)=>new Promise((o=>{const a=t.options.renderer;s.removeLayer(t),t.options.renderer=r,s.addLayer(t),r._updatePaths();const l=s._getMapPanePos(),u=r._container,h=n.DomUtil.getPosition(u);e.drawImage(r._container,h.x+l.x,h.y+l.y,u.width/i,u.height/i),s.removeLayer(t),t.options.renderer=a,s.addLayer(t),o()})),z5=(t,e,s,n,i)=>new Promise((r=>{if(R0(t))return t.export(e).then(r);const o=s.getPixelBounds().min,a=s.project(t.getLatLng(),s.getZoom());if(!t._icon||t._icon.tagName!=="IMG")return r();const l=/^data:/.test(t._icon.src),u=l?t._icon.src:GN(t._icon.src),h=new Image,g=t.options.icon;if(g){const f=g.options;let p=f.iconSize||[24,24];const y=a.subtract(o);let _=f.iconAnchor||[0,0];Array.isArray(p)||(p=[p.x,p.y]),Array.isArray(_)||(_=[_.x,_.y]);const x=Math.round(y.x-(p[0]-_[0])*i),v=Math.round(y.y-_[1]*i);h.crossOrigin="";const b=()=>{e.drawImage(h,x,v,p[0]*i,p[1]*i),r()};h.onload=b,h.src=u,l&&b()}}));function D5(t){if(t.options.pane==="overlayPane"&&"getElement"in t){const e=t.getElement();return e&&e.tagName.toLowerCase()==="canvas"}return!1}var O5=(t,e,s,n,i)=>new Promise((r=>{const o=t.getElement(),a=o.width,l=o.height;e.drawImage(o,0,0,a,l),r()})),B5=(t,e,s,n,i)=>new Promise((r=>{s.removeLayer(t),t.setUrl(GN(t.getUrl())),t.options.crossOrigin="anonymous",t.once("load",(()=>{const o=t.getBounds(),a=s.latLngToContainerPoint(o.getNorthWest()),l=s.latLngToContainerPoint(o.getSouthEast()),u=l.x-a.x,h=l.y-a.y;e.drawImage(t._image,a.x,a.y,u,h),r()})),s.addLayer(t)}));function GN(t){return t+(t.indexOf("?")===-1?"?":"&")+"noCache="+Date.now()}var U5={tileLayers:F5,imageOverlays:B5,canvasOverlays:O5,vectorLayers:P5,markers:z5,vectorMap:R5};function G5(t,e){return t instanceof e.TileLayer||t.options.pane==="tilePane"&&R0(t)?"tileLayers":D5(t)?"canvasOverlays":t instanceof e.ImageOverlay?"imageOverlays":t instanceof e.Path?"vectorLayers":t instanceof e.Marker?"markers":"MapboxGL"in e&&t instanceof e.MapboxGL?"vectorMap":void 0}function V5(t,e,s,n,i,r){const o={vectorMap:[],tileLayers:[],vectorLayers:[],canvasOverlays:[],imageOverlays:[],markers:[]};return e.eachLayer((a=>{if(a!==t){const l=G5(a,n);if(l&&l in o){const u=U5[l];o[l].push((()=>u(a,s,e,n,i,r)))}}})),o}function j5(t){t.TileLayer.prototype.getUrl=function(){return this._url},t.ImageOverlay.prototype.getUrl=function(){return this._url};const e="leaflet-zoom-animated";t.OgmaOverlay||(t.OgmaOverlay=t.Layer.extend({options:{pane:"overlayPane",padding:0,onUpdate:()=>{}},initialize:function(s){const{container:n}=s;t.Util.setOptions(this,s),this._container=n},setLocked:function(s){return this._locked=s,this},onAdd:function(s){this._map=s,this.getPane().appendChild(this._container),this._wgsOrigin=t.latLng([0,0]),this._wgsInitialShift=s.project(this._wgsOrigin,this._initialZoom),t.DomUtil.addClass(this._container,"leaflet-layer"),this._zoomAnimated&&(t.DomUtil.addClass(this._container,e),this._container.style.position="absolute",this._container.style.zIndex=9999),this._initialZoom=(this._map.getMaxZoom()+this._map.getMinZoom())/2,this._mapInitialZoom=this._map.getZoom(),this._updateBounds(),this._update({})},_updateBounds(){const s=this.options.padding,n=this._map.getSize(),i=this._map.containerPointToLayerPoint(n.multiplyBy(-s));this._bounds=new t.Bounds(i,i.add(n.multiplyBy(1+2*s))),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},_update(s){this._updateBounds(),this._redraw(this._bounds.min,s),this._positionTimer=t.Util.requestAnimFrame((()=>{this._container&&t.DomUtil.setPosition(this._container,this._bounds.min)}))},_redraw(s,n){this.options.onUpdate()},_updateTransform(s,n){if(this._locked)return;const i=this._map.getZoomScale(n,this._zoom),r=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,n),a=r.multiplyBy(-i).add(o).subtract(this._map._getNewPixelOrigin(s,n));t.Browser.any3d?t.DomUtil.setTransform(this._container,a,i):t.DomUtil.setPosition(this._container,a)},_onZoom(s){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_onMoveEnd(s){this._update(s)},_onAnimZoom({center:s,zoom:n}){this._updateTransform(s,n)},bringToFront(){t.DomUtil.toFront(this._container)},getEvents(){return{zoom:this._onZoom,moveend:this._onMoveEnd,zoomanim:this._onAnimZoom,layeradd:this.bringToFront,zoomend:this.options.onUpdate}},onRemove:function(){t.DomUtil.removeClass(this._container,e);const s=this._container;["transform","webkitTransform","OTransform","MozTransform","msTransform","zIndex","position"].forEach((n=>s.style[n]=null)),t.Util.cancelAnimFrame(this._positionTimer),this._container=null}}))}function H5(t,e,s,n){const i=t.filter((L=>L.isVisible())),r=i.size===0,{mapX:o,mapY:a}=i.reduce(((L,M)=>{const{latitude:F,longitude:O}=M.getGeoCoordinates(),{x:G,y:j}=n(F,O);return L.mapX.push(G),L.mapY.push(j),L}),{mapX:[],mapY:[]}),l=i.getAttribute("x"),u=i.getAttribute("y"),h=i.getAttribute("radius").map(Number),g=new ri({xValues:l,yValues:u,scaledSizeValues:h}),f=new ri({xValues:o,yValues:a});r&&(g.cx=g.cy=0,g.width=g.height=0),isFinite(f.width)&&isFinite(f.height)||(f.cx=f.cy=0,f.width=f.height=0);let p=f.cx-g.cx,y=f.cy-g.cy;const _=r?1:Math.max(f.width,f.height)/Math.max(g.width,g.height),[x,v]=h.reduce(((L,M)=>(L[0]=Math.min(L[0],M*_),L[1]=Math.max(L[1],M*_),L)),[1/0,0]);f.pad(v),f.minScaledSize=x,f.maxScaledSize=v;const b=s.computeConfigForBounds(f),S=e.zoom/dP(b.zoom);p+=(g.cx-e.x)*S,y+=(g.cy-e.y)*S;const A=g.cx+p,w=g.cy+y;return{offsetChanges:{name:"graph-to-geo",nodeAttributes:{radius:L=>Number(L.getAttribute("radius"))*S,x:L=>(L.getAttribute("x")+p-A)*S+A,y:L=>(L.getAttribute("y")+y-w)*S+w},edgeAttributes:{width:L=>Number(L.getAttribute("width"))*S}},camera:{zoom:e.zoom/S,x:(e.x+p-A)*S+A,y:(e.y+y-w)*S+w,angle:0,...e.getSize()}}}function $5(t,e,s,n){const i=t.getAttributes(["x","y","radius"]),r=t.getBoundingBox(),o=t.size===0,a=t.reduce(((A,{_index:w},L)=>(A[w]=L,A)),{});n();const l=t.getAttribute("x"),u=t.getAttribute("y"),h=t.getAttribute("radius"),g=new ri({xValues:l,yValues:u,scaledSizeValues:h.map((A=>2*A))});o&&(r.reset(),g.reset());let f=g.cx-r.cx,p=g.cy-r.cy,y=0,_=0;const x=s.computeConfigForBounds(g),v=e.zoom/x.zoom;let b,S;return isNaN(r.cx)||isNaN(r.cy)?(r.cx=e.x,r.cy=e.y,b=x.x,S=x.y):(f+=(r.cx-e.x)*v,p+=(r.cy-e.y)*v,y=r.cx+f,_=r.cy+p,b=(e.x+f-y)*v+y,S=(e.y+p-_)*v+_),{offsetChanges:{name:"geo-to-graph",nodeAttributes:{x:A=>(i[a[A._index]].x+f-y)*v+y,y:A=>(i[a[A._index]].y+p-_)*v+_}},camera:{zoom:x.zoom,x:b,y:S,angle:0,...e.getSize()}}}var VN={"top-left":"left","bottom-left":"left","top-right":"right","bottom-right":"right"},q5={"top-left":"top","bottom-left":"bottom","top-right":"top","bottom-right":"bottom"},zA={position:"bottom-right",horizontalMargin:0,verticalMargin:0,className:void 0},Y5=class extends Xe{onMounted(){this._brand=null}set(t,e){let{position:s,horizontalMargin:n,verticalMargin:i,className:r}={...zA,...e};VN[s]||(s=zA.position),this.remove();const o=document.createElement("div");return bT(o,Vx.sanitize(t)),o.style.position="absolute",jN(o,s,n,i),o.style.zIndex="10",r&&o.setAttribute("class",r),this._brand=o,this._modules.dom.setLayer("brand",this._brand),o}remove(){this._modules.dom.setLayer("brand",null),this._brand=null}};function jN(t,e,s,n){const i=s===void 0?"":s+"px",r=n===void 0?"":n+"px";t.style[VN[e]]=i,t.style[q5[e]]=r}var DA={},W5=class extends Xe{constructor(){super(...arguments),this._enabled=!1,this._settings={...La},this._edgesOriginalTextStyle={},this._nodesOriginalTextStyle={},this._nodeDraggingSetting=!1,this._transition=!1,this._attribution=null,this._updating=!1,this._updateRate=50,this._x=0,this._y=0,this._onCameraUpdate=t=>{if(this.L&&this._enabled&&this._map&&this._map._loaded){const e=this._x-this._modules.camera.x,s=this._y-this._modules.camera.y;(e||s)&&this._syncMapWithCamera()}},this._syncMapWithCamera=()=>{if(!this._map)return;this._updating||(this._updating=!0,this._layer.setLocked(!0),this._map._moveStart(!0,!1));const t=this._fromPointToLatLng(this._modules.camera.x,this._modules.camera.y),e=$m(this._modules.camera.zoom),s=this.L.latLng(t.latitude,t.longitude);this._map._move(s,e,{pinch:!0,round:!1}),clearTimeout(this._updateRequest),this._updateRequest=this._modules.dom.setTimeout((()=>{this._updating=!1,this._layer.setLocked(!1),this._map&&this._map._move(s,e,{pinch:!0})._moveEnd(!0)}),this._updateRate)},this._onNodesDragStart=()=>{this._enabled&&(this._setMapDragging(!1),this._nodeDragOffsetX=this._nodeDragOffsetY=0)},this._onNodesDragged=({nodes:t,dx:e,dy:s})=>{if(this._enabled){const n=t.map((i=>{const{x:r,y:o}=i.getAttributes(["x","y"]);return this._fromPointToLatLng(r+e-this._nodeDragOffsetX,o+s-this._nodeDragOffsetY)}));return this._nodeDragOffsetX=e,this._nodeDragOffsetY=s,t.setGeoCoordinates(n)}return Promise.resolve(this._modules.graph.nodeList())},this._onMapUpdate=()=>{if(!this._map)return Promise.resolve(void 0);const{lat:t,lng:e}=this._map.getCenter(),s=this._fromLatLngToPoint(t,e);this._x=s.x,this._y=s.y;const n=uP(this._map.getZoom());return this._modules.events.fire("beforeGeoCameraMove",{zoom:this._map.getZoom()}),this._modules.camera.setView({zoom:n,x:s.x,y:s.y},{ignoreZoomLimits:!0}).then((()=>this._adjustMinvisibleSizes()))},this.runLayout=async({type:t,nodes:e,latitudePath:s=Cr,longitudePath:n=Lr,options:i,center:r})=>{const o=TP(r),a=o([r.longitude,r.latitude]),l=e.getPosition(),u=[];return e.setAttributes(e.map((h=>{const g=h.getData(s),f=h.getData(n);if(isNaN(g)||isNaN(f))return{x:a[0],y:a[1]};const p=o([f,g]);return{x:p[0],y:p[1]}}))).then((()=>this._ogma.layouts[t]({...i,nodes:e,dryRun:!0}))).then((h=>{const g=h.positions.current,f=new Array(g.length),p=new Array(g.length),y=new Array(g.length).fill(10);g.forEach(((b,S)=>{const A=o.invert([b.x,b.y]);f[S]=A[1],p[S]=A[0],u.push({latitude:A[1],longitude:A[0]})}));const _=wh(p,f,y),x=_[0]-r.longitude,v=_[1]-r.latitude;for(let b=0;b<u.length;b++)f[b]-=v,p[b]-=x,u[b].latitude-=v,u[b].longitude-=x;return e.setData(s,f),e.setData(n,p),e.setAttributes(l)})).then((()=>this._ogma.modules.geo._updateNodesCoordinates(e))).then((()=>u))}}onMounted(){this._modules.events.register(["geoEnabled","beforeGeoDisabled","geoDisabled","geoNodesMoved","geoLoaded","geoReady"]),ME()&&(this.L=Yi("L")||Yi("leaflet"),this.L&&j5(this.L)),this._modules.graph.createNodeAttribute({name:"geo.prevLat",storage:"float"},!0),this._modules.graph.createNodeAttribute({name:Gm,storage:"float"},!0),this._modules.graph.createNodeAttribute({name:Cr,storage:"float"},!0),this._modules.graph.createNodeAttribute({name:Lr,storage:"float"},!0),this._modules.events.register(["beforeGeoCameraMove"]),this._modules.events.on("addNodes",(t=>{t.virtual||this._refreshOrAddNodes(t.nodes,!0)})).on("updateNodeData",(t=>{this._onDataChange(t.changes)})).on("nodesDragProgress",this._onNodesDragged).on(["nodesDragStart","lassoEnabled"],this._onNodesDragStart).on(["nodesDragEnd","lassoDisabled"],(()=>this._setMapDragging(!0))).on("viewChanged",this._onCameraUpdate)}_onDataChange(t){const e=J_(this.latitudePath),s=J_(this.longitudePath),n=t.filter((({virtual:r,property:o,newValues:a})=>!(r||!a.length)&&(o&&typeof o!="string"?o.find((l=>e.startsWith(l)||s.startsWith(l))):o===null||e.startsWith(o)||s.startsWith(o))));if(!n.length)return;const i=EP(n);i&&(this._modules.events.fire("geoNodesMoved",{nodes:i}),this._refreshOrAddNodes(i,!1))}_refreshOrAddNodes(t,e){e&&this._updatePrevNodesCoordinates(t),this._updateNodesCoordinates(t),this._enabled&&(this._cacheOriginalTextStyles(t,null),this._filter.refresh())}_updatePrevNodesCoordinates(t){jc(this._modules.graph,t,Cr,gE),jc(this._modules.graph,t,Lr,Gm)}_restorePrevNodesCoordinates(t){jc(this._modules.graph,t,gE,Cr),jc(this._modules.graph,t,Gm,Lr)}_updateNodesCoordinates(t){xP(this._modules.graph,t,this._settings)}_createMapTileLayer(t,e,s){if(t&&!gn(t))return t;const n=t,i=n.wms?this.L.tileLayer.wms:this.L.tileLayer,r=hP(n,e)||"";return i(n.url,{attribution:r,maxZoom:s,...t})}_setupTileLayer(t,e,s,n){const i=this._createMapTileLayer(t,e,n);return i.once("load",(()=>{this._modules.events.fire("geoLoaded")})),i.addTo(this._map),NE(i,s),i}_onSettingsChanged(t,e){var i;const s=t.wrapCoordinates!==e.wrapCoordinates,n=t.latitudePath!==e.latitudePath||t.longitudePath!==e.longitudePath;if(s||n){let r=Promise.resolve();this._enabled&&this._filter&&(r=r.then((()=>this._filter.refresh()))),r.then((()=>this._updateNodesCoordinates(this._modules.graph.getNodes("all"))))}this._enabled&&(fP(t,e)&&this._map&&(this._map.removeLayer(this._tileLayer),this._tileLayer=this._setupTileLayer(e.tiles,e.attribution,e.opacity,e.maxZoomLevel)),t.sizeRatio!==e.sizeRatio&&this._updateSizes(),t.maxZoomLevel!==e.maxZoomLevel&&(this._modules.settings.update({minZoom:1,maxZoom:Math.pow(2,e.maxZoomLevel)}),(i=this._map)==null||i.setMaxZoom(e.maxZoomLevel),this._tileLayer&&this._tileLayer.options&&(this._tileLayer.options.maxZoom=e.maxZoomLevel)),t.disableNodeDragging!==e.disableNodeDragging&&this._setDragging(!e.disableNodeDragging),t.attributionOptions!==e.attributionOptions&&this._setAttributionOptions(e.attributionOptions,e.attribution),NE(this._tileLayer,e.opacity))}_setMapDragging(t){if(this._map){const e=t?"enable":"disable";this._map.dragging[e]()}}_fromLatLngToPoint(t,e){return this._map.options.crs.latLngToPoint(this.L.latLng(t,e),nf)}_fromPointToLatLng(t,e){const{lat:s,lng:n}=this._map.options.crs.pointToLatLng(this.L.point({x:t,y:e}),nf);return{latitude:s,longitude:n}}_updateSizes(){this._enabled&&this._projection&&this._projection.updateAll()}enable(t){return this.setEnabled(!0,t)}getMap(){return this._enabled?this._map:null}getOptions(){return this._enabled?{...this._settings,tiles:gn(this._settings.tiles)?{...this._settings.tiles}:this._settings.tiles}:{...La}}setOptions(t){if(!this._enabled||this._transition)return;cP(t,this.L);const e=this._settings;this._settings={...La,...e,...t,tiles:gP(La,t)},this._onSettingsChanged(e,this._settings)}disable(t){return this.setEnabled(!1,t)}isEnabled(){return this._enabled}toggle(t={}){return this.setEnabled(!this._enabled,t)}getContainerCoords(t){return t.getGeoCoordinates().map((({latitude:e,longitude:s})=>this._map.latLngToContainerPoint([e,s])))}getContainerCoord(t){const{latitude:e,longitude:s}=t.getGeoCoordinates();return this._map.latLngToContainerPoint([e||0,s||0])}setEnabled(t,e){if(!ME())throw new Error("Ogma Geo cannot be used outside a browser");if(!this.L)throw new Error("You are trying to use Geo mode but Leaflet has not been found. Please follow our migration guide: https://bit.ly/2SYkF8A");if(this._transition||t===this._enabled)return Promise.resolve();const s=this._modules.settings;this._enabled||(this._prevSettings=s.get(),this._nodeDraggingSetting=!!s.get("interactions.drag.enabled")),this._enabled=t,this.setOptions(e),this._transition=!0;const n=this._settings;return t?this._show(e==null?void 0:e.latitude,e==null?void 0:e.longitude,e==null?void 0:e.zoom).then((()=>(this._registerTextStyle(this._modules.graph.getNodes(),this._modules.graph.getEdges()),this._setDragging(!n.disableNodeDragging),this._transition=!1,this._updating=!1,this._modules.events.fire("geoEnabled").fire("geoReady"),this._adjustMinvisibleSizes()))):this._restoreTextStyle().then((()=>this._hide())).then((()=>{this._transition=!1,this._modules.events.fire("geoDisabled"),this._setDragging(this._nodeDraggingSetting,!0)})).then((()=>this._ogma.view.afterNextFrame()))}destroy(){return this._enabled&&this._destroyMapSync(),Promise.resolve()}_cacheOriginalTextStyles(t,e){e&&(this._edgesOriginalTextStyle=IE(e,this._edgesOriginalTextStyle)),t&&(this._nodesOriginalTextStyle=SP(t,this._nodesOriginalTextStyle))}_registerTextStyle(t,e){this._cacheOriginalTextStyles(t,e);const{nodeAttributes:s,edgeAttributes:n}=this._modules.hover.getHoverClassDefinition();this._hoverEdgesOriginalTextStyle=n||null,this._hoverNodesOriginalTextStyle=s||null,this._modules.hover.updateEdgeAttributes({text:{size:i=>(this._edgesOriginalTextStyle[i.getId()]||DA)["text.size"]}}),this._modules.hover.updateNodeAttributes({text:{size:i=>(this._nodesOriginalTextStyle[i.getId()]||DA)["text.size"]}})}_restoreTextStyle(){return this._modules.hover.updateEdgeAttributes(this._hoverEdgesOriginalTextStyle,!0),this._modules.hover.updateNodeAttributes(this._hoverNodesOriginalTextStyle,!0),Promise.all([wP(this._modules.graph.getEdges(),this._edgesOriginalTextStyle)]).then((()=>{this._edgesOriginalTextStyle=IE(this._modules.graph.edgeList(),{}),this._nodesOriginalTextStyle={},this._edgesOriginalTextStyle={}}))}_setDragging(t,e=!1){this._modules.settings.update({interactions:{drag:{enabled:t,applyResult:e}}})}_setAttributionOptions(t,e){if(this._map){if(this._attribution&&(this._attribution.remove(),this._attribution=null),this._attribution=this.L.control.attribution({prefix:!1}).addTo(this._map),gn(t)){this._attribution.setPrefix(""),t.position=t.position||"bottom-right";const s=t.position.replace("-","");this._attribution.setPosition(s);const n=this._attribution.getContainer();n&&(t.className&&this.L.DomUtil.addClass(n,t.className),jN(n,t.position||"bottom-right",t.horizontalMargin,t.verticalMargin))}e!=null&&this._attribution.addAttribution(e)}}_nodeIsVisible(t){return vP(t,this._settings,this._hasCustomProjection())}_updateSettingsForMap(){const t=this._modules.graphics.getGraphicsEngine().parseColor(this._settings.backgroundColor);t[3]=0,this._modules.settings.update({backgroundColor:nC(t),minZoom:1e-6,interactions:{rotation:{enabled:!1},drag:{enabled:!1},pan:{enabled:!1},zoom:{enabled:!1,onDoubleClick:!1}},mouse:{wheelEnabled:!1}})}getGraphPosition(t){const e=this.L.latLngBounds(_P(t));return{center:t.size>0?e.getCenter():this.L.latLng([0,0]),zoom:this._clampZoom(this._map.getBoundsZoom(e))}}_initMap(){this._updateSettingsForMap(),this._mapContainer=mP(this._modules.dom.getContainer());const t={...EF,minZoom:this._settings.minZoomLevel,maxZoom:this._settings.maxZoomLevel};this._hasCustomProjection()&&(t.crs=this._settings.crs,t.worldCopyJump=!1,t.maxBoundsViscosity=0),this._map=new this.L.Map(this._mapContainer,t),this._map.on("movestart zoomstart",(()=>{this._updating=!0})).on("moveend zoomend",(()=>{this._updating=!1})),this._setAttributionOptions(this._settings.attributionOptions,this._settings.attribution),this._setupLayers()}_clampZoom(t){let e=this._tileLayer.options.maxZoom;return e===void 0&&(e=1/0),Math.min(t,e)}_show(t,e,s){let n;return this._initMap(),this._filter?n=this.filter.enable(0):(this._filter=this._modules.transformations.api.addNodeFilter({criteria:i=>this._nodeIsVisible(i)}),this._filter.setIndex(0),n=this._filter.whenApplied()),n.then((()=>{const i=this._map,r=this._modules.graph.getNodes(),o=this._modules.graph.getEdges(),a=this.getGraphPosition(r),l=a.center;t!==void 0&&e!==void 0&&(l.lat=t,l.lng=e);const u=s??a.zoom,{offset:h,newCameraView:g}=this._transformToGeo();return this._modules.camera.setView(g,{ignoreZoomLimits:!0}).then((()=>(this._updatePrevNodesCoordinates(r),i.setView(l,u,{animate:!1}),this._modules.graphics.animate({nodes:r,edges:o},(()=>{this._projection=this._createFinalPositionLayer()}),!0,this._settings.duration)))).then((()=>h.destroy()))}))}updateProjection(){var t;(t=this._projection)==null||t.update()}_hasCustomProjection(){return this._settings.crs!=null}_setupLayers(){this._settings.tiles&&(this._tileLayer=this._setupTileLayer(this._settings.tiles,this._settings.attribution,this._settings.opacity,this._settings.maxZoomLevel)),this._layer=new this.L.OgmaOverlay({container:this._modules.graphics.getDomElement(),mapContainer:this._mapContainer,onUpdate:()=>this._onMapUpdate()}),this._layer.addTo(this._map)}_adjustMinvisibleSizes(){return Promise.all([AP(this._modules.graph.getEdges(),this._edgesOriginalTextStyle,this._map.getZoom())])}_hide(){if(!this._map)return Promise.resolve();this._modules.settings.update(this._prevSettings);const t=this._map;t.removeLayer(this._layer);const e=this._modules.dom.getContainer(),s=this._modules.graphics.getDomElement();e&&e.appendChild(s),t.getContainer().style.zIndex="0";const n=this._modules.graph.getNodes("all"),i=this._modules.graph.getEdges("all"),{offset:r,newCameraView:o}=this._transformToGraph();return this._modules.camera.setView(o||{}).then((()=>(this._modules.events.fire("beforeGeoDisabled"),Promise.all([p2(t.getContainer(),1,0,this._settings.duration/2).then((()=>this._destroyMapSync())),this._modules.graphics.animate({nodes:n,edges:i},(()=>r&&r.destroy()),!0,this._settings.duration)])))).then((()=>(this._map=null,this._filter.disable(0).then((()=>{})))))}_destroyMapSync(){if(this._map){this._layer&&this._layer._map&&this._map.removeLayer(this._layer),this._map.remove(),this._map._animatingZoom=!1,this._map=null;const t=this._mapContainer.parentNode;t&&t.removeChild(this._mapContainer)}}_transformToGeo(){const t=this._modules.graph.getNodes(),{offsetChanges:e,camera:s}=H5(t,this._modules.camera,this._modules.locate,((n,i)=>this._fromLatLngToPoint(n,i)));return{offset:this._addGraphAttributesLayer(e),newCameraView:s}}_addGraphAttributesLayer(t){return this._modules.graphics.addAttributeLayer({priority:Yz,nodeSelector:e=>e.isVisible(),edgeSelector:e=>e.isVisible(),...t})}_transformToGraph(){const t=this._modules.graph.getNodes("all"),{offsetChanges:e,camera:s}=$5(t,this._modules.camera,this._modules.locate,(()=>{this._projection&&(this._projection.destroy(),this._projection=null)}));return{offset:this._addGraphAttributesLayer(e),newCameraView:s}}getPointFromLatLng(t){const{latitude:e,longitude:s}=t.getGeoCoordinates();return e==null?t.getAttributes(["x","y"]):this._fromLatLngToPoint(e,s)}_createFinalPositionLayer(){return this._addGraphAttributesLayer({name:"graph-2-geo-animation",nodeAttributes:{scalingMethod:"fixed",radius:t=>Number(t.getAttribute("radius"))*this._settings.sizeRatio,x:t=>this.getPointFromLatLng(t).x,y:t=>this.getPointFromLatLng(t).y},edgeAttributes:{scalingMethod:"fixed",width:t=>Number(t.getAttribute("width"))*this._settings.sizeRatio}})}setCenter(t,e){return this._enabled?this.setView(t,e,$m(this._modules.camera.getZoom())):Promise.resolve()}setZoom(t){return this._enabled&&this._map?(t=this._clampZoom(t),this._map.setZoom(t),new Promise((e=>{const s=this._map;if(s.getZoom()===t)return e(void 0);s.once("moveend zoomend",e)})).then(this._onMapUpdate)):Promise.resolve()}zoomIn(){return this.setZoom(this.getZoom()+1)}zoomOut(){return this.setZoom(this.getZoom()-1)}setView(t,e,s){if(!this._enabled||!this._map)return Promise.resolve();const n=this._map;s=this._clampZoom(s);const i=this.L.latLng([t,e]);return n.setView(i,s,{animate:!1,reset:!0}),new Promise((r=>{if(n.getZoom()===s&&n.getCenter().equals(i))return r(void 0);n.once("moveend zoomend",r)})).then(this._onMapUpdate)}getView(){if(!this._enabled||!this._map)return;const t=this._map.getCenter();return{zoom:this._map.getZoom(),latitude:t.lat,longitude:t.lng}}getCenter(){if(!this._enabled||!this._map)return;const t=this._map.getCenter();return{latitude:t.lat,longitude:t.lng}}getZoom(){if(this._enabled&&this._map)return this._map.getZoom()}resetCoordinates(){if(!this._enabled||!this._projection)return;const t=this._modules.graph.getNodes();this._restorePrevNodesCoordinates(this._modules.graph.getNodes());const e=this._modules.graph.getNodeAttribute(Cr).getMultiple(t._indexes),s=this._modules.graph.getNodeAttribute(Lr).getMultiple(t._indexes);t.setData(this._settings.latitudePath,e),t.setData(this._settings.longitudePath,s),this._projection.update()}getUnprojectedCoordinates(t){this._projection&&this._projection.destroy();const e=t.getPosition();return this._projection=this._createFinalPositionLayer(),e}get latitudePath(){return this._settings.latitudePath}get longitudePath(){return this._settings.longitudePath}get filter(){return this._filter}exportBackground(t){if(!this._map)return Promise.reject("Map is not ready");const{pixelRatio:e,width:s,height:n,zoom:i,x:r,y:o}=t,a=s*e,l=n*e,u=Pn(a,l),h=u.getContext("2d"),g=this._map;if(!h)throw new Error(`Unable to get 2d context from  ${u}`);const f=this.getView(),p={zoom:Math.round($m(i*e)),...this._fromPointToLatLng(r,o)},y=new this.L.Canvas;g.addLayer(y);const{vectorMap:_,tileLayers:x,vectorLayers:v,canvasOverlays:b,imageOverlays:S,markers:A}=V5(this._layer,g,h,this.L,e,y),w=g.options.zoomSnap;return Promise.resolve().then((()=>(Ha(this._mapContainer,a+"px",l+"px"),g.invalidateSize({animate:!1}),this.setView(p.latitude,p.longitude,p.zoom)))).then((()=>cT([..._,...x,...b,...S,...v,...A]))).then((()=>{Ha(this._mapContainer,"100%","100%"),g.invalidateSize({animate:!1}),g.options.zoomSnap=w,this.setView(f.latitude,f.longitude,f.zoom)})).then((()=>new Promise((L=>this.L.Util.requestAnimFrame(L))))).then((()=>g.removeLayer(y))).then((()=>u))}},X5=class extends Xe{constructor(){super(...arguments),this._context={edgesAlwaysCurvy:!1,edgesRoutingStyle:"none",directedEdges:!1}}onMounted(){this._attributeLayer=this._addAttributeLayer(),this._modules.settings.register("edgesAlwaysCurvy",!1,(t=>{this._context.edgesAlwaysCurvy=t,this._attributeLayer.updateAll()})),this._modules.settings.register("directedEdges",!1,(t=>{this._context.directedEdges=t,this._attributeLayer.updateAll()})),this._modules.settings.register("edgesRoutingStyle","none",(t=>{var i;const e=t&&t!=="none",s=t==="vertical",n=(i=this._ogma.modules)==null?void 0:i.graphics.getGraphicsEngine();n&&n.setBentEdges(e,s),this._attributeLayer.updateAll()}))}computeCurvature(t,e="visible",s){const{edgesAlwaysCurvy:n,directedEdges:i}=this._context,r=t.getSource()===t.getTarget();if(!n&&t.hasParallelEdges()===!1&&!r)return 0;let o=t.getParallelEdges({filter:e});s&&(o=o.filter((u=>s(u))));const a=o.indexOf(t);if(a===-1)return 0;let l;if(r)l=(a+1)*Math.max(+t.getAttribute("width")||0,1);else{const u=t.getSource(),h=o.size;if(h===1&&!n)return 0;if(i){let g=0;for(let f=0;f<a;++f)o.get(f).getSource()===u&&(g+=1);l=g+1}else{const g=u!==o.get(0).getSource();l=h%2!=1||n?(1+(a/2|0))*(a%2==0?1:-1)*(g?-1:1):a===0?0:((a+1)/2|0)*(a%2==0?1:-1)*(g?-1:1)}}return l}_addAttributeLayer(){return this._modules.graphics.addAttributeLayer({name:"curvature",priority:jz,edgeDependencies:{parallelEdges:!0},edgeContext:this._context,edgeAttributes:{curvature:t=>this.computeCurvature(t)}})}};/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Z5(t){if(typeof t!="string"||t.trim()===""){let e="Calls to uncheckedconversion functions must go through security review.";throw e+=" A justification must be provided to capture what security assumptions are being made.",new Error(e)}}function ud(t,e){return Z5(e.justification),Ix(t)}var HN="worker_start",$N="worker_configure",Cf="worker_stop",dh="worker_update",K5=0,qN=class extends Lh{constructor(t,e){super(),this._complete=!1,this._busy=!1,this._destroyed=!1,this._data=null,this._onStart=as,this._onStop=as,this._setIdle=as,this._onPause=as,this.timer={start:0,steps:0},this._modules=e,this._busy=!1,this.id=++K5,this.configure(t)}configure({configure:t=hr,update:e=as,context:s=as,stop:n=as,isRunning:i=ef,onStart:r=as,onStop:o=as,onPause:a=as,setIdle:l=as}){this._configure=t,this._update=e,this._createContext=s,this._isRunning=i,this._stop=n,this._onStart=r,this._onStop=o,this._setIdle=l,this._onPause=a}setData(t){this._data=t}getData(){return this._data}start(t){this.promise=new Promise(((s,n)=>{this.resolve=s,this.reject=n})),this._complete=!1,this._busy=!0,this._onStart(),this.fire(HN,{target:this});const e=this._configure(t,this._modules);return this.fire($N,e),this.send(e),this}stop(t=!0){return this._complete?Promise.resolve():(this._onStop(),t&&this.send({type:Cf}),this.promise.then((()=>{this.fire(Cf,{target:this}),this.clearEvents(),this._complete=!0})))}pause(){this._onPause()}setIdle(t){this._setIdle(t)}isBusy(){return!this._complete||this._busy}setBusy(t){this._busy=t}getPromise(){return this.promise}destroy(){this._destroyed||(this._destroyed=!0,this._modules&&(this._busy&&this.stop(),delete this._modules))}},YN=/^function\s*\(/,WN=/^\(|^\w+\s?=>/,Q5="Layout control code for the worker",dd={justification:Q5};function xg(t){const e=t.toString();return e.indexOf("function")===0||WN.test(e)?e:`function ${e}`}var J5=class extends qN{constructor(t,e){super(t,e);const s=XR([ud(tG(t.imports),dd),sd`\nconst __CONTEXT = (`,ud(xg(this._createContext),dd),sd`)();\nconst __UPDATE_FUNC = `,ud(xg(this._update),dd),sd`\nconst __IS_RUNNING_FUNC = `,ud(xg(this._isRunning),dd),sd`\nconst __STOP_FN = `,ud(xg(this._stop),dd),sd`\nlet result;
      self.addEventListener("message", function (evt) {
        if (evt.data && evt.data.type === 'worker_stop') {
          __STOP_FN(__CONTEXT);
          return self.postMessage({ result, isRunning: false, stopped: true });
        }
        result = __UPDATE_FUNC(evt.data, __CONTEXT);
        const isRunning = __IS_RUNNING_FUNC(__CONTEXT, evt.data);
        self.postMessage({ result, isRunning });
      });
    `]);this._worker=YL(s),this._worker.addEventListener("message",(n=>{e.dom.isDestroyed()||this.onWorkerMessage(n)}))}onWorkerMessage(t){const e=t.data.isRunning,s=t.data.stopped,n={data:void 0},i={worker:this,workerMessage:t.data.result,modules:this._modules,data:n,isRunning:e};if(!s)return e?(this.fire(dh,i),this.send(n.data)):(this.fire(dh,i),this.stop());this.resolve()}destroy(){super.destroy(),this._worker.terminate()}send(t){return this._complete||this._worker.postMessage(qL(t)),this}};function tG(t={}){const e=Object.keys(t),s=[];for(let n=0,i=e.length;n<i;n++){const r=e[n],o=t[r];if(typeof o!="function")throw new Error(`Asynchronous worker: dependency "${r}" is not found`);{const a=eG(o);a?(s.push(OA(o,r)),a!==r&&s.push(`var ${r} = ${a};`)):s.push(`var ${r} = ${OA(o,r)};`)}}return s.join(`
`)}function OA(t,e){const s=t.toString();return YN.test(s)?`function ${t.name||e} ${s.substring(s.indexOf("("))}`:WN.test(s)?`const ${t.name||e} = ${s.toString()}`:s}function eG(t){const e=t.toString();return t.name?t.name:YN.test(e)?null:e.substring(9,e.indexOf("(")).trim()}var sG=class extends qN{constructor(t,e){super(t,e),this._context=this._createContext()}sync(t){if(t&&t.type===Cf)return this._stop(this._context),void this.resolve();const e=this._update(t,this._context),s=this._isRunning(this._context,t),n={data:void 0},i={worker:this,workerMessage:e,modules:this._modules,data:n,isRunning:s};return s?(this.fire(dh,i),this.send(n.data)):(this.fire(dh,i),this.stop())}send(t){return this._complete||this._modules.dom.setTimeout((()=>{this.sync(t)}),0),this}},nG=3,iG=class extends Xe{constructor(){super(...arguments),this._pool={}}create(t,e){const s=e&&$L,n=this._modules,i=`${t.name||"worker"}-${s?"async":"sync"}`;let r=this._pool[i];r||(r=this._pool[i]=[]);let o=r.find((a=>!a.isBusy()));return o?o.configure(t):(o=s?new J5(t,n):new sG(t,n),this._pool[i].push(o)),o.on(Cf,(()=>{this._pool[i].length<=nG||(o.destroy(),this._pool[i]=this._pool[i].filter((a=>a!==o)))})),o}start(t,e){return t.start(e)}run(t,e,s){const n=this.create(t,s);return this.start(n,e)}destroy(){for(const t in this._pool)this._pool[t].forEach((e=>e.destroy())),delete this._pool[t]}};function rG(t,e,s,n=t.getNodes()){if(!e)return s?t.nodeList():n.filter((i=>i.getMetaNode()===null));if(!(e instanceof uo)){if(Array.isArray(e)&&e.length>0)return t.getNodes(e);throw Error("[Layout]: 'nodes' must be a NodeList or an NodeId[]")}return e}function oG(t,e,s=t.getEdges()){if(!e)return s;if(!(e instanceof Ya)){if(Array.isArray(e)&&e.length>0)return t.getEdges(e);throw Error("[Layout]: 'edges' must be a EdgeList or a valid EdgeId[]")}return e}function aG(t){if(!t.size)return;const e=new Set(t.getId());return t.getAdjacentEdges().filter((s=>s.getExtremities().getId().every((n=>e.has(n)))))}function XN(t,e={},s=!0){s||(e.edges=void 0);const n=rG(t,e.nodes,e.edges),i=oG(t,e.edges,aG(n));return{...e,nodes:n.concat(i.getExtremities()).dedupe(),edges:i}}var lG=16,BA="cubicOut",UA={duration:300,locate:!1},uG=new Set(["force"]),dG=class extends Xe{constructor(){super(...arguments),this.resolves=new Map,this._batchMode=!1,this._batchStarted=!1,this._batches=new Map,this._running=[],this._textsHidden=!1,this.onInteractionStart=()=>{this.setWorkersIdle(!0)},this.onViewChanged=()=>{this.setWorkersIdle(!1)},this.onVisibilityChange=()=>{lo().hidden?this.setWorkersIdle(!0):this.setWorkersIdle(!1)},this._onWorkerUpdate=(t,e,s,n,i)=>{const{duration:r,onSync:o,onUpdate:a,dryRun:l,locate:u}=n,h=i.workerMessage,g=i.isRunning;if(o&&this._modules.dom.setTimeout((()=>o(h,this._modules,g)),r),s){const f=s(h,this._modules,g);this._modules.events.fire("layoutComputed",{type:"layoutComputed",name:e,positions:f}),a&&a(h,f,g),this._assignNodePositions(f,r,l,n.easing).then((()=>{g||this._onWorkerComplete(t,f,h,this._layouts[e],n,t.getData())})),g||u&&f&&this._animateCamera(f,u,n.duration)}else g||t.fire("taskComplete",h)},this._onWorkerComplete=(t,e,s,n,i,r)=>{for(let f=0;f<this._running.length;f++)if(this._running[f]===t){this._running.splice(f,1);break}n.onStop&&e&&n.onStop(i,e,this._modules);const o=this._batchMode&&this._batchStarted&&this._batches.get(n.name);if(o){const f=this._batches.get(n.name),p=f.subGraphs,y=f.resolves;let _=0;for(let x=0;x<p.length;x++){const v=y[x],b=p[x].length,S=_,A=new Uint32Array(r.indexes.slice(_,_+b)),w=this._modules.graph.nodeList(A),L=i.dryRun&&e?e:this.collectNodesData(w),M=w.getId(),F={before:hd({...r,indexes:A},S),current:hd({...L,indexes:A},S)};this._modules.events.fire("layoutEnd",{type:"layoutEnd",name:n.name,positions:F,ids:M}),v({name:n.name,positions:F,ids:M}),_+=b}}const a=this._modules.graph.nodeList(new Uint32Array(r.indexes)),l=i.dryRun&&e?e:this.collectNodesData(a),u=a.getId(),h={before:hd(r),current:hd(l)};if(o||this._modules.events.fire("layoutEnd",{type:"layoutEnd",name:n.name,positions:h,ids:u}),i.onEnd&&i.onEnd(s),i.skipTextDrawing&&this._textsHidden&&(this._modules.graphics.showTexts(),this._textsHidden=!1),!this.resolves.has(t))throw new Error("Worker not found");const g=this.resolves.get(t);this.resolves.delete(t),g({name:n.name,positions:h,ids:u}),t.setBusy(!1)},this._onWorkerStart=(t,e,s)=>{e.skipTextDrawing&&!this._textsHidden&&(this._modules.graphics.hideTexts(),this._textsHidden=!0);const n=this._modules.graph.getNodes(e.nodes),i=this.collectNodesData(n),r=i.ids;s.setData(i),this._modules.events.fire("layoutStart",{type:"layoutStart",name:t.name,ids:r,worker:s})}}onMounted(){this._layouts={},this.timers=new Map,this.resolves=new Map,this._modules.events.register(["layoutGetData","layoutPrepare","layoutStart","layoutEnd","layoutComputed"]),this._modules.events.on("clearGraph",(()=>this.stop())).on(["dragStart","zoomStart"],this.onInteractionStart).on(["dragEnd","viewChanged"],this.onViewChanged),this._modules.dom.addDocumentEventListener("visibilitychange",this.onVisibilityChange)}setWorkersIdle(t){this._running.forEach((e=>e.setIdle(t)))}register(t){if(this._layouts[t.name])throw new Error(`Layout ${t.name} already exists`);this._layouts[t.name]=t}getAvailableLayouts(){return Object.keys(this._layouts)}enableBatching(){this._batchMode||(this._batches.clear(),this._batchMode=!0,this._batchStarted=!1)}runBatch(){const t=Array.from(this._batches.keys());return this._batchStarted=!0,Promise.all(t.map((e=>{const s=this._batches.get(e);return s.options.groups=s.subGraphs,this.start(e,s.options)}))).finally((()=>{this._batchStarted=!1,this._batches.clear(),this._batchMode=!1}))}_addToBatch(t,e,s){e.nodes.isList||(e.nodes=this._modules.graph.getNodes(e.nodes));const n=e.nodes.size;if(e.edges.isList||(e.edges=this._modules.graph.getEdges(e.edges)),!this._batches.has(t))return this._batches.set(t,{resolves:[s],subGraphs:[Array.from({length:n}).map(((o,a)=>a))],options:e});const i=this._batches.get(t);i.resolves.push(s);const r=i.options.nodes.size;i.options.nodes=i.options.nodes.concat(e.nodes),i.options.edges=i.options.edges.concat(e.edges),i.options.xs&&e.xs&&(i.options.xs=i.options.xs.concat(e.xs)),i.options.ys&&e.ys&&(i.options.ys=i.options.ys.concat(e.ys)),i.options.rs&&e.rs&&(i.options.rs=i.options.rs.concat(e.rs)),i.subGraphs.push(Array.from({length:n}).map(((o,a)=>a+r)))}start(t,e={}){const s=this._layouts[t];this._modules.events.fire("layoutPrepare",{name:t,params:e});const n=XN(this._modules.graph,e,["radial","grid"].indexOf(t)===-1);return new Promise((i=>{if(!s)throw new Error(`layout ${t} does not exist`);if(this._batchMode&&!this._batchStarted&&uG.has(t))return this._addToBatch(t,n,i);n.duration=typeof n.duration=="number"?n.duration:UA.duration;const r=s.onSync;n.skipTextDrawing=n.skipTextDrawing===void 0?!0:!!n.skipTextDrawing;let o=n.locate||UA.locate;o&&typeof o=="boolean"&&(o={}),n.locate=o;const a={name:t,update:s.update,isRunning:s.isRunning,configure:s.configure,context:s.context,imports:s.imports,stop:s.stop,setIdle:s.setIdle};this._modules.graphics.forceAttributesComputation();const l=n.useWebWorker===void 0?!0:!!n.useWebWorker,u=this._modules.workers.create(a,l);this.resolves.set(u,i),u.on(HN,(()=>{var h;(h=s.onStart)==null||h.call(s,e),this._onWorkerStart(s,n,u)})).on($N,(h=>{this._modules.events.fire("layoutGetData",{name:t,data:h})})).on(dh,(h=>{const g=h.workerMessage,f=g.lastUpdate||-1/0,p=h.isRunning,y=Hn();p&&(!n.continuous||y-f<lG)||(g.lastUpdate=y,this._onWorkerUpdate(u,t,r,n,h))})),this._modules.workers.start(u,n),this._running.push(u)}))}_animateCamera(t,e,s){if(t.indexes.length===0)return Promise.resolve();const n=this._modules.locate.layoutDataBoundingBox(t),i=this._modules.locate.computeConfigForBounds(n,e);return this._modules.camera.setView(i,{duration:s,easing:e.easing||BA,ignoreZoomLimits:!0})}stop(){for(;this._running.length!==0;){const t=this._running.pop();t.stop(),t.fire("taskComplete",null)}return Promise.resolve()}isRunning(){return this._running.length!==0}_assignNodePositions(t,e,s,n=BA){if(!t||s){const u=t?new Uint32Array(t.indexes):void 0,h=this._modules.graph.nodeList(u);return Promise.resolve(h)}const{indexes:i,x:r,y:o}=t,a=this._modules.graph.nodeList(new Uint32Array(i)),l=hd(t);for(let u=0;u<l.length;u++)l[u]={x:r[u],y:o[u]};return a.setAttributes(l,{duration:e,easing:n})}collectNodesData(t){const e=t._indexes,s=this._modules.graph.getNodeAttribute("x").getMultiple(e),n=this._modules.graph.getNodeAttribute("y").getMultiple(e);return{ids:t.getId(),indexes:e,x:s,y:n}}};function hd({x:t,y:e,indexes:s},n=0){const i=s.length,r=new Array(i);for(let o=0;o<i;o++)r[o]={x:t[o+n],y:e[o+n]};return r}function GA(t){return typeof t=="number"&&isNaN(t)}var VA=class{constructor(){this._keys=[],this._values=[]}set(t,e){const s=this._getIndex(t);return s===-1?(this._keys.push(t.slice()),this._values.push(e),!0):(this._values[s]=e,!1)}get(t){const e=this._getIndex(t);return e===-1?void 0:this._values[e]}has(t){return this._getIndex(t)!==-1}delete(t){const e=this._getIndex(t);return e!==-1&&(this._keys.splice(e,1),this._values.splice(e,1),!0)}keys(){return this._keys.map((t=>t.slice()))}values(){return this._values.slice()}_getIndex(t){for(let e=0;e<this._keys.length;e++){const s=this._keys[e];if(s.length===t.length){let n=!0;for(let i=0;i<t.length;i++){const r=s[i],o=t[i];if(!(r===o||GA(r)&&GA(o))){n=!1;break}}if(n)return e}}return-1}get size(){return this._keys.length}},hG=class{constructor(){this._map=new Map,this._arrays=new VA}clear(){return this._arrays=new VA,this._map.clear()}delete(t){return Nn(t)?this._arrays.delete(t):this._map.delete(t)}get(t){return Nn(t)?this._arrays.get(t):this._map.get(t)}set(t,e){return Nn(t)?this._arrays.set(t,e):this._map.set(t,e),this}keys(){return[...iC(this._map),...this._arrays.keys()]}values(){return[...rC(this._map),...this._arrays.values()]}get size(){return this._map.size+this._arrays.size}},cG=class{constructor(t,e,{path:s,filter:n,unwindArrays:i}){this._module=t,this._isNode=e,this._path=s||[],this._filter=n,this._unwindArrays=i,this._onUpdateHandlers=[],this._triggerUpdate=r=>{for(let o=0;o<this._onUpdateHandlers.length;++o)this._onUpdateHandlers[o](r)},this._info=t.watchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}onUpdate(t){this._onUpdateHandlers.push(t)}getPropertyInfo(){return this._info}getPath(){return this._path.slice()}destroy(){this._module.unwatchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}},gG=class{constructor(t,e,{path:s,filter:n,unwindArrays:i}){this._module=t,this._isNode=e,this._path=s,this._filter=n,this._unwindArrays=i,this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[]}get path(){return this._path}onPropertyAdded(t){return this._onAddHandlers.push(t),this}onPropertyRemoved(t){return this._onRemoveHandlers.push(t),this}onPropertyUpdated(t){return this._onUpdateHandlers.push(t),this}getPath(){return this._path.slice()}getProperties(){return this._propertyList.slice()}getPropertyInfo(t){const e=this._properties[t];return e?e.info:null}destroy(){Mr(this._properties,(({handler:e},s)=>{const n=this._path.concat([s]);this._module.unwatchPropertyInformation(this._isNode,n,e,this._filter,this._unwindArrays)})),this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[];const t=this._module._objectPropertyWatchers.indexOf(this);this._module._objectPropertyWatchers.splice(t,1)}updateSubPropertiesToWatch(t,e){if(t!==this._isNode)return;const s=e.getData(this._path);for(let n=0;n<s.length;n++){const i=s[n];if(Ga(i)){const r=Object.keys(i);for(let o=0;o<r.length;o++)this._addSubPropertyToWatch(r[o])}}}_addSubPropertyToWatch(t){if(!this._properties[t]){const e=this._path.concat([t]),s=()=>this._triggerPropertyUpdate(t),n=this._unwindArrays,i=this._isNode,r=this._filter,o=this._module.watchPropertyInformation(i,e,s,r,n);this._properties[t]={handler:s,info:o},this._triggerPropertyUpdate(t)}}_triggerPropertyUpdate(t){const{info:e}=this._properties[t],s=this._propertyList.indexOf(t),n=s!==-1,i=e.getType()!=="undefined";!n&&i?(this._propertyList.push(t),this._triggerHandlers("_onAddHandlers",t,e),this._triggerHandlers("_onUpdateHandlers",t,e)):n&&!i?(this._propertyList.splice(s,1),this._triggerHandlers("_onUpdateHandlers",t,e),this._triggerHandlers("_onRemoveHandlers",t,e)):n&&i&&this._triggerHandlers("_onUpdateHandlers",t,e)}_triggerHandlers(t,e,s){const n=this[t];for(let i=0,r=n.length;i<r;i++)n[i](e,s)}},fG=class{constructor(){}setWatcher(t){this._watcher=t}isNode(){return this._watcher.isNode}getPath(){return this._watcher.property.slice()}getBoundaries(){const t=this._watcher.boundaries;return t?{min:t.min,max:t.max}:null}getValues(){return this._watcher.values.keys()}getValueCount(t){return this._watcher.values.get(t)||0}getCount(){return this._watcher.total}getType(){return this._watcher.any>0?"any":this._watcher.numbers>0?"number":"undefined"}},pG=class extends Xe{constructor(){super(...arguments),this._onExcludedStateChange=({elements:t,value:e})=>{const s=!e;for(let n=0,i=this._propertyWatchers.length;n<i;n++){const r=this._propertyWatchers[n];r.isNode===t.isNode&&r.filter==="visible"&&(s?Nd(r,t.getData(r.property)):Wg(r,t.getData(r.property)),vg(r))}},this._onDataChange=({isNode:t,changes:e})=>{for(let s=0;s<this._propertyWatchers.length;++s){const n=this._propertyWatchers[s],i=n.property,r=n.filter==="all";if(n.isNode===t)for(let o=0;o<e.length;++o){const a=e[o],l=yG(a.property||[],i);if(l){const u=a.nodes||a.edges,h=[],g=[];if(u)for(let f=0;f<u.size;++f){const p=u.get(f);(r||p.isVisible())&&(h.push(Ys(a.newValues[f],l)),g.push(Ys(a.previousValues[f],l)))}h.length&&(Nd(n,h),Wg(n,g),vg(n))}}}for(let s=0,n=this._objectPropertyWatchers.length;s<n;s++){const i=this._objectPropertyWatchers[s],r=i.path;for(let o=0;o<e.length;++o){const{property:a,nodes:l,edges:u}=e[o],h=l||u;if(h){const g=h.isNode;(!a||a.length<=r.length+1&&r.every(((f,p)=>f===a[p])))&&i.updateSubPropertiesToWatch(g,h)}}}},this._onElementsAdded=t=>{const e=t.nodes||t.edges;for(let s=0;s<this._propertyWatchers.length;++s){const n=this._propertyWatchers[s];if(n.isNode===e.isNode){const i=e.getData(n.property);i.length&&(Nd(n,i),vg(n))}}for(let s=0;s<this._objectPropertyWatchers.length;s++)this._objectPropertyWatchers[s].updateSubPropertiesToWatch(e.isNode,e)},this._onElementsRemoved=t=>{const e=t.nodes||t.edges;for(let s=0;s<this._propertyWatchers.length;++s){const n=this._propertyWatchers[s],i=n.filter==="all";if(n.isNode===e.isNode&&i){const r=e.getData(n.property);r.length&&(Wg(n,r),vg(n))}}},this._onGraphClear=()=>{this._propertyWatchers.forEach((t=>{t.numbers=0,t.any=0,t.total=0,t.boundaries=null,t.values.clear()}))}}onMounted(){this._propertyWatchers=[],this._objectPropertyWatchers=[],this._modules.events.on("excludedStateChange",this._onExcludedStateChange).on(["updateNodeData","updateEdgeData"],this._onDataChange).on(["addNodes","addEdges"],this._onElementsAdded).on(["removeNodes","removeEdges"],this._onElementsRemoved).on("clearGraph",this._onGraphClear)}watchNodeObjectProperty(t){return this._watchObjectProperty(!0,bg(t))}watchEdgeObjectProperty(t){return this._watchObjectProperty(!1,bg(t))}watchNodeNonObjectProperty(t){return this._watchNonObjectProperty(!0,bg(t))}watchEdgeNonObjectProperty(t){return this._watchNonObjectProperty(!1,bg(t))}watchPropertyInformation(t,e,s,n,i){const r=this._findWatcher(t,e,n,i)||this._createWatcher(t,e,n,i);return s&&r.onChange.push(s),r.info}unwatchPropertyInformation(t,e,s,n,i){const r=this._findWatcher(t,e,n,i);if(!r)return;const o=r.onChange,a=o.indexOf(s);if(a!==-1&&(o.splice(a,1),o.length===0)){const l=this._propertyWatchers.indexOf(r);this._propertyWatchers.splice(l,1)}}_watchObjectProperty(t,e){const s=new gG(this,t,e);return this._objectPropertyWatchers.push(s),s.updateSubPropertiesToWatch(t,this._modules.graph[t?"getNodes":"getEdges"](e.filter)),s}_watchNonObjectProperty(t,e){return new cG(this,t,e)}_findWatcher(t,e,s,n){for(let i=0;i<this._propertyWatchers.length;++i){const r=this._propertyWatchers[i];if(r.isNode===t&&r.filter===s&&r.unwindArrays===n&&_G(r.property,e))return r}return null}_createWatcher(t,e,s,n){const i={isNode:t,property:e,numbers:0,any:0,total:0,values:new hG,boundaries:null,onChange:[],filter:s,unwindArrays:n,info:new fG};return i.info.setWatcher(i),Nd(i,this._modules.graph[t?"getNodes":"getEdges"](s).getData(e)),this._propertyWatchers.push(i),i}};function jA(t){return t==null?[]:Ua(t)}function mG(t){return t==="all"?"all":"visible"}function vg(t){for(let e=0;e<t.onChange.length;++e)t.onChange[e](t.info)}function _G(t,e){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(t[s]!==e[s])return!1;return!0}function yG(t,e){if(t.length>e.length)return null;let s=0;for(;s<t.length;++s)if(t[s]!==e[s])return null;return e.slice(s)}function Nd(t,e,s){const n=t.values,i=!s&&t.unwindArrays;for(let r=0;r<e.length;++r){const o=e[r];if(s||o===void 0||(t.total+=1),i&&Array.isArray(o))Nd(t,o,!0);else{const a=n.get(o);a?n.set(o,a+1):(n.set(o,1),tp(o)?(t.boundaries?o<t.boundaries.min?t.boundaries.min=o:o>t.boundaries.max&&(t.boundaries.max=o):t.boundaries={min:o,max:o},t.numbers+=1):o!==void 0&&(t.any+=1))}}}function Wg(t,e,s){const n=t.values,i=!s&&t.unwindArrays,r=t.boundaries;let o=!1;for(let a=0;a<e.length;++a){const l=e[a];if(s||l===void 0||(t.total-=1),i&&Array.isArray(l))o=o||Wg(t,l,!0);else{const u=n.get(l);u>1?n.set(l,u-1):(n.delete(l),tp(l)?(t.numbers-=1,!r||r.min!==l&&r.max!==l||(o=!0)):l!==void 0&&(t.any-=1))}}return!s&&o&&(t.boundaries=xG(n.keys())),o}function xG(t){let e=null,s=null;for(let n=0;n<t.length;++n){const i=t[n];tp(i)&&((e==null||i<e)&&(e=i),(s==null||i>s)&&(s=i))}return e==null||s==null?null:{min:e,max:s}}function bg(t){return typeof t!="object"||t===null||Array.isArray(t)?{path:jA(t),filter:"visible",unwindArrays:!1}:{path:jA(t.path),filter:mG(t.filter||"visible"),unwindArrays:!!t.unwindArrays}}var vG=class extends Xe{onMounted(){this._modules.events.register(["virtualDown","virtualUp","virtualMove","virtualClick","virtualDoubleClick","virtualWheel"])}get x(){return this._modules.position.x||0}get y(){return this._modules.position.y||0}_later(){return this._modules.dom.afterNextFrame()}move({x:t,y:e}){if(t!==void 0&&e!==void 0){const s=t-this.x,n=e-this.y;this._modules.events.fire("virtualMove",{x:t,y:e,dx:s,dy:n})}return Promise.resolve()}down({x:t,y:e,button:s="left"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualDown",{x:this.x,y:this.y,button:s}),this._modules.events.fire("virtualMove",{x:this.x,y:this.y,dx:0,dy:0,button:s})}))}up({x:t,y:e,button:s="left"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualUp",{x:t,y:e,button:s})}))}click({x:t,y:e,button:s="left"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualClick",{x:t,y:e,button:s})}))}rightClick({x:t,y:e,button:s="right"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualClick",{x:t,y:e,button:s})}))}doubleclick({x:t,y:e,button:s="left"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualDoubleClick",{x:t,y:e,button:s})}))}drag(t,e){return this.down(t).then((()=>this.move(e))).then((()=>this.up(e)))}wheel({x:t,y:e,dx:s,dy:n,delta:i,metaKey:r,ctrlKey:o}){return this.move({x:t,y:e}).then((()=>(this._modules.events.fire("virtualWheel",{x:t,y:e,dx:s,dy:n,delta:i,domEvent:{metaKey:r,ctrlKey:o}}),this._later())))}};function Ui(t,e,s,n,i,r){const o=bi(),a=r.graphToScreenCoordinates(t),l=r.graphToScreenCoordinates(e);i.beginPath(),i.moveTo(a.x*o,a.y*o),i.lineTo(l.x*o,l.y*o),i.strokeStyle=n,i.lineWidth=s,i.stroke()}function HA(t,e,s,n){let i,r,o,a=0,l=t.length-1;for(;a<l&&a>-1;)if(i=(a+l)/2|0,r=Math.abs(e[t[i]]-s),o=Math.abs(e[t[i+1]]-s),o<r)a=i+1;else if(o>r)l=i;else{const u=Math.abs(e[t[a]]-s),h=Math.abs(e[t[l]]-s);if(u<h)l=i;else{if(!(u>h))return l;a=i+1}}return n?l:t[l]}function $A(t,e,s,n,i,r,o){let a,l,u,h,g,f;for(let p=0,y=t.length;p<y;p++)for(let _=0;_<y;_++){if(p===_)continue;let x=t[p],v=t[_];_<p&&(h=v,v=x,x=h);const b=e[x],S=e[v],A=r.get(x),w=r.get(v);if(b+A<n-i&&S-w>n+i&&Math.abs(Math.abs(b+A-(n-i))-Math.abs(S-w-(n+i)))<=o)return a=x,l=s,u=v,f=b+A+Math.abs(S-w-(b+A))/2,g=[b+A,f-i,f+i,S-w],{a,b:l,c:u,current:s,target:f,points:g};if(b+A<n-i&&S+w<n-i&&Math.abs(Math.abs(b+A-(S-w))-Math.abs(Math.max(b+A,S+w)-(n-i)))<=o)return a=x,l=v,u=s,f=S+A+Math.abs(Math.abs(b+A-(S-w)))+i,g=[b+A,S-w,S+w,f-i],{a,b:l,c:u,current:s,target:f,points:g};if(b-A>n+i&&S-w>n+i&&Math.abs(Math.abs(b+A-(S-w))-Math.abs(Math.min(b-A,S-w)-(n+i)))<=o)return a=s,l=x,u=v,f=b-A-Math.abs(Math.abs(b+A-(S-w)))-i,g=[f+i,b-A,b+A,S-w],{a,b:l,c:u,current:s,target:f,points:g}}return null}var __={enabled:!1,tolerance:5,centerSnapDistance:240,sideSnapDistanceFactor:3,guidelineWidth:1,guidelineColor:"#ff0000",preferredDistance:{enabled:!0,ratio:1.13,tolerance:10,lineColor:"#00C3FF",lineWidth:1},neighbours:{enabled:!0,offset:5,tolerance:3,lineColor:"#00C3FF",lineWidth:1}},bG=class extends Xe{constructor(){super(...arguments),this._options=Zs(__),this._enabled=!1,this._ysnap=0,this._xsnap=0,this._node=null,this._nodes=null,this._r=0,this._vguideline={start:{x:0,y:0},end:{x:0,y:0}},this._hguideline={start:{x:0,y:0},end:{x:0,y:0}},this._gridResolution=0,this._onNodeDragStart=({nodes:t})=>{t.size===1&&(this._node=t.get(0),this._cacheViewportData(),this._r=Number(this._node.getAttribute("radius")))},this._onNodeDragEnd=()=>{this._node=null,this._layer.refresh()}}onMounted(){this._options=Zs(__),this._enabled=!1}enable(t){this._enabled||(this._options=ki(t,__),this._enabled=!0,this._layer=this._modules.layers.addCanvasLayer((e=>{e.clearRect(0,0,e.canvas.width,e.canvas.height)}),{isStatic:!0,noClear:!1}),this._layer.moveToTop(),this._modules.events.on("nodesDragStart",this._onNodeDragStart).on("nodesDragEnd",this._onNodeDragEnd),this._modules.settings.update({"interactions.drag.onBeforeDrag":(e,s,n,i)=>this._onBeforeDrag(s,n,i)}))}disable(){this._enabled&&(this._modules.events.off(this._onNodeDragStart).off(this._onNodeDragEnd),this._layer.destroy(),this._modules.settings.update({"interactions.drag.onBeforeDrag":null}),this._enabled=!1)}enabled(){return this._enabled}_onBeforeDrag(t,e,s){if(this._node){const n=s[0];this._layer.refresh((i=>{this._scan(i,n)})),this._node.setAttributes(n)}}_cacheViewportData(){const t=this._modules.camera,e=t.screenToGraphCoordinates({x:0,y:0}),s=t.screenToGraphCoordinates({x:t.width,y:t.height});if(this._nodes=this._modules.spatial.getNodesByBoundingBox(e.x,e.y,s.x,s.y),this._node==null)return;const n=this._node._index,i=Array.from(this._nodes._indexes);i.splice(i.indexOf(n),1);const r=this._modules.graph.getNodeAttribute("radius"),o=this._modules.graph.getNodeAttribute("x"),a=this._modules.graph.getNodeAttribute("y"),l=o.buffer(),u=a.buffer(),h=_d(i.slice(),o),g=_d(i.slice(),a),f={},p={};this._gridResolution=Number(this._node.getAttribute("radius"));const y=this._gridResolution;for(let _=0,x=i.length;_<x;_++){const v=h[_],b=g[_],S=l[v]/y|0,A=u[b]/y|0;f[S]||(f[S]=[]),p[A]||(p[A]=[]),f[S].push(v),p[A].push(b)}this._nodesByX=h,this._nodesByY=g,this._xGrid=f,this._yGrid=p,this._xList=o,this._yList=a,this._X=l,this._Y=u,this._R=r}_scan(t,e){if(this._node==null)return;const s=this._node._index,n=e.x,i=e.y,r=this._r,o=this._options,a=this._xList,l=this._yList,u=this._R,h=this._X,g=this._Y,f=this._modules.camera.zoom,p=Math.min(r,this._options.tolerance/f),y=2*r*o.sideSnapDistanceFactor,_=o.guidelineWidth,x=o.guidelineColor;let v,b,S,A,w,L,M,F,O=s,G=s,j=null,Z=!1,at=!1;if(O=HA(this._nodesByX,h,n),G=HA(this._nodesByY,g,i),Math.abs(h[O]-n)>o.centerSnapDistance&&(O=s),Math.abs(g[G]-i)>o.centerSnapDistance&&(G=s),this._xsnap=0,O!==s){v=this._vguideline.start,b=this._vguideline.end,F=O,S=h[F],A=g[F],j=u.get(F),M=Math.abs(n-S);const pt=Math.abs(n-r-(S-j)),K=Math.abs(n+r-(S+j));if(M<Math.max(r,j)){A<i?(v.y=A-j,b.y=i+r):(v.y=A+j,b.y=i-r);const ut=Math.min(pt,M,K);ut===M?(v.x=b.x=S,b.y=i,v.y=A,this._xsnap=1):Math.abs(i-A)<j+r+y&&(ut===pt?(v.x=b.x=S-j,this._xsnap=2):(v.x=b.x=S+j,this._xsnap=3)),ut<p&&(Z=!0)}this._xsnap!==0&&Ui(v,b,_,x,t,this._modules.camera)}if(this._ysnap=0,G!==s){v=this._hguideline.start,b=this._hguideline.end,F=G,S=h[F],A=g[F],j=u.get(F),M=Math.abs(i-A);const pt=Math.abs(i-r-(A-j)),K=Math.abs(i+r-(A+j));if(M<Math.max(r,j)){S<n?(v.x=S-j,b.x=n+r):(v.x=S+j,b.x=n-r);const ut=Math.min(pt,M,K);ut===M?(v.y=b.y=A,b.x=n,v.x=S,this._ysnap=1):Math.abs(n-S)<j+r+y&&(ut===pt?(v.y=b.y=A-j,this._ysnap=4):(v.y=b.y=A+j,this._ysnap=5)),ut<p&&(at=!0)}this._ysnap!==0&&Ui(v,b,_,x,t,this._modules.camera)}if(j!=null&&o.preferredDistance.enabled){const pt=o.preferredDistance.ratio,K=Math.min(o.preferredDistance.tolerance/f,r),ut=Math.max(r,j);if(O===s||this._xsnap!==0&&Z){if(G!==s&&(this._ysnap===0||!at)&&(F=G,S=h[F],A=g[F],j=u.get(F),L=Math.abs(i-A)-(r+j)*(1+pt),L<=K&&L>=-K)){const ht=i<A?-1:1;v=this._hguideline.start,b=this._hguideline.end,v.x=S-ut,b.x=S+ut,v.y=b.y=A,Ui(v,b,_,x,t,this._modules.camera),v.x=n-ut,b.x=n+ut,v.y=b.y=A+ht*(1+pt)*(r+j),Ui(v,b,_,x,t,this._modules.camera),this._ysnap=1,at=!0}}else if(F=O,S=h[F],A=g[F],j=u.get(F),w=Math.abs(n-S)-(r+j)*(1+pt),w<=K&&w>=-K){const ht=n<S?-1:1;v=this._vguideline.start,b=this._vguideline.end,v.x=b.x=S+ht*(1+pt)*(r+j),v.y=A-ut,b.y=A+ut,v.x=b.x=S,Ui(v,b,_,x,t,this._modules.camera),v.y=i-ut,b.y=i+ut,v.x=b.x=S+ht*(1+pt)*(r+j),Ui(v,b,_,x,t,this._modules.camera),this._xsnap=1,Z=!0}}if(o.neighbours.enabled){const pt=this._gridResolution,K=n/pt|0,ut=i/pt|0,ht=this._xGrid,nt=this._yGrid,ot=[],Mt=[].concat(nt[ut-1]||ot,nt[ut]||ot,nt[ut+1]||ot),Q=[].concat(ht[K-1]||ot,ht[K]||ot,ht[K+1]||ot);let Et;Mt.length>1&&(_d(Mt,a),Et=$A(Mt,h,s,n,r,u,p),Et&&(this._drawNeighbourGuidelines(t,Et,e,!1),Z=!1)),Q.length>1&&!Et&&(_d(Q,l),Et=$A(Q,g,s,i,r,u,p),Et&&(this._drawNeighbourGuidelines(t,Et,e,!0),at=!1))}(Z||at)&&this._snap(e,!Z,!at)}_drawNeighbourGuidelines(t,{a:e,b:s,c:n,points:i,target:r},o,a){const l={x:0,y:0},u={x:0,y:0},h=this._R,g=this._X,f=this._Y;let[p,y,_]=h.getMultiple([e,s,n]);const{offset:x,lineWidth:v,lineColor:b}=this._options.neighbours;let S,A;a?(o.y=r,p=-p,y=-y,_=-_,S=u.x=l.x=Math.min(g[e]+p,g[s]+y,g[n]+_)-x,A=g):(o.x=r,S=u.y=l.y=Math.max(f[e]+p,f[s]+y,f[n]+_)+x,A=f);const w=a?"y":"x",L=a?"x":"y";l[w]=i[0],u[w]=i[1],Ui(l,u,v,b,t,this._modules.camera),l[w]=i[2],u[w]=i[3],Ui(l,u,v,b,t,this._modules.camera),l[w]=i[0],l[L]=S-x/2,u[w]=i[0],l[L]=A[e]+p,Ui(l,u,v,b,t,this._modules.camera),l[w]=i[1],l[L]=S-x/2,u[w]=i[1],l[L]=A[s]+y,Ui(l,u,v,b,t,this._modules.camera),l[w]=i[2],l[L]=S-x/2,u[w]=i[2],l[L]=A[s]+y,Ui(l,u,v,b,t,this._modules.camera),l[w]=i[3],l[L]=S-x/2,u[w]=i[3],l[L]=A[n]+_,Ui(l,u,v,b,t,this._modules.camera)}_snap(t,e,s){const n=this._xsnap,i=this._ysnap;let r;e||n===0||(r=this._vguideline.end,t.x=n===2?r.x+this._r:n===3?r.x-this._r:r.x),s||i===0||(r=this._hguideline.end,t.y=i===4?r.y+this._r:i===5?r.y-this._r:r.y)}},EG=class{constructor(t,e,s){this._module=t,this._id=e,this._whenApplied=s.then((()=>this))}getId(){return this._id}whenApplied(){return this._whenApplied}refresh(){return this._module.refreshRule(this._id)}getIndex(){return this._module.getRuleIndex(this._id)}setIndex(t){return this._module.setRuleIndex(this._id,t)}update(t){return this._module.updateRule(this._id,t)}getDefinition(){return this._module.getRuleDefinition(this._id)}destroy(){return this._module.destroyRule(this._id)}},SG=1e3,AG=1/SG,wG=class extends Xe{constructor(){super(...arguments),this._idCounter=1,this._rules=[]}onMounted(){this._rules=[],this._modules.events.register(["addStyleRule","removeStyleRule","updateStyleRule","refreshStyleRule"])}_get(t){for(let e=0;e<this._rules.length;++e){const s=this._rules[e];if(s.id===t)return s.index=e,s}throw new Error("calling a method on a destroyed style rule")}_updatePriorities(){for(let t=0;t<this._rules.length;++t){const e=this._rules[t],s=Hz+t*AG;e.attributeLayer.update({priority:s})}}addRule(t={}){const e=this._idCounter++,s=this._modules.graphics.addAttributeLayer({name:`rule(${e})`,...qA(t)}),n=this._modules.dom.afterNextFrame(),i=new EG(this,e,n),r={id:e,attributeLayer:s,wrapper:i};return this._rules.push(r),this._updatePriorities(),this._modules.events.fire("addStyleRule",{rule:r,options:t,id:r.id}),i}getRuleIndex(t){const e=this._get(t);return e.index==null?null:e.index}setRuleIndex(t,e){const s=this._get(t),n=Wi(e,0,this._rules.length-1);return this._rules.splice(s.index,1),this._rules.splice(n,0,s),this._updatePriorities(),this._modules.dom.afterNextFrame()}updateRule(t,e){const s=this._get(t),n=Object.assign({fullOverwrite:e.fullOverwrite},e);return s.attributeLayer.update(n),this._modules.events.fire("updateStyleRule",{rule:s,options:e}),this._modules.dom.afterNextFrame()}getRuleDefinition(t){return qA(this._get(t).attributeLayer.getDefinition())}destroyRule(t){const e=this._get(t);return this._modules.events.fire("removeStyleRule",{rule:e,id:e.id}),e.attributeLayer.destroy(),this._rules.splice(e.index,1),this._modules.dom.afterNextFrame()}refreshRule(t){const e=this._get(t);return e.attributeLayer.updateAll(),this._modules.events.fire("refreshStyleRule",{rule:e,id:t}),this._modules.dom.afterNextFrame()}refreshAllRules(){for(const t of this._rules)t.attributeLayer.updateAll(),this._modules.events.fire("refreshStyleRule",{rule:t,id:t.id});return this._modules.dom.afterNextFrame()}getRuleList(){return this._rules.map((t=>t.wrapper))}};function qA(t){return{nodeAttributes:t.nodeAttributes,edgeAttributes:t.edgeAttributes,nodeSelector:t.nodeSelector,edgeSelector:t.edgeSelector,nodeDependencies:t.nodeDependencies,edgeDependencies:t.edgeDependencies,nodeOutput:t.nodeOutput,edgeOutput:t.edgeOutput}}var tx,YA={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:({nodes:t})=>t.setSelected(!0),bothExtremities:!1},ZN=class extends Xe{constructor(){super(...arguments),this._enabled=!1,this._points=[],this._bbox=new ri,this._onStart=({x:t,y:e})=>{this._bbox.reset(),this.savePoint(t,e,!1)},this._onStop=()=>{const{minX:t,minY:e,maxX:s,maxY:n}=this._bbox,{nodes:i,edges:r}=this._modules.spatial.queryProjected(t,e,s,n),o={},a=i.filter((h=>{const g=h.isVisible(),f=h.getAttribute("detectable"),p=g&&f&&this._modules.locate.isNodeInPolygon(h,this._points);return o[h._index]=p,p}));let l=r.filter((h=>{const g=h.isVisible(),f=h.getAttribute("detectable");return g&&f&&this._modules.locate.isEdgeInPolygon(h,this._points)}));this._options.bothExtremities&&(l=this.filterByExtremities(l,o)),this._layer.clear();const u=this._points.slice();this._points=[],this.disable(),this._options.callback({nodes:a,edges:l,points:u})}}onMounted(){this._options=Zs(YA),this._cachedCursor="",this._modules.events.isRegistered("lassoEnabled")||this._modules.events.register(["lassoEnabled","lassoDisabled"]),this._interaction=this._modules.interactions.onDrag({priority:"lasso",check:()=>this._enabled,onStart:this._onStart,onProgress:({x:t,y:e})=>this.savePoint(t,e,!0),onStop:this._onStop})}enable(t={}){var e;return this._enabled||(this._enabled=!0,this._modules.captor.setDetectionEnabled(!1),this._options=ki(t,YA),this._layer=this._modules.layers.addCanvasLayer(as,{isStatic:!0,noClear:!1}),this._layer.moveToTop(),this._cachedCursor=((e=this._layer.element.parentElement)==null?void 0:e.style.cursor)||"",hf(this._layer.element.parentElement,this._options.cursorStyle),this._modules.captor.isLeftPressed()&&this._interaction.start(this._modules.captor.getCursorPosition()),this._modules.events.fire("lassoEnabled")),this}disable(){return this._enabled?(this._enabled=!1,this._modules.captor.setDetectionEnabled(!0),hf(this._layer.element.parentElement,this._cachedCursor),this._layer.destroy(),this._modules.events.fire("lassoDisabled"),this):this}enabled(){return this._enabled}savePoint(t,e,s){const n=bi(),i=this._options,r=this._points;if(this._bbox.addPoint(t,e),r.push({x:t,y:e}),s){const o=r[0];this._layer.refresh((a=>{a.lineWidth=i.strokeWidth,a.lineJoin="bevel",a.strokeStyle=i.strokeColor,a.fillStyle=i.fillColor,a.beginPath(),a.moveTo(o.x*n,o.y*n);for(let l=1;l<r.length;++l){const u=r[l];a.lineTo(u.x*n,u.y*n)}a.stroke(),i.fillColor&&a.fill()}))}}filterByExtremities(t,e){const s=this._modules.graph.getEdgeAttribute("source"),n=this._modules.graph.getEdgeAttribute("target");return t.filter((i=>{const r=i._index,o=s.get(r),a=n.get(r);return e[o]&&e[a]}))}},WA={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:({nodes:t,edges:e})=>{t.size?t.setSelected(!0):e.setSelected(!0)},bothExtremities:!1},TG=class extends ZN{constructor(){super(...arguments),this._onStart=({x:t,y:e})=>{var s;this._rectangle.reset(),this._start={x:t,y:e},(s=this._layer)==null||s.refresh((n=>{n.fillStyle=this._options.fillColor,n.strokeStyle=this._options.strokeColor,n.lineWidth=this._options.strokeWidth}))},this._onStop=()=>{var a;const t=this._modules.captor.getCursorPosition(),e=this._formatRectangle(t),{nodes:s,edges:n}=this._modules.spatial.queryProjected(e.minX,e.minY,e.maxX,e.maxY),i={},r=s.filter((l=>{const u=l.isVisible(),h=l.getAttribute("detectable"),g=u&&h&&this._modules.locate.isNodeInRectangle(l,e);return i[l._index]=g,g}));let o=n.filter((l=>{const u=l.isVisible(),h=l.getAttribute("detectable");return u&&h&&this._modules.locate.isEdgeInRectangle(l,e)}));this._options.bothExtremities&&(o=this.filterByExtremities(o,i)),(a=this._layer)==null||a.clear(),this.disable(),this._options.callback({nodes:r,edges:o,rectangle:{minX:e.minX,minY:e.minY,maxX:e.maxX,maxY:e.maxY,width:e.width,height:e.height,cx:e.cx,cy:e.cy}})}}onMounted(){this._options=Zs(WA),this._enabled=!1,this._rectangle=new ri,this._interaction=this._modules.interactions.onDrag({priority:"lasso",disableDetection:!0,check:()=>this._enabled,onStart:this._onStart,onProgress:({x:t,y:e})=>this._refreshRectangle({x:t,y:e}),onStop:this._onStop})}enable(t){return super.enable(ki(t,WA))}_formatRectangle(t){const e=this._start.x,s=this._start.y,n=t.x,i=t.y,r=Math.abs(e-n),o=Math.abs(s-i),a=e<n?e:n,l=s<i?s:i;return this._rectangle.reset().addPoint(a,l).addPoint(a+r,l+o)}_refreshRectangle(t){var o;const{minX:e,minY:s,width:n,height:i}=this._formatRectangle(t),r=bi();(o=this._layer)==null||o.refresh((a=>{a.strokeRect(e*r,s*r,n*r,i*r),this._options.fillColor&&a.fillRect(e*r,s*r,n*r,i*r)}))}},CG=oT(aT()),Tr=6,KN=5,$d=1,QN=0,JN=0,ex=-1;function tM(t,e,s,n){QN=t,tx=s,JN=e?1:0,ex=n}var XA=(t,e,s,n)=>i=>{const{rects:r,bboxes:o,intersects:a,indexToLayer:l,indexToRemoveNodeText:u,indexToRemoveEdgeText:h}=n;if(o[i*Tr+5]===QN&&o[i*Tr+4]===s)return!1;const g=i*KN,f=Rh(r[g],r[g+1],r[g+2],r[g+3],r[g+4]);if(lL(tx,f)){if(n.realIntersection=!0,ex<=0&&a.push(tx,f),!(l[o[i*Tr+5]]<ex))return!0;t.remove(i),n.realIntersection=!1,o[i*Tr+4]===JN?u[o[i*Tr+5]]=!0:h[o[i*Tr+5]]=!0}return!1};function ZA(t,e,s="#22ff00"){return sx([[t[0],t[1]],[t[2],t[1]],[t[2],t[3]],[t[0],t[3]]].map((n=>({x:n[0],y:n[1]}))),e,s)}function sx(t,e,s="#ff0000"){e.strokeStyle=s,e.beginPath();for(let n=0,i=t.length;n<i;n++)n===0?e.moveTo(t[n].x,t[n].y):e.lineTo(t[n].x,t[n].y);e.closePath(),e.stroke()}function LG(t,e,s,n,i){for(let a=0,l=e.length;a<l;a+=Tr)ZA(e.slice(a,a+4),t,"#aaaaaa");for(let a=0;a<s.length;a+=KN)sx(Rh(s[a],s[a+1],s[a+2],s[a+3],s[a+4]),t,"green");const r=[i.root];let o=i.root;for(;o=r.pop();)o.leaf||r.push.apply(r,o.children),ZA(i.getNodeBounds(o),t,"rgba(0,0,0,0.2)"),o=r.pop();n.forEach((a=>sx(a,t,"red")))}var cd={x1:0,y1:0,x2:0,y2:0},y_={x:0,y:0},Fl={x:0,y:0},NG=Math.PI/2,MG=0;function kG(t,e,s,n,i,r,o,a,l,u,h){const g=a.remove.nodes,f=a.remove.edges,p=a.redraw.edges,y=s.angle,_=s.zoom,x=i.x,v=i.y,b=i.radius,S=Math.PI,{source:A,target:w,scalingMethod:L}=n,M=n.width,F=n.curvature,O=n.layer,G=n.text.content,j=n.text.scaling,Z=n.text.size,at=n.text.font,pt=n.text.style,K=n.text.scale,ut=n.text.maxLineLength,ht=n.text.margin,nt=n.text.minVisibleSize,ot=n.text.padding,Mt=n.animationDuration,Q=n.text.adjustAngle,Et=n.text.position;a.indexToLayer={},a.indexToQuadIndex={},a.indexToRemoveNodeText={},a.indexToRemoveEdgeText={},a.indexToRedrawEdgeText={},a.byLayer=[];const{byLayer:Xt,indexToLayer:Ht,indexToQuadIndex:Zt,indexToRedrawEdgeText:ae,indexToRemoveNodeText:pe,indexToRemoveEdgeText:ne}=a;for(let ge=0;ge<t.length;ge++){const ze=t[ge],is=O.get(ze)-Z2;for(let Ge=1;Ge<=is;Ge++)(Xt[Ge]=Xt[Ge]||[]).push(ze);Ht[ze]=is}if(l!==null){const ge=Xt.length;for(let ze=Ht[l]+1;ze<=ge;ze++)(Xt[ze]=Xt[ze]||[]).unshift(l);Ht[l]=ge}const te=[0,0,0,0],se=[0,0,0,0,0],{bboxes:ce,rects:Ce}=a,ve=(ge,ze=-1)=>{const is=Mt.get(ge);let Ge=G?G.get(ge):"";if(Ge===null||Ge===""||is)return!1;const De=A.get(ge),He=w.get(ge);let Je=M.get(ge);const ss=F.get(ge),ts=nt.get(ge);if(Je*_<ts)return ne[ge]=!0,!1;L.get(ge)==="fixed"&&(Je/=_);let hs=(x.get(De)+x.get(He))/2,Fe=(v.get(De)+v.get(He))/2;Ge=Ge?Ge.toString():"";const Oe=!j.get(ge),Ns=K.get(ge)*(Oe?1:_),zs=at.get(ge),$s=(Oe?Z.get(ge):Ns*Je)*$d,Ms=pt.get(ge),An=ut.get(ge),fn=Et.get(ge)===Mh;let un=+fn*ht.get(ge)+n.text.padding.get(ge);const xs=x.get(De),Ds=v.get(De),gt=x.get(He),k=v.get(He),P=b.get(De),D=b.get(He);if(ss===0){const Ut=gu(xs,Ds,gt,k)-y,he=P-D;hs+=he*Math.cos(Ut)/2,Fe+=he*Math.sin(Ut)/2}let B;const $=De===He;if($)B=S/4-y,np(xs,Ds,ss,P,0,cd),ih(.5,xs,Ds,gt,k,cd.x1,cd.y1,cd.x2,cd.y2,Fl),hs=Fl.x,Fe=Fl.y,un/=-_;else{if(xs===gt&&Ds===k)return!1;B=gu(xs,Ds,gt,k)-y,ss!==0&&(Wa(xs,Ds,gt,k,ss,y_),rp(.5,xs,Ds,gt,k,y_.x,y_.y,Fl),hs=Fl.x,Fe=Fl.y)}const H=un+MG,X=SC(Ge,An);if(!X)return!1;const{lines:lt,data:dt}=X;let ct=r(dt[0],zs,Ms,$s).width*$d;for(let Ut=1;Ut<lt;Ut++)ct=Math.max(ct,r(dt[Ut],zs,Ms,$s).width*$d);const mt=lt*$s,yt=ct/_/2,Nt=mt/_/2,Tt=Math.abs(cf(B))<NG?1:-1;let At=fn?$?mt/_+Je/2+un:Tt*(H/_+Je/2+Nt):0;if(!$&&ss===0&&Q.get(ge)){const Ut=ot.get(ge);_n(xs,Ds,gt,k)*_-(P+D)*(h?1:_)<ct+2*Ut+1&&(At*=Tt,B=0)}if(se[0]=hs-yt,se[1]=Fe-Nt,se[2]=hs+yt,se[3]=Fe+Nt,se[4]=B+y,Jy(se,-(B+y),-At,se),se[2]=se[2]-se[0],se[3]=se[3]-se[1],B=S-B-y,dp(hs-yt,Fe-Nt,2*yt,2*Nt,B,void 0,void 0,te),Jy(te,B,At,te),a.realIntersection=!1,tM(ge,!1,Rh(se[0],se[1],se[2],se[3],se[4]),ze),e.traverse(te[0],te[1],te[2],te[3],u),a.realIntersection&&!o)return ne[ge]=!0,!1;if(ae[ge]=!0,pe[ge]=!1,ze<=0){const Ut=ce.length/Tr;Zt[ge]=Ut,ce.push(te[0],te[1],te[2],te[3],0,ge),e.insert(Ut,te[0],te[1],te[2],te[3]),Ce.push(se[0],se[1],se[2],se[3],se[4])}else e.insert(Zt[ge],te[0],te[1],te[2],te[3])};for(const ge of t)ve(ge);let Me=!0;for(let ge=0;ge<Xt.length;ge++){const ze=Xt[ge];if(ze)if(Me)Me=!1;else for(const is of ze)ve(is,ge)}for(let ge=0;ge<t.length;ge++){const ze=t[ge];pe[ze]?g.push(ze):ae[ze]&&p.push(ze),ne[ze]&&f.push(ze)}return a}var IG={left:-1,right:1,top:0,bottom:0,center:0},RG={left:0,right:0,top:-1,bottom:1,center:0},FG={left:-1,right:0,top:-.5,bottom:-.5,center:-.5},PG={left:-.5,right:-.5,top:-1,bottom:0,center:-.5},zG=(t,e,s)=>SC(e,s.get(t))||{lines:0,data:[" "],maxLength:1},DG=(t,e,s,n,i,r,o)=>{const{lines:a,data:l}=zG(t,e,n);let u=s(l[0],i,r,o).width;for(let h=1;h<a;h++)u=Math.max(u,s(l[h],i,r,o).width);return[u,a*o*$d]},OG=(t,e,s)=>{const n=e.text.content,i=e.radius,r=e.text.scaling,o=e.text.position,a=e.text.padding,l=e.text.scale,u=e.text.size,h=e.text.style,g=e.text.font,f=e.text.maxLineLength,p=e.text.margin,y=n.get(t),_=i.get(t),x=!r.get(t),v=o.get(t),b=a.get(t),S=l.get(t),A=(x?u.get(t):S*_*2)*$d,w=h.get(t),L=g.get(t),M=b+p.get(t),F=IG[v],O=RG[v],[G,j]=DG(t,`${y}`,s,f,L,w,A),Z=G/2,at=j/2;return[FG[v]*G,PG[v]*j,F*M,O*M,F*_,O*_,G,j,Z,at]};function BG(t,e,s,n,i,r,o,a,l){const u=o.remove.nodes,h=o.remove.edges,g=o.redraw.nodes,f=s.angle,p=s.zoom,y=s.sin,_=s.cos,x=n.x,v=n.y,b=n.radius,S=n.layer,A=n.scalingMethod,w=n.text.content,L=n.text.scaling,M=n.text.minVisibleSize,F=n.animationDuration,O=n.textHidden,G=n.excluded;o.indexToLayer={},o.indexToQuadIndex={},o.indexToRemoveNodeText={},o.indexToRemoveEdgeText={},o.indexToRedrawNodeText={},o.byLayer=[];const{indexToLayer:j,indexToRedrawNodeText:Z,indexToRemoveNodeText:at,indexToRemoveEdgeText:pt,indexToQuadIndex:K,byLayer:ut}=o;for(let Ht=0;Ht<t.length;Ht++){const Zt=t[Ht],ae=S.get(Zt)-Z2;(ut[ae]=ut[ae]||[]).push(Zt),j[Zt]=ae}if(a!==null){const Ht=ut.length;for(let Zt=j[a]+1;Zt<=Ht;Zt++)(ut[Zt]=ut[Zt]||[]).unshift(a);j[a]=Ht}let ht;const nt=[0,0,0,0],ot=[0,0,0,0,0],{bboxes:Mt,rects:Q}=o,Et=(Ht,Zt=-1)=>{const ae=F.get(Ht);let pe=w.get(Ht);if(pe===null||pe===""||ae!==0)return!1;let ne=b.get(Ht);const te=M.get(Ht);if(G.get(Ht)===1)return at[Ht]=!0,!1;if(2*ne*p<te)return O.get(Ht)===0&&(at[Ht]=!0),!1;A.get(Ht)==="fixed"&&(ne/=p);const se=x.get(Ht),ce=v.get(Ht);typeof pe=="number"&&(pe=pe.toString());let[Ce,ve,Me,ge,ze,is,Ge,De,He,Je]=i(Ht);const ss=!L.get(Ht),ts=ss?p:1,hs=A.get(Ht)==="fixed"?p:1;ss?(Me+=He,ge+=Je,He/=p,Je/=p,Ge/=p,De/=p):(Me+=He*p,ge+=Je*p),Ce=Ce/ts+Me/p+ze/hs,ve=ve/ts+ge/p+is/hs,dp(se-He,ce-Je,Ge,De,-f,y,-_,nt),ot[0]=se-He,ot[1]=ce-Je,ot[2]=Ge,ot[3]=De,ot[4]=f;const Fe=_*Ce-y*ve,Oe=y*Ce+_*ve;if(nt[0]+=Fe,nt[1]+=Oe,nt[2]+=Fe,nt[3]+=Oe,ot[0]+=Fe,ot[1]+=Oe,o.realIntersection=!1,tM(Ht,!0,Rh(ot[0],ot[1],ot[2],ot[3],ot[4]),Zt),e.traverse(nt[0],nt[1],nt[2],nt[3],l),o.realIntersection&&!r)return at[Ht]=!0,!1;Z[Ht]=!0,at[Ht]=!1,Zt<=0?(ht=Mt.length/Tr,K[Ht]=ht,Mt.push(nt[0],nt[1],nt[2],nt[3],1,Ht),e.insert(ht,nt[0],nt[1],nt[2],nt[3]),Q.push(ot[0],ot[1],ot[2],ot[3],ot[4])):e.insert(K[Ht],nt[0],nt[1],nt[2],nt[3])};for(const Ht of t)Et(Ht);let Xt=!0;for(let Ht=0;Ht<ut.length;Ht++){const Zt=ut[Ht];if(Zt)if(Xt)Xt=!1;else for(const ae of Zt)Et(ae,Ht)}for(let Ht=0;Ht<t.length;Ht++){const Zt=t[Ht];at[Zt]?u.push(Zt):Z[Zt]&&g.push(Zt),pt[Zt]&&h.push(Zt)}return o}var UG=1,GG="topDown",VG="bottomUp",jG=.15,HG=200,KA=80,$G=["x","y","radius","width","layer","text.content","text.minVisibleSize","text.size","text.scale","text.scaling","text.padding","text.margin","text.position","text.style"].reduce(((t,e)=>(t.add(e),t)),new Set),qG=class extends Xe{constructor(t,e){super(t),this._textBBoxes=[],this._rects=[],this._enabled=!1,this._geoEnabled=!1,this._intersects=[],this._textDisplacement={},this._textDisplacementUpdate={},this._skipFrames=!1,this._output={remove:{nodes:[],edges:[]},redraw:{nodes:[],edges:[]},rects:this._rects,bboxes:this._textBBoxes,intersects:this._intersects,realIntersection:!1,indexToLayer:{},byLayer:[],indexToRedrawEdgeText:{},indexToRemoveEdgeText:{},indexToRedrawNodeText:{},indexToRemoveNodeText:{},indexToQuadIndex:{}},this._onZoomStart=Zd((({startZoom:s,endZoom:n})=>{this._enabled&&n<s&&this._updateLabels(this._modules.camera.clone({zoom:n}))}),KA),this._onLayoutEnd=Zd((()=>{this._enabled&&this._updateLabels()}),KA),this._onAttributesChanged=s=>{if([...s.edgeAttributes,...s.nodeAttributes].some((n=>$G.has(n)))){const n=s.nodes._indexes;for(let i=0;i<n.length;i++)this._textDisplacementUpdate[n[i]]=!0;this._update()}},this._onToggle=s=>(s?this._update():this._reset(),this),this._update=()=>{(this._enabled||this._forceEnabled)&&this._updateDebounced()},this._toggleDebug=s=>{s?this._modules.layers.whenReady((()=>{this._layer=this._modules.layers.addCanvasLayer((n=>{n.lineWidth=1/this._modules.camera.getZoom(),LG(n,this._textBBoxes,this._rects,this._intersects,this._quadtree)}),{isStatic:!1,noClear:!1}),this._layer.moveToTop(),this._canvas=this._layer.element,this._ctx=this._canvas.getContext("2d"),this._update()})):this._canvas&&(this._layer.destroy(),this._canvas=this._ctx=null)},this._measureText=(s,n,i,r)=>this._engine.measureText(s,n,i,r),this._textDisplacement={},this._textDisplacementUpdate={},this._quadtree=new CG.Quadtree((s=>{const n=Tr,i=n*s;return this._textBBoxes.slice(i,i+n)}),UG),e.forceEnableTextOverlapRemoval&&this.forceEnable()}onMounted(){this._engine=this._modules.graphics.getGraphicsEngine(),this._modules.events.register(["labelCollisionsRemoved"]),this.setRate(HG),this._modules.settings.register("texts.preventOverlap",!0,this._onToggle),this._modules.settings.register("texts.debug",!1,this._toggleDebug),this._modules.settings.register("texts.removalStrategy",GG);const t=this._output;this._nodeTraversal=XA(this._quadtree,!1,1,t),this._edgeTraversal=XA(this._quadtree,!1,0,t),this._modules.events.on(["layoutEnd","locate"],this._onLayoutEnd).on(["viewChanged","mouseover","mouseout"],this._update).on("updateAttributes",this._onAttributesChanged).on("setContainer",(({element:e})=>{if(e)return this._enable();this._disable()})).on("zoomStart",this._onZoomStart).on("viewExportStart",(({preventOverlap:e,camera:s})=>{e&&this.forceUpdate(s)})).on("viewExportEnd",(()=>{this.forceUpdate()})).on("geoEnabled",(()=>this._geoEnabled=!0)).on("geoDisabled",(()=>this._geoEnabled=!1))}getTextsBoundingBox(t,e){if(this._skipFrames=!0,t||e?this._updateLabels(this._modules.camera,t?Array.from(t._indexes):[],e?Array.from(e._indexes):[]):this._updateLabels(),this._skipFrames=!1,this._rects===void 0)throw new Error("this._rects is undefined");const s=this._rects,n=new ri;for(let i=0;i<s.length;i+=5){const r=s[i],o=s[i+1],a=s[i+2],l=s[i+3],u=s[i+4],[h,g,f,p]=dp(r,o,a,l,u);n.addPoint(h,g).addPoint(f,p)}return n}setRate(t){this._updateDebounced=this._modules.sync.debounceIdle((e=>this._updateLabels(e)),t)}forceEnable(){this._forceEnabled=!0}update(){this._update()}forceUpdate(t=this._modules.camera){this._updateLabels(t)}query(t,e,s,n,i){const r=this._quadtree.query(t,e,s,n);for(let o=0;o<r.length;o++){const a=this._textBBoxes[6*r[o]+4],l=this._textBBoxes[6*r[o]+5];a?i.nodes.push(l):i.edges.push(l)}}_enable(){this._enabled=!0,this._update()}_disable(){this._textBBoxes=[],this._rects=[],this._intersects=[],this._enabled=!1}_onCameraMove(){this._update()}_updateLabels(t=this._modules.camera,e,s){if(!this._modules.settings.get("texts.preventOverlap"))return;const n=this._modules.graphics.getNodeAttributes(),i=this._modules.graphics.getEdgeAttributes();this._intersects=[],this._textBBoxes=[],this._rects=[];const r=t.getAngle(),o=t.getProjectedScreenBounds(jG),a=this._modules.settings.get("texts.removalStrategy")===VG,l={angle:r,zoom:t.zoom,sin:Math.sin(r),cos:Math.cos(r)};this._resetOutput();const u=this._output;if(!e||!s){const y=this._modules.spatial.queryRaw(o[0],o[1],o[2],o[3]);e=y.nodes,s=y.edges}const h=this._quadtree.clear().cover(o[0],o[1],o[2],o[3]);if(e.length+s.length===0)return;const g=this._modules.captor.getPointedElement();let f=null,p=null;g!==null&&(g.isNode?f=g._index:p=g._index);for(const y of e)!this._textDisplacementUpdate[y]&&this._textDisplacement[y]||(this._textDisplacement[y]=OG(y,n,this._measureText),this._textDisplacementUpdate[y]=!1);BG(e,h,l,n,(y=>this._textDisplacement[y]),a,u,f,this._nodeTraversal),kG(s,h,l,i,n,this._measureText,a,u,p,this._edgeTraversal,this._geoEnabled),this._skipFrames||this._clearOverlaps(this._output),this._modules.settings.get("texts.debug")&&this._layer.refresh()}_clearOverlaps(t){const e=this._modules.graph.nodeList,s=this._modules.graph.edgeList,n=this._modules.graphics,i=e(new Uint32Array(t.remove.nodes)),r=s(new Uint32Array(t.remove.edges)),o=e(new Uint32Array(t.redraw.nodes)),a=s(new Uint32Array(t.redraw.edges));n.setTextHidden(i,!0),n.setTextHidden(r,!0),n.setTextHidden(o,!1),n.setTextHidden(a,!1),this._modules.events.fire("labelCollisionsRemoved",t)}_resetOutput(){const t=this._output;t.remove.nodes=[],t.remove.edges=[],t.redraw.nodes=[],t.redraw.edges=[],t.rects=this._rects,t.bboxes=this._textBBoxes,t.intersects=this._intersects,t.realIntersection=!1,t.indexToLayer={},t.byLayer=[],t.indexToRedrawEdgeText={},t.indexToRemoveEdgeText={},t.indexToRedrawNodeText={},t.indexToRemoveNodeText={},t.indexToQuadIndex={}}_reset(){this._modules.graphics.resetTextHidden(),this._textDisplacement={},this._textDisplacementUpdate={}}},YG=class extends Xe{constructor(){super(...arguments),this._onStartInteractionEvent=(t,e)=>{const s=e==="mousewheel";if(this._current&&!s)return;const n=this._interactionsByStartEvent[e];let i;for(const r of n)r.check(t)&&(!i||r.priority>=i.priority)&&(i=r);i&&(s?i.onStart&&i.onStart(t):this._startInteraction(i,t))},this._onProgressInteractionEvent=(t,e)=>{this._current&&this._current.progressEventName===e&&this._current.onProgress&&this._current.onProgress(t)},this._onStopInteractionEvent=(t,e)=>{this._current&&this._current.stopEventName===e&&this._stopCurrentInteraction(null)}}onMounted(){this._interactionsByStartEvent={},this._boundProgressEvents={},this._boundStopEvents={}}_startInteraction(t,e){t.onStart&&t.onStart(e),t.onStop&&(this._current=t,t.disableDetection&&this._modules.captor.setDetectionEnabled(!1))}_stopCurrentInteraction(t){this._current&&this._current.disableDetection&&this._modules.captor.setDetectionEnabled(!0),this._current&&this._current.onStop&&this._current.onStop(t),this._current=void 0}_forceStartInteraction(t,e){this._current&&this._stopCurrentInteraction(e),this._startInteraction(t,e)}_createWrapper(t){return{start:e=>this._forceStartInteraction(t,e)}}_addInteraction(t,e){const s=this._interactionsByStartEvent[t];return s?s.push(e):(this._interactionsByStartEvent[t]=[e],this._modules.events.on(t,this._onStartInteractionEvent)),this._createWrapper(e)}_createProgressiveInteraction(t,e,s,n){const i={priority:QA(n.priority),check:n.check||ef,onStart:n.onStart||as,onProgress:n.onProgress||as,onStop:n.onStop||as,disableDetection:!!n.disableDetection,progressEventName:e,stopEventName:s};return this._boundProgressEvents[e]||(this._boundProgressEvents[e]=!0,this._modules.events.on(e,this._onProgressInteractionEvent)),this._boundStopEvents[s]||(this._boundStopEvents[s]=!0,this._modules.events.on(s,this._onStopInteractionEvent)),this._addInteraction(t,i)}_createNonProgressiveInteraction(t,e){return this._addInteraction(t,{priority:QA(e.priority),check:e.check||ef,onStart:e.handler||as,onProgress:void 0,onStop:void 0,disableDetection:!1,progressEventName:void 0,stopEventName:void 0})}onDrag(t){return this._createProgressiveInteraction("dragStart","dragProgress","dragEnd",t)}onGesture(t){return this._createProgressiveInteraction("gestureStart","gestureProgress","gestureEnd",t)}onClick(t){return this._createNonProgressiveInteraction("click",t)}onDoubleClick(t){return this._createNonProgressiveInteraction("doubleclick",t)}onHover(t){return this._createNonProgressiveInteraction("mouseover",t)}onUnhover(t){return this._createNonProgressiveInteraction("mouseout",t)}onMouseWheel(t){return this._createNonProgressiveInteraction("mousewheel",t)}onMouseDown(t){return this._createNonProgressiveInteraction("mousedown",t)}onMouseUp(t){return this._createNonProgressiveInteraction("mouseup",t)}onMouseMove(t){return this._createNonProgressiveInteraction("mousemove",t)}};function QA(t){return typeof t=="string"?Kz.indexOf(t):typeof t!="number"||isNaN(t)?0:t}var WG=["virtualUp","mouseupInternal","touchUp"],XG=["virtualDown","mousedownInternal","touchDown"],ZG=["virtualMove","mousemoveInternal","touchMove"],KG=["virtualClick","clickInternal","touchTap"],QG=["virtualDoubleClick","doubleclickInternal","touchDoubleTap"],JG=["virtualWheel","mousewheelInternal"],tV=100,eV=class extends Xe{constructor(){super(...arguments),this.spatialIndexMarginRatio=5,this._elt=null,this._hoveredElt=null,this._draggedElt=null,this._hover=!1,this._disabledCounter=0,this._accDx=0,this._accDy=0,this._prevX=0,this._prevY=0,this._buttons={left:{isPressed:!1,isDragging:!1},middle:{isPressed:!1,isDragging:!1},right:{isPressed:!1,isDragging:!1}},this._onGraphChanged=()=>{this._resetCurrent(this._modules.position.x,this._modules.position.y),this._onMove({x:this._modules.position.x,y:this._modules.position.y,source:null,domEvent:null})}}onMounted(){this._modules.events.register(["mousemove","mousedown","mouseup","click","doubleclick","mousewheel","mouseout","mouseover","dragStart","dragProgress","dragEnd","gestureStart","gestureProgress","gestureEnd"]),this._modules.settings.register("detect.nodes",!0).register("detect.edges",!0).register("detect.nodeTexts",!0).register("detect.nodeBadges",!0).register("detect.edgeTexts",!0).register("detect.nodeErrorMargin",5).register("detect.edgeErrorMargin",2).register("detect.enableSpatialIndex",!0),this._modules.events.on(["removeNodes","removeEdges","clearGraph"],this._onGraphChanged).on(ZG,((t,e)=>{this._onMove({...t,source:Ea(e)})})).on(XG,(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onDown({domEvent:t,x:e,y:s,button:n,source:Ea(i)})})).on(WG,(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onUp({domEvent:t,x:e,y:s,button:n,source:Ea(i)})})).on(KG,(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onClick({domEvent:t,x:e,y:s,button:n,source:Ea(i)})})).on(QG,(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onDoubleClick({domEvent:t,x:e,y:s,button:n,source:Ea(i)})})).on(JG,(({domEvent:t,x:e,y:s,delta:n,dx:i,dy:r})=>this._onWheel({domEvent:t,x:e,y:s,delta:n,source:"mouse",dx:i,dy:r}))).on("touchStartGesture",(t=>this._modules.events.fire("gestureStart",t))).on("touchProgressGesture",(t=>this._modules.events.fire("gestureProgress",t))).on("touchEndGesture",(t=>this._modules.events.fire("gestureEnd",t))).on("documentMouseMove",(({domEvent:t,x:e,y:s},n)=>{this._onDocumentMove({domEvent:t,x:e,y:s,source:Ea(n)})})).on("documentMouseUp",(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onDocumentUp({domEvent:t,x:e,y:s,source:Ea(i),button:n})}))}triggerUnhover(){this._hover=!1,this._hoveredElt=null}triggerDetection(){this._detectElement(this._modules.position.x,this._modules.position.y,!1,!1),this._elt&&(this._hoveredElt=this._elt,this._hover=!0)}getPointedElement(){return this._hoveredElt}getDraggedElement(){return this._draggedElt}isAnyButtonPressed(){return this._buttons.left.isPressed||this._buttons.right.isPressed||this._buttons.middle.isPressed}isAnyButtonDragging(){return this._buttons.left.isDragging||this._buttons.right.isDragging||this._buttons.middle.isDragging}isButtonPressed(t){return this._buttons[t].isPressed}isLeftPressed(){return this.isButtonPressed("left")}getCursorPosition(){return{x:this._modules.position.x,y:this._modules.position.y}}getCursorInformation(){return{x:this._modules.position.x,y:this._modules.position.y,target:this._hoveredElt}}setDetectionEnabled(t){this._disabledCounter=Math.max(0,this._disabledCounter+(t?-1:1))}_resetCurrent(t,e){for(const s in this._buttons){const n=this._buttons[s];n.isDragging&&this._modules.events.fire("dragEnd",{domEvent:null,x:t,y:e,button:s,target:this._draggedElt}),n.isPressed=!1,n.isDragging=!1}this._hover&&this._hoveredElt&&this._modules.events.fire("mouseout",{domEvent:null,x:t,y:e,target:this._hoveredElt}),this._hover=!1,this._hoveredElt=null,this._draggedElt=null}_onMove({domEvent:t,x:e,y:s,source:n}){let{dx:i,dy:r}=this._setPointerPosition(e,s);this._modules.events.fire("mousemove",{domEvent:t,x:e,y:s,dx:i,dy:r,source:n});for(const o in this._buttons){const a=this._buttons[o];if(a.isPressed)if(a.isDragging){const l=this._getStoredDXY();i+=l.dx,r+=l.dy,this._modules.events.fire("dragProgress",{domEvent:t,x:e,y:s,dx:i,dy:r,button:o,source:n,target:this._draggedElt})}else a.isDragging=!0,this._hoveredElt&&this._hover&&(this._modules.events.fire("mouseout",{domEvent:t,x:e,y:s,source:n,target:this._hoveredElt}),this._hover=!1),this._draggedElt||(this._draggedElt=this._hoveredElt),this._storeDXY(i,r),this._modules.events.fire("dragStart",{domEvent:t,x:e,y:s,button:o,source:n,target:this._draggedElt})}t&&!this._modules.graphics.getDomElement().contains(t.target)||this._detectElement(e,s,!1,!1),this._elt!==this._hoveredElt&&(this._hoveredElt&&this._hover&&(this._hover=!0,this._modules.events.fire("mouseout",{domEvent:t,x:e,y:s,source:n,target:this._hoveredElt})),this._hoveredElt=this._elt,this._elt&&(this._hover=!0,this._modules.events.fire("mouseover",{domEvent:t,x:e,y:s,source:n,target:this._hoveredElt})))}_onDocumentMove({domEvent:t,x:e,y:s,source:n}){for(const i in this._buttons){const{isDragging:r}=this._buttons[i];if(r){const{dx:o,dy:a}=this._setPointerPosition(e,s);this._modules.events.fire("dragProgress",{domEvent:t,x:e,y:s,dx:o,dy:a,button:i,source:n,target:this._draggedElt})}}}_onDocumentUp({domEvent:t,x:e,y:s,source:n,button:i}){if(i!=null&&this._buttons[i].isDragging){this._modules.events.fire("dragEnd",{domEvent:t,x:e,y:s,button:i,source:n,target:this._draggedElt});const r=this._buttons[i];r.isDragging=!1,r.isPressed=!1,this.isAnyButtonDragging()||(this._draggedElt=null)}}_onDown({domEvent:t,x:e,y:s,button:n,source:i}){if(n==null)return;this._detectElement(e,s,!1,!1),this._elt!==this._hoveredElt&&this._resetCurrent(e,s);const r=this._buttons[n];this._hoveredElt=this._elt,r.isPressed=!0,this._elt&&t&&(t.stopPropagation(),t.preventDefault()),this._modules.events.fire("mousedown",{domEvent:t,x:e,y:s,button:n,source:i,target:this._hoveredElt})}_onDoubleClick({domEvent:t,x:e,y:s,button:n,source:i}){n!=null&&(t1(t,"doubleclick")||this._modules.events.fire("doubleclick",{domEvent:t,x:e,y:s,button:n,source:i,target:this._hoveredElt}))}_onUp({domEvent:t,x:e,y:s,button:n,source:i}){if(n==null)return;const r=this._buttons[n];r.isPressed&&(r.isDragging&&(this._modules.events.fire("dragEnd",{domEvent:t,x:e,y:s,button:n,source:i,target:this._draggedElt}),r.isDragging=!1,this.isAnyButtonDragging()||(this._draggedElt=null)),r.isPressed=!1,this._detectElement(e,s,!1,!1),this._modules.events.fire("mouseup",{domEvent:t,x:e,y:s,button:n,source:i,target:this._elt}),this.isAnyButtonPressed()||this._hover||i==="touch"||(this._hoveredElt=this._elt,this._hoveredElt&&(this._modules.events.fire("mouseover",{domEvent:t,x:e,y:s,source:i,target:this._hoveredElt}),this._hover=!0)))}_onClick({domEvent:t,x:e,y:s,button:n,source:i}){t1(t,"click")||this._modules.events.fire("click",{domEvent:t,x:e,y:s,button:n,source:i,target:this._hoveredElt})}_onWheel({domEvent:t,x:e,y:s,delta:n,source:i,dx:r,dy:o}){this._modules.position.x=e,this._modules.position.y=s,this._modules.events.fire("mousewheel",{domEvent:t,x:e,y:s,dx:r,dy:o,delta:n,source:i,target:this._hoveredElt})}_storeDXY(t,e){this._accDx=t,this._accDy=e}_getStoredDXY(){const t=this._accDx,e=this._accDy;return this._accDx=0,this._accDy=0,{dx:t,dy:e}}_setPointerPosition(t,e){const s=t-this._prevX,n=e-this._prevY;return this._modules.position.x=t,this._modules.position.y=e,this._prevX=t,this._prevY=e,this._accDx=0,this._accDy=0,{dx:s,dy:n}}_detectElement(t,e,s,n){this._elt=this.detectElementAt(t,e,s,n)}detectElementAt(t,e,s,n){if(this._disabledCounter!==0)return null;const i=this._modules.settings,r=i.get("detect.enableSpatialIndex"),o=i.get("detect.nodeErrorMargin")||0,a=i.get("detect.edgeErrorMargin")||0;let l=i.get("detect.nodes"),u=i.get("detect.edges");n&&(l=!0,u=!0);let h=null,g=[],f=[];if(!s&&r&&(l||u)){const _=this.spatialIndexMarginRatio,x=Math.max(o*_,a*_),v=this._modules.spatial.queryRawProjected(t-x,e-x,t+x,e+x);g=v.nodes,f=v.edges}let p=null,y=null;if(l&&(p=this._modules.graphics.detectNode(t,e,!!i.get("detect.nodeTexts"),!!i.get("detect.nodeBadges"),o,g)),u&&(f.length<tV||!p)&&(y=this._modules.graphics.detectEdge(t,e,!!i.get("detect.edgeTexts"),a,f)),p&&y){const _=this._modules.graphics.getAttributesManager().getFlexArrays();h=_.nodes.current.layer.get(p._index)>=_.edges.current.layer.get(y._index)?p:y}else p?h=p:y&&(h=y);return h}};function Ea(t){return t.indexOf("touch")===0?"touch":"mouse"}var x_=!1,JA={down:{trigger:"pointerdown",duplicate:"mousedown"},click:{trigger:"pointerdown",duplicate:"mouseup"},doubleclick:{trigger:"pointerdown",duplicate:"mouseup"}};function t1(t,e){if(t)return t.type===JA[e].trigger&&(x_=!0),t.type===JA[e].duplicate&&x_?(x_=!1,!0):void 0}var sV=class extends Xe{constructor(){super(...arguments),this._dragged=null,this._start=[],this._end=[],this._shouldDrag=({target:t,button:e})=>{const s=e==="left",n=this._modules.settings.get("interactions.drag.enabled"),i=t!==null&&t.isNode&&t.getAttribute("draggable")===!0,r=t&&t.hasClass(ti);return!(!(s&&n&&i)||r)},this._onDragStart=({x:t,y:e,target:s})=>{s&&(s.isSelected()?this._dragged=this._modules.selection.getSelectedNodes().filter((n=>n.getAttribute("draggable"))):this._dragged=s.toList()),this._dragged&&(this._start=this._dragged.getPosition(),this._end=Zs(this._start),this._onBeforeDrag=this._modules.settings.get("interactions.drag.onBeforeDrag"),this._startDrag=this._modules.camera.screenToGraphCoordinates({x:t,y:e}),this._dragged.addClass(Gg),this._modules.events.fire("nodesDragStart",{nodes:this._dragged}),this._modules.graphics.addCursorStyle(this._modules.settings.get("interactions.drag.cursor")))},this._onDrag=()=>{if(!this._dragged||!this._startDrag)return;const{x:t,y:e}=this._modules.captor.getCursorInformation(),s=this._dragged._indexes,n=this._modules.camera.screenToGraphCoordinates({x:t,y:e}),i=n.x-this._startDrag.x,r=n.y-this._startDrag.y;for(let o=0;o<s.length;++o){const a=this._start[o],l=this._end[o];l.x=a.x+i,l.y=a.y+r}this._onBeforeDrag&&this._onBeforeDrag(this._dragged,t,e,this._end),this._modules.settings.get("interactions.drag.applyResult")&&this._modules.individualAttributes.setMultipleAttributes(this._dragged,this._end),this._modules.events.fire("nodesDragProgress",{nodes:this._dragged,dx:i,dy:r})},this._onDragEnd=()=>{this._dragged&&(this._dragged.removeClass(Gg),this._modules.graphics.removeCursorStyle(this._modules.settings.get("interactions.drag.cursor")),this._modules.events.fire("nodesDragEnd",{nodes:this._dragged,start:this._start,end:this._end}),this._dragged=null,this._start=[],this._end=[])}}onMounted(){this._modules.classes.createClass({name:Gg,isBuiltin:!0,nodeAttributes:{layer:Xz}}),this._modules.events.register(["nodesDragStart","nodesDragProgress","nodesDragEnd"]),this._modules.settings.register("interactions.drag.enabled",!0).register("interactions.drag.cursor","move").register("interactions.drag.onBeforeDrag",void 0),this._modules.settings.register("interactions.drag.applyResult",!0),this._modules.interactions.onDrag({priority:"drag",disableDetection:!0,check:this._shouldDrag,onStart:this._onDragStart,onProgress:this._onDrag,onStop:this._onDragEnd})}},nV={color:"#00C3FF",radius:4,cursorOnHover:"grab",cursorOnDrag:"grabbing"},iV=class extends Xe{constructor(){super(...arguments),this._hoveredNode=null,this._hoverHandle=!1,this._grabHandle=!1,this._x=0,this._y=0,this._enabled=!1,this._onMouseUp=()=>this._grabHandle=!1,this._onMouseDown=()=>{this._hoverHandle&&(this._grabHandle=!0)},this._onDragProgress=()=>{this._grabHandle&&this._refreshCanvas()},this._onDragStart=()=>{if(!this._movedEdges)return;this._nodesToHighlight=this._nodesToHighlight.filter((e=>e!==this._startNode&&!e.isVirtual())),this._movedEdges.setExcluded(!0);const t=this._options.cursorOnDrag;this._prevSettings=this._modules.settings.update({edgeHover:!1,cursor:{default:t,node:t,edge:t}})},this._onDragEnd=()=>{if(!this._movedEdges)return;this._restoreSettings();const t=this._getPointedNode();t?this._movedEdges.forEach((e=>{e.getTarget()===this._startNode?e.setTarget(t):e.setSource(t)})):this._options.onMouseUpInVoid&&this._options.onMouseUpInVoid(this._modules.camera.screenToGraphCoordinates({x:this._x,y:this._y}),this._startNode,this._movedEdges,this._movedEdges.map((e=>e.getSource()===this._startNode))),this._movedEdges.setExcluded(!1),this._movedEdges.setSelected(!0),this._movedEdges=null,this._refreshHandles()},this._refreshHandles=()=>{if(!this._enabled||this._movedEdges)return;const t=this._modules.selection.getSelectedEdges();this._nodesToHighlight=t.getExtremities().dedupe().filter((e=>!e.isVirtual())),this._rewirableClass.clearEdges(),this._rewirableClass.add(t),this._refreshCanvas()},this._shouldInteractionStart=()=>{if(!this._enabled||!this._hoveredNode||!this._hoverHandle||this._hoveredNode.isVirtual())return!1;const t=this._hoveredNode.getAdjacentEdges().filter((e=>e.isSelected()));return!!t.size&&(this._movedEdges=t,this._edgeColors=this._movedEdges.getAttribute("color"),this._startNode=this._hoveredNode,!0)},this._refreshCanvas=()=>{this._enabled&&this._layer.refresh()},this._checkForHover=()=>{if(!this._enabled||!this._nodesToHighlight)return;const t=this._options.radius,e=this._nodesToHighlight.getPosition(),s=this._modules.camera.screenToGraphCoordinates(this._modules.captor.getCursorPosition());for(let n=0;n<e.length;n++){const{x:i,y:r}=e[n];if(!(i-t>s.x||i+t<s.x||r-t>s.y||r+t<s.y))return this._hoveredNode=this._nodesToHighlight.get(n),void this._enableCursorOnHover()}this._hoveredNode=null,this._disableCursorOnHover()}}onMounted(){this._rewirableClass=this._modules.classes.createClass({name:H2,isBuiltin:!0,edgeAttributes:{layer:Zz}})}enable(t){this._enabled||(this._modules.events.on("move",this._checkForHover).on("mousemove",this._checkForHover).on("dragProgress",this._onDragProgress).on("nodesDragProgress",this._refreshCanvas).on("mousedown",this._onMouseDown).on("mouseup",this._onMouseUp).on("edgesSelected",this._refreshHandles).on("edgesUnselected",this._refreshHandles),this._interaction=this._modules.interactions.onDrag({priority:"rewiring",check:this._shouldInteractionStart,onStart:this._onDragStart,onProgress:({x:e,y:s})=>{this._x=e,this._y=s},onStop:this._onDragEnd}),this._options={...nV,...t},this._enabled=!0,this._layer=this._modules.layers.addCanvasLayer((e=>{if(!this._enabled||!this._nodesToHighlight)return;const s=this._modules.captor.getCursorPosition(),n=this._getPointedNode(),i=this._options.color,r=this._options.radius,o=2*r;if(this._displayMovedEdges(e),e.fillStyle=i,e.strokeStyle=i,this._nodesToHighlight.forEach((a=>{const{x:l,y:u}=a.getPosition();e.fillRect(l-r,u-r,o,o)})),this._movedEdges){const a=n?n.getPosition():s;e.fillRect(a.x-r,a.y-r,o,o)}}),{isStatic:!1,noClear:!1}),this._layer.moveToTop(),this._refreshHandles())}disable(){this._enabled&&(this._interaction&&this._interaction.stop&&this._interaction.stop(),this._interaction=void 0,this._modules.graphics.removeCursorStyle(this._options.cursorOnDrag),this._disableCursorOnHover(),this._hoveredNode=null,this._restoreSettings(),this._layer.destroy(),this._rewirableClass.clearEdges(),this._enabled=!1,[this._checkForHover,this._onDragProgress,this._refreshCanvas,this._onMouseDown,this._onMouseUp,this._refreshHandles].forEach((t=>this._ogma.events.off(t))))}enabled(){return this._enabled}_restoreSettings(){this._prevSettings&&(this._modules.settings.update(this._prevSettings),this._prevSettings=void 0)}_disableCursorOnHover(){this._hoverHandle&&!this._grabHandle&&(this._hoverHandle=!1,this._modules.graphics.removeCursorStyle(this._options.cursorOnHover))}_enableCursorOnHover(){this._hoverHandle||(this._hoverHandle=!0,this._modules.graphics.addCursorStyle(this._options.cursorOnHover))}_displayMovedEdges(t){if(!this._movedEdges)return;const e=this._x,s=this._y,n=this._modules.camera.screenToGraphCoordinates({x:e,y:s});this._movedEdges.forEach(((i,r)=>{const o=this._edgeColors[r],a=i.getSource(),l=i.getTarget(),u=this._getPointedNode(),h=l===this._startNode?a:l,g=Number(i.getAttribute("width")),f=h.getPosition(),p=u?u.getPosition():n;t.beginPath(),t.moveTo(f.x,f.y),t.lineTo(p.x,p.y),t.strokeStyle=o,t.lineWidth=g,t.stroke()}))}_getPointedNode(){const t=this._modules.captor.getPointedElement();return t&&t.isNode&&!t.isVirtual()?t:null}},e1={cursor:"nesw-resize",color:"#00C3FF",lineWidth:1,handleSize:6,detectionMargin:5,snappingRatio:1.25,nbNodesToSnapTo:5,previewColor:"rgba(0, 0, 0, 0.2)",sizeIndicatorColor:"black",sizeIndicatorOffset:5,sizeIndicatorWidth:3,sizeIndicatorThickness:1},rV=class extends Xe{constructor(){super(...arguments),this._enabled=!1,this._nodesToHighlight=null,this._cursorEnabled=!1,this._x=0,this._y=0,this._additionalRadiuses=[],this._onSelectionChange=()=>{this._enabled&&(this._nodesToHighlight=this._modules.selection.getSelectedNodes(),this._displayHandles())},this._displayHandlesHandler=()=>this._displayHandles(),this._moveHandler=({x:t,y:e})=>{this._modules.dom.setTimeout((()=>this._detectBoundingBoxes(t,e)),0)}}onMounted(){this._engine=this._modules.graphics.getGraphicsEngine(),this._modules.interactions.onDrag({priority:"resizing",disableDetection:!0,check:()=>!(!this._enabled||!this._pointedNode),onStart:({x:t,y:e})=>{this._x=t,this._y=e,this._nodeBeingResized=this._pointedNode},onProgress:({x:t,y:e})=>{this._x=t,this._y=e,this._displayHandles()},onStop:()=>{if(this._nodesToHighlight){const t=this._modules.camera.zoom,e=this._nodesToHighlight.getAttributes(["x","y","radius"]).map((({x:s,y:n,radius:i},r)=>{const o=this._additionalRadiuses[r]/t;return{radius:+i+o,x:s+o,y:n-o}}));this._nodesToHighlight.setAttributes(e)}this._pointedNode=null,this._nodeBeingResized=null,this._displayHandles()}})}onReady(){this._modules.events.on(["nodesSelected","nodesUnselected"],this._onSelectionChange)}_enableCursor(){this._cursorEnabled||(this._modules.graphics.addCursorStyle(this._options.cursor),this._cursorEnabled=!0)}_disableCursor(){this._cursorEnabled&&(this._modules.graphics.removeCursorStyle(this._options.cursor),this._cursorEnabled=!1)}_detectBoundingBoxes(t,e){if(!this._enabled||this._nodeBeingResized||!this._nodesToHighlight)return;const s=this._options.handleSize/2,n=this._options.detectionMargin;return this._pointedNode=null,this._forEachNodeToHighlight(((i,r,o)=>{const a=r.x+o-s-n,l=r.x+o+s+n,u=r.y-o-s-n,h=r.y-o+s+n;t>=a&&t<=l&&e>=u&&e<=h&&(this._pointedNode=i)})),this._pointedNode?this._enableCursor():this._disableCursor()}_forEachNodeToHighlight(t){this._nodesToHighlight&&this._nodesToHighlight.forEach((e=>{const s=e.getPositionOnScreen(),n=this._getTotalRadius(e);t(e,s,n)}))}_displayHandles(){this._enabled&&this._nodesToHighlight&&this._layer.refresh()}_displayNodePreview(t,e,s,n,i,r){if(i*=1/this._modules.camera.getZoom(),t.beginPath(),r.length===1)t.arc(s,n,i,0,2*Math.PI);else for(let o=0;o<r.length;++o){const a=r[o],l=s+a.x*i,u=n+a.y*i;o===0?t.moveTo(l,u):t.lineTo(l,u)}t.fillStyle=this._options.previewColor,t.fill()}_getTotalRadius(t,e=!0){return Number(t.getAttribute("radius"))*(this._modules.camera.zoom*(e?1:0))+Number(t.getAttribute("innerStroke.width"))+Number(t.getAttribute("outerStroke.width"))+this._options.lineWidth/2}_snap(t,e,s){const n=this._modules.spatial.getNodesInScreenByDistance(e).filter((g=>!g.isSelected())).slice(0,this._options.nbNodesToSnapTo),i=this._getTotalRadius(e),r=i+s,o=this._options.snappingRatio,a=r/i,l=Math.round(m2(a,o));let u=i*Math.pow(o,l),h=null;if(n.forEach((g=>{const f=this._getTotalRadius(g);Math.abs(f-r)<=Math.abs(u-r)&&(u=f,h=g)})),h){t.save(),t.strokeStyle=this._options.sizeIndicatorColor,t.lineWidth=this._options.sizeIndicatorThickness/this._modules.camera.getZoom();const g=h.getAttribute("radius");this._displaySizeIndicator(t,e,u),n.filter((f=>f.getAttribute("radius")===g)).forEach((f=>this._displaySizeIndicator(t,f))),t.restore()}return u-i}_displaySizeIndicator(t,e,s){s=s||void 0;const n=this._modules.camera.getZoom(),i=e.getPosition(),r=this._getTotalRadius(e),o=(s||r)/n,a=(s?s-r:0)/n,l=a+(-this._options.sizeIndicatorOffset-(s?Number(e.getAttribute("innerStroke.width"))+Number(e.getAttribute("outerStroke.width")):0))/n,u=i.x-o+l|0,h=i.y-o-a|0,g=i.y+o-a|0,f=this._options.sizeIndicatorWidth/n;t.beginPath(),t.moveTo(u-f,h),t.lineTo(u+f,h),t.moveTo(u,h),t.lineTo(u,g),t.moveTo(u-f,g),t.lineTo(u+f,g),t.stroke()}enable(t={}){this._enabled||(this._options={...e1,...t},this._layer=this._modules.layers.addCanvasLayer((e=>{const s=bi(),n=this._modules.camera.getZoom(),{color:i,lineWidth:r}=this._options;let o=this._options.handleSize,a=0;if(this._nodeBeingResized){const l=this._getTotalRadius(this._nodeBeingResized),u=this._nodeBeingResized.getPositionOnScreen();a=Math.max(this._x-(u.x+l),-(this._y-(u.y-l)))/2}this._additionalRadiuses=[],this._nodesToHighlight&&this._nodesToHighlight.forEach((l=>{const u=l.getPosition();let h=this._getTotalRadius(l),g=0;if(this._nodeBeingResized){g=a;const f=-h+Number(l.getAttribute("innerStroke.width"))+Number(l.getAttribute("outerStroke.width"))+r/2+1;g=g<f?f:this._snap(e,l,g),this._additionalRadiuses.push(g);const p=l.getAttribute("shape"),y=this._engine.getShapePoints(p),_=u.x+g/n,x=u.y-g/n,v=h+g;this._displayNodePreview(e,s,_,x,v,y)}e.strokeStyle=i,e.fillStyle=i,e.lineWidth=r/n,h/=n,g/=n,o/=n*s,e.strokeRect(u.x-h,u.y-h-2*g,2*(g+h),2*(g+h)),e.fillRect(u.x+h+2*g-o/2,u.y-h-2*g-o/2,o,o)}))}),{isStatic:!1,noClear:!1}),this._layer.moveToTop(),this._modules.events.on(["mousemove","mousedown"],this._moveHandler),this._enabled=!0)}disable(){this._enabled&&(this._modules.events.off(this._displayHandlesHandler).off(this._moveHandler),this._layer.destroy(),this._disableCursor(),this._reset())}_reset(){this._enabled=!1,this._nodesToHighlight=null,this._options={...e1},this._nodeBeingResized=null,this._pointedNode=null,this._cursorEnabled=!1,this._x=0,this._y=0,this._additionalRadiuses=[]}enabled(){return this._enabled}},oV={strokeColor:"black",strokeWidth:5,dashed:!0,cursorStyle:"cell",createNodes:!0,condition:Rx,onNodeCreated:as,onEdgeCreated:as,createNode:hr,createEdge:hr,onComplete:as},aV=class extends Xe{constructor(){super(...arguments),this._enabled=!1,this._blockId=0,this._cursorEnabled=!1}onMounted(){this._engine=this._modules.graphics.getGraphicsEngine(),this._group=this._engine.createGroup(),this._depth=rh(0).edgeBody,this._modules.events.register(["connectNodes"]),this._interaction=this._modules.interactions.onDrag({priority:"connectNodes",check:({target:t,button:e="left"})=>this._enabled&&e==="left"&&t&&t.isNode&&!t.isVirtual(),onStart:({target:t})=>this._onStart(t),onProgress:({x:t,y:e})=>this._onMove(t,e),onStop:()=>this._onStop()}),this._modules.events.on("clearGraph",(()=>this.disable()))}_onStart(t){t&&(this._cursorEnabled=!0,this._startNode=t,this._startPos=t.getPosition(),this._modules.graphics.addCursorStyle(this._options.cursorStyle),this._blockId=this._modules.graphics.allocateGraphicsEngineBlockId())}_onMove(t,e){this._startNode!==null&&(this._endPos=this._modules.camera.screenToGraphCoordinates({x:t,y:e}),this._drawLine())}_onStop(){if(this._startNode===null)return;const{condition:t,onNodeCreated:e,onEdgeCreated:s,createEdge:n,createNode:i,onComplete:r,createNodes:o}=this._options;let a=this._modules.captor.getPointedElement(),l=null,u=null;if(this._modules.graphics.releaseGraphicsEngineBlockId(this._blockId),!a&&o){const h=i({attributes:{x:this._endPos.x,y:this._endPos.y}});a=this._modules.graph.addNode(h),u=a,e&&e(u)}if(a&&!a.isVirtual()&&(u||!t||t(this._startNode,a))){const h=n({source:this._startNode.getId(),target:a.getId()});l=this._modules.graph.addEdge(h),s&&s(l)}r&&(this._modules.events.fire("connectNodes",{source:this._startNode,target:a,edge:l}),r(this._startNode,a,l||void 0)),this.disable()}_drawLine(){this._group.reset(dr,!1,this._depth);const t=this._group.nextAndReset().end;t.pieceId=Jf,t.shape="line",t.x1=this._startPos.x,t.y1=this._startPos.y,t.x2=this._endPos.x,t.y2=this._endPos.y,t.fillColor=this._options.strokeColor,t.thicknessOrFontSizeFixed=this._options.strokeWidth,this._options.dashed&&(t.dashLength=3,t.gapLength=1),this._engine.storeGroup(this._blockId,this._group),this._modules.dom.refresh()}enable(t={}){return this._enabled||(this._options={...oV,...t},this._enabled=!0,this._cursorEnabled=!1,this._startNode=null,this._prevSettings=this._modules.settings.update({"cursor.node":this._options.cursorStyle,"detect.edges":!1}),this._modules.captor.isLeftPressed()&&this._interaction.start(this._modules.captor.getCursorInformation())),this}disable(){return this._enabled?(this._enabled=!1,this._modules.settings.update(this._prevSettings),this._cursorEnabled&&this._modules.graphics.removeCursorStyle(this._options.cursorStyle),this):this}enabled(){return this._enabled}},lV=["top","bottom","left","right","cssDefined"],uV=1e4,dV={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}},hV={position:"top",autoAdjust:!0,delay:100},cV={hover:{node:({target:t})=>t&&t.isNode,edge:({target:t})=>t&&!t.isNode},click:{left:{node:({target:t,button:e})=>e==="left"&&t&&t.isNode,edge:({target:t,button:e})=>e==="left"&&t&&!t.isNode,background:({target:t,button:e})=>e==="left"&&!t},right:{node:({target:t,button:e})=>e==="right"&&t&&t.isNode,edge:({target:t,button:e})=>e==="right"&&t&&!t.isNode,background:({target:t,button:e})=>e==="right"&&!t}},doubleclick:{left:{node:({target:t,button:e})=>e==="left"&&t&&t.isNode,edge:({target:t,button:e})=>e==="left"&&t&&!t.isNode,background:({target:t,button:e})=>e==="left"&&!t},right:{node:({target:t,button:e})=>e==="right"&&t&&t.isNode,edge:({target:t,button:e})=>e==="right"&&t&&!t.isNode,background:({target:t,button:e})=>e==="right"&&!t}}},gV=class extends Xe{constructor(){super(...arguments),this._x=0,this._y=0}onMounted(){this._handlers={},this._currentHandlerName=null,this._tooltip=null,this._isHover=!1,this._modules.events.register(["tooltipShow","tooltipHide"]),this._modules.events.on(["mouseup","dragStart"],(()=>{this._isHover||this._hideTooltip(!1)})).on("mouseout",(()=>{this._isHover&&this._hideTooltip(!1)})).on("clearGraph",(()=>this._hideTooltip(!1))),this._modules.interactions.onHover(this._createInteraction("hover",!0)),this._modules.interactions.onClick(this._createInteraction("click")),this._modules.interactions.onDoubleClick(this._createInteraction("doubleclick"))}hide(){this._hideTooltip(!0)}isShown(){return!!this._tooltip}refresh(){this._refreshTooltip()}show(t,{position:e="top",autoAdjust:s=!0,className:n,x:i=0,y:r=0}={}){this._showTooltip(t,{position:e,autoAdjust:s,className:n},{x:i,y:r})}setHandler(t,e,s){const n={...hV,...s};n.position&&lV.indexOf(n.position)===-1&&(n.position="top"),this._handlers[t]={handler:e,condition:Ys(cV,t),settings:n}}_hideTooltip(t){if(this._timeout&&(this._modules.dom.clearTimeout(this._timeout),this._timeout=null),t&&(this._currentHandlerName=null),this._tooltip){const e=this._tooltip;this._tooltip.parentNode&&this._tooltip.parentNode.removeChild(this._tooltip),this._tooltip=null,this._modules.events.fire("tooltipHide",{tooltip:e})}}_createInteraction(t,e=!1){return{priority:"tooltip",check:s=>{const n=s1(t,s),i=this._handlers[n];return(!e||!this._modules.connectNodes.enabled())&&(!(!i||!i.condition(s))||!(e||!this._currentHandlerName||this._isHover)&&this._tooltip!==null)},handler:s=>{const{target:n,x:i,y:r}=s;this._hideTooltip(!1),this._isHover=e,this._elt=n,this._x=i,this._y=r,this._currentHandlerName=s1(t,s),this._refreshTooltip()}}}_refreshTooltip(){if(!this._currentHandlerName)return void this._hideTooltip(!1);const t=this._handlers[this._currentHandlerName];if(!t)return;const{settings:e,handler:s}=t,n=this._elt;if(n){const r=n.isNode?"node":"edge";if(this._currentHandlerName.indexOf(r)===-1)return}const i=s(n);Promise.resolve(i).then((r=>this._schedule((()=>this._showTooltip(r,e)),e.delay)))}_schedule(t,e){this._timeout&&this._modules.dom.clearTimeout(this._timeout),this._timeout=this._modules.dom.setTimeout((()=>{this._timeout=null,t()}),e)}_showTooltip(t,e,s){this._hideTooltip(!1);const{position:n,className:i,autoAdjust:r}=e;let o=this._x,a=this._y,l=this._elt;const u=this._modules.dom.getDimensions();let h=0,g=0;if(s&&(o=s.x,a=s.y,l=null),typeof t=="string")this._tooltip=fV("div"),bT(this._tooltip,Vx.sanitize(t));else{if(!h2(t))throw new Error(`invalid tooltip ${t}, expected HTML string or HTML element`);this._tooltip=t}const f=this._tooltip;if(i&&this._tooltip.classList.add(i),n!=="cssDefined"&&(f.style.position="absolute"),f.style.zIndex=uV.toString(),this._modules.dom.appendElement(f),l&&l.isNode){const _=l,x=_.getPositionOnScreen(),v=Number(_.getAttribute("radius"))*(_.getAttribute("scalingMethod")==="fixed"?1:this._modules.camera.getZoom())+Number(_.getAttribute("innerStroke.width"))+Number(_.getAttribute("outerStroke.width"));o=x.x,a=x.y,h=v,g=v}const p=f.offsetWidth/2,y=f.offsetHeight/2;if(h+=p,g+=y,n&&n!=="cssDefined"){const _=dV[n];let x=_.x,v=_.y;if(r){const b=o+h*_.x,S=a+g*_.y;(b-p<0||b+p>=u.width)&&(n==="left"||n==="right"?x*=-1:x=b-p<0?(p-b+1)/h:(u.width-(b+p)-1)/h),(S-y<0||S+y>=u.height)&&(n==="top"||n==="bottom"?v*=-1:v=S-y<0?(y-S+1)/g:(u.height-(S+y)-1)/g)}f.style.left=o+h*x-p+"px",f.style.top=a+g*v-y+"px"}this._modules.events.fire("tooltipShow",{tooltip:f})}};function s1(t,{button:e,target:s}){return`${t}${e?`.${e}`:""}.${s!==null?s.isNode?"node":"edge":"background"}`}function fV(t){return ao?document.createElement(t):uf()}var qd={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",46:"del",8:"backspace",32:"space",224:"cmd",91:"cmd",92:"cmd",93:"cmd",187:"+",189:"-"},n1=Object.keys(qd).reduce(((t,e)=>{const s=qd[e];return t[s]||(t[s]=[]),t[s].push(e),t}),{}),pV=38,mV=40,_V=37,yV=39,xV=187,vV=189,bV=class extends Xe{constructor(){super(...arguments),this._onKeyPress=t=>{if((t==="zoomIn"||t==="zoomOut")&&!this._modules.settings.get("interactions.zoom.keyboard")||(t==="moveUp"||t==="moveDown"||t==="moveLeft"||t==="moveRight")&&!this._modules.settings.get("interactions.pan.keyboard")||!this._modules.dom.hasFocus())return;const{width:e,height:s}=this._ogma.view.getGraphBoundingBox(),n=Math.max(e,s)/10;if(isNaN(n)||!isFinite(n))return;const i={duration:150,easing:"cubicOut"};if(t==="zoomIn")return this._ogma.view.zoomIn(i);if(t==="zoomOut")return this._ogma.view.zoomOut(i);const r={x:0,y:0};return t==="moveLeft"?r.x=-n:t==="moveRight"?r.x=n:t==="moveUp"?r.y=-n:t==="moveDown"&&(r.y=n),this._ogma.view.move(r,i)},this._onBlur=()=>this.resetKeys(),this._onKeyUp=t=>{const e=t.keyCode||t.which;this._pressed[e]=!1,this._modules.events.fire("keyup",{domEvent:t,key:qd[e],code:e})},this._onKeyDown=t=>{const e=t.keyCode||t.which,s=this._binds[e];if(!this._pressed[e]){if(this._pressed[e]=!0,s)for(const n of s)n.keys.every((i=>i.some((r=>this._pressed[r]))))&&n.handler({domEvent:t});this._modules.events.fire("keydown",{domEvent:t,key:qd[e],code:e})}}}onMounted(){this._modules.events.register(["keyup","keydown"]),this._binds=[],this._pressed=[],this._modules.dom.addWindowEventListener("keydown",this._onKeyDown).addWindowEventListener("keyup",this._onKeyUp).addWindowEventListener("visibilitychange",this._onBlur).addWindowEventListener("blur",this._onBlur,!1),this._idleTimeout=4e3,this._prevEventTimeStamp=Hn(),this._modules.events.onAnyEvent((()=>{const t=Hn();t-this._prevEventTimeStamp>this._idleTimeout&&this.resetKeys(),this._prevEventTimeStamp=t})),this._modules.settings.register("interactions.pan.keyboard",!0),this._modules.settings.register("interactions.zoom.keyboard",!0),this._setupManualControls()}_setupManualControls(){this.onKeyPress(xV,(()=>this._onKeyPress("zoomIn"))).onKeyPress(vV,(()=>this._onKeyPress("zoomOut"))).onKeyPress(pV,(()=>this._onKeyPress("moveUp"))).onKeyPress(mV,(()=>this._onKeyPress("moveDown"))).onKeyPress(_V,(()=>this._onKeyPress("moveLeft"))).onKeyPress(yV,(()=>this._onKeyPress("moveRight")))}setIdleTimeout(t){if(!isFinite(t)||t<=1)throw new TypeError("Idle timeout must be a positive number > 1");this._idleTimeout=t}resetKeys(){for(let t=0;t<this._pressed.length;t++)this._pressed[t]&&(this._pressed[t]=!1,this._modules.events.fire("keyup",{key:qd[t],code:t}))}onKeyPress(t,e){let s=[];if(typeof t=="number")s=[t];else if(typeof t=="string")s=t.split(" ");else{if(!Array.isArray(t))throw new TypeError(`${t} is not a number, string or array`);s=t}if(s.length===0)throw new Error("the array should contain at least one element");const n=s.map((o=>{if(typeof o=="number")return[o];if(typeof o=="string"){const a=n1[o];if(!a)throw new Error(`${o} is not a valid key identifier`);return a}throw new TypeError(`${o} is not a valid key identifier`)})),i=n.pop(),r={keys:n,handler:e};return i&&i.forEach((o=>{this._binds[o]||(this._binds[o]=[]),this._binds[o].push(r)})),this}isPressed(t){if(typeof t=="number")return this._pressed[t];if(typeof t=="string"){const e=n1[t];if(e)return e.some((s=>this._pressed[s]))}return!1}},EV=[{name:"color",isNode:!0},{name:"shape",isNode:!0},{name:"radius",isNode:!0},{name:"icon.content",isNode:!0},{name:"image.url",isNode:!0},{name:"image",isNode:!0},{name:"color",isNode:!1},{name:"shape",isNode:!1},{name:"width",isNode:!1}],ho=Math.PI,co=2*Math.PI,eM=Math.cos(ho/2-co/5),sM=Math.cos(ho/2-co/5*2),nM=Math.cos(ho/2-co/5*3),iM=Math.cos(ho/2-co/5*4),rM=Math.sin(-ho/2+co/5),oM=Math.sin(-ho/2+co/5*2),aM=Math.sin(-ho/2+co/5*3),lM=Math.sin(-ho/2+co/5*4),Lf=1.6,uM=3,SV=.9,Eg=.31,v_=1/3,AV=[8,3],wV=[3,3],Sg={position:"bottom",widgetWidth:130,fontFamily:"Arial",fontSize:10,fontColor:"black",titleFontSize:12,titleFontColor:"black",titleMaxLength:20,titleTextAlign:"left",shapeColor:"grey",backgroundColor:"white",borderColor:"black",borderRadius:0,borderWidth:1,innerMargin:10,outerMargin:5,circleStrokeWidth:3,titleFunction:t=>t[t.length-1]},TV=["widgetWidth","fontSize","titleFontSize","borderRadius","borderWidth","innerMargin","outerMargin","circleStrokeWidth"];function dM(t){return Array.isArray(t)?t.reduce(((e,s)=>e&&dM(s)),!0):t==="undefined"||!isNaN(Number(t))}function hM(t){return Array.isArray(t)?t.reduce(((e,s)=>Math.min(e,hM(s))),1/0):typeof(t=Number(t))=="number"?isNaN(t)?1/0:+t:1/0}function cM(t){return Array.isArray(t)?t.reduce(((e,s)=>Math.max(e,cM(s))),-1/0):typeof(t=Number(t))=="number"?isNaN(t)?-1/0:+t:-1/0}function oo(t){const e=["K","M","B","T","P","E","Z","Y"];if(t>9999){let s=0;for(;s<e.length&&t>999;)t/=1e3,s++;return(i1(t,3)+e[s-1]).toString()}return i1(t,4).toString()}function i1(t,e=3){const s=e===4?10:1;return t<10?Math.round(100*t*s)/(100*s):t<100?Math.round(10*t*s)/(10*s):t<1e3?Math.round(t*s)/s:Math.round(t)}function gM(t){return t.innerMargin+(t.titleFontSize+t.fontSize)*Lf}var CV=(t,e)=>t.isNode!==e.isNode?t.isNode?-1:1:t.title<=e.title?-1:1,LV=(t,e)=>t.height-e.height,NV=(t,e)=>t.isNode!==e.isNode?t.isNode?-1:1:e.height-t.height,MV=(t,e)=>t.isNode!==e.isNode?t.isNode?-1:1:t.content[0].title<=e.content[0].title?-1:1;function kV(t,e,s){const n=e.getContext("2d"),{x:i,y:r,height:o,isNode:a,styleProperty:l,title:u,mapping:h,iconFont:g,iconFontStyle:f}=s;FV(n,t,i,r,o),PV(n,t,u,i,r);const p=t.fontSize*Lf,y=t.fontSize/2*Lf*SV,_=t.fontSize*uM,x=t.fontSize,v=RV(t,a);let b=r+gM(t);const S=i+t.innerMargin+v/2,A=i+2*t.innerMargin+v,w=zd(h),L=dM(w),M=t.fontColor,F=t.shapeColor,O=Object.keys(h);if(L&&(O.sort(((G,j)=>Qr(h[j])-Qr(h[G]))),l==="radius"||l==="width")){const G=hM(w),j=cM(w);return(a?ZV:KV)(t,n,i,b,G,(G+j)/2,j,F)}O.forEach((G=>{const j=h[G];l==="color"&&(a?fM(n,S,b,y,G):DV(n,S,b,_,x,G)),l==="shape"&&(a?HV(n,S,b,y,G,F):WV(n,S,b,_,x,G,F)),l==="icon.content"&&OV(n,S,b,G,g,y,M,f),l!=="image"&&l!=="image.url"||BV(n,S,b,y,G),zV(n,t,A,b,j,L),b+=p}))}function IV(t,e,s,n,i,r){t.beginPath(),t.arc(e,s,n,0,co),t.strokeStyle=i,t.lineWidth=r,t.stroke()}function Fh(t,e,s,n,i="left",r="normal"){t.textAlign=i,t.textBaseline="middle",t.fillStyle=n,t.font=`${r} ${s}px "${e}"`}function RV(t,e){const s=e?1:uM;return t.fontSize*s}function FV(t,e,s,n,i){return XV(t,s,n,e.widgetWidth,i,e.borderRadius,e.backgroundColor,e.borderColor,e.borderWidth)}function PV(t,e,s,n,i){Fh(t,e.fontFamily,e.titleFontSize,e.titleFontColor,e.titleTextAlign);const r=e.titleTextAlign==="center",o=e.widgetWidth-2*e.innerMargin,a=t.measureText(s).width,l=n+(r?e.widgetWidth/2:e.innerMargin),u=i+e.titleFontSize/2+e.innerMargin;if(a>o){const h=o/a,g=(s.length*h|0)-2;s=s.substr(0,g)+""}t.fillText(s,l,u)}function zV(t,e,s,n,i,r){let o=i.join();if(r)if(i.length===1)o=oo(i[0]);else{const a=Qr(i),l=ql(i);o=`${oo(a)} - ${oo(l)}`}Fh(t,e.fontFamily,e.fontSize,e.fontColor),t.fillText(o,s,n)}function fM(t,e,s,n,i){t.beginPath(),t.arc(e,s,n,0,2*ho),t.fillStyle=i,t.fill()}function DV(t,e,s,n,i,r){t.fillStyle=r,t.fillRect(e-n/2,s-i/2,n,i)}function OV(t,e,s,n,i,r,o,a){Fh(t,i,2*r,o,"center",a),t.fillText(n,e,s)}function BV(t,e,s,n,i){if(typeof Image>"u")return;t._imgStore||(t._imgStore={});let r=t._imgStore[i];if(r)return t.drawImage(r,e-n,s-n,2*n,2*n);r=new Image,r.src=i,r.onload=()=>{t.drawImage(r,e-n,s-n,2*n,2*n)},t._imgStore[i]=r}function UV(t,e,s,n){t.fillRect(e-n,s-n*Eg,2*n,2*n*Eg),t.fillRect(e-n*Eg,s-n,2*n*Eg,2*n)}function GV(t,e,s,n){return t.beginPath(),t.moveTo(e-n,s),t.lineTo(e,s-n),t.lineTo(e+n,s),t.lineTo(e,s+n),t.fill()}function VV(t,e,s,n){t.beginPath(),t.moveTo(e,s-n),t.lineTo(e+eM*n,s+rM*n),t.lineTo(e+sM*n,s+oM*n),t.lineTo(e+nM*n,s+aM*n),t.lineTo(e+iM*n,s+lM*n),t.fill()}function jV(t,e,s,n){t.beginPath(),t.moveTo(e,s-n),t.lineTo(e+sM*n,s+oM*n),t.lineTo(e+iM*n,s+lM*n),t.lineTo(e+eM*n,s+rM*n),t.lineTo(e+nM*n,s+aM*n),t.fill()}function HV(t,e,s,n,i,r){switch(t.fillStyle=r,i){case"square":return t.fillRect(e-n,s-n,2*n,2*n);case"circle":return fM(t,e,s,n,r);case"cross":return UV(t,e,s,n);case"diamond":return GV(t,e,s,n);case"equilateral":return VV(t,e,s,n);case"star":return jV(t,e,s,n)}}function $V(t,e,s,n,i){t.fillRect(e-n/2,s-i/4,n*(1-v_),i/2),t.beginPath(),t.moveTo(e+n*(1-v_-.5),s-i/2),t.lineTo(e+n*(1-v_-.5),s+i/2),t.lineTo(e+n/2,s),t.fill()}function qV(t,e,s,n,i,r,o){t.beginPath(),t.moveTo(e-n/2,s),t.lineTo(e+n/2,s),t.strokeStyle=r,t.lineWidth=i/2,t.setLineDash(o==="dashed"?AV:wV),t.stroke()}function YV(t,e,s,n,i){t.beginPath(),t.moveTo(e-n/2,s-i/2),t.lineTo(e-n/2,s+i/2),t.lineTo(e+n/2,s),t.fill()}function WV(t,e,s,n,i,r,o){return t.fillStyle=o,r==="line"&&t.fillRect(e-n/2,s-i/4,n,i/2),r==="arrow"?$V(t,e,s,n,i):r==="dashed"||r==="dotted"?qV(t,e,s,n,i,o,r):r==="tapered"?YV(t,e,s,n,i):void 0}function XV(t,e,s,n,i,r,o,a,l){t.setLineDash([]),t.beginPath(),t.moveTo(e+r,s),t.lineTo(e+n-r,s),t.quadraticCurveTo(e+n,s,e+n,s+r),t.lineTo(e+n,s+i-r),t.quadraticCurveTo(e+n,s+i,e+n-r,s+i),t.lineTo(e+r,s+i),t.quadraticCurveTo(e,s+i,e,s+i-r),t.lineTo(e,s+r),t.quadraticCurveTo(e,s,e+r,s),t.closePath(),t.fillStyle=o,t.fill(),t.strokeStyle=a,t.lineWidth=l,t.stroke()}function ZV(t,e,s,n,i,r,o,a){const l=.7*t.fontSize,u=3*l,h=(l+u)/2,g=s+t.innerMargin+u,f=g+u+t.innerMargin,p=n+2*u-.5*t.innerMargin,y=t.circleStrokeWidth;for(const _ of[l,h,u])IV(e,g,p-_,_,a,y);Fh(e,t.fontFamily,t.fontSize,t.fontColor,"left"),e.fillText(oo(i),f,p+l-2*l),e.fillText(oo(r),f,p+l-2*h),e.fillText(oo(o),f,p+l-2*u)}function KV(t,e,s,n,i,r,o,a){const l=(t.widgetWidth-2*t.innerMargin)/3,u=t.fontSize,h=n-t.innerMargin/2,g=h+2*u,f=s+t.innerMargin;e.fillStyle=a,e.fillRect(f,h-u/2,l+1,u),e.fillRect(f+l,h-u/3,l+1,u/1.5),e.fillRect(f+2*l,h-u/6,l,u/3),Fh(e,t.fontFamily,t.fontSize,t.fontColor,"center"),e.fillText(oo(o),f+.5*l,g),e.fillText(oo(r),f+1.5*l,g),e.fillText(oo(i),f+2.5*l,g)}function QV(t,e,s,n){const i=n.outerMargin+gM(n),r=n.fontSize*Lf,o=i-.8*n.innerMargin;return e==="radius"||e==="width"?o+r*(s?3:2):o+Object.keys(t).length*r}function JV(t,e,s){const n={width:e.width,height:e.height};let i=!1;return!!(n.width&&n.height&&s)&&(i=t.position==="top"||t.position==="bottom"?nj(n,t,s,t.position==="bottom"):tj(n,t,s,t.position==="left"),i&&s.forEach((r=>kV(t,e,r))),i)}function tj(t,e,s,n){const i=e.widgetWidth+e.outerMargin,r=Math.floor((t.width-e.outerMargin)/i),o=t.height;let a=e.outerMargin,l=n?e.outerMargin:t.width-i,u=1;s=s.slice().sort(CV);for(let h=0;h<s.length;++h){const g=s[h];if(a+g.height>o){if(a===e.outerMargin)return!1;a=e.outerMargin,u+=1,n?l+=i:l-=i}g.x=l,g.y=a,a+=g.height}return u<=r}function ej(t,e,s){let n=null;for(let i=0;i<e.length;++i){const r=e[i];r.isNode!==t.isNode&&e.length!==1||!(n===null||r.height<e[n].height)||(n=i)}if(n!=null){const i=e[n];i.content.push(t),i.height+=t.height+s.outerMargin}}function sj(t){let e=0;for(let s=1;s<t.length;++s)t[s].height>t[e].height&&(e=s);return e}function nj(t,e,s,n){s=s.slice();const i=e.widgetWidth+e.outerMargin,r=Math.floor((t.width-e.outerMargin)/i),o=t.height-e.outerMargin,a=new Array(Math.min(r,s.length)),l=s.length;let u=0,h=0,g=0,f=0;for(let S=0;S<l;++S){const A=s[S];A.isNode?(u+=1,h+=A.height):(g+=1,f+=A.height)}const p=h+f,y=h/p,_=f/p;let x=Math.round(y*r);const v=Math.round(_*r);if(x>u?x=u:v>g&&(x=r-g),r===0)return!1;for(let S=0;S<a.length;S++)a[S]={content:[],height:0,isNode:S<x};for(let S=0;S<l;++S){const A=sj(s);ej(s[A],a,e),s.splice(A,1)}a.every((({content:S})=>S.length===1))?a.sort(MV):a.sort(NV);let b=e.outerMargin;for(let S=0;S<a.length;++S){const A=a[S];if(A.height>o)return!1;A.content.sort(LV);let w=0;for(let L=0;L<A.content.length;++L){const M=A.content[L];M.x=b,M.y=n?t.height-w-M.height-e.outerMargin:w+e.outerMargin,w+=M.height+e.outerMargin}b+=i}return!0}var ij=class extends Xe{constructor(){super(...arguments),this._enabled=!1,this._mustRefresh=!1,this._promises=[]}onMounted(){this._modules.events.on("frame",(()=>{this._enabled&&this._mustRefresh&&this._layer.refresh()})).on(["resize","reloadFonts"],(()=>{this._mustRefresh=!0}))}enable(t={}){const e=this._settings;return this._settings={...Sg,...t},this._mustRefresh=!this._enabled||!this._sameOptions(e,this._settings),this._enabled?Promise.resolve():(this._enabled=!0,this._layer=this._modules.layers.addCanvasLayer((s=>{this._drawOnCanvas(this._settings,s.canvas,bi());const n=this._promises;this._promises=[],n.forEach((i=>i())),this._mustRefresh=!1}),{isStatic:!0,noClear:!1}),this._layer.moveToTop(),this.refresh())}_afterNextUpdate(){return new Promise((t=>this._promises.push(t)))}_formatSettings(t,e){const s={...Sg,...t};return TV.forEach((n=>s[n]*=e)),s}disable(){return this._enabled&&(this._enabled=!1,this._layer.destroy()),Promise.resolve()}enabled(){return this._enabled}refresh(){return this._mustRefresh=!0,this._modules.dom.refresh(),this._afterNextUpdate()}destroy(){this._enabled=!1,this._mustRefresh=!1,this._settings={...Sg},this._promises=[]}getOptions(){return this._enabled?{...this._settings}:{...Sg}}getCurrentOptions(){return this._settings}_sameOptions(t,e){return t===e||Object.keys(t).reduce(((s,n)=>s&&t[n]===e[n]),!0)}_drawOnCanvas(t,e,s){const n=this._formatSettings(t,s);JV(n,e,this._computeWidgetList(n))}exportOnCanvas(t,e,s){return this._drawOnCanvas(e,t,s)}export(t={}){const{width:e,height:s}={...this._modules.camera.getSize(),...t},n=bi(),i=Pn(e*n,s*n);return this._drawOnCanvas(t,i,n),Promise.resolve().then((()=>i))}_computeWidgetList(t){const e=[];return EV.forEach((({name:s,isNode:n})=>{const i=this._computeWidget(t,s,n);i&&e.push(i)})),e}_computeWidget(t,e,s){const n=this._computePropertyMapping(t,e,s);if(n){if(e!=="icon.content")return n;const i=this._getRulesForAttribute(s,"icon.font"),r=this._getRulesForAttribute(s,"icon.style");let o=null,a=null;if(i.length||(o="Arial",a="normal"),typeof i[0]=="string"&&(o=i[0],a=r[0]),o&&a)return n.iconFont=o,n.iconFontStyle=a,n}return null}_computePropertyMapping(t,e,s){const[n]=this._getRulesForAttribute(s,e),i=n&&n.mapping,r=i&&i.getValues(s);if(i&&r){const o=i.getField(),a={};return Mr(r,((l,u)=>{l!==void 0&&u!=="undefined"&&(a[l]=a[l]||[],a[l].push(u))})),Object.keys(a).length===0?null:{isNode:s,title:t.titleFunction(o,e),styleProperty:e,dataProperty:o,mapping:a,height:QV(a,e,s,t)}}return null}_getRulesForAttribute(t,e){return this._modules.styleRules.getRuleList().map((s=>{const n=s.getDefinition();return Ys(t?n.nodeAttributes:n.edgeAttributes,e)})).filter(hr).sort(((s,n)=>s.mapping&&n.mapping?0:s.mapping?-1:1))}},r1={layer:W2,outerStroke:{color:EL,width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:SL,minVisibleSize:0}},rj={layer:W2,color:EL,text:{backgroundColor:SL,minVisibleSize:0}},o1={duration:150,easing:"quadradicOut"},oj=class extends Xe{constructor(){super(...arguments),this._delay=16,this._manualTriggerDetection=!1,this._hovered=null,this._hoveredTextHidden=!1,this._onAnimate=({updatesPositions:t})=>{t&&this._hovered&&this._modules.graphics.isMoving(this._hovered)&&(this._manualTriggerDetection=!0,this._resetHover())},this._onBeforeNewFrame=()=>{if(this._manualTriggerDetection){this._manualTriggerDetection=!1,this._modules.captor.triggerDetection();const t=this._modules.captor.getPointedElement();t&&this._hover(t)}},this._onClear=()=>{this._hovered=null,this._timeout&&this._modules.dom.clearTimeout(this._timeout)},this._resetHover=()=>{this._hovered&&(this._unhover(this._hovered),this._modules.captor.triggerUnhover()),this._timeout&&(this._modules.dom.clearTimeout(this._timeout),this._timeout=null)}}_setAnimationOptions(t){this._animationOptions={duration:(t==null?void 0:t.duration)!==void 0?t.duration:o1.duration,easing:(t==null?void 0:t.easing)!==void 0?t.easing:o1.easing},t==null||delete t.duration,t==null||delete t.easing}setRate(t){return this._delay=t,this}replaceNullColor(t,e){t&&Ys(t,e)===null&&no(t,e,this._modules.settings.get("backgroundColor"))}updateNodeAttributes(t,e){this._setAnimationOptions(t),this.replaceNullColor(t,"text.backgroundColor"),this._hoverClass.update({nodeAttributes:t,fullOverwrite:e}),this._hoverExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()}updateEdgeAttributes(t,e){this.replaceNullColor(t,"text.backgroundColor"),this.replaceNullColor(t,"text.secondary.backgroundColor"),this._setAnimationOptions(t),this._hoverClass.update({edgeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()}getHoverClassDefinition(){return this._hoverClass.getDefinition()}onMounted(){this._registerSettings(),this._setAnimationOptions(null),this._hoverExtremityHighlightedClass=this._modules.classes.createClass({name:by,isBuiltin:!0,nodeAttributes:r1}),this._hoverClass=this._modules.classes.createClass({name:Od,isBuiltin:!0,nodeAttributes:r1,edgeAttributes:rj}),this._modules.events.on("mouseover",(({target:t})=>t&&this._hover(t))).on("mouseout",(({target:t})=>t&&this._unhover(t))).on("animate",this._onAnimate).on("beforeNewFrame",this._onBeforeNewFrame).on("mouseout",this._resetHover).on("clearGraph",this._onClear)}_registerSettings(){this._modules.settings.register("cursor.node","pointer",((t,e)=>{this._hovered&&this._hovered.isNode&&(this._modules.graphics.removeCursorStyle(e),this._modules.graphics.addCursorStyle(t))})),this._modules.settings.register("cursor.edge","pointer",((t,e)=>{this._hovered&&!this._hovered.isNode&&(this._modules.graphics.removeCursorStyle(e),this._modules.graphics.addCursorStyle(t))})),this._modules.settings.register("nodeHover",!0,(t=>{!t&&this._hovered&&this._hovered.isNode&&this._unhover(this._hovered)})),this._modules.settings.register("edgeHover",!0,(t=>{t||!this._hovered||this._hovered.isNode||this._unhover(this._hovered)}))}setEdgeExtremitiesAttributes(t,e){this._hoverExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e})}_updateExtremityHighlightLayer(){const t=this._hoverClass.getDefinition().edgeAttributes,e=t?t.layer:void 0;this._hoverExtremityHighlightedClass.update({nodeAttributes:{layer:e},fullOverwrite:!1})}_removeTimeout(){this._timeout&&(this._modules.dom.clearTimeout(this._timeout),this._timeout=null)}_hover(t){const e=t.isNode?"nodeHover":"edgeHover";this._modules.settings.get(e)&&t&&(t.hasClass(ti)||(this._removeTimeout(),this._timeout=this._modules.dom.setTimeout((()=>{this._setElementHighlight(!0,t),this._timeout=null}),this._delay)))}_unhover(t){this._removeTimeout(),this._hovered===t&&(this._setElementHighlight(!1,t),this._hoverExtremityHighlightedClass.clearNodes(),this._hovered=null)}_setElementHighlight(t,e){const s=this._modules.settings.get(e.isNode?"cursor.node":"cursor.edge");if(t?(this._modules.graphics.addCursorStyle(s),e.addClass(Od,this._animationOptions),this._hovered=e):(this._modules.graphics.removeCursorStyle(s),e.removeClass(Od,this._animationOptions)),e.isNode){const n=this._modules.graph.getAttribute(e.isNode,"textHidden"),i=e._index;t&&(this._hoveredTextHidden=n.get(i)!==0);const r=!t&&this._hoveredTextHidden;n.set(i,r)}else this._hoverExtremityHighlightedClass.clearNodes(),t&&e.getExtremities().filter((n=>!n.isDisabled())).addClass(by,this._animationOptions)}},aj={layer:X2,color:Uy,text:{backgroundColor:l3,color:Uy},innerStroke:A0,detectable:!1},lj={layer:X2,color:A0,text:{color:Uy},detectable:!1},uj=class extends Xe{constructor(){super(...arguments),this.shouldTriggerEvents=!0}setDisabledNodeAttributes(t,e){this._disabledClass.update({nodeAttributes:t,fullOverwrite:e})}setDisabledEdgeAttributes(t,e){this._disabledClass.update({edgeAttributes:t,fullOverwrite:e})}updateNodeAttributes(t,e){this.setDisabledNodeAttributes(t,e)}updateEdgeAttributes(t,e){this.setDisabledEdgeAttributes(t,e)}onMounted(){this.shouldTriggerEvents=!0,this._modules.events.register(["nodesDisabled","nodesEnabled","edgesDisabled","edgesEnabled"]),this._disabledClass=this._modules.classes.createClass({name:ti,isBuiltin:!0,nodeAttributes:aj,edgeAttributes:lj}),this._modules.events.on(`nodeClassAdded_${ti}`,(t=>{this.shouldTriggerEvents&&this._modules.events.fire("nodesDisabled",t)})),this._modules.events.on(`edgeClassAdded_${ti}`,(t=>{this.shouldTriggerEvents&&this._modules.events.fire("edgesDisabled",t)})),this._modules.events.on(`nodeClassRemoved_${ti}`,(t=>{this.shouldTriggerEvents&&(this._modules.events.fire("nodesEnabled",t),this._modules.styleRules.refreshAllRules())})),this._modules.events.on(`edgeClassRemoved_${ti}`,(t=>{this.shouldTriggerEvents&&(this._modules.events.fire("edgesEnabled",t),this._modules.styleRules.refreshAllRules())})),this._modules.events.on("excludedStateChange",(({elements:t,value:e})=>{e||t.setDisabled(!1)}))}setActive(t,e){if(Nn(e)){const s=[],n=[];if(t.toList().forEach(((i,r)=>{(e[r]?s:n).push(i.getId())})),s.length!==0){const i=this._modules.graph.getElements(t.isNode,s);i.addClass(ti),i.removeClass(Ts)}n.length!==0&&this._modules.graph.getElements(t.isNode,n).removeClass(ti)}else t.size&&(t[e?"addClass":"removeClass"](ti),e&&t.removeClass(Ts))}areActive(t){return t.hasClass(ti)}getDisabledNodes(){return this._disabledClass.getNodes()}getDisabledEdges(){return this._disabledClass.getEdges()}getEnabledNodes(){return this._modules.graph.getNodes().filter((t=>!t.hasClass(ti)))}getEnabledEdges(){return this._modules.graph.getEdges().filter((t=>!t.hasClass(ti)))}disableEvents(){this.shouldTriggerEvents=!1}enableEvents(){this.shouldTriggerEvents=!0}clear(){this._disabledClass.clearNodes(),this._disabledClass.clearEdges()}},dj=class extends Xe{constructor(){super(...arguments),this.x=0,this.y=0}},hj=class{constructor(t,e){this._nodeMapping={valid:!1,values:{}},this._edgeMapping={valid:!1,values:{}},this._computeMapping=e,this._field=t,this._assignedRules=[]}getValue(t,e){const s=t.isNode,n=s?this._nodeMapping:this._edgeMapping;n.valid||(n.values=this._computeMapping(s),n.valid=!0);const i=t.getData(this._field);return Array.isArray(i)?e==="color"?i.map((r=>n.values[r])):n.values[i[0]]:n.values[i]}markAsInvalid(){this._nodeMapping.valid=!1,this._edgeMapping.valid=!1}getValues(t){return t?this._nodeMapping.values:this._edgeMapping.values}getField(){return this._field}isAssignedTo(t){return this._assignedRules.find((e=>e===t))}getAssignedRules(){return this._assignedRules.slice()}assignTo(t){this.isAssignedTo(t)||this._assignedRules.push(t)}unAssignTo(t){this._assignedRules=this._assignedRules.filter((e=>e!==t))}};function pM(t,e,s){const n=(e?t.getNodes():t.getEdges()).getData(s),i={};return n.forEach((r=>{if(!Array.isArray(r))return i[r]=1;r.forEach((o=>i[o]=1))})),Object.keys(i).sort()}function cj(t,e,s,n){const{values:i={},fallback:r}=s,o=pM(t,n,e),a={};let l=0;for(let u=0;u<o.length;++u){const h=o[u];h in i?a[h]=i[h]:(a[h]=r[l],l=(l+1)%r.length)}return a}function gj(t,{nbSlices:e,minValue:s,maxValue:n}){if(Array.isArray(t))return t.slice();const{min:i=s,max:r=n}=t,o=(r-i)/e,a=[];for(let l=1;l<e;++l)a.push(i+o*l);return a}function fj(t,e){if(Array.isArray(t))return t;const{min:s,max:n}=t,i=e.length+1,r=(n-s)/e.length,o=[];for(let a=0;a<i;a++)o.push(s+a*r);return o}function pj(t,e,s,n){const{fallback:i,stops:r={},values:o,reverse:a}=s,l=pM(t,n,e);let u=1/0,h=-1/0;for(let y=0;y<l.length;y++){const _=+l[y];tp(_)&&(u=Math.min(u,_),h=Math.max(h,_),l[y]=_)}const g={};if(!isFinite(u)){for(let y=0;y<l.length;y++)g[l[y]]=i;return g}const f=gj(r,{nbSlices:Array.isArray(o)?o.length:o.nbSlices,minValue:u,maxValue:h}),p=fj(o,f);a&&p.reverse();for(let y=0;y<l.length;++y){const _=l[y];if(isFinite(_)){let x=0;for(;x<f.length&&f[x]<=_;)x+=1;g[_]=p[x]}else g[_]=i}return g}var mj=class extends Xe{constructor(){super(...arguments),this._mappingList=[],this._onStyleRuleRemoved=({rule:t})=>{for(const e of this._mappingList)e.unAssignTo(t.id)},this._onStyleRuleAdded=({rule:t,options:e})=>{const s=e.nodeAttributes&&typeof e.nodeAttributes!="function"?e.nodeAttributes:{},n=e.edgeAttributes&&typeof e.edgeAttributes!="function"?e.edgeAttributes:{};[...zd(s),...zd(n)].forEach((i=>{i&&this._recursiveGetMapping(i).forEach((r=>r.assignTo(t.id)))}))},this._refreshRulesAndLegend=()=>{this._mappingList.forEach((t=>{const e=t.getAssignedRules();t.markAsInvalid(),e.forEach((s=>this._modules.styleRules.refreshRule(s)))})),this._modules.legend.refresh()}}onMounted(){this._modules.events.on(["addStyleRule","updateStyleRule"],this._onStyleRuleAdded).on("removeStyleRule",this._onStyleRuleRemoved).on(["addNodes","addEdges","updateNodeData","updateEdgeData","removeNodes","beforeRemoveEdges","excludedStateChange","clearGraph"],this._refreshRulesAndLegend)}_recursiveGetMapping(t,e=[]){if(!t)return e;if(t.mapping)return e.push(t.mapping),e;if(typeof t!="object")return e;const s=zd(t).map((n=>this._recursiveGetMapping(n)));return e.concat(...s)}createMapping({field:t,values:e={},fallback:s}={field:""}){if(t=Ua(t),Array.isArray(s)?s.length===0&&(s=[void 0]):s=[s],!Ga(e))throw new Error('"mapping" should be an object');return this._createMappingFunction(cj,t,{values:e,fallback:s})}createSlices({field:t,fallback:e,stops:s={},values:n,reverse:i=!1}={field:"",values:[]}){if(t=Ua(t),Array.isArray(n)||n.nbSlices||(n.nbSlices=7),Array.isArray(s)&&Array.isArray(n)&&s.length!==n.length-1)throw new Error("there should be exactly one more value that stops");return this._createMappingFunction(pj,t,{fallback:e,stops:s,values:n,reverse:i})}_createMappingFunction(t,e,s){const n=new hj(e,(r=>t(this._modules.graph,e,s,r)));this._mappingList.push(n);const i=(r,o,a)=>n.getValue(r,a);return i.mapping=n,i}createTemplate(t){if(typeof t!="string")throw new TypeError('"template" should be a string');const e=[];let s=0,n=!1;for(;!n;){let i=-1;const r=t.indexOf("{{",s);r!==-1&&(i=t.indexOf("}}",r+2)),i!==-1?(e.push(t.substring(s,r)),e.push(t.substring(r+2,i)),s=i+2):(e.push(t.slice(s)),n=!0)}return function(i){let r=e[0];for(let o=1;o<e.length;o+=2)r+=i.getData(e[o]),r+=e[o+1];return r}}},a1=t=>t.stopPropagation(),_j=(t,e)=>{e.style.position="absolute",e.style.left="0",e.style.top="0",t.appendChild(e)},yj=t=>e=>{for(;t.firstChild;)t.removeChild(t.firstChild);for(let s=0;s<e.length;++s)_j(t,e[s])},xj=(t,e)=>{const s=document.createElement("img");return new Promise((n=>{s.addEventListener("load",(()=>{e.drawImage(s,0,0,e.canvas.width,e.canvas.height),n(e)}));const i=`data:image/svg+xml;base64,${btoa(new XMLSerializer().serializeToString(t))}`;s.src=i}))},vj=class extends Xe{constructor(){super(...arguments),this._elements=[],this._layers=[],this.readyCallbacks=[],this.render=(t,e,s,n)=>{const i=n&&n.pixelRatio?n.pixelRatio:bi(),{zoom:r,x:o,y:a,width:l,height:u}=n||this._modules.camera.getView();if(r===void 0||o===void 0||a===void 0||l===void 0||u===void 0)return null;const h=i*r;s.noClear||t.clearRect(0,0,l*i,u*i),s.isStatic||(t.save(),t.translate(l*i/2,u*i/2),t.rotate(n?-(n.angle||0):-this._modules.camera.getAngle()),t.translate(-o*h,-a*h),t.scale(h,h)),e(t),s.isStatic||t.restore()},this.createCanvas=(t,e)=>{const{width:s,height:n}=this._modules.camera.getSize(),i=e.canvas||Pn(s,n),r=e.ctx||i.getContext("2d"),o=(h=t)=>{r&&this.render(r,h,e)},a=()=>{const{width:h,height:g}=this._modules.camera.getSize(),f=bi();i.width=h*f,i.height=g*f,i.style.width=`${h}px`,i.style.height=`${g}px`,o()};let l,u;if(e.isStatic)this._modules.events.on("resize",a),l=()=>this._modules.events.off(a);else{let h=this._modules.camera.getCenter(),g=this._modules.camera.getZoom(),f=!1;const p=0;let y;const _=500,x=()=>{f||(o(),f=!0,h=this._modules.camera.getCenter(),g=this._modules.camera.getZoom())},v=()=>{f||x();const{x:A,y:w}=this._modules.camera.getCenter(),L=A-h.x,M=w-h.y,F=-L*g,O=-M*g,G=this._modules.camera.getZoom()/g,j=-this._modules.camera.getAngle();i.style.transform=`
          scale(${G})
          rotate(${-j}rad)
          translateX(${F}px)
          translateY(${O}px)
          rotate(${j}rad)
        `.replace(/\n/g,"")};u=()=>!f||(o(),f=!1,i.style.transform="scale(1) translateX(0px) translateY(0px)",!1);const b=A=>{y&&clearTimeout(y),x()},S=A=>{Date.now()<p&&y&&clearTimeout(y),y=setTimeout(u,A.duration+_),x()};this._modules.events.on("dragStart",b).on("zoomStart",S).on("dragEnd",u).on(["viewChanged","zoom","rotate","move","animate"],v),this._modules.dom.addDirectWindowEventListener("resize",u),this._modules.events.on("resize",a),l=()=>{this._modules.events.off(a).off(b).off(S).off(u).off(v),this._modules.dom.removeDirectWindowEventListener("resize",u)}}return i.style.touchAction="none",i.style.pointerEvents="none",a(),{element:i,removeListeners:l,refresh:h=>{u&&!u()||o(h)},clear:()=>r==null?void 0:r.clearRect(0,0,i.width,i.height)}},this.createSVG=t=>{const{element:e}=t;e.style["pointer-events"]="none";const s=()=>{t.draw(t.element)},n=i=>{let{zoom:r,x:o,y:a,width:l,height:u}=i||this._modules.camera.getView();if(l=Math.floor(l),u=Math.floor(u),r===void 0||o===void 0||a===void 0||l===void 0||u===void 0)return null;const h=l/2/r,g=u/2/r,f=Math.cos(-this._modules.camera.getAngle()),p=Math.sin(-this._modules.camera.getAngle()),y=f*o-p*a-h,_=p*o+f*a-g,x=l/r,v=u/r;e.style.width=`${l}px`,e.style.height=`${u}px`,e.setAttribute("width",`${l}`),e.setAttribute("height",`${u}`),e.setAttribute("viewBox",`${y} ${_} ${x} ${v}`)};return this._modules.events.on(["viewChanged","zoom","rotate","move","animate","afterImageExport"],(()=>n())),e.addEventListener("mousemove",a1),n(),s(),{element:e,removeListeners:()=>{this._modules.events.off(n)},updateTransformation:n,refresh:s}},this._createOverlay=t=>{const e=()=>{const{element:i,position:r}=t,{zoom:o,x:a,y:l,width:u,height:h}=this._modules.camera.getView();if(o===void 0||a===void 0||l===void 0||u===void 0||h===void 0)return null;const g=o,f=u/2,p=h/2,y=-this._modules.camera.getAngle(),_=(r.x-a)*g,x=(r.y-l)*g;i.style.transformOrigin="top left",i.style.transform=`translate(${f}px, ${p}px) rotate(${y}rad) translate(${_}px, ${x}px) ${t.scaled?`scale(${g}, ${g})`:""}`};this._modules.events.on(["viewChanged","zoom","rotate","move","animate","afterImageExport"],e);const{element:s,size:n}=t;return n&&(s.style.width=`${n.width}`,s.style.height=`${n.height}`),s.addEventListener("mousemove",a1),e(),{element:s,removeListeners:()=>{this._modules.events.off(e)},updateTransformation:e}},this.addLayer=(t,e="layer",s=this._elements.length)=>{const n=typeof t=="string"?cy(t):t;this._elements.push(n);const i={element:n};return i.type=e,i.getLevel=()=>this._elements.indexOf(n),i.moveTo=r=>(this._elements.splice(r,0,this._elements.splice(i.getLevel(),1)[0]),this._updateDom(this._elements),i),i.moveUp=()=>i.moveTo(i.getLevel()+1),i.moveDown=()=>i.moveTo(i.getLevel()-1),i.moveToTop=()=>i.moveTo(this._elements.length-1),i.moveToBottom=()=>i.moveTo(0),i.destroy=()=>this._removeLayer(i),i.hide=()=>(i.element&&(i.element.style.visibility="hidden"),i),i.show=()=>(i.element&&(i.element.style.visibility="visible"),i),i.isHidden=()=>i.element.style.visibility==="hidden",i.setOpacity=r=>(i.element&&(i.element.style.opacity=r.toString()),i),i.getOpacity=()=>parseFloat(i.element.style.opacity||"1"),i.setPosition=r=>{if(i.element){const o=i.element.style;o.left=`${r.x}px`,o.top=`${r.y}px`}return i},i.setSize=r=>{if(i.element&&r){const{width:o,height:a}=r,l=i.element.style;l.width=`${o}px`,l.height=`${a}px`}return i},i.moveTo(s),this._layers.push(i),i},this.addCanvasLayer=(t,e={isStatic:!1,noClear:!1},s=this._elements.length)=>{const n=this.createCanvas(t,e),{element:i,removeListeners:r,refresh:o,clear:a}=n,l=this.addLayer(i,"canvas",s);return i.classList.add("ogma-canvas-layer"),l.destroy=()=>this._removeLayer(l,r),l.refresh=o,l.clear=a,l.draw=t,l.options=e,l},this.addOverlay=(t,e=this._elements.length)=>{typeof t.element=="string"&&(t.element=cy(t.element)),t.scaled=t.scaled===void 0||t.scaled;const s=this._createOverlay(t),{element:n,removeListeners:i,updateTransformation:r}=s,o=this.addLayer(n,"overlay",e);return o._onViewChange=r,o._onDestroy=i,o.destroy=()=>this._removeLayer(o,i),o.setPosition=a=>(t.position=a,r(),o),t.size&&o.setSize(t.size),o},this.addSVGLayer=(t,e=this._elements.length)=>{const s=this.createSVG(t),{element:n,refresh:i,removeListeners:r,updateTransformation:o}=s,a=this.addLayer(n,"svg",e);return a._onViewChange=o,a._onDestroy=r,a.destroy=()=>this._removeLayer(a,r),a.refresh=i,a}}canvasToImage(t,e){const s=document.createElement("canvas");s.width=e.width,s.height=e.height;const n=s.getContext("2d");this.render(n,t.draw,{...t.options,noClear:!0},{...e,pixelRatio:1});const i=ys("image");return i.setAttribute("href",s.toDataURL("image/png")),i.setAttribute("width",s.width),i.setAttribute("height",s.height),i}exportPNG(t,e,s){const n=t.getContext("2d");let i=Promise.resolve();return e.forEach((r=>{i=i.then((()=>{var o;if(r.type!=="canvas")return(o=r._onViewChange)==null||o.call(r,s),xj(r.element,n);this.render(n,r.draw,{...r.options,noClear:!0},s)}))})),i}exportSVG(t,e,s,n){let i=Promise.resolve();return e.forEach((r=>{i=i.then((()=>{var o;return r.type==="canvas"?this.canvasToImage(r,s):((o=r._onViewChange)==null||o.call(r,s),r.refresh(),r.element.cloneNode(!0))})).then((o=>n?t.insertBefore(o,t.querySelector(".ogma-nodes").parentNode||t.firstChild):t.appendChild(o)))})),i}export(t){const e=this._layers.sort(((i,r)=>i.getLevel()-r.getLevel())).filter((i=>i.type==="canvas"||i.type==="svg")),s=this.ogmaLayer?this.ogmaLayer.getLevel():0,n=t.below?e.filter((i=>i.getLevel()<s)):e.filter((i=>i.getLevel()>s));return t.canvas?this.exportPNG(t.canvas,n,t.view):this.exportSVG(t.svg,n,t.view,t.below)}onMounted(){const t=this._modules.graphics.getDomElement();this._updateDom=yj(t);const e=t.firstChild;e&&(this.ogmaLayer=this.addLayer(e)),this.runCallbacks()}runCallbacks(){this.ogmaLayer&&(this.readyCallbacks.forEach((t=>t())),this.readyCallbacks=[])}whenReady(t){this.readyCallbacks.push(t),this.ogmaLayer&&this.runCallbacks()}_removeLayer(t,e){return t.element&&t.element.parentNode&&(this._elements.splice(t.getLevel(),1),e&&e(),t.element=null,this._updateDom(this._elements)),this._layers=this._layers.filter((s=>s!==t)),t}destroy(){this._elements=[]}},bj=class extends Xe{onMounted(){const t=this._modules.graph;this._nodeList=t.getNodeAttribute("object"),this._edgeList=t.getEdgeAttribute("object"),this._sourceList=t.getEdgeAttribute("source"),this._targetList=t.getEdgeAttribute("target"),this._excludedList=t.getEdgeAttribute("excluded"),this._virtualList=t.getEdgeAttribute("virtual")}shortestPath(t={source:void 0,target:void 0}){const{source:e,target:s,directed:n=!1,edges:i=this._ogma.getEdges(),nodes:r=this._ogma.getNodes(),edgeCostFunction:o=(()=>1),heuristicFunction:a=(()=>0)}=t,l=i.reduce(((_,x)=>(_[x._index]=!0,_)),{}),u=r.reduce(((_,x)=>(_[x._index]=!0,_)),{}),h=this._modules.graph.getNode(e),g=this._modules.graph.getNode(s);if(!h)throw new Error("the source is not a node");if(!g)throw new Error("the target is not a node");const f=h._index,p=g._index;u[f]=!0,u[p]=!0;let y=null;if(f===p)y={nodes:h.toList(),edges:this._modules.graph.edgeList()};else{const _=this._modules.graph.getNodeMaxIndex()+1,x=new Int32Array(_),v=new Float32Array(_),b=new Float32Array(_),S=new Set,A=new D2(b);for(v.fill(1/0),b.fill(1/0),x.fill(-1),A.add(f),v[f]=0,b[f]=a(h,g);!A.isEmpty();){const w=A.removeMin();if(w===p){y=this._constructPath(x,f,p);break}S.add(w);const L=this._modules.graph.getAdjacentDirections(w);if(L)for(let M=0;M<L.length;++M){const F=L[M],O=this._modules.graph.getEdgeIndexesInDirection(F);let G=-1,j=0,Z=-1;for(let at=0;at<O.length;++at){const pt=O[at],K=this._sourceList.get(pt),ut=this._targetList.get(pt);if(K===ut||!u[K]||!u[ut]||n&&w!==K||!l[pt])continue;const ht=o(this._edgeList.get(pt));(G===-1||ht<j)&&(G=pt,j=ht,Z=K===w?ut:K)}if(Z!==-1||S.has(Z)){const at=v[w]+j;if(!A.has(Z)||at<v[Z]){const pt=this._nodeList.get(w);x[Z]=G,v[Z]=at,b[Z]=at+a(pt,g),A.add(Z)}}}}}return Promise.resolve(y)}_constructPath(t,e,s){const n=[s],i=[];let r=s;for(;r!==e;){const o=t[r],a=this._sourceList.get(o),l=this._targetList.get(o);r=r===a?l:a,n.push(r),i.push(o)}return n.reverse(),i.reverse(),{nodes:this._modules.graph.nodeList(new Uint32Array(n)),edges:this._modules.graph.edgeList(new Uint32Array(i))}}detectCycle(t,e){const s=e.getSource(),n=e.getTarget(),i=I2(t._indexes,s._indexes,n._indexes);return i?this._modules.graph.nodeList(new Uint32Array(i)).dedupe():this._modules.graph.nodeList()}getAllSimpleCycles(t,e){const s=e.getSource(),n=e.getTarget();return new F2(t._indexes,s._indexes,n._indexes).getCycles().map((i=>this._modules.graph.nodeList(new Uint32Array(i))))}minimumSpanningTree(t,e,s){const n=this._modules.graph;t=n.getNodes(t),e=n.getEdges(e);const i=new Set;t.forEach((l=>i.add(l._index)));const r=n.getConnectedComponents(t,{filter:l=>i.has(l),internalIndexes:!0}),o={};r.forEach(((l,u)=>l.forEach((h=>o[h]=u))));const a=[];return e.forEach((l=>{const u=o[l.getSource()._index];u!==void 0&&(a[u]===void 0&&(a[u]=[]),a[u].push(l._index))})),r.map(((l,u)=>{const h=P2(l,a[u]||[],(g=>n.edge(g).getSource()._index),(g=>n.edge(g).getTarget()._index),s?g=>s(n.edge(g)):void 0);return{nodes:n.nodeList(new Uint32Array(l)),edges:n.edgeList(new Uint32Array(h))}}))}bfs({root:t,onNode:e,onEdge:s=as,directed:n=!1}){const i=this._modules.graph,r=[t],o=new Set,a={direction:n?"out":"both"};for(;r.length;){const l=r.pop();if(!o.has(l._index)){if(e(l)===!0)return;o.add(l._index),i.getAdjacentEdges(l,a).forEach((u=>{if(s(u)===!1)return;const h=u.getSource()===l?u.getTarget():u.getSource();r.unshift(h)}))}}}dfs({root:t,onNode:e,onEdge:s=as,directed:n=!1}){const i=this._modules.graph,r=[t],o=new Set,a={direction:n?"out":"both"};for(;r.length;){const l=r.pop();if(!o.has(l._index)){if(e(l)===!0)return;o.add(l._index),i.getAdjacentEdges(l,a).forEach((u=>{if(s(u)===!1)return;const h=u.getSource()===l?u.getTarget():u.getSource();r.push(h)}))}}}betweenness({nodes:t,edges:e,directed:s,normalized:n}){const i=this._ogma.getNodes().subtract(t),r=this._ogma.getEdges().subtract(e).concat(i.fastGetAdjacentElements().edges).dedupe();return z2({adjacency:t.map((o=>{const a=this._ogma.edgeList(this._ogma.modules.graph.topology.getAdjacentElements(!1,o.toList()._indexes,{direction:s?"out":"both"})).subtract(r).dedupe();return{id:o._index,adj:a.map((l=>l.getSource()._index===o._index?l.getTarget()._index:l.getSource()._index))}})),directed:s,normalized:n})}fishEyeExpand(t,e,s,n){return N2(t,e,s,n)}},l1=(t,e)=>{if(!t)throw new Error("Traversal options are required");if(typeof t.onNode!="function")throw new Error("onNode callback is required");if(t.root=e.getNode(t.root),!t.root)throw new Error(`Root node '${t.root}' does not exist`);return t},Ag=()=>({nodes:void 0,edges:void 0}),Ej=class extends Ps{constructor(){super(...arguments),this.shortestPath=t=>this._ogma.modules.algorithms.shortestPath(t),this.hasCycle=t=>{const{nodes:e,edges:s}=t||Ag();return this.detectCycle({nodes:e,edges:s})!==null},this.getAllSimpleCycles=t=>{let{nodes:e,edges:s}=t||Ag();return e||(e=this._ogma.getNodes()),s||(s=e.getAdjacentEdges({bothExtremities:!0})),this._ogma.modules.algorithms.getAllSimpleCycles(e,s)},this.detectCycle=t=>{let{nodes:e,edges:s}=t||Ag();e||(e=this._ogma.getNodes()),s||(s=e.getAdjacentEdges({bothExtremities:!0}));const n=this._ogma.modules.algorithms.detectCycle(e,s);return n.size?n:null},this.minimumSpanningTree=t=>{const{nodes:e,edges:s,edgeCostFunction:n}=t||{...Ag(),edgeCostFunction:void 0};return this._ogma.modules.algorithms.minimumSpanningTree(e,s,n)},this.dfs=t=>this._ogma.modules.algorithms.dfs(l1(t,this._ogma.modules.graph)),this.bfs=t=>this._ogma.modules.algorithms.bfs(l1(t,this._ogma.modules.graph)),this.betweenness=(t={})=>(t={nodes:t.nodes||this._ogma.getNodes(),edges:t.edges||this._ogma.getEdges(),directed:t.directed!==void 0&&t.directed,normalized:t.normalized===void 0||t.normalized},this._ogma.modules.algorithms.betweenness(t)),this.getMinimumEnclosingCircle=t=>{if(!t||t.size===0)throw new Error("getMinimumEnclosingCircle: no nodes provided");const e=t.getAttribute("x"),s=t.getAttribute("y"),n=t.getAttribute("radius"),[i,r,o]=wh(e,s,n);return{x:i,y:r,radius:o}},this.circlePack=({nodes:t,margin:e=0,origin:s={x:0,y:0},duration:n=0,easing:i="linear",sort:r,dryRun:o})=>{if(!t||t.size===0)throw new Error("circlePack: no nodes provided");let a=t.map(((u,h)=>({index:h,radius:+u.getAttribute("radius")+e,id:u.getId()})));if(r)if(r==="asc")a=a.sort(((u,h)=>h.radius-u.radius));else if(r==="desc")a=a.sort(((u,h)=>u.radius-h.radius));else{if(typeof r!="function")throw new Error("circlePack: invalid sort option");a=a.sort(((u,h)=>r(t.get(u.index),t.get(h.index))))}if(s&&(!isFinite(s.x)||!isFinite(s.y)))throw new Error("circlePack: invalid origin");const l=L2(a,s.x,s.y).reduce(((u,{index:h,x:g,y:f})=>(u[h]={x:g,y:f},u)),new Array(t.size));return o?l:t.setAttributes(l,{duration:n,easing:i}).then((()=>l))},this.fishEyeExpand=({nodes:t,focusNode:e,deltaRadius:s,duration:n=0,dryRun:i=!1,easing:r="linear",xyr:o})=>{if(!t||t.size===0)throw new Error("Expand/collapse: no nodes provided");if(!(e instanceof xi))throw new Error("Expand/collapse: no focus node provided");if(!isFinite(s))throw new Error("Expand/collapse: invalid delta radius");const a=this._ogma.modules.algorithms.fishEyeExpand(t,e,s,o);return i?a:t.setAttributes(a,{duration:n,easing:r}).then((()=>a))}}},Sj=class{getHoveredElement(){return this.modules.captor.getPointedElement()}getPointerInformation(){return this.modules.captor.getCursorInformation()}},Aj=class{getNodesByClassName(t,e){return this.modules.classes.getClassByName(t,!0).getNodes(e)}getEdgesByClassName(t,e){return this.modules.classes.getClassByName(t,!0).getEdges(e)}},F0={};xh(F0,{gexf:()=>mM,gexfFromUrl:()=>P0,graphml:()=>vM,graphmlFromUrl:()=>bM,janus:()=>_M,json:()=>yM,jsonFromUrl:()=>z0,mtx:()=>wj,mtxFromUrl:()=>Tj,neo4j:()=>xM});var mM=t=>Promise.resolve(KC(t)),P0=t=>Su(t).then((e=>KC(e))),_M=t=>Promise.resolve(EB(t)),yM=(t,e)=>Promise.resolve(HC(t,e)),z0=(t,e)=>Su(t).then((s=>HC(s,e))),xM=t=>Promise.resolve(QB(t)),vM=(t,e)=>Promise.resolve(QC(t,e)),bM=(t,e)=>Su(t).then((s=>QC(s,e))),wj=t=>Promise.resolve(JC(t)),Tj=t=>Su(t).then((e=>JC(e))),Cj=class extends Ps{constructor(){super(...arguments),this.wait=t=>new Promise((e=>setTimeout(e,t))),this.initRandomGraph=t=>this._ogma.generate.random(t).then(this._ogma.setGraph).then((()=>this._ogma.view.locateGraph())).then((()=>this._ogma.view.afterNextFrame())),this.initGrid=t=>{const e=Math.ceil(Math.sqrt(t));return this._ogma.generate.grid({rows:e,columns:e}).then((s=>this._ogma.setGraph(s))).then((()=>this._ogma.view.locateGraph()))},this.initLine=t=>(this._ogma.setGraph({nodes:[{id:0,attributes:{x:0,y:0}},{id:1,attributes:t?{x:0,y:50}:{x:50,y:0}}],edges:[{id:0,source:1,target:0}]}),this._ogma.view.locateGraph()),this.initSingleNode=()=>(this._ogma.setGraph({nodes:[{id:0,attributes:{x:0,y:0}}],edges:[]}),this._ogma.view.locateGraph()),this.initContinuousRenderLoop=({triggerKey:t="r",start:e=!0}={})=>{let s=e;const n=()=>{s&&this._ogma.modules.dom.beforeNextFrame().then(n)};document.addEventListener("keydown",(({key:i})=>{i===t&&(s=!s,n())})),n()},this.appendToBody=()=>{const t=document.createElement("div");t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.bottom="0",t.style.right="0",document.body.appendChild(t),this._ogma.setContainer(t)},this.loadFile=t=>(t.endsWith(".gexf")?P0(t):z0(t)).then((e=>this._ogma.setGraph(e))).then((()=>this._ogma.view.locateGraph())).then((()=>this._ogma.view.afterNextFrame())),this.enableLasso=t=>{this._ogma.events.on("dragStart",(()=>{this._ogma.keyboard.isKeyPressed("ctrl")&&this._ogma.tools.lasso.enable(t)}))},this.randomizeGraph=({minX:t=0,minY:e=0,maxX:s=500,maxY:n=500}={})=>this._ogma.getNodes().setAttributes(this._ogma.getNodes().map((()=>({x:t+Math.random()*(s-t),y:e+Math.random()*(n-e)}))))}},Lj=class{getDisabledNodes(){return this.modules.disabled.getDisabledNodes()}getEnabledNodes(){return this.modules.disabled.getEnabledNodes()}getDisabledEdges(){return this.modules.disabled.getDisabledEdges()}getEnabledEdges(){return this.modules.disabled.getEnabledEdges()}},Nj=class{setContainer(t){this.modules.dom.setContainer(t)}getContainer(){return this.modules.dom.getContainer()}},Mj=class extends Ps{constructor(){super(...arguments),this.once=(t,e)=>(this._ogma.modules.events.once(t,e),this),this.removeListener=t=>{this._ogma.modules.events.off(t)},this.onNodesAdded=t=>(this._ogma.events.on("addNodes",t),this._ogma),this.onBeforeNodesRemoved=t=>(this._ogma.events.on("beforeRemoveNodes",t),this._ogma),this.onNodesRemoved=t=>(this._ogma.events.on("removeNodes",t),this._ogma),this.onEdgesAdded=t=>(this._ogma.events.on("addEdges",t),this._ogma),this.onBeforeEdgesRemoved=t=>(this._ogma.events.on("beforeRemoveEdges",t),this._ogma),this.onEdgesRemoved=t=>(this._ogma.events.on("removeEdges",t),this._ogma),this.onGraphCleared=t=>(this._ogma.events.on("clearGraph",t),this._ogma),this.onNodesClassAdded=(t,e)=>(this._ogma.modules.classes.onNodeClassAdded(t,e),this._ogma),this.onNodesClassRemoved=(t,e)=>(this._ogma.modules.classes.onNodeClassRemoved(t,e),this._ogma),this.onEdgesClassAdded=(t,e)=>(this._ogma.modules.classes.onEdgeClassAdded(t,e),this._ogma),this.onEdgesClassRemoved=(t,e)=>(this._ogma.modules.classes.onEdgeClassRemoved(t,e),this._ogma),this.onNodeDragStart=t=>(this._ogma.events.on("nodesDragStart",t),this._ogma),this.onNodeDragProgress=t=>(this._ogma.events.on("nodesDragProgress",t),this._ogma),this.onNodeDragEnd=t=>(this._ogma.events.on("nodesDragEnd",t),this._ogma),this.onDrop=t=>(this._ogma.events.on("drop",t),this._ogma),this.onNodesSelected=t=>this.onNodesClassAdded(Ts,t),this.onNodesUnselected=t=>this.onNodesClassRemoved(Ts,t),this.onEdgesSelected=t=>this.onEdgesClassAdded(Ts,t),this.onEdgesUnselected=t=>this.onEdgesClassRemoved(Ts,t),this.onNodeDataChange=t=>(this._ogma.events.on("updateNodeData",t),this._ogma),this.onEdgeDataChange=t=>(this._ogma.events.on("updateEdgeData",t),this._ogma),this.onAnimate=t=>(this._ogma.events.on("animate",t),this._ogma),this.onMouseMove=t=>(this._ogma.events.on("mousemove",t),this._ogma),this.onMouseButtonDown=t=>(this._ogma.events.on("mousedown",t),this._ogma),this.onMouseButtonUp=t=>(this._ogma.events.on("mouseup",t),this._ogma),this.onClick=t=>(this._ogma.events.on("click",t),this._ogma),this.onDoubleClick=t=>(this._ogma.events.on("doubleclick",t),this._ogma),this.onMouseWheel=t=>(this._ogma.events.on("mousewheel",t),this._ogma),this.onHover=t=>(this._ogma.events.on("mouseover",t),this._ogma),this.onUnhover=t=>(this._ogma.events.on("mouseout",t),this._ogma),this.onDragStart=t=>(this._ogma.events.on("dragStart",t),this._ogma),this.onDragProgress=t=>(this._ogma.events.on("dragProgress",t),this._ogma),this.onDragEnd=t=>(this._ogma.events.on("dragEnd",t),this._ogma),this.onGestureStart=t=>(this._ogma.events.on("gestureStart",t),this._ogma),this.onGestureProgress=t=>(this._ogma.events.on("gestureProgress",t),this._ogma),this.onGestureEnd=t=>(this._ogma.events.on("gestureEnd",t),this._ogma),this.onRendererStateChange=t=>(this._ogma.events.on("rendererStateChange",t),this._ogma),this.onZoomProgress=t=>(this._ogma.events.on("zoom",t),this._ogma),this.onViewChanged=t=>(this._ogma.events.on("viewChanged",t),this._ogma),this.onNodesConnected=t=>(this._ogma.events.on("connectNodes",t),this._ogma),this.onGeoModeEnabled=t=>(this._ogma.events.on("geoEnabled",t),this._ogma),this.onGeoModeDisabled=t=>(this._ogma.events.on("geoDisabled",t),this._ogma),this.onGeoModeLoaded=t=>(this._ogma.events.on("geoLoaded",t),this._ogma),this.onLayoutStart=t=>(this._ogma.events.on("layoutStart",t),this._ogma),this.onLayoutComplete=t=>(this._ogma.events.on("layoutEnd",t),this._ogma),this.onLayoutComputed=t=>(this._ogma.events.on("layoutComputed",t),this._ogma),this.onTooltipShown=t=>(this._ogma.events.on("tooltipShow",t),this._ogma),this.onTooltipHidden=t=>(this._ogma.events.on("tooltipHide",t),this._ogma),this.onTransformationEnabled=t=>(this._ogma.events.on("transformationEnabled",t),this._ogma),this.onTransformationDisabled=t=>(this._ogma.events.on("transformationDisabled",t),this._ogma),this.onTransformationSetIndex=t=>(this._ogma.events.on("transformationSetIndex",t),this._ogma),this.onTransformationDestroyed=t=>(this._ogma.modules.events.on("transformationDestroyed",t),this._ogma),this.onTransformationRefreshed=t=>(this._ogma.events.on("transformationRefresh",t),this._ogma)}on(t,e){return this._ogma.modules.events.on(t,e),this}off(t){return this._ogma.modules.events.off(t),this}onKeyPress(t,e){return this._ogma.modules.keyboard.onKeyPress(t,e),this._ogma}};function Nf(t,e,s){if(t!=null)return Array.isArray(t)?t[0]:t}function nx(t){return t==null?null:typeof t=="string"||typeof t=="number"?`${t}`:t&&nx(t.content)}function kj(t){if(t!=null)return typeof t=="string"?t:t.style||"line"}var Ij=["color","radius","shape","text.content","x","y"],Rj=["color","width","shape.body","text.content"];function Fj(t){return t!=="all"?{nodes:["x","y"],edges:[]}:{nodes:Ij,edges:Rj}}function Pj(t,{nodes:e,edges:s}){const n=t.getOriginalAttributes();return{nodes:e.reduce(((i,r)=>(i[r.getId()]={x:n.nodes.x.get(r._index),y:n.nodes.y.get(r._index),color:Nf(n.nodes.color.get(r._index)),radius:n.nodes.radius.get(r._index),shape:n.nodes.shape.get(r._index),text:{content:n.nodes.text.content.get(r._index)}},i)),{}),edges:s.reduce(((i,r)=>(i[r.getId()]={color:Nf(n.edges.color.get(r._index)),width:n.edges.width.get(r._index),shape:{type:n.edges.shape.body.get(r._index)},text:{content:n.edges.text&&n.edges.text.content&&n.edges.text.content.get(r._index)}},i)),{})}}function zj(t){return{nodes:t.nodes.map((({id:e,attributes:s={},data:n})=>{const{color:i,radius:r,shape:o,text:a,x:l,y:u}=s;return{id:e,x:l,y:u,color:Nf(i),size:r,shape:o,text:nx(a),data:n}})),edges:t.edges.map((({id:e,source:s,target:n,attributes:i={},data:r})=>{const{color:o,width:a,text:l,shape:u}=i;return{id:e,source:s,target:n,color:Nf(o),size:a,shape:kj(u),text:nx(l),data:r}}))}}function u1(t){return t instanceof xi?t.getId():t}function d1(t){return t instanceof Ir?t.getId():t}function h1(t){return t instanceof uo?t.getId():t instanceof xi?[t.getId()]:Nn(t)?t.map(u1):[u1(t)]}function c1(t){return t instanceof Ya?t.getId():t instanceof Ir?[t.getId()]:Nn(t)?t.map(d1):[d1(t)]}var D0="visible";function Dj(t,e){return t?h1(t):typeof e=="object"?h1(e.nodes):e||D0}function Oj(t,e){return t?c1(t):typeof e=="object"?c1(e.edges):e||D0}function EM(t,e,s,n){const i=Dj(e,n),r=Oj(s,n);return{nodes:t.getNodes(i),edges:t.getEdges(r)}}function SM(t,{nodeAttributes:e,edgeAttributes:s,nodes:n,edges:i,filter:r,nodeData:o,edgeData:a}){const l=EM(t,n,i,r);return{nodes:l.nodes.toJSON({attributes:e,data:o}),edges:l.edges.toJSON({attributes:s,data:a})}}function hp(t,e,{styles:s,nodes:n,edges:i,filter:r,nodeData:o,edgeData:a}){const{nodes:l,edges:u}=Fj(s),h=SM(t,{nodeAttributes:l,edgeAttributes:u,nodes:n,edges:i,filter:r,nodeData:o,edgeData:a});if(s==="original"){const g=Pj(e,EM(t,n,i,r));for(const f of h.nodes)f.id!=null&&(f.attributes=g[f.id]);for(const f of h.edges)f.id!=null&&(f.attributes=g[f.id])}return s==="all"&&h.edges.forEach((({source:g,target:f,attributes:p})=>{if(p){const y=t.getNode(g);if(p.color==="source"&&y){const x=y.getAttribute("color");p.color=Array.isArray(x)?x[0]:x}const _=t.getNode(f);if(p.color==="target"&&_){const x=_.getAttribute("color");p.color=Array.isArray(x)?x[0]:x}}})),zj(h)}function Bj(t,e){for(let s=0;s<e.length;++s){if(t==null)return;t=t[e[s]]}return t}function Uj(t,e,s){for(let n=0;n<e.length-1;++n){const i=e[n];let r=t[i];r===void 0&&(r={},t[i]=r),t=r}t[e[e.length-1]]=s}function Gj(t){const e={...t[0]};for(const s of t)for(const n of Object.keys(s))n in e||(e[n]=void 0);return Object.keys(e)}function g1(t,e){return t==null||Array.isArray(t)&&!t.length?e:t}function Vj(t){return typeof t=="string"}function jj(t,e,s,n,i){const r=e==="edges",o={};return t.forEach(((a,l)=>{const u=i.get(l),h=Q_(g1(s(u),e));if(!h.every(Vj))throw Error(`The tab ${e} function returned an invalid value.`);const g=Q_(n(a.data,h));h.forEach(((f,p)=>{const y=g1(g[p],{}),_=up({internal___id:a.id,...r?{internal___source:a.source,internal___target:a.target}:{},...y}).reduce(((x,{path:v,value:b})=>(x[v.join(".")]=b,x)),{});o[f]=o[f]||[],o[f].push(_)}))})),o}function Hj(t){if(!t.length)return[];const e=Gj(t),s=[e];for(const n of t)s.push(e.map((i=>n[i])));return s[0]=s[0].map((n=>n.replace("internal___",""))),s}function $j(t,e,s){const n=new HL;let i=e?1:3;const r=[];for(let a=0;a<t.length;++a){const l=t[a],u=new Array(i);let h=l.data;if(s){const f={};s.forEach((p=>{const y=Ua(p),_=Bj(h,y);Uj(f,y,_)})),h=f}const g=up(h);u[0]=l.id,e||(u[1]=l.source,u[2]=l.target);for(let f=0;f<g.length;++f){const{path:p,value:y}=g[f];p.length&&(n.has(p)?u[n.get(p)]=y:(n.set(p,i),u[i]=y,i++))}r.push(u)}const o=[];return o.push("id"),e||(o.push("source"),o.push("target")),n.keys().forEach((a=>o.push(a[a.length-1]))),r.unshift(o),r.forEach((a=>a.length=i)),r}var qj=/[=+\-@|%]/,Yj=t=>t.length>0&&qj.test(t[0])?!isNaN(Number(t))&&isFinite(Number(t))?`${t}`:`'${t=t.replace("|","|")}`:t;function AM(t){return t===void 0?"":t instanceof Date?t.toISOString():Yj(""+t)}var Wj={what:void 0,dataProperties:void 0,separator:",",textSeparator:'"',download:!0,filename:"graph.csv",filter:"visible",nodes:void 0,edges:void 0,nodeData:hr,edgeData:hr,styles:"none"};function Xj(t,e){const{what:s,dataProperties:n,nodes:i,edges:r,separator:o,textSeparator:a,download:l,nodeData:u,edgeData:h,filename:g,filter:f}=ki(typeof e=="string"?{what:e}:e,Wj),p=hp(t.modules.graph,t.modules.individualAttributes,{styles:"none",nodes:i,edges:r,filter:f,nodeData:u,edgeData:h});try{const y=Zj(p,{what:s,separator:o,textSeparator:a,dataProperties:n});return l&&ta(y,g,"text","text/csv"),Promise.resolve(y)}catch(y){return Promise.reject(y)}}function Zj(t,{what:e,separator:s,textSeparator:n,dataProperties:i}){const r=new RegExp(n,"g");if(n&&n!=='"'&&n!=="'")throw new TypeError(`Invalid argument :"textSeparator" is not single-quote or double-quote, was ${n}`);if(e!=="nodes"&&e!=="edges")throw new TypeError('missing argument: "what": should have value "nodes" or "edges"');const o=e==="nodes";return $j(o?t.nodes:t.edges,o,i).map((a=>a.map((l=>(function(h){return n+AM(h).replace(r,`${n}${n}`).replace(/\n/g,"\\n").replace(/\r/g,"")+n})(l))))).map((a=>a.join(s))).join(`
`)}var Pl=t=>Math.round(255*t);function f1(t,e){if(e==="integer"&&typeof t=="number"){if(t%1!=0)return"float"}else if(typeof t!="number")return typeof t=="boolean"?"boolean":"string";return e}var ix=t=>typeof t=="object"&&t!==null&&t.constructor===Object;function rx(t,e={}){return Mr(t,((s,n)=>{ix(s)?rx(s,e):e[n]=s})),e}var Kj={creator:void 0,description:void 0,styles:"all",download:!0,filename:"graph.gexf",nodes:void 0,edges:void 0,nodeData:t=>t,edgeData:t=>t,filter:"visible"};function Qj(t,e={}){const{styles:s,nodes:n,edges:i,download:r,filename:o,creator:a,description:l,filter:u,nodeData:h,edgeData:g}=ki(e,Kj),f=Jj(hp(t.modules.graph,t.modules.individualAttributes,{styles:s,nodes:n,edges:i,filter:u,nodeData:h,edgeData:g}),{creator:a,description:l});return r&&ta(f,o,"text","text/xml"),Promise.resolve(f)}function Jj(t,e){const s=KL(),n={},i={};let r,o=0,a=0;const l=s.createElement("gexf");l.setAttribute("xmlns","http://www.gexf.net/1.2draft"),l.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz"),l.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),l.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd"),l.setAttribute("version","1.2");const u=s.createElement("meta");if(u.setAttribute("lastmodifieddate",ST()),e.creator){const _=s.createElement("creator");r=s.createTextNode(""+e.creator),_.appendChild(r),u.appendChild(_)}if(e.description){const _=s.createElement("description");r=s.createTextNode(""+e.description),_.appendChild(r),u.appendChild(_)}const h=s.createElement("graph");h.setAttribute("mode","static");const g=s.createElement("nodes");t.nodes.forEach((_=>{const x=s.createElement("node");if(x.setAttribute("id",String(_.id)),_.text&&x.setAttribute("label",$l(_.text)),ix(_.data)){const b=rx(_.data),S=s.createElement("attvalues");Object.keys(b).forEach((A=>{A in n||(n[A]={id:o,type:"integer"},o++);const w=b[A];n[A].type=f1(w,n[A].type);const L=s.createElement("attvalue");L.setAttribute("for",n[A].id),L.setAttribute("value",$l(w)),S.appendChild(L)})),x.appendChild(S)}if(_.color){const b=Yn(_.color);if(b){const S=s.createElement("viz:color");S.setAttribute("r",Pl(b[0])),S.setAttribute("g",Pl(b[1])),S.setAttribute("b",Pl(b[2])),S.setAttribute("a",b[3]),x.appendChild(S)}}const v=s.createElement("viz:position");if(v.setAttribute("x",_.x),v.setAttribute("y",-_.y),x.appendChild(v),_.size){const b=s.createElement("viz:size");b.setAttribute("value",_.size),x.appendChild(b)}g.appendChild(x)}));const f=s.createElement("attributes");f.setAttribute("class","node"),Object.keys(n).forEach((_=>{const x=s.createElement("attribute");x.setAttribute("id",n[_].id),x.setAttribute("title",_),x.setAttribute("type",n[_].type),f.appendChild(x)}));const p=s.createElement("edges");t.edges.forEach((_=>{const x=s.createElement("edge");if(x.setAttribute("id",_.id.toString()),x.setAttribute("source",_.source),x.setAttribute("target",_.target),_.size&&x.setAttribute("weight",_.size),_.text&&x.setAttribute("label",$l(_.text)),ix(_.data)){const v=rx(_.data),b=s.createElement("attvalues");Object.keys(v).forEach((S=>{S in i||(i[S]={id:a,type:"integer"},a++);const A=v[S];i[S].type=f1(A,i[S].type);const w=s.createElement("attvalue");w.setAttribute("for",i[S].id),w.setAttribute("value",$l(A)),b.appendChild(w)})),x.appendChild(b)}if(_.color){const v=Yn(_.color);if(v){const b=s.createElement("viz:color");b.setAttribute("r",Pl(v[0])),b.setAttribute("g",Pl(v[1])),b.setAttribute("b",Pl(v[2])),b.setAttribute("a",v[3]),x.appendChild(b)}}if(_.size){const v=s.createElement("viz:size");v.setAttribute("value",_.size),x.appendChild(v)}p.appendChild(x)}));const y=s.createElement("attributes");return y.setAttribute("class","edge"),Object.keys(i).forEach((_=>{const x=s.createElement("attribute");x.setAttribute("id",i[_].id),x.setAttribute("title",_),x.setAttribute("type",i[_].type),y.appendChild(x)})),h.appendChild(f),h.appendChild(y),h.appendChild(g),h.appendChild(p),l.appendChild(u),l.appendChild(h),s.appendChild(l),`<?xml version="1.0" encoding="UTF-8"?>${s.serialize()}`}var t6={graphId:"G",directedEdges:!0,styles:"all",download:!0,filename:"graph.graphml",nodes:void 0,edges:void 0,nodeData:t=>t,edgeData:t=>t,filter:"visible"};function e6(t,e){const{styles:s,nodes:n,edges:i,download:r,filename:o,graphId:a,directedEdges:l,filter:u,nodeData:h,edgeData:g}=ki(e,t6),f=s6(hp(t.modules.graph,t.modules.individualAttributes,{styles:s,nodes:n,edges:i,filter:u,nodeData:h,edgeData:g}),{graphId:a,directedEdges:l,noStyles:s==="none"});return r&&ta(f,o,"text","text/xml"),Promise.resolve(f)}function s6(t,e){const s=QL();function n(f,p,y,_,x){y=y||{};const v=s.createElement(p);for(const b in y){if(!Object.prototype.hasOwnProperty.call(y,b))continue;const S=y[b];S!==void 0&&v.setAttribute(b,S)}return(_!==void 0||x)&&(Object.prototype.toString.call(_)==="[object Object]"&&(_=JSON.stringify(_)),v.appendChild(s.createTextNode(_))),f.appendChild(v),v}const i=["id","source","target"],r=["size","x","y","shape","text","color"],o={size:{for:"all",type:"double"},x:{for:"node",type:"double"},y:{for:"node",type:"double"},shape:{for:"all",type:"string"},color:{for:"all",type:"string"},r:{for:"all",type:"int"},g:{for:"all",type:"int"},b:{for:"all",type:"int"},a:{for:"all",type:"double"},text:{for:"all",type:"string"}};e.noStyles&&(delete o.color,delete o.r,delete o.g,delete o.b,delete o.a,delete o.shape,r.pop());const a=[],l=[];function u(f,p){const y={id:f.id};r.forEach((_=>{let x=f[_];_==="y"&&x&&(x=-parseFloat(x)),x!==void 0&&(y[(p==="edge"?"edge_":"")+_]=x,_==="color"&&(function(b,S){const A=Yn(S);A&&(b.r=A[0],b.g=A[1],b.b=A[2])})(y,x))})),Mr(f.data||{},((_,x)=>{r.indexOf(x)===-1&&i.indexOf(x)===-1&&(o[x]?o[x].for!==p&&(o[x].for="all"):o[x]={for:p,type:"string"},y[x]=_)})),p==="edge"?(y.source=f.source,y.target=f.target,l.push(y)):a.push(y)}t.nodes.forEach((f=>u(f,"node"))),t.edges.forEach((f=>u(f,"edge")));const h=n(s,"graphml",{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml","xmlns:java":"http://www.yworks.com/xml/yfiles-common/1.0/java","xmlns:sys":"http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0","xmlns:x":"http://ww.yworks.com/xml/yfiles-common/markup/2.0"});Mr(o,((f,p)=>{f.for!=="node"&&f.for!=="all"||n(h,"key",{"attr.name":p,"attr.type":f.type,for:"node",id:p}),f.for!=="edge"&&f.for!=="all"||n(h,"key",{"attr.name":p,"attr.type":f.type,for:"edge",id:"edge_"+p})})),n(h,"key",{id:"nodegraphics",for:"node","yfiles.type":"nodegraphics","attr.type":"string"}),n(h,"key",{id:"edgegraphics",for:"edge","yfiles.type":"edgegraphics","attr.type":"string"});const g=n(h,"graph",{edgedefault:e.directedEdges||e.directedEdges===void 0?"directed":"undirected",id:e.graphId?e.graphId:"G","parse.nodes":t.nodes.length,"parse.edges":t.edges.length,"parse.order":"nodesfirst"});return a.forEach((f=>{const p=n(g,"node",{id:f.id});(function(_,x){const v=n(_,"data",{key:"nodegraphics"}),b=n(v,"y:ShapeNode");n(b,"y:Geometry",{x:x.x,y:x.y,width:x.size,height:x.size}),e.noStyles||n(b,"y:Fill",{color:Ny(x.color),transparent:!1}),n(b,"y:NodeLabel",null,x.text||""),n(b,"y:Shape",{type:x.shape})})(p,f),Mr(f,((y,_)=>{i.indexOf(_)===-1&&n(p,"data",{key:_},y,!0)}))})),l.forEach((f=>{const p=n(g,"edge",{id:f.id,source:f.source,target:f.target});(function(_,x){const v=n(_,"data",{key:"edgegraphics"}),b=n(v,"y:PolyLineEdge");n(b,"y:LineStyle",{type:x.edge_type,color:e.noStyles?void 0:Ny(x.edge_color),width:x.edge_size}),n(b,"y:EdgeLabel",null,x.edge_label)})(p,f),Mr(f,((y,_)=>{i.indexOf(_)===-1&&n(p,"data",{key:_},y,!0)}))})),`<?xml version="1.0" encoding="UTF-8"?>
${N0(s)}`}var n6={nodeAttributes:["x","y","color","radius","shape","text"],edgeAttributes:["color","width","text"],nodeData:hr,edgeData:hr,filter:"visible",pretty:!1,download:!0,filename:"graph.json",anonymize:!1};function i6(t,e={}){e.anonymize&&(e={nodeAttributes:"all",edgeAttributes:"all",nodeData:sf,edgeData:sf,filter:e.filter||"all",download:e.download,pretty:e.pretty,filename:e.filename});const{nodeAttributes:s,edgeAttributes:n,nodeData:i,edgeData:r,filter:o,pretty:a,download:l,filename:u}=ki(e,n6),h=SM(t.modules.graph,{nodeAttributes:s,edgeAttributes:n,filter:o,nodeData:i,edgeData:r}),g=a?JSON.stringify(h,null," "):JSON.stringify(h);return l&&ta(g,u,"text","application/json"),Promise.resolve(h)}function r6(t,e){return t.getBoundingBox().computeForZoom(e).extend(ri.fromValues(t.getAttribute("x"),t.getAttribute("y"),t.map((s=>s.getAttribute("radius")+s.getAttribute("innerStroke.width")+s.getAttribute("outerStroke.width")))))}function o6(t,e,s){const n=e.view.graphToScreenCoordinates(s.bottomLeft()),i=e.view.graphToScreenCoordinates(s.topRight()),r=Math.abs(i.x-n.x),o=Math.abs(i.y-n.y),a=Math.min(t.width/r,t.height/o);t.width=r*a,t.height=o*a}function wM(t,e={}){const s=t.view.get(),n=typeof e.margin=="number"?e.margin:0,i={pixelRatio:e.pixelRatio||bi(),angle:0,backgroundColor:null,zoom:0,x:0,y:0,width:0,height:0,hideImages:!1,renderBackground:!0,isBufferDisplayable:ef};if(e.width&&e.height?(i.width=e.width,i.height=e.height):(i.width=s.width,i.height=s.height),e.clip)i.zoom=s.zoom,i.x=s.x,i.y=s.y;else{const r=r6(t.getNodes(e.filter),s.zoom);if(e.texts){const o=t.modules.labels.getTextsBoundingBox();o.isValid()&&r.extend(o)}e.width!=null&&isFinite(e.width)&&e.height!=null&&isFinite(e.height)||o6(i,t,r),i.width=Math.max(i.width,2*n),i.height=Math.max(i.height,2*n),i.x=r.cx,i.y=r.cy,i.zoom=Math.min((i.width-2*n)/r.width,(i.height-2*n)/r.height)}return t.modules.geo.isEnabled()?i.backgroundColor=null:e.background!==void 0&&(i.backgroundColor=e.background),i}function ox(t,e,s,n,i=!1){const r={...s,hideImages:i,angle:s.angle||0,currentTime:Hn(),isBufferDisplayable:l=>e.texts||!eL(l),bentEnable:!1,bentVertical:!1},o={};if(e.badges===!1){const l={text:null,image:null};o.badges={topLeft:l,topRight:l,bottomRight:l,bottomLeft:l}}const a=t.styles.getClass(Na);return a&&a.update({nodeAttributes:o}),t.modules.graphics.export(n,r,e.filter||D0,e)}var wg=t=>({download:!0,filter:"visible",filename:`graph.${t}`,clip:!1,margin:10,width:void 0,height:void 0,background:null,badges:!0,legend:void 0,texts:!0,preventOverlap:!0,images:!0,textWatermark:{content:"",fontFamily:"Arial",fontSize:48,fontStyle:void 0,fontColor:"red",repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageWatermark:{url:void 0,width:void 0,height:void 0,repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageCrossOrigin:void 0,layers:!0,pixelRatio:void 0}),a6={png:wg("png"),jpg:wg("jpg"),tiff:wg("tiff"),gif:wg("gif")};function l6(t){const{canvas:e,parameters:s}=t;return s.textWatermark.content&&p1(e,s.textWatermark,m6,_6),s.imageWatermark.url?u2(s.imageWatermark.url).then((n=>(n&&(s.imageWatermark.content=n,p1(e,s.imageWatermark,x6,y6)),t))):t}function u6(t){const{ogma:e,canvas:s,parameters:n}=t,i=e.modules.legend;let r=null;return n.legend===void 0&&(r=!!i.enabled()&&i.getCurrentOptions()),n.legend===!0&&(r={}),r&&i.exportOnCanvas(s,r,t.parameters.pixelRatio),t}function d6(t){const{canvas:e,parameters:s,view:n}=t;if(!n.renderBackground)return t;n.renderBackground=!1;const i=e.getContext("2d");return i.fillStyle=s.background,i.fillRect(0,0,e.width,e.height),t}function h6(t){const{ogma:e,view:s}=t;return e.modules.geo.isEnabled()?e.modules.geo.exportBackground(s).then((n=>{const i=s.width*s.pixelRatio,r=s.height*s.pixelRatio,o=Pn(i,r),a=o.getContext("2d");return a.drawImage(n,(i-n.width)/2,(r-n.height)/2),a.drawImage(t.canvas,0,0),t.canvas=o,t})):t}function c6(t){const{ogma:e,view:s,canvas:n,parameters:i}=t;return i.layers?e.modules.layers.export({view:s,canvas:n,below:!0}).then((()=>t)):t}function g6(t){const{ogma:e,view:s,canvas:n,parameters:i}=t;return i.layers?e.modules.layers.export({view:s,below:!1,canvas:n}).then((()=>t)):t}function f6(t){const{ogma:e,parameters:s,canvas:n,view:i}=t,r=n.getContext("2d");return ox(e,s,i,"canvas",!s.images).then((o=>{try{const a=o.getContext("2d");if(!a)throw new Error("Failed to render graph");return a.getImageData(0,0,1,1),r.drawImage(o,0,0,n.width,n.height),t}catch(a){return $o(a),ox(e,s,i,"canvas",!0).then((l=>(r.drawImage(l,0,0,n.width,n.height),t)))}}))}function p6({canvas:t,parameters:e,type:s}){const n=t.toDataURL("image/"+s);return e.download&&ta(n,e.filename,"dataURL","image/"+s),n}function Tg(t,e,s){const n=ki(e,a6[s]);n.filename.endsWith(s)||(n.filename+="."+s),n.background===null&&(n.background=t.modules.graphics.getTransparentBackgroundColor());const i=wM(t,n);n.pixelRatio=i.pixelRatio;const r=Pn(i.width*i.pixelRatio,i.height*i.pixelRatio),o={ogma:t,parameters:n,canvas:r,view:i,type:s};return Promise.resolve().then((()=>o)).then(d6).then(h6).then(c6).then(f6).then(g6).then(l6).then(u6).then(p6).then((a=>(t.modules.events.fire("afterImageExport"),a)))}function m6(t,e,s,n){t.textAlign="center",t.textBaseline="middle",t.fillText(e,s,n)}function _6(t,e,s){return{width:t.measureText(e).width,height:s}}function y6(t,e,s,n,i){return{width:n===void 0?e.width:n,height:i===void 0?e.height:i}}function x6(t,e,s,n,i,r){t.drawImage(e,s-i/2,n-r/2,i,r)}function p1(t,e,s,n){if(!e)return;if(typeof e!="object")e={content:e};else if(!e.content)return;const{fontFamily:i,fontSize:r,fontStyle:o,fontColor:a,repeat:l,alpha:u,space:h,content:g}=e;let f=e.angle;const p=t.getContext("2d"),y=t.width,_=t.height,x=e.x===void 0?y/2:e.x,v=e.y===void 0?_/2:e.y,b=e.height,S=e.width;f=f/180*Math.PI,Zo(p,i,r,o),p.fillStyle=a,p.globalAlpha=u;const A=n(p,g,r,S,b);if(l){const w=A.width+h,L=A.height+h,M=Math.sqrt(y*y+_*_);p.save(),p.translate(0,0),p.rotate(f);for(let F=0;F<M;F+=w)for(let O=0;O<M;O+=L)s(p,g,F,O,A.width,A.height),O!==0&&s(p,g,F,-O,A.width,A.height);p.restore()}else p.save(),p.translate(x,v),p.rotate(f),s(p,g,0,0,A.width,A.height),p.restore()}var v6={download:!0,filename:"graph.svg",width:void 0,height:void 0,background:null,texts:!0,preventOverlap:!0,groupSemantically:!0,images:!0,badges:!0,embedFonts:!1,layers:!0,clip:!1,margin:10,prefix:"ogma"};function b6(t,e){const s=ki(e,v6),{background:n,filename:i,download:r,layers:o}=s,a=t.modules.graphics;n===null&&(s.background=a.getTransparentBackgroundColor());const l=wM(t,s);return ox(t,s,l,"svg",!s.images).then((u=>(u.removeAttribute("pointer-events"),u.setAttribute("version","1.1"),u.setAttributeNS(hy,"xmlns",Bx),u.setAttributeNS(hy,"xmlns:xlink",l2),u))).then((u=>s.groupSemantically?S6(t,u,s):u)).then((u=>w6(u,s))).then((u=>E6(t,l,u))).then((u=>m1(t,l,u,o,!0))).then((u=>m1(t,l,u,o,!1))).then((u=>(t.modules.events.fire("afterImageExport"),u))).then((u=>{const h=`<?xml version="1.0" encoding="utf-8"?>${N0(u)}`;return r&&ta(h,i,"text","image/svg+xml"),h}))}function E6(t,e,s){return t.modules.geo.isEnabled()?t.modules.geo.exportBackground({...e,pixelRatio:1}).then((n=>{const i=ys("image",{width:n.width,height:n.height,x:0,y:0,href:n.toDataURL()});return s.insertBefore(i,s.children[0]),s})):Promise.resolve(s)}function m1(t,e,s,n,i=!1){return n?t.modules.layers.export({view:e,svg:s,below:i}).then((()=>s)):Promise.resolve(s)}function S6(t,e,s){const n=e.childNodes[2],i=n.childNodes,r={},o=s.prefix;for(let p=0;p<i.length;p++){const y=i[p],_=y.getAttribute(ji);_!=null&&(r[_]=r[_]||[],r[_].push(y))}const a=Object.keys(r),l=t.modules.graph,u=l.getNodeAttribute("id"),h=l.getEdgeAttribute("id"),g=ys("g",{class:`${o}-edges`}),f=ys("g",{class:`${o}-nodes`});for(let p=0;p<a.length;p++){const y=a[p],_=y.charAt(0)==="n",x=parseInt(y.substring(1)),v=r[y],b=$l((_?u:h).get(x).toString()),S=ys("g");S.setAttribute(`data-${_?"node":"edge"}-id`,b),S.setAttribute("class",`${o}-${_?"node":"edge"}`);for(let A=0;A<v.length;A++){const w=v[A];S.appendChild(w),w.removeAttribute(ji)}(_?f:g).appendChild(S)}return n.appendChild(g),n.appendChild(f),e}function A6(t){const e=[].concat(Array.prototype.slice.call(t.getElementsByTagName("text")||[])),s=[],n={};for(let i=0;i<e.length;i++){const r=e[i].parentNode.getAttribute("font-family");if(typeof r=="string"){const o=r.split(",");for(let a=0;a<o.length;a++){const l=o[a].replace(/['"]/g,"");l===""||n[l]||(n[l]=!0,s.push(l))}}}return{list:s,map:n}}function w6(t,e){const s=A6(t).map;return UL().then((n=>n.filter((i=>s[i.name])))).then((n=>GL(n,!!e.embedFonts))).then((n=>{if(n.length!==0){const i=ys("style");for(let r=0;r<n.length;r++)i.appendChild(Ux(n[r]));t.childNodes[0].appendChild(i)}return t}))}var T6={what:void 0,dataProperties:void 0,filter:"visible",nodes:void 0,edges:void 0,download:!0,filename:"graph.xlsx",tab:void 0,nodeData:void 0,edgeData:void 0};function C6(t,e={}){typeof e=="string"&&(e={what:e});const{what:s,nodes:n,edges:i,tab:r={nodes:()=>"nodes",edges:()=>"edges"},download:o,filename:a,dataProperties:l,filter:u,nodeData:h,edgeData:g}=ki(e,T6);r.nodes||(r.nodes=()=>"nodes"),r.edges||(r.edges=()=>"edges");const f=hp(t.modules.graph,t.modules.individualAttributes,{styles:"none",nodes:n,edges:i,filter:u,nodeData:y=>y,edgeData:y=>y}),p=L6(f,{what:s,tabFunctions:r,tabContentFunctions:{nodes:h||(y=>sy(Kd(y||{}),l)),edges:g||(y=>sy(Kd(y||{}),l))}},{nodes:t.modules.graph.getNodes(f.nodes.map((({id:y})=>y))),edges:t.modules.graph.getEdges(f.edges.map((({id:y})=>y)))});return o&&ta(p,a,"blob","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),Promise.resolve(p)}function L6(t,{what:e,tabFunctions:s,tabContentFunctions:n},i){const r=Yi("XLSX")||Yi("xlsx",{throwOnError:!0});if(!r)throw Error('The xlsx exports requires the "xlsx" peer dependency to be associated');const o=new M6;if(e){if(e!=="nodes"&&e!=="edges")throw new TypeError(`Invalid argument: "what" is not "nodes" or "edges", was ${e}`);e==="nodes"&&(t.edges=[]),e==="edges"&&(t.nodes=[])}const a={};for(const l of["nodes","edges"]){const u=jj(t[l],l,s[l],n[l],i[l]);for(const h of Object.keys(u))a[h]=[...a[h]||[],...u[h]]}for(const l of Object.keys(a))o.SheetNames.push(l),o.Sheets[l]=N6(r,Hj(a[l]));return o.SheetNames.length===0&&(o.SheetNames=["nodes","edges"],o.Sheets.nodes={},o.Sheets.edges={}),Jd([k6(r.write(o,{bookType:"xlsx",bookSST:!1,type:"binary"}))],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")}function N6(t,e){const s={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}};for(let i=0;i!==e.length;++i){const r=e[i];for(let o=0;o!==r.length;++o){const a=r[o];n.s.r>i&&(n.s.r=i),n.s.c>o&&(n.s.c=o),n.e.r<i&&(n.e.r=i),n.e.c<o&&(n.e.c=o);const l={v:a,t:"s"};typeof a=="number"?l.t="n":a instanceof Date?l.t="d":typeof a=="boolean"?l.t="b":l.v=AM(a),s[t.utils.encode_cell({c:o,r:i})]=l}}return n.s.c<1e7&&(s["!ref"]=t.utils.encode_range(n)),s}var M6=class{constructor(){this.SheetNames=[],this.Sheets={}}};function k6(t){const e=new ArrayBuffer(t.length),s=new Uint8Array(e);for(let n=0;n!==t.length;++n)s[n]=255&t.charCodeAt(n);return e}var I6=class extends Ps{constructor(t){super(t),this.csv=e=>Xj(this._ogma,e),this.xlsx=e=>(e&&e.dataProperties&&void 0,C6(this._ogma,e)),this.gexf=e=>Qj(this._ogma,e),this.graphml=(e={})=>e6(this._ogma,e),this.json=(e={})=>i6(this._ogma,e),this.svg=(e={})=>b6(this._ogma,e),this.png=(e={})=>Tg(this._ogma,e,"png"),this.jpg=(e={})=>Tg(this._ogma,e,"jpg"),this.tiff=(e={})=>Tg(this._ogma,e,"tiff"),this.gif=(e={})=>Tg(this._ogma,e,"gif"),t.styles.createClass({name:Na,isBuiltin:!0})}};/**
 * Ogma Generators
 * @description Graphs Generators for Ogma
 * @version 0.0.18 (built on Wed Aug 06 2025 13:07:32 GMT+0000 (Coordinated Universal Time))
 * @author Alexander Milevski - Leo Nicolle - Sylvain Milan - Marco Liberati
 * @license (c) Linkurious 2025. All rights reserved.
 * @preserve
 */function R6(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _1,y1={exports:{}};function F6(){return _1||(_1=1,y1.exports=(function(){return t.importState=function(s){var n=new t;return n.importState(s),n},t;function t(){return(function(s){var n=0,i=0,r=0,o=1;s.length==0&&(s=[+new Date]);var a=e();n=a(" "),i=a(" "),r=a(" ");for(var l=0;l<s.length;l++)(n-=a(s[l]))<0&&(n+=1),(i-=a(s[l]))<0&&(i+=1),(r-=a(s[l]))<0&&(r+=1);a=null;var u=function(){var h=2091639*n+23283064365386963e-26*o;return n=i,i=r,r=h-(o=0|h)};return u.next=u,u.uint32=function(){return 4294967296*u()},u.fract53=function(){return u()+11102230246251565e-32*(2097152*u()|0)},u.version="Alea 0.9",u.args=s,u.exportState=function(){return[n,i,r,o]},u.importState=function(h){n=+h[0]||0,i=+h[1]||0,r=+h[2]||0,o=+h[3]||0},u})(Array.prototype.slice.call(arguments))}function e(){var s=4022871197,n=function(i){i=i.toString();for(var r=0;r<i.length;r++){var o=.02519603282416938*(s+=i.charCodeAt(r));o-=s=o>>>0,s=(o*=s)>>>0,s+=4294967296*(o-=s)}return 23283064365386963e-26*(s>>>0)};return n.version="Mash 0.9",n}})()),y1.exports}var P6=F6(),z6=R6(P6),D6=z6(42),cn=()=>D6.next(),O6=({nodes:t=10,edges:e=10,texts:s=!1,scale:n=100}={})=>({nodes:t,edges:e,texts:s,scale:n});function B6({nodes:t,scale:e,texts:s,edges:n}){const i=[],r=[];for(let o=0;o<t;o++)i.push({id:o,attributes:{x:cn()*e,y:cn()*e,text:s?`Node ${o}`:void 0}});for(let o=0;o<n;o++)r.push({id:o,source:cn()*t|0,target:cn()*t|0,attributes:{text:s?`Edge ${o}`:void 0}});return{nodes:i,edges:r}}var x1=Object.freeze(Object.defineProperty({__proto__:null,configure:O6,generate:B6},Symbol.toStringTag,{value:"Module"})),U6=({rows:t=4,columns:e=4,columnDistance:s=20,rowDistance:n=20,xmin:i=0,ymin:r=0}={})=>({rows:t,columns:e,columnDistance:s,rowDistance:n,xmin:i,ymin:r});function G6({rows:t,columns:e,columnDistance:s,rowDistance:n,xmin:i,ymin:r}){const o={nodes:[],edges:[]};let a=0;for(let l=0;l<t;++l)for(let u=0;u<e;++u){const h=l*e+u;o.nodes.push({id:h,attributes:{x:i+u*s,y:r+l*n}}),u!==e-1&&(o.edges.push({id:a,source:h,target:l*e+u+1}),a++),l!==t-1&&(o.edges.push({id:a,source:h,target:(l+1)*e+u}),a++)}return o}var v1=Object.freeze(Object.defineProperty({__proto__:null,configure:U6,generate:G6},Symbol.toStringTag,{value:"Module"})),V6=({length:t=5,scale:e=100}={})=>({length:t,scale:e});function j6({length:t,scale:e}){const s={nodes:[],edges:[]};if(t<=0)return s;s.nodes.push({id:0,attributes:{x:cn()*e,y:cn()*e}});for(let n=1;n<t;++n)s.nodes.push({id:n,attributes:{x:cn()*e,y:cn()*e}}),s.edges.push({id:n-1,source:n-1,target:n});return s}var b1=Object.freeze(Object.defineProperty({__proto__:null,configure:V6,generate:j6},Symbol.toStringTag,{value:"Module"}));function H6(t){return typeof t=="number"&&isFinite(t)&&t>=0?t:void 0}function $6(t){return typeof t=="number"&&isFinite(t)&&t>0?t:void 0}function Md(t){return typeof t=="number"&&isFinite(t)?t:void 0}function q6({children:t=2,height:e=3}={}){if(!$6(t))throw new TypeError('Invalid argument: "children" is not a positive number, was '+t);if(!H6(e))throw new TypeError('Invalid argument: "height" is not a positive number, was '+e);return{children:t,height:e}}function Y6({children:t,height:e}){e+=1;const s=Math.pow(t,e),n=[],i=[];let r=1,o=0,a=0;for(let l=0;l<e;++l){const u=s/(r+1)/1.5;for(let h=0;h<r;++h){const g=o++;if(n.push({id:g,attributes:{x:(h+1)*u*10,y:20*l}}),l!==e-1)for(let f=0;f<t;++f)i.push({id:a,source:g,target:g*t+f+1}),a+=1}r*=t}return{nodes:n,edges:i}}var E1=Object.freeze(Object.defineProperty({__proto__:null,configure:q6,generate:Y6},Symbol.toStringTag,{value:"Module"}));function W6({nodes:t=20,edges:e,p:s,scale:n=100}={}){if(!Md(t)||t<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+t);if(e!==void 0&&s!==void 0)throw new TypeError("Invalid argument: choose between options.edges and options.p");return e===void 0&&s===void 0&&(s=.1),s===void 0&&(s=-1),e===void 0&&(e=-1),{nodes:t,p:s,edges:e,scale:n}}function X6(t){const e={nodes:[],edges:[]},s=t.nodes,n=t.p,i=t.scale;if(n>=0){let r=0;for(let o=0;o<s;o++){e.nodes.push({id:o,attributes:{x:cn()*i,y:cn()*i}});for(let a=0;a<o;a++)cn()<n&&e.edges.push({id:r++,source:o,target:a})}}else{const r=[],o=t.edges;for(let l=0;l<s;l++){e.nodes.push({id:l,attributes:{x:100*cn(),y:100*cn()}});for(let u=l+1;u<s;u++)r.push({source:l,target:u})}let a=r.length-1;for(let l=0;l<o;l++){const u=r.splice(Math.floor(cn()*a),1)[0];u.id=l,e.edges.push(u),a--}}return e}var S1=Object.freeze(Object.defineProperty({__proto__:null,configure:W6,generate:X6},Symbol.toStringTag,{value:"Module"}));function Z6({nodes:t=40,m0:e=5,m:s=1,scale:n=100}={}){if(!Md(t)||t<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+t);if(!Md(e)||e>=t)throw new TypeError(`Invalid argument: options.m0 is not a number < ${t}, was ${e}`);if(!Md(e)||s>=e)throw new TypeError(`Invalid argument: options.m is not a number <= ${e}, was ${s}`);if(!Md(n)||n<0)throw new TypeError("Invalid argument: options.scale is not a number or is less than 0");return{nodes:t,m0:e,m:s,scale:n}}function K6({scale:t,nodes:e,m0:s,m:n}){const i={nodes:[],edges:[]},r={},o=[],a=t/10;let l=0;for(let u=0;u<s;u++)i.nodes.push({id:u,attributes:{x:cn()*a,y:cn()*a}}),o[u]=0;for(let u=0;u<s;u++)for(let h=u+1;h<s;h++){const g={id:l++,source:u,target:h};r[g.source+"-"+g.target]=g,i.edges.push(g),o[u]++,o[h]++}for(let u=s;u<e;u++){i.nodes.push({id:u,attributes:{x:cn()*t,y:cn()*t}}),o[u]=0;let h=0;for(let f=0;f<u;f++)h+=o[f];let g=0;for(let f=0;f<n;f++){const p=cn();let y=0;for(let _=0;_<u;_++)if(!r[`${u}-${_}`]&&!r[`${_}-${u}`]&&(y=u===1?1:y+o[_]/h+g/(u-f),p<=y)){g+=o[_]/h;const x={id:l++,source:u,target:_};r[`${x.source}-${x.target}`]=x,i.edges.push(x),o[u]++,o[_]++;break}}}return i}var A1=Object.freeze(Object.defineProperty({__proto__:null,configure:Z6,generate:K6},Symbol.toStringTag,{value:"Module"}));function Q6({nodes:t=50,width:e=100,height:s=100,x:n=0,y:i=0}={}){if(!isFinite(t)||t<1)throw new RangeError("Tree generator: number of nodes must be a positive integer");return{nodes:t,width:e,height:s,x:n,y:i}}function J6({nodes:t,x:e,y:s,width:n,height:i}){const r=e-n/2,o=s-i/2;return{nodes:new Array(t).fill(0).map(((a,l)=>({id:l,attributes:{x:r+cn()*n,y:o+cn()*i}}))),edges:new Array(t-1).fill(0).map(((a,l)=>({id:l,source:Math.floor(Math.sqrt(l)),target:l+1})))}}var w1=Object.freeze(Object.defineProperty({__proto__:null,configure:Q6,generate:J6},Symbol.toStringTag,{value:"Module"})),tH=5,eH=10,sH=10,nH=2.7,iH=.2;function rH({depth:t=3,breadth:e=3,nodes:s}){return s!==void 0?(e=5,t=Math.ceil(Math.log(s)/Math.log(5))):s=-1,{depth:t,breadth:e,nodes:s}}function oH({depth:t,breadth:e,nodes:s}){const n={id:0,attributes:{x:0,y:0,radius:CM(t+1)}},i={nodes:[n],edges:[]};return LM(i,e,t,n,1),s!==void 0&&s>=0&&(i.nodes=i.nodes.slice(0,s),i.edges=i.edges.slice(0,Math.max(s-1,0))),i}function TM(t){return Math.pow(nH,t)*eH}function CM(t){return tH+TM(t)/sH}function LM(t,e,s,n,i){if(s===0)return i;const r=TM(s),o=CM(s),a=o*iH;let l=-Math.PI;const u=2*Math.PI/e,h=n.attributes.x||0,g=n.attributes.y||0;for(let f=0;f<e;++f){const p={id:i,attributes:{x:h+r*Math.cos(l),y:g+r*Math.sin(l),radius:o}},y={id:i,source:n.id,target:i,attributes:{width:a}};t.nodes.push(p),t.edges.push(y),i=LM(t,e,s-1,p,i+1),l+=u}return i}var T1=Object.freeze(Object.defineProperty({__proto__:null,configure:rH,generate:oH},Symbol.toStringTag,{value:"Module"})),aH=class extends Ps{constructor(){super(...arguments),this.balancedTree=t=>Promise.resolve(E1.generate(E1.configure(t))),this.barabasiAlbert=t=>Promise.resolve(A1.generate(A1.configure(t))),this.erdosRenyi=t=>Promise.resolve(S1.generate(S1.configure(t))),this.flower=t=>Promise.resolve(T1.generate(T1.configure(t))),this.grid=t=>Promise.resolve(v1.generate(v1.configure(t))),this.path=t=>Promise.resolve(b1.generate(b1.configure(t))),this.random=t=>Promise.resolve(x1.generate(x1.configure(t))),this.randomTree=t=>Promise.resolve(w1.generate(w1.configure(t)))}},lH=class extends Ps{constructor(){super(...arguments),this.enable=t=>this._ogma.modules.geo.enable(t),this.disable=t=>this._ogma.modules.geo.disable(t),this.setOptions=t=>this._ogma.modules.geo.setOptions(t),this.getOptions=()=>this._ogma.modules.geo.getOptions(),this.getMap=()=>this._ogma.modules.geo.getMap(),this.enabled=()=>this._ogma.modules.geo.isEnabled(),this.getCenter=()=>this._ogma.modules.geo.getCenter(),this.getView=()=>this._ogma.modules.geo.getView(),this.getZoom=()=>this._ogma.modules.geo.getZoom(),this.setZoom=t=>this._ogma.modules.geo.setZoom(t),this.setView=(t,e,s)=>this._ogma.modules.geo.setView(t,e,s),this.setCenter=(t,e)=>this._ogma.modules.geo.setCenter(t,e),this.toggle=t=>this._ogma.modules.geo.toggle(t),this.resetCoordinates=()=>this._ogma.modules.geo.resetCoordinates(),this.getUnprojectedCoordinates=t=>this._ogma.modules.geo.getUnprojectedCoordinates(this._ogma.getNodes(t)),this.runLayout=async({type:t,nodes:e,latitudePath:s=Cr,longitudePath:n=Lr,options:i,center:r})=>{if(t===void 0||i===void 0)throw new Error("Ogma.geo.runLayout: Both layout type and options are required");if(e=this._ogma.getNodes(e),r===void 0){let o=0;if(r=e.reduce(((a,l)=>{const u=l.getData(s),h=l.getData(n);return isNaN(u)||isNaN(h)||(a.latitude+=u,a.longitude+=h,o++),a}),{latitude:0,longitude:0}),isNaN(r.latitude)||isNaN(r.longitude))throw new Error("Ogma.geo.runLayout: No valid center coordinates found");r.latitude/=o,r.longitude/=o}return this._ogma.modules.geo.runLayout({center:r,nodes:e,type:t,options:i,latitudePath:s,longitudePath:n})}}},uH=class{reloadFonts(){this.modules.graphics.reloadFonts()}},dH=class extends Ps{constructor(){super(...arguments),this.gexf=t=>mM(t),this.gexfFromUrl=t=>P0(t),this.janus=t=>_M(t),this.json=(t,e)=>yM(t,e),this.jsonFromUrl=(t,e)=>z0(t,e),this.neo4j=t=>xM(t),this.graphml=(t,e)=>vM(t,e),this.graphmlFromUrl=(t,e)=>bM(t,e)}},hH=class extends Ps{constructor(){super(...arguments),this.isKeyPressed=t=>this._ogma.modules.keyboard.isPressed(t),this.resetKeys=()=>{this._ogma.modules.keyboard.resetKeys()}}},cH=class extends Ps{addLayer(t,e){return this._ogma.modules.layers.addLayer(t,"layer",e)}addCanvasLayer(t,e,s){return this._ogma.modules.layers.addCanvasLayer(t,e,s)}addOverlay(t,e){if(!t.position)throw new Error("options.position argument is required");return this._ogma.modules.layers.addOverlay(t,e)}addSVGLayer(t,e){return t.element||(t.element=document.createElementNS("http://www.w3.org/2000/svg","svg")),t.draw||(t.draw=()=>{}),this._ogma.modules.layers.addSVGLayer(t,e)}},C1={name:"concentric",configure:function(t,{graph:e,data:s}){if(t.centralNode===void 0)throw new Error('concentric layout: missing parameter "centralNode"');const n={...t,centralNode:(function(A,w){return w instanceof xi?w:A.getNode(w)})(e,t.centralNode)},{centralNode:i,nodes:r}=n,o=e.getNode(i);if(o===void 0)throw new Error('concentric layout: "centralNode" parameter is not valid');const a=o._index,{x:l,y:u}=o.getPosition(),h=r.getAttribute("layoutable"),g=e.getNodes(r)._indexes,f=Array.from(g.filter(((S,A)=>h[A])));f.indexOf(a)===-1&&f.push(a);const p=t.rs?t.rs:e.getNodeAttribute("radius").getMultiple(g),y=(function(A,w,L,M){if(w)return w==="random"?"random":w==="radius"?M.slice():w==="degree"?L.getDegree():A.getProperty(L,w)})(s,n.sortBy,r,p),_=f.reduce(((S,A,w)=>(S[A]=w,S)),{}),x=f.map(((S,A)=>A)),v=new Set(t.edges.getExtremities()._indexes),b=f.map((S=>e.topology.getAdjacentElements(!0,new Uint32Array([S])).filter((A=>v.has(A))).map((A=>_[A]))));return{sourceNodeIndex:f.indexOf(a),centerX:typeof n.centerX=="number"?n.centerX:l,centerY:typeof n.centerY=="number"?n.centerY:u,list:f,indexes:x,size:f.length,totalSize:f.length,attributes:{adjacentNodes:b,size:p},sortAttr:y,clockwise:n.clockwise===void 0||n.clockwise,circleHopRatio:n.circleHopRatio||5,allowOverlap:!!n.allowOverlap}},context:function(){return{dijkstra:function(t,e,s,n,i){const r=Math.pow(2,31)-1,o=new Int32Array(n),a=new Int32Array(n),l=new Int8Array(n);o.fill(r),a.fill(-1);for(let h=0;h<n;++h){const g=e[h];g!==void 0&&(o[g]=r,a[g]=-1)}o[i]=0;let u=0;for(;u!==-1;){let h=r;u=-1;for(let g=0;g<s;++g){const f=e[g],p=o[f];!l[f]&&p<h&&(h=p,u=f,l[f]=1)}if(u>-1){const g=t[u],f=h+1;g.forEach((p=>{const y=o[p];f<y&&(o[p]=f,a[p]=u)}))}}return o},determinePropertyType:function(t,e,s){return e.some((n=>t[n]!=="number"))?"string":"number"}}},update:function(t,e){const{attributes:s,indexes:n,size:i}=t,{sourceNodeIndex:r,centerX:o,centerY:a,sortAttr:l}=t,u=s.adjacentNodes,h=s.size,g=new Array(t.totalSize),f=new Array(t.totalSize),p=e.dijkstra(u,n,t.size,t.totalSize,r);let y=0;const _={};for(let L=0;L<i;L++){const M=h[n[L]];M>y&&(y=M)}const x=y*t.circleHopRatio;let v=0,b=0;const S=Math.PI/9;for(let L=0;L<i;L++){const M=n[L],F=p[M];let O=_[F];O||(O=[],_[F]=O),O.push(M)}const A=(function(M,F,O){if(M==="random")return function(){return Math.random()-.5};if(M)return O.determinePropertyType(M,F,F.length)==="number"?function(G,j){return M[G]-M[j]}:function(G,j){return M[G]<M[j]?-1:1}})(l,n,e),w=l==="random"||l;return Object.keys(_).sort(((L,M)=>parseInt(L)-parseInt(M))).forEach(((L,M)=>{const F=_[L],O=F.length;let G=0,j=b;const Z=2*Math.PI/O;if(M!==0&&!t.allowOverlap){const at=2*Math.PI*v;let pt=0;G+=F.reduce(((K,ut)=>K+h[ut]),0),pt=2*G*Math.SQRT2,pt>at&&(v+=pt/(2*Math.PI)-v)}w&&(F.sort(A),t.clockwise||F.reverse());for(let at=0;at<O;at++){const pt=F[at];g[pt]=Math.cos(j)*v+o,f[pt]=Math.sin(j)*v+a;const K=h[pt];j+=Z*(t.allowOverlap?1:K/G*O)}v+=x,b+=S})),{x:g,y:f,indexes:t.list}},isRunning:function(){return!1},onSync:function({indexes:t,x:e,y:s}){return{indexes:t,x:e,y:s}}},gH=t=>(t.modules.layouts.register(C1),e=>t.modules.layouts.start(C1.name,e)),fH=Object.defineProperty,Se=(t,e)=>fH(t,"name",{value:e,configurable:!0});function _u(t){let e=0,s=0;for(const o of t)e+=o.w*o.h,s=Math.max(s,o.w);t.sort(((o,a)=>a.h-o.h));const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),s),h:1/0}];let i=0,r=0;for(const o of t)for(let a=n.length-1;a>=0;a--){const l=n[a];if(!(o.w>l.w||o.h>l.h)){if(o.x=l.x,o.y=l.y,r=Math.max(r,o.y+o.h),i=Math.max(i,o.x+o.w),o.w===l.w&&o.h===l.h){const u=n.pop();a<n.length&&(n[a]=u)}else o.h===l.h?(l.x+=o.w,l.w-=o.w):o.w===l.w?(l.y+=o.h,l.h-=o.h):(n.push({x:l.x+o.w,y:l.y,w:l.w-o.w,h:o.h}),l.y+=o.h,l.h-=o.h);break}}return{w:i,h:r,fill:e/(i*r)||0}}Se(_u,"g");var L1=Se(((t,e)=>Array.from({length:t},((s,n)=>e(n)))),"me"),go=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),pH=Se((()=>({[WebGL2RenderingContext.FLOAT]:"uniform1f",[WebGL2RenderingContext.FLOAT_VEC2]:"uniform2fv",[WebGL2RenderingContext.FLOAT_VEC3]:"uniform3fv",[WebGL2RenderingContext.FLOAT_VEC4]:"uniform4fv",[WebGL2RenderingContext.INT]:"uniform1i",[WebGL2RenderingContext.INT_VEC2]:"uniform2iv",[WebGL2RenderingContext.INT_VEC3]:"uniform3iv",[WebGL2RenderingContext.INT_VEC4]:"uniform4iv",[WebGL2RenderingContext.UNSIGNED_INT]:"uniform1ui",[WebGL2RenderingContext.UNSIGNED_INT_VEC2]:"uniform2uiv",[WebGL2RenderingContext.UNSIGNED_INT_VEC3]:"uniform2uiv",[WebGL2RenderingContext.UNSIGNED_INT_VEC4]:"uniform2uiv",[WebGL2RenderingContext.FLOAT_MAT2]:"uniformMatrix2fv",[WebGL2RenderingContext.FLOAT_MAT3]:"uniformMatrix3fv",[WebGL2RenderingContext.FLOAT_MAT4]:"uniformMatrix4fv",[WebGL2RenderingContext.SAMPLER_2D]:"uniform1i",[WebGL2RenderingContext.INT_SAMPLER_2D]:"uniform1i",[WebGL2RenderingContext.UNSIGNED_INT_SAMPLER_2D]:"uniform1i",[WebGL2RenderingContext.SAMPLER_CUBE]:"uniform1i"})),"we"),Cg=new Map,b_=new Map,mH=Se(((t,e,s,n)=>{Cg.has(t)||Cg.set(t,Cg.size);const i=`${Cg.get(t)}:${e}:${s}`;return b_.has(i)||b_.set(i,n()),b_.get(i)}),"ze"),Qo=Se(((t,e)=>()=>([t,e]=[e,t],[t,e])),"$"),Qe=Se(((t,e=go)=>{const s=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),s}),"b"),N1=Se(((t,e,s)=>{const n=t.createShader(e);if(n===null)throw new Error("Cannot create WebGL shader.");return t.shaderSource(n,s),t.compileShader(n),n}),"ce"),ea=Se(((t,e,s)=>mH(t,e,s,(()=>{const n=t.createProgram();if(t.attachShader(n,N1(t,t.VERTEX_SHADER,e)),t.attachShader(n,N1(t,t.FRAGMENT_SHADER,s)),t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS)){const i=t.getProgramInfoLog(n);throw t.deleteProgram(n),new Error(`Could not link WebGL program: 
${i}`)}return n}))),"q"),ii=Se(((t,{size:e,data:s,type:n,internalFormat:i=t.RGBA32F,format:r=t.RGBA})=>{const o=t.createTexture(),[a,l]=e.map((u=>Math.max(1,u)));return s instanceof Float32Array&&s.byteLength===0?s=new Float32Array(a*l*4):s instanceof Uint32Array&&s.byteLength===0&&(s=new Uint32Array(a*l*4)),t.bindTexture(t.TEXTURE_2D,o),t.texImage2D(t.TEXTURE_2D,0,i,a,l,0,r,n,s),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),{size:e,data:s,type:n,format:r,handle:o}}),"k"),Jo=Se(((t,e)=>{const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);const n=t.checkFramebufferStatus(t.FRAMEBUFFER);if(n!==t.FRAMEBUFFER_COMPLETE){const i={[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT]:"Attachment is NOT complete.",[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT]:"No valid attachment.",[t.FRAMEBUFFER_UNSUPPORTED]:"Attachment types are not supported."}[n];throw i?new Error(`Framebuffer: ${i}`):new Error(`Framebuffer: Unknown reason (status: ${n})`)}return s}),"W"),Xa=Se(((t,e,s)=>{t.useProgram(e);const n={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let r=0;r<i;r++){const o=t.getActiveUniform(e,r);if(!o)throw new Error(`Cannot get GL active uniform ${r}.`);const{name:a,size:l,type:u}=o,h=t.getUniformLocation(e,a);if(!h)throw new Error(`Cannot get GL uniform location ${a}.`);n[a]={size:l,data:s[a],type:u,location:h}}return n}),"Y");function sa(t,e,s={}){let n=0;const i=pH();return Object.entries(e).forEach((([r,{location:o,type:a,data:l}])=>{let u=s[r]!==void 0?s[r]:l;(a===t.SAMPLER_2D||a===t.INT_SAMPLER_2D||a===t.UNSIGNED_INT_SAMPLER_2D)&&(t.activeTexture(t.TEXTURE0+n),t.bindTexture(t.TEXTURE_2D,u),u=n,n++),t[i[a]](o,u)}))}Se(sa,"J");var M1=Se(((t,e=!1)=>{const s=e?1<<Math.ceil(Math.log2(Math.sqrt(t))):Math.ceil(Math.sqrt(t));return{w:s,h:s}}),"ue"),Gl=Se(((t,e,{x:s,y:n,w:i})=>{const r=s+t%i;return(n+Math.floor(t/i))*e+r}),"Q"),ax=Se((t=>{const e=new Map,s={nodes:[],edges:[]};return t.nodes.forEach(((n,i)=>{e.has(n.id)&&console.warn(`Duplicated ID ${n.id}@${i}`),s.nodes.push({...n,id:i}),e.set(n.id,i)})),t.edges.forEach((n=>{const i=e.get(n.source),r=e.get(n.target);return i===void 0?console.warn(`Missing source ${n.source}`):r===void 0?console.warn(`Missing target ${n.target}`):void s.edges.push({...n,source:Math.min(i,r),target:Math.max(i,r)})})),s.edges.sort(((n,i)=>n.source-i.source||n.target-i.target)),s}),"it"),_H=Se((({nodes:t,edges:e},[s,n]=[0,0],i=.001)=>{const r=Math.PI*(3-Math.sqrt(5)),o=t.map((l=>(l.x=(l.x||0)-s,l.y=(l.y||0)-n,l))).map((l=>({n:l,key:l.pinned?0:.5+Math.floor(l.x/i)+Math.floor(l.y/i)/i}))).sort(((l,u)=>l.key-u.key));let a=0;return o.forEach((({n:l,key:u},h)=>{if(u*h==0||u!==o[h-1].key)return a=h;const g=Math.sqrt(h-a);l.x=o[a].n.x+g*Math.cos(r*(h-a)),l.y=o[a].n.y+g*Math.sin(r*(h-a))})),{nodes:t,edges:e}}),"at"),k1=Se(((t,e)=>{const s={};return e.forEach(((n,i)=>(s[n]??(s[n]=new Set)).add(i))),[...Object.values(s)].map((n=>({nodes:[...n].map((i=>t.nodes[i])),edges:t.edges.filter((({source:i,target:r})=>n.has(i)&&n.has(r)))})))}),"st");function lx(t,e){const s=e.map((({nodes:S})=>({x:0,y:0,...M1(S.length,!0)}))),n=e.map((({edges:S})=>({x:0,y:0,...M1(2*S.length)}))),i=_u(s.slice()),r=_u(n.slice()),o=i.w*i.h,a=r.w*r.h,l=new Float32Array(4*o),u=new Uint32Array(3*o),h=new Uint32Array(2*a),g=new Float32Array(4*o),f=new Float32Array(a);e.forEach((({nodes:S,edges:A},w)=>{const L=S.length,M=A.length,F=s[w],O=n[w],G=new Uint32Array(M),j=new Uint32Array(M),Z=new Uint32Array(L);for(let ht=0;ht<M;ht++){const{source:nt,target:ot}=A[ht];G[ht]=nt,j[ht]=ot,Z[nt]++,Z[ot]++}const at=L1(L,(()=>[]));G.forEach(((ht,nt)=>{at[ht].push(j[nt]),at[j[nt]].push(ht)}));const pt=L1(L,(()=>[]));G.forEach(((ht,nt)=>{if(A[nt].stiffness!==void 0)pt[ht].push(A[nt].stiffness),pt[j[nt]].push(A[nt].stiffness);else{const ot=Z[ht],Mt=Z[j[nt]],Q=ot*Mt/(Math.min(ot,Mt)*(ot+Mt));pt[ht].push(Q),pt[j[nt]].push(Q)}}));for(let ht=0;ht<L;ht++){const nt=4*Gl(ht,i.w,F);l[nt]=S[ht].x||0,l[nt+1]=S[ht].y||0}let K=0;for(let ht=0;ht<L;ht++){const nt=3*Gl(ht,i.w,F);u[nt]=K%O.w,u[nt+1]=Math.floor(K/O.w),u[nt+2]=Z[ht],K+=Z[ht]}let ut=0;for(let ht=0;ht<L;ht++)for(const nt of at[ht]){const ot=2*Gl(ut,r.w,O);h[ot]=nt%F.w,h[ot+1]=Math.floor(nt/F.w),ut++}for(let ht=0;ht<L;ht++){const nt=4*Gl(ht,i.w,F);g[nt]=S[ht].mass||Z[ht]+1,g[nt+1]=S[ht].r||1,g[nt+2]=S[ht].pinned?1:0}ut=0;for(let ht=0;ht<L;ht++)for(const nt of pt[ht]){const ot=Gl(ut,r.w,O);f[ot]=nt,ut++}}));const p=ii(t,{size:[i.w,i.h],data:l,type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F}),y=ii(t,{size:[i.w,i.h],data:g,type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F}),_=ii(t,{size:[i.w,i.h],data:u,type:t.UNSIGNED_INT,format:t.RGB_INTEGER,internalFormat:t.RGB32UI}),x=ii(t,{size:[r.w,r.h],data:h,type:t.UNSIGNED_INT,format:t.RG_INTEGER,internalFormat:t.RG32UI}),v=ii(t,{size:[r.w,r.h],data:f,type:t.FLOAT,format:t.RED,internalFormat:t.R32F}),b=ii(t,{size:[i.w,i.h],data:g,type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F});return{items:e.map((({nodes:S,edges:A},w)=>({N:S.length,E:A.length,particlesPositionsSlot:s[w],particlesChargesSlot:s[w],adjacencyOffsetsSlot:s[w],adjacencyListsSlot:n[w],stiffnessSlot:n[w],nodesExtraPropertiesSlot:s[w]}))),texture:{particlesPositions:()=>p,particlesCharges:()=>y,adjacencyOffsets:()=>_,adjacencyLists:()=>x,stiffness:()=>v,nodesExtraProperties:()=>b}}}Se(lx,"mt");var I1=Se(((t,e)=>{t.deleteTexture(e.texture.particlesPositions().handle),t.deleteTexture(e.texture.particlesCharges().handle),t.deleteTexture(e.texture.adjacencyOffsets().handle),t.deleteTexture(e.texture.adjacencyLists().handle),t.deleteTexture(e.texture.stiffness().handle),t.deleteTexture(e.texture.nodesExtraProperties().handle)}),"ct"),Yd=Se((()=>({x:0,y:0,w:0,h:0})),"Z"),yH=`#version 300 es
precision highp float;precision highp int;vec2 c(vec2 c,vec2 e){return vec2(c.x*e.x-c.y*e.y,c.x*e.y+c.y*e.x);}vec2 c(vec2 c){return c.y=-c.y,c;}vec2 c(vec2 i[8],vec2 s,vec2 a){vec2 t,o=a-s,e=vec2(1,0);for(int s;s<8;++s)t+=c(i[s],e),e=c(e,o);return t;}vec2 c(vec2 e,vec4 c){return(e-c.xy)/c.zw;}uniform float m_x,m_y,m_z,m_10,m_11,m_12,m_u,m_v,m_w;uniform highp sampler2D m_13;uniform highp usampler2D m_14,m_15;uniform highp sampler2D m_16,m_17,m_7;uniform highp usampler2D m_18,m_19;uniform highp sampler2D m_1j,m_1k;flat in uvec4 m_2b,m_2c,m_2d,m_2e,m_2f,m_26,m_29,m_28,m_1y;flat in uint m_22,m_27,m_20;out vec4 outColor;void main(){uvec2 s=uvec2(gl_FragCoord.xy)-m_2b.xy;if(m_2b.z*s.y+s.x>=m_22)return;vec3 a=texelFetch(m_16,ivec2(m_2c.xy+s),0).xyz;if(a.z>0.)return;vec4 l=texelFetch(m_13,ivec2(m_2b.xy+s),0);vec2 i=l.xy,e=l.zw;ivec4 t=ivec4(texelFetch(m_14,ivec2(m_2e.xy+s),0));vec4 o=texelFetch(m_7,ivec2(m_26.xy),0);float r=float(1u<<m_27-1u);ivec2 u=ivec2(r*c(i,o));vec2 v=(vec2(u)+.5)/r;ivec2 p=u-ivec2(1);for(int c;c<9;++c){ivec2 t=p+ivec2(c%3,c/3);if(t>>m_27-1u!=ivec2(0))continue;uvec2 s=texelFetch(m_19,ivec2(m_28.xy)+t,0).xy;for(uint c=s.x;c<s.y;c++){uint l=texelFetch(m_18,ivec2(m_29.xy)+ivec2(c%m_29.z,c/m_29.z),0).x;ivec2 o=ivec2(l%m_2b.z,l/m_2b.z);vec2 t=texelFetch(m_13,ivec2(m_2b.xy)+o,0).xy-i;float u=dot(t,t)+1e-4;if(m_11>0.&&m_u<.5){float i=texelFetch(m_16,ivec2(m_2c.xy)+o,0).y,c=max(a.y+i+m_12,.01);if(u<c*c){float s=sqrt(u);e-=(c-s)*m_11*i/c*t/s;}}float r=texelFetch(m_16,ivec2(m_2c.xy)+o,0).x;e-=m_u*m_x*r*t/u;}}if(m_27>2u){vec2 t[8];ivec2 s=ivec2(m_1y.xy)+u;vec4 a=texelFetch(m_1j,s,0),l=texelFetch(m_1k,s,0);if(t[0]=a.xy,t[1]=a.zw,t[2]=l.xy,t[3]=l.zw,m_20>4u){vec4 c=texelFetch(m_1j,s,0);t[4]=c.xy,t[5]=c.zw;}if(m_20>6u){vec4 c=texelFetch(m_1k,s,0);t[6]=c.xy,t[7]=c.zw;}vec2 r=c(c(t,v,c(i,o))/o.z);e+=m_u*m_x*r;}ivec2 n;for(int s;s<t.z;s++){n=ivec2(texelFetch(m_15,ivec2(m_2d.xy)+t.xy,0).xy);float o=texelFetch(m_17,ivec2(m_2f.xy)+t.xy,0).x;vec2 c=texelFetch(m_13,ivec2(m_2b.xy)+n,0).xy-i;if(c*=1.-m_10/(length(c)+1e-4),e+=m_u*m_z*o*c/a.x,t.x+=1,t.x>=int(m_2d.z))t.x=0,t.y+=1;}e=m_v*(e-m_u*m_y*i);float x=dot(e,e);if(x>m_w)e*=sqrt(m_w/x);outColor=vec4(i+e,e);}`,xH=`#version 300 es
precision highp int;
precision highp float;

uniform uint m_c; 
uniform uvec2 m_1b;

in vec2 position; 
in uvec4 m_1c; 
in uvec4 m_1d; 
in uvec4 m_1e; 
in uvec4 m_1f; 
in uvec4 m_1g; 
in uvec4 m_s; 
in uvec4 m_1h; 
in uvec4 m_1i; 
in uvec4 m_e; 

in uint m_5; 
in uint m_t; 
in uint m_g; 

flat out uvec4 m_2b;
flat out uvec4 m_2c;
flat out uvec4 m_2d;
flat out uvec4 m_2e;
flat out uvec4 m_2f;
flat out uvec4 m_26;
flat out uvec4 m_29;
flat out uvec4 m_28;
flat out uvec4 m_1y;

flat out uint m_22;
flat out uint m_27;
flat out uint m_20;

void main() {
  m_2b = m_1c;
  m_2c = m_1d;
  m_2d = m_1e;
  m_2e = m_1f;
  m_2f = m_1g;
  m_26 = m_s;
  m_29 = m_1h;
  m_28 = m_1i;
  m_1y = m_e;

  m_22 = m_5;
  m_27 = m_t;
  m_20 = m_g;

  
  if(m_c != m_t - 1u) {
    gl_Position = vec4(0.f, 0.f, 0.f, 1.f);
    return;
  }

  
  vec2 posPx = (position + 1.f) * vec2(m_1c.zw) * .5f + vec2(m_1c.xy);
  gl_Position = vec4(posPx / vec2(m_1b) * 2.f - 1.f, 0.f, 1.f);
}`,vH=Se(((t,e,{charge:s,gravity:n,inertia:i,edgeStrength:r,edgeLength:o,elasticity:a,margin:l,maxDisplacement:u})=>{const h=ea(t,xH,yH),g=e.texture.particlesPositions(),f=ii(t,{type:t.FLOAT,size:g.size,data:new Float32Array(g.data.buffer.slice(0)),format:t.RGBA,internalFormat:t.RGBA32F}),p=Qo(g,f),y=Jo(t,f.handle),_=Jo(t,g.handle),x=Qo(y,_),v=Xa(t,h,{m_u:1,m_v:i,m_w:u**2,m_x:s,m_y:n,m_z:r,m_10:o,m_11:a,m_12:l,m_13:g.handle,m_14:e.texture.adjacencyOffsets().handle,m_15:e.texture.adjacencyLists().handle,m_16:e.texture.nodesExtraProperties().handle,m_17:e.texture.stiffness().handle,m_c:2,m_7:e.texture.spatialBoundaries().handle,m_18:e.texture.spatialKeys().handle,m_19:e.texture.gridCells().handle,m_1a:null,m_1b:g.size});let b=g;const S=[],A=new Set;function w(M=1){t.viewport(0,0,g.size[0],g.size[1]),t.useProgram(h),t.bindFramebuffer(t.FRAMEBUFFER,x()[0]);const[F,O]=p();b=O,A.forEach((G=>{var j,Z;t.bindVertexArray(S[G]),sa(t,v,{m_u:M,m_13:F.handle,m_7:e.texture.spatialBoundaries().handle,m_18:e.texture.spatialKeys().handle,m_c:G,m_1j:(j=e.texture.localExpansions(G,0))==null?void 0:j.handle,m_1k:(Z=e.texture.localExpansions(G,1))==null?void 0:Z.handle,m_14:e.texture.adjacencyOffsets().handle,m_15:e.texture.adjacencyLists().handle,m_16:e.texture.nodesExtraProperties().handle,m_17:e.texture.stiffness().handle,m_19:e.texture.gridCells().handle}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}))}e.items.forEach((({depth:M})=>{A.add(M-1)})),A.forEach((M=>{S[M]=t.createVertexArray(),t.bindVertexArray(S[M]);const F=t.getAttribLocation(h,"position");t.enableVertexAttribArray(F),Qe(t,go),t.vertexAttribPointer(F,2,t.FLOAT,!1,0,0);const O=t.getAttribLocation(h,"m_1c");t.enableVertexAttribArray(O);const G=e.items.map((ce=>ce.particlesPositionsSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(G)),t.vertexAttribIPointer(O,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(O,1);const j=t.getAttribLocation(h,"m_1d");t.enableVertexAttribArray(j);const Z=e.items.map((ce=>ce.nodesExtraPropertiesSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(Z)),t.vertexAttribIPointer(j,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(j,1);const at=t.getAttribLocation(h,"m_1e");t.enableVertexAttribArray(at);const pt=e.items.map((ce=>ce.adjacencyListsSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(pt)),t.vertexAttribIPointer(at,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(at,1);const K=t.getAttribLocation(h,"m_1f");t.enableVertexAttribArray(K);const ut=e.items.map((ce=>ce.adjacencyOffsetsSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(ut)),t.vertexAttribIPointer(K,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(K,1);const ht=t.getAttribLocation(h,"m_1g");t.enableVertexAttribArray(ht);const nt=e.items.map((ce=>ce.stiffnessSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(nt)),t.vertexAttribIPointer(ht,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(ht,1);const ot=t.getAttribLocation(h,"m_s");t.enableVertexAttribArray(ot);const Mt=e.items.map((ce=>ce.spatialBoundariesSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(Mt)),t.vertexAttribIPointer(ot,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(ot,1);const Q=t.getAttribLocation(h,"m_1h");t.enableVertexAttribArray(Q);const Et=e.items.map((ce=>ce.spatialKeysSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(Et)),t.vertexAttribIPointer(Q,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(Q,1);const Xt=t.getAttribLocation(h,"m_1i");t.enableVertexAttribArray(Xt);const Ht=e.items.map((ce=>ce.gridCellsSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(Ht)),t.vertexAttribIPointer(Xt,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(Xt,1);const Zt=t.getAttribLocation(h,"m_e");t.enableVertexAttribArray(Zt);const ae=Yd(),pe=e.items.map((ce=>ce.localExpansionsSlot[M]||ae)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(pe)),t.vertexAttribIPointer(Zt,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(Zt,1);const ne=t.getAttribLocation(h,"m_5");t.enableVertexAttribArray(ne),Qe(t,new Uint32Array(e.items.map((({N:ce})=>ce)))),t.vertexAttribIPointer(ne,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(ne,1);const te=t.getAttribLocation(h,"m_t");t.enableVertexAttribArray(te),Qe(t,new Uint32Array(e.items.map((ce=>ce.depth)))),t.vertexAttribIPointer(te,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(te,1);const se=t.getAttribLocation(h,"m_g");t.enableVertexAttribArray(se),Qe(t,new Uint32Array(e.items.map((ce=>ce.order)))),t.vertexAttribIPointer(se,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(se,1)})),Se(w,"P");const L=Se((()=>{t.deleteFramebuffer(y),t.deleteFramebuffer(_),t.deleteTexture(f.handle)}),"h");return{step:w,outputs:{items:e.items.map((M=>({N:M.N,pointsSlot:M.particlesPositionsSlot}))),texture:{points:()=>b}},destroy:L}}),"Fe"),bH=`#version 300 es
precision highp float;vec2 l(vec2 l,vec2 x){return vec2(l.x*x.x-l.y*x.y,l.x*x.y+l.y*x.x);}vec2 x(vec2 x,vec2 l){return vec2(dot(x,l),x.y*l.x-x.x*l.y)/dot(l,l);}uniform uint m_c;uniform highp sampler2D m_l,m_m,m_n,m_o,m_h,m_i,m_j,m_k;flat in uvec4 m_1y,m_1z;flat in uint m_20;layout(location=0)out vec4 l01;layout(location=1)out vec4 l23;layout(location=2)out vec4 l45;layout(location=3)out vec4 l67;void main(){float a=float(1u<<m_c);uvec2 i=uvec2(gl_FragCoord.xy)-m_1y.xy;vec2 r=(vec2(i)+.5)/a,e=texelFetch(m_h,ivec2(m_1y.xy+i),0).xy;if(e.x==0.)return;if(m_c>2u){uvec2 o=i>>1u;vec2 w=r-(vec2(i&65534u)+1.)/a,x=vec2(1,0);vec4 u=texelFetch(m_l,ivec2(m_1z.xy+o),0),y=m_20>2u?texelFetch(m_m,ivec2(m_1z.xy+o),0):vec4(0),e=m_20>4u?texelFetch(m_n,ivec2(m_1z.xy+o),0):vec4(0),z=m_20>6u?texelFetch(m_o,ivec2(m_1z.xy+o),0):vec4(0);switch(m_20){case 2u:l01.xy+=l(u.xy,1.*x),l01.zw+=l(u.zw,1.*x),x=l(x,w),l01.xy+=l(u.zw,1.*x);break;case 3u:case 4u:l01.xy+=l(u.xy,1.*x),l01.zw+=l(u.zw,1.*x),l23.xy+=l(y.xy,1.*x),l23.zw+=l(y.zw,1.*x),x=l(x,w),l01.xy+=l(u.zw,1.*x),l01.zw+=l(y.xy,2.*x),l23.xy+=l(y.zw,3.*x),x=l(x,w),l01.xy+=l(y.xy,1.*x),l01.zw+=l(y.zw,3.*x),x=l(x,w),l01.xy+=l(y.zw,1.*x);break;case 5u:case 6u:l01.xy+=l(u.xy,1.*x),l01.zw+=l(u.zw,1.*x),l23.xy+=l(y.xy,1.*x),l23.zw+=l(y.zw,1.*x),l45.xy+=l(e.xy,1.*x),l45.zw+=l(e.zw,1.*x),x=l(x,w),l01.xy+=l(u.zw,1.*x),l01.zw+=l(y.xy,2.*x),l23.xy+=l(y.zw,3.*x),l23.zw+=l(e.xy,4.*x),l45.xy+=l(e.zw,5.*x),x=l(x,w),l01.xy+=l(y.xy,1.*x),l01.zw+=l(y.zw,3.*x),l23.xy+=l(e.xy,6.*x),l23.zw+=l(e.zw,10.*x),x=l(x,w),l01.xy+=l(y.zw,1.*x),l01.zw+=l(e.xy,4.*x),l23.xy+=l(e.zw,10.*x),x=l(x,w),l01.xy+=l(e.xy,1.*x),l01.zw+=l(e.zw,5.*x),x=l(x,w),l01.xy+=l(e.zw,1.*x);break;case 7u:case 8u:l01.xy+=l(u.xy,1.*x),l01.zw+=l(u.zw,1.*x),l23.xy+=l(y.xy,1.*x),l23.zw+=l(y.zw,1.*x),l45.xy+=l(e.xy,1.*x),l45.zw+=l(e.zw,1.*x),l67.xy+=l(z.xy,1.*x),l67.zw+=l(z.zw,1.*x),x=l(x,w),l01.xy+=l(u.zw,1.*x),l01.zw+=l(y.xy,2.*x),l23.xy+=l(y.zw,3.*x),l23.zw+=l(e.xy,4.*x),l45.xy+=l(e.zw,5.*x),l45.zw+=l(z.xy,6.*x),l67.xy+=l(z.zw,7.*x),x=l(x,w),l01.xy+=l(y.xy,1.*x),l01.zw+=l(y.zw,3.*x),l23.xy+=l(e.xy,6.*x),l23.zw+=l(e.zw,10.*x),l45.xy+=l(z.xy,15.*x),l45.zw+=l(z.zw,21.*x),x=l(x,w),l01.xy+=l(y.zw,1.*x),l01.zw+=l(e.xy,4.*x),l23.xy+=l(e.zw,10.*x),l23.zw+=l(z.xy,20.*x),l45.xy+=l(z.zw,35.*x),x=l(x,w),l01.xy+=l(e.xy,1.*x),l01.zw+=l(e.zw,5.*x),l23.xy+=l(z.xy,15.*x),l23.zw+=l(z.zw,35.*x),x=l(x,w),l01.xy+=l(e.zw,1.*x),l01.zw+=l(z.xy,6.*x),l23.xy+=l(z.zw,21.*x),x=l(x,w),l01.xy+=l(z.xy,1.*x),l01.zw+=l(z.zw,7.*x),x=l(x,w),l01.xy+=l(z.zw,1.*x);break;}}ivec2 y=(ivec2(i)&65534)-2;for(uint n;n<36u;n++){ivec2 t=y+ivec2(int(n)%6,int(n)/6);vec4 w=texelFetch(m_h,ivec2(m_1y.xy)+t,0);if(w.x==0.)continue;vec2 s=vec2(t-ivec2(i));if(dot(s,s)<=2.||t>>ivec2(m_c)!=ivec2(0))continue;vec2 c=x(vec2(1,0),r-(vec2(t)+.5)/a),e=c;vec4 z=m_20>2u?texelFetch(m_i,ivec2(m_1y.xy)+t,0):vec4(0),u=m_20>4u?texelFetch(m_j,ivec2(m_1y.xy)+t,0):vec4(0),o=m_20>6u?texelFetch(m_k,ivec2(m_1y.xy)+t,0):vec4(0);if(l01.xy+=l(w.xy,e),e=l(e,c),l01.xy+=l(w.zw,1.*e),l01.zw+=l(w.xy,-e),e=l(e,c),m_20>=3u)l01.xy+=l(z.xy,1.*e),l23.xy+=l(w.xy,e);if(l01.zw+=l(w.zw,-2.*e),m_20<3u)continue;if(e=l(e,c),l01.xy+=l(z.zw,1.*e),l01.zw+=l(z.xy,-3.*e),l23.xy+=l(w.zw,3.*e),l23.zw+=l(w.xy,-e),e=l(e,c),m_20>=5u)l01.xy+=l(u.xy,1.*e);if(l01.zw+=l(z.zw,-4.*e),l23.xy+=l(z.xy,6.*e),l23.zw+=l(w.zw,-4.*e),m_20>=5u)l45.xy+=l(w.xy,e);if(e=l(e,c),l23.xy+=l(z.zw,10.*e),l23.zw+=l(z.xy,-10.*e),m_20>=5u)l01.xy+=l(u.zw,1.*e),l01.zw+=l(u.xy,-5.*e),l45.xy+=l(w.zw,5.*e),l45.zw+=l(w.xy,-e);if(e=l(e,c),l23.zw+=l(z.zw,-20.*e),m_20>=7u)l01.xy+=l(o.xy,1.*e),l67.xy+=l(w.xy,e);if(m_20>=5u)l01.zw+=l(u.zw,-6.*e),l23.xy+=l(u.xy,15.*e),l45.xy+=l(z.xy,15.*e),l45.zw+=l(w.zw,-6.*e);if(m_20<5u)continue;if(e=l(e,c),m_20>=7u)l67.zw+=l(w.xy,-e),l67.xy+=l(w.zw,7.*e),l01.zw+=l(o.xy,-7.*e),l01.xy+=l(o.zw,1.*e);if(l45.zw+=l(z.xy,-21.*e),l45.xy+=l(z.zw,35.*e),l23.zw+=l(u.xy,-35.*e),l23.xy+=l(u.zw,21.*e),e=l(e,c),m_20>=7u)l67.zw+=l(w.zw,-8.*e),l67.xy+=l(z.xy,28.*e),l23.xy+=l(o.xy,28.*e),l01.zw+=l(o.zw,-8.*e);if(l45.zw+=l(z.zw,-56.*e),l45.xy+=l(u.xy,70.*e),l23.zw+=l(u.zw,-56.*e),e=l(e,c),m_20>=7u)l67.zw+=l(z.xy,-36.*e),l67.xy+=l(z.zw,84.*e),l23.zw+=l(o.xy,-84.*e),l23.xy+=l(o.zw,36.*e);if(l45.zw+=l(u.xy,-126.*e),l45.xy+=l(u.zw,126.*e),e=l(e,c),m_20>=7u)l67.zw+=l(z.zw,-120.*e),l67.xy+=l(u.xy,210.*e),l45.xy+=l(o.xy,210.*e),l23.zw+=l(o.zw,-120.*e);if(l45.zw+=l(u.zw,-252.*e),m_20<7u)continue;e=l(e,c),l67.zw+=l(u.xy,-330.*e),l67.xy+=l(u.zw,462.*e),l45.zw+=l(o.xy,-462.*e),l45.xy+=l(o.zw,330.*e),e=l(e,c),l67.zw+=l(u.zw,-792.*e),l67.xy+=l(o.xy,924.*e),l45.zw+=l(o.zw,-792.*e),e=l(e,c),l67.zw+=l(o.xy,-1716.*e),l67.xy+=l(o.zw,1716.*e),e=l(e,c),l67.zw+=l(o.zw,-3432.*e);}}`,EH=`#version 300 es
precision mediump int;
precision highp float;

uniform uvec2 m_d;

in vec2 position; 
in uvec4 m_e; 
in uvec4 m_f; 
in uint m_g; 

flat out uvec4 m_1y;
flat out uvec4 m_1z;
flat out uint m_20;

void main() {
  m_1y = m_e;
  m_1z = m_f;
  m_20 = m_g;

  
  vec2 posPx = (position + 1.f) * vec2(m_e.zw) * .5f + vec2(m_e.xy);
  gl_Position = vec4(posPx / vec2(m_d) * 2.f - 1.f, 0.f, 1.f);
}`,SH=Se(((t,e)=>{const s=ea(t,EH,bH),n=Math.max(...e.items.map((({depth:h})=>h))),i=[];e.items.forEach((({order:h,depth:g,multipolesSlot:f})=>{const p={};for(let y=n-1;y>=2;y--)p[y]=f[y];i.push({order:h,depth:g,localExpansionsSlot:p})}));const r=[];for(let h=n-1;h>=1;h--){r[h]=[];const[g,f]=h===1?[1,1]:e.texture.multipoles(h,0).size;for(let p=0;p<4;p++)r[h][p]=ii(t,{size:[g,f],data:new Float32Array(4*g*f),type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F})}const o=r.map(((h,g)=>{const f=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,f),h.forEach(((p,y)=>{t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+y,t.TEXTURE_2D,p.handle,0)})),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1,t.COLOR_ATTACHMENT2,t.COLOR_ATTACHMENT3]),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&console.error(`FBO incomplete for level ${g}`),f})),a=Xa(t,s,{m_c:2,m_d:[0,0]}),l=[];for(let h=n-1;h>=2;h--){l[h]=t.createVertexArray(),t.bindVertexArray(l[h]);const g=t.getAttribLocation(s,"position");t.enableVertexAttribArray(g),Qe(t,go),t.vertexAttribPointer(g,2,t.FLOAT,!1,0,0);const f=t.getAttribLocation(s,"m_e");t.enableVertexAttribArray(f);const p=i.map((({localExpansionsSlot:v})=>v[h])).map((({x:v,y:b,w:S,h:A})=>[v,b,S,A])).flat();Qe(t,new Uint32Array(p)),t.vertexAttribIPointer(f,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(f,1);const y=t.getAttribLocation(s,"m_f");t.enableVertexAttribArray(y);const _=i.map((({localExpansionsSlot:v})=>h>=3?v[h-1]:Yd())).map((({x:v,y:b,w:S,h:A})=>[v,b,S,A])).flat();Qe(t,new Uint32Array(_)),t.vertexAttribIPointer(y,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(y,1);const x=t.getAttribLocation(s,"m_g");t.enableVertexAttribArray(x),Qe(t,new Uint32Array(e.items.map((v=>v.order)))),t.vertexAttribIPointer(x,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(x,1)}function u(){t.useProgram(s);for(let h=2;h<n;h++){t.bindVertexArray(l[h]);const g=r[h-1],f=r[h];t.viewport(0,0,...f[0].size),t.bindFramebuffer(t.FRAMEBUFFER,o[h]),sa(t,a,{m_c:h,m_h:e.texture.multipoles(h,0).handle,m_i:e.texture.multipoles(h,1).handle,m_j:e.texture.multipoles(h,2).handle,m_k:e.texture.multipoles(h,3).handle,m_l:g[0].handle,m_m:g[1].handle,m_n:g[2].handle,m_o:g[3].handle,m_d:f[0].size}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}}return Se(u,"u"),{step:u,outputs:{items:i,texture:{localExpansions:(h,g)=>r[h]&&r[h][g]}},destroy:()=>{o.forEach((h=>t.deleteFramebuffer(h))),r.forEach((h=>h.forEach((({handle:g})=>t.deleteTexture(g))))),l.forEach((h=>t.deleteVertexArray(h)))}}}),"Ie"),AH=`#version 300 es
precision highp float;precision highp int;vec2 l(vec2 l,vec2 i){return vec2(l.x*i.x-l.y*i.y,l.x*i.y+l.y*i.x);}vec2 l(vec2 i,vec4 l){return(i-l.xy)/l.zw;}uniform highp sampler2D m_13,m_1n,m_7;uniform highp usampler2D m_18,m_19;uniform uint m_c;uniform highp sampler2D m_1s,m_1t,m_1u,m_1v;flat in uvec4 m_2g,m_2h,m_2b,m_26,m_29,m_28;flat in uint m_27,m_20;layout(location=0)out vec4 m01;layout(location=1)out vec4 m23;layout(location=2)out vec4 m45;layout(location=3)out vec4 m67;void main(){float s=float(1u<<m_c);uvec2 i=uvec2(gl_FragCoord.xy)-m_2g.xy;vec2 v=(vec2(i)+.5)/s;if(m_c==m_27-1u){vec4 e=texelFetch(m_7,ivec2(m_26.xy),0);uvec2 s=texelFetch(m_19,ivec2(m_28.xy+i),0).xy;for(uint t=s.x;t<s.y;t++){uint o=texelFetch(m_18,ivec2(m_29.xy)+ivec2(t%m_29.z,t/m_29.z),0).x;ivec2 c=ivec2(m_2b.xy)+ivec2(o%m_2b.w,o/m_2b.w);vec2 u=l(texelFetch(m_13,c,0).xy,e)-v;float x=texelFetch(m_1n,c,0).x;vec2 i=vec2(x,0.);if(m01.xy+=i,i=l(i,u),m01.zw+=i,m_20<3u)continue;if(i=l(i,u),m23.xy+=i,i=l(i,u),m23.zw+=i,m_20<5u)continue;if(i=l(i,u),m45.xy+=i,i=l(i,u),m45.zw+=i,m_20<7u)continue;i=l(i,u),m67.xy+=i,i=l(i,u),m67.zw+=i;}}else for(uint y;y<4u;++y){uvec2 x=2u*i+uvec2(y&1u,y>>1u);vec2 u=(vec2(x)+.5)/s/2.-v,e=vec2(1,0);vec4 t=texelFetch(m_1s,ivec2(m_2h.xy+x),0);if(m01.xy+=l(t.xy,1.*e),e=vec2(1,0),m01.zw+=l(t.zw,1.*e),e=l(e,u),m01.zw+=l(t.xy,1.*e),m_20<3u)continue;vec4 o=texelFetch(m_1t,ivec2(m_2h.xy+x),0);if(e=vec2(1,0),m23.xy+=l(o.xy,1.*e),e=l(e,u),m23.xy+=l(t.zw,2.*e),e=l(e,u),m23.xy+=l(t.xy,1.*e),e=vec2(1,0),m23.zw+=l(o.zw,1.*e),e=l(e,u),m23.zw+=l(o.xy,3.*e),e=l(e,u),m23.zw+=l(t.zw,3.*e),e=l(e,u),m23.zw+=l(t.xy,1.*e),m_20<5u)continue;vec4 c=texelFetch(m_1u,ivec2(m_2h.xy+x),0);if(e=vec2(1,0),m45.xy+=l(c.xy,1.*e),e=l(e,u),m45.xy+=l(o.zw,4.*e),e=l(e,u),m45.xy+=l(o.xy,6.*e),e=l(e,u),m45.xy+=l(t.zw,4.*e),e=l(e,u),m45.xy+=l(t.xy,1.*e),e=vec2(1,0),m45.zw+=l(c.zw,1.*e),e=l(e,u),m45.zw+=l(c.xy,5.*e),e=l(e,u),m45.zw+=l(o.zw,10.*e),e=l(e,u),m45.zw+=l(o.xy,10.*e),e=l(e,u),m45.zw+=l(t.zw,5.*e),e=l(e,u),m45.zw+=l(t.xy,1.*e),m_20<7u)continue;vec4 m=texelFetch(m_1v,ivec2(m_2h.xy+x),0);e=vec2(1,0),m67.xy+=l(m.xy,1.*e),e=l(e,u),m67.xy+=l(c.zw,6.*e),e=l(e,u),m67.xy+=l(c.xy,15.*e),e=l(e,u),m67.xy+=l(o.zw,20.*e),e=l(e,u),m67.xy+=l(o.xy,15.*e),e=l(e,u),m67.xy+=l(t.zw,6.*e),e=l(e,u),m67.xy+=l(t.xy,1.*e),e=vec2(1,0),m67.zw+=l(m.zw,1.*e),e=l(e,u),m67.zw+=l(m.xy,7.*e),e=l(e,u),m67.zw+=l(c.zw,21.*e),e=l(e,u),m67.zw+=l(c.xy,35.*e),e=l(e,u),m67.zw+=l(o.zw,35.*e),e=l(e,u),m67.zw+=l(o.xy,21.*e),e=l(e,u),m67.zw+=l(t.zw,7.*e),e=l(e,u),m67.zw+=l(t.xy,1.*e);}}`,wH=`#version 300 es
precision highp int;
precision highp float;

uniform uvec2 m_1p;

in vec2 position; 
in uvec4 m_1q; 
in uvec4 m_1r; 
in uvec4 m_1c; 

in uvec4 m_s; 
in uvec4 m_1h; 
in uvec4 m_1i; 
in uint m_t; 
in uint m_g; 

flat out uvec4 m_2g;
flat out uvec4 m_2h;
flat out uvec4 m_2b;

flat out uvec4 m_26;
flat out uvec4 m_29;
flat out uvec4 m_28;
flat out uint m_27;
flat out uint m_20;

void main() {
  m_2g = m_1q;
  m_2h = m_1r;
  m_2b = m_1c;
  
  m_26 = m_s;
  m_29 = m_1h;
  m_28 = m_1i;
  m_27 = m_t;
  m_20 = m_g;

  
  vec2 posPx = (position + 1.f) * vec2(m_1q.zw) * .5f + vec2(m_1q.xy);
  gl_Position = vec4(posPx / vec2(m_1p) * 2.f - 1.f, 0.f, 1.f);
}`,TH=Se(((t,e)=>{const s=ea(t,wH,AH),n=Math.max(...e.items.map((({depth:h})=>h))),i=[];e.items.forEach((({order:h,depth:g})=>{const f={};for(let p=n-1;p>=2;p--)f[p]=p>=g?Yd():{x:0,y:0,w:1<<p,h:1<<p};i.push({order:h,depth:g,multipolesSlot:f})}));const r=[];for(let h=n;h>=2;h--){r[h]=[];const{w:g,h:f}=_u(i.map((({multipolesSlot:p})=>p[h]||Yd())));for(let p=0;p<4;p++)r[h][p]=ii(t,{size:[g,f],data:new Float32Array(4*g*f),type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F})}const o=r.map(((h,g)=>{const f=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,f),h.forEach(((p,y)=>{t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+y,t.TEXTURE_2D,p.handle,0)})),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1,t.COLOR_ATTACHMENT2,t.COLOR_ATTACHMENT3]),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&console.error(`FBO incomplete for level ${g}`),f})),a=Xa(t,s,{m_c:n-1,m_13:e.texture.particlesPositions().handle,m_1n:e.texture.particlesCharges().handle,m_7:e.texture.spatialBoundaries().handle,m_18:e.texture.spatialKeys().handle,m_19:e.texture.gridCells().handle,m_1o:null,m_1p:[0,0]}),l=[];for(let h=n-1;h>=2;h--){l[h]=t.createVertexArray(),t.bindVertexArray(l[h]);const g=t.getAttribLocation(s,"position");t.enableVertexAttribArray(g),Qe(t,go),t.vertexAttribPointer(g,2,t.FLOAT,!1,0,0);const f=t.getAttribLocation(s,"m_1q");t.enableVertexAttribArray(f);const p=i.map((({multipolesSlot:G})=>G[h])).map((({x:G,y:j,w:Z,h:at})=>[G,j,Z,at])).flat();Qe(t,new Uint32Array(p)),t.vertexAttribIPointer(f,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(f,1);const y=t.getAttribLocation(s,"m_1r");t.enableVertexAttribArray(y);const _=i.map((({multipolesSlot:G,depth:j})=>h>=j-1?Yd():G[h+1])).map((({x:G,y:j,w:Z,h:at})=>[G,j,Z,at])).flat();Qe(t,new Uint32Array(_)),t.vertexAttribIPointer(y,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(y,1);const x=t.getAttribLocation(s,"m_1c");t.enableVertexAttribArray(x);const v=e.items.map((G=>G.particlesPositionsSlot)).map((({x:G,y:j,w:Z,h:at})=>[G,j,Z,at])).flat();Qe(t,new Uint32Array(v)),t.vertexAttribIPointer(x,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(x,1);const b=t.getAttribLocation(s,"m_s");t.enableVertexAttribArray(b);const S=e.items.map((G=>G.spatialBoundariesSlot)).map((({x:G,y:j,w:Z,h:at})=>[G,j,Z,at])).flat();Qe(t,new Uint32Array(S)),t.vertexAttribIPointer(b,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(b,1);const A=t.getAttribLocation(s,"m_1h");t.enableVertexAttribArray(A);const w=e.items.map((G=>G.spatialKeysSlot)).map((({x:G,y:j,w:Z,h:at})=>[G,j,Z,at])).flat();Qe(t,new Uint32Array(w)),t.vertexAttribIPointer(A,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(A,1);const L=t.getAttribLocation(s,"m_1i");t.enableVertexAttribArray(L);const M=e.items.map((G=>G.gridCellsSlot)).map((({x:G,y:j,w:Z,h:at})=>[G,j,Z,at])).flat();Qe(t,new Uint32Array(M)),t.vertexAttribIPointer(L,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(L,1);const F=t.getAttribLocation(s,"m_t");t.enableVertexAttribArray(F),Qe(t,new Uint32Array(e.items.map((G=>G.depth)))),t.vertexAttribIPointer(F,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(F,1);const O=t.getAttribLocation(s,"m_g");t.enableVertexAttribArray(O),Qe(t,new Uint32Array(e.items.map((G=>G.order)))),t.vertexAttribIPointer(O,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(O,1)}function u(){t.useProgram(s);for(let h=n-1;h>=2;h--){t.bindVertexArray(l[h]);const g=r[h+1],f=r[h][0].size;t.viewport(0,0,...f),t.bindFramebuffer(t.FRAMEBUFFER,o[h]),sa(t,a,{m_13:e.texture.particlesPositions().handle,m_7:e.texture.spatialBoundaries().handle,m_1n:e.texture.particlesCharges().handle,m_18:e.texture.spatialKeys().handle,m_19:e.texture.gridCells().handle,m_c:h,m_1s:g[0].handle,m_1t:g[1].handle,m_1u:g[2].handle,m_1v:g[3].handle,m_1p:f}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}}return Se(u,"u"),{step:u,outputs:{items:i,texture:{multipoles:(h,g)=>r[h]&&r[h][g]}},destroy:()=>{o.forEach((h=>t.deleteFramebuffer(h))),r.forEach((h=>h.forEach((({handle:g})=>t.deleteTexture(g))))),l.forEach((h=>t.deleteVertexArray(h)))}}}),"Re"),CH=`#version 300 es
precision highp int;uint u(uint u){return u&=65535u,u=(u|u<<8)&16711935u,u=(u|u<<4)&252645135u,u=(u|u<<2)&858993459u,u=(u|u<<1)&1431655765u,u;}uint u(uvec2 i){return u(i.y)<<1|u(i.x);}uniform highp usampler2D m_18;flat in uvec4 m_28,m_29;flat in uint m_22;out uvec2 outColor;uint i(uint e){uint u,i=m_22;for(;u<i;){uint t=u+i>>1,l=texelFetch(m_18,ivec2(m_29.xy)+ivec2(t%m_29.z,t/m_29.z),0).y;l<e?u=t+1u:i=t;}return u;}void main(){uvec2 t=uvec2(gl_FragCoord.xy);uint e=u((t-m_28.xy)%m_28.z);outColor=uvec2(i(e),i(e+1u));}`,LH=`#version 300 es
precision highp int;
precision mediump float;

uniform uvec2 m_1m;

in vec2 position; 
in uvec4 m_1i; 
in uvec4 m_1h; 
in uint m_5; 

flat out uvec4 m_28;
flat out uvec4 m_29;
flat out uint m_22;

void main() {
  m_28 = m_1i;
  m_29 = m_1h;
  m_22 = m_5;

  
  vec2 posPx = (position + 1.f) * vec2(m_1i.zw) * .5f + vec2(m_1i.xy);
  gl_Position = vec4(posPx / vec2(m_1m) * 2.f - 1.f, 0.f, 1.f);
}`,NH=Se(((t,e)=>{const s=ea(t,LH,CH),n=e.items.map((({depth:v})=>{const b=1<<v-1;return{x:0,y:0,w:b,h:b}})),i=_u(n.slice()),r=ii(t,{size:[i.w,i.h],data:new Uint32Array(2*i.w*i.h),type:t.UNSIGNED_INT,format:t.RG_INTEGER,internalFormat:t.RG32UI}),o=Jo(t,r.handle),a=Xa(t,s,{m_18:e.texture.spatialKeys().handle,m_1m:r.size}),l=t.createVertexArray();t.bindVertexArray(l);const u=t.getAttribLocation(s,"position");t.enableVertexAttribArray(u),Qe(t,go),t.vertexAttribPointer(u,2,t.FLOAT,!1,0,0);const h=t.getAttribLocation(s,"m_1i");t.enableVertexAttribArray(h);const g=n.map((({x:v,y:b,w:S,h:A})=>[v,b,S,A])).flat();Qe(t,new Uint32Array(g)),t.vertexAttribIPointer(h,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(h,1);const f=t.getAttribLocation(s,"m_1h");t.enableVertexAttribArray(f);const p=e.items.map((({spatialKeysSlot:v})=>v)).map((({x:v,y:b,w:S,h:A})=>[v,b,S,A])).flat();Qe(t,new Uint32Array(p)),t.vertexAttribIPointer(f,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(f,1);const y=t.getAttribLocation(s,"m_5");function _(){t.viewport(0,0,r.size[0],r.size[1]),t.useProgram(s),t.bindVertexArray(l),t.bindFramebuffer(t.FRAMEBUFFER,o),sa(t,a,{m_18:e.texture.spatialKeys().handle}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}t.enableVertexAttribArray(y),Qe(t,new Uint32Array(e.items.map((({N:v})=>v)))),t.vertexAttribIPointer(y,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(y,1),Se(_,"d");const x=Se((()=>{t.deleteFramebuffer(o),t.deleteTexture(r.handle)}),"N");return{step:_,outputs:{items:e.items.map((({N:v,depth:b},S)=>({N:v,depth:b,spatialBoundariesSlot:e.items[S].spatialBoundariesSlot,spatialKeysSlot:e.items[S].spatialKeysSlot,gridCellsSlot:n[S]}))),texture:{spatialBoundaries:e.texture.spatialBoundaries,spatialKeys:e.texture.spatialKeys,gridCells:()=>r}},destroy:x}}),"Me"),MH=`#version 300 es
precision highp int;uniform uint m_0,m_1;uniform highp usampler2D m_2;flat in uvec4 m_1w;flat in uint m_1x;out uvec2 outColor;uvec2 e(uvec2 e,uvec2 u,bool y){uvec2 t=e.x<4294967295u?texelFetch(m_2,ivec2(m_1w.xy)+ivec2(e.x%m_1w.z,e.x/m_1w.z),0).xy:e,o=u.x<4294967295u?texelFetch(m_2,ivec2(m_1w.xy)+ivec2(u.x%m_1w.z,u.x/m_1w.z),0).xy:u;if(y)return t.y<o.y?t:o;return t.y>o.y?t:o;}void main(){uvec2 u=uvec2(gl_FragCoord.xy);if(m_1x==1u){outColor=texelFetch(m_2,ivec2(u),0).xy;return;}uint t=uint(u.x-m_1w.x+m_1w.z*(u.y-m_1w.y)),s=texelFetch(m_2,ivec2(u),0).x,o=t^1u<<m_0-m_1,l=texelFetch(m_2,ivec2(m_1w.xy)+ivec2(o%m_1w.z,o/m_1w.z),0).x;bool y=(t>>m_0-m_1&1u)==0u;(t>>m_0&2u)==2u&&(y=!y),outColor=e(uvec2(t,s),uvec2(o,l),y);}`,kH=`#version 300 es
precision highp int;
precision highp float;

uniform uvec2 m_3;
uniform uint m_0;

in vec2 position; 
in uvec4 m_4; 
in uint m_5; 

flat out uvec4 m_1w;
flat out uint m_1x;

void main() {
  m_1w = m_4;
  m_1x = 0u;

  
  uint minN = 1u << m_0;
  if(minN >= m_5) {
    if(minN >= 2u * m_5) {
      gl_Position = vec4(0.f, 0.f, 0.f, 1.f);
      return;
    }
    
    m_1x = 1u;
  }

  
  vec2 posPx = (position + 1.f) * vec2(m_4.zw) * .5f + vec2(m_4.xy);
  gl_Position = vec4(posPx / vec2(m_3) * 2.f - 1.f, 0.f, 1.f);
}`,IH=Se((t=>{for(let e=0;e<t.length/2;e++)t[2*e]=e,t[2*e+1]=4294967295;return t}),"je"),NM=Se((t=>1<<Math.ceil(Math.log2(t))),"le"),RH=Se((t=>{if(t<2)return[1,1];const e=32-Math.clz32(t-1);return[1<<(e>>>1)+(1&e),1<<(e>>>1)]}),"ke"),MM=Se(((t,[e,s],n=IH(new Uint32Array(2*e*s)))=>ii(t,{size:[e,s],data:n,type:t.UNSIGNED_INT,format:t.RG_INTEGER,internalFormat:t.RG32UI})),"fe"),R1=Se(((t,[e,s],n=new Uint32Array(4*e*s))=>ii(t,{size:[e,s],data:n,type:t.UNSIGNED_INT,format:t.RGBA_INTEGER,internalFormat:t.RGBA32UI})),"xe"),FH=Se((t=>Math.max(0,Math.ceil(Math.log2(t)))),"He"),PH=Se((t=>t*(t+1)/2),"Ke"),zH=Se(((t,e)=>{const s=ea(t,kH,MH),n=e.texture.spatialKeys(),i=MM(t,n.size),r=Qo(i,n),o=Jo(t,n.handle),a=Jo(t,i.handle),l=Qo(o,a),u=Xa(t,s,{m_0:0,m_1:0,m_2:n.handle,m_3:n.size}),h=e.items.map((({N:w})=>FH(w))).reduce(((w,L)=>Math.max(w,L)),0),g=t.createVertexArray();t.bindVertexArray(g);const f=t.getAttribLocation(s,"position");t.enableVertexAttribArray(f),Qe(t,go),t.vertexAttribPointer(f,2,t.FLOAT,!1,0,0);const p=t.getAttribLocation(s,"m_4");t.enableVertexAttribArray(p);const y=e.items.map((({spatialKeysSlot:w})=>w)).map((({x:w,y:L,w:M,h:F})=>[w,L,M,F])).flat();Qe(t,new Uint32Array(y)),t.vertexAttribIPointer(p,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(p,1);const _=t.getAttribLocation(s,"m_5");t.enableVertexAttribArray(_),Qe(t,new Uint32Array(e.items.map((({N:w})=>w)))),t.vertexAttribIPointer(_,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(_,1);let x=0,v=0,b=n;function S(w=PH(h)){t.useProgram(s),t.bindVertexArray(g),t.viewport(0,0,i.size[0],i.size[1]);const L=e.texture.spatialKeys();b!==L&&(l(),r(),b=L);for(let M=0;M<w;M++){t.bindFramebuffer(t.FRAMEBUFFER,l()[0]);const[F,O]=r();b=O,sa(t,u,{m_0:x,m_1:v,m_2:F.handle}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length),v=(v+1)%(x+1),v===0&&(x=(x+1)%h)}}Se(S,"E");const A=Se((()=>{t.deleteFramebuffer(o),t.deleteFramebuffer(a),t.deleteTexture(i.handle)}),"P");return{step:S,outputs:{items:e.items,texture:{spatialKeys:()=>b}},destroy:A}}),"$e"),DH=`#version 300 es
precision highp int;uniform uint m_0,m_1;uniform highp usampler2D m_2,m_1l;flat in uvec4 m_1w,m_2a;flat in uint m_1x;layout(location=0)out uvec2 outKeys;layout(location=1)out uvec4 outIntervals;uint n(uint n,uint e,uint u,uint i){uint t=n<u?e+n:i-u+n;return texelFetch(m_2,ivec2(m_1w.xy)+ivec2(t%m_1w.z,t/m_1w.z),0).y;}void main(){ivec2 o=ivec2(gl_FragCoord.xy);if(m_1x==1u){outKeys=texelFetch(m_2,ivec2(o),0).xy;return;}uint i=m_2a.z*(uint(o.y)-m_2a.y)+(uint(o.x)-m_2a.x);uvec4 u;if(m_1==0u)u=uvec4(i&4294967294u,1u,(i&4294967294u)+1u,1u)<<m_0;else{uint n=i>>1u,t=m_2a.z==m_2a.w?m_2a.z:m_2a.z>>1u;u=texelFetch(m_1l,ivec2(m_2a.xy)+ivec2(n%t,n/t),0);}uint e=u.y+u.w>>1u,t=u.y<e?0u:u.y-e,y=u.y<e?u.y:e;for(;t<y;){uint i=t+(y-t>>1u);n(i,u.x,u.y,u.z)<n(i+e,u.x,u.y,u.z)?t=i+1u:y=i;}uvec4 l=(i&1u)==(i>>m_1+1u&1u)?uvec4(u.x,t,u.z+u.w-e+t,e-t):uvec4(u.x+t,u.y-t,u.z,u.w-e+t);if(m_0==m_1){uint n=l.y*l.x+l.w*l.z;outKeys=texelFetch(m_2,ivec2(m_1w.xy)+ivec2(n%m_1w.z,n/m_1w.z),0).xy;}else outIntervals=l;}`,OH=`#version 300 es
precision highp int;
precision highp float;

uniform uvec2 m_3;
uniform uint m_0;
uniform uint m_1;

in vec2 position; 
in uvec4 m_4; 
in uint m_5; 

flat out uvec4 m_1w;
flat out uvec4 m_2a;
flat out uint m_1x;

void main() {
  
  uint minN = 1u << m_0;
  if(minN >= m_5) {
    if(minN >= 2u * m_5) {
      gl_Position = vec4(0.f, 0.f, 0.f, 1.f);
      return;
    }
    
    m_1x = 1u;
  }

  
  uint delta = m_0 - m_1;
  uvec4 intervalSlot = m_4;
  if(intervalSlot.z == intervalSlot.w) {
    
    intervalSlot.z = intervalSlot.z >> (delta >> 1u);
    intervalSlot.w = intervalSlot.w >> ((delta + 1u) >> 1u);
  } else {
    
    intervalSlot.z = intervalSlot.z >> ((delta + 1u) >> 1u);
    intervalSlot.w = intervalSlot.w >> (delta >> 1u);
  }
  m_1w = m_4;
  m_2a = intervalSlot;

  
  vec2 posPx = (position + 1.f) * vec2(intervalSlot.zw) * .5f + vec2(intervalSlot.xy);
  gl_Position = vec4(posPx / vec2(m_3) * 2.f - 1.f, 0.f, 1.f);
}`,BH=Se((t=>Math.max(0,Math.ceil(Math.log2(t)))),"qe"),Lg=Se(((t,e,s)=>{const n=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.handle,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT1,t.TEXTURE_2D,s.handle,0),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1]),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&console.error("FBO incomplete"),{handle:n,ca0:e,ca1:s}}),"te"),UH=Se(((t,e)=>{const s=ea(t,OH,DH),n=t.getUniformLocation(s,"m_0"),i=t.getUniformLocation(s,"m_1"),r=t.getUniformLocation(s,"m_2"),o=t.getUniformLocation(s,"m_1l"),a=t.getUniformLocation(s,"m_3"),l=e.texture.spatialKeys(),u=MM(t,l.size),h=R1(t,l.size),g=R1(t,l.size),f=Qo(Lg(t,l,g),Lg(t,l,h)),p=Qo(Lg(t,u,g),Lg(t,u,h)),y=e.items.map((({N:L})=>BH(NM(L)))).reduce(((L,M)=>Math.max(L,M)),0),_=t.createVertexArray();t.bindVertexArray(_);const x=t.getAttribLocation(s,"position");t.enableVertexAttribArray(x),Qe(t,go),t.vertexAttribPointer(x,2,t.FLOAT,!1,0,0);const v=t.getAttribLocation(s,"m_4");t.enableVertexAttribArray(v);const b=e.items.map((({spatialKeysSlot:L})=>L)).map((({x:L,y:M,w:F,h:O})=>[L,M,F,O])).flat();Qe(t,new Uint32Array(b)),t.vertexAttribIPointer(v,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(v,1);const S=t.getAttribLocation(s,"m_5");function A(){t.bindVertexArray(_),t.viewport(0,0,...l.size),t.useProgram(s),t.uniform2ui(a,...l.size),t.uniform1i(r,0),t.uniform1i(o,1);for(let L=0;L<y;L++){t.activeTexture(t.TEXTURE0);const M=(1&L?u:l).handle;t.bindTexture(t.TEXTURE_2D,M),t.uniform1ui(n,L);for(let F=0;F<=L;F++){const[O,G]=1&L?f():p();t.bindFramebuffer(t.FRAMEBUFFER,O.handle),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,G.ca1.handle),t.uniform1ui(i,F),L===F?t.drawBuffers([t.COLOR_ATTACHMENT0,t.NONE]):F<2&&t.drawBuffers([t.NONE,t.COLOR_ATTACHMENT1]),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}}}t.enableVertexAttribArray(S),Qe(t,new Uint32Array(e.items.map((({N:L})=>L)))),t.vertexAttribIPointer(S,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(S,1),Se(A,"P");const w=Se((()=>{t.deleteTexture(u.handle),t.deleteTexture(g.handle),t.deleteTexture(h.handle),p().forEach((L=>t.deleteFramebuffer(L.handle))),f().forEach((L=>t.deleteFramebuffer(L.handle)))}),"h");return{step:A,outputs:{items:e.items,texture:{spatialKeys:()=>y-1&1?l:u}},destroy:w}}),"Ye"),GH=`#version 300 es
precision highp float;precision highp int;uint u(uint u){return u&=65535u,u=(u|u<<8)&16711935u,u=(u|u<<4)&252645135u,u=(u|u<<2)&858993459u,u=(u|u<<1)&1431655765u,u;}uint u(uvec2 t){return u(t.y)<<1|u(t.x);}vec2 u(vec2 t,vec4 u){return(t-u.xy)/u.zw;}uniform highp sampler2D m_b,m_7;flat in uvec4 m_24,m_25,m_26;flat in uint m_22,m_27;out uvec2 outColor;void main(){uvec2 o=uvec2(gl_FragCoord.xy);uint t=o.x-m_24.x+(o.y-m_24.y)*m_24.z;if(t>=m_22){outColor=uvec2(t,4294967295u);return;}uvec2 e=uvec2(t%m_25.z,t/m_25.z)+m_25.xy;vec4 i=texelFetch(m_7,ivec2(m_26.xy),0);vec2 n=u(texelFetch(m_b,ivec2(e),0).xy,i);outColor=uvec2(t,u(uvec2(float(1u<<m_27-1u)*n)));}`,VH=`#version 300 es
precision highp int;
precision highp float;

uniform uvec2 m_p;

in vec2 position; 
in uvec4 m_q; 
in uvec4 m_r; 
in uvec4 m_s; 
in uint m_5; 
in uint m_t; 

flat out uvec4 m_24;
flat out uvec4 m_25;
flat out uvec4 m_26;
flat out uint m_22;
flat out uint m_27;

void main() {
  m_24 = m_q;
  m_25 = m_r;
  m_26 = m_s;
  m_22 = m_5;
  m_27 = m_t;

  
  vec2 posPx = (position + 1.f) * vec2(m_q.zw) * .5f + vec2(m_q.xy);
  gl_Position = vec4(posPx / vec2(m_p) * 2.f - 1.f, 0.f, 1.f);
}`,jH=Se(((t,e)=>{const s=ea(t,VH,GH),n=e.items.map((({N:w})=>{const[L,M]=RH(NM(w));return{x:0,y:0,w:L,h:M}})),i=_u(n.slice()),r=new Uint32Array(2*i.w*i.h);n.forEach((w=>{for(let L=0;L<w.w*w.h;L++){const M=2*Gl(L,i.w,w);r[M]=L,r[M+1]=4294967295}}));const o=ii(t,{size:[i.w,i.h],data:r,type:t.UNSIGNED_INT,format:t.RG_INTEGER,internalFormat:t.RG32UI}),a=Jo(t,o.handle),l=Xa(t,s,{m_b:e.texture.points().handle,m_7:e.texture.spatialBoundaries().handle,m_p:o.size}),u=t.createVertexArray();t.bindVertexArray(u);const h=t.getAttribLocation(s,"position");t.enableVertexAttribArray(h),Qe(t,go),t.vertexAttribPointer(h,2,t.FLOAT,!1,0,0);const g=t.getAttribLocation(s,"m_q");t.enableVertexAttribArray(g);const f=n.map((({x:w,y:L,w:M,h:F})=>[w,L,M,F])).flat();Qe(t,new Uint32Array(f)),t.vertexAttribIPointer(g,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(g,1);const p=t.getAttribLocation(s,"m_r");t.enableVertexAttribArray(p);const y=e.items.map((({pointsSlot:w})=>w)).map((({x:w,y:L,w:M,h:F})=>[w,L,M,F])).flat();Qe(t,new Uint32Array(y)),t.vertexAttribIPointer(p,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(p,1);const _=t.getAttribLocation(s,"m_s");t.enableVertexAttribArray(_);const x=e.items.map((({spatialBoundariesSlot:w})=>w)).map((({x:w,y:L,w:M,h:F})=>[w,L,M,F])).flat();Qe(t,new Uint32Array(x)),t.vertexAttribIPointer(_,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(_,1);const v=t.getAttribLocation(s,"m_5");t.enableVertexAttribArray(v),Qe(t,new Uint32Array(e.items.map((({N:w})=>w)))),t.vertexAttribIPointer(v,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(v,1);const b=t.getAttribLocation(s,"m_t");function S(){t.viewport(0,0,o.size[0],o.size[1]),t.useProgram(s),t.bindVertexArray(u),t.bindFramebuffer(t.FRAMEBUFFER,a),sa(t,l,{m_b:e.texture.points().handle,m_7:e.texture.spatialBoundaries().handle}),t.drawArraysInstanced(t.TRIANGLES,0,6,n.length)}t.enableVertexAttribArray(b),Qe(t,new Uint32Array(e.items.map((({depth:w})=>w)))),t.vertexAttribIPointer(b,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(b,1),Se(S,"x");const A=Se((()=>{t.deleteFramebuffer(a),t.deleteTexture(o.handle)}),"E");return{step:S,outputs:{items:e.items.map(((w,L)=>({N:e.items[L].N,spatialKeysSlot:n[L]}))),texture:{spatialKeys:()=>o}},destroy:A}}),"Ze"),HH=`#version 300 es
precision mediump float;uniform mediump sampler2D m_b,m_7;uniform uint m_8;flat in uvec4 m_21;flat in uint m_22,m_23;out vec4 outColor;void main(){uvec2 o=uvec2(gl_FragCoord.xy);uint u=o.x-m_21.x+(o.y-m_21.y)*m_21.z;if(outColor=vec4(1e9,1e9,-1e9,-1e9),u>=m_22)return;if(m_8>=m_23){outColor=texelFetch(m_7,ivec2(o),0);return;}if(m_8==0u)outColor.xy=outColor.zw=texelFetch(m_b,ivec2(o),0).xy;else for(uint u;u<4u;u++){uvec2 e=(o-m_21.xy<<1u)+uvec2(u&1u,u>>1u)+m_21.xy;vec4 t=texelFetch(m_7,ivec2(e),0);outColor=vec4(min(outColor.xy,t.xy),max(outColor.zw,t.zw));}if(m_8==m_23-1u){vec2 o=outColor.zw-outColor.xy;outColor=vec4(outColor.xy-1.,vec2(max(o.x,o.y))+2.);}}`,$H=`#version 300 es
precision mediump int;
precision mediump float;

uniform uvec2 m_6;
uniform uint m_8;

in vec2 position; 
in uvec4 m_9; 
in uint m_5; 
in uint m_a; 

flat out uvec4 m_21;
flat out uint m_22;
flat out uint m_23;

void main() {
  uvec4 slot = uvec4(m_9.xy, m_9.zw >> min(m_8, m_23));
  m_21 = slot;
  m_22 = m_5;
  m_23 = m_a;

  
  vec2 posPx = (position + 1.f) * vec2(slot.zw) * .5f + vec2(m_21.xy);
  gl_Position = vec4(posPx / vec2(m_6) * 2.f - 1.f, 0.f, 1.f);
}`,qH=Se((t=>Math.ceil(Math.log2(Math.sqrt(t)))+1),"tt"),YH=Se(((t,e)=>{const s=ea(t,$H,HH),n=e.texture.points(),i=ii(t,{size:n.size,data:new Float32Array(n.data.buffer.slice(0)),type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F}),r=ii(t,{size:n.size,data:new Float32Array(n.data.buffer.slice(0)),type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F}),o=Qo(i,r),a=Jo(t,r.handle),l=Jo(t,i.handle),u=Qo(a,l),h=Xa(t,s,{m_6:n.size,m_7:i.handle,m_8:0}),g=e.items.map((({N:L})=>qH(L))),f=g.reduce(((L,M)=>Math.max(L,M)),0),p=t.createVertexArray();t.bindVertexArray(p);const y=t.getAttribLocation(s,"position");t.enableVertexAttribArray(y),Qe(t,go),t.vertexAttribPointer(y,2,t.FLOAT,!1,0,0);const _=t.getAttribLocation(s,"m_9");t.enableVertexAttribArray(_);const x=e.items.map((({pointsSlot:L})=>L)).map((({x:L,y:M,w:F,h:O})=>[L,M,F,O])).flat();Qe(t,new Uint32Array(x)),t.vertexAttribIPointer(_,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(_,1);const v=t.getAttribLocation(s,"m_5");t.enableVertexAttribArray(v),Qe(t,new Uint32Array(e.items.map((({N:L})=>L)))),t.vertexAttribIPointer(v,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(v,1);const b=t.getAttribLocation(s,"m_a");t.enableVertexAttribArray(b),Qe(t,new Uint32Array(g)),t.vertexAttribIPointer(b,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(b,1);let S=i;function A(){t.viewport(0,0,...i.size),t.useProgram(s),t.bindVertexArray(p);for(let L=0;L<f;L++){t.bindFramebuffer(t.FRAMEBUFFER,u()[0]);const[M,F]=o();S=F,sa(t,h,{m_b:e.texture.points().handle,m_6:e.texture.points().size,m_7:M.handle,m_8:L}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}}Se(A,"E");const w=Se((()=>{t.deleteFramebuffer(a),t.deleteFramebuffer(l),t.deleteTexture(r.handle),t.deleteTexture(i.handle)}),"P");return{step:A,outputs:{items:e.items.map((({pointsSlot:L})=>L)).map((({x:L,y:M})=>({spatialBoundariesSlot:{x:L,y:M,w:1,h:1}}))),texture:{spatialBoundaries:()=>S}},destroy:w}}),"rt"),WH=Se((t=>{let e;return()=>e||t().finally((()=>e=void 0))}),"nt"),XH=Se(((t,e)=>Math.max(.1,1-(t/Math.max(1,e-20))**7.39)),"ye"),ZH=Se(((t,e=25,s=24e3)=>{const n=(s-e)/(e-1);return Math.ceil(e*n*4/(n+t))}),"ve"),F1=Se((t=>{const e=Math.max(1,Math.ceil(Math.log2(t)/2));return t>65535?e+1:e}),"_e"),P1={charge:10,edgeStrength:.5,edgeLength:30,elasticity:.9,margin:1,gravity:.01,inertia:.9,maxDisplacement:1e3,steps:200},KH=Se(((t,e)=>{let[s,n]=[0,0];const i=Se((()=>{for(let o=0;o<t;o++,s++)if(!e(s))return!0}),"i"),r=Se((o=>{i()?o(s):n=requestAnimationFrame((()=>r(o)))}),"a");return{start:WH((()=>new Promise((o=>(s=0)||r(o))))),step:i,stop:()=>cancelAnimationFrame(n)}}),"Ae"),E_=Se(((t,e,s)=>{let n=e.texture.particlesPositions();const{steps:i,batch:r,sortingMethod:o}=s,a=s.order??4,l={items:e.items.map((({N:v,particlesPositionsSlot:b})=>({N:v,pointsSlot:b}))),texture:{points:()=>n}},u=YH(t,l),h=jH(t,{items:e.items.map((({N:v},b)=>({depth:Math.max(1,s.depth??F1(v)),...l.items[b],...u.outputs.items[b]}))),texture:{...l.texture,...u.outputs.texture}}),g=(o==="ibr"?UH:zH)(t,h.outputs),f=NH(t,{items:e.items.map((({N:v},b)=>({depth:Math.max(1,s.depth??F1(v)),...u.outputs.items[b],...g.outputs.items[b]}))),texture:{...u.outputs.texture,...g.outputs.texture}}),p=TH(t,{items:e.items.map(((v,b)=>({order:a,...v,...f.outputs.items[b]}))),texture:{particlesPositions:()=>n,particlesCharges:e.texture.particlesCharges,...f.outputs.texture}}),y=SH(t,{items:p.outputs.items,texture:{...p.outputs.texture}}),_=vH(t,{items:e.items.map(((v,b)=>({...v,...f.outputs.items[b],...y.outputs.items[b]}))),texture:{...e.texture,...f.outputs.texture,...y.outputs.texture}},s),x=e.items.reduce(((v,{N:b})=>Math.max(v,b)),0);return{...KH(r??ZH(x),(v=>(n=_.outputs.texture.points(),u.step(),h.step(),g.step(),f.step(),p.step(),y.step(),_.step(XH(v,i)),v<i))),destroy:()=>{u.destroy(),h.destroy(),g.destroy(),f.destroy(),p.destroy(),y.destroy(),_.destroy()}}}),"_t"),z1=0,kM=typeof window>"u",QH=typeof performance<"u"&&performance.now?performance:Date,JH=kM?t=>{const e=QH.now(),s=Math.max(0,16-(e-z1)),n=setTimeout((()=>t(e+s)),s);return z1=e+s,n}:window.requestAnimationFrame,t$=kM?t=>clearTimeout(t):window.cancelAnimationFrame;function IM(t,e,s){for(let n=0;n<t.length;n++){const i=t[n];i.x=e[n],i.y=s[n]}}Se(IM,"defaultUpdate");var e$=Se((()=>{}),"noop"),s$=.001,S_={movementRatio:7e-8,surfaceRatio:.0025},n$=.003,i$=Se(((t,e)=>n$*t**2+(e+1)),"defaultMass"),ux=class{constructor(t={}){this.onUpdate=Se((e=>{}),"onUpdate"),this.update=IM,this.nextTick=JH,this.cancelTick=t$,this.onEnd=e$,this.charge=10,this.maxIterations=200,this.minMovement=.1,this.edgeLength=30,this.edgeStrength=3,this.friction=.1,this.elasticity=.9,this.margin=1,this.cx=void 0,this.cy=void 0,this.gravity=.01,this.theta=.34,this.batch=void 0,this.inertia=.9,this.integrator=0,this.multilevel=!1,this.placement="none",this.placementOffset=10,this.alignSiblings=!1,this.bucketSize=void 0,this.maxDisplacement=1e3,this.siblingsMinAngle=0,this.siblingsOffset=.15,this.steps=200,this.scaling=1,this.defaultRadius=1,this.autoStop=S_,this.gpuAcceleration=!0,this.barnesHutOptimization=!0,"autoStop"in t?t.autoStop&&(typeof t.autoStop=="boolean"?t.autoStop=S_:t.autoStop={...t.autoStop,...S_}):t.steps;for(const e in t)t[e]===void 0&&e!=="order"&&e!=="depth"||(this[e]=t[e])}};Se(ux,"Settings");var r$=Se((({nodes:t,edges:e})=>{const s=t.length,n=e.length,i=new Uint32Array(s);for(let r=0;r<n;r++){const{source:o,target:a}=e[r];i[o]++,i[a]++}return i}),"degrees"),o$=Se(((t,e)=>({nodes:t.nodes.map(((s,n)=>{let i=(s.mass??1)*i$(s.r||1,e[n]);return i=Math.max(i,s$),{...s,mass:i}})),edges:t.edges.map((s=>{const n=s.weight||1,i=e[s.target]+1,r=e[s.source]+1,o=n*(i*r)/Math.min(i,r)/(i+r);return{...s,stiffness:o}}))})),"defaultSettings"),Ng=Se(((t,e)=>{const s=_H(ax(t),e);return o$(s,r$(s))}),"cleanGraph"),D1=class{constructor(t){this.promise=new Promise(t)}then(t){return this.promise.then(t)}stop(){return this.simulation.stop(),this}get iterations(){return this.simulation.iterations()}};function Xg(t,e,s={}){var x;let n,i;e.getExtension("EXT_color_buffer_float")||((x=e.getExtension("WEBGL_lose_context"))==null||x.loseContext());let r=new ux({...P1,...s});const o=t.nodes.length,a=s.cx||t.nodes.reduce(((v,b)=>v+(b.x||0)),0)/o,l=s.cy||t.nodes.reduce(((v,b)=>v+(b.y||0)),0)/o,u=[a,l],h=Array.from({length:o},((v,b)=>b)),g=Se((v=>{if(!n)throw new Error("No graph has been set");const{size:b}=n.texture.particlesPositions();if(b[0]*b[1]<=1)return{X:[0],Y:[0]};const S=[],A=[];let w=0;const L=new Float32Array(4*b[0]*b[1]);return e.readPixels(0,0,b[0],b[1],e.RGBA,e.FLOAT,L),n.items.forEach((({N:M,particlesPositionsSlot:F})=>{const{x:O,y:G,w:j}=F;for(let Z=0;Z<M;Z++){const at=O+Z%j,pt=4*((G+Math.floor(Z/j))*b[0]+at);S[h[w+Z]]=L[pt]+a,A[h[w+Z]]=L[pt+1]+l}w+=M})),v&&(f(),p()),{X:S,Y:A}}),"readLayoutData"),f=Se((()=>{i&&(i.stop(),i.destroy(),i=void 0)}),"simulationCleanup"),p=Se((()=>{n&&(I1(e,n),n=void 0)}),"graphLayoutCleanup"),y={setOptions:(v={})=>(r=new ux({...P1,...v}),n&&(f(),i=E_(e,n,r)),y),setGraph:(v={nodes:[],edges:[]})=>{let b;if(n&&I1(e,n),s.groups){const S={};Object.entries(s.groups).forEach((([A,w])=>w.forEach((L=>S[L]=Number(A))))),b=k1(ax(v),Object.values(S)),b.map((({nodes:A})=>A)).flat().forEach(((A,w)=>h[w]=A.id)),b=b.map((A=>Ng(A,u)))}else b=[Ng(v,u)];return n=lx(e,b),r&&(f(),i=E_(e,n,r)),y},start:()=>{if(!i)throw new Error("No graph has been set");return i.start().finally((()=>{var v;return(v=s.onEnd)==null?void 0:v.call(s,1)})).catch((v=>{throw new Error("Something went wrong during GPU layout: "+v)})),y},stop:()=>(i&&i.stop(),y),step:()=>{if(!i)throw new Error("No graph has been set");return i.step(),y},data:v=>g(v),iterations:()=>1};let _;if(s.groups){const v={};Object.entries(s.groups).forEach((([b,S])=>S.forEach((A=>v[A]=Number(b))))),_=k1(ax(t),Object.values(v)),_.map((({nodes:b})=>b)).flat().forEach(((b,S)=>h[S]=b.id)),_=_.map((b=>Ng(b,u)))}else _=[Ng(t,u)];return n=lx(e,_),i=E_(e,n,r),y}/**
* @preserve
* @linkurious/force-layout@1.0.9
* Ogma general-purpose force-directed layout
*/function O1(){var t=(()=>{var e=Object.defineProperty,s=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,r=(Y,et)=>e(Y,"name",{value:et,configurable:!0}),o={};((Y,et)=>{for(var J in et)e(Y,J,{get:et[J],enumerable:!0})})(o,{IntegratorType:()=>ss,force:()=>cs});var a=class{constructor(Y){let et=l();this.c=1,this.s0=et(" "),this.s1=et(" "),this.s2=et(" "),this.s0-=et(String(Y)),this.s0<0&&(this.s0+=1),this.s1-=et(String(Y)),this.s1<0&&(this.s1+=1),this.s2-=et(Y),this.s2<0&&(this.s2+=1),et=null}next(){return()=>{const Y=2091639*this.s0+23283064365386963e-26*this.c;return this.s0=this.s1,this.s1=this.s2,this.s2=Y-(this.c=0|Y)}}nextDouble(){const Y=this.next();return()=>Y()+11102230246251565e-32*(2097152*Y()|0)}nextInt32(){const Y=this.next();return()=>4294967296*Y()|0}};function l(){let Y=4022871197;return et=>{et=et.toString();for(let J=0;J<et.length;J++){Y+=et.charCodeAt(J);let tt=.02519603282416938*Y;Y=tt>>>0,tt-=Y,tt*=Y,Y=tt>>>0,tt-=Y,Y+=4294967296*tt}return 23283064365386963e-26*(Y>>>0)}}function u(Y){return new a(Y.toString()).next()}r(a,"Alea"),r(l,"Mash"),r(u,"impl");var h=u(42);function g(Y){h=u(Y)}function f(){return 1e-6*(h()-.5)}function p(Y,et,J,{edgeStrength:tt,edgeLength:ft}){const _t=J.sources,it=J.targets,vt=J.X,Ct=J.Y,Ft=J.R,Pt=J.fx,Lt=J.fy,Yt=J.degrees,$t=J.masses,Bt=J.weights;for(let Gt=0;Gt<et.length;Gt++){const qt=et[Gt],Kt=_t[qt],ee=it[qt],oe=1,re=Yt[Kt]+oe,C=Yt[ee]+oe,R=tt*Bt[qt];let U=vt[ee]+Pt[ee]-vt[Kt]-Pt[Kt]||f(),W=Ct[ee]+Lt[ee]-Ct[Kt]-Lt[Kt]||f();const St=U*U+W*W,bt=Math.sqrt(St),It=ft+Ft[Kt]+Ft[ee];if(bt<=It)continue;const Qt=It-bt,ie=Qt*(C*re/Math.min(C,re)/(C+re)),Ee=Math.min(1,Y*R*Qt/St*(ie*(C+re)/(C*re))),we=C*re/(C+re);U*=Ee,W*=Ee,Pt[Kt]+=U*we/$t[Kt],Lt[Kt]+=W*we/$t[Kt],Pt[ee]-=U*we/$t[ee],Lt[ee]-=W*we/$t[ee]}}r(g,"setSeed"),r(f,"randomize"),r(p,"attraction");var y=r(((Y,et)=>{const J=et.sources,tt=et.targets,ft=et.degrees,_t=et.weights,it=et.edgeIds,vt=et.nodeToGroup,Ct=et.hasGroups;for(let Ft=0;Ft<Y.length;Ft++){const{source:Pt,target:Lt,weight:Yt=1}=Y[Ft];J[Ft]=Pt,tt[Ft]=Lt,_t[Ft]=Yt,ft[Pt]++,ft[Lt]++,it[Ft]=Ft,_t[Ft]=Yt===void 0?1:Yt,Ct&&vt[Pt]!==vt[Lt]&&(_t[Ft]=0)}}),"initialize");function _(Y,et,J,{gravity:tt,cx:ft,cy:_t}){const it=J.X,vt=J.Y,Ct=J.fx,Ft=J.fy,Pt=J.nodeToGroup,Lt=J.cells,Yt=J.hasGroups,$t=et.length;for(let Bt=0;Bt<$t;Bt++){const Gt=et[Bt],qt=Yt?Lt[Pt[Bt]].cx:ft,Kt=Yt?Lt[Pt[Bt]].cy:_t,ee=qt-it[Gt]||f(),oe=Kt-vt[Gt]||f(),re=tt*Y;Ct[Gt]+=ee*re,Ft[Gt]+=oe*re}}p.initialize=y,r(_,"center");var x=r(((Y,et,J)=>{const{X:tt,Y:ft}=et;let _t=J.cx,it=J.cy;const vt=Y.length;if(_t===void 0||it===void 0){_t=it=0;for(let Ct=0;Ct<vt;Ct++)_t+=tt[Ct],it+=ft[Ct];_t/=vt,it/=vt}J.cx=_t,J.cy=it}),"initialize");_.initialize=x;var v=class{constructor(Y,et,J,tt){this.left=null,this.right=null,this.data=null,this.code=Y,this.data=et,this.left=J,this.right=tt}};function b(Y,et,J,tt,ft){const _t=new v(null,null,null,null),it=[_t],vt=[tt,ft];for(;it.length!==0;){const Ct=vt.pop(),Ft=vt.pop(),Pt=it.pop();if(Ct-Ft==0)Pt.code=J[Ft],Pt.data=Y[et[Ft]];else{const Lt=w(et,J,Ft,Ct);Pt.code=Lt,Ft<=Lt&&(Pt.left=new v(null,null,null,null),it.push(Pt.left),vt.push(Ft,Lt)),Ct>Lt&&(Pt.right=new v(null,null,null,null),it.push(Pt.right),vt.push(Lt+1,Ct))}}return _t}function S(Y,et,J,tt,ft,_t){const it=new v(null,null,null,null),vt=[it],Ct=[tt,ft];for(;vt.length!==0;){const Ft=Ct.pop(),Pt=Ct.pop(),Lt=vt.pop();if(Ft-Pt<_t){const Yt=new Array(Ft-Pt+1);for(let $t=Pt,Bt=0;$t<=Ft;$t++,Bt++)Yt[Bt]=Y[et[$t]];Lt.code=J[Pt],Lt.data=Yt}else{const Yt=w(et,J,Pt,Ft);Lt.code=Yt,Pt<=Yt&&(Lt.left=new v(null,null,null,null),vt.push(Lt.left),Ct.push(Pt,Yt)),Ft>Yt&&(Lt.right=new v(null,null,null,null),vt.push(Lt.right),Ct.push(Yt+1,Ft))}}return it}r(v,"Node"),r(b,"buildIterative"),r(S,"buildIterativeBuckets");var A=Math.clz32||r((function(et){let J=-2147483648;for(let tt=0;tt<31;tt+=1){if(J&et)return tt;J>>>=1}return 32}),"clz");function w(Y,et,J,tt){const ft=et[Y[J]],_t=et[Y[tt]];if(ft===_t)return J;const it=A(ft^_t);let vt,Ct,Ft,Pt=J,Lt=tt-J;do Lt=Lt+1>>1,vt=Pt+Lt,vt<tt&&(Ct=et[Y[vt]],Ft=A(ft^Ct),Ft>it&&(Pt=vt));while(Lt>1);return Pt}function L(Y,et){let J=Y^et,tt=65535^J,ft=65535^(Y|et),_t=Y&(65535^et),it=J|tt>>1,vt=J>>1^J,Ct=ft>>1^tt&_t>>1^ft,Ft=J&ft>>1^_t>>1^_t;J=it,tt=vt,ft=Ct,_t=Ft,it=J&J>>2^tt&tt>>2,vt=J&tt>>2^tt&(J^tt)>>2,Ct^=J&ft>>2^tt&_t>>2,Ft^=tt&ft>>2^(J^tt)&_t>>2,J=it,tt=vt,ft=Ct,_t=Ft,it=J&J>>4^tt&tt>>4,vt=J&tt>>4^tt&(J^tt)>>4,Ct^=J&ft>>4^tt&_t>>4,Ft^=tt&ft>>4^(J^tt)&_t>>4,J=it,tt=vt,ft=Ct,_t=Ft,Ct^=J&ft>>8^tt&_t>>8,Ft^=tt&ft>>8^(J^tt)&_t>>8,J=Ct^Ct>>1,tt=Ft^Ft>>1;let Pt=Y^et,Lt=tt|65535^(Pt|J);return Pt=16711935&(Pt|Pt<<8),Pt=252645135&(Pt|Pt<<4),Pt=858993459&(Pt|Pt<<2),Pt=1431655765&(Pt|Pt<<1),Lt=16711935&(Lt|Lt<<8),Lt=252645135&(Lt|Lt<<4),Lt=858993459&(Lt|Lt<<2),Lt=1431655765&(Lt|Lt<<1),(Lt<<1|Pt)>>>0}r(w,"findSplit"),r(L,"hilbert");var M=[0,1],F=[0,2];for(let Y=4;Y<65535;Y<<=2)for(let et=0,J=M.length;et<J;et++)M.push(M[et]|Y),F.push((M[et]|Y)<<1);function O(Y,et){return(F[255&et]|M[255&Y])+65536*(F[et>>8&255]|M[Y>>8&255])+4294967296*(F[et>>16&255]|M[Y>>16&255])}r(O,"morton");var G=new Uint32Array(1024);function j(Y,et){const J=new Uint32Array(et.length);for(let ft=0;ft<1024;ft++)G[ft]=0;const tt=255;for(let ft=0;ft<et.length;ft++){const _t=et[ft];G[_t&tt]++,G[256+(_t>>8&tt)]++,G[512+(_t>>16&tt)]++,G[768+(_t>>24&tt)]++}for(let ft=0;ft<4;ft++){let _t=0,it=0;const vt=256*ft;for(let Ct=0;Ct<256;Ct++)_t=G[Ct+vt],G[Ct+vt]=it,it+=_t}for(let ft=0;ft<et.length;ft++){const _t=et[ft];J[G[_t&tt]++]=ft}for(let ft=0;ft<et.length;ft++){const _t=J[ft],it=et[_t];Y[G[256+(it>>8&tt)]++]=_t}for(let ft=0;ft<et.length;ft++){const _t=Y[ft],it=et[_t];J[G[512+(it>>16&tt)]++]=_t}for(let ft=0;ft<et.length;ft++){const _t=J[ft],it=et[_t];Y[G[768+(it>>24&tt)]++]=_t}}r(j,"radixSort");var Z=class{constructor(Y,{getX:et,getY:J,bucketSize:tt=0,sfc:ft=1}={}){this.bucketSize=0,this._root=null;const _t=Y.length,it=new Uint32Array(_t);let vt=1/0,Ct=1/0,Ft=-1/0,Pt=-1/0;this._x=et,this._y=J;const Lt=ft===1?L:O;this._project=Lt;const Yt=new Uint32Array(_t);for(let Gt=0;Gt<_t;Gt++){const qt=Y[Gt],Kt=et(qt),ee=J(qt);Kt<vt&&(vt=Kt),ee<Ct&&(Ct=ee),Kt>Ft&&(Ft=Kt),ee>Pt&&(Pt=ee),Yt[Gt]=Gt}this._minX=vt,this._minY=Ct,this._maxX=Ft,this._maxY=Pt;const $t=65535/Math.max(Ft-vt,1),Bt=65535/Math.max(Pt-Ct,1);this._hw=$t,this._hh=Bt;for(let Gt=0;Gt<_t;Gt++){const qt=Y[Gt];it[Gt]=Lt($t*(et(qt)-vt),Bt*(J(qt)-Ct))}j(Yt,it),this._root=tt===0?b(Y,Yt,it,0,_t-1):S(Y,Yt,it,0,_t-1,tt),this.bucketSize=tt}get root(){return this._root}inOrder(Y,et){let J=this._root;const tt=[];let ft=!1;for(;!ft;)if(J)tt.push(J),J=J.left;else if(tt.length!==0){if(J=tt.pop(),Y.call(et,J))break;J=J.right}else ft=!0;return this}preOrder(Y,et){const J=[this._root];for(;J.length!==0;){const tt=J.pop();Y.call(et,tt)||(tt.right&&J.push(tt.right),tt.left&&J.push(tt.left))}return this}postOrder(Y,et){const J=[];let tt,ft=this._root;do{for(;ft;)ft.right&&J.push(ft.right),J.push(ft),ft=ft.left;ft=J.pop(),tt=J.length-1,ft.right&&J[tt]===ft.right?(J[tt]=ft,ft=ft.right):(Y.call(et,ft),ft=null)}while(J.length!==0);return this}map(Y,et){const J=[];return this.inOrder((tt=>{J.push(Y.call(et,tt))})),J}height(){return at(this._root)}toString(Y=(et=>et.code.toString())){const et=[];return pt(this._root,"",!0,(J=>et.push(J)),Y),et.join("")}size(){let Y=0;return this.preOrder((()=>{Y++})),Y}destroy(){return this._root=null,this}};function at(Y){return Y?1+Math.max(at(Y.left),at(Y.right)):0}function pt(Y,et,J,tt,ft){if(Y){tt(et+(J?"^-- ":"|-- ")+ft(Y)+`
`);const _t=et+(J?"    ":"|   ");Y.left&&pt(Y.left,_t,!1,tt,ft),Y.right&&pt(Y.right,_t,!0,tt,ft)}}function K(Y){for(let et=Y.length-1;et>=0;et--){let J=Math.floor(Math.random()*(et+1));J=Math.max(Math.min(J,et),0);const tt=Y[et];Y[et]=Y[J],Y[J]=tt}return Y}r(Z,"BVH"),r(at,"treeHeight"),r(pt,"row"),r(K,"shuffle");var ut,ht,nt,ot,Mt,Q,Et,Xt,Ht,Zt=r((Y=>Y.x),"getX"),ae=r((Y=>Y.y),"getY"),pe=r((Y=>Y.r),"getR");function ne(Y,et=Zt,J=ae,tt=pe){const ft=K(Y.slice()),_t=ft.length;let it,vt=[],Ct=0;for(;Ct<_t;){const Ft=ft[Ct];it&&ce(it,et(Ft),J(Ft),tt(Ft))?Ct++:(vt=te(vt,Ft,et,J,tt),it=ve(vt,et,J,tt),Ct=0)}return it}function te(Y,et,J,tt,ft){const _t=J(et),it=tt(et),vt=ft(et),Ct={x:_t,y:it,r:vt};if(Ce(Ct,Y,J,tt,ft))return[et];for(let Ft=0;Ft<Y.length;++Ft){const Pt=Y[Ft],Lt=J(Pt),Yt=tt(Pt),$t=ft(Pt);if(!se(Ct,Lt,Yt,$t)&&Ce(ge(Lt,Yt,$t,_t,it,vt),Y,J,tt,ft))return[Y[Ft],et]}for(let Ft=0;Ft<Y.length-1;Ft++)for(let Pt=Ft+1;Pt<Y.length;Pt++){const Lt=Y[Ft],Yt=Y[Pt],$t=J(Lt),Bt=tt(Lt),Gt=ft(Lt),qt=J(Yt),Kt=tt(Yt),ee=ft(Yt);if(!se(ge($t,Bt,Gt,qt,Kt,ee),_t,it,vt)&&!se(ge($t,Bt,Gt,_t,it,vt),qt,Kt,ee)&&!se(ge(qt,Kt,ee,_t,it,vt),$t,Bt,Gt)&&Ce(ze($t,Bt,Gt,qt,Kt,ee,_t,it,vt),Y,J,tt,ft))return[Y[Ft],Y[Pt],et]}throw new Error}function se(Y,et,J,tt){const ft=Y.r-tt,_t=et-Y.x,it=J-Y.y;return ft>=0&&ft*ft>_t*_t+it*it}function ce(Y,et,J,tt){const ft=Y.r-tt+1e-6,_t=et-Y.x,it=J-Y.y;return ft>0&&ft*ft>_t*_t+it*it}function Ce(Y,et,J,tt,ft){for(let _t=0;_t<et.length;++_t){const it=et[_t];if(!ce(Y,J(it),tt(it),ft(it)))return!1}return!0}function ve(Y,et,J,tt){return Y.length===1?Me(et(Y[0]),J(Y[0]),tt(Y[0])):Y.length===2?ge(et(Y[0]),J(Y[0]),tt(Y[0]),et(Y[1]),J(Y[1]),tt(Y[1])):ze(et(Y[0]),J(Y[0]),tt(Y[0]),et(Y[1]),J(Y[1]),tt(Y[1]),et(Y[2]),J(Y[2]),tt(Y[2]))}function Me(Y,et,J){return{x:Y,y:et,r:J}}function ge(Y,et,J,tt,ft,_t){const it=tt-Y,vt=ft-et,Ct=_t-J,Ft=Math.sqrt(it*it+vt*vt);return{x:(Y+tt+it/Ft*Ct)/2,y:(et+ft+vt/Ft*Ct)/2,r:(Ft+J+_t)/2}}function ze(Y,et,J,tt,ft,_t,it,vt,Ct){const Ft=(Y+tt+it)/3,Pt=(et+ft+vt)/3,Lt=Y-Ft,Yt=et-Pt,$t=tt-Ft,Bt=ft-Pt,Gt=it-Ft,qt=vt-Pt,Kt=Lt-$t,ee=Lt-Gt,oe=Yt-Bt,re=Yt-qt,C=_t-J,R=Ct-J,U=Lt*Lt+Yt*Yt-J*J,W=U-$t*$t-Bt*Bt+_t*_t,St=U-Gt*Gt-qt*qt+Ct*Ct,bt=ee*oe-Kt*re,It=(oe*St-re*W)/(2*bt)-Lt,Qt=(re*C-oe*R)/bt,ie=(ee*W-Kt*St)/(2*bt)-Yt,Ee=(Kt*R-ee*C)/bt,we=Qt*Qt+Ee*Ee-1,We=2*(J+It*Qt+ie*Ee),us=It*It+ie*ie-J*J,ms=-(Math.abs(we)>1e-6?(We+Math.sqrt(We*We-4*we*us))/(2*we):us/We);return{x:Ft+Lt+It+Qt*ms,y:Pt+Yt+ie+Ee*ms,r:ms}}function is(Y,et,J,{X:tt,Y:ft,R:_t,fx:it,fy:vt,bucketSize:Ct},{elasticity:Ft}){if(Ft===0)return J;J||(J=new Z(et,{getX:ut,getY:ht,bucketSize:Ct})).postOrder(ot);for(let Pt=0;Pt<et.length;Pt++)Q=et[Pt],Et=tt[Q]+it[Q],Xt=ft[Q]+vt[Q],Ht=_t[Q],J.preOrder(Mt);return J}r(ne,"med"),r(te,"extend"),r(se,"contains"),r(ce,"containsWeak"),r(Ce,"containsWeakAll"),r(ve,"enclose"),r(Me,"from1"),r(ge,"from2"),r(ze,"from3"),r(is,"collisionForce");var Ge=r((Y=>{const et=Y.X,J=Y.Y,tt=Y.R,ft=Y.bucketSize;return _t=>{let it,vt,Ct,Ft;const Pt=_t.data;if(Pt!==null)if(ft!==0){const Lt=ne(Pt,ut,ht,nt);it=Lt.x,vt=Lt.y,Ct=Lt.r}else{const Lt=Pt;it=et[Lt],vt=J[Lt],Ct=tt[Lt]}else if(_t.left&&_t.right){const Lt=_t.left.cx,Yt=_t.left.cy,$t=_t.right.cx,Bt=_t.right.cy,Gt=_t.left.r,qt=_t.right.r,Kt=$t-Lt,ee=Bt-Yt,oe=qt-Gt,re=Math.sqrt(Kt*Kt+ee*ee);it=(Lt+$t+Kt/re*oe)/2,vt=(Yt+Bt+ee/re*oe)/2,Ct=(re+Gt+qt)/2}else Ft=_t.left||_t.right,Ft&&(it=Ft.cx,vt=Ft.cy,Ct=Ft.r);_t.cx=it,_t.cy=vt,_t.r=Ct}}),"getMeasureBodies"),De=r(((Y,{elasticity:et,margin:J})=>{const tt=Y.X,ft=Y.Y,_t=Y.R,it=Y.fx,vt=Y.fy,Ct=Y.bucketSize,Ft=Y.nodeToGroup,Pt=Y.cellSize,Lt=Y.hasGroups;return Yt=>{const $t=Yt.data;if($t===null){const Bt=Yt.cx-Et,Gt=Yt.cy-Xt,qt=Yt.r+Ht;return Lt?Bt*Bt+Gt*Gt>Pt*Pt:Bt*Bt+Gt*Gt>qt*qt}if(Ct!==0){const Bt=$t;for(let Gt=0;Gt<Bt.length;Gt++){const qt=Bt[Gt];if(qt>Q){const Kt=_t[qt];let ee=Et-tt[qt]-it[qt],oe=Xt-ft[qt]-vt[qt];const re=Ht+Kt+J;let C=ee*ee+oe*oe;if(C<re*re){ee===0&&(ee=f(),C+=ee*ee),oe===0&&(oe=f(),C+=oe*oe);const R=Math.sqrt(C),U=(re-R)*et/R,W=Kt/re;it[Q]+=ee*U*W,vt[Q]+=oe*U*W,it[qt]-=ee*U*(1-W),vt[qt]-=oe*U*(1-W)}}}}else{const Bt=Yt.data;if(Lt&&Ft[Q]!==Ft[Bt])return;if(Bt>Q){const Gt=_t[Bt];let qt=Et-tt[Bt],Kt=Xt-ft[Bt];const ee=Ht+Gt+J;let oe=qt*qt+Kt*Kt;if(oe<ee*ee){qt===0&&(qt=f(),oe+=qt*qt),Kt===0&&(Kt=f(),oe+=Kt*Kt);const re=Math.sqrt(oe),C=(ee-re)*et/re,R=Gt/ee;it[Q]+=qt*C*R,vt[Q]+=Kt*C*R,it[Bt]-=qt*C*(1-R),vt[Bt]-=Kt*C*(1-R)}}}}}),"getApplyForce"),He=r(((Y,et,J)=>{const{X:tt,Y:ft,R:_t}=et;ut=r((it=>tt[it]),"getX"),ht=r((it=>ft[it]),"getY"),nt=r((it=>_t[it]),"getR"),ot=Ge(et),Mt=De(et,J)}),"initialize");function Je(Y,et,{masses:J,X:tt,Y:ft,fx:_t,fy:it},{charge:vt}){const Ct=et.length;let Ft,Pt,Lt,Yt,$t,Bt,Gt,qt,Kt;for(let ee=0;ee<Ct;ee++){Ft=et[ee];for(let oe=ee+1;oe<Ct;oe++)if(ee!==oe){if(Pt=et[oe],Ft===Pt)continue;Lt=tt[Ft]-tt[Pt]||f(),Yt=ft[Ft]-ft[Pt]||f(),$t=Lt*Lt+Yt*Yt,$t<1&&($t=Math.sqrt(1*$t)),Bt=vt*J[Pt],Gt=Y*Bt/$t,qt=vt*J[Ft],Kt=Y*qt/$t,_t[Ft]+=Lt*Gt,it[Ft]+=Yt*Gt,_t[Pt]-=Lt*Kt,it[Pt]-=Yt*Kt}}}is.initialize=He,r(Je,"repulsion"),Je.initialize=()=>{};var ss=(Y=>(Y[Y.verlet=0]="verlet",Y[Y.euler=1]="euler",Y))(ss||{}),ts=0,hs=typeof window>"u",Fe=typeof performance<"u"&&performance.now?performance:Date,Oe=hs?Y=>{const et=Fe.now(),J=Math.max(0,16-(et-ts)),tt=setTimeout((()=>Y(et+J)),J);return ts=et+J,tt}:window.requestAnimationFrame,Ns=hs?Y=>clearTimeout(Y):window.cancelAnimationFrame;function zs(Y,et,J){for(let tt=0;tt<Y.length;tt++){const ft=Y[tt];ft.x=et[tt],ft.y=J[tt]}}r(zs,"defaultUpdate");var $s,Ms,An,fn,un,xs,Ds,gt,k,P,D,B=r((()=>{}),"noop"),$={movementRatio:7e-8,surfaceRatio:.0025},H=r(((Y,et)=>.003*Y**2+(et+1)),"defaultMass"),X=class{constructor(Y={}){this.onUpdate=r((et=>{}),"onUpdate"),this.update=zs,this.nextTick=Oe,this.cancelTick=Ns,this.onEnd=B,this.charge=10,this.maxIterations=200,this.minMovement=.1,this.edgeLength=30,this.edgeStrength=3,this.friction=.1,this.elasticity=.9,this.margin=1,this.cx=void 0,this.cy=void 0,this.gravity=.01,this.theta=.34,this.batch=void 0,this.inertia=.9,this.integrator=0,this.multilevel=!1,this.placement="none",this.placementOffset=10,this.alignSiblings=!1,this.bucketSize=void 0,this.maxDisplacement=1e3,this.siblingsMinAngle=0,this.siblingsOffset=.15,this.steps=200,this.scaling=1,this.defaultRadius=1,this.autoStop=$,this.gpuAcceleration=!0,this.barnesHutOptimization=!0,"autoStop"in Y?Y.autoStop&&(typeof Y.autoStop=="boolean"?Y.autoStop=$:Y.autoStop={...Y.autoStop,...$}):Y.steps;for(const et in Y)Y[et]===void 0&&et!=="order"&&et!=="depth"||(this[et]=Y[et])}};r(X,"Settings");var lt=0;function dt(Y,et,J,tt){const ft=tt.X,_t=tt.Y,it=tt.R,vt=tt.masses,Ct=tt.bucketSize;lt=Y,J===null&&(J=new Z(et,{getX:An,getY:fn,bucketSize:Ct})).postOrder($s);const Ft=et.length;for(let Pt=0;Pt<Ft;Pt++)xs=et[Pt],Ds=ft[xs],gt=_t[xs],k=it[xs],P=vt[xs],D=P,J.preOrder(Ms);return J}r(dt,"repulsion");var ct=r(((Y,{charge:et,theta:J})=>{const tt=Y.fx,ft=Y.fy,_t=Y.X,it=Y.Y,vt=Y.R,Ct=Y.masses,Ft=Y.bucketSize,Pt=Y.cellSize;return Lt=>{let Yt=0,$t=0,Bt=Ds-Lt.cx||f(),Gt=gt-Lt.cy||f(),qt=Bt*Bt+Gt*Gt,Kt=k+Lt.r;const ee=Lt.data;if(ee!==null){if(ee===xs)return!1;if(Ft!==0){const oe=ee;for(let re=0;re<oe.length;re++){const C=oe[re];if(C===xs)continue;Bt=Ds-_t[C]||f(),Gt=gt-it[C]||f(),qt=Bt*Bt+Gt*Gt,Kt=k+vt[C],qt<1&&(qt=Math.sqrt(1*qt));const R=Ct[C];Yt=et*R*D,$t=lt*Yt/qt,tt[xs]+=Bt*$t/P,ft[xs]+=Gt*$t/P}}else{if(qt<1&&(qt=Math.sqrt(1*qt)),qt>(Pt/2)**2)return!0;Yt=et*Lt.mass*D,$t=lt*Yt/qt,tt[xs]+=Bt*$t/P,ft[xs]+=Gt*$t/P}}else{const oe=Kt/J;if(qt>oe*oe)return qt<1&&(qt=Math.sqrt(1*qt)),qt>(Pt/2)**2||(Yt=et*Lt.mass,Yt=et*Lt.mass*D,$t=lt*Yt/qt,tt[xs]+=Bt*$t/P,ft[xs]+=Gt*$t/P),!0}}}),"getApplyForce"),mt=r((Y=>{const et=Y.X,J=Y.Y,tt=Y.R,ft=Y.masses,_t=Y.bucketSize;return it=>{let vt,Ct,Ft=0,Pt=0,Lt=0,Yt=0;const $t=it.data;if($t!==null)if(_t!==0){const Bt=$t,Gt=ne(Bt,An,fn,un);Ft=Gt.x,Pt=Gt.y,Lt=Gt.r;for(let qt=0;qt<Bt.length;qt++)Yt+=ft[Bt[qt]]}else Ct=$t,Ft=et[Ct],Pt=J[Ct],Lt=tt[Ct],Yt=ft[Ct];else if(it.left&&it.right){const Bt=it.left.cx,Gt=it.left.cy,qt=it.right.cx,Kt=it.right.cy,ee=it.left.r,oe=it.right.r,re=qt-Bt,C=Kt-Gt,R=oe-ee,U=Math.sqrt(re*re+C*C);Ft=(Bt+qt+re/U*R)/2,Pt=(Gt+Kt+C/U*R)/2,Lt=(U+ee+oe)/2,Yt=it.left.mass+it.right.mass}else vt=it.left||it.right,Ft=vt.cx,Pt=vt.cy,Lt=vt.r,Yt=vt.mass;it.cx=Ft,it.cy=Pt,it.r=Lt,it.mass=Yt}}),"getAccumulateBodies"),yt=r(((Y,et,J)=>{const tt=Y.length,ft=et.X,_t=et.Y,it=et.R,vt=et.degrees,Ct=et.pinned,Ft=et.masses,Pt=et.nodeIds,Lt=J.scaling,Yt=J.defaultRadius,$t=J.bucketSize;et.bucketSize=$t===void 0?Math.floor(Math.log(tt)):$t;let Bt=1/0,Gt=1/0,qt=-1/0,Kt=-1/0;const ee=Math.PI*(3-Math.sqrt(5));let oe=0;for(let re=0;re<Y.length;re++){const C=Y[re];let{x:R,y:U,r:W}=C,{mass:St=1}=C;if(St=Math.max(St*H(W||Yt,vt[re]),.001),isNaN(R)||isNaN(U)){const bt=5*Math.sqrt(re),It=re*ee;R=bt*Math.cos(It),U=bt*Math.sin(It)}W=W||Yt,ft[re]=R,_t[re]=U,it[re]=W,Ct[re]=C.pinned?1:0,Ft[re]=St*Lt,Pt[re]=re,W>oe&&(oe=W),R<Bt&&(Bt=R),U<Gt&&(Gt=U),R>qt&&(qt=R),U>Kt&&(Kt=U)}if(Y.length>1&&(qt-Bt<2*oe||Kt-Gt<2*oe)){const re=(Bt+qt)/2,C=(Gt+Kt)/2;for(let R=0;R<tt;R++)if(!Ct[R]){const U=5*Math.sqrt(R),W=R*ee,St=re+U*Math.cos(W),bt=C+U*Math.sin(W);ft[R]=St,_t[R]=bt,St<Bt&&(Bt=St),bt<Gt&&(Gt=bt),St>qt&&(qt=St),bt>Kt&&(Kt=bt)}}et.updateGroups(),An=r((re=>ft[re]),"getX"),fn=r((re=>_t[re]),"getY"),un=r((re=>it[re]),"getR"),$s=mt(et),Ms=ct(et,J)}),"initialize");function Nt(Y,et,J,{maxDisplacement:tt}){const{X:ft,Y:_t,fx:it,fy:vt,pinned:Ct,layer:Ft,layers:Pt,surfaces:Lt,movements:Yt}=J;Yt.fill(0);let $t=0;const Bt=Y.length;let Gt=1/0,qt=1/0,Kt=-1/0,ee=-1/0;const oe=tt*tt;for(let R=0;R<Bt;R++){const U=Y[R],W=it[U]*=et,St=vt[U]*=et,bt=Ft[U];let It=W,Qt=St;const ie=ft[U],Ee=_t[U];if(It*It+Qt*Qt>oe){const We=Math.sqrt(It*It+Qt*Qt)/tt;Qt/=We,It/=We}Ct[U]||(ft[U]+=It,_t[U]+=Qt);const we=Math.sqrt(It*It+Qt*Qt);Ct[U]||(ie<Gt&&(Gt=ie),Ee<qt&&(qt=Ee),ie>Gt&&(Kt=ie),Ee>qt&&(ee=Ee),Yt[bt-1]+=we),$t+=bt*we}const re=Math.max(Kt-Gt,0),C=Math.max(ee-qt,0);for(let R=0;R<Pt.length;R++){const U=Pt[R],W=U.length;let St=1/0,bt=1/0,It=-1/0,Qt=-1/0,ie=0;for(let ds=0;ds<W;ds++){const ks=U[ds];if(Ct[ks])continue;const gs=ft[ks],Is=_t[ks];gs<St&&(St=gs),Is<bt&&(bt=Is),gs>It&&(It=gs),Is>Qt&&(Qt=Is),ie++}const Ee=It-St,we=Qt-bt,We=Math.max(1,Math.sqrt(Ee**2+we**2));Lt[R]=We;const us=ie===0?0:Yt[R]/ie,ms=re*C||1;Yt[R]=us>ie?us/ms:0}return J.updateGroups(),$t}function Tt(Y,et,J){At(Y,et,J),Ut(J)}function At(Y,et,{sources:J,targets:tt,degrees:ft,nodeIds:_t,edgeIds:it}){const vt={};for(let Ct=0;Ct<Y.length;Ct++)vt[Ct]=_t[Ct]=Ct;for(let Ct=0;Ct<et.length;Ct++){const{source:Ft,target:Pt}=et[Ct],Lt=vt[Ft],Yt=vt[Pt];it[Ct]=Ct,J[Ct]=Lt,tt[Ct]=Yt,ft[Lt]++,ft[Yt]++}}function Ut({nodeIds:Y,edgeIds:et,sources:J,targets:tt,degrees:ft,layer:_t,layers:it,component:vt,components:Ct,cluster:Ft,parent:Pt}){let Lt=0,Yt=1;const $t=new Uint32Array(Y.length);for(let oe=0;oe<Y.length;oe++)$t[oe]=ft[oe];const Bt=new Array(Y.length);for(let oe=0;oe<et.length;oe++){const re=et[oe],C=J[re],R=tt[re];Bt[C]=Bt[C]||[],Bt[R]=Bt[R]||[],Bt[C].push(R),Bt[R].push(C)}const Gt=new Uint8Array(Y.length),qt=new Uint8Array(Y.length);Pt.fill(-1);let Kt=0;for(let oe=0;oe<Y.length;oe++)if(Gt[oe]===0){const re=[oe];for(;re.length!==0;){const C=re.pop();if(Gt[C]===0&&Bt[C]!==void 0){const R=Bt[C];for(let U=0;U<R.length;U++)re.push(R[U])}Gt[C]=1,vt[C]=Kt}Kt++}const ee=new Array(Y.length);for(let oe=0;oe<Y.length;oe++)_t[oe]=0,ee[oe]=oe;for(;ee.length!==0;){const oe=[],re=[];for(let C=0;C<ee.length;C++)$t[ee[C]]<=Lt&&(oe.push(C),re.push(ee[C]));for(let C=0;C<re.length;C++){const R=re[C];qt[R]=Lt,_t[R]=Yt;const U=Bt[R];if(U)for(let W=0;W<U.length;W++)$t[U[W]]--}for(let C=0;C<re.length;C++){const R=re[C],U=Bt[R];if(U)for(let W=0;W<U.length;W++){const St=U[W],bt=_t[St];if(bt===void 0||bt>Yt){Pt[R]=St;break}}}oe.reverse();for(let C=0;C<oe.length;C++)ee.splice(oe[C],1);if(Yt+=1,ee.length>0){let C=1/0;for(let R=0;R<ee.length;R++){const U=$t[ee[R]];U<C&&(C=U)}C>=Lt+1&&(Lt=C,Yt=1)}}Gt.fill(0);for(let oe=0;oe<Y.length;oe++){const re=Y[oe],C=_t[re];if(Pt[re]===-1||_t[Pt[re]]===C){const R=[re];for(Gt.fill(0);R.length!==0;){const U=R.pop();if(Gt[U])continue;if(_t[U]>C){Pt[re]=U;break}const W=Bt[U];if(Gt[U]=1,W)for(let St=0;St<W.length;St++)R.push(W[St])}}}for(let oe=0;oe<Y.length;oe++){const re=Y[oe],C=vt[re];Ct[C]=Ct[C]||[],Ct[C].push(re);const R=_t[re]-1;it[R]=it[R]||[],it[R].push(re),Ft[re]=Pt[re]}}dt.initialize=yt,r(Nt,"velocityVerlet"),r(Tt,"topology"),r(At,"initTopology"),r(Ut,"decomposition");var he=class{constructor(Y,et=!0,J){this.bucketSize=0,this.cells=[];const tt=Y.nodes.length,ft=Y.edges.length;if(g(tt+ft),this.X=new Array(tt),this.Y=new Array(tt),this.R=new Array(tt),this.fx=new Float32Array(tt),this.fy=new Float32Array(tt),this.vx=new Float32Array(tt),this.vy=new Float32Array(tt),this.pinned=new Uint8Array(tt),this.masses=new Float32Array(tt),this.weights=new Float32Array(ft),this.lengths=new Float32Array(ft),this.sources=new Uint32Array(ft),this.targets=new Uint32Array(ft),this.degrees=new Uint32Array(tt),this.layer=new Uint32Array(tt),this.parent=new Int32Array(tt),this.cluster=new Int32Array(tt),this.component=new Uint32Array(tt),this.components=[],this.layers=[],this.nodeIds=new Array(tt),this.edgeIds=new Array(ft),this.groups=J&&J.groups||[],this.maxR=new Float32Array(Math.max(this.groups.length,1)),this.cellSize=0,this.cells=[],this.hasGroups=this.groups.length>0,this.hasGroups){this.nodeToGroup=new Int32Array(tt);for(let _t=0;_t<this.groups.length;_t++){const it=this.groups[_t];this.cells[_t]={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,ox:0,oy:0,cx:0,cy:0},this.maxR[_t]=0;for(let vt=0;vt<it.length;vt++){const Ct=it[vt];this.nodeToGroup[Ct]=_t,this.maxR[_t]=Math.max(this.maxR[_t],Y.nodes[Ct].r)}}}et&&Tt(Y.nodes,Y.edges,this),this.movements=new Array(this.layers.length).fill(0),this.surfaces=new Array(this.layers.length).fill(0),this.movementsPrev=new Array(this.layers.length).fill(0),this.surfacesPrev=new Array(this.layers.length).fill(0)}updateGroups(){if(!this.hasGroups)return void(this.cellSize=1/0);const Y=this.X,et=this.Y,J=this.groups,tt=this.cells,ft=this.maxR;let _t=0;J.forEach(((Ft,Pt)=>{const Lt=tt[Pt];Lt.minX=1/0,Lt.minY=1/0,Lt.maxX=-1/0,Lt.maxY=-1/0,Ft.forEach((Gt=>{const qt=Y[Gt],Kt=et[Gt];Lt.minX=Math.min(qt,Lt.minX),Lt.minY=Math.min(Kt,Lt.minY),Lt.maxX=Math.max(qt,Lt.maxX),Lt.maxY=Math.max(Kt,Lt.maxY)}));const Yt=ft[Pt];Lt.minX-=Yt,Lt.minY-=Yt,Lt.maxX+=Yt,Lt.maxY+=Yt;const $t=Math.abs(Lt.maxX-Lt.minX),Bt=Math.abs(Lt.maxY-Lt.minY);_t=Math.max(_t,$t,Bt),Lt.cx=(Lt.maxX+Lt.minX)/2,Lt.cy=(Lt.maxY+Lt.minY)/2})),_t=Math.ceil(2*_t+1),this.cellSize=_t;const it=Math.ceil(Math.sqrt(J.length)),vt=it*_t/2,Ct=_t/2;for(let Ft=0;Ft<J.length;Ft++){const Pt=J[Ft],Lt=Ft%it,Yt=Math.floor(Ft/it),$t=tt[Ft],Bt=(Lt+.5)*_t-vt,Gt=(Yt+.5)*_t-vt,qt=Bt-$t.cx,Kt=Gt-$t.cy;$t.cx=Bt,$t.cy=Gt,$t.minX=Bt-Ct,$t.minY=Gt-Ct,$t.maxX=Bt+Ct,$t.maxY=Gt+Ct;for(const ee of Pt)Y[ee]+=qt,et[ee]+=Kt}}};function xe(Y,et){return Y<et?Y*et+Math.pow(et-Y-1,2)/4:Y*et+Math.pow(Y-et-1,2)/4}function be(Y,et){return(Y+et)*(Y+et+1)/2+et}function ue({edgeIds:Y,sources:et,targets:J,pinned:tt,degrees:ft,X:_t,Y:it,R:vt},Ct=0,Ft=.5){const Pt={},Lt={};for(const Yt of Y){const $t=et[Yt],Bt=J[Yt];$t!==Bt&&(Pt[$t]=Pt[$t]||{},Pt[Bt]=Pt[Bt]||{},Pt[$t][Bt]=!0,Pt[Bt][$t]=!0)}Object.keys(Pt).forEach((Yt=>{const $t=Number(Yt),Bt=Object.keys(Pt[Number($t)]);if(Bt.length===2){const[Gt,qt]=Bt,Kt=xe(Number(Gt),Number(qt));Kt in Lt||(Lt[Kt]=[Number(qt),Number(Gt)]),tt[$t]||Lt[Kt].push($t)}})),Object.keys(Lt).forEach((Yt=>{const[$t,Bt,...Gt]=Lt[Number(Yt)];if(Gt.length<3)return;const qt=_t[$t],Kt=it[$t],ee=_t[Bt],oe=it[Bt],re=ft[$t],C=.25+.5*re/(re+ft[Bt]);let R=qt+(ee-qt)*C,U=Kt+(oe-Kt)*C,W=-(oe-Kt),St=ee-qt;const bt=Math.sqrt(Math.pow(qt-ee,2)+Math.pow(Kt-oe,2));W=-2*W/bt,St=-2*St/bt;const It=Math.acos(W/Math.sqrt(W*W+St*St));Ct>0&&(It<Ct||It>Math.PI-Ct&&It<=Math.PI?(W=2*Math.cos(Math.PI-Ct),St=2*Math.sin(Math.PI-Ct)):(It>2*Math.PI-Ct||It>=Math.PI&&It<Math.PI+Ct)&&(W=2*Math.cos(Ct),St=2*Math.sin(Ct)));let Qt=0,ie=1;Gt.sort(((ms,ds)=>vt[ds]-vt[ms]));let Ee=0,we=0;const We=Math.max(vt[Gt[0]],vt[Gt[1]])/2;Gt.length%2==1&&(Qt=1,R-=W*We,U-=St*We);const us=1+Ft;for(let ms=0;ms<Gt.length;ms++){const ds=(Qt+ms)%2,ks=Gt[ms],gs=ms>=2?vt[ks]:We,Is=(ds?Ee:we)+gs;_t[ks]=R+W*ie*Is,it[ks]=U+St*ie*Is,ds?Ee+=gs*us:we+=gs*us,ie=-ie}}))}function _e(Y){let et=0,J=0;for(const it of Y)et+=it.w*it.h,J=Math.max(J,it.w);Y.sort(((it,vt)=>vt.h-it.h));const tt=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(et/.95)),J),h:1/0}];let ft=0,_t=0;for(const it of Y)for(let vt=tt.length-1;vt>=0;vt--){const Ct=tt[vt];if(!(it.w>Ct.w||it.h>Ct.h)){if(it.x=Ct.x,it.y=Ct.y,_t=Math.max(_t,it.y+it.h),ft=Math.max(ft,it.x+it.w),it.w===Ct.w&&it.h===Ct.h){const Ft=tt.pop();vt<tt.length&&(tt[vt]=Ft)}else it.h===Ct.h?(Ct.x+=it.w,Ct.w-=it.w):it.w===Ct.w?(Ct.y+=it.h,Ct.h-=it.h):(tt.push({x:Ct.x+it.w,y:Ct.y,w:Ct.w-it.w,h:it.h}),Ct.y+=it.h,Ct.h-=it.h);break}}}function Te(Y,et=1){return _e(Y.map((J=>(J.w+=J.maxr+et,J.h+=J.maxr+et,J))).sort(((J,tt)=>J.w*J.h-tt.w*tt.h)))}r(he,"LayoutData"),r(xe,"unorderedPair"),r(be,"orderedPair"),r(ue,"alignSiblings"),r(_e,"potpack"),r(Te,"boxpack");var Ve=class{constructor(){this.ids=[],this.xmin=1/0,this.ymin=1/0,this.xmax=-1/0,this.ymax=-1/0,this.x=0,this.y=0,this.w=0,this.h=0,this.cx=0,this.cy=0,this.radius=0,this.mx=0,this.my=0,this.m=0,this.maxr=0}add(Y,et,J,tt){this.ids.push(Y),et-tt<this.xmin&&(this.xmin=et-tt),J-tt<this.ymin&&(this.ymin=J-tt),et+tt>this.xmax&&(this.xmax=et+tt),J+tt>this.ymax&&(this.ymax=J+tt),tt>this.maxr&&(this.maxr=tt),this.mx+=tt*et,this.my+=tt*J,this.m+=tt}measure(Y=0){return this.w=this.xmax-this.xmin+2*Y,this.h=this.ymax-this.ymin+2*Y,this.cx=this.mx/this.m,this.cy=this.my/this.m,this.x=this.xmin,this.y=this.ymin,this.radius=Math.sqrt(this.w*this.w+this.h*this.h)/2,this}};function Ie(Y,et=20,J,tt,ft){for(const Bt of Y){const{x:Gt,y:qt,r:Kt}=ne(Bt.ids,(ee=>J[ee]),(ee=>tt[ee]),(ee=>ft[ee]));Bt.cx=Gt,Bt.cy=qt,Bt.radius=Kt+et}const _t=Y.slice().sort(((Bt,Gt)=>Bt.radius-Gt.radius)),it=_t.map((Bt=>({x:Bt.cx,y:Bt.cy,r:Bt.radius}))),vt=_t.pop();let Ct=3*Math.PI/2,Ft=vt.radius;const Pt=2*Math.PI,{cx:Lt,cy:Yt}=vt,$t=[vt];for(;_t.length!==0;){const Bt=_t[_t.length-1],Gt=Ft+Bt.radius,qt=Lt+Math.cos(Ct)*Gt,Kt=Yt+Math.sin(Ct)*Gt;$t.some((ee=>{const oe=ee.cx-qt,re=ee.cy-Kt;return Math.sqrt(oe*oe+re*re)<ee.radius+Bt.radius}))?Ft+=1:(Bt.x=qt-Bt.w/2,Bt.y=Kt-Bt.h/2,Bt.cx=qt,Bt.cy=Kt,it[_t.length-1].x=qt,it[_t.length-1].y=Kt,$t.push(_t.pop()),Ct+=(2*Bt.radius+1)/Gt*1%Pt)}}function je(Y,et,J,tt){let ft=0;const _t=[];for(const it of tt){const vt=new Ve;for(const Ct of it)vt.add(Ct,Y[Ct],et[Ct],J[Ct]);_t.push(vt.measure()),it.length>_t[ft].ids.length&&(ft=_t.length-1)}return{boxes:_t,biggest:ft}}function Pe(Y,et,{X:J,Y:tt,R:ft,components:_t,pinned:it,degrees:vt,sources:Ct,targets:Ft,edgeIds:Pt},{update:Lt,onUpdate:Yt,placement:$t,placementOffset:Bt,alignSiblings:Gt,siblingsMinAngle:qt,siblingsOffset:Kt}){if(Gt&&(ue({X:J,Y:tt,R:ft,degrees:vt,pinned:it,sources:Ct,targets:Ft,edgeIds:Pt},qt,Kt),Lt(Y,J,tt)),$t){const{boxes:ee,biggest:oe}=je(J,tt,ft,_t);if($t==="spiral")Ie(ee,Bt,J,tt,ft);else{if($t!=="box")return;Te(ee,Bt)}const re=ee[oe].xmin-ee[oe].x,C=ee[oe].ymin-ee[oe].y;for(const R of ee){const{xmin:U,ymin:W,x:St,y:bt,ids:It}=R,Qt=U-St-re,ie=W-bt-C;for(const Ee of It)J[Ee]-=Qt,tt[Ee]-=ie}Lt(Y,J,tt),Yt()}}function Be(Y,et,{X:J,Y:tt,R:ft,degrees:_t,nodeIds:it,edgeIds:vt,layers:Ct,layer:Ft,cluster:Pt,masses:Lt,weights:Yt,sources:$t,targets:Bt},{cx:Gt,cy:qt,nextTick:Kt,cancelTick:ee,update:oe,onUpdate:re,batch:C,maxIterations:R,steps:U,minMovement:W},St,bt){const It=Ct.slice();C=C??1;let Qt,ie=0;function Ee(){ee(Qt),oe(Y,J,tt),re(),bt(ie)}r(Ee,"stop");const we={};for(let Ss=0;Ss<et.length;Ss++)we[Number(et[Ss].id)||Ss]=Ss;const We=new Map;for(let Ss=0;Ss<vt.length;Ss++){const Os=vt[Ss];We.set(be($t[Os],Bt[Os]),Os)}for(let Ss=0;Ss<Ct.length;Ss++){const Os=Ct[Ss],yn=Ss;for(let en=0;en<Os.length;en++){const Ks=Os[en],Bs=Pt[Ks];Bs!==-1&&(Lt[Bs]+=Lt[Ks])}for(let en=0;en<et.length;en++){const Ks=et[en],Bs=Number(Ks.id)||en,wn=Ks.source,Zi=Ks.target,Mn=Yt[we[Bs]];if(Ft[wn]===yn&&Ft[Zi]===yn){const Ki=Pt[wn],pr=Pt[Zi];if(Ki!==pr){const vs=We.get(be(Ki,pr));vs!==void 0&&(Yt[vs]+=Mn)}}}}it.length=0,vt.length=0;let us=1;const ms=1-Math.pow(.1,1/U/2),ds=(us-.1)/U;let ks,gs,Is=.5;function pn(){us+=(0-us)*ms;const Ss=St(us,it,vt);let Os=us<=Is||Ss<W;if(ie===0||Os){const yn=It.pop();if(yn){ks&&(gs=ks.reduce(((Ks,Bs)=>Math.max(Ks,Gt-J[Bs],qt-tt[Bs])),0)),it.push.apply(it,yn);for(let Ks=0;Ks<yn.length;Ks++){const Bs=yn[Ks],wn=Pt[Bs];if(wn!==-1){const Zi=_t[Bs]>1?2:1,Mn=ft[wn]+ft[Bs];Lt[wn]-=Lt[Bs],J[Bs]=J[wn]+Zi*Mn*(2*h()-1),tt[Bs]=tt[wn]+Zi*Mn*(2*h()-1)}else ks&&(J[Bs]=Gt+2*gs*(1-2*h()),tt[Bs]=qt+2*gs*(1-2*h()))}ks=yn;const en=it.reduce(((Ks,Bs)=>(Ks[Bs]=!0,Ks)),{});vt.length=0;for(let Ks=0;Ks<et.length;Ks++){const{source:Bs,target:wn,id:Zi}=et[Ks];en[Bs]&&en[wn]&&vt.push(we[Number(Zi)])}Os=!1,It.length===0?(us=.2,Is=.1):(us=.1+2*ds,Is=.1)}}ie%C==0&&(oe(Y,J,tt),re()),++ie>=1/0||Os?Ee():Qt=Kt(pn)}return r(pn,"simulationStep"),{done:!1,start(){return Qt=setTimeout(pn),this},stop(){return Ee(),this},get iterations(){return ie}}}r(Ve,"Component"),r(Ie,"spiralpack"),r(je,"groupAndMeasure"),r(Pe,"postprocessing"),r(Be,"multiLevel");var Ue,es=class{constructor(Y){this.promise=new Promise(Y)}then(Y){return this.promise.then(Y)}stop(){return this.simulation.stop(),this}get iterations(){return this.simulation.iterations()}};function os(Y,et,{X:J,Y:tt,nodeIds:ft,edgeIds:_t,layers:it,movements:vt,movementsPrev:Ct,surfaces:Ft,surfacesPrev:Pt},Lt,Yt,$t){const{nextTick:Bt,cancelTick:Gt,steps:qt,minMovement:Kt,update:ee,onUpdate:oe,autoStop:re}=Lt,C=Lt.batch??1;let R=0,U=1,W,St=1-Math.pow(.05,1/qt),bt=!1;const It=r((()=>{bt=!0,Gt(W),oe(),$t(R)}),"stop");let Qt=!1;const ie=r((()=>{U+=(.001-U)*St;const Ee=Yt(U,ft,_t),we=it.length;let We=!1,us=!1;if(re){We=us=!0;const{movementRatio:ds,surfaceRatio:ks}=re;for(let gs=0;gs<we;gs++)We&&Math.abs(1-Ft[gs]/Pt[gs])>ks&&(We=!1),us&&Math.abs(vt[gs]-Ct[gs])>ds&&(us=!1)}We&&us&&!Qt&&(St=1-Math.pow(.001,1/Math.max(10,R)),Qt=!0);const ms=bt||U<.05||Ee!==0&&Ee<=Kt;if(R%C==0&&(ee(Y,J,tt),oe()),++R>=qt||ms)return It();for(let ds=0;ds<we;ds++)Ct[ds]=vt[ds],Pt[ds]=Ft[ds];W=Bt(ie)}),"simulationStep");return{done:!1,start(){return W=setTimeout(ie),this},stop(){return It(),this},get iterations(){return R}}}function cs(Y,et={}){let J,tt;const ft=r(((Yt={nodes:[],edges:[]})=>(J=Yt.nodes,tt=Yt.edges,g(be(J.length,tt.length)),new he(Yt,!0,et))),"setGraph"),_t=r(((Yt={})=>new X(Yt)),"setOptions");let it=ft(Y),vt=_t(et);y(tt,it),yt(J,it,vt),He(J,it,vt),x(J,it,vt);const Ct=Nt;let Ft=null;const Pt=r(((Yt,$t,Bt)=>(Ft&&(Ft.destroy(),Ft=null),$t.length<=1?0:(vt.barnesHutOptimization?Ft=dt(Yt,$t,Ft,it):Je(Yt,$t,it,vt),p(Yt,Bt,it,vt),Ft&&vt.elasticity!==0&&is(0,$t,Ft,it,vt),_(Yt,$t,it,vt),Ct($t,vt.inertia,it,vt)))),"step");let Lt;return{setOptions:(Yt={})=>(vt=_t(Yt),this),setGraph:({nodes:Yt,edges:$t})=>(it=ft(Y),y($t,it),yt(Yt,it,vt),He(Yt,it,vt),x(Yt,it,vt),this),start(){return Lt=(vt.multilevel?Be:os)(J,tt,it,vt,Pt,(Yt=>{Lt.done||Pe(J,0,it,vt),vt.onEnd(Yt);const $t=et.groups;if($t)for(let Bt=0;Bt<$t.length;Bt++){const Gt=$t[Bt],qt=Gt.reduce(((Kt,ee)=>(Kt.x+=it.X[ee],Kt.y+=it.Y[ee],Kt)),{x:0,y:0});qt.x/=Gt.length,qt.y/=Gt.length,et.cx&&(qt.x-=et.cx),et.cy&&(qt.y-=et.cy);for(let Kt=0;Kt<Gt.length;Kt++)it.X[Gt[Kt]]-=qt.x,it.Y[Gt[Kt]]-=qt.y}Lt.done=!0})).start(),this},iterations:()=>Lt.iterations,data:()=>it,stop(){return Lt&&Lt.stop(),this},step(Yt=1){return Pt(Yt,it.nodeIds,it.edgeIds),vt.update(J,it.X,it.Y),this}}}return r(es,"SimulationPromise"),r(os,"singleLevel"),r(cs,"force"),cs.run=(Y,et)=>{let J;const tt=new es((ft=>{et.onEnd=ft,J=cs(Y,et).start()}));return tt.simulation=J,tt.stop=()=>(J.stop(),tt),tt},Ue=o,((Y,et,J,tt)=>{if(et&&typeof et=="object"||typeof et=="function")for(let ft of n(et))i.call(Y,ft)||ft===J||e(Y,ft,{get:()=>et[ft],enumerable:!(tt=s(et,ft))||tt.enumerable});return Y})(e({},"__esModule",{value:!0}),Ue)})();return t.force.apply(this,arguments)}Se(D1,"SimulationPromise"),Se(Xg,"gpuLayout"),Xg.run=(t,e,s)=>{let n;const i=new D1((r=>{s.onEnd=r,n=Xg(t,e,s).start()}));return i.simulation=n,i.stop=()=>(n.stop(),i),i};var a$=2,l$=1.25,B1=t=>{},U1={name:"force",imports:{force:O1},configure(t,{graph:e,events:s}){const n=t.nodes._indexes,i=t.xs?t.xs:e.getNodeAttribute("x").getMultiple(n),r=t.ys?t.ys:e.getNodeAttribute("y").getMultiple(n),o=t.rs?t.rs:e.getNodeAttribute("radius").getMultiple(n),a=e.getNodeAttribute("layoutable").getMultiple(n),l=t.edges,u=[],h=[],g={},f=t.edgeWeight||B1,p=t.nodeMass?x=>t.nodeMass(t.nodes.get(x)):B1;t.edgeStrength===void 0&&(t.edgeStrength=.5),t.gpu&&(t.edgeStrength/=a$),t.gravity==null&&(t.gravity=.01),t.siblingsOffset==null&&(t.siblingsOffset=0),t.theta==null&&(t.theta=.62),t.autoStop=!!t.autoStop,t.alignSiblings=!!t.alignSiblings;const y=t.radiusRatio||l$;for(let x=0;x<t.nodes._indexes.length;x++){const v=t.nodes._indexes[x];g[v]=x,u.push({id:x,x:i[x],y:r[x],r:o[x]*y,mass:p(x),pinned:!a[x]})}l.forEach((x=>{const v=g[x.getSource()._index],b=g[x.getTarget()._index];v!==b&&v!==void 0&&b!==void 0&&h.push({source:v,target:b,weight:f(x)})}));const _=Gf({...t});return delete _.nodes,delete _.edges,{graph:{nodes:u,edges:h},options:_,indexes:t.nodes._indexes,done:!1,x:i,y:r,chunkPeriod:250}},update:function(t,e){if(!e.simulation&&t){let s;e.done=!1,e.graph=t.graph,e.options=t.options,e.indexes=t.indexes;let n=!1;if(t.options.gpu){const l=bC("webgl2",{},(()=>{$o("GPU layout: WebGL context not available. Falling back on CPU."),e.simulation=void 0,e.options.gpu=!1,e.cleanUp&&e.cleanUp(),this._update(t,e)}));l&&(s=l.context,e.cleanUp=l.cleanUp),n=!!s}let i=Date.now();n||(t.options.nextTick=l=>Date.now()-i<=e.chunkPeriod?l():(i=Date.now(),setTimeout(l,0))),t.options.update=(l,u,h)=>{e.x=u,e.y=h},t.options.onEnd=()=>{if(n&&s){const{X:l,Y:u}=e.simulation.data(!0);e.x=l,e.y=u}e.done=!0,e.simulation=void 0,e.cleanUp&&e.cleanUp()},t.options.bucketSize=0;const r=n&&s?Xg(t.graph,s,t.options).start():O1(t.graph,t.options).start();e.simulation=r;const{X:o,Y:a}=n&&s?{X:new Float32Array(t.graph.nodes.length),Y:new Float32Array(t.graph.nodes.length)}:r.data();e.x=o,e.y=a}return{graph:e.graph,indexes:e.indexes,x:e.x,y:e.y}},context:function(){return{done:!1,graph:{nodes:[],edges:[]},x:null,y:null,indexes:null,chunkPeriod:250}},stop:function(t){t.done=!0,t.simulation&&(t.simulation.stop(),delete t.simulation)},isRunning:function(t){return!t.done||(t.done=!1,!1)},onSync:function({indexes:t,x:e,y:s}){return{indexes:t,x:e,y:s}}};function u$(t,e,s,n,i){return{x:t+i*(s-t),y:e+i*(n-e)}}var d$=10;function h$(t,e,s){let n,i,r=1/0;for(let o=0,a=e.length;o<a;o++){const l=e[o],u=e[(o+1)%a],h=m0(t[0],t[1],l[0],l[1],u[0],u[1]);h<r&&(r=h,n=l,i=u)}return c$(t[0],t[1],n[0],n[1],i[0],i[1],s)}function c$(t,e,s,n,i,r,o){const a=FC(t,e,s,n,i,r);let l=-(n-r),u=s-i;const h=Math.sqrt(l*l+u*u);return l/=h,u/=h,[a.x-o*l,a.y-o*u]}function g$(t,e,s,n){for(let i=0;i<t.length;i++){const[r,o]=t[i],a=Math.abs(r-e),l=Math.abs(o-s);if(a+l<=n||!(a>n||l>n)&&a*a+l*l<=n*n)return!0}return!1}function f$(t,e,s){const n=IC(s.cx,s.cy,t,e,s.minX,s.minY,s.maxX,s.maxY);let i,r=1/0,o={x:s.maxX,y:e};for(const a of n)i=_n(t,e,a.x,a.y),i<r&&(r=i,o=a);return o}function p$(t){const e=t.bottomLeft(),s=t.topRight();return[[e.x,e.y],[e.x,s.y],[s.x,s.y],[s.x,e.y]]}function m$(t,e,s,n){const i=[],r=[],o=[];return t.forEach(((a,l)=>{n[l]&&(i.push(a),r.push(e[l]),o.push(s[l]))})),{ids:i,subgraphPositions:r,radii:o}}function _$(t,e,s){const{duration:n=0,margin:i=5,referenceNodes:r,nodes:o}=e,{ids:a,subgraphPositions:l,radii:u}=m$(o.getId(),s,o.getAttribute("radius"),o.getAttribute("layoutable")),h=t.getNodes(a);let g=r;!g||g instanceof uo||(g=t.getNodes(g));const f=g||h.inverse(),p=f.getPosition().map((F=>[F.x,F.y])),y=h.getBoundingBox(),_=f.getBoundingBox();_.pad(_.maxScaledSize);const x={layoutName:"incremental",ids:h.getId(),positions:{before:l,current:l}};if(!h.size)return Promise.resolve(x);const v=wh(l.map((F=>F.x)),l.map((F=>F.y)),u),[b,S]=v,A=v[2]+_.maxScaledSize+i;let w,L=0,M=0;if(g$(p,b,S,A))if(f.size<=3){if(Zx(b,S,v[2],_.minX,_.minY,_.maxX,_.maxY)){const F=f$(b,S,_);w=_n(_.cx,_.cy,F.x,F.y);const O=u$(_.cx,_.cy,F.x,F.y,(w+A)/w);L=O.x-b,M=O.y-S}}else{const F=qx.from(p,(at=>at[0]),(at=>at[1])),O=Xd(F.triangles,p),G=p.length>3?Xd(F.hull,p):p$(_),j=S2(f.getPosition(),d$,A,O,G);let Z=h$([b,S],G,A);if(j.length>0){let at=Math.pow(b-Z[0],2)+Math.pow(S-Z[1],2);for(const pt of j)L=b-pt[0],M=S-pt[1],w=L*L+M*M,w<at&&(at=w,Z=pt.slice(0,2));L=Z[0]-b,M=Z[1]-S}else L=Z[0]-y.cx,M=Z[1]-y.cy}if(L||M){const F=l.map((O=>(O.x+=L,O.y+=M,O)));if(e.locate){typeof e.locate=="boolean"&&(e.locate={});const O=t.modules.locate.layoutDataBoundingBox({x:[...p.map((j=>j[0])),...F.map((j=>j.x))],y:[...p.map((j=>j[1])),...F.map((j=>j.y))],indexes:t.getNodes()._indexes}),G=t.modules.locate.computeConfigForBounds(O,e.locate);t.modules.camera.setView(G,{duration:n,easing:e.locate.easing,ignoreZoomLimits:!0})}return x.positions.current=F,h.setAttributes(F,n).then((()=>x))}return h.setAttributes(l,n).then((()=>x))}function y$(t,e,s){const n=Zs(e);return n.duration=0,n.dryRun=!0,n.locate=!1,delete n.incremental,s(n).then((i=>_$(t,e,i.positions.current)))}function x$(t,e,s){const{nodes:n,duration:i,centralNode:r}=e,o=n,a=o.reduce(((u,h)=>(u[h._index]=!0,u)),{}),l=t.getNodes();if(e.focusOnGroupShape)return s({nodes:o,duration:0}).then((()=>{const u=o.concat(r),h=u.getAttribute("layoutable");return u.setAttributes({layoutable:!1}),s({nodes:t.getNodes(),duration:i}).then((()=>u.setAttributes(h)))}));{const u=Zs(e);return delete u.centralNode,u.incremental=!1,u.nodes=l,u.nodeMass=(h,g)=>(g+1)*(a[h._index]?1:2),s(u)}}function RM(t,e,s){const n=XN(e.modules.graph,t);if(typeof n.incremental!="boolean"&&"margin"in n.incremental&&!isFinite(n.incremental.margin))throw new Error("Incremental layout: margin has to be a positive number");const i=Zs(n);return typeof n.incremental!="boolean"&&(i.margin=n.incremental.margin,i.referenceNodes=n.incremental.referenceNodes),i.centralNode&&!i.centralNode.getAttribute("layoutable")?x$(e,i,s):y$(e,i,s)}var v$=t=>(t.modules.layouts.register(U1),(e={})=>{if(e.incremental)return RM(e,t,t.layouts.force);if(e.edgeStrength!==void 0&&(!isFinite(e.edgeStrength)||e.edgeStrength<0))throw new Error("force layout: edgeStrength must be a positive number");if(e.steps!==void 0&&(!isFinite(e.steps)||e.steps<=0))throw new Error("force layout: 'steps' must be a positive integer");if(e.edgeLength!==void 0&&(!isFinite(e.edgeLength)||e.edgeLength<=0))throw new Error("force layout: 'edgeLength' must be positive");if(e.gravity!==void 0&&(!isFinite(e.gravity)||e.gravity<0||e.gravity>=1))throw new Error("force layout: 'gravity' must be between 0 and 1");if(e.charge!==void 0&&!isFinite(e.charge))throw new Error("force layout: 'charge' must be a number");if(e.radiusRatio!==void 0&&(!isFinite(e.radiusRatio)||e.radiusRatio<0))throw new Error("force layout: 'radiusRatio' must be a positive number");if(e.theta!==void 0&&(!isFinite(e.theta)||e.theta<0||e.theta>1))throw new Error("force layout: 'theta' must be between 0 and 1");if(!(e.cx===void 0&&e.cy===void 0||typeof e.cx=="number"&&typeof e.cy=="number"))throw new Error("force layout: both 'cx' and 'cy' must be numbers");if(e.siblingsOffset!==void 0&&!isFinite(e.siblingsOffset))throw new Error("force layout: 'siblingsOffset' must be a number");return e.gpu=!!e.gpu,e.gpu&&(e.useWebWorker=!1),t.modules.layouts.start(U1.name,e)}),G1={name:"forceLink",configure:function(t,{graph:e,camera:s,graphics:n}){const i=t.nodes._indexes,r=t.edges._indexes,o={},a={},l=i.length,u=r.length;let h;var g=e.getObjectList(!0),f=e.getObjectList(!1);(t.nodes||t.edges)&&(delete(t=Zs(t)).nodes,delete t.edges);const p=e.getNodeAttribute("innerStroke.width").getMultiple(i),y=e.getNodeAttribute("outerStroke.width").getMultiple(i),_=e.degrees(i),x=t.xs?t.xs:e.getNodeAttribute("x").getMultiple(i),v=t.ys?t.ys:e.getNodeAttribute("y").getMultiple(i),b=t.rs?t.rs:e.getNodeAttribute("radius").getMultiple(i),S=e.nodeList(i).getAttribute("layoutable"),A=typeof t.nodeMass=="function"?t.nodeMass:function(K,ut,ht){return ut+1};delete t.nodeMass;const w=typeof t.edgeWeight=="function"?t.edgeWeight:function(K){return 1};delete t.edgeWeight,isFinite(t.scalingRatio)||delete t.scalingRatio;const L=i.reduce(((K,ut,ht)=>(S[ht]||(K[ut]=!0),K)),{});let M=0,F=0,O=0;const G=s.getZoom();for(h=0;h<i.length;++h){const K=i[h],ut=x[h],ht=v[h],nt=b[h]+(p[h]+y[h])/G;o[K]={id:K,x:ut,y:ht,degree:_[h],size:nt,pinned:!!L[K],mass:A(g.get(K),_[h],h)},O=Math.max(nt,O)}if(l>1)for(h=0;h<l;h++){const K=o[i[h]];M+=K.x,F+=K.y}M/=l,F/=l;const j={x:M,y:F},Z=e.edgeList(r),at=Z.getSource()._indexes,pt=Z.getTarget()._indexes;for(h=0;h<u;h++){const K=r[h],ut=at[h],ht=pt[h];o[ut]&&o[ht]&&(a[K]={source:ut,target:ht},a[K].weight=w(f.get(K)))}return{nodes:o,edges:a,maxSize:O,config:Gf(t),barycentre:j}},context:function(){return{chunkPeriod:250}},update:function(t,e){let s;!e.W&&t?(s={ppn:10,ppe:3,ppr:9,MAX_SUBDIVISION_RETRIES:3,maxForce:10,iterations:0,converged:!1,settings:{linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:0,scalingRatio:100,strongGravityMode:!0,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5,startingIterations:10,iterationsPerRender:10,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:!0,alignNodeSiblings:!0,nodeSiblingsScale:5,nodeSiblingsAngleMin:0}},e.W=s,(function(u,h){const g=(function(p,y){let _,x,v,b=p.nodes,S=p.edges,A=p.maxSize,w=Object.keys(p.nodes),L=Object.keys(p.edges),M=w.length*s.ppn,F=L.length*s.ppe,O={};const G=Math.pow(10,Math.log(Math.max(A,1))-6),j=G/2,Z=Math.random,at=y.randomizeFactor||1;let pt;pt=y.randomize==="locally"?ht=>ht+Z()*at:y.randomize==="globally"?ht=>Z()*at:ht=>ht+Z()*G-j;const K=new Float32Array(M),ut=new Float32Array(F);for(_=x=0,v=w.length;_<v;_++){const ht=w[_],nt=b[ht];let ot=nt.x,Mt=nt.y;nt.pinned||(ot=pt(ot),Mt=pt(Mt)),O[ht]=x,K[x]=ot,K[x+1]=Mt,K[x+2]=0,K[x+3]=0,K[x+4]=0,K[x+5]=0,K[x+6]=nt.mass,K[x+7]=1,K[x+8]=nt.size,K[x+9]=nt.pinned||0,x+=s.ppn}for(_=x=0,v=L.length;_<v;_++){const ht=S[L[_]];ut[x]=O[ht.source],ut[x+1]=O[ht.target],ut[x+2]=ht.weight||0,x+=s.ppe}return{nodes:K,edges:ut}})(u,h);e.NodeMatrix=g.nodes,e.EdgeMatrix=g.edges,s.nodesLength=e.NodeMatrix.length,s.edgesLength=e.EdgeMatrix.length})(t,t.config),s.settings=(function(u,h){for(const g in u)h[g]=u[g];return h})(t.config,s.settings),e.nodes=t.nodes,e.edges=t.edges,e.barycentre=t.barycentre):s=e.W;let n,i=e.NodeMatrix,r=e.EdgeMatrix;function o(){let l,u,h,g,f,p,y,_,x,v,b,S,A,w,L,M,F;for(h=0;h<s.nodesLength;h+=s.ppn)i[h+4]=i[h+2],i[h+5]=i[h+3],i[h+2]=0,i[h+3]=0;if(s.settings.outboundAttractionDistribution){for(x=0,h=0;h<s.nodesLength;h+=s.ppn)x+=i[h+6];x/=s.nodesLength}if(s.settings.barnesHutOptimize){let pt,K,ut,ht,nt=1/0,ot=-1/0,Mt=1/0,Q=-1/0;for(n=[],h=0;h<s.nodesLength;h+=s.ppn)nt=Math.min(nt,i[h+0]),ot=Math.max(ot,i[h+0]),Mt=Math.min(Mt,i[h+1]),Q=Math.max(Q,i[h+1]);const Et=ot-nt,Xt=Q-Mt;for(Et>Xt?(Mt-=(Et-Xt)/2,Q=Mt+Et):(nt-=(Xt-Et)/2,ot=nt+Xt),n[0]=-1,n[1]=(nt+ot)/2,n[2]=(Mt+Q)/2,n[3]=Math.max(ot-nt,Q-Mt),n[4]=-1,n[5]=-1,n[6]=0,n[7]=0,n[8]=0,l=1,h=0;h<s.nodesLength;h+=s.ppn)for(u=0,ut=s.MAX_SUBDIVISION_RETRIES;;){if(!(n[u+5]>=0)){if(n[u+0]<0){n[u+0]=h;break}if(n[u+5]=l*s.ppr,y=n[u+3]/2,_=n[u+5],n[_+0]=-1,n[_+1]=n[u+1]-y,n[_+2]=n[u+2]-y,n[_+3]=y,n[_+4]=_+s.ppr,n[_+5]=-1,n[_+6]=0,n[_+7]=0,n[_+8]=0,_+=s.ppr,n[_+0]=-1,n[_+1]=n[u+1]-y,n[_+2]=n[u+2]+y,n[_+3]=y,n[_+4]=_+s.ppr,n[_+5]=-1,n[_+6]=0,n[_+7]=0,n[_+8]=0,_+=s.ppr,n[_+0]=-1,n[_+1]=n[u+1]+y,n[_+2]=n[u+2]-y,n[_+3]=y,n[_+4]=_+s.ppr,n[_+5]=-1,n[_+6]=0,n[_+7]=0,n[_+8]=0,_+=s.ppr,n[_+0]=-1,n[_+1]=n[u+1]+y,n[_+2]=n[u+2]+y,n[_+3]=y,n[_+4]=n[u+4],n[_+5]=-1,n[_+6]=0,n[_+7]=0,n[_+8]=0,l+=4,ht=u+0,pt=i[n[ht]+0]<n[u+1]?i[n[ht]+1]<n[u+2]?n[u+5]:n[u+5]+s.ppr:i[n[ht]+1]<n[u+2]?n[u+5]+2*s.ppr:n[u+5]+3*s.ppr,n[u+6]=i[n[ht]+6],n[u+7]=i[n[ht]+0],n[u+8]=i[n[ht]+1],n[pt+0]=n[u+0],n[u+0]=-1,K=i[h+0]<n[u+1]?i[h+1]<n[u+2]?n[u+5]:n[u+5]+s.ppr:i[h+1]<n[u+2]?n[u+5]+2*s.ppr:n[u+5]+3*s.ppr,pt===K){if(ut--){u=pt;continue}ut=s.MAX_SUBDIVISION_RETRIES;break}n[K+0]=h;break}pt=i[h+0]<n[u+1]?i[h+1]<n[u+2]?n[u+5]:n[u+5]+s.ppr:i[h+1]<n[u+2]?n[u+5]+2*s.ppr:n[u+5]+3*s.ppr,n[u+7]=(n[u+7]*n[u+6]+i[h+0]*i[h+6])/(n[u+6]+i[h+6]),n[u+8]=(n[u+8]*n[u+6]+i[h+1]*i[h+6])/(n[u+6]+i[h+6]),n[u+6]+=i[h+6],u=pt}}if(s.settings.barnesHutOptimize)for(v=s.settings.scalingRatio,h=0;h<s.nodesLength;h+=s.ppn)for(u=0;;)if(n[u+5]>=0){if(M=Math.sqrt((i[h+0]-n[u+7])*(i[h+0]-n[u+7])+(i[h+1]-n[u+8])*(i[h+1]-n[u+8])),2*n[u+3]/M<s.settings.barnesHutTheta){if(b=i[h+0]-n[u+7],S=i[h+1]-n[u+8],s.settings.adjustSizes?M>0?(F=v*i[h+6]*n[u+6]/M/M,i[h+2]+=b*F,i[h+3]+=S*F):M<0&&(F=-v*i[h+6]*n[u+6]/M,i[h+2]+=b*F,i[h+3]+=S*F):M>0&&(F=v*i[h+6]*n[u+6]/M/M,i[h+2]+=b*F,i[h+3]+=S*F),n[u+4]<0)break;u=n[u+4];continue}u=n[u+5]}else{if(n[u+0]>=0&&n[u+0]!==h&&(b=i[h+0]-i[n[u+0]+0],S=i[h+1]-i[n[u+0]+1],M=Math.sqrt(b*b+S*S),s.settings.adjustSizes?M>0?(F=v*i[h+6]*i[n[u+0]+6]/M/M,i[h+2]+=b*F,i[h+3]+=S*F):M<0&&(F=-v*i[h+6]*i[n[u+0]+6]/M,i[h+2]+=b*F,i[h+3]+=S*F):M>0&&(F=v*i[h+6]*i[n[u+0]+6]/M/M,i[h+2]+=b*F,i[h+3]+=S*F)),n[u+4]<0)break;u=n[u+4]}else for(v=s.settings.scalingRatio,g=0;g<s.nodesLength;g+=s.ppn)for(f=0;f<g;f+=s.ppn)b=i[g+0]-i[f+0],S=i[g+1]-i[f+1],s.settings.adjustSizes?(M=Math.sqrt(b*b+S*S)-i[g+8]-i[f+8],M>0?(F=v*i[g+6]*i[f+6]/M/M,i[g+2]+=b*F,i[g+3]+=S*F,i[f+2]+=b*F,i[f+3]+=S*F):M<0&&(F=100*v*i[g+6]*i[f+6],i[g+2]+=b*F,i[g+3]+=S*F,i[f+2]-=b*F,i[f+3]-=S*F)):(M=Math.sqrt(b*b+S*S),M>0&&(F=v*i[g+6]*i[f+6]/M/M,i[g+2]+=b*F,i[g+3]+=S*F,i[f+2]-=b*F,i[f+3]-=S*F));for(_=s.settings.gravity/s.settings.scalingRatio,v=s.settings.scalingRatio,h=0;h<s.nodesLength;h+=s.ppn)F=0,b=i[h+0],S=i[h+1],M=Math.sqrt(b*b+S*S),s.settings.strongGravityMode?M>0&&(F=v*i[h+6]*_):M>0&&(F=v*i[h+6]*_/M),i[h+2]-=b*F,i[h+3]-=S*F;for(v=1*(s.settings.outboundAttractionDistribution?x:1),p=0;p<s.edgesLength;p+=s.ppe)g=r[p+0],f=r[p+1],y=r[p+2],L=Math.pow(y,s.settings.edgeWeightInfluence),b=i[g+0]-i[f+0],S=i[g+1]-i[f+1],s.settings.adjustSizes?(M=Math.sqrt(b*b+S*S)-i[g+8]-i[f+8],s.settings.linLogMode?s.settings.outboundAttractionDistribution?M>0&&(F=-v*L*Math.log(1+M)/M/i[g+6]):M>0&&(F=-v*L*Math.log(1+M)/M):s.settings.outboundAttractionDistribution?M>0&&(F=-v*L/i[g+6]):M>0&&(F=-v*L)):(M=Math.sqrt(b*b+S*S),s.settings.linLogMode?s.settings.outboundAttractionDistribution?M>0&&(F=-v*L*Math.log(1+M)/M/i[g+6]):M>0&&(F=-v*L*Math.log(1+M)/M):s.settings.outboundAttractionDistribution?(M=1,F=-v*L/i[g+6]):(M=1,F=-v*L)),M>0&&(i[g+2]+=b*F,i[g+3]+=S*F,i[f+2]-=b*F,i[f+3]-=S*F);let O,G,j,Z,at=0;if(s.settings.adjustSizes)for(h=0;h<s.nodesLength;h+=s.ppn)i[h+9]||(O=Math.sqrt(i[h+2]*i[h+2]+i[h+3]*i[h+3]),O>s.maxForce&&(i[h+2]=i[h+2]*s.maxForce/O,i[h+3]=i[h+3]*s.maxForce/O),G=i[h+6]*Math.sqrt((i[h+4]-i[h+2])*(i[h+4]-i[h+2])+(i[h+5]-i[h+3])*(i[h+5]-i[h+3])),j=Math.sqrt((i[h+4]+i[h+2])*(i[h+4]+i[h+2])+(i[h+5]+i[h+3])*(i[h+5]+i[h+3]))/2,Z=.1*Math.log(1+j)/(1+Math.sqrt(G)),A=i[h+0],w=i[h+1],i[h+0]=i[h+0]+i[h+2]*(Z/s.settings.slowDown),i[h+1]=i[h+1]+i[h+3]*(Z/s.settings.slowDown),b=i[h+0],S=i[h+1],M=Math.sqrt((b-A)*(b-A)+(S-w)*(S-w)),at+=M);else for(h=0;h<s.nodesLength;h+=s.ppn)i[h+9]||(G=i[h+6]*Math.sqrt((i[h+4]-i[h+2])*(i[h+4]-i[h+2])+(i[h+5]-i[h+3])*(i[h+5]-i[h+3])),j=Math.sqrt((i[h+4]+i[h+2])*(i[h+4]+i[h+2])+(i[h+5]+i[h+3])*(i[h+5]+i[h+3]))/2,Z=i[h+7]*Math.log(1+j)/(1+Math.sqrt(G)),i[h+7]=Math.min(1,Math.sqrt(Z*(i[h+2]*i[h+2]+i[h+3]*i[h+3])/(1+Math.sqrt(G)))),A=i[h+0],w=i[h+1],i[h+0]=i[h+0]+i[h+2]*(Z/s.settings.slowDown),i[h+1]=i[h+1]+i[h+3]*(Z/s.settings.slowDown),b=i[h+0],S=i[h+1],M=Math.sqrt((b-A)*(b-A)+(S-w)*(S-w)),at+=M);if(s.iterations++,s.settings.autoStop&&(s.converged=s.iterations>s.settings.maxIterations||at/s.nodesLength<s.settings.avgDistanceThreshold,s.converged&&s.settings.alignNodeSiblings)){let pt,K,ut={},ht={};for(p=0;p<s.edgesLength;p+=s.ppe)g=r[p+0],f=r[p+1],g!==f&&(ut[g]=ut[g]||{},ut[f]=ut[f]||{},ut[g][f]=!0,ut[f][g]=!0);Object.keys(ut).forEach((Me=>{var ge=~~Me;K=Object.keys(ut[ge]),K.length==2&&(pt=K[0]+";"+K[1],pt in ht||(pt=K[1]+";"+K[0],ht[pt]||(ht[pt]=[~~K[1],~~K[0]])),ht[pt].push(ge))}));let nt,ot,Mt,Q,Et,Xt,Ht,Zt,ae,pe,ne,te,se,ce,Ce,ve=s.settings.nodeSiblingsAngleMin;Object.keys(ht).forEach((Me=>{if(ot=ht[Me].shift(),Mt=ht[Me].shift(),nt=ht[Me].filter((Ge=>!i[Ge+9])),nt.length==1)return;if(Xt=i[ot+0],Ht=i[ot+1],Zt=i[Mt+0],ae=i[Mt+1],Q=Object.keys(ut[ot]).length,Et=Object.keys(ut[Mt]).length,pe=(function(De,He,Je,ss,ts){return(ts-ss)*(De-He)/(Je-He)+ss})(Q/(Q+Et),0,1,1/4,3/4),te=(function(De,He,Je,ss,ts){return{x:De+(Je-De)*ts,y:He+(ss-He)*ts}})(Xt,Ht,Zt,ae,pe),se=(function(De,He,Je,ss){return{xi:-(ss-He),yi:Je-De,xiPrime:ss-He,yiPrime:-(Je-De)}})(Xt,Ht,Zt,ae),ne=(function(De,He,Je,ss){const ts=Je-De,hs=ss-He;return Math.sqrt(ts*ts+hs*hs)})(Xt,Ht,Zt,ae),ce=(function(De,He){return{x:(De.xiPrime-De.xi)/He,y:(De.yiPrime-De.yi)/He}})(se,ne),Ce=(function(De){return Math.acos(De.x/Math.sqrt(De.x*De.x+De.y*De.y))})(ce),2*ve>Math.PI)throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.");ve>0&&(Ce<ve||Ce>Math.PI-ve&&Ce<=Math.PI?ce={x:2*Math.cos(Math.PI-ve),y:2*Math.sin(Math.PI-ve)}:(Ce>2*Math.PI-ve||Ce>=Math.PI&&Ce<Math.PI+ve)&&(ce={x:2*Math.cos(ve),y:2*Math.sin(ve)}));let ge=0,ze=1,is=1;nt.length%2==1&&(is=0,ge=1);for(let Ge=0;Ge<nt.length;Ge++)i[nt[Ge]+0]=te.x+ze*ce.x*is*(ge||Ge>=2?s.settings.nodeSiblingsScale:2*s.settings.nodeSiblingsScale/3),i[nt[Ge]+1]=te.y+ze*ce.y*is*(ge||Ge>=2?s.settings.nodeSiblingsScale:2*s.settings.nodeSiblingsScale/3),ze=-ze,is+=(Ge+ge)%2}))}}function a(l){const u=Object.keys(l),h={};for(let g=0;g<i.length;g+=s.ppn){const f=u[g/s.ppn];h[f]={id:f,x:i[g+0],y:i[g+1],pinned:i[g+9]}}return h}return(function(){if(s.settings.autoStop){const u=Date.now();for(;!(s.converged||Date.now()-u>=e.chunkPeriod);)o()}else{const u=s.iterations===0?s.settings.startingIterations:s.iterations+s.settings.iterationsPerRender;for(;s.iterations!==u;)o()}return{nodes:a(e.nodes),barycentre:e.barycentre}})()},isRunning:function(t){return!t.W.settings.autoStop||!t.W.converged||(t.W=void 0,!1)},stop:function(t){t.W&&(t.W.converged=!0)},onSync:function({nodes:t,barycentre:e},{graph:s}){const n=Object.keys(t),i=n.length;let r,o,a,l,u,h,g,f,p=0,y=0;const _=new Array(i),x=new Array(i),v=new Array(i),b=new Array(i),[S,A]=s.getAttributes(!0,["x","y"]);for(r=0;r<i;r++)o=n[r],a=t[o],f=parseInt(o),_[r]=f,b[r]=a.pinned,a.pinned?(l=S.get(f),u=A.get(f)):(l=a.x,u=a.y),x[r]=l,v[r]=u,p+=l,y+=u;for(h=p/i-e.x,g=y/i-e.y,r=0;r<i;r++)b[r]||(x[r]-=h,v[r]-=g);return{indexes:_,x,y:v}}},b$=t=>(t.modules.layouts.register(G1),(e={})=>e.incremental?RM(e,t,t.layouts.forceLink):t.modules.layouts.start(G1.name,e)),V1={name:"grid",configure:function(t,{graph:e,camera:s}){function n(w){return w===void 0||typeof w=="number"&&isFinite(w)&&w>0}const i=t.sortBy,r=t,o=r.nodes,a=Array.from(o._indexes),l=a.length,{rows:u,cols:h,rowDistance:g,colDistance:f}=(function(L,M,F,O,G){if(!n(M))throw new TypeError('"rows" should be a positive integer');if(!n(F))throw new TypeError('"cols" should be a positive integer');if(!n(O))throw new TypeError('"rowDistance" should be a positive number');if(!n(G))throw new TypeError('"colDistance" should be a positive number');if(M)return{rows:M,cols:Math.ceil(L/M),rowDistance:O,colDistance:G};if(F)return{cols:F,rows:Math.ceil(L/F),rowDistance:O,colDistance:G};const j=Math.ceil(Math.sqrt(L));return{cols:j,rows:Math.ceil(L/j),rowDistance:O,colDistance:G}})(l,r.rows,r.cols,r.colDistance,r.rowDistance),p=(function(L,M,F,O,G){return typeof L!="string"?O.map(((j,Z)=>Z)):L==="radius"?M.getAttribute(!0,"radius").getMultiple(O):L==="degree"?F.getDegree():L==="random"?O.map((()=>Math.random())):F.getData(L).map((j=>j||G))})(i,e,o,a,t.sortFallbackValue),y=o.getAttribute("layoutable"),_=a.reduce(((w,L,M)=>(y[M]&&w.push({id:L,attr:p[M]}),w)),[]),x=o.getAttribute("x"),v=o.getAttribute("y"),b=o.getAttribute("radius");let S=1/0,A=1/0;for(let w=0;w<a.length;w++)S=Math.min(S,x[w]),A=Math.min(A,v[w]);return{sort:!!i,nodes:_,reverse:!!r.reverse,cols:h,rows:u,minX:S,minY:A,rs:b,rowDistance:g,colDistance:f}},update:function({sort:t,nodes:e,minX:s,rs:n,minY:i,reverse:r,cols:o,rowDistance:a,colDistance:l}){const u=e.map(((v,b)=>b));t&&u.sort(((v,b)=>e[v].attr-e[b].attr)),r&&u.reverse();let h=0;for(let v=0;v<e.length;v++){const b=v>0&&(v+1)%o==0,S=v%o==0,A=b?0:n[u[v+1]]||0,w=S?0:n[u[v+o-1]]||0,L=n[u[v+o]]||0,M=b?0:n[u[v+o+1]]||0,F=n[u[v]]||0;h=Math.max(h,F+A,F+w,F+L,F+M)}let g=h+5,f=h+5;const p=s,y=i;isFinite(g)||(g=0),isFinite(f)||(f=0),a!==void 0&&isFinite(a)&&(g=h+a),l!==void 0&&isFinite(l)&&(f=h+l);let _=0,x=0;return u.forEach((v=>{const b=e[v];b.x=p+_*g,b.y=y+x*f,_+=1,_===o&&(x+=1,_=0)})),e},onSync:function(t){return{indexes:t.map((({id:e})=>e)),x:t.map((({x:e})=>e)),y:t.map((({y:e})=>e))}}},E$=t=>(t.modules.layouts.register(V1),(e={})=>t.modules.layouts.start(V1.name,e)),O0={id:"__SENTINEL__",layer:-1,sink:!1,fixed:!1,siblingIndex:-1,parentIds:[],children:[],radius:0,ref:null},kd=t=>t.data===O0||!1,dx=t=>!kd(t),S$=[],A$=(t,e)=>({id:t,layer:e,data:O0,children:S$,ref:void 0,x:0,y:0}),FM=(t,e)=>({id:t,layer:-1,data:e,children:[],x:0,y:0}),j1=class{constructor(t,e,s){this.data=t,this.prev=e,this.next=s}toString(){return this.data}},PM=t=>t.reduce(((e,s)=>(e[s]=!0,e)),{});function w$(t,e){const s=[t],n=PM(s),i=[t];for(;s.length;){const r=s.shift();for(const o of e.get(r))n[o]||(n[o]=!0,i.push(o),s.push(o))}return i}function B0(t){return t.reduce(((e,{source:s,target:n})=>(e.set(s,e.get(s)||[]),e.set(n,e.get(n)||[]),e.get(s).push(n),e.get(n).push(s),e)),new Map)}function T$(t){return t.reduce(((e,{source:s,target:n})=>(e[s]=e[s]||[],e[s].push(n),e)),{})}function C$(t,e,s){const n=s||B0(e||[]);return t.filter((({id:i})=>!n.has(i)))}function L$(t,e){const s=PM(e);return t.filter((n=>!(n in s)))}function Gi(t,e){t.forEach(((s,n)=>{s.forEach(((i,r,o)=>{e(i,r,o,n)}))}))}var H1=t=>{const e=Math.floor(t.length/2);return(t=[...t].sort(((s,n)=>s-n))).length%2!=0?t[e]:(t[e-1]+t[e])/2};function N$(t,e,s){const n=B0(e);let i=Array.from(n.keys());const r=[];for(;i.length;){const o=w$(i[0],n);r.push(o),i=L$(i,o)}return s.skipSingletons?r:r.concat(C$(t,e,n).map((({id:o})=>[o])))}var Zg=({id:t,layer:e,sink:s,siblingIndex:n,radius:i,layoutable:r})=>({id:t,layer:e!==void 0?e:void 0,sink:s,siblingIndex:n||0,radius:i||0,fixed:r===!1,parentIds:[],children:[],ref:null});function M$(t){const e={x:0,y:0};let s=0;for(let n=0;n<t.length;n++){const i=t[n];for(let r=0;r<i.nodes.length;r++){const o=i.nodes[r];e.x+=o.x||0,e.y+=o.y||0,s++}}return e.x/=s,e.y/=s,e}function k$(t){const e={x:0,y:0};let s=0;for(const[,{x:n,y:i}]of t)e.x+=n||0,e.y+=i||0,s++;return e.x/=s,e.y/=s,e}function I$(t,e,s){const n=M$(s),i=t.x-n.x,r=t.y-n.y;for(let o=0;o<s.length;o++){const a=s[o];for(let l=0;l<a.nodes.length;l++){const u=a.nodes[l],h=e.get(u.id);!h||u.data&&u.data.fixed||(h.x=u.x+i,h.y=u.y+r)}}}function $1(t){return Math.ceil(Math.sqrt(t))}var q1=5,R$=class{constructor(t,e,s=0,n=!1){this.groupToSubNodes=new Map,this.nodeToGroup=new Map,this.lookup=new Map,this.shouldPackSiblings=!0,this.shouldSort=!1,this.shouldPackSiblings=t,this.packSiblingsFn=e||(()=>1),this.siblingsGap=s,this.shouldSort=n}packSiblings(t){if(!this.shouldPackSiblings)return;const e=this.groupToSubNodes,s=this.nodeToGroup,n=this.siblingsGap,i=this.packSiblingsFn,r=[],o=new Set,a=new Map,l=new Map,u=this.lookup;t.nodes.forEach((h=>{u.set(h.id,h)})),t.nodes.forEach((h=>{if(!h.children.length)return;const g=[];h.children.forEach((f=>{f.id===h.id||f.children.length||g.push(f)})),!(g.length<q1)&&l.set(h.id,g)})),l.forEach(((h,g)=>{const f=new Map;h.length<q1||(h.forEach((p=>{if(a.has(p.id))return;const y=i(p.data);if(y===void 0)return;const _=`${g}-${y}`;a.set(p.id,_),f.has(_)?f.get(_).push(p):f.set(_,[p])})),f.forEach(((p,y)=>{this.shouldSort&&p.sort(((S,A)=>S.data.siblingIndex-A.data.siblingIndex));const _=$1(p.length);let x=_*n;for(let S=0;S<_;S++){let A=0;for(let w=0;w<_;w++){const L=p[S*_+w];A=Math.max(A,L?2*L.data.radius:0)}x+=A}x/=2,e.set(y,p);const v=p[0].layer,b=FM(y,Zg({id:y,layer:v,radius:x}));b.layer=v,u.set(y,b),r.push(b),p.forEach((S=>{s.set(S.id,y),o.add(S.id)}))})))})),t.nodes=t.nodes.filter((h=>o.has(h.id)===!1)),r.forEach((h=>{t.nodes.push(h)})),t.nodes.forEach((h=>{const g=new Set;h.children=h.children.filter((f=>{if(!a.has(f.id))return!0;const p=a.get(f.id);return g.add(p),!1})),h.children.push(...Array.from(g).map((f=>u.get(f))))}))}unpackSiblings(t){if(!this.shouldPackSiblings)return;const e=this.siblingsGap,s=this.groupToSubNodes,n=new Set,i=[];t.nodes.forEach((r=>{if(!s.has(r.id))return;n.add(r.id);const o=s.get(r.id)||[],a=$1(o.length),l=new Array(a).fill(0);o.forEach(((h,g)=>{i.push(h);const f=Math.floor(g/a);l[f]=Math.max(l[f],2*h.data.radius)})),l[0]-=r.data.radius;for(let h=1;h<a;h++)l[h]+=l[h-1]+e;const u=2*r.data.radius/a;o.forEach(((h,g)=>{const f=Math.floor(g/a),p=g%a;h.y=r.y+l[f],h.x=r.x-r.data.radius+p*u}))})),t.nodes=t.nodes.filter((r=>!n.has(r.id))),i.forEach((r=>{t.nodes.push(r)}))}};function F$(t){let e=0,s=0;for(const o of t)e+=o.w*o.h,s=Math.max(s,o.w);t.sort(((o,a)=>a.h-o.h));const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),s),h:1/0}];let i=0,r=0;for(const o of t)for(let a=n.length-1;a>=0;a--){const l=n[a];if(!(o.w>l.w||o.h>l.h)){if(o.x=l.x,o.y=l.y,r=Math.max(r,o.y+o.h),i=Math.max(i,o.x+o.w),o.w===l.w&&o.h===l.h){const u=n.pop();a<n.length&&(n[a]=u)}else o.h===l.h?(l.x+=o.w,l.w-=o.w):o.w===l.w?(l.y+=o.h,l.h-=o.h):(n.push({x:l.x+o.w,y:l.y,w:l.w-o.w,h:o.h}),l.y+=o.h,l.h-=o.h);break}}return{w:i,h:r,fill:e/(i*r)||0}}var P$={down:()=>{},up:t=>t.y=-t.y,left:t=>{const e=t.x;t.x=-t.y,t.y=e},right:t=>{const e=t.x;t.x=t.y,t.y=-e}},A_=(t,e)=>isFinite(t)&&t>0?t:e;function z$(t){return{nodesSeparation:A_(t.nodesSeparation,0),componentsSeparation:A_(t.componentsSeparation,25),layerSeparation:A_(t.layerSeparation,50)}}function D$(t,{componentsSeparation:e,packing:s}){const n=[];for(let i=0;i<t.length;i++){const r=t[i],o=r.nodes;if(r.isFake&&r.w!==void 0&&r.h!==void 0){n.push({w:r.w,h:r.h,x:void 0,y:void 0,dag:r});continue}if(r.nodes.length===1){const f=2*o[0].data.radius;n.push({w:f+e/2,h:f+e/2,x:void 0,y:void 0,dag:r});continue}const{minX:a,maxX:l,minY:u,maxY:h}=o.reduce(((f,{x:p,y,data:_})=>{const x=_.radius||0;return f.minX=Math.min(f.minX,p-x),f.maxX=Math.max(f.maxX,p+x),f.minY=Math.min(f.minY,y-x),f.maxY=Math.max(f.maxY,y+x),f}),{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0}),g=(l+a)/2;o.forEach((f=>{f.x-=g})),n.push({w:Math.abs(l-a)+e/2,h:Math.abs(h-u)+e/2,minX:a,x:void 0,y:void 0,dag:r})}if(s!=="singleline")F$(n);else{let i=0;for(let r=0;r<n.length;r++){const o=n[r];o.x=i,o.y=0,i+=o.w}}return n}function O$(t,e={}){const{componentsSeparation:s}=z$(e);e.direction===void 0&&(e.direction="down");const n=D$(t,{componentsSeparation:s,packing:e.packing});for(let i=0;i<n.length;i++){const{x:r=0,y:o=0,dag:a}=n[i];for(const l of a.nodes)l.x+=r,l.y+=o,P$[e.direction](l)}}var B$=t=>t.reduce(((e,{radius:s})=>Math.max(e,2*s)),0);function U$(t,e){return{nodes:t.map((s=>({...s,data:s}))),isFake:!0,...e}}function G$(t,e,s){const n=B0(e||[]),i=t.filter((({id:p})=>!n.has(p))).sort(((p,y)=>y.radius-p.radius)),r=Math.sqrt(i.length);let o=Math.floor(r),a=Math.ceil(r);o*a<i.length&&(o<a?o++:a++);const l=Math.max(1,B$(i)),u=Math.max(s.nodesGridSeparation||0,1),h=l*a+u*(a-1),g=l*o+u*Math.max(o-1,0),f=U$(i,{w:h,h:g});return f.nodes.forEach(((p,y)=>{const _=y%a,x=Math.floor(y/a);p.x=h*_/a,p.y=g*x/o})),f}function Y1(t,e,s){const n=e.reduce(((o,a)=>(o.set(a.source,o.get(a.source)||[]),o.get(a.source).push(a),o)),new Map),{result:i}=t.reduce((function o(a,l){const{visited:u,stack:h,result:g}=a;if(u.has(l.id))return a;h.add(l.id),u.add(l.id);const f=n.get(l.id)||[];for(const p of f)h.has(p.target)?g.push(p):o(a,s.get(p.target));return h.delete(l.id),a}),{visited:new Set,stack:new Set,result:[]}),r=i.reduce(((o,{source:a,target:l})=>(o.set(a,o.get(a)||new Set),o.get(a).add(l),o)),new Map);return e.map((o=>{const{source:a,target:l,id:u}=o;return r.has(a)&&r.get(a).has(l)?{id:u,source:l,target:a}:o}))}function V$(t){if(!t||!t.length)throw Error("Cannot stratify empty data");for(const i of t){if(!i)throw Error('Node data is "null"');if(i.id==null)throw Error('Node id contains a "null" value')}const e=t.map((i=>FM(i.id,i))),s=e.reduce(((i,r)=>{if(i[r.id])throw Error(`The connected component contains id duplicates: ${r.id}`);return i[r.id]=r,i}),{}),n=[];for(let i=0;i<e.length;i++){const r=e[i];for(let o=0;o<r.data.parentIds.length;o++){const a=r.data.parentIds[o],l=s[a];if(!l)throw Error(`The node ${r.id} has a missing parent id ${a}`);l.children.push(r)}r.data.parentIds.length||n.push(r)}return{isFake:!1,nodes:j$(n)}}function j$(t){const e={},s=[];for(;t.length;){const n=t.pop();e[n.id]||(s.push(n),e[n.id]=!0,t.push(...n.children))}return s}var H$=t=>{var h,g,f;const e=[];if(t.nodes.forEach((p=>{if(p&&!isNaN(p.layer)&&p.layer!==null){if(p.layer<0)throw new Error("Layer must be greater than or equal to 0");e.push([p.id,p.layer])}})),e.length===0)return t.edges;e.sort(((p,y)=>p[1]-y[1]));const s=new Set;for(let p=0;p<e.length;p++)e[p][1]!==0&&s.add(e[p][0]);const n=new Map;for(const p of t.nodes)n.set(p.id,[]);for(const p of t.edges)(h=n.get(p.source))==null||h.push(p.target),(g=n.get(p.target))==null||g.push(p.source);if(!e.map((([,p])=>p)).some((p=>p===0))){e.sort(((x,v)=>x[1]-v[1]));const p=new Set,y=[e[0]];let _;for(;y.length>0;){const[x,v]=y.shift();if(v===0){_=x;break}p.add(x);const b=n.get(x)||[];for(const S of b)s.has(S)||p.has(S)||y.push([S,v-1])}if(_)e.push([_,0]);else{const x=e[0][1];for(let v=0;v<e.length;v++)e[v][1]-=x}}const i=e.filter((([,p])=>p===0)).map((([p])=>p)),r=i.slice(),o=new Map,a=new Map,l=new Map;for(const p of i)o.set(p,0),a.set(p,[]);for(;r.length>0;){const p=r.shift(),y=o.get(p),_=n.get(p)||[];for(const x of _){const v=o.get(x);v===void 0?(o.set(x,y+1),a.set(x,[p]),r.push(x)):v===y+1&&((f=a.get(x))==null||f.push(p))}}for(const[p,y]of a.entries())for(const _ of y)l.set(_,(l.get(_)||[]).concat(p));for(const[p,y]of e)if(o.get(p)!==y)if(y===0){const _=a.get(p)||[];a.set(p,[]),_.forEach((b=>{l.set(b,(l.get(b)||[]).filter((S=>S!==p)))}));const x=t.nodes.filter((b=>o.get(b.id)===0));o.clear(),x.forEach((b=>o.set(b.id,0)));const v=x.map((b=>b.id));for(;v.length>0;){const b=v.shift(),S=o.get(b),A=l.get(b)||[];for(const w of A)o.get(w)===void 0&&(o.set(w,S+1),v.push(w))}}else{const _=t.nodes.find((S=>o.get(S.id)===y-1&&S.id!==p));if(!_)continue;const x=a.get(p)||[];a.set(p,[_.id]),x.forEach((S=>{l.set(S,(l.get(S)||[]).filter((A=>A!==p)))})),l.set(_.id,(l.get(_.id)||[]).concat(p));const v=t.nodes.filter((S=>o.get(S.id)===0));o.clear(),v.forEach((S=>o.set(S.id,0)));const b=v.map((S=>S.id));for(;b.length>0;){const S=b.shift(),A=o.get(S),w=l.get(S)||[];for(const L of w)o.get(L)===void 0&&(o.set(L,A+1),b.push(L))}}const u=[];for(const[p,y]of a.entries())if(y.length>0)for(const _ of y)u.push({id:`${_}-${p}`,source:_,target:p});return u},$$=class{constructor(){this.byId={},this.byIndex={},this.length=0}append(e,s){let n;return this.head?(n=new j1(e,this.tail),this.tail=this.tail.next=n):(n=new j1(e),this.tail=this.head=n),this.byId[s]=n,this.byIndex[this.length++]=n,n}find(e){let s=this.head;do{if(s.data===e)return s;s=s.next}while(s)}forEach(e){let s=this.head,n=0;do e(s,n),n++;while(s=s.next)}},Vi=-1,nn=1e-5,w_=[],q$=class{constructor(t,e,s){this.edges=[],this.nodeMap={},this.nodeIndexTopDown={},this.nodeToLayer={},this.longEdges={},this.virt={},this.height={},this.breadth={},this.first=[],this.totalW={},this.mDist={},this.X={},this.block={},this.nodeList=new $$,this.nodeDistance=e,this.layerDistance=s,this.layers=t;const{breadth:n,virt:i,height:r,nodeToLayer:o,nodeIndexTopDown:a,nodeMap:l,longEdges:u,edges:h}=this;let g=0;Gi(this.layers,((_,x,v,b)=>{if(a[_.id]=g++,l[_.id]=_,o[_.id]=b,this.nodeList.append(_,_.id),_.children.forEach((A=>{const w=kd(A)||kd(_);h.push({source:_.id,target:A.id,virtual:w,id:h.length})})),u[_.id])return;const S=[_.id];if(u[_.id]=S,!dx(_))for(let A=0;A<_.children.length;A++){const w=_.children[A];if(dx(w))continue;let L=w;for(;kd(L);)S.push(L.id),u[L.id]=S,L=L.children[0]}}));const f=this.adjacencyList=T$(h);this.N=t.reduce(((_,x)=>_+x.length),0),this.Y=new Float32Array(t.length),this.first=t.map((_=>_[0])),t.forEach(((_,x)=>r[x]=0)),Gi(this.layers,((_,x,v,b)=>{const S=f[_.id]?f[_.id].length:0;i[_.id]=kd(_)&&S===1,this.nodeToLayer[_.id]=b,i[_.id]?n[_.id]=0:(n[_.id]=2*_.data.radius,r[b]=Math.max(r[b]||0,2*_.data.radius))}));const p={},y={};h.forEach((_=>{const x=_.source,v=_.target;p[v]=p[v]||[],p[v].push(x),y[x]=y[x]||[],y[x].push(v)})),Object.values(p).forEach((_=>{_.sort(((x,v)=>this.nodeIndexTopDown[x]-this.nodeIndexTopDown[v]))})),Object.values(y).forEach((_=>{_.sort(((x,v)=>this.nodeIndexTopDown[x]-this.nodeIndexTopDown[v]))})),this.neighbours={prev:p,next:y}}computeMinNodeDistances(){const{layers:t,totalW:e}=this;Gi(t,(s=>{e[s.id]=0})),Gi(t,(s=>e[s.data.id]=0)),this.layers.forEach((s=>{e[s[0].id]=0,s.slice(1).forEach(((n,i)=>{const r=s[i],o=n.id;e[o]=e[r.id]+r.data.radius+n.data.radius+this.nodeDistance}))}))}decrossVirtualEdges(){this.layers.forEach((t=>{let e=-1;t.forEach((s=>{if(!this.virt[s.id])return;const n=this.neighbours.next[s.id][0];if(this.virt[n])if(e!==-1&&e>this.nodeIndexTopDown[n]){const i=this.longEdges[s.id];let r=0;for(r=0;r<i.length&&i[r]!==n;r++);const o=i.slice(r);o.forEach((l=>this.longEdges[l]=o));const a=i.slice(0,r);a.forEach((l=>this.longEdges[l]=a))}else e=this.nodeIndexTopDown[n]}))}))}placeLongEdges(){const{X:t,layers:e}=this;Gi(e,(s=>t[s.id]=0));for(let s=1;s>=-1;s-=2){const n={};let i=0;const r={};Gi(e,(u=>r[u.id]=0)),r[O0.id]=0;const o=s;e.forEach((u=>{let h=o===1?u[0]:u[u.length-1];r[h.id]||(this.longEdges[h.id].forEach((p=>{r[p]=i})),i++);let g=o===1?0:u.length-1,f=g+o;for(;f>=0&&f<u.length;)h=u[f],r[h.id]||this.longEdges[h.id].forEach((p=>{r[p]=r[u[g].id]})),g=f,f+=o}));const a={};e.forEach((u=>{for(let h=o===1?0:u.length-1;o===1?h<u.length:h>=0;h+=o){const g=u[h],f=r[g.id];a[f]=a[f]||[],a[f].push(g.id)}}));const l={};this.nodeList.forEach((u=>l[u.data.id]=0));for(let u=0;u<i;u++){const h={done:!1,dist:0},g=a[u];for(let f=0;f<g.length;f++){const p=g[f];this.sortLongEdges(p,s,l,h,r,n)}if(!h.done){const f=this.layers[this.nodeToLayer[a[u][0]]],p=[];f.forEach((y=>{for(const _ of this.neighbours.prev[y.id]||w_){const x=Math.abs(l[_]-l[y.id]);p.push(x)}})),p.length!==0&&(h.dist=H1(p))}for(let f=0;f<g.length;f++)l[g[f]]-=s*h.dist}Gi(e,(u=>t[u.id]+=l[u.id]/2))}}sortLongEdges(t,e,s,n,i,r){if(r[t])return!1;let o=!1,a=0;const{nodeToLayer:l,totalW:u}=this,h=this.longEdges[t];h.forEach((g=>r[g]=!0)),h.forEach((g=>{const f=this.nodeList.byIndex[this.nodeIndexTopDown[g]-e];if(!f)return;const p=f.data.id,y=g,_=l[p]===l[y],x=i[p]===i[y];!_||!x||(this.sortLongEdges(p,e,s,n,i,r),(!o||e*(a-s[p])<e*(u[y]-u[p]))&&(o=!0,a=s[p]+u[y]-u[p]))})),h.forEach((g=>{s[g]=a;const f=this.nodeList.byId[g],p=e===1?f.next:f.prev;if(!p)return;const y=p.data.id,_=g,x=l[y]===l[_],v=i[y]!==i[_],b=e*(u[y]-u[_]-s[y]+s[_]);x&&v&&(!n.done||b>n.dist)&&(n.dist=b,n.done=!0)}))}placeNonVirtualNodes(){const t={};Gi(this.layers,(l=>t[l.id]=-1));const{X:e,totalW:s,virt:n,nodeIndexTopDown:i,mDist:r,nodeList:o}=this,a={};Gi(this.layers,((l,u,h,g)=>{if(!n[l.id])return void(a[l.id]=!1);let f=this.nodeList.byId[l.id].next;for(;f&&this.nodeToLayer[f.data.id]===g&&!n[f.data.id];)f=f.next;a[l.id]=this.nodeToLayer[f.data.id]===g&&e[f.data.id]-e[l.id]<s[f.data.id]-s[l.id]+nn})),Gi(this.layers,(({id:l})=>{a[l]&&t[l]===-1&&this.longEdges[l].forEach((u=>{u!==l&&(t[u]=i[u]<i[l]?1:0)}))})),Gi(this.layers,(({id:l})=>r[l]=s[l]));for(let l=0;l<2;l++)for(let u=l?this.layers.length-1:0;u>=0&&u<this.layers.length;l?u--:u++){let h=Vi;const g=this.layers[u];if(g.forEach((({id:f},p,y)=>{if(n[f]){if(h===Vi){this.placeSequence(Vi,f,y[0].id,o.byId[f].prev.data.id,l);for(let _=0;_<p;_++){const x=y[_].id;r[x]=r[f]-e[f]+e[x]}}else if(t[h]!==1-l){a[h]||this.placeSequence(h,f,o.byId[h].next.data.id,o.byId[f].prev.data.id,l);const _=l===1?this.neighbours.prev:this.neighbours.next,x=_[h][0],v=_[f][0];if(n[x]&&n[v])for(let b=i[x]+1;b<i[v];b++)t[o.byIndex[b].data.id]=l}h=f}})),h===Vi)this.placeSequence(Vi,Vi,g[0].id,g[g.length-1].id,l),g.forEach((({id:f})=>r[f]=e[f]));else{this.placeSequence(h,Vi,o.byId[h].next.data.id,g[g.length-1].id,l);for(let f=g.length-1;f>=0;f--){const p=g[f].id;if(p===h)break;r[p]=r[h]-e[h]+e[p]}}}}placeSequence(t,e,s,n,i,r=0){if(r===2048)return;const o=this.nodeIndexTopDown[s],a=this.nodeIndexTopDown[n],{X:l,nodeIndexTopDown:u,mDist:h}=this;if(o===a)l[s]=this.placeNode(s,t,e,l[s],i);else if(o<a){const g=Math.floor((u[s]+u[n])/2),f=this.nodeList.byIndex[g],p=f.next.data.id,y=h[p]-h[f.data.id];this.placeSequence(t,e,s,f.data.id,i,r+1),this.placeSequence(t,e,p,n,i,r+1),this.combineSequences(t,e,s,n,p,f.data.id,i,y)}}calculateBends(t,e,s,n,i,r,o,a){let l=0;const u=[],{X:h,mDist:g,neighbours:f}=this,p=this.nodeIndexTopDown[s],y=this.nodeIndexTopDown[n];for(let _=this.nodeList.byId[r],x=this.nodeIndexTopDown[_.data.id];x>=p&&x<=y&&_;_=t===-1?_.prev:_.next,x=_&&this.nodeIndexTopDown[_.data.id]){const v=_.data.id,b=(e===0?f.prev[v]:f.next[v])||w_;let S=0;for(let w=0;w<b.length;w++){const L=b[w];if(t*(h[L]-h[v])<nn)S++;else{S--;const M=h[L]+g[r]-g[v];t*(h[r]-M)>-nn?l++:(a===Vi||t*(M-h[a]+g[a]-g[r])<nn)&&t*(M-h[i])<o-nn&&u.push({value:2,key:M})}}const A=h[v]+g[r]-g[v];t*(h[r]-A)>-nn?l+=S:(a===Vi||t*(A-h[a]+g[a]-g[r])<nn)&&t*(A-h[i])<o-nn&&u.push({value:S,key:A})}return a!==Vi&&u.push({value:this.edges.length,key:h[a]-g[a]+g[r]}),u.sort((({key:_},{key:x})=>_-x)),{res:l,bends:u.reduce(((_,x,v)=>{if(v<u.length-1){const b=u[v+1];Math.abs(x.key-b.key)>nn?x.value>0&&_.push(x):x.value+=b.value}else x.value>0&&_.push(x);return _}),[])}}combineSequences(t,e,s,n,i,r,o,a){const{X:l,mDist:u,nodeIndexTopDown:h}=this;let{res:g,bends:f}=this.calculateBends(-1,o,s,n,i,r,a,t),{res:p,bends:y}=this.calculateBends(1,o,s,n,r,i,a,e);for(f.length>0&&f.reverse();l[i]-l[r]<a-nn;){let v=0,b=0;if(g<p){const S=f.length;if(S>0){const A=f.pop();v=A.value,l[r]=A.key}(S===0||l[i]-l[r]>a+nn)&&(l[r]=l[i]-a)}else if(g>p){const S=y.length;if(S>0){const A=y.pop();b=A.value,l[i]=A.key}(S===0||l[i]-l[r]>a+nn)&&(l[i]=l[r]+a)}else{let S=(a-l[i]+l[r])/2;const A=f.length===0?S+1:l[r]-f[f.length-1].key,w=y.length===0?S+1:y[y.length-1].key-l[i];A<S+nn&&A<w+nn&&(v=f.pop().value),w<S+nn&&w<A+nn&&(b=y.pop().value),S=Math.min(S,A,w),l[r]-=S,l[i]+=S}g+=v,p+=b}let _,x=this.nodeList.byId[r].prev;for(;x&&h[_=x.data.id]>=h[s]&&l[r]-l[_]<u[r]-u[_];)l[_]=l[r]-u[r]+u[_],x=x.prev;for(x=this.nodeList.byId[i].next;x&&h[_=x.data.id]<=h[n]&&l[i]-l[_]>u[i]-u[_];)l[_]=l[i]-u[i]+u[_],x=x.next}placeNode(t,e,s,n,i){const{X:r,neighbours:o,mDist:a}=this,l=((i===0?o.prev:o.next)[t]||w_).map((u=>r[u]));return l.length===0?r[t]:(n=H1(l),e!==Vi&&(n=Math.max(n,r[e]+a[t]-a[e])),s!==Vi&&(n=Math.min(n,r[s]+a[t]-a[s])),n)}moveLongEdge(t,e,s){const{X:n,virt:i,totalW:r,nodeList:o}=this,{id:a}=t.data;if(s[a]||!i[a])return;const l=this.longEdges[a];if(!l)return;l.forEach((_=>s[_]=!0));const u=l[0],h=l[l.length-1],g=[];e<0?g.push(n[u]<n[h]?n[u]:n[h],n[u]<n[h]?n[h]:n[u]):e>0?g.push(n[u]<n[h]?n[h]:n[u],n[u]<n[h]?n[u]:n[h]):g.push(n[u],n[h]);const f=g[0];let p,y=!1;for(;!y&&g.length!==0;)p=g.pop(),y=!0,l.forEach((_=>{const x=this.layers[this.nodeToLayer[_]];if(_!==x[0].id){const v=o.byId[_].prev.data;p-n[v.data.id]<r[_]-r[v.data.id]&&this.moveLongEdge(v,-1,s),y=y&&p-n[v.data.id]>=r[_]-r[v.data.id]-nn}if(_!==x[x.length-1].id){const v=o.byId[_].next.data;p-n[v.data.id]>r[_]-r[v.data.id]&&this.moveLongEdge(v,1,s),y=y&&p-n[v.data.id]<=r[_]-r[v.data.id]+nn}}));y||(p=f,l.forEach((_=>{const x=this.layers[this.nodeToLayer[_]];if(_!==x[0].id){const v=o.byId[_].prev.data;p=Math.max(p,n[v.data.id]+r[_]-r[v.data.id])}if(_!==x[x.length-1].id){const v=o.byId[_].next.data;p=Math.min(p,n[v.data.id]+r[_]-r[v.data.id])}}))),l.forEach((_=>n[_]=p))}moveLongEdges(){const t={};this.layers.forEach((e=>{const s=Math.floor(e.length/2);for(let n=s;n<e.length;n++)this.moveLongEdge(e[n],0,t);for(let n=s-1;n>=0;n--)this.moveLongEdge(e[n],0,t)}))}computeY(){const{Y:t,layers:e,height:s}=this;t[0]=0,e.slice(1).forEach(((n,i)=>{t[i+1]=t[i]+(s[i]+s[i+1])/2+this.layerDistance}))}straightenLongEdge(t,e){const{nodeList:s,longEdges:n,neighbours:i,X:r,Y:o,nodeToLayer:a,totalW:l}=this,u=n[t.id];if(e[t.id]||!i.prev[t.id]||i.prev[t.id].length!==1||!i.next[t.id]||i.next[t.id].length!==1||!(u&&u.length<2))return;e[t.id]=!0;const h=i.prev[t.id][0],g=i.next[t.id][0];if(a[g]===a[h])return;const f=r[h]+(r[g]-r[h])*(o[a[t.id]]-o[a[h]])/(o[a[g]]-o[a[h]]);if(t!==this.first[a[t.id]]){const y=s.byId[t.id].prev.data;if(f-r[y.id]<l[t.id]-l[y.id]-nn&&this.straightenLongEdge(y,e),f-r[y.id]<l[t.id]-l[y.id]-nn)return}const p=this.layers[a[t.id]];if(t!==p[p.length-1]){const y=s.byId[t.id].next.data;if(r[y.id]-f<l[y.id]-l[t.id]-nn&&this.straightenLongEdge(y,e),r[y.id]-f<l[y.id]-l[t.id]-nn)return}r[t.id]=f}straightenEdges(){const t={};this.layers.forEach((e=>{const s=Math.floor(e.length/2);for(let n=s;n<e.length;n++)this.straightenLongEdge(e[n],t);for(let n=s-1;n>=0;n--)this.straightenLongEdge(e[n],t)}))}run(){this.computeMinNodeDistances(),this.decrossVirtualEdges(),this.placeLongEdges(),this.placeNonVirtualNodes(),this.moveLongEdges(),this.computeY(),this.straightenEdges(),Gi(this.layers,((t,e,s,n)=>{t.x=this.X[t.id],t.y=this.Y[n]}))}},Y$=(t,e=20,s=50)=>new q$(t,e,s).run();function W$(t){if(t.sort(((n,i)=>n-i)),t.length===0)return 0;const e=Math.floor(t.length/2),s=Math.floor(t.length/2);return(t[e]+t[s])/2}function hx(t,e,s){const n={};return e.forEach(((i,r)=>n[i.id]=r)),t.map((i=>(s[i.id]||[]).map((r=>n[r])).sort())).reduce(((i,r,o,a)=>{const l=r.length?r[r.length-1]:-1;for(let u=o+1;u<a.length;u++)i+=a[u].filter((h=>h<l)).length;return i}),0)}function X$(t,e,s,n,i){const r={};for(let o=0;o<t.length;o++)r[t[o].id]=W$((e[t[o].id]||[]).map((a=>s[a])))||0;i?t.sort(((o,a)=>{const l=r[o.id]-r[a.id],u=n[o.id]===n[a.id],h=o.data.siblingIndex,g=a.data.siblingIndex;return u&&h>-1&&g>-1?h-g:l===0?s[a.id]-s[o.id]:l})):t.sort(((o,a)=>{const l=r[o.id]-r[a.id];return l===0?s[a.id]-s[o.id]:l}))}function W1({layers:t,topDown:e,topDownAdj:s,bottomUpAdj:n,idToIndex:i,crossings:r,sortSiblings:o}){const a=e?s:n;for(let l=e?0:t.length-1;e?l<t.length:l>=0;e?l++:l--){X$(t[l],a[l]||{},i,n[l],o);const u=l>0?hx(t[l-1],t[l],s[l-1]):0,h=l<t.length-1?hx(t[l],t[l+1],s[l]):0;h+u<=(r[l]||0)+(r[l-1]||0)?(r[l]=h,l>0&&(r[l-1]=u),t[l].forEach(((g,f)=>i[g.id]=f))):t[l].sort(((g,f)=>i[g.id]-i[f.id]))}}var Z$=(t,e,s)=>{if(!s&&!e)return;const n={},i=t.map((()=>({}))),r=t.map((()=>({})));if(t.forEach(((h,g)=>{h.forEach(((f,p)=>{n[f.id]=s?f.data.siblingIndex:p,f.children.forEach((y=>{const _=y.layer;_>g?(i[g][f.id]=i[g][f.id]||[],i[g][f.id].push(y.id),r[_][y.id]=r[_][y.id]||[],r[_][y.id].push(f.id)):(i[_][y.id]=i[_][y.id]||[],i[_][y.id].push(f.id),r[g][f.id]=r[g][f.id]||[],r[g][f.id].push(y.id))}))}))})),n[-1]=-1,s&&(t.forEach((h=>h.sort(((g,f)=>n[g.id]-n[f.id])))),!e))return;const o=t.slice(1).map(((h,g)=>hx(t[g],h,i[g]))),a=[[50,100],[100,10],[1e3,1],[5e3,0]],l=Math.max(...t.map((h=>h.length))),u=(a.find((([h])=>l<h))||a[a.length-1])[1];for(let h=0;h<u;h++)W1({layers:t,topDown:!0,topDownAdj:i,bottomUpAdj:r,idToIndex:n,crossings:o,sortSiblings:s}),W1({layers:t,topDown:!1,topDownAdj:i,bottomUpAdj:r,idToIndex:n,crossings:o,sortSiblings:s})};function K$(t){const e={},s={},n={};t.nodes.forEach((o=>{n[o.id]=o}));const i=o=>{if(e[o.id])return s[o.id];e[o.id]=!0;let a=1/0;for(const l of o.children)a=Math.min(a,i(n[l.id])-1);return a===1/0&&(a=0),s[o.id]=a,a};t.nodes.forEach((o=>{o.data.parentIds.length===0&&i(o)}));let r=1/0;t.nodes.forEach((o=>{r=Math.min(r,s[o.id])})),t.nodes.forEach((o=>{s[o.id]-=r,o.layer=s[o.id]})),t.nodes.forEach((o=>{typeof o.data.layer=="number"&&!isNaN(o.data.layer)&&(o.layer=o.data.layer)}))}function Q$(t){const e=t.nodes.reduce(((s,n)=>n.data.fixed&&(s===null||s.layer>n.layer)?n:s),null);return e&&t.nodes.forEach((s=>s.ref=e.id)),t}function J$(t){if(t.nodes.every((e=>e.layer))){const e=t.nodes.reduce(((s,n)=>Math.min(s,n.layer)),1/0);t.nodes.forEach((s=>s.layer-=e))}}function tq(t){if(t.nodes.some((e=>e.data.sink))){const e=t.nodes.reduce(((s,n)=>Math.max(s,n.layer)),-1/0);t.nodes.forEach((s=>{s.data.sink&&(s.layer=e+1)}))}}function eq(t){const e=[];t.nodes.forEach((n=>e[n.layer]=0));const s=Array.from(e).reduce(((n,i,r)=>{if(r===0)return n.push(0),n;const o=n[r-1];return i!==void 0?(n.push(o),n):(n.push(o-1),n)}),[]);t.nodes.forEach((n=>n.layer+=s[n.layer]))}function sq(t){return K$(t),tq(t),J$(t),eq(t),t.nodes.forEach((e=>{const{below:s,above:n}=e.children.reduce(((i,r)=>(e.layer>r.layer?i.above.push(r):i.below.push(r),i)),{above:[],below:[]});n.forEach((i=>i.children.push(e))),e.children=s})),Q$(t)}var nq=(t,{nodeDistance:e,layerDistance:s,nodeLookup:n,customSort:i,customLayering:r,sortSiblings:o,siblingsPacking:a,shouldDecross:l=!0})=>{sq(t),a.packSiblings(t),r&&r(t);const u=iq(t);return t.nodes.length>1?(Z$(u,l,o),i&&u.forEach((h=>{h.sort(((g,f)=>i(n.get(g.id),n.get(f.id))))})),Y$(u,e,s)):(t.nodes[0].x=0,t.nodes[0].y=0),a.unpackSiblings(t),rq(t),t};function iq(t){return t.nodes.reduce(((e,s)=>(e[s.layer]=e[s.layer]||[],e[s.layer].push(s),s.children=s.children.map((n=>{if(n.layer===s.layer+1)return n;let i=n;for(let r=n.layer-1;r>s.layer;r--){const o=A$(`${s.id}->${n.id}@${r}`,r);o.children=[i],e[r]=e[r]||[],e[r].push(o),i=o}return i})),e)),[])}function rq(t){t.nodes.forEach((e=>{e.data&&(e.children=e.children.filter(dx))}))}var oq=(t,e={})=>{const s=new Map,n=new Map;for(const u of t.nodes)s.set(u.id,u);const i=t.nodes.slice(),r=(t.edges||[]).filter((({source:u,target:h})=>u!==h)),o=Y1(i,r,s).filter((u=>{const h=n.get(u.source);if(!h){const g=new Map;return g.set(u.target,!0),n.set(u.source,g),!0}return!h.get(u.target)&&(h.set(u.target,!0),!0)})),a=N$(i,o,{skipSingletons:e.packing==="grid"}),l=a.map((u=>{const h=u.map((f=>s.get(f))),g=o.filter((f=>u.includes(f.source)));return Y1(h,H$({nodes:h,edges:g}),s)})).flat().reduce(((u,h)=>(u.has(h.source)||u.set(h.source,Zg(s.get(h.source))),u.has(h.target)||u.set(h.target,Zg(s.get(h.target))),u.get(h.target).children.push(h.source),u.get(h.target).parentIds.push(h.source),u)),new Map);return{components:a.map((u=>u.map((h=>l.get(h)||Zg(s.get(h)))))),lookup:s}};function aq(t,e,s,n){const i=[];for(const r of t){const o=V$(r);i.push(o),nq(o,{nodeDistance:n.nodesSeparation,layerDistance:n.layerSeparation,shouldDecross:n.shouldDecross,siblingsPacking:s,customSort:n.customSort,customLayering:n.customLayering,sortSiblings:!!n.sortSiblings,nodeLookup:e})}return i}var X1=(t,e={})=>{if(!t||!t.nodes)return t;const s={direction:"down",packing:"fit",nodesGridSeparation:1,...e,shouldDecross:e.shouldDecross!==!1},n=new R$(e.shouldPackSiblings,e.siblingPacking,e.siblingsGap,e.sortSiblings),{components:i,lookup:r}=oq(t,s),o=k$(r),a=aq(i,r,n,s);if(s.packing==="grid"){const l=G$(t.nodes,t.edges,s);a.push(l)}return O$(a,s),I$(o,r,a),t},T_={direction:"TB",nodeDistance:5,levelDistance:50,componentDistance:50,gapWidth:1,arrangeComponents:"fit",gridDistance:50,layer:"layer",siblingIndex:""},cx={name:"hierarchical",imports:{sequential:X1},configure:function(t,{graph:e,data:s}){function n(S,A,w=S.getNodes()){return A?A instanceof uo?A:S.getNodes(A):w}const i={...T_,...t,nodeList:t.nodes};i.direction=t.direction||T_.direction,i.layerSeparation=i.levelDistance,i.nodesSeparation=i.nodeDistance,i.componentsSeparation=i.componentDistance,i.gapDistance=i.gapWidth,i.packing=i.arrangeComponents;const r=t.decross!==!1,o={...i},a=i.edges,l=i.nodeList;if(["TB","BT","LR","RL"].indexOf(i.direction)===-1)throw new Error('direction should be one of the "TB", "BT", "LR", "RL"');if(["fit","grid","singleLine"].indexOf(i.packing)===-1)throw new Error('arrangeComponents should be one of the "fit", "grid", "singleLine"');i.nodesGridSeparation=t.gridDistance||T_.gridDistance;const u=l.getId(),h=l.getAttribute("layoutable").reduce(((S,A,w)=>(S[u[w]]=A,S)),{}),g=l.getAttributes(["x","y"]).reduce(((S,A,w)=>(S[u[w]]=A,S)),{}),f=t.rs?t.rs:l.getAttribute("radius");if(typeof o.layer!="string")throw new Error("'layer' should be the valid data field name");if(o.siblingIndex===void 0&&(o.siblingIndex=""),typeof o.siblingIndex!="string")throw new Error("'siblingIndex' should be the valid data field name");const p=n(e,i.roots,e.nodeList()),y=s.getProperty(i.nodeList,o.layer),_=o.siblingIndex.length?s.getProperty(i.nodeList,o.siblingIndex):[],x=p.map((S=>{let A=-1;return i.nodeList.forEach(((w,L)=>{w===S&&(A=L)})),A}));for(const S of x)y[S]=0;const v=n(e,i.sinks,e.nodeList()).toArray().reduce(((S,A)=>(S[A.getId()]=!0,S)),{}),b=u.map((S=>v[S]));return{nodes:u,edges:a.map((S=>({id:S.getId(),source:S.getSource().getId(),target:S.getTarget().getId()}))),decross:r,options:Gf(i),layoutable:h,radiuses:f,siblingIndexes:_,layers:y,sinks:b,coords:g}},context:as,update:function({nodes:t,edges:e,options:s,layoutable:n,radiuses:i,layers:r,siblingIndexes:o,decross:a,sinks:l,coords:u}){const h=e.filter((({source:p,target:y})=>p in n&&y in n)),g={nodes:t.map(((p,y)=>({id:p,radius:i[y],layer:r[y],siblingIndex:o[y],sink:l[y],layoutable:n[p],x:u[p].x,y:u[p].y}))),edges:h},{nodes:f}=X1(g,{packing:{fit:"fit",singleLine:"singleline",grid:"grid"}[s.arrangeComponents],direction:{TB:"down",BT:"up",RL:"left",LR:"right"}[s.direction],layerSeparation:s.layerSeparation,nodesSeparation:s.nodesSeparation,shouldDecross:s.decross,sortSiblings:o.length>0,componentsSeparation:s.componentsSeparation,nodesGridSeparation:s.nodesGridSeparation,evenDistribution:s.evenDistribution});return{positions:f}},isRunning:function(){return!1},onSync:function({positions:t},{graph:e}){return{indexes:t.map((({id:s})=>(e.getNode(s)||{_index:-1})._index)),x:t.map((({x:s})=>s)),y:t.map((({y:s})=>s))}}},lq=t=>(t.modules.layouts.register(cx),(e={})=>(e.useWebWorker=!1,t.modules.layouts.start(cx.name,e))),gx=(t,e)=>t-e,Z1={name:"radial",imports:{minHeap:Yf,bellmanFord:Hx,dijkstra:$x,johnson:my,distance:_n,circleCircleIntersection:Wx,circleSortCompare:Xx,weightedStress:v2,distanceStress:b2,constrainedStress:fy,stressMinimizationStep:py,removeRadialOverlap:yy,linear:Af,calculateRadii:OE},configure(t,{graph:e}){let s=t.nodes;const n=s.size;function i(L,M){return L!=null&&isFinite(L)?L:M}if(t.centralNode===void 0)throw new Error('radial layout: missing parameter "centralNode"');const r=e.getNode(t.centralNode);if(r===void 0)throw new Error('radial layout: parameter "centralNode" is not valid');t.radiusRatio=i(t.radiusRatio,Math.SQRT2),t.radiusDelta=i(t.radiusDelta,0),t.nodeGap=i(t.nodeGap,10),t.repulsion=n*i(t.repulsion,1);const o=r.getPosition(),a=i(t.centerX,o.x),l=i(t.centerY,o.y),u=r._index;s.includes(r)||(s=s.concat(r.toList()));let h=s._indexes;const g=s.getAttribute("layoutable");h=h.filter(((L,M)=>g[M]||L===u)),h.sort(gx);const f=h.length,p=uq(h,e.getConnectedComponents(s,{internalIndexes:!0}),u),y=e.degrees(h),_=new Float32Array(t.xs?t.xs:e.getNodeAttribute("x").getMultiple(h)),x=new Float32Array(t.ys?t.ys:e.getNodeAttribute("y").getMultiple(h)),v=t.rs?t.rs:e.getNodeAttribute("radius").getMultiple(h),b=e.getEdges()._indexes,S=e.getEdgeAttribute("source").getMultiple(b),A=e.getEdgeAttribute("target").getMultiple(b),w=e.getAdjacencyList({internalIndexes:!0,weight:1,indexes:h});return{centerIndex:u,centerIndexPos:0,cx:a,cy:l,D:null,indexes:h,components:p,normIndexes:null,radii:null,rings:null,x:_,y:x,degree:y,size:f,attributes:{size:v,adjacency:w,weights:A.map((()=>1)),sources:S,targets:A},sortAttr:null,allowOverlap:!!t.allowOverlap,nodeGap:t.nodeGap,radiusRatio:t.radiusRatio,radiusDelta:t.radiusDelta,repulsion:t.repulsion,randomize:!("randomize"in t)||!!t.randomize,renderSteps:!!t.renderSteps,epsilon:i(t.epsilon,.001),maxSteps:i(t.maxIterations,100),iterationsPerRender:i(t.iterationsPerRender,20),step:-1,stress:Number.POSITIVE_INFINITY,prevStress:0,converged:!1,overlapRemoved:!1,done:!1}},context:()=>({data:null,gridPlacement(t,e,s=8){const n=t.length,i=new Float32Array(n),r=new Float32Array(n);let o=0;for(let f=0,p=t.length;f<p;f++){const y=e[t[f]];y>o&&(o=y)}const a=o*s,l=Math.ceil(Math.sqrt(n)),u=Math.ceil(n/l),h=-Math.floor((u-1)*a/2),g=-Math.floor((l-1)*a/2);for(let f=0;f<l;f++)for(let p=0;p<u;p++)i[f*u+p]=h+p*a,r[f*u+p]=g+f*a;return{x:i,y:r}},connectComponents(t,e,s,n,i,r){let o;function a(l,u){const h=new Uint32Array(l.length+1);return h.set(l),h[l.length]=u,h}for(let l=1;l<t.length;l++){const u=t[l];let h=0,g=0;u.forEach(((y,_)=>{const x=i.get(y);x!=null&&x>h&&(g=_,h=x)})),o=u[g];const f=e[r.get(o)];f.weights=f.weights||[],f.nodes=a(f.nodes,s),f.weights.push(n);const p=e[r.get(s)];p.weights=p.weights||[],p.nodes=a(p.nodes,o),p.weights.push(n)}},correctSubgraphsDistances(t,e,s,n,i){const r=Array.prototype.reduce.call(t[s],((a,l,u)=>(u!==s&&l<n&&l>a&&(a=l),a)),0),o=n-r-1;for(let a=1;a<e.length;a++){const l=e[a];for(let u=0,h=l.length;u<h;u++){const g=i.get(l[u]);g!=null&&(t[s][g]-=o,t[g][s]-=o)}}},initialize(t,e){t.data=e,e.step=0;const s=new Map,n=new Map;e.normIndexes=e.indexes.reduce(((u,h,g)=>(u[g]=g,s.set(h,g),n.set(h,e.degree[g]),t.data&&h===e.centerIndex&&(t.data.centerIndexPos=g),u)),new Uint32Array(e.indexes.length));const i=e.centerIndexPos,r=e.components[0].length;t.connectComponents(e.components,e.attributes.adjacency,e.centerIndex,r,n,s);const o=my({sources:e.attributes.sources,targets:e.attributes.targets,weights:e.attributes.weights,indexes:e.indexes,adjacency:e.attributes.adjacency,undirected:!0});t.correctSubgraphsDistances(o,e.components,i,r,s),e.D=o;const a=o[i],l={};for(let u=0,h=e.normIndexes.length;u<h;u++)if(u!==i){const g=a[u];l[g]=l[g]||[],l[g].push(e.normIndexes[u])}e.rings=l,e.radii=OE(i,e.rings,e.attributes.size,e.nodeGap,e.radiusRatio,e.radiusDelta)},removeOverlaps(t,e){if(!t.data)return;const s=t.data.centerIndexPos,n=e.attributes.size,{rings:i,radii:r}=e,o=e.x[s],a=e.y[s];for(const l in i){const u=i[l];for(let h=0;h<u.length;h++){const g=u[h],f=r[l];let p=e.x[g]-o,y=e.y[g]-a;p+y===0&&(p=Math.sin(g)*Math.random()*.001,y=Math.cos(g)*Math.random()*.001);const _=Math.sqrt(p*p+y*y),x=f;if(_-x<0){const v=x/_;e.x[g]=o+p*v,e.y[g]=a+y*v}}}for(const l in i){const u=i[l],h=_n(o,a,e.x[u[0]],e.y[u[0]]);yy({X:e.x,Y:e.y,sizes:n,indexes:u,center:[o,a],R:h,gap:e.nodeGap,inPlace:!0})}}}),update(t,e){t||(t=e.data);const s=t.indexes,n=t.centerIndex;let i;t.x=t.x||new Float32Array(t.size),t.y=t.y||new Float32Array(t.size),t.step===-1&&e.initialize(e,t);const r=t.repulsion,o=a=>t.radii&&t.radii[a]||1;if(t.step===0&&t.randomize&&(i=e.gridPlacement(t.indexes,t.attributes.size),t.x=i.x,t.y=i.y),!t.converged){const a=t.maxSteps,l=t.iterationsPerRender;let u=t.step;const h=Math.min(u+l,a),{D:g,x:f,y:p,size:y,centerIndexPos:_,normIndexes:x}=t;for(;u<=h&&!t.converged;){const v=Af(Math.min(u,a)/a);t.step=u++,i=py(g,f,p,y,_,r,v,x,o),t.x=i.x,t.y=i.y,t.prevStress=t.stress,t.stress=fy(g,f,p,y,_,r,v,x),t.converged=t.converged||Math.abs(t.stress-t.prevStress)<=t.epsilon}}if(t.converged)if(t.overlapRemoved||t.allowOverlap){t.done=!0;const a=t.rings||{};t.rings=Object.keys(a).reduce(((l,u)=>(l[u]=a[u].map((h=>s[h])),l)),{})}else e.removeOverlaps(e,t,n),t.overlapRemoved=!0;return t},isRunning:({data:t})=>!(!t||t.converged&&(t.allowOverlap||t.done))||(t&&(t.step=-1),!1),onSync(t){if(t.renderSteps||t.done)return K1(t)},onEnd:t=>K1(t)};function K1(t){const e=t.x,s=t.y,n=t.indexes.length,i=e[t.centerIndexPos]-t.cx,r=s[t.centerIndexPos]-t.cy;for(let o=0;o<n;o++)e[o]-=i,s[o]-=r;return{indexes:t.indexes,x:e,y:s}}function uq(t,e,s){const n=t.slice().sort(gx),i=[];for(let r=0,o=e.length;r<o;r++){const a=[],l=e[r];let u=!1;for(let h=0,g=l.length;h<g;h++){const f=l[h];uT(n,f)!==-1&&(f===s&&(u=!0),a.push(f))}a.length!==0&&i[u?"unshift":"push"](a.sort(gx))}return i}var dq=t=>(t.modules.layouts.register(Z1),e=>{if(e.centralNode===void 0)throw new Error('concentric layout: missing parameter "centralNode"');if(e.maxIterations=e.maxIterations&&isFinite(e.maxIterations)?Math.floor(e.maxIterations):100,e.maxIterations<1)throw new RangeError("maxIterations must be a positive integer");if(e.iterationsPerRender=e.iterationsPerRender&&isFinite(e.iterationsPerRender)?Math.floor(e.iterationsPerRender):20,e.iterationsPerRender<1)throw new RangeError("iterationsPerRender must be a positive integer");if(e.epsilon=e.epsilon&&isFinite(e.epsilon)?e.epsilon:.001,e.epsilon<=0)throw new RangeError("epsilon has to be a positive number");return t.modules.layouts.start(Z1.name,e)}),Q1={...cx,name:"sequential"},hq=t=>(t.modules.layouts.register(Q1),(e={})=>{e.useWebWorker=!1;const s={...e,evenDistribution:!0};return t.modules.layouts.start(Q1.name,s)}),cq=class extends Ps{constructor(t){super(t),this.stop=()=>this._ogma.modules.layouts.stop(),this.concentric=gH(t),this.radial=dq(t),this.force=v$(t),this.forceLink=b$(t),this.hierarchical=lq(t),this.sequential=hq(t),this.grid=E$(t)}},gq=class extends Ps{constructor(){super(...arguments),this.move=t=>this._ogma.modules.virtualMouse.move(t),this.down=t=>this._ogma.modules.virtualMouse.down(t),this.up=t=>this._ogma.modules.virtualMouse.up(t),this.click=t=>this._ogma.modules.virtualMouse.click(t),this.rightClick=t=>this._ogma.modules.virtualMouse.rightClick(t),this.doubleclick=t=>this._ogma.modules.virtualMouse.doubleclick(t),this.drag=(t,e)=>this._ogma.modules.virtualMouse.drag(t,e),this.wheel=t=>this._ogma.modules.virtualMouse.wheel(t)}},fq=class extends Ps{constructor(){super(...arguments),this.map=t=>this._ogma.modules.rules.createMapping(t),this.slices=t=>this._ogma.modules.rules.createSlices(t),this.template=t=>this._ogma.modules.rules.createTemplate(t)}},pq=class extends Ps{constructor(){super(...arguments),this.watchNodeObjectProperty=t=>this._ogma.modules.watcher.watchNodeObjectProperty(t),this.watchEdgeObjectProperty=t=>this._ogma.modules.watcher.watchEdgeObjectProperty(t),this.watchNodeNonObjectProperty=t=>this._ogma.modules.watcher.watchNodeNonObjectProperty(t),this.watchEdgeNonObjectProperty=t=>this._ogma.modules.watcher.watchEdgeNonObjectProperty(t)}},mq=class{clearSelection(){return this.modules.selection.clear()}getSelectedNodes(){return this.modules.selection.getSelectedNodes()}getNonSelectedNodes(){return this.modules.selection.getNonSelectedNodes()}getSelectedEdges(){return this.modules.selection.getSelectedEdges()}getNonSelectedEdges(){return this.modules.selection.getNonSelectedEdges()}},_q=class{setOptions(t){return this.modules.settings.update(t)}getOptions(){return this.modules.settings.get()}},yq=class extends Ps{constructor(){super(...arguments),this.setNodesVisibility=t=>this._ogma.modules.graphics.setNodesVisibility(t),this.setEdgesVisibility=t=>this._ogma.modules.graphics.setEdgesVisibility(t),this.setNodeTextsVisibility=t=>this._ogma.modules.graphics.setNodeTextsVisibility(t),this.setEdgeTextsVisibility=t=>this._ogma.modules.graphics.setEdgeTextsVisibility(t),this.addRule=(t={})=>this._ogma.modules.styleRules.addRule(t),this.getRuleList=()=>this._ogma.modules.styleRules.getRuleList(),this.addNodeRule=(t,e)=>{let s,n;return e===void 0?(s=t,n=void 0):(s=e,n=t),this.addRule({nodeAttributes:s,nodeSelector:n})},this.addEdgeRule=(t,e)=>{let s,n;return e===void 0?(s=t,n=void 0):(s=e,n=t),this.addRule({edgeAttributes:s,edgeSelector:n})},this.getNodeRules=()=>this.getRuleList().filter((t=>t.getDefinition().edgeAttributes===void 0)),this.getEdgeRules=()=>this.getRuleList().filter((t=>t.getDefinition().nodeAttributes===void 0)),this.createClass=t=>this._ogma.modules.classes.createClass(t),this.getClass=t=>this._ogma.modules.classes.getClassByName(t),this.getClassList=()=>this._ogma.modules.classes.getClassList(),this.setHoveredNodeAttributes=(t,e)=>{this._ogma.modules.hover.updateNodeAttributes(t,e)},this.setHoveredEdgeAttributes=(t,e)=>{this._ogma.modules.hover.updateEdgeAttributes(t,e)},this.setHoveredEdgeExtremitiesAttributes=(t,e)=>this._ogma.modules.hover.setEdgeExtremitiesAttributes(t,!!e),this.setSelectedNodeAttributes=(t,e)=>this._ogma.modules.selection.setNodeAttributes(t,!!e),this.setSelectedEdgeAttributes=(t,e)=>this._ogma.modules.selection.setEdgeAttributes(t,!!e),this.setSelectedEdgeExtremitiesAttributes=(t,e)=>this._ogma.modules.selection.setEdgeExtremitiesAttributes(t,!!e),this.setDisabledNodeAttributes=(t,e)=>{this._ogma.modules.disabled.setDisabledNodeAttributes(t,e)},this.setDisabledEdgeAttributes=(t,e)=>{this._ogma.modules.disabled.setDisabledEdgeAttributes(t,e)},this.setTheme=({nodeAttributes:t,edgeAttributes:e,selectedNodeAttributes:s,selectedEdgeAttributes:n,selectedEdgeExtremitiesAttributes:i,hoveredNodeAttributes:r,hoveredEdgeAttributes:o,hoveredEdgeExtremitiesAttributes:a,disabledNodeAttributes:l,disabledEdgeAttributes:u})=>{this._ogma.modules.pulses.setTheme(t&&t.pulse||{},e&&e.pulse||{}),this._ogma.modules.graphics.getAttributesManager().setDefaultAttributes(t||{},e||{}),this.setSelectedNodeAttributes(s||{}),this.setSelectedEdgeAttributes(n||{}),this.setHoveredNodeAttributes(r||{}),this.setHoveredEdgeAttributes(o||{}),this.setHoveredEdgeExtremitiesAttributes(a||{}),this.setSelectedEdgeExtremitiesAttributes(i||{}),l!==void 0&&this.setDisabledNodeAttributes(l,!0),u!==void 0&&this.setDisabledEdgeAttributes(u,!0)},this.fontSizeToBadgeScale=jL}},xq=class extends Ps{constructor(){super(...arguments),this.set=(t,e)=>this._ogma.modules.brand.set(t,e),this.remove=()=>{this._ogma.modules.brand.remove()}}},vq=class extends Ps{constructor(){super(...arguments),this.enable=t=>(this._ogma.modules.connectNodes.enable(t),this),this.disable=()=>(this._ogma.modules.connectNodes.disable(),this),this.enabled=()=>this._ogma.modules.connectNodes.enabled()}},bq=class extends Ps{constructor(){super(...arguments),this.enable=t=>(this._ogma.modules.lasso.enable(t),this),this.disable=()=>(this._ogma.modules.lasso.disable(),this),this.enabled=()=>this._ogma.modules.lasso.enabled()}},Eq=class extends Ps{constructor(){super(...arguments),this.enable=t=>this._ogma.modules.legend.enable(t),this.disable=()=>this._ogma.modules.legend.disable(),this.enabled=()=>this._ogma.modules.legend.enabled(),this.getOptions=()=>this._ogma.modules.legend.getOptions(),this.export=t=>this._ogma.modules.legend.export(t)}},Sq=class extends Ps{constructor(){super(...arguments),this.enable=(t={})=>{this._ogma.modules.rectangleSelect.enable(t)},this.disable=()=>{this._ogma.modules.rectangleSelect.disable()},this.enabled=()=>this._ogma.modules.rectangleSelect.enabled()}},Aq=class extends Ps{constructor(){super(...arguments),this.enable=t=>{this._ogma.modules.resizing.enable(t)},this.disable=()=>{this._ogma.modules.resizing.disable()},this.enabled=()=>this._ogma.modules.resizing.enabled()}},wq=class extends Ps{constructor(){super(...arguments),this.enable=(t={})=>{this._ogma.modules.rewiring.enable(t)},this.disable=()=>{this._ogma.modules.rewiring.disable()},this.enabled=()=>this._ogma.modules.rewiring.enabled()}},Tq=class extends Ps{constructor(){super(...arguments),this.enable=(t={})=>{this._ogma.modules.snapping.enable(t)},this.disable=()=>{this._ogma.modules.snapping.disable()},this.enabled=()=>this._ogma.modules.snapping.enabled()}},Cq=class extends Ps{constructor(){super(...arguments),this.onNodeHover=(t,e={})=>{this._ogma.modules.tooltip.setHandler("hover.node",t,e)},this.onNodeClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.left.node",t,e)},this.onNodeRightClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.right.node",t,e)},this.onNodeDoubleClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("doubleclick.left.node",t,e)},this.onEdgeHover=(t,e={})=>{this._ogma.modules.tooltip.setHandler("hover.edge",t,e)},this.onEdgeClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.left.edge",t,e)},this.onEdgeRightClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.right.edge",t,e)},this.onEdgeDoubleClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("doubleclick.left.edge",t,e)},this.onBackgroundClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.left.background",t,e)},this.onBackgroundRightClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.right.background",t,e)},this.onBackgroundDoubleClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("doubleclick.left.background",t,e)},this.refresh=()=>this._ogma.modules.tooltip.refresh(),this.isShown=()=>this._ogma.modules.tooltip.isShown(),this.hide=()=>{this._ogma.modules.tooltip.hide()},this.show=(t,e)=>this._ogma.modules.tooltip.show(t,e)}},Lq=class extends Ps{constructor(t){super(t),this.lasso=new bq(t),this.connectNodes=new vq(t),this.legend=new Eq(t),this.rectangleSelect=new Sq(t),this.resize=new Aq(t),this.rewire=new wq(t),this.snapping=new Tq(t),this.tooltip=new Cq(t),this.brand=new xq(t)}},Nq=class extends Ps{constructor(t){super(t),this.getList=()=>this._ogma.modules.transformations.api.getList(),this.clear=()=>this._ogma.modules.transformations.api.clear().then((()=>{})),this.getById=e=>this._ogma.modules.transformations.api.getById(e),this.afterNextUpdate=()=>this._ogma.modules.transformations.afterNextUpdate(),this.onGroupsUpdated=e=>{this._ogma.modules.transformations.onGroupsUpdated(e)},this.layoutGroups=(e,s,n=!1)=>this._ogma.modules.transformations.api.layoutGroups(e,s,n),this.triggerGroupUpdated=e=>this._ogma.modules.transformations.triggerGroupUpdated(e),this.triggerGroupsUpdated=()=>this._ogma.modules.transformations.api.triggerGroupsUpdated()}addNodeGrouping(t){return this._ogma.modules.transformations.api.addNodeGrouping(t)}addNodeClustering(t){return this._ogma.modules.transformations.api.addNodeClustering(t)}addEdgeGrouping(t){return this._ogma.modules.transformations.api.addEdgeGrouping(t)}addDrillDown(t){return this._ogma.modules.transformations.api.addDrilldown(t)}addNodeFilter(t){return this._ogma.modules.transformations.api.addNodeFilter(t)}addEdgeFilter(t){return this._ogma.modules.transformations.api.addEdgeFilter(t)}getNodeFilters(){return this._ogma.modules.transformations.getNodeFilters()}getEdgeFilters(){return this._ogma.modules.transformations.getEdgeFilters()}addNeighborGeneration(t){return this._ogma.modules.transformations.api.addNeighborGeneration(t)}addNeighborMerging(t){return this._ogma.modules.transformations.api.addNeighborMerging(t)}addNodeCollapsing(t){return this._ogma.modules.transformations.api.addNodeCollapsing(t)}addGeoClustering(t){return this._ogma.modules.transformations.api.addGeoClustering(t)}addVirtualProperties(t){return this._ogma.modules.transformations.api.addVirtualProperties(t)}getXYR(t){return this._ogma.modules.transformations.getXYR(t)}expandGroup({node:t,computeSubNodesPosition:e,onExpand:s}){return this._ogma.modules.transformations.api.fishEyeExpand(t,s,e)}collapseGroup({node:t,onCollapse:e}){return this._ogma.modules.transformations.api.fishEyeCollapse(t,e)}},Mq=class extends Ps{constructor(){super(...arguments),this.setZoom=(t,e)=>this._ogma.modules.camera.setZoom(t,e),this.zoomIn=t=>this._ogma.geo.enabled()?this._ogma.modules.geo.zoomIn():this._ogma.modules.camera.zoomIn(t),this.zoomOut=t=>this._ogma.geo.enabled()?this._ogma.modules.geo.zoomOut():this._ogma.modules.camera.zoomOut(t),this.getZoom=()=>this._ogma.modules.camera.getZoom(),this.setCenter=(t,e)=>this._ogma.modules.camera.setCenter(t,e),this.move=(t,e)=>this._ogma.modules.camera.move(t,e),this.moveToBounds=(t,e)=>{if(!(t&&t instanceof ri)){if(!Nn(t)||t.length!==4)throw new Error("ogma.view.zoomToBounds requires a BoundingBox as a parameter");{const[s,n,i,r]=t;t=ri.from({minX:s,minY:n,maxX:i,maxY:r})}}return this._ogma.modules.camera.moveToBounds(t,e)},this.moveTo=(t,e)=>this._ogma.modules.camera.moveTo(t,e),this.getCenter=()=>this._ogma.modules.camera.getCenter(),this.setAngle=(t,e)=>this._ogma.modules.camera.setAngle(t,e),this.rotate=(t,e)=>this._ogma.modules.camera.rotate(t,e),this.getAngle=()=>this._ogma.modules.camera.getAngle(),this.set=(t,e)=>this._ogma.modules.camera.setView(t,e),this.get=()=>this._ogma.modules.camera.getView(),this.graphToScreenCoordinates=t=>this._ogma.modules.camera.graphToScreenCoordinates(t),this.screenToGraphCoordinates=t=>this._ogma.modules.camera.screenToGraphCoordinates(t),this.getImageData=()=>this._ogma.modules.graphics.getImageData(),this.getElementAt=t=>this._ogma.modules.captor.detectElementAt(t.x,t.y,!1,!0),this.getElementsInView=()=>{const{width:t,height:e}=this.get(),s=this.screenToGraphCoordinates({x:0,y:0}),n=this.screenToGraphCoordinates({x:t,y:e});return this._ogma.modules.spatial.query(s.x,s.y,n.x,n.y)},this.getBounds=()=>{const{width:t,height:e}=this.getSize(),s=this.screenToGraphCoordinates({x:0,y:0}),n=this.screenToGraphCoordinates({x:t,y:e});return{cx:(s.x+n.x)/2,cy:(s.y+n.y)/2,width:n.x-s.x,height:n.y-s.y,minX:s.x,minY:s.y,maxX:n.x,maxY:n.y}},this.getElementsInside=(t,e,s,n,i=!0)=>{const{spatial:r,camera:o}=this._ogma.modules;if(i){const a=o.graphToScreenCoordinates({x:t,y:e}),l=o.graphToScreenCoordinates({x:s,y:n});return r.queryProjected(a.x,a.y,l.x,l.y)}return r.queryProjected(t,e,s,n)},this.beforeNextFrame=()=>this._ogma.modules.dom.beforeNextFrame(),this.afterNextFrame=()=>this._ogma.modules.dom.afterNextFrame(),this.setFullScreen=t=>this._ogma.modules.dom.setFullScreen(t),this.isFullScreen=()=>this._ogma.modules.dom.isFullScreen(),this.forceResize=()=>this._ogma.modules.dom.forceResize(),this.getSize=()=>this._ogma.modules.dom.getDimensions(),this.setSize=t=>{if(!t||isNaN(t.width)||isNaN(t.height))throw new Error("Size must follow the format { width: number, height: number }");if(t.width<0)throw new Error("width must be positive");if(t.height<0)throw new Error("height must be positive");return this._ogma.modules.dom.setDimensions(t),Promise.resolve()},this.locateGraph=t=>this._ogma.modules.locate.locateGraph(t),this.locateRawGraph=(t,e)=>this._ogma.modules.locate.locateRawGraph(t,e),this.getGraphBoundingBox=({withTexts:t=!1}={})=>this._ogma.modules.locate.getGraphBoundingBox(t),this.animationInProgress=()=>this._ogma.modules.locate.isLocating()||this._ogma.modules.camera.animationInProgress(),this.getTextBoundingBox=t=>{if(!t)throw new Error("ogma.view.getTextBoundingBox: item must be a Node or an Edge");const e=t.getAttribute("text"),s=this._ogma.modules.labels;return e==null||e===""?null:t.isList?t.isNode?void s.getTextsBoundingBox(t):s.getTextsBoundingBox(void 0,t):t.isNode?s.getTextsBoundingBox(t.toList()):s.getTextsBoundingBox(void 0,t.toList())},this.getNodeBadgeAt=(t,e)=>{if(!t)throw new Error("ogma.view.getNodeBadgeAt: node is not defined");return PC(e,t._index,this._ogma.modules.graphics.getAttributesManager(),this._ogma.modules.camera,this._ogma.modules.graphics.getGraphicsEngine())}}},kq=class{constructor(t,e){this._ogma=t,this.settings=new X4(t),this.events=new q4(t),this.dom=new Iz(t),this.animations=new I5(t),this.camera=new I4(t),this.graph=new tD(t),this.data=new Pz(t),this.graphics=new B4(t),this.layers=new vj(t),this.individualAttributes=new W4(t),this.algorithms=new bj(t),this.position=new dj(t),this.touch=new b5(t),this.mouse=new x5(t),this.virtualMouse=new vG(t),this.spatial=new a5(t),this.captor=new eV(t),this.interactions=new YG(t),this.classes=new J4(t),this.cameraInteractions=new L4(t,!!e.debug),this.hover=new oj(t),this.disabled=new uj(t),this.keyboard=new bV(t),this.selection=new A5(t),this.styleRules=new wG(t),this.legend=new ij(t),this.sync=new w5(t),this.rules=new mj(t),this.transformations=new E5(t),this.locate=new p5(t),this.drag=new sV(t),this.pulses=new N5(t),this.curvatureManager=new X5(t),this.workers=new iG(t),this.layouts=new dG(t),this.watcher=new pG(t),this.rectangleSelect=new TG(t),this.labels=new qG(t,e),this.brand=new Y5(t),this.lasso=new ZN(t),this.rewiring=new iV(t),this.resizing=new rV(t),this.snapping=new bG(t),this.connectNodes=new aV(t),this.tooltip=new gV(t),this.geo=new W5(t),Object.keys(this).forEach((s=>{const n=this[s];n instanceof Xe&&(n._setModules(this),n.onMounted())})),t.onReady((()=>{Object.keys(this).forEach((s=>{const n=this[s];n instanceof Xe&&n.onReady(e)}))}))}destroy(){Object.keys(this).forEach((t=>{const e=this[t];e instanceof Xe&&e.destroy(this._ogma)}))}},Iq=1,Rq=[Aj,Sj,Nj,kP,uH,mq,Lj,_q],fx={version:"5.3.11",commit:"4f664632b",buildTime:"Tue Jan 27 2026 18:13:50 GMT+0000 (Coordinated Universal Time)"},Ci,Vl=(Ci=class{constructor(e={}){this.node=s=>new xi(s,this),this.edge=s=>new Ir(s,this),this.nodeList=s=>new uo(s||new Uint32Array(0),this),this.edgeList=s=>new Ya(s||new Uint32Array(0),this),this._onReady=[],this.build=fx,this._init(e)}_init(e){this._initParameters=e,this._debug=!!e.debug,this._token=Iq++,this.modules=new kq(this,e),this.styles=new yq(this),this.algorithms=new Ej(this),this.export=new I6(this),this.keyboard=new hH(this),this.generate=new aH(this),this.layouts=new cq(this),this.parse=new dH(this),this.transformations=new Nq(this),this.tools=new Lq(this),this.view=new Mq(this),this.mouse=new gq(this),this.events=new Mj(this),this.schema=new pq(this),this.rules=new fq(this),this.geo=new lH(this),this.layers=new cH(this),this.debug=new Cj(this),this._onReady.forEach((s=>s(this))),this.safelyBindToInstance(),this.modules.events.register(["destroy"]),this.build={version:"5.3.11",commit:"4f664632b",buildTime:"Tue Jan 27 2026 18:13:50 GMT+0000 (Coordinated Universal Time)"}}safelyBindToInstance(){for(const e of Object.getOwnPropertyNames(Ci.prototype))typeof Ci.prototype[e]=="function"&&(this[e]=this[e].bind(this))}onReady(e){this._onReady.push(e)}_destroy(){if(!this._token)throw new Error('"destroy" called twice on the same instance of Ogma');this._onReady=[],this.modules.destroy(),this.modules=null}destroy(){this.modules.events.fire("destroy",{}),this._destroy()}isDestroyed(){return!this.modules}reset(){const e=this._initParameters;this._destroy(),this._init(e)}isDebug(){return this._debug}},Ci.libraries=JT,Ci.geometry=mu,Ci.parse=F0,Ci.build=fx,Ci.algorithms=jx,Ci.utils=b0,Ci);Vl.algorithms=jx,Vl.utils=b0,Vl.parse=F0,Vl.build=fx,_F(Vl,Rq);var U0=Vl,Xn=(t=>(t.NodeFilter="node-filter",t.EdgeFilter="edge-filter",t.NodeCollapsing="node-collapsing",t.VirtualProperties="virtual-properties",t.NeighborGeneration="neighbor-generation",t.NeighborMerging="neighbor-merging",t.NodeGrouping="node-grouping",t.EdgeGrouping="edge-grouping",t.NodeClustering="node-clustering",t.GeoClustering="geo-clustering",t.Unknown="unknown",t))(Xn||{}),na=class{constructor({id:t,duration:e,easing:s,ogma:n,module:i}){this.animation=s?{duration:e,easing:s}:e===void 0?0:e,this.destroyed=!1,this.id=t,this.ogma=n,this.context={},this.module=i,this.resetContext()}setOptions(t){var e;let s=typeof this.animation=="number"?this.animation:(e=this.animation)==null?void 0:e.duration,n=typeof this.animation=="object"?this.animation.easing:void 0;return typeof t.duration=="number"&&(s=t.duration),t.easing!==void 0&&(n=t.easing),this.animation=n?{duration:s,easing:n}:s===void 0?0:s,this.module.setOptions(this),this.module.afterNextUpdate()}enable(t){return this.animation=t===void 0?this.animation:t,this.module.enable(this)}disable(t){return this.animation=t===void 0?this.animation:t,this.module.disable(this)}isEnabled(){return this.module.isEnabled(this)}getId(){return this.id}whenApplied(){return this.module.afterNextUpdate().then((()=>this))}toggle(t){return this.animation=t===void 0?this.animation:t,this.isEnabled()?this.module.disable(this):this.module.enable(this)}run(t=!0){return Promise.resolve()}undo(t=!0){return Promise.resolve()}cleanup(){return this.resetContext(),Promise.resolve()}refresh(){return this.module.refreshTransformation(this),this.module.afterNextUpdate()}getIndex(){return this.module.getIndex(this)}setIndex(t){return this.module.setIndex(this,t),this.module.afterNextUpdate()}getAnimation(){return typeof this.animation=="number"?{duration:this.animation,easing:"linear"}:this.animation}getContext(){return this.context}setContent(t){this.context=t}resetContext(){this.context={}}getName(){return Xn.Unknown}destroy(t){return t!==void 0&&(this.animation=t),this.module.remove(this)}},Fq=class{constructor(t){this.xs=new Map,this.ys=new Map,this.rs=new Map,this.curvatures=new Map,this.hiddenNodes=new Set,this.hiddenEdges=new Set,this.animations=[],this.before=[],this.after=[],this.applying=!1,this._onNodesRemoved=e=>{const s=e.nodes._indexes;for(const n of s)this.xs.delete(n),this.ys.delete(n),this.rs.delete(n)},this.ogma=t,this.afterMod={nodesToHide:new Set,edgesToHide:new Set},this.layer=this.ogma.modules.graphics.addAttributeLayer({name:"ogma-transformations-animations",priority:5.99999,nodeOutput:{attributes:["radius"]},edgeOutput:{attributes:["curvature"]},nodeDependencies:void 0,edgeDependencies:void 0}),this.attributeLayerData=this.layer._attributesManager._getLayerById(this.layer._id),this.initEvents()}initEvents(){this.ogma.events.on("removeNodes",this._onNodesRemoved)}apply(t){const e=Array.from(this.xs.values()),s=Array.from(this.ys.values()),n=Array.from(this.rs.values()).map((g=>({radius:g}))),i=Array.from(this.curvatures.values()).map((g=>({curvature:g}))),r=this.ogma.nodeList(Array.from(this.hiddenNodes)),o=this.ogma.edgeList(Array.from(this.hiddenEdges)),a=e.map(((g,f)=>({x:g,y:s[f]}))),l=this.ogma.nodeList(Array.from(this.xs.keys())),u=this.ogma.nodeList(Array.from(this.rs.keys())),h=this.ogma.edgeList(Array.from(this.curvatures.keys()));return this.xs.clear(),this.ys.clear(),this.rs.clear(),this.curvatures.clear(),this.hiddenNodes.clear(),this.hiddenEdges.clear(),this.before.forEach((g=>g())),this.initCurvature(h._indexes),this.applying=a.length>0||n.length>0||i.length>0,Promise.all([a.length?l.setAttributes(a,t):Promise.resolve(),n.length?this.ogma.modules.graphics.animate(u,(()=>this.layer.setAttributeValues(u,n)),!1,t):Promise.resolve(),i.length?this.ogma.modules.graphics.animate(h,(()=>this.layer.setAttributeValues(h,i)),!1,t):Promise.resolve(),...this.animations.map((g=>g()))]).then((()=>(this.ogma.nodeList(Array.from(this.afterMod.nodesToHide)).setVisible(!1),this.ogma.edgeList(Array.from(this.afterMod.edgesToHide)).setVisible(!1),Promise.all(this.after.map((g=>g())))))).then((()=>{this.deleteCurvatures(h._indexes),r.setVisible(!1),o.setVisible(!1),this.animations=[],this.before=[],this.after=[],this.afterMod.nodesToHide.clear(),this.afterMod.edgesToHide.clear(),this.applying=!1}))}setXYR(t,e,s,n){if(typeof t=="number")this.xs.set(t,e),this.ys.set(t,s),n!==void 0&&this.rs.set(t,n);else for(const i of t)this.xs.set(i,e),this.ys.set(i,s),n!==void 0&&this.rs.set(i,n)}getOpenRadius(t){return this.attributeLayerData.nodes.outputFlexArrays.radius.get(t)}getInputFlexArrays(){return this.attributeLayerData.nodes.inputFlexArrays}getCloseRadius(t){return this.attributeLayerData.nodes.inputFlexArrays.radius.get(t)}deleteOpenRadius(t){this.layer.getFlexArrays().nodes.radius.set(t,void 0)}initCurvature(t){const e=this.attributeLayerData.edges.inputFlexArrays.curvature,s=this.attributeLayerData.edges.outputFlexArrays.curvature;for(let n=0;n<t.length;n++)s.set(t[n],e.get(t[n]))}deleteCurvatures(t){const e=this.layer.getFlexArrays().edges.curvature;for(let s=0;s<t.length;s++)e.set(t[s],void 0)}hideNode(t){this.hiddenNodes.add(t)}showNode(t){this.hiddenNodes.delete(t)}hideNodes(t){for(const e of t)this.hiddenNodes.add(e)}showNodes(t){for(const e of t)this.hiddenNodes.delete(e)}hideEdge(t){this.hiddenEdges.add(t)}showEdge(t){this.hiddenEdges.delete(t)}hideEdges(t){for(const e of t)this.hiddenEdges.add(e)}showEdges(t){for(const e of t)this.hiddenEdges.delete(e)}pushBefore(t){Array.isArray(t)?this.before.push(...t):this.before.push(t)}pushAfter(t){Array.isArray(t)?this.after.push(...t):this.after.push(t)}setXY(t,e,s){this.xs.set(t,e),this.ys.set(t,s)}getXYR(t){const e=this.xs,s=this.ys,n=this.rs,i=t.getAttributes(["x","y","radius"]);for(let r=0;r<t.size;r++){const o=t._indexes[r];e.has(o)&&(i[r].x=e.get(o)),s.has(o)&&(i[r].y=s.get(o)),n.has(o)&&(i[r].radius=n.get(o))}return i}getXs(t){return this.getMapValues(t,"x",this.xs)}getYs(t){return this.getMapValues(t,"y",this.ys)}getRs(t){return this.getMapValues(t,"radius",this.rs)}getMapValues(t,e,s){const n=this.ogma.modules.graphics.getAttributesManager()._layerController.nodes._currentFlexArrays[e],i=new Array(t.size);for(let r=0;r<t.size;r++){const o=t._indexes[r];s.has(o)?i[r]=s.get(o):i[r]=n.get(o)}return i}setR(t,e){this.rs.set(t,e)}setRs(t,e){for(let s=0;s<t.length;s++)e[s]!==void 0&&this.rs.set(t[s],e[s])}setCurvatures(t,e){for(let s=0;s<t.length;s++)this.curvatures.set(t[s],e[s])}setCurvature(t,e){this.curvatures.set(t,e)}hideNodesAfter(t){for(let e=0;e<t.length;e++)this.afterMod.nodesToHide.add(t[e])}hideEdgesAfter(t){for(let e=0;e<t.length;e++)this.afterMod.edgesToHide.add(t[e])}setOpenRadius(t,e){this.attributeLayerData.nodes.outputFlexArrays.radius.set(t,e)}push(t){Array.isArray(t)?this.animations.push(...t):this.animations.push(t)}getMaxAnimation(t,e){return(typeof t=="number"?t:t.duration)>(typeof e=="number"?e:e.duration)?t:e}isApplying(){return this.applying}};function Ia(t,e,s){const n=typeof e=="string"?e.split("."):e;for(let i=0;i<n.length-1;++i){const r=n[i];let o=t[r];o||(o={},t[r]=o),t=o}t[n[n.length-1]]=s}function Pq(t){let e=0,s=0;const n=t.length;if(n===0)throw new Error("Ogma transformations: Compute centroid: at least one point is required");for(let i=0;i<n;++i){const r=t[i];e+=r.x,s+=r.y}return e/=n,s/=n,{x:e,y:s}}function zq(t,e){const s=t.get(0);return{data:s.getData(),attributes:s.getAttributes(e)}}function Mf(t,e){return`gen_grp_${e}_${t}`}function Dq(t){return t.map((({id:e,source:s,target:n})=>({id:e,source:s,target:n})))}function Oq(t,e,s,n){let i=e,r=s;return!n&&i.toString()>r.toString()&&(i=s,r=e),`${t}[${i}-${r}]`}function Bq(t){if(t===void 0)return Math.round(Math.random()*Number.MAX_SAFE_INTEGER);if(typeof t!="string"&&(typeof t!="number"||!isFinite(t)))throw new Error(`Ogma transformation: ${t} is not a valid id, expected string or number`);return t}function Mg(t){return`data.${t}`}var Uq=class{constructor(t){this.groupsByDepth=new Map,this.treeMap=new Map,this.dataMap=new Map,this.invalidEdges=new Map,this.edges=new Map,this.ogma=t.ogma,this.module=t.module,this.enabled=t.enabled===void 0||t.enabled,this.onGetSubgraph=t.onGetSubgraph,this.duration=t.duration||0,this.easing=t.easing||"quadraticOut",this.parentPath=t.parentPath||"parent",this.depthPath=t.depthPath||"depth",this.padding=t.padding||0,this.nodeGenerator=t.nodeGenerator||(()=>({})),this.showContents=t.showContents===void 0||t.showContents,this.onGroupUpdate=t.onGroupUpdate||(()=>{}),this.copyData=t.copyData===void 0||t.copyData,this.context={virtualEdges:this.ogma.edgeList()}}createGrouping(t){var e;const{ogma:s,groupsByDepth:n}=this,i=s.transformations.addNodeGrouping({selector:o=>o.getData(this.depthPath)===t,groupIdFunction:o=>o.getData(this.parentPath),showContents:o=>typeof this.showContents=="boolean"?this.showContents:this.showContents(o,t),onBeforeAddMetaEdges:(o,a)=>this.addEdges(o,a),onGroupUpdate:(o,a,l)=>this.onGroupUpdate(o,a,l,t),padding:o=>typeof this.padding=="number"?this.padding:this.padding(o,t),duration:this.duration,enabled:this.enabled,nodeGenerator:(o,a)=>{const l=this.nodeGenerator(o,a,i);return this.copyData&&(l.data||(l.data={}),l.data={...l.data,...this.dataMap.get(a)}),Ia(l,Mg(this.parentPath),this.treeMap.get(a)),Ia(l,Mg(this.depthPath),t-1),l.id=a,l}});if(!n.size)return n.set(t,i);const r=Array.from(n.keys()).reduce(((o,a)=>Math.max(o,a)));n.set(t,i),i.setIndex((e=n.get(r))==null?void 0:e.getIndex())}async drill(t){if(this.treeMap.has(t.getId()))return;const{ogma:e,groupsByDepth:s}=this;try{e.modules.graphics.pauseRendering();const n=t.getId(),i=this.getGroupId(n);this.treeMap.set(i,t.getData(this.parentPath)),this.dataMap.set(i,t.getData());const r=t.getData(this.depthPath)||0,o=t.getPosition(),a=await this.onGetSubgraph(t);this.edges.set(i,t.getAdjacentEdges().map((u=>{const h=u.getSource().getId(),g=u.getTarget().getId();return{source:h===n?i:h,target:g===n?i:g,data:{...u.getData()}}}))),a.nodes.forEach((u=>{Ia(u,Mg(this.parentPath),i),Ia(u,Mg(this.depthPath),r+1),u.attributes||(u.attributes={}),u.attributes.x=o.x,u.attributes.y=o.y})),this.module.pause(),e.removeEdges(t.getAdjacentEdges()),e.removeNode(t),await e.view.afterNextFrame(),await e.addNodes(a.nodes);const l=a.edges.filter((u=>{const h=u.source,g=u.target;if(e.getNode(h)&&e.getNode(g))return!0;const f=e.getNode(h)?g:h;return this.invalidEdges.has(f)?this.invalidEdges.get(f).push(u):this.invalidEdges.set(f,[u]),!1}));a.nodes.forEach((u=>{if(!this.invalidEdges.has(u.id))return;const{valid:h,invalid:g}=this.invalidEdges.get(u.id).reduce(((f,p)=>(e.getNode(p.source)&&e.getNode(p.target)?f.valid.push(p):f.invalid.push(p),f)),{valid:[],invalid:[]});e.addEdges(h),g.length?this.invalidEdges.set(u.id,g):this.invalidEdges.delete(u.id)})),await e.addEdges(l),s.has(r+1)||this.createGrouping(r+1),this.module.resume(),e.modules.graphics.resumeRendering(),await this.module.afterNextUpdate()}catch(n){throw e.modules.graphics.resumeRendering(),n}}async addEdges(t,e){e.forEach((s=>{const n=this.edges.get(s.getId());n&&this.ogma.addEdges(n,{virtual:!0}).then((i=>{this.context.virtualEdges=this.context.virtualEdges.concat(i)}))}))}getGroupId(t){return`ogma-group-${t}`}getMaxDepth(){return this.groupsByDepth.size}disable(t){return this.enabled=!1,this.duration=typeof t=="number"?t:this.duration,this.easing=typeof t=="object"?t.easing:this.easing,this.groupsByDepth.forEach((e=>e.disable(t))),this.module.animations.hideEdges(this.context.virtualEdges._indexes),this.context.virtualEdges.setSelected(!0),this.module.afterNextUpdate()}enable(t){return this.enabled=!0,this.duration=typeof t=="number"?t:this.duration,this.easing=typeof t=="object"?t.easing:this.easing,this.groupsByDepth.forEach((e=>e.enable(t))),this.module.animations.showEdges(this.context.virtualEdges._indexes),this.module.afterNextUpdate().then((()=>this.context.virtualEdges.setVisible(!0)))}toggle(t){return this.enabled?this.disable(t):this.enable(t)}setOptions(t){this.onGetSubgraph=t.onGetSubgraph?t.onGetSubgraph:this.onGetSubgraph,this.duration=t.duration!==void 0?t.duration:this.duration,this.easing=t.easing||this.easing,this.parentPath=t.parentPath||this.parentPath,this.depthPath=t.depthPath||this.depthPath,this.padding=t.padding!==void 0?t.padding:this.padding,this.nodeGenerator=t.nodeGenerator||this.nodeGenerator,this.showContents=t.showContents!==void 0?t.showContents:this.showContents,this.onGroupUpdate=t.onGroupUpdate||this.onGroupUpdate,this.copyData=t.copyData!==void 0?t.copyData:this.copyData;const e=this.enabled;return this.enabled=t.enabled!==void 0?t.enabled:this.enabled,this.enabled!==e&&this.groupsByDepth.forEach((s=>this.enabled?s.enable({duration:this.duration,easing:this.easing}):s.disable({duration:this.duration,easing:this.easing}))),this.groupsByDepth.forEach((s=>s.refresh())),this.module.afterNextUpdate()}destroy(){return this.groupsByDepth.forEach((t=>t.destroy())),this.module.afterNextUpdate().then((()=>{this.treeMap.clear(),this.dataMap.clear(),this.invalidEdges.clear(),this.edges.clear(),this.context.virtualEdges=this.ogma.edgeList()}))}onRemove(t){this.context.virtualEdges=this.context.virtualEdges.filter((e=>!t.has(e._index)))}},Gq=class{constructor(t){this.drilldowns=[],this.module=t}addDrilldown(t){this.drilldowns.push(t)}removeDrilldown(t){this.drilldowns=this.drilldowns.filter((e=>e!==t))}onRemove(t,e){e||this.drilldowns.forEach((s=>s.onRemove(t)))}},zM=2;function Vq(t){return typeof t.then=="function"}var jq=class{constructor(t,e){this.relayouted=new Set,this.shouldRelayout=new Set,this.layoutPerGroup=new Map,this.nextLayout=new Map,this.nextOnGroupUpdate=null,this.onGroupsUpdate=()=>null,this._onLayoutPrepare=s=>{if(!s.params.nodes)return;const n=s.params.nodes,i=Array.isArray(n)?this.ogma.getNode(n[0])._index:n._indexes[0],r=this.module.nodeToMeta.get(i);if(!r)return;const o={...s,params:{...s.params}};delete o.params.nodes,delete o.params.groups,this.layoutPerGroup.set(r._index,o)},this.ogma=t,this.module=e,this.ogma.events.on("layoutPrepare",this._onLayoutPrepare)}getNodesToRecompute(t){const e=Array.from(t),s=new Set,n=[];for(;e.length>0;){const i=e.shift();if(s.has(i))continue;n.push(i),s.add(i);const r=this.module.nodeToMeta.get(i);r&&e.push(r._index)}return this.ogma.nodeList(n)}getLayoutFunction(t,e,s,n){const i=this.getNextLayout(e._index),r=this.ogma.modules.graphics.getAttributesManager()._layerController.nodes._currentFlexArrays,o={x:r.x.get(e._index),y:r.y.get(e._index)};return()=>{const a=i?i(e,s,n):t(e,s,n);return this._runLayout(a,s,o)}}_runLayout(t,e,s){let n;if(!t)return Promise.resolve(null);if(Vq(t))n=t;else{if(!t)return;{const o=this.module.animations.getXs(e),a=this.module.animations.getYs(e),l=this.module.animations.getRs(e);n=this.ogma.layouts[t.layout]({...t.params,nodes:e,dryRun:!0,xs:o,ys:a,rs:l}).then((u=>u.positions.current))}}const i=this.module.animations,r=e._indexes;return n.then((o=>{if(!o)throw new Error("Ogma tansformations, onGroupUpdated callback should return either a layout or a promise containing  positions");let a=0,l=0;if(s){let u=-1/0,h=-1/0,g=1/0,f=1/0;for(let p=0;p<r.length;p++){const y=o[p];y&&(u=Math.max(u,y.x),h=Math.max(h,y.y),g=Math.min(g,y.x),f=Math.min(f,y.y))}a=s.x-(u+g)/2,l=s.y-(h+f)/2}for(let u=0;u<r.length;u++){const h=o[u];h&&(i.xs.set(r[u],h.x+a),i.ys.set(r[u],h.y+l))}}))}handleLayoutFunctions(t){const e=!!this.ogma.modules.layouts.enableBatching;e&&this.ogma.modules.layouts.enableBatching();const s=t.map((i=>i())),n=e?this.ogma.modules.layouts.runBatch():Promise.resolve();return Promise.all(s).then((()=>n))}async handleGlobalLayout(t,e){const s=this.getNextOnGroupUpdate(),n=s?s(t,e):this.onGroupsUpdate(t,e);await this._runLayout(n,t)}async layoutGroups(t,e,s=!1){const n=new Map,i=this.ogma.getNodes(t.map((({groupId:a})=>a)));t.forEach(((a,l)=>{n.set(a.groupId,(()=>this._runLayout(a,this.module.metaToNodes.get(i.get(l)._index))))}));const r=this.getNodesToRecompute(i._indexes),o=new Map;r.forEach((a=>o.set(a._index,this.module.nodeToTransformation.get(a._index).getIndex()))),r.sort(((a,l)=>o.get(a._index)-o.get(l._index)));for(let a=0;a<r.size;a++){const l=o.get(r._indexes[a]);let u;for(u=a+1;u<r.size&&o.get(r._indexes[u])===l;u++);const h=r.slice(a,u);a=u-1,await Promise.all(h.map((g=>{this.relayouted.add(g._index);let f=Promise.resolve();if(n.has(g.getId()))f=n.get(g.getId())();else if(s&&this.layoutPerGroup.has(g._index)){const p=this.module.metaToNodes.get(g._index),y=this.layoutPerGroup.get(g._index);f=this.ogma.layouts[y.name]({...y.params,nodes:p})}return f.then((()=>{this.module.groupController.setGroupXYR(g)}))})))}return await this.module.groupController.onAfterLayouts(),this.module.animations.apply(e||0).finally((()=>{this.relayouted.clear()}))}setNextLayout(t,e){this.nextLayout.set(t,e)}getNextLayout(t){const e=this.nextLayout.get(t);return this.nextLayout.delete(t),e}setNextOnGroupUpdate(t){this.nextOnGroupUpdate=t}getNextOnGroupUpdate(){const t=this.nextOnGroupUpdate;return this.nextOnGroupUpdate=null,t}hasRelayouted(t){return this.relayouted.has(t)}clear(){this.relayouted.clear(),this.shouldRelayout.clear()}},kg=14,Hq=class{constructor(t,e){this.subNodeOffsetX=new Map,this.subNodeOffsetY=new Map,this.openRadius=new Map,this.isExpanding=new Set,this.alreadyGrouped=new Set,this.openGroups=new Set,this.closeGroups=new Set,this.fadedGroups=new Set,this.nodeGroupinCount=0,this.destroyed=!1,this.nodeLayer=new Map,this.edgeLayer=new Map,this.savedNodeLayer=new Map,this.savedEdgeLayer=new Map,this.padding=new Map,this.geoRadius=new Map,this.collapsedGroups=new Set,this.hasUpdated=new Set,this.shouldRunGroupUpdate=!1,this.runningLayouts=!1,this.onSetMultipleAttributes=({elements:n,values:i,options:r,updatedAttributes:o,promises:a})=>{if(this.module.isRefreshing()||this.destroyed||this.runningLayouts||this.module.animations.isApplying())return;const l=new Set(o),u=i;if(!n.isNode||!l.has("x")&&!l.has("y")&&!l.has("radius"))return Promise.resolve();const h=n.toList();if(!h.size)return Promise.resolve();const g=[],f=new Set,p=Array.from(h._indexes);for(;p.length;){const _=p.shift(),x=this.module.nodeToMeta.get(_);if(!x||f.has(x._index))continue;const v=this.getGroupXYR(x,this.module.getSubNodes(x),h,u);v.isGeo?g.push(x.setAttribute("radius",v.radius,r)):(delete v.isGeo,this.closeGroups.has(x._index)||this.collapsedGroups.has(x._index)?(this.openRadius.set(x._index,v.radius),this.module.animations.setXY(x._index,v.x,v.y)):this.module.animations.setXYR(x._index,v.x,v.y,v.radius),f.add(x._index)),p.push(x._index)}const y=h.map(((_,x)=>{if(!this.openGroups.has(_._index))return null;const v=_.getPosition();return Array.isArray(u)&&u[x]?(u[x].x!==void 0&&(v.x=u[x].x),u[x].y!==void 0&&(v.y=u[x].y)):(u.x!==void 0&&(v.x=u.x),u.y!==void 0&&(v.y=u.y)),{group:_,position:v}})).filter((_=>_));y.length&&y.forEach((({group:_,position:x})=>this.animateChildren(_,x))),(f.size>0||y.length)&&g.push(this.module.animations.apply(r)),a.push(...g)},this.ogma=t,this.layoutController=new jq(t,e),this.groupLayer=this.ogma.modules.graphics.addAttributeLayer({name:"groups-layer",priority:5.98,edgeAttributes:{layer:n=>this.edgeLayer.get(n._index)},nodeAttributes:{layer:n=>this.nodeLayer.get(n._index)},nodeDependencies:void 0,edgeDependencies:void 0});const s=t.styles.getClass("_group-fading_");this.fadingClass=s||this.ogma.styles.createClass({name:"_group-fading_",nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0}}),this.module=e,t.events.on("setMultipleAttributes",this.onSetMultipleAttributes).on("beforeGeoCameraMove",(({zoom:n})=>{const i=this.ogma.nodeList(Array.from(this.geoRadius.keys())).filter((r=>r&&!this.collapsedGroups.has(r._index)&&this.openGroups.has(r._index)));i.forEach((r=>{const o=this.geoRadius.get(r._index)*2**n;this.module.animations.setOpenRadius(r._index,o)})),this.ogma.modules.geo._projection&&this.ogma.modules.geo._projection.updateElements(i)})).on(["geoEnabled","beforeGeoDisabled"],(()=>this._onToggleGeo())).on("geoNodesMoved",(({nodes:n})=>{const i=n._indexes;for(let r=0;r<i.length;r++){const o=this.module.getMetaNode(n.get(r));!o||!this.openGroups.has(o._index)||this.layoutController.shouldRelayout.add(o._index)}}))}setSubEltsLayer(t,e,s){const n=s?zM:-2;if(!this.isOpen(t))return;const i=this.module.getSubNodes(t);i.forEach((o=>{this.nodeLayer.set(o._index,e+n),this.setSubEltsLayer(o,e+n,s)}));const r=i.getAdjacentEdges({bothExtremities:!0});for(let o=0;o<r.size;o++)this.edgeLayer.set(r._indexes[o],e+n)}setNodeGroupingCount(t){this.nodeGroupinCount=t}getNodeGroupingCount(){return this.nodeGroupinCount}updateGroupLayer(t,e){this.groupLayer.updateElements(t||this.ogma.getNodes()),this.groupLayer.updateElements(e||this.ogma.getEdges())}closeGroup(t,e,s,n,i=!1){const r=[e],o=this.closeGroups.has(t._index)||this.collapsedGroups.has(t._index);this.openGroups.delete(t._index),this.closeGroups.add(t._index),i?this.fadedGroups.add(t._index):this.fadedGroups.delete(t._index),this.hasUpdated.add(t._index);const a=this.module.animations,l=i?0:a.getCloseRadius(t._index),u=a.getOpenRadius(t._index);if(u!==void 0&&!o&&this.openRadius.set(t._index,u),a.setXYR(t._index,s,n,l),i)return;for(;r.length;){const g=r.shift(),f=g._indexes,p=g.getAdjacentEdges({bothExtremities:!0}),y=new Set;for(let x=0;x<p._indexes.length;x++)y.add(p._indexes[x]);const _=g.getAdjacentEdges({bothExtremities:!1}).filter((x=>!y.has(x._index)));a.setXYR(f,s,n,l),a.hideNodesAfter(f),a.hideEdgesAfter(p._indexes),a.hideEdgesAfter(_._indexes),a.pushAfter((()=>{const x=[];a.deleteOpenRadius(t._index);for(let v=0;v<f.length;v++){const b=this.closeGroups.has(f[v]);x.push(b?l:this.openRadius.get(f[v]))}this.module.animations.setRs(g._indexes,x)}));for(let x=0;x<f.length;x++){if(!this.openGroups.has(f[x]))continue;const v=g.get(x);this.collapsedGroups.add(v._index);const b=this.module.getSubNodes(g.get(x));b.size&&r.push(b)}}const h=this.module.getMetaNode(t);h&&this.openGroups.has(h._index)&&this.layoutController.shouldRelayout.add(h._index)}setGroupXYR(t){const e=this.getGroupXYR(t,this.module.getSubNodes(t),void 0,void 0);e.isGeo?(this.setGeoLatLng(t,e.y,e.x),this.module.animations.setR(t._index,e.radius)):this.module.animations.setXYR(t._index,e.x,e.y,e.radius)}setGeoLatLng(t,e,s){this.ogma.modules.data.setProperty(t,this.ogma.modules.geo.latitudePath,e,{virtual:!0}),this.ogma.modules.data.setProperty(t,this.ogma.modules.geo.longitudePath,s,{virtual:!0})}expandGroup(t,e,s=!1){const n=this.module.animations,i=t.getPosition(),r=this.fadedGroups.has(t._index);s?this.fadedGroups.add(t._index):(this.fadedGroups.delete(t._index),this.openGroups.add(t._index),this.closeGroups.delete(t._index),this.collapsedGroups.delete(t._index)),this.isExpanding.add(t._index),this.hasUpdated.add(t._index);const o=[{subNodes:e,offset:this.getOffset(t._index),isClosed:!1,wasCollapsed:!r}];for(;o.length;){const{subNodes:l,offset:u,isClosed:h,wasCollapsed:g}=o.shift();if((h||g)&&n.pushBefore((()=>l.setAttributes(i,0))),h)continue;const f=l._indexes,p=l.getAdjacentEdges({bothExtremities:!0,filter:"all"});l.setVisible(!0),p.setVisible(!0);for(let y=0;y<f.length;y++){const _=this.closeGroups.has(f[y]);n.setXYR(f[y],i.x+u.x+this.subNodeOffsetX.get(f[y])||0,i.y+u.y+this.subNodeOffsetY.get(f[y])||0,_?this.module.animations.getCloseRadius(f[y]):this.openRadius.get(f[y])),this.collapsedGroups.delete(f[y]);const x=this.module.getSubNodes(l.get(y));x.size&&o.push({subNodes:x,isClosed:_,wasCollapsed:g||this.collapsedGroups.has(f[y]),offset:{x:u.x+this.subNodeOffsetX.get(f[y])||0,y:u.y+this.subNodeOffsetY.get(f[y])||0}})}}const a=this.module.getMetaNode(t);a&&this.openGroups.has(a._index)&&this.layoutController.shouldRelayout.add(a._index),n.setXYR(t._index,i.x,i.y,s?0:this.openRadius.get(t._index))}getOffset(t){return this.collapsedGroups.has(t)&&this.subNodeOffsetX.has(t)?{x:this.subNodeOffsetX.get(t),y:this.subNodeOffsetY.get(t)}:{x:0,y:0}}restorePositions(t,e){const s=t.getPosition(),n=(e=e.filter((o=>!o.isVirtual())))._indexes,i=this.getOffset(t._index),r=[];for(let o=0;o<n.length;o++)r.push({x:i.x+s.x+this.subNodeOffsetX.get(n[o])||0,y:i.x+s.y+this.subNodeOffsetY.get(n[o])||0});e.setAttributes(r,0)}animateChildren(t,e){const s=[{parent:t,position:e}];for(;s.length;){const{parent:n,position:i}=s.shift();if(!n.isNode)continue;const r=this.module.getSubNodes(n);r.size&&r.forEach((o=>{const a=this.subNodeOffsetX.get(o._index)||0,l=this.subNodeOffsetY.get(o._index)||0,u={x:i.x+a,y:i.y+l};this.module.animations.setXY(o._index,u.x,u.y),s.push({parent:o,position:u})}))}}addOpenGroup(t){this.openGroups.add(t._index),this.closeGroups.delete(t._index)}isOpen(t){return this.openGroups.has(t._index)}isClose(t){return this.closeGroups.has(t._index)}setPadding(t,e){const s=new Set,n=isNaN(+e),i=e;return t.forEach((r=>{const o=n?i(r):+e;this.padding.get(r._index)!==o&&s.add(r._index),this.padding.set(r._index,o)})),s}getGroupXYR(t,e,s,n){let i,r,o;const a=this.module.animations,l=this.ogma.geo.enabled();if(i=new Array(e.size).fill(0),r=new Array(e.size).fill(0),o=new Array(e.size).fill(0),l){const y=e.getData(this.ogma.modules.geo.latitudePath),_=e.getData(this.ogma.modules.geo.longitudePath);i=[],r=[],o=[];for(let x=0;x<y.length;x++){const{x:v,y:b}=this.ogma.geo.getMap().project({lat:y[x],lng:_[x]},kg);i.push(v),r.push(b),o.push(2**kg*this.geoRadius.get(e._indexes[x])||10)}}else{const y=this.ogma.modules.graphics.getAttributesManager()._layerController.nodes._currentFlexArrays,_=this.openGroups.has(t._index),x=this.isExpanding.has(t._index),v=_&&!x?y.radius:a.getInputFlexArrays().radius;for(let b=0;b<e.size;b++)i[b]=y.x.get(e._indexes[b]),r[b]=y.y.get(e._indexes[b]),o[b]=v.get(e._indexes[b])}if(s&&n&&s.isNode){const y=s._indexes,_=new Map,x=new Map,v=new Map;for(let S=0;S<y.length;S++){const A=Array.isArray(n)?n[S]:n;!isNaN(A.x)&&_.set(y[S],A.x),!isNaN(A.y)&&x.set(y[S],A.y),!isNaN(A.radius)&&v.set(y[S],A.radius)}const b=e._indexes;for(let S=0;S<b.length;S++)_.has(b[S])&&(i[S]=_.get(b[S])),x.has(b[S])&&(r[S]=x.get(b[S])),v.has(b[S])&&(o[S]=v.get(b[S]))}const u=e._indexes;for(let y=0;y<u.length;y++)!this.closeGroups.has(u[y])&&!this.collapsedGroups.has(u[y])&&this.openRadius.has(u[y])&&(o[y]=this.openRadius.get(u[y]));if(!l)for(let y=0;y<u.length;y++)a.xs.get(u[y])!==void 0&&(i[y]=a.xs.get(u[y])),a.ys.get(u[y])!==void 0&&(r[y]=a.ys.get(u[y])),a.rs.get(u[y])!==void 0&&(o[y]=a.rs.get(u[y]));let h=0,g=0,f=0;const p=U0.algorithms.minDisk(i,r,o);if(h=p[0],g=p[1],f=p[2],f+=this.padding.get(t._index)||0,l){const{lat:y,lng:_}=this.ogma.geo.getMap().unproject({x:h,y:g},kg);h=_,g=y,f/=2**kg,this.geoRadius.set(t._index,f),f*=2**this.ogma.geo.getZoom()}else this.openRadius.set(t._index,f),e.forEach(((y,_)=>{this.subNodeOffsetX.set(y._index,i[_]-h),this.subNodeOffsetY.set(y._index,r[_]-g)}));return{x:h,y:g,radius:f,isGeo:l}}async onAfterLayouts(){const t=this.module.animations,e=this.module.getList().filter((r=>r.getName()===Xn.NodeGrouping&&r.isEnabled())),s=[];let n=!1;for(let r=e.length-1;r>=0;r--)e[r].getContext().metaNodes.forEach((o=>{if(o.getMetaNode())return;n||(n=this.hasUpdated.has(o._index)||this.layoutController.relayouted.has(o._index)||this.layoutController.shouldRelayout.has(o._index));const a=!this.collapsedGroups.has(o._index)&&!this.closeGroups.has(o._index);s.push({group:o,collapsed:!a})}));if(n||this.shouldRunGroupUpdate){this.shouldRunGroupUpdate=!1;const r=this.ogma.getNodes().filter((a=>{const l=this.module.getMetaNode(a);return!l||!this.module.nodeToTransformation.get(l._index).isEnabled()})),o=new Array(r.size);for(let a=0;a<r.size;a++)o[a]=this.openRadius.get(r._indexes[a])||this.module.animations.getCloseRadius(r._indexes[a])||0;await this.layoutController.handleGlobalLayout(r,o)}const i=new Set;for(;s.length;){const{group:r,collapsed:o}=s.shift();if(i.has(r._index))continue;i.add(r._index);const a=this.module.getSubNodes(r),l=a._indexes,u=t.xs.get(r._index),h=t.ys.get(r._index);if(u!==void 0&&h!==void 0){if(o){t.deleteOpenRadius(r._index);for(let g=0;g<l.length;g++)t.setXY(l[g],u,h)}else for(let g=0;g<l.length;g++)t.setXY(l[g],u+this.subNodeOffsetX.get(l[g])||0,h+this.subNodeOffsetY.get(l[g])||0);for(let g=0;g<l.length;g++)this.module.isVirtual(l[g],!0)&&s.push({group:a.get(g),collapsed:this.collapsedGroups.has(l[g])||this.closeGroups.has(l[g])||o})}}this.hasUpdated.clear(),this.layoutController.clear(),this.isExpanding.clear()}cleanup(t,e,s){let n=t._indexes;for(let i=0;i<n.length;i++)this.padding.delete(n[i]),this.openGroups.delete(n[i]),this.closeGroups.delete(n[i]),this.nodeLayer.delete(n[i]),this.savedNodeLayer.delete(n[i]),this.savedEdgeLayer.delete(n[i]);for(let i=0;i<e.size;i++)this.edgeLayer.delete(e._indexes[i]);if(s){n=s._indexes;for(let i=0;i<n.length;i++)this.subNodeOffsetX.delete(n[i]),this.subNodeOffsetY.delete(n[i])}}getPositions(t,e){const{x:s,y:n}=t.getPosition();return e.map((i=>({x:s+(this.subNodeOffsetX.get(i._index)||0),y:n+(this.subNodeOffsetY.get(i._index)||0)})))}hideSubNodes(t){const e=[t];for(;e.length;){const s=e.pop();s.setVisible(!1);for(let n=0;n<s._indexes.length;n++)this.collapsedGroups.add(s._indexes[n]),this.openGroups.has(s._indexes[n])&&e.push(this.module.getSubNodes(s.get(n)))}}onRemove(t,e){if(!e)return;const s=[],n=new Set;for(let i=0;i<t.length;i++){const r=this.module.nodeToMeta.get(t[i]);if(!r)continue;const o=r._index;this.openRadius.delete(o),this.isExpanding.delete(o),this.alreadyGrouped.delete(o),this.collapsedGroups.delete(o),this.closeGroups.delete(o),this.openGroups.delete(o),this.padding.delete(o),this.geoRadius.delete(o),this.hasUpdated.delete(o),this.subNodeOffsetX.delete(o),this.subNodeOffsetY.delete(o),this.nodeLayer.delete(o),this.edgeLayer.delete(o),this.savedNodeLayer.delete(o),this.savedEdgeLayer.delete(o),this.openGroups.has(o)&&(this.layoutController.shouldRelayout.add(o),s.push(o))}for(;s.length;){const i=s.shift();if(n.has(i))continue;n.add(i);const r=this.module.nodeToMeta.get(i);r&&this.openGroups.has(r._index)&&(this.layoutController.shouldRelayout.add(r._index),s.push(r._index))}}async fishEyeExpand(t,e,s){if(!t.isVirtual())throw new Error("Focus node is not virtual.");const n=this.module.nodeToMeta.get(t._index);if(n&&n.isVisible())throw new Error("Focus node is not at top level.");const i=this.module.animations,r=this.ogma,o=i.getCloseRadius(t._index);s&&(this.layoutController.setNextLayout(t._index,s),this.layoutController.shouldRelayout.add(t._index)),this.layoutController.setNextOnGroupUpdate((async a=>{const l=i.getXYR(t.toList())[0].radius-o,u=i.getXYR(a);return await r.algorithms.fishEyeExpand({nodes:a,focusNode:t,dryRun:!0,deltaRadius:l,xyr:u})})),await e(),await this.module.afterNextUpdate()}setNodeLayer(t,e){this.nodeLayer.set(t,e),this.savedNodeLayer.set(t,e)}setEdgeLayer(t,e){this.edgeLayer.set(t,e),this.savedEdgeLayer.set(t,e)}async fishEyeCollapse(t,e){if(!t.isVirtual())throw new Error("Focus node is not virtual.");const s=this.module.nodeToMeta.get(t._index);if(s&&s.isVisible())throw new Error("Focus node is not at top level.");const n=this.module.animations,i=this.ogma,r=t.getAttribute("radius");this.layoutController.setNextOnGroupUpdate((async o=>{const a=n.getXYR(t.toList())[0].radius-r,l=n.getXYR(o);return await i.algorithms.fishEyeExpand({nodes:o,focusNode:t,dryRun:!0,deltaRadius:a,xyr:l})})),await e(),await this.module.afterNextUpdate()}triggerGroupsUpdate(){this.shouldRunGroupUpdate=!0}layoutGroups(t,e,s=!1){return this.runningLayouts=!0,this.layoutController.layoutGroups(t,e,s).finally((()=>{this.runningLayouts=!1}))}_onToggleGeo(){this.geoRadius.clear();const t=this.module.getList().find((s=>s.getName()===Xn.NodeGrouping));if(!t)return;const e=Array.from(this.openGroups.keys());for(let s=0;s<e.length;s++)this.layoutController.shouldRelayout.add(e[s]);t.refresh()}startRefresh(){this.alreadyGrouped.clear()}clear(){this.subNodeOffsetX.clear(),this.subNodeOffsetY.clear(),this.openRadius.clear(),this.isExpanding.clear(),this.layoutController.clear(),this.alreadyGrouped.clear(),this.openGroups.clear(),this.closeGroups.clear(),this.nodeLayer.clear(),this.edgeLayer.clear(),this.padding.clear(),this.geoRadius.clear(),this.collapsedGroups.clear(),this.hasUpdated.clear()}destroy(){this.destroyed||(this.destroyed=!0,this.ogma.events.off(this.onSetMultipleAttributes))}},$q=class{constructor(t){this.ogma=t}save(){this.selectedNodes=this.ogma.getSelectedNodes(),this.selectedEdges=this.ogma.getSelectedEdges(),this.ogma.modules.selection.disableEvents()}restore(){const t=this.selectedNodes.filter((i=>!this.ogma.getNode(i.getId()))),e=this.selectedEdges.filter((i=>!this.ogma.getEdge(i.getId()))),s=new Set,n=new Set;if(t.size){this.ogma.modules.events.fire("nodesUnselected",{nodes:t});for(let i=0;i<t.size;i++)s.add(t._indexes[i])}if(e.size){this.ogma.modules.events.fire("edgesUnselected",{edges:e});for(let i=0;i<e.size;i++)n.add(e._indexes[i])}this.selectedNodes.filter((i=>!i.isSelected()&&!s.has(i._index))).setSelected(!0),this.selectedEdges.filter((i=>!i.isSelected()&&!n.has(i._index))).setSelected(!0),this.ogma.modules.selection.enableEvents()}cleanup(){this.selectedNodes=void 0,this.selectedEdges=void 0,this.ogma.modules.selection.enableEvents&&this.ogma.modules.selection.enableEvents()}},qq={setData:!1,addElement:!0,removeElement:!0,setOptions:!1,refresh:!1},Yq=class px{constructor(){this.prev={},this.next={},this.prevorder=[],this.nextorder=[],this.shouldAnimate=!1,this.minRefreshIndex=0}addTransformation(e,s){this.next[e]=s,this.nextorder.push(e)}removeTransformation(e){delete this.next[e]}setIndex(e,s){const n=this.nextorder.indexOf(e);this.nextorder.splice(n,1),this.nextorder.splice(s,0,e),this.minRefreshIndex=Math.min(this.minRefreshIndex,n,s)}setEnabled(e,s){this.next[e]=s}isEnabled(e){return this.prev[e]||!1}static getDiff(e,s){const n=new Map;for(const i in e)s[i]!==void 0?s[i]!==e[i]&&n.set(+i,{shouldDo:s[i],shouldUndo:e[i]}):n.set(+i,{shouldDo:!1,shouldUndo:e[i],shouldCleanup:!0});for(const i in s)e[i]===void 0&&s[i]===!0&&n.set(+i,{shouldDo:!0,shouldUndo:!1});return n}getFirstChange(e){const{nextorder:s}=this;let n=s.length;for(let i=0;i<s.length;i++){const r=e.get(s[i]);if(r&&(r.shouldUndo||r.shouldDo)){n=i;break}}return n}refreshFrom(e,s){const{nextorder:n}=this;for(let i=s;i<this.nextorder.length;i++)e.set(n[i],{shouldUndo:this.prev[n[i]],shouldDo:this.prev[n[i]],...e.get(n[i])||{}});return e}isDirty(){const e=px.getDiff(this.prev,this.next),s=Math.min(this.minRefreshIndex,this.getFirstChange(e));return(e.size>0||s<this.nextorder.length)&&{reason:e.size>0?"diff":"refresh",index:s}}invalidateFrom(e,s){this.shouldAnimate||(this.shouldAnimate=qq[s]),this.minRefreshIndex=Math.min(this.minRefreshIndex,e)}step(){const e=px.getDiff(this.prev,this.next);this.prev={...this.next};const s=Math.min(this.minRefreshIndex,this.getFirstChange(e)),n=this.nextorder.reduce(((o,a,l)=>o.set(a,l)),new Map),i=this.prevorder.reduce(((o,a,l)=>o.set(a,l)),new Map);this.nextorder=this.nextorder.filter((o=>this.prev[o]!==void 0)),this.prevorder=[...this.nextorder],this.minRefreshIndex=this.nextorder.length;const r=this.shouldAnimate;return this.shouldAnimate=!1,{diff:this.refreshFrom(e,s),nextorder:n,prevorder:i,shouldAnimate:r}}done(){}},Wq=class{constructor(t){this.transformations=[],this.addingGraph=!1,this.addingElements=!1,this.nodeToTransformation=new Map,this.edgeToTransformation=new Map,this.nodeVirtual=new Set,this.edgeVirtual=new Set,this.nodeToMeta=new Map,this.edgeToMeta=new Map,this.metaToNodes=new Map,this.metaToEdges=new Map,this._onDestroy=()=>{this.destroy()},this._onAddElements=({nodes:e,edges:s,virtual:n})=>{if(n){if(e)for(let i=0;i<e.size;i++)this.nodeVirtual.add(e._indexes[i]);if(s)for(let i=0;i<s.size;i++)this.edgeVirtual.add(s._indexes[i])}else this.addingGraph||this.addingElements||(this.state.invalidateFrom(0,"addElement"),this.invalidate())},this._onSetData=({elements:e,virtual:s})=>{if(s)return;const{isNode:n,_indexes:i}=e;let r=1/0;for(const o of i){const a=this.getTransformation(o,n);if(!a){r=0;break}r=Math.min(r,a.getIndex())}return this.state.invalidateFrom(r,"setData"),this.invalidate(),r},this._onRequestElementsToDelete=e=>{const{elementsToRemove:s}=e,n=s.isNode,i=s._indexes,r=this.getLeafElements(i,n);e.elementsToRemove=n?this.ogma.nodeList(r):this.ogma.edgeList(r)},this._onAfterRemoveElements=({nodes:e,edges:s})=>{if(!this.ogma.isDestroyed()){if(e)for(let n=0;n<e.size;n++)this.nodeVirtual.delete(e._indexes[n]);if(s)for(let n=0;n<s.size;n++)this.edgeVirtual.delete(s._indexes[n])}},this._onRemoveElements=({nodes:e,edges:s,virtual:n})=>{n||this.ogma.isDestroyed()||this._refreshPromise.then((()=>{const i=!!e,r=i?e._indexes:s._indexes,o=new Set(r);this.transformations.forEach((a=>a.onRemove(o,i))),this.groupController.onRemove(r,i),this.drilldownController.onRemove(o,i),i?(this.nodeToMeta.clear(),this.metaToNodes.clear(),this.nodeToTransformation.clear()):(this.edgeToMeta.clear(),this.metaToEdges.clear(),this.edgeToTransformation.clear()),this.state.invalidateFrom(0,"removeElement"),this.invalidate()}))},this._onClearGraph=()=>{this.transformations.forEach((e=>{e.cleanup()})),this.groupController.clear(),this.nodeToMeta.clear(),this.edgeToMeta.clear(),this.metaToNodes.clear(),this.metaToEdges.clear(),this.nodeToTransformation.clear(),this.edgeToTransformation.clear(),this.state.invalidateFrom(0,"removeElement"),this.invalidate()},this.ogma=t,this.state=new Yq,this.animations=new Fq(t),this._shouldRefresh=!1,this._refreshing=!1,this.isDestroyed=!1,this.isPaused=!1,this.selection=new $q(t),this._refreshPromise=Promise.resolve(),this.groupController=new Hq(t,this),this.drilldownController=new Gq(this),this.ogma.events.on("setData",this._onSetData).on("preAddGraph",(()=>{this.addingGraph=!0})).on("postAddGraph",(()=>{this.addingGraph=!1,this.state.invalidateFrom(0,"addElement"),this.invalidate()})).on("preAddElements",(({virtual:e})=>{e||this.addingGraph||(this.addingElements=!0)})).on("postAddElements",(({virtual:e})=>{e||this.addingGraph||(this.addingElements=!1,this.state.invalidateFrom(0,"addElement"),this.invalidate())})).on(["addNodes","addEdges"],this._onAddElements).on(["removeNodes","removeEdges"],this._onRemoveElements).on("clearGraph",this._onClearGraph).on(["afterRemoveNodes","afterRemoveEdges"],this._onAfterRemoveElements).on("requestElementsToDelete",this._onRequestElementsToDelete).on("destroy",this._onDestroy)}addTransformation(t,e=!0){this.state.addTransformation(t.getId(),e),this.transformations.push(t),this.invalidate()}removeTransformation(t){const e=this.transformations.indexOf(t);e!==-1&&this.transformations.splice(e,1),this.invalidate()}async step(t=0,e={fireEnabled:[],fireDisabled:[],fireRefresh:[],fireDestroy:[],fireSetIndex:[]}){var s;if(t>5)throw new Error("Ogma transformations: Transformations refresh in loop");const{diff:n,prevorder:i,nextorder:r}=this.state.step(),{fireEnabled:o,fireDisabled:a,fireRefresh:l,fireDestroy:u,fireSetIndex:h}=e,g=[],f=[],p=[];this.groupController.startRefresh();for(const _ of this.transformations){const x=_.getId();if(!n.has(x))continue;const{shouldDo:v,shouldUndo:b,shouldCleanup:S}=n.get(x);v&&!b?o.push(_):b&&!v?a.push(_):v&&b&&l.push(_),i.has(x)&&i.get(x)!==r.get(x)&&h.push(_),b&&g.push(_),v&&f.push(_),S&&(u.push(_),p.push(_))}let y=0;g.sort(((_,x)=>i.get(x.getId())-i.get(_.getId())||0));for(const _ of g){const x=!((s=n.get(_.getId()))!=null&&s.shouldDo);x&&(y=this.animations.getMaxAnimation(y,_.getAnimation())),await _.undo(x)}f.sort(((_,x)=>r.get(_.getId())-r.get(x.getId())||0)),this.ogma.modules.graphics.pauseRendering();for(let _=0;_<f.length;_++){const x=f[_],v=_===f.length-1;v&&(y=this.animations.getMaxAnimation(y,x.getAnimation())),await x.run(v)}for(const _ of p)await _.cleanup();if((g.length||f.length||p.length)&&(this.groupController.updateGroupLayer(),await this.groupController.onAfterLayouts()),this.ogma.modules.graphics.resumeRendering(),await this.animations.apply(y),!this.isDestroyed)return this.state.isDirty()?this.step(t+1,e):e}refresh(){this.isDestroyed||this.ogma.isDestroyed()||!this._shouldRefresh||!this.transformations.length||this._refreshing||this.addingGraph||this.addingElements||this.isPaused||(this._shouldRefresh=!1,this._refreshing=!0,this._refreshPromise=this._refreshPromise.then((()=>(this.selection.save(),this.step().then((t=>{this._refreshing=!1;const{fireEnabled:e,fireDisabled:s,fireRefresh:n,fireDestroy:i,fireSetIndex:r}=t,o=this.ogma.modules.events;s.reverse().forEach((a=>o.fire("transformationDisabled",{target:a}))),e.forEach((a=>o.fire("transformationEnabled",{target:a}))),r.forEach((a=>o.fire("transformationSetIndex",{target:a}))),n.forEach((a=>o.fire("transformationRefresh",{target:a}))),i.forEach((a=>o.fire("transformationDestroyed",{target:a})))})).finally((()=>{this.selection.restore(),this.selection.cleanup(),this.ogma.modules.graphics.resumeRendering()}))))).catch((t=>{const e=this.state.isDirty();if(!e)throw new Error(`Ogma transformations, refresh failed.
${t.stack}`);const s=e.reason==="diff"?"You are constantly adding/removing/changing index of a transformation":"You are constantly adding/removing/updating nodes or edges while transformations refresh";throw new Error(`Ogma transformations, refresh failed.
${s}`)})).catch((t=>{if(!this.onRefreshError)throw t;this.onRefreshError(t)})).finally((()=>{})))}enable(t){return this.state.setEnabled(t.getId(),!0),this.invalidate(),this.afterNextUpdate()}disable(t){return this.state.setEnabled(t.getId(),!1),this.invalidate(),this.afterNextUpdate()}remove(t){return this.disable(t),this.state.removeTransformation(t.getId()),this.afterNextUpdate().then((()=>{this.transformations.splice(this.getIndex(t),1)}))}isEnabled(t){return this.state.isEnabled(t.getId())}getList(){return this.transformations.slice()}getIndex(t){for(let e=0;e<this.transformations.length;e++)if(this.transformations[e]===t)return e;return-1}setIndex(t,e){const s=this.getIndex(t);this.state.setIndex(t.getId(),e),this.transformations.splice(s,1),this.transformations.splice(e,0,t),this.invalidate()}setOptions(t){this.state.invalidateFrom(this.getIndex(t),"setOptions"),this.invalidate()}refreshTransformation(t){this.state.invalidateFrom(this.getIndex(t),"refresh"),this.invalidate()}clear(){return this.transformations.forEach((t=>t.destroy(0))),this.invalidate(),this.afterNextUpdate()}destroy(){this.transformations.forEach((t=>t.destroy(0))),this.groupController.destroy(),this._refreshPromise=Promise.resolve(),this.isDestroyed=!0}invalidate(){this.ogma.isDestroyed()||(this._shouldRefresh=!0,this.ogma.modules.dom.refresh(),this.ogma.modules.dom.onNextFrame().then((()=>{this.refresh()})))}afterNextUpdate(){return this.ogma.view.afterNextFrame().then((()=>this._refreshPromise))}getTransformation(t,e){return e?this.nodeToTransformation.get(t):this.edgeToTransformation.get(t)}setTransformation(t,e,s){s?this.nodeToTransformation.set(t,e):this.edgeToTransformation.set(t,e)}deleteTransformation(t){const e=t.isNode?this.nodeToTransformation:this.edgeToTransformation,s=t._indexes;for(const n of s)e.delete(n)}setMetaNode(t,e){this.nodeToMeta.set(t,e)}setSubNodes(t,e){this.metaToNodes.set(t,e)}setMetaElement(t,e,s){s?this.setMetaNode(t,e):this.setMetaEdge(t,e)}setSubElements(t,e,s){s?this.setSubNodes(t,e):this.setSubEdges(t,e)}removeMetaNodes(t){const e=t._indexes;for(const s of e){const n=this.metaToNodes.get(s);n&&n.forEach((i=>this.nodeToMeta.delete(i._index))),this.nodeToTransformation.delete(s),this.metaToNodes.delete(s)}}removeMetaEdges(t){const e=t._indexes;for(const s of e){const n=this.metaToEdges.get(s);n&&n.forEach((i=>this.edgeToMeta.delete(i._index))),this.edgeToTransformation.delete(s),this.metaToEdges.delete(s)}}clearSubNodes(t){this.metaToNodes.delete(t)}clearMetaNode(t){this.nodeToMeta.delete(t)}setMetaEdge(t,e){this.edgeToMeta.set(t,e)}setSubEdges(t,e){this.metaToEdges.set(t,e)}clearSubEdges(t){this.metaToEdges.delete(t)}clearMetaEdge(t){this.edgeToMeta.delete(t)}getMetaNode(t){return this.nodeToMeta.get(t._index)||null}getMetaEdge(t){return this.edgeToMeta.get(t._index)||null}getLeafElements(t,e){const s=[t],n=e?this.metaToNodes:this.metaToEdges,i=[];for(;s.length;){const r=s.pop();for(let o=0;o<r.length;o++){i.push(r[o]);const a=n.get(r[o]);a&&s.push(a._indexes)}}return i}getSubElements(t){const e=t.isNode?this.metaToNodes:this.metaToEdges,s=t.toList()._indexes;let n=0;for(let o=0;o<s.length;o++){const a=e.get(s[o]);a&&(n+=a.size)}const i=new Uint32Array(n);let r=0;for(let o=0;o<s.length;o++){const a=e.get(s[o]);if(a)for(let l=0;l<a.size;l++)i[r++]=a._indexes[l]}return t.isNode?this.ogma.nodeList(i):this.ogma.edgeList(i)}getSubNodes(t){return this.getSubElements(t)}getSubEdges(t){return this.getSubElements(t)}getById(t){return this.transformations.find((e=>e.getId()===t))}isIntraEdge(t){const e=t.getSource()._index;return this.nodeToMeta.has(e)&&this.nodeToMeta.get(e)===this.nodeToMeta.get(t.getTarget()._index)}isVirtual(t,e){return e?this.nodeVirtual.has(t):this.edgeVirtual.has(t)}isRefreshing(){return this._refreshing}pause(){this.isPaused=!0}resume(){this.isPaused=!1,this.refresh()}},ei="_transparent",yu=t=>!0,Xq=()=>{};function DM(t){if(t.keys)return Array.from(t.keys());const e=[];return t.forEach(((s,n)=>e.push(n))),e}function kf(t){if(t.values)return Array.from(t.values());const e=[];return t.forEach((s=>e.push(s))),e}function J1(t){return!(!t||t.constructor!==Object&&t.constructor)}var Ra=(...t)=>{const e={};for(let s=0;s<t.length;s++){const n=t[s];for(const i in n)n.hasOwnProperty(i)&&(Array.isArray(e[i])&&Array.isArray(n[i])?e[i]=Array.from(new Set(e[i].concat(n[i]))):J1(e[i])&&J1(n[i])?e[i]=Ra(e[i],n[i]):e[i]=n[i])}return e};function Zq(t){return Array.isArray(t)?t:[t]}var mx=()=>!0,OM=()=>!1,Kq=()=>null,Qq=class extends na{constructor(t){super(t),this.nodeSelector=t.criteria||yu}setOptions(t){return this.nodeSelector=t.criteria||this.nodeSelector,super.setOptions(t)}getName(){return Xn.NodeFilter}run(){const t=this.nodeSelector,e=this.ogma.getNodes().filter((a=>!t||!t(a))),s=e.getAdjacentEdges();this.module.animations.hideNodes(e._indexes),this.module.animations.hideEdges(s._indexes),e.setVisible(!1),s.setVisible(!1);const n=e.subtract(this.context.hiddenNodes),i=s.subtract(this.context.hiddenEdges),r=this.context.hiddenNodes.subtract(e),o=this.context.hiddenEdges.subtract(s);return this.module.animations.pushBefore((()=>{r.setVisible(!0),r.setVisible(!0),i.setVisible(!0),n.setVisible(!0),r.addClass(ei),o.addClass(ei)})),this.module.animations.push((()=>Promise.all([o.removeClass(ei,this.animation),r.removeClass(ei,this.animation),n.addClass(ei,this.animation),i.addClass(ei,this.animation)]))),this.context={...this.context,hiddenNodes:e,hiddenEdges:s},Promise.resolve()}undo(t=!0){const{hiddenNodes:e,hiddenEdges:s}=this.context,n=t?this.animation:0;return e.setExcluded(!1),s.setExcluded(!1),t&&(e.addClass(ei),s.addClass(ei),this.module.animations.push((()=>Promise.all([e.removeClass(ei,n),s.removeClass(ei,n)]))),this.context.hiddenNodes=this.ogma.nodeList(),this.context.hiddenEdges=this.ogma.edgeList()),Promise.resolve()}onRemove(t,e){e?this.context.hiddenNodes=this.context.hiddenNodes.filter((s=>!t.has(s._index))):this.context.hiddenEdges=this.context.hiddenEdges.filter((s=>!t.has(s._index)))}resetContext(){this.context={...this.context,hiddenEdges:this.ogma.edgeList(),hiddenNodes:this.ogma.nodeList()}}},Jq=class extends na{constructor(t){super(t),this.edgeSelector=t.criteria||yu}setOptions(t){return this.edgeSelector=t.criteria||this.edgeSelector,super.setOptions(t)}getName(){return Xn.EdgeFilter}run(){const t=this.edgeSelector,e=this.ogma.getEdges().filter((r=>!t||!t(r))),s=this.module.animations;e.setVisible(!1);const n=e.subtract(this.context.hiddenEdges),i=this.context.hiddenEdges.subtract(e);return this.module.animations.pushBefore((()=>{n.setVisible(!0),i.setVisible(!0),i.addClass(ei)})),s.hideEdges(e._indexes),s.push((()=>Promise.all([i.removeClass(ei,this.animation),n.addClass(ei,this.animation)]))),this.context={...this.context,hiddenEdges:e},Promise.resolve()}undo(t=!0){super.undo(t);const{hiddenEdges:e}=this.context,s=t?this.animation:0;return e.setExcluded(!1),t&&(e.addClass(ei),this.module.animations.push((()=>Promise.all([e.removeClass(ei,s)]))),this.context.hiddenEdges=this.ogma.edgeList()),Promise.resolve()}onRemove(t,e){e||(this.context.hiddenEdges=this.context.hiddenEdges.filter((s=>!t.has(s._index))))}resetContext(){this.context={...this.context,hiddenEdges:this.ogma.edgeList()}}},hn="_faded",tY=class extends na{constructor(t){super(t),this.selector=t.selector||OM,this.dataFunction=t.dataFunction||Xq}getName(){return Xn.NeighborMerging}run(t=!0){const{ogma:e}=this,s=t?this.animation:0,n=e.getNodes().filter(this.selector),i=[],r=new Map;for(let f=0;f<n.size;++f){const p=n.get(f),y=p.getAdjacentEdges(),_=this.dataFunction(p);for(let x=0;x<y.size;++x){const v=y.get(x),b=v.getSource(),S=v.getTarget();if(b!==S&&_!==void 0){const A=b===p?S:b;let w=r.get(A);w||(w=[],r.set(A,w)),w.push(_)}i.push(v)}}const o=e.getEdges(i),a=e.getNodes(DM(r)),l=kf(r),u=a.getData(),h=new Array(a.size);for(let f=0;f<h.length;++f){const p=l[f];let y=u[f];for(let _=0;_<p.length;++_)y=Ra(y,p[_]);h[f]=y}const g=this.module.animations;return g.hideNodes(n._indexes),g.hideEdges(o._indexes),g.push((()=>Promise.all([n.addClass(hn,s),o.addClass(hn,s)]).then((()=>{this.ogma.modules.data.setProperty(a,null,h,{dispatch:!0,virtual:!0})})))),this.context={...this.context,hiddenNodes:n,hiddenEdges:o,nodesWithDataChange:a,oldDataList:u},Promise.resolve()}resetContext(){super.resetContext(),this.context={...this.context,hiddenNodes:this.ogma.nodeList(),hiddenEdges:this.ogma.edgeList(),nodesWithDataChange:this.ogma.nodeList(),oldDataList:[]}}undo(t=!0){const{hiddenNodes:e,hiddenEdges:s,nodesWithDataChange:n,oldDataList:i}=this.context,r=t?this.animation:0,o=this.module.animations;return this.context.hiddenEdges=this.ogma.edgeList(),this.context.hiddenNodes=this.ogma.nodeList(),this.context.nodesWithDataChange=this.ogma.nodeList(),this.context.oldDataList=[],e.setVisible(!0),s.setVisible(!0),o.pushBefore((()=>{e.addClass(hn),s.addClass(hn)})),o.push((()=>Promise.all([e.removeClass(hn,r),s.removeClass(hn,r)]).then((()=>{this.ogma.modules.data.setProperty(n,null,i,{dispatch:!0,virtual:!0})})))),Promise.resolve()}onRemove(t,e){e&&(this.context.hiddenNodes=this.context.hiddenNodes.filter((s=>!t.has(s._index)))),this.context.hiddenEdges=this.context.hiddenEdges.filter((s=>!t.has(s._index)))}cleanup(){return Promise.resolve()}setOptions(t){return this.selector=t.selector||this.selector,this.dataFunction=t.dataFunction||this.dataFunction,super.setOptions(t)}};function eY(t){return t!=null}var sY=(t,e)=>({source:t.getId(),target:e.getId()}),nY=class extends na{constructor(t){super(t);const{selector:e=mx,neighborIdFunction:s=Kq,nodeGenerator:n=(()=>({})),edgeGenerator:i=sY}=t;this.neighborIdFunction=s,this.selector=e,this.generateIds=r=>this.selector(r)&&this.neighborIdFunction(r)||null,this.nodeGenerator=n,this.edgeGenerator=i}getName(){return Xn.NeighborGeneration}run(t=!0){const{ogma:e,id:s}=this,n=t?this.animation:0,i=e.getNodes(),r=new Map;for(let f=0;f<i.size;++f){const p=i.get(f),y=(iY(this.generateIds(p))||[]).filter(eY);if(y)for(const _ of y){let x=r.get(_);x||(x=[],r.set(_,x)),x.push(p)}}const o=new Array(r.size),a=[],l=DM(r),u=kf(r).map((f=>e.getNodes(f)));for(let f=0;f<o.length;++f){const p=l[f],y=u[f],_=this.nodeGenerator(p,y);_.id=`_gen_${s}_${p}`;const x=Pq(y.getPosition());_.attributes=_.attributes||{},_.attributes.x=x.x,_.attributes.y=x.y,o[f]=_}let h,g;return e.addNodes(o.map((f=>({id:f.id,attributes:f.attributes}))),{virtual:!0}).then((()=>{h=e.getNodes(o.map((p=>p.id)));const f=h._indexes;this.context.virtualNodes&&this.module.removeMetaNodes(this.context.virtualNodes);for(let p=0;p<h.size;p++)this.module.setTransformation(f[p],this,!0),this.module.setSubNodes(f[p],this.ogma.createNodeList());h.replaceOriginalAttributes(o.map((p=>p.attributes)),["x","y"]),this.ogma.modules.data.setProperty(h,null,o.map((p=>p.data)),{dispatch:!0,virtual:!0});for(let p=0;p<h.size;++p){const y=h.get(p),_=u[p];for(let x=0;x<_.size;++x){const v=_.get(x),b=this.edgeGenerator(v,y);!b.source&&!b.target&&(b.source=v.getId(),b.target=y.getId()),b.id||(b.id=`${b.source}-${b.target}`),a.push(b)}}return e.addEdges(a,{virtual:!0})})).then((()=>{g=e.getEdges(a.map((p=>p.id)));const f=g._indexes;this.context.virtualEdges&&this.module.removeMetaEdges(this.context.virtualEdges);for(let p=0;p<g.size;p++)this.module.setTransformation(f[p],this,!1),this.module.setSubEdges(f[p],this.ogma.createEdgeList());this.context={virtualEdges:g,virtualNodes:h},e.removeNodes(this.context.virtualNodes.subtract(h),{virtual:!0}),e.removeEdges(this.context.virtualEdges.subtract(g),{virtual:!0}),h.setVisible(!0),g.setVisible(!0),this.module.animations.pushBefore((()=>{h.addClass(hn),g.addClass(hn)})),this.module.animations.push((()=>Promise.all([h.removeClass(hn,n),g.removeClass(hn,n)])))}))}undo(t=!0){const{virtualNodes:e,virtualEdges:s}=this.context;if(!s||!e)return Promise.resolve(this.context);const n=t?this.animation:0,i=this.module.animations;t?(i.hideNodes(e._indexes),i.hideEdges(s._indexes),i.push((()=>Promise.all([e.addClass(hn,n),s.addClass(hn,n)])))):(e.setVisible(!1),s.setVisible(!1))}onRemove(){}cleanup(){const{virtualEdges:t,virtualNodes:e}=this.context;return t&&e&&(this.module.removeMetaNodes(e),this.module.removeMetaEdges(t),this.ogma.removeNodes(e,{virtual:!0}),this.ogma.removeEdges(t,{virtual:!0}),this.context.virtualEdges=this.ogma.edgeList(),this.context.virtualNodes=this.ogma.nodeList()),Promise.resolve()}setOptions(t){const{selector:e,neighborIdFunction:s,nodeGenerator:n,edgeGenerator:i}=t;return this.selector=e||this.selector,this.neighborIdFunction=s||this.neighborIdFunction,this.generateIds=r=>this.selector(r)&&this.neighborIdFunction(r)||null,this.nodeGenerator=n||this.nodeGenerator,this.edgeGenerator=i||this.edgeGenerator,super.setOptions(t)}resetContext(){super.resetContext(),this.context={...this.context,virtualNodes:this.ogma.nodeList(),virtualEdges:this.ogma.edgeList()}}};function iY(t){return Array.isArray(t)?t:t?[t]:null}function rY(t,e){return t.size===e.size&&t.filter((s=>e.includes(s))).size>0}var oY=class extends na{constructor(t){super(t),this.selector=t.selector||OM,this.edgeGenerator=t.edgeGenerator||(()=>({}))}getName(){return Xn.NodeCollapsing}resetContext(){this.context={hiddenNodes:this.ogma.nodeList(),hiddenEdges:this.ogma.edgeList(),virtualEdges:this.ogma.edgeList()}}run(t=!0){const{ogma:e}=this,s=t?this.animation:0,n=e.getNodes().filter(this.selector),i=n.getAdjacentEdges(),r=[],o=n.map((l=>l.getAdjacentNodes().filter((u=>!this.selector(u)))));for(let l=0;l<n.size;l++)for(let u=l;u<n.size;u++){const h=n.get(l),g=n.get(u);if(this.ogma.modules.graph.getEdgesBetweenTwoNodes(h,g).size>0&&(o[l].size||o[u].size)&&!rY(o[l],o[u]))throw Error(`addNodeCollapsing: invalid connected nodes [${h.getId()}] and [${g.getId()}] to be collapsed. The addNodeCollapsing function supports only disconnected nodes.`)}const a=new Map;for(let l=0;l<n.size;++l){const u=n.get(l),h=o[l];for(let g=0;g<h.size-1;++g){const f=h.get(g),p=this.ogma.modules.graph.getEdgesBetweenTwoNodes(u,f);if(f!==u)for(let y=g+1;y<h.size;++y){const _=h.get(y),x=this.ogma.modules.graph.getEdgesBetweenTwoNodes(u,_),v=this.edgeGenerator(u,f,_,p,x);if(v){const b=Zq(v);for(let S=0;S<b.length;++S)r.push(aY(e,b[S],S,u,f,_,p,x)),a.set(r[r.length-1].id,p.concat(x))}}}}return e.addEdges(r,{virtual:!0}).then((()=>{const l=this.ogma.getEdges(r.map((g=>g.id)));this.context.virtualEdges&&this.module.removeMetaEdges(this.context.virtualEdges);const u=l._indexes;for(let g=0;g<l.size;g++){this.module.setTransformation(u[g],this,!1);const f=a.get(l.get(g).getId());this.module.setSubEdges(u[g],f);for(let p=0;p<f.size;p++)this.module.setMetaEdge(f._indexes[p],l.get(g))}e.removeEdges(this.context.virtualEdges.subtract(l),{virtual:!0});const h=this.module.animations;l.setVisible(!0),h.pushBefore((()=>l.addClass(hn))),h.push((()=>Promise.all([l.removeClass(hn,s),n.addClass(hn,s),i.addClass(hn,s)]))),h.hideNodes(n._indexes),h.hideEdges(i._indexes),this.context={hiddenEdges:i,hiddenNodes:n,virtualEdges:l}}))}undo(t=!0){const{hiddenNodes:e,hiddenEdges:s,virtualEdges:n}=this.context,i=t?this.animation:0,r=this.module.animations;return e.setVisible(!0),s.setVisible(!0),t?(r.hideEdges(n._indexes),r.pushBefore((()=>Promise.all([e.addClass(hn),s.addClass(hn)]))),r.push((()=>Promise.all([n.addClass(hn,i),e.removeClass(hn,i),s.removeClass(hn,i)])))):n.setVisible(!1),Promise.resolve()}cleanup(){const t=this.context.virtualEdges||this.ogma.createEdgeList();return this.module.removeMetaEdges(t),this.ogma.removeEdges(t,{virtual:!0}).then((()=>{this.resetContext()}))}onRemove(t,e){e&&(this.context.hiddenNodes=this.context.hiddenNodes.filter((s=>!t.has(s._index)))),this.context.hiddenEdges=this.context.hiddenEdges.filter((s=>!t.has(s._index)))}setOptions(t){return this.selector=t.selector||this.selector,this.edgeGenerator=t.edgeGenerator||this.edgeGenerator,super.setOptions(t)}};function aY(t,e,s,n,i,r,o,a){let l,u;if(e.source!==void 0&&(l=t.getNode(e.source),l!==i&&l!==r))throw new Error([`addNodeCollapsing: edge generator produced RawEdge with invalid source [${e.source}]`,`expected to be [${i.getId()}] or [${r.getId()}]`].join("; "));if(e.target!==void 0&&(u=t.getNode(e.target),u!==i&&u!==r))throw new Error([`addNodeCollapsing: edge generator produced RawEdge with invalid target [${e.target}]`,`expected to be [${i.getId()}] or [${r.getId()}]`].join("; "));if(l&&u&&l===u)throw new Error(`addNodeCollapsing: edge generator produced RawEdge with same source and target [${l.getId()}]`);if(l&&!u)u=l===i?r:i;else if(u&&!l)l=u===i?r:i;else if(!l&&!u){let h=!0;for(let g=0;g<o.size;++g)o.get(g).getSource()===i&&(h=!1);for(let g=0;g<a.size;++g)a.get(g).getTarget()===r&&(h=!1);h?(l=r,u=i):(l=i,u=r)}return l&&u?{...e,id:`_gen_${n.getId()}_${l.getId()}_${u.getId()}_${s}`,source:l.getId(),target:u.getId()}:{}}var lY=class extends na{constructor(t){super(t),this.nodeSelector=t.nodeSelector||mx,this.edgeSelector=t.edgeSelector||mx,this.nodeDataFunction=t.nodeDataFunction||null,this.edgeDataFunction=t.edgeDataFunction||null}getName(){return Xn.VirtualProperties}resetContext(){this.context={nodes:this.ogma.nodeList(),oldNodesData:[],edges:this.ogma.edgeList(),oldEdgesData:[]}}run(){const{ogma:t,context:e}=this;return this.nodeDataFunction&&(e.nodes=t.getNodes().filter(this.nodeSelector),e.oldNodesData=tw(e.nodes,this.nodeDataFunction,this.ogma)),this.edgeDataFunction&&(e.edges=t.getEdges().filter(this.edgeSelector),e.oldEdgesData=tw(e.edges,this.edgeDataFunction,this.ogma)),Promise.resolve()}undo(){const{nodes:t,oldNodesData:e,edges:s,oldEdgesData:n}=this.context,i=this.ogma.modules.data;return t&&i.setProperty(t,null,e,{dispatch:!0,virtual:!0}),s&&i.setProperty(s,null,n,{dispatch:!0,virtual:!0}),Promise.resolve()}onRemove(t,e){e&&(this.context.nodes=this.context.nodes.filter((s=>!t.has(s._index)))),this.context.edges=this.context.edges.filter((s=>!t.has(s._index)))}cleanup(){return this.resetContext(),Promise.resolve()}setOptions(t){return this.nodeSelector=t.nodeSelector||this.nodeSelector,this.edgeSelector=t.edgeSelector||this.edgeSelector,this.nodeDataFunction=t.nodeDataFunction||this.nodeDataFunction,this.edgeDataFunction=t.edgeDataFunction||this.edgeDataFunction,super.setOptions(t)}};function tw(t,e,s){const n=[],i=[];for(let r=0;r<t.size;++r){const o=t.get(r),a=o.getData(),l=e(o);i.push(Ra(a,l)),n.push(a)}return s.modules.data.setProperty(t,null,i,{dispatch:!0,virtual:!0}),n}var xu=()=>"";function hh(){return{}}var BM=class extends na{constructor(t){super(t),this.nodeSelector=t.nodeSelector||yu,this.nodeGroupIdFunction=t.nodeGroupIdFunction||xu,this.nodeGenerator=t.nodeGenerator||hh,this.edgeSelector=t.edgeSelector||yu,this.edgeGroupIdFunction=t.edgeGroupIdFunction||xu,this.edgeGenerator=t.edgeGenerator||hh,this.separateEdgesByDirection=t.separateEdgesByDirection!==void 0&&t.separateEdgesByDirection,this.groupSelfLoopEdges=!!t.groupSelfLoopEdges,this.groupEdges=t.groupEdges===void 0||t.groupEdges,this.ogma.events.on("updateNodeData",(({changes:e})=>this.checkChanges(e,!0))).on("updateEdgeData",(({changes:e})=>this.checkChanges(e,!1)))}computeNodeGroupId(t){if(this.nodeGroupIdFunction){if(!this.nodeSelector(t)||this.module.groupController.alreadyGrouped.has(t._index)||this.module.animations.hiddenNodes.has(t._index))return;const e=this.nodeGroupIdFunction(t);return e===void 0?void 0:e}}computeEdgeGroupId(t){if(this.edgeGroupIdFunction)return this.edgeSelector(t)&&!this.module.animations.hiddenEdges.has(t._index)?this.edgeGroupIdFunction(t):void 0}addMetaNodes(){const t=this.id,e=this.ogma,s=e.getNodes(),n=new Map;for(let h=0;h<s.size;++h){const g=s.get(h),f=this.computeNodeGroupId(g);if(f===void 0)continue;let p=n.get(f);p||(p={id:f,nodes:[]},n.set(f,p)),p.nodes.push(g)}const i=Array.from(n.values()),r=i.map((({nodes:h})=>e.getNodes(h))),o=[],a=[],l=new Set,{nodeDataUpdates:u}=this.context;for(let h=0;h<i.length;++h){const g=i[h].id,f=r[h],p=this.nodeGenerator(f,g,this);if(p){if(p.id===void 0&&(p.id=Mf(g,t)),l.has(p.id))throw new Error(`Ogma transformations: NodeGrouping ${this.id} is trying to create two different metaNodes with the same id.`);l.add(p.id),a.push(p.id),o.push(p)}else i.splice(h,1),r.splice(h,1),h--}return e.addNodes(o.map((({id:h})=>({id:h}))),{virtual:!0}).then((h=>{const g=e.getNodes(a);e.modules.individualAttributes.replaceOriginalAttributes(g,o.map((({attributes:p})=>p)));const f=g.getData();for(let p=0;p<f.length;p++){const y=f[p],_=o[p];f[p]=Ra(Ra(y,_.data),u.get(a[p]))}return e.modules.data.setProperty(g,null,f,{dispatch:!0,virtual:!0}),g.setVisible(!0),this.context.metaNodes&&this.module.removeMetaNodes(this.context.metaNodes),this.assignMetaSubNodes(g,r),{metaNodes:g,newNodes:h}}))}assignMetaSubNodes(t,e){const s=t._indexes;for(let n=0;n<s.length;n++){const i=e[n]._indexes,r=s[n],o=t.get(n);for(let a=0;a<i.length;a++)this.module.setMetaNode(i[a],o),this.module.groupController.alreadyGrouped.add(i[a]);this.module.setSubNodes(r,e[n]),this.module.setTransformation(r,this,!0)}}addMetaEdges(t){const e=this.id,s=this.ogma;let n,i=!1;const r=new Set;t?(n=this.module.getSubNodes(t).getAdjacentElements({bothExtremities:!1}).edges,i=!0):n=s.getEdges();const o=new Map,a=this.ogma.modules.graphics.getAttributesManager().getUsedEdgeAttributes().filter((_=>_!=="curvature")),l=new Map;for(let _=0;_<n.size;++_){const x=n.get(_),v=this.computeEdgeGroupId(x);if(v==null)continue;let b=x.getSource(),S=x.getTarget();if(i){let L=this.module.nodeToMeta.get(b._index);L&&L.getTransformation().getId()!==this.getId()&&(L=b);let M=this.module.nodeToMeta.get(S._index);if(M&&M.getTransformation().getId()!==this.getId()&&(M=S),b=L||b,S=M||S,b&&b===S&&(l.has(b._index)?l.get(b._index).push(x._index):l.set(b._index,[x._index]),!this.groupSelfLoopEdges))continue}const A=this.groupEdges?Oq(v,b.getId(),S.getId(),this.separateEdgesByDirection):`${x.getId()}:${b.getId()}->${S.getId()}`;let w=o.get(A);w||(w={id:A,source:b,target:S,edges:[]},o.set(A,w)),w.edges.push(x)}const u=Array.from(o.values()),h=u.map((({edges:_})=>s.getEdges(_))),g=[],{edgeDataUpdates:f}=this.context,p=[],y=[];r.clear();for(let _=0;_<u.length;++_){const x=u[_],v=x.id,b=h[_],S=this.groupEdges?this.edgeGenerator(b,v,x.source,x.target,this):zq(b,a);if(S){if(S.id===null)throw Error(`The id ${S.id} returned by the edgeGenerator function is not unique.`);if(S.id===void 0&&(S.id=Mf(v,e)),r.has(S.id))throw new Error(`Ogma transformations: NodeGrouping ${this.id} is trying to create two different metaEdges with the same id.`);r.add(S.id),p.push(S.id),x.source===x.target&&y.push(S.id),S.source=x.source.getId(),S.target=x.target.getId(),g.push(S)}}return s.addEdges(Dq(g),{virtual:!0}).then((()=>{const _=s.getEdges(p),x=s.getEdges(y);x.setVisible(!1),_.setVisible(!1),s.modules.individualAttributes.replaceOriginalAttributes(_,g.map((b=>b.attributes)));const v=_.getData();for(let b=0;b<v.length;b++){const S=g[b],A=v[b];v[b]=Ra(Ra(A,S.data),f.get(p[b]))}return s.modules.data.setProperty(_,null,v,{dispatch:!0,virtual:!0}),this.context.metaEdges&&this.module.removeMetaEdges(this.context.metaEdges),this.assignMetaSubEdges(_,h),{intraEdges:l,metaEdges:_,selfLoopEdges:x,subEdges:h}}))}assignMetaSubEdges(t,e){const s=t._indexes;for(let n=0;n<s.length;n++){const i=e[n]._indexes,r=s[n],o=t.get(n);for(let a=0;a<i.length;a++)this.module.setMetaEdge(i[a],o);this.module.setSubEdges(r,e[n]),this.module.setTransformation(r,this,!1)}}removeMetaEdges(t){t.forEach((e=>{const s=this.module.getSubEdges(e);if(!s)return;const n=s._indexes;for(let r=0;r<n.length;r++)this.module.clearMetaEdge(n[r]);this.module.clearSubEdges(e._index);const i=this.module.getMetaEdge(e);if(i){for(let r=0;r<n.length;r++)this.module.setMetaEdge(n[r],i);this.module.setSubEdges(i._index,this.module.getSubEdges(i).filter((r=>r!==e)).concat(s))}s.filter((r=>r.getTarget().isVisible()&&r.getSource().isVisible())).setVisible(!0)})),t.setVisible(!1)}removeMetaNodes(t){t.forEach((e=>{const s=this.module.getSubNodes(e);if(!s)return;const n=s._indexes;for(const i of n)this.module.clearMetaNode(i);this.module.clearSubNodes(e._index),s.setVisible(!0)})),t.setVisible(!1)}onRemove(t,e){}checkChanges(t,e){const s=e?this.context.nodeDataUpdates:this.context.edgeDataUpdates,n=this.module;for(let i=0;i<t.length;i++){const{property:r,newValues:o,virtual:a,nodes:l,edges:u}=t[i];if(a)continue;const h=e?l.filter((g=>n.getTransformation(g._index,e)===this)):u.filter((g=>n.getTransformation(g._index,e)===this));if(h.size)for(let g=0;g<h._indexes.length;g++){const f=h.get(g).getId();let p=s.get(f)||{};const y=o[g];r?Ia(p,r,y):p=y,s.set(f,p)}}}setOptions(t){return this.nodeSelector=t.nodeSelector||this.nodeSelector,this.nodeGroupIdFunction=t.nodeGroupIdFunction||this.nodeGroupIdFunction,this.nodeGenerator=t.nodeGenerator||this.nodeGenerator,this.edgeSelector=t.edgeSelector||this.edgeSelector,this.edgeGroupIdFunction=t.edgeGroupIdFunction||this.edgeGroupIdFunction,this.edgeGenerator=t.edgeGenerator||this.edgeGenerator,this.separateEdgesByDirection=t.separateEdgesByDirection!==void 0?!!t.separateEdgesByDirection:this.separateEdgesByDirection,this.groupSelfLoopEdges=t.groupSelfLoopEdges!==void 0?!!t.groupSelfLoopEdges:this.groupSelfLoopEdges,this.groupEdges=t.groupEdges!==void 0?!!t.groupEdges:this.groupEdges,super.setOptions(t)}resetContext(){super.resetContext(),this.context={...this.context,nodeDataUpdates:new Map,edgeDataUpdates:new Map}}},UM=class extends BM{constructor({duration:e,easing:s,id:n,ogma:i,module:r,enabled:o,padding:a=2,onBeforeAddMetaEdges:l,selector:u=yu,groupIdFunction:h=xu,edgeGroupIdFunction:g=xu,nodeGenerator:f=hh,edgeGenerator:p=hh,onGroupUpdate:y=(()=>{}),separateEdgesByDirection:_=!1,groupSelfLoopEdges:x=!1,groupEdges:v=!0,restorePositions:b=!0,showContents:S=!1}){super({id:n,ogma:i,module:r,nodeSelector:u,nodeGroupIdFunction:h,edgeGroupIdFunction:g,nodeGenerator:f,edgeSelector:A=>!(!this.module.getMetaNode(A.getSource())&&!this.module.getMetaNode(A.getTarget())),edgeGenerator:p,separateEdgesByDirection:_,groupEdges:v,groupSelfLoopEdges:x,duration:e,easing:s,enabled:o}),this.onBeforeAddMetaEdges=l||(()=>Promise.resolve()),this.onGroupUpdate=y,this._padding=a,this._showContents=typeof S!="function"?()=>S:S,this._restorePositions=b,this.module.groupController.setNodeGroupingCount(this.module.groupController.getNodeGroupingCount()+1)}getName(){return Xn.NodeGrouping}get padding(){return this._padding}set padding(e){this._padding=e,this.refresh()}resetContext(){super.resetContext(),this.context={...this.context,metaNodes:this.ogma.nodeList(),metaEdges:this.ogma.edgeList(),subNodes:this.ogma.nodeList(),intraEdges:this.ogma.edgeList(),subNodesPerMetaNode:new Map,subEdges:this.ogma.edgeList()}}run(){let e,s;const n=this.ogma,i=this.module.animations,r=this.module.groupController,o=r.layoutController;let a=n.createNodeList(),l=n.createEdgeList();const u=[];let h=n.createEdgeList();const g=new Map,f=-(this.getIndex()+zM),p=new Set,y=[],_=[],x=[];let v;const b=n.geo.enabled();return this.addMetaNodes().then((({metaNodes:S,newNodes:A})=>{v=r.setPadding(S,this._padding),e=S;for(let w=0;w<A.size;w++)p.add(A._indexes[w]);for(let w=0;w<e.size;w++)r.setNodeLayer(e._indexes[w],f);return this.onBeforeAddMetaEdges(e,A).then((()=>this.addMetaEdges(e)))})).then((({intraEdges:S,metaEdges:A,selfLoopEdges:w})=>{s=A,l=this.module.getSubEdges(s),s.filter((F=>F.getExtremities().map((O=>O.isVisible())).every((O=>O)))).setVisible(!0);for(let F=0;F<s.size;F++)r.edgeLayer.set(s._indexes[F],f);l.setVisible(!1);const L=this.context.metaNodes.subtract(e),M=this.context.metaEdges.subtract(s);return this.module.removeMetaNodes(L),this.module.removeMetaEdges(M),r.cleanup(L,M),n.removeNodes(L,{virtual:!0}).then((()=>n.removeEdges(M,{virtual:!0}))).then((()=>({intraEdges:S,metaEdges:A,selfLoopEdges:w})))})).then((({intraEdges:S,selfLoopEdges:A})=>{const w=e._indexes,L=[],M=e.getPosition();for(let F=0;F<w.length;F++){const O=e.get(F),G=r.isClose(O),j=!G&&!r.isOpen(O),Z=r.collapsedGroups.has(O._index),at=this._showContents(O),pt=this.module.getSubNodes(O),K=M[F],ut=pt._indexes,ht=new Set;if(j){const{x:Et,y:Xt}=r.getGroupXYR(O,this.module.getSubNodes(O),void 0,void 0);b?r.setGeoLatLng(O,Xt,Et):(_.push({x:Et,y:Xt}),x.push(O._index),K.x=Et,K.y=Xt)}g.set(w[F],ht);const nt=S.has(O._index)&&n.edgeList(S.get(O._index));nt&&(h=h.concat(nt),nt.setVisible(at&&!Z)),A.setVisible(!0),a=a.concat(pt);for(let Et=0;Et<ut.length;Et++)ht.add(ut[Et]);const ot=this.context.subNodesPerMetaNode.get(w[F]),Mt=v.has(O._index);let Q=!ot||o.shouldRelayout.has(O._index);if(!Q&&ot)for(const Et of ot.keys())Q||(Q=!ht.has(Et));if(!Q&&ot)for(let Et=0;Et<ut.length;Et++)Q||(Q=!ot.has(ut[Et]));if(Q&&(o.shouldRelayout.add(O._index),L.push(r.layoutController.getLayoutFunction(this.onGroupUpdate,O,pt,at))),at){if(G?r.expandGroup(O,pt):r.addOpenGroup(O),Q||Mt||G){y.push(O);const Et=this.module.getMetaNode(O);Et&&o.shouldRelayout.add(Et._index)}}else r.closeGroup(O,pt,K.x,K.y)}return x.length&&i.pushBefore((()=>{n.nodeList(x).setAttributes(_)})),r.layoutController.handleLayoutFunctions(L).then((()=>{y.forEach((F=>r.setGroupXYR(F))),b&&this.ogma.modules.geo._updateNodesCoordinates(e)}))})).then((()=>(this.context={metaNodes:e,metaEdges:s,subNodesPerMetaNode:g,subNodes:a,intraEdges:h,nodeDataUpdates:this.context.nodeDataUpdates,edgeDataUpdates:this.context.edgeDataUpdates,subEdges:l},u)))}undo(e=!0){super.undo(e);const{metaNodes:s,metaEdges:n,intraEdges:i,subNodes:r,subEdges:o}=this.context,a=this.module.animations,l=this.module.groupController;if(i.setVisible(!0),o.setVisible(!0),n.setVisible(!1),r.setVisible(!0),s.setVisible(!1),e){a.pushBefore((()=>{s.setVisible(!0),n.setVisible(!0)})),a.pushAfter((()=>{s.setVisible(!1),n.setVisible(!1)}));for(let u=0;u<n.size;u++)this.module.isVirtual(n._indexes[u],!1)||l.edgeLayer.delete(n._indexes[u]);for(let u=0;u<o.size;u++)this.module.isVirtual(o._indexes[u],!1)||l.edgeLayer.delete(o._indexes[u]);for(let u=0;u<i.size;u++)this.module.isVirtual(i._indexes[u],!1)||l.edgeLayer.delete(i._indexes[u]);for(let u=0;u<r.size;u++)this.module.isVirtual(r._indexes[u],!0)||l.nodeLayer.delete(r._indexes[u]);this.context.subNodesPerMetaNode.clear(),s.forEach((u=>{const h=this.module.getSubNodes(u);if(l.nodeLayer.delete(u._index),l.isClose(u))l.expandGroup(u,h,!0);else{const g=u.getPosition();l.closeGroup(u,h,g.x,g.y,!0)}}))}}onRemove(e,s){if(s){const n=this.context.metaNodes.size;this.context.metaNodes=this.context.metaNodes.filter((r=>!e.has(r._index)));const i=this.context.subNodes.size;this.context.subNodes=this.context.subNodes.filter((r=>!e.has(r._index))),(this.context.subNodes.size!==n||this.context.metaNodes.size!==i)&&this.context.subNodesPerMetaNode.clear()}else this.context.subEdges=this.context.subEdges.filter((n=>!e.has(n._index))),this.context.metaEdges=this.context.metaEdges.filter((n=>!e.has(n._index)))}cleanup(){const{ogma:e}=this,s=this.context,{metaNodes:n,metaEdges:i,subNodes:r}=s;return this.module.removeMetaNodes(n),this.module.removeMetaEdges(i),this.module.groupController.cleanup(n,i,r),this.module.groupController.setNodeGroupingCount(this.module.groupController.getNodeGroupingCount()-1),super.cleanup(),Promise.all([e.removeEdges(i,{virtual:!0}),e.removeNodes(n,{virtual:!0})]).then((()=>Promise.resolve()))}setOptions({duration:e,easing:s,enabled:n,padding:i,selector:r,groupIdFunction:o,nodeGenerator:a,edgeGroupIdFunction:l,edgeGenerator:u,separateEdgesByDirection:h,groupSelfLoopEdges:g,groupEdges:f,restorePositions:p,showContents:y}){return this._padding=i!==void 0?i:this.padding,this._showContents=y!==void 0?typeof y!="function"?()=>y:y:this._showContents,this._restorePositions=p===void 0?this._restorePositions:p,super.setOptions({nodeSelector:r,nodeGroupIdFunction:o,nodeGenerator:a,edgeSelector:_=>!(!this.module.getMetaNode(_.getSource())&&!this.module.getMetaNode(_.getTarget())),edgeGroupIdFunction:l,edgeGenerator:u,separateEdgesByDirection:h,groupEdges:f,groupSelfLoopEdges:g,duration:e,easing:s,enabled:n})}},uY=class extends BM{constructor({duration:t,easing:e,id:s,ogma:n,module:i,enabled:r,selector:o=yu,groupIdFunction:a=xu,generator:l=hh,separateEdgesByDirection:u=!1}){super({id:s,ogma:n,module:i,nodeSelector:null,nodeGroupIdFunction:null,nodeGenerator:null,edgeSelector:o,edgeGroupIdFunction:a,edgeGenerator:l,separateEdgesByDirection:u,groupEdges:!0,groupSelfLoopEdges:!0,duration:t,easing:e,enabled:r})}resetContext(){super.resetContext(),this.context={...this.context,metaEdges:this.ogma.edgeList(),subEdges:this.ogma.edgeList()}}getName(){return Xn.EdgeGrouping}run(){let t,e;const s=this.module.animations,n=new Set(this.context.metaEdges.getId());return this.addMetaEdges().then((({metaEdges:i})=>{t=i,e=this.module.getSubEdges(t),t.setVisible(!0),e.setVisible(!1),s.hideEdges(e._indexes);const r=t.concat(this.context.metaEdges).getParallelEdges().dedupe().filter((u=>!n.has(u.getId()))),o=new Array(r.size),a=new Map;for(let u=0;u<r.size;u++)o[u]=this.ogma.modules.curvatureManager.computeCurvature(r.get(u),"visible"),a.set(r._indexes[u],o[u]);const l=this.module.getSubEdges(r);l.setVisible(!0),this.module.animations.setCurvatures(r._indexes,o);for(let u=0;u<l._indexes.length;u++)this.module.animations.setCurvature(e._indexes[u],a.get(this.module.getMetaEdge(e.get(u))._index)||0)})).then((()=>{this.context.metaEdges=t,this.context.subEdges=e}))}undo(t=!0){super.undo(t);const{metaEdges:e,subEdges:s}=this.context;if(s.setVisible(!0),e.setVisible(!1),!t)return Promise.resolve();const n=s.getParallelEdges().dedupe(),i=new Array(n.size),r=new Map;for(let o=0;o<n.size;o++)i[o]=this.ogma.modules.curvatureManager.computeCurvature(n.get(o),"visible"),r.set(n._indexes[o],i[o]);return this.module.animations.setCurvatures(n._indexes,i),Promise.resolve()}onRemove(t,e){e||(this.context.subEdges=this.context.subEdges.filter((s=>!t.has(s._index))))}_getCurvatures(t){return t.map((e=>this.ogma.modules.curvatureManager.computeCurvature(e,"visible",(()=>!0))))}cleanup(){const{metaEdges:t}=this.context;return this.module.removeMetaEdges(t),this.ogma.removeEdges(t,{virtual:!0}).then((()=>(this.context.metaEdges=this.ogma.edgeList(),this.context.subEdges=this.ogma.edgeList(),Promise.resolve())))}setOptions({duration:t,easing:e,enabled:s,selector:n,groupIdFunction:i,generator:r,separateEdgesByDirection:o}){return super.setOptions({nodeSelector:void 0,nodeGroupIdFunction:void 0,nodeGenerator:void 0,edgeSelector:n,edgeGroupIdFunction:i,edgeGenerator:r,separateEdgesByDirection:o,groupEdges:!0,duration:t,easing:e,enabled:s})}},ew=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],C_=1,gd=8,dY=class GM{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,n]=new Uint8Array(e,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const i=n>>4;if(i!==C_)throw new Error(`Got v${i} data when expected v${C_}.`);const r=ew[15&n];if(!r)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(e,2,1),[a]=new Uint32Array(e,4,1);return new GM(a,o,r,e)}constructor(e,s=64,n=Float64Array,i){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const r=ew.indexOf(this.ArrayType),o=2*e*this.ArrayType.BYTES_PER_ELEMENT,a=e*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-a%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${n}.`);i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,gd,e),this.coords=new this.ArrayType(this.data,gd+a+l,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(gd+o+a+l),this.ids=new this.IndexArrayType(this.data,gd,e),this.coords=new this.ArrayType(this.data,gd+a+l,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(C_<<4)+r]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=e)}add(e,s){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=s,n}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return _x(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,s,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:o,nodeSize:a}=this,l=[0,r.length-1,0],u=[];for(;l.length;){const h=l.pop()||0,g=l.pop()||0,f=l.pop()||0;if(g-f<=a){for(let x=f;x<=g;x++){const v=o[2*x],b=o[2*x+1];v>=e&&v<=n&&b>=s&&b<=i&&u.push(r[x])}continue}const p=f+g>>1,y=o[2*p],_=o[2*p+1];y>=e&&y<=n&&_>=s&&_<=i&&u.push(r[p]),(h===0?e<=y:s<=_)&&(l.push(f),l.push(p-1),l.push(1-h)),(h===0?n>=y:i>=_)&&(l.push(p+1),l.push(g),l.push(1-h))}return u}within(e,s,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:r,nodeSize:o}=this,a=[0,i.length-1,0],l=[],u=n*n;for(;a.length;){const h=a.pop()||0,g=a.pop()||0,f=a.pop()||0;if(g-f<=o){for(let x=f;x<=g;x++)sw(r[2*x],r[2*x+1],e,s)<=u&&l.push(i[x]);continue}const p=f+g>>1,y=r[2*p],_=r[2*p+1];sw(y,_,e,s)<=u&&l.push(i[p]),(h===0?e-n<=y:s-n<=_)&&(a.push(f),a.push(p-1),a.push(1-h)),(h===0?e+n>=y:s+n>=_)&&(a.push(p+1),a.push(g),a.push(1-h))}return l}};function _x(t,e,s,n,i,r){if(i-n<=s)return;const o=n+i>>1;VM(t,e,o,n,i,r),_x(t,e,s,n,o-1,1-r),_x(t,e,s,o+1,i,1-r)}function VM(t,e,s,n,i,r){for(;i>n;){if(i-n>600){const u=i-n+1,h=s-n+1,g=Math.log(u),f=.5*Math.exp(2*g/3),p=.5*Math.sqrt(g*f*(u-f)/u)*(h-u/2<0?-1:1);VM(t,e,s,Math.max(n,Math.floor(s-h*f/u+p)),Math.min(i,Math.floor(s+(u-h)*f/u+p)),r)}const o=e[2*s+r];let a=n,l=i;for(fd(t,e,n,s),e[2*i+r]>o&&fd(t,e,n,i);a<l;){for(fd(t,e,a,l),a++,l--;e[2*a+r]<o;)a++;for(;e[2*l+r]>o;)l--}e[2*n+r]===o?fd(t,e,n,l):(l++,fd(t,e,l,i)),l<=s&&(n=l+1),s<=l&&(i=l-1)}}function fd(t,e,s,n){L_(t,s,n),L_(e,2*s,2*n),L_(e,2*s+1,2*n+1)}function L_(t,e,s){const n=t[e];t[e]=t[s],t[s]=n}function sw(t,e,s,n){const i=t-s,r=e-n;return i*i+r*r}var hY=t=>t/360+.5,cY=t=>{const e=Math.sin(t*Math.PI/180),s=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return s<0?0:s>1?1:s},gY=t=>{const e=Math.PI-2*Math.PI*t;return 360/Math.PI*Math.atan(Math.exp(e))-90},fY=t=>360*(t-.5);function pY(t,e,s,n,i,r){let o=t._indexes.length;const a=t.getData(r.modules.geo.latitudePath),l=t.getData(r.modules.geo.longitudePath),u=new Float32Array(o),h=new Float32Array(o),g=new Uint32Array(o),f=new Uint32Array(o),p=new Map,y=new Map;let _,x=-1,v=!0;for(let L=0;L<a.length;L++){const M=a[L],F=l[L];y.set(t._indexes[L],e[L]);const O=cY(M),G=hY(F);u[L]=O,h[L]=G,g[L]=t._indexes[L],x=Math.max(x,t._indexes[L])}let b=x+1;const[S,A]=s,w=[];for(let L=0,M=A;L<20;L++,M=A-(A-S)*L/19){if(v){_=new dY(o,64,Float32Array);for(let K=0;K<o;K++)_.add(h[K],u[K]);_.finish()}v=!1;const F=n/(i*Math.pow(2,M)),O=[],G=new Set,j=new Set;for(let K=0;K<o;K++){if(G.has(g[K]))continue;const ut=_.within(h[K],u[K],F);if(ut.length===0&&ut.push(K),ut.length===1){const pe=g[ut[0]];if(G.add(pe),p.has(pe)){j.add(pe);const ne=p.get(pe);O.push(ne),p.set(ne.id,ne),y.set(ne.id,ne.groupId)}continue}const ht=b++,nt=[];let ot=0;const Mt=y.get(g[K]);let Q=0,Et=0;for(let pe=0;pe<ut.length;pe++){const ne=ut[pe];if(!G.has(g[ne])&&Mt===y.get(g[ne])){if(G.add(g[ne]),j.add(g[ne]),p.has(g[ne])){const te=p.get(g[ne]),se=te.subNodes.size;ot+=se,Q+=te.mercatorLat*se,Et+=te.mercatorLng*se}else ot+=1,Q+=u[ne],Et+=h[ne];nt.push(g[ne])}}if(Q/=ot,Et/=ot,ot<2){j.delete(g[K]);continue}const Xt=new Uint32Array(ot);let Ht=0;for(let pe=0;pe<nt.length;pe++){const ne=nt[pe];if(p.has(ne)){const te=p.get(ne);for(let se=0;se<te.subNodes.size;se++)Xt[Ht++]=te.subNodes._indexes[se]}else Xt[Ht++]=ne}const Zt=r.nodeList(Xt);y.set(ht,Mt);const ae={id:ht,cellId:Math.round(Q/F/F+Et/F),groupId:Mt,step:L,zoom:M,lat:gY(Q),lng:fY(Et),mercatorLat:Q,mercatorLng:Et,subNodes:Zt};p.set(ae.id,ae),O.push(ae),v=!0}let Z=0,at=0;for(let K=0;K<o;K++)j.has(g[K])||(g[Z]=g[K],u[Z]=u[K],h[Z]=h[K],f[at]=g[K],Z++,at++);const pt=new Uint32Array(at);for(let K=0;K<at;K++)pt[K]=f[K];for(const K of O)g[Z]=K.id,u[Z]=K.mercatorLat,h[Z]=K.mercatorLng,Z++;o=at+O.length,(!(L>0)||O.length)&&w.push({zoom:M,clusters:O,unclusteredNodeIndexes:pt})}return w}var mY=256,_Y=class extends UM{constructor(t){super({...t,enabled:t.enabled&&t.ogma.geo.enabled(),showContents:!1,selector:e=>{const s=this.getPosition(e);return s&&!isNaN(s.x)&&!isNaN(s.y)&&(!t.selector||t.selector(e))},groupIdFunction:t.groupIdFunction,edgeGroupIdFunction:t.edgeGroupIdFunction,nodeGenerator:t.nodeGenerator}),this._clustersByZoom=[],this._nullZoomLevel={zoom:-1/0,nodes:this.ogma.nodeList(),edges:this.ogma.edgeList(),metaNodes:this.ogma.nodeList(),subNodes:[],subEdges:[],metaEdges:this.ogma.edgeList()},this._currentClusters=this._nullZoomLevel,this._zoomLevels=t.zoomLevels?t.zoomLevels:[0,22],this._groupingRadius=t.radius===void 0?60:t.radius,this._generateIdFunction=t.groupIdFunction||(()=>""),this._shouldEnable=t.enabled,this._shouldRefreshClusters=!0,this._selectedNodes=this.ogma.nodeList(),this._selectedEdges=this.ogma.edgeList(),this.ogma.events.on("beforeGeoCameraMove",(({zoom:e})=>{!this.isEnabled()||!this.ogma.geo.enabled()||Math.abs(this.getBestZoomLevel(e).zoom-this._currentClusters.zoom)<.01||(this._shouldRefreshClusters=!1,this.refresh())})).on("geoDisabled",(()=>{this.isEnabled()&&this.disable(0).then((()=>{this._shouldEnable=!0}))})).on("geoEnabled",(()=>{this._shouldEnable&&this.enable(0)}))}getPosition(t){return{x:t.getData(this.ogma.modules.geo.latitudePath),y:t.getData(this.ogma.modules.geo.longitudePath)}}getName(){return Xn.GeoClustering}enable(t){return this.ogma&&!this.ogma.geo.enabled()?(this._shouldEnable=!0,Promise.resolve()):super.enable(t)}undo(t=!0){const{metaNodes:e,metaEdges:s}=this._currentClusters;return e.setVisible(!1),s.setVisible(!1),this._selectedNodes.setVisible(!0),this._selectedEdges.setVisible(!0),Promise.resolve()}disable(t){return this._shouldEnable=!1,super.disable(t)}async onePassCluster(){const t=new Set,e=new Set;for(let o=0;o<this._clustersByZoom.length;o++){const a=this._clustersByZoom[o];this.module.removeMetaNodes(a.metaNodes),this.module.removeMetaEdges(a.metaEdges);for(let l=0;l<a.metaNodes._indexes.length;l++)t.add(a.metaNodes._indexes[l]);for(let l=0;l<a.metaEdges._indexes.length;l++)e.add(a.metaEdges._indexes[l])}const s=this.ogma.getNodes().filter((o=>this.nodeSelector(o)));this._selectedEdges=s.getAdjacentEdges({bothExtremities:!0});const n=[],i=s.map((o=>this._generateIdFunction(o))),r=pY(s,i,this._zoomLevels,this._groupingRadius,mY,this.ogma);for(let o=0;o<r.length;o++){const{clusters:a,zoom:l,unclusteredNodeIndexes:u}=r[o],h=a.map((({cellId:v,groupId:b,lat:S,lng:A,subNodes:w,step:L})=>{const M=this.nodeGenerator(w,b,this);return M.data||(M.data={}),Ia(M.data,this.ogma.modules.geo.latitudePath,S),Ia(M.data,this.ogma.modules.geo.longitudePath,A),M.id=`geo-cluster-${L}-${v}-${b}`,M}));await this.ogma.addNodes(h,{virtual:!0});const g=this.ogma.getNodes(h.map((v=>v.id))),f=a.map((v=>v.subNodes));this.assignMetaSubNodes(g,f);const{metaEdges:p,subEdges:y}=await this.addMetaEdges(g);for(let v=0;v<g._indexes.length;v++)t.delete(g._indexes[v]);for(let v=0;v<p._indexes.length;v++)e.delete(p._indexes[v]);const _=this.ogma.nodeList(u),x=_.getAdjacentEdges({bothExtremities:!0});this.module.removeMetaNodes(g),this.module.removeMetaEdges(p),g.setVisible(!1),p.setVisible(!1),n.push({nodes:_,edges:x,zoom:l,metaNodes:g,subNodes:f,subEdges:y,metaEdges:p})}this.ogma.removeNodes(this.ogma.nodeList(Array.from(t))),this.ogma.removeEdges(this.ogma.edgeList(Array.from(e))),this._clustersByZoom=n,this._selectedNodes=s}getBestZoomLevel(t){return this._clustersByZoom.reduce(((e,s)=>t<s.zoom?s:e),this._nullZoomLevel)}async run(){var t;this._shouldRefreshClusters&&await this.onePassCluster(),this._shouldRefreshClusters=!0;const e=this._currentClusters,s=((t=this.ogma.geo.getMap())==null?void 0:t.getZoom())||0,n=this.getBestZoomLevel(s);return this._currentClusters=n,e&&(this.module.removeMetaNodes(e.metaNodes),this.module.removeMetaEdges(e.metaEdges)),this._selectedEdges.setVisible(!1),this._selectedNodes.setVisible(!1),n.nodes.setVisible(!0),n.edges.setVisible(!0),n.metaNodes.setVisible(!0),n.metaEdges.setVisible(!0),this.assignMetaSubNodes(n.metaNodes,n.subNodes),this.assignMetaSubEdges(n.metaEdges,n.subEdges),this.ogma.modules.geo._updateNodesCoordinates(n.metaNodes),this.ogma.modules.geo.updateProjection(),[]}setOptions(t){const e=super.setOptions({...t,selector:s=>{const n=this.getPosition(s);return n&&!isNaN(n.x)&&!isNaN(n.y)&&(!t.selector||t.selector(s))},groupIdFunction:t.groupIdFunction,nodeGenerator:t.nodeGenerator,edgeGroupIdFunction:t.edgeGroupIdFunction});return this._groupingRadius=t.radius===void 0?this._groupingRadius:t.radius,this._generateIdFunction=t.groupIdFunction||this._generateIdFunction,this._shouldRefreshClusters=!0,this._shouldEnable=t.enabled,this._zoomLevels=t.zoomLevels!==void 0?t.zoomLevels:this._zoomLevels,e}},nw=()=>({}),yY=class extends na{constructor(t){super(t),this._groupSelfLoopEdges=!1,this._isCleaningUp=!1,this._isRunning=!1,this.shouldDo=!0,this.enabled=!1,this._onBeforeAdd=e=>{if(this._isCleaningUp||!this.enabled||e.virtual)return;const{isNode:s,objects:n}=e;if(s){const i=n;iw(i,this._groupNodes(i))}else{const i=n;iw(i,this._groupEdges(i))}this._shouldSetVirtual=!0},this._onAfterAdd=e=>{this._shouldSetVirtual&&(this._shouldSetVirtual=!1,this._setVirtual(e.nodes||e.edges,!!e.nodes))},this._onRequestElementsToDelete=e=>{if(e.virtual)return;const{ogma:s,context:n}=this,i=e.elementsToRemove.isNode,r=i?s.getNodes:s.getEdges,o=i?n.metaNodesSet:n.metaEdgesSet,a=i?n.nodeGroups:n.edgeGroups,l=i?s.removeNodes:s.removeEdges,u=e.elementsToRemove.size,h=r(Array.from(o)),g=e.elementsToRemove.slice();if(e.elementsToRemove=e.elementsToRemove.subtract(h),e.elementsToRemove.size===u)return;const f=g.subtract(e.elementsToRemove);if(f.forEach((p=>{a.delete(p.getId())})),i){const p=f.getAdjacentEdges().filter((y=>y.isVirtual()));s.removeEdges(p)}l(f,{virtual:!0})},this._nodeToGroupId=t.groupIdFunction||xu,this._groupSelfLoopEdges=!!t.groupSelfLoopEdges,this._nodeGenerator=t.nodeGenerator||nw,this._edgeGenerator=t.edgeGenerator||nw,this._shouldSetVirtual=!1,this._selector=t.selector,this.shouldDo=t.enabled===void 0||!!t.enabled,this.ogma.events.on("preAddElements",this._onBeforeAdd).on("requestElementsToDelete",this._onRequestElementsToDelete).on(["postAddGraph","addNodes","addEdges"],this._onAfterAdd),this.shouldDo&&(this.enable(),this.shouldDo=!1)}getName(){return Xn.NodeClustering}enable(){if(this.enabled)return Promise.resolve();this.enabled=!0,this.shouldDo=!0,this._isRunning=!0;const{ogma:t}=this;return t.getNodes().size?t.export.json({download:!1,edgeAttributes:"all",nodeAttributes:"all"}).then((e=>(t.clearGraph(),t.setGraph(e)))).then((()=>(this._isRunning=!1,Promise.resolve()))):(this._isRunning=!1,Promise.resolve())}disable(){return this.enabled?(this.enabled=!1,this.shouldDo=!1,super.disable()):Promise.resolve()}destroy(){return this.disable(),super.destroy()}run(){const{ogma:t}=this;return this.enabled||!this.shouldDo?Promise.resolve():t.export.json({download:!1,edgeAttributes:"all",nodeAttributes:"all"}).then((e=>(this._isCleaningUp=!0,t.clearGraph(),this._isCleaningUp=!1,t.setGraph(e))))}undo(){if(this._isRunning||this.enabled)return Promise.resolve();const{ogma:t,context:e}=this;this._isCleaningUp=!0;const s=t.getNodes(Array.from(e.metaNodesSet));this.module.removeMetaNodes(s);const n=t.getEdges(Array.from(e.metaEdgesSet));this.module.removeMetaEdges(n);const i=this._getSubNodes(),r=this._getSubEdges();return this.resetContext(),t.removeNodes(s,{virtual:!0}).then((()=>t.removeEdges(n,{virtual:!0}))).then((()=>t.addNodes(i))).then((()=>t.addEdges(r))).then((()=>{this._isCleaningUp=!1,Promise.resolve()}))}cleanup(){return this._isRunning||this.ogma.events.off(this._onBeforeAdd).off(this._onRequestElementsToDelete).off(this._onAfterAdd),Promise.resolve()}resetContext(){this._isRunning||(this.context={nodeGroups:new Map,edgeGroups:new Map,metaNodesSet:new Set,metaEdgesSet:new Set,virtualNodes:this.ogma.createNodeList(),virtualEdges:this.ogma.createEdgeList(),nodeToGroupId:new Map})}getSubNodes(t){const e=this.context.nodeGroups.get(t.getId());return e?e.nodes:[]}getSubEdges(t){const e=this.context.edgeGroups.get(t.getId());return e?e.edges:[]}_getSubNodes(){return Array.from(this.context.nodeGroups.values()).reduce(((t,{nodes:e})=>(t.push(...e),t)),[])}_getSubEdges(){return Array.from(this.context.edgeGroups.values()).reduce(((t,{edges:e})=>(t.push(...e),t)),[])}_setVirtual(t,e){if(!t)return;const{context:s}=this,n=e?s.metaNodesSet:s.metaEdgesSet,i=t.filter((r=>n.has(r.getId())));if(e)for(let r=0;r<i.size;r++)this.module.setTransformation(i._indexes[r],this,e),this.module.setSubNodes(i._indexes[r],null);else for(let r=0;r<i.size;r++)this.module.setTransformation(i._indexes[r],this,e),this.module.setSubEdges(i._indexes[r],null);e?s.virtualNodes=s.virtualNodes.concat(i):s.virtualEdges=s.virtualEdges.concat(i)}setContext(){}_computeEdgeGroupId(t,e){return t>e?`${e}:${t}`:`${t}:${e}`}_groupEdges(t){const{ogma:e,id:s,context:n}=this,i=s,r=new Map,o=n.nodeToGroupId;n.edgeGroups.forEach((h=>{h.newEdges=[],r.set(h.id,h)}));const a=[];for(let h=0;h<t.length;++h){const g=t[h];let f=n.nodeToGroupId.get(g.source),p=n.nodeToGroupId.get(g.target);if(!f&&!p){a.push(g);continue}f=f||g.source,p=p||g.target;const y=this._computeEdgeGroupId(f,p);if(y!==void 0){const _=o.get(g.source)||g.source,x=o.get(g.target)||g.target;let v=r.get(y);v||(v={id:y,source:_,target:x,edges:[],newEdges:[]},r.set(y,v)),v.edges.push(g),v.newEdges.push(g)}}const l=kf(r),u=l.map((({edges:h})=>h));for(let h=0;h<l.length;++h){const g=l[h];if(!g.newEdges.length)continue;const f=g.id,p=u[h],y=this._edgeGenerator(p,f);y.id===void 0&&(y.id=Mf(f,i)),y.source=g.source,y.target=g.target,g.metaEdge=y,n.metaEdgesSet.add(y.id),n.edgeGroups.get(y.id)||n.edgeGroups.set(y.id,g),(this._groupSelfLoopEdges||y.source!==y.target)&&a.push(y)}return e.view.afterNextFrame().then((()=>{n.edgeGroups.forEach((({newEdges:h,metaEdge:g})=>{if(!(h.length&&g&&g.id&&g.attributes))return;const f=e.getEdge(g.id);f==null||f.setAttributes(g.attributes)}))})),a}_groupNodes(t){const{id:e,context:s,ogma:n}=this,i=e,r=new Map;s.nodeGroups.forEach((g=>{g.newNodes=[],r.set(g.id,g)}));const o=[];for(let g=0;g<t.length;g++){const f=t[g];if(this._selector&&!this._selector(f)){o.push(f);continue}f.id=Bq(f.id);const p=this._nodeToGroupId(f);if(p!==void 0){let y=r.get(p);y||(y={id:p,nodes:[],newNodes:[]},r.set(p,y)),y.nodes.push(f),y.newNodes.push(f)}else s.nodeToGroupId.set(f.id,f.id)}const a=kf(r),l=a.map((({nodes:g})=>g)),u=a.map((({newNodes:g})=>g)),h=[];for(let g=0;g<a.length;++g){if(!a[g].newNodes.length)continue;const f=a[g].id,p=l[g],y=this._nodeGenerator(p,f);a[g].metaNode=y,y.id===void 0&&(y.id=Mf(f,i));for(const _ of u[g])s.nodeToGroupId.set(_.id,y.id);s.metaNodesSet.add(y.id),s.nodeGroups.get(y.id)||s.nodeGroups.set(y.id,a[g]),h.push(y)}return h.push(...o),n.view.afterNextFrame().then((()=>{s.nodeGroups.forEach((({newNodes:g,metaNode:f})=>{if(!(g.length&&f&&f.id&&f.attributes))return;const p=n.getNode(f.id);p==null||p.setAttributes(f.attributes)}))})),h}setOptions(t){return this._nodeToGroupId=t.groupIdFunction||this._nodeToGroupId,this._groupSelfLoopEdges=t.groupSelfLoopEdges!==void 0?!!t.groupSelfLoopEdges:this._groupSelfLoopEdges,this._nodeGenerator=t.nodeGenerator||this._nodeGenerator,this._edgeGenerator=t.edgeGenerator||this._edgeGenerator,this._selector=t.selector||this._selector,this.disable().then((()=>this.undo())).then((()=>this.ogma.view.afterNextFrame())).then((()=>this.enable()))}onRemove(){}};function iw(t,e){const s=e.length;return t.length=s,t.splice(0,s,...e),t}function Wr(t){return t.enabled!==!1}var xY=class extends Wq{_setOptions(t){const e=t;return e.ogma=this.ogma,e.module=this,e.id=this.transformations.length,e}addNodeGrouping(t={}){const e=new UM(this._setOptions(t));return this.addTransformation(e,Wr(t)),e}addEdgeGrouping(t={}){const e=new uY(this._setOptions(t));return this.addTransformation(e,Wr(t)),e}addGeoClustering(t={}){const e=new _Y(this._setOptions(t));return this.addTransformation(e,t.enabled),e}addNodeFilter(t={}){let e={};e=typeof t=="function"?{criteria:t}:t;const s=new Qq(this._setOptions(e));return this.addTransformation(s,Wr(e)),s}addEdgeFilter(t={}){let e={};e=typeof t=="function"?{criteria:t}:t;const s=new Jq(this._setOptions(e));return this.addTransformation(s,Wr(e)),s}addNeighborMerging(t){const e=new tY(this._setOptions(t));return this.addTransformation(e,Wr(t)),e}addNeighborGeneration(t){const e=new nY(this._setOptions(t));return this.addTransformation(e,Wr(t)),e}addNodeCollapsing(t={}){const e=new oY(this._setOptions(t));return this.addTransformation(e,Wr(t)),e}addVirtualProperties(t={}){const e=new lY(this._setOptions(t));return this.addTransformation(e,Wr(t)),e}addNodeClustering(t={}){const e=new yY(this._setOptions(t));return this.addTransformation(e,Wr(t)),e}addDrilldown(t={onGetSubgraph:()=>Promise.resolve({nodes:[],edges:[]})}){const e=new Uq(this._setOptions(t));return this.drilldownController.addDrilldown(e),e}onGroupsUpdated(t){this.groupController.layoutController.onGroupsUpdate=t}triggerGroupsUpdated(){this.groupController.triggerGroupsUpdate()}layoutGroups(t,e,s=!1){return this.groupController.layoutGroups(t,e,s)}getXYR(t){return this.animations.getXYR(t)}fishEyeExpand(t,e,s){return this.groupController.fishEyeExpand(t,e,s)}fishEyeCollapse(t,e){return this.groupController.fishEyeCollapse(t,e)}},vY=U0,jt=yh();const rs=DI(jt);var Do={},Sa={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rw;function bY(){if(rw)return Sa;rw=1;var t=yh();function e(C){for(var R="https://reactjs.org/docs/error-decoder.html?invariant="+C,U=1;U<arguments.length;U++)R+="&args[]="+encodeURIComponent(arguments[U]);return"Minified React error #"+C+"; visit "+R+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=Object.prototype.hasOwnProperty,n=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,i={},r={};function o(C){return s.call(r,C)?!0:s.call(i,C)?!1:n.test(C)?r[C]=!0:(i[C]=!0,!1)}function a(C,R,U,W,St,bt,It){this.acceptsBooleans=R===2||R===3||R===4,this.attributeName=W,this.attributeNamespace=St,this.mustUseProperty=U,this.propertyName=C,this.type=R,this.sanitizeURL=bt,this.removeEmptyString=It}var l={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(C){l[C]=new a(C,0,!1,C,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(C){var R=C[0];l[R]=new a(R,1,!1,C[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(C){l[C]=new a(C,2,!1,C.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(C){l[C]=new a(C,2,!1,C,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(C){l[C]=new a(C,3,!1,C.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(C){l[C]=new a(C,3,!0,C,null,!1,!1)}),["capture","download"].forEach(function(C){l[C]=new a(C,4,!1,C,null,!1,!1)}),["cols","rows","size","span"].forEach(function(C){l[C]=new a(C,6,!1,C,null,!1,!1)}),["rowSpan","start"].forEach(function(C){l[C]=new a(C,5,!1,C.toLowerCase(),null,!1,!1)});var u=/[\-:]([a-z])/g;function h(C){return C[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(C){var R=C.replace(u,h);l[R]=new a(R,1,!1,C,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(C){var R=C.replace(u,h);l[R]=new a(R,1,!1,C,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(C){var R=C.replace(u,h);l[R]=new a(R,1,!1,C,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(C){l[C]=new a(C,1,!1,C.toLowerCase(),null,!1,!1)}),l.xlinkHref=new a("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(C){l[C]=new a(C,1,!1,C.toLowerCase(),null,!0,!0)});var g={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},f=["Webkit","ms","Moz","O"];Object.keys(g).forEach(function(C){f.forEach(function(R){R=R+C.charAt(0).toUpperCase()+C.substring(1),g[R]=g[C]})});var p=/["'&<>]/;function y(C){if(typeof C=="boolean"||typeof C=="number")return""+C;C=""+C;var R=p.exec(C);if(R){var U="",W,St=0;for(W=R.index;W<C.length;W++){switch(C.charCodeAt(W)){case 34:R="&quot;";break;case 38:R="&amp;";break;case 39:R="&#x27;";break;case 60:R="&lt;";break;case 62:R="&gt;";break;default:continue}St!==W&&(U+=C.substring(St,W)),St=W+1,U+=R}C=St!==W?U+C.substring(St,W):U}return C}var _=/([A-Z])/g,x=/^ms-/,v=Array.isArray;function b(C,R){return{insertionMode:C,selectedValue:R}}function S(C,R,U){switch(R){case"select":return b(1,U.value!=null?U.value:U.defaultValue);case"svg":return b(2,null);case"math":return b(3,null);case"foreignObject":return b(1,null);case"table":return b(4,null);case"thead":case"tbody":case"tfoot":return b(5,null);case"colgroup":return b(7,null);case"tr":return b(6,null)}return 4<=C.insertionMode||C.insertionMode===0?b(1,null):C}var A=new Map;function w(C,R,U){if(typeof U!="object")throw Error(e(62));R=!0;for(var W in U)if(s.call(U,W)){var St=U[W];if(St!=null&&typeof St!="boolean"&&St!==""){if(W.indexOf("--")===0){var bt=y(W);St=y((""+St).trim())}else{bt=W;var It=A.get(bt);It!==void 0||(It=y(bt.replace(_,"-$1").toLowerCase().replace(x,"-ms-")),A.set(bt,It)),bt=It,St=typeof St=="number"?St===0||s.call(g,W)?""+St:St+"px":y((""+St).trim())}R?(R=!1,C.push(' style="',bt,":",St)):C.push(";",bt,":",St)}}R||C.push('"')}function L(C,R,U,W){switch(U){case"style":w(C,R,W);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<U.length)||U[0]!=="o"&&U[0]!=="O"||U[1]!=="n"&&U[1]!=="N"){if(R=l.hasOwnProperty(U)?l[U]:null,R!==null){switch(typeof W){case"function":case"symbol":return;case"boolean":if(!R.acceptsBooleans)return}switch(U=R.attributeName,R.type){case 3:W&&C.push(" ",U,'=""');break;case 4:W===!0?C.push(" ",U,'=""'):W!==!1&&C.push(" ",U,'="',y(W),'"');break;case 5:isNaN(W)||C.push(" ",U,'="',y(W),'"');break;case 6:!isNaN(W)&&1<=W&&C.push(" ",U,'="',y(W),'"');break;default:R.sanitizeURL&&(W=""+W),C.push(" ",U,'="',y(W),'"')}}else if(o(U)){switch(typeof W){case"function":case"symbol":return;case"boolean":if(R=U.toLowerCase().slice(0,5),R!=="data-"&&R!=="aria-")return}C.push(" ",U,'="',y(W),'"')}}}function M(C,R,U){if(R!=null){if(U!=null)throw Error(e(60));if(typeof R!="object"||!("__html"in R))throw Error(e(61));R=R.__html,R!=null&&C.push(""+R)}}function F(C){var R="";return t.Children.forEach(C,function(U){U!=null&&(R+=U)}),R}function O(C,R,U,W){C.push(Z(U));var St=U=null,bt;for(bt in R)if(s.call(R,bt)){var It=R[bt];if(It!=null)switch(bt){case"children":U=It;break;case"dangerouslySetInnerHTML":St=It;break;default:L(C,W,bt,It)}}return C.push(">"),M(C,St,U),typeof U=="string"?(C.push(y(U)),null):U}var G=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,j=new Map;function Z(C){var R=j.get(C);if(R===void 0){if(!G.test(C))throw Error(e(65,C));R="<"+C,j.set(C,R)}return R}function at(C,R,U,W,St){switch(R){case"select":C.push(Z("select"));var bt=null,It=null;for(we in U)if(s.call(U,we)){var Qt=U[we];if(Qt!=null)switch(we){case"children":bt=Qt;break;case"dangerouslySetInnerHTML":It=Qt;break;case"defaultValue":case"value":break;default:L(C,W,we,Qt)}}return C.push(">"),M(C,It,bt),bt;case"option":It=St.selectedValue,C.push(Z("option"));var ie=Qt=null,Ee=null,we=null;for(bt in U)if(s.call(U,bt)){var We=U[bt];if(We!=null)switch(bt){case"children":Qt=We;break;case"selected":Ee=We;break;case"dangerouslySetInnerHTML":we=We;break;case"value":ie=We;default:L(C,W,bt,We)}}if(It!=null)if(U=ie!==null?""+ie:F(Qt),v(It)){for(W=0;W<It.length;W++)if(""+It[W]===U){C.push(' selected=""');break}}else""+It===U&&C.push(' selected=""');else Ee&&C.push(' selected=""');return C.push(">"),M(C,we,Qt),Qt;case"textarea":C.push(Z("textarea")),we=It=bt=null;for(Qt in U)if(s.call(U,Qt)&&(ie=U[Qt],ie!=null))switch(Qt){case"children":we=ie;break;case"value":bt=ie;break;case"defaultValue":It=ie;break;case"dangerouslySetInnerHTML":throw Error(e(91));default:L(C,W,Qt,ie)}if(bt===null&&It!==null&&(bt=It),C.push(">"),we!=null){if(bt!=null)throw Error(e(92));if(v(we)&&1<we.length)throw Error(e(93));bt=""+we}return typeof bt=="string"&&bt[0]===`
`&&C.push(`
`),bt!==null&&C.push(y(""+bt)),null;case"input":C.push(Z("input")),ie=we=Qt=bt=null;for(It in U)if(s.call(U,It)&&(Ee=U[It],Ee!=null))switch(It){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,"input"));case"defaultChecked":ie=Ee;break;case"defaultValue":Qt=Ee;break;case"checked":we=Ee;break;case"value":bt=Ee;break;default:L(C,W,It,Ee)}return we!==null?L(C,W,"checked",we):ie!==null&&L(C,W,"checked",ie),bt!==null?L(C,W,"value",bt):Qt!==null&&L(C,W,"value",Qt),C.push("/>"),null;case"menuitem":C.push(Z("menuitem"));for(var us in U)if(s.call(U,us)&&(bt=U[us],bt!=null))switch(us){case"children":case"dangerouslySetInnerHTML":throw Error(e(400));default:L(C,W,us,bt)}return C.push(">"),null;case"title":C.push(Z("title")),bt=null;for(We in U)if(s.call(U,We)&&(It=U[We],It!=null))switch(We){case"children":bt=It;break;case"dangerouslySetInnerHTML":throw Error(e(434));default:L(C,W,We,It)}return C.push(">"),bt;case"listing":case"pre":C.push(Z(R)),It=bt=null;for(ie in U)if(s.call(U,ie)&&(Qt=U[ie],Qt!=null))switch(ie){case"children":bt=Qt;break;case"dangerouslySetInnerHTML":It=Qt;break;default:L(C,W,ie,Qt)}if(C.push(">"),It!=null){if(bt!=null)throw Error(e(60));if(typeof It!="object"||!("__html"in It))throw Error(e(61));U=It.__html,U!=null&&(typeof U=="string"&&0<U.length&&U[0]===`
`?C.push(`
`,U):C.push(""+U))}return typeof bt=="string"&&bt[0]===`
`&&C.push(`
`),bt;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":C.push(Z(R));for(var ms in U)if(s.call(U,ms)&&(bt=U[ms],bt!=null))switch(ms){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,R));default:L(C,W,ms,bt)}return C.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return O(C,U,R,W);case"html":return St.insertionMode===0&&C.push("<!DOCTYPE html>"),O(C,U,R,W);default:if(R.indexOf("-")===-1&&typeof U.is!="string")return O(C,U,R,W);C.push(Z(R)),It=bt=null;for(Ee in U)if(s.call(U,Ee)&&(Qt=U[Ee],Qt!=null))switch(Ee){case"children":bt=Qt;break;case"dangerouslySetInnerHTML":It=Qt;break;case"style":w(C,W,Qt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:o(Ee)&&typeof Qt!="function"&&typeof Qt!="symbol"&&C.push(" ",Ee,'="',y(Qt),'"')}return C.push(">"),M(C,It,bt),bt}}function pt(C,R,U){if(C.push('<!--$?--><template id="'),U===null)throw Error(e(395));return C.push(U),C.push('"></template>')}function K(C,R,U,W){switch(U.insertionMode){case 0:case 1:return C.push('<div hidden id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 2:return C.push('<svg aria-hidden="true" style="display:none" id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 3:return C.push('<math aria-hidden="true" style="display:none" id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 4:return C.push('<table hidden id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 5:return C.push('<table hidden><tbody id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 6:return C.push('<table hidden><tr id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 7:return C.push('<table hidden><colgroup id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');default:throw Error(e(397))}}function ut(C,R){switch(R.insertionMode){case 0:case 1:return C.push("</div>");case 2:return C.push("</svg>");case 3:return C.push("</math>");case 4:return C.push("</table>");case 5:return C.push("</tbody></table>");case 6:return C.push("</tr></table>");case 7:return C.push("</colgroup></table>");default:throw Error(e(397))}}var ht=/[<\u2028\u2029]/g;function nt(C){return JSON.stringify(C).replace(ht,function(R){switch(R){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function ot(C,R){return R=R===void 0?"":R,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:R+"P:",segmentPrefix:R+"S:",boundaryPrefix:R+"B:",idPrefix:R,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:C}}function Mt(C,R,U,W){return U.generateStaticMarkup?(C.push(y(R)),!1):(R===""?C=W:(W&&C.push("<!-- -->"),C.push(y(R)),C=!0),C)}var Q=Object.assign,Et=Symbol.for("react.element"),Xt=Symbol.for("react.portal"),Ht=Symbol.for("react.fragment"),Zt=Symbol.for("react.strict_mode"),ae=Symbol.for("react.profiler"),pe=Symbol.for("react.provider"),ne=Symbol.for("react.context"),te=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),Ce=Symbol.for("react.memo"),ve=Symbol.for("react.lazy"),Me=Symbol.for("react.scope"),ge=Symbol.for("react.debug_trace_mode"),ze=Symbol.for("react.legacy_hidden"),is=Symbol.for("react.default_value"),Ge=Symbol.iterator;function De(C){if(C==null)return null;if(typeof C=="function")return C.displayName||C.name||null;if(typeof C=="string")return C;switch(C){case Ht:return"Fragment";case Xt:return"Portal";case ae:return"Profiler";case Zt:return"StrictMode";case se:return"Suspense";case ce:return"SuspenseList"}if(typeof C=="object")switch(C.$$typeof){case ne:return(C.displayName||"Context")+".Consumer";case pe:return(C._context.displayName||"Context")+".Provider";case te:var R=C.render;return C=C.displayName,C||(C=R.displayName||R.name||"",C=C!==""?"ForwardRef("+C+")":"ForwardRef"),C;case Ce:return R=C.displayName||null,R!==null?R:De(C.type)||"Memo";case ve:R=C._payload,C=C._init;try{return De(C(R))}catch{}}return null}var He={};function Je(C,R){if(C=C.contextTypes,!C)return He;var U={},W;for(W in C)U[W]=R[W];return U}var ss=null;function ts(C,R){if(C!==R){C.context._currentValue2=C.parentValue,C=C.parent;var U=R.parent;if(C===null){if(U!==null)throw Error(e(401))}else{if(U===null)throw Error(e(401));ts(C,U)}R.context._currentValue2=R.value}}function hs(C){C.context._currentValue2=C.parentValue,C=C.parent,C!==null&&hs(C)}function Fe(C){var R=C.parent;R!==null&&Fe(R),C.context._currentValue2=C.value}function Oe(C,R){if(C.context._currentValue2=C.parentValue,C=C.parent,C===null)throw Error(e(402));C.depth===R.depth?ts(C,R):Oe(C,R)}function Ns(C,R){var U=R.parent;if(U===null)throw Error(e(402));C.depth===U.depth?ts(C,U):Ns(C,U),R.context._currentValue2=R.value}function zs(C){var R=ss;R!==C&&(R===null?Fe(C):C===null?hs(R):R.depth===C.depth?ts(R,C):R.depth>C.depth?Oe(R,C):Ns(R,C),ss=C)}var $s={isMounted:function(){return!1},enqueueSetState:function(C,R){C=C._reactInternals,C.queue!==null&&C.queue.push(R)},enqueueReplaceState:function(C,R){C=C._reactInternals,C.replace=!0,C.queue=[R]},enqueueForceUpdate:function(){}};function Ms(C,R,U,W){var St=C.state!==void 0?C.state:null;C.updater=$s,C.props=U,C.state=St;var bt={queue:[],replace:!1};C._reactInternals=bt;var It=R.contextType;if(C.context=typeof It=="object"&&It!==null?It._currentValue2:W,It=R.getDerivedStateFromProps,typeof It=="function"&&(It=It(U,St),St=It==null?St:Q({},St,It),C.state=St),typeof R.getDerivedStateFromProps!="function"&&typeof C.getSnapshotBeforeUpdate!="function"&&(typeof C.UNSAFE_componentWillMount=="function"||typeof C.componentWillMount=="function"))if(R=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),R!==C.state&&$s.enqueueReplaceState(C,C.state,null),bt.queue!==null&&0<bt.queue.length)if(R=bt.queue,It=bt.replace,bt.queue=null,bt.replace=!1,It&&R.length===1)C.state=R[0];else{for(bt=It?R[0]:C.state,St=!0,It=It?1:0;It<R.length;It++){var Qt=R[It];Qt=typeof Qt=="function"?Qt.call(C,bt,U,W):Qt,Qt!=null&&(St?(St=!1,bt=Q({},bt,Qt)):Q(bt,Qt))}C.state=bt}else bt.queue=null}var An={id:1,overflow:""};function fn(C,R,U){var W=C.id;C=C.overflow;var St=32-un(W)-1;W&=~(1<<St),U+=1;var bt=32-un(R)+St;if(30<bt){var It=St-St%5;return bt=(W&(1<<It)-1).toString(32),W>>=It,St-=It,{id:1<<32-un(R)+St|U<<St|W,overflow:bt+C}}return{id:1<<bt|U<<St|W,overflow:C}}var un=Math.clz32?Math.clz32:gt,xs=Math.log,Ds=Math.LN2;function gt(C){return C>>>=0,C===0?32:31-(xs(C)/Ds|0)|0}function k(C,R){return C===R&&(C!==0||1/C===1/R)||C!==C&&R!==R}var P=typeof Object.is=="function"?Object.is:k,D=null,B=null,$=null,H=null,X=!1,lt=!1,dt=0,ct=null,mt=0;function yt(){if(D===null)throw Error(e(321));return D}function Nt(){if(0<mt)throw Error(e(312));return{memoizedState:null,queue:null,next:null}}function Tt(){return H===null?$===null?(X=!1,$=H=Nt()):(X=!0,H=$):H.next===null?(X=!1,H=H.next=Nt()):(X=!0,H=H.next),H}function At(){B=D=null,lt=!1,$=null,mt=0,H=ct=null}function Ut(C,R){return typeof R=="function"?R(C):R}function he(C,R,U){if(D=yt(),H=Tt(),X){var W=H.queue;if(R=W.dispatch,ct!==null&&(U=ct.get(W),U!==void 0)){ct.delete(W),W=H.memoizedState;do W=C(W,U.action),U=U.next;while(U!==null);return H.memoizedState=W,[W,R]}return[H.memoizedState,R]}return C=C===Ut?typeof R=="function"?R():R:U!==void 0?U(R):R,H.memoizedState=C,C=H.queue={last:null,dispatch:null},C=C.dispatch=be.bind(null,D,C),[H.memoizedState,C]}function xe(C,R){if(D=yt(),H=Tt(),R=R===void 0?null:R,H!==null){var U=H.memoizedState;if(U!==null&&R!==null){var W=U[1];t:if(W===null)W=!1;else{for(var St=0;St<W.length&&St<R.length;St++)if(!P(R[St],W[St])){W=!1;break t}W=!0}if(W)return U[0]}}return C=C(),H.memoizedState=[C,R],C}function be(C,R,U){if(25<=mt)throw Error(e(301));if(C===D)if(lt=!0,C={action:U,next:null},ct===null&&(ct=new Map),U=ct.get(R),U===void 0)ct.set(R,C);else{for(R=U;R.next!==null;)R=R.next;R.next=C}}function ue(){throw Error(e(394))}function _e(){}var Te={readContext:function(C){return C._currentValue2},useContext:function(C){return yt(),C._currentValue2},useMemo:xe,useReducer:he,useRef:function(C){D=yt(),H=Tt();var R=H.memoizedState;return R===null?(C={current:C},H.memoizedState=C):R},useState:function(C){return he(Ut,C)},useInsertionEffect:_e,useLayoutEffect:function(){},useCallback:function(C,R){return xe(function(){return C},R)},useImperativeHandle:_e,useEffect:_e,useDebugValue:_e,useDeferredValue:function(C){return yt(),C},useTransition:function(){return yt(),[!1,ue]},useId:function(){var C=B.treeContext,R=C.overflow;C=C.id,C=(C&~(1<<32-un(C)-1)).toString(32)+R;var U=Ve;if(U===null)throw Error(e(404));return R=dt++,C=":"+U.idPrefix+"R"+C,0<R&&(C+="H"+R.toString(32)),C+":"},useMutableSource:function(C,R){return yt(),R(C._source)},useSyncExternalStore:function(C,R,U){if(U===void 0)throw Error(e(407));return U()}},Ve=null,Ie=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function je(C){return console.error(C),null}function Pe(){}function Be(C,R,U,W,St,bt,It,Qt,ie){var Ee=[],we=new Set;return R={destination:null,responseState:R,progressiveChunkSize:W===void 0?12800:W,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:we,pingedTasks:Ee,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:St===void 0?je:St,onAllReady:Pe,onShellReady:It===void 0?Pe:It,onShellError:Pe,onFatalError:Pe},U=es(R,0,null,U,!1,!1),U.parentFlushed=!0,C=Ue(R,C,null,U,we,He,null,An),Ee.push(C),R}function Ue(C,R,U,W,St,bt,It,Qt){C.allPendingTasks++,U===null?C.pendingRootTasks++:U.pendingTasks++;var ie={node:R,ping:function(){var Ee=C.pingedTasks;Ee.push(ie),Ee.length===1&&Lt(C)},blockedBoundary:U,blockedSegment:W,abortSet:St,legacyContext:bt,context:It,treeContext:Qt};return St.add(ie),ie}function es(C,R,U,W,St,bt){return{status:0,id:-1,index:R,parentFlushed:!1,chunks:[],children:[],formatContext:W,boundary:U,lastPushedText:St,textEmbedded:bt}}function os(C,R){if(C=C.onError(R),C!=null&&typeof C!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof C+'" instead');return C}function cs(C,R){var U=C.onShellError;U(R),U=C.onFatalError,U(R),C.destination!==null?(C.status=2,C.destination.destroy(R)):(C.status=1,C.fatalError=R)}function Y(C,R,U,W,St){for(D={},B=R,dt=0,C=U(W,St);lt;)lt=!1,dt=0,mt+=1,H=null,C=U(W,St);return At(),C}function et(C,R,U,W){var St=U.render(),bt=W.childContextTypes;if(bt!=null){var It=R.legacyContext;if(typeof U.getChildContext!="function")W=It;else{U=U.getChildContext();for(var Qt in U)if(!(Qt in bt))throw Error(e(108,De(W)||"Unknown",Qt));W=Q({},It,U)}R.legacyContext=W,ft(C,R,St),R.legacyContext=It}else ft(C,R,St)}function J(C,R){if(C&&C.defaultProps){R=Q({},R),C=C.defaultProps;for(var U in C)R[U]===void 0&&(R[U]=C[U]);return R}return R}function tt(C,R,U,W,St){if(typeof U=="function")if(U.prototype&&U.prototype.isReactComponent){St=Je(U,R.legacyContext);var bt=U.contextType;bt=new U(W,typeof bt=="object"&&bt!==null?bt._currentValue2:St),Ms(bt,U,W,St),et(C,R,bt,U)}else{bt=Je(U,R.legacyContext),St=Y(C,R,U,W,bt);var It=dt!==0;if(typeof St=="object"&&St!==null&&typeof St.render=="function"&&St.$$typeof===void 0)Ms(St,U,W,bt),et(C,R,St,U);else if(It){W=R.treeContext,R.treeContext=fn(W,1,0);try{ft(C,R,St)}finally{R.treeContext=W}}else ft(C,R,St)}else if(typeof U=="string"){switch(St=R.blockedSegment,bt=at(St.chunks,U,W,C.responseState,St.formatContext),St.lastPushedText=!1,It=St.formatContext,St.formatContext=S(It,U,W),it(C,R,bt),St.formatContext=It,U){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:St.chunks.push("</",U,">")}St.lastPushedText=!1}else{switch(U){case ze:case ge:case Zt:case ae:case Ht:ft(C,R,W.children);return;case ce:ft(C,R,W.children);return;case Me:throw Error(e(343));case se:t:{U=R.blockedBoundary,St=R.blockedSegment,bt=W.fallback,W=W.children,It=new Set;var Qt={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:It,errorDigest:null},ie=es(C,St.chunks.length,Qt,St.formatContext,!1,!1);St.children.push(ie),St.lastPushedText=!1;var Ee=es(C,0,null,St.formatContext,!1,!1);Ee.parentFlushed=!0,R.blockedBoundary=Qt,R.blockedSegment=Ee;try{if(it(C,R,W),C.responseState.generateStaticMarkup||Ee.lastPushedText&&Ee.textEmbedded&&Ee.chunks.push("<!-- -->"),Ee.status=1,Ft(Qt,Ee),Qt.pendingTasks===0)break t}catch(we){Ee.status=4,Qt.forceClientRender=!0,Qt.errorDigest=os(C,we)}finally{R.blockedBoundary=U,R.blockedSegment=St}R=Ue(C,bt,U,ie,It,R.legacyContext,R.context,R.treeContext),C.pingedTasks.push(R)}return}if(typeof U=="object"&&U!==null)switch(U.$$typeof){case te:if(W=Y(C,R,U.render,W,St),dt!==0){U=R.treeContext,R.treeContext=fn(U,1,0);try{ft(C,R,W)}finally{R.treeContext=U}}else ft(C,R,W);return;case Ce:U=U.type,W=J(U,W),tt(C,R,U,W,St);return;case pe:if(St=W.children,U=U._context,W=W.value,bt=U._currentValue2,U._currentValue2=W,It=ss,ss=W={parent:It,depth:It===null?0:It.depth+1,context:U,parentValue:bt,value:W},R.context=W,ft(C,R,St),C=ss,C===null)throw Error(e(403));W=C.parentValue,C.context._currentValue2=W===is?C.context._defaultValue:W,C=ss=C.parent,R.context=C;return;case ne:W=W.children,W=W(U._currentValue2),ft(C,R,W);return;case ve:St=U._init,U=St(U._payload),W=J(U,W),tt(C,R,U,W,void 0);return}throw Error(e(130,U==null?U:typeof U,""))}}function ft(C,R,U){if(R.node=U,typeof U=="object"&&U!==null){switch(U.$$typeof){case Et:tt(C,R,U.type,U.props,U.ref);return;case Xt:throw Error(e(257));case ve:var W=U._init;U=W(U._payload),ft(C,R,U);return}if(v(U)){_t(C,R,U);return}if(U===null||typeof U!="object"?W=null:(W=Ge&&U[Ge]||U["@@iterator"],W=typeof W=="function"?W:null),W&&(W=W.call(U))){if(U=W.next(),!U.done){var St=[];do St.push(U.value),U=W.next();while(!U.done);_t(C,R,St)}return}throw C=Object.prototype.toString.call(U),Error(e(31,C==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":C))}typeof U=="string"?(W=R.blockedSegment,W.lastPushedText=Mt(R.blockedSegment.chunks,U,C.responseState,W.lastPushedText)):typeof U=="number"&&(W=R.blockedSegment,W.lastPushedText=Mt(R.blockedSegment.chunks,""+U,C.responseState,W.lastPushedText))}function _t(C,R,U){for(var W=U.length,St=0;St<W;St++){var bt=R.treeContext;R.treeContext=fn(bt,W,St);try{it(C,R,U[St])}finally{R.treeContext=bt}}}function it(C,R,U){var W=R.blockedSegment.formatContext,St=R.legacyContext,bt=R.context;try{return ft(C,R,U)}catch(ie){if(At(),typeof ie=="object"&&ie!==null&&typeof ie.then=="function"){U=ie;var It=R.blockedSegment,Qt=es(C,It.chunks.length,null,It.formatContext,It.lastPushedText,!0);It.children.push(Qt),It.lastPushedText=!1,C=Ue(C,R.node,R.blockedBoundary,Qt,R.abortSet,R.legacyContext,R.context,R.treeContext).ping,U.then(C,C),R.blockedSegment.formatContext=W,R.legacyContext=St,R.context=bt,zs(bt)}else throw R.blockedSegment.formatContext=W,R.legacyContext=St,R.context=bt,zs(bt),ie}}function vt(C){var R=C.blockedBoundary;C=C.blockedSegment,C.status=3,Pt(this,R,C)}function Ct(C,R,U){var W=C.blockedBoundary;C.blockedSegment.status=3,W===null?(R.allPendingTasks--,R.status!==2&&(R.status=2,R.destination!==null&&R.destination.push(null))):(W.pendingTasks--,W.forceClientRender||(W.forceClientRender=!0,C=U===void 0?Error(e(432)):U,W.errorDigest=R.onError(C),W.parentFlushed&&R.clientRenderedBoundaries.push(W)),W.fallbackAbortableTasks.forEach(function(St){return Ct(St,R,U)}),W.fallbackAbortableTasks.clear(),R.allPendingTasks--,R.allPendingTasks===0&&(W=R.onAllReady,W()))}function Ft(C,R){if(R.chunks.length===0&&R.children.length===1&&R.children[0].boundary===null){var U=R.children[0];U.id=R.id,U.parentFlushed=!0,U.status===1&&Ft(C,U)}else C.completedSegments.push(R)}function Pt(C,R,U){if(R===null){if(U.parentFlushed){if(C.completedRootSegment!==null)throw Error(e(389));C.completedRootSegment=U}C.pendingRootTasks--,C.pendingRootTasks===0&&(C.onShellError=Pe,R=C.onShellReady,R())}else R.pendingTasks--,R.forceClientRender||(R.pendingTasks===0?(U.parentFlushed&&U.status===1&&Ft(R,U),R.parentFlushed&&C.completedBoundaries.push(R),R.fallbackAbortableTasks.forEach(vt,C),R.fallbackAbortableTasks.clear()):U.parentFlushed&&U.status===1&&(Ft(R,U),R.completedSegments.length===1&&R.parentFlushed&&C.partialBoundaries.push(R)));C.allPendingTasks--,C.allPendingTasks===0&&(C=C.onAllReady,C())}function Lt(C){if(C.status!==2){var R=ss,U=Ie.current;Ie.current=Te;var W=Ve;Ve=C.responseState;try{var St=C.pingedTasks,bt;for(bt=0;bt<St.length;bt++){var It=St[bt],Qt=C,ie=It.blockedSegment;if(ie.status===0){zs(It.context);try{ft(Qt,It,It.node),Qt.responseState.generateStaticMarkup||ie.lastPushedText&&ie.textEmbedded&&ie.chunks.push("<!-- -->"),It.abortSet.delete(It),ie.status=1,Pt(Qt,It.blockedBoundary,ie)}catch(ds){if(At(),typeof ds=="object"&&ds!==null&&typeof ds.then=="function"){var Ee=It.ping;ds.then(Ee,Ee)}else{It.abortSet.delete(It),ie.status=4;var we=It.blockedBoundary,We=ds,us=os(Qt,We);if(we===null?cs(Qt,We):(we.pendingTasks--,we.forceClientRender||(we.forceClientRender=!0,we.errorDigest=us,we.parentFlushed&&Qt.clientRenderedBoundaries.push(we))),Qt.allPendingTasks--,Qt.allPendingTasks===0){var ms=Qt.onAllReady;ms()}}}finally{}}}St.splice(0,bt),C.destination!==null&&Kt(C,C.destination)}catch(ds){os(C,ds),cs(C,ds)}finally{Ve=W,Ie.current=U,U===Te&&zs(R)}}}function Yt(C,R,U){switch(U.parentFlushed=!0,U.status){case 0:var W=U.id=C.nextSegmentId++;return U.lastPushedText=!1,U.textEmbedded=!1,C=C.responseState,R.push('<template id="'),R.push(C.placeholderPrefix),C=W.toString(16),R.push(C),R.push('"></template>');case 1:U.status=2;var St=!0;W=U.chunks;var bt=0;U=U.children;for(var It=0;It<U.length;It++){for(St=U[It];bt<St.index;bt++)R.push(W[bt]);St=$t(C,R,St)}for(;bt<W.length-1;bt++)R.push(W[bt]);return bt<W.length&&(St=R.push(W[bt])),St;default:throw Error(e(390))}}function $t(C,R,U){var W=U.boundary;if(W===null)return Yt(C,R,U);if(W.parentFlushed=!0,W.forceClientRender)return C.responseState.generateStaticMarkup||(W=W.errorDigest,R.push("<!--$!-->"),R.push("<template"),W&&(R.push(' data-dgst="'),W=y(W),R.push(W),R.push('"')),R.push("></template>")),Yt(C,R,U),C=C.responseState.generateStaticMarkup?!0:R.push("<!--/$-->"),C;if(0<W.pendingTasks){W.rootSegmentID=C.nextSegmentId++,0<W.completedSegments.length&&C.partialBoundaries.push(W);var St=C.responseState,bt=St.nextSuspenseID++;return St=St.boundaryPrefix+bt.toString(16),W=W.id=St,pt(R,C.responseState,W),Yt(C,R,U),R.push("<!--/$-->")}if(W.byteSize>C.progressiveChunkSize)return W.rootSegmentID=C.nextSegmentId++,C.completedBoundaries.push(W),pt(R,C.responseState,W.id),Yt(C,R,U),R.push("<!--/$-->");if(C.responseState.generateStaticMarkup||R.push("<!--$-->"),U=W.completedSegments,U.length!==1)throw Error(e(391));return $t(C,R,U[0]),C=C.responseState.generateStaticMarkup?!0:R.push("<!--/$-->"),C}function Bt(C,R,U){return K(R,C.responseState,U.formatContext,U.id),$t(C,R,U),ut(R,U.formatContext)}function Gt(C,R,U){for(var W=U.completedSegments,St=0;St<W.length;St++)qt(C,R,U,W[St]);if(W.length=0,C=C.responseState,W=U.id,U=U.rootSegmentID,R.push(C.startInlineScript),C.sentCompleteBoundaryFunction?R.push('$RC("'):(C.sentCompleteBoundaryFunction=!0,R.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),W===null)throw Error(e(395));return U=U.toString(16),R.push(W),R.push('","'),R.push(C.segmentPrefix),R.push(U),R.push('")<\/script>')}function qt(C,R,U,W){if(W.status===2)return!0;var St=W.id;if(St===-1){if((W.id=U.rootSegmentID)===-1)throw Error(e(392));return Bt(C,R,W)}return Bt(C,R,W),C=C.responseState,R.push(C.startInlineScript),C.sentCompleteSegmentFunction?R.push('$RS("'):(C.sentCompleteSegmentFunction=!0,R.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),R.push(C.segmentPrefix),St=St.toString(16),R.push(St),R.push('","'),R.push(C.placeholderPrefix),R.push(St),R.push('")<\/script>')}function Kt(C,R){try{var U=C.completedRootSegment;if(U!==null&&C.pendingRootTasks===0){$t(C,R,U),C.completedRootSegment=null;var W=C.responseState.bootstrapChunks;for(U=0;U<W.length-1;U++)R.push(W[U]);U<W.length&&R.push(W[U])}var St=C.clientRenderedBoundaries,bt;for(bt=0;bt<St.length;bt++){var It=St[bt];W=R;var Qt=C.responseState,ie=It.id,Ee=It.errorDigest,we=It.errorMessage,We=It.errorComponentStack;if(W.push(Qt.startInlineScript),Qt.sentClientRenderFunction?W.push('$RX("'):(Qt.sentClientRenderFunction=!0,W.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),ie===null)throw Error(e(395));if(W.push(ie),W.push('"'),Ee||we||We){W.push(",");var us=nt(Ee||"");W.push(us)}if(we||We){W.push(",");var ms=nt(we||"");W.push(ms)}if(We){W.push(",");var ds=nt(We);W.push(ds)}if(!W.push(")<\/script>")){C.destination=null,bt++,St.splice(0,bt);return}}St.splice(0,bt);var ks=C.completedBoundaries;for(bt=0;bt<ks.length;bt++)if(!Gt(C,R,ks[bt])){C.destination=null,bt++,ks.splice(0,bt);return}ks.splice(0,bt);var gs=C.partialBoundaries;for(bt=0;bt<gs.length;bt++){var Is=gs[bt];t:{St=C,It=R;var pn=Is.completedSegments;for(Qt=0;Qt<pn.length;Qt++)if(!qt(St,It,Is,pn[Qt])){Qt++,pn.splice(0,Qt);var Ss=!1;break t}pn.splice(0,Qt),Ss=!0}if(!Ss){C.destination=null,bt++,gs.splice(0,bt);return}}gs.splice(0,bt);var Os=C.completedBoundaries;for(bt=0;bt<Os.length;bt++)if(!Gt(C,R,Os[bt])){C.destination=null,bt++,Os.splice(0,bt);return}Os.splice(0,bt)}finally{C.allPendingTasks===0&&C.pingedTasks.length===0&&C.clientRenderedBoundaries.length===0&&C.completedBoundaries.length===0&&R.push(null)}}function ee(C,R){try{var U=C.abortableTasks;U.forEach(function(W){return Ct(W,C,R)}),U.clear(),C.destination!==null&&Kt(C,C.destination)}catch(W){os(C,W),cs(C,W)}}function oe(){}function re(C,R,U,W){var St=!1,bt=null,It="",Qt={push:function(Ee){return Ee!==null&&(It+=Ee),!0},destroy:function(Ee){St=!0,bt=Ee}},ie=!1;if(C=Be(C,ot(U,R?R.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,oe,void 0,function(){ie=!0}),Lt(C),ee(C,W),C.status===1)C.status=2,Qt.destroy(C.fatalError);else if(C.status!==2&&C.destination===null){C.destination=Qt;try{Kt(C,Qt)}catch(Ee){os(C,Ee),cs(C,Ee)}}if(St)throw bt;if(!ie)throw Error(e(426));return It}return Sa.renderToNodeStream=function(){throw Error(e(207))},Sa.renderToStaticMarkup=function(C,R){return re(C,R,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},Sa.renderToStaticNodeStream=function(){throw Error(e(208))},Sa.renderToString=function(C,R){return re(C,R,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},Sa.version="18.3.1",Sa}var Ig={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ow;function EY(){if(ow)return Ig;ow=1;var t=yh();function e(N){for(var z="https://reactjs.org/docs/error-decoder.html?invariant="+N,q=1;q<arguments.length;q++)z+="&args[]="+encodeURIComponent(arguments[q]);return"Minified React error #"+N+"; visit "+z+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=null,n=0;function i(N,z){if(z.length!==0)if(512<z.length)0<n&&(N.enqueue(new Uint8Array(s.buffer,0,n)),s=new Uint8Array(512),n=0),N.enqueue(z);else{var q=s.length-n;q<z.length&&(q===0?N.enqueue(s):(s.set(z.subarray(0,q),n),N.enqueue(s),z=z.subarray(q)),s=new Uint8Array(512),n=0),s.set(z,n),n+=z.length}}function r(N,z){return i(N,z),!0}function o(N){s&&0<n&&(N.enqueue(new Uint8Array(s.buffer,0,n)),s=null,n=0)}var a=new TextEncoder;function l(N){return a.encode(N)}function u(N){return a.encode(N)}function h(N,z){typeof N.error=="function"?N.error(z):N.close()}var g=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},y={};function _(N){return g.call(y,N)?!0:g.call(p,N)?!1:f.test(N)?y[N]=!0:(p[N]=!0,!1)}function x(N,z,q,st,Ot,Rt,Jt){this.acceptsBooleans=z===2||z===3||z===4,this.attributeName=st,this.attributeNamespace=Ot,this.mustUseProperty=q,this.propertyName=N,this.type=z,this.sanitizeURL=Rt,this.removeEmptyString=Jt}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(N){v[N]=new x(N,0,!1,N,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(N){var z=N[0];v[z]=new x(z,1,!1,N[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(N){v[N]=new x(N,2,!1,N.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(N){v[N]=new x(N,2,!1,N,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(N){v[N]=new x(N,3,!1,N.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(N){v[N]=new x(N,3,!0,N,null,!1,!1)}),["capture","download"].forEach(function(N){v[N]=new x(N,4,!1,N,null,!1,!1)}),["cols","rows","size","span"].forEach(function(N){v[N]=new x(N,6,!1,N,null,!1,!1)}),["rowSpan","start"].forEach(function(N){v[N]=new x(N,5,!1,N.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function S(N){return N[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(N){var z=N.replace(b,S);v[z]=new x(z,1,!1,N,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(N){var z=N.replace(b,S);v[z]=new x(z,1,!1,N,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(N){var z=N.replace(b,S);v[z]=new x(z,1,!1,N,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(N){v[N]=new x(N,1,!1,N.toLowerCase(),null,!1,!1)}),v.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(N){v[N]=new x(N,1,!1,N.toLowerCase(),null,!0,!0)});var A={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},w=["Webkit","ms","Moz","O"];Object.keys(A).forEach(function(N){w.forEach(function(z){z=z+N.charAt(0).toUpperCase()+N.substring(1),A[z]=A[N]})});var L=/["'&<>]/;function M(N){if(typeof N=="boolean"||typeof N=="number")return""+N;N=""+N;var z=L.exec(N);if(z){var q="",st,Ot=0;for(st=z.index;st<N.length;st++){switch(N.charCodeAt(st)){case 34:z="&quot;";break;case 38:z="&amp;";break;case 39:z="&#x27;";break;case 60:z="&lt;";break;case 62:z="&gt;";break;default:continue}Ot!==st&&(q+=N.substring(Ot,st)),Ot=st+1,q+=z}N=Ot!==st?q+N.substring(Ot,st):q}return N}var F=/([A-Z])/g,O=/^ms-/,G=Array.isArray,j=u("<script>"),Z=u("<\/script>"),at=u('<script src="'),pt=u('<script type="module" src="'),K=u('" async=""><\/script>'),ut=/(<\/|<)(s)(cript)/gi;function ht(N,z,q,st){return""+z+(q==="s"?"\\u0073":"\\u0053")+st}function nt(N,z,q,st,Ot){N=N===void 0?"":N,z=z===void 0?j:u('<script nonce="'+M(z)+'">');var Rt=[];if(q!==void 0&&Rt.push(z,l((""+q).replace(ut,ht)),Z),st!==void 0)for(q=0;q<st.length;q++)Rt.push(at,l(M(st[q])),K);if(Ot!==void 0)for(st=0;st<Ot.length;st++)Rt.push(pt,l(M(Ot[st])),K);return{bootstrapChunks:Rt,startInlineScript:z,placeholderPrefix:u(N+"P:"),segmentPrefix:u(N+"S:"),boundaryPrefix:N+"B:",idPrefix:N,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function ot(N,z){return{insertionMode:N,selectedValue:z}}function Mt(N){return ot(N==="http://www.w3.org/2000/svg"?2:N==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function Q(N,z,q){switch(z){case"select":return ot(1,q.value!=null?q.value:q.defaultValue);case"svg":return ot(2,null);case"math":return ot(3,null);case"foreignObject":return ot(1,null);case"table":return ot(4,null);case"thead":case"tbody":case"tfoot":return ot(5,null);case"colgroup":return ot(7,null);case"tr":return ot(6,null)}return 4<=N.insertionMode||N.insertionMode===0?ot(1,null):N}var Et=u("<!-- -->");function Xt(N,z,q,st){return z===""?st:(st&&N.push(Et),N.push(l(M(z))),!0)}var Ht=new Map,Zt=u(' style="'),ae=u(":"),pe=u(";");function ne(N,z,q){if(typeof q!="object")throw Error(e(62));z=!0;for(var st in q)if(g.call(q,st)){var Ot=q[st];if(Ot!=null&&typeof Ot!="boolean"&&Ot!==""){if(st.indexOf("--")===0){var Rt=l(M(st));Ot=l(M((""+Ot).trim()))}else{Rt=st;var Jt=Ht.get(Rt);Jt!==void 0||(Jt=u(M(Rt.replace(F,"-$1").toLowerCase().replace(O,"-ms-"))),Ht.set(Rt,Jt)),Rt=Jt,Ot=typeof Ot=="number"?Ot===0||g.call(A,st)?l(""+Ot):l(Ot+"px"):l(M((""+Ot).trim()))}z?(z=!1,N.push(Zt,Rt,ae,Ot)):N.push(pe,Rt,ae,Ot)}}z||N.push(ce)}var te=u(" "),se=u('="'),ce=u('"'),Ce=u('=""');function ve(N,z,q,st){switch(q){case"style":ne(N,z,st);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<q.length)||q[0]!=="o"&&q[0]!=="O"||q[1]!=="n"&&q[1]!=="N"){if(z=v.hasOwnProperty(q)?v[q]:null,z!==null){switch(typeof st){case"function":case"symbol":return;case"boolean":if(!z.acceptsBooleans)return}switch(q=l(z.attributeName),z.type){case 3:st&&N.push(te,q,Ce);break;case 4:st===!0?N.push(te,q,Ce):st!==!1&&N.push(te,q,se,l(M(st)),ce);break;case 5:isNaN(st)||N.push(te,q,se,l(M(st)),ce);break;case 6:!isNaN(st)&&1<=st&&N.push(te,q,se,l(M(st)),ce);break;default:z.sanitizeURL&&(st=""+st),N.push(te,q,se,l(M(st)),ce)}}else if(_(q)){switch(typeof st){case"function":case"symbol":return;case"boolean":if(z=q.toLowerCase().slice(0,5),z!=="data-"&&z!=="aria-")return}N.push(te,l(q),se,l(M(st)),ce)}}}var Me=u(">"),ge=u("/>");function ze(N,z,q){if(z!=null){if(q!=null)throw Error(e(60));if(typeof z!="object"||!("__html"in z))throw Error(e(61));z=z.__html,z!=null&&N.push(l(""+z))}}function is(N){var z="";return t.Children.forEach(N,function(q){q!=null&&(z+=q)}),z}var Ge=u(' selected=""');function De(N,z,q,st){N.push(ts(q));var Ot=q=null,Rt;for(Rt in z)if(g.call(z,Rt)){var Jt=z[Rt];if(Jt!=null)switch(Rt){case"children":q=Jt;break;case"dangerouslySetInnerHTML":Ot=Jt;break;default:ve(N,st,Rt,Jt)}}return N.push(Me),ze(N,Ot,q),typeof q=="string"?(N.push(l(M(q))),null):q}var He=u(`
`),Je=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,ss=new Map;function ts(N){var z=ss.get(N);if(z===void 0){if(!Je.test(N))throw Error(e(65,N));z=u("<"+N),ss.set(N,z)}return z}var hs=u("<!DOCTYPE html>");function Fe(N,z,q,st,Ot){switch(z){case"select":N.push(ts("select"));var Rt=null,Jt=null;for(Ze in q)if(g.call(q,Ze)){var me=q[Ze];if(me!=null)switch(Ze){case"children":Rt=me;break;case"dangerouslySetInnerHTML":Jt=me;break;case"defaultValue":case"value":break;default:ve(N,st,Ze,me)}}return N.push(Me),ze(N,Jt,Rt),Rt;case"option":Jt=Ot.selectedValue,N.push(ts("option"));var Ye=me=null,ns=null,Ze=null;for(Rt in q)if(g.call(q,Rt)){var ws=q[Rt];if(ws!=null)switch(Rt){case"children":me=ws;break;case"selected":ns=ws;break;case"dangerouslySetInnerHTML":Ze=ws;break;case"value":Ye=ws;default:ve(N,st,Rt,ws)}}if(Jt!=null)if(q=Ye!==null?""+Ye:is(me),G(Jt)){for(st=0;st<Jt.length;st++)if(""+Jt[st]===q){N.push(Ge);break}}else""+Jt===q&&N.push(Ge);else ns&&N.push(Ge);return N.push(Me),ze(N,Ze,me),me;case"textarea":N.push(ts("textarea")),Ze=Jt=Rt=null;for(me in q)if(g.call(q,me)&&(Ye=q[me],Ye!=null))switch(me){case"children":Ze=Ye;break;case"value":Rt=Ye;break;case"defaultValue":Jt=Ye;break;case"dangerouslySetInnerHTML":throw Error(e(91));default:ve(N,st,me,Ye)}if(Rt===null&&Jt!==null&&(Rt=Jt),N.push(Me),Ze!=null){if(Rt!=null)throw Error(e(92));if(G(Ze)&&1<Ze.length)throw Error(e(93));Rt=""+Ze}return typeof Rt=="string"&&Rt[0]===`
`&&N.push(He),Rt!==null&&N.push(l(M(""+Rt))),null;case"input":N.push(ts("input")),Ye=Ze=me=Rt=null;for(Jt in q)if(g.call(q,Jt)&&(ns=q[Jt],ns!=null))switch(Jt){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,"input"));case"defaultChecked":Ye=ns;break;case"defaultValue":me=ns;break;case"checked":Ze=ns;break;case"value":Rt=ns;break;default:ve(N,st,Jt,ns)}return Ze!==null?ve(N,st,"checked",Ze):Ye!==null&&ve(N,st,"checked",Ye),Rt!==null?ve(N,st,"value",Rt):me!==null&&ve(N,st,"value",me),N.push(ge),null;case"menuitem":N.push(ts("menuitem"));for(var zn in q)if(g.call(q,zn)&&(Rt=q[zn],Rt!=null))switch(zn){case"children":case"dangerouslySetInnerHTML":throw Error(e(400));default:ve(N,st,zn,Rt)}return N.push(Me),null;case"title":N.push(ts("title")),Rt=null;for(ws in q)if(g.call(q,ws)&&(Jt=q[ws],Jt!=null))switch(ws){case"children":Rt=Jt;break;case"dangerouslySetInnerHTML":throw Error(e(434));default:ve(N,st,ws,Jt)}return N.push(Me),Rt;case"listing":case"pre":N.push(ts(z)),Jt=Rt=null;for(Ye in q)if(g.call(q,Ye)&&(me=q[Ye],me!=null))switch(Ye){case"children":Rt=me;break;case"dangerouslySetInnerHTML":Jt=me;break;default:ve(N,st,Ye,me)}if(N.push(Me),Jt!=null){if(Rt!=null)throw Error(e(60));if(typeof Jt!="object"||!("__html"in Jt))throw Error(e(61));q=Jt.__html,q!=null&&(typeof q=="string"&&0<q.length&&q[0]===`
`?N.push(He,l(q)):N.push(l(""+q)))}return typeof Rt=="string"&&Rt[0]===`
`&&N.push(He),Rt;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":N.push(ts(z));for(var li in q)if(g.call(q,li)&&(Rt=q[li],Rt!=null))switch(li){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,z));default:ve(N,st,li,Rt)}return N.push(ge),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return De(N,q,z,st);case"html":return Ot.insertionMode===0&&N.push(hs),De(N,q,z,st);default:if(z.indexOf("-")===-1&&typeof q.is!="string")return De(N,q,z,st);N.push(ts(z)),Jt=Rt=null;for(ns in q)if(g.call(q,ns)&&(me=q[ns],me!=null))switch(ns){case"children":Rt=me;break;case"dangerouslySetInnerHTML":Jt=me;break;case"style":ne(N,st,me);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:_(ns)&&typeof me!="function"&&typeof me!="symbol"&&N.push(te,l(ns),se,l(M(me)),ce)}return N.push(Me),ze(N,Jt,Rt),Rt}}var Oe=u("</"),Ns=u(">"),zs=u('<template id="'),$s=u('"></template>'),Ms=u("<!--$-->"),An=u('<!--$?--><template id="'),fn=u('"></template>'),un=u("<!--$!-->"),xs=u("<!--/$-->"),Ds=u("<template"),gt=u('"'),k=u(' data-dgst="');u(' data-msg="'),u(' data-stck="');var P=u("></template>");function D(N,z,q){if(i(N,An),q===null)throw Error(e(395));return i(N,q),r(N,fn)}var B=u('<div hidden id="'),$=u('">'),H=u("</div>"),X=u('<svg aria-hidden="true" style="display:none" id="'),lt=u('">'),dt=u("</svg>"),ct=u('<math aria-hidden="true" style="display:none" id="'),mt=u('">'),yt=u("</math>"),Nt=u('<table hidden id="'),Tt=u('">'),At=u("</table>"),Ut=u('<table hidden><tbody id="'),he=u('">'),xe=u("</tbody></table>"),be=u('<table hidden><tr id="'),ue=u('">'),_e=u("</tr></table>"),Te=u('<table hidden><colgroup id="'),Ve=u('">'),Ie=u("</colgroup></table>");function je(N,z,q,st){switch(q.insertionMode){case 0:case 1:return i(N,B),i(N,z.segmentPrefix),i(N,l(st.toString(16))),r(N,$);case 2:return i(N,X),i(N,z.segmentPrefix),i(N,l(st.toString(16))),r(N,lt);case 3:return i(N,ct),i(N,z.segmentPrefix),i(N,l(st.toString(16))),r(N,mt);case 4:return i(N,Nt),i(N,z.segmentPrefix),i(N,l(st.toString(16))),r(N,Tt);case 5:return i(N,Ut),i(N,z.segmentPrefix),i(N,l(st.toString(16))),r(N,he);case 6:return i(N,be),i(N,z.segmentPrefix),i(N,l(st.toString(16))),r(N,ue);case 7:return i(N,Te),i(N,z.segmentPrefix),i(N,l(st.toString(16))),r(N,Ve);default:throw Error(e(397))}}function Pe(N,z){switch(z.insertionMode){case 0:case 1:return r(N,H);case 2:return r(N,dt);case 3:return r(N,yt);case 4:return r(N,At);case 5:return r(N,xe);case 6:return r(N,_e);case 7:return r(N,Ie);default:throw Error(e(397))}}var Be=u('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),Ue=u('$RS("'),es=u('","'),os=u('")<\/script>'),cs=u('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),Y=u('$RC("'),et=u('","'),J=u('")<\/script>'),tt=u('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),ft=u('$RX("'),_t=u('"'),it=u(")<\/script>"),vt=u(","),Ct=/[<\u2028\u2029]/g;function Ft(N){return JSON.stringify(N).replace(Ct,function(z){switch(z){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var Pt=Object.assign,Lt=Symbol.for("react.element"),Yt=Symbol.for("react.portal"),$t=Symbol.for("react.fragment"),Bt=Symbol.for("react.strict_mode"),Gt=Symbol.for("react.profiler"),qt=Symbol.for("react.provider"),Kt=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),oe=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),U=Symbol.for("react.scope"),W=Symbol.for("react.debug_trace_mode"),St=Symbol.for("react.legacy_hidden"),bt=Symbol.for("react.default_value"),It=Symbol.iterator;function Qt(N){if(N==null)return null;if(typeof N=="function")return N.displayName||N.name||null;if(typeof N=="string")return N;switch(N){case $t:return"Fragment";case Yt:return"Portal";case Gt:return"Profiler";case Bt:return"StrictMode";case oe:return"Suspense";case re:return"SuspenseList"}if(typeof N=="object")switch(N.$$typeof){case Kt:return(N.displayName||"Context")+".Consumer";case qt:return(N._context.displayName||"Context")+".Provider";case ee:var z=N.render;return N=N.displayName,N||(N=z.displayName||z.name||"",N=N!==""?"ForwardRef("+N+")":"ForwardRef"),N;case C:return z=N.displayName||null,z!==null?z:Qt(N.type)||"Memo";case R:z=N._payload,N=N._init;try{return Qt(N(z))}catch{}}return null}var ie={};function Ee(N,z){if(N=N.contextTypes,!N)return ie;var q={},st;for(st in N)q[st]=z[st];return q}var we=null;function We(N,z){if(N!==z){N.context._currentValue=N.parentValue,N=N.parent;var q=z.parent;if(N===null){if(q!==null)throw Error(e(401))}else{if(q===null)throw Error(e(401));We(N,q)}z.context._currentValue=z.value}}function us(N){N.context._currentValue=N.parentValue,N=N.parent,N!==null&&us(N)}function ms(N){var z=N.parent;z!==null&&ms(z),N.context._currentValue=N.value}function ds(N,z){if(N.context._currentValue=N.parentValue,N=N.parent,N===null)throw Error(e(402));N.depth===z.depth?We(N,z):ds(N,z)}function ks(N,z){var q=z.parent;if(q===null)throw Error(e(402));N.depth===q.depth?We(N,q):ks(N,q),z.context._currentValue=z.value}function gs(N){var z=we;z!==N&&(z===null?ms(N):N===null?us(z):z.depth===N.depth?We(z,N):z.depth>N.depth?ds(z,N):ks(z,N),we=N)}var Is={isMounted:function(){return!1},enqueueSetState:function(N,z){N=N._reactInternals,N.queue!==null&&N.queue.push(z)},enqueueReplaceState:function(N,z){N=N._reactInternals,N.replace=!0,N.queue=[z]},enqueueForceUpdate:function(){}};function pn(N,z,q,st){var Ot=N.state!==void 0?N.state:null;N.updater=Is,N.props=q,N.state=Ot;var Rt={queue:[],replace:!1};N._reactInternals=Rt;var Jt=z.contextType;if(N.context=typeof Jt=="object"&&Jt!==null?Jt._currentValue:st,Jt=z.getDerivedStateFromProps,typeof Jt=="function"&&(Jt=Jt(q,Ot),Ot=Jt==null?Ot:Pt({},Ot,Jt),N.state=Ot),typeof z.getDerivedStateFromProps!="function"&&typeof N.getSnapshotBeforeUpdate!="function"&&(typeof N.UNSAFE_componentWillMount=="function"||typeof N.componentWillMount=="function"))if(z=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),z!==N.state&&Is.enqueueReplaceState(N,N.state,null),Rt.queue!==null&&0<Rt.queue.length)if(z=Rt.queue,Jt=Rt.replace,Rt.queue=null,Rt.replace=!1,Jt&&z.length===1)N.state=z[0];else{for(Rt=Jt?z[0]:N.state,Ot=!0,Jt=Jt?1:0;Jt<z.length;Jt++){var me=z[Jt];me=typeof me=="function"?me.call(N,Rt,q,st):me,me!=null&&(Ot?(Ot=!1,Rt=Pt({},Rt,me)):Pt(Rt,me))}N.state=Rt}else Rt.queue=null}var Ss={id:1,overflow:""};function Os(N,z,q){var st=N.id;N=N.overflow;var Ot=32-yn(st)-1;st&=~(1<<Ot),q+=1;var Rt=32-yn(z)+Ot;if(30<Rt){var Jt=Ot-Ot%5;return Rt=(st&(1<<Jt)-1).toString(32),st>>=Jt,Ot-=Jt,{id:1<<32-yn(z)+Ot|q<<Ot|st,overflow:Rt+N}}return{id:1<<Rt|q<<Ot|st,overflow:N}}var yn=Math.clz32?Math.clz32:Bs,en=Math.log,Ks=Math.LN2;function Bs(N){return N>>>=0,N===0?32:31-(en(N)/Ks|0)|0}function wn(N,z){return N===z&&(N!==0||1/N===1/z)||N!==N&&z!==z}var Zi=typeof Object.is=="function"?Object.is:wn,Mn=null,Ki=null,pr=null,vs=null,Qi=!1,mr=!1,Ri=0,Ei=null,Ja=0;function Rr(){if(Mn===null)throw Error(e(321));return Mn}function tl(){if(0<Ja)throw Error(e(312));return{memoizedState:null,queue:null,next:null}}function fo(){return vs===null?pr===null?(Qi=!1,pr=vs=tl()):(Qi=!0,vs=pr):vs.next===null?(Qi=!1,vs=vs.next=tl()):(Qi=!0,vs=vs.next),vs}function ia(){Ki=Mn=null,mr=!1,pr=null,Ja=0,vs=Ei=null}function Au(N,z){return typeof z=="function"?z(N):z}function Ji(N,z,q){if(Mn=Rr(),vs=fo(),Qi){var st=vs.queue;if(z=st.dispatch,Ei!==null&&(q=Ei.get(st),q!==void 0)){Ei.delete(st),st=vs.memoizedState;do st=N(st,q.action),q=q.next;while(q!==null);return vs.memoizedState=st,[st,z]}return[vs.memoizedState,z]}return N=N===Au?typeof z=="function"?z():z:q!==void 0?q(z):z,vs.memoizedState=N,N=vs.queue={last:null,dispatch:null},N=N.dispatch=sl.bind(null,Mn,N),[vs.memoizedState,N]}function el(N,z){if(Mn=Rr(),vs=fo(),z=z===void 0?null:z,vs!==null){var q=vs.memoizedState;if(q!==null&&z!==null){var st=q[1];t:if(st===null)st=!1;else{for(var Ot=0;Ot<st.length&&Ot<z.length;Ot++)if(!Zi(z[Ot],st[Ot])){st=!1;break t}st=!0}if(st)return q[0]}}return N=N(),vs.memoizedState=[N,z],N}function sl(N,z,q){if(25<=Ja)throw Error(e(301));if(N===Mn)if(mr=!0,N={action:q,next:null},Ei===null&&(Ei=new Map),q=Ei.get(z),q===void 0)Ei.set(z,N);else{for(z=q;z.next!==null;)z=z.next;z.next=N}}function Ph(){throw Error(e(394))}function Fr(){}var ra={readContext:function(N){return N._currentValue},useContext:function(N){return Rr(),N._currentValue},useMemo:el,useReducer:Ji,useRef:function(N){Mn=Rr(),vs=fo();var z=vs.memoizedState;return z===null?(N={current:N},vs.memoizedState=N):z},useState:function(N){return Ji(Au,N)},useInsertionEffect:Fr,useLayoutEffect:function(){},useCallback:function(N,z){return el(function(){return N},z)},useImperativeHandle:Fr,useEffect:Fr,useDebugValue:Fr,useDeferredValue:function(N){return Rr(),N},useTransition:function(){return Rr(),[!1,Ph]},useId:function(){var N=Ki.treeContext,z=N.overflow;N=N.id,N=(N&~(1<<32-yn(N)-1)).toString(32)+z;var q=oa;if(q===null)throw Error(e(404));return z=Ri++,N=":"+q.idPrefix+"R"+N,0<z&&(N+="H"+z.toString(32)),N+":"},useMutableSource:function(N,z){return Rr(),z(N._source)},useSyncExternalStore:function(N,z,q){if(q===void 0)throw Error(e(407));return q()}},oa=null,kn=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function po(N){return console.error(N),null}function Pr(){}function aa(N,z,q,st,Ot,Rt,Jt,me,Ye){var ns=[],Ze=new Set;return z={destination:null,responseState:z,progressiveChunkSize:st===void 0?12800:st,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:Ze,pingedTasks:ns,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Ot===void 0?po:Ot,onAllReady:Rt===void 0?Pr:Rt,onShellReady:Jt===void 0?Pr:Jt,onShellError:me===void 0?Pr:me,onFatalError:Ye===void 0?Pr:Ye},q=mo(z,0,null,q,!1,!1),q.parentFlushed=!0,N=wu(z,N,null,q,Ze,ie,null,Ss),ns.push(N),z}function wu(N,z,q,st,Ot,Rt,Jt,me){N.allPendingTasks++,q===null?N.pendingRootTasks++:q.pendingTasks++;var Ye={node:z,ping:function(){var ns=N.pingedTasks;ns.push(Ye),ns.length===1&&Nu(N)},blockedBoundary:q,blockedSegment:st,abortSet:Ot,legacyContext:Rt,context:Jt,treeContext:me};return Ot.add(Ye),Ye}function mo(N,z,q,st,Ot,Rt){return{status:0,id:-1,index:z,parentFlushed:!1,chunks:[],children:[],formatContext:st,boundary:q,lastPushedText:Ot,textEmbedded:Rt}}function zr(N,z){if(N=N.onError(z),N!=null&&typeof N!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof N+'" instead');return N}function _r(N,z){var q=N.onShellError;q(z),q=N.onFatalError,q(z),N.destination!==null?(N.status=2,h(N.destination,z)):(N.status=1,N.fatalError=z)}function la(N,z,q,st,Ot){for(Mn={},Ki=z,Ri=0,N=q(st,Ot);mr;)mr=!1,Ri=0,Ja+=1,vs=null,N=q(st,Ot);return ia(),N}function Tu(N,z,q,st){var Ot=q.render(),Rt=st.childContextTypes;if(Rt!=null){var Jt=z.legacyContext;if(typeof q.getChildContext!="function")st=Jt;else{q=q.getChildContext();for(var me in q)if(!(me in Rt))throw Error(e(108,Qt(st)||"Unknown",me));st=Pt({},Jt,q)}z.legacyContext=st,Zn(N,z,Ot),z.legacyContext=Jt}else Zn(N,z,Ot)}function zh(N,z){if(N&&N.defaultProps){z=Pt({},z),N=N.defaultProps;for(var q in N)z[q]===void 0&&(z[q]=N[q]);return z}return z}function Cu(N,z,q,st,Ot){if(typeof q=="function")if(q.prototype&&q.prototype.isReactComponent){Ot=Ee(q,z.legacyContext);var Rt=q.contextType;Rt=new q(st,typeof Rt=="object"&&Rt!==null?Rt._currentValue:Ot),pn(Rt,q,st,Ot),Tu(N,z,Rt,q)}else{Rt=Ee(q,z.legacyContext),Ot=la(N,z,q,st,Rt);var Jt=Ri!==0;if(typeof Ot=="object"&&Ot!==null&&typeof Ot.render=="function"&&Ot.$$typeof===void 0)pn(Ot,q,st,Rt),Tu(N,z,Ot,q);else if(Jt){st=z.treeContext,z.treeContext=Os(st,1,0);try{Zn(N,z,Ot)}finally{z.treeContext=st}}else Zn(N,z,Ot)}else if(typeof q=="string"){switch(Ot=z.blockedSegment,Rt=Fe(Ot.chunks,q,st,N.responseState,Ot.formatContext),Ot.lastPushedText=!1,Jt=Ot.formatContext,Ot.formatContext=Q(Jt,q,st),Lu(N,z,Rt),Ot.formatContext=Jt,q){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Ot.chunks.push(Oe,l(q),Ns)}Ot.lastPushedText=!1}else{switch(q){case St:case W:case Bt:case Gt:case $t:Zn(N,z,st.children);return;case re:Zn(N,z,st.children);return;case U:throw Error(e(343));case oe:t:{q=z.blockedBoundary,Ot=z.blockedSegment,Rt=st.fallback,st=st.children,Jt=new Set;var me={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:Jt,errorDigest:null},Ye=mo(N,Ot.chunks.length,me,Ot.formatContext,!1,!1);Ot.children.push(Ye),Ot.lastPushedText=!1;var ns=mo(N,0,null,Ot.formatContext,!1,!1);ns.parentFlushed=!0,z.blockedBoundary=me,z.blockedSegment=ns;try{if(Lu(N,z,st),ns.lastPushedText&&ns.textEmbedded&&ns.chunks.push(Et),ns.status=1,il(me,ns),me.pendingTasks===0)break t}catch(Ze){ns.status=4,me.forceClientRender=!0,me.errorDigest=zr(N,Ze)}finally{z.blockedBoundary=q,z.blockedSegment=Ot}z=wu(N,Rt,q,Ye,Jt,z.legacyContext,z.context,z.treeContext),N.pingedTasks.push(z)}return}if(typeof q=="object"&&q!==null)switch(q.$$typeof){case ee:if(st=la(N,z,q.render,st,Ot),Ri!==0){q=z.treeContext,z.treeContext=Os(q,1,0);try{Zn(N,z,st)}finally{z.treeContext=q}}else Zn(N,z,st);return;case C:q=q.type,st=zh(q,st),Cu(N,z,q,st,Ot);return;case qt:if(Ot=st.children,q=q._context,st=st.value,Rt=q._currentValue,q._currentValue=st,Jt=we,we=st={parent:Jt,depth:Jt===null?0:Jt.depth+1,context:q,parentValue:Rt,value:st},z.context=st,Zn(N,z,Ot),N=we,N===null)throw Error(e(403));st=N.parentValue,N.context._currentValue=st===bt?N.context._defaultValue:st,N=we=N.parent,z.context=N;return;case Kt:st=st.children,st=st(q._currentValue),Zn(N,z,st);return;case R:Ot=q._init,q=Ot(q._payload),st=zh(q,st),Cu(N,z,q,st,void 0);return}throw Error(e(130,q==null?q:typeof q,""))}}function Zn(N,z,q){if(z.node=q,typeof q=="object"&&q!==null){switch(q.$$typeof){case Lt:Cu(N,z,q.type,q.props,q.ref);return;case Yt:throw Error(e(257));case R:var st=q._init;q=st(q._payload),Zn(N,z,q);return}if(G(q)){nl(N,z,q);return}if(q===null||typeof q!="object"?st=null:(st=It&&q[It]||q["@@iterator"],st=typeof st=="function"?st:null),st&&(st=st.call(q))){if(q=st.next(),!q.done){var Ot=[];do Ot.push(q.value),q=st.next();while(!q.done);nl(N,z,Ot)}return}throw N=Object.prototype.toString.call(q),Error(e(31,N==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":N))}typeof q=="string"?(st=z.blockedSegment,st.lastPushedText=Xt(z.blockedSegment.chunks,q,N.responseState,st.lastPushedText)):typeof q=="number"&&(st=z.blockedSegment,st.lastPushedText=Xt(z.blockedSegment.chunks,""+q,N.responseState,st.lastPushedText))}function nl(N,z,q){for(var st=q.length,Ot=0;Ot<st;Ot++){var Rt=z.treeContext;z.treeContext=Os(Rt,st,Ot);try{Lu(N,z,q[Ot])}finally{z.treeContext=Rt}}}function Lu(N,z,q){var st=z.blockedSegment.formatContext,Ot=z.legacyContext,Rt=z.context;try{return Zn(N,z,q)}catch(Ye){if(ia(),typeof Ye=="object"&&Ye!==null&&typeof Ye.then=="function"){q=Ye;var Jt=z.blockedSegment,me=mo(N,Jt.chunks.length,null,Jt.formatContext,Jt.lastPushedText,!0);Jt.children.push(me),Jt.lastPushedText=!1,N=wu(N,z.node,z.blockedBoundary,me,z.abortSet,z.legacyContext,z.context,z.treeContext).ping,q.then(N,N),z.blockedSegment.formatContext=st,z.legacyContext=Ot,z.context=Rt,gs(Rt)}else throw z.blockedSegment.formatContext=st,z.legacyContext=Ot,z.context=Rt,gs(Rt),Ye}}function pp(N){var z=N.blockedBoundary;N=N.blockedSegment,N.status=3,Oh(this,z,N)}function Dh(N,z,q){var st=N.blockedBoundary;N.blockedSegment.status=3,st===null?(z.allPendingTasks--,z.status!==2&&(z.status=2,z.destination!==null&&z.destination.close())):(st.pendingTasks--,st.forceClientRender||(st.forceClientRender=!0,N=q===void 0?Error(e(432)):q,st.errorDigest=z.onError(N),st.parentFlushed&&z.clientRenderedBoundaries.push(st)),st.fallbackAbortableTasks.forEach(function(Ot){return Dh(Ot,z,q)}),st.fallbackAbortableTasks.clear(),z.allPendingTasks--,z.allPendingTasks===0&&(st=z.onAllReady,st()))}function il(N,z){if(z.chunks.length===0&&z.children.length===1&&z.children[0].boundary===null){var q=z.children[0];q.id=z.id,q.parentFlushed=!0,q.status===1&&il(N,q)}else N.completedSegments.push(z)}function Oh(N,z,q){if(z===null){if(q.parentFlushed){if(N.completedRootSegment!==null)throw Error(e(389));N.completedRootSegment=q}N.pendingRootTasks--,N.pendingRootTasks===0&&(N.onShellError=Pr,z=N.onShellReady,z())}else z.pendingTasks--,z.forceClientRender||(z.pendingTasks===0?(q.parentFlushed&&q.status===1&&il(z,q),z.parentFlushed&&N.completedBoundaries.push(z),z.fallbackAbortableTasks.forEach(pp,N),z.fallbackAbortableTasks.clear()):q.parentFlushed&&q.status===1&&(il(z,q),z.completedSegments.length===1&&z.parentFlushed&&N.partialBoundaries.push(z)));N.allPendingTasks--,N.allPendingTasks===0&&(N=N.onAllReady,N())}function Nu(N){if(N.status!==2){var z=we,q=kn.current;kn.current=ra;var st=oa;oa=N.responseState;try{var Ot=N.pingedTasks,Rt;for(Rt=0;Rt<Ot.length;Rt++){var Jt=Ot[Rt],me=N,Ye=Jt.blockedSegment;if(Ye.status===0){gs(Jt.context);try{Zn(me,Jt,Jt.node),Ye.lastPushedText&&Ye.textEmbedded&&Ye.chunks.push(Et),Jt.abortSet.delete(Jt),Ye.status=1,Oh(me,Jt.blockedBoundary,Ye)}catch(ui){if(ia(),typeof ui=="object"&&ui!==null&&typeof ui.then=="function"){var ns=Jt.ping;ui.then(ns,ns)}else{Jt.abortSet.delete(Jt),Ye.status=4;var Ze=Jt.blockedBoundary,ws=ui,zn=zr(me,ws);if(Ze===null?_r(me,ws):(Ze.pendingTasks--,Ze.forceClientRender||(Ze.forceClientRender=!0,Ze.errorDigest=zn,Ze.parentFlushed&&me.clientRenderedBoundaries.push(Ze))),me.allPendingTasks--,me.allPendingTasks===0){var li=me.onAllReady;li()}}}finally{}}}Ot.splice(0,Rt),N.destination!==null&&Mu(N,N.destination)}catch(ui){zr(N,ui),_r(N,ui)}finally{oa=st,kn.current=q,q===ra&&gs(z)}}}function rl(N,z,q){switch(q.parentFlushed=!0,q.status){case 0:var st=q.id=N.nextSegmentId++;return q.lastPushedText=!1,q.textEmbedded=!1,N=N.responseState,i(z,zs),i(z,N.placeholderPrefix),N=l(st.toString(16)),i(z,N),r(z,$s);case 1:q.status=2;var Ot=!0;st=q.chunks;var Rt=0;q=q.children;for(var Jt=0;Jt<q.length;Jt++){for(Ot=q[Jt];Rt<Ot.index;Rt++)i(z,st[Rt]);Ot=ol(N,z,Ot)}for(;Rt<st.length-1;Rt++)i(z,st[Rt]);return Rt<st.length&&(Ot=r(z,st[Rt])),Ot;default:throw Error(e(390))}}function ol(N,z,q){var st=q.boundary;if(st===null)return rl(N,z,q);if(st.parentFlushed=!0,st.forceClientRender)st=st.errorDigest,r(z,un),i(z,Ds),st&&(i(z,k),i(z,l(M(st))),i(z,gt)),r(z,P),rl(N,z,q);else if(0<st.pendingTasks){st.rootSegmentID=N.nextSegmentId++,0<st.completedSegments.length&&N.partialBoundaries.push(st);var Ot=N.responseState,Rt=Ot.nextSuspenseID++;Ot=u(Ot.boundaryPrefix+Rt.toString(16)),st=st.id=Ot,D(z,N.responseState,st),rl(N,z,q)}else if(st.byteSize>N.progressiveChunkSize)st.rootSegmentID=N.nextSegmentId++,N.completedBoundaries.push(st),D(z,N.responseState,st.id),rl(N,z,q);else{if(r(z,Ms),q=st.completedSegments,q.length!==1)throw Error(e(391));ol(N,z,q[0])}return r(z,xs)}function Bh(N,z,q){return je(z,N.responseState,q.formatContext,q.id),ol(N,z,q),Pe(z,q.formatContext)}function Uh(N,z,q){for(var st=q.completedSegments,Ot=0;Ot<st.length;Ot++)al(N,z,q,st[Ot]);if(st.length=0,N=N.responseState,st=q.id,q=q.rootSegmentID,i(z,N.startInlineScript),N.sentCompleteBoundaryFunction?i(z,Y):(N.sentCompleteBoundaryFunction=!0,i(z,cs)),st===null)throw Error(e(395));return q=l(q.toString(16)),i(z,st),i(z,et),i(z,N.segmentPrefix),i(z,q),r(z,J)}function al(N,z,q,st){if(st.status===2)return!0;var Ot=st.id;if(Ot===-1){if((st.id=q.rootSegmentID)===-1)throw Error(e(392));return Bh(N,z,st)}return Bh(N,z,st),N=N.responseState,i(z,N.startInlineScript),N.sentCompleteSegmentFunction?i(z,Ue):(N.sentCompleteSegmentFunction=!0,i(z,Be)),i(z,N.segmentPrefix),Ot=l(Ot.toString(16)),i(z,Ot),i(z,es),i(z,N.placeholderPrefix),i(z,Ot),r(z,os)}function Mu(N,z){s=new Uint8Array(512),n=0;try{var q=N.completedRootSegment;if(q!==null&&N.pendingRootTasks===0){ol(N,z,q),N.completedRootSegment=null;var st=N.responseState.bootstrapChunks;for(q=0;q<st.length-1;q++)i(z,st[q]);q<st.length&&r(z,st[q])}var Ot=N.clientRenderedBoundaries,Rt;for(Rt=0;Rt<Ot.length;Rt++){var Jt=Ot[Rt];st=z;var me=N.responseState,Ye=Jt.id,ns=Jt.errorDigest,Ze=Jt.errorMessage,ws=Jt.errorComponentStack;if(i(st,me.startInlineScript),me.sentClientRenderFunction?i(st,ft):(me.sentClientRenderFunction=!0,i(st,tt)),Ye===null)throw Error(e(395));i(st,Ye),i(st,_t),(ns||Ze||ws)&&(i(st,vt),i(st,l(Ft(ns||"")))),(Ze||ws)&&(i(st,vt),i(st,l(Ft(Ze||"")))),ws&&(i(st,vt),i(st,l(Ft(ws)))),r(st,it)}Ot.splice(0,Rt);var zn=N.completedBoundaries;for(Rt=0;Rt<zn.length;Rt++)Uh(N,z,zn[Rt]);zn.splice(0,Rt),o(z),s=new Uint8Array(512),n=0;var li=N.partialBoundaries;for(Rt=0;Rt<li.length;Rt++){var ui=li[Rt];t:{Ot=N,Jt=z;var ua=ui.completedSegments;for(me=0;me<ua.length;me++)if(!al(Ot,Jt,ui,ua[me])){me++,ua.splice(0,me);var ku=!1;break t}ua.splice(0,me),ku=!0}if(!ku){N.destination=null,Rt++,li.splice(0,Rt);return}}li.splice(0,Rt);var yr=N.completedBoundaries;for(Rt=0;Rt<yr.length;Rt++)Uh(N,z,yr[Rt]);yr.splice(0,Rt)}finally{o(z),N.allPendingTasks===0&&N.pingedTasks.length===0&&N.clientRenderedBoundaries.length===0&&N.completedBoundaries.length===0&&z.close()}}function Gh(N,z){try{var q=N.abortableTasks;q.forEach(function(st){return Dh(st,N,z)}),q.clear(),N.destination!==null&&Mu(N,N.destination)}catch(st){zr(N,st),_r(N,st)}}return Ig.renderToReadableStream=function(N,z){return new Promise(function(q,st){var Ot,Rt,Jt=new Promise(function(Ze,ws){Rt=Ze,Ot=ws}),me=aa(N,nt(z?z.identifierPrefix:void 0,z?z.nonce:void 0,z?z.bootstrapScriptContent:void 0,z?z.bootstrapScripts:void 0,z?z.bootstrapModules:void 0),Mt(z?z.namespaceURI:void 0),z?z.progressiveChunkSize:void 0,z?z.onError:void 0,Rt,function(){var Ze=new ReadableStream({type:"bytes",pull:function(ws){if(me.status===1)me.status=2,h(ws,me.fatalError);else if(me.status!==2&&me.destination===null){me.destination=ws;try{Mu(me,ws)}catch(zn){zr(me,zn),_r(me,zn)}}},cancel:function(){Gh(me)}},{highWaterMark:0});Ze.allReady=Jt,q(Ze)},function(Ze){Jt.catch(function(){}),st(Ze)},Ot);if(z&&z.signal){var Ye=z.signal,ns=function(){Gh(me,Ye.reason),Ye.removeEventListener("abort",ns)};Ye.addEventListener("abort",ns)}Nu(me)})},Ig.version="18.3.1",Ig}var aw;function SY(){if(aw)return Do;aw=1;var t,e;return t=bY(),e=EY(),Do.version=t.version,Do.renderToString=t.renderToString,Do.renderToStaticMarkup=t.renderToStaticMarkup,Do.renderToNodeStream=t.renderToNodeStream,Do.renderToStaticNodeStream=t.renderToStaticNodeStream,Do.renderToReadableStream=e.renderToReadableStream,Do}var yx=SY(),ch=iT();const jM=jt.createContext(null),ln=()=>{const t=jt.useContext(jM);if(!t)throw new Error("useOgma must be used within an OgmaProvider");return t.ogma};function lw(t,e){Object.keys(t).forEach(s=>{const n=t[s];n&&e(s,n)})}function AY(t){return t.startsWith("on")&&t.length>2?t[2].toLowerCase()+t.substring(3):null}function uw(t,e,s){const n={};Object.keys(e).forEach(i=>{if(!i.startsWith("on"))return;const r=AY(i),o=e[i];r&&typeof o=="function"&&(n[r]=o)}),lw(s,(i,r)=>{n[i]||(t.events.off(r),delete s[i])}),lw(n,(i,r)=>{const o=s[i];o&&o!==r&&t.events.off(o),(!o||o!==r)&&(t.events.on(i,r),s[i]=r)})}function N_(t,e){if(t===e)return!0;try{return JSON.stringify(t)===JSON.stringify(e)}catch{return!1}}const dw={},wY=(t,e)=>{const{options:s=dw,children:n,graph:i,onReady:r,theme:o,className:a="ogma-container"}=t,l=jt.useRef({}),u=jt.useRef(null),[h,g]=jt.useState(),[f,p]=jt.useState(),[y,_]=jt.useState(dw),[x,v]=jt.useState();return jt.useImperativeHandle(e,()=>h,[h]),jt.useEffect(()=>{if(!u.current||h)return;const b=new vY({container:u.current,graph:i,options:s});p(i),_(s),o&&(v(o),b.styles.setTheme(o)),uw(b,t,l.current),g(b),r&&r(b)},[u.current]),jt.useLayoutEffect(()=>{const b=()=>h==null?void 0:h.view.forceResize();return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]),jt.useEffect(()=>{h&&(i&&N_(i,f)===!1&&(p(i),h.setGraph(i)),s&&N_(s,y)===!1&&(_(s),h.setOptions(s)))},[i,s]),jt.useEffect(()=>{h&&o&&N_(o,x)===!1&&(v(o),h.styles.setTheme(o))},[o]),jt.useEffect(()=>{h&&uw(h,t,l.current)},[t]),rs.createElement("div",{style:{width:"100%",height:"100%"},className:a,ref:u},h&&rs.createElement(jM.Provider,{value:{ogma:h}},n))},TY=jt.memo(jt.forwardRef(wY)),CY=jt.forwardRef(({selector:t,attributes:e},s)=>{const n=ln(),[i,r]=jt.useState();return jt.useImperativeHandle(s,()=>i,[i]),jt.useEffect(()=>{const o=t?n.styles.addNodeRule(t,e):n.styles.addNodeRule(e);return r(o),()=>{o.destroy(),r(void 0)}},[t,e]),null}),LY=({attributes:t,fullOverwrite:e})=>{const s=ln();return jt.useEffect(()=>(s.styles.setHoveredNodeAttributes(t,e),()=>{s.styles.setHoveredNodeAttributes(null)}),[t,e]),null},NY=({attributes:t,fullOverwrite:e})=>{const s=ln();return jt.useEffect(()=>(s.styles.setSelectedNodeAttributes(t,e),()=>{s.styles.setSelectedNodeAttributes(null)}),[t,e]),null},MY=Object.assign(CY,{Hovered:LY,Selected:NY}),kY=jt.forwardRef(({selector:t,attributes:e},s)=>{const n=ln(),[i,r]=jt.useState();return jt.useImperativeHandle(s,()=>i,[i]),jt.useEffect(()=>{const o=t?n.styles.addEdgeRule(t,e):n.styles.addEdgeRule(e);return r(o),()=>{o.destroy(),r(void 0)}},[t,e]),null}),IY=({attributes:t,fullOverwrite:e})=>{const s=ln();return jt.useEffect(()=>(s.styles.setHoveredEdgeAttributes(t,e),()=>{s.styles.setHoveredEdgeAttributes(null)}),[t,e]),null},RY=({attributes:t,fullOverwrite:e})=>{const s=ln();return jt.useEffect(()=>(s.styles.setSelectedEdgeAttributes(t,e),()=>{s.styles.setSelectedEdgeAttributes(null)}),[t,e]),null},FY=Object.assign(kY,{Hovered:IY,Selected:RY}),PY=jt.forwardRef(({name:t,edgeAttributes:e,edgeDependencies:s,edgeOutput:n,nodeAttributes:i,nodeDependencies:r,nodeOutput:o},a)=>{const l=ln(),[u,h]=jt.useState(null);return jt.useImperativeHandle(a,()=>u,[u]),jt.useEffect(()=>{const g={edgeAttributes:e,edgeDependencies:s,edgeOutput:n,nodeAttributes:i,nodeDependencies:r,nodeOutput:o};async function f(){const p=l.styles.createClass({name:t,...g});await l.view.afterNextFrame(),h(p)}return f(),()=>{async function p(){const y=l.styles.getClass(t);y&&await y.destroy(),h(null)}p()}},[]),jt.useEffect(()=>{u&&u.update({edgeAttributes:e,edgeDependencies:s,edgeOutput:n,nodeAttributes:i,nodeDependencies:r,nodeOutput:o})},[e,s,n,i,r,o]),null}),zY=(t,e)=>t.name===e.name&&t.edgeAttributes===e.edgeAttributes&&t.edgeDependencies===e.edgeDependencies&&t.edgeOutput===e.edgeOutput&&t.nodeAttributes===e.nodeAttributes&&t.nodeDependencies===e.nodeDependencies&&t.nodeOutput===e.nodeOutput;jt.memo(PY,zY);function Za(t,e,s){e===t.isEnabled()&&(e?t.disable(s):t.enable(s))}function Ka(t,e,s){const n=({target:l})=>{l===e&&t.onEnabled&&t.onEnabled(e)},i=({target:l})=>{l===e&&t.onDisabled&&t.onDisabled(e)},r=({target:l})=>{l===e&&t.onUpdated&&t.onUpdated(e)},o=({target:l,index:u})=>{l===e&&t.onSetIndex&&t.onSetIndex(e,u)},a=({target:l})=>{l===e&&(t.onDestroyed&&t.onDestroyed(e),s.events.off(n).off(i).off(r).off(o).off(a))};return s.events.on("transformationEnabled",n).on("transformationDisabled",i).on("transformationDestroyed",a).on("transformationSetIndex",o).on("transformationRefresh",r),()=>{s.events.off(n).off(i).off(r).off(o).off(a)}}function DY(t,e){const s=ln(),[n,i]=jt.useState();return jt.useImperativeHandle(e,()=>n,[n]),jt.useEffect(()=>{const r=s.transformations.addNodeGrouping({...t,enabled:!t.disabled});return Ka(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),jt.useEffect(()=>{n&&Za(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),jt.useEffect(()=>{n==null||n.setOptions(t)},[t.groupIdFunction,t.groupSelfLoopEdges,t.edgeGenerator,t.nodeGenerator,t.groupEdges,t.padding,t.selector,t.showContents,t.separateEdgesByDirection]),null}jt.forwardRef(DY);function OY(t,e){const s=ln(),[n,i]=jt.useState();return jt.useImperativeHandle(e,()=>n,[n]),jt.useEffect(()=>{const r=s.transformations.addEdgeGrouping({...t,enabled:!t.disabled});return Ka(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),jt.useEffect(()=>{n&&Za(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),jt.useEffect(()=>{n==null||n.setOptions(t)},[t.selector,t.generator,t.groupIdFunction,t.separateEdgesByDirection]),null}jt.forwardRef(OY);function BY(t,e){const s=ln(),[n,i]=jt.useState();return jt.useImperativeHandle(e,()=>n,[n]),jt.useEffect(()=>{const r=s.transformations.addNodeCollapsing({...t,enabled:!t.disabled});return Ka(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),jt.useEffect(()=>{n&&Za(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),jt.useEffect(()=>{n==null||n.setOptions(t)},[t.edgeGenerator,t.selector]),null}jt.forwardRef(BY);function UY(t,e){const s=ln(),[n,i]=jt.useState();return jt.useImperativeHandle(e,()=>n,[n]),jt.useEffect(()=>{const r=s.transformations.addNeighborMerging({...t,enabled:!t.disabled});return Ka(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),jt.useEffect(()=>{n&&Za(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),jt.useEffect(()=>{n==null||n.setOptions(t)},[t.dataFunction,t.selector]),null}jt.forwardRef(UY);function GY(t,e){const s=ln(),[n,i]=jt.useState();return jt.useImperativeHandle(e,()=>n,[n]),jt.useEffect(()=>{const r=s.transformations.addNeighborGeneration({...t,enabled:!t.disabled});return Ka(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),jt.useEffect(()=>{n&&Za(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),jt.useEffect(()=>{n==null||n.setOptions(t)},[t.edgeGenerator,t.nodeGenerator,t.neighborIdFunction,t.selector]),null}jt.forwardRef(GY);function VY(t,e){const s=ln(),[n,i]=jt.useState();return jt.useImperativeHandle(e,()=>n,[n]),jt.useEffect(()=>{const r=s.transformations.addEdgeFilter({...t,enabled:!t.disabled});return Ka(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),jt.useEffect(()=>{n&&Za(n,!!t.disabled,t.duration)},[t.disabled]),jt.useEffect(()=>{n==null||n.setOptions(t)},[t.criteria]),null}jt.forwardRef(VY);function jY(t,e){const s=ln(),[n,i]=jt.useState();return jt.useImperativeHandle(e,()=>n,[n]),jt.useEffect(()=>{const r=s.transformations.addNodeFilter({...t,enabled:!t.disabled});return Ka(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),jt.useEffect(()=>{n&&Za(n,!!t.disabled,t.duration)},[t.disabled]),jt.useEffect(()=>{n==null||n.setOptions(t)},[t.criteria]),null}jt.forwardRef(jY);function HY(t,e,s,n){return typeof s=="string"?s:typeof s=="function"?yx.renderToString(s(t,e)):yx.renderToString(n)}function If(t,e){return typeof t=="function"?t(e):t}const hw=(t,e)=>`${t} ${t}--${e}`;function $Y(t="&times;",e){if(t){const s=typeof t=="string"?t:yx.renderToString(t);return`<div class=${e}>${s}</div>`}return""}function qY(t){return t.endsWith("Doubleclick")?"doubleclick":t.toLowerCase().endsWith("click")?"click":"mouseover"}function YY(t,e){if(t instanceof xi){const s=t.getAttribute("radius"),n=cw("outer",t,e),i=cw("inner",t,e);return s+n+i}else if(t instanceof Ir)return t.size;return 0}function cw(t,e,s){const n=e.getAttribute(`${t}Stroke.width`);return e.getAttribute(`${t}Stroke.minVisibleSize`)>e.size?0:e.getAttribute(`${t}Stroke.scalingMethod`)==="fixed"?n:n/s}function gw(t,e,s){const n=YY(t,e),i={x:0,y:0};switch(s){case"top":i.y=-n;break;case"bottom":i.y=n;break;case"left":i.x=-n;break;case"right":i.x=n;break}return i}function WY(t,e,s){return t.left<0?"right":t.right>e?"left":t.top<0?"bottom":t.bottom>s?"top":null}function fw(t,e,s){switch(t||e){case"top":return`translate(calc(-50% + ${s.x}px),calc(-100% + ${s.y}px))`;case"bottom":return`translate(calc(-50% + ${s.x}px),${s.y}px)`;case"left":return`translate(calc(-100% + ${s.x}px),calc(-50% + ${s.y}px))`;default:return`translate(${s.x}px,calc(-50% + ${s.y}px))`}}const M_={x:-9999,y:-9999},XY="ogma-popup--content",ZY="ogma-popup--close",KY="ogma-popup--body",QY="ogma-popup",JY=({content:t,position:e,children:s,isOpen:n=!0,closeButton:i,onClose:r=()=>{},placement:o="top",popupClass:a=QY,closeButtonClass:l=ZY,contentClass:u=XY,popupBodyClass:h=KY,size:g,closeOnEsc:f=!0},p)=>{const y=ln(),[_,x]=jt.useState(null);if(jt.useImperativeHandle(p,()=>_,[_]),jt.useEffect(()=>{let b=null,S=null,A=null;if(n){const w=If(e,y)||M_;if(b=y.layers.addOverlay({position:w||M_,element:`<div class="${hw(a,o)}"/>
          <div class="${h}">
            ${$Y(i,l)}
            <div class="${u} "></div>
          </div>
        </div>`,size:g||{width:"auto",height:"auto"},scaled:!1}),A=L=>{const M=b==null?void 0:b.element.querySelector(`.${l}`);L.target&&M.contains(L.target)&&(L.stopPropagation(),L.preventDefault(),r())},S=({code:L})=>{L===27&&r()},f&&y.events.on("keyup",S),b.element.addEventListener("click",A),x(b),t&&!s){const L=b.element.querySelector(`.${u}`),M=HY(y,w,t,s);L&&(L.innerHTML=M)}x(b)}return()=>{b&&(A&&b.element.removeEventListener("click",A),S&&y.events.off(S),b.destroy(),x(null))}},[n,y]),jt.useEffect(()=>{if(_&&_.element){const b=If(e,y)||M_;if(_.setPosition(b),_.element.className=hw(a,o),t&&!s){const S=_.element.querySelector(`.${u}`);S&&(S.innerHTML=typeof t=="string"?t:"")}n?_.show():_.hide()}},[_,e,n,o,a,t,s]),!_||!n)return null;const v=_.element.querySelector(`.${u}`);return v&&s?ch.createPortal(s,v):null};jt.forwardRef(JY);const tW={x:-9999,y:-9999},eW=({eventName:t,position:e,children:s,placement:n="top",bodyClass:i="ogma-tooltip--body",translate:r={x:0,y:0},size:o},a)=>{const l=ln(),[u,h]=jt.useState(),[g,f]=jt.useState(),[p,y]=jt.useState(null);jt.useImperativeHandle(a,()=>p,[p]);function _(v,b){if(e)p==null||p.show();else{const w=l.geo.enabled()?l.geo.getZoom():l.view.getZoom(),L=gw(v,w,n),M={x:b.x+L.x,y:b.y+L.y};f(b),p==null||p.setPosition(M)}const S=fw(null,n,r),A=p.element.children[0];A.style.transform=S}function x(){p==null||p.hide(),h(void 0)}if(jt.useEffect(()=>{const v=l.layers.addOverlay({position:e||tW,element:`
      <div style="pointer-events: none">
        <div class="${i}" style="pointer-events: auto">
        </div>
      </div>`,size:o||{width:"auto",height:"auto"},scaled:!1});y(v)},[]),jt.useEffect(()=>{if(!p)return;let v=()=>null,b=()=>null;const S=qY(t);return S==="mouseover"?(v=A=>{var w;if(t.startsWith("node")){if((w=A.target)!=null&&w.isNode){const L=A.target;h(L),_(L,L.getPosition())}}else if(t.startsWith("edge")&&A.target&&!A.target.isNode){const L=l.view.screenToGraphCoordinates({x:A.x,y:A.y});h(A.target),_(A.target,L)}},b=A=>{var w;(t.startsWith("node")&&((w=A.target)!=null&&w.isNode)||t.startsWith("edge")&&A.target&&!A.target.isNode)&&x()},l.events.on("mouseout",b)):(v=A=>{var w;if(!(t.endsWith("Rightclick")&&A.button==="left")){if(t.startsWith("background")){if(!A.target){const L=l.view.screenToGraphCoordinates({x:A.x,y:A.y});h(L),_("background",L)}}else if(t.startsWith("node")){if((w=A.target)!=null&&w.isNode){const L=A.target;h(L),_(L,L.getPosition())}}else if(A.target&&!A.target.isNode){const L=l.view.screenToGraphCoordinates({x:A.x,y:A.y});h(A.target),_(A.target,L)}}},b=A=>{var w;t.startsWith("node")?(w=A.target)!=null&&w.isNode||x():t.startsWith("edge")?(!A.target||A.target.isNode)&&x():t.startsWith("background")&&(A.target||t.endsWith("Rightclick")&&A.button==="left"||t.endsWith("Click")&&A.button==="right")&&x()},l.events.on("click",b)),p.hide(),l.events.on(S,v),()=>{l.events.off(v),l.events.off(b),p&&(p.destroy(),y(null))}},[p]),jt.useEffect(()=>{!p||!p.element||(e&&p.setPosition(e),(n||i)&&(p.element.firstElementChild.className="ogma-popup--body "+i),o&&p.setSize(o))},[e,n,o,i]),jt.useEffect(()=>{if(!p||!p.element||!u)return;const v=p.element,b=v.children[0].getBoundingClientRect(),S=v.ownerDocument.defaultView,A=WY(b,S.innerWidth,S.innerHeight);if(A){const w=l.geo.enabled()?l.geo.getZoom():l.view.getZoom(),L=u instanceof xi||u instanceof Ir?u:"background",M=gw(L,w,A);p==null||p.setPosition({x:g.x+M.x,y:g.y+M.y});const F=fw(A,n,r);v.children[0].style.transform=F}p.show()},[g]),!p||!p.element)return null;if(s instanceof Function){if(!u)return null;const v=s(u);return v===null?(p.hide(),null):ch.createPortal(v,p.element.firstElementChild)}else return s?ch.createPortal(s,p.element.firstElementChild):null};jt.forwardRef(eW);const sW=({noClear:t=!1,isStatic:e=!1,render:s,index:n,visible:i=!0},r)=>{const o=ln(),[a,l]=jt.useState(null);return jt.useImperativeHandle(r,()=>a,[a]),jt.useEffect(()=>{const u=o.layers.addCanvasLayer(s,{isStatic:e,noClear:t},n);return l(u),()=>{u&&(u.destroy(),l(null))}},[]),jt.useEffect(()=>{a&&(n!==void 0&&isFinite(n)&&a.moveTo(n),i?a.show():a.hide())},[a,n,i]),null};jt.forwardRef(sW);const k_={x:-9999,y:-9999};jt.forwardRef(({position:t,children:e,className:s="",size:n,scaled:i,index:r},o)=>{const a=ln(),[l,u]=jt.useState(null);return jt.useImperativeHandle(o,()=>l,[l]),jt.useEffect(()=>{const h=If(t,a)||k_,g=document.createElement("div");g.className=s;const f=a.layers.addOverlay({position:h||k_,element:g,size:n||{width:"auto",height:"auto"},scaled:i},r);return u(f),()=>{l&&(l.destroy(),u(null))}},[]),jt.useEffect(()=>{if(l){const h=If(t,a)||k_;s&&(l.element.className=s),r!==void 0&&isFinite(r)&&l.moveTo(r),l.setPosition(h)}},[t,s,r]),l?ch.createPortal(e,l.element):null});const nW=jt.forwardRef(({children:t,className:e="",index:s},n)=>{const i=ln(),[r,o]=jt.useState(null);return jt.useImperativeHandle(n,()=>r,[r]),jt.useEffect(()=>{const a=document.createElement("div");a.className=e;const l=i.layers.addLayer(a,s);return o(l),()=>{r&&(r.destroy(),o(null))}},[]),jt.useEffect(()=>{r&&(e&&(r.element.className=e),s!==void 0&&isFinite(s)&&r.moveTo(s))},[e,s]),r?ch.createPortal(t,r.element):null}),Rg=nW;var iW=Object.defineProperty,rW=(t,e,s)=>e in t?iW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,Wt=(t,e,s)=>rW(t,typeof e!="symbol"?e+"":e,s);function oW(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var pw={exports:{}},mw;function aW(){return mw||(mw=1,(function(t){var e=Object.prototype.hasOwnProperty,s="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(s=!1));function i(l,u,h){this.fn=l,this.context=u,this.once=h||!1}function r(l,u,h,g,f){if(typeof h!="function")throw new TypeError("The listener must be a function");var p=new i(h,g||l,f),y=s?s+u:u;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],p]:l._events[y].push(p):(l._events[y]=p,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,h;if(this._eventsCount===0)return l;for(h in u=this._events)e.call(u,h)&&l.push(s?h.slice(1):h);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=s?s+l:l,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var g=0,f=h.length,p=new Array(f);g<f;g++)p[g]=h[g].fn;return p},a.prototype.listenerCount=function(l){var u=s?s+l:l,h=this._events[u];return h?h.fn?1:h.length:0},a.prototype.emit=function(l,u,h,g,f,p){var y=s?s+l:l;if(!this._events[y])return!1;var _=this._events[y],x=arguments.length,v,b;if(_.fn){switch(_.once&&this.removeListener(l,_.fn,void 0,!0),x){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,u),!0;case 3:return _.fn.call(_.context,u,h),!0;case 4:return _.fn.call(_.context,u,h,g),!0;case 5:return _.fn.call(_.context,u,h,g,f),!0;case 6:return _.fn.call(_.context,u,h,g,f,p),!0}for(b=1,v=new Array(x-1);b<x;b++)v[b-1]=arguments[b];_.fn.apply(_.context,v)}else{var S=_.length,A;for(b=0;b<S;b++)switch(_[b].once&&this.removeListener(l,_[b].fn,void 0,!0),x){case 1:_[b].fn.call(_[b].context);break;case 2:_[b].fn.call(_[b].context,u);break;case 3:_[b].fn.call(_[b].context,u,h);break;case 4:_[b].fn.call(_[b].context,u,h,g);break;default:if(!v)for(A=1,v=new Array(x-1);A<x;A++)v[A-1]=arguments[A];_[b].fn.apply(_[b].context,v)}}return!0},a.prototype.on=function(l,u,h){return r(this,l,u,h,!1)},a.prototype.once=function(l,u,h){return r(this,l,u,h,!0)},a.prototype.removeListener=function(l,u,h,g){var f=s?s+l:l;if(!this._events[f])return this;if(!u)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!g||p.once)&&(!h||p.context===h)&&o(this,f);else{for(var y=0,_=[],x=p.length;y<x;y++)(p[y].fn!==u||g&&!p[y].once||h&&p[y].context!==h)&&_.push(p[y]);_.length?this._events[f]=_.length===1?_[0]:_:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=s?s+l:l,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=s,a.EventEmitter=a,t.exports=a})(pw)),pw.exports}var lW=aW();const uW=oW(lW),cp="dragging",gh="dragstart",xx="dragend",vx="click",HM="select",$M="unselect",qM="remove",Rf="add",bx="cancelDrawing",Ff="completeDrawing",YM="update",dW="link",WM="history",XM=5,hW=3,G0={SHAPES:1,EDITOR:2,HANDLES:3},Hi="start",Fa="end",on={default:"default",move:"move",pointer:"pointer",crosshair:"crosshair",grab:"grab",grabbing:"grabbing",ewResize:"ew-resize",nsResize:"ns-resize",nwResize:"nw-resize",neResize:"ne-resize",swResize:"sw-resize",seResize:"se-resize"},fh="collapsed",ZM="expanded",KM=1.2,cW=.2,Cs={TEXT:"text",NODE:"node",COMMENT:"comment",POLYGON:"polygon",EDGE:"edge"},QM=`<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>`;let Qa=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,s)=>(s&=63,s<36?e+=s.toString(36):s<62?e+=(s-26).toString(36).toUpperCase():s>62?e+="-":e+="_",e),"");function gW(t,e){const s=t[0]-e[0],n=t[1]-e[1];return s*s+n*n}function fW(t,e,s){let n=e[0],i=e[1],r=s[0]-n,o=s[1]-i;if(r!==0||o!==0){const a=((t[0]-n)*r+(t[1]-i)*o)/(r*r+o*o);a>1?(n=s[0],i=s[1]):a>0&&(n+=r*a,i+=o*a)}return r=t[0]-n,o=t[1]-i,r*r+o*o}function pW(t,e){let s=t[0];const n=[s];let i;for(let r=1,o=t.length;r<o;r++)i=t[r],gW(i,s)>e&&(n.push(i),s=i);return s!==i&&n.push(i),n}function Ex(t,e,s,n,i){let r=n,o=0;for(let a=e+1;a<s;a++){const l=fW(t[a],t[e],t[s]);l>r&&(o=a,r=l)}r>n&&(o-e>1&&Ex(t,e,o,n,i),i.push(t[o]),s-o>1&&Ex(t,o,s,n,i))}function mW(t,e){const s=t.length-1,n=[t[0]];return Ex(t,0,s,e,n),n.push(t[s]),n}function _w(t,e,s){if(t.length<=2)return t;const n=e!==void 0?e*e:1;return t=s?t:pW(t,n),t=mW(t,n),t}function yw(t){if(t.geometry.bbox)return t.geometry.bbox;const e=t.geometry.coordinates[0];let s=1/0,n=1/0,i=-1/0,r=-1/0;for(const[o,a]of e)o<s&&(s=o),o>i&&(i=o),a<n&&(n=a),a>r&&(r=a);return[s,n,i,r]}function JM(t){const e=t.geometry.coordinates[0];let s=0,n=0;const i=e.length-1;for(let r=0;r<i;r++)s+=e[r][0],n+=e[r][1];return{x:s/i,y:n/i}}function _W(t,e,s){const n=t.geometry.coordinates.map(o=>o.map(([a,l])=>[a+e,l+s])),i=t.geometry.bbox,r=i?[i[0]+e,i[1]+s,i[2]+e,i[3]+s]:void 0;return{...t,geometry:{...t.geometry,coordinates:n,bbox:r}}}function yW(t){const e=t.geometry.coordinates[0];let s=1/0,n=1/0,i=-1/0,r=-1/0;for(const[o,a]of e)o<s&&(s=o),o>i&&(i=o),a<n&&(n=a),a>r&&(r=a);t.geometry.bbox=[s,n,i,r]}const xW="http://www.w3.org/2000/svg";function As(t){return document.createElementNS(xW,t)}function Kr(t){return t.geometry.bbox||ph(t),t.geometry.bbox}function $n(t){if("width"in t.properties&&"height"in t.properties)return{width:t.properties.width,height:t.properties.height};const e=Kr(t);return{width:e[2]-e[0],height:e[3]-e[1]}}function ru(t,e=!1,s=1){if(t.geometry.type==="Point"&&"width"in t.properties&&"height"in t.properties){const[i,r]=t.geometry.coordinates;let o=t.properties.width,a=t.properties.height;return e&&(o/=s,a/=s),{x:i-o/2,y:r-a/2}}const n=Kr(t);return{x:n[0],y:n[1]}}function yi(t){if(t.geometry.type==="Point")return{x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};const e=Kr(t);return{x:(e[0]+e[2])/2,y:(e[1]+e[3])/2}}function ph(t){if(vi(t)){const[e,s]=t.geometry.coordinates[0],[n,i]=t.geometry.coordinates[1];t.geometry.bbox=[Math.min(e,n),Math.min(s,i),Math.max(e,n),Math.max(s,i)]}else if(t.geometry.type==="Point"&&"width"in t.properties&&"height"in t.properties){const[e,s]=t.geometry.coordinates,n=t.properties.width/2,i=t.properties.height/2;t.geometry.bbox=[e-n,s-i,e+n,s+i]}else if(t.geometry.type==="Polygon"){const e=t.geometry.coordinates[0];let s=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY;for(const o of e){const a=o[0],l=o[1];a<s&&(s=a),l<n&&(n=l),a>i&&(i=a),l>r&&(r=l)}t.geometry.bbox=[s,n,i,r]}}function tk(t){const[e,s]=t.geometry.coordinates[0];return{x:e,y:s}}function Kg(t,e){const[s,n]=t.geometry.coordinates[e===Hi?0:1];return{x:s,y:n}}function ek(t){const[e,s]=t.geometry.coordinates[1];return{x:e,y:s}}function vW(t,e,s){t.geometry.coordinates[0]=[e,s]}function bW(t,e,s){t.geometry.coordinates[1]=[e,s]}function V0(t){return{start:tk(t),end:ek(t)}}function EW(t,e,s,n){e===Hi?vW(t,s,n):bW(t,s,n)}function sk(t){return Qg(t).reduce((e,s)=>(e[0]=Math.min(s[0],e[0]),e[1]=Math.min(s[1],e[1]),e[2]=Math.max(s[0],e[2]),e[3]=Math.max(s[1],e[3]),e),[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY])}function Qg(t){let e=[];if(t.type=="Point")t.bbox?e=[[t.bbox[0],t.bbox[1]],[t.bbox[2],t.bbox[3]]]:e=[t.coordinates];else if(t.type=="LineString"||t.type=="MultiPoint")e=t.coordinates;else if(t.type=="Polygon"||t.type=="MultiLineString")e=t.coordinates.reduce(function(s,n){return s.concat(n)},[]);else if(t.type=="MultiPolygon")e=t.coordinates.reduce((s,n)=>s.concat(n.reduce((i,r)=>i.concat(r),[])),[]);else if(t.type=="Feature")if(Xs(t)||qn(t)){const s=Kr(t);e=[[s[0],s[1]],[s[2],s[3]]]}else e=Qg(t.geometry);else t.type=="GeometryCollection"?e=t.geometries.reduce((s,n)=>s.concat(Qg(n)),[]):t.type=="FeatureCollection"&&(e=t.features.reduce((s,n)=>s.concat(Qg(n)),[]));return e}function Sx(t,e){if(!e)return{x:t.clientX,y:t.clientY};const s=e.getBoundingClientRect();return{x:t.clientX-s.left-e.clientLeft,y:t.clientY-s.top-e.clientTop}}function SW(t){if(t.startsWith("#")){const e=nk(t),s=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),i=parseInt(e.slice(5,7),16);return{r:s,g:n,b:i,a:1}}else{const e=t.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([0-9.]+))?\)/);if(!e)throw new Error(`Invalid RGB color: ${t}`);return{r:parseInt(e[1]),g:parseInt(e[2]),b:parseInt(e[3]),a:e[4]!==void 0?parseFloat(e[4]):1}}}function nk(t){return t.length===4?t.split("").map(e=>e+e).join(""):t}function xw(){return typeof window<"u"?window:void 0}const ik=(t,e)=>{let s=!1;return(...n)=>{s||(t(...n),s=!0,setTimeout(()=>{s=!1},e))}};function AW(t){if((qn(t)||Xs(t))&&t.geometry.type==="Polygon"){const e=t.geometry.coordinates[0],s=e[0][0],n=e[0][1],i=e[2][0],r=e[2][1],o=i-s,a=r-n,l=s+o/2,u=n+a/2;return{...t,geometry:{type:"Point",coordinates:[l,u],bbox:[s,n,i,r]},properties:{...t.properties,width:o,height:a}}}return t}function wW(t,e){let s,n,i,r=1;const o=t.trim();if(o.startsWith("#")){const u=(o.length===4?nk(o):o).match(/#?(\w{2})(\w{2})(\w{2})/);if(!u)return t;s=parseInt(u[1],16),n=parseInt(u[2],16),i=parseInt(u[3],16)}else{const u=o.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([0-9.]+))?\)/);if(!u)return t;s=parseInt(u[1]),n=parseInt(u[2]),i=parseInt(u[3]),r=u[4]!==void 0?parseFloat(u[4]):1}const a=e*100,l=.299*s+.587*n+.114*i>186?-a/2:a;return s=Math.max(0,Math.min(255,s+Math.round(2.55*l))),n=Math.max(0,Math.min(255,n+Math.round(2.55*l))),i=Math.max(0,Math.min(255,i+Math.round(2.55*l))),`rgba(${s},${n},${i},${r})`}const gp=t=>wW(t,cW),En=(t,e)=>({x:t.x-e.x,y:t.y-e.y}),Mi=t=>Math.sqrt(t.x*t.x+t.y*t.y),TW=t=>({x:-t.x,y:-t.y}),Pf=t=>{const e=Mi(t);return e===0?{x:0,y:0}:{x:t.x/e,y:t.y/e}},$a=(t,e)=>({x:t.x+e.x,y:t.y+e.y}),eo=(t,e)=>({x:t.x*e,y:t.y*e}),vw=(t,e)=>{const s=Math.sin(e),n=Math.cos(e);return{x:t.x*n-t.y*s,y:t.x*s+t.y*n}},vu=(t,e)=>t.x*e.x+t.y*e.y,CW=(t,e)=>t.x*e.y-t.y*e.x,vi=t=>t.properties.type==="arrow";function rk(t,e,s){const{start:n,end:i}=V0(t),r=En(e,n),o=t.properties.style.strokeWidth,a=En(i,n),l=Mi(a),u=vu(r,Pf(a));return u>0&&u<l&&Math.abs(CW(r,Pf(a)))<o/2+s}const qa={strokeType:"plain",strokeColor:"#202020",strokeWidth:1,head:"none",tail:"none"};({...qa});const Ax=(t=0,e=0,s=0,n=0,i={...qa})=>({id:Qa(),type:"Feature",properties:{type:"arrow",style:{...qa,...i}},geometry:{type:"LineString",coordinates:[[t,e],[s,n]]}}),qn=t=>t.properties.type==="box";function LW(t,e,s=0,n=1,i=0){const r=ru(t),{width:o,height:a}=$n(t),l=e.x-r.x,u=e.y-r.y,h=l*n-u*s,g=l*s+u*n;return h>-i&&h<o+i&&g>-i&&g<a+i}const mh={background:"#f5f5f5",strokeWidth:0,borderRadius:8,padding:16,strokeType:"plain"};({...mh});const bw=(t=0,e=0,s=100,n=50,i={...mh})=>({id:Qa(),type:"Feature",properties:{type:"box",width:s,height:n,style:{...mh,...i}},geometry:{type:"Point",coordinates:[t+s/2,e+n/2]}}),Xs=t=>t.properties.type==="text",rn={font:"sans-serif",fontSize:18,color:"#505050",background:"#f5f5f5",strokeWidth:0,borderRadius:8,padding:16,strokeType:"plain",fixedSize:!1};Qa(),{...rn};const Ew=(t=0,e=0,s=100,n=50,i="",r={...rn})=>({id:Qa(),type:"Feature",properties:{type:"text",content:i,width:s,height:n,style:{...rn,...r}},geometry:{type:"Point",coordinates:[t+s/2,e+n/2],bbox:[t,e,t+s,e+n]}});function ok(t,e,s=0,n=0,i=1,r=1){var o;const[a,l]=t.geometry.coordinates;let{width:u,height:h}=$n(t);(o=t.properties.style)!=null&&o.fixedSize&&(u/=r,h/=r);const g=u/2,f=h/2,p=e.x-a,y=e.y-l,_=p*i-y*n,x=p*n+y*i;return _>-g-s&&_<g+s&&x>-f-s&&x<f+s}const bn=t=>t.properties.type==="comment",Ta={background:"#FFFACD",padding:8,borderRadius:4,strokeColor:"#DDD",strokeWidth:1,strokeType:"plain",iconColor:"#FFCB2F",iconSymbol:"",iconBorderColor:"#aaa",iconBorderWidth:2,minHeight:60,iconSize:32,color:"#333",font:"Arial, sans-serif",fontSize:12,showSendButton:!0,autoGrow:!0,fixedSize:!0},I_={mode:"expanded",width:200,height:60};function NW(t,e,s,n){const i={type:"comment",content:s,mode:(n==null?void 0:n.mode)??I_.mode,width:(n==null?void 0:n.width)??I_.width,height:(n==null?void 0:n.height)??I_.height,author:n==null?void 0:n.author,timestamp:n==null?void 0:n.timestamp,style:{...Ta,...n==null?void 0:n.style}};return{id:Qa(),type:"Feature",properties:i,geometry:{type:"Point",coordinates:[t,e]}}}function MW(t,e,s=0,n,i,r=1){if(t.properties.mode!==fh)return ok(t,e,s,n,i,r);const o=t.properties,a={...Ta,...o.style};let l=a.iconSize,u=a.iconSize;a.fixedSize&&(l/=r,u/=r);const h=l/2,g=u/2,f=e.x-t.geometry.coordinates[0],p=e.y-t.geometry.coordinates[1];return f>=-h-s&&f<=h+s&&p>=-g-s&&p<=g+s}function kW(t,e,s,n,i,r,o,a,l){const u=t-o,h=e-a,g=o+u*r-h*i,f=a+u*i+h*r,p=o+(u+s)*r-h*i,y=a+(u+s)*i+h*r,_=o+(u+s)*r-(h+n)*i,x=a+(u+s)*i+(h+n)*r,v=o+u*r-(h+n)*i,b=a+u*i+(h+n)*r;return l[0]=Math.min(g,p,_,v),l[1]=Math.min(f,y,x,b),l[2]=Math.max(g,p,_,v),l[3]=Math.max(f,y,x,b),l}function IW(t,e,s){const n=s.x-e.x,i=s.y-e.y,r=n*n+i*i;if(r===0){const g=t.x-e.x,f=t.y-e.y;return Math.sqrt(g*g+f*f)}let o=((t.x-e.x)*n+(t.y-e.y)*i)/r;o=Math.max(0,Math.min(1,o));const a=e.x+o*n,l=e.y+o*i,u=t.x-a,h=t.y-l;return Math.sqrt(u*u+h*h)}const kr=t=>t.properties.type==="polygon";function ak(t,e,s=0){const n=t.geometry.coordinates[0],i=t.geometry.bbox;if(i){const[o,a,l,u]=i;if(e.x<o-s||e.x>l+s||e.y<a-s||e.y>u+s)return!1}let r=!1;for(let o=0,a=n.length-1;o<n.length;a=o++){const l=n[o][0],u=n[o][1],h=n[a][0],g=n[a][1];u>e.y!=g>e.y&&e.x<(h-l)*(e.y-u)/(g-u)+l&&(r=!r)}if(r)return!0;if(s>0)for(let o=0;o<n.length-1;o++){const[a,l]=n[o],[u,h]=n[o+1];if(IW(e,{x:a,y:l},{x:u,y:h})<=s)return!0}return!1}function RW(t,e){const s=t[0];s.length>0&&(s[0][0]!==s[s.length-1][0]||s[0][1]!==s[s.length-1][1])&&s.push([s[0][0],s[0][1]]);let n=1/0,i=1/0,r=-1/0,o=-1/0;for(const[g,f]of s)g<n&&(n=g),g>r&&(r=g),f<i&&(i=f),f>o&&(o=f);const a=[n,i,r,o],{id:l,style:u,...h}=e||{};return{type:"Feature",id:l||Qa(),geometry:{type:"Polygon",coordinates:t,bbox:a},properties:{type:"polygon",style:{...Ca,...u},...h}}}const Ca={...mh,strokeColor:"#000000",strokeWidth:2,background:"transparent"};({...Ca});const Sw=t=>t.type==="FeatureCollection";class FW{constructor(e){Wt(this,"previousZoom",-1),this.store=e}toggleComment(e){const s=this.store.getState().getFeature(e);if(!s||!bn(s))return;const n=s;this.store.getState().applyLiveUpdate(e,{properties:{...n.properties,mode:n.properties.mode==="collapsed"?"expanded":"collapsed"}})}updateCommentModesForZoom(e){if(Math.abs(this.previousZoom-e)<5e-4)return;this.previousZoom=e;const s=this.store.getState(),n=s.features,i={};Object.values(n).forEach(r=>{if(bn(r)){const o=r,a=this.getCommentZoomThreshold(o),l=e<a?fh:ZM;if(o.properties.mode===l)return;i[o.id]={properties:{...o.properties,mode:l}}}}),s.applyLiveUpdates(i)}getCommentZoomThreshold(e){const s={...e.properties.style};if(s.collapseZoomThreshold!==void 0)return s.collapseZoomThreshold;const n=80/e.properties.width;return Math.max(.1,Math.min(1,n))}}class fp extends EventTarget{constructor(e,s){super(),Wt(this,"annotation",null),Wt(this,"ogma"),Wt(this,"dragging",!1),Wt(this,"dragStartPoint"),Wt(this,"hoveredHandle"),Wt(this,"ogmaPanningOption",!1),Wt(this,"store"),Wt(this,"draggingWasEnabled",!0),Wt(this,"handleMouseMove",n=>{if(!this.isActive())return;const i=this.store.getState();if(!this.dragging&&i.mousePressed&&i.mousePressPoint&&(this.detectHandle(n,this.ogma.view.getZoom()),this.hoveredHandle)){this.dragStartPoint=i.mousePressPoint,this.onDragStart(n),this.dispatchEvent(new Event(gh)),this.disablePanning();return}this.dragging?this.dragStartPoint&&this.onDrag(n):this.detectHandle(n,this.ogma.view.getZoom())}),Wt(this,"handleMouseDown",n=>{!this.isActive()||this.dragging||!this.hoveredHandle||(n.preventDefault(),n.stopPropagation(),this.dragStartPoint=this.clientToCanvas(n),this.onDragStart(n),this.dispatchEvent(new Event(gh)),this.disablePanning())}),Wt(this,"disablePanning",()=>{var n,i;this.ogmaPanningOption=!!((i=(n=this.ogma.getOptions().interactions)==null?void 0:n.pan)!=null&&i.enabled),this.ogma.setOptions({interactions:{pan:{enabled:!1},drag:{enabled:!1}}})}),Wt(this,"restorePanning",()=>{this.ogma.setOptions({interactions:{pan:{enabled:!0},drag:{enabled:!0}}})}),Wt(this,"handleMouseUp",n=>{!this.isActive()||!this.dragging||(this.restorePanning(),this.onDragEnd(n),this.dispatchEvent(new Event(xx)))}),this.store=s,this.ogma=e,this.store.subscribe(n=>n.features,n=>{this.isActive()&&!n[this.annotation]&&this.stopEditing()})}cancelEdit(){!this.isActive()||this.annotation===null||this.clearDragState()}clearDragState(){this.dragging=!1,this.dragStartPoint=void 0,this.hoveredHandle=void 0,this.restorePanning(),this.setCursor(on.default)}commitChange(){this.getAnnotation()&&this.store.getState().commitLiveUpdates()}onDrag(e){this.dispatchEvent(new Event(cp))}onDragStart(e){return this.isActive()?(this.dragging=!0,this.dragStartPoint=this.clientToCanvas(e),this.disablePanning(),!0):!1}onDragEnd(e){return this.isActive()?(this.restorePanning(),this.dragging=!1,!0):!1}clientToCanvas(e){const s=this.ogma,n=Sx(e,s.getContainer());return s.view.screenToGraphCoordinates(n)}setAnnotation(e){if(this.annotation=e?e.id:null,this.annotation!==null){const s=this.ogma.getContainer();if(s){const n=xw()||s;n.addEventListener("mousemove",this.handleMouseMove),n.addEventListener("mouseup",this.handleMouseUp,!1),s.addEventListener("mousedown",this.handleMouseDown,!0)}}else{const s=this.ogma.getContainer();if(s){const n=xw()||s;n.removeEventListener("mousemove",this.handleMouseMove),n.removeEventListener("mouseup",this.handleMouseUp),s.removeEventListener("mousedown",this.handleMouseDown)}this.clearDragState(),this.setCursor(on.default)}}getAnnotation(){return this.store.getState().getFeature(this.annotation)}setCursor(e){var s;const n=(s=this.ogma.getContainer())==null?void 0:s.firstChild;n&&(n.style.cursor=e)}stopEditing(){this.isActive()&&this.setAnnotation(null)}cancelDrawing(){if(!this.isActive())return;const e=this.store.getState();e.drawingFeature===this.annotation&&e.removeFeature(this.annotation),this.stopEditing()}isActive(){return this.annotation!==null}}class PW extends fp{constructor(e,s,n,i,r,o,a){super(e,s),Wt(this,"links"),Wt(this,"snapping"),Wt(this,"arrowHandler"),Wt(this,"arrowStyle"),Wt(this,"offsetX"),Wt(this,"offsetY"),Wt(this,"comment"),Wt(this,"startX",0),Wt(this,"startY",0),Wt(this,"onArrowComplete",()=>{var l;this.arrowHandler.removeEventListener("dragend",this.onArrowComplete);const u=this.store.getState(),h=Array.from(u.selectedFeatures);if(h.length===0)return;const g=u.getFeature(h[0]);if(!g||!vi(g))return;const f=g.geometry.coordinates[0],p=g.geometry.coordinates[1],y=p[0]-this.startX,_=p[1]-this.startY,x=Math.sqrt(y*y+_*_);let v,b;x<5?(v=this.startX+this.offsetX,b=this.startY+this.offsetY):(v=p[0],b=p[1]);const S=this.comment;S.geometry.coordinates=[v,b],u.addFeature(S),this.store.setState({drawingFeature:S.id});const A=S.properties.height,w=v,L=b+A*.5;this.snapArrowStart(g,f[0],f[1]);const M=(l=g.properties.link)==null?void 0:l.start;u.updateFeature(g.id,{...g,geometry:{...g.geometry,coordinates:[[w,L],f]},properties:{...g.properties,link:{start:{side:Hi,id:S.id,type:Cs.COMMENT,magnet:{x:0,y:.5}},end:M?{side:Fa,id:M.id,type:M.type,magnet:M.magnet}:void 0}}}),this.links.add(g,Hi,S.id,Cs.COMMENT,{x:0,y:.5}),M&&M.magnet&&this.links.add(g,Fa,M.id,M.type,M.magnet),u.setSelectedFeatures([S.id]),this.store.setState({drawingFeature:null})}),this.links=n,this.arrowHandler=r,this.snapping=i,this.offsetX=(a==null?void 0:a.offsetX)??100,this.offsetY=(a==null?void 0:a.offsetY)??-50,this.arrowStyle=a==null?void 0:a.arrowStyle,this.comment=o}detectHandle(e,s){}startDrawing(e,s,n){var i;this.startX=s,this.startY=n;const r=Ax(s,n,s,n,{...qa,head:"arrow",...(i=this.arrowStyle)==null?void 0:i.style});this.store.getState().addFeature(r),this.store.setState({drawingFeature:r.id}),this.arrowHandler.addEventListener("dragend",this.onArrowComplete),this.store.getState().setSelectedFeatures([r.id]),this.arrowHandler.startDrawing(r.id,s,n)}snapArrowStart(e,s,n){const i=this.snapping.snap({x:s,y:n});i&&(e.geometry.coordinates[0]=[i.point.x,i.point.y],e.properties.link={start:{side:Hi,id:i.id,type:i.type,magnet:i.magnet}},this.links.add(e,Hi,i.id,i.type,i.magnet))}}function zW(t,e,s,n,i){const{width:r,height:o}=n.view.getSize(),a=8,l=16,u=a*l,h={width:150,height:50},g=h.width,f=h.height,p=Math.max(r,o),y=200,_={minX:0,minY:0,maxX:0,maxY:0},x=n.view.graphToScreenCoordinates({x:t,y:e});for(let v=0;v<u;v++){const b=v%a,S=Math.floor(v/a),A=2*Math.PI*(b/a),w=y+S/l*(p-y),L=Math.cos(A)*w,M=Math.sin(A)*w,F=x.x+L,O=x.y+M;if(_.minX=F,_.minY=O-f/2,_.maxX=F+g,_.maxY=O+f/2,L<0&&(_.minX-=g,_.maxX-=g),_.minX<0||_.maxX>r||_.minY<0||_.maxY>o)continue;const G=n.view.screenToGraphCoordinates({x:_.minX,y:_.minY}),j=n.view.screenToGraphCoordinates({x:_.maxX,y:_.maxY});if(_.minX=G.x,_.minY=G.y,_.maxX=j.x,_.maxY=j.y,!s.query(_).filter(Z=>Z.properties.type!=="arrow").length)return n.view.screenToGraphCoordinates({x:F,y:O})}return n.view.screenToGraphCoordinates({x:r/2,y:o/2})}class DW{constructor(e,s,n,i,r,o,a){Wt(this,"ogma"),Wt(this,"store"),Wt(this,"editor"),Wt(this,"interactions"),Wt(this,"links"),Wt(this,"control"),Wt(this,"index"),Wt(this,"pendingDrawingListener",null),this.ogma=e,this.store=s,this.editor=n,this.interactions=i,this.links=r,this.control=o,this.index=a}cancelPendingDrawing(){this.pendingDrawingListener&&(this.ogma.events.off(this.pendingDrawingListener),this.pendingDrawingListener=null)}isDrawing(){return this.store.getState().drawingFeature!==null}enableDrawingMode(e){this.control.unselect().cancelDrawing();const s=n=>{this.ogma.events.off(s),this.pendingDrawingListener=null;const{x:i,y:r}=this.ogma.view.screenToGraphCoordinates(n);e(i,r)};return this.pendingDrawingListener=s,this.ogma.events.once("mousedown",s),this.control}enableArrowDrawing(e){return this.enableDrawingMode((s,n)=>{const i=Ax(s,n,s,n,e);this.startArrow(s,n,i)})}enableTextDrawing(e){return this.enableDrawingMode((s,n)=>{const i=Ew(s,n,0,0,void 0,e);this.startText(s,n,i)})}enableBoxDrawing(e){return this.enableDrawingMode((s,n)=>{const i=bw(s,n,0,0,e);this.startBox(s,n,i)})}enablePolygonDrawing(e){return this.enableDrawingMode((s,n)=>{const i=RW([[[s,n]]],{style:e});this.startPolygon(s,n,i)})}enableCommentDrawing(e={}){return this.enableDrawingMode((s,n)=>{let i=e.offsetX,r=e.offsetY;if(i===void 0&&r===void 0){const a=zW(s,n,this.index,this.ogma);i=a.x,r=a.y}const o=NW(s,n,"",e==null?void 0:e.commentStyle);this.startComment(s,n,o,{...e,offsetX:i,offsetY:r})})}startComment(e,s,n,i){this.editor.getActiveHandler()&&this.editor.getActiveHandler().stopEditing(),this.control.cancelDrawing(),this.store.setState({drawingFeature:n.id}),this.interactions.suppressClicksTemporarily(200);const r=new PW(this.ogma,this.store,this.links,this.editor.getSnapping(),this.editor.getArrowHandler(),n,i),o=a=>{var l;a.id===n.id&&(this.control.select(a.id),this.control.off(Rf,o),(l=this.editor.getActiveHandler())==null||l.startEditingText())};return this.control.on(Rf,o),r.startDrawing(n.id,e,s),this.control}startBox(e,s,n){return n||(n=bw(e,s)),this.store.setState({drawingFeature:n.id}),this.control.add(n),this.interactions.suppressClicksTemporarily(200),this.control.select(n.id),this.editor.getActiveHandler().startDrawing(n.id,e,s),this.control}startArrow(e,s,n){return n||(n=Ax(e,s)),this.editor.getActiveHandler()&&this.editor.getActiveHandler().stopEditing(),this.control.cancelDrawing(),this.store.setState({drawingFeature:n.id}),this.control.add(n),this.interactions.suppressClicksTemporarily(200),this.control.select(n.id),this.editor.getActiveHandler().startDrawing(n.id,e,s),this.control}startText(e,s,n){return n||(n=Ew(e,s)),this.store.setState({drawingFeature:n.id}),this.control.add(n),this.interactions.suppressClicksTemporarily(200),this.control.select(n.id),this.editor.getActiveHandler().startDrawing(n.id,e,s),this.control}startPolygon(e,s,n){return this.store.setState({drawingFeature:n.id}),this.control.add(n),this.interactions.suppressClicksTemporarily(200),this.control.select(n.id),this.editor.getActiveHandler().startDrawing(n.id,e,s),this.control}}class OW{constructor(e,s){this.store=e,this.links=s}undo(){return this.canUndo()?(this.store.temporal.getState().undo(),this.links.refresh(),!0):!1}redo(){return this.canRedo()?(this.store.temporal.getState().redo(),this.links.refresh(),!0):!1}canUndo(){return this.store.temporal.getState().pastStates.length>0}canRedo(){return this.store.temporal.getState().futureStates.length>0}clearHistory(){this.store.temporal.getState().clear()}}class BW{constructor(e){this.store=e}select(e){const s=Array.isArray(e)?e:[e];this.store.getState().setSelectedFeatures(s)}unselect(e){const s=Array.isArray(e)?e:[e];if(e===void 0)this.store.getState().setSelectedFeatures([]);else{const n=new Set(s),i=Array.from(this.store.getState().selectedFeatures).filter(r=>!n.has(r));this.store.getState().setSelectedFeatures(i)}}getSelectedAnnotations(){const e=this.store.getState();return{type:"FeatureCollection",features:Array.from(e.selectedFeatures).map(s=>e.features[s])}}getSelected(){const e=this.store.getState(),s=Array.from(e.selectedFeatures)[0];return s?e.features[s]:null}}class UW{constructor(e){this.store=e}add(e){if(Sw(e))for(const s of e.features)this.add(s);else{const s=AW(e);this.store.getState().addFeature(s)}}remove(e){if(Sw(e))for(const s of e.features)this.remove(s);else this.store.getState().removeFeature(e.id)}getAnnotations(){const e=this.store.getState().features;return{type:"FeatureCollection",features:Object.values(e)}}getAnnotation(e){return this.store.getState().getFeature(e)}updateStyle(e,s){const n=this.store.getState().getFeature(e);n&&this.store.getState().updateFeature(e,{id:e,properties:{...n.properties,style:{...n.properties.style,...s}}})}update(e){var s;const n=this.store.getState(),i=n.getFeature(e.id);i&&n.updateFeature(e.id,{...i,...e,properties:{...i.properties,...e.properties,style:{...i.properties.style,...(s=e.properties)==null?void 0:s.style}},geometry:{...i.geometry,...e.geometry}})}setScale(e,s,n,i){const r=this.store.getState().getFeature(e);if(!r)return;const o=this.store.getState();if(vi(r)){const a=r.geometry.coordinates.map(([l,u])=>{const h=l-n,g=u-i;return[n+h*s,i+g*s]});o.updateFeature(e,{geometry:{...r.geometry,coordinates:a}})}else if(Xs(r)||qn(r)){const[a,l]=r.geometry.coordinates,u=a-n,h=l-i,g=n+u*s,f=i+h*s,p=r.properties.width*s,y=r.properties.height*s;o.updateFeature(e,{properties:{...r.properties,width:p,height:y},geometry:{...r.geometry,coordinates:[g,f]}})}}}function lk(t){var e,s;const n=t.properties.link;return n?((e=n.start)==null?void 0:e.type)===Cs.COMMENT||((s=n.end)==null?void 0:s.type)===Cs.COMMENT:!1}function GW(t){var e,s;return((s=(e=t.properties.link)==null?void 0:e.start)==null?void 0:s.type)!==Cs.COMMENT}class VW extends fp{constructor(e,s,n,i){super(e,s),Wt(this,"snapping"),Wt(this,"links"),Wt(this,"snap",null),this.snapping=n,this.links=i}detectHandle(e){const s=this.getAnnotation(),n=this.clientToCanvas(e),i=XM,r=s.geometry.coordinates[0],o=s.geometry.coordinates[1],a=Math.sqrt(Math.pow(n.x-r[0],2)+Math.pow(n.y-r[1],2)),l=Math.sqrt(Math.pow(n.x-o[0],2)+Math.pow(n.y-o[1],2));a<i?this.grabHandle("start",r[0],r[1]):l<i?this.grabHandle("end",o[0],o[1]):rk(s,n,i)?(this.setCursor(on.grab),this.hoveredHandle={type:"body",point:n},this.store.setState({hoveredHandle:2})):(this.store.setState({hoveredHandle:-1}),this.hoveredHandle=void 0)}grabHandle(e,s,n){this.hoveredHandle={type:e,point:{x:s,y:n}},this.store.setState({hoveredHandle:e==="start"?0:1}),this.setCursor(on.move)}onDrag(e){var s;if(!(this.dragStartPoint||!this.hoveredHandle)||!this.isActive())return;e.stopPropagation(),e.stopImmediatePropagation();const n=this.clientToCanvas(e),i=this.hoveredHandle,r=this.getAnnotation();this.snap=this.snapping.snap(n);const o=((s=this.snap)==null?void 0:s.point)||n,a=r.properties.link||{},l=[...r.geometry.coordinates];if(i.type==="start")l[0]=[o.x,o.y],this.snap&&(a.start={side:i.type,id:this.snap.id,type:this.snap.type,magnet:this.snap.magnet});else if(i.type==="end")l[1]=[o.x,o.y],this.snap&&(a.end={side:i.type,id:this.snap.id,type:this.snap.type,magnet:this.snap.magnet});else if(i.type==="body"){const u=o.x-i.point.x,h=o.y-i.point.y,g=r.geometry.coordinates[0],f=r.geometry.coordinates[1];l[0]=[g[0]+u,g[1]+h],l[1]=[f[0]+u,f[1]+h]}this.store.getState().applyLiveUpdate(r.id,{id:r.id,properties:{...r.properties,link:a},geometry:{type:r.geometry.type,coordinates:l}}),this.dispatchEvent(new CustomEvent(cp,{detail:{point:o,annotation:this.annotation,handle:i}}))}onDragStart(e){if(!super.onDragStart(e))return!1;const s=this.getAnnotation(),n=this.hoveredHandle;return n.type==="body"&&lk(s)||n.type==="end"&&!1||n.type==="start"&&!GW(s)?(this.clearDragState(),!1):(this.store.getState().startLiveUpdate([this.annotation]),!0)}onDragEnd(e){if(!super.onDragEnd(e))return!1;if(this.snap&&this.hoveredHandle){const s=this.hoveredHandle;s.type!=="body"&&this.links.add(this.getAnnotation(),s.type,this.snap.id,this.snap.type,this.snap.magnet)}else if(this.snap===null&&this.hoveredHandle){const s=this.getAnnotation(),n=this.hoveredHandle.type;if(s.properties.link&&s.properties.link[n]){this.links.remove(s,n);const i={...s.properties.link};delete i[n],this.store.getState().applyLiveUpdate(s.id,{properties:{...s.properties,link:i}})}}return this.store.getState().drawingFeature===this.annotation&&this.store.setState({drawingFeature:null}),this.commitChange(),this.clearDragState(),this.snap=null,!0}snapDrawingStart(e,s,n){const i=this.snapping.snap({x:s,y:n});if(i){const r={geometry:{...e.geometry,coordinates:[[i.point.x,i.point.y],e.geometry.coordinates[1]]},properties:{...e.properties,link:{start:{side:Hi,id:i.id,type:i.type,magnet:i.magnet}}}},o=this.store.getState();o.applyLiveUpdate(e.id,r),o.updateFeature(e.id,r),this.links.add(e,"start",i.id,i.type,i.magnet)}}startDrawing(e,s,n){this.annotation=e;const i=this.getAnnotation();this.snapDrawingStart(i,s,n),this.grabHandle("end",s,n),this.dragging=!0,this.dragStartPoint={x:s,y:n};const r=this.ogma.view.graphToScreenCoordinates({x:s,y:n});this.onDragStart({clientX:r.x,clientY:r.y})}link(e,s,n){let i=Kg(e,n);const r=e.properties.link||{};let o=null;if(s instanceof xi)i=s.getPosition(),o=this.snapping.snapToNodes(i,s.toList());else{const a=this.store.getState().getFeature(s);if(!a)throw new Error(`Annotation with id ${s} not found`);if(Xs(a)||qn(a))i=yi(a),o=this.snapping.snapToText(i,[a]);else if(kr(a))i=JM(a),o=this.snapping.snapToPolygon(i,[a]);else throw new Error(`Cannot link arrow to annotation of type ${a.properties.type}`)}o&&(r[n]={side:n,id:o.id,type:o.type,magnet:o.magnet},this.links.add(e,n,o.id,o.type,o.magnet),EW(e,n,i.x,i.y),this.store.getState().updateFeature(e.id,{properties:{...e.properties,link:r},geometry:{type:e.geometry.type,coordinates:e.geometry.coordinates}}))}}class jW extends fp{constructor(e,s,n){super(e,s),Wt(this,"links"),Wt(this,"isDrawingMode",!1),Wt(this,"simplificationTolerance",5),Wt(this,"handleMouseDown",i=>{!this.isActive()||this.dragging||!this.hoveredHandle||(i.preventDefault(),i.stopPropagation(),this.dragStartPoint=this.clientToCanvas(i),this.onDragStart(i),this.dispatchEvent(new Event(gh)),this.disablePanning())}),this.links=n}startDrawing(e,s,n){this.annotation=e,this.isDrawingMode=!0;const i=this.store.getState();i.startLiveUpdate([e]),i.setDrawingPoints([]);const r=this.ogma.view.graphToScreenCoordinates({x:s,y:n});return this.dragStartPoint=r,this.disablePanning(),this.onDragStart({clientX:r.x,clientY:r.y}),this}cancelDrawing(){this.isDrawingMode&&(this.isDrawingMode=!1,this.annotation&&(this.store.getState().removeFeature(this.annotation),this.annotation=null)),this.restorePanning()}detectHandle(e,s=1){const n=this.getAnnotation();if(!n)return;const i=this.clientToCanvas(e),r=XM/s,o=n.geometry.coordinates[0];for(let a=0;a<o.length-1;a++){const[l,u]=o[a];if(Math.sqrt(Math.pow(i.x-l,2)+Math.pow(i.y-u,2))<r*2){this.grabHandle("vertex",l,u,a);return}}ak(n,i,r)?(this.setCursor(on.grab),this.hoveredHandle={type:"body",point:i},this.store.setState({hoveredHandle:-1})):(this.store.setState({hoveredHandle:-1}),this.hoveredHandle=void 0)}grabHandle(e,s,n,i){this.setCursor(e==="vertex"?on.pointer:on.grab),this.hoveredHandle={type:e,point:{x:s,y:n},vertexIndex:i},this.store.setState({hoveredHandle:i??0})}onDragStart(e){if(this.isDrawingMode){const s=this.clientToCanvas(e);this.dragging=!0;const n=this.getAnnotation();if(n){const i=[[s.x,s.y],[s.x,s.y]],r=this.store.getState();r.setDrawingPoints(i),r.applyLiveUpdate(n.id,{...n,geometry:{type:"Polygon",coordinates:[i],bbox:[s.x,s.y,s.x,s.y]}})}return this.dragStartPoint=s,!0}return this.hoveredHandle?(this.dragging=!0,this.setCursor(on.grabbing),this.store.getState().startLiveUpdate([this.annotation]),!0):!1}onDrag(e){if(this.isDrawingMode&&this.dragging){const o=this.clientToCanvas(e),a=this.store.getState(),l=this.getAnnotation();if(!l)return;const u=a.liveUpdates[this.annotation],h=u?{...l,...u}:l,g=a.drawingPoints.slice(0,-1),f=[...g,[o.x,o.y],g[0]];a.setDrawingPoints(f);const p=_w(f,this.simplificationTolerance,!1),y=[...p,p[0]];a.applyLiveUpdate(this.annotation,{...h,geometry:{type:"Polygon",coordinates:[y]}});return}if(!this.dragging||!this.dragStartPoint||!this.hoveredHandle)return;const s=this.clientToCanvas(e),n=s.x-this.dragStartPoint.x,i=s.y-this.dragStartPoint.y,r=this.getAnnotation();if(r){if(this.hoveredHandle.type==="body"){const o=_W(r,n,i);this.store.getState().applyLiveUpdate(r.id,o),this.links.updateLinkedArrowsDuringDrag(r.id,{x:n,y:i})}else if(this.hoveredHandle.type==="vertex"&&this.hoveredHandle.vertexIndex!==void 0){const o=r.geometry.coordinates[0].map((l,u)=>u===this.hoveredHandle.vertexIndex?[this.hoveredHandle.point.x+n,this.hoveredHandle.point.y+i]:u===r.geometry.coordinates[0].length-1&&this.hoveredHandle.vertexIndex===0?[this.hoveredHandle.point.x+n,this.hoveredHandle.point.y+i]:l),a={...r,geometry:{...r.geometry,coordinates:[o]}};yW(a),this.store.getState().applyLiveUpdate(r.id,a)}this.dispatchEvent(new Event(cp))}}onDragEnd(){if(this.isDrawingMode&&this.dragging){const e=this.store.getState(),s=this.getAnnotation();if(s){const n=e.drawingPoints;if(n.length<3)this.cancelDrawing();else{const i=_w(n.slice(1,-1),this.simplificationTolerance,!0),r={...s,geometry:{type:"Polygon",coordinates:[i]}};ph(r),this.store.getState().applyLiveUpdate(s.id,r),this.store.setState({drawingFeature:null}),this.commitChange(),this.isDrawingMode=!1,this.dragging=!1,this.restorePanning(),this.dispatchEvent(new CustomEvent(Ff,{detail:r}))}}return!0}return!this.dragging||(this.dragging=!1,this.dragStartPoint=void 0,!this.getAnnotation())?!1:(this.commitChange(),this.setCursor(on.grab),!0)}getAnnotation(){if(this.annotation)return this.store.getState().getFeature(this.annotation)}}function HW(t,e){let s=!1;for(let n=0,i=e.length-1;n<e.length;i=n++){const r=e[n][0],o=e[n][1],a=e[i][0],l=e[i][1];o>t.y!=l>t.y&&t.x<(a-r)*(t.y-o)/(l-o)+r&&(s=!s)}return s}function $W(t,e,s,n,i){const r=t*t,o=r*t,a=1-t,l=a*a,u=l*a;return{x:u*e.x+3*l*t*s.x+3*a*r*n.x+o*i.x,y:u*e.y+3*l*t*s.y+3*a*r*n.y+o*i.y}}function qW(t,e,s,n,i){let r=1/0,o=null;const a=20;for(let l=0;l<=a;l++){const u=l/a,h=$W(u,e,s,n,i),g=Mi(En(h,t));g<r&&(r=g,o=h)}return o?{point:o,distance:r}:null}function YW(t,e,s){const n=e.geometry.coordinates[0];for(let i=0;i<n.length-1;i++){const[r,o]=n[i];if(Mi(En({x:r,y:o},t))<s)return{point:{x:r,y:o},magnet:{x:r,y:o},type:Cs.POLYGON,id:e.id}}for(let i=0;i<n.length-1;i++){const[r,o]=n[i],[a,l]=n[i+1],u={x:r,y:o},h=En({x:a,y:l},u),g=Mi(h),f={x:h.x/g,y:h.y/g},p={x:-f.y,y:f.x},y=En(t,u),_=Math.abs(vu(p,y)),x=vu(f,y);if(x>=0&&x<=g&&_<s){const v={x:u.x+f.x*x,y:u.y+f.y*x};return{point:v,magnet:v,type:Cs.POLYGON,id:e.id}}}return null}function WW(t,e,s){for(const n of e){const i=n.geometry.coordinates[0].slice(0,-1);if(i.length<3)return YW(t,n,s);for(let l=0;l<i.length;l++){const[u,h]=i[l];if(Mi(En({x:u,y:h},t))<s)return{point:{x:u,y:h},magnet:{x:u,y:h},type:Cs.POLYGON,id:n.id}}const r=HW(t,i);let o=null,a=r?1/0:s;for(let l=0;l<i.length;l++){const u=i[(l-1+i.length)%i.length],h=i[l],g=i[(l+1)%i.length],f=i[(l+2)%i.length],p=h[0]+(g[0]-u[0])/6*.5,y=h[1]+(g[1]-u[1])/6*.5,_=g[0]-(f[0]-h[0])/6*.5,x=g[1]-(f[1]-h[1])/6*.5,v=qW(t,{x:h[0],y:h[1]},{x:p,y},{x:_,y:x},{x:g[0],y:g[1]});if(v){const b=v.distance;if(r)b<a&&(a=b,o=v.point);else if(b<s)return{point:v.point,magnet:v.point,type:Cs.POLYGON,id:n.id}}}if(r&&o)return{point:o,magnet:o,type:Cs.POLYGON,id:n.id}}return null}const uk=[{x:-.5,y:-.5},{x:0,y:-.5},{x:.5,y:-.5},{x:-.5,y:0},{x:.5,y:0},{x:-.5,y:.5},{x:0,y:.5},{x:.5,y:.5},{x:0,y:0}],XW=[[-.5,-.5,.5,-.5],[.5,-.5,.5,.5],[.5,.5,-.5,.5],[-.5,.5,-.5,-.5]];function Aw(t,e,s,n,i,r,o,a,l){const u=t*i,h=e*r;return l?{x:s+(u*o-h*a),y:n+(u*a+h*o)}:{x:s+u,y:n+h}}function ZW(t,e,s,n,i){var r;const o=yi(e);let{width:a,height:l}=$n(e);const{sin:u,cos:h}=i.getState();(r=e.properties.style)!=null&&r.fixedSize&&(a/=s,l/=s);for(const g of uk){let f=g.x*a,p=g.y*l;if(!qn(e)){const _=f*h-p*u,x=f*u+p*h;f=_,p=x}const y={x:o.x+f,y:o.y+p};if(!(Mi(En(y,t))>=n))return{point:{x:y.x,y:y.y},type:Cs.TEXT,magnet:g,id:e.id}}return null}function KW(t,e,s,n,i){var r;const{x:o,y:a}=yi(e);let{width:l,height:u}=$n(e);(r=e.properties.style)!=null&&r.fixedSize&&(l/=s,u/=s);const{sin:h,cos:g}=i.getState(),f=!qn(e);let p=null,y=1/0;for(let _=0;_<4;_++){const[x,v,b,S]=XW[_],A=Aw(x,v,o,a,l,u,g,h,f),w=Aw(b,S,o,a,l,u,g,h,f),L=En(w,A),M=Mi(L),F={x:L.x/M,y:L.y/M},O={x:-F.y,y:F.x},G=En(t,A),j=vu(O,G),Z=vu(F,G);if(Z>=0&&Z<=M){const at=Math.abs(j);if(at<n||at<y){const pt=Z/M,K={point:{x:A.x+F.x*Z,y:A.y+F.y*Z},magnet:{x:x+(b-x)*pt,y:v+(S-v)*pt},type:Cs.TEXT,id:e.id};if(at<n)return K;at<y&&(y=at,p=K)}}}return p&&y<Math.max(l,u)?p:null}function QW(t,e,s,n,i){for(const r of e){const o=ZW(t,r,s,n,i)||KW(t,r,s,n,i);if(o)return o}return null}function JW(t,e,s){const n=e.getAttributes(["x","y","radius"]);for(let i=0;i<n.length;i++){const r=n[i],o=En({x:r.x,y:r.y},t),a=Mi(o);if(a>=Number(r.radius)+Number(s))continue;const l=eo(o,1/a),u=a<Number(r.radius)/2,h=u?{x:r.x,y:r.y}:$a({x:r.x,y:r.y},eo(l,-Number(r.radius))),g=u?{x:0,y:0}:l;return{point:h,id:e.get(i).getId(),magnet:g,type:Cs.NODE}}return null}function tX(t,e,s,n,i=20){let r=0,o=1/0,a=null;for(let l=0;l<=i;l++){const u=l/i,h=mu.getPointOnQuadraticCurve(u,e.x,e.y,s.x,s.y,n.x,n.y),g=Mi(En(h,t));g<o&&(o=g,a=h,r=u)}return a?{t:r,point:a,distance:o}:null}function eX(t,e,s){const n=s.x-e.x,i=s.y-e.y,r=n*n+i*i;if(r===0)return{t:0,point:{x:e.x,y:e.y},distance:Mi(En(e,t))};const o=Math.max(0,Math.min(1,((t.x-e.x)*n+(t.y-e.y)*i)/r)),a={x:e.x+o*n,y:e.y+o*i};return{t:o,point:a,distance:Mi(En(a,t))}}function sX(t,e,s){let n=null,i=s;const r=e.getAttribute("curvature"),o=e.getExtremities().getPosition();for(let a=0;a<e.size;a++){const l=e.get(a),u=r[a],h=o[2*a],g=o[2*a+1];let f;if(u===0||u===void 0)f=eX(t,h,g);else{const p=mu.getQuadraticCurveControlPoint(h.x,h.y,g.x,g.y,u);f=tX(t,h,g,p)}f&&f.distance<i&&(i=f.distance,n={point:f.point,id:l.getId(),magnet:{x:f.t,y:0},type:Cs.EDGE})}return n}class nX extends EventTarget{constructor(e,s,n,i){super(),Wt(this,"ogma"),Wt(this,"options"),Wt(this,"spatialIndex"),Wt(this,"hoveredNode",null),Wt(this,"store"),this.ogma=e,this.options=s,this.spatialIndex=n,this.store=i}snap(e){return this.findMagnet(e)||null}findMagnet(e){const s=this.options.detectMargin,n={minX:e.x-s,minY:e.y-s,maxX:e.x+s,maxY:e.y+s},i=this.spatialIndex.search(n),r=i.filter(p=>Xs(p)||qn(p)),o=i.filter(p=>kr(p)),{nodes:a,edges:l}=this.ogma.view.getElementsInside(n.minX,n.minY,n.maxX,n.maxY),u=this.snapToNodes(e,a);if(u)return u;const h=this.snapToEdges(e,l);if(h)return h;const g=this.snapToText(e,r);return g||this.snapToPolygon(e,o)||null}snapToText(e,s){const{zoom:n}=this.store.getState();return QW(e,s,n,this.options.magnetRadius,this.store)}snapToPolygon(e,s){return WW(e,s,this.options.magnetRadius)}snapToNodes(e,s){return JW(e,s,this.options.detectMargin)}snapToEdges(e,s){return sX(e,s,this.options.magnetRadius)}getHoveredNode(){return this.hoveredNode}clearHoveredNode(){var e;(e=this.hoveredNode)==null||e.setSelected(!1),this.hoveredNode=null}getMagnets(){return uk}}class iX{constructor(e,s,n,i=()=>{}){Wt(this,"layer"),Wt(this,"textarea"),Wt(this,"sendButton",null),Wt(this,"isFocused"),Wt(this,"unsubscribe"),Wt(this,"onFocus",()=>{this.isFocused=!0}),Wt(this,"onBlur",()=>{this.getAnnotation()&&this.updateContent(),this.isFocused=!1}),Wt(this,"onKeyup",_=>{_.key==="Escape"&&this.textarea.blur(),_.stopPropagation()}),Wt(this,"onKeydown",_=>{_.stopPropagation()}),Wt(this,"onInput",()=>{this.updateContent(),this.updateStyle(),this.updatePosition(),this.layer.setSize(this.getSize()),this.updateSendButtonState()}),Wt(this,"onSendClick",_=>{_.preventDefault(),_.stopPropagation(),!(!this.sendButton||this.sendButton.disabled)&&(this.updateContent(),this.textarea.blur(),this.onSendHandler())}),Wt(this,"update",()=>{this.getAnnotation()&&(this.updateStyle(),this.updatePosition(),this.layer.setSize(this.getSize()))});var r,o,a;this.ogma=e,this.store=s,this.annotation=n,this.onSendHandler=i;const l=this.getPosition(),u=this.getSize(),h=this.getAnnotation(),g=this.store.getState(),f=((r=g.options)==null?void 0:r.showSendButton)??!0,p=((o=g.options)==null?void 0:o.sendButtonIcon)||"",y=((a=g.options)==null?void 0:a.textPlaceholder)||"Enter text";this.layer=this.ogma.layers.addOverlay({element:`<div class="ogma-annotation-text-editor">
          <textarea wrap="on" name="annotation-text--input" spellcheck="false" placeholder="${y}"></textarea>
          ${f?`<button class="ogma-send-button" type="button" title="Send">
            <span class="ogma-send-button-icon">${p}</span>
          </button>`:""}
        </div>`,position:l,size:u},G0.EDITOR),this.textarea=this.layer.element.querySelector("textarea"),this.textarea.setAttribute("wrap","on"),this.textarea.setAttribute("spellcheck","false"),this.textarea.value=h.properties.content||"",f&&(this.sendButton=this.layer.element.querySelector(".ogma-send-button"),this.sendButton.addEventListener("click",this.onSendClick),this.updateSendButtonState()),this.isFocused=!1,this.textarea.addEventListener("focus",this.onFocus),this.textarea.addEventListener("blur",this.onBlur),this.textarea.addEventListener("input",this.onInput),this.textarea.addEventListener("keyup",this.onKeyup),this.textarea.addEventListener("keydown",this.onKeydown),this.updateStyle(),this.updatePosition(),this.textarea.focus(),this.unsubscribe=this.store.subscribe(_=>({rotation:_.rotation,zoom:_.zoom,annotation:_.features[this.annotation]}),this.update,{equalityFn:(_,x)=>_.rotation===x.rotation&&_.zoom===x.zoom&&_.annotation===x.annotation})}getAnnotation(){const e=this.store.getState();return e.liveUpdates[this.annotation]?e.liveUpdates[this.annotation]:(e.startLiveUpdate([this.annotation]),this.store.getState().getFeature(this.annotation))}getPosition(){var e;const s=this.getAnnotation();if(!s)return{x:0,y:0};const n=ru(s,(e=s.properties.style)==null?void 0:e.fixedSize,this.store.getState().zoom),i=R_(s);return{x:n.x+i,y:n.y+i}}getSize(){var e;const s=this.getAnnotation(),n=$n(s),i=R_(s),r=((e=s.properties.style)==null?void 0:e.fixedSize)||!1,o=this.store.getState().zoom,a=r?1/o:1;return{width:(n.width-i*2)*a,height:(n.height-i*2)*a}}updateStyle(){const e=this.getAnnotation();if(!e)return;const{font:s,fontSize:n=rn.fontSize,borderRadius:i,color:r,background:o,padding:a=0,fixedSize:l=rn.fixedSize}=e.properties.style||rn,u=this.textarea,h=this.store.getState().zoom,g=l?1/h:1,f=parseFloat(n.toString())*g,p=a*g,y=u.style;if(y.font=`${f} ${s}`,y.fontFamily=s||"sans-serif",y.fontSize=`${f}px`,y.padding=`${p}px`,y.lineHeight=`${f*KM}px`,y.boxSizing="border-box",y.color=r||"black",y.background=o||"transparent",y.borderRadius=`${i}px`,l&&(y.overflow="hidden",y.resize="none"),y.transformOrigin="center",y.transform=`rotate(${this.store.getState().rotation}rad)`,this.sendButton){const _=l?1/h:1;this.sendButton.style.transform=`scale(${_})`,this.sendButton.style.transformOrigin="bottom right"}}updatePosition(){this.layer.setPosition(this.getPosition())}updateContent(){var e,s;const n=this.getAnnotation();let i=n.properties.height,r=n.geometry.coordinates;const o=(e=n.properties.style)==null?void 0:e.fixedSize;if(o){const l=this.textarea.scrollHeight,u=R_(n),h=this.store.getState().zoom,g=(l+u*2/h)*h,f=((s=n.properties.style)==null?void 0:s.minHeight)||50;i=Math.max(f,g);const p=i-n.properties.height;if(Math.abs(p)>1){const[y,_]=n.geometry.coordinates;r=[y,_+p]}}const a={...n,properties:{...n.properties,content:this.textarea.value,height:i},geometry:{...n.geometry,coordinates:r}};o&&Math.abs(n.properties.height-i)>1&&(this.layer.setSize(this.getSize()),this.layer.setPosition(this.getPosition())),this.store.getState().applyLiveUpdate(this.annotation,a)}updateSendButtonState(){if(!this.sendButton)return;const e=this.textarea.value.trim().length===0;this.sendButton.disabled=e}destroy(){this.store.getState().commitLiveUpdates(new Set([this.annotation])),this.unsubscribe(),this.sendButton&&this.sendButton.removeEventListener("click",this.onSendClick),this.layer.destroy()}}function R_(t){var e;return((e=t.properties.style)==null?void 0:e.strokeWidth)||0}const ww={x:1,y:0},Tw={x:0,y:1},rX=[["top",Tw,-.5,-.5,.5,-.5],["right",ww,.5,-.5,.5,.5],["bottom",Tw,-.5,.5,.5,.5],["left",ww,-.5,-.5,-.5,.5]],oX={top:[0,1],right:[1,2],bottom:[2,3],left:[3,0]},Cw=[[-.5,-.5],[.5,-.5],[.5,.5],[-.5,.5]],aX=[on.nwResize,on.neResize,on.seResize,on.swResize];class F_ extends fp{constructor(e,s,n){super(e,s),Wt(this,"links"),Wt(this,"textEditor",null),Wt(this,"stopEditingText",()=>{this.textEditor&&(this.store.getState().drawingFeature===this.annotation&&this.store.setState({drawingFeature:null}),this.textEditor.destroy()),this.textEditor=null}),this.links=n}detectHandle(e,s){var n;const i=this.getAnnotation(),{x:r,y:o}=this.clientToCanvas(e);let{width:a,height:l}=$n(i);const u=5/s,h=yi(i),g=this.store.getState();let{revSin:f,revCos:p}=g;(qn(i)||bn(i))&&(f=0,p=1),this.hoveredHandle=void 0;const y=hW*(1/s),_=r-h.x,x=o-h.y,v=_*p-x*f,b=_*f+x*p,S=((n=i.properties.style)==null?void 0:n.fixedSize)===!0||bn(i);if(S&&(a/=s,l/=s),!S){for(let A=0;A<Cw.length;A++){const[w,L]=Cw[A],M=a*w,F=l*L;if(v>=M-y-u&&v<=M+y+u&&b>=F-y-u&&b<=F+y+u){this.hoveredHandle={type:"corner",corner:A},this.store.setState({hoveredHandle:A}),this.setCursor(this.getCornerCursor(A));return}}for(const[A,w,L,M,F,O]of rX){const G=a*L,j=l*M,Z=a*F,at=l*O,pt=vu(w,{x:v-G,y:b-j});if(Math.abs(pt)<u&&v>=G-u&&v<=Z+u&&b>=j-u&&b<=at+u){this.hoveredHandle={type:"edge",edge:A,corner:-1},this.store.setState({hoveredHandle:oX[A][0]+4}),this.setCursor(this.getEdgeCursor(A));return}}}if(v>=-a/2-u&&v<=a/2+u&&b>=-l/2-u&&b<=l/2+u){this.store.setState({hoveredHandle:8}),this.hoveredHandle={type:"body",corner:-1},this.setCursor(on.grab);return}this.store.setState({hoveredHandle:-1}),this.setCursor(on.default)}onDrag(e){if(!this.dragStartPoint||!this.hoveredHandle||!this.isActive())return;e.stopPropagation(),e.stopImmediatePropagation();const s=this.getAnnotation(),n=this.clientToCanvas(e),i={x:n.x-this.dragStartPoint.x,y:n.y-this.dragStartPoint.y},r=this.hoveredHandle,o=this.getAnnotation();let a=null;if(r.type==="corner"?a=this.dragCorner(o,i,r.corner):r.type==="edge"&&r.edge?a=this.dragEdge(o,i,r):r.type==="body"&&(a=this.dragBody(o,i)),a){const l=a;this.store.getState().applyLiveUpdate(s.id,l);const u=En(yi(l),yi(o));this.links.updateLinkedArrowsDuringDrag(s.id,u),this.textEditor&&this.textEditor.update()}this.dispatchEvent(new CustomEvent(cp,{detail:{point:n,annotation:this.annotation,handle:r}}))}dragBody(e,s){const n=yi(e);return{...e,geometry:{type:e.geometry.type,coordinates:[n.x+s.x,n.y+s.y]}}}dragCorner(e,s,n){const i=n===0||n===1,r=n===0||n===3,o=n===1||n===2,a=n===2||n===3,{width:l,height:u}=$n(e),h=this.store.getState();let{revSin:g,revCos:f}=h;(qn(e)||bn(e))&&(g=0,f=1);const p=s.x*f-s.y*g,y=s.x*g+s.y*f;let _=0,x=0;r?_=-p:o&&(_=p),i?x=-y:a&&(x=y);const v=Math.max(0,l+_),b=Math.max(0,u+x),S=yi(e),A=S.x+s.x/2,w=S.y+s.y/2;return{...e,properties:{...e.properties,width:v,height:b},geometry:{type:e.geometry.type,coordinates:[A,w]}}}dragEdge(e,s,n){const{width:i,height:r}=$n(e),o=yi(e),a=this.store.getState();let{revSin:l,revCos:u}=a;(qn(e)||bn(e))&&(l=0,u=1);const h=s.x*u-s.y*l,g=s.x*l+s.y*u;let f=i,p=r,y=0,_=0;switch(n.edge){case"top":p=Math.max(0,r-g),_=g/2;break;case"bottom":p=Math.max(0,r+g),_=g/2;break;case"left":f=Math.max(0,i-h),y=h/2;break;case"right":f=Math.max(0,i+h),y=h/2;break}const x=y*u+_*l,v=-y*l+_*u;return{...e,properties:{...e.properties,width:f,height:p},geometry:{type:e.geometry.type,coordinates:[o.x+x,o.y+v]}}}onDragStart(e){return super.onDragStart(e)?(this.stopEditingText(),this.store.getState().startLiveUpdate([this.annotation]),!0):!1}onClick(e){const s=this.getAnnotation();s&&(Xs(s)||bn(s))&&this.startEditingText()}startEditingText(){this.textEditor===null&&(this.textEditor=new iX(this.ogma,this.store,this.annotation,this.stopEditingText))}onDragEnd(e){var s,n;if(!super.onDragEnd(e))return!1;this.store.getState().drawingFeature===this.annotation&&this.store.setState({drawingFeature:null});const i=this.clientToCanvas(e),r=i.x-(((s=this.dragStartPoint)==null?void 0:s.x)||0),o=i.y-(((n=this.dragStartPoint)==null?void 0:n.y)||0);return Math.abs(r)<1&&Math.abs(o)<1?(this.clearDragState(),this.onClick({clientX:e.clientX,clientY:e.clientY})):this.commitChange(),this.hoveredHandle=void 0,this.dragStartPoint=void 0,this.dragging=!1,!0}getCornerCursor(e){return aX[e]}getEdgeCursor(e){switch(e){case"top":case"bottom":return on.nsResize;case"left":case"right":return on.ewResize;default:return on.default}}stopEditing(){super.stopEditing(),this.commitChange(),this.stopEditingText()}startDrawing(e,s,n){this.annotation=e,this.hoveredHandle={type:"corner",corner:2},this.store.setState({hoveredHandle:2}),this.dragging=!0;const i=this.ogma.view.graphToScreenCoordinates({x:s,y:n});this.dragStartPoint=i,this.disablePanning(),this.onDragStart({clientX:i.x,clientY:i.y})}setAnnotation(e){super.setAnnotation(e),e&&bn(e)&&e.properties.mode===fh&&this.store.getState().updateFeature(e.id,{properties:{...e.properties,mode:ZM}})}}class lX extends EventTarget{constructor(e,s,n,i,r){super(),Wt(this,"handlers",new Map),Wt(this,"activeHandler"),Wt(this,"interaction"),Wt(this,"ogma"),Wt(this,"snapping"),Wt(this,"store"),this.ogma=e,this.store=s,this.interaction=r,this.snapping=new nX(e,{detectMargin:10,magnetRadius:10},n,s),this.handlers.set("box",new F_(this.ogma,this.store,i)),this.handlers.set("text",new F_(this.ogma,this.store,i)),this.handlers.set("comment",new F_(this.ogma,this.store,i)),this.handlers.set("arrow",new VW(this.ogma,this.store,this.snapping,i)),this.handlers.set("polygon",new jW(this.ogma,this.store,i)),this.handlers.forEach(o=>{o.addEventListener("dragstart",()=>{this.dispatchEvent(new Event("dragstart")),this.store.setState({isDragging:!0}),this.interaction.setMode("edit")}),o.addEventListener("dragend",()=>{this.dispatchEvent(new Event("dragend")),this.store.setState({isDragging:!1}),this.interaction.suppressClicksTemporarily()})}),this.store.subscribe(o=>o.selectedFeatures,(o,a)=>{const l=Array.from(o.keys()).filter(h=>!a.has(h)),u=Array.from(a.keys()).filter(h=>!o.has(h));!l.length&&!u.length||(u.forEach(h=>this.stopEditingFeature(h)),l.forEach(h=>this.editFeature(h)))})}stopEditingFeature(e){const s=this.store.getState().features[e];if(!s)return;const n=s.properties.type,i=this.handlers.get(n);i&&i.stopEditing()}editFeature(e){var s;const n=this.store.getState().features[e];n&&(this.setActiveHandler(n.properties.type),(s=this.activeHandler)==null||s.setAnnotation(n))}getSnapping(){return this.snapping}getArrowHandler(){return this.handlers.get("arrow")}getActiveHandler(){return this.activeHandler}setActiveHandler(e){const s=this.handlers.get(e);if(!s)throw new Error(`Handler for type ${e} not found`);return this.activeHandler=s,this}destroy(){}}const uX=["x","y","radius"],dX=1;class hX{constructor(e,s,n){Wt(this,"links",new Map),Wt(this,"nodeToLink",new Map),Wt(this,"edgeToLink",new Map),Wt(this,"annotationToLink",new Map),Wt(this,"linksByArrowId",new Map),Wt(this,"store"),Wt(this,"ogma"),Wt(this,"updatedItems",new Set),Wt(this,"onLinkCreated"),Wt(this,"commitTimeout"),Wt(this,"onSetMultipleAttributes",({elements:i,updatedAttributes:r})=>{const o=new Set(r);!i.isNode||!o.has("x")&&!o.has("y")&&!o.has("radius")||this.requestUpdateFromNodePositions(i.toList())}),Wt(this,"refresh",()=>{const i=this.store.getState(),r=new Map;this.annotationToLink.forEach((o,a)=>{var l;const u=i.getFeature(a);u&&(Xs(u)&&((l=u.properties.style)!=null&&l.fixedSize)||bn(u))&&o.forEach(h=>{const g=this.links.get(h);if(!g)return;const f=g.arrow;r.set(f,this.linksByArrowId.get(f))})}),r.size>0&&this.update(r)}),Wt(this,"throttledRefresh",ik(()=>this.refresh(),20)),Wt(this,"onAddRemoveEdges",i=>{const r=i.edges;if(!r.size||!this.edgeToLink.size)return;const o=new Map,a=new Map;r.getParallelEdges().getId().forEach(l=>{const u=this.edgeToLink.get(l);u&&u.forEach(h=>{const g=this.links.get(h);if(!g)return;const f=g.arrow;o.set(f,this.linksByArrowId.get(f)),a.set(f,this.linksByArrowId.get(f))})}),a.size!==0&&this.update(a)}),Wt(this,"commit",()=>{this.store.getState().batchUpdate(this.commitLiveUpdates),this.updatedItems.clear()}),Wt(this,"commitLiveUpdates",()=>{this.store.getState().commitLiveUpdates(this.updatedItems)}),Wt(this,"onAddArrow",(i,r)=>{const o=this.store.getState(),a=new Set(Object.keys(r)),l=Object.keys(i).filter(h=>!a.has(h)),u=Object.keys(r).filter(h=>!i[h]);l.forEach(h=>{var g,f;const p=o.getFeature(h);if(!p||!vi(p))return;const y=p;if((g=y.properties.link)!=null&&g.start){const _=y.properties.link.start;this.add(y,Hi,_.id,_.type,_.magnet)}if((f=y.properties.link)!=null&&f.end){const _=y.properties.link.end;this.add(y,Fa,_.id,_.type,_.magnet)}}),u.forEach(h=>{const g=r[h];if(vi(g)){const f=g;this.remove(f,Hi),this.remove(f,Fa)}else{const f=this.annotationToLink.get(h);if(f)for(const p of f){const y=this.links.get(p);if(!y)continue;const _=o.getFeature(y.arrow);_&&this.remove(_,y.side),this.linksByArrowId.delete(y.arrow),this.links.delete(p)}}})}),this.ogma=e,this.store=s,this.onLinkCreated=n,this.store.subscribe(i=>i.features,this.onAddArrow),this.store.subscribe(i=>({zoom:i.zoom,rotation:i.rotation}),this.throttledRefresh,{equalityFn:(i,r)=>i.zoom===r.zoom&&i.rotation===r.rotation}),this.ogma.events.on("setMultipleAttributes",this.onSetMultipleAttributes).on(["addEdges","removeEdges"],this.onAddRemoveEdges).on("viewChanged",this.refresh)}updateLinkedArrowsDuringDrag(e,s){const n=this.store.getState();if(!n.getFeature(e))return;const i=this.annotationToLink.get(e);if(i)for(const r of i){const o=this.links.get(r);if(!o)continue;const a=n.getFeature(o.arrow),l=Kg(a,o.side),u=$a(l,s),h={...a.geometry,coordinates:a.geometry.coordinates.map((g,f)=>o.side===Hi&&f===0||o.side===Fa&&f===1?[u.x,u.y]:[...g])};n.applyLiveUpdate(a.id,{geometry:h}),this.updatedItems.add(a.id)}}add(e,s,n,i,r){const o=Qa(),a=e.id;let l=r;if(i===Cs.POLYGON){const g=this.store.getState().getFeature(n);if(g&&kr(g)){const f=yw(g),p=f[2]-f[0],y=f[3]-f[1],_=r.x-f[0],x=r.y-f[1],v=p>0?_/p:.5,b=y>0?x/y:.5;l={x:v,y:b}}}const u={id:o,arrow:a,target:n,targetType:i,magnet:l,side:s};if(i===Cs.NODE&&!this.ogma.getNode(n)||i===Cs.EDGE&&!this.ogma.getEdge(n))return;this.remove(e,s),this.links.set(o,u);const h=i===Cs.NODE?this.nodeToLink:i===Cs.EDGE?this.edgeToLink:this.annotationToLink;return h.has(n)||h.set(n,new Set),h.get(n).add(o),this.linksByArrowId.has(a)||this.linksByArrowId.set(a,{}),this.linksByArrowId.get(a)[s]=o,e.properties.link=e.properties.link||{},e.properties.link[s]={id:n,side:s,type:i,magnet:l},this.onLinkCreated&&this.onLinkCreated(e,u),this}remove(e,s){var n,i,r,o,a;const l=e.id,u=(n=this.linksByArrowId.get(l))==null?void 0:n[s];if((i=e.properties.link)==null||delete i[s],!u)return this;const h=this.links.get(u);return h?(this.links.delete(u),(r=this.nodeToLink.get(h.target))==null||r.delete(u),(o=this.edgeToLink.get(h.target))==null||o.delete(u),(a=this.annotationToLink.get(h.target))==null||a.delete(u),this.linksByArrowId.has(l)&&(this.linksByArrowId.get(l)[s]=void 0),this):this}requestUpdateFromNodePositions(e){setTimeout(()=>this.updateFromNodePositions(e),1)}updateFromNodePositions(e){const s=e.getId(),n=new Map;s.forEach(l=>{const u=this.nodeToLink.get(l);u&&u.forEach(h=>{const g=this.links.get(h);if(!g)return;const f=g.arrow;n.set(f,this.linksByArrowId.get(f))})});const i=new Map;e.getAdjacentEdges().getId().forEach(l=>{const u=this.edgeToLink.get(l);u&&u.forEach(h=>{const g=this.links.get(h);if(!g)return;const f=g.arrow;n.set(f,this.linksByArrowId.get(f)),i.set(f,this.linksByArrowId.get(f))})});const r=e.getAttributes(uX),o=this.store.getState(),a={};for(let l=0;l<s.length;l++){const u=s[l],h=this.nodeToLink.get(u);if(h)for(const g of h){const f=this.links.get(g);if(!f)continue;const p=f.arrow,y=this.store.getState().getFeature(p),_=y.geometry.coordinates.slice(),x=Kg(y,Fa),v=Kg(y,Hi),b=r[l],S=this._getNodeSnapPoint(b,eo(En(x,v),-1),this._isLinkedToCenter(f));_[f.side===Hi?0:1]=S,a[p]={...y,geometry:{coordinates:_}},this.updatedItems.add(p),f.magnet={x:S[0]-b.x,y:S[1]-b.y},ph(a[p])}}if(o.applyLiveUpdates(a),i.size>0){this.update(i);return}this.requestCommit()}update(e=this.linksByArrowId){const s=this.store.getState(),n=Array.from(this.nodeToLink.keys()),i=new Map;n.forEach((a,l)=>i.set(a,l));const r=this.ogma.getNodes(n).getAttributes(["x","y","radius"]),o={};e.forEach((a,l)=>{const u=this.links.get(a.start),h=this.links.get(a.end),g=s.getFeature(l);let f=g.geometry.coordinates[0],p=g.geometry.coordinates[1];const y=u?u.targetType===Cs.NODE?r[i.get(u.target)]:u.targetType===Cs.EDGE?this._getEdgeSnapPoint(u.target,u.magnet.x,!0):this._getAnnotationCenter(s.getFeature(u.target)):{x:f[0],y:f[1]},_=h?h.targetType===Cs.NODE?r[i.get(h.target)]:h.targetType===Cs.EDGE?this._getEdgeSnapPoint(h.target,h.magnet.x,!0):this._getAnnotationCenter(s.getFeature(h.target)):{x:p[0],y:p[1]},x=En(_,y);if(u)if(u.targetType===Cs.NODE)f=this._getNodeSnapPoint(y,x,this._isLinkedToCenter(u));else if(u.targetType===Cs.EDGE)f=this._getEdgeSnapPoint(u.target,u.magnet.x);else{const v=s.getFeature(u.target);f=this._getAnnotationSnapPoint(v,_,u,s.zoom)}if(h)if(h.targetType===Cs.NODE)p=this._getNodeSnapPoint(_,eo(x,-1),this._isLinkedToCenter(h));else if(h.targetType===Cs.EDGE)p=this._getEdgeSnapPoint(h.target,h.magnet.x);else{const v=s.getFeature(h.target);p=this._getAnnotationSnapPoint(v,y,h,s.zoom)}o[g.id]={properties:g.properties,geometry:{coordinates:[f,p]}},ph(o[g.id]),this.updatedItems.add(g.id)}),s.applyLiveUpdates(o),this.requestCommit()}requestCommit(){clearTimeout(this.commitTimeout),this.commitTimeout=setTimeout(this.commit,dX)}_isLinkedToCenter(e){return e.magnet.x===0&&e.magnet.y===0}_getAnnotationCenter(e){return kr(e)?JM(e):yi(e)}_getAnnotationSnapPoint(e,s,n,i){if(kr(e)){const r=yw(e),o=r[0]+n.magnet.x*(r[2]-r[0]),a=r[1]+n.magnet.y*(r[3]-r[1]);return[o,a]}return this._getBoxSnapPoint(e,s,n,i)}_getBoxSnapPoint(e,s,n,i){var r;const o=yi(e);let{width:a,height:l}=$n(e);(Xs(e)&&((r=e.properties.style)!=null&&r.fixedSize)||bn(e))&&(a/=i,l/=i);let u=n.magnet.x*a,h=n.magnet.y*l;if(Xs(e)&&!qn(e)){const{sin:g,cos:f}=this.store.getState(),p=u*f-h*g,y=u*g+h*f;u=p,h=y}else if(bn(e)){const g={...e.properties.style}.iconSize||32,f=g/16*.5;u=n.magnet.x*g*f,h=n.magnet.y*g*f}return[o.x+u,o.y+h]}_getNodeSnapPoint(e,s,n){if(n)return[e.x,e.y];const i=Math.sqrt(s.x*s.x+s.y*s.y),r=eo(s,1/i),o=i<Number(e.radius)/2?{x:e.x,y:e.y}:$a({x:e.x,y:e.y},eo(r,-Number(e.radius)));return[o.x,o.y]}_getEdgeSnapPoint(e,s,n=!1){const i=this.ogma.getEdge(e);if(!i)return[0,0];const r=i.getAttribute("curvature"),o=i.getExtremities().getPosition(),a=o[0],l=o[1];if(r===0||r===void 0){const g=[a.x+s*(l.x-a.x),a.y+s*(l.y-a.y)];return n?{x:g[0],y:g[1]}:g}const u=mu.getQuadraticCurveControlPoint(a.x,a.y,l.x,l.y,r),h=mu.getPointOnQuadraticCurve(s,a.x,a.y,l.x,l.y,u.x,u.y);return n?{x:h.x,y:h.y}:[h.x,h.y]}destroy(){this.ogma.events.off(this.onSetMultipleAttributes)}}function P_(t){return t instanceof HTMLCanvasElement||t instanceof HTMLTextAreaElement}class cX extends EventTarget{constructor(e,s,n){super(),Wt(this,"query",{minX:1/0,minY:1/0,maxX:1/0,maxY:1/0}),Wt(this,"suppressClickUntil",0),Wt(this,"mouseDownState",null),Wt(this,"DRAG_THRESHOLD",3),Wt(this,"onMouseMove",r=>{if(!P_(r.target))return;const o=Sx(r,this.ogma.getContainer()),a=this.store.getState();if(this.mouseDownState&&!a.isDragging){const p=r.clientX-this.mouseDownState.screenX,y=r.clientY-this.mouseDownState.screenY;Math.sqrt(p*p+y*y)>this.DRAG_THRESHOLD&&(this.mouseDownState.hasMoved=!0)}if(a.isDragging)return;const{x:l,y:u}=this.ogma.view.screenToGraphCoordinates(o),h=this.detect(l,u),g=(h==null?void 0:h.id)??null,f=a.hoveredFeature;g!==f&&a.setHoveredFeature(g),this.setCursor(g===null?on.default:on.pointer)}),Wt(this,"onMouseClick",()=>{Date.now()<this.suppressClickUntil}),Wt(this,"onMouseDown",r=>{if(!P_(r.target)||Date.now()<this.suppressClickUntil)return;const o=Sx(r,this.ogma.getContainer()),{x:a,y:l}=this.ogma.view.screenToGraphCoordinates(o),u=this.detect(a,l);this.mouseDownState={annotation:u,screenX:r.clientX,screenY:r.clientY,hasMoved:!1};const h=this.store.getState();this.store.setState({mousePressed:!0,mousePressPoint:{x:a,y:l}}),u&&!h.selectedFeatures.has(u.id)&&(r.ctrlKey||r.metaKey?h.toggleSelection(u.id):h.setSelectedFeatures([u.id]))}),Wt(this,"onMouseUp",r=>{if(!P_(r.target))return;const o=this.store.getState();if(this.store.setState({mousePressed:!1,mousePressPoint:null}),this.mouseDownState&&!this.mouseDownState.hasMoved&&!o.isDragging){const a=this.mouseDownState.annotation;a?r.ctrlKey||r.metaKey?o.toggleSelection(a.id):o.selectedFeatures.has(a.id)||o.setSelectedFeatures([a.id]):!r.ctrlKey&&!r.metaKey&&o.clearSelection(),this.dispatchEvent(new Event(vx))}this.mouseDownState=null}),this.ogma=e,this.store=s,this.index=n;const i=this.ogma.getContainer();i&&(i.addEventListener("mousemove",this.onMouseMove,{passive:!0,capture:!0}),i.addEventListener("click",this.onMouseClick,{passive:!0,capture:!0}),i.addEventListener("mousedown",this.onMouseDown,{passive:!0,capture:!1}),i.addEventListener("mouseup",this.onMouseUp,{passive:!0,capture:!0}))}detect(e,s,n){let i=null;const r=this.store.getState(),o=n??r.options.detectMargin;this.query.minX=e-o,this.query.minY=s-o,this.query.maxX=e+o,this.query.maxY=s+o;const a=this.index.query(this.query);if(a.length===0)return null;for(const l of a){const u=r.getFeature(l.id);if(vi(u)){if(rk(u,{x:e,y:s},o)){i=u;break}}else if(qn(u)){if(LW(u,{x:e,y:s},0,1,o)){i=u;break}}else if(kr(u)){if(ak(u,{x:e,y:s},o)){i=u;break}}else if(bn(u)){if(MW(u,{x:e,y:s},o,r.sin,r.cos,r.zoom)){i=u;break}}else if(Xs(u)&&ok(u,{x:e,y:s},o,r.revSin,r.revCos,r.zoom)){i=u;break}}return i}setCursor(e){var s;const n=(s=this.ogma.getContainer())==null?void 0:s.firstChild;n&&(n.style.cursor=e)}setMode(e){var s;e==="default"?this.setCursor(((s=this.ogma.getOptions().cursor)==null?void 0:s.default)||"default"):e==="add"||e==="link"?this.setCursor(on.crosshair):e==="rotate"&&this.setCursor(on.alias)}suppressClicksTemporarily(e=100){this.suppressClickUntil=Date.now()+e}destroy(){const e=this.ogma.getContainer();e&&(e.removeEventListener("mousemove",this.onMouseMove),e.removeEventListener("click",this.onMouseClick))}}function dk(t,e,s=0,n=t.length-1,i=gX){for(;n>s;){if(n-s>600){const l=n-s+1,u=e-s+1,h=Math.log(l),g=.5*Math.exp(2*h/3),f=.5*Math.sqrt(h*g*(l-g)/l)*(u-l/2<0?-1:1),p=Math.max(s,Math.floor(e-u*g/l+f)),y=Math.min(n,Math.floor(e+(l-u)*g/l+f));dk(t,e,p,y,i)}const r=t[e];let o=s,a=n;for(pd(t,s,e),i(t[n],r)>0&&pd(t,s,n);o<a;){for(pd(t,o,a),o++,a--;i(t[o],r)<0;)o++;for(;i(t[a],r)>0;)a--}i(t[s],r)===0?pd(t,s,a):(a++,pd(t,a,n)),a<=e&&(s=a+1),e<=a&&(n=a-1)}}function pd(t,e,s){const n=t[e];t[e]=t[s],t[s]=n}function gX(t,e){return t<e?-1:t>e?1:0}class fX{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let s=this.data;const n=[];if(!Pg(e,s))return n;const i=this.toBBox,r=[];for(;s;){for(let o=0;o<s.children.length;o++){const a=s.children[o],l=s.leaf?i(a):a;Pg(e,l)&&(s.leaf?n.push(a):D_(e,l)?this._all(a,n):r.push(a))}s=r.pop()}return n}collides(e){let s=this.data;if(!Pg(e,s))return!1;const n=[];for(;s;){for(let i=0;i<s.children.length;i++){const r=s.children[i],o=s.leaf?this.toBBox(r):r;if(Pg(e,o)){if(s.leaf||D_(e,o))return!0;n.push(r)}}s=n.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let n=0;n<e.length;n++)this.insert(e[n]);return this}let s=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=s;else if(this.data.height===s.height)this._splitRoot(this.data,s);else{if(this.data.height<s.height){const n=this.data;this.data=s,s=n}this._insert(s,this.data.height-s.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=jl([]),this}remove(e,s){if(!e)return this;let n=this.data;const i=this.toBBox(e),r=[],o=[];let a,l,u;for(;n||r.length;){if(n||(n=r.pop(),l=r[r.length-1],a=o.pop(),u=!0),n.leaf){const h=pX(e,n.children,s);if(h!==-1)return n.children.splice(h,1),r.push(n),this._condense(r),this}!u&&!n.leaf&&D_(n,i)?(r.push(n),o.push(a),a=0,l=n,n=n.children[0]):l?(a++,n=l.children[a],u=!1):n=null}return this}toBBox(e){return e}compareMinX(e,s){return e.minX-s.minX}compareMinY(e,s){return e.minY-s.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,s){const n=[];for(;e;)e.leaf?s.push(...e.children):n.push(...e.children),e=n.pop();return s}_build(e,s,n,i){const r=n-s+1;let o=this._maxEntries,a;if(r<=o)return a=jl(e.slice(s,n+1)),zl(a,this.toBBox),a;i||(i=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,i-1))),a=jl([]),a.leaf=!1,a.height=i;const l=Math.ceil(r/o),u=l*Math.ceil(Math.sqrt(o));Lw(e,s,n,u,this.compareMinX);for(let h=s;h<=n;h+=u){const g=Math.min(h+u-1,n);Lw(e,h,g,l,this.compareMinY);for(let f=h;f<=g;f+=l){const p=Math.min(f+l-1,g);a.children.push(this._build(e,f,p,i-1))}}return zl(a,this.toBBox),a}_chooseSubtree(e,s,n,i){for(;i.push(s),!(s.leaf||i.length-1===n);){let r=1/0,o=1/0,a;for(let l=0;l<s.children.length;l++){const u=s.children[l],h=z_(u),g=yX(e,u)-h;g<o?(o=g,r=h<r?h:r,a=u):g===o&&h<r&&(r=h,a=u)}s=a||s.children[0]}return s}_insert(e,s,n){const i=n?e:this.toBBox(e),r=[],o=this._chooseSubtree(i,this.data,s,r);for(o.children.push(e),Rd(o,i);s>=0&&r[s].children.length>this._maxEntries;)this._split(r,s),s--;this._adjustParentBBoxes(i,r,s)}_split(e,s){const n=e[s],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);const o=this._chooseSplitIndex(n,r,i),a=jl(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,zl(n,this.toBBox),zl(a,this.toBBox),s?e[s-1].children.push(a):this._splitRoot(n,a)}_splitRoot(e,s){this.data=jl([e,s]),this.data.height=e.height+1,this.data.leaf=!1,zl(this.data,this.toBBox)}_chooseSplitIndex(e,s,n){let i,r=1/0,o=1/0;for(let a=s;a<=n-s;a++){const l=Id(e,0,a,this.toBBox),u=Id(e,a,n,this.toBBox),h=xX(l,u),g=z_(l)+z_(u);h<r?(r=h,i=a,o=g<o?g:o):h===r&&g<o&&(o=g,i=a)}return i||n-s}_chooseSplitAxis(e,s,n){const i=e.leaf?this.compareMinX:mX,r=e.leaf?this.compareMinY:_X,o=this._allDistMargin(e,s,n,i),a=this._allDistMargin(e,s,n,r);o<a&&e.children.sort(i)}_allDistMargin(e,s,n,i){e.children.sort(i);const r=this.toBBox,o=Id(e,0,s,r),a=Id(e,n-s,n,r);let l=Fg(o)+Fg(a);for(let u=s;u<n-s;u++){const h=e.children[u];Rd(o,e.leaf?r(h):h),l+=Fg(o)}for(let u=n-s-1;u>=s;u--){const h=e.children[u];Rd(a,e.leaf?r(h):h),l+=Fg(a)}return l}_adjustParentBBoxes(e,s,n){for(let i=n;i>=0;i--)Rd(s[i],e)}_condense(e){for(let s=e.length-1,n;s>=0;s--)e[s].children.length===0?s>0?(n=e[s-1].children,n.splice(n.indexOf(e[s]),1)):this.clear():zl(e[s],this.toBBox)}}function pX(t,e,s){if(!s)return e.indexOf(t);for(let n=0;n<e.length;n++)if(s(t,e[n]))return n;return-1}function zl(t,e){Id(t,0,t.children.length,e,t)}function Id(t,e,s,n,i){i||(i=jl(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let r=e;r<s;r++){const o=t.children[r];Rd(i,t.leaf?n(o):o)}return i}function Rd(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function mX(t,e){return t.minX-e.minX}function _X(t,e){return t.minY-e.minY}function z_(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Fg(t){return t.maxX-t.minX+(t.maxY-t.minY)}function yX(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function xX(t,e){const s=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,i-s)*Math.max(0,r-n)}function D_(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Pg(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function jl(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Lw(t,e,s,n,i){const r=[e,s];for(;r.length;){if(s=r.pop(),e=r.pop(),s-e<=n)continue;const o=e+Math.ceil((s-e)/n/2)*n;dk(t,o,e,s,i),r.push(e,o,o,s)}}const md={minX:0,minY:0,maxX:0,maxY:0},Nw=(t,e)=>t.id===e.id;class vX extends fX{constructor(e){super(),Wt(this,"store"),Wt(this,"onRotationChange",()=>{const s=this.store.getState().getAllFeatures().filter(n=>Xs(n)||bn(n));for(const n of s)this.updateRotatedText(n)}),Wt(this,"onZoomChange",()=>{const s=this.store.getState().getAllFeatures().filter(n=>{var i;return(Xs(n)||bn(n))&&((i=n.properties.style)==null?void 0:i.fixedSize)});for(const n of s)this.updateRotatedText(n)}),this.store=e,this.store.subscribe(s=>s.features,s=>{this.clear(),Object.values(s).forEach(n=>{Xs(n)||bn(n)?this.updateRotatedText(n):this.insert(n)})}),this.store.subscribe(s=>({features:s.features,isDragging:s.isDragging,lastChangedFeatures:s.lastChangedFeatures,rotation:s.rotation}),(s,n)=>{n&&n.isDragging&&!s.isDragging&&s.lastChangedFeatures.length>0&&s.lastChangedFeatures.forEach(i=>{const r=s.features[i];r&&(ph(r),Xs(r)||bn(r)?this.updateRotatedText(r):(this.remove(r,Nw),this.insert(r)))})},{equalityFn:(s,n)=>s.isDragging===n.isDragging}),this.store.subscribe(s=>s.rotation,this.onRotationChange),this.store.subscribe(s=>s.zoom,this.onZoomChange)}updateRotatedText(e){var s;const n=this.store.getState();this.remove(e,Nw);const i=yi(e);let{width:r,height:o}=$n(e);if(((s=e.properties.style)==null?void 0:s.fixedSize)===!0){const h=n.invZoom;r*=h,o*=h}const a=r/2,l=o/2,u=n.getRotatedBBox(i.x-a,i.y-l,i.x+a,i.y+l);this.insert({...e,geometry:{...e.geometry,bbox:u.slice()}})}compareMinX(e,s){return Kr(e)[0]-Kr(s)[0]}compareMinY(e,s){return Kr(e)[1]-Kr(s)[1]}toBBox(e){const s=Kr(e);return md.minX=s[0],md.minY=s[1],md.maxX=s[2],md.maxY=s[3],md}query(e){return super.search(e)}}class hk{constructor(e,s){Wt(this,"layer"),this.ogma=e,this.store=s}destroy(){}}function bX(t,e,s,n,i,r){const o=Math.min(n/2,i/2),a=Math.min(r,o);t.beginPath(),t.moveTo(e+a,s),t.lineTo(e+n-a,s),t.quadraticCurveTo(e+n,s,e+n,s+a),t.lineTo(e+n,s+i-a),t.quadraticCurveTo(e+n,s+i,e+n-a,s+i),t.lineTo(e+a,s+i),t.quadraticCurveTo(e,s+i,e,s+i-a),t.lineTo(e,s+a),t.quadraticCurveTo(e,s,e+a,s),t.closePath()}const Mw=[[-.5,-.5],[.5,-.5],[.5,.5],[-.5,.5]];class EX extends hk{constructor(e,s){super(e,s),Wt(this,"handleFill","#fff"),Wt(this,"handleStroke","#1A70E5"),Wt(this,"handleStrokeWidth",1.5),Wt(this,"handleRadius",3),Wt(this,"handleMagnifier",1.5),Wt(this,"refresh",()=>{this.layer.refresh()}),Wt(this,"render",n=>{const i=this.store.getState(),r=1/i.zoom,{hoveredHandle:o,rotation:a,liveUpdates:l,features:u}=i,h=this.handleRadius*r;n.fillStyle=this.handleFill,n.lineWidth=this.handleStrokeWidth*r,n.strokeStyle=this.handleStroke,Object.values(u).forEach(g=>{if(!i.isSelected(g.id))return;const f=l[g.id]?{...g,...l[g.id]}:g;if(vi(f))this.renderArrowHandles(f,n,h,o);else if(qn(f)||Xs(f)){const p=Xs(f)?a:0;this.renderOutline(f,n,p,o,i.zoom),this.renderBoxHandles(f,n,h,o,p)}else kr(f)&&this.renderPolygonHandles(f,n,h,o,i.drawingFeature===f.id)})}),this.layer=e.layers.addCanvasLayer(this.render,void 0,G0.HANDLES),this.store.subscribe(n=>({selectedFeatures:n.selectedFeatures,liveUpdates:n.liveUpdates}),this.refresh),e.events.on("zoom",this.refresh)}renderOutline(e,s,n,i,r){var o,a;const l=Xs(e)&&((o=e.properties.style)==null?void 0:o.fixedSize);let{width:u,height:h}=$n(e);l&&(u/=r,h/=r);const g=ru(e,l,r),f=u/2,p=h/2,y=g.x+f,_=g.y+p;s.save(),s.translate(y,_),s.rotate(n);const x=(a=e.properties.style)==null?void 0:a.borderRadius;if(x&&x>0?(bX(s,-f,-p,u,h,x),s.stroke()):s.strokeRect(-f,-p,u,h),i>=4&&i<8){let v,b,S,A;const w=x&&x>0?x:this.handleRadius/r;switch(i){case 4:v=-f+w,b=-p,S=f-w,A=-p;break;case 5:v=f,b=-p+w,S=f,A=p-w;break;case 6:v=f-w,b=p,S=-f+w,A=p;break;case 7:v=-f,b=p-w,S=-f,A=-p+w;break}s.lineWidth=this.handleStrokeWidth*this.handleMagnifier/r,s.beginPath(),s.moveTo(v,b),s.lineTo(S,A),s.stroke(),s.lineWidth=this.handleStrokeWidth}s.restore()}renderArrowHandles(e,s,n,i){const r=tk(e),o=ek(e),a=+(i===0),l=+(i===1),u=n*(1+(this.handleMagnifier-1)*a),h=n*(1+(this.handleMagnifier-1)*l);s.beginPath(),s.moveTo(r.x,r.y),s.lineTo(o.x,o.y),s.closePath(),s.stroke(),s.beginPath(),s.moveTo(r.x-u,r.y-u),s.rect(r.x-u,r.y-u,u*2,u*2),s.moveTo(o.x-h,o.y-h),s.rect(o.x-h,o.y-h,h*2,h*2),s.closePath(),s.fill(),s.stroke()}renderBoxHandles(e,s,n,i,r){var o;if(Xs(e)&&(o=e.properties.style)!=null&&o.fixedSize)return;const{width:a,height:l}=$n(e),u=ru(e),h=a/2,g=l/2,f=u.x+h,p=u.y+g;s.save(),s.translate(f,p),s.rotate(r),s.beginPath();for(let y=0;y<Mw.length;y++){const[_,x]=Mw[y],v=a*_,b=l*x,S=i===y?n*this.handleMagnifier:n;s.rect(v-S,b-S,S*2,S*2)}s.closePath(),s.fill(),s.stroke(),s.restore()}renderPolygonHandles(e,s,n,i,r){const o=e.geometry.coordinates[0];if(!r){o.length>2&&(s.save(),s.strokeStyle=this.handleStroke,s.lineWidth=this.handleStrokeWidth/this.store.getState().zoom,this.drawSmoothPolygon(s,o,.5),s.stroke(),s.restore()),s.beginPath();for(let a=0;a<o.length-1;a++){const[l,u]=o[a],h=i===a?n*this.handleMagnifier:n;s.moveTo(l+h,u),s.arc(l,u,h,0,2*Math.PI)}s.closePath(),s.fill(),s.stroke()}}drawSmoothPolygon(e,s,n){const i=s.slice(0,-1);if(i.length<3)return;e.beginPath();const r=i.length;for(let o=0;o<r;o++){const a=i[(o-1+r)%r],l=i[o],u=i[(o+1)%r],h=i[(o+2)%r],g=l[0]+(u[0]-a[0])/6*n,f=l[1]+(u[1]-a[1])/6*n,p=u[0]-(h[0]-l[0])/6*n,y=u[1]-(h[1]-l[1])/6*n;o===0&&e.moveTo(l[0],l[1]),e.bezierCurveTo(g,f,p,y,u[0],u[1])}e.closePath()}renderCenterPoint(e,s){var n;const i=this.store.getState();if(Xs(e)){const r=ru(e,(n=e.properties.style)==null?void 0:n.fixedSize,i.zoom),o=$n(e);s.moveTo(r.x+o.width/2+5,r.y+o.height/2),s.arc(r.x+o.width/2,r.y+o.height/2,5,0,Math.PI*2,!0)}}destroy(){this.layer.destroy(),super.destroy()}}const SX=.5;function AX(t,e,s,n){const{start:i,end:r}=V0(t),o=En(r,i);return Math.min(n,Math.max(2*e,Mi(o)*.01,s))}function kw(t,e){return!t||t==="none"?0:t==="dot"?e*2:t==="halo-dot"?e*4:t==="arrow"||t==="arrow-plain"?e:0}function wX(t,e){if(!t){t=As("g");const s=As("path");t.classList.add("annotation-arrow"),t.setAttribute("data-annotation",`${e}`),t.setAttribute("data-annotation-type","arrow"),t.appendChild(s);const n=As("g");n.classList.add("annotation-arrow-endpoints"),t.appendChild(n)}return t}function TX(t,e,s,n,i,r){const{start:o,end:a}=V0(e),l=e.properties.style||qa,{tail:u,strokeWidth:h=0,head:g,strokeColor:f,strokeType:p}=l,y=En(a,o),_=lk(e)?1/r.zoom:1,x=AX(e,h,s,n)*_,v=wX(i,e.id),b=v.firstChild,S=f||"none";b.setAttribute("stroke",S),b.setAttribute("stroke-width",`${_*h}`),b.setAttribute("fill","none"),b.setAttribute("stroke-linecap","round"),b.setAttribute("stroke-linejoin","round");const A=kw(u,h*_),w=kw(g,h*_),L=Pf(y),M=$a(o,eo(L,A)),F=$a(a,eo(L,-w)),O=`M ${M.x} ${M.y} L ${F.x} ${F.y}`;b.setAttribute("d",O);const G=v.children[1];return G.innerHTML="",p==="dashed"?b.setAttribute("stroke-dasharray","5,10"):b.removeAttribute("stroke-dasharray"),Iw(G,o,y,S,u,h,_,x),Iw(G,a,TW(y),S,g,h,_,x),v.setAttribute("transform",`rotate(${-r.rotation*(180/Math.PI)})`),t.appendChild(v),v}function Iw(t,e,s,n,i,r,o,a){i==="halo-dot"&&Rw(t,e,CX(n),SX,r*o*4),(i==="dot"||i==="halo-dot")&&Rw(t,e,n,1,r*o*2),(i==="arrow"||i==="arrow-plain")&&LX(t,e,s,n,i==="arrow-plain",r*o,a)}function CX(t){return t==="none"?"none":t}function Rw(t,e,s,n,i){const r=As("circle");r.setAttribute("cx",`${e.x}`),r.setAttribute("cy",`${e.y}`),r.setAttribute("r",`${i}`),r.setAttribute("fill-opacity",`${n}`),r.setAttribute("fill",s),t.appendChild(r)}function LX(t,e,s,n,i,r,o){const a=eo(Pf(s),o),l=$a(e,vw(a,Math.PI/6)),u=$a(e,vw(a,-Math.PI/6)),h=As("path"),g=`${e.x} ${e.y}`,f=`M ${l.x} ${l.y} L ${g} L ${u.x} ${u.y}${i?" Z":""}`;h.setAttribute("d",f),h.setAttribute("stroke",n),h.setAttribute("stroke-width",`${r}`),h.setAttribute("fill",i?n:"none"),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),t.appendChild(h)}function NX(t,e,s="box"){if(!t){t=As("g"),t.setAttribute("data-annotation",`${e}`),t.setAttribute("data-annotation-type",s),t.classList.add(`annotation-${s}`);const n=As("rect");t.appendChild(n)}return t}function ck(t,e,s,n){const i=e.id,r=`class${i}`,o=$n(e),a=NX(s,i,e.properties.type),{strokeColor:l,strokeWidth:u,strokeType:h,background:g,borderRadius:f}=e.properties.style||mh;a.classList.add("annotation-box"),a.setAttribute("fill",`${g||"transparent"}`);const p=a.firstChild;f&&(p.setAttribute("rx",`${f}`),p.setAttribute("ry",`${f}`)),h&&h!=="none"&&(p.setAttribute("stroke",l||"black"),p.setAttribute("stroke-width",`${u}`),h==="dashed"&&p.setAttribute("stroke-dasharray","5,5")),g&&g.length&&(n.hoveredFeature===e.id?p.setAttribute("fill",gp(g)):p.setAttribute("fill",g));const y=ru(e);return p.setAttribute("width",`${o.width}`),p.setAttribute("height",`${o.height}`),p.setAttribute("x",`${y.x}`),p.setAttribute("y",`${y.y}`),a.appendChild(p),a.setAttribute("transform",n.getRotationTransform(0,0)),a.classList.add(r),a.setAttribute("data-annotation",`${e.id}`),a.setAttribute("data-annotation-type",e.properties.type),t.appendChild(a),a}const MX=/^((?:[a-z\d-]+\s+)*)([\d.]+(%|em|px)|(?:x+-)?large|(?:x+-)?small|medium)(?:\s*\/\s*(normal|[\d.]+(%|px|em)?))?(\s.+)?$/,kX=/\bsmall-caps\b/,IX=/\b(?:italic|oblique)\b/,RX=/\bbold(?:er)?\b/,gk=16,Fw=13.3333333,FX=.01*gk,PX={"xx-small":9,"x-small":10,smaller:13.3333,small:13,medium:16,large:18,larger:19.2,"x-large":24,"xx-large":32},O_=new Map;function zX(t){if(O_.has(t))return O_.get(t);const e=MX.exec(t);if(!e)return;const s={};s.family=(e[6]||"").trim();let n=PX[e[2]]||parseFloat(e[2]);if(e[3]==="%"?n*=FX:e[3]==="em"?n*=gk:e[3]==="pt"&&(n*=Fw),s.size=n,e[4]==="normal"||e[4]==="inherit"||!e[4]?s.height=Math.round(n*(7/6)):!e[5]||e[5]==="em"?s.height=parseFloat(e[4]||"")*n:e[5]==="pt"?s.height=parseFloat(e[4]||"")*Fw:e[5]==="%"?s.height=n*.01:s.height=parseFloat(e[4]||""),s.variant=kX.test(e[1])?"small-caps":"normal",s.style=IX.test(e[1])?"italic":"normal",RX.test(e[1]))s.weight=700;else{const i=/\b(\d+)\b/.exec(e[1]),r=i?parseInt(i[1],10):400;r>=100&&r!==400?s.weight=r:s.weight=400}return O_.set(t,s),s}const DX="12px/14px sans-serif";class Ni{constructor(e=DX){let s,n=14,i=12,r=400,o="normal",a="normal",l=0,u;if(typeof e=="string"){const h=zX(e);h&&(s=h.family,i=h.size,n=h.height||14,a=h.variant,o=h.style,r=h.weight)}else e instanceof Ni&&(s=e.family,i=e.size,n=e.height,a=e.variant,r=e.weight,o=e.style,l=e.baseline,u=e.color);this.family=s||"sans-serif",this.size=i||i===0?i:12,this.height=n||n===0?n:this.size*(7/6),this.variant=a||"",this.style=o||"",this.weight=r||400,this.baseline=l||0,this.color=u||""}assign(e={}){const s=new Ni(this);return e.bold&&(s.weight=700),e.weight&&(s.weight=e.weight),e.italic&&(s.style="italic"),e.family&&(s.family=e.family),e.style&&(s.style=e.style),e.color&&(s.color=e.color),typeof e.baseline=="number"&&(s.baseline=e.baseline),typeof e.size=="number"&&(s.size=e.size),s}toString(e){let s="";return this.style&&this.style!=="normal"&&(s+=this.style),this.variant&&this.variant!=="normal"&&(s+=(s?" ":"")+this.variant),this.weight&&this.weight!==400&&(s+=s?" ":"",this.weight===700?s+="bold":s+=this.weight),this.size&&(s+=(s?" ":"")+this.size+"px",this.height!==this.size&&(s+="/"+this.height+"px")),this.family&&(s+=(s?" ":"")+this.family),e&&(s+="::"+this.baseline),e&&(s+="::"+this.color),s}valueOf(){return this.toString(!0)}}const fk={"\n":.28,"\r":.28," ":.28,"":.28,"":.28,"":0,"":.5,"":1,"":.5,"":1,"":.33,"":.25,"":.16,"":.56,"":.28,"":.2,"":.15,"":0,"":.16,"":.22,"":1,"\uFEFF":0},OX=new Ni,Pw={trim:!0,collapse:!0},B_={};function wx(){return(t,e)=>{const s=new Ni(e);let n=s.size;return/\bmonospace\b/.test(s.family)?n*=.6:(n*=.45,s.weight>400&&(n*=1.18)),t.length*n}}function Tx(t){if(t&&t.getContext){const e=t.getContext("2d");if(e&&typeof e.measureText=="function")return(s,n)=>(e.font=String(n),e.measureText(s).width)}}function pk(){const t=typeof document<"u"?document:null;return typeof OffscreenCanvas<"u"&&new OffscreenCanvas(100,100)||t&&t.createElement&&t.createElement("canvas")||null}let Wd=Tx(pk())||wx();function BX(t){if(t==null)Wd=Tx(pk())||wx();else if(t)Wd=Tx(t)||wx();else throw new Error("setMeasureCanvas argument is not a canvas or null")}function Go(t,e,s=Pw){typeof e=="string"?e=new Ni(e):e instanceof Ni?e=OX.assign(e):e=new Ni().assign(e);const n=Object.assign({},Pw,s);let i=String(t);if(!i)return 0;if(i in fk){const o=e.valueOf()+"/"+i;return o in B_||(B_[o]=Wd(`_${i}_`,e)-Wd("__",e)),B_[o]}!n.trim||!n.collapse?i=i.replace(/\n/g," "):n.trim?i=i.replace(/\n/g," ").trim():n.collapse&&(i=i.replace(/\s+/g," "));const r=typeof t=="string"?0:t.tracking||0;return Wd(i,e)+e.size*r}class tn{constructor(e=""){this.value=e,this.font=null,this.href="",this.sub=!1,this.sup=!1,this.width,this.line,this.tracking,this.whitespace}clone(){const e=new tn(this.value);return Object.assign(e,this)}valueOf(){return this.value}toString(){return this.value}}class _h extends tn{}class Li extends tn{}class Pa extends tn{}const UX=/[\r\n\xA0]+/g,zw=.7;function GX(t,e){t.sup&&(t.baseline=.45,t.size=zw),t.sub&&(t.baseline=-.3,t.size=zw);let s=e;return(t.style||t.weight||t.baseline||t.color||t.size||t.family)&&(s=e.assign(t)),s}function Dw(t,e,s){let n=t.width,i,r;for(;n+s.width>e&&t.length;)i=t[t.length-1],r=i.width,i.width>s.width?(i.value=i.value.slice(0,-1),i.width=Go(i,i.font),n+=i.width):t.pop(),n-=r;t[t.length-1]instanceof Pa&&t.pop(),i=t[t.length-1]||i||{},s.font=s.font.assign(i),s.href=t.length?i.href:null,s.rel=t.length?i.rel:null,s.target=t.length?i.target:null,t.push(s)}function Ow(t){return Object.assign([],{height:0,font:t,width:0,hasOverflow:!1,hasLineOverflow:!1})}function VX(t,e,s){if(!t.length)return Ow(s);const n=e.height(),i=e.width(),r=e.overflowLine(),o=e.overflowWrap(),a=s.assign({bold:!0}),l=isFinite(n())?Math.floor(n()/s.height):1/0;if(!n()&&!i(0)||!l)return Ow(s);let u=0,h=0,g=0;const f=[];let p=[],y=!1;for(;u<t.length&&h<l;){const w=t[u],L=GX(w,s);if(w.width=Go(w,L),w.font=L,w.line=h,w.whitespace=w.value in fk,w.value&&(w.value=w.value.replace(UX," ")),!(!g&&w.whitespace||y&&w.whitespace))if(w instanceof Li)g=0,p=[],f.push(u+1),h++;else if(w instanceof _h||w instanceof Pa)p.push({index:u,width:g});else if(w.whitespace||g+w.width<i(h))g+=w.width;else if(p.length){let M,F;do{F=!0,M=p.pop();const O=t[M.index];let G;O instanceof Pa&&(G=Go("-",O.font||s),M.width+G>i(h)&&(F=!p.length))}while(!F);f.push(M.index+1),g=0,h++,u=M.index,p=[]}else if(o==="break-word"){const M=i(h);if(g+w.width>M){const F=w.clone();do w.value=w.value.slice(0,-1),w.width=Go(w,w.font||s),g+=w.width;while(w.value&&w.width>M);F.value=F.value.slice(w.value.length),t.splice(u+1,0,new _h,F)}f.push(u+1),g=0,h++}else g+=w.width;u++,y=w.whitespace}u!==f[f.length-1]&&f.push(u);let _=0,x=0;const v=f.map(w=>{let L=_,M;for(;(M=t[L])&&(M.whitespace||!M.value);)L++;let F=w,O=null;for(;F>L&&(M=t[F-1])&&(M.whitespace||!(M.value||M instanceof Pa));)M instanceof Li&&(O=M),F--;M instanceof Pa&&(M.value="-",M.width=Go("-",M.font||s)),_=w;const G=Object.assign(t.slice(L,F).filter(j=>j.value),{width:0});return O&&G.push(O),G.width=G.reduce((j,Z)=>j+Z.width,0),G.width>x&&(x=G.width),G});let b=!1;if(r){const w=r==="ellipsis"?"":r;v.forEach((L,M)=>{const F=i(M);if(L.width>F){const O=new tn(w);O.font=s,O.width=Go(w,a),Dw(L,F,O),b=!0}})}let S=!1;const A=e.overflow()==="ellipsis"?"":e.overflow();if(A&&u!==t.length){const w=i(v.length-1),L=v[v.length-1],M=new tn(A);M.font=s,M.width=Go(A,a),Dw(L,w,M),S=!0}else S=!1;return Object.assign(v,{height:v.length*s.height,font:s,width:x,hasOverflow:S,hasLineOverflow:b})}function Dl(t){return Math.round(t*1e6)/1e6}const jX={center:"middle",right:"end"},HX={middle:.5,center:.5,bottom:1,end:1},U_=(t,e)=>!t&&!e||t===e;function $X(t,e){const s=[],n=e.font(),i=n.size,r=n.family,o=e.align(),a=e.createElement();if(t.length){const l=n.height,u=e.valign(),h=e.height()(),g=e.width()(0),f=!isFinite(g)&&t.length===1,p=f?null:e.x(),y=Dl(l/i);let _=f?null:Dl(l/(i*1.15+(l-i)/2));if(HX[u]&&isFinite(h)){const M=u==="bottom"?1:.5;_=(_||0)+(h*M-l*t.length*M)/i}const x=o==="justify";let v=0;o==="right"?v=g:o==="center"&&(v=g/2);let b=[],S="tspan",A=null,w="";const L=()=>{if(w){const M=a(S,A,w);b.push(M)}S="tspan",A=null,w=""};for(let M=0,F=t.length;M<F;M++){let O="",G="",j=0;const Z=t[M];if(!Z.length){s.push(a("tspan",{x:p(M),dy:Dl(M?y:_)+"em"},""));continue}b=[];let at=0,pt=0,K;for(let ut=0,ht=Z.length;ut<ht;ut++){const nt=Z[ut],ot=nt.font;nt.whitespace&&at++,pt+=nt.width,ut&&!nt.tracking&&!j&&U_(ot.id,O)&&U_(nt.class,G)&&U_(K,nt.href)?w+=nt.value:(L(),w=nt.value,A={fontFamily:ot.family!==r?ot.family:null,fontSize:ot.size!==i?ot.size:null,fontWeight:ot.weight!==400&&ot.weight||null,fontStyle:ot.style!=="normal"&&ot.style||null,fontVariant:ot.variant!=="normal"&&ot.variant||null,fill:ot.color||null,baselineShift:ot.baseline?ot.baseline*100+"%":null,className:nt.class||null,dx:0,href:null,rel:null,target:null},j&&(A.dx=Dl(j),j=0),nt.tracking&&(j=ot.size*nt.tracking),nt.href&&!K?(K=nt.href,S="a",A.href=K,A.rel=nt.rel,A.target=nt.target):K=null,O=ot.id,G=nt.class)}if(L(),f)s.push(...b);else{let ut=null;const ht=M===F-1||Z[Z.length-1]instanceof Li;if(x&&Z.length>1&&!ht){const nt=g-pt;ut=Dl(nt/at)}s.push(a("tspan",{wordSpacing:ut,x:p(M)+v,dy:Dl(M?y:_)+"em"},...b))}}}return a("text",{fontFamily:r,fontSize:i,textAnchor:jX[o]||"start"},...s)}const qX={middle:.5,center:.5,bottom:1,end:1};function YX(t,e){return t.color?t.color:e.href?"#00C":"#000"}function WX(t,e,s){if(!t.length)return;s.textBaseline="middle";const n=e.font(),i=n.height,r=n.size,o=e.valign(),a=e.height()(),l=e.width()(0),u=e.align(),h=u==="justify";let g=i*.5;const f=qX[o];if(f&&isFinite(a)){const p=t.length*i;g+=a*f-p*f}t.forEach((p,y)=>{let _=e.x()(y);const x=y*i+g;let v=0,b=0;p.forEach(w=>{w.whitespace&&v++,b+=w.width});let S=0;const A=y===t.length-1||p[p.length-1]instanceof Li;h&&p.length>1&&!A&&(S=(l-b)/v),p.forEach(w=>{s.font=w.font;const L=w.font,M=L.baseline?r*-L.baseline+r*.15:0;s.fillStyle=YX(L,w);let F=0;if(u==="right"?F+=l-b:u==="center"?F+=l/2-b/2:u==="justify"&&(w.whitespace||w instanceof Li)&&(_+=S),s.fillText(w.value,_+F,x+M),w.href){s.beginPath(),s.strokeStyle=s.fillStyle;const O=Math.floor(x+r*.45)+.5;s.moveTo(_+F,O),s.lineTo(_+F+w.width,O),s.stroke()}_+=w.width})})}function mk(t){const e={};for(let s=0;s<t.length;s++){const n=t[s];typeof n=="number"||n==null||(typeof n=="string"?e.text=n:typeof n=="function"?e.fn=n:typeof n=="object"&&n._groups?e.d3=n:n&&n.nodeType&&n.getContext?e.ctx=n.getContext("2d"):n&&n.fillText&&n.beginPath?e.ctx=n:n&&(e.text=n))}return e}const XX=Object.prototype.hasOwnProperty,G_={};function ZX(t){return G_[t]||(G_[t]=t.replace(/([a-z])([A-Z])/g,(e,s,n)=>s+"-"+n.toLowerCase())),G_[t]}function _k(t,e){if(Array.isArray(e))return e.forEach(s=>_k(t,s));typeof e=="string"&&(e=document.createTextNode(e)),t.appendChild(e)}function yk(t,e,...s){if(typeof document>"u")throw new Error("No document found, cannot create elements");const n=typeof t=="string"?document.createElementNS("http://www.w3.org/2000/svg",t):t;if(e&&n.setAttribute)for(const i in e)XX.call(e,i)&&e[i]!=null&&n.setAttribute(i==="className"?"class":ZX(i),String(e[i]));return s!=null&&s.length&&s.forEach(i=>{_k(n,i)}),n}const Bw=t=>typeof t=="function"?t:()=>t,KX={top:{vAnchor:-0},middle:{vAnchor:-.5},bottom:{vAnchor:-1},left:{hAnchor:-0},center:{hAnchor:-.5},right:{hAnchor:-1}},xk=class vk{constructor(e){if(this.props={width:()=>1/0,height:()=>1/0,rotation:0,vAnchor:0,hAnchor:0},e)for(const s in e)typeof this[s]=="function"&&this[s](e[s]);this.render=this.render.bind(this)}anchor(e){const{hAnchor:s,vAnchor:n,width:i,height:r}=this.props;if(!arguments.length)return[s*i(),n*r()];if(typeof e=="string"){const o=this.props;e.toLowerCase().trim().split(/\s+/).forEach(a=>Object.assign(o,KX[a]))}return this}width(e){return arguments.length?(this.props.width=Bw(e),this):this.props.width}height(e){return arguments.length?(this.props.height=Bw(e),this):this.props.height}rotate(e){return arguments.length?(this.props.rotation=e,this):this.props.rotation}createElement(e){return arguments.length?(this.props.createElement=e,this):this.props.createElement||vk.createElement}canvas(e,s){const n=e.getContext?e.getContext("2d"):e;return n.save(),n.rotate(this.rotate()*Math.PI/180),n.translate(...this.anchor()),s(n),n.restore(),n}render(...e){const s=mk(e);if(s.d3)return s.d3.attr("transform",`rotate(${this.rotate()}) translate(${this.anchor()})`);if(s.ctx)return this.canvas(s.ctx,s.fn);if(s.text){const n=typeof s.text.render=="function"?s.text.render():s.text;return this.createElement()("g",{transform:`rotate(${this.rotate()}) translate(${this.anchor()})`},n)}}};Wt(xk,"createElement",yk);let QX=xk;const V_=/^[\n\r\t\x20\xA0\u2000-\u200B\u205F\u3000]/,JX=/^[^\n\r\t\u0020\u2000-\u200B\u205F\u3000]{2,}/,Uw=/^[\xA0\u2011\u202F\u2060\uFEFF]/,t8=/^(?:[;\xAD%?]|,(?!\d))/,e8=/^[$\u2212]/,s8="'[<{(<".split(""),n8="',,!?]>})".split(""),Gw=t=>{const e=t.charCodeAt(0);return e>=19968&&e<=40959};function zf(t,e){e!==!1&&(t=t.trim());const s=[];let n=t.charAt(0),i,r,o=0;for(let a=1,l=t.length;a<l;a++){i=t.charAt(a),r=t.charAt(a+1);const u=V_.test(n),h=V_.test(i);let g=h||u||Gw(n)||Gw(i),f;if((e8.test(i)&&!Uw.test(n)||t8.test(n+r)&&!Uw.test(i))&&(g=!0),g&&(n8.includes(i)||s8.includes(n))&&(g=!1),(n==="-"||n===""||n===""||n==="")&&(f=V_.test(t.charAt(a-2)),f&&!h&&(g=!1),!f&&JX.test(i+r)&&(g=!0)),g){const p=t.slice(o,a);/\u00AD$/.test(p)?(s.push(new tn(p.slice(0,-1))),s.push(new Pa)):(s.push(new tn(p)),s.push(new _h)),o=a}n=i}return s.push(new tn(t.slice(o))),s}const Vw={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:""},i8=/^[\n\r\x20\u2000-\u200B\u205F\u3000]/,r8=/^<\/([a-zA-Z0-9]+)([^>]*)>/,o8=/^<([a-zA-Z0-9]+)((?:\s[^=\s/]+(?:\s*=\s*(?:"[^"]+"|'[^']+'|[^>\\s]+))?)+)?\s*(\/?)>(\n*)/,a8=/^<!--(.+?)-->/,l8=/&(?:#(\d\d{2,})|#x([\da-fA-F]{2,})|([a-zA-Z][a-zA-Z1-4]{1,8}));/g,jw={b:t=>t.weight=700,strong:t=>t.weight=700,i:t=>t.style="italic",em:t=>t.style="italic",dfn:t=>t.style="italic",cite:t=>t.style="italic",code:t=>t.family="monospace",kbd:t=>t.family="monospace",samp:t=>t.family="monospace",var:t=>t.family="monospace",tt:t=>t.family="monospace",sub:t=>t.sub=!0,sup:t=>t.sup=!0},u8={div:1,li:1,blockquote:2,h1:2,h2:2,h3:2,h4:2,h5:2,h6:2,ul:2,ol:2,hr:2,p:2};function bk(t){return t.replace(l8,function(e,s,n,i){if(s||n){const r=s?10:16;return String.fromCharCode(parseInt(s||n,r))}else if(i in Vw)return Vw[i];return e})}function d8(t){return t&&t.length>1&&(t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'")?t.slice(1,-1):t}const h8=/^\s*([^=\s&]+)(?:\s*=\s*("[^"]+"|'[^']+'|[^>\s]+))?/;function c8(t){let e;const s={};if(t){do if(e=h8.exec(t),e){const n=bk(d8(e[2]||"")).replace(/[ \r\n\t]+/g," ").trim();if(s[e[1]]=n,t=t.slice(e[0].length),t.length&&/^\S/.test(t[0]))throw new Error("Attribute error")}while(e&&t.length);if(/\S/.test(t))throw new Error("Attribute error")}return s}function g8(t){t=String(t||"").trim();let e={weight:null,style:null,sub:!1,sup:!1,href:null,color:null,rel:null,target:null};const s=[],n=[];let i,r;const o=function(g){for(const f in e)e[f]&&(g[f]=e[f]);s.push(g)},a=()=>{n.push(e),e=Object.create(e)},l=()=>{n.length&&(e=n.pop())},u=g=>{const f=s.length;let p=u8[g];if(f&&p){let y=f-1;for(;s[y]&&(s[y]instanceof _h||i8.test(s[y].value));)y--;for(;p&&s[y]&&s[y]instanceof Li;)y--,p--;for(;p-- >0;)s.push(new Li)}};for(;t.length;){if(i=/^[^<]+/.exec(t)){const g=bk(i[0]);zf(g,!1).forEach(o)}else if(!(i=a8.exec(t)))if(i=r8.exec(t))l(),u(i[1]);else if(i=o8.exec(t)){const g=i[1];u(g),a(),jw[g]&&jw[g](e);const f=c8(i[2]);g==="a"&&(f.href&&(e.href=f.href),f.rel&&(e.rel=f.rel),f.target&&(e.target=f.target)),f.class&&(e.class=e.class?e.class+" "+f.class:f.class),f.style&&(r=/(?:^|\s|;)color\s*:\s*([^;\s"']+)/.exec(f.style),r&&r[1]&&(e.color=r[1])),g==="br"&&s.push(new Li)}else i=[t.slice(0,1)],o(new tn(i[0]));t=t.slice(i[0].length)}let h=s[s.length-1];for(;h instanceof Li;)s.pop(),h=s[s.length-1];return s}const Hw={copyright:"",textcopyright:"",dag:"",textdagger:"",ddag:"",textdaggerdbl:"",guillemotleft:"",guillemotright:"",guilsinglleft:"",guilsinglright:"",ldots:"",dots:"",textellipsis:"",lq:"",P:"",textparagraph:"",pounds:"",textsterling:"",quotedblbase:"",quotesinglbase:"",rq:"",S:"",sim:"~",textasciicircum:"^",textasciitilde:"",texttildelow:"~",textasteriskcentered:"*",textbackslash:"'",textbar:"|",textbardbl:"",textbigcircle:"",textbraceleft:"{",textbraceright:"}",textbullet:"",textdollar:"$",textemdash:"",textendash:"",texteuro:"",eurosym:"",euro:"",textexclamdown:"",textgreater:">",textless:"<",textordfeminine:"",textordmasculine:"",textperiodcentered:"",cdot:"",textquestiondown:"",textquotedblleft:"",textquotedblright:"",textquoteleft:"",textquoteright:"",textquotestraightbase:"",textquotestraightdblbase:"",textregistered:"",textthreequartersemdash:"-",texttrademark:"",texttwelveudash:"-",textunderscore:"_",textvisiblespace:"",gets:"",textleftarrow:"",to:"",textrightarrow:"",textdegree:"",infty:"",triangle:"",triangledown:"",blacktriangle:"",blacktriangledown:"",angle:"",sphericalangle:"",aleph:"",hbar:"",imath:"",jmath:"",ell:"",wp:"",Re:"",Im:"",mho:"",prime:"",emptyset:"",nabla:"",surd:"",partial:"",top:"",bot:"",vdash:"",dashv:"",forall:"",exists:"",nexists:"",neg:"",lnot:"",flat:"",natural:"",sharp:"",backslash:"\\",Box:"",Diamond:"",clubsuit:"",diamondsuit:"",heartsuit:"",spadesuit:"",Join:"",blacksquare:"",bigstar:"",diagdown:"",diagup:"",blacklozenge:"",rfloor:"",lfloor:"",rceil:"",lceil:"",rangle:"",langle:"",sum:"",int:"",oint:"",prod:"",coprod:"",bigcap:"",bigcup:"",bigsqcup:"",bigvee:"",bigwedge:"",bigodot:"",bigotimes:"",bigoplus:"",biguplus:"",alpha:"",beta:"",chi:"",delta:"",epsilon:"",eta:"",gamma:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",omega:"",phi:"",pi:"",psi:"",rho:"",sigma:"",tau:"",theta:"",upsilon:"",xi:"",zeta:"",Alpha:"",Beta:"",Chi:"",Delta:"",Epsilon:"",Eta:"",Gamma:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Omega:"",Phi:"",Pi:"",Psi:"",Rho:"",Sigma:"",Tau:"",Theta:"",Upsilon:"",Xi:"",Zeta:"",aa:"",AA:"",ae:"",AE:"",dh:"",DH:"",dj:"",DJ:"",ij:"",IJ:"",l:"",L:"",ng:"",NG:"",o:"",O:"",oe:"",OE:"",ss:"",SS:"SS",th:"",TH:""},f8=/^(\^|_|\\[^#$%&~_^\\{}()\s]+)(\{)?/,p8=/^%[^\n]+(?:\n|$)/,m8=/^[^#$%&~_^\\{}]+/,_8=/^\\([&{}$%#_])/,y8=/(?:\\[\\@,!:;-]|-{2,3}|[!?]`|``?|,,|''?|~|<<|>>)/g,x8={"---":"","--":"","!`":"","?`":"","``":"",",,":"","''":"","`":"","'":"","<<":"",">>":"","~":"","\\-":"","\\,":"","\\;":"","\\:":"","\\!":"","\\@":"\uFEFF","\\\\":"\\newline{}"},Sn={bf:t=>t.weight="bold",it:t=>t.style="italic",sl:t=>t.style="italic",color:(t,e)=>t.color=e,href:(t,e)=>t.href=e,"^":t=>t.sup=!0,_:t=>t.sub=!0,par:function(t){this.tokens.push(new Li,new Li)},newline:function(t){this.tokens.push(new Li)},url:function(t,e){t=this.open_context(),t.href=e,this.add_token(new tn(e)),this.close_context()}};Sn.textsuperscript=Sn["^"];Sn.textsubscript=Sn._;Sn.textsl=Sn.sl;Sn.mathbf=Sn.bf;Sn.mathit=Sn.it;Sn.textbf=Sn.bf;Sn.textit=Sn.it;Sn.textcolor=Sn.color;function v8(t){t=String(t||"").trim();const e=[0];t=t.replace(/\\verb,(.*?),/,(h,g)=>(e.push(g),"\\verb,"+(e.length-1)+",")).replace(/\\\\\n/g,()=>"\\\\").replace(y8,(h,g,f)=>f.charAt(g-1)==="\\"?h:x8[h]).replace(/\n\s+/g,h=>/\n/.test(h.slice(1))?"\\par ":h).replace(/\\symbol\{(\d+)\}/,(h,g,f,p)=>p.charAt(f-1)==="\\"?h:String.fromCharCode(1*g)).replace(/(^|[^\\])(\^|_)(\d|[^{]\S*)/g,(h,g,f,p)=>g+f+"{"+p+"}").replace(/\\verb,(.*?),/,(h,g)=>`\\verb,${e[+g]},`);let s={weight:null,italic:null,variant:null,sub:!1,sup:!1,href:null};const n=[],i=[];let r;const o=function(h){for(const g in s)s[g]&&(h[g]=s[g]);return n.push(h),h},a=function(){i.push(s),s=Object.create(s)},l=function(){if(!i.length)throw new Error("Unexpected }");s=i.pop()},u={tokens:n,open_context:a,close_context:l,add_token:o};for(;t.length;){if(r=m8.exec(t))zf(r[0],!1).forEach(o);else if(r=_8.exec(t))o(new tn(r[1]));else if(!(r=p8.exec(t))){if(r=/^\{/.exec(t))a();else if(r=/^\}/.exec(t))l();else if(!(r=/^\$/.exec(t)))if(r=/^\\verb,([^,]+),/.exec(t))o(new tn(r[1]));else if(r=f8.exec(t)){const h=r[1].slice(1)||r[1];let g=!!r[2];if(/^(La)?TeX$/i.test(h)){a(),s.family="serif";let f;h==="LaTeX"&&(f=o(new tn("L")),f.tracking=-.25,f=o(new tn("A")),f.size=.7,f.baseline=.3,f.tracking=-.1),f=o(new tn("T")),f.tracking=-.17,f=o(new tn("E")),f.baseline=-.22,f.tracking=-.13,f=o(new tn("X")),l()}else if(h in Hw)o(new tn(Hw[h])),g&&a();else if(h in Sn){const f=[];let p=Sn[h].length-1,y;if(p){for(g=!1,t=t.slice(r[0].length-1);p--;)if(y=/^\{([^}]+)\}/.exec(t))f.push(y[1]),t=t.slice(y[0].length);else throw new Error(h+" is missing an argument");r[0]=/^\{/.exec(t)?"{":"",g=!!r[0]}g&&a(),Sn[h].apply(u,[s,...f])}else o(new tn(r[1])),g&&a()}else r=[t.slice(0,1)],o(new tn(r[0]))}t=t.slice(r[0].length)}return n}const b8=new Ni,j_=t=>typeof t=="function"?t:()=>t,$w={left:"left",start:"left",center:"center",middle:"center",right:"right",end:"right",justify:"justify"},mi=class Fd{constructor(e){this.props={overflow:"ellipsis",overflowWrap:null,overflowLine:"",align:"left",wordBreak:null,valign:"top",width:()=>1/0,height:()=>1/0,x:()=>0,font:b8,parser:Fd.defaultparser},e&&(e.font&&this.font(e.font),e.overflow&&this.overflow(e.overflow),e.overflowLine&&this.overflowLine(e.overflowLine),e.overflowWrap&&this.overflowWrap(e.overflowWrap),e.valign&&this.valign(e.valign),e.align&&this.align(e.align),e.width&&this.width(e.width),e.height&&this.height(e.height),e.x&&this.x(e.x),e.parser&&this.parser(e.parser),e.createElement&&this.createElement(e.createElement))}linebreak(e){const s=this.props.parser(String(e)),n=VX(s,this,this.font()),i=r=>this.render(n,r);return Object.assign(n,{render:i,svg:i,draw:i})}font(e){return arguments.length?(this.props.font=new Ni(e),this):this.props.font||new Ni}overflow(e){return arguments.length?(this.props.overflow=String(e),this):this.props.overflow}overflowLine(e){return arguments.length?(this.props.overflowLine=String(e),this):this.props.overflowLine}valign(e){return arguments.length?(this.props.valign=e,this):this.props.valign}align(e){if(!arguments.length)return this.props.align;const s=String(e).toLowerCase();return s in $w&&(this.props.align=$w[s]),this}overflowWrap(e){if(!arguments.length)return this.props.overflowWrap||"normal";const s=String(e).toLowerCase();return s==="break-word"?this.props.overflowWrap="break-word":(s==="normal"||e==null)&&(this.props.overflowWrap=null),this}width(e){return arguments.length?(this.props.width=j_(e),this):this.props.width}height(e){return arguments.length?(this.props.height=j_(e),this):this.props.height}x(e){return arguments.length?(this.props.x=j_(e),this):this.props.x}parser(e){if(!arguments.length)return this.props.parser;if(typeof e=="string"){const s=Fd[e]||Fd[e+"parser"];typeof s=="function"&&(e=s)}if(typeof e!="function")throw new Error("Unknown parser: "+e);return this.props.parser=e,this}createElement(e){return arguments.length?(this.props.createElement=e,this):this.props.createElement||Fd.createElement}render(e,s){const n=mk([e,s]);if(typeof n.text=="string"&&(n.text=this.linebreak(n.text)),n.ctx)WX(n.text,this,n.ctx);else return $X(n.text,this)}};Wt(mi,"createElement",yk),Wt(mi,"textparser",zf),Wt(mi,"defaultparser",zf),Wt(mi,"htmlparser",g8),Wt(mi,"latexparser",v8),Wt(mi,"Token",tn),Wt(mi,"Break",_h),Wt(mi,"LineBreak",Li),Wt(mi,"SoftHyphen",Pa),Wt(mi,"Rotator",QX),Wt(mi,"Font",Ni),Wt(mi,"setMeasureCanvas",BX),Wt(mi,"measureText",function(t,e,s){return Go(t,new Ni(e),s)});let H_=mi;function Ek(t,e,s,n){const{width:i,height:r}=$n(e),{color:o=rn.color,strokeColor:a=rn.strokeColor,strokeWidth:l=rn.strokeWidth,strokeType:u=rn.strokeType,background:h=rn.background,borderRadius:g=rn.borderRadius,fixedSize:f=rn.fixedSize}=e.properties.style||rn,p=ck(t,e,s,n);p.setAttribute("data-annotation-type",e.properties.type),p.classList.add("annotation-text"),p.setAttribute("fill",`${o}`);let y=p.firstChild;for(;y;){const S=y.nextSibling;y.nodeType===1&&y.tagName!=="rect"&&p.removeChild(y),y=S}let _=p.firstChild;_||(_=As("rect"),p.appendChild(_));const x=-i/2,v=-r/2;g&&(_.setAttribute("rx",`${g}`),_.setAttribute("ry",`${g}`)),u&&u!=="none"&&(_.setAttribute("stroke",a||"black"),_.setAttribute("stroke-width",`${l}`),u==="dashed"&&_.setAttribute("stroke-dasharray","5,5")),h&&h.length&&(n.hoveredFeature===e.id?_.setAttribute("fill",gp(h)):_.setAttribute("fill",h)),_.setAttribute("width",`${i}`),_.setAttribute("height",`${r}`);const b=yi(e);return _.setAttribute("x",`${x}`),_.setAttribute("y",`${v}`),E8(e,p,x,v),p.setAttribute("transform",n.getScreenAlignedTransform(b.x,b.y,!f)),t.appendChild(p),p}const qw=t=>t.replace(/$/,""),Yw=t=>t.children[0].innerHTML;function E8(t,e,s=0,n=0){const{width:i,height:r}=$n(t),{fontSize:o=rn.fontSize,font:a=rn.font,padding:l=0}=t.properties.style||{};if(i===r&&i===0)return;const u=parseFloat(o.toString())*KM,h=new H_({font:`${o}px/${u}px ${a}`.replace(/(px)+/g,"px"),width:i-l*2,height:r-l,align:"left",valign:"top",x:0,overflow:"ellipsis",parser:H_.htmlparser,createElement:H_.createElement});h.overflowWrap("break-word");const g=t.properties.content||"";if(g.length===0)return;const f=h.linebreak(g.replaceAll(`
`,"<br>")).svg(),p=[...f.children],y=g.match(/(https?:\/\/.*)/gm);(y?y.map(_=>_.split(" ")[0]):[]).forEach(_=>{let x=_;const v=[];for(;x.length>0;){const b=p.find(A=>!!A.children[0]&&A.children[0].tagName==="tspan"&&x.startsWith(qw(Yw(A))));if(!b)break;v.push(b);const S=qw(b.children[0].innerHTML).length;if(!S)break;x=x.slice(S)}v.forEach(b=>{const S=document.createElementNS("http://www.w3.org/2000/svg","a");S.setAttribute("href",_),S.setAttribute("target","_blank"),S.innerHTML=Yw(b),b.children[0].innerHTML="",b.children[0].appendChild(S)})}),f.setAttribute("transform",`translate(${s+l}, ${n+l})`),e.appendChild(f)}function S8(){const t=As("style");return t.textContent=`
    /* Comment Animation Styles */
    .comment-icon,
    .comment-box {
      transition:
        opacity 0.25s ease-in-out,
        scale 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      will-change: scale, opacity;
    }

    /* Disable transitions when comment was not visible */
    .comment-no-transition .comment-icon,
    .comment-no-transition .comment-box {
      transition: none;
    }

    /* Collapsed state: icon visible, box hidden */
    .comment-collapsed .comment-icon {
      opacity: 1;
      scale: 1;
    }

    .comment-collapsed .comment-box {
      opacity: 0;
      scale: 0.5;
    }

    /* Expanded state: box visible, icon hidden */
    .comment-expanded .comment-icon {
      opacity: 0;
      scale: 0.5;
    }

    .comment-expanded .comment-box {
      opacity: 1;
      scale: 1;
    }
  `,t}function A8(t,e,s){const n={...Ta,...e.properties.style},i=n.iconSize,{iconColor:r=Ta.iconColor,iconSymbol:o=Ta.iconSymbol,iconBorderColor:a=Ta.iconBorderColor,iconBorderWidth:l=Ta.iconBorderWidth}=n;let u=t.querySelector("circle");u||(u=As("circle"),u.setAttribute("cx","0"),u.setAttribute("cy","0"),t.appendChild(u)),u.setAttribute("r",`${i/2}`),s.hoveredFeature===e.id?u.setAttribute("fill",gp(r)):u.setAttribute("fill",r),l&&l>0?(u.setAttribute("stroke",a||"#CCC"),u.setAttribute("stroke-width",`${l}`)):(u.removeAttribute("stroke"),u.removeAttribute("stroke-width"));let h=t.querySelector("text");h||(h=As("text"),h.setAttribute("x","0"),h.setAttribute("y","0"),h.setAttribute("text-anchor","middle"),h.setAttribute("dominant-baseline","central"),h.setAttribute("pointer-events","none"),t.appendChild(h)),h.setAttribute("font-size",`${i*.5}`),h.textContent=o}function w8(t,e,s){const n={...e,properties:{type:"text",content:e.properties.content,width:e.properties.width,height:e.properties.height,style:{...e.properties.style,fixedSize:!0}}},i=As("g"),r=Ek(i,n,void 0,s);for(t.innerHTML="";r.firstChild;)t.appendChild(r.firstChild);t.setAttribute("filter","url(#softShadow)")}function T8(t,e,s,n,i){const r=e.properties.mode;let o=s;o||(o=As("g"),o.setAttribute("data-annotation",`${e.id}`),o.setAttribute("data-annotation-type","comment"));let a=o.querySelector(".comment-icon");a||(a=As("g"),a.classList.add("comment-icon"),o.appendChild(a));let l=o.querySelector(".comment-box");l||(l=As("g"),l.classList.add("comment-box"),o.appendChild(l)),A8(a,e,n),w8(l,e,n),i?o.classList.remove("comment-no-transition"):o.classList.add("comment-no-transition"),r===fh&&!o.classList.contains("comment-collapsed")?(o.classList.add("comment-collapsed"),o.classList.remove("comment-expanded")):r!==fh&&o.classList.contains("comment-collapsed")&&(o.classList.add("comment-expanded"),o.classList.remove("comment-collapsed"));const u=yi(e);return o.setAttribute("transform",n.getScreenAlignedTransform(u.x,u.y,!1)),(!o.parentNode||o.parentNode!==t)&&t.appendChild(o),o}function C8(t,e=.5,s=!1){if(t.length<2)return"";if(t.length<3)return t.map((o,a)=>`${a===0?"M":"L"}${o[0]},${o[1]}`).join(" ")+" Z";const n=t,i=n.length-1,r=[];for(let o=0;o<i;o++){const a=n[(o-1+i)%i],l=n[o],u=n[(o+1)%i],h=n[(o+2)%i],g=l[0]+(u[0]-a[0])/6*e,f=l[1]+(u[1]-a[1])/6*e,p=u[0]-(h[0]-l[0])/6*e,y=u[1]-(h[1]-l[1])/6*e;o===0&&r.push(`M${l[0]},${l[1]}`),s&&o===i-1?r.push(`L${u[0]},${u[1]}`):r.push(`C${g},${f} ${p},${y} ${u[0]},${u[1]}`)}return r.push("Z"),r.join(" ")}const L8=(t,e,s="box")=>(t||(t=As("g"),t.setAttribute("data-annotation",`${e}`),t.classList.add(`annotation-${s}`)),t);function N8(t,e,s,n){const i=L8(s,e.id.toString(),e.properties.type);i.setAttribute("data-annotation",String(e.id));let r=i.querySelector("path");r||(r=As("path"),i.appendChild(r));const{strokeColor:o=Ca.strokeColor,strokeWidth:a=Ca.strokeWidth,background:l=Ca.background,strokeType:u=Ca.strokeType}=e.properties.style||Ca;o&&r.setAttribute("stroke",o),a!==void 0&&r.setAttribute("stroke-width",String(a)),l&&(n.hoveredFeature===e.id?r.setAttribute("fill",gp(l)):r.setAttribute("fill",l)),u==="dashed"?r.setAttribute("stroke-dasharray","5,5"):r.removeAttribute("stroke-dasharray");const h=e.geometry.coordinates[0],g=C8(h,.5,n.drawingFeature===e.id);return r.setAttribute("d",g),i.setAttribute("transform",n.getRotationTransform(0,0)),t.appendChild(i),i}class M8 extends hk{constructor(e,s){super(e,s),Wt(this,"features",new Map),Wt(this,"arrowsRoot",null),Wt(this,"shapesRoot",null),Wt(this,"commentsRoot",null),Wt(this,"annotationsRoot",null),Wt(this,"visibleFeatures",new Set),Wt(this,"isExporting",!1),Wt(this,"render",n=>{const{features:i,hoveredFeature:r,selectedFeatures:o,liveUpdates:a}=this.store.getState();(!this.annotationsRoot||!n.contains(this.annotationsRoot))&&(n.innerHTML="",n.appendChild(this.getDefs()),this.arrowsRoot=As("g"),this.commentsRoot=As("g"),this.annotationsRoot=As("g"),this.shapesRoot=As("g"),this.annotationsRoot.appendChild(this.arrowsRoot),this.annotationsRoot.appendChild(this.shapesRoot),this.annotationsRoot.appendChild(this.commentsRoot),n.appendChild(this.annotationsRoot)),n.removeChild(this.annotationsRoot);const l=this.arrowsRoot,u=this.annotationsRoot,h=this.commentsRoot,g=this.shapesRoot,f=this.store.getState(),p=this.getViewportBounds(),y=new Set(Object.keys(i));this.removeFeatures(y);const _=new Set;for(let x of Object.values(i)){if(a[x.id]&&(x={...x,...a[x.id]}),!this.isExporting&&!this.isFeatureVisible(x,p))continue;_.add(x.id);let v=this.features.get(x.id);qn(x)?v=ck(g,x,v,f):Xs(x)?v=Ek(g,x,v,f):bn(x)?v=T8(h,x,v,f,this.visibleFeatures.has(x.id)):kr(x)?v=N8(g,x,v,f):vi(x)&&(v=TX(l,x,f.options.minArrowHeight,f.options.maxArrowHeight,v,f)),v&&this.features.set(x.id,v)}this.applyStateClasses(u,r,o),n.appendChild(u),this.visibleFeatures.clear(),this.visibleFeatures=_}),Wt(this,"throttleRender",ik(()=>this.render(this.layer.element),8)),Wt(this,"refresh",()=>{this.layer.refresh()}),Wt(this,"onExportStart",()=>{this.isExporting=!0}),Wt(this,"onExportEnd",()=>{this.isExporting=!1}),e.events.on("viewExportStart",this.onExportStart),e.events.on("afterImageExport",this.onExportEnd),this.layer=this.ogma.layers.addSVGLayer({draw:this.render},G0.SHAPES),this.store.subscribe(n=>({features:n.features,liveUpdates:n.liveUpdates,hoveredFeature:n.hoveredFeature,selectedFeatures:n.selectedFeatures,rotation:n.rotation,zoom:n.zoom}),this.throttleRender,{equalityFn:(n,i)=>n.features===i.features&&n.liveUpdates===i.liveUpdates&&n.hoveredFeature===i.hoveredFeature&&n.selectedFeatures===i.selectedFeatures&&n.rotation===i.rotation&&n.zoom===i.zoom})}getViewportBounds(){const e=this.ogma,{width:s,height:n}=e.view.getSize(),i=1.5,r=e.view.screenToGraphCoordinates({x:0,y:0}),o=e.view.screenToGraphCoordinates({x:s*i,y:0}),a=e.view.screenToGraphCoordinates({x:0,y:n*i}),l=e.view.screenToGraphCoordinates({x:s*i,y:n*i});return[Math.min(r.x,o.x,a.x,l.x),Math.min(r.y,o.y,a.y,l.y),Math.max(r.x,o.x,a.x,l.x),Math.max(r.y,o.y,a.y,l.y)]}isFeatureVisible(e,s){const n=e.geometry.bbox;if(!n)return!0;const[i,r,o,a]=n;return!(o<s[0]||i>s[2]||a<s[1]||r>s[3])}getDefs(){const e=As("defs");e.appendChild(S8());const s=As("filter");s.setAttribute("id","softShadow"),s.setAttribute("x","-50%"),s.setAttribute("y","-50%"),s.setAttribute("width","200%"),s.setAttribute("height","200%");const n=As("feGaussianBlur");n.setAttribute("in","SourceAlpha"),n.setAttribute("stdDeviation","2"),n.setAttribute("result","blur");const i=As("feOffset");i.setAttribute("in","blur"),i.setAttribute("dx","0"),i.setAttribute("dy","1"),i.setAttribute("result","offsetBlur");const r=As("feComponentTransfer");r.setAttribute("in","offsetBlur"),r.setAttribute("result","shadow");const o=As("feFuncA");o.setAttribute("type","linear"),o.setAttribute("slope","0.25"),r.appendChild(o);const a=As("feMerge"),l=As("feMergeNode");l.setAttribute("in","shadow");const u=As("feMergeNode");return u.setAttribute("in","SourceGraphic"),a.appendChild(l),a.appendChild(u),s.appendChild(n),s.appendChild(i),s.appendChild(r),s.appendChild(a),e.appendChild(s),e}removeFeatures(e){for(const s of this.features.keys())if(!e.has(s)){const n=this.features.get(s);n&&n.parentNode&&n.parentNode.removeChild(n),this.features.delete(s)}}applyStateClasses(e,s,n){if(s!==null){const i=e.querySelector(`[data-annotation="${s}"]`);i&&i.classList.add("annotation-hovered")}n.forEach(i=>{const r=e.querySelector(`[data-annotation="${i}"]`);r&&r.classList.add("annotation-selected")})}destroy(){this.features.clear(),this.layer.destroy(),this.ogma.events.off(this.onExportStart),this.ogma.events.off(this.onExportEnd),super.destroy()}}const Ww=t=>{let e;const s=new Set,n=(a,l)=>{const u=typeof a=="function"?a(e):a;if(!Object.is(u,e)){const h=e;e=l??(typeof u!="object"||u===null)?u:Object.assign({},e,u),s.forEach(g=>g(e,h))}},i=()=>e,r={setState:n,getState:i,getInitialState:()=>o,subscribe:a=>(s.add(a),()=>s.delete(a))},o=e=t(n,i,r);return r},Sk=t=>t?Ww(t):Ww;var Xw=(t,e,s)=>(n,i)=>({pastStates:(s==null?void 0:s.pastStates)||[],futureStates:(s==null?void 0:s.futureStates)||[],undo:(r=1)=>{var o,a;if(i().pastStates.length){const l=((o=s==null?void 0:s.partialize)==null?void 0:o.call(s,e()))||e(),u=i().pastStates.splice(-r,r),h=u.shift();t(h),n({pastStates:i().pastStates,futureStates:i().futureStates.concat(((a=s==null?void 0:s.diff)==null?void 0:a.call(s,l,h))||l,u.reverse())})}},redo:(r=1)=>{var o,a;if(i().futureStates.length){const l=((o=s==null?void 0:s.partialize)==null?void 0:o.call(s,e()))||e(),u=i().futureStates.splice(-r,r),h=u.shift();t(h),n({pastStates:i().pastStates.concat(((a=s==null?void 0:s.diff)==null?void 0:a.call(s,l,h))||l,u.reverse()),futureStates:i().futureStates})}},clear:()=>n({pastStates:[],futureStates:[]}),isTracking:!0,pause:()=>n({isTracking:!1}),resume:()=>n({isTracking:!0}),setOnSave:r=>n({_onSave:r}),_onSave:s==null?void 0:s.onSave,_handleSet:(r,o,a,l)=>{var u,h;s!=null&&s.limit&&i().pastStates.length>=(s==null?void 0:s.limit)&&i().pastStates.shift(),(h=(u=i())._onSave)==null||h.call(u,r,a),n({pastStates:i().pastStates.concat(l||r),futureStates:[]})}}),k8=(t,e)=>(s,n,i)=>{var r,o;i.temporal=Sk(((r=e==null?void 0:e.wrapTemporal)==null?void 0:r.call(e,Xw(s,n,e)))||Xw(s,n,e));const a=((o=e==null?void 0:e.handleSet)==null?void 0:o.call(e,i.temporal.getState()._handleSet))||i.temporal.getState()._handleSet,l=h=>{var g,f,p;if(!i.temporal.getState().isTracking)return;const y=((g=e==null?void 0:e.partialize)==null?void 0:g.call(e,n()))||n(),_=(f=e==null?void 0:e.diff)==null?void 0:f.call(e,h,y);_===null||(p=e==null?void 0:e.equality)!=null&&p.call(e,h,y)||a(h,void 0,y,_)},u=i.setState;return i.setState=(...h)=>{var g;const f=((g=e==null?void 0:e.partialize)==null?void 0:g.call(e,n()))||n();u(...h),l(f)},t((...h)=>{var g;const f=((g=e==null?void 0:e.partialize)==null?void 0:g.call(e,n()))||n();s(...h),l(f)},n,i)};const I8=t=>(e,s,n)=>{const i=n.subscribe;return n.subscribe=(r,o,a)=>{let l=r;if(o){const u=(a==null?void 0:a.equalityFn)||Object.is;let h=r(n.getState());l=g=>{const f=r(g);if(!u(h,f)){const p=h;o(h=f,p)}},a!=null&&a.fireImmediately&&o(h,h)}return i(l)},t(e,s,n)},R8=I8,F8=[0,0,0,0];function P8(t,e){const s=Object.keys(t.features),n=Object.keys(e.features);if(s.length!==n.length)return!1;for(const i of s)if(!(i in e.features))return!1;for(const i of s){const r=t.features[i],o=e.features[i],a=r.geometry,l=o.geometry;if(a.coordinates!==l.coordinates||r.properties!==o.properties||r.properties.style!==o.properties.style||a!==l)return!1}return t.drawingFeature===e.drawingFeature}const z8=t=>{const e=Sk()(R8(k8((s,n)=>({features:{},liveUpdates:{},isDragging:!1,hoveringHandle:!1,hoveredHandle:-1,hoveredFeature:null,selectedFeatures:new Set,lastChangedFeatures:[],drawingFeature:null,drawingPoints:null,mousePressed:!1,mousePressPoint:null,rotation:0,sin:0,cos:1,revRotation:0,revSin:0,revCos:1,zoom:1,invZoom:1,options:{showSendButton:(t==null?void 0:t.showSendButton)??!0,sendButtonIcon:(t==null?void 0:t.sendButtonIcon)??QM,minArrowHeight:(t==null?void 0:t.minArrowHeight)??20,maxArrowHeight:(t==null?void 0:t.maxArrowHeight)??30,detectMargin:(t==null?void 0:t.detectMargin)??2,magnetRadius:(t==null?void 0:t.magnetRadius)??10,magnetHandleRadius:(t==null?void 0:t.magnetHandleRadius)??5,textPlaceholder:(t==null?void 0:t.textPlaceholder)??"Type here"},setOptions:i=>s(r=>({options:{...r.options,...i}})),removeFeature:i=>s(r=>{var o,a,l,u;const h=r.features[i];if(!h)return r;const{features:g,liveUpdates:f}=r,p=new Set([i]);if((bn(h)||Xs(h))&&Object.values(g).forEach(x=>{var v,b,S,A;vi(x)&&(((b=(v=x.properties.link)==null?void 0:v.end)==null?void 0:b.id)===i||((A=(S=x.properties.link)==null?void 0:S.start)==null?void 0:A.id)===i)&&p.add(x.id)}),vi(h)){const x=((a=(o=h.properties.link)==null?void 0:o.end)==null?void 0:a.type)==="comment"?h.properties.link.end.id:((u=(l=h.properties.link)==null?void 0:l.start)==null?void 0:u.type)==="comment"?h.properties.link.start.id:null;if(x){let v=0;if(Object.values(r.features).forEach(b=>{var S,A,w,L;vi(b)&&b.id!==i&&(((A=(S=b.properties.link)==null?void 0:S.end)==null?void 0:A.id)===x||((L=(w=b.properties.link)==null?void 0:w.start)==null?void 0:L.id)===x)&&v++}),v===0)return console.error("Cannot delete last arrow attached to comment. Delete the comment instead."),r}}const y={...g},_={...f};return p.forEach(x=>{delete y[x],delete _[x]}),{features:y,liveUpdates:_}}),addFeature:i=>s(r=>({features:{...r.features,[i.id]:i}})),startLiveUpdate:i=>{s(r=>({liveUpdates:i.reduce((o,a)=>({...o,[a]:{...r.features[a]}}),{})}))},applyLiveUpdate:(i,r)=>{s(o=>({liveUpdates:{...o.liveUpdates,[i]:{...o.liveUpdates[i],...r}}}))},applyLiveUpdates:i=>{s(r=>{const o=r.liveUpdates;for(const a in i)o[a]=i[a];return{liveUpdates:o}})},commitLiveUpdates:i=>{const{features:r,liveUpdates:o}=n(),a={...r},l=[],u=Object.keys(o);i||(i=new Set(u)),u.forEach(h=>{const g=o[h];a[h]&&Object.keys(g).length>0&&(a[h]={...a[h],...g},l.push(h))}),s({features:a,liveUpdates:{},isDragging:!1,lastChangedFeatures:l})},cancelLiveUpdates:()=>s({liveUpdates:{},isDragging:!1}),updateFeature:(i,r)=>s(o=>{const a={...o.features[i],...r},l={...o.liveUpdates};return delete l[i],{features:{...o.features,[i]:a},liveUpdates:l}}),updateFeatures:i=>s(r=>{const o={...r.features};return Object.entries(i).forEach(([a,l])=>{o[a]&&(o[a]={...o[a],...l})}),{features:o}}),batchUpdate:i=>{const r=e.temporal.getState();r.pause(),i(),r.resume()},getFeature:i=>n().features[i],getMergedFeature:i=>{const r=n().features[i],o=n().liveUpdates[i];if(r)return o?{...r,...o}:r},getAllFeatures:()=>{const{features:i,liveUpdates:r}=n();return Object.entries(i).map(([o,a])=>{const l=r[o];return l?{...a,...l}:a})},setHoveredFeature:i=>s({hoveredFeature:i}),setSelectedFeatures:i=>s({selectedFeatures:new Set(i)}),addToSelection:i=>{const{selectedFeatures:r}=n(),o=new Set(r);o.add(i),s({selectedFeatures:o})},removeFromSelection:i=>{const{selectedFeatures:r}=n(),o=new Set(r);o.delete(i),s({selectedFeatures:o})},toggleSelection:i=>{const{selectedFeatures:r}=n(),o=new Set(r);o.has(i)?o.delete(i):o.add(i),s({selectedFeatures:o})},clearSelection:()=>s({selectedFeatures:new Set}),isHovered:i=>n().hoveredFeature===i,isSelected:i=>n().selectedFeatures.has(i),setRotation:i=>{s({rotation:i,sin:Math.sin(i),cos:Math.cos(i),revRotation:-i,revSin:Math.sin(-i),revCos:Math.cos(-i)})},setZoom:i=>{s({zoom:i,invZoom:1/i})},getScreenAlignedTransform(i,r,o=!0){const a=this.revSin,l=this.revCos,u=i*l-r*a,h=i*a+r*l,g=o?1:this.invZoom;return`matrix(${g}, 0, 0, ${g}, ${u}, ${h})`},getRotationTransform(i,r){const o=this.revSin,a=this.revCos,l=i*a-r*o,u=i*o+r*a;return`matrix(${a}, ${o}, ${-o}, ${a}, ${-l}, ${-u})`},getRotatedBBox(i,r,o,a){return kW(i,r,o-i,a-r,this.sin,this.cos,i+(o-i)/2,r+(a-r)/2,F8)},setDrawingPoints:i=>s({drawingPoints:i})}),{limit:250,partialize:s=>({drawingFeature:s.drawingFeature,isDragging:s.isDragging,features:s.features,lastChangedFeatures:s.lastChangedFeatures}),equality:P8,handleSet:s=>n=>{n.drawingFeature===null&&s(n)}})));return e},D8={detectMargin:2,magnetHandleRadius:5,magnetRadius:10,textPlaceholder:"Type here",showSendButton:!0,sendButtonIcon:QM,minArrowHeight:20,maxArrowHeight:30};class O8 extends uW{constructor(e,s={}){super(),Wt(this,"ogma"),Wt(this,"store"),Wt(this,"renderers",{}),Wt(this,"interactions"),Wt(this,"editor"),Wt(this,"links"),Wt(this,"index"),Wt(this,"drawing"),Wt(this,"selectionManager"),Wt(this,"historyManager"),Wt(this,"updateManager"),Wt(this,"commentManager"),Wt(this,"onRotate",()=>this.store.getState().setRotation(this.ogma.view.getAngle())),Wt(this,"onZoom",()=>{const i=this.ogma.view.getZoom();this.store.getState().setZoom(i),this.commentManager.updateCommentModesForZoom(i)}),Wt(this,"onLayout",()=>{this.links.update()}),this.ogma=e;const n={...D8,...s};this.store=z8(n),this.index=new vX(this.store),this.links=new hX(this.ogma,this.store,(i,r)=>{this.emit(dW,{arrow:i,link:r})}),this.interactions=new cX(this.ogma,this.store,this.index),this.editor=new lX(this.ogma,this.store,this.index,this.links,this.interactions),this.drawing=new DW(this.ogma,this.store,this.editor,this.interactions,this.links,this,this.index),this.selectionManager=new BW(this.store),this.historyManager=new OW(this.store,this.links),this.updateManager=new UW(this.store),this.commentManager=new FW(this.store),this.initializeRenderers(),this.setupEvents()}initializeRenderers(){this.renderers.shapes=new M8(this.ogma,this.store),this.renderers.handles=new EX(this.ogma,this.store)}setupEvents(){this.ogma.events.on("rotate",this.onRotate).on("zoom",this.onZoom).on("layoutEnd",this.onLayout),this.editor.addEventListener(gh,()=>this.emit(gh)),this.editor.addEventListener(xx,()=>this.emit(xx)),this.interactions.addEventListener(vx,()=>this.emit(vx)),this.store.temporal.subscribe(e=>{this.emit(WM,{canUndo:e.pastStates.length>0,canRedo:e.futureStates.length>0})}),this.store.subscribe(e=>e.selectedFeatures,(e,s)=>{const n=Array.from(e).filter(i=>!(s!=null&&s.has(i)));if(n.length>0&&this.emit(HM,{ids:n}),s){const i=Array.from(s).filter(r=>!e.has(r));i.length>0&&this.emit($M,{ids:i})}}),this.store.subscribe(e=>e.drawingFeature,(e,s)=>{e===null&&s!==null&&this.emit(Ff,{id:s})}),this.store.subscribe(e=>e.features,(e,s)=>{if(s){for(const n of Object.keys(e))s[n]?s[n]!==e[n]&&this.emit(YM,e[n]):this.emit(Rf,{id:n});for(const n of Object.keys(s))e[n]||this.emit(qM,{id:n})}})}setOptions(e={}){return this.store.getState().setOptions(e),this.store.getState().options}add(e){return this.updateManager.add(e),this}remove(e){return this.updateManager.remove(e),this}undo(){return this.historyManager.undo()}redo(){return this.historyManager.redo()}canUndo(){return this.historyManager.canUndo()}canRedo(){return this.historyManager.canRedo()}clearHistory(){this.historyManager.clearHistory()}getAnnotations(){return this.updateManager.getAnnotations()}select(e){return this.selectionManager.select(e),this}unselect(e){return this.selectionManager.unselect(e),this}cancelDrawing(){var e;return this.drawing.cancelPendingDrawing(),(e=this.editor.getActiveHandler())==null||e.cancelDrawing(),this.emit(bx),this}enableArrowDrawing(e){return this.drawing.enableArrowDrawing(e),this}enableTextDrawing(e){return this.drawing.enableTextDrawing(e),this}enableBoxDrawing(e){return this.drawing.enableBoxDrawing(e),this}enablePolygonDrawing(e){return this.drawing.enablePolygonDrawing(e),this}enableCommentDrawing(e={}){return this.drawing.enableCommentDrawing(e),this}startComment(e,s,n,i){return this.drawing.startComment(e,s,n,i),this}startBox(e,s,n){return this.drawing.startBox(e,s,n),this}startArrow(e,s,n){return this.drawing.startArrow(e,s,n),this}startText(e,s,n){return this.drawing.startText(e,s,n),this}startPolygon(e,s,n){return this.drawing.startPolygon(e,s,n),this}getSelectedAnnotations(){return this.selectionManager.getSelectedAnnotations()}getSelected(){return this.selectionManager.getSelected()}getAnnotation(e){return this.updateManager.getAnnotation(e)}setScale(e,s,n,i){return this.updateManager.setScale(e,s,n,i),this}toggleComment(e){return this.commentManager.toggleComment(e),this}destroy(){this.ogma.events.off(this.onRotate).off(this.onZoom),this.links.destroy(),Object.values(this.renderers).forEach(e=>e.destroy()),this.interactions.destroy(),this.editor.destroy()}updateStyle(e,s){return this.updateManager.updateStyle(e,s),this}update(e){return this.updateManager.update(e),this}link(e,s,n=Fa){const i=this.getAnnotation(e);if(!i)throw new Error(`Arrow with id ${e} not found`);return this.editor.getArrowHandler().link(i,s,n),this}isDrawing(){return this.drawing.isDrawing()}}const bu=(t,e=0,s=1)=>t>s?s:t<e?e:t,oi=(t,e=0,s=Math.pow(10,e))=>Math.round(s*t)/s,Ak=({h:t,s:e,v:s,a:n})=>{const i=(200-e)*s/100;return{h:oi(t),s:oi(i>0&&i<200?e*s/100/(i<=100?i:200-i)*100:0),l:oi(i/2),a:oi(n,2)}},Cx=t=>{const{h:e,s,l:n}=Ak(t);return`hsl(${e}, ${s}%, ${n}%)`},$_=t=>{const{h:e,s,l:n,a:i}=Ak(t);return`hsla(${e}, ${s}%, ${n}%, ${i})`},B8=({h:t,s:e,v:s,a:n})=>{t=t/360*6,e=e/100,s=s/100;const i=Math.floor(t),r=s*(1-e),o=s*(1-(t-i)*e),a=s*(1-(1-t+i)*e),l=i%6;return{r:oi([s,o,r,r,a,s][l]*255),g:oi([a,s,s,o,r,r][l]*255),b:oi([r,r,a,s,s,o][l]*255),a:oi(n,2)}},U8=({r:t,g:e,b:s,a:n})=>{const i=Math.max(t,e,s),r=i-Math.min(t,e,s),o=r?i===t?(e-s)/r:i===e?2+(s-t)/r:4+(t-e)/r:0;return{h:oi(60*(o<0?o+6:o)),s:oi(i?r/i*100:0),v:oi(i/255*100),a:n}},wk=(t,e)=>{if(t===e)return!0;for(const s in t)if(t[s]!==e[s])return!1;return!0},Zw={},Tk=t=>{let e=Zw[t];return e||(e=document.createElement("template"),e.innerHTML=t,Zw[t]=e),e},j0=(t,e,s)=>{t.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:s}))};let ou=!1;const Lx=t=>"touches"in t,G8=t=>ou&&!Lx(t)?!1:(ou||(ou=Lx(t)),!0),Kw=(t,e)=>{const s=Lx(e)?e.touches[0]:e,n=t.el.getBoundingClientRect();j0(t.el,"move",t.getMove({x:bu((s.pageX-(n.left+window.pageXOffset))/n.width),y:bu((s.pageY-(n.top+window.pageYOffset))/n.height)}))},V8=(t,e)=>{const s=e.keyCode;s>40||t.xy&&s<37||s<33||(e.preventDefault(),j0(t.el,"move",t.getMove({x:s===39?.01:s===37?-.01:s===34?.05:s===33?-.05:s===35?1:s===36?-1:0,y:s===40?.01:s===38?-.01:0},!0)))};class H0{constructor(e,s,n,i){const r=Tk(`<div role="slider" tabindex="0" part="${s}" ${n}><div part="${s}-pointer"></div></div>`);e.appendChild(r.content.cloneNode(!0));const o=e.querySelector(`[part=${s}]`);o.addEventListener("mousedown",this),o.addEventListener("touchstart",this),o.addEventListener("keydown",this),this.el=o,this.xy=i,this.nodes=[o.firstChild,o]}set dragging(e){const s=e?document.addEventListener:document.removeEventListener;s(ou?"touchmove":"mousemove",this),s(ou?"touchend":"mouseup",this)}handleEvent(e){switch(e.type){case"mousedown":case"touchstart":if(e.preventDefault(),!G8(e)||!ou&&e.button!=0)return;this.el.focus(),Kw(this,e),this.dragging=!0;break;case"mousemove":case"touchmove":e.preventDefault(),Kw(this,e);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":V8(this,e);break}}style(e){e.forEach((s,n)=>{for(const i in s)this.nodes[n].style.setProperty(i,s[i])})}}class j8 extends H0{constructor(e){super(e,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:e}){this.h=e,this.style([{left:`${e/360*100}%`,color:Cx({h:e,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${oi(e)}`)}getMove(e,s){return{h:s?bu(this.h+e.x*360,0,360):360*e.x}}}class H8 extends H0{constructor(e){super(e,"saturation",'aria-label="Color"',!0)}update(e){this.hsva=e,this.style([{top:`${100-e.v}%`,left:`${e.s}%`,color:Cx(e)},{"background-color":Cx({h:e.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${oi(e.s)}%, Brightness ${oi(e.v)}%`)}getMove(e,s){return{s:s?bu(this.hsva.s+e.x*100,0,100):e.x*100,v:s?bu(this.hsva.v-e.y*100,0,100):Math.round(100-e.y*100)}}}const $8=':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',q8="[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}",Y8="[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}",zg=Symbol("same"),q_=Symbol("color"),Qw=Symbol("hsva"),Y_=Symbol("update"),Jw=Symbol("parts"),Df=Symbol("css"),Of=Symbol("sliders");class W8 extends HTMLElement{static get observedAttributes(){return["color"]}get[Df](){return[$8,q8,Y8]}get[Of](){return[H8,j8]}get color(){return this[q_]}set color(e){if(!this[zg](e)){const s=this.colorModel.toHsva(e);this[Y_](s),this[q_]=e}}constructor(){super();const e=Tk(`<style>${this[Df].join("")}</style>`),s=this.attachShadow({mode:"open"});s.appendChild(e.content.cloneNode(!0)),s.addEventListener("move",this),this[Jw]=this[Of].map(n=>new n(s))}connectedCallback(){if(this.hasOwnProperty("color")){const e=this.color;delete this.color,this.color=e}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(e,s,n){const i=this.colorModel.fromAttr(n);this[zg](i)||(this.color=i)}handleEvent(e){const s=this[Qw],n={...s,...e.detail};this[Y_](n);let i;!wk(n,s)&&!this[zg](i=this.colorModel.fromHsva(n))&&(this[q_]=i,j0(this,"color-changed",{value:i}))}[zg](e){return this.color&&this.colorModel.equal(e,this.color)}[Y_](e){this[Qw]=e,this[Jw].forEach(s=>s.update(e))}}class X8 extends H0{constructor(e){super(e,"alpha",'aria-label="Alpha" aria-valuemin="0" aria-valuemax="1"',!1)}update(e){this.hsva=e;const s=$_({...e,a:0}),n=$_({...e,a:1}),i=e.a*100;this.style([{left:`${i}%`,color:$_(e)},{"--gradient":`linear-gradient(90deg, ${s}, ${n}`}]);const r=oi(i);this.el.setAttribute("aria-valuenow",`${r}`),this.el.setAttribute("aria-valuetext",`${r}%`)}getMove(e,s){return{a:s?bu(this.hsva.a+e.x):e.x}}}const Z8=`[part=alpha]{flex:0 0 24px}[part=alpha]::after{display:block;content:"";position:absolute;top:0;left:0;right:0;bottom:0;border-radius:inherit;background-image:var(--gradient);box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part^=alpha]{background-color:#fff;background-image:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><rect x="8" width="8" height="8"/><rect y="8" width="8" height="8"/></svg>')}[part=alpha-pointer]{top:50%}`;class K8 extends W8{get[Df](){return[...super[Df],Z8]}get[Of](){return[...super[Of],X8]}}const Q8={defaultColor:{r:0,g:0,b:0,a:1},toHsva:U8,fromHsva:B8,equal:wk,fromAttr:t=>JSON.parse(t)};class J8 extends K8{get colorModel(){return Q8}}class Ck extends J8{}customElements.define("rgba-color-picker",Ck);const tT=[8,10,12,14,16,24,32,48,64,72],eT="none",Lk="#333333";["Roboto","Helvetica Neue","Helvetica","Arial","sans-serif","Georgia, serif","Menlo","Monaco","Consolas","Courier New","monospace"].sort((t,e)=>t.toLocaleLowerCase().localeCompare(e.toLocaleLowerCase()));const Nk={head:"arrow",strokeColor:Lk,strokeWidth:5},t9=.25,Mk={font:"Roboto",fontSize:tT[2],padding:tT[2]*t9,color:Lk,strokeType:eT,background:eT},kk=jt.createContext(void 0),fr=()=>jt.useContext(kk);function e9(t){return t.reduce((e,s)=>e+s,0)/t.length}const s9=({children:t,annotations:e})=>{const s=ln(),[n,i]=jt.useState(e||{type:"FeatureCollection",features:[]}),[r,o]=jt.useState(null),[a,l]=jt.useState(Nk),[u,h]=jt.useState(Mk),[g,f]=jt.useState(),[p,y]=jt.useState(1),[_,x]=jt.useState(1),[v,b]=jt.useState(!1),[S,A]=jt.useState(!1);return jt.useEffect(()=>{if(!s)return;const w=new O8(s,{minArrowHeight:1}),L=e9(s.getNodes().getAttribute("radius"))/5,M=p;return l({...a,strokeWidth:(a.strokeWidth||1)*M}),y(M),x(L),w.on(HM,()=>{w.getSelectedAnnotations().features.forEach(F=>{F&&(vi(F)?l({...F.properties.style||{}}):Xs(F)&&h({...F.properties.style||{}}),o(F))})}).on($M,()=>{o(null)}).on(Rf,()=>{i(w.getAnnotations())}).on(qM,()=>{i(w.getAnnotations())}).on(YM,()=>{i(w.getAnnotations())}).on(WM,()=>{b(w.canUndo()),A(w.canRedo())}),f(w),e&&(w.add(e),w.clearHistory()),()=>{w.destroy()}},[s]),jt.useEffect(()=>{g&&r&&(r==null?void 0:r.properties.type)==="arrow"&&g.updateStyle(r.id,a)},[g,a,r]),jt.useEffect(()=>{g&&r&&(r==null?void 0:r.properties.type)==="text"&&g.updateStyle(r.id,u)},[g,u,r]),zt.jsx(kk.Provider,{value:{annotations:n,currentAnnotation:r,setCurrentAnnotation:o,textStyle:u,setTextStyle:h,arrowStyle:a,setArrowStyle:l,arrowWidthFactor:p,setArrowWidthFactor:y,textSizeFactor:_,setTextSizeFactor:x,editor:g,setEditor:f,canUndo:v,canRedo:S,undo:()=>(g==null?void 0:g.undo())||!1,redo:()=>(g==null?void 0:g.redo())||!1,clearHistory:()=>g==null?void 0:g.clearHistory(),add:w=>g==null?void 0:g.add(w),remove:w=>g==null?void 0:g.remove(w),cancelDrawing:()=>g==null?void 0:g.cancelDrawing(),select:w=>g==null?void 0:g.select(w),enableBoxDrawing:w=>g==null?void 0:g.enableBoxDrawing(w),enablePolygonDrawing:w=>g==null?void 0:g.enablePolygonDrawing(w),enableCommentDrawing:w=>g==null?void 0:g.enableCommentDrawing(w)},children:t})},W_=({annotation:t,mode:e,initialColor:s})=>{const{editor:n}=fr(),[i,r]=jt.useState(s),[o,a]=jt.useState(["#0099FF","#FF7523","#44AA99"]),[l,u]=jt.useState(0),[h,g]=jt.useState(!1),f=jt.useRef(null),p=jt.useRef(null),y=jt.useCallback(v=>{t&&(e==="arrow"?n==null||n.updateStyle(t.id,{strokeColor:v}):e==="text"?n==null||n.updateStyle(t.id,{color:v}):e==="polygon"&&(n==null||n.updateStyle(t.id,{strokeColor:v})))},[t,n,e]),_=jt.useCallback(v=>{if(o.includes(v))u(o.indexOf(v));else{const b=[v,...o.slice(0,2)];a(b),u(0)}r(v)},[o]);jt.useEffect(()=>{const v=b=>{if(h&&f.current&&!f.current.contains(b.target)){const S=document.querySelectorAll(".color-circle");Array.from(S).some(w=>w.contains(b.target))||g(!1)}};return document.addEventListener("click",v),()=>document.removeEventListener("click",v)},[h]),jt.useEffect(()=>{h&&f.current&&!p.current&&(p.current=new Ck,p.current.color=SW(i),f.current.appendChild(p.current),p.current.addEventListener("color-changed",v=>{const b=n9(v.detail.value);r(b);const S=[...o];S[l]=b,a(S),y(b)})),!h&&p.current&&f.current&&(f.current.innerHTML="",p.current=null)},[h,i,l,o,y,_]),jt.useEffect(()=>{_(s)},[s,_]);const x=(v,b)=>{b.stopPropagation(),b.preventDefault();const S=l===v&&h;u(v),r(o[v]),S?g(!1):h?(g(!1),setTimeout(()=>g(!0),50)):(y(o[v]),g(!0))};return zt.jsxs(zt.Fragment,{children:[zt.jsx("div",{className:"section-header",children:zt.jsx("h3",{children:"Color"})}),zt.jsx("div",{className:"color-selector",children:o.map((v,b)=>zt.jsx("button",{className:`color-circle ${b===l?"color-circle-primary":""}`,style:{"--circle-color":v},onClick:S=>x(b,S),children:zt.jsx("div",{className:"color-inner"})},b))}),h&&zt.jsx("div",{className:"color-picker-overlay",ref:f,style:{position:"fixed",right:"240px",top:"50%",transform:"translateY(-50%)",zIndex:1e4}})]})};function n9(t){return`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`}const i9=[{value:"#f5f5f5",style:"--circle-color: #f5f5f5;"},{value:"#EDE6FF",style:"--circle-color: #EDE6FF;"},{value:"transparent",style:"--circle-color: white; border: 2px dashed #ccc;"}],sT=({annotation:t,currentBackground:e})=>{const{editor:s}=fr(),n=i=>{t&&(s==null||s.updateStyle(t.id,{background:i}))};return zt.jsxs(zt.Fragment,{children:[zt.jsx("div",{className:"section-header",children:zt.jsx("h3",{children:"Background"})}),zt.jsx("div",{className:"color-selector",children:i9.map(({value:i,style:r})=>{const o={};if(r.includes("--circle-color:")){const a=r.split(":")[1].replace(";","").trim();o["--circle-color"]=a}if(r.includes("border:")){const a=r.split("border:")[1].replace(";","").trim();o.border=a}return zt.jsx("button",{className:`color-circle ${i===e?"color-circle-primary":""}`,onClick:()=>n(i),children:zt.jsx("div",{className:"color-inner",style:o})},i)})})]})},X_=[{value:"sans-serif",label:"Sans Serif",icon:"icon-type"},{value:"serif",label:"Serif",icon:"icon-italic"},{value:"monospace",label:"Monospace",icon:"icon-code"}],r9=({annotation:t,currentFont:e})=>{const{editor:s}=fr(),[n,i]=jt.useState(!1),r=a=>{t&&(s==null||s.updateStyle(t.id,{font:a})),i(!1)},o=X_.find(a=>a.value===e)||X_[0];return zt.jsxs(zt.Fragment,{children:[zt.jsx("div",{className:"section-header",children:zt.jsx("h3",{children:"Font"})}),zt.jsx("div",{className:"custom-select-section",children:zt.jsxs("div",{className:`custom-select ${n?"open":""}`,children:[zt.jsxs("div",{className:"custom-select-trigger",onClick:()=>i(!n),children:[zt.jsx("i",{className:o.icon}),zt.jsx("span",{children:o.label}),zt.jsx("i",{className:"icon-chevron-down custom-select-arrow"})]}),zt.jsx("div",{className:"custom-select-options",children:X_.map(a=>zt.jsxs("div",{className:`custom-select-option ${a.value===e?"selected":""}`,title:a.label,onClick:()=>r(a.value),children:[zt.jsx("i",{className:a.icon}),zt.jsx("span",{children:a.label})]},a.value))})]})})]})},o9=[{value:"none",label:"None",icon:"icon-x"},{value:"arrow",label:"Open Arrow",icon:"icon-arrow-left"},{value:"arrow-plain",label:"Filled Arrow",icon:"icon-play"},{value:"halo-dot",label:"Halo Dot",icon:"icon-circle-dot"},{value:"dot",label:"Dot",icon:"icon-dot"}],a9=({annotation:t})=>{const{editor:e}=fr(),[s,n]=jt.useState(new Set),i=(a,l)=>{t&&(e==null||e.updateStyle(t.id,{[a]:l})),n(u=>{const h=new Set(u);return h.delete(a),h})},r=a=>{n(l=>{const u=new Set(l);return u.has(a)?u.delete(a):(u.clear(),u.add(a)),u})},o=a=>{var f;const l=((f=t.properties.style)==null?void 0:f[a])||"none",u=o9.map(p=>({...p,icon:p.value==="arrow"&&a==="tail"?"icon-arrow-left":p.value==="arrow"?"icon-arrow-right":p.icon,selected:p.value===l,rotate:p.value==="arrow-plain"&&a==="tail"})),h=u.find(p=>p.selected)||u[0],g=s.has(a);return zt.jsxs("div",{className:"extremity-wrapper",children:[zt.jsx("label",{children:a}),zt.jsxs("div",{className:`custom-select ${g?"open":""}`,children:[zt.jsxs("div",{className:"custom-select-trigger",onClick:()=>r(a),children:[zt.jsx("i",{className:h.icon,style:h.rotate?{transform:"rotate(180deg)"}:{}}),zt.jsx("span",{children:h.label}),zt.jsx("i",{className:"icon-chevron-down custom-select-arrow"})]}),zt.jsx("div",{className:"custom-select-options",children:u.map(p=>zt.jsxs("div",{className:`custom-select-option ${p.selected?"selected":""}`,title:p.label,onClick:()=>i(a,p.value),children:[zt.jsx("i",{className:p.icon,style:p.rotate?{transform:"rotate(180deg)"}:{}}),zt.jsx("span",{children:p.label})]},p.value))})]})]})};return zt.jsxs(zt.Fragment,{children:[zt.jsx("div",{className:"section-header",children:zt.jsx("h3",{children:"Extremities"})}),zt.jsxs("div",{className:"custom-select-section",children:[o("head"),o("tail")]})]})},Dg=({annotation:t,title:e,property:s,value:n,min:i,max:r,mode:o,currentColor:a})=>{const{editor:l}=fr(),[u,h]=rs.useState(n);rs.useEffect(()=>{h(n)},[n]);const g=f=>{t&&(s==="strokeWidth"?o==="text"&&a?l==null||l.updateStyle(t.id,{strokeWidth:f,strokeColor:a}):l==null||l.updateStyle(t.id,{strokeWidth:f}):s==="fontSize"&&(l==null||l.updateStyle(t.id,{fontSize:f})))};return zt.jsxs(zt.Fragment,{children:[zt.jsx("div",{className:"section-header",children:zt.jsx("h3",{children:e})}),zt.jsxs("div",{className:"slider-section",children:[zt.jsx("input",{type:"range",id:`${s}-slider`,className:"slider",min:i,max:r,value:u,onChange:f=>{const p=parseInt(f.target.value,10);h(p),g(p)}}),zt.jsx("div",{className:"slider-value",children:zt.jsx("span",{children:u})})]})]})},l9=[{value:"plain",icon:"icon-circle"},{value:"dashed",icon:"icon-circle-dashed"}],Z_=({annotation:t,currentLineType:e})=>{const{editor:s}=fr(),n=i=>{t&&(s==null||s.updateStyle(t.id,{strokeType:i}))};return zt.jsxs(zt.Fragment,{children:[zt.jsx("div",{className:"section-header",children:zt.jsx("h3",{children:"Line type"})}),zt.jsx("div",{className:"linetype-section",children:l9.map(({value:i,icon:r})=>zt.jsx("button",{className:`linetype-button ${e===i?"active":""}`,title:i,onClick:()=>n(i),children:zt.jsx("i",{className:r})},i))})]})},u9=({visible:t,annotation:e})=>{const[s,n]=jt.useState(null);jt.useEffect(()=>{e?vi(e)?n("arrow"):Xs(e)||qn(e)?n("text"):kr(e)&&n("polygon"):n(null)},[e]);const i=()=>{var u,h,g;return e?s==="arrow"?((u=e.properties.style)==null?void 0:u.strokeColor)||qa.strokeColor:s==="text"?((h=e.properties.style)==null?void 0:h.color)||rn.color:s==="polygon"?((g=e.properties.style)==null?void 0:g.strokeColor)||"#000000":"#0099FF":"#0099FF"},r=u=>{const h=u.properties.style||{},g=h.strokeWidth||qa.strokeWidth,f=h.strokeType||"plain",p=i();return zt.jsxs(zt.Fragment,{children:[zt.jsx(W_,{annotation:e,mode:"arrow",initialColor:p}),zt.jsx(a9,{annotation:u}),zt.jsx(Dg,{annotation:e,title:"Stroke width",property:"strokeWidth",value:g,min:1,max:20}),zt.jsx(Z_,{annotation:e,currentLineType:f})]})},o=u=>{const h=u.properties.style||{},g=typeof h.fontSize=="number"?h.fontSize:typeof rn.fontSize=="number"?rn.fontSize:18,f=h.strokeWidth||rn.strokeWidth,p=h.strokeType||"plain",y=h.background||rn.background,_=h.font||rn.font,x=i();return zt.jsxs(zt.Fragment,{children:[zt.jsx(W_,{annotation:e,mode:"text",initialColor:x}),zt.jsx(sT,{annotation:e,currentBackground:y}),zt.jsx(r9,{annotation:e,currentFont:_}),zt.jsx(Dg,{annotation:e,title:"Font size",property:"fontSize",value:g,min:8,max:72}),zt.jsx(Dg,{annotation:e,title:"Stroke width",property:"strokeWidth",value:f,min:1,max:20,mode:"text",currentColor:x}),zt.jsx(Z_,{annotation:e,currentLineType:p})]})},a=u=>{const h=u.properties.style||{},g=h.strokeWidth||2,f=h.strokeType||"plain",p=h.background||"transparent",y=i();return zt.jsxs(zt.Fragment,{children:[zt.jsx(W_,{annotation:e,mode:"polygon",initialColor:y}),zt.jsx(sT,{annotation:e,currentBackground:p}),zt.jsx(Dg,{annotation:e,title:"Stroke width",property:"strokeWidth",value:g,min:1,max:20}),zt.jsx(Z_,{annotation:e,currentLineType:f})]})},l=rs.useCallback(u=>{u.stopPropagation()},[]);return!t||!e?null:zt.jsx("div",{className:"annotation-panel",onClick:l,onMouseDown:l,onMouseMove:l,children:zt.jsxs("div",{className:"panel-body",children:[s==="arrow"&&vi(e)&&r(e),s==="text"&&(Xs(e)||qn(e)||bn(e))&&o(e),s==="polygon"&&kr(e)&&a(e)]})})},d9=()=>{const{editor:t}=fr(),[e,s]=jt.useState(null),[n,i]=jt.useState(null),[r,o]=jt.useState(!1);return jt.useEffect(()=>{if(!t)return;const a=f=>{if(f.ids.length===1){const p=t.getAnnotation(f.ids[0]);if(!p)return;i(p);const y=()=>{n&&(s(n),o(!0),i(null))};t.isDrawing()&&t.once("cancelDrawing",y).once("completeDrawing",y)}else i(null),o(!1)},l=()=>{n&&(s(n),o(!0),i(null))},u=()=>{n&&(s(n),o(!0),i(null))},h=()=>{i(null),o(!1)},g=()=>{o(!1),s(null)};return t.on("select",a).on("click",l).on("dragend",u).on("dragstart",h).on("unselect",g),()=>{t.off("select",a).off("click",l).off("dragend",u).off("dragstart",h).off("unselect",g)}},[t,n]),zt.jsx(u9,{visible:r,annotation:e})};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h9=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),c9=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,n)=>n?n.toUpperCase():s.toLowerCase()),nT=t=>{const e=c9(t);return e.charAt(0).toUpperCase()+e.slice(1)},Ik=(...t)=>t.filter((e,s,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===s).join(" ").trim(),g9=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var f9={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p9=jt.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:i="",children:r,iconNode:o,...a},l)=>jt.createElement("svg",{ref:l,...f9,width:e,height:e,stroke:t,strokeWidth:n?Number(s)*24/Number(e):s,className:Ik("lucide",i),...!r&&!g9(a)&&{"aria-hidden":"true"},...a},[...o.map(([u,h])=>jt.createElement(u,h)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ii=(t,e)=>{const s=jt.forwardRef(({className:n,...i},r)=>jt.createElement(p9,{ref:r,iconNode:e,className:Ik(`lucide-${h9(nT(t))}`,`lucide-${t}`,n),...i}));return s.displayName=nT(t),s};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m9=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],_9=Ii("arrow-right",m9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y9=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],x9=Ii("camera",y9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v9=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],b9=Ii("download",v9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E9=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],S9=Ii("message-square",E9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A9=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],w9=Ii("minimize",A9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T9=[["path",{d:"M10.83 2.38a2 2 0 0 1 2.34 0l8 5.74a2 2 0 0 1 .73 2.25l-3.04 9.26a2 2 0 0 1-1.9 1.37H7.04a2 2 0 0 1-1.9-1.37L2.1 10.37a2 2 0 0 1 .73-2.25z",key:"2hea0t"}]],C9=Ii("pentagon",T9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L9=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]],N9=Ii("rectangle-horizontal",L9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M9=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],k9=Ii("redo",M9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I9=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],R9=Ii("rotate-ccw",I9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F9=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],P9=Ii("rotate-cw",F9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z9=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],D9=Ii("trash",z9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O9=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],B9=Ii("type",O9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U9=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],G9=Ii("undo",U9),V9=({onSvgExport:t,onJsonExport:e})=>{const{editor:s,canUndo:n,canRedo:i,undo:r,redo:o,remove:a}=fr(),[l,u]=rs.useState(null);rs.useEffect(()=>{if(!s)return;const b=()=>{u(null)};return s.on(Ff,b),s.on(bx,b),()=>{s.off(Ff,b),s.off(bx,b)}},[s]);const h=rs.useCallback(()=>{s.enableArrowDrawing({strokeType:"plain",strokeColor:"#3A03CF",strokeWidth:2,head:"arrow"}),u("arrow")},[s]),g=rs.useCallback(()=>{s.enableTextDrawing({font:"IBM Plex Sans",fontSize:24,color:"#3A03CF",background:"#EDE6FF",borderRadius:8,padding:12}),u("text")},[s]),f=rs.useCallback(()=>{s.enableBoxDrawing({background:"#EDE6FF",borderRadius:8,padding:12}),u("box")},[s]),p=rs.useCallback(()=>{s.enablePolygonDrawing({strokeColor:"#3A03CF",strokeWidth:2,background:"rgba(58, 3, 207, 0.15)"}),u("polygon")},[s]),y=rs.useCallback(()=>{s.enableCommentDrawing({offsetX:200,offsetY:-150,commentStyle:{content:"",style:{color:"#3A03CF",background:"#EDE6FF",fontSize:16,font:"IBM Plex Sans"}},arrowStyle:{style:{strokeType:"plain",strokeColor:"#3A03CF",strokeWidth:2,head:"halo-dot"}}}),u("comment")},[s]),_=rs.useCallback(()=>{const b=s.getSelectedAnnotations();b.features.length>0&&a(b)},[s,a]),x=rs.useCallback(b=>{b.stopPropagation(),b.preventDefault()},[]),v=16;return zt.jsxs("div",{className:"add-menu",onClick:x,onMouseMove:x,children:[zt.jsx("button",{"data-tooltip":"Add arrow",onClick:h,className:l==="arrow"?"active":"",children:zt.jsx(_9,{width:v,height:v})}),zt.jsx("button",{"data-tooltip":"Add comment",onClick:y,className:l==="comment"?"active":"",children:zt.jsx(S9,{width:v,height:v})}),zt.jsx("button",{"data-tooltip":"Add box",onClick:f,className:l==="box"?"active":"",children:zt.jsx(N9,{width:v,height:v})}),zt.jsx("button",{"data-tooltip":"Add text",onClick:g,className:l==="text"?"active":"",children:zt.jsx(B9,{width:v,height:v})}),zt.jsx("button",{"data-tooltip":"Add polygon (click points, Esc to finish)",onClick:p,className:l==="polygon"?"active":"",children:zt.jsx(C9,{width:v,height:v})}),zt.jsx("span",{className:"separator"}),zt.jsx("button",{"data-tooltip":"Undo",onClick:()=>r(),disabled:!n,children:zt.jsx(G9,{width:v,height:v})}),zt.jsx("button",{"data-tooltip":"Redo",onClick:()=>o(),disabled:!i,children:zt.jsx(k9,{width:v,height:v})}),zt.jsx("span",{className:"separator"}),zt.jsx("button",{"data-tooltip":"Delete selected",onClick:_,children:zt.jsx(D9,{width:v,height:v})}),zt.jsx("span",{className:"separator"}),zt.jsx("button",{"data-tooltip":"Export annotations",onClick:e,children:zt.jsx(b9,{width:v,height:v})}),zt.jsx("button",{"data-tooltip":"Export SVG",onClick:t,children:zt.jsx(x9,{width:v,height:v})})]})},j9=({isOpen:t,jsonContent:e,onClose:s,onDownload:n})=>{const i=rs.useCallback(o=>{o.target===o.currentTarget&&s()},[s]),r=rs.useCallback(o=>{o.stopPropagation()},[]);return t?zt.jsx("div",{className:"popup-backdrop",onClick:i,children:zt.jsxs("div",{className:"popup-content",onWheel:r,children:[zt.jsxs("div",{className:"popup-header",children:[zt.jsx("h2",{children:"JSON Export Preview"}),zt.jsx("button",{className:"popup-close",onClick:s,children:""})]}),zt.jsx("div",{className:"popup-body",children:zt.jsx("div",{className:"json-preview",children:zt.jsx("pre",{children:zt.jsx("code",{children:e})})})}),zt.jsx("div",{className:"popup-footer",children:zt.jsx("button",{className:"popup-button",onClick:n,children:"Download JSON"})})]})}):null},H9=({isOpen:t,svgContent:e,onClose:s,onDownload:n})=>{const[i,r]=rs.useState("");rs.useEffect(()=>{if(e){const a=new Blob([e],{type:"image/svg+xml"}),l=URL.createObjectURL(a);return r(l),()=>{URL.revokeObjectURL(l)}}},[e]);const o=rs.useCallback(a=>{a.target===a.currentTarget&&s()},[s]);return t?zt.jsx("div",{className:"popup-backdrop",onClick:o,children:zt.jsxs("div",{className:"popup-content",children:[zt.jsxs("div",{className:"popup-header",children:[zt.jsx("h2",{children:"SVG Export Preview"}),zt.jsx("button",{className:"popup-close",onClick:s,children:""})]}),zt.jsx("div",{className:"popup-body",children:zt.jsx("div",{className:"svg-preview",children:i&&zt.jsx("img",{src:i,alt:"Graph Export"})})}),zt.jsx("div",{className:"popup-footer",children:zt.jsx("button",{className:"popup-button",onClick:n,children:"Download SVG"})})]})}):null},$9=()=>{const t=ln(),{annotations:e}=fr(),s=rs.useCallback(async()=>{const a=t.view.getGraphBoundingBox();await t.view.moveToBounds(a.extend(sk(e)),{duration:200})},[t,e]),n=rs.useCallback(async()=>{await t.view.rotate(-Math.PI/8,{duration:200})},[t]),i=rs.useCallback(async()=>{await t.view.rotate(Math.PI/8,{duration:200})},[t]),r=rs.useCallback(a=>{a.stopPropagation(),a.preventDefault()},[]);rs.useEffect(()=>{setTimeout(()=>{},2500)},[t]);const o=16;return zt.jsxs("div",{className:"view-controls",onMouseMove:r,onClick:r,children:[zt.jsx("button",{"data-tooltip":"Center view",onClick:s,children:zt.jsx(w9,{width:o,height:o})}),zt.jsx("span",{className:"separator"}),zt.jsx("button",{"data-tooltip":"Rotate clockwise",onClick:n,children:zt.jsx(P9,{width:o,height:o})}),zt.jsx("button",{"data-tooltip":"Rotate counter-clockwise",onClick:i,children:zt.jsx(R9,{width:o,height:o})})]})},K_=t=>{t.cancelable&&t.stopPropagation()},q9=t=>{const{cancelDrawing:e,remove:s,editor:n}=fr();rs.useEffect(()=>{const i=r=>{if(r.key==="Escape")e();else if(r.key==="Backspace"||r.key==="Delete"){const o=n==null?void 0:n.getSelectedAnnotations();o&&o.features.length>0&&s(o)}else r.key==="0"&&t()};return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}},[e,s,n,t])},Y9=({defaultArrowStyle:t={},defaultTextStyle:e={}})=>{const{annotations:s,editor:n}=fr(),i=ln(),[r,o]=rs.useState(!1),[a,l]=rs.useState(""),[u,h]=rs.useState(!1),[g,f]=rs.useState(""),p=rs.useCallback(async()=>{try{const L=await i.export.svg({clip:!0,download:!1});l(L),o(!0)}catch(L){console.error("Failed to export SVG:",L)}},[i]),y=rs.useCallback(()=>{o(!1),l("")},[]),_=rs.useCallback(()=>{if(a){const L=new Blob([a],{type:"image/svg+xml"}),M=URL.createObjectURL(L),F=document.createElement("a");document.body.appendChild(F),F.setAttribute("href",M),F.setAttribute("download","graph-with-annotations.svg"),F.click(),F.remove(),URL.revokeObjectURL(M)}},[a]),x=rs.useCallback(()=>{try{const L=n==null?void 0:n.getAnnotations();if(L){const M=JSON.stringify(L,null,2);f(M),h(!0)}}catch(L){console.error("Failed to export JSON:",L)}},[n]),v=rs.useCallback(()=>{h(!1),f("")},[]),b=rs.useCallback(()=>{if(g){const L=new Blob([g],{type:"application/json"}),M=URL.createObjectURL(L),F=document.createElement("a");document.body.appendChild(F),F.setAttribute("href",M),F.setAttribute("download","annotations.json"),F.click(),F.remove(),URL.revokeObjectURL(M)}},[g]),S=rs.useCallback(async()=>{const L=i.view.getGraphBoundingBox();await i.view.moveToBounds(L.extend(sk(s)),{duration:200})},[i,s]);q9(S);const A=rs.useCallback(K_,[]),w=rs.useCallback(L=>(L&&L.element&&L.element.addEventListener("wheel",K_,{passive:!1}),()=>{L.element.removeEventListener("wheel",K_)}),[]);return rs.useEffect(()=>{Object.assign(Nk,t),Object.assign(Mk,e)},[t,e]),zt.jsxs(zt.Fragment,{children:[zt.jsx(Rg,{className:"controls",ref:w,index:100,children:zt.jsx("div",{className:"container",onMouseMove:A,onClick:A,children:zt.jsx(V9,{onSvgExport:p,onJsonExport:x})})}),zt.jsx(Rg,{className:"view-controls-layer",index:100,children:zt.jsx("div",{className:"view-controls-container",children:zt.jsx($9,{})})}),zt.jsx(Rg,{className:"svg-popup-layer",index:1e3,children:zt.jsx(H9,{isOpen:r,svgContent:a,onClose:y,onDownload:_})}),zt.jsx(Rg,{className:"json-popup-layer",index:1e3,children:zt.jsx(j9,{isOpen:u,jsonContent:g,onClose:v,onDownload:b})})," "]})};async function W9(){return await U0.parse.jsonFromUrl("./graph.json")}async function X9(){return(await fetch("annotations-test.json")).json()}function Z9(){const[t,e]=rs.useState(null),[s,n]=rs.useState(null);return rs.useEffect(()=>{Promise.all([W9(),X9()]).then(([i,r])=>(e(i),n(r))).catch(i=>{console.error("Failed to load graph or annotations:",i)})},[]),!t||!s?zt.jsx("div",{children:"Loading graph..."}):zt.jsx("div",{className:"App",children:zt.jsxs(TY,{graph:t,onReady:i=>{i.tools.brand.set(`<div class="brand">
              <a href="../react/">
                <code>ogma-annotations-react</code></a> | <a href="https://github.com/linkurious/ogma-annotations-control/tree/develop/packages/react/web/">code</a>
            </div>`,{position:"top-left",horizontalMargin:10,verticalMargin:10,className:"brand"})},children:[zt.jsx(MY,{attributes:{color:"#5B97F8"}}),zt.jsx(FY,{attributes:{color:"#C2D7FF"}}),zt.jsxs(s9,{annotations:s,children:[zt.jsx(Y9,{minThickness:1,maxThickness:10,defaultArrowStyle:{strokeType:"plain",strokeColor:"#3A03CF",strokeWidth:2,head:"arrow"},defaultTextStyle:{font:"IBM Plex Sans",fontSize:24,color:"#3A03CF",background:"#EDE6FF",borderRadius:8,padding:12}}),zt.jsx(d9,{})]})]})})}$I.createRoot(document.getElementById("root")).render(zt.jsx(Z9,{}))});export default K9();
