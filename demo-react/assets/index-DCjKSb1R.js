var JI=Object.defineProperty;var tk=(t,e,s)=>e in t?JI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var ek=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Qt=(t,e,s)=>tk(t,typeof e!="symbol"?e+"":e,s);var L8=ek((D8,Td)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=s(i);fetch(i.href,r)}})();function sk(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ap={exports:{}},Yu={},wp={exports:{}},as={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cb;function nk(){if(Cb)return as;Cb=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),r=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function f(Q){return Q===null||typeof Q!="object"?null:(Q=g&&Q[g]||Q["@@iterator"],typeof Q=="function"?Q:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,p={};function x(Q,Et,qt){this.props=Q,this.context=Et,this.refs=p,this.updater=qt||m}x.prototype.isReactComponent={},x.prototype.setState=function(Q,Et){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,Et,"setState")},x.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function v(){}v.prototype=x.prototype;function b(Q,Et,qt){this.props=Q,this.context=Et,this.refs=p,this.updater=qt||m}var S=b.prototype=new v;S.constructor=b,y(S,x.prototype),S.isPureReactComponent=!0;var A=Array.isArray,w=Object.prototype.hasOwnProperty,L={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function F(Q,Et,qt){var Vt,Wt={},oe=null,me=null;if(Et!=null)for(Vt in Et.ref!==void 0&&(me=Et.ref),Et.key!==void 0&&(oe=""+Et.key),Et)w.call(Et,Vt)&&!k.hasOwnProperty(Vt)&&(Wt[Vt]=Et[Vt]);var se=arguments.length-2;if(se===1)Wt.children=qt;else if(1<se){for(var Jt=Array(se),ee=0;ee<se;ee++)Jt[ee]=arguments[ee+2];Wt.children=Jt}if(Q&&Q.defaultProps)for(Vt in se=Q.defaultProps,se)Wt[Vt]===void 0&&(Wt[Vt]=se[Vt]);return{$$typeof:t,type:Q,key:oe,ref:me,props:Wt,_owner:L.current}}function O(Q,Et){return{$$typeof:t,type:Q.type,key:Et,ref:Q.ref,props:Q.props,_owner:Q._owner}}function j(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===t}function V(Q){var Et={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(qt){return Et[qt]})}var Z=/\/+/g;function at(Q,Et){return typeof Q=="object"&&Q!==null&&Q.key!=null?V(""+Q.key):Et.toString(36)}function mt(Q,Et,qt,Vt,Wt){var oe=typeof Q;(oe==="undefined"||oe==="boolean")&&(Q=null);var me=!1;if(Q===null)me=!0;else switch(oe){case"string":case"number":me=!0;break;case"object":switch(Q.$$typeof){case t:case e:me=!0}}if(me)return me=Q,Wt=Wt(me),Q=Vt===""?"."+at(me,0):Vt,A(Wt)?(qt="",Q!=null&&(qt=Q.replace(Z,"$&/")+"/"),mt(Wt,Et,qt,"",function(ee){return ee})):Wt!=null&&(j(Wt)&&(Wt=O(Wt,qt+(!Wt.key||me&&me.key===Wt.key?"":(""+Wt.key).replace(Z,"$&/")+"/")+Q)),Et.push(Wt)),1;if(me=0,Vt=Vt===""?".":Vt+":",A(Q))for(var se=0;se<Q.length;se++){oe=Q[se];var Jt=Vt+at(oe,se);me+=mt(oe,Et,qt,Jt,Wt)}else if(Jt=f(Q),typeof Jt=="function")for(Q=Jt.call(Q),se=0;!(oe=Q.next()).done;)oe=oe.value,Jt=Vt+at(oe,se++),me+=mt(oe,Et,qt,Jt,Wt);else if(oe==="object")throw Et=String(Q),Error("Objects are not valid as a React child (found: "+(Et==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":Et)+"). If you meant to render a collection of children, use an array instead.");return me}function K(Q,Et,qt){if(Q==null)return Q;var Vt=[],Wt=0;return mt(Q,Vt,"","",function(oe){return Et.call(qt,oe,Wt++)}),Vt}function ut(Q){if(Q._status===-1){var Et=Q._result;Et=Et(),Et.then(function(qt){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=qt)},function(qt){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=qt)}),Q._status===-1&&(Q._status=0,Q._result=Et)}if(Q._status===1)return Q._result.default;throw Q._result}var ht={current:null},nt={transition:null},ot={ReactCurrentDispatcher:ht,ReactCurrentBatchConfig:nt,ReactCurrentOwner:L};function Mt(){throw Error("act(...) is not supported in production builds of React.")}return as.Children={map:K,forEach:function(Q,Et,qt){K(Q,function(){Et.apply(this,arguments)},qt)},count:function(Q){var Et=0;return K(Q,function(){Et++}),Et},toArray:function(Q){return K(Q,function(Et){return Et})||[]},only:function(Q){if(!j(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},as.Component=x,as.Fragment=s,as.Profiler=i,as.PureComponent=b,as.StrictMode=n,as.Suspense=l,as.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ot,as.act=Mt,as.cloneElement=function(Q,Et,qt){if(Q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Q+".");var Vt=y({},Q.props),Wt=Q.key,oe=Q.ref,me=Q._owner;if(Et!=null){if(Et.ref!==void 0&&(oe=Et.ref,me=L.current),Et.key!==void 0&&(Wt=""+Et.key),Q.type&&Q.type.defaultProps)var se=Q.type.defaultProps;for(Jt in Et)w.call(Et,Jt)&&!k.hasOwnProperty(Jt)&&(Vt[Jt]=Et[Jt]===void 0&&se!==void 0?se[Jt]:Et[Jt])}var Jt=arguments.length-2;if(Jt===1)Vt.children=qt;else if(1<Jt){se=Array(Jt);for(var ee=0;ee<Jt;ee++)se[ee]=arguments[ee+2];Vt.children=se}return{$$typeof:t,type:Q.type,key:Wt,ref:oe,props:Vt,_owner:me}},as.createContext=function(Q){return Q={$$typeof:o,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Q.Provider={$$typeof:r,_context:Q},Q.Consumer=Q},as.createElement=F,as.createFactory=function(Q){var Et=F.bind(null,Q);return Et.type=Q,Et},as.createRef=function(){return{current:null}},as.forwardRef=function(Q){return{$$typeof:a,render:Q}},as.isValidElement=j,as.lazy=function(Q){return{$$typeof:h,_payload:{_status:-1,_result:Q},_init:ut}},as.memo=function(Q,Et){return{$$typeof:u,type:Q,compare:Et===void 0?null:Et}},as.startTransition=function(Q){var Et=nt.transition;nt.transition={};try{Q()}finally{nt.transition=Et}},as.unstable_act=Mt,as.useCallback=function(Q,Et){return ht.current.useCallback(Q,Et)},as.useContext=function(Q){return ht.current.useContext(Q)},as.useDebugValue=function(){},as.useDeferredValue=function(Q){return ht.current.useDeferredValue(Q)},as.useEffect=function(Q,Et){return ht.current.useEffect(Q,Et)},as.useId=function(){return ht.current.useId()},as.useImperativeHandle=function(Q,Et,qt){return ht.current.useImperativeHandle(Q,Et,qt)},as.useInsertionEffect=function(Q,Et){return ht.current.useInsertionEffect(Q,Et)},as.useLayoutEffect=function(Q,Et){return ht.current.useLayoutEffect(Q,Et)},as.useMemo=function(Q,Et){return ht.current.useMemo(Q,Et)},as.useReducer=function(Q,Et,qt){return ht.current.useReducer(Q,Et,qt)},as.useRef=function(Q){return ht.current.useRef(Q)},as.useState=function(Q){return ht.current.useState(Q)},as.useSyncExternalStore=function(Q,Et,qt){return ht.current.useSyncExternalStore(Q,Et,qt)},as.useTransition=function(){return ht.current.useTransition()},as.version="18.3.1",as}var Lb;function dh(){return Lb||(Lb=1,wp.exports=nk()),wp.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nb;function ik(){if(Nb)return Yu;Nb=1;var t=dh(),e=Symbol.for("react.element"),s=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,u){var h,g={},f=null,m=null;u!==void 0&&(f=""+u),l.key!==void 0&&(f=""+l.key),l.ref!==void 0&&(m=l.ref);for(h in l)n.call(l,h)&&!r.hasOwnProperty(h)&&(g[h]=l[h]);if(a&&a.defaultProps)for(h in l=a.defaultProps,l)g[h]===void 0&&(g[h]=l[h]);return{$$typeof:e,type:a,key:f,ref:m,props:g,_owner:i.current}}return Yu.Fragment=s,Yu.jsx=o,Yu.jsxs=o,Yu}var Mb;function rk(){return Mb||(Mb=1,Ap.exports=ik()),Ap.exports}var de=rk(),Tc={},Tp={exports:{}},gi={},Cp={exports:{}},Lp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ib;function ok(){return Ib||(Ib=1,(function(t){function e(nt,ot){var Mt=nt.length;nt.push(ot);t:for(;0<Mt;){var Q=Mt-1>>>1,Et=nt[Q];if(0<i(Et,ot))nt[Q]=ot,nt[Mt]=Et,Mt=Q;else break t}}function s(nt){return nt.length===0?null:nt[0]}function n(nt){if(nt.length===0)return null;var ot=nt[0],Mt=nt.pop();if(Mt!==ot){nt[0]=Mt;t:for(var Q=0,Et=nt.length,qt=Et>>>1;Q<qt;){var Vt=2*(Q+1)-1,Wt=nt[Vt],oe=Vt+1,me=nt[oe];if(0>i(Wt,Mt))oe<Et&&0>i(me,Wt)?(nt[Q]=me,nt[oe]=Mt,Q=oe):(nt[Q]=Wt,nt[Vt]=Mt,Q=Vt);else if(oe<Et&&0>i(me,Mt))nt[Q]=me,nt[oe]=Mt,Q=oe;else break t}}return ot}function i(nt,ot){var Mt=nt.sortIndex-ot.sortIndex;return Mt!==0?Mt:nt.id-ot.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,g=null,f=3,m=!1,y=!1,p=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(nt){for(var ot=s(u);ot!==null;){if(ot.callback===null)n(u);else if(ot.startTime<=nt)n(u),ot.sortIndex=ot.expirationTime,e(l,ot);else break;ot=s(u)}}function A(nt){if(p=!1,S(nt),!y)if(s(l)!==null)y=!0,ut(w);else{var ot=s(u);ot!==null&&ht(A,ot.startTime-nt)}}function w(nt,ot){y=!1,p&&(p=!1,v(F),F=-1),m=!0;var Mt=f;try{for(S(ot),g=s(l);g!==null&&(!(g.expirationTime>ot)||nt&&!V());){var Q=g.callback;if(typeof Q=="function"){g.callback=null,f=g.priorityLevel;var Et=Q(g.expirationTime<=ot);ot=t.unstable_now(),typeof Et=="function"?g.callback=Et:g===s(l)&&n(l),S(ot)}else n(l);g=s(l)}if(g!==null)var qt=!0;else{var Vt=s(u);Vt!==null&&ht(A,Vt.startTime-ot),qt=!1}return qt}finally{g=null,f=Mt,m=!1}}var L=!1,k=null,F=-1,O=5,j=-1;function V(){return!(t.unstable_now()-j<O)}function Z(){if(k!==null){var nt=t.unstable_now();j=nt;var ot=!0;try{ot=k(!0,nt)}finally{ot?at():(L=!1,k=null)}}else L=!1}var at;if(typeof b=="function")at=function(){b(Z)};else if(typeof MessageChannel<"u"){var mt=new MessageChannel,K=mt.port2;mt.port1.onmessage=Z,at=function(){K.postMessage(null)}}else at=function(){x(Z,0)};function ut(nt){k=nt,L||(L=!0,at())}function ht(nt,ot){F=x(function(){nt(t.unstable_now())},ot)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(nt){nt.callback=null},t.unstable_continueExecution=function(){y||m||(y=!0,ut(w))},t.unstable_forceFrameRate=function(nt){0>nt||125<nt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<nt?Math.floor(1e3/nt):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return s(l)},t.unstable_next=function(nt){switch(f){case 1:case 2:case 3:var ot=3;break;default:ot=f}var Mt=f;f=ot;try{return nt()}finally{f=Mt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(nt,ot){switch(nt){case 1:case 2:case 3:case 4:case 5:break;default:nt=3}var Mt=f;f=nt;try{return ot()}finally{f=Mt}},t.unstable_scheduleCallback=function(nt,ot,Mt){var Q=t.unstable_now();switch(typeof Mt=="object"&&Mt!==null?(Mt=Mt.delay,Mt=typeof Mt=="number"&&0<Mt?Q+Mt:Q):Mt=Q,nt){case 1:var Et=-1;break;case 2:Et=250;break;case 5:Et=1073741823;break;case 4:Et=1e4;break;default:Et=5e3}return Et=Mt+Et,nt={id:h++,callback:ot,priorityLevel:nt,startTime:Mt,expirationTime:Et,sortIndex:-1},Mt>Q?(nt.sortIndex=Mt,e(u,nt),s(l)===null&&nt===s(u)&&(p?(v(F),F=-1):p=!0,ht(A,Mt-Q))):(nt.sortIndex=Et,e(l,nt),y||m||(y=!0,ut(w))),nt},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(nt){var ot=f;return function(){var Mt=f;f=ot;try{return nt.apply(this,arguments)}finally{f=Mt}}}})(Lp)),Lp}var kb;function ak(){return kb||(kb=1,Cp.exports=ok()),Cp.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rb;function lk(){if(Rb)return gi;Rb=1;var t=dh(),e=ak();function s(d){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+d,_=1;_<arguments.length;_++)c+="&args[]="+encodeURIComponent(arguments[_]);return"Minified React error #"+d+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function r(d,c){o(d,c),o(d+"Capture",c)}function o(d,c){for(i[d]=c,d=0;d<c.length;d++)n.add(c[d])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},g={};function f(d){return l.call(g,d)?!0:l.call(h,d)?!1:u.test(d)?g[d]=!0:(h[d]=!0,!1)}function m(d,c,_,E){if(_!==null&&_.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return E?!1:_!==null?!_.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function y(d,c,_,E){if(c===null||typeof c>"u"||m(d,c,_,E))return!0;if(E)return!1;if(_!==null)switch(_.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function p(d,c,_,E,T,I,G){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=E,this.attributeNamespace=T,this.mustUseProperty=_,this.propertyName=d,this.type=c,this.sanitizeURL=I,this.removeEmptyString=G}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){x[d]=new p(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var c=d[0];x[c]=new p(c,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){x[d]=new p(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){x[d]=new p(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){x[d]=new p(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){x[d]=new p(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){x[d]=new p(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){x[d]=new p(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){x[d]=new p(d,5,!1,d.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function b(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var c=d.replace(v,b);x[c]=new p(c,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var c=d.replace(v,b);x[c]=new p(c,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var c=d.replace(v,b);x[c]=new p(c,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){x[d]=new p(d,1,!1,d.toLowerCase(),null,!1,!1)}),x.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){x[d]=new p(d,1,!1,d.toLowerCase(),null,!0,!0)});function S(d,c,_,E){var T=x.hasOwnProperty(c)?x[c]:null;(T!==null?T.type!==0:E||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(y(c,_,T,E)&&(_=null),E||T===null?f(c)&&(_===null?d.removeAttribute(c):d.setAttribute(c,""+_)):T.mustUseProperty?d[T.propertyName]=_===null?T.type===3?!1:"":_:(c=T.attributeName,E=T.attributeNamespace,_===null?d.removeAttribute(c):(T=T.type,_=T===3||T===4&&_===!0?"":""+_,E?d.setAttributeNS(E,c,_):d.setAttribute(c,_))))}var A=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),L=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),V=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),at=Symbol.for("react.suspense"),mt=Symbol.for("react.suspense_list"),K=Symbol.for("react.memo"),ut=Symbol.for("react.lazy"),ht=Symbol.for("react.offscreen"),nt=Symbol.iterator;function ot(d){return d===null||typeof d!="object"?null:(d=nt&&d[nt]||d["@@iterator"],typeof d=="function"?d:null)}var Mt=Object.assign,Q;function Et(d){if(Q===void 0)try{throw Error()}catch(_){var c=_.stack.trim().match(/\n( *(at )?)/);Q=c&&c[1]||""}return`
`+Q+d}var qt=!1;function Vt(d,c){if(!d||qt)return"";qt=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Gt){var E=Gt}Reflect.construct(d,[],c)}else{try{c.call()}catch(Gt){E=Gt}d.call(c.prototype)}else{try{throw Error()}catch(Gt){E=Gt}d()}}catch(Gt){if(Gt&&E&&typeof Gt.stack=="string"){for(var T=Gt.stack.split(`
`),I=E.stack.split(`
`),G=T.length-1,rt=I.length-1;1<=G&&0<=rt&&T[G]!==I[rt];)rt--;for(;1<=G&&0<=rt;G--,rt--)if(T[G]!==I[rt]){if(G!==1||rt!==1)do if(G--,rt--,0>rt||T[G]!==I[rt]){var xt=`
`+T[G].replace(" at new "," at ");return d.displayName&&xt.includes("<anonymous>")&&(xt=xt.replace("<anonymous>",d.displayName)),xt}while(1<=G&&0<=rt);break}}}finally{qt=!1,Error.prepareStackTrace=_}return(d=d?d.displayName||d.name:"")?Et(d):""}function Wt(d){switch(d.tag){case 5:return Et(d.type);case 16:return Et("Lazy");case 13:return Et("Suspense");case 19:return Et("SuspenseList");case 0:case 2:case 15:return d=Vt(d.type,!1),d;case 11:return d=Vt(d.type.render,!1),d;case 1:return d=Vt(d.type,!0),d;default:return""}}function oe(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case k:return"Fragment";case L:return"Portal";case O:return"Profiler";case F:return"StrictMode";case at:return"Suspense";case mt:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case V:return(d.displayName||"Context")+".Consumer";case j:return(d._context.displayName||"Context")+".Provider";case Z:var c=d.render;return d=d.displayName,d||(d=c.displayName||c.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case K:return c=d.displayName||null,c!==null?c:oe(d.type)||"Memo";case ut:c=d._payload,d=d._init;try{return oe(d(c))}catch{}}return null}function me(d){var c=d.type;switch(d.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=c.render,d=d.displayName||d.name||"",c.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oe(c);case 8:return c===F?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function se(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Jt(d){var c=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function ee(d){var c=Jt(d)?"checked":"value",_=Object.getOwnPropertyDescriptor(d.constructor.prototype,c),E=""+d[c];if(!d.hasOwnProperty(c)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var T=_.get,I=_.set;return Object.defineProperty(d,c,{configurable:!0,get:function(){return T.call(this)},set:function(G){E=""+G,I.call(this,G)}}),Object.defineProperty(d,c,{enumerable:_.enumerable}),{getValue:function(){return E},setValue:function(G){E=""+G},stopTracking:function(){d._valueTracker=null,delete d[c]}}}}function ce(d){d._valueTracker||(d._valueTracker=ee(d))}function Ce(d){if(!d)return!1;var c=d._valueTracker;if(!c)return!0;var _=c.getValue(),E="";return d&&(E=Jt(d)?d.checked?"true":"false":d.value),d=E,d!==_?(c.setValue(d),!0):!1}function ve(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function Me(d,c){var _=c.checked;return Mt({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:_??d._wrapperState.initialChecked})}function ge(d,c){var _=c.defaultValue==null?"":c.defaultValue,E=c.checked!=null?c.checked:c.defaultChecked;_=se(c.value!=null?c.value:_),d._wrapperState={initialChecked:E,initialValue:_,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function ze(d,c){c=c.checked,c!=null&&S(d,"checked",c,!1)}function is(d,c){ze(d,c);var _=se(c.value),E=c.type;if(_!=null)E==="number"?(_===0&&d.value===""||d.value!=_)&&(d.value=""+_):d.value!==""+_&&(d.value=""+_);else if(E==="submit"||E==="reset"){d.removeAttribute("value");return}c.hasOwnProperty("value")?De(d,c.type,_):c.hasOwnProperty("defaultValue")&&De(d,c.type,se(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(d.defaultChecked=!!c.defaultChecked)}function Ge(d,c,_){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var E=c.type;if(!(E!=="submit"&&E!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+d._wrapperState.initialValue,_||c===d.value||(d.value=c),d.defaultValue=c}_=d.name,_!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,_!==""&&(d.name=_)}function De(d,c,_){(c!=="number"||ve(d.ownerDocument)!==d)&&(_==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+_&&(d.defaultValue=""+_))}var He=Array.isArray;function Je(d,c,_,E){if(d=d.options,c){c={};for(var T=0;T<_.length;T++)c["$"+_[T]]=!0;for(_=0;_<d.length;_++)T=c.hasOwnProperty("$"+d[_].value),d[_].selected!==T&&(d[_].selected=T),T&&E&&(d[_].defaultSelected=!0)}else{for(_=""+se(_),c=null,T=0;T<d.length;T++){if(d[T].value===_){d[T].selected=!0,E&&(d[T].defaultSelected=!0);return}c!==null||d[T].disabled||(c=d[T])}c!==null&&(c.selected=!0)}}function ss(d,c){if(c.dangerouslySetInnerHTML!=null)throw Error(s(91));return Mt({},c,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function ts(d,c){var _=c.value;if(_==null){if(_=c.children,c=c.defaultValue,_!=null){if(c!=null)throw Error(s(92));if(He(_)){if(1<_.length)throw Error(s(93));_=_[0]}c=_}c==null&&(c=""),_=c}d._wrapperState={initialValue:se(_)}}function hs(d,c){var _=se(c.value),E=se(c.defaultValue);_!=null&&(_=""+_,_!==d.value&&(d.value=_),c.defaultValue==null&&d.defaultValue!==_&&(d.defaultValue=_)),E!=null&&(d.defaultValue=""+E)}function Fe(d){var c=d.textContent;c===d._wrapperState.initialValue&&c!==""&&c!==null&&(d.value=c)}function Oe(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cs(d,c){return d==null||d==="http://www.w3.org/1999/xhtml"?Oe(c):d==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var Fs,Hs=(function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,_,E,T){MSApp.execUnsafeLocalFunction(function(){return d(c,_,E,T)})}:d})(function(d,c){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=c;else{for(Fs=Fs||document.createElement("div"),Fs.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Fs.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;c.firstChild;)d.appendChild(c.firstChild)}});function Ls(d,c){if(c){var _=d.firstChild;if(_&&_===d.lastChild&&_.nodeType===3){_.nodeValue=c;return}}d.textContent=c}var En={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},hn=["Webkit","ms","Moz","O"];Object.keys(En).forEach(function(d){hn.forEach(function(c){c=c+d.charAt(0).toUpperCase()+d.substring(1),En[c]=En[d]})});function on(d,c,_){return c==null||typeof c=="boolean"||c===""?"":_||typeof c!="number"||c===0||En.hasOwnProperty(d)&&En[d]?(""+c).trim():c+"px"}function xs(d,c){d=d.style;for(var _ in c)if(c.hasOwnProperty(_)){var E=_.indexOf("--")===0,T=on(_,c[_],E);_==="float"&&(_="cssFloat"),E?d.setProperty(_,T):d[_]=T}}var Ps=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gt(d,c){if(c){if(Ps[d]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(s(137,d));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(s(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(s(61))}if(c.style!=null&&typeof c.style!="object")throw Error(s(62))}}function M(d,c){if(d.indexOf("-")===-1)return typeof c.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var P=null;function D(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var B=null,$=null,H=null;function X(d){if(d=ku(d)){if(typeof B!="function")throw Error(s(280));var c=d.stateNode;c&&(c=Gh(c),B(d.stateNode,d.type,c))}}function lt(d){$?H?H.push(d):H=[d]:$=d}function dt(){if($){var d=$,c=H;if(H=$=null,X(d),c)for(d=0;d<c.length;d++)X(c[d])}}function ct(d,c){return d(c)}function pt(){}var yt=!1;function Nt(d,c,_){if(yt)return d(c,_);yt=!0;try{return ct(d,c,_)}finally{yt=!1,($!==null||H!==null)&&(pt(),dt())}}function Tt(d,c){var _=d.stateNode;if(_===null)return null;var E=Gh(_);if(E===null)return null;_=E[c];t:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(E=!E.disabled)||(d=d.type,E=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!E;break t;default:d=!1}if(d)return null;if(_&&typeof _!="function")throw Error(s(231,c,typeof _));return _}var At=!1;if(a)try{var Bt={};Object.defineProperty(Bt,"passive",{get:function(){At=!0}}),window.addEventListener("test",Bt,Bt),window.removeEventListener("test",Bt,Bt)}catch{At=!1}function he(d,c,_,E,T,I,G,rt,xt){var Gt=Array.prototype.slice.call(arguments,3);try{c.apply(_,Gt)}catch(ue){this.onError(ue)}}var xe=!1,be=null,le=!1,_e=null,Te={onError:function(d){xe=!0,be=d}};function Ve(d,c,_,E,T,I,G,rt,xt){xe=!1,be=null,he.apply(Te,arguments)}function ke(d,c,_,E,T,I,G,rt,xt){if(Ve.apply(this,arguments),xe){if(xe){var Gt=be;xe=!1,be=null}else throw Error(s(198));le||(le=!0,_e=Gt)}}function je(d){var c=d,_=d;if(d.alternate)for(;c.return;)c=c.return;else{d=c;do c=d,(c.flags&4098)!==0&&(_=c.return),d=c.return;while(d)}return c.tag===3?_:null}function Pe(d){if(d.tag===13){var c=d.memoizedState;if(c===null&&(d=d.alternate,d!==null&&(c=d.memoizedState)),c!==null)return c.dehydrated}return null}function Be(d){if(je(d)!==d)throw Error(s(188))}function Ue(d){var c=d.alternate;if(!c){if(c=je(d),c===null)throw Error(s(188));return c!==d?null:d}for(var _=d,E=c;;){var T=_.return;if(T===null)break;var I=T.alternate;if(I===null){if(E=T.return,E!==null){_=E;continue}break}if(T.child===I.child){for(I=T.child;I;){if(I===_)return Be(T),d;if(I===E)return Be(T),c;I=I.sibling}throw Error(s(188))}if(_.return!==E.return)_=T,E=I;else{for(var G=!1,rt=T.child;rt;){if(rt===_){G=!0,_=T,E=I;break}if(rt===E){G=!0,E=T,_=I;break}rt=rt.sibling}if(!G){for(rt=I.child;rt;){if(rt===_){G=!0,_=I,E=T;break}if(rt===E){G=!0,E=I,_=T;break}rt=rt.sibling}if(!G)throw Error(s(189))}}if(_.alternate!==E)throw Error(s(190))}if(_.tag!==3)throw Error(s(188));return _.stateNode.current===_?d:c}function es(d){return d=Ue(d),d!==null?rs(d):null}function rs(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var c=rs(d);if(c!==null)return c;d=d.sibling}return null}var cs=e.unstable_scheduleCallback,Y=e.unstable_cancelCallback,et=e.unstable_shouldYield,J=e.unstable_requestPaint,tt=e.unstable_now,ft=e.unstable_getCurrentPriorityLevel,_t=e.unstable_ImmediatePriority,it=e.unstable_UserBlockingPriority,vt=e.unstable_NormalPriority,Ct=e.unstable_LowPriority,Ft=e.unstable_IdlePriority,Pt=null,Lt=null;function $t(d){if(Lt&&typeof Lt.onCommitFiberRoot=="function")try{Lt.onCommitFiberRoot(Pt,d,void 0,(d.current.flags&128)===128)}catch{}}var jt=Math.clz32?Math.clz32:Ht,Ot=Math.log,Ut=Math.LN2;function Ht(d){return d>>>=0,d===0?32:31-(Ot(d)/Ut|0)|0}var Xt=64,te=4194304;function re(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function ie(d,c){var _=d.pendingLanes;if(_===0)return 0;var E=0,T=d.suspendedLanes,I=d.pingedLanes,G=_&268435455;if(G!==0){var rt=G&~T;rt!==0?E=re(rt):(I&=G,I!==0&&(E=re(I)))}else G=_&~T,G!==0?E=re(G):I!==0&&(E=re(I));if(E===0)return 0;if(c!==0&&c!==E&&(c&T)===0&&(T=E&-E,I=c&-c,T>=I||T===16&&(I&4194240)!==0))return c;if((E&4)!==0&&(E|=_&16),c=d.entangledLanes,c!==0)for(d=d.entanglements,c&=E;0<c;)_=31-jt(c),T=1<<_,E|=d[_],c&=~T;return E}function C(d,c){switch(d){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function R(d,c){for(var _=d.suspendedLanes,E=d.pingedLanes,T=d.expirationTimes,I=d.pendingLanes;0<I;){var G=31-jt(I),rt=1<<G,xt=T[G];xt===-1?((rt&_)===0||(rt&E)!==0)&&(T[G]=C(rt,c)):xt<=c&&(d.expiredLanes|=rt),I&=~rt}}function U(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function W(){var d=Xt;return Xt<<=1,(Xt&4194240)===0&&(Xt=64),d}function St(d){for(var c=[],_=0;31>_;_++)c.push(d);return c}function bt(d,c,_){d.pendingLanes|=c,c!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,c=31-jt(c),d[c]=_}function kt(d,c){var _=d.pendingLanes&~c;d.pendingLanes=c,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=c,d.mutableReadLanes&=c,d.entangledLanes&=c,c=d.entanglements;var E=d.eventTimes;for(d=d.expirationTimes;0<_;){var T=31-jt(_),I=1<<T;c[T]=0,E[T]=-1,d[T]=-1,_&=~I}}function Zt(d,c){var _=d.entangledLanes|=c;for(d=d.entanglements;_;){var E=31-jt(_),T=1<<E;T&c|d[E]&c&&(d[E]|=c),_&=~T}}var ne=0;function Ee(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var we,We,ls,ps,us,Ns=!1,gs=[],Ms=null,cn=null,Ss=null,zs=new Map,_n=new Map,Js=[],Xs="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ds(d,c){switch(d){case"focusin":case"focusout":Ms=null;break;case"dragenter":case"dragleave":cn=null;break;case"mouseover":case"mouseout":Ss=null;break;case"pointerover":case"pointerout":zs.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":_n.delete(c.pointerId)}}function Sn(d,c,_,E,T,I){return d===null||d.nativeEvent!==I?(d={blockedOn:c,domEventName:_,eventSystemFlags:E,nativeEvent:I,targetContainers:[T]},c!==null&&(c=ku(c),c!==null&&We(c)),d):(d.eventSystemFlags|=E,c=d.targetContainers,T!==null&&c.indexOf(T)===-1&&c.push(T),d)}function Yi(d,c,_,E,T){switch(c){case"focusin":return Ms=Sn(Ms,d,c,_,E,T),!0;case"dragenter":return cn=Sn(cn,d,c,_,E,T),!0;case"mouseover":return Ss=Sn(Ss,d,c,_,E,T),!0;case"pointerover":var I=T.pointerId;return zs.set(I,Sn(zs.get(I)||null,d,c,_,E,T)),!0;case"gotpointercapture":return I=T.pointerId,_n.set(I,Sn(_n.get(I)||null,d,c,_,E,T)),!0}return!1}function Cn(d){var c=ra(d.target);if(c!==null){var _=je(c);if(_!==null){if(c=_.tag,c===13){if(c=Pe(_),c!==null){d.blockedOn=c,us(d.priority,function(){ls(_)});return}}else if(c===3&&_.stateNode.current.memoizedState.isDehydrated){d.blockedOn=_.tag===3?_.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Wi(d){if(d.blockedOn!==null)return!1;for(var c=d.targetContainers;0<c.length;){var _=Jo(d.domEventName,d.eventSystemFlags,c[0],d.nativeEvent);if(_===null){_=d.nativeEvent;var E=new _.constructor(_.type,_);P=E,_.target.dispatchEvent(E),P=null}else return c=ku(_),c!==null&&We(c),d.blockedOn=_,!1;c.shift()}return!0}function hr(d,c,_){Wi(d)&&_.delete(c)}function vs(){Ns=!1,Ms!==null&&Wi(Ms)&&(Ms=null),cn!==null&&Wi(cn)&&(cn=null),Ss!==null&&Wi(Ss)&&(Ss=null),zs.forEach(hr),_n.forEach(hr)}function Xi(d,c){d.blockedOn===c&&(d.blockedOn=null,Ns||(Ns=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,vs)))}function cr(d){function c(T){return Xi(T,d)}if(0<gs.length){Xi(gs[0],d);for(var _=1;_<gs.length;_++){var E=gs[_];E.blockedOn===d&&(E.blockedOn=null)}}for(Ms!==null&&Xi(Ms,d),cn!==null&&Xi(cn,d),Ss!==null&&Xi(Ss,d),zs.forEach(c),_n.forEach(c),_=0;_<Js.length;_++)E=Js[_],E.blockedOn===d&&(E.blockedOn=null);for(;0<Js.length&&(_=Js[0],_.blockedOn===null);)Cn(_),_.blockedOn===null&&Js.shift()}var Ni=A.ReactCurrentBatchConfig,pi=!0;function Wa(d,c,_,E){var T=ne,I=Ni.transition;Ni.transition=null;try{ne=1,Xa(d,c,_,E)}finally{ne=T,Ni.transition=I}}function Lr(d,c,_,E){var T=ne,I=Ni.transition;Ni.transition=null;try{ne=4,Xa(d,c,_,E)}finally{ne=T,Ni.transition=I}}function Xa(d,c,_,E){if(pi){var T=Jo(d,c,_,E);if(T===null)fm(d,c,E,lo,_),Ds(d,E);else if(Yi(T,d,c,_,E))E.stopPropagation();else if(Ds(d,E),c&4&&-1<Xs.indexOf(d)){for(;T!==null;){var I=ku(T);if(I!==null&&we(I),I=Jo(d,c,_,E),I===null&&fm(d,c,E,lo,_),I===T)break;T=I}T!==null&&E.stopPropagation()}else fm(d,c,E,null,_)}}var lo=null;function Jo(d,c,_,E){if(lo=null,d=D(E),d=ra(d),d!==null)if(c=je(d),c===null)d=null;else if(_=c.tag,_===13){if(d=Pe(c),d!==null)return d;d=null}else if(_===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;d=null}else c!==d&&(d=null);return lo=d,null}function pu(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ft()){case _t:return 1;case it:return 4;case vt:case Ct:return 16;case Ft:return 536870912;default:return 16}default:return 16}}var Zi=null,Za=null,Ka=null;function Ch(){if(Ka)return Ka;var d,c=Za,_=c.length,E,T="value"in Zi?Zi.value:Zi.textContent,I=T.length;for(d=0;d<_&&c[d]===T[d];d++);var G=_-d;for(E=1;E<=G&&c[_-E]===T[I-E];E++);return Ka=T.slice(d,1<E?1-E:void 0)}function Nr(d){var c=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&c===13&&(d=13)):d=c,d===10&&(d=13),32<=d||d===13?d:0}function ta(){return!0}function ea(){return!1}function Ln(d){function c(_,E,T,I,G){this._reactName=_,this._targetInst=T,this.type=E,this.nativeEvent=I,this.target=G,this.currentTarget=null;for(var rt in d)d.hasOwnProperty(rt)&&(_=d[rt],this[rt]=_?_(I):I[rt]);return this.isDefaultPrevented=(I.defaultPrevented!=null?I.defaultPrevented:I.returnValue===!1)?ta:ea,this.isPropagationStopped=ea,this}return Mt(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _=this.nativeEvent;_&&(_.preventDefault?_.preventDefault():typeof _.returnValue!="unknown"&&(_.returnValue=!1),this.isDefaultPrevented=ta)},stopPropagation:function(){var _=this.nativeEvent;_&&(_.stopPropagation?_.stopPropagation():typeof _.cancelBubble!="unknown"&&(_.cancelBubble=!0),this.isPropagationStopped=ta)},persist:function(){},isPersistent:ta}),c}var uo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mr=Ln(uo),sa=Mt({},uo,{view:0,detail:0}),_u=Ln(sa),ho,Ir,gr,na=Mt({},sa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sl,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==gr&&(gr&&d.type==="mousemove"?(ho=d.screenX-gr.screenX,Ir=d.screenY-gr.screenY):Ir=ho=0,gr=d),ho)},movementY:function(d){return"movementY"in d?d.movementY:Ir}}),yu=Ln(na),Lh=Mt({},na,{dataTransfer:0}),xu=Ln(Lh),Zn=Mt({},sa,{relatedTarget:0}),Qa=Ln(Zn),vu=Mt({},uo,{animationName:0,elapsedTime:0,pseudoElement:0}),im=Ln(vu),Nh=Mt({},uo,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),Ja=Ln(Nh),Mh=Mt({},uo,{data:0}),bu=Ln(Mh),tl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},el={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ih={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kh(d){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(d):(d=Ih[d])?!!c[d]:!1}function sl(){return kh}var Eu=Mt({},sa,{key:function(d){if(d.key){var c=tl[d.key]||d.key;if(c!=="Unidentified")return c}return d.type==="keypress"?(d=Nr(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?el[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sl,charCode:function(d){return d.type==="keypress"?Nr(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?Nr(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Rh=Ln(Eu),N=Mt({},na,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),z=Ln(N),q=Mt({},sa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sl}),st=Ln(q),Dt=Mt({},uo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rt=Ln(Dt),Kt=Mt({},na,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),pe=Ln(Kt),Ye=[9,13,27,32],ns=a&&"CompositionEvent"in window,Xe=null;a&&"documentMode"in document&&(Xe=document.documentMode);var ws=a&&"TextEvent"in window&&!Xe,Pn=a&&(!ns||Xe&&8<Xe&&11>=Xe),oi=" ",ai=!1;function ia(d,c){switch(d){case"keyup":return Ye.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Su(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var fr=!1;function ZM(d,c){switch(d){case"compositionend":return Su(c);case"keypress":return c.which!==32?null:(ai=!0,oi);case"textInput":return d=c.data,d===oi&&ai?null:d;default:return null}}function KM(d,c){if(fr)return d==="compositionend"||!ns&&ia(d,c)?(d=Ch(),Ka=Za=Zi=null,fr=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Pn&&c.locale!=="ko"?null:c.data;default:return null}}var QM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function A0(d){var c=d&&d.nodeName&&d.nodeName.toLowerCase();return c==="input"?!!QM[d.type]:c==="textarea"}function w0(d,c,_,E){lt(E),c=Oh(c,"onChange"),0<c.length&&(_=new Mr("onChange","change",null,_,E),d.push({event:_,listeners:c}))}var Au=null,wu=null;function JM(d){j0(d,0)}function Fh(d){var c=al(d);if(Ce(c))return d}function tI(d,c){if(d==="change")return c}var T0=!1;if(a){var rm;if(a){var om="oninput"in document;if(!om){var C0=document.createElement("div");C0.setAttribute("oninput","return;"),om=typeof C0.oninput=="function"}rm=om}else rm=!1;T0=rm&&(!document.documentMode||9<document.documentMode)}function L0(){Au&&(Au.detachEvent("onpropertychange",N0),wu=Au=null)}function N0(d){if(d.propertyName==="value"&&Fh(wu)){var c=[];w0(c,wu,d,D(d)),Nt(JM,c)}}function eI(d,c,_){d==="focusin"?(L0(),Au=c,wu=_,Au.attachEvent("onpropertychange",N0)):d==="focusout"&&L0()}function sI(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return Fh(wu)}function nI(d,c){if(d==="click")return Fh(c)}function iI(d,c){if(d==="input"||d==="change")return Fh(c)}function rI(d,c){return d===c&&(d!==0||1/d===1/c)||d!==d&&c!==c}var Ki=typeof Object.is=="function"?Object.is:rI;function Tu(d,c){if(Ki(d,c))return!0;if(typeof d!="object"||d===null||typeof c!="object"||c===null)return!1;var _=Object.keys(d),E=Object.keys(c);if(_.length!==E.length)return!1;for(E=0;E<_.length;E++){var T=_[E];if(!l.call(c,T)||!Ki(d[T],c[T]))return!1}return!0}function M0(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function I0(d,c){var _=M0(d);d=0;for(var E;_;){if(_.nodeType===3){if(E=d+_.textContent.length,d<=c&&E>=c)return{node:_,offset:c-d};d=E}t:{for(;_;){if(_.nextSibling){_=_.nextSibling;break t}_=_.parentNode}_=void 0}_=M0(_)}}function k0(d,c){return d&&c?d===c?!0:d&&d.nodeType===3?!1:c&&c.nodeType===3?k0(d,c.parentNode):"contains"in d?d.contains(c):d.compareDocumentPosition?!!(d.compareDocumentPosition(c)&16):!1:!1}function R0(){for(var d=window,c=ve();c instanceof d.HTMLIFrameElement;){try{var _=typeof c.contentWindow.location.href=="string"}catch{_=!1}if(_)d=c.contentWindow;else break;c=ve(d.document)}return c}function am(d){var c=d&&d.nodeName&&d.nodeName.toLowerCase();return c&&(c==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||c==="textarea"||d.contentEditable==="true")}function oI(d){var c=R0(),_=d.focusedElem,E=d.selectionRange;if(c!==_&&_&&_.ownerDocument&&k0(_.ownerDocument.documentElement,_)){if(E!==null&&am(_)){if(c=E.start,d=E.end,d===void 0&&(d=c),"selectionStart"in _)_.selectionStart=c,_.selectionEnd=Math.min(d,_.value.length);else if(d=(c=_.ownerDocument||document)&&c.defaultView||window,d.getSelection){d=d.getSelection();var T=_.textContent.length,I=Math.min(E.start,T);E=E.end===void 0?I:Math.min(E.end,T),!d.extend&&I>E&&(T=E,E=I,I=T),T=I0(_,I);var G=I0(_,E);T&&G&&(d.rangeCount!==1||d.anchorNode!==T.node||d.anchorOffset!==T.offset||d.focusNode!==G.node||d.focusOffset!==G.offset)&&(c=c.createRange(),c.setStart(T.node,T.offset),d.removeAllRanges(),I>E?(d.addRange(c),d.extend(G.node,G.offset)):(c.setEnd(G.node,G.offset),d.addRange(c)))}}for(c=[],d=_;d=d.parentNode;)d.nodeType===1&&c.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<c.length;_++)d=c[_],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var aI=a&&"documentMode"in document&&11>=document.documentMode,nl=null,lm=null,Cu=null,um=!1;function F0(d,c,_){var E=_.window===_?_.document:_.nodeType===9?_:_.ownerDocument;um||nl==null||nl!==ve(E)||(E=nl,"selectionStart"in E&&am(E)?E={start:E.selectionStart,end:E.selectionEnd}:(E=(E.ownerDocument&&E.ownerDocument.defaultView||window).getSelection(),E={anchorNode:E.anchorNode,anchorOffset:E.anchorOffset,focusNode:E.focusNode,focusOffset:E.focusOffset}),Cu&&Tu(Cu,E)||(Cu=E,E=Oh(lm,"onSelect"),0<E.length&&(c=new Mr("onSelect","select",null,c,_),d.push({event:c,listeners:E}),c.target=nl)))}function Ph(d,c){var _={};return _[d.toLowerCase()]=c.toLowerCase(),_["Webkit"+d]="webkit"+c,_["Moz"+d]="moz"+c,_}var il={animationend:Ph("Animation","AnimationEnd"),animationiteration:Ph("Animation","AnimationIteration"),animationstart:Ph("Animation","AnimationStart"),transitionend:Ph("Transition","TransitionEnd")},dm={},P0={};a&&(P0=document.createElement("div").style,"AnimationEvent"in window||(delete il.animationend.animation,delete il.animationiteration.animation,delete il.animationstart.animation),"TransitionEvent"in window||delete il.transitionend.transition);function zh(d){if(dm[d])return dm[d];if(!il[d])return d;var c=il[d],_;for(_ in c)if(c.hasOwnProperty(_)&&_ in P0)return dm[d]=c[_];return d}var z0=zh("animationend"),D0=zh("animationiteration"),O0=zh("animationstart"),B0=zh("transitionend"),U0=new Map,G0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function co(d,c){U0.set(d,c),r(c,[d])}for(var hm=0;hm<G0.length;hm++){var cm=G0[hm],lI=cm.toLowerCase(),uI=cm[0].toUpperCase()+cm.slice(1);co(lI,"on"+uI)}co(z0,"onAnimationEnd"),co(D0,"onAnimationIteration"),co(O0,"onAnimationStart"),co("dblclick","onDoubleClick"),co("focusin","onFocus"),co("focusout","onBlur"),co(B0,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),r("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),r("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),r("onBeforeInput",["compositionend","keypress","textInput","paste"]),r("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dI=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lu));function V0(d,c,_){var E=d.type||"unknown-event";d.currentTarget=_,ke(E,c,void 0,d),d.currentTarget=null}function j0(d,c){c=(c&4)!==0;for(var _=0;_<d.length;_++){var E=d[_],T=E.event;E=E.listeners;t:{var I=void 0;if(c)for(var G=E.length-1;0<=G;G--){var rt=E[G],xt=rt.instance,Gt=rt.currentTarget;if(rt=rt.listener,xt!==I&&T.isPropagationStopped())break t;V0(T,rt,Gt),I=xt}else for(G=0;G<E.length;G++){if(rt=E[G],xt=rt.instance,Gt=rt.currentTarget,rt=rt.listener,xt!==I&&T.isPropagationStopped())break t;V0(T,rt,Gt),I=xt}}}if(le)throw d=_e,le=!1,_e=null,d}function Os(d,c){var _=c[vm];_===void 0&&(_=c[vm]=new Set);var E=d+"__bubble";_.has(E)||(H0(c,d,2,!1),_.add(E))}function gm(d,c,_){var E=0;c&&(E|=4),H0(_,d,E,c)}var Dh="_reactListening"+Math.random().toString(36).slice(2);function Nu(d){if(!d[Dh]){d[Dh]=!0,n.forEach(function(_){_!=="selectionchange"&&(dI.has(_)||gm(_,!1,d),gm(_,!0,d))});var c=d.nodeType===9?d:d.ownerDocument;c===null||c[Dh]||(c[Dh]=!0,gm("selectionchange",!1,c))}}function H0(d,c,_,E){switch(pu(c)){case 1:var T=Wa;break;case 4:T=Lr;break;default:T=Xa}_=T.bind(null,c,_,d),T=void 0,!At||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(T=!0),E?T!==void 0?d.addEventListener(c,_,{capture:!0,passive:T}):d.addEventListener(c,_,!0):T!==void 0?d.addEventListener(c,_,{passive:T}):d.addEventListener(c,_,!1)}function fm(d,c,_,E,T){var I=E;if((c&1)===0&&(c&2)===0&&E!==null)t:for(;;){if(E===null)return;var G=E.tag;if(G===3||G===4){var rt=E.stateNode.containerInfo;if(rt===T||rt.nodeType===8&&rt.parentNode===T)break;if(G===4)for(G=E.return;G!==null;){var xt=G.tag;if((xt===3||xt===4)&&(xt=G.stateNode.containerInfo,xt===T||xt.nodeType===8&&xt.parentNode===T))return;G=G.return}for(;rt!==null;){if(G=ra(rt),G===null)return;if(xt=G.tag,xt===5||xt===6){E=I=G;continue t}rt=rt.parentNode}}E=E.return}Nt(function(){var Gt=I,ue=D(_),fe=[];t:{var ae=U0.get(d);if(ae!==void 0){var Ae=Mr,Ne=d;switch(d){case"keypress":if(Nr(_)===0)break t;case"keydown":case"keyup":Ae=Rh;break;case"focusin":Ne="focus",Ae=Qa;break;case"focusout":Ne="blur",Ae=Qa;break;case"beforeblur":case"afterblur":Ae=Qa;break;case"click":if(_.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ae=yu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ae=xu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ae=st;break;case z0:case D0:case O0:Ae=im;break;case B0:Ae=Rt;break;case"scroll":Ae=_u;break;case"wheel":Ae=pe;break;case"copy":case"cut":case"paste":Ae=Ja;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ae=z}var Ie=(c&4)!==0,an=!Ie&&d==="scroll",It=Ie?ae!==null?ae+"Capture":null:ae;Ie=[];for(var wt=Gt,zt;wt!==null;){zt=wt;var ye=zt.stateNode;if(zt.tag===5&&ye!==null&&(zt=ye,It!==null&&(ye=Tt(wt,It),ye!=null&&Ie.push(Mu(wt,ye,zt)))),an)break;wt=wt.return}0<Ie.length&&(ae=new Ae(ae,Ne,null,_,ue),fe.push({event:ae,listeners:Ie}))}}if((c&7)===0){t:{if(ae=d==="mouseover"||d==="pointerover",Ae=d==="mouseout"||d==="pointerout",ae&&_!==P&&(Ne=_.relatedTarget||_.fromElement)&&(ra(Ne)||Ne[kr]))break t;if((Ae||ae)&&(ae=ue.window===ue?ue:(ae=ue.ownerDocument)?ae.defaultView||ae.parentWindow:window,Ae?(Ne=_.relatedTarget||_.toElement,Ae=Gt,Ne=Ne?ra(Ne):null,Ne!==null&&(an=je(Ne),Ne!==an||Ne.tag!==5&&Ne.tag!==6)&&(Ne=null)):(Ae=null,Ne=Gt),Ae!==Ne)){if(Ie=yu,ye="onMouseLeave",It="onMouseEnter",wt="mouse",(d==="pointerout"||d==="pointerover")&&(Ie=z,ye="onPointerLeave",It="onPointerEnter",wt="pointer"),an=Ae==null?ae:al(Ae),zt=Ne==null?ae:al(Ne),ae=new Ie(ye,wt+"leave",Ae,_,ue),ae.target=an,ae.relatedTarget=zt,ye=null,ra(ue)===Gt&&(Ie=new Ie(It,wt+"enter",Ne,_,ue),Ie.target=zt,Ie.relatedTarget=an,ye=Ie),an=ye,Ae&&Ne)e:{for(Ie=Ae,It=Ne,wt=0,zt=Ie;zt;zt=rl(zt))wt++;for(zt=0,ye=It;ye;ye=rl(ye))zt++;for(;0<wt-zt;)Ie=rl(Ie),wt--;for(;0<zt-wt;)It=rl(It),zt--;for(;wt--;){if(Ie===It||It!==null&&Ie===It.alternate)break e;Ie=rl(Ie),It=rl(It)}Ie=null}else Ie=null;Ae!==null&&$0(fe,ae,Ae,Ie,!1),Ne!==null&&an!==null&&$0(fe,an,Ne,Ie,!0)}}t:{if(ae=Gt?al(Gt):window,Ae=ae.nodeName&&ae.nodeName.toLowerCase(),Ae==="select"||Ae==="input"&&ae.type==="file")var Re=tI;else if(A0(ae))if(T0)Re=iI;else{Re=sI;var $e=eI}else(Ae=ae.nodeName)&&Ae.toLowerCase()==="input"&&(ae.type==="checkbox"||ae.type==="radio")&&(Re=nI);if(Re&&(Re=Re(d,Gt))){w0(fe,Re,_,ue);break t}$e&&$e(d,ae,Gt),d==="focusout"&&($e=ae._wrapperState)&&$e.controlled&&ae.type==="number"&&De(ae,"number",ae.value)}switch($e=Gt?al(Gt):window,d){case"focusin":(A0($e)||$e.contentEditable==="true")&&(nl=$e,lm=Gt,Cu=null);break;case"focusout":Cu=lm=nl=null;break;case"mousedown":um=!0;break;case"contextmenu":case"mouseup":case"dragend":um=!1,F0(fe,_,ue);break;case"selectionchange":if(aI)break;case"keydown":case"keyup":F0(fe,_,ue)}var qe;if(ns)t:{switch(d){case"compositionstart":var Ze="onCompositionStart";break t;case"compositionend":Ze="onCompositionEnd";break t;case"compositionupdate":Ze="onCompositionUpdate";break t}Ze=void 0}else fr?ia(d,_)&&(Ze="onCompositionEnd"):d==="keydown"&&_.keyCode===229&&(Ze="onCompositionStart");Ze&&(Pn&&_.locale!=="ko"&&(fr||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&fr&&(qe=Ch()):(Zi=ue,Za="value"in Zi?Zi.value:Zi.textContent,fr=!0)),$e=Oh(Gt,Ze),0<$e.length&&(Ze=new bu(Ze,d,null,_,ue),fe.push({event:Ze,listeners:$e}),qe?Ze.data=qe:(qe=Su(_),qe!==null&&(Ze.data=qe)))),(qe=ws?ZM(d,_):KM(d,_))&&(Gt=Oh(Gt,"onBeforeInput"),0<Gt.length&&(ue=new bu("onBeforeInput","beforeinput",null,_,ue),fe.push({event:ue,listeners:Gt}),ue.data=qe))}j0(fe,c)})}function Mu(d,c,_){return{instance:d,listener:c,currentTarget:_}}function Oh(d,c){for(var _=c+"Capture",E=[];d!==null;){var T=d,I=T.stateNode;T.tag===5&&I!==null&&(T=I,I=Tt(d,_),I!=null&&E.unshift(Mu(d,I,T)),I=Tt(d,c),I!=null&&E.push(Mu(d,I,T))),d=d.return}return E}function rl(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function $0(d,c,_,E,T){for(var I=c._reactName,G=[];_!==null&&_!==E;){var rt=_,xt=rt.alternate,Gt=rt.stateNode;if(xt!==null&&xt===E)break;rt.tag===5&&Gt!==null&&(rt=Gt,T?(xt=Tt(_,I),xt!=null&&G.unshift(Mu(_,xt,rt))):T||(xt=Tt(_,I),xt!=null&&G.push(Mu(_,xt,rt)))),_=_.return}G.length!==0&&d.push({event:c,listeners:G})}var hI=/\r\n?/g,cI=/\u0000|\uFFFD/g;function q0(d){return(typeof d=="string"?d:""+d).replace(hI,`
`).replace(cI,"")}function Bh(d,c,_){if(c=q0(c),q0(d)!==c&&_)throw Error(s(425))}function Uh(){}var mm=null,pm=null;function _m(d,c){return d==="textarea"||d==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var ym=typeof setTimeout=="function"?setTimeout:void 0,gI=typeof clearTimeout=="function"?clearTimeout:void 0,Y0=typeof Promise=="function"?Promise:void 0,fI=typeof queueMicrotask=="function"?queueMicrotask:typeof Y0<"u"?function(d){return Y0.resolve(null).then(d).catch(mI)}:ym;function mI(d){setTimeout(function(){throw d})}function xm(d,c){var _=c,E=0;do{var T=_.nextSibling;if(d.removeChild(_),T&&T.nodeType===8)if(_=T.data,_==="/$"){if(E===0){d.removeChild(T),cr(c);return}E--}else _!=="$"&&_!=="$?"&&_!=="$!"||E++;_=T}while(_);cr(c)}function go(d){for(;d!=null;d=d.nextSibling){var c=d.nodeType;if(c===1||c===3)break;if(c===8){if(c=d.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return d}function W0(d){d=d.previousSibling;for(var c=0;d;){if(d.nodeType===8){var _=d.data;if(_==="$"||_==="$!"||_==="$?"){if(c===0)return d;c--}else _==="/$"&&c++}d=d.previousSibling}return null}var ol=Math.random().toString(36).slice(2),mr="__reactFiber$"+ol,Iu="__reactProps$"+ol,kr="__reactContainer$"+ol,vm="__reactEvents$"+ol,pI="__reactListeners$"+ol,_I="__reactHandles$"+ol;function ra(d){var c=d[mr];if(c)return c;for(var _=d.parentNode;_;){if(c=_[kr]||_[mr]){if(_=c.alternate,c.child!==null||_!==null&&_.child!==null)for(d=W0(d);d!==null;){if(_=d[mr])return _;d=W0(d)}return c}d=_,_=d.parentNode}return null}function ku(d){return d=d[mr]||d[kr],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function al(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(s(33))}function Gh(d){return d[Iu]||null}var bm=[],ll=-1;function fo(d){return{current:d}}function Bs(d){0>ll||(d.current=bm[ll],bm[ll]=null,ll--)}function Is(d,c){ll++,bm[ll]=d.current,d.current=c}var mo={},zn=fo(mo),li=fo(!1),oa=mo;function ul(d,c){var _=d.type.contextTypes;if(!_)return mo;var E=d.stateNode;if(E&&E.__reactInternalMemoizedUnmaskedChildContext===c)return E.__reactInternalMemoizedMaskedChildContext;var T={},I;for(I in _)T[I]=c[I];return E&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=c,d.__reactInternalMemoizedMaskedChildContext=T),T}function ui(d){return d=d.childContextTypes,d!=null}function Vh(){Bs(li),Bs(zn)}function X0(d,c,_){if(zn.current!==mo)throw Error(s(168));Is(zn,c),Is(li,_)}function Z0(d,c,_){var E=d.stateNode;if(c=c.childContextTypes,typeof E.getChildContext!="function")return _;E=E.getChildContext();for(var T in E)if(!(T in c))throw Error(s(108,me(d)||"Unknown",T));return Mt({},_,E)}function jh(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||mo,oa=zn.current,Is(zn,d),Is(li,li.current),!0}function K0(d,c,_){var E=d.stateNode;if(!E)throw Error(s(169));_?(d=Z0(d,c,oa),E.__reactInternalMemoizedMergedChildContext=d,Bs(li),Bs(zn),Is(zn,d)):Bs(li),Is(li,_)}var Rr=null,Hh=!1,Em=!1;function Q0(d){Rr===null?Rr=[d]:Rr.push(d)}function yI(d){Hh=!0,Q0(d)}function po(){if(!Em&&Rr!==null){Em=!0;var d=0,c=ne;try{var _=Rr;for(ne=1;d<_.length;d++){var E=_[d];do E=E(!0);while(E!==null)}Rr=null,Hh=!1}catch(T){throw Rr!==null&&(Rr=Rr.slice(d+1)),cs(_t,po),T}finally{ne=c,Em=!1}}return null}var dl=[],hl=0,$h=null,qh=0,Mi=[],Ii=0,aa=null,Fr=1,Pr="";function la(d,c){dl[hl++]=qh,dl[hl++]=$h,$h=d,qh=c}function J0(d,c,_){Mi[Ii++]=Fr,Mi[Ii++]=Pr,Mi[Ii++]=aa,aa=d;var E=Fr;d=Pr;var T=32-jt(E)-1;E&=~(1<<T),_+=1;var I=32-jt(c)+T;if(30<I){var G=T-T%5;I=(E&(1<<G)-1).toString(32),E>>=G,T-=G,Fr=1<<32-jt(c)+T|_<<T|E,Pr=I+d}else Fr=1<<I|_<<T|E,Pr=d}function Sm(d){d.return!==null&&(la(d,1),J0(d,1,0))}function Am(d){for(;d===$h;)$h=dl[--hl],dl[hl]=null,qh=dl[--hl],dl[hl]=null;for(;d===aa;)aa=Mi[--Ii],Mi[Ii]=null,Pr=Mi[--Ii],Mi[Ii]=null,Fr=Mi[--Ii],Mi[Ii]=null}var _i=null,yi=null,$s=!1,Qi=null;function tv(d,c){var _=Pi(5,null,null,0);_.elementType="DELETED",_.stateNode=c,_.return=d,c=d.deletions,c===null?(d.deletions=[_],d.flags|=16):c.push(_)}function ev(d,c){switch(d.tag){case 5:var _=d.type;return c=c.nodeType!==1||_.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(d.stateNode=c,_i=d,yi=go(c.firstChild),!0):!1;case 6:return c=d.pendingProps===""||c.nodeType!==3?null:c,c!==null?(d.stateNode=c,_i=d,yi=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(_=aa!==null?{id:Fr,overflow:Pr}:null,d.memoizedState={dehydrated:c,treeContext:_,retryLane:1073741824},_=Pi(18,null,null,0),_.stateNode=c,_.return=d,d.child=_,_i=d,yi=null,!0):!1;default:return!1}}function wm(d){return(d.mode&1)!==0&&(d.flags&128)===0}function Tm(d){if($s){var c=yi;if(c){var _=c;if(!ev(d,c)){if(wm(d))throw Error(s(418));c=go(_.nextSibling);var E=_i;c&&ev(d,c)?tv(E,_):(d.flags=d.flags&-4097|2,$s=!1,_i=d)}}else{if(wm(d))throw Error(s(418));d.flags=d.flags&-4097|2,$s=!1,_i=d}}}function sv(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;_i=d}function Yh(d){if(d!==_i)return!1;if(!$s)return sv(d),$s=!0,!1;var c;if((c=d.tag!==3)&&!(c=d.tag!==5)&&(c=d.type,c=c!=="head"&&c!=="body"&&!_m(d.type,d.memoizedProps)),c&&(c=yi)){if(wm(d))throw nv(),Error(s(418));for(;c;)tv(d,c),c=go(c.nextSibling)}if(sv(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));t:{for(d=d.nextSibling,c=0;d;){if(d.nodeType===8){var _=d.data;if(_==="/$"){if(c===0){yi=go(d.nextSibling);break t}c--}else _!=="$"&&_!=="$!"&&_!=="$?"||c++}d=d.nextSibling}yi=null}}else yi=_i?go(d.stateNode.nextSibling):null;return!0}function nv(){for(var d=yi;d;)d=go(d.nextSibling)}function cl(){yi=_i=null,$s=!1}function Cm(d){Qi===null?Qi=[d]:Qi.push(d)}var xI=A.ReactCurrentBatchConfig;function Ru(d,c,_){if(d=_.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(_._owner){if(_=_._owner,_){if(_.tag!==1)throw Error(s(309));var E=_.stateNode}if(!E)throw Error(s(147,d));var T=E,I=""+d;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===I?c.ref:(c=function(G){var rt=T.refs;G===null?delete rt[I]:rt[I]=G},c._stringRef=I,c)}if(typeof d!="string")throw Error(s(284));if(!_._owner)throw Error(s(290,d))}return d}function Wh(d,c){throw d=Object.prototype.toString.call(c),Error(s(31,d==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":d))}function iv(d){var c=d._init;return c(d._payload)}function rv(d){function c(It,wt){if(d){var zt=It.deletions;zt===null?(It.deletions=[wt],It.flags|=16):zt.push(wt)}}function _(It,wt){if(!d)return null;for(;wt!==null;)c(It,wt),wt=wt.sibling;return null}function E(It,wt){for(It=new Map;wt!==null;)wt.key!==null?It.set(wt.key,wt):It.set(wt.index,wt),wt=wt.sibling;return It}function T(It,wt){return It=Ao(It,wt),It.index=0,It.sibling=null,It}function I(It,wt,zt){return It.index=zt,d?(zt=It.alternate,zt!==null?(zt=zt.index,zt<wt?(It.flags|=2,wt):zt):(It.flags|=2,wt)):(It.flags|=1048576,wt)}function G(It){return d&&It.alternate===null&&(It.flags|=2),It}function rt(It,wt,zt,ye){return wt===null||wt.tag!==6?(wt=yp(zt,It.mode,ye),wt.return=It,wt):(wt=T(wt,zt),wt.return=It,wt)}function xt(It,wt,zt,ye){var Re=zt.type;return Re===k?ue(It,wt,zt.props.children,ye,zt.key):wt!==null&&(wt.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===ut&&iv(Re)===wt.type)?(ye=T(wt,zt.props),ye.ref=Ru(It,wt,zt),ye.return=It,ye):(ye=yc(zt.type,zt.key,zt.props,null,It.mode,ye),ye.ref=Ru(It,wt,zt),ye.return=It,ye)}function Gt(It,wt,zt,ye){return wt===null||wt.tag!==4||wt.stateNode.containerInfo!==zt.containerInfo||wt.stateNode.implementation!==zt.implementation?(wt=xp(zt,It.mode,ye),wt.return=It,wt):(wt=T(wt,zt.children||[]),wt.return=It,wt)}function ue(It,wt,zt,ye,Re){return wt===null||wt.tag!==7?(wt=pa(zt,It.mode,ye,Re),wt.return=It,wt):(wt=T(wt,zt),wt.return=It,wt)}function fe(It,wt,zt){if(typeof wt=="string"&&wt!==""||typeof wt=="number")return wt=yp(""+wt,It.mode,zt),wt.return=It,wt;if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case w:return zt=yc(wt.type,wt.key,wt.props,null,It.mode,zt),zt.ref=Ru(It,null,wt),zt.return=It,zt;case L:return wt=xp(wt,It.mode,zt),wt.return=It,wt;case ut:var ye=wt._init;return fe(It,ye(wt._payload),zt)}if(He(wt)||ot(wt))return wt=pa(wt,It.mode,zt,null),wt.return=It,wt;Wh(It,wt)}return null}function ae(It,wt,zt,ye){var Re=wt!==null?wt.key:null;if(typeof zt=="string"&&zt!==""||typeof zt=="number")return Re!==null?null:rt(It,wt,""+zt,ye);if(typeof zt=="object"&&zt!==null){switch(zt.$$typeof){case w:return zt.key===Re?xt(It,wt,zt,ye):null;case L:return zt.key===Re?Gt(It,wt,zt,ye):null;case ut:return Re=zt._init,ae(It,wt,Re(zt._payload),ye)}if(He(zt)||ot(zt))return Re!==null?null:ue(It,wt,zt,ye,null);Wh(It,zt)}return null}function Ae(It,wt,zt,ye,Re){if(typeof ye=="string"&&ye!==""||typeof ye=="number")return It=It.get(zt)||null,rt(wt,It,""+ye,Re);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case w:return It=It.get(ye.key===null?zt:ye.key)||null,xt(wt,It,ye,Re);case L:return It=It.get(ye.key===null?zt:ye.key)||null,Gt(wt,It,ye,Re);case ut:var $e=ye._init;return Ae(It,wt,zt,$e(ye._payload),Re)}if(He(ye)||ot(ye))return It=It.get(zt)||null,ue(wt,It,ye,Re,null);Wh(wt,ye)}return null}function Ne(It,wt,zt,ye){for(var Re=null,$e=null,qe=wt,Ze=wt=0,Tn=null;qe!==null&&Ze<zt.length;Ze++){qe.index>Ze?(Tn=qe,qe=null):Tn=qe.sibling;var _s=ae(It,qe,zt[Ze],ye);if(_s===null){qe===null&&(qe=Tn);break}d&&qe&&_s.alternate===null&&c(It,qe),wt=I(_s,wt,Ze),$e===null?Re=_s:$e.sibling=_s,$e=_s,qe=Tn}if(Ze===zt.length)return _(It,qe),$s&&la(It,Ze),Re;if(qe===null){for(;Ze<zt.length;Ze++)qe=fe(It,zt[Ze],ye),qe!==null&&(wt=I(qe,wt,Ze),$e===null?Re=qe:$e.sibling=qe,$e=qe);return $s&&la(It,Ze),Re}for(qe=E(It,qe);Ze<zt.length;Ze++)Tn=Ae(qe,It,Ze,zt[Ze],ye),Tn!==null&&(d&&Tn.alternate!==null&&qe.delete(Tn.key===null?Ze:Tn.key),wt=I(Tn,wt,Ze),$e===null?Re=Tn:$e.sibling=Tn,$e=Tn);return d&&qe.forEach(function(wo){return c(It,wo)}),$s&&la(It,Ze),Re}function Ie(It,wt,zt,ye){var Re=ot(zt);if(typeof Re!="function")throw Error(s(150));if(zt=Re.call(zt),zt==null)throw Error(s(151));for(var $e=Re=null,qe=wt,Ze=wt=0,Tn=null,_s=zt.next();qe!==null&&!_s.done;Ze++,_s=zt.next()){qe.index>Ze?(Tn=qe,qe=null):Tn=qe.sibling;var wo=ae(It,qe,_s.value,ye);if(wo===null){qe===null&&(qe=Tn);break}d&&qe&&wo.alternate===null&&c(It,qe),wt=I(wo,wt,Ze),$e===null?Re=wo:$e.sibling=wo,$e=wo,qe=Tn}if(_s.done)return _(It,qe),$s&&la(It,Ze),Re;if(qe===null){for(;!_s.done;Ze++,_s=zt.next())_s=fe(It,_s.value,ye),_s!==null&&(wt=I(_s,wt,Ze),$e===null?Re=_s:$e.sibling=_s,$e=_s);return $s&&la(It,Ze),Re}for(qe=E(It,qe);!_s.done;Ze++,_s=zt.next())_s=Ae(qe,It,Ze,_s.value,ye),_s!==null&&(d&&_s.alternate!==null&&qe.delete(_s.key===null?Ze:_s.key),wt=I(_s,wt,Ze),$e===null?Re=_s:$e.sibling=_s,$e=_s);return d&&qe.forEach(function(QI){return c(It,QI)}),$s&&la(It,Ze),Re}function an(It,wt,zt,ye){if(typeof zt=="object"&&zt!==null&&zt.type===k&&zt.key===null&&(zt=zt.props.children),typeof zt=="object"&&zt!==null){switch(zt.$$typeof){case w:t:{for(var Re=zt.key,$e=wt;$e!==null;){if($e.key===Re){if(Re=zt.type,Re===k){if($e.tag===7){_(It,$e.sibling),wt=T($e,zt.props.children),wt.return=It,It=wt;break t}}else if($e.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===ut&&iv(Re)===$e.type){_(It,$e.sibling),wt=T($e,zt.props),wt.ref=Ru(It,$e,zt),wt.return=It,It=wt;break t}_(It,$e);break}else c(It,$e);$e=$e.sibling}zt.type===k?(wt=pa(zt.props.children,It.mode,ye,zt.key),wt.return=It,It=wt):(ye=yc(zt.type,zt.key,zt.props,null,It.mode,ye),ye.ref=Ru(It,wt,zt),ye.return=It,It=ye)}return G(It);case L:t:{for($e=zt.key;wt!==null;){if(wt.key===$e)if(wt.tag===4&&wt.stateNode.containerInfo===zt.containerInfo&&wt.stateNode.implementation===zt.implementation){_(It,wt.sibling),wt=T(wt,zt.children||[]),wt.return=It,It=wt;break t}else{_(It,wt);break}else c(It,wt);wt=wt.sibling}wt=xp(zt,It.mode,ye),wt.return=It,It=wt}return G(It);case ut:return $e=zt._init,an(It,wt,$e(zt._payload),ye)}if(He(zt))return Ne(It,wt,zt,ye);if(ot(zt))return Ie(It,wt,zt,ye);Wh(It,zt)}return typeof zt=="string"&&zt!==""||typeof zt=="number"?(zt=""+zt,wt!==null&&wt.tag===6?(_(It,wt.sibling),wt=T(wt,zt),wt.return=It,It=wt):(_(It,wt),wt=yp(zt,It.mode,ye),wt.return=It,It=wt),G(It)):_(It,wt)}return an}var gl=rv(!0),ov=rv(!1),Xh=fo(null),Zh=null,fl=null,Lm=null;function Nm(){Lm=fl=Zh=null}function Mm(d){var c=Xh.current;Bs(Xh),d._currentValue=c}function Im(d,c,_){for(;d!==null;){var E=d.alternate;if((d.childLanes&c)!==c?(d.childLanes|=c,E!==null&&(E.childLanes|=c)):E!==null&&(E.childLanes&c)!==c&&(E.childLanes|=c),d===_)break;d=d.return}}function ml(d,c){Zh=d,Lm=fl=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&c)!==0&&(di=!0),d.firstContext=null)}function ki(d){var c=d._currentValue;if(Lm!==d)if(d={context:d,memoizedValue:c,next:null},fl===null){if(Zh===null)throw Error(s(308));fl=d,Zh.dependencies={lanes:0,firstContext:d}}else fl=fl.next=d;return c}var ua=null;function km(d){ua===null?ua=[d]:ua.push(d)}function av(d,c,_,E){var T=c.interleaved;return T===null?(_.next=_,km(c)):(_.next=T.next,T.next=_),c.interleaved=_,zr(d,E)}function zr(d,c){d.lanes|=c;var _=d.alternate;for(_!==null&&(_.lanes|=c),_=d,d=d.return;d!==null;)d.childLanes|=c,_=d.alternate,_!==null&&(_.childLanes|=c),_=d,d=d.return;return _.tag===3?_.stateNode:null}var _o=!1;function Rm(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lv(d,c){d=d.updateQueue,c.updateQueue===d&&(c.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function Dr(d,c){return{eventTime:d,lane:c,tag:0,payload:null,callback:null,next:null}}function yo(d,c,_){var E=d.updateQueue;if(E===null)return null;if(E=E.shared,(fs&2)!==0){var T=E.pending;return T===null?c.next=c:(c.next=T.next,T.next=c),E.pending=c,zr(d,_)}return T=E.interleaved,T===null?(c.next=c,km(E)):(c.next=T.next,T.next=c),E.interleaved=c,zr(d,_)}function Kh(d,c,_){if(c=c.updateQueue,c!==null&&(c=c.shared,(_&4194240)!==0)){var E=c.lanes;E&=d.pendingLanes,_|=E,c.lanes=_,Zt(d,_)}}function uv(d,c){var _=d.updateQueue,E=d.alternate;if(E!==null&&(E=E.updateQueue,_===E)){var T=null,I=null;if(_=_.firstBaseUpdate,_!==null){do{var G={eventTime:_.eventTime,lane:_.lane,tag:_.tag,payload:_.payload,callback:_.callback,next:null};I===null?T=I=G:I=I.next=G,_=_.next}while(_!==null);I===null?T=I=c:I=I.next=c}else T=I=c;_={baseState:E.baseState,firstBaseUpdate:T,lastBaseUpdate:I,shared:E.shared,effects:E.effects},d.updateQueue=_;return}d=_.lastBaseUpdate,d===null?_.firstBaseUpdate=c:d.next=c,_.lastBaseUpdate=c}function Qh(d,c,_,E){var T=d.updateQueue;_o=!1;var I=T.firstBaseUpdate,G=T.lastBaseUpdate,rt=T.shared.pending;if(rt!==null){T.shared.pending=null;var xt=rt,Gt=xt.next;xt.next=null,G===null?I=Gt:G.next=Gt,G=xt;var ue=d.alternate;ue!==null&&(ue=ue.updateQueue,rt=ue.lastBaseUpdate,rt!==G&&(rt===null?ue.firstBaseUpdate=Gt:rt.next=Gt,ue.lastBaseUpdate=xt))}if(I!==null){var fe=T.baseState;G=0,ue=Gt=xt=null,rt=I;do{var ae=rt.lane,Ae=rt.eventTime;if((E&ae)===ae){ue!==null&&(ue=ue.next={eventTime:Ae,lane:0,tag:rt.tag,payload:rt.payload,callback:rt.callback,next:null});t:{var Ne=d,Ie=rt;switch(ae=c,Ae=_,Ie.tag){case 1:if(Ne=Ie.payload,typeof Ne=="function"){fe=Ne.call(Ae,fe,ae);break t}fe=Ne;break t;case 3:Ne.flags=Ne.flags&-65537|128;case 0:if(Ne=Ie.payload,ae=typeof Ne=="function"?Ne.call(Ae,fe,ae):Ne,ae==null)break t;fe=Mt({},fe,ae);break t;case 2:_o=!0}}rt.callback!==null&&rt.lane!==0&&(d.flags|=64,ae=T.effects,ae===null?T.effects=[rt]:ae.push(rt))}else Ae={eventTime:Ae,lane:ae,tag:rt.tag,payload:rt.payload,callback:rt.callback,next:null},ue===null?(Gt=ue=Ae,xt=fe):ue=ue.next=Ae,G|=ae;if(rt=rt.next,rt===null){if(rt=T.shared.pending,rt===null)break;ae=rt,rt=ae.next,ae.next=null,T.lastBaseUpdate=ae,T.shared.pending=null}}while(!0);if(ue===null&&(xt=fe),T.baseState=xt,T.firstBaseUpdate=Gt,T.lastBaseUpdate=ue,c=T.shared.interleaved,c!==null){T=c;do G|=T.lane,T=T.next;while(T!==c)}else I===null&&(T.shared.lanes=0);ca|=G,d.lanes=G,d.memoizedState=fe}}function dv(d,c,_){if(d=c.effects,c.effects=null,d!==null)for(c=0;c<d.length;c++){var E=d[c],T=E.callback;if(T!==null){if(E.callback=null,E=_,typeof T!="function")throw Error(s(191,T));T.call(E)}}}var Fu={},pr=fo(Fu),Pu=fo(Fu),zu=fo(Fu);function da(d){if(d===Fu)throw Error(s(174));return d}function Fm(d,c){switch(Is(zu,c),Is(Pu,d),Is(pr,Fu),d=c.nodeType,d){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Cs(null,"");break;default:d=d===8?c.parentNode:c,c=d.namespaceURI||null,d=d.tagName,c=Cs(c,d)}Bs(pr),Is(pr,c)}function pl(){Bs(pr),Bs(Pu),Bs(zu)}function hv(d){da(zu.current);var c=da(pr.current),_=Cs(c,d.type);c!==_&&(Is(Pu,d),Is(pr,_))}function Pm(d){Pu.current===d&&(Bs(pr),Bs(Pu))}var Zs=fo(0);function Jh(d){for(var c=d;c!==null;){if(c.tag===13){var _=c.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||_.data==="$?"||_.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===d)break;for(;c.sibling===null;){if(c.return===null||c.return===d)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var zm=[];function Dm(){for(var d=0;d<zm.length;d++)zm[d]._workInProgressVersionPrimary=null;zm.length=0}var tc=A.ReactCurrentDispatcher,Om=A.ReactCurrentBatchConfig,ha=0,Ks=null,yn=null,An=null,ec=!1,Du=!1,Ou=0,vI=0;function Dn(){throw Error(s(321))}function Bm(d,c){if(c===null)return!1;for(var _=0;_<c.length&&_<d.length;_++)if(!Ki(d[_],c[_]))return!1;return!0}function Um(d,c,_,E,T,I){if(ha=I,Ks=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,tc.current=d===null||d.memoizedState===null?AI:wI,d=_(E,T),Du){I=0;do{if(Du=!1,Ou=0,25<=I)throw Error(s(301));I+=1,An=yn=null,c.updateQueue=null,tc.current=TI,d=_(E,T)}while(Du)}if(tc.current=ic,c=yn!==null&&yn.next!==null,ha=0,An=yn=Ks=null,ec=!1,c)throw Error(s(300));return d}function Gm(){var d=Ou!==0;return Ou=0,d}function _r(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return An===null?Ks.memoizedState=An=d:An=An.next=d,An}function Ri(){if(yn===null){var d=Ks.alternate;d=d!==null?d.memoizedState:null}else d=yn.next;var c=An===null?Ks.memoizedState:An.next;if(c!==null)An=c,yn=d;else{if(d===null)throw Error(s(310));yn=d,d={memoizedState:yn.memoizedState,baseState:yn.baseState,baseQueue:yn.baseQueue,queue:yn.queue,next:null},An===null?Ks.memoizedState=An=d:An=An.next=d}return An}function Bu(d,c){return typeof c=="function"?c(d):c}function Vm(d){var c=Ri(),_=c.queue;if(_===null)throw Error(s(311));_.lastRenderedReducer=d;var E=yn,T=E.baseQueue,I=_.pending;if(I!==null){if(T!==null){var G=T.next;T.next=I.next,I.next=G}E.baseQueue=T=I,_.pending=null}if(T!==null){I=T.next,E=E.baseState;var rt=G=null,xt=null,Gt=I;do{var ue=Gt.lane;if((ha&ue)===ue)xt!==null&&(xt=xt.next={lane:0,action:Gt.action,hasEagerState:Gt.hasEagerState,eagerState:Gt.eagerState,next:null}),E=Gt.hasEagerState?Gt.eagerState:d(E,Gt.action);else{var fe={lane:ue,action:Gt.action,hasEagerState:Gt.hasEagerState,eagerState:Gt.eagerState,next:null};xt===null?(rt=xt=fe,G=E):xt=xt.next=fe,Ks.lanes|=ue,ca|=ue}Gt=Gt.next}while(Gt!==null&&Gt!==I);xt===null?G=E:xt.next=rt,Ki(E,c.memoizedState)||(di=!0),c.memoizedState=E,c.baseState=G,c.baseQueue=xt,_.lastRenderedState=E}if(d=_.interleaved,d!==null){T=d;do I=T.lane,Ks.lanes|=I,ca|=I,T=T.next;while(T!==d)}else T===null&&(_.lanes=0);return[c.memoizedState,_.dispatch]}function jm(d){var c=Ri(),_=c.queue;if(_===null)throw Error(s(311));_.lastRenderedReducer=d;var E=_.dispatch,T=_.pending,I=c.memoizedState;if(T!==null){_.pending=null;var G=T=T.next;do I=d(I,G.action),G=G.next;while(G!==T);Ki(I,c.memoizedState)||(di=!0),c.memoizedState=I,c.baseQueue===null&&(c.baseState=I),_.lastRenderedState=I}return[I,E]}function cv(){}function gv(d,c){var _=Ks,E=Ri(),T=c(),I=!Ki(E.memoizedState,T);if(I&&(E.memoizedState=T,di=!0),E=E.queue,Hm(pv.bind(null,_,E,d),[d]),E.getSnapshot!==c||I||An!==null&&An.memoizedState.tag&1){if(_.flags|=2048,Uu(9,mv.bind(null,_,E,T,c),void 0,null),wn===null)throw Error(s(349));(ha&30)!==0||fv(_,c,T)}return T}function fv(d,c,_){d.flags|=16384,d={getSnapshot:c,value:_},c=Ks.updateQueue,c===null?(c={lastEffect:null,stores:null},Ks.updateQueue=c,c.stores=[d]):(_=c.stores,_===null?c.stores=[d]:_.push(d))}function mv(d,c,_,E){c.value=_,c.getSnapshot=E,_v(c)&&yv(d)}function pv(d,c,_){return _(function(){_v(c)&&yv(d)})}function _v(d){var c=d.getSnapshot;d=d.value;try{var _=c();return!Ki(d,_)}catch{return!0}}function yv(d){var c=zr(d,1);c!==null&&sr(c,d,1,-1)}function xv(d){var c=_r();return typeof d=="function"&&(d=d()),c.memoizedState=c.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bu,lastRenderedState:d},c.queue=d,d=d.dispatch=SI.bind(null,Ks,d),[c.memoizedState,d]}function Uu(d,c,_,E){return d={tag:d,create:c,destroy:_,deps:E,next:null},c=Ks.updateQueue,c===null?(c={lastEffect:null,stores:null},Ks.updateQueue=c,c.lastEffect=d.next=d):(_=c.lastEffect,_===null?c.lastEffect=d.next=d:(E=_.next,_.next=d,d.next=E,c.lastEffect=d)),d}function vv(){return Ri().memoizedState}function sc(d,c,_,E){var T=_r();Ks.flags|=d,T.memoizedState=Uu(1|c,_,void 0,E===void 0?null:E)}function nc(d,c,_,E){var T=Ri();E=E===void 0?null:E;var I=void 0;if(yn!==null){var G=yn.memoizedState;if(I=G.destroy,E!==null&&Bm(E,G.deps)){T.memoizedState=Uu(c,_,I,E);return}}Ks.flags|=d,T.memoizedState=Uu(1|c,_,I,E)}function bv(d,c){return sc(8390656,8,d,c)}function Hm(d,c){return nc(2048,8,d,c)}function Ev(d,c){return nc(4,2,d,c)}function Sv(d,c){return nc(4,4,d,c)}function Av(d,c){if(typeof c=="function")return d=d(),c(d),function(){c(null)};if(c!=null)return d=d(),c.current=d,function(){c.current=null}}function wv(d,c,_){return _=_!=null?_.concat([d]):null,nc(4,4,Av.bind(null,c,d),_)}function $m(){}function Tv(d,c){var _=Ri();c=c===void 0?null:c;var E=_.memoizedState;return E!==null&&c!==null&&Bm(c,E[1])?E[0]:(_.memoizedState=[d,c],d)}function Cv(d,c){var _=Ri();c=c===void 0?null:c;var E=_.memoizedState;return E!==null&&c!==null&&Bm(c,E[1])?E[0]:(d=d(),_.memoizedState=[d,c],d)}function Lv(d,c,_){return(ha&21)===0?(d.baseState&&(d.baseState=!1,di=!0),d.memoizedState=_):(Ki(_,c)||(_=W(),Ks.lanes|=_,ca|=_,d.baseState=!0),c)}function bI(d,c){var _=ne;ne=_!==0&&4>_?_:4,d(!0);var E=Om.transition;Om.transition={};try{d(!1),c()}finally{ne=_,Om.transition=E}}function Nv(){return Ri().memoizedState}function EI(d,c,_){var E=Eo(d);if(_={lane:E,action:_,hasEagerState:!1,eagerState:null,next:null},Mv(d))Iv(c,_);else if(_=av(d,c,_,E),_!==null){var T=Qn();sr(_,d,E,T),kv(_,c,E)}}function SI(d,c,_){var E=Eo(d),T={lane:E,action:_,hasEagerState:!1,eagerState:null,next:null};if(Mv(d))Iv(c,T);else{var I=d.alternate;if(d.lanes===0&&(I===null||I.lanes===0)&&(I=c.lastRenderedReducer,I!==null))try{var G=c.lastRenderedState,rt=I(G,_);if(T.hasEagerState=!0,T.eagerState=rt,Ki(rt,G)){var xt=c.interleaved;xt===null?(T.next=T,km(c)):(T.next=xt.next,xt.next=T),c.interleaved=T;return}}catch{}finally{}_=av(d,c,T,E),_!==null&&(T=Qn(),sr(_,d,E,T),kv(_,c,E))}}function Mv(d){var c=d.alternate;return d===Ks||c!==null&&c===Ks}function Iv(d,c){Du=ec=!0;var _=d.pending;_===null?c.next=c:(c.next=_.next,_.next=c),d.pending=c}function kv(d,c,_){if((_&4194240)!==0){var E=c.lanes;E&=d.pendingLanes,_|=E,c.lanes=_,Zt(d,_)}}var ic={readContext:ki,useCallback:Dn,useContext:Dn,useEffect:Dn,useImperativeHandle:Dn,useInsertionEffect:Dn,useLayoutEffect:Dn,useMemo:Dn,useReducer:Dn,useRef:Dn,useState:Dn,useDebugValue:Dn,useDeferredValue:Dn,useTransition:Dn,useMutableSource:Dn,useSyncExternalStore:Dn,useId:Dn,unstable_isNewReconciler:!1},AI={readContext:ki,useCallback:function(d,c){return _r().memoizedState=[d,c===void 0?null:c],d},useContext:ki,useEffect:bv,useImperativeHandle:function(d,c,_){return _=_!=null?_.concat([d]):null,sc(4194308,4,Av.bind(null,c,d),_)},useLayoutEffect:function(d,c){return sc(4194308,4,d,c)},useInsertionEffect:function(d,c){return sc(4,2,d,c)},useMemo:function(d,c){var _=_r();return c=c===void 0?null:c,d=d(),_.memoizedState=[d,c],d},useReducer:function(d,c,_){var E=_r();return c=_!==void 0?_(c):c,E.memoizedState=E.baseState=c,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:c},E.queue=d,d=d.dispatch=EI.bind(null,Ks,d),[E.memoizedState,d]},useRef:function(d){var c=_r();return d={current:d},c.memoizedState=d},useState:xv,useDebugValue:$m,useDeferredValue:function(d){return _r().memoizedState=d},useTransition:function(){var d=xv(!1),c=d[0];return d=bI.bind(null,d[1]),_r().memoizedState=d,[c,d]},useMutableSource:function(){},useSyncExternalStore:function(d,c,_){var E=Ks,T=_r();if($s){if(_===void 0)throw Error(s(407));_=_()}else{if(_=c(),wn===null)throw Error(s(349));(ha&30)!==0||fv(E,c,_)}T.memoizedState=_;var I={value:_,getSnapshot:c};return T.queue=I,bv(pv.bind(null,E,I,d),[d]),E.flags|=2048,Uu(9,mv.bind(null,E,I,_,c),void 0,null),_},useId:function(){var d=_r(),c=wn.identifierPrefix;if($s){var _=Pr,E=Fr;_=(E&~(1<<32-jt(E)-1)).toString(32)+_,c=":"+c+"R"+_,_=Ou++,0<_&&(c+="H"+_.toString(32)),c+=":"}else _=vI++,c=":"+c+"r"+_.toString(32)+":";return d.memoizedState=c},unstable_isNewReconciler:!1},wI={readContext:ki,useCallback:Tv,useContext:ki,useEffect:Hm,useImperativeHandle:wv,useInsertionEffect:Ev,useLayoutEffect:Sv,useMemo:Cv,useReducer:Vm,useRef:vv,useState:function(){return Vm(Bu)},useDebugValue:$m,useDeferredValue:function(d){var c=Ri();return Lv(c,yn.memoizedState,d)},useTransition:function(){var d=Vm(Bu)[0],c=Ri().memoizedState;return[d,c]},useMutableSource:cv,useSyncExternalStore:gv,useId:Nv,unstable_isNewReconciler:!1},TI={readContext:ki,useCallback:Tv,useContext:ki,useEffect:Hm,useImperativeHandle:wv,useInsertionEffect:Ev,useLayoutEffect:Sv,useMemo:Cv,useReducer:jm,useRef:vv,useState:function(){return jm(Bu)},useDebugValue:$m,useDeferredValue:function(d){var c=Ri();return yn===null?c.memoizedState=d:Lv(c,yn.memoizedState,d)},useTransition:function(){var d=jm(Bu)[0],c=Ri().memoizedState;return[d,c]},useMutableSource:cv,useSyncExternalStore:gv,useId:Nv,unstable_isNewReconciler:!1};function Ji(d,c){if(d&&d.defaultProps){c=Mt({},c),d=d.defaultProps;for(var _ in d)c[_]===void 0&&(c[_]=d[_]);return c}return c}function qm(d,c,_,E){c=d.memoizedState,_=_(E,c),_=_==null?c:Mt({},c,_),d.memoizedState=_,d.lanes===0&&(d.updateQueue.baseState=_)}var rc={isMounted:function(d){return(d=d._reactInternals)?je(d)===d:!1},enqueueSetState:function(d,c,_){d=d._reactInternals;var E=Qn(),T=Eo(d),I=Dr(E,T);I.payload=c,_!=null&&(I.callback=_),c=yo(d,I,T),c!==null&&(sr(c,d,T,E),Kh(c,d,T))},enqueueReplaceState:function(d,c,_){d=d._reactInternals;var E=Qn(),T=Eo(d),I=Dr(E,T);I.tag=1,I.payload=c,_!=null&&(I.callback=_),c=yo(d,I,T),c!==null&&(sr(c,d,T,E),Kh(c,d,T))},enqueueForceUpdate:function(d,c){d=d._reactInternals;var _=Qn(),E=Eo(d),T=Dr(_,E);T.tag=2,c!=null&&(T.callback=c),c=yo(d,T,E),c!==null&&(sr(c,d,E,_),Kh(c,d,E))}};function Rv(d,c,_,E,T,I,G){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(E,I,G):c.prototype&&c.prototype.isPureReactComponent?!Tu(_,E)||!Tu(T,I):!0}function Fv(d,c,_){var E=!1,T=mo,I=c.contextType;return typeof I=="object"&&I!==null?I=ki(I):(T=ui(c)?oa:zn.current,E=c.contextTypes,I=(E=E!=null)?ul(d,T):mo),c=new c(_,I),d.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=rc,d.stateNode=c,c._reactInternals=d,E&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=T,d.__reactInternalMemoizedMaskedChildContext=I),c}function Pv(d,c,_,E){d=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(_,E),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(_,E),c.state!==d&&rc.enqueueReplaceState(c,c.state,null)}function Ym(d,c,_,E){var T=d.stateNode;T.props=_,T.state=d.memoizedState,T.refs={},Rm(d);var I=c.contextType;typeof I=="object"&&I!==null?T.context=ki(I):(I=ui(c)?oa:zn.current,T.context=ul(d,I)),T.state=d.memoizedState,I=c.getDerivedStateFromProps,typeof I=="function"&&(qm(d,c,I,_),T.state=d.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(c=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),c!==T.state&&rc.enqueueReplaceState(T,T.state,null),Qh(d,_,T,E),T.state=d.memoizedState),typeof T.componentDidMount=="function"&&(d.flags|=4194308)}function _l(d,c){try{var _="",E=c;do _+=Wt(E),E=E.return;while(E);var T=_}catch(I){T=`
Error generating stack: `+I.message+`
`+I.stack}return{value:d,source:c,stack:T,digest:null}}function Wm(d,c,_){return{value:d,source:null,stack:_??null,digest:c??null}}function Xm(d,c){try{console.error(c.value)}catch(_){setTimeout(function(){throw _})}}var CI=typeof WeakMap=="function"?WeakMap:Map;function zv(d,c,_){_=Dr(-1,_),_.tag=3,_.payload={element:null};var E=c.value;return _.callback=function(){cc||(cc=!0,dp=E),Xm(d,c)},_}function Dv(d,c,_){_=Dr(-1,_),_.tag=3;var E=d.type.getDerivedStateFromError;if(typeof E=="function"){var T=c.value;_.payload=function(){return E(T)},_.callback=function(){Xm(d,c)}}var I=d.stateNode;return I!==null&&typeof I.componentDidCatch=="function"&&(_.callback=function(){Xm(d,c),typeof E!="function"&&(vo===null?vo=new Set([this]):vo.add(this));var G=c.stack;this.componentDidCatch(c.value,{componentStack:G!==null?G:""})}),_}function Ov(d,c,_){var E=d.pingCache;if(E===null){E=d.pingCache=new CI;var T=new Set;E.set(c,T)}else T=E.get(c),T===void 0&&(T=new Set,E.set(c,T));T.has(_)||(T.add(_),d=GI.bind(null,d,c,_),c.then(d,d))}function Bv(d){do{var c;if((c=d.tag===13)&&(c=d.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return d;d=d.return}while(d!==null);return null}function Uv(d,c,_,E,T){return(d.mode&1)===0?(d===c?d.flags|=65536:(d.flags|=128,_.flags|=131072,_.flags&=-52805,_.tag===1&&(_.alternate===null?_.tag=17:(c=Dr(-1,1),c.tag=2,yo(_,c,1))),_.lanes|=1),d):(d.flags|=65536,d.lanes=T,d)}var LI=A.ReactCurrentOwner,di=!1;function Kn(d,c,_,E){c.child=d===null?ov(c,null,_,E):gl(c,d.child,_,E)}function Gv(d,c,_,E,T){_=_.render;var I=c.ref;return ml(c,T),E=Um(d,c,_,E,I,T),_=Gm(),d!==null&&!di?(c.updateQueue=d.updateQueue,c.flags&=-2053,d.lanes&=~T,Or(d,c,T)):($s&&_&&Sm(c),c.flags|=1,Kn(d,c,E,T),c.child)}function Vv(d,c,_,E,T){if(d===null){var I=_.type;return typeof I=="function"&&!_p(I)&&I.defaultProps===void 0&&_.compare===null&&_.defaultProps===void 0?(c.tag=15,c.type=I,jv(d,c,I,E,T)):(d=yc(_.type,null,E,c,c.mode,T),d.ref=c.ref,d.return=c,c.child=d)}if(I=d.child,(d.lanes&T)===0){var G=I.memoizedProps;if(_=_.compare,_=_!==null?_:Tu,_(G,E)&&d.ref===c.ref)return Or(d,c,T)}return c.flags|=1,d=Ao(I,E),d.ref=c.ref,d.return=c,c.child=d}function jv(d,c,_,E,T){if(d!==null){var I=d.memoizedProps;if(Tu(I,E)&&d.ref===c.ref)if(di=!1,c.pendingProps=E=I,(d.lanes&T)!==0)(d.flags&131072)!==0&&(di=!0);else return c.lanes=d.lanes,Or(d,c,T)}return Zm(d,c,_,E,T)}function Hv(d,c,_){var E=c.pendingProps,T=E.children,I=d!==null?d.memoizedState:null;if(E.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},Is(xl,xi),xi|=_;else{if((_&1073741824)===0)return d=I!==null?I.baseLanes|_:_,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:d,cachePool:null,transitions:null},c.updateQueue=null,Is(xl,xi),xi|=d,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},E=I!==null?I.baseLanes:_,Is(xl,xi),xi|=E}else I!==null?(E=I.baseLanes|_,c.memoizedState=null):E=_,Is(xl,xi),xi|=E;return Kn(d,c,T,_),c.child}function $v(d,c){var _=c.ref;(d===null&&_!==null||d!==null&&d.ref!==_)&&(c.flags|=512,c.flags|=2097152)}function Zm(d,c,_,E,T){var I=ui(_)?oa:zn.current;return I=ul(c,I),ml(c,T),_=Um(d,c,_,E,I,T),E=Gm(),d!==null&&!di?(c.updateQueue=d.updateQueue,c.flags&=-2053,d.lanes&=~T,Or(d,c,T)):($s&&E&&Sm(c),c.flags|=1,Kn(d,c,_,T),c.child)}function qv(d,c,_,E,T){if(ui(_)){var I=!0;jh(c)}else I=!1;if(ml(c,T),c.stateNode===null)ac(d,c),Fv(c,_,E),Ym(c,_,E,T),E=!0;else if(d===null){var G=c.stateNode,rt=c.memoizedProps;G.props=rt;var xt=G.context,Gt=_.contextType;typeof Gt=="object"&&Gt!==null?Gt=ki(Gt):(Gt=ui(_)?oa:zn.current,Gt=ul(c,Gt));var ue=_.getDerivedStateFromProps,fe=typeof ue=="function"||typeof G.getSnapshotBeforeUpdate=="function";fe||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(rt!==E||xt!==Gt)&&Pv(c,G,E,Gt),_o=!1;var ae=c.memoizedState;G.state=ae,Qh(c,E,G,T),xt=c.memoizedState,rt!==E||ae!==xt||li.current||_o?(typeof ue=="function"&&(qm(c,_,ue,E),xt=c.memoizedState),(rt=_o||Rv(c,_,rt,E,ae,xt,Gt))?(fe||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(c.flags|=4194308)):(typeof G.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=E,c.memoizedState=xt),G.props=E,G.state=xt,G.context=Gt,E=rt):(typeof G.componentDidMount=="function"&&(c.flags|=4194308),E=!1)}else{G=c.stateNode,lv(d,c),rt=c.memoizedProps,Gt=c.type===c.elementType?rt:Ji(c.type,rt),G.props=Gt,fe=c.pendingProps,ae=G.context,xt=_.contextType,typeof xt=="object"&&xt!==null?xt=ki(xt):(xt=ui(_)?oa:zn.current,xt=ul(c,xt));var Ae=_.getDerivedStateFromProps;(ue=typeof Ae=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(rt!==fe||ae!==xt)&&Pv(c,G,E,xt),_o=!1,ae=c.memoizedState,G.state=ae,Qh(c,E,G,T);var Ne=c.memoizedState;rt!==fe||ae!==Ne||li.current||_o?(typeof Ae=="function"&&(qm(c,_,Ae,E),Ne=c.memoizedState),(Gt=_o||Rv(c,_,Gt,E,ae,Ne,xt)||!1)?(ue||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(E,Ne,xt),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(E,Ne,xt)),typeof G.componentDidUpdate=="function"&&(c.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof G.componentDidUpdate!="function"||rt===d.memoizedProps&&ae===d.memoizedState||(c.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||rt===d.memoizedProps&&ae===d.memoizedState||(c.flags|=1024),c.memoizedProps=E,c.memoizedState=Ne),G.props=E,G.state=Ne,G.context=xt,E=Gt):(typeof G.componentDidUpdate!="function"||rt===d.memoizedProps&&ae===d.memoizedState||(c.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||rt===d.memoizedProps&&ae===d.memoizedState||(c.flags|=1024),E=!1)}return Km(d,c,_,E,I,T)}function Km(d,c,_,E,T,I){$v(d,c);var G=(c.flags&128)!==0;if(!E&&!G)return T&&K0(c,_,!1),Or(d,c,I);E=c.stateNode,LI.current=c;var rt=G&&typeof _.getDerivedStateFromError!="function"?null:E.render();return c.flags|=1,d!==null&&G?(c.child=gl(c,d.child,null,I),c.child=gl(c,null,rt,I)):Kn(d,c,rt,I),c.memoizedState=E.state,T&&K0(c,_,!0),c.child}function Yv(d){var c=d.stateNode;c.pendingContext?X0(d,c.pendingContext,c.pendingContext!==c.context):c.context&&X0(d,c.context,!1),Fm(d,c.containerInfo)}function Wv(d,c,_,E,T){return cl(),Cm(T),c.flags|=256,Kn(d,c,_,E),c.child}var Qm={dehydrated:null,treeContext:null,retryLane:0};function Jm(d){return{baseLanes:d,cachePool:null,transitions:null}}function Xv(d,c,_){var E=c.pendingProps,T=Zs.current,I=!1,G=(c.flags&128)!==0,rt;if((rt=G)||(rt=d!==null&&d.memoizedState===null?!1:(T&2)!==0),rt?(I=!0,c.flags&=-129):(d===null||d.memoizedState!==null)&&(T|=1),Is(Zs,T&1),d===null)return Tm(c),d=c.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((c.mode&1)===0?c.lanes=1:d.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(G=E.children,d=E.fallback,I?(E=c.mode,I=c.child,G={mode:"hidden",children:G},(E&1)===0&&I!==null?(I.childLanes=0,I.pendingProps=G):I=xc(G,E,0,null),d=pa(d,E,_,null),I.return=c,d.return=c,I.sibling=d,c.child=I,c.child.memoizedState=Jm(_),c.memoizedState=Qm,d):tp(c,G));if(T=d.memoizedState,T!==null&&(rt=T.dehydrated,rt!==null))return NI(d,c,G,E,rt,T,_);if(I){I=E.fallback,G=c.mode,T=d.child,rt=T.sibling;var xt={mode:"hidden",children:E.children};return(G&1)===0&&c.child!==T?(E=c.child,E.childLanes=0,E.pendingProps=xt,c.deletions=null):(E=Ao(T,xt),E.subtreeFlags=T.subtreeFlags&14680064),rt!==null?I=Ao(rt,I):(I=pa(I,G,_,null),I.flags|=2),I.return=c,E.return=c,E.sibling=I,c.child=E,E=I,I=c.child,G=d.child.memoizedState,G=G===null?Jm(_):{baseLanes:G.baseLanes|_,cachePool:null,transitions:G.transitions},I.memoizedState=G,I.childLanes=d.childLanes&~_,c.memoizedState=Qm,E}return I=d.child,d=I.sibling,E=Ao(I,{mode:"visible",children:E.children}),(c.mode&1)===0&&(E.lanes=_),E.return=c,E.sibling=null,d!==null&&(_=c.deletions,_===null?(c.deletions=[d],c.flags|=16):_.push(d)),c.child=E,c.memoizedState=null,E}function tp(d,c){return c=xc({mode:"visible",children:c},d.mode,0,null),c.return=d,d.child=c}function oc(d,c,_,E){return E!==null&&Cm(E),gl(c,d.child,null,_),d=tp(c,c.pendingProps.children),d.flags|=2,c.memoizedState=null,d}function NI(d,c,_,E,T,I,G){if(_)return c.flags&256?(c.flags&=-257,E=Wm(Error(s(422))),oc(d,c,G,E)):c.memoizedState!==null?(c.child=d.child,c.flags|=128,null):(I=E.fallback,T=c.mode,E=xc({mode:"visible",children:E.children},T,0,null),I=pa(I,T,G,null),I.flags|=2,E.return=c,I.return=c,E.sibling=I,c.child=E,(c.mode&1)!==0&&gl(c,d.child,null,G),c.child.memoizedState=Jm(G),c.memoizedState=Qm,I);if((c.mode&1)===0)return oc(d,c,G,null);if(T.data==="$!"){if(E=T.nextSibling&&T.nextSibling.dataset,E)var rt=E.dgst;return E=rt,I=Error(s(419)),E=Wm(I,E,void 0),oc(d,c,G,E)}if(rt=(G&d.childLanes)!==0,di||rt){if(E=wn,E!==null){switch(G&-G){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=(T&(E.suspendedLanes|G))!==0?0:T,T!==0&&T!==I.retryLane&&(I.retryLane=T,zr(d,T),sr(E,d,T,-1))}return pp(),E=Wm(Error(s(421))),oc(d,c,G,E)}return T.data==="$?"?(c.flags|=128,c.child=d.child,c=VI.bind(null,d),T._reactRetry=c,null):(d=I.treeContext,yi=go(T.nextSibling),_i=c,$s=!0,Qi=null,d!==null&&(Mi[Ii++]=Fr,Mi[Ii++]=Pr,Mi[Ii++]=aa,Fr=d.id,Pr=d.overflow,aa=c),c=tp(c,E.children),c.flags|=4096,c)}function Zv(d,c,_){d.lanes|=c;var E=d.alternate;E!==null&&(E.lanes|=c),Im(d.return,c,_)}function ep(d,c,_,E,T){var I=d.memoizedState;I===null?d.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:E,tail:_,tailMode:T}:(I.isBackwards=c,I.rendering=null,I.renderingStartTime=0,I.last=E,I.tail=_,I.tailMode=T)}function Kv(d,c,_){var E=c.pendingProps,T=E.revealOrder,I=E.tail;if(Kn(d,c,E.children,_),E=Zs.current,(E&2)!==0)E=E&1|2,c.flags|=128;else{if(d!==null&&(d.flags&128)!==0)t:for(d=c.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&Zv(d,_,c);else if(d.tag===19)Zv(d,_,c);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break t;for(;d.sibling===null;){if(d.return===null||d.return===c)break t;d=d.return}d.sibling.return=d.return,d=d.sibling}E&=1}if(Is(Zs,E),(c.mode&1)===0)c.memoizedState=null;else switch(T){case"forwards":for(_=c.child,T=null;_!==null;)d=_.alternate,d!==null&&Jh(d)===null&&(T=_),_=_.sibling;_=T,_===null?(T=c.child,c.child=null):(T=_.sibling,_.sibling=null),ep(c,!1,T,_,I);break;case"backwards":for(_=null,T=c.child,c.child=null;T!==null;){if(d=T.alternate,d!==null&&Jh(d)===null){c.child=T;break}d=T.sibling,T.sibling=_,_=T,T=d}ep(c,!0,_,null,I);break;case"together":ep(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function ac(d,c){(c.mode&1)===0&&d!==null&&(d.alternate=null,c.alternate=null,c.flags|=2)}function Or(d,c,_){if(d!==null&&(c.dependencies=d.dependencies),ca|=c.lanes,(_&c.childLanes)===0)return null;if(d!==null&&c.child!==d.child)throw Error(s(153));if(c.child!==null){for(d=c.child,_=Ao(d,d.pendingProps),c.child=_,_.return=c;d.sibling!==null;)d=d.sibling,_=_.sibling=Ao(d,d.pendingProps),_.return=c;_.sibling=null}return c.child}function MI(d,c,_){switch(c.tag){case 3:Yv(c),cl();break;case 5:hv(c);break;case 1:ui(c.type)&&jh(c);break;case 4:Fm(c,c.stateNode.containerInfo);break;case 10:var E=c.type._context,T=c.memoizedProps.value;Is(Xh,E._currentValue),E._currentValue=T;break;case 13:if(E=c.memoizedState,E!==null)return E.dehydrated!==null?(Is(Zs,Zs.current&1),c.flags|=128,null):(_&c.child.childLanes)!==0?Xv(d,c,_):(Is(Zs,Zs.current&1),d=Or(d,c,_),d!==null?d.sibling:null);Is(Zs,Zs.current&1);break;case 19:if(E=(_&c.childLanes)!==0,(d.flags&128)!==0){if(E)return Kv(d,c,_);c.flags|=128}if(T=c.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),Is(Zs,Zs.current),E)break;return null;case 22:case 23:return c.lanes=0,Hv(d,c,_)}return Or(d,c,_)}var Qv,sp,Jv,tb;Qv=function(d,c){for(var _=c.child;_!==null;){if(_.tag===5||_.tag===6)d.appendChild(_.stateNode);else if(_.tag!==4&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===c)break;for(;_.sibling===null;){if(_.return===null||_.return===c)return;_=_.return}_.sibling.return=_.return,_=_.sibling}},sp=function(){},Jv=function(d,c,_,E){var T=d.memoizedProps;if(T!==E){d=c.stateNode,da(pr.current);var I=null;switch(_){case"input":T=Me(d,T),E=Me(d,E),I=[];break;case"select":T=Mt({},T,{value:void 0}),E=Mt({},E,{value:void 0}),I=[];break;case"textarea":T=ss(d,T),E=ss(d,E),I=[];break;default:typeof T.onClick!="function"&&typeof E.onClick=="function"&&(d.onclick=Uh)}gt(_,E);var G;_=null;for(Gt in T)if(!E.hasOwnProperty(Gt)&&T.hasOwnProperty(Gt)&&T[Gt]!=null)if(Gt==="style"){var rt=T[Gt];for(G in rt)rt.hasOwnProperty(G)&&(_||(_={}),_[G]="")}else Gt!=="dangerouslySetInnerHTML"&&Gt!=="children"&&Gt!=="suppressContentEditableWarning"&&Gt!=="suppressHydrationWarning"&&Gt!=="autoFocus"&&(i.hasOwnProperty(Gt)?I||(I=[]):(I=I||[]).push(Gt,null));for(Gt in E){var xt=E[Gt];if(rt=T!=null?T[Gt]:void 0,E.hasOwnProperty(Gt)&&xt!==rt&&(xt!=null||rt!=null))if(Gt==="style")if(rt){for(G in rt)!rt.hasOwnProperty(G)||xt&&xt.hasOwnProperty(G)||(_||(_={}),_[G]="");for(G in xt)xt.hasOwnProperty(G)&&rt[G]!==xt[G]&&(_||(_={}),_[G]=xt[G])}else _||(I||(I=[]),I.push(Gt,_)),_=xt;else Gt==="dangerouslySetInnerHTML"?(xt=xt?xt.__html:void 0,rt=rt?rt.__html:void 0,xt!=null&&rt!==xt&&(I=I||[]).push(Gt,xt)):Gt==="children"?typeof xt!="string"&&typeof xt!="number"||(I=I||[]).push(Gt,""+xt):Gt!=="suppressContentEditableWarning"&&Gt!=="suppressHydrationWarning"&&(i.hasOwnProperty(Gt)?(xt!=null&&Gt==="onScroll"&&Os("scroll",d),I||rt===xt||(I=[])):(I=I||[]).push(Gt,xt))}_&&(I=I||[]).push("style",_);var Gt=I;(c.updateQueue=Gt)&&(c.flags|=4)}},tb=function(d,c,_,E){_!==E&&(c.flags|=4)};function Gu(d,c){if(!$s)switch(d.tailMode){case"hidden":c=d.tail;for(var _=null;c!==null;)c.alternate!==null&&(_=c),c=c.sibling;_===null?d.tail=null:_.sibling=null;break;case"collapsed":_=d.tail;for(var E=null;_!==null;)_.alternate!==null&&(E=_),_=_.sibling;E===null?c||d.tail===null?d.tail=null:d.tail.sibling=null:E.sibling=null}}function On(d){var c=d.alternate!==null&&d.alternate.child===d.child,_=0,E=0;if(c)for(var T=d.child;T!==null;)_|=T.lanes|T.childLanes,E|=T.subtreeFlags&14680064,E|=T.flags&14680064,T.return=d,T=T.sibling;else for(T=d.child;T!==null;)_|=T.lanes|T.childLanes,E|=T.subtreeFlags,E|=T.flags,T.return=d,T=T.sibling;return d.subtreeFlags|=E,d.childLanes=_,c}function II(d,c,_){var E=c.pendingProps;switch(Am(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return On(c),null;case 1:return ui(c.type)&&Vh(),On(c),null;case 3:return E=c.stateNode,pl(),Bs(li),Bs(zn),Dm(),E.pendingContext&&(E.context=E.pendingContext,E.pendingContext=null),(d===null||d.child===null)&&(Yh(c)?c.flags|=4:d===null||d.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Qi!==null&&(gp(Qi),Qi=null))),sp(d,c),On(c),null;case 5:Pm(c);var T=da(zu.current);if(_=c.type,d!==null&&c.stateNode!=null)Jv(d,c,_,E,T),d.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!E){if(c.stateNode===null)throw Error(s(166));return On(c),null}if(d=da(pr.current),Yh(c)){E=c.stateNode,_=c.type;var I=c.memoizedProps;switch(E[mr]=c,E[Iu]=I,d=(c.mode&1)!==0,_){case"dialog":Os("cancel",E),Os("close",E);break;case"iframe":case"object":case"embed":Os("load",E);break;case"video":case"audio":for(T=0;T<Lu.length;T++)Os(Lu[T],E);break;case"source":Os("error",E);break;case"img":case"image":case"link":Os("error",E),Os("load",E);break;case"details":Os("toggle",E);break;case"input":ge(E,I),Os("invalid",E);break;case"select":E._wrapperState={wasMultiple:!!I.multiple},Os("invalid",E);break;case"textarea":ts(E,I),Os("invalid",E)}gt(_,I),T=null;for(var G in I)if(I.hasOwnProperty(G)){var rt=I[G];G==="children"?typeof rt=="string"?E.textContent!==rt&&(I.suppressHydrationWarning!==!0&&Bh(E.textContent,rt,d),T=["children",rt]):typeof rt=="number"&&E.textContent!==""+rt&&(I.suppressHydrationWarning!==!0&&Bh(E.textContent,rt,d),T=["children",""+rt]):i.hasOwnProperty(G)&&rt!=null&&G==="onScroll"&&Os("scroll",E)}switch(_){case"input":ce(E),Ge(E,I,!0);break;case"textarea":ce(E),Fe(E);break;case"select":case"option":break;default:typeof I.onClick=="function"&&(E.onclick=Uh)}E=T,c.updateQueue=E,E!==null&&(c.flags|=4)}else{G=T.nodeType===9?T:T.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=Oe(_)),d==="http://www.w3.org/1999/xhtml"?_==="script"?(d=G.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof E.is=="string"?d=G.createElement(_,{is:E.is}):(d=G.createElement(_),_==="select"&&(G=d,E.multiple?G.multiple=!0:E.size&&(G.size=E.size))):d=G.createElementNS(d,_),d[mr]=c,d[Iu]=E,Qv(d,c,!1,!1),c.stateNode=d;t:{switch(G=M(_,E),_){case"dialog":Os("cancel",d),Os("close",d),T=E;break;case"iframe":case"object":case"embed":Os("load",d),T=E;break;case"video":case"audio":for(T=0;T<Lu.length;T++)Os(Lu[T],d);T=E;break;case"source":Os("error",d),T=E;break;case"img":case"image":case"link":Os("error",d),Os("load",d),T=E;break;case"details":Os("toggle",d),T=E;break;case"input":ge(d,E),T=Me(d,E),Os("invalid",d);break;case"option":T=E;break;case"select":d._wrapperState={wasMultiple:!!E.multiple},T=Mt({},E,{value:void 0}),Os("invalid",d);break;case"textarea":ts(d,E),T=ss(d,E),Os("invalid",d);break;default:T=E}gt(_,T),rt=T;for(I in rt)if(rt.hasOwnProperty(I)){var xt=rt[I];I==="style"?xs(d,xt):I==="dangerouslySetInnerHTML"?(xt=xt?xt.__html:void 0,xt!=null&&Hs(d,xt)):I==="children"?typeof xt=="string"?(_!=="textarea"||xt!=="")&&Ls(d,xt):typeof xt=="number"&&Ls(d,""+xt):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(i.hasOwnProperty(I)?xt!=null&&I==="onScroll"&&Os("scroll",d):xt!=null&&S(d,I,xt,G))}switch(_){case"input":ce(d),Ge(d,E,!1);break;case"textarea":ce(d),Fe(d);break;case"option":E.value!=null&&d.setAttribute("value",""+se(E.value));break;case"select":d.multiple=!!E.multiple,I=E.value,I!=null?Je(d,!!E.multiple,I,!1):E.defaultValue!=null&&Je(d,!!E.multiple,E.defaultValue,!0);break;default:typeof T.onClick=="function"&&(d.onclick=Uh)}switch(_){case"button":case"input":case"select":case"textarea":E=!!E.autoFocus;break t;case"img":E=!0;break t;default:E=!1}}E&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return On(c),null;case 6:if(d&&c.stateNode!=null)tb(d,c,d.memoizedProps,E);else{if(typeof E!="string"&&c.stateNode===null)throw Error(s(166));if(_=da(zu.current),da(pr.current),Yh(c)){if(E=c.stateNode,_=c.memoizedProps,E[mr]=c,(I=E.nodeValue!==_)&&(d=_i,d!==null))switch(d.tag){case 3:Bh(E.nodeValue,_,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&Bh(E.nodeValue,_,(d.mode&1)!==0)}I&&(c.flags|=4)}else E=(_.nodeType===9?_:_.ownerDocument).createTextNode(E),E[mr]=c,c.stateNode=E}return On(c),null;case 13:if(Bs(Zs),E=c.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if($s&&yi!==null&&(c.mode&1)!==0&&(c.flags&128)===0)nv(),cl(),c.flags|=98560,I=!1;else if(I=Yh(c),E!==null&&E.dehydrated!==null){if(d===null){if(!I)throw Error(s(318));if(I=c.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(s(317));I[mr]=c}else cl(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;On(c),I=!1}else Qi!==null&&(gp(Qi),Qi=null),I=!0;if(!I)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=_,c):(E=E!==null,E!==(d!==null&&d.memoizedState!==null)&&E&&(c.child.flags|=8192,(c.mode&1)!==0&&(d===null||(Zs.current&1)!==0?xn===0&&(xn=3):pp())),c.updateQueue!==null&&(c.flags|=4),On(c),null);case 4:return pl(),sp(d,c),d===null&&Nu(c.stateNode.containerInfo),On(c),null;case 10:return Mm(c.type._context),On(c),null;case 17:return ui(c.type)&&Vh(),On(c),null;case 19:if(Bs(Zs),I=c.memoizedState,I===null)return On(c),null;if(E=(c.flags&128)!==0,G=I.rendering,G===null)if(E)Gu(I,!1);else{if(xn!==0||d!==null&&(d.flags&128)!==0)for(d=c.child;d!==null;){if(G=Jh(d),G!==null){for(c.flags|=128,Gu(I,!1),E=G.updateQueue,E!==null&&(c.updateQueue=E,c.flags|=4),c.subtreeFlags=0,E=_,_=c.child;_!==null;)I=_,d=E,I.flags&=14680066,G=I.alternate,G===null?(I.childLanes=0,I.lanes=d,I.child=null,I.subtreeFlags=0,I.memoizedProps=null,I.memoizedState=null,I.updateQueue=null,I.dependencies=null,I.stateNode=null):(I.childLanes=G.childLanes,I.lanes=G.lanes,I.child=G.child,I.subtreeFlags=0,I.deletions=null,I.memoizedProps=G.memoizedProps,I.memoizedState=G.memoizedState,I.updateQueue=G.updateQueue,I.type=G.type,d=G.dependencies,I.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),_=_.sibling;return Is(Zs,Zs.current&1|2),c.child}d=d.sibling}I.tail!==null&&tt()>vl&&(c.flags|=128,E=!0,Gu(I,!1),c.lanes=4194304)}else{if(!E)if(d=Jh(G),d!==null){if(c.flags|=128,E=!0,_=d.updateQueue,_!==null&&(c.updateQueue=_,c.flags|=4),Gu(I,!0),I.tail===null&&I.tailMode==="hidden"&&!G.alternate&&!$s)return On(c),null}else 2*tt()-I.renderingStartTime>vl&&_!==1073741824&&(c.flags|=128,E=!0,Gu(I,!1),c.lanes=4194304);I.isBackwards?(G.sibling=c.child,c.child=G):(_=I.last,_!==null?_.sibling=G:c.child=G,I.last=G)}return I.tail!==null?(c=I.tail,I.rendering=c,I.tail=c.sibling,I.renderingStartTime=tt(),c.sibling=null,_=Zs.current,Is(Zs,E?_&1|2:_&1),c):(On(c),null);case 22:case 23:return mp(),E=c.memoizedState!==null,d!==null&&d.memoizedState!==null!==E&&(c.flags|=8192),E&&(c.mode&1)!==0?(xi&1073741824)!==0&&(On(c),c.subtreeFlags&6&&(c.flags|=8192)):On(c),null;case 24:return null;case 25:return null}throw Error(s(156,c.tag))}function kI(d,c){switch(Am(c),c.tag){case 1:return ui(c.type)&&Vh(),d=c.flags,d&65536?(c.flags=d&-65537|128,c):null;case 3:return pl(),Bs(li),Bs(zn),Dm(),d=c.flags,(d&65536)!==0&&(d&128)===0?(c.flags=d&-65537|128,c):null;case 5:return Pm(c),null;case 13:if(Bs(Zs),d=c.memoizedState,d!==null&&d.dehydrated!==null){if(c.alternate===null)throw Error(s(340));cl()}return d=c.flags,d&65536?(c.flags=d&-65537|128,c):null;case 19:return Bs(Zs),null;case 4:return pl(),null;case 10:return Mm(c.type._context),null;case 22:case 23:return mp(),null;case 24:return null;default:return null}}var lc=!1,Bn=!1,RI=typeof WeakSet=="function"?WeakSet:Set,Le=null;function yl(d,c){var _=d.ref;if(_!==null)if(typeof _=="function")try{_(null)}catch(E){tn(d,c,E)}else _.current=null}function np(d,c,_){try{_()}catch(E){tn(d,c,E)}}var eb=!1;function FI(d,c){if(mm=pi,d=R0(),am(d)){if("selectionStart"in d)var _={start:d.selectionStart,end:d.selectionEnd};else t:{_=(_=d.ownerDocument)&&_.defaultView||window;var E=_.getSelection&&_.getSelection();if(E&&E.rangeCount!==0){_=E.anchorNode;var T=E.anchorOffset,I=E.focusNode;E=E.focusOffset;try{_.nodeType,I.nodeType}catch{_=null;break t}var G=0,rt=-1,xt=-1,Gt=0,ue=0,fe=d,ae=null;e:for(;;){for(var Ae;fe!==_||T!==0&&fe.nodeType!==3||(rt=G+T),fe!==I||E!==0&&fe.nodeType!==3||(xt=G+E),fe.nodeType===3&&(G+=fe.nodeValue.length),(Ae=fe.firstChild)!==null;)ae=fe,fe=Ae;for(;;){if(fe===d)break e;if(ae===_&&++Gt===T&&(rt=G),ae===I&&++ue===E&&(xt=G),(Ae=fe.nextSibling)!==null)break;fe=ae,ae=fe.parentNode}fe=Ae}_=rt===-1||xt===-1?null:{start:rt,end:xt}}else _=null}_=_||{start:0,end:0}}else _=null;for(pm={focusedElem:d,selectionRange:_},pi=!1,Le=c;Le!==null;)if(c=Le,d=c.child,(c.subtreeFlags&1028)!==0&&d!==null)d.return=c,Le=d;else for(;Le!==null;){c=Le;try{var Ne=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Ne!==null){var Ie=Ne.memoizedProps,an=Ne.memoizedState,It=c.stateNode,wt=It.getSnapshotBeforeUpdate(c.elementType===c.type?Ie:Ji(c.type,Ie),an);It.__reactInternalSnapshotBeforeUpdate=wt}break;case 3:var zt=c.stateNode.containerInfo;zt.nodeType===1?zt.textContent="":zt.nodeType===9&&zt.documentElement&&zt.removeChild(zt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(ye){tn(c,c.return,ye)}if(d=c.sibling,d!==null){d.return=c.return,Le=d;break}Le=c.return}return Ne=eb,eb=!1,Ne}function Vu(d,c,_){var E=c.updateQueue;if(E=E!==null?E.lastEffect:null,E!==null){var T=E=E.next;do{if((T.tag&d)===d){var I=T.destroy;T.destroy=void 0,I!==void 0&&np(c,_,I)}T=T.next}while(T!==E)}}function uc(d,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var _=c=c.next;do{if((_.tag&d)===d){var E=_.create;_.destroy=E()}_=_.next}while(_!==c)}}function ip(d){var c=d.ref;if(c!==null){var _=d.stateNode;switch(d.tag){case 5:d=_;break;default:d=_}typeof c=="function"?c(d):c.current=d}}function sb(d){var c=d.alternate;c!==null&&(d.alternate=null,sb(c)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(c=d.stateNode,c!==null&&(delete c[mr],delete c[Iu],delete c[vm],delete c[pI],delete c[_I])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function nb(d){return d.tag===5||d.tag===3||d.tag===4}function ib(d){t:for(;;){for(;d.sibling===null;){if(d.return===null||nb(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue t;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function rp(d,c,_){var E=d.tag;if(E===5||E===6)d=d.stateNode,c?_.nodeType===8?_.parentNode.insertBefore(d,c):_.insertBefore(d,c):(_.nodeType===8?(c=_.parentNode,c.insertBefore(d,_)):(c=_,c.appendChild(d)),_=_._reactRootContainer,_!=null||c.onclick!==null||(c.onclick=Uh));else if(E!==4&&(d=d.child,d!==null))for(rp(d,c,_),d=d.sibling;d!==null;)rp(d,c,_),d=d.sibling}function op(d,c,_){var E=d.tag;if(E===5||E===6)d=d.stateNode,c?_.insertBefore(d,c):_.appendChild(d);else if(E!==4&&(d=d.child,d!==null))for(op(d,c,_),d=d.sibling;d!==null;)op(d,c,_),d=d.sibling}var Nn=null,tr=!1;function xo(d,c,_){for(_=_.child;_!==null;)rb(d,c,_),_=_.sibling}function rb(d,c,_){if(Lt&&typeof Lt.onCommitFiberUnmount=="function")try{Lt.onCommitFiberUnmount(Pt,_)}catch{}switch(_.tag){case 5:Bn||yl(_,c);case 6:var E=Nn,T=tr;Nn=null,xo(d,c,_),Nn=E,tr=T,Nn!==null&&(tr?(d=Nn,_=_.stateNode,d.nodeType===8?d.parentNode.removeChild(_):d.removeChild(_)):Nn.removeChild(_.stateNode));break;case 18:Nn!==null&&(tr?(d=Nn,_=_.stateNode,d.nodeType===8?xm(d.parentNode,_):d.nodeType===1&&xm(d,_),cr(d)):xm(Nn,_.stateNode));break;case 4:E=Nn,T=tr,Nn=_.stateNode.containerInfo,tr=!0,xo(d,c,_),Nn=E,tr=T;break;case 0:case 11:case 14:case 15:if(!Bn&&(E=_.updateQueue,E!==null&&(E=E.lastEffect,E!==null))){T=E=E.next;do{var I=T,G=I.destroy;I=I.tag,G!==void 0&&((I&2)!==0||(I&4)!==0)&&np(_,c,G),T=T.next}while(T!==E)}xo(d,c,_);break;case 1:if(!Bn&&(yl(_,c),E=_.stateNode,typeof E.componentWillUnmount=="function"))try{E.props=_.memoizedProps,E.state=_.memoizedState,E.componentWillUnmount()}catch(rt){tn(_,c,rt)}xo(d,c,_);break;case 21:xo(d,c,_);break;case 22:_.mode&1?(Bn=(E=Bn)||_.memoizedState!==null,xo(d,c,_),Bn=E):xo(d,c,_);break;default:xo(d,c,_)}}function ob(d){var c=d.updateQueue;if(c!==null){d.updateQueue=null;var _=d.stateNode;_===null&&(_=d.stateNode=new RI),c.forEach(function(E){var T=jI.bind(null,d,E);_.has(E)||(_.add(E),E.then(T,T))})}}function er(d,c){var _=c.deletions;if(_!==null)for(var E=0;E<_.length;E++){var T=_[E];try{var I=d,G=c,rt=G;t:for(;rt!==null;){switch(rt.tag){case 5:Nn=rt.stateNode,tr=!1;break t;case 3:Nn=rt.stateNode.containerInfo,tr=!0;break t;case 4:Nn=rt.stateNode.containerInfo,tr=!0;break t}rt=rt.return}if(Nn===null)throw Error(s(160));rb(I,G,T),Nn=null,tr=!1;var xt=T.alternate;xt!==null&&(xt.return=null),T.return=null}catch(Gt){tn(T,c,Gt)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)ab(c,d),c=c.sibling}function ab(d,c){var _=d.alternate,E=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(er(c,d),yr(d),E&4){try{Vu(3,d,d.return),uc(3,d)}catch(Ie){tn(d,d.return,Ie)}try{Vu(5,d,d.return)}catch(Ie){tn(d,d.return,Ie)}}break;case 1:er(c,d),yr(d),E&512&&_!==null&&yl(_,_.return);break;case 5:if(er(c,d),yr(d),E&512&&_!==null&&yl(_,_.return),d.flags&32){var T=d.stateNode;try{Ls(T,"")}catch(Ie){tn(d,d.return,Ie)}}if(E&4&&(T=d.stateNode,T!=null)){var I=d.memoizedProps,G=_!==null?_.memoizedProps:I,rt=d.type,xt=d.updateQueue;if(d.updateQueue=null,xt!==null)try{rt==="input"&&I.type==="radio"&&I.name!=null&&ze(T,I),M(rt,G);var Gt=M(rt,I);for(G=0;G<xt.length;G+=2){var ue=xt[G],fe=xt[G+1];ue==="style"?xs(T,fe):ue==="dangerouslySetInnerHTML"?Hs(T,fe):ue==="children"?Ls(T,fe):S(T,ue,fe,Gt)}switch(rt){case"input":is(T,I);break;case"textarea":hs(T,I);break;case"select":var ae=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!I.multiple;var Ae=I.value;Ae!=null?Je(T,!!I.multiple,Ae,!1):ae!==!!I.multiple&&(I.defaultValue!=null?Je(T,!!I.multiple,I.defaultValue,!0):Je(T,!!I.multiple,I.multiple?[]:"",!1))}T[Iu]=I}catch(Ie){tn(d,d.return,Ie)}}break;case 6:if(er(c,d),yr(d),E&4){if(d.stateNode===null)throw Error(s(162));T=d.stateNode,I=d.memoizedProps;try{T.nodeValue=I}catch(Ie){tn(d,d.return,Ie)}}break;case 3:if(er(c,d),yr(d),E&4&&_!==null&&_.memoizedState.isDehydrated)try{cr(c.containerInfo)}catch(Ie){tn(d,d.return,Ie)}break;case 4:er(c,d),yr(d);break;case 13:er(c,d),yr(d),T=d.child,T.flags&8192&&(I=T.memoizedState!==null,T.stateNode.isHidden=I,!I||T.alternate!==null&&T.alternate.memoizedState!==null||(up=tt())),E&4&&ob(d);break;case 22:if(ue=_!==null&&_.memoizedState!==null,d.mode&1?(Bn=(Gt=Bn)||ue,er(c,d),Bn=Gt):er(c,d),yr(d),E&8192){if(Gt=d.memoizedState!==null,(d.stateNode.isHidden=Gt)&&!ue&&(d.mode&1)!==0)for(Le=d,ue=d.child;ue!==null;){for(fe=Le=ue;Le!==null;){switch(ae=Le,Ae=ae.child,ae.tag){case 0:case 11:case 14:case 15:Vu(4,ae,ae.return);break;case 1:yl(ae,ae.return);var Ne=ae.stateNode;if(typeof Ne.componentWillUnmount=="function"){E=ae,_=ae.return;try{c=E,Ne.props=c.memoizedProps,Ne.state=c.memoizedState,Ne.componentWillUnmount()}catch(Ie){tn(E,_,Ie)}}break;case 5:yl(ae,ae.return);break;case 22:if(ae.memoizedState!==null){db(fe);continue}}Ae!==null?(Ae.return=ae,Le=Ae):db(fe)}ue=ue.sibling}t:for(ue=null,fe=d;;){if(fe.tag===5){if(ue===null){ue=fe;try{T=fe.stateNode,Gt?(I=T.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none"):(rt=fe.stateNode,xt=fe.memoizedProps.style,G=xt!=null&&xt.hasOwnProperty("display")?xt.display:null,rt.style.display=on("display",G))}catch(Ie){tn(d,d.return,Ie)}}}else if(fe.tag===6){if(ue===null)try{fe.stateNode.nodeValue=Gt?"":fe.memoizedProps}catch(Ie){tn(d,d.return,Ie)}}else if((fe.tag!==22&&fe.tag!==23||fe.memoizedState===null||fe===d)&&fe.child!==null){fe.child.return=fe,fe=fe.child;continue}if(fe===d)break t;for(;fe.sibling===null;){if(fe.return===null||fe.return===d)break t;ue===fe&&(ue=null),fe=fe.return}ue===fe&&(ue=null),fe.sibling.return=fe.return,fe=fe.sibling}}break;case 19:er(c,d),yr(d),E&4&&ob(d);break;case 21:break;default:er(c,d),yr(d)}}function yr(d){var c=d.flags;if(c&2){try{t:{for(var _=d.return;_!==null;){if(nb(_)){var E=_;break t}_=_.return}throw Error(s(160))}switch(E.tag){case 5:var T=E.stateNode;E.flags&32&&(Ls(T,""),E.flags&=-33);var I=ib(d);op(d,I,T);break;case 3:case 4:var G=E.stateNode.containerInfo,rt=ib(d);rp(d,rt,G);break;default:throw Error(s(161))}}catch(xt){tn(d,d.return,xt)}d.flags&=-3}c&4096&&(d.flags&=-4097)}function PI(d,c,_){Le=d,lb(d)}function lb(d,c,_){for(var E=(d.mode&1)!==0;Le!==null;){var T=Le,I=T.child;if(T.tag===22&&E){var G=T.memoizedState!==null||lc;if(!G){var rt=T.alternate,xt=rt!==null&&rt.memoizedState!==null||Bn;rt=lc;var Gt=Bn;if(lc=G,(Bn=xt)&&!Gt)for(Le=T;Le!==null;)G=Le,xt=G.child,G.tag===22&&G.memoizedState!==null?hb(T):xt!==null?(xt.return=G,Le=xt):hb(T);for(;I!==null;)Le=I,lb(I),I=I.sibling;Le=T,lc=rt,Bn=Gt}ub(d)}else(T.subtreeFlags&8772)!==0&&I!==null?(I.return=T,Le=I):ub(d)}}function ub(d){for(;Le!==null;){var c=Le;if((c.flags&8772)!==0){var _=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Bn||uc(5,c);break;case 1:var E=c.stateNode;if(c.flags&4&&!Bn)if(_===null)E.componentDidMount();else{var T=c.elementType===c.type?_.memoizedProps:Ji(c.type,_.memoizedProps);E.componentDidUpdate(T,_.memoizedState,E.__reactInternalSnapshotBeforeUpdate)}var I=c.updateQueue;I!==null&&dv(c,I,E);break;case 3:var G=c.updateQueue;if(G!==null){if(_=null,c.child!==null)switch(c.child.tag){case 5:_=c.child.stateNode;break;case 1:_=c.child.stateNode}dv(c,G,_)}break;case 5:var rt=c.stateNode;if(_===null&&c.flags&4){_=rt;var xt=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":xt.autoFocus&&_.focus();break;case"img":xt.src&&(_.src=xt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var Gt=c.alternate;if(Gt!==null){var ue=Gt.memoizedState;if(ue!==null){var fe=ue.dehydrated;fe!==null&&cr(fe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}Bn||c.flags&512&&ip(c)}catch(ae){tn(c,c.return,ae)}}if(c===d){Le=null;break}if(_=c.sibling,_!==null){_.return=c.return,Le=_;break}Le=c.return}}function db(d){for(;Le!==null;){var c=Le;if(c===d){Le=null;break}var _=c.sibling;if(_!==null){_.return=c.return,Le=_;break}Le=c.return}}function hb(d){for(;Le!==null;){var c=Le;try{switch(c.tag){case 0:case 11:case 15:var _=c.return;try{uc(4,c)}catch(xt){tn(c,_,xt)}break;case 1:var E=c.stateNode;if(typeof E.componentDidMount=="function"){var T=c.return;try{E.componentDidMount()}catch(xt){tn(c,T,xt)}}var I=c.return;try{ip(c)}catch(xt){tn(c,I,xt)}break;case 5:var G=c.return;try{ip(c)}catch(xt){tn(c,G,xt)}}}catch(xt){tn(c,c.return,xt)}if(c===d){Le=null;break}var rt=c.sibling;if(rt!==null){rt.return=c.return,Le=rt;break}Le=c.return}}var zI=Math.ceil,dc=A.ReactCurrentDispatcher,ap=A.ReactCurrentOwner,Fi=A.ReactCurrentBatchConfig,fs=0,wn=null,gn=null,Mn=0,xi=0,xl=fo(0),xn=0,ju=null,ca=0,hc=0,lp=0,Hu=null,hi=null,up=0,vl=1/0,Br=null,cc=!1,dp=null,vo=null,gc=!1,bo=null,fc=0,$u=0,hp=null,mc=-1,pc=0;function Qn(){return(fs&6)!==0?tt():mc!==-1?mc:mc=tt()}function Eo(d){return(d.mode&1)===0?1:(fs&2)!==0&&Mn!==0?Mn&-Mn:xI.transition!==null?(pc===0&&(pc=W()),pc):(d=ne,d!==0||(d=window.event,d=d===void 0?16:pu(d.type)),d)}function sr(d,c,_,E){if(50<$u)throw $u=0,hp=null,Error(s(185));bt(d,_,E),((fs&2)===0||d!==wn)&&(d===wn&&((fs&2)===0&&(hc|=_),xn===4&&So(d,Mn)),ci(d,E),_===1&&fs===0&&(c.mode&1)===0&&(vl=tt()+500,Hh&&po()))}function ci(d,c){var _=d.callbackNode;R(d,c);var E=ie(d,d===wn?Mn:0);if(E===0)_!==null&&Y(_),d.callbackNode=null,d.callbackPriority=0;else if(c=E&-E,d.callbackPriority!==c){if(_!=null&&Y(_),c===1)d.tag===0?yI(gb.bind(null,d)):Q0(gb.bind(null,d)),fI(function(){(fs&6)===0&&po()}),_=null;else{switch(Ee(E)){case 1:_=_t;break;case 4:_=it;break;case 16:_=vt;break;case 536870912:_=Ft;break;default:_=vt}_=bb(_,cb.bind(null,d))}d.callbackPriority=c,d.callbackNode=_}}function cb(d,c){if(mc=-1,pc=0,(fs&6)!==0)throw Error(s(327));var _=d.callbackNode;if(bl()&&d.callbackNode!==_)return null;var E=ie(d,d===wn?Mn:0);if(E===0)return null;if((E&30)!==0||(E&d.expiredLanes)!==0||c)c=_c(d,E);else{c=E;var T=fs;fs|=2;var I=mb();(wn!==d||Mn!==c)&&(Br=null,vl=tt()+500,fa(d,c));do try{BI();break}catch(rt){fb(d,rt)}while(!0);Nm(),dc.current=I,fs=T,gn!==null?c=0:(wn=null,Mn=0,c=xn)}if(c!==0){if(c===2&&(T=U(d),T!==0&&(E=T,c=cp(d,T))),c===1)throw _=ju,fa(d,0),So(d,E),ci(d,tt()),_;if(c===6)So(d,E);else{if(T=d.current.alternate,(E&30)===0&&!DI(T)&&(c=_c(d,E),c===2&&(I=U(d),I!==0&&(E=I,c=cp(d,I))),c===1))throw _=ju,fa(d,0),So(d,E),ci(d,tt()),_;switch(d.finishedWork=T,d.finishedLanes=E,c){case 0:case 1:throw Error(s(345));case 2:ma(d,hi,Br);break;case 3:if(So(d,E),(E&130023424)===E&&(c=up+500-tt(),10<c)){if(ie(d,0)!==0)break;if(T=d.suspendedLanes,(T&E)!==E){Qn(),d.pingedLanes|=d.suspendedLanes&T;break}d.timeoutHandle=ym(ma.bind(null,d,hi,Br),c);break}ma(d,hi,Br);break;case 4:if(So(d,E),(E&4194240)===E)break;for(c=d.eventTimes,T=-1;0<E;){var G=31-jt(E);I=1<<G,G=c[G],G>T&&(T=G),E&=~I}if(E=T,E=tt()-E,E=(120>E?120:480>E?480:1080>E?1080:1920>E?1920:3e3>E?3e3:4320>E?4320:1960*zI(E/1960))-E,10<E){d.timeoutHandle=ym(ma.bind(null,d,hi,Br),E);break}ma(d,hi,Br);break;case 5:ma(d,hi,Br);break;default:throw Error(s(329))}}}return ci(d,tt()),d.callbackNode===_?cb.bind(null,d):null}function cp(d,c){var _=Hu;return d.current.memoizedState.isDehydrated&&(fa(d,c).flags|=256),d=_c(d,c),d!==2&&(c=hi,hi=_,c!==null&&gp(c)),d}function gp(d){hi===null?hi=d:hi.push.apply(hi,d)}function DI(d){for(var c=d;;){if(c.flags&16384){var _=c.updateQueue;if(_!==null&&(_=_.stores,_!==null))for(var E=0;E<_.length;E++){var T=_[E],I=T.getSnapshot;T=T.value;try{if(!Ki(I(),T))return!1}catch{return!1}}}if(_=c.child,c.subtreeFlags&16384&&_!==null)_.return=c,c=_;else{if(c===d)break;for(;c.sibling===null;){if(c.return===null||c.return===d)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function So(d,c){for(c&=~lp,c&=~hc,d.suspendedLanes|=c,d.pingedLanes&=~c,d=d.expirationTimes;0<c;){var _=31-jt(c),E=1<<_;d[_]=-1,c&=~E}}function gb(d){if((fs&6)!==0)throw Error(s(327));bl();var c=ie(d,0);if((c&1)===0)return ci(d,tt()),null;var _=_c(d,c);if(d.tag!==0&&_===2){var E=U(d);E!==0&&(c=E,_=cp(d,E))}if(_===1)throw _=ju,fa(d,0),So(d,c),ci(d,tt()),_;if(_===6)throw Error(s(345));return d.finishedWork=d.current.alternate,d.finishedLanes=c,ma(d,hi,Br),ci(d,tt()),null}function fp(d,c){var _=fs;fs|=1;try{return d(c)}finally{fs=_,fs===0&&(vl=tt()+500,Hh&&po())}}function ga(d){bo!==null&&bo.tag===0&&(fs&6)===0&&bl();var c=fs;fs|=1;var _=Fi.transition,E=ne;try{if(Fi.transition=null,ne=1,d)return d()}finally{ne=E,Fi.transition=_,fs=c,(fs&6)===0&&po()}}function mp(){xi=xl.current,Bs(xl)}function fa(d,c){d.finishedWork=null,d.finishedLanes=0;var _=d.timeoutHandle;if(_!==-1&&(d.timeoutHandle=-1,gI(_)),gn!==null)for(_=gn.return;_!==null;){var E=_;switch(Am(E),E.tag){case 1:E=E.type.childContextTypes,E!=null&&Vh();break;case 3:pl(),Bs(li),Bs(zn),Dm();break;case 5:Pm(E);break;case 4:pl();break;case 13:Bs(Zs);break;case 19:Bs(Zs);break;case 10:Mm(E.type._context);break;case 22:case 23:mp()}_=_.return}if(wn=d,gn=d=Ao(d.current,null),Mn=xi=c,xn=0,ju=null,lp=hc=ca=0,hi=Hu=null,ua!==null){for(c=0;c<ua.length;c++)if(_=ua[c],E=_.interleaved,E!==null){_.interleaved=null;var T=E.next,I=_.pending;if(I!==null){var G=I.next;I.next=T,E.next=G}_.pending=E}ua=null}return d}function fb(d,c){do{var _=gn;try{if(Nm(),tc.current=ic,ec){for(var E=Ks.memoizedState;E!==null;){var T=E.queue;T!==null&&(T.pending=null),E=E.next}ec=!1}if(ha=0,An=yn=Ks=null,Du=!1,Ou=0,ap.current=null,_===null||_.return===null){xn=1,ju=c,gn=null;break}t:{var I=d,G=_.return,rt=_,xt=c;if(c=Mn,rt.flags|=32768,xt!==null&&typeof xt=="object"&&typeof xt.then=="function"){var Gt=xt,ue=rt,fe=ue.tag;if((ue.mode&1)===0&&(fe===0||fe===11||fe===15)){var ae=ue.alternate;ae?(ue.updateQueue=ae.updateQueue,ue.memoizedState=ae.memoizedState,ue.lanes=ae.lanes):(ue.updateQueue=null,ue.memoizedState=null)}var Ae=Bv(G);if(Ae!==null){Ae.flags&=-257,Uv(Ae,G,rt,I,c),Ae.mode&1&&Ov(I,Gt,c),c=Ae,xt=Gt;var Ne=c.updateQueue;if(Ne===null){var Ie=new Set;Ie.add(xt),c.updateQueue=Ie}else Ne.add(xt);break t}else{if((c&1)===0){Ov(I,Gt,c),pp();break t}xt=Error(s(426))}}else if($s&&rt.mode&1){var an=Bv(G);if(an!==null){(an.flags&65536)===0&&(an.flags|=256),Uv(an,G,rt,I,c),Cm(_l(xt,rt));break t}}I=xt=_l(xt,rt),xn!==4&&(xn=2),Hu===null?Hu=[I]:Hu.push(I),I=G;do{switch(I.tag){case 3:I.flags|=65536,c&=-c,I.lanes|=c;var It=zv(I,xt,c);uv(I,It);break t;case 1:rt=xt;var wt=I.type,zt=I.stateNode;if((I.flags&128)===0&&(typeof wt.getDerivedStateFromError=="function"||zt!==null&&typeof zt.componentDidCatch=="function"&&(vo===null||!vo.has(zt)))){I.flags|=65536,c&=-c,I.lanes|=c;var ye=Dv(I,rt,c);uv(I,ye);break t}}I=I.return}while(I!==null)}_b(_)}catch(Re){c=Re,gn===_&&_!==null&&(gn=_=_.return);continue}break}while(!0)}function mb(){var d=dc.current;return dc.current=ic,d===null?ic:d}function pp(){(xn===0||xn===3||xn===2)&&(xn=4),wn===null||(ca&268435455)===0&&(hc&268435455)===0||So(wn,Mn)}function _c(d,c){var _=fs;fs|=2;var E=mb();(wn!==d||Mn!==c)&&(Br=null,fa(d,c));do try{OI();break}catch(T){fb(d,T)}while(!0);if(Nm(),fs=_,dc.current=E,gn!==null)throw Error(s(261));return wn=null,Mn=0,xn}function OI(){for(;gn!==null;)pb(gn)}function BI(){for(;gn!==null&&!et();)pb(gn)}function pb(d){var c=vb(d.alternate,d,xi);d.memoizedProps=d.pendingProps,c===null?_b(d):gn=c,ap.current=null}function _b(d){var c=d;do{var _=c.alternate;if(d=c.return,(c.flags&32768)===0){if(_=II(_,c,xi),_!==null){gn=_;return}}else{if(_=kI(_,c),_!==null){_.flags&=32767,gn=_;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{xn=6,gn=null;return}}if(c=c.sibling,c!==null){gn=c;return}gn=c=d}while(c!==null);xn===0&&(xn=5)}function ma(d,c,_){var E=ne,T=Fi.transition;try{Fi.transition=null,ne=1,UI(d,c,_,E)}finally{Fi.transition=T,ne=E}return null}function UI(d,c,_,E){do bl();while(bo!==null);if((fs&6)!==0)throw Error(s(327));_=d.finishedWork;var T=d.finishedLanes;if(_===null)return null;if(d.finishedWork=null,d.finishedLanes=0,_===d.current)throw Error(s(177));d.callbackNode=null,d.callbackPriority=0;var I=_.lanes|_.childLanes;if(kt(d,I),d===wn&&(gn=wn=null,Mn=0),(_.subtreeFlags&2064)===0&&(_.flags&2064)===0||gc||(gc=!0,bb(vt,function(){return bl(),null})),I=(_.flags&15990)!==0,(_.subtreeFlags&15990)!==0||I){I=Fi.transition,Fi.transition=null;var G=ne;ne=1;var rt=fs;fs|=4,ap.current=null,FI(d,_),ab(_,d),oI(pm),pi=!!mm,pm=mm=null,d.current=_,PI(_),J(),fs=rt,ne=G,Fi.transition=I}else d.current=_;if(gc&&(gc=!1,bo=d,fc=T),I=d.pendingLanes,I===0&&(vo=null),$t(_.stateNode),ci(d,tt()),c!==null)for(E=d.onRecoverableError,_=0;_<c.length;_++)T=c[_],E(T.value,{componentStack:T.stack,digest:T.digest});if(cc)throw cc=!1,d=dp,dp=null,d;return(fc&1)!==0&&d.tag!==0&&bl(),I=d.pendingLanes,(I&1)!==0?d===hp?$u++:($u=0,hp=d):$u=0,po(),null}function bl(){if(bo!==null){var d=Ee(fc),c=Fi.transition,_=ne;try{if(Fi.transition=null,ne=16>d?16:d,bo===null)var E=!1;else{if(d=bo,bo=null,fc=0,(fs&6)!==0)throw Error(s(331));var T=fs;for(fs|=4,Le=d.current;Le!==null;){var I=Le,G=I.child;if((Le.flags&16)!==0){var rt=I.deletions;if(rt!==null){for(var xt=0;xt<rt.length;xt++){var Gt=rt[xt];for(Le=Gt;Le!==null;){var ue=Le;switch(ue.tag){case 0:case 11:case 15:Vu(8,ue,I)}var fe=ue.child;if(fe!==null)fe.return=ue,Le=fe;else for(;Le!==null;){ue=Le;var ae=ue.sibling,Ae=ue.return;if(sb(ue),ue===Gt){Le=null;break}if(ae!==null){ae.return=Ae,Le=ae;break}Le=Ae}}}var Ne=I.alternate;if(Ne!==null){var Ie=Ne.child;if(Ie!==null){Ne.child=null;do{var an=Ie.sibling;Ie.sibling=null,Ie=an}while(Ie!==null)}}Le=I}}if((I.subtreeFlags&2064)!==0&&G!==null)G.return=I,Le=G;else t:for(;Le!==null;){if(I=Le,(I.flags&2048)!==0)switch(I.tag){case 0:case 11:case 15:Vu(9,I,I.return)}var It=I.sibling;if(It!==null){It.return=I.return,Le=It;break t}Le=I.return}}var wt=d.current;for(Le=wt;Le!==null;){G=Le;var zt=G.child;if((G.subtreeFlags&2064)!==0&&zt!==null)zt.return=G,Le=zt;else t:for(G=wt;Le!==null;){if(rt=Le,(rt.flags&2048)!==0)try{switch(rt.tag){case 0:case 11:case 15:uc(9,rt)}}catch(Re){tn(rt,rt.return,Re)}if(rt===G){Le=null;break t}var ye=rt.sibling;if(ye!==null){ye.return=rt.return,Le=ye;break t}Le=rt.return}}if(fs=T,po(),Lt&&typeof Lt.onPostCommitFiberRoot=="function")try{Lt.onPostCommitFiberRoot(Pt,d)}catch{}E=!0}return E}finally{ne=_,Fi.transition=c}}return!1}function yb(d,c,_){c=_l(_,c),c=zv(d,c,1),d=yo(d,c,1),c=Qn(),d!==null&&(bt(d,1,c),ci(d,c))}function tn(d,c,_){if(d.tag===3)yb(d,d,_);else for(;c!==null;){if(c.tag===3){yb(c,d,_);break}else if(c.tag===1){var E=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(vo===null||!vo.has(E))){d=_l(_,d),d=Dv(c,d,1),c=yo(c,d,1),d=Qn(),c!==null&&(bt(c,1,d),ci(c,d));break}}c=c.return}}function GI(d,c,_){var E=d.pingCache;E!==null&&E.delete(c),c=Qn(),d.pingedLanes|=d.suspendedLanes&_,wn===d&&(Mn&_)===_&&(xn===4||xn===3&&(Mn&130023424)===Mn&&500>tt()-up?fa(d,0):lp|=_),ci(d,c)}function xb(d,c){c===0&&((d.mode&1)===0?c=1:(c=te,te<<=1,(te&130023424)===0&&(te=4194304)));var _=Qn();d=zr(d,c),d!==null&&(bt(d,c,_),ci(d,_))}function VI(d){var c=d.memoizedState,_=0;c!==null&&(_=c.retryLane),xb(d,_)}function jI(d,c){var _=0;switch(d.tag){case 13:var E=d.stateNode,T=d.memoizedState;T!==null&&(_=T.retryLane);break;case 19:E=d.stateNode;break;default:throw Error(s(314))}E!==null&&E.delete(c),xb(d,_)}var vb;vb=function(d,c,_){if(d!==null)if(d.memoizedProps!==c.pendingProps||li.current)di=!0;else{if((d.lanes&_)===0&&(c.flags&128)===0)return di=!1,MI(d,c,_);di=(d.flags&131072)!==0}else di=!1,$s&&(c.flags&1048576)!==0&&J0(c,qh,c.index);switch(c.lanes=0,c.tag){case 2:var E=c.type;ac(d,c),d=c.pendingProps;var T=ul(c,zn.current);ml(c,_),T=Um(null,c,E,d,T,_);var I=Gm();return c.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,ui(E)?(I=!0,jh(c)):I=!1,c.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,Rm(c),T.updater=rc,c.stateNode=T,T._reactInternals=c,Ym(c,E,d,_),c=Km(null,c,E,!0,I,_)):(c.tag=0,$s&&I&&Sm(c),Kn(null,c,T,_),c=c.child),c;case 16:E=c.elementType;t:{switch(ac(d,c),d=c.pendingProps,T=E._init,E=T(E._payload),c.type=E,T=c.tag=$I(E),d=Ji(E,d),T){case 0:c=Zm(null,c,E,d,_);break t;case 1:c=qv(null,c,E,d,_);break t;case 11:c=Gv(null,c,E,d,_);break t;case 14:c=Vv(null,c,E,Ji(E.type,d),_);break t}throw Error(s(306,E,""))}return c;case 0:return E=c.type,T=c.pendingProps,T=c.elementType===E?T:Ji(E,T),Zm(d,c,E,T,_);case 1:return E=c.type,T=c.pendingProps,T=c.elementType===E?T:Ji(E,T),qv(d,c,E,T,_);case 3:t:{if(Yv(c),d===null)throw Error(s(387));E=c.pendingProps,I=c.memoizedState,T=I.element,lv(d,c),Qh(c,E,null,_);var G=c.memoizedState;if(E=G.element,I.isDehydrated)if(I={element:E,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},c.updateQueue.baseState=I,c.memoizedState=I,c.flags&256){T=_l(Error(s(423)),c),c=Wv(d,c,E,_,T);break t}else if(E!==T){T=_l(Error(s(424)),c),c=Wv(d,c,E,_,T);break t}else for(yi=go(c.stateNode.containerInfo.firstChild),_i=c,$s=!0,Qi=null,_=ov(c,null,E,_),c.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling;else{if(cl(),E===T){c=Or(d,c,_);break t}Kn(d,c,E,_)}c=c.child}return c;case 5:return hv(c),d===null&&Tm(c),E=c.type,T=c.pendingProps,I=d!==null?d.memoizedProps:null,G=T.children,_m(E,T)?G=null:I!==null&&_m(E,I)&&(c.flags|=32),$v(d,c),Kn(d,c,G,_),c.child;case 6:return d===null&&Tm(c),null;case 13:return Xv(d,c,_);case 4:return Fm(c,c.stateNode.containerInfo),E=c.pendingProps,d===null?c.child=gl(c,null,E,_):Kn(d,c,E,_),c.child;case 11:return E=c.type,T=c.pendingProps,T=c.elementType===E?T:Ji(E,T),Gv(d,c,E,T,_);case 7:return Kn(d,c,c.pendingProps,_),c.child;case 8:return Kn(d,c,c.pendingProps.children,_),c.child;case 12:return Kn(d,c,c.pendingProps.children,_),c.child;case 10:t:{if(E=c.type._context,T=c.pendingProps,I=c.memoizedProps,G=T.value,Is(Xh,E._currentValue),E._currentValue=G,I!==null)if(Ki(I.value,G)){if(I.children===T.children&&!li.current){c=Or(d,c,_);break t}}else for(I=c.child,I!==null&&(I.return=c);I!==null;){var rt=I.dependencies;if(rt!==null){G=I.child;for(var xt=rt.firstContext;xt!==null;){if(xt.context===E){if(I.tag===1){xt=Dr(-1,_&-_),xt.tag=2;var Gt=I.updateQueue;if(Gt!==null){Gt=Gt.shared;var ue=Gt.pending;ue===null?xt.next=xt:(xt.next=ue.next,ue.next=xt),Gt.pending=xt}}I.lanes|=_,xt=I.alternate,xt!==null&&(xt.lanes|=_),Im(I.return,_,c),rt.lanes|=_;break}xt=xt.next}}else if(I.tag===10)G=I.type===c.type?null:I.child;else if(I.tag===18){if(G=I.return,G===null)throw Error(s(341));G.lanes|=_,rt=G.alternate,rt!==null&&(rt.lanes|=_),Im(G,_,c),G=I.sibling}else G=I.child;if(G!==null)G.return=I;else for(G=I;G!==null;){if(G===c){G=null;break}if(I=G.sibling,I!==null){I.return=G.return,G=I;break}G=G.return}I=G}Kn(d,c,T.children,_),c=c.child}return c;case 9:return T=c.type,E=c.pendingProps.children,ml(c,_),T=ki(T),E=E(T),c.flags|=1,Kn(d,c,E,_),c.child;case 14:return E=c.type,T=Ji(E,c.pendingProps),T=Ji(E.type,T),Vv(d,c,E,T,_);case 15:return jv(d,c,c.type,c.pendingProps,_);case 17:return E=c.type,T=c.pendingProps,T=c.elementType===E?T:Ji(E,T),ac(d,c),c.tag=1,ui(E)?(d=!0,jh(c)):d=!1,ml(c,_),Fv(c,E,T),Ym(c,E,T,_),Km(null,c,E,!0,d,_);case 19:return Kv(d,c,_);case 22:return Hv(d,c,_)}throw Error(s(156,c.tag))};function bb(d,c){return cs(d,c)}function HI(d,c,_,E){this.tag=d,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pi(d,c,_,E){return new HI(d,c,_,E)}function _p(d){return d=d.prototype,!(!d||!d.isReactComponent)}function $I(d){if(typeof d=="function")return _p(d)?1:0;if(d!=null){if(d=d.$$typeof,d===Z)return 11;if(d===K)return 14}return 2}function Ao(d,c){var _=d.alternate;return _===null?(_=Pi(d.tag,c,d.key,d.mode),_.elementType=d.elementType,_.type=d.type,_.stateNode=d.stateNode,_.alternate=d,d.alternate=_):(_.pendingProps=c,_.type=d.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=d.flags&14680064,_.childLanes=d.childLanes,_.lanes=d.lanes,_.child=d.child,_.memoizedProps=d.memoizedProps,_.memoizedState=d.memoizedState,_.updateQueue=d.updateQueue,c=d.dependencies,_.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},_.sibling=d.sibling,_.index=d.index,_.ref=d.ref,_}function yc(d,c,_,E,T,I){var G=2;if(E=d,typeof d=="function")_p(d)&&(G=1);else if(typeof d=="string")G=5;else t:switch(d){case k:return pa(_.children,T,I,c);case F:G=8,T|=8;break;case O:return d=Pi(12,_,c,T|2),d.elementType=O,d.lanes=I,d;case at:return d=Pi(13,_,c,T),d.elementType=at,d.lanes=I,d;case mt:return d=Pi(19,_,c,T),d.elementType=mt,d.lanes=I,d;case ht:return xc(_,T,I,c);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case j:G=10;break t;case V:G=9;break t;case Z:G=11;break t;case K:G=14;break t;case ut:G=16,E=null;break t}throw Error(s(130,d==null?d:typeof d,""))}return c=Pi(G,_,c,T),c.elementType=d,c.type=E,c.lanes=I,c}function pa(d,c,_,E){return d=Pi(7,d,E,c),d.lanes=_,d}function xc(d,c,_,E){return d=Pi(22,d,E,c),d.elementType=ht,d.lanes=_,d.stateNode={isHidden:!1},d}function yp(d,c,_){return d=Pi(6,d,null,c),d.lanes=_,d}function xp(d,c,_){return c=Pi(4,d.children!==null?d.children:[],d.key,c),c.lanes=_,c.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},c}function qI(d,c,_,E,T){this.tag=c,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=St(0),this.expirationTimes=St(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=St(0),this.identifierPrefix=E,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function vp(d,c,_,E,T,I,G,rt,xt){return d=new qI(d,c,_,rt,xt),c===1?(c=1,I===!0&&(c|=8)):c=0,I=Pi(3,null,null,c),d.current=I,I.stateNode=d,I.memoizedState={element:E,isDehydrated:_,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rm(I),d}function YI(d,c,_){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:E==null?null:""+E,children:d,containerInfo:c,implementation:_}}function Eb(d){if(!d)return mo;d=d._reactInternals;t:{if(je(d)!==d||d.tag!==1)throw Error(s(170));var c=d;do{switch(c.tag){case 3:c=c.stateNode.context;break t;case 1:if(ui(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break t}}c=c.return}while(c!==null);throw Error(s(171))}if(d.tag===1){var _=d.type;if(ui(_))return Z0(d,_,c)}return c}function Sb(d,c,_,E,T,I,G,rt,xt){return d=vp(_,E,!0,d,T,I,G,rt,xt),d.context=Eb(null),_=d.current,E=Qn(),T=Eo(_),I=Dr(E,T),I.callback=c??null,yo(_,I,T),d.current.lanes=T,bt(d,T,E),ci(d,E),d}function vc(d,c,_,E){var T=c.current,I=Qn(),G=Eo(T);return _=Eb(_),c.context===null?c.context=_:c.pendingContext=_,c=Dr(I,G),c.payload={element:d},E=E===void 0?null:E,E!==null&&(c.callback=E),d=yo(T,c,G),d!==null&&(sr(d,T,G,I),Kh(d,T,G)),G}function bc(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function Ab(d,c){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var _=d.retryLane;d.retryLane=_!==0&&_<c?_:c}}function bp(d,c){Ab(d,c),(d=d.alternate)&&Ab(d,c)}function WI(){return null}var wb=typeof reportError=="function"?reportError:function(d){console.error(d)};function Ep(d){this._internalRoot=d}Ec.prototype.render=Ep.prototype.render=function(d){var c=this._internalRoot;if(c===null)throw Error(s(409));vc(d,c,null,null)},Ec.prototype.unmount=Ep.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var c=d.containerInfo;ga(function(){vc(null,d,null,null)}),c[kr]=null}};function Ec(d){this._internalRoot=d}Ec.prototype.unstable_scheduleHydration=function(d){if(d){var c=ps();d={blockedOn:null,target:d,priority:c};for(var _=0;_<Js.length&&c!==0&&c<Js[_].priority;_++);Js.splice(_,0,d),_===0&&Cn(d)}};function Sp(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function Sc(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function Tb(){}function XI(d,c,_,E,T){if(T){if(typeof E=="function"){var I=E;E=function(){var Gt=bc(G);I.call(Gt)}}var G=Sb(c,E,d,0,null,!1,!1,"",Tb);return d._reactRootContainer=G,d[kr]=G.current,Nu(d.nodeType===8?d.parentNode:d),ga(),G}for(;T=d.lastChild;)d.removeChild(T);if(typeof E=="function"){var rt=E;E=function(){var Gt=bc(xt);rt.call(Gt)}}var xt=vp(d,0,!1,null,null,!1,!1,"",Tb);return d._reactRootContainer=xt,d[kr]=xt.current,Nu(d.nodeType===8?d.parentNode:d),ga(function(){vc(c,xt,_,E)}),xt}function Ac(d,c,_,E,T){var I=_._reactRootContainer;if(I){var G=I;if(typeof T=="function"){var rt=T;T=function(){var xt=bc(G);rt.call(xt)}}vc(c,G,d,T)}else G=XI(_,c,d,T,E);return bc(G)}we=function(d){switch(d.tag){case 3:var c=d.stateNode;if(c.current.memoizedState.isDehydrated){var _=re(c.pendingLanes);_!==0&&(Zt(c,_|1),ci(c,tt()),(fs&6)===0&&(vl=tt()+500,po()))}break;case 13:ga(function(){var E=zr(d,1);if(E!==null){var T=Qn();sr(E,d,1,T)}}),bp(d,1)}},We=function(d){if(d.tag===13){var c=zr(d,134217728);if(c!==null){var _=Qn();sr(c,d,134217728,_)}bp(d,134217728)}},ls=function(d){if(d.tag===13){var c=Eo(d),_=zr(d,c);if(_!==null){var E=Qn();sr(_,d,c,E)}bp(d,c)}},ps=function(){return ne},us=function(d,c){var _=ne;try{return ne=d,c()}finally{ne=_}},B=function(d,c,_){switch(c){case"input":if(is(d,_),c=_.name,_.type==="radio"&&c!=null){for(_=d;_.parentNode;)_=_.parentNode;for(_=_.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<_.length;c++){var E=_[c];if(E!==d&&E.form===d.form){var T=Gh(E);if(!T)throw Error(s(90));Ce(E),is(E,T)}}}break;case"textarea":hs(d,_);break;case"select":c=_.value,c!=null&&Je(d,!!_.multiple,c,!1)}},ct=fp,pt=ga;var ZI={usingClientEntryPoint:!1,Events:[ku,al,Gh,lt,dt,fp]},qu={findFiberByHostInstance:ra,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},KI={bundleType:qu.bundleType,version:qu.version,rendererPackageName:qu.rendererPackageName,rendererConfig:qu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=es(d),d===null?null:d.stateNode},findFiberByHostInstance:qu.findFiberByHostInstance||WI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wc.isDisabled&&wc.supportsFiber)try{Pt=wc.inject(KI),Lt=wc}catch{}}return gi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZI,gi.createPortal=function(d,c){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sp(c))throw Error(s(200));return YI(d,c,null,_)},gi.createRoot=function(d,c){if(!Sp(d))throw Error(s(299));var _=!1,E="",T=wb;return c!=null&&(c.unstable_strictMode===!0&&(_=!0),c.identifierPrefix!==void 0&&(E=c.identifierPrefix),c.onRecoverableError!==void 0&&(T=c.onRecoverableError)),c=vp(d,1,!1,null,null,_,!1,E,T),d[kr]=c.current,Nu(d.nodeType===8?d.parentNode:d),new Ep(c)},gi.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var c=d._reactInternals;if(c===void 0)throw typeof d.render=="function"?Error(s(188)):(d=Object.keys(d).join(","),Error(s(268,d)));return d=es(c),d=d===null?null:d.stateNode,d},gi.flushSync=function(d){return ga(d)},gi.hydrate=function(d,c,_){if(!Sc(c))throw Error(s(200));return Ac(null,d,c,!0,_)},gi.hydrateRoot=function(d,c,_){if(!Sp(d))throw Error(s(405));var E=_!=null&&_.hydratedSources||null,T=!1,I="",G=wb;if(_!=null&&(_.unstable_strictMode===!0&&(T=!0),_.identifierPrefix!==void 0&&(I=_.identifierPrefix),_.onRecoverableError!==void 0&&(G=_.onRecoverableError)),c=Sb(c,null,d,1,_??null,T,!1,I,G),d[kr]=c.current,Nu(d),E)for(d=0;d<E.length;d++)_=E[d],T=_._getVersion,T=T(_._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[_,T]:c.mutableSourceEagerHydrationData.push(_,T);return new Ec(c)},gi.render=function(d,c,_){if(!Sc(c))throw Error(s(200));return Ac(null,d,c,!1,_)},gi.unmountComponentAtNode=function(d){if(!Sc(d))throw Error(s(40));return d._reactRootContainer?(ga(function(){Ac(null,null,d,!1,function(){d._reactRootContainer=null,d[kr]=null})}),!0):!1},gi.unstable_batchedUpdates=fp,gi.unstable_renderSubtreeIntoContainer=function(d,c,_,E){if(!Sc(_))throw Error(s(200));if(d==null||d._reactInternals===void 0)throw Error(s(38));return Ac(d,c,_,!1,E)},gi.version="18.3.1-next-f1338f8080-20240426",gi}var Fb;function Iw(){if(Fb)return Tp.exports;Fb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Tp.exports=lk(),Tp.exports}var Pb;function uk(){if(Pb)return Tc;Pb=1;var t=Iw();return Tc.createRoot=t.createRoot,Tc.hydrateRoot=t.hydrateRoot,Tc}var dk=uk(),Yt=dh();const ds=sk(Yt);var hk=Object.create,hx=Object.defineProperty,ck=Object.getOwnPropertyDescriptor,kw=Object.getOwnPropertyNames,gk=Object.getPrototypeOf,fk=Object.prototype.hasOwnProperty,mk=(t,e)=>function(){return e||(0,t[kw(t)[0]])((e={exports:{}}).exports,e),e.exports},hh=(t,e)=>{for(var s in e)hx(t,s,{get:e[s],enumerable:!0})},pk=(t,e,s,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of kw(e))fk.call(t,i)||i===s||hx(t,i,{get:()=>e[i],enumerable:!(n=ck(e,i))||n.enumerable});return t},Rw=(t,e,s)=>(s=t!=null?hk(gk(t)):{},pk(t&&t.__esModule?s:hx(s,"default",{value:t,enumerable:!0}),t)),Fw=mk({"node_modules/@linkurious/spatial-index/dist/esm/index.js"(t,e){/**
     * @linkurious/spatial-index v0.5.8
     * Ogma spatial index data structures
     *
     * @author Alexander Milevski
     * @license ISC
     * @preserve
     */var s,n;s=t,n=function(i){function r(gt,M,P,D,B){const $=Math.abs(P-gt),H=gt<P?1:-1,X=-Math.abs(D-M),lt=M<D?1:-1;let dt,ct=$+X;for(;;){if(B(gt,M),dt=2*ct,dt>=X){if(gt===P)break;ct+=X,gt+=H}if(dt<=$){if(M===D)break;ct+=$,M+=lt}}}function o(gt,M="assert error"){if(!gt)throw new Error(M)}function a(gt,M,P,D,B,$,H){var X,lt,dt,ct,pt,yt=B-P,Nt=$-D,Tt=gt-P,At=M-D,Bt=Tt*Nt-At*yt;if(yt*yt+Nt*Nt>Tt*Tt+At*At&&(B=gt,gt=yt+P,$=M,M=Nt+D,Bt=-Bt),Bt!=0){Tt+=yt,At+=Nt,X=2*(Tt*=yt=gt<B?1:-1)*(At*=Nt=M<$?1:-1),Tt*=Tt,At*=At,Bt*yt*Nt<0&&(Tt=-Tt,At=-At,X=-X,Bt=-Bt),lt=4*Nt*(P-gt)*Bt+Tt-X,dt=4*yt*(M-D)*Bt+At-X,Tt+=Tt,At+=At,ct=lt+dt+X;do{if(Bt=Math.min(lt+X,-X-dt),pt=Math.max(lt+X,-X-dt),pt+=2*pt*Bt*Bt/(4*pt*pt+Bt*Bt),H(gt,M,255*Math.abs(ct-lt-dt-X)/pt),gt==B||M==$)break;P=gt,Bt=lt-ct,D=+(2*ct+dt<0),2*ct+lt>0&&(ct-dt<pt&&H(gt,M+Nt,255*Math.abs(ct-dt)/pt),gt+=yt,lt-=X,ct+=dt+=At),D&&(Bt<pt&&H(P+yt,M,255*Math.abs(Bt)/pt),M+=Nt,dt-=X,ct+=lt+=Tt)}while(dt<lt)}(function(xe,be,le,_e,Te){const Ve=xe<le?1:-1,ke=be<_e?1:-1;let je,Pe=Math.abs(le-xe),Be=Math.abs(_e-be),Ue=Pe*Pe+Be*Be,es=Ue===0?1:1/Math.sqrt(Ue);for(Pe*=es,Be*=es,Ue=Pe-Be;;){if(Te(xe,be,Math.abs(Ue-(Pe+Be))>>16),es=Ue,je=xe,2*es>=-Pe){if(xe===le)break;es+Be<16711680&&Te(xe,be+ke,es+Be>>16),Ue-=Be,xe+=Ve}if(2*es<=Be){if(be===_e)break;Pe-es<16711680&&Te(je+Ve,be,Pe-es>>16),Ue+=Pe,be+=ke}}})(gt,M,B,$,H)}function l(gt,M,P,D,B,$,H,X,lt){var dt,ct,pt,yt=1;let Nt,Tt,At,Bt,he,xe,be,le,_e,Te,Ve,ke=gt<H?1:-1,je=M<X?1:-1,Pe=-Math.abs(gt+P-B-H),Be=Pe-4*ke*(P-B),Ue=ke*(gt-P-B+H),es=-Math.abs(M+D-$-X),rs=es-4*je*(D-$),cs=je*(M-D-$+X),Y=.01;if(o((P-gt)*(B-H)<Y&&((H-gt)*(P-B)<Y||Ue*Ue<Be*Pe+Y),"slope change"),o((D-M)*($-X)<Y&&((X-M)*(D-$)<Y||cs*cs<rs*es+Y),"slope change"),Be==0&&rs==0)return ke=Math.floor((3*P-gt+1)/2),je=Math.floor((3*D-M+1)/2),(function(J,tt,ft,_t,it,vt,Ct){var Ft,Pt,Lt,$t,jt=it-ft,Ot=vt-_t,Ut=J-ft,Ht=tt-_t,Xt=Ut*Ot-Ht*jt;if(o(Ut*jt<=0&&Ht*Ot<=0,"sign of gradient must not change"),jt*jt+Ot*Ot>Ut*Ut+Ht*Ht&&(it=J,J=jt+ft,vt=tt,tt=Ot+_t,Xt=-Xt),Xt!=0){Ut+=jt,Ht+=Ot,Ft=2*(Ut*=jt=J<it?1:-1)*(Ht*=Ot=tt<vt?1:-1),Ut*=Ut,Ht*=Ht,Xt*jt*Ot<0&&(Ut=-Ut,Ht=-Ht,Ft=-Ft,Xt=-Xt),Pt=4*Ot*Xt*(ft-J)+Ut-Ft,Lt=4*jt*Xt*(tt-_t)+Ht-Ft,Ut+=Ut,Ht+=Ht,$t=Pt+Lt+Ft;do{if(Ct(J,tt),J==it&&tt==vt)return;_t=+(2*$t<Pt),2*$t>Lt&&(J+=jt,Pt-=Ft,$t+=Lt+=Ht),_t&&(tt+=Ot,Lt-=Ft,$t+=Pt+=Ut)}while(Lt<0&&Pt>0)}r(J,tt,it,vt,Ct)})(gt,M,ke,je,H,X,lt);P=(P-gt)*(P-gt)+(D-M)*(D-M)+1,B=(B-H)*(B-H)+($-X)*($-X)+1;do{Nt=Be*cs-Ue*rs,Tt=Be*es-Pe*rs,At=Ue*es-Pe*cs,Te=Nt*(Nt+Tt-3*At)+Tt*Tt,Nt*=dt=Te>0?1:Math.sqrt(1+1024/P),Tt*=dt,At*=dt,Te*=dt*dt,xe=9*(Nt+Tt+At)/8,Bt=8*(Be-rs),le=27*(8*Nt*(cs*cs-rs*es)+Te*(rs+2*cs+es))/64-rs*rs*(xe-rs),_e=27*(8*Nt*(Ue*Ue-Be*Pe)-Te*(Be+2*Ue+Pe))/64-Be*Be*(xe+Be),he=3*(3*Nt*(3*cs*cs-rs*rs-2*rs*es)-rs*(3*Tt*(rs+cs)+rs*Bt))/4,be=3*(3*Nt*(3*Ue*Ue-Be*Be-2*Be*Pe)-Be*(3*Tt*(Be+Ue)+Be*Bt))/4,xe=Be*rs*(6*Nt+6*Tt-3*At+Bt),Tt=rs*rs,Bt=Be*Be,xe=3*(xe+9*dt*(Bt*cs*es-Ue*Pe*Tt)-18*Ue*cs*Nt)/8,Te<0&&(le=-le,_e=-_e,he=-he,be=-be,xe=-xe,Tt=-Tt,Bt=-Bt),Nt=6*rs*Tt,Tt*=-6*Be,At=6*rs*Bt,Bt*=-6*Be,le+=xe,Te=le+_e,_e+=xe;t:for(Ve=xe,ct=pt=dt;gt!=H&&M!=X;){lt(gt,M);do{if(le>Ve||_e<Ve)break t;D=2*Te-_e,2*Te>=le&&(ct--,Te+=le+=he,_e+=xe+=Tt,be+=At,he+=Nt),D<=0&&(pt--,Te+=_e+=be,le+=xe+=At,he+=Tt,be+=Bt)}while(ct>0&&pt>0);2*ct<=dt&&(gt+=ke,ct+=dt),2*pt<=dt&&(M+=je,pt+=dt),Ve==xe&&le<0&&_e>0&&(Ve=Y)}he=gt,gt=H,H=he,ke=-ke,Ue=-Ue,be=M,M=X,X=be,je=-je,cs=-cs,P=B}while(yt--);r(gt,M,H,X,lt)}function u(gt,M,P,D,B,$,H,X,lt){(function(ct,pt,yt,Nt,Tt,At,Bt,he,xe,be){let le=0,_e=0,Te=ct+yt-Tt-Bt,Ve=Te-4*(yt-Tt),ke=ct-yt-Tt+Bt,je=ke+4*(yt+Tt),Pe=pt+Nt-At-he,Be=Pe-4*(Nt-At),Ue=pt-Nt-At+he,es=Ue+4*(Nt+At);var rs,cs,Y,et,J,tt,ft=ct,_t=pt;let it,vt=ke*ke-Ve*Te;const Ct=[0,0,0,0,0];for(Ve==0?Math.abs(Te)<2*Math.abs(ke)&&(Ct[le++]=Te/(2*ke)):vt>0&&(it=Math.sqrt(vt),vt=(ke-it)/Ve,Math.abs(vt)<1&&(Ct[le++]=vt),vt=(ke+it)/Ve,Math.abs(vt)<1&&(Ct[le++]=vt)),vt=Ue*Ue-Be*Pe,Be==0?Math.abs(Pe)<2*Math.abs(Ue)&&(Ct[le++]=Pe/(2*Ue)):vt>0&&(it=Math.sqrt(vt),vt=(Ue-it)/Be,Math.abs(vt)<1&&(Ct[le++]=vt),vt=(Ue+it)/Be,Math.abs(vt)<1&&(Ct[le++]=vt)),_e=1;_e<le;_e++)(vt=Ct[_e-1])>Ct[_e]&&(Ct[_e-1]=Ct[_e],Ct[_e]=vt,_e=0);for(vt=-1,Ct[le]=1,_e=0;_e<=le;_e++)it=Ct[_e],rs=(vt*(vt*ke-2*Te)-it*(vt*(vt*Ve-2*ke)+Te)+je)/8-ft,et=(vt*(vt*Ue-2*Pe)-it*(vt*(vt*Be-2*Ue)+Pe)+es)/8-_t,cs=(it*(it*ke-2*Te)-vt*(it*(it*Ve-2*ke)+Te)+je)/8-ft,J=(it*(it*Ue-2*Pe)-vt*(it*(it*Be-2*Ue)+Pe)+es)/8-_t,ft-=Y=(it*(it*(3*ke-it*Ve)-3*Te)+je)/8,_t-=tt=(it*(it*(3*Ue-it*Be)-3*Pe)+es)/8,Bt=Math.floor(Y+.5),he=Math.floor(tt+.5),ft!=0&&(rs*=ft=(ct-Bt)/ft,cs*=ft),_t!=0&&(et*=_t=(pt-he)/_t,J*=_t),(ct!=Bt||pt!=he)&&xe(ct,pt,ct+rs,pt+et,ct+cs,pt+J,Bt,he,be),ct=Bt,pt=he,ft=Y,_t=tt,vt=it})(gt,M,P,D,B,$,H,X,l,lt)}for(var h=Object.freeze({__proto__:null,AABB:0,SEGMENT:1,CURVE:3,LOOP:4,POINT:5}),g=[0,1],f=[0,2],m=4;m<65535;m<<=2)for(var y=0,p=g.length;y<p;y++)g.push(g[y]|m),f.push((g[y]|m)<<1);function x(gt,M){return(f[255&M]|g[255&gt])+65536*(f[M>>8&255]|g[gt>>8&255])+4294967296*(f[M>>16&255]|g[gt>>16&255])}let v,b;function S(gt,M=[0,0]){if(gt>0xffffffffffff)throw"Only morton codes up to 48 bits are supported.";if(!v){v={},b={};for(var P=0;P<256;P++)v[x(P,0)]=P,b[x(0,P)]=P}var D=v[21845&gt],B=b[43690&gt];return gt>65535&&(D|=v[21845&(gt/=65536)]<<8,B|=b[43690&gt]<<8,gt>65535&&(D|=v[21845&(gt/=65536)]<<16,B|=b[43690&gt]<<16)),M[0]=D,M[1]=B,M}x.code=function(M,P,D){if(M>24)throw"Morton codes are only supported up to Z=24";var B=1<<24-M;return x(P*B,D*B)},x.range=function(M,P,D){if(M>24)throw"Morton ranges are only supported up to Z=24";var B=1<<24-M,$=x(P*B,D*B);return[$,$+B*B-1]},x.reverse=S,x.decode=function(M,P){var D=S(P),B=1<<24-M;return[D[0]/B,D[1]/B]},x.min=function(M,P){var D=1431655765&M,B=1431655765&P,$=2863311530&M,H=2863311530&P;return Math.min(D,B)+Math.min($,H)};const A=x;let w,L,k;function F(gt,M,P){const D=1<<P;return[gt=~~(D*((gt+k)/L)),M=~~(D*((M+k)/L))]}function O(gt,M,P){const D=1<<P;return[gt=D*((gt+k)/L),M=D*((M+k)/L)]}function j(gt,M,P,D,B,$){const H=F(gt,M,B),X=F(P,D,B);for(let lt=H[0];lt<=X[0];lt++)for(let dt=H[1];dt<=X[1];dt++)$.push(A(lt,dt))}function V(gt,M,P){const[D,B]=F(gt[0],gt[1],M),[$,H]=F(gt[2],gt[3],M),[X,lt]=F(gt[4],gt[5],M);(function(ct,pt,yt,Nt,Tt,At,Bt){var he,xe=ct-yt,be=pt-Nt,le=ct-2*yt+Tt;xe*(Tt-yt)>0&&(be*(At-Nt)>0&&Math.abs((pt-2*Nt+At)/le*xe)>Math.abs(be)&&(ct=Tt,Tt=xe+yt,pt=At,At=be+Nt),he=(1-(le=(ct-yt)/le))*((1-le)*pt+2*le*Nt)+le*le*At,le=(ct*Tt-yt*yt)*le/(ct-yt),xe=Math.floor(le+.5),be=Math.floor(he+.5),he=(Nt-pt)*(le-ct)/(yt-ct)+pt,a(ct,pt,xe,Math.floor(he+.5),xe,be,Bt),he=(Nt-At)*(le-Tt)/(yt-Tt)+At,ct=yt=xe,pt=be,Nt=Math.floor(he+.5)),(pt-Nt)*(At-Nt)>0&&(he=(1-(le=(pt-Nt)/(le=pt-2*Nt+At)))*((1-le)*ct+2*le*yt)+le*le*Tt,le=(pt*At-Nt*Nt)*le/(pt-Nt),xe=Math.floor(he+.5),be=Math.floor(le+.5),he=(yt-ct)*(le-pt)/(Nt-pt)+ct,a(ct,pt,Math.floor(he+.5),be,xe,be,Bt),he=(yt-Tt)*(le-At)/(Nt-At)+Tt,ct=xe,yt=Math.floor(he+.5),pt=Nt=be),a(ct,pt,yt,Nt,Tt,At,Bt)})(D,B,$,H,X,lt,((dt,ct)=>{P.push(A(dt,ct))}))}(function(M){w=M,L=1<<w,k=1<<w-1})(14);const Z=[[0,0],[0,0]];function at(gt,M){const P=gt.type,D=gt.coordinates,B=[];switch(P){case 1:Z[0][0]=D[0],Z[0][1]=D[1],Z[1][0]=D[2],Z[1][1]=D[3],(function(H,X,lt,dt){for(var ct,pt,yt=0;yt<H.length-1;yt++){var Nt=O(H[yt][0],H[yt][1],X),Tt=O(H[yt+1][0],H[yt+1][1],X),At=Nt[0],Bt=Nt[1],he=Tt[0]-At,xe=Tt[1]-Bt;if(xe!==0||he!==0){var be=he>0?1:-1,le=xe>0?1:-1,_e=Math.floor(At),Te=Math.floor(Bt),Ve=he===0?1/0:Math.abs(((he>0?1:0)+_e-At)/he),ke=xe===0?1/0:Math.abs(((xe>0?1:0)+Te-Bt)/xe),je=Math.abs(be/he),Pe=Math.abs(le/xe);for(_e===ct&&Te===pt||(dt.push(A(_e,Te)),ct=_e,pt=Te);Ve<1||ke<1;)Ve<ke?(Ve+=je,_e+=be):(ke+=Pe,Te+=le),dt.push(A(_e,Te)),ct=_e,pt=Te}}})(Z,M,void 0,B);break;case 0:j(D[0],D[1],D[2],D[3],M,B);break;case 5:j(D[0]-D[2],D[1]-D[2],D[0]+D[2],D[1]+D[2],M,B);break;case 3:V(D,M,B);break;case 4:(function(H,X,lt){const[dt,ct]=F(H[0],H[1],X),[pt,yt]=F(H[2],H[3],X),[Nt,Tt]=F(H[4],H[5],X),[At,Bt]=F(H[6],H[7],X);u(dt,ct,pt,yt,Nt,Tt,At,Bt,((he,xe)=>{lt.push(A(he,xe))}))})(D,M,B)}return B}class mt{constructor(M=Int32Array,P=16,D=8){this._BIG_LIST=new Uint8Array([-1])[0],this._ArrayType=M,this._capacity=P,this._MAX_LIST_SIZE=D,this._freeIndex=-1,this.clear()}clear(){this._buffer=new this._ArrayType(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._idToIndex=new Map,this._constList=new Array(this._MAX_LIST_SIZE)}addEntry(M){let P;return this._freeIndex===-1?P=this._nextIndex++:(P=this._freeIndex,this._freeIndex=-1),this._idToIndex.set(M,P),P>=this._capacity&&this._expand(P+1),this._sizes[P]=0,P}getItems(M){const P=this._idToIndex.get(M);if(P===void 0)return;const D=this._sizes[P],B=this._MAX_LIST_SIZE*P;if(D<=this._MAX_LIST_SIZE){this._constList.length=D;for(let $=0,H=D;$<H;++$)this._constList[$]=this._buffer[B+$];return this._constList}if(D===this._BIG_LIST){const $=this._buffer[B];return this._bigLists[$]}}removeEntry(M){const P=this._idToIndex.get(M);if(this._sizes[P]===this._BIG_LIST){const D=this._MAX_LIST_SIZE*P,B=this._buffer[D];this._bigLists[B].length=0}this._sizes[P]=0,this._freeIndex=P}size(M){const P=this._idToIndex.get(M),D=this._sizes[P];return D<=this._MAX_LIST_SIZE?D:this._bigLists[this._buffer[P*this._MAX_LIST_SIZE]].length}sizes(M){const P=this._sizes,D=this._bigLists,B=this._buffer,$=this._MAX_LIST_SIZE,H=M.length,X=new Array(H);for(let lt=0;lt<H;lt++){const dt=this._idToIndex.get(M[lt]),ct=P[dt];X[lt]=ct<=$?ct:D[B[dt*$]].length}return X}addTo(M,P){const D=this._idToIndex.get(M),B=this._sizes[D],$=D*this._MAX_LIST_SIZE;if(B<this._MAX_LIST_SIZE)this._buffer[$+B]=P,this._sizes[D]=B+1;else if(B===this._BIG_LIST){const H=this._buffer[$];this._bigLists[H].push(P)}else{const H=new Array(this._MAX_LIST_SIZE);for(let X=0;X<this._MAX_LIST_SIZE;++X)H[X]=this._buffer[$+X];H.push(P),this._bigLists.push(H),this._sizes[D]=this._BIG_LIST,this._buffer[$]=this._bigLists.length-1}}removeFrom(M,P){this.removeFromAndGetSize(M,P)}removeFromAndGetSize(M,P){const D=this._idToIndex.get(M);let B=this._sizes[D];const $=this._MAX_LIST_SIZE*D;if(B<=this._MAX_LIST_SIZE){for(let H=$,X=$+B;H<X;++H)if(this._buffer[H]===P)return B-=1,this._buffer[H]=this._buffer[X-1],this._sizes[D]=B,B}else if(B===this._BIG_LIST){const H=this._buffer[$],X=this._bigLists[H],lt=X.indexOf(P);if(lt!==-1)return X.splice(lt,1),X.length}}reserve(M){this._capacity<M&&this._expand(M)}_expand(M){this._capacity=Math.pow(2,Math.ceil(Math.log2(M))),this._buffer=K(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=K(this._sizes,this._capacity)}has(M){const P=this._idToIndex.get(M);return!(P===void 0||P>=this._capacity)&&this._sizes[P]!==0}keys(){return Array.from(this._idToIndex.keys())}get averageSize(){let M=0;for(let P=0;P<this._capacity;P++)M+=this._sizes[P];return M/this._capacity}}function K(gt,M){const P=new gt.constructor(M);return P.set(gt),P}function ut(){for(var gt=arguments,M=gt.length-1,P=M,D=[],B=0;B<=M&&Math.abs(gt[B])<=1e-12;B++)M--;switch(M){case 1:ht(gt[P],gt[P-1],D);break;case 2:nt(gt[P],gt[P-1],gt[P-2],D);break;case 3:ot(gt[P],gt[P-1],gt[P-2],gt[P-3],D)}return D}function ht(gt,M,P=[]){return M!==0&&P.push(-gt/M),P}function nt(gt,M,P,D=[]){var B=M/P,$=B*B-gt/P*4;if($>0){var H=Math.sqrt($);D.push(.5*(-B+H)),D.push(.5*(-B-H))}else $===0&&D.push(.5*-B);return D}function ot(gt,M,P,D,B=[]){var $,H,X=P/D,lt=M/D,dt=(3*lt-X*X)/3,ct=(2*X*X*X-9*lt*X+gt/D*27)/27,pt=X/3,yt=ct*ct/4+dt*dt*dt/27,Nt=ct/2;if(Math.abs(yt)<=1e-6&&(yt=0),yt>0){var Tt=Math.sqrt(yt);H=($=-Nt+Tt)>=0?Math.pow($,1/3):-Math.pow(-$,1/3),($=-Nt-Tt)>=0?H+=Math.pow($,1/3):H-=Math.pow(-$,1/3),B.push(H-pt)}else if(yt<0){var At=Math.sqrt(-dt/3),Bt=Math.atan2(Math.sqrt(-yt),-Nt)/3,he=Math.cos(Bt),xe=Math.sin(Bt),be=Math.sqrt(3);B.push(2*At*he-pt),B.push(-At*(he+be*xe)-pt),B.push(-At*(he-be*xe)-pt)}else $=Nt>=0?-Math.pow(Nt,1/3):Math.pow(-Nt,1/3),B.push(2*$-pt),B.push(-$-pt);return B}function Mt(gt,M,P,D,B,$,H,X,lt,dt,ct){for(var pt,yt,Nt=Math.min(H,lt),Tt=Math.min(X,dt),At=Math.max(H,lt),Bt=Math.max(X,dt),he=ut((pt=X-dt)*(gt+-2*P+B)+(yt=lt-H)*(M+-2*D+$),pt*(-2*gt+2*P)+yt*(-2*M+2*D),pt*gt+yt*M+(H*dt-lt*X)),xe=0;xe<he.length;xe++){var be=he[xe];if(0<=be&&be<=1){var le=gt+(P-gt)*be,_e=M+(D-M)*be,Te=le+(P+(B-P)*be-le)*be,Ve=_e+(D+($-D)*be-_e)*be;if(H===lt){if(Tt<=Ve&&Ve<=Bt)return 1}else if(X===dt){if(Nt<=Te&&Te<=At)return 1}else if(Te>=Nt&&Ve>=Tt&&Te<=At&&Ve<=Bt)return 1}}return ct?ct.length/2:0}function Q(gt,M,P,D,B,$,H,X,lt,dt,ct,pt,yt){for(var Nt,Tt,At=Math.min(lt,ct),Bt=Math.min(dt,pt),he=Math.max(lt,ct),xe=Math.max(dt,pt),be=ut((Nt=dt-pt)*(-1*gt+3*P+-3*B+H)+(Tt=ct-lt)*(-1*M+3*D+-3*$+X),Nt*(3*gt+-6*P+3*B)+Tt*(3*M+-6*D+3*$),Nt*(-3*gt+3*P)+Tt*(-3*M+3*D),Nt*gt+Tt*M+(lt*pt-ct*dt)),le=0;le<be.length;le++){var _e=be[le];if(0<=_e&&_e<=1){var Te=gt+(P-gt)*_e,Ve=M+(D-M)*_e,ke=P+(B-P)*_e,je=D+($-D)*_e,Pe=Te+(ke-Te)*_e,Be=Ve+(je-Ve)*_e,Ue=Pe+(ke+(B+(H-B)*_e-ke)*_e-Pe)*_e,es=Be+(je+($+(X-$)*_e-je)*_e-Be)*_e;if(lt===ct){if(Bt<=es&&es<=xe)return 1}else if(dt===pt){if(At<=Ue&&Ue<=he)return 1}else if(Ue>=At&&es>=Bt&&Ue<=he&&es<=xe)return 1}}return yt?yt.length/2:0}const Et=function(M,P,D,B,$,H,X,lt,dt,ct,pt){return X<=M&&dt>=M&&lt<=P&&ct>=P||X<=$&&dt>=$&&lt<=H&&ct>=H||Mt(M,P,D,B,$,H,X,lt,dt,lt)||Mt(M,P,D,B,$,H,dt,lt,dt,ct)||Mt(M,P,D,B,$,H,X,ct,dt,ct)||Mt(M,P,D,B,$,H,X,lt,X,ct)?1:0},qt=function(M,P,D,B,$,H,X,lt,dt,ct,pt,yt,Nt){return dt<=M&&pt>=M&&ct<=P&&yt>=P||dt<=X&&pt>=X&&ct<=lt&&yt>=lt||Q(M,P,D,B,$,H,X,lt,dt,ct,pt,ct)||Q(M,P,D,B,$,H,X,lt,pt,ct,pt,yt)||Q(M,P,D,B,$,H,X,lt,dt,yt,pt,yt)||Q(M,P,D,B,$,H,X,lt,dt,ct,dt,yt)?1:0};function Vt(gt,M,P){return Math.min(Math.max(M,gt),P)}function Wt(gt,M,P,D,B,$,H,X){const lt=((H-B)*(M-$)-(X-$)*(gt-B))/((X-$)*(P-gt)-(H-B)*(D-M)),dt=((P-gt)*(M-$)-(D-M)*(gt-B))/((X-$)*(P-gt)-(H-B)*(D-M));return lt>=0&&lt<=1&&dt>=0&&dt<=1}function oe(gt,M,P,D,B){const $=gt.type,H=gt.coordinates;return $===5?(function(lt,dt,ct,pt,yt,Nt,Tt){const At=lt-Vt(lt,pt,Nt),Bt=dt-Vt(dt,yt,Tt);return At*At+Bt*Bt<ct*ct})(H[0],H[1],H[2],M,P,D,B):$===1?(function(lt,dt,ct,pt,yt,Nt,Tt,At){return lt>=yt&&dt>=Nt&&lt<=Tt&&dt<=At||ct>=yt&&pt>=Nt&&ct<=Tt&&pt<=At||!!Wt(lt,dt,ct,pt,yt,Nt,yt,At)||!!Wt(lt,dt,ct,pt,Tt,Nt,Tt,At)||!!Wt(lt,dt,ct,pt,yt,Nt,Tt,Nt)||!!Wt(lt,dt,ct,pt,yt,At,Tt,At)})(H[0],H[1],H[2],H[3],M,P,D,B):$===3?Et(H[0],H[1],H[2],H[3],H[4],H[5],M,P,D,B):$===4?qt(H[0],H[1],H[2],H[3],H[4],H[5],H[6],H[7],M,P,D,B):(function(lt,dt){return lt[3]>dt[1]&&lt[1]<dt[3]&&lt[2]>dt[0]&&lt[0]<dt[2]})(H,[M,P,D,B])}const me=2863311530,se=4294967295,Jt=31;function ee(gt,M,P){let D=M;for(let B=Jt;B>=0;B--){const $=1<<B,H=((P&$)<<2|(gt&$)<<1|M&$)>>B;if(H===1)D=gt&~(me>>>Jt-B)&se|1<<B,M=(M|me>>>Jt-B&~(se<<B)&se)&~(1<<B)&se;else{if(H===3)return gt;if(H===4)return D;H===5&&(gt=gt&~(me>>>Jt-B)&se|1<<B)}}return D}function ce(gt,M,P){for(let D=Jt;D>=0;D--){const B=1<<D,$=((P&B)<<2|(gt&B)<<1|M&B)>>D;if($===1)M=(M|me>>>Jt-D&~(se<<D)&se)&~(1<<D)&se;else{if($===3||$===4)return!1;$===5&&(gt=gt&~(me>>>Jt-D)&se|1<<D)}}return!0}function Ce(gt,M,P){const D=P+1;let B=0;for(let $=Jt;$>=0;$--){const H=1<<$,X=(D&H)>>$,lt=(gt&H)>>$,dt=(M&H)>>$,ct=1&$,pt=B&3<<2*ct;if(pt===0&&X>dt&&lt<=dt){B|=2<<2*ct;break}if(pt===0&&X<lt){B|=1<<2*ct;break}}return B===0?D:ee(gt,M,P)}class ve{constructor(M,P){this.key=M,this.data=P,this.left=null,this.right=null}}function Me(gt,M){return gt>M?1:gt<M?-1:0}function ge(gt,M,P){if(M===null)return M;let D,B,$;const H=new ve;for(D=B=H;;){const X=P(gt,M.key);if(X<0){if(M.left===null||P(gt,M.left.key)<0&&($=M.left,M.left=$.right,$.right=M,(M=$).left===null))break;B.left=M,B=M,M=M.left}else{if(!(X>0)||M.right===null||P(gt,M.right.key)>0&&($=M.right,M.right=$.left,$.left=M,(M=$).right===null))break;D.right=M,D=M,M=M.right}}return D.right=M.left,B.left=M.right,M.left=H.right,M.right=H.left,M}function ze(gt,M,P,D,B){const $=new ve(gt,M);if(B._size++,P===null)return $.left=$.right=null,$;const H=D(gt,(P=ge(gt,P,D)).key);return H<0?($.left=P.left,$.right=P,P.left=null):H>=0&&($.right=P.right,$.left=P,P.right=null),$}function is(gt,M,P,D){let B;return M===null?null:P(gt,(M=ge(gt,M,P)).key)===0?(M.left===null?B=M.right:(B=ge(gt,M.left,P),B.right=M.right),D._size--,B):M}function Ge(gt,M,P){let D,B;if(M===null)D=B=null;else{const $=P((M=ge(gt,M,P)).key,gt);$===0?(D=M.left,B=M.right):$<0?(B=M.right,M.right=null,D=M):(D=M.left,M.left=null,B=M)}return{left:D,right:B}}function De(gt,M,P,D,B){if(gt){D(`${M}${P?" ":" "}${B(gt)}
`);const $=M+(P?"    ":"   ");gt.left&&De(gt.left,$,!1,D,B),gt.right&&De(gt.right,$,!0,D,B)}}class He{constructor(M=Me){this._comparator=M,this._root=null,this._size=0}insert(M,P){return this._root=ze(M,P,this._root,this._comparator,this)}add(M,P){return this._root=(function(B,$,H,X,lt){const dt=new ve(B,$);if(H===null)return dt.left=dt.right=null,lt._size++,dt;const ct=X(B,(H=ge(B,H,X)).key);return ct===0?H:(ct<0?(dt.left=H.left,dt.right=H,H.left=null):ct>0&&(dt.right=H.right,dt.left=H,H.right=null),lt._size++,dt)})(M,P,this._root,this._comparator,this)}remove(M){this._root=is(M,this._root,this._comparator,this)}pop(){let M=this._root;if(M){for(;M.left;)M=M.left;return this._root=ge(M.key,this._root,this._comparator),this._root=is(M.key,this._root,this._comparator,this),{key:M.key,data:M.data}}return null}findStatic(M){let P=this._root;const D=this._comparator;for(;P;){const B=D(M,P.key);if(B===0)return P;P=B<0?P.left:P.right}return null}find(M){return this._root&&(this._root=ge(M,this._root,this._comparator),this._comparator(M,this._root.key)!==0)?null:this._root}contains(M){let P=this._root;const D=this._comparator;for(;P;){const B=D(M,P.key);if(B===0)return!0;P=B<0?P.left:P.right}return!1}forEach(M,P){let D=this._root;const B=[];let $=!1;for(;!$;)D!==null?(B.push(D),D=D.left):B.length!==0?(D=B.pop(),M.call(P,D),D=D.right):$=!0;return this}range(M,P,D,B){const $=[],H=this._comparator;let X,lt=this._root;for(;$.length!==0||lt;)if(lt)$.push(lt),lt=lt.left;else{if(lt=$.pop(),X=H(lt.key,P),X>0)break;if(H(lt.key,M)>=0&&D.call(B,lt))return this;lt=lt.right}return this}keys(){const M=[];return this.forEach((({key:P})=>M.push(P))),M}values(){const M=[];return this.forEach((({data:P})=>M.push(P))),M}min(){return this._root?this.minNode(this._root).key:null}max(){return this._root?this.maxNode(this._root).key:null}minNode(M=this._root){if(M)for(;M.left;)M=M.left;return M}maxNode(M=this._root){if(M)for(;M.right;)M=M.right;return M}at(M){let P=this._root,D=!1,B=0;const $=[];for(;!D;)if(P)$.push(P),P=P.left;else if($.length>0){if(P=$.pop(),B===M)return P;B++,P=P.right}else D=!0;return null}next(M){let P=this._root,D=null;if(M.right){for(D=M.right;D.left;)D=D.left;return D}const B=this._comparator;for(;P;){const $=B(M.key,P.key);if($===0)break;$<0?(D=P,P=P.left):P=P.right}return D}prev(M){let P=this._root,D=null;if(M.left!==null){for(D=M.left;D.right;)D=D.right;return D}const B=this._comparator;for(;P;){const $=B(M.key,P.key);if($===0)break;$<0?P=P.left:(D=P,P=P.right)}return D}clear(){return this._root=null,this._size=0,this}toList(){return(function(P){var D=P,B=[],$=!1;const H={next:null};let X=H;for(;!$;)D?(B.push(D),D=D.left):B.length>0?D=(D=X=X.next=B.pop()).right:$=!0;return X.next=null,H.next})(this._root)}load(M=[],P=[],D=!1){let B=M.length;const $=this._comparator;if(D&&ts(M,P,0,B-1,$),this._root===null)this._root=Je(this._root,M,P,0,B),this._size=B;else{const H=(function(lt,dt,ct=((pt,yt)=>pt-yt)){const pt={};let yt=pt,Nt=lt,Tt=dt;for(;Nt!==null&&Tt!==null;)ct(Nt.key,Tt.key)<0?(yt.next=Nt,Nt=Nt.next):(yt.next=Tt,Tt=Tt.next),yt=yt.next;return Nt!==null?yt.next=Nt:Tt!==null&&(yt.next=Tt),pt.next})(this.toList(),(function(lt,dt){const ct={next:null};let pt=ct;for(let yt=0;yt<lt.length;yt++)pt=pt.next={key:lt[yt],data:dt[yt]};return pt.next=null,ct.next})(M,P),$);B=this._size+B,this._root=ss({head:H},0,B)}return this}isEmpty(){return this._root===null}get size(){return this._size}toString(M=(P=>P.key)){const P=[];return De(this._root,"",!0,(D=>P.push(D)),M),P.join("")}update(M,P,D){const B=this._comparator;let{left:$,right:H}=Ge(M,this._root,B);this._size--,B(M,P)<0?H=ze(P,D,H,B,this):$=ze(P,D,$,B,this),this._root=(function(lt,dt,ct){return dt===null?lt:(lt===null||((dt=ge(lt.key,dt,ct)).left=lt),dt)})($,H,B)}split(M){return Ge(M,this._root,this._comparator)}}function Je(gt,M,P,D,B){const $=B-D;if($>0){const H=D+Math.floor($/2),X={key:M[H],data:P[H],parent:gt};return X.left=Je(X,M,P,D,H),X.right=Je(X,M,P,H+1,B),X}return null}function ss(gt,M,P){const D=P-M;if(D>0){const B=M+Math.floor(D/2),$=ss(gt,M,B),H=gt.head;return H.left=$,gt.head=gt.head.next,H.right=ss(gt,B+1,P),H}return null}function ts(gt,M,P,D,B){if(P>=D)return;const $=gt[P+D>>1];let H=P-1,X=D+1;for(;;){do H++;while(B(gt[H],$)<0);do X--;while(B(gt[X],$)>0);if(H>=X)break;let lt=gt[H];gt[H]=gt[X],gt[X]=lt,lt=M[H],M[H]=M[X],M[X]=lt}ts(gt,M,P,X,B),ts(gt,M,X+1,D,B)}class hs extends He{constructor(M){super(M)}lte(M){const P=this._comparator;let D,B=this._root;for(;B;){if(D=P(B.key,M),B.left===null&&B.right===null&&D>0)return null;if(D<=0&&B.right===null||D<=0&&P(B.right.key,M)>0)return B;B=D>=0?B.left:B.right}return B}gte(M){const P=[],D=this._comparator;let B=this._root;for(;P.length!==0||B;)if(B)P.push(B),B=B.left;else{if(B=P.pop(),D(B.key,M)>=0)break;B=B.right}return B}clear(){return this._root=null,this._size=0,this}}class Fe{constructor(M,P=8){this.setLevel(P),this.setAccessor(M),this._tree=new hs(((D,B)=>D-B)),this._nodeToId=new mt(Uint32Array,1e3,16),this._idToNode=new mt(Uint32Array,16,8),this._size=0,this._checkedNodes=[],this._codeCache=[0,0]}setAccessor(M){return this._getGeometry=M,this}load(M){const P=[],D=this._nodeToId,B=this._idToNode,$=this._level,H=this._getGeometry;for(let X=0;X<M.length;X++){const lt=M[X],dt=at(H(lt),$);B.addEntry(lt);for(let ct=0;ct<dt.length;ct++){const pt=dt[ct];D.has(pt)||(D.addEntry(pt),P.push(pt)),D.addTo(pt,lt),B.addTo(lt,pt)}}return this._tree.load(P,[],!0),this._size+=M.length,this}addToPage(){}removeFromPage(){}insert(M){const P=at(this._getGeometry(M),this._level),D=this._idToNode,B=this._nodeToId,$=this._tree;this._size++,D.addEntry(M);for(let H=0;H<P.length;H++){const X=P[H];B.has(X)||($.insert(X),B.addEntry(X)),B.addTo(X,M),D.addTo(M,X)}}remove(M){const P=this._idToNode.getItems(M),D=this._nodeToId,B=this._tree;if(P)for(let $=0;$<P.length;$++){const H=P[$];D.removeFromAndGetSize(H,M)===0&&B.remove(H)}return this._idToNode.removeEntry(M),this._size--,this}update(M){return this.remove(M),this.insert(M),this}forEach(M){return this._tree.forEach(M),this}all(){const M=[];return this._tree.forEach((P=>{M.push(P)})),M}clear(){return this._tree.clear(),this._nodeToId.clear(),this._idToNode.clear(),this}setLevel(M){return this._level=M,this}traverse(M,P,D,B,$){const[H,X]=O(M,P,this._level),[lt,dt]=O(D,B,this._level),ct=x(H,X),pt=x(lt,dt);let yt=this._tree._root;const Nt=[];let Tt=ct;for(;Nt.length>0||yt;)if(yt)Nt.push(yt),yt=yt.left;else{yt=Nt.pop();const At=yt.key;if(At>pt)break;if(At>=ct&&At>=Tt&&(Tt=Ce(ct,pt,At),$(yt)))return this;yt=yt.right}return this}getKeys(M){const[P,D,B,$]=M,[H,X]=O(P,D,this._level),[lt,dt]=O(B,$,this._level),ct=x(H,X),pt=x(lt,dt);let yt=this._tree._root;const Nt=[];let Tt=ct;for(;Nt.length>0||yt;)if(yt)Nt.push(yt),yt=yt.left;else{yt=Nt.pop();const At=yt.key;if(At>pt)break;At>=ct&&At>=Tt&&(Tt=Ce(ct,pt,At)),yt=yt.right}return this}traverseDescend(M,P,D,B,$){const H=O(P,D,this._level),X=O(B,$,this._level),lt=x(H[0],H[1]),dt=x(X[0],X[1]);return this._recurse(this._tree._root,lt,dt,lt,dt,M),this}traverseRange(M,P,D,B,$){const[H,X]=O(P,D,this._level),[lt,dt]=O(B,$,this._level),ct=x(H,X),pt=x(lt,dt);return this._tree.range(ct,pt,(yt=>{const Nt=yt.key;if(ce(ct,pt,Nt)&&M(yt))return!0})),this}_recurse(M,P,D,B,$,H){if(M===null)return;const X=M.key;if(X<P)return this._recurse(M.right,P,D,B,$,H);if(X>D)return this._recurse(M.left,P,D,B,$,H);if(ce(B,$,X)){if(this._recurse(M.left,P,X,B,$,H),H(M))return;this._recurse(M.right,X,D,B,$,H)}else{const lt=ee(B,$,X),dt=(function(pt,yt,Nt){let Tt=pt;for(let At=Jt;At>=0;At--){const Bt=1<<At,he=((Nt&Bt)<<2|(pt&Bt)<<1|yt&Bt)>>At;if(he===1)yt=(yt|me>>>Jt-At&~(se<<At)&se)&~(1<<At)&se;else{if(he===3)return Tt;if(he===4)return yt;he===5&&(Tt=(yt|me>>>Jt-At&~(se<<At)&se)&~(1<<At)&se,pt=pt&~(me>>>Jt-At)&se|1<<At)}}return Tt})(B,$,X);this._recurse(M.left,P,dt,B,$,H),this._recurse(M.right,lt,D,B,$,H)}}query(M,P,D,B){const $=[],H=[];this.traverse(M,P,D,B,(dt=>{$.push(dt)}));const X={},lt=this._getGeometry;this._intersectionChecks=0;for(let dt=0;dt<$.length;dt++){const ct=$[dt],pt=this._nodeToId.getItems(ct.key);for(let yt=0;yt<pt.length;yt++){const Nt=pt[yt];if(!X[Nt]){const Tt=lt(Nt);this._intersectionChecks++,oe(Tt,M,P,D,B)&&H.push(Nt),X[Nt]=!0}}}return this._checkedNodes=$,H}getItems(M){return this._nodeToId.getItems(M)}get intersectionChecks(){return this._intersectionChecks}get level(){return this._level}get size(){return this._size}keyToBBox(M){const P=(function(){return w})(),[D,B]=x.reverse(M),$=1<<12-this._level+(P-12),H=1<<P-1;return[D*$-H,B*$-H,(D+1)*$-H,(B+1)*$-H]}}Fe.MAX_ZOOM=12;var Oe=typeof Map>"u"?class{constructor(){this._values={},this._size=0}get size(){return this._size}has(M){return!!this._values[M]}set(M,P){M in this._values||this._size++,this._values[M]=P}get(M){return this._values[M]}delete(M){M in this._values&&(delete this._values[M],this._size--)}keys(){return Object.keys(this._values)}clear(){this._values={},this._size=0}}:Map,Cs=typeof Set>"u"?class{constructor(){this._values={},this._size=0}get size(){return this._size}has(M){return!!this._values[M]}add(M){M in this._values||this._size++,this._values[M]=!0}delete(M){M in this._values&&(delete this._values[M],this._size--)}keys(){return Object.keys(this._values)}clear(){this._values={},this._size=0}}:Set;class Fs{constructor(){this._intersects=null,this._getBounds=null}setBoundsGetter(M){return this._getBounds=M,this}setIntersector(M){return this._intersects=M,this}}function Hs(gt,M,P,D,B,$,H,X){return D>=$&&M<=X&&P>=B&&gt<=H}const Ls=(gt,M,P,D,B,$)=>({minX:gt,minY:M,maxX:P,maxY:D,leaf:!0,level:$,parent:B,objects:[],final:!1,children:null});function En(gt){const{minX:M,minY:P,maxX:D,maxY:B}=gt;return[M,P,D,B]}function hn(gt,M,P,D,B,$,H,X){return gt>=B&&P<=H&&M>=$&&D<=X}function on(gt,M,P,D,B,$,H,X){const lt=($+X)/2,dt=(M+D)/2;return(gt+P)/2<=(B+H)/2?dt<=lt?0:1:dt<=lt?3:2}const xs=gt=>gt;class Ps extends Fs{constructor(M=xs,P=10,D,B=0){super(),this._nodeCapacity=10,this._root=null,this._objects={},this._size=0,this._rootLevel=0,this._maxLevel=30,this._idToCell={},this._nodeCapacity=P,this._root=null,this._getBounds=M,this._rootLevel=B,this._maxLevel=B+30,this._idToCell={},D&&(this._root=Ls(D[0],D[1],D[2],D[3],null,B))}get size(){return this._size}get root(){return this._root}clear(){return this._root=null,this._objects={},this._size=0,this._idToCell={},this._rootLevel=0,this._maxLevel=this._rootLevel+30,this}insert(M,P,D,B,$,H=this._root){if(P||([P,D,B,$]=this._getBounds(M)),this._objects[M])return;if(this._objects[M]=!0,this._size++,!this._root){const Tt=Math.max(Math.abs(B-P),Math.abs($-D));return this._root=Ls(P,D,P+Tt,D+Tt,null,this._rootLevel),this._idToCell[M]=[this._root],this._root.objects=[M],M}let X,lt=[H],dt=!1;const ct=this._nodeCapacity,pt=this._idToCell,yt=this._maxLevel;let Nt;for(;Nt=lt.pop();){X=Nt;const{minX:Tt,minY:At,maxX:Bt,maxY:he}=X;Hs(P,D,B,$,Tt,At,Bt,he)&&(X.leaf?X.objects&&(X.objects.length<ct||X.final)?(X.objects.push(M),pt[M]?pt[M].push(X):pt[M]=[X],dt=!0,(X.level>=yt||Math.abs(Bt-Tt)<=Math.abs(B-P)||Math.abs(he-At)<=Math.abs($-D))&&(X.final=!0)):(this.splitNode(X),lt.push(X)):lt.push.apply(lt,X.children))}if(!hn(P,D,B,$,(H=this._root).minX,H.minY,H.maxX,H.maxY)){let Tt=this._rootLevel;for(;!hn(P,D,B,$,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){H=this._root;const{minX:At,minY:Bt,maxX:he,maxY:xe}=H;let be=At,le=Bt,_e=he,Te=xe;const Ve=Math.abs(he-At),ke=Math.abs(xe-Bt);if(ke===0&&Ve===0)break;const je=Math.max(Ve,ke);P<At?(be-=je,D<Bt?le-=je:Te+=je):(_e+=je,D<Bt?le-=je:Te+=je);const Pe=Ls(be,le,_e,Te,null,--Tt);this.splitNode(Pe),Pe.children[on(At,Bt,he,xe,be,le,_e,Te)]=H,this._root=H.parent=Pe}for(lt=[this._root],this._root.level=this._rootLevel;Nt=lt.shift();)if(X=Nt,!X.leaf)for(let At=0;At<4;At++){const Bt=X.children[At];Bt.level=X.level+1,lt.push(Bt)}H=this._root;for(let At=0;At<4;At++){const Bt=H.children[At];Bt&&Bt.leaf&&Bt.objects&&(Bt.objects.push(M),pt[M]?pt[M].push(Bt):pt[M]=[Bt])}}return dt?M:void 0}removeById(M){if(!this._objects[M])return M;this._size--;const P=this._idToCell[M];for(let D=0;D<P.length;D++){const B=P[D].objects||[];for(let $=0,H=B.length;$<H;$++)if(B[$]===M){B.splice($,1);break}}return delete this._objects[M],delete this._idToCell[M],M}remove(M){const[P,D,B,$]=this._getBounds(M),H=[this._root];let X,lt;const dt=[];for(;X=H.pop();)if(Hs(P,D,B,$,X.minX,X.minY,X.maxX,X.maxY))if(X.leaf){const ct=X.objects||[];for(let pt=0,yt=ct.length;pt<yt;pt++)if(ct[pt]===M){ct.splice(pt,1),yt===1&&dt.push(X);break}}else H.push.apply(H,X.children);if(delete this._idToCell[M],delete this._objects[M],this._size--,dt.length)for(;lt=dt.pop();){let ct=lt.parent,pt=!0;for(;ct&&pt;){if(!ct.leaf){for(let yt=0;yt<4;yt++)if(X=ct.children[yt],!X.leaf||X.objects&&X.objects.length!==0){pt=!1;break}pt&&(ct.leaf=!0,ct.children=[],ct.objects=[])}ct=ct.parent}}return M}splitNode(M){const{minX:P,minY:D,maxX:B,maxY:$}=M,H=(P+B)/2,X=(D+$)/2,lt=M.level+1,dt=this._idToCell,ct=this._maxLevel,pt=[Ls(P,D,H,X,M,lt),Ls(P,X,H,$,M,lt),Ls(H,X,B,$,M,lt),Ls(H,D,B,X,M,lt)];if(M.objects!==null){const yt=M.objects,Nt=this._getBounds;for(let Tt=0,At=yt.length;Tt<At;Tt++){const Bt=yt[Tt],he=Nt(Bt);let xe=dt[Bt];for(let be=0;be<4;be++){const le=pt[be],{minX:_e,minY:Te,maxX:Ve,maxY:ke}=le;Hs(he[0],he[1],he[2],he[3],_e,Te,Ve,ke)&&(le.objects&&le.objects.push(Bt),(le.level>=ct||Math.abs(Ve-_e)<=Math.abs(he[2]-he[0])||Math.abs(ke-Te)<=Math.abs(he[3]-he[1]))&&(le.final=!0),xe?xe.push(le):xe=[le])}xe&&xe.splice(xe.indexOf(M),1)}}M.children=pt,M.objects=null,M.leaf=!1}point(M,P,D){let B=[];const $=[this._root];let H,X,lt;const dt=this._getBounds;for(;H=$.pop();)if(M>=H.minX&&M<=H.maxX&&P>=H.minY&&P<=H.maxY){if(H.leaf){D&&H.objects&&(B=H.objects);const ct=H.objects||[];for(let pt=0,yt=ct.length;pt<yt;pt++)lt=ct[pt],X=dt(lt),M>=X[0]&&M<=X[2]&&P>=X[1]&&P<=X[3]&&B.push(lt);break}$.push.apply($,H.children)}return B.length?B:null}neigbours(M,P){let D,B=[];const $=[this._root];for(;D=$.pop();)if(M>=D.minX&&M<=D.maxX&&P>=D.minY&&P<=D.maxY){if(D.leaf){B=D.objects;break}$.push.apply($,D.children)}return B}query(M,P,D,B){const $=[],H=[this._root];let X,lt,dt;const ct=this._getBounds,pt={},yt=this._intersects;let Nt;for(;X=H.pop();)if(Hs(M,P,D,B,X.minX,X.minY,X.maxX,X.maxY))if(X.leaf){const Tt=X.objects||[];for(let At=0,Bt=Tt.length;At<Bt;At++)dt=Tt[At],pt[dt]||(lt=ct(dt),Hs(M,P,D,B,lt[0],lt[1],lt[2],lt[3])&&(yt&&!yt(dt,M,P,D,B)||$.push(dt)),pt[dt]=!0)}else Nt=on(M,P,D,B,X.minX,X.minY,X.maxX,X.maxY),H.push(X.children[(Nt+3)%4],X.children[(Nt+2)%4],X.children[(Nt+1)%4],X.children[Nt]);return $}traverse(M,P,D,B,$){const H=[],X=[this._root];let lt,dt,ct;const pt=this._getBounds,yt={},Nt=this._intersects;let Tt;for(;lt=X.pop();)if(Hs(M,P,D,B,lt.minX,lt.minY,lt.maxX,lt.maxY))if(lt.leaf){const At=lt.objects||[];for(let Bt=0,he=At.length;Bt<he;Bt++)if(ct=At[Bt],!yt[ct]){if(dt=pt(ct),Hs(M,P,D,B,dt[0],dt[1],dt[2],dt[3])&&(!Nt||Nt(ct,M,P,D,B))&&(H.push(ct),$(ct)))return H;yt[ct]=!0}}else Tt=on(M,P,D,B,lt.minX,lt.minY,lt.maxX,lt.maxY),X.push(lt.children[(Tt+3)%4],lt.children[(Tt+2)%4],lt.children[(Tt+1)%4],lt.children[Tt]);return H}getOverlaps(){const M=[this._root];let P,D,B;const $=[],H=this._getBounds,X={};for(;P=M.pop();)if(P.leaf){const lt=P.objects||[],dt=lt.length;for(let ct=0;ct<dt;ct++)for(let pt=0;pt<dt;pt++)if(D=lt[ct],B=lt[pt],ct!==pt&&!X[D+":"+B]&&!X[B+":"+D]){X[D+":"+B]=!0;const yt=H(D),Nt=H(B);Hs(yt[0],yt[1],yt[2],yt[3],Nt[0],Nt[1],Nt[2],Nt[3])&&$.push(D,B)}}else M.push.apply(M,P.children);return $}cover(M,P,D,B){if(this._root===null)return this._root=Ls(M,P,D,B,null,0),this;let $=this._root;if(!hn(M,P,D,B,$.minX,$.minY,$.maxX,$.maxY)){let H=this._rootLevel;for(;!hn(M,P,D,B,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){$=this._root;const{minX:ct,minY:pt,maxX:yt,maxY:Nt}=$;let Tt=ct,At=pt,Bt=yt,he=Nt;const xe=Math.abs(yt-ct),be=Math.abs(Nt-pt);if(be===0&&xe===0)break;const le=Math.max(xe,be);M<ct?(Tt-=le,P<pt?At-=le:he+=le):(Bt+=le,P<pt?At-=le:he+=le);const _e=Ls(Tt,At,Bt,he,null,--H);this.splitNode(_e),_e.children[on(ct,pt,yt,Nt,Tt,At,Bt,he)]=$,this._root=$.parent=_e}const X=[this._root];let lt,dt;for(this._root.level=this._rootLevel;lt=X.shift();)if(dt=lt,!dt.leaf)for(let ct=0;ct<4;ct++){const pt=dt.children[ct];pt.level=dt.level+1,X.push(pt)}}return this}getAll(){return Object.keys(this._objects).map((M=>Number(M)))}forEach(M,P){const D=[this._root];let B;for(;B=D.pop();)if(B.leaf&&B.objects)for(let $=0,H=B.objects.length;$<H;$++)M.call(P,B.objects[$]);else D.push.apply(D,B.children);return this}getLeafs(){const M=[this._root],P=[];let D;for(;D=M.pop();)D.leaf?P.push(D):M.push.apply(M,D.children);return P}traverseFromRoot(M,P){const D=[this._root];let B;for(;B=D.pop();)M.call(P,B,B.objects)||B.leaf||D.push.apply(D,B.children);return this}update(M,P,D,B,$){return this.remove(M),this.insert(M,P,D,B,$),this}getNodeBounds(M){return En(M)}}Ps.flatAccessor=(gt,M)=>P=>{const D=M*P;return gt.slice(D,D+M)},Ps.inside=hn,Ps.intersects=function(M,P,D,B,$,H,X,lt){return M>$&&M<X&&P>H&&P<lt||D>$&&D<X&&B>H&&B<lt},Ps.overlaps=Hs,Ps.getNodeBBox=En,i.GeometryTypes=h,i.HGrid=class extends Fs{constructor(M,P,D=16,B=65536,$=Int32Array,H=16){super(),this._occupied=0,this._idToCode=new Oe,this._codeCache=[0,0,0],this.code=(X,lt,dt)=>dt|x(X,lt)<<this._bitsForZoom,this.decode=(X,lt)=>(x.reverse(X>>this._bitsForZoom,lt),lt[2]=X&this._zoomMask,lt),this._intersects=M,this._getBounds=P,this._cells=new mt($),this._offset=B,this._maxLevels=H,this._mortonMax=(1<<this._maxLevels)-1,this._bitsForZoom=Math.log2(this._maxLevels),this._zoomMask=(1<<this._bitsForZoom)-1,this._objectsAtLevel=new Array(this._maxLevels).fill(0),this._min=-B,this._max=B,this._resolution=this._mortonMax/(this._max-this._min),this._minCellSize=D*this._resolution,this._bounds=new Array(4*this._maxLevels);for(let X=0;X<this._maxLevels;X++)this._bounds[4*X]=1/0,this._bounds[4*X+1]=1/0,this._bounds[4*X+2]=-1/0,this._bounds[4*X+3]=-1/0}setMinCellSize(M){return this._minCellSize=M,this}setOffset(M){return this._offset=M,this._min=-M,this._max=M,this._resolution=this._mortonMax/(this._max-this._min),this}insert(M,P,D,B,$){P===void 0&&([P,D,B,$]=this._getBounds(M));const H=Math.max(B-P,$-D);let X,lt=this._minCellSize;for(X=0;lt<H&&X<this._maxLevels-1;X++)lt*=2;const dt=this._resolution,ct=this._min,pt=dt*(.5*(B+P)-ct)/lt|0,yt=dt*(.5*($+D)-ct)/lt|0,Nt=this.code(pt,yt,X);this._cells.has(Nt)||this._cells.addEntry(Nt),this._cells.addTo(Nt,M),this._objectsAtLevel[X]++,this._occupied|=1<<X;const Tt=4*X,At=this._bounds;return pt<At[Tt]&&(At[Tt]=pt),yt<At[Tt+1]&&(At[Tt+1]=yt),pt>At[Tt+2]&&(At[Tt+2]=pt),yt>At[Tt+3]&&(At[Tt+3]=yt),this._idToCode.set(M,Nt),Nt}has(M){return this._idToCode.has(M)}update(M,P,D,B,$){return this.remove(M),this.insert(M,P,D,B,$)}remove(M){const P=this._idToCode.get(M);this.decode(P,this._codeCache);const D=this._codeCache[2];return--this._objectsAtLevel[D]==0&&(this._occupied&=~(1<<D),this._bounds[4*D]=1/0,this._bounds[4*D+1]=1/0,this._bounds[4*D+2]=-1/0,this._bounds[4*D+3]=-1/0),this._cells.removeFrom(P,M),this._idToCode.delete(M),this}query(M,P,D,B){const $=this._cells,H=this._bounds,X=this._intersects,lt=this._min,dt=this._resolution;let ct=this._minCellSize,pt=this._occupied;const yt=[];for(let Nt=0;Nt<this._maxLevels&&pt!==0;ct*=2,pt>>=1,Nt++){if((1&pt)==0)continue;const Tt=1/ct,At=4*Nt,Bt=Math.max(H[At],dt*(M-lt)*Tt-1>>0),he=Math.max(H[At+1],dt*(P-lt)*Tt-1>>0),xe=Math.min(H[At+2],dt*(D-lt)*Tt+1>>0),be=Math.min(H[At+3],dt*(B-lt)*Tt+1>>0);for(let le=Bt;le<=xe;le++)for(let _e=he;_e<=be;_e++){const Te=this.code(le,_e,Nt);if(!$.has(Te))continue;const Ve=$.getItems(Te);if(Ve!==void 0)for(let ke=0;ke<Ve.length;ke++){const je=Ve[ke];X(je,M,P,D,B)&&yt.push(je)}}}return yt}traverse(M,P,D,B,$){const H=this._cells,X=this._bounds,lt=this._intersects,dt=this._min,ct=this._resolution;let pt=this._minCellSize,yt=this._occupied;const Nt=[];for(let Tt=0;Tt<this._maxLevels&&yt!==0;pt*=2,yt>>=1,Tt++){if((1&yt)==0)continue;const At=1/pt,Bt=4*Tt,he=Math.max(X[Bt],ct*(M-dt)*At-1>>0),xe=Math.max(X[Bt+1],ct*(P-dt)*At-1>>0),be=Math.min(X[Bt+2],ct*(D-dt)*At+1>>0),le=Math.min(X[Bt+3],ct*(B-dt)*At+1>>0);for(let _e=he;_e<=be;_e++)for(let Te=xe;Te<=le;Te++){const Ve=this.code(_e,Te,Tt),ke=H.getItems(Ve);if(ke!==void 0)for(let je=0;je<ke.length;je++){const Pe=ke[je];if(lt(Pe,M,P,D,B)&&(Nt.push(Pe),$(Pe)))return Nt}}}return Nt}collisions(M,P=this._getBounds){if(typeof P!="function")throw new Error("getBounds function is required to get the object bounds");const D=Array.from(this._idToCode.keys()),B=this._min,$=this._resolution,H=this._cells,X=new Oe,lt=[];for(let dt=0;dt<D.length;dt++){let ct=0,pt=this._minCellSize,yt=this._occupied;const Nt=D[dt];let[Tt,At,Bt,he]=P(Nt);const xe=Math.max(Bt-Tt,he-At);for(ct=0;pt<xe;ct++)pt*=2,yt>>=1;Tt=$*(Tt-B),At=$*(At-B),Bt=$*(Bt-B),he=$*(he-B);for(let be=ct;be<this._maxLevels&&yt!==0;pt*=2,yt>>=1,be++){if((1&yt)==0)continue;const le=1/pt,_e=At*le-1>>0,Te=Bt*le+1>>0,Ve=he*le+1>>0;for(let ke=Tt*le-1>>0;ke<=Te;ke++)for(let je=_e;je<=Ve;je++){const Pe=this.code(ke,je,be);if(X.get(Pe)===dt)continue;X.set(Pe,dt);const Be=H.getItems(Pe);if(Be!==void 0)for(let Ue=0;Ue<Be.length;Ue++){const es=Be[Ue],[rs,cs,Y,et]=this._getBounds(es);es!==Nt&&M(Nt,rs,cs,Y,et)&&lt.push(Nt,es)}}}}return(function(ct){const pt=new Cs,yt=[];for(let Nt=0;Nt<ct.length;Nt+=2){const Tt=ct[Nt],At=ct[Nt+1],Bt=Tt<At?Tt*At+(At-Tt-1)*(At-Tt-1)/4:Tt*At+(Tt-At-1)*(Tt-At-1)/4;pt.has(Bt)||(pt.add(Bt),yt.push(Tt,At))}return yt})(lt)}clear(){this._occupied=0,this._cells.clear(),this._idToCode.clear(),this._objectsAtLevel=new Array(this._maxLevels).fill(0),this._bounds=new Array(4*this._maxLevels);for(let M=0;M<this._maxLevels;M++)this._bounds[4*M]=1/0,this._bounds[4*M+1]=1/0,this._bounds[4*M+2]=-1/0,this._bounds[4*M+3]=-1/0;return this}keyToBBox(M){const[P,D,B]=this.decode(M,[0,0,0]),$=this._minCellSize*(1<<B),H=this._min,X=this._resolution;return[P*$/X+H,D*$/X+H,(P+1)*$/X+H,(D+1)*$/X+H]}keys(){return this._cells.keys()}get averageCellOccupancy(){return this._cells.averageSize}get size(){return this._idToCode.size}getBoxes(){return Array.from(this._idToCode.keys()).map((M=>this._getBounds(M)))}},i.Quadtree=Ps,i.SGrid=class extends Fs{constructor(M,P,D){super();const B=this.cells=[];if(M instanceof ArrayBuffer){this.arrayBuffer=M;const H=new Int32Array(this.arrayBuffer);M=H[0],P=H[1],D=H[2],this.d=P+2*D;for(let dt=0;dt<this.d*this.d;dt++){const ct=H[3+dt],pt=H[3+dt+1];B.push(ct===pt?null:H.subarray(ct,pt))}const X=H[3+B.length],lt=H[3+B.length+1];this.keys=H.subarray(X,lt),this.bboxes=H.subarray(lt),this.insert=this._insertReadonly}else{this.d=P+2*D;for(let H=0;H<this.d*this.d;H++)B.push([]);this.keys=[],this.bboxes=[]}this.n=P,this.extent=M,this.padding=D,this.scale=P/M,this.uid=0;const $=D/P*M;this.min=-$,this.max=M+$}insert(M,P,D,B,$){return P===void 0&&([P,D,B,$]=this._getBounds(M)),this._forEachCell(P,D,B,$,this._insertCell,this.uid++),this.keys.push(M),this.bboxes.push(P),this.bboxes.push(D),this.bboxes.push(B),this.bboxes.push($),this}_insertReadonly(M,P,D,B,$){throw"Cannot insert into a GridIndex created from an ArrayBuffer."}_insertCell(M,P,D,B,$,H){this.cells[$].push(H)}query(M,P,D,B,$){const H=this.min,X=this.max;if(M<=H&&P<=H&&X<=D&&X<=B&&!$)return Array.prototype.slice.call(this.keys);{const lt=[],dt={};return this._forEachCell(M,P,D,B,this._queryCell,lt,dt,$),lt}}traverse(M,P,D,B,$,H){const X=this.min,lt=this.max;if(M<=X&&P<=X&&lt<=D&&lt<=B&&!H)return Array.prototype.slice.call(this.keys);{const dt=[],ct={};return this._forEachCell(M,P,D,B,this._queryCellEarlyStop,dt,ct,$,H),dt}}_queryCell(M,P,D,B,$,H,X,lt){const dt=this.cells[$];if(dt!==null){const ct=this.keys,pt=this.bboxes,yt=this._intersects;for(let Nt=0;Nt<dt.length;Nt++){const Tt=dt[Nt];if(X[Tt]===void 0){const At=4*Tt;!(lt?lt(pt[At+0],pt[At+1],pt[At+2],pt[At+3]):M<=pt[At+2]&&P<=pt[At+3]&&D>=pt[At+0]&&B>=pt[At+1])||yt&&!yt(Tt,M,P,D,B)?yt&&!yt(Tt,M,P,D,B)||(X[Tt]=!1):(X[Tt]=!0,H.push(ct[Tt]))}}}}_queryCellEarlyStop(M,P,D,B,$,H,X,lt,dt){const ct=this.cells[$];if(ct!==null){const pt=this.keys,yt=this.bboxes,Nt=this._intersects;for(let Tt=0;Tt<ct.length;Tt++){const At=ct[Tt];if(X[At]===void 0){const Bt=4*At;if(!(dt?dt(yt[Bt+0],yt[Bt+1],yt[Bt+2],yt[Bt+3]):M<=yt[Bt+2]&&P<=yt[Bt+3]&&D>=yt[Bt+0]&&B>=yt[Bt+1])||Nt&&!Nt(At,M,P,D,B))Nt&&!Nt(At,M,P,D,B)||(X[At]=!1);else if(X[At]=!0,H.push(pt[At]),lt(At))return!0}}}}remove(M){throw new Error("Method not implemented yet.")}update(M,P,D,B,$){throw new Error("Method not implemented yet.")}clear(){const M=this.cells=[];if(this.arrayBuffer){for(let P=0;P<this.d*this.d;P++)M.push(null);this.keys=new Int32Array([]),this.bboxes=new Int32Array([])}else{for(let P=0;P<this.d*this.d;P++)M.push([]);this.keys=[],this.bboxes=[]}return this.uid=0,this}_forEachCell(M,P,D,B,$,H,X,lt,dt){const ct=this._convertToCellCoord(M),pt=this._convertToCellCoord(P),yt=this._convertToCellCoord(D),Nt=this._convertToCellCoord(B);for(let Tt=ct;Tt<=yt;Tt++)for(let At=pt;At<=Nt;At++){const Bt=this.d*At+Tt;if((!dt||dt(this._convertFromCellCoord(Tt),this._convertFromCellCoord(At),this._convertFromCellCoord(Tt+1),this._convertFromCellCoord(At+1)))&&$.call(this,M,P,D,B,Bt,H,X,lt,dt))return}}_convertFromCellCoord(M){return(M-this.padding)/this.scale}_convertToCellCoord(M){return Math.max(0,Math.min(this.d-1,Math.floor(M*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const M=this.cells,P=3+this.cells.length+1+1;let D=0;for(let H=0;H<this.cells.length;H++)D+=this.cells[H].length;const B=new Int32Array(P+D+this.keys.length+this.bboxes.length);B[0]=this.extent,B[1]=this.n,B[2]=this.padding;let $=P;for(let H=0;H<M.length;H++){const X=M[H];B[3+H]=$,B.set(X,$),$+=X.length}return B[3+M.length]=$,B.set(this.keys,$),$+=this.keys.length,B[3+M.length+1]=$,B.set(this.bboxes,$),$+=this.bboxes.length,B.buffer}},i.UBTree=Fe,i.morton=x,Object.defineProperty(i,"__esModule",{value:!0})},typeof t=="object"&&e!==void 0?n(t):typeof define=="function"&&define.amd?define(["exports"],n):n((s=typeof globalThis<"u"?globalThis:s||self).SpatialIndex={})}}),Rs=class{constructor(t){this._ogma=t}};function ud(t,e){for(let s=1,n=t.length;s<n;s++){const i=t[s];let r=s;for(;r>0&&e.get(t[r-1])>e.get(i);)t[r]=t[r-1],--r;t[r]=i}return t}function _k(t,e){for(let s=1,n=t.length;s<n;s++){const i=t[s];let r=s;for(;r>0&&e.get(t[r-1])<e.get(i);)t[r]=t[r-1],--r;t[r]=i}return t}function Rn(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function F_(t){return Array.isArray(t)?t:[t]}function Pw(t){const e=[];for(let s=0;s<t.length;++s){const n=t[s];if(Array.isArray(n))for(let i=0;i<n.length;++i)e.push(n[i]);else e.push(n)}return e}function yk(...t){if(t.length===0)return[];const e=t[0].constructor;let s=0;for(const r of t)s+=r.length;const n=new e(s);let i=0;for(const r of t){for(let o=0;o<r.length;o++)n[i+o]=r[o];i+=r.length}return n}function xk(t,e){const s=t.indexOf(e);return s!==-1&&(t.splice(s,1),!0)}function zw(t,e){let s,n,i=0,r=t.length-1;for(;i<=r;)if(s=(i+r)/2|0,n=t[s],n<e)i=s+1;else{if(!(n>e))return s;r=s-1}return-1}var Gd=(t,e)=>{const s=new Array(t.length);for(let n=0;n<t.length;n++)s[n]=e[t[n]];return s};function vk(t){return typeof t=="number"&&t%1==0}function P_(t){return Array.isArray(t)?t.join("."):t}function Da(t){if(!t)return[];if(typeof t=="string")return t.split(".");if(Array.isArray(t)){for(let e=0;e<t.length;++e)if(typeof t[e]!="string")throw new TypeError(`${t[e]} is not a string`);return t.slice()}throw new TypeError(`invalid property path "${t}": expected string or array of strings`)}function Vd(t,e,s){let n,i,r;if(e===0)return function(){t.apply(s,arguments)};const o=function(){n=!1,i&&(r.apply(s,i),i=null)};return r=function(){let a;return n?i=arguments:(a=t.apply(s,arguments),setTimeout(o,e),n=!0),a},r}function Dw(t,e){let s,n=!1;return function i(){s?n=!0:s=setTimeout((()=>{if(s=null,n)return i(),void(n=!1);n=!1,t()}),e)}}function bk(t,e,s){let n,i,r,o,a;const l=e===0||e===void 0?100:e;function u(){const g=Date.now()-o;g<l&&g>=0?n=setTimeout(u,l-g):(n=null,s||(a=t.apply(r,i),r=i=null))}const h=function(){r=this,i=arguments,o=Date.now();const g=s&&!n;return n||(n=setTimeout(u,e)),g&&(a=t.apply(r,i),r=i=null),a};return h.clear=function(){n&&(clearTimeout(n),n=null)},h.flush=function(){n&&(a=t.apply(r,i),r=i=null,clearTimeout(n),n=null)},h}function Ow(t,e,s,n,i){s(t[e],e,t,n,i).then((r=>{e===t.length-1?n(r):Ow(t,e+1,s,n,i)})).catch(i)}function Ek(t,e){return new Promise(((s,n)=>Ow(t,0,e,s,n)))}function Cf(){return new Uint8Array(new Uint32Array([305419896]).buffer)[0]===120}function Bw(t){return t.reduce(((e,s)=>e.then(s)),Promise.resolve())}function z_(t,e,s,n,i,r,o,a){return t+i+256*(e+r)+65536*(s+o)+16777216*(n+a)}function Sk(t,e){return t<e?t*e+Math.pow(e-t-1,2)/4:t*e+Math.pow(t-e-1,2)/4}function Oa(t){return!(t===null||typeof t!="object"||Rn(t)||t instanceof RegExp||typeof HTMLElement<"u"&&t instanceof HTMLElement)}function Cd(t){const e=Object.keys(t),s=new Array(e.length);for(let n=0;n<e.length;++n)s[n]=t[e[n]];return s}function Cr(t,e,s){if(Array.isArray(t))return t.forEach(e,s);if(!Oa(t))throw new Error("forEach: invalid argument "+JSON.stringify(t));const n=Object.keys(t);if(s!==void 0)for(let i=0;i<n.length;++i){const r=n[i];e.call(s,t[r],r)}else for(let i=0;i<n.length;++i){const r=n[i];e(t[r],r)}}function Ws(t){if(Array.isArray(t)){const n=new Array(t.length);for(let i=0;i<t.length;++i)n[i]=Ws(t[i]);return n}if(!dn(t))return t;const e={},s=Object.keys(t);for(const n of s)e[n]=Ws(t[n]);return e}function Ak(t,e){e.forEach((s=>{t.indexOf(s)===-1&&t.push(s)}))}function Kr(t,e,s){const n=typeof e=="string"?e.split("."):e;for(let i=0;i<n.length-1;++i){const r=n[i];let o=t[r];o||(o={},t[r]=o),t=o}t[n[n.length-1]]=s}function qs(t,e){const s=Da(e);if(!s.length)return t;if(t){for(let n=0;n<s.length-1;++n){const i=t[s[n]];if(!i)return;t=i}return t[s[s.length-1]]}}function jd(t,e,s="."){e||(e=r=>!Oa(r));const n={},i=Object.keys(t);for(let r=0;r<i.length;++r){const o=i[r],a=t[o];if(a instanceof Date)n[o]=a;else if(e(a))n[o]=a;else{const l=jd(a,e),u=Object.keys(l);for(let h=0;h<u.length;h++){const g=u[h];n[`${o}${s}${g}`]=l[g]}}}return n}function D_(t){const e={},s=Object.keys(t);for(let n=0;n<s.length;++n){const i=s[n];Kr(e,i,t[i])}return e}function Ba(t,e,s=[]){const n=Object.keys(t);for(let i=0;i<n.length;++i){const r=n[i],o=t[r],a=e?e+r:r;dn(o)?Ba(o,a+".",s):s.push(a)}return s}var Uw=Object.prototype.hasOwnProperty;function Gw(t,e){const s=[t];let n;for(;s.length>0;)if(n=s.pop(),n)if(dn(n))for(const i in n)Uw.call(n,i)&&s.push(n[i]);else e(n)}function wk(t){const e={};return Gw(t,(s=>e[s.getName()]=s)),e}function Lf(t,e=[]){if(dn(t)){const s=Object.keys(t);for(const n of s)Lf(t[n],e)}else e.push(t);return e}function Nf(t){for(const e in t)typeof t[e]=="function"&&delete t[e];return t}function Ci(t,e){if(t===void 0)return Ws(e);if(!Oa(t))return t;const s={},n=Object.keys(e);for(const i of n){const r=e[i],o=t[i];Oa(r)?s[i]=Ci(o,r):s[i]=o===void 0?Ws(r):o}return s}function dn(t){return t&&(t.constructor===Object||!t.constructor)}function Hg(t,e){if(!dn(e)||!dn(t))return e;const s=Object.assign({},t),n=Object.keys(e);for(const i of n)s[i]=Hg(s[i],e[i]);return s}function O_(t,e){return e==null?t:e.reduce(((s,n)=>(s[n]=t[n],s)),{})}var Ol=(...t)=>{const e={};for(let s=0;s<t.length;s++){const n=t[s];for(const i in n)Uw.call(n,i)&&(Array.isArray(e[i])&&Array.isArray(n[i])?e[i]=Array.from(new Set(e[i].concat(n[i]))):dn(e[i])&&dn(n[i])?e[i]=Ol(e[i],n[i]):e[i]=n[i])}return e},ch={};/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Mf(t){if(t!==ch)throw new Error("Bad secret")}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Tk(t,e){if(!Lk(t)||e+1!==t.length)throw new TypeError(`
    ############################## ERROR ##############################

    It looks like you are trying to call a template tag function (fn\`...\`)
    using the normal function syntax (fn(...)), which is not supported.

    The functions in the safevalues library are not designed to be called
    like normal functions, and doing so invalidates the security guarantees
    that safevalues provides.

    If you are stuck and not sure how to proceed, please reach out to us
    instead through:
     - https://github.com/google/safevalues/issues

    ############################## ERROR ##############################`)}function dd(t){return Object.isFrozen(t)&&Object.isFrozen(t.raw)}function Cc(t){return t.toString().indexOf("`")===-1}var zb=Cc((t=>t``))||Cc((t=>t`\0`))||Cc((t=>t`\n`))||Cc((t=>t`\u0000`)),Ck=dd``&&dd`\0`&&dd`\n`&&dd`\u0000`;function Lk(t){return!(!Array.isArray(t)||!Array.isArray(t.raw))&&t.length===t.raw.length&&!(!zb&&t===t.raw)&&!!(zb&&!Ck||dd(t))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Np,Nk="google#safe",Mk=Nk,Ik=globalThis.trustedTypes,Db=Ik;function kk(){let t=null;if(!Db)return t;try{const e=s=>s;t=Db.createPolicy(Mk,{createHTML:e,createScript:e,createScriptURL:e})}catch(e){throw e}return t}function cx(){return Np===void 0&&(Np=kk()),Np}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Lc(t){return{valueOf:t}.valueOf()}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Vw=class{constructor(t,e){Mf(t),this.privateDoNotAccessOrElseWrappedHtml=e}toString(){return this.privateDoNotAccessOrElseWrappedHtml+""}},Rk=Vw;function Fk(t){return new Rk(ch,t)}function jw(t){const e=t,s=cx();return Fk(s?s.createHTML(e):e)}function Pk(t){return t instanceof Vw}function gx(t){if(Pk(t))return t.privateDoNotAccessOrElseWrappedHtml;{let e="";throw e="Unexpected type when unwrapping SafeHtml",new Error(e)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Hw=class{constructor(t,e){Mf(t),this.privateDoNotAccessOrElseWrappedResourceUrl=e}toString(){return this.privateDoNotAccessOrElseWrappedResourceUrl+""}},zk=Hw;function Dk(t){return new zk(ch,t)}function Ok(t){const e=t,s=cx();return Dk(s?s.createScriptURL(e):e)}function Bk(t){return t instanceof Hw}function gu(t){if(Bk(t))return t.privateDoNotAccessOrElseWrappedResourceUrl;{let e="";throw e="Unexpected type when unwrapping TrustedResourceUrl",new Error(e)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var $g,Ob,$w=class{constructor(t,e){Mf(t),this.privateDoNotAccessOrElseWrappedScript=e}toString(){return this.privateDoNotAccessOrElseWrappedScript+""}},Uk=$w;function Gk(t){return new Uk(ch,t)}function fx(t){const e=t,s=cx();return Gk(s?s.createScript(e):e)}function Vk(t){return t instanceof $w}function qw(t){if(Vk(t))return t.privateDoNotAccessOrElseWrappedScript;{let e="";throw e="Unexpected type when unwrapping SafeScript",new Error(e)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jk(t,e){e.appendChild(t);let s=new XMLSerializer().serializeToString(e);return s=s.slice(s.indexOf(">")+1,s.lastIndexOf("</")),jw(s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Bb(t){try{return new URL(t,window.document.baseURI)}catch{return new URL("about:invalid")}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Hk(t){let e;try{e=new URL(t)}catch{return"https:"}return e.protocol}(function(t){t[t.STYLE_ELEMENT=0]="STYLE_ELEMENT",t[t.STYLE_ATTRIBUTE=1]="STYLE_ATTRIBUTE",t[t.HTML_ATTRIBUTE=2]="HTML_ATTRIBUTE"})($g||($g={})),(function(t){t[t.AT_KEYWORD=0]="AT_KEYWORD",t[t.CDC=1]="CDC",t[t.CDO=2]="CDO",t[t.CLOSE_CURLY=3]="CLOSE_CURLY",t[t.CLOSE_PAREN=4]="CLOSE_PAREN",t[t.CLOSE_SQUARE=5]="CLOSE_SQUARE",t[t.COLON=6]="COLON",t[t.COMMA=7]="COMMA",t[t.DELIM=8]="DELIM",t[t.DIMENSION=9]="DIMENSION",t[t.EOF=10]="EOF",t[t.FUNCTION=11]="FUNCTION",t[t.HASH=12]="HASH",t[t.IDENT=13]="IDENT",t[t.NUMBER=14]="NUMBER",t[t.OPEN_CURLY=15]="OPEN_CURLY",t[t.OPEN_PAREN=16]="OPEN_PAREN",t[t.OPEN_SQUARE=17]="OPEN_SQUARE",t[t.PERCENTAGE=18]="PERCENTAGE",t[t.SEMICOLON=19]="SEMICOLON",t[t.STRING=20]="STRING",t[t.WHITESPACE=21]="WHITESPACE"})(Ob||(Ob={}));var $k=["data:","http:","https:","mailto:","ftp:"],qk=/^\s*(?!javascript:)(?:[\w+.-]+:|[^:/?#]*(?:[/?#]|$))/i;function Yk(t){const e=!qk.test(t);return e&&console.error(`A URL with content '${t}' was sanitized away.`),e}function Wk(t){if(!Yk(t))return t}function gh(t){return Wk(t)}function Xk(t){const e=Hk(t);return e!==void 0&&$k.indexOf(e.toLowerCase())!==-1?t:"about:invalid#zClosurez"}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Zk="display:inline-block;clip-path:inset(0);overflow:hidden;vertical-align:top;text-decoration:inherit",Kk=`:host{${Zk}}`;/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qk(t,e){return t.createContextualFragment(gx(e))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Jk(t,e){if(e.defaultView)throw new Error("createInertFragment called with non-inert document");const s=e.createRange();return s.selectNode(e.body),Qk(s,jw(t))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ub(t){const e=t.nodeName;return typeof e=="string"?e:"FORM"}function Gb(t){return t.nodeType===3}function Vb(t){const e=t.nodeType;return e===1||typeof e!="number"}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ts,br=class{constructor(t,e,s,n,i){this.allowedElements=t,this.elementPolicies=e,this.allowedGlobalAttributes=s,this.globalAttributePolicies=n,this.globallyAllowedAttributePrefixes=i}isAllowedElement(t){return t!=="FORM"&&(this.allowedElements.has(t)||this.elementPolicies.has(t))}getAttributePolicy(t,e){const s=this.elementPolicies.get(e);return s!=null&&s.has(t)?s.get(t):this.allowedGlobalAttributes.has(t)?{policyAction:Ts.KEEP}:this.globalAttributePolicies.get(t)||(this.globallyAllowedAttributePrefixes&&[...this.globallyAllowedAttributePrefixes].some((i=>t.indexOf(i)===0))?{policyAction:Ts.KEEP}:{policyAction:Ts.DROP})}};(function(t){t[t.DROP=0]="DROP",t[t.KEEP=1]="KEEP",t[t.KEEP_AND_SANITIZE_URL=2]="KEEP_AND_SANITIZE_URL",t[t.KEEP_AND_NORMALIZE=3]="KEEP_AND_NORMALIZE",t[t.KEEP_AND_SANITIZE_STYLE=4]="KEEP_AND_SANITIZE_STYLE",t[t.KEEP_AND_USE_RESOURCE_URL_POLICY=5]="KEEP_AND_USE_RESOURCE_URL_POLICY",t[t.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET=6]="KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET"})(Ts||(Ts={}));var tR=new Set(["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"]);function eR(t){return!tR.has(t.toUpperCase())&&/^[a-z][-_.a-z0-9]*-[-_.a-z0-9]*$/i.test(t)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var sR=["ARTICLE","SECTION","NAV","ASIDE","H1","H2","H3","H4","H5","H6","HEADER","FOOTER","ADDRESS","P","HR","PRE","BLOCKQUOTE","OL","UL","LH","LI","DL","DT","DD","FIGURE","FIGCAPTION","MAIN","DIV","EM","STRONG","SMALL","S","CITE","Q","DFN","ABBR","RUBY","RB","RT","RTC","RP","DATA","TIME","CODE","VAR","SAMP","KBD","SUB","SUP","I","B","U","MARK","BDI","BDO","SPAN","BR","WBR","NOBR","INS","DEL","PICTURE","PARAM","TRACK","MAP","TABLE","CAPTION","COLGROUP","COL","TBODY","THEAD","TFOOT","TR","TD","TH","SELECT","DATALIST","OPTGROUP","OPTION","OUTPUT","PROGRESS","METER","FIELDSET","LEGEND","DETAILS","SUMMARY","MENU","DIALOG","SLOT","CANVAS","FONT","CENTER","ACRONYM","BASEFONT","BIG","DIR","HGROUP","STRIKE","TT"],nR=[["A",new Map([["href",{policyAction:Ts.KEEP_AND_SANITIZE_URL}]])],["AREA",new Map([["href",{policyAction:Ts.KEEP_AND_SANITIZE_URL}]])],["LINK",new Map([["href",{policyAction:Ts.KEEP_AND_USE_RESOURCE_URL_POLICY,conditions:new Map([["rel",new Set(["alternate","author","bookmark","canonical","cite","help","icon","license","next","prefetch","dns-prefetch","prerender","preconnect","preload","prev","search","subresource"])]])}]])],["SOURCE",new Map([["src",{policyAction:Ts.KEEP_AND_USE_RESOURCE_URL_POLICY}],["srcset",{policyAction:Ts.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET}]])],["IMG",new Map([["src",{policyAction:Ts.KEEP_AND_USE_RESOURCE_URL_POLICY}],["srcset",{policyAction:Ts.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET}]])],["VIDEO",new Map([["src",{policyAction:Ts.KEEP_AND_USE_RESOURCE_URL_POLICY}]])],["AUDIO",new Map([["src",{policyAction:Ts.KEEP_AND_USE_RESOURCE_URL_POLICY}]])]],iR=["title","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-current","aria-disabled","aria-dropeffect","aria-expanded","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","alt","align","autocapitalize","autocomplete","autocorrect","autofocus","autoplay","bgcolor","border","cellpadding","cellspacing","checked","cite","color","cols","colspan","controls","controlslist","datetime","disabled","download","draggable","enctype","face","formenctype","frameborder","height","hreflang","hidden","ismap","label","lang","loop","max","maxlength","media","minlength","min","multiple","muted","nonce","open","placeholder","poster","preload","rel","required","reversed","role","rows","rowspan","selected","shape","size","sizes","slot","span","spellcheck","start","step","summary","translate","type","valign","value","width","wrap","itemscope","itemtype","itemid","itemprop","itemref"],rR=[["dir",{policyAction:Ts.KEEP_AND_NORMALIZE,conditions:Lc((()=>new Map([["dir",new Set(["auto","ltr","rtl"])]])))}],["async",{policyAction:Ts.KEEP_AND_NORMALIZE,conditions:Lc((()=>new Map([["async",new Set(["async"])]])))}],["loading",{policyAction:Ts.KEEP_AND_NORMALIZE,conditions:Lc((()=>new Map([["loading",new Set(["eager","lazy"])]])))}],["target",{policyAction:Ts.KEEP_AND_NORMALIZE,conditions:Lc((()=>new Map([["target",new Set(["_self","_blank"])]])))}]],oR=new br(new Set(sR),new Map(nR),new Set(iR),new Map(rR),void 0),aR=class{constructor(t,e,s,n,i,r){this.sanitizerTable=t,this.styleElementSanitizer=s,this.styleAttributeSanitizer=n,this.resourceUrlPolicy=i,this.openShadow=r,this.changes=[],Mf(e)}sanitizeAssertUnchanged(t){this.changes=[];const e=this.sanitize(t);if(this.changes.length!==0)throw new Error(`Unexpected change to HTML value as a result of sanitization. Input: "${t}", sanitized output: "${e}"
List of changes:${this.changes.join(`
`)}`);return e}sanitize(t){const e=document.implementation.createHTMLDocument("");return jk(this.sanitizeToFragmentInternal(t,e),e.body)}sanitizeToFragment(t){const e=document.implementation.createHTMLDocument("");return this.styleElementSanitizer&&this.styleAttributeSanitizer?this.sanitizeWithCssToFragment(t,e):this.sanitizeToFragmentInternal(t,e)}sanitizeWithCssToFragment(t,e){const s=document.createElement("safevalues-with-css"),n=this.openShadow?"open":"closed",i=s.attachShadow({mode:n}),r=this.sanitizeToFragmentInternal(t,e),o=document.createElement("style");o.textContent=Kk,o.id="safevalues-internal-style",i.appendChild(o),i.appendChild(r);const a=e.createDocumentFragment();return a.appendChild(s),a}sanitizeToFragmentInternal(t,e){const s=Jk(t,e),n=document.createTreeWalker(s,5,(a=>this.nodeFilter(a)));let i=n.nextNode();const r=e.createDocumentFragment();let o=r;for(;i!==null;){let a;if(Gb(i))if(this.styleElementSanitizer&&o.nodeName==="STYLE"){const l=this.styleElementSanitizer(i.data);a=this.createTextNode(l)}else a=this.sanitizeTextNode(i);else{if(!Vb(i)){let l="";throw l="Node is not of type text or element",new Error(l)}a=this.sanitizeElementNode(i,e)}if(o.appendChild(a),i=n.firstChild(),i)o=a;else for(;!(i=n.nextSibling())&&(i=n.parentNode());)o=o.parentNode}return r}createTextNode(t){return document.createTextNode(t)}sanitizeTextNode(t){return this.createTextNode(t.data)}sanitizeElementNode(t,e){const s=Ub(t),n=e.createElement(s),i=t.attributes;for(const{name:r,value:o}of i){const a=this.sanitizerTable.getAttributePolicy(r,s);if(this.satisfiesAllConditions(a.conditions,i))switch(a.policyAction){case Ts.KEEP:Ur(n,r,o);break;case Ts.KEEP_AND_SANITIZE_URL:const l=Xk(o);l!==o&&this.recordChange(`Url in attribute ${r} was modified during sanitization. Original url:"${o}" was sanitized to: "${l}"`),Ur(n,r,l);break;case Ts.KEEP_AND_NORMALIZE:Ur(n,r,o.toLowerCase());break;case Ts.KEEP_AND_SANITIZE_STYLE:this.styleAttributeSanitizer?Ur(n,r,this.styleAttributeSanitizer(o)):Ur(n,r,o);break;case Ts.KEEP_AND_USE_RESOURCE_URL_POLICY:if(this.resourceUrlPolicy){const u={type:$g.HTML_ATTRIBUTE,attributeName:r,elementName:s},h=Bb(o),g=this.resourceUrlPolicy(h,u);g&&Ur(n,r,g.toString())}else Ur(n,r,o);break;case Ts.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET:if(this.resourceUrlPolicy){const u={type:$g.HTML_ATTRIBUTE,attributeName:r,elementName:s},h=lR(o),g={parts:[]};for(const f of h.parts){const m=Bb(f.url),y=this.resourceUrlPolicy(m,u);y&&g.parts.push({url:y.toString(),descriptor:f.descriptor})}Ur(n,r,uR(g))}else Ur(n,r,o);break;case Ts.DROP:this.recordChange(`Attribute: ${r} was dropped`);break;default:dR(a.policyAction,"Unhandled AttributePolicyAction case")}else this.recordChange(`Not all conditions satisfied for attribute: ${r}.`)}return n}nodeFilter(t){if(Gb(t))return 1;if(!Vb(t))return 2;const e=Ub(t);return e===null?(this.recordChange(`Node name was null for node: ${t}`),2):this.sanitizerTable.isAllowedElement(e)?1:(this.recordChange(`Element: ${e} was dropped`),2)}recordChange(t){this.changes.push(t)}satisfiesAllConditions(t,e){var s;if(!t)return!0;for(const[n,i]of t){const r=(s=e.getNamedItem(n))===null||s===void 0?void 0:s.value;if(r&&!i.has(r))return!1}return!0}};function Ur(t,e,s){t.setAttribute(e,s)}function lR(t){const e=[];for(const s of t.split(",")){const[n,i]=s.trim().split(/\s+/,2);e.push({url:n,descriptor:i})}return{parts:e}}function uR(t){return t.parts.map((e=>{const{url:s,descriptor:n}=e;return`${s}${n?` ${n}`:""}`})).join(" , ")}function dR(t,e=`unexpected value ${t}!`){throw new Error(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var hR=class{constructor(){this.calledBuild=!1,this.sanitizerTable=oR}onlyAllowElements(t){const e=new Set,s=new Map;for(let n of t){if(n=n.toUpperCase(),!this.sanitizerTable.isAllowedElement(n))throw new Error(`Element: ${n}, is not allowed by html5_contract.textpb`);const i=this.sanitizerTable.elementPolicies.get(n);i!==void 0?s.set(n,i):e.add(n)}return this.sanitizerTable=new br(e,s,this.sanitizerTable.allowedGlobalAttributes,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowCustomElement(t,e){const s=new Set(this.sanitizerTable.allowedElements),n=new Map(this.sanitizerTable.elementPolicies);if(!eR(t=t.toUpperCase()))throw new Error(`Element: ${t} is not a custom element`);if(e){const i=new Map;for(const r of e)i.set(r.toLowerCase(),{policyAction:Ts.KEEP});n.set(t,i)}else s.add(t);return this.sanitizerTable=new br(s,n,this.sanitizerTable.allowedGlobalAttributes,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}onlyAllowAttributes(t){const e=new Set,s=new Map,n=new Map;for(const i of t)this.sanitizerTable.allowedGlobalAttributes.has(i)&&e.add(i),this.sanitizerTable.globalAttributePolicies.has(i)&&s.set(i,this.sanitizerTable.globalAttributePolicies.get(i));for(const[i,r]of this.sanitizerTable.elementPolicies.entries()){const o=new Map;for(const[a,l]of r.entries())t.has(a)&&o.set(a,l);n.set(i,o)}return this.sanitizerTable=new br(this.sanitizerTable.allowedElements,n,e,s,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowDataAttributes(t){if(t===void 0){const s=new Set(this.sanitizerTable.globallyAllowedAttributePrefixes);return s.add("data-"),this.sanitizerTable=new br(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,this.sanitizerTable.allowedGlobalAttributes,this.sanitizerTable.globalAttributePolicies,s),this}const e=new Set(this.sanitizerTable.allowedGlobalAttributes);for(const s of t){if(s.indexOf("data-")!==0)throw new Error(`data attribute: ${s} does not begin with the prefix "data-"`);e.add(s)}return this.sanitizerTable=new br(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,e,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowStyleAttributes(){const t=new Map(this.sanitizerTable.globalAttributePolicies);return t.set("style",{policyAction:Ts.KEEP_AND_SANITIZE_STYLE}),this.sanitizerTable=new br(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,this.sanitizerTable.allowedGlobalAttributes,t,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowClassAttributes(){const t=new Set(this.sanitizerTable.allowedGlobalAttributes);return t.add("class"),this.sanitizerTable=new br(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,t,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowIdAttributes(){const t=new Set(this.sanitizerTable.allowedGlobalAttributes);return t.add("id"),this.sanitizerTable=new br(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,t,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowIdReferenceAttributes(){const t=new Set(this.sanitizerTable.allowedGlobalAttributes);return t.add("aria-activedescendant").add("aria-controls").add("aria-labelledby").add("aria-owns").add("for").add("list"),this.sanitizerTable=new br(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,t,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}withResourceUrlPolicy(t){return this.resourceUrlPolicy=t,this}},cR=class extends hR{build(){if(this.calledBuild)throw new Error("this sanitizer has already called build");return this.calledBuild=!0,new aR(this.sanitizerTable,ch,void 0,void 0,this.resourceUrlPolicy)}};/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gR(t){const e=qw(t).toString(),s=new Blob([e],{type:"text/javascript"});return Ok(URL.createObjectURL(s))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wu(t,...e){if(e.some((s=>s!=="")))throw new Error("safeScript only allows empty string expressions to enable inline comments.");return Tk(t,e.length),fx(t.join(""))}function fR(t){return fx(t.map(qw).join(""))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Yw(t,e){const s=gh(e);s!==void 0&&(t.href=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mR(t,e){const s=gh(e);s!==void 0&&(t.href=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pR(t,e){t.href=gu(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _R(t,e){const s=gh(e);s!==void 0&&(t.formAction=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yR(t,e){t.src=gu(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xR(t,e){const s=gh(e);s!==void 0&&(t.action=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vR(t,e){t.src=gu(e).toString()}function bR(t,e){t.srcdoc=gx(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ER(t,e){const s=gh(e);s!==void 0&&(t.formAction=s)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SR(t,e){t.data=gu(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AR(t){return wR("script",t)}function wR(t,e=document){var s;const n=(s=e.querySelector)===null||s===void 0?void 0:s.call(e,`${t}[nonce]`);return n==null?"":n.nonce||n.getAttribute("nonce")||""}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TR(t){const e=AR(t.ownerDocument);e&&t.setAttribute("nonce",e)}function CR(t,e,s){t.src=gu(e),TR(t)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ww(t,e){NR(t)&&LR(t),t.innerHTML=gx(e)}function LR(t){let e="";const s=t.tagName;if(/^(script|style)$/i.test(s))throw e=s.toLowerCase()==="script"?"Use setScriptTextContent with a SafeScript.":"Use setStyleTextContent with a SafeStyleSheet.",new Error(e)}function NR(t){return t.nodeType===1}function MR(t,e,s){if(t.namespaceURI!=="http://www.w3.org/1999/xhtml")throw new Error(`Cannot set attribute '${e}' on '${t.tagName}'.Element is not in the HTML namespace`);switch(e=e.toLowerCase(),`${t.tagName} ${e}`){case"A href":return void Yw(t,s);case"AREA href":return void mR(t,s);case"BASE href":return void pR(t,s);case"BUTTON formaction":return void _R(t,s);case"EMBED src":return void yR(t,s);case"FORM action":return void xR(t,s);case"IFRAME src":return void vR(t,s);case"IFRAME srcdoc":return void bR(t,s);case"IFRAME sandbox":throw new Error("Can't set 'sandbox' on iframe tags. Use setIframeSrcWithIntent or setIframeSrcdocWithIntent instead");case"INPUT formaction":return void ER(t,s);case"LINK href":throw new Error("Can't set 'href' attribute on link tags. Use setLinkHrefAndRel instead");case"LINK rel":throw new Error("Can't set 'rel' attribute on link tags. Use setLinkHrefAndRel instead");case"OBJECT data":return void SR(t,s);case"SCRIPT src":return void CR(t,s);default:if(/^on./.test(e))throw new Error(`Attribute "${e}" looks like an event handler attribute. Please use a safe alternative like addEventListener instead.`);t.setAttribute(e,s)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function IR(t,e){return new Worker(gu(t),e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var kR=typeof global=="object"&&global!==null&&global.it!==void 0,eo=typeof document<"u",Vo=typeof window<"u",If=Vo&&!window.__OGMA_HEADLESS,kf=If&&eo,RR=typeof navigator<"u"&&navigator.userAgent!==void 0?navigator.userAgent.toLowerCase():"",FR=Vo&&/mac/.test(RR),Xw=typeof performance<"u"&&performance.now?()=>0|performance.now():()=>Date.now(),PR=Xw();function $n(){return Xw()-PR}function Zw(){const t=new Date,e=t.getDate(),s=t.getMonth()+1;return`${t.getFullYear()}-${s<10?"0"+s:s}-${e<10?"0"+e:e}`}function Kw(){const t=new Date;return`[${Nc((t.getUTCHours()-(t.getTimezoneOffset()/60|0))%24)}:${Nc(t.getUTCMinutes())}:${Nc(t.getUTCSeconds())}:${Nc(t.getUTCMilliseconds(),3)}]`}function Nc(t,e=2){let s=Math.pow(10,e-1),n=String(t);for(;s>1;)t<s&&(n="0"+n),s/=10;return n}function Uo(t){kR||console.warn(Kw()+" "+t)}function zR(t,e){e.forEach((s=>{Object.getOwnPropertyNames(s.prototype).forEach((n=>{Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(s.prototype,n)||Object.create(null))}))}))}var os=()=>{},qg=()=>!1,mx=()=>!0,Yg=()=>null,lr=t=>t;function Qw(t,e,s){const n=t.getObjectList(e.isNode);for(let i=0;i<e._indexes.length;++i){const r=e._indexes[i];s(n.get(r),i,e)}}function Jw(t,e,s){const n=new Array(e.size),i=t.getObjectList(e.isNode);for(let r=0;r<e._indexes.length;++r){const o=e._indexes[r],a=i.get(o);n[r]=s(a,r,e)}return n}function tT(t,e,s){s=s||mx;const n=e.isNode,i=t.acquireIndexList(n),r=t.getObjectList(n),o=t.getListFactory(n);for(let a=0;a<e._indexes.length;++a){const l=e._indexes[a],u=r.get(l);u&&s(u,a,e)&&i.push(l)}return o(i.sliceAndReset())}function eT(t,e,s){const n=t.getObjectList(e.isNode);for(let i=0;i<e._indexes.length;++i){const r=e._indexes[i];if(!s(n.get(r),i,e))return!1}return!0}function sT(t,e,s){const n=t.getObjectList(e.isNode);for(let i=0;i<e._indexes.length;++i){const r=e._indexes[i];if(s(n.get(r),i,e))return!0}return!1}function nT(t,e,s){const n=t.getObjectList(e.isNode);for(let i=0;i<e._indexes.length;++i){const r=e._indexes[i],o=n.get(r);if(s(o,i,e))return o}}function iT(t,e,s,n){const i=t.getListFactory(e.isNode);if(!s)return{valid:e,invalid:i()};const r=t.acquireIndexList(e.isNode),o=t.acquireIndexList(e.isNode),a=t.getObjectList(e.isNode);for(let l=0;l<e._indexes.length;l++){const u=e._indexes[l],h=a.get(u);h!==void 0&&(s(h,n)?r:o).pushUnchecked(u)}return{valid:i(r.sliceAndReset()),invalid:i(o.sliceAndReset())}}function rT(t,e,s,n){const i=t.getObjectList(e.isNode);let r=n;for(let o=0;o<e._indexes.length;++o){const a=e._indexes[o];r=s(r,i.get(a),o)}return r}function oT(t,e){const s=e.isNode,n=t.topology.getDeduper(s),i=t.acquireIndexList(s),r=t.getListFactory(s);for(let o=0;o<e._indexes.length;o++){const a=e._indexes[o];n.get(a)===0&&(n.set(a,1),i.push(a))}return r(i.sliceAndReset())}function aT(t,e,s){const n=e.isNode,i=s.topology.getDeduper(n),r=s.acquireIndexList(n),o=s.getListFactory(n);for(let a=0;a<e._indexes.length;a++){const l=e._indexes[a];i.set(l,1)}for(let a=0;a<t._indexes.length;a++){const l=t._indexes[a];i.get(l)===0&&r.push(l)}return o(r.sliceAndReset())}function lT(t,e){const s=e.isNode,n=t.storage.fetch(s),i=n.getFlexArray("excluded"),r=n.getMaxIndex(),o=t.topology.getDeduper(s),a=t.acquireIndexList(s),l=t.getListFactory(s);for(let u=0;u<e._indexes.length;u++)o.set(e._indexes[u],1);for(let u=1;u<=r;++u)o.get(u)===0&&i.get(u)===0&&a.push(u);return l(a.sliceAndReset())}function uT(t,e,s){const n=t.getListFactory(e.isNode),i=new Uint32Array(e._indexes.length+s._indexes.length);return i.set(e._indexes),i.set(s._indexes,e._indexes.length),n(i)}function dT(t,e){return t.getObjectList(e.isNode).getMultiple(e._indexes)}function Rf(t,e){const s=t.getStorage(e.isNode);if(e.isList){const n=new Array(e.size);for(let i=0;i<e._indexes.length;++i)n[i]=s.getId(e._indexes[i]);return n}return s.getId(e._index)}function hT(t,e){return t.topology.getExtremity(!0,e)}function cT(t,e){return t.topology.getExtremity(!1,e)}function gT(t,e,s){return t.getObjectList(e.isNode).get(e._indexes[s])}function fT(t,e,s){const n=t.getListFactory(e.isNode),i=t.getObjectList(e.isNode),r=e._indexes.slice();return r.sort(((o,a)=>{const l=i.get(o),u=i.get(a);return s(l,u)})),n(r)}var DR=[];function mT(t){typeof t=="object"&&t!==null||(t={});const e=typeof t.data=="function"?t.data:lr;return{attributes:Array.isArray(t.attributes)?t.attributes:t.attributes||DR,data:e}}function Ff(t,e){for(const s of t){const n=e;Object.keys(n).forEach((i=>{const r=n[i];s.prototype[i]=function(o,a){return Uo(`Deprecated method "${i}"; please use "${r}" instead.`),this[r](o,a)}}))}}function jb(t){const e=t.getFlexArray("removed"),s=t.getFlexArray("excluded"),n=t.getFlexArray("virtual");return{all:i=>e.get(i)===0,visible:i=>s.get(i)===0,excluded:i=>s.get(i)===1,raw:i=>n.get(i)===0&&e.get(i)===0,_all:i=>!0}}function Hb(t,e,s){return{all:Mc(s.all,t,e),visible:Mc(s.visible,t,e),raw:Mc(s.raw,t,e),_all:Mc(s._all,t,e)}}function Mc(t,e,s){let n=null;return{getList(){if(!n){const i=e(),r=s();r.reset();for(let o=1;o<=i;++o)t(o)&&r.push(o);n=r.sliceAndReset()}return n},invalidList(){n=null}}}function OR(t){if(t===void 0)return Math.round(Math.random()*Number.MAX_SAFE_INTEGER);if(typeof t!="string"&&(typeof t!="number"||!isFinite(t)))throw new Error(`${t} is not a valid id, expected string or number`);return t}var $b=new Uint32Array(1),so=class{constructor(t,e){this.size=1,this.isNode=!1,this.isList=!1,this._index=t,this._ogma=e}get _indexes(){return $b[0]=this._index,$b}setAttributes(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)}setAttribute(t,e,s){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,s)}getAttributes(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)[0]}getAttribute(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)[0]}resetAttributes(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)}replaceOriginalAttributes(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)}getPreviousAttributes(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)[0]}isInView(t){return this._ogma.modules.locate.isElementInView(this,t)}hasParallelEdges(){return this._ogma.modules.graph.hasParallelEdges(this)}getParallelEdges(t){return this._ogma.modules.graph.getParallelEdges(this,t)}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)}getAdjacentElements(){const{nodes:t,edges:e}=this.fastGetAdjacentElements();return{nodes:t.dedupe(),edges:e.filter((s=>s!==this)).dedupe()}}isVisible(){return!this.isExcluded()}isExcluded(){return this._ogma.modules.graph.isExcluded(this)[0]}setExcluded(t){return this._ogma.modules.graph.setExcluded(this,t)}setVisible(t){return this.setExcluded(!t)}toList(){return this._ogma.modules.graph.edgeList(new Uint32Array([this._index]))}getId(){return Rf(this._ogma.modules.graph,this)}getSource(){return hT(this._ogma.modules.graph,this)}getTarget(){return cT(this._ogma.modules.graph,this)}getExtremities(){return this._ogma.modules.graph.nodeList(new Uint32Array([this.getSource()._index,this.getTarget()._index]))}setSource(t){this._ogma.modules.graph.setSource(this,t)}setTarget(t){this._ogma.modules.graph.setTarget(this,t)}slice(){return this.toList()}toJSON(t={}){const{attributes:e,data:s}=mT(t);return{id:this.getId(),source:this.getSource().getId(),target:this.getTarget().getId(),attributes:this.getAttributes(e),data:s(Ws(this.getData()))}}get(t){return t===0?this:void 0}setSelected(t){this._ogma.modules.selection.setActive(this,t)}isSelected(){return this._ogma.modules.selection.areActive(this)}locate(t){return this._ogma.modules.locate.locateElements(this,t)}getBoundingBox({includeTexts:t=!1,ignoreCurvature:e=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,t,t,e)}setData(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e),this}getData(t){return this._ogma.modules.data.getProperty(this,t||null)[0]}addClass(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)}addClasses(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)}removeClass(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)}removeClasses(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)}hasClass(t){return this._ogma.modules.classes.hasSingleElementClass(t,this)}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)[0]}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]}isVirtual(){return this._ogma.modules.transformations.isElementVirtual(this)}getTransformation(){return this._ogma.modules.transformations.getElementTransformation(this)}getMetaEdge(){return this._ogma.modules.transformations.getMetaEdge(this)}getSubEdges(){return this._ogma.modules.transformations.getSubEdges(this)}pulse(t){return this._ogma.modules.pulses.pulse(this,t)}};Ff([so],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var Va=class{constructor(t,e){this.isList=!0,this.isNode=!1,this._indexes=t,this._ogma=e}get size(){return this._indexes.length}setAttributes(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)}setAttribute(t,e,s){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,s)}getAttributes(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)}getAttribute(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)}resetAttributes(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)}replaceOriginalAttributes(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)}getPreviousAttributes(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)}getPreviousAttribute(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)}getParallelEdges(t){return this._ogma.modules.graph.getParallelEdges(this,t)}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)}getAdjacentElements(){const{nodes:t,edges:e}=this.fastGetAdjacentElements();return{nodes:t.dedupe(),edges:e.subtract(this).dedupe()}}isVisible(){return this.isExcluded().map((t=>!t))}isExcluded(){return this._ogma.modules.graph.isExcluded(this)}isVirtual(){return this.map((t=>this._ogma.modules.transformations.isElementVirtual(t)))}setExcluded(t){return this._ogma.modules.graph.setExcluded(this,t)}setVisible(t){return this.setExcluded(!t)}toList(){return this}toArray(){return dT(this._ogma.modules.graph,this)}clone(){return this._ogma.modules.graph.edgeList(this._indexes.slice())}getId(){return Rf(this._ogma.modules.graph,this)}getSource(){return hT(this._ogma.modules.graph,this)}getTarget(){return cT(this._ogma.modules.graph,this)}getExtremities(){return this.getSource().concat(this.getTarget())}get(t){return gT(this._ogma.modules.graph,this,t)}forEach(t){Qw(this._ogma.modules.graph,this,t)}map(t){return Jw(this._ogma.modules.graph,this,t)}find(t){return nT(this._ogma.modules.graph,this,t)}some(t){return sT(this._ogma.modules.graph,this,t)}every(t){return eT(this._ogma.modules.graph,this,t)}[Symbol.iterator](){let t=-1;return{next:()=>({value:this.get(++t),done:t>=this.size})}}filter(t){return tT(this._ogma.modules.graph,this,t)}reduce(t,e){return rT(this._ogma.modules.graph,this,t,e)}concat(t){return uT(this._ogma.modules.graph,this,t)}dedupe(){return oT(this._ogma.modules.graph,this)}subtract(t){return aT(this,t,this._ogma.modules.graph)}slice(t,e){return this._ogma.modules.graph.edgeList(this._indexes.slice(t,e))}indexOf(t){return t instanceof so?this._indexes.indexOf(t._index):-1}includes(t){return this.indexOf(t)!==-1}sort(t){return fT(this._ogma.modules.graph,this,t)}inverse(){return lT(this._ogma.modules.graph,this)}toJSON(t={}){return this.map((e=>e.toJSON(t)))}setSelected(t){this._ogma.modules.selection.setActive(this,t)}isSelected(){return this._ogma.modules.selection.areActive(this)}locate(t){return this._ogma.modules.locate.locateElements(this,t)}getBoundingBox({includeTexts:t=!1,ignoreCurvature:e=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,t,t,e)}setData(t,e){if(arguments.length<2&&(e=t,t=null),typeof e!="function"&&!Rn(e))throw new Error(`invalid argument ${e}; expected array or function`);return this._ogma.modules.data.setProperty(this,t,e,{dispatch:!0}),this}fillData(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e,{dispatch:!1}),this}getData(t){return this._ogma.modules.data.getProperty(this,t||null)}addClass(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)}addClasses(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)}removeClass(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)}removeClasses(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)}hasClass(t){return this.map((e=>this._ogma.modules.classes.hasSingleElementClass(t,e)))}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)}getMetaEdge(){return this._ogma.modules.transformations.getMetaEdges(this)}getSubEdges(){return this.map(this._ogma.modules.transformations.getSubEdges)}pulse(t){return this._ogma.modules.pulses.pulse(this,t)}};Ff([Va],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var Ar="geo.latitude",wr="geo.longitude",qb="geo.prevLat",Mp="geo.prevLng",B_=85.0511287798,BR=6378137,Wg=1,UR='Map data &copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap contributors</a>',Aa={latitudePath:"latitude",longitudePath:"longitude",maxZoomLevel:22,minZoomLevel:0,wrapCoordinates:!0,tileUrlTemplate:"https://{s}.tile.osm.org/{z}/{x}/{y}.png",tileUrlSubdomains:"abc",attribution:null,attributionOptions:void 0,backgroundColor:"silver",opacity:1,duration:0,disableNodeDragging:!0,tileBuffer:1,sizeRatio:1,tiles:{url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png",subdomains:"abc",tms:!1,wms:!1},crs:void 0},GR={maxBoundsViscosity:1,worldCopyJump:!0,zoomControl:!1,attributionControl:!1},VR=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let s=0;for(let n=0;n<this._n&&n<32;n++){const i=e[n],r=t+i,o=Math.abs(t)<Math.abs(i)?t-(r-i):i-(r-t);o&&(e[s++]=o),t=r}return e[s]=t,this._n=s+1,this}valueOf(){const t=this._partials;let e,s,n,i=this._n,r=0;if(i>0){for(r=t[--i];i>0&&(e=r,s=t[--i],r=e+s,n=s-(r-e),!n););i>0&&(n<0&&t[i-1]<0||n>0&&t[i-1]>0)&&(s=2*n,e=r+s,s==e-r&&(r=e))}return r}};function*jR(t){for(const e of t)yield*e}function pT(t){return Array.from(jR(t))}var ks=1e-6,ms=Math.PI,Gi=ms/2,Yb=ms/4,ur=2*ms,Gr=180/ms,vi=ms/180,nn=Math.abs,HR=Math.atan,eu=Math.atan2,Ys=Math.cos,js=Math.sin,$R=Math.sign||function(t){return t>0?1:t<0?-1:0},fh=Math.sqrt;function _T(t){return t>1?0:t<-1?ms:Math.acos(t)}function su(t){return t>1?Gi:t<-1?-Gi:Math.asin(t)}function hd(){}function Xg(t,e){t&&Xb.hasOwnProperty(t.type)&&Xb[t.type](t,e)}var Wb={Feature:function(t,e){Xg(t.geometry,e)},FeatureCollection:function(t,e){for(var s=t.features,n=-1,i=s.length;++n<i;)Xg(s[n].geometry,e)}},Xb={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var s=t.coordinates,n=-1,i=s.length;++n<i;)t=s[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){U_(t.coordinates,e,0)},MultiLineString:function(t,e){for(var s=t.coordinates,n=-1,i=s.length;++n<i;)U_(s[n],e,0)},Polygon:function(t,e){Zb(t.coordinates,e)},MultiPolygon:function(t,e){for(var s=t.coordinates,n=-1,i=s.length;++n<i;)Zb(s[n],e)},GeometryCollection:function(t,e){for(var s=t.geometries,n=-1,i=s.length;++n<i;)Xg(s[n],e)}};function U_(t,e,s){var n,i=-1,r=t.length-s;for(e.lineStart();++i<r;)n=t[i],e.point(n[0],n[1],n[2]);e.lineEnd()}function Zb(t,e){var s=-1,n=t.length;for(e.polygonStart();++s<n;)U_(t[s],e,1);e.polygonEnd()}function qR(t,e){t&&Wb.hasOwnProperty(t.type)?Wb[t.type](t,e):Xg(t,e)}function G_(t){return[eu(t[1],t[0]),su(t[2])]}function nu(t){var e=t[0],s=t[1],n=Ys(s);return[n*Ys(e),n*js(e),js(s)]}function Ic(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Zg(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Ip(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function kc(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function V_(t){var e=fh(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function j_(t,e){function s(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(s.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),s}function H_(t,e){return nn(t)>ms&&(t-=Math.round(t/ur)*ur),[t,e]}function YR(t,e,s){return(t%=ur)?e||s?j_(Qb(t),Jb(e,s)):Qb(t):e||s?Jb(e,s):H_}function Kb(t){return function(e,s){return nn(e+=t)>ms&&(e-=Math.round(e/ur)*ur),[e,s]}}function Qb(t){var e=Kb(t);return e.invert=Kb(-t),e}function Jb(t,e){var s=Ys(t),n=js(t),i=Ys(e),r=js(e);function o(a,l){var u=Ys(l),h=Ys(a)*u,g=js(a)*u,f=js(l),m=f*s+h*n;return[eu(g*i-m*r,h*s-f*n),su(m*i+g*r)]}return o.invert=function(a,l){var u=Ys(l),h=Ys(a)*u,g=js(a)*u,f=js(l),m=f*i-g*r;return[eu(g*i+f*r,h*s+m*n),su(m*s-h*n)]},o}function WR(t,e,s,n,i,r){if(s){var o=Ys(e),a=js(e),l=n*s;i==null?(i=e+n*ur,r=e-l/2):(i=tE(o,i),r=tE(o,r),(n>0?i<r:i>r)&&(i+=n*ur));for(var u,h=i;n>0?h>r:h<r;h-=l)u=G_([o,-a*Ys(h),-a*js(h)]),t.point(u[0],u[1])}}function tE(t,e){(e=nu(e))[0]-=t,V_(e);var s=_T(-e[1]);return((-e[2]<0?-s:s)+ur-ks)%ur}function yT(){var t,e=[];return{point:function(s,n,i){t.push([s,n,i])},lineStart:function(){e.push(t=[])},lineEnd:hd,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var s=e;return e=[],t=null,s}}}function Ng(t,e){return nn(t[0]-e[0])<ks&&nn(t[1]-e[1])<ks}function Rc(t,e,s,n){this.x=t,this.z=e,this.o=s,this.e=n,this.v=!1,this.n=this.p=null}function xT(t,e,s,n,i){var r,o,a=[],l=[];if(t.forEach((function(y){if(!((p=y.length-1)<=0)){var p,x,v=y[0],b=y[p];if(Ng(v,b)){if(!v[2]&&!b[2]){for(i.lineStart(),r=0;r<p;++r)i.point((v=y[r])[0],v[1]);return void i.lineEnd()}b[0]+=2*ks}a.push(x=new Rc(v,y,null,!0)),l.push(x.o=new Rc(v,null,x,!1)),a.push(x=new Rc(b,y,null,!1)),l.push(x.o=new Rc(b,null,x,!0))}})),a.length){for(l.sort(e),eE(a),eE(l),r=0,o=l.length;r<o;++r)l[r].e=s=!s;for(var u,h,g=a[0];;){for(var f=g,m=!0;f.v;)if((f=f.n)===g)return;u=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(m)for(r=0,o=u.length;r<o;++r)i.point((h=u[r])[0],h[1]);else n(f.x,f.n.x,1,i);f=f.n}else{if(m)for(u=f.p.z,r=u.length-1;r>=0;--r)i.point((h=u[r])[0],h[1]);else n(f.x,f.p.x,-1,i);f=f.p}u=(f=f.o).z,m=!m}while(!f.v);i.lineEnd()}}}function eE(t){if(e=t.length){for(var e,s,n=0,i=t[0];++n<e;)i.n=s=t[n],s.p=i,i=s;i.n=s=t[0],s.p=i}}function kp(t){return nn(t[0])<=ms?t[0]:$R(t[0])*((nn(t[0])+ms)%ur-ms)}function XR(t,e){var s=kp(e),n=e[1],i=js(n),r=[js(s),-Ys(s),0],o=0,a=0,l=new VR;i===1?n=Gi+ks:i===-1&&(n=-Gi-ks);for(var u=0,h=t.length;u<h;++u)if(f=(g=t[u]).length)for(var g,f,m=g[f-1],y=kp(m),p=m[1]/2+Yb,x=js(p),v=Ys(p),b=0;b<f;++b,y=A,x=L,v=k,m=S){var S=g[b],A=kp(S),w=S[1]/2+Yb,L=js(w),k=Ys(w),F=A-y,O=F>=0?1:-1,j=O*F,V=j>ms,Z=x*L;if(l.add(eu(Z*O*js(j),v*k+Z*Ys(j))),o+=V?F+O*ur:F,V^y>=s^A>=s){var at=Zg(nu(m),nu(S));V_(at);var mt=Zg(r,at);V_(mt);var K=(V^F>=0?-1:1)*su(mt[2]);(n>K||n===K&&(at[0]||at[1]))&&(a+=V^F>=0?1:-1)}}return(o<-ks||o<ks&&l<-1e-12)^1&a}function vT(t,e,s,n){return function(i){var r,o,a,l=e(i),u=yT(),h=e(u),g=!1,f={point:m,lineStart:p,lineEnd:x,polygonStart:function(){f.point=v,f.lineStart=b,f.lineEnd=S,o=[],r=[]},polygonEnd:function(){f.point=m,f.lineStart=p,f.lineEnd=x,o=pT(o);var A=XR(r,n);o.length?(g||(i.polygonStart(),g=!0),xT(o,KR,A,s,i)):A&&(g||(i.polygonStart(),g=!0),i.lineStart(),s(null,null,1,i),i.lineEnd()),g&&(i.polygonEnd(),g=!1),o=r=null},sphere:function(){i.polygonStart(),i.lineStart(),s(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function m(A,w){t(A,w)&&i.point(A,w)}function y(A,w){l.point(A,w)}function p(){f.point=y,l.lineStart()}function x(){f.point=m,l.lineEnd()}function v(A,w){a.push([A,w]),h.point(A,w)}function b(){h.lineStart(),a=[]}function S(){v(a[0][0],a[0][1]),h.lineEnd();var A,w,L,k,F=h.clean(),O=u.result(),j=O.length;if(a.pop(),r.push(a),a=null,j)if(1&F){if((w=(L=O[0]).length-1)>0){for(g||(i.polygonStart(),g=!0),i.lineStart(),A=0;A<w;++A)i.point((k=L[A])[0],k[1]);i.lineEnd()}}else j>1&&2&F&&O.push(O.pop().concat(O.shift())),o.push(O.filter(ZR))}return f}}function ZR(t){return t.length>1}function KR(t,e){return((t=t.x)[0]<0?t[1]-Gi-ks:Gi-t[1])-((e=e.x)[0]<0?e[1]-Gi-ks:Gi-e[1])}H_.invert=H_;var sE=vT((function(){return!0}),QR,tF,[-ms,-Gi]);function QR(t){var e,s=NaN,n=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(r,o){var a=r>0?ms:-ms,l=nn(r-s);nn(l-ms)<ks?(t.point(s,n=(n+o)/2>0?Gi:-Gi),t.point(i,n),t.lineEnd(),t.lineStart(),t.point(a,n),t.point(r,n),e=0):i!==a&&l>=ms&&(nn(s-i)<ks&&(s-=i*ks),nn(r-a)<ks&&(r-=a*ks),n=JR(s,n,r,o),t.point(i,n),t.lineEnd(),t.lineStart(),t.point(a,n),e=0),t.point(s=r,n=o),i=a},lineEnd:function(){t.lineEnd(),s=n=NaN},clean:function(){return 2-e}}}function JR(t,e,s,n){var i,r,o=js(t-s);return nn(o)>ks?HR((js(e)*(r=Ys(n))*js(s)-js(n)*(i=Ys(e))*js(t))/(i*r*o)):(e+n)/2}function tF(t,e,s,n){var i;if(t==null)i=s*Gi,n.point(-ms,i),n.point(0,i),n.point(ms,i),n.point(ms,0),n.point(ms,-i),n.point(0,-i),n.point(-ms,-i),n.point(-ms,0),n.point(-ms,i);else if(nn(t[0]-e[0])>ks){var r=t[0]<e[0]?ms:-ms;i=s*r/2,n.point(-r,i),n.point(0,i),n.point(r,i)}else n.point(e[0],e[1])}function eF(t){var e=Ys(t),s=2*vi,n=e>0,i=nn(e)>ks;function r(l,u){return Ys(l)*Ys(u)>e}function o(l,u,h){var g=[1,0,0],f=Zg(nu(l),nu(u)),m=Ic(f,f),y=f[0],p=m-y*y;if(!p)return!h&&l;var x=e*m/p,v=-e*y/p,b=Zg(g,f),S=kc(g,x);Ip(S,kc(f,v));var A=b,w=Ic(S,A),L=Ic(A,A),k=w*w-L*(Ic(S,S)-1);if(!(k<0)){var F=fh(k),O=kc(A,(-w-F)/L);if(Ip(O,S),O=G_(O),!h)return O;var j,V=l[0],Z=u[0],at=l[1],mt=u[1];Z<V&&(j=V,V=Z,Z=j);var K=Z-V,ut=nn(K-ms)<ks;if(!ut&&mt<at&&(j=at,at=mt,mt=j),ut||K<ks?ut?at+mt>0^O[1]<(nn(O[0]-V)<ks?at:mt):at<=O[1]&&O[1]<=mt:K>ms^(V<=O[0]&&O[0]<=Z)){var ht=kc(A,(-w+F)/L);return Ip(ht,S),[O,G_(ht)]}}}function a(l,u){var h=n?t:ms-t,g=0;return l<-h?g|=1:l>h&&(g|=2),u<-h?g|=4:u>h&&(g|=8),g}return vT(r,(function(u){var h,g,f,m,y;return{lineStart:function(){m=f=!1,y=1},point:function(p,x){var v,b=[p,x],S=r(p,x),A=n?S?0:a(p,x):S?a(p+(p<0?ms:-ms),x):0;if(!h&&(m=f=S)&&u.lineStart(),S!==f&&(!(v=o(h,b))||Ng(h,v)||Ng(b,v))&&(b[2]=1),S!==f)y=0,S?(u.lineStart(),v=o(b,h),u.point(v[0],v[1])):(v=o(h,b),u.point(v[0],v[1],2),u.lineEnd()),h=v;else if(i&&h&&n^S){var w;A&g||!(w=o(b,h,!0))||(y=0,n?(u.lineStart(),u.point(w[0][0],w[0][1]),u.point(w[1][0],w[1][1]),u.lineEnd()):(u.point(w[1][0],w[1][1]),u.lineEnd(),u.lineStart(),u.point(w[0][0],w[0][1],3)))}!S||h&&Ng(h,b)||u.point(b[0],b[1]),h=b,f=S,g=A},lineEnd:function(){f&&u.lineEnd(),h=null},clean:function(){return y|(m&&f)<<1}}}),(function(u,h,g,f){WR(f,t,s,g,u,h)}),n?[0,-t]:[-ms,t-ms])}function sF(t,e,s,n,i,r){var o,a=t[0],l=t[1],u=0,h=1,g=e[0]-a,f=e[1]-l;if(o=s-a,g||!(o>0)){if(o/=g,g<0){if(o<u)return;o<h&&(h=o)}else if(g>0){if(o>h)return;o>u&&(u=o)}if(o=i-a,g||!(o<0)){if(o/=g,g<0){if(o>h)return;o>u&&(u=o)}else if(g>0){if(o<u)return;o<h&&(h=o)}if(o=n-l,f||!(o>0)){if(o/=f,f<0){if(o<u)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>u&&(u=o)}if(o=r-l,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>u&&(u=o)}else if(f>0){if(o<u)return;o<h&&(h=o)}return u>0&&(t[0]=a+u*g,t[1]=l+u*f),h<1&&(e[0]=a+h*g,e[1]=l+h*f),!0}}}}}var cd=1e9,Fc=-cd;function nF(t,e,s,n){function i(u,h){return t<=u&&u<=s&&e<=h&&h<=n}function r(u,h,g,f){var m=0,y=0;if(u==null||(m=o(u,g))!==(y=o(h,g))||l(u,h)<0^g>0)do f.point(m===0||m===3?t:s,m>1?n:e);while((m=(m+g+4)%4)!==y);else f.point(h[0],h[1])}function o(u,h){return nn(u[0]-t)<ks?h>0?0:3:nn(u[0]-s)<ks?h>0?2:1:nn(u[1]-e)<ks?h>0?1:0:h>0?3:2}function a(u,h){return l(u.x,h.x)}function l(u,h){var g=o(u,1),f=o(h,1);return g!==f?g-f:g===0?h[1]-u[1]:g===1?u[0]-h[0]:g===2?u[1]-h[1]:h[0]-u[0]}return function(u){var h,g,f,m,y,p,x,v,b,S,A,w=u,L=yT(),k={point:F,lineStart:function(){k.point=O,g&&g.push(f=[]),S=!0,b=!1,x=v=NaN},lineEnd:function(){h&&(O(m,y),p&&b&&L.rejoin(),h.push(L.result())),k.point=F,b&&w.lineEnd()},polygonStart:function(){w=L,h=[],g=[],A=!0},polygonEnd:function(){var V=(function(){for(var K=0,ut=0,ht=g.length;ut<ht;++ut)for(var nt,ot,Mt=g[ut],Q=1,Et=Mt.length,qt=Mt[0],Vt=qt[0],Wt=qt[1];Q<Et;++Q)nt=Vt,ot=Wt,Vt=(qt=Mt[Q])[0],Wt=qt[1],ot<=n?Wt>n&&(Vt-nt)*(n-ot)>(Wt-ot)*(t-nt)&&++K:Wt<=n&&(Vt-nt)*(n-ot)<(Wt-ot)*(t-nt)&&--K;return K})(),Z=A&&V,at=(h=pT(h)).length;(Z||at)&&(u.polygonStart(),Z&&(u.lineStart(),r(null,null,1,u),u.lineEnd()),at&&xT(h,a,V,r,u),u.polygonEnd()),w=u,h=g=f=null}};function F(j,V){i(j,V)&&w.point(j,V)}function O(j,V){var Z=i(j,V);if(g&&f.push([j,V]),S)m=j,y=V,p=Z,S=!1,Z&&(w.lineStart(),w.point(j,V));else if(Z&&b)w.point(j,V);else{var at=[x=Math.max(Fc,Math.min(cd,x)),v=Math.max(Fc,Math.min(cd,v))],mt=[j=Math.max(Fc,Math.min(cd,j)),V=Math.max(Fc,Math.min(cd,V))];sF(at,mt,t,e,s,n)?(b||(w.lineStart(),w.point(at[0],at[1])),w.point(mt[0],mt[1]),Z||w.lineEnd(),A=!1):Z&&(w.lineStart(),w.point(j,V),A=!1)}x=j,v=V,b=Z}return k}}var nE=t=>t,iu=1/0,Kg=iu,Hd=-iu,Qg=Hd,iF={point:rF,lineStart:hd,lineEnd:hd,polygonStart:hd,polygonEnd:hd,result:function(){var t=[[iu,Kg],[Hd,Qg]];return Hd=Qg=-(Kg=iu=1/0),t}};function rF(t,e){t<iu&&(iu=t),t>Hd&&(Hd=t),e<Kg&&(Kg=e),e>Qg&&(Qg=e)}var iE=iF;function px(t){return function(e){var s=new $_;for(var n in t)s[n]=t[n];return s.stream=e,s}}function $_(){}function _x(t,e,s){var n=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),n!=null&&t.clipExtent(null),qR(s,t.stream(iE)),e(iE.result()),n!=null&&t.clipExtent(n),t}function bT(t,e,s){return _x(t,(function(n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=Math.min(i/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),a=+e[0][0]+(i-o*(n[1][0]+n[0][0]))/2,l=+e[0][1]+(r-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,l])}),s)}function oF(t,e,s){return bT(t,[[0,0],e],s)}function aF(t,e,s){return _x(t,(function(n){var i=+e,r=i/(n[1][0]-n[0][0]),o=(i-r*(n[1][0]+n[0][0]))/2,a=-r*n[0][1];t.scale(150*r).translate([o,a])}),s)}function lF(t,e,s){return _x(t,(function(n){var i=+e,r=i/(n[1][1]-n[0][1]),o=-r*n[0][0],a=(i-r*(n[1][1]+n[0][1]))/2;t.scale(150*r).translate([o,a])}),s)}$_.prototype={constructor:$_,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var rE=16,uF=Ys(30*vi);function oE(t,e){return+e?hF(t,e):dF(t)}function dF(t){return px({point:function(e,s){e=t(e,s),this.stream.point(e[0],e[1])}})}function hF(t,e){function s(n,i,r,o,a,l,u,h,g,f,m,y,p,x){var v=u-n,b=h-i,S=v*v+b*b;if(S>4*e&&p--){var A=o+f,w=a+m,L=l+y,k=fh(A*A+w*w+L*L),F=su(L/=k),O=nn(nn(L)-1)<ks||nn(r-g)<ks?(r+g)/2:eu(w,A),j=t(O,F),V=j[0],Z=j[1],at=V-n,mt=Z-i,K=b*at-v*mt;(K*K/S>e||nn((v*at+b*mt)/S-.5)>.3||o*f+a*m+l*y<uF)&&(s(n,i,r,o,a,l,V,Z,O,A/=k,w/=k,L,p,x),x.point(V,Z),s(V,Z,O,A,w,L,u,h,g,f,m,y,p,x))}}return function(n){var i,r,o,a,l,u,h,g,f,m,y,p,x={point:v,lineStart:b,lineEnd:A,polygonStart:function(){n.polygonStart(),x.lineStart=w},polygonEnd:function(){n.polygonEnd(),x.lineStart=b}};function v(F,O){F=t(F,O),n.point(F[0],F[1])}function b(){g=NaN,x.point=S,n.lineStart()}function S(F,O){var j=nu([F,O]),V=t(F,O);s(g,f,h,m,y,p,g=V[0],f=V[1],h=F,m=j[0],y=j[1],p=j[2],rE,n),n.point(g,f)}function A(){x.point=v,n.lineEnd()}function w(){b(),x.point=L,x.lineEnd=k}function L(F,O){S(i=F,O),r=g,o=f,a=m,l=y,u=p,x.point=S}function k(){s(g,f,h,m,y,p,r,o,i,a,l,u,rE,n),x.lineEnd=A,A()}return x}}var cF=px({point:function(t,e){this.stream.point(t*vi,e*vi)}});function gF(t){return px({point:function(e,s){var n=t(e,s);return this.stream.point(n[0],n[1])}})}function fF(t,e,s,n,i){function r(o,a){return[e+t*(o*=n),s-t*(a*=i)]}return r.invert=function(o,a){return[(o-e)/t*n,(s-a)/t*i]},r}function aE(t,e,s,n,i,r){if(!r)return fF(t,e,s,n,i);var o=Ys(r),a=js(r),l=o*t,u=a*t,h=o/t,g=a/t,f=(a*s-o*e)/t,m=(a*e+o*s)/t;function y(p,x){return[l*(p*=n)-u*(x*=i)+e,s-u*p-l*x]}return y.invert=function(p,x){return[n*(h*p-g*x+f),i*(m-g*p-h*x)]},y}function mF(t){return pF((function(){return t}))()}function pF(t){var e,s,n,i,r,o,a,l,u,h,g=150,f=480,m=250,y=0,p=0,x=0,v=0,b=0,S=0,A=1,w=1,L=null,k=sE,F=null,O=nE,j=.5;function V(K){return l(K[0]*vi,K[1]*vi)}function Z(K){return(K=l.invert(K[0],K[1]))&&[K[0]*Gr,K[1]*Gr]}function at(){var K=aE(g,0,0,A,w,S).apply(null,e(y,p)),ut=aE(g,f-K[0],m-K[1],A,w,S);return s=YR(x,v,b),a=j_(e,ut),l=j_(s,a),o=oE(a,j),mt()}function mt(){return u=h=null,V}return V.stream=function(K){return u&&h===K?u:u=cF(gF(s)(k(o(O(h=K)))))},V.preclip=function(K){return arguments.length?(k=K,L=void 0,mt()):k},V.postclip=function(K){return arguments.length?(O=K,F=n=i=r=null,mt()):O},V.clipAngle=function(K){return arguments.length?(k=+K?eF(L=K*vi):(L=null,sE),mt()):L*Gr},V.clipExtent=function(K){return arguments.length?(O=K==null?(F=n=i=r=null,nE):nF(F=+K[0][0],n=+K[0][1],i=+K[1][0],r=+K[1][1]),mt()):F==null?null:[[F,n],[i,r]]},V.scale=function(K){return arguments.length?(g=+K,at()):g},V.translate=function(K){return arguments.length?(f=+K[0],m=+K[1],at()):[f,m]},V.center=function(K){return arguments.length?(y=K[0]%360*vi,p=K[1]%360*vi,at()):[y*Gr,p*Gr]},V.rotate=function(K){return arguments.length?(x=K[0]%360*vi,v=K[1]%360*vi,b=K.length>2?K[2]%360*vi:0,at()):[x*Gr,v*Gr,b*Gr]},V.angle=function(K){return arguments.length?(S=K%360*vi,at()):S*Gr},V.reflectX=function(K){return arguments.length?(A=K?-1:1,at()):A<0},V.reflectY=function(K){return arguments.length?(w=K?-1:1,at()):w<0},V.precision=function(K){return arguments.length?(o=oE(a,j=K*K),mt()):fh(j)},V.fitExtent=function(K,ut){return bT(V,K,ut)},V.fitSize=function(K,ut){return oF(V,K,ut)},V.fitWidth=function(K,ut){return aF(V,K,ut)},V.fitHeight=function(K,ut){return lF(V,K,ut)},function(){return e=t.apply(this,arguments),V.invert=e.invert&&Z,at()}}function _F(t){return function(e,s){var n=Ys(e),i=Ys(s),r=t(n*i);return r===1/0?[2,0]:[r*i*js(e),r*js(s)]}}function yF(t){return function(e,s){var n=fh(e*e+s*s),i=t(n),r=js(i),o=Ys(i);return[eu(e*r,n*o),su(n&&s*r/n)]}}var ET=_F((function(t){return(t=_T(t))&&t/js(t)}));function xF(){return mF(ET).scale(79.4188).clipAngle(179.999)}ET.invert=yF((function(t){return t}));var vF=(()=>{let t=0;return typeof requestAnimationFrame<"u"?requestAnimationFrame:function(e){const s=Date.now(),n=Math.min(16,Math.max(0,16-(s-t))),i=t=s+n;return setTimeout((()=>e(i)),n)}})(),ST=50,bF=typeof cancelAnimationFrame<"u"?cancelAnimationFrame:function(t){return clearTimeout(t)};function yx(t,e){return vF((s=>{t.call(e,s)}))}function AT(t){t&&bF(t)}var Rp,Ua,xx,wT,EF={},TT=EF,Mg={},CT={},q_=t=>null;if(typeof global=="object"&&(Mg=global),typeof window=="object"&&(CT=window),typeof Td=="object"&&typeof Td.require=="function"){const t=Td.require.bind(Td);q_=e=>{try{return t(e)}catch{return null}}}else typeof Mg.require=="function"&&(q_=t=>{const e=Mg.require;try{return e(t)}catch{return null}});function Hi(t,{throwOnError:e}={}){let s=null;if(!s&&t&&(s=TT[t]),!s&&t&&(s=q_(t)),!s&&t&&(s=CT[t]),!s&&t&&(s=Mg[t]),!s&&e){const n=[`unable to find module "${t}"; make sure one of these statements is true:`,`- Ogma.libraries['${t}'] is set to the right library`,`- require('${t}') returns the right library`,`- window['${t}'] is set to the right library`].join(`
`);throw new Error(n)}return s}var rr,LT=(rr=class{constructor(){this.method=null,this.url=null,this.status=0,this.readyState=0,this.headers={},this.responseText=null,this.response=null,rr.onCreate&&rr.onCreate(this)}open(e,s){this.method=e,this.url=s,rr.onSend&&rr.onSend(this)}respond(e,s,n){this.readyState=4,this.status=e,this.headers=s,this.responseText=n,this.response=n,this.onreadystatechange()}send(){this.readyState=4}},rr.onCreate=os,rr.onSend=os,rr),or,NT=(or=class{constructor(){this.onload=os,or.onCreate&&or.onCreate(this)}readAsDataURL(e){this._blob=e,or.onRead&&or.onRead(this)}load(e){this.result=typeof e=="function"?e(this._blob):e,this.onload&&this.onload()}},or.onCreate=os,or.onRead=os,or);function no(){return Ua||{createElementNS:()=>null,createElement:()=>null,implementation:{createDocument(){throw new Error('unable to create XML document; if you use Node JS install the "xmldom" package')}}}}Rp=Hi("@xmldom/xmldom"),Ua=eo?document:Rp?new Rp.DOMImplementation().createDocument():null,xx=typeof XMLHttpRequest<"u"?XMLHttpRequest:LT,wT=typeof FileReader<"u"?FileReader:NT;var SF=class{observe(){}unobserve(){}disconnect(){}},AF=typeof ResizeObserver>"u"?SF:ResizeObserver,MT=t=>new AF(t);function IT(t,e){if(document&&document.defaultView){let s=t.style[e];if((!s||s==="auto")&&no().defaultView){const n=document.defaultView.getComputedStyle(t,null);s=n?n[e]:null}return s==="auto"?null:s?s.toString():null}return null}var kT=class{constructor(){this.onmousewheel=os,this.__dummy=!0,this.style={},this.clientWidth=0,this.clientHeight=0,this.childNodes=[],this.style={width:"0px",height:"0px",top:void 0,left:void 0,position:"",backgroundColor:void 0}}get offsetWidth(){return parseFloat(this.style.width||"0")}get offsetHeight(){return parseFloat(this.style.height||"0")}get firstChild(){return null}get parentNode(){return null}get classList(){return{length:0,value:"",add(){},remove(){},contains:t=>!1,item:null}}get innerHTML(){return""}set innerHTML(t){}appendChild(t){return this.childNodes.push(t),t}removeChild(){}addEventListener(){}removeEventListener(){}insertBefore(){}contains(t){return!1}};function Jg(){return new kT}var mi=Vo?()=>window.devicePixelRatio:()=>1;function RT(t){const e=";base64,";let s,n,i;if(t.indexOf(e)===-1)return s=t.split(","),n=s[0].split(":")[1],i=decodeURIComponent(s[1]),$d(i,n);s=t.split(e),n=s[0].split(":")[1],i=window.atob(s[1]);const r=i.length,o=new Uint8Array(r);for(let a=0;a<r;++a)o[a]=i.charCodeAt(a);return $d([o],n)}var FT=class{constructor(t,e){this.data=t,this.type=e}};function $d(t,e){return typeof Blob<"u"?new Blob(t,{type:e}):new FT(t,e)}function wF(t){return typeof Blob<"u"&&t instanceof Blob||t instanceof FT}function TF(t,e,s="text/plain"){return e==="blob"?t:e==="dataURL"?RT(t):$d([t],s||"text/xml")}function Xo(t,e,s="text",n="text/plain"){if(!If)return t;let i=null,r=null,o=null;window.Blob?(i=TF(t,s,n),r=URL.createObjectURL(i)):o="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(t);const a=document.createElement("a");return Yw(a,r||o||""),a.setAttribute("download",e),document.body.appendChild(a),a.click(),document.body.removeChild(a),r&&setTimeout((()=>window.URL.revokeObjectURL(r)),0),t}function tf(t,e,s,n=mi()){if(Ga(t,e+"px",s+"px"),t.tagName==="IMG"||t.tagName==="CANVAS"){const i=t;i.width=e*n,i.height=s*n}}function vx(t,e){Cr(e,((s,n)=>{s!==void 0&&t.setAttribute(n,s)}))}var bx="http://www.w3.org/2000/svg",Y_="http://www.w3.org/2000/xmlns/",PT="http://www.w3.org/1999/xlink",CF=1;function ys(t,e){const s=Ua.createElementNS(bx,t);return s.style||(s.style={}),e&&vx(s,e),s}function W_(t){const e=Ua.createElement("div");if(e.innerHTML=t.trim().replace(/\s+/g," "),!e.firstChild||e.firstChild.nodeType!==CF)throw new Error(`Failed to create element from: "${t}". Expected an HTML string`);return e.firstChild}function Ex(t){if(Ua)return Ua.createTextNode(t)}function zT(t){return typeof Image>"u"?Promise.resolve(null):new Promise((e=>{const s=new Image;s.src=t,s.onload=()=>e(s),s.onerror=()=>e(null)}))}function DT(t){if(t.indexOf("http://")===0||t.indexOf("https://")===0)return t;const e=window.location.origin;if(window.location.protocol==="blob:")return t;const s=window.location.pathname,n=s.lastIndexOf("/");return n===-1?e+"/"+t:e+s.substring(0,n)+"/"+t}function fu(t){return new Promise(((e,s)=>{const n=new xx;n.open("GET",DT(t),!0),n.onreadystatechange=function(){if(n.readyState===4){const i=n.status;i===200?e(n.responseText):s(i!==0?new Error(`cannot retrieve file at url "${t}"; the server responded with status code ${i}.`):new Error(`cannot send XMLHttpRequest to url "${t}"; if you're using the local file protocol this is most likely the cause.`))}},n.onerror=function(){s(new Error(`cannot retrieve file at url "${t}"; the XMLHttpRequest failed.`))},n.send()}))}function OT(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function ef(t,e){t.style.cursor=e,t.style.cursor!==e&&(t.style.cursor=`-webkit-${e}`)}function BT(t){return new Promise(((e,s)=>{const n=new xx;n.responseType="blob",n.open("GET",DT(t),!0),n.onreadystatechange=()=>{if(n.readyState===4){if(n.status===200)return e(n.response);s(n.status)}},n.onerror=i=>s(i),n.send()}))}function UT(t){return BT(t).then((e=>new Promise(((s,n)=>{const i=new wT;i.onerror=n,i.onload=()=>s(i.result),i.readAsDataURL(e)}))))}function Bl(t,e=!0){const s=e?"&#13;":`
`;return(""+t).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,s).replace(/[\r\n]/g,s)}var Sx={0:"left",1:"middle",2:"right"};function GT(t){if(t.baseURI)return t.baseURI;const e=t.getElementsByTagName("base");return e.length>0?e[0].href:t.URL||(t.location?t.location.href:"")}function VT(t,e,s,n){return new Promise((i=>{let r=e;const o=Date.now(),a=(s-e)*Math.min(1,1/(n/16));(function l(){Date.now()-o<n?(r=Math.min(1,Math.max(0,r+a)),t.style.opacity=r.toString(),yx(l)):i()})()}))}function Ga(t,e,s){t.style.width=e,t.style.height=s}var Ax=new cR().allowClassAttributes().allowDataAttributes().allowIdAttributes().allowStyleAttributes().build();function Do(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function $i(t,e,s){return Math.max(e,Math.min(s,t))}function X_(t,e,s){return t+(e-t)*s}function bs(t,e,s){return t*(1-s)+e*s}function Ul(t){if(!t.length)return-1/0;let e=t[0];for(let s=1,n=t.length;s<n;++s){const i=t[s];i>e&&(e=i)}return e}function Yr(t){if(!t.length)return 1/0;let e=t[0];for(let s=1,n=t.length;s<n;++s){const i=t[s];i<e&&(e=i)}return e}var jT=(t,e)=>Math.log(t)/Math.log(e),sf=t=>t<-Math.PI?t+2*Math.PI:t>Math.PI?t-2*Math.PI:t;function lE(t,e){t&&e!==void 0&&isFinite(e)&&t.setOpacity&&t.setOpacity(e)}function uE(){return Vo||typeof global<"u"&&!global.process}function Fp(t){return Math.log2(t)+Wg}function LF(t){return 2**(t-Wg)}function dE(t){return t!=null&&!isNaN(t)}function HT(t,e){return qT(t,e,"longitude")}function $T(t,e){return qT(t,e,"latitude")}function qT(t,e,s){if(isNaN(e))throw new TypeError(`node ${t}: ${e} is not a valid ${s}`)}var NF=t=>Math.pow(2,Math.ceil(Math.log2(t)));function MF(t,e){return e==null&&t.url===Aa.tiles.url?UR:null}function IF(t={},e){const{tileUrlSubdomains:s,tileUrlTemplate:n,attribution:i,attributionOptions:r,latitudePath:o,longitudePath:a,sizeRatio:l,tiles:u}=t;if(n!=null&&typeof n!="string")throw new TypeError("Geo mode: tileUrlTemplate must be a URL string");if(s!=null&&typeof s!="string")throw new TypeError("Geo mode: tileUrlTemplate must be a string");if(u!=null){if(!(dn(u)||u instanceof e.Layer))throw new TypeError("Geo mode: tiles must be a object or L.Layer instance");const h=u;if(h.url!=null&&typeof h.url!="string")throw new TypeError("Geo mode: tiles.url must be a string");if(h.subdomains!=null&&typeof h.subdomains!="string")throw new TypeError("Geo mode: tiles.subdomains must be a string");if(h.tms&&typeof h.tms!="boolean")throw new TypeError("Geo mode: tiles.tms must be a boolean");if(h.wms&&typeof h.wms!="boolean")throw new TypeError("Geo mode: tiles.wms must be a boolean")}if(i!=null&&typeof i!="string")throw new TypeError("Geo mode: Map attribution must be a string");if(r!=null&&!dn(r))throw new TypeError("Geo mode: attributionOptions must to be a BrandOptions object");if(o!=null&&typeof o!="string"&&!Array.isArray(o))throw new TypeError("Geo mode: Latitude path must be a valid property path: a string or an array of strings.");if(a!=null&&typeof a!="string"&&!Array.isArray(a))throw new TypeError("Geo mode: Longitude path must be a valid property path: a string or an array of strings.");if(l!=null&&(!isFinite(l)||l<=0))throw new TypeError("Geo mode: sizeRatio must be a positive number.")}function kF(t,e={}){if(e.tiles===void 0||e.tileUrlTemplate||e.tileUrlSubdomains){const s=Aa.tiles;return{...e.tiles||{},...Aa.tiles,url:e.tileUrlTemplate||s.url,subdomains:e.tileUrlSubdomains||s.subdomains}}return dn(e.tiles)?{...t.tiles,...e.tiles}:e.tiles}function RF(t,e){return t.attribution!==e.attribution||t.tiles!==e.tiles}var FF=no().createElement("div");function PF(t){const e=no().createElement("div");e.className="ogma-geo-container",Ga(e,"100%","100%");const s=t||FF;return s.insertBefore(e,s.firstChild),e}function zF(t){const e=[[1/0,1/0],[-1/0,-1/0]];return t.getGeoCoordinates().reduce(((s,{latitude:n,longitude:i})=>{const[r,o]=s;return r[0]=Math.min(r[0],n),r[1]=Math.min(r[1],i),o[0]=Math.max(o[0],n),o[1]=Math.max(o[1],i),s}),e)}function DF(t,e,s,n){const i=e._indexes;t.getNodeAttribute(Ar).setMultiple(i,s),t.getNodeAttribute(wr).setMultiple(i,n)}function OF(t,e,s){const{longitudePath:n,latitudePath:i,wrapCoordinates:r}=s,[o,a]=t.getAttributes(!0,[Ar,wr]),l=e._indexes,u=e.getId(),h=l.length,g=e.getData(i),f=e.getData(n);for(let m=0;m<h;m++){let y=f[m],p=g[m];const x=l[m],v=u[m];p!=null&&y!=null&&(HT(v,y),$T(v,p),r&&(y%=180,p=$i(+p,-B_,B_)),a.set(x,y),o.set(x,p))}}function BF(t,{longitudePath:e,latitudePath:s,wrapCoordinates:n},i){const r=t.getData(e),o=t.getData(s);return r!=null&&o!=null&&(!(!n&&!i)||Math.abs(o)<=B_&&Math.abs(r)<=180)}function Pc(t,e,s,n){UF(t,!0,e,s,n)}function UF(t,e,s,n,i){const r=t.getAttribute(e,n),o=t.getAttribute(e,i),a=s._indexes;o.setMultiple(a,r.getMultiple(a))}function GF(t){return t.reduce(((e,{nodes:s,newValues:n})=>{if(!s)return e;const i=s.filter(((r,o)=>n[o]!=null));return e?e.concat(i):i}),null)}function VF(t,e){return t.getAttributes(["text.minVisibleSize","text.size","text.scale","radius"]).forEach((({text:s,radius:n},i)=>{e[t.get(i).getId()]={"text.minVisibleSize":s.minVisibleSize,"text.size":s.size,"text.scale":s.scale,minVisibleSize:s.minVisibleSize,size:Math.max(1,Number(n))}})),e}function hE(t,e){return t.getAttributes(["text.minVisibleSize","text.size","text.scale","minVisibleSize","width"]).forEach((({text:s,minVisibleSize:n,width:i},r)=>{e[t.get(r).getId()]={"text.minVisibleSize":s.minVisibleSize,"text.size":s.size,"text.scale":s.scale,minVisibleSize:n,size:Math.max(1,Number(i))}})),e}function jF(t,e,s){if(!e||!Object.keys(e).length)return Promise.resolve();const n=t.getId().filter((i=>e[i])).map((i=>{if(!e[i])return 0;const r=Number(e[i]["text.minVisibleSize"]),o=Number(e[i].minVisibleSize),a=Number(e[i]["text.size"]),l=Number(e[i]["text.scale"]),u=Number(e[i].size)*l*s;return u<=o||u<=r?0:a}));return t.setAttribute("text.size",n)}function HF(t,e){const s=t.getId().map((n=>{const i=e[n]||{};return Number(i["text.size"])}));return t.setAttribute("text.size",s)}var $F=t=>xF().rotate([-t.longitude,-t.latitude]).scale(BR),cE=new Uint32Array(1),ji=class{constructor(t,e){this.size=1,this.isNode=!0,this.isList=!1,this._index=t,this._ogma=e}get _indexes(){return cE[0]=this._index,cE}setAttributes(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)}setAttribute(t,e,s){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,s)}resetAttributes(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)}getAttributes(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)[0]}getAttribute(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)[0]}getPosition(){return this.getAttributes(["x","y"])}getPositionOnScreen(){return this._ogma.modules.camera.graphToScreenCoordinates(this.getPosition())}isInScreen(){const t=this.getPositionOnScreen(),e=this._ogma.modules.camera;return t.x>=0&&t.x<=e.width&&t.y>=0&&t.y<=e.height}replaceOriginalAttributes(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)}getPreviousAttributes(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)[0]}getPreviousAttribute(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)}isInView(t){return this._ogma.modules.locate.isElementInView(this,t)}getAdjacentNodes(t){return this._ogma.modules.graph.getAdjacentNodes(this,t)}getAdjacentEdges(t){return this._ogma.modules.graph.getAdjacentEdges(this,t)}getAdjacentElements(t){return{nodes:this._ogma.modules.graph.getAdjacentNodes(this,t).dedupe(),edges:this._ogma.modules.graph.getAdjacentEdges(this,t).dedupe()}}getDegree(t){return this._ogma.modules.graph.getDegree(this,t)[0]}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)}getConnectedComponent(t){return this._ogma.modules.graph.getConnectedComponentByNode(this,t)[0]}isVisible(){return!this.isExcluded()}isExcluded(){return this._ogma.modules.graph.isExcluded(this)[0]}setExcluded(t){return this._ogma.modules.graph.setExcluded(this,t)}setVisible(t){return this.setExcluded(!t)}toList(){return this._ogma.nodeList(new Uint32Array([+this._index]))}getId(){return Rf(this._ogma.modules.graph,this)}slice(){return this.toList()}toJSON(t={}){const{attributes:e,data:s}=mT(t),n=this.getAttributes(e);return{id:this.getId(),attributes:n,data:s(Ws(this.getData()))}}get(t){return t===0?this:void 0}setSelected(t){this._ogma.modules.selection.setActive(this,t)}isSelected(){return this._ogma.modules.selection.areActive(this)}locate(t){return this._ogma.modules.locate.locateElements(this,t)}getBoundingBox({includeTexts:t=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,t,t)}setData(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e),this}getData(t){return this._ogma.modules.data.getProperty(this,t||null)[0]}addClass(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)}addClasses(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)}removeClass(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)}removeClasses(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)}hasClass(t){return this._ogma.modules.classes.hasSingleElementClass(t,this)}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)[0]}getGeoCoordinates(){const t=this._ogma.modules.graph,e=t.getNodeAttribute(Ar).get(this._index),s=t.getNodeAttribute(wr).get(this._index);return{latitude:dE(e)?e:void 0,longitude:dE(s)?s:void 0}}setGeoCoordinates(t){return this.toList().setGeoCoordinates([t]).then((()=>this))}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]}isVirtual(){return this._ogma.modules.transformations.isElementVirtual(this)}getTransformation(){return this._ogma.modules.transformations.getElementTransformation(this)}getMetaNode(){return this._ogma.modules.transformations.getMetaNode(this)}getSubNodes(){return this._ogma.modules.transformations.getSubNodes(this)}pulse(t){return this._ogma.modules.pulses.pulse(this,t)}};Ff([ji],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var io=class{constructor(t,e){this.isList=!0,this.isNode=!0,this._indexes=t,this._ogma=e}get size(){return this._indexes.length}setAttributes(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)}setAttribute(t,e,s){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,s)}getAttributes(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)}getAttribute(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)}resetAttributes(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)}getPosition(){return this.getAttributes(["x","y"])}getPositionOnScreen(){return this.getPosition().map((t=>this._ogma.modules.camera.graphToScreenCoordinates(t)))}replaceOriginalAttributes(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)}getPreviousAttributes(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)}getPreviousAttribute(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)}getAdjacentNodes(t){return this._ogma.modules.graph.getAdjacentNodes(this,t)}getAdjacentEdges(t){return this._ogma.modules.graph.getAdjacentEdges(this,t)}getAdjacentElements(t){return{nodes:this._ogma.modules.graph.getAdjacentNodes(this,t).dedupe(),edges:this._ogma.modules.graph.getAdjacentEdges(this,t).dedupe()}}getDegree(t){return this._ogma.modules.graph.getDegree(this,t)}getConnectedComponents(t){return this._ogma.modules.graph.getConnectedComponents(this,t)}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)}isVisible(){return this.isExcluded().map((t=>!t))}isExcluded(){return this._ogma.modules.graph.isExcluded(this)}isVirtual(){return this.map((t=>this._ogma.modules.transformations.isElementVirtual(t)))}setExcluded(t){return this._ogma.modules.graph.setExcluded(this,t)}setVisible(t){return this.setExcluded(!t)}toList(){return this}toArray(){return dT(this._ogma.modules.graph,this)}clone(){return this._ogma.modules.graph.nodeList(this._indexes.slice())}getId(){return Rf(this._ogma.modules.graph,this)}get(t){return gT(this._ogma.modules.graph,this,t)}forEach(t){Qw(this._ogma.modules.graph,this,t)}find(t){return nT(this._ogma.modules.graph,this,t)}some(t){return sT(this._ogma.modules.graph,this,t)}every(t){return eT(this._ogma.modules.graph,this,t)}map(t){return Jw(this._ogma.modules.graph,this,t)}[Symbol.iterator](){let t=-1;return{next:()=>({value:this.get(++t),done:t>=this.size})}}filter(t){return tT(this._ogma.modules.graph,this,t)}reduce(t,e){return rT(this._ogma.modules.graph,this,t,e)}concat(t){return uT(this._ogma.modules.graph,this,t)}dedupe(){return oT(this._ogma.modules.graph,this)}subtract(t){return aT(this,t,this._ogma.modules.graph)}slice(t,e){return this._ogma.modules.graph.nodeList(this._indexes.slice(t,e))}indexOf(t){return t instanceof ji?this._indexes.indexOf(t._index):-1}includes(t){return this.indexOf(t)!==-1}inverse(){return lT(this._ogma.modules.graph,this)}sort(t){return fT(this._ogma.modules.graph,this,t)}toJSON(t={}){return this.map((e=>e.toJSON(t)))}setSelected(t){this._ogma.modules.selection.setActive(this,t)}isSelected(){return this._ogma.modules.selection.areActive(this)}locate(t){return this._ogma.modules.locate.locateElements(this,t)}getBoundingBox({includeTexts:t=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,t,t)}setData(t,e){if(arguments.length<2&&(e=t,t=null),typeof e!="function"&&!Rn(e))throw new Error(`invalid argument ${e}; expected array or function`);return this._ogma.modules.data.setProperty(this,t,e,{dispatch:!0}),this}fillData(t,e){return arguments.length<2&&(e=t,t=null),this._ogma.modules.data.setProperty(this,t,e,{dispatch:!1}),this}getData(t){return this._ogma.modules.data.getProperty(this,t||null)}addClass(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)}addClasses(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)}removeClass(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)}removeClasses(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)}hasClass(t){return this.map((e=>this._ogma.modules.classes.hasSingleElementClass(t,e)))}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)}getGeoCoordinates(){const t=this._ogma.modules.graph,e=new Array(this._indexes.length),s=t.getNodeAttribute(Ar).getMultiple(this._indexes),n=t.getNodeAttribute(wr).getMultiple(this._indexes);for(let i=0,r=this._indexes.length;i<r;i++)e[i]={latitude:s[i],longitude:n[i]};return e}setGeoCoordinates(t){const e=this._ogma.modules.geo,s=this.getId(),n=this._indexes,i=new Array(n.length),r=new Array(n.length);if(t===null&&(t=new Array(n.length).fill(null)),t.length!==n.length)throw new RangeError("You must provide coordinates for each node in the NodeList");for(let l=0,u=n.length;l<u;l++){let{latitude:h,longitude:g}=t[l]||{latitude:void 0,longitude:void 0};const f=s[l];h==null&&g==null?h=g=void 0:($T(f,h),HT(f,g)),i[l]=h,r[l]=g}this.setData(e.latitudePath,i),this.setData(e.longitudePath,r);const{dom:o,graph:a}=this._ogma.modules;return DF(a,this,i,r),this._ogma.modules.geo.isEnabled()?o.afterNextFrame().then((()=>o.afterNextFrame())).then((()=>this)):o.afterNextFrame().then((()=>this))}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)}getMetaNode(){return this._ogma.modules.transformations.getMetaNodes(this)}getSubNodes(){return this.map(this._ogma.modules.transformations.getSubNodes)}pulse(t){return this._ogma.modules.pulses.pulse(this,t)}};function qF(t,e,s,n,i){return mh(t,e,s,!0,[n],i)}function YF(t,e,s,n,i){return mh(t,e,s,!1,[n],i)}function WF(t,e,s,n,i){return mh(t,e,s,!0,n,i)}function XF(t,e,s,n,i){return mh(t,e,s,!1,n,i)}async function mh(t,e,s,n,i,r={}){Array.isArray(i)||i instanceof(n?io:Va)||(i=[i]);const{virtual:o=!1}=r;!o&&e.isRefreshing()&&await new Promise((y=>{s.once("idle",y)}));const a={elementsToRemove:t.getElements(n,i)};t.fireEvent("requestElementsToDelete",a);let{elementsToRemove:l}=a;if(!l.size)return Promise.resolve();l=l.dedupe();const u=t.storage.fetch(n),h=u.getFlexArray("removed");if(l=l.filter((y=>h.get(y._index)===0)),n){const y=l.getAdjacentEdges({filter:"all"});mh(t,e,s,!1,y,r)}const g=l._indexes,f=t.getCacheLists(n),m={virtual:o,[n?"nodes":"edges"]:l};if(t.fireEvent(n?"beforeRemoveNodes":"beforeRemoveEdges",m),f.visible.invalidList(),f.all.invalidList(),f.raw.invalidList(),t.setExcluded(l,!0),h.setMultiple(g,1),!n)for(let y=0;y<g.length;++y)t.topology.removeFromAdjacencyList(g[y]);return u.removeElements(g),t.fireEvent(n?"removeNodes":"removeEdges",m),t.fireEvent(n?"afterRemoveNodes":"afterRemoveEdges",m),Promise.resolve()}Ff([io],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var ZF=class{addNodes(t,e){return this.modules.graph.addNodes(t,e)}addEdges(t,e){return this.modules.graph.addEdges(t,e)}addNode(t,e){return this.modules.graph.addNode(t,e)}addEdge(t,e){return this.modules.graph.addEdge(t,e)}removeNodes(t,e){return WF(this.modules.graph,this.modules.transformations,this.modules.events,t,e)}removeEdges(t,e){return XF(this.modules.graph,this.modules.transformations,this.modules.events,t,e)}removeNode(t,e){return qF(this.modules.graph,this.modules.transformations,this.modules.events,t,e)}removeEdge(t,e){return YF(this.modules.graph,this.modules.transformations,this.modules.events,t,e)}getNodes(t){return this.modules.graph.getNodes(t)}getEdges(t){return this.modules.graph.getEdges(t)}getNode(t){return this.modules.graph.getNode(t)}getEdge(t){return this.modules.graph.getEdge(t)}clearGraph(){this.modules.graph.clear()}setGraph(t,e){return this.modules.graph.clear(),this.addGraph(t,e)}addGraph(t,e){const s=this.modules.graph.getNodes().size===0,n=this.modules.graph.addGraph(t,e);return s?this.modules.locate.locateGraph({padding:30,ignoreZoomLimits:!1,duration:0}).then((()=>n)):n}createNodeList(){return this.getNodes([])}createEdgeList(){return this.getEdges([])}getConnectedComponents(t={}){return this.modules.graph.getConnectedComponents(this.getNodes(t.filter),t)}getConnectedComponentByNode(t,e){const s=this.modules.graph.getNode(t);if(s===void 0)throw new Error(`getComponentByNode: cannot find node ${t}`);return this.modules.graph.getConnectedComponentByNode(s,e)[0]}},wx={};function YT(t,e,s,n,i,r){let o=0;for(let a=0;a<n;a++)for(let l=0;l<n;l++){const u=r[a],h=r[l];if(u!==h){const g=t[u][h]*i,f=1/(g*g);if(f){const m=e[u]-e[h],y=s[u]-s[h];o+=f*Math.pow(g-Math.sqrt(m*m+y*y),2)}}}return o}function WT(t,e,s,n,i,r,o){let a=0;if(i===-1)return 0;for(let l=0;l<n;l++)for(let u=0;u<n;u++){const h=o[l],g=o[u];if(h!==g&&(h===i||g===i)){const f=t[h][g]*r,m=1/(f*f);if(m){const y=e[h]-e[g],p=s[h]-s[g];a+=m*Math.pow(f-Math.sqrt(y*y+p*p),2)}}}return a}function Z_(t,e,s,n,i,r,o,a){o=o||0;let l=0,u=0;for(let h=0;h<n;h++)for(let g=0;g<n;g++){const f=a[h],m=a[g];if(f!==m){const y=t[f][m]*r,p=1/(y*y);if(p){const x=e[f]-e[m],v=s[f]-s[m],b=p*Math.pow(y-Math.sqrt(x*x+v*v),2);l+=b,f!==i&&m!==i||(u+=b)}}}return(1-o)*l+o*u}function K_(t,e,s,n,i,r,o,a,l){o=o||0;const u=e,h=s;(i=i===void 0?-1:i)===-1&&(o=0);const g=e[i],f=s[i];for(let m=0;m<n;m++){const y=a[m],p=l(t[i][m]),x=o/(p*p);if(p===0)continue;let v=0,b=0,S=0;const A=e[y],w=s[y];for(let k=0;k<n;k++){const F=a[k];if(F!==y){const O=t[y][F]*r,j=1/(O*O),V=e[F],Z=s[F];if(j!==0){const at=A-V,mt=w-Z,K=at*at+mt*mt,ut=K<1e-12?0:1/Math.sqrt(K);b+=(1-o)*j*(V+O*(A-V)*ut),S+=(1-o)*j*(Z+O*(w-Z)*ut)}v+=j}}const L=(1-o)*v+x;if(L!==0){const k=A-g,F=w-f;let O=k*k+F*F;O=O<1e-12?0:1/Math.sqrt(O);const j=p===0?0:x*(p*O);u[y]=(b+j*e[y])/L,h[y]=(S+j*s[y])/L}}return{x:u,y:h}}function KF(t,e,s,n,i,r,o,a){o=o||0;const l=e,u=s;let h;(i=i===void 0?-1:i)===-1&&(o=0);for(let g=0;g<n;g++){const f=a[g];let m=0,y=0,p=0;const x=e[f],v=s[f];for(let b=0;b<n;b++){const S=a[b];let A=0;if(S!==f){let w=0;const L=t[f][S]*r,k=1/(L*L);f!==i&&S!==i||(w=k);const F=(1-o)*k+o*w;if(m+=F,k!==0){const O=e[S],j=s[S],V=x-O,Z=v-j,at=V*V+Z*Z;at>1e-6&&(A=1/Math.sqrt(at)),y+=F*(O+L*(x-O)*A),p+=F*(j+L*(v-j)*A)}}}h=m,h!==0&&(l[f]=y/h,u[f]=p/h)}return{x:l,y:u}}function Pf(t=((i,r)=>i-r),e=[],s={},n=(i=>i)){let i=e.length;function r(o){for(;;){const a=2*o+1,l=a+1;let u=o;if(a<i&&t(e[a],e[u])<0&&(u=a),l<i&&t(e[l],e[u])<0&&(u=l),u===o)return o;const h=e[u];e[u]=e[o],e[o]=h,s[n(e[u])]=u,s[n(h)]=o,o=u}}return{get keys(){return s},get size(){return i},heapify:r,pop(){if(i<=0)return;if(i===1)return i--,e[0];const o=e[0];return e[0]=e[i-1],i--,r(0),o},decreaseKey(o,a){for(a!==void 0&&(e[o]=a,s[n(a)]=o);o>0;){const l=o-1>>1;if(!(t(e[l],e[o])>0))break;{const u=e[o];e[o]=e[l],e[l]=u,s[n(e[o])]=o,s[n(u)]=l,o=l}}return o},min:()=>e[0],remove(o){return this.decreaseKey(o,Number.NEGATIVE_INFINITY),this.pop()},push(o){i++;let a=i-1;for(e[a]=o;a>0;){const l=a-1>>1;if(!(t(e[l],e[a])>0))break;{const u=e[a];e[a]=e[l],e[l]=u,s[n(e[a])]=a,s[n(u)]=l,a=l}}return a},empty:()=>i<=0,toArray:()=>e.slice(0,i)}}function Tx({sources:t,targets:e,weights:s,source:n,target:i,undirected:r=!1,indexes:o,N:a}){if(!(a=o?o.length:a)||!isFinite(a)||a===0)throw new Error("Invalid number of nodes "+a);const l=new Float32Array(a),u=new Int32Array(a),h={},g=Number.POSITIVE_INFINITY;if(!s){s=[];for(let p=0;p<a;p++)s[p]=1}if(!o){o=new Uint32Array(a);for(let p=0;p<a;p++)o[p]=p+1}for(let p=0;p<a;p++)l[p]=g,u[p]=-1,h[o[p]]=p;l[h[n]]=0;let f=!1;for(let p=1;p<=a;p++){for(let x=0;x<s.length;x++){const v=t[x],b=e[x],S=h[v],A=h[b];if(S!==void 0&&A!==void 0){const w=s[x];let L=l[S]+w;l[S]!==g&&L<l[A]&&(l[A]=L,u[A]=v,f=!0),r&&(L=l[A]+w,l[A]!==g&&L<l[S]&&(l[S]=L,u[S]=b,f=!0))}}if(!f)break}if(f)for(let p=0;p<s.length;p++){const x=t[p],v=e[p],b=h[x],S=h[v];if(b!==void 0&&S!==void 0){const A=s[p];if(l[b]+A<l[S])return null}}let m=null,y=null;if(i!==void 0){const p=h[i];if(p!==void 0&&l[p]!==g){m=[];for(let x=i;x!==-1;x=u[h[x]])m.push(x);m=m.reverse(),y=l[p]}}return{distances:l,path:m,pathLength:y}}function Cx(t,e,s,n,i,r,o){const a=(n=n||t.map(((x,v)=>v+1))).length,l=new Float32Array(a),u=new Int32Array(a),h=new Uint32Array(a),g=Number.POSITIVE_INFINITY,f={};if(a===0)return{distances:l,path:null,pathLength:null};if(!i){i={};for(let x=0;x<a;x++)i[n[x]]=x}for(let x=0;x<a;x++)l[x]=g,u[x]=-1,h[x]=f[x]=x;const m=Pf(((x,v)=>l[x]-l[v]),h,f);for(l[i[e]]=0,m.decreaseKey(f[i[e]]);m.size!==0;){const x=m.pop(),v=l[x],b=t[x];if(v===g)break;for(let S=0,A=b.nodes.length;S<A;S++){const w=b.nodes[S],L=r?1:o?o(n[x],w):b.weights?b.weights[S]:1,k=i[w];if(k===void 0)continue;const F=v+L;F<l[k]&&(l[k]=F,u[k]=x,m.decreaseKey(f[k]))}}let y=null,p=null;if(s!==void 0){const x=i[s];if(l[x]!==g){y=[];for(let v=x;v!==-1;v=u[v])y.push(n[v]);y.reverse(),p=l[s]}}return{distances:l,path:y,pathLength:p}}function Q_({sources:t,targets:e,weights:s,indexes:n,adjacency:i,undirected:r,ignoreWeights:o}){const a=Number.POSITIVE_INFINITY,l=n?n.length:i.length;if(!n){n=new Uint32Array(l);for(let p=0;p<l;p++)n[p]=p+1}const u=new Array(l),h={};for(let p=0;p<l;p++){u[p]=new Float32Array(l);for(let x=0;x<l;x++)u[p][x]=p===x?0:a;h[n[p]]=p}const g=l,f=s.length;t=t.slice(),e=e.slice(),s=s.slice();for(let p=0;p<l;p++)t[f+p]=g,e[f+p]=n[p],s[f+p]=0,o&&(s[p]=1);const m=Tx({sources:t,targets:e,weights:s,undirected:r,N:l+1,source:g});if(m===null)throw new Error("Graph has negative weight loops");const y=m.distances;for(let p=0;p<s.length;p++){const x=h[t[p]],v=h[e[p]];x!==void 0&&v!==void 0&&(s[p]=s[p]+y[x]-y[v])}t=t.slice(0,f),e=e.slice(0,f),s=s.slice(0,f);for(let p=0;p<l;p++){const x=n[p],{distances:v}=Cx(i,x,void 0,n,h,!!o);for(let b=0;b<l;b++)u[p][b]=p===b?0:v[b]}return u}hh(wx,{CyclesFinder:()=>a2,Quadtree:()=>PP,bellmanFord:()=>Tx,betweenness:()=>u2,circlePack:()=>e2,circleSpread:()=>vP,constrainedStress:()=>Z_,convexhull:()=>yP,detectCyclesDirected:()=>r2,detectCyclesUndirected:()=>DP,detectCyclesUndirectedDFS:()=>OP,dijkstra:()=>Cx,distanceStress:()=>WT,fisheye:()=>s2,johnson:()=>Q_,kruskal:()=>l2,largestEmptyCircle:()=>ZT,minDisk:()=>_h,minHeap:()=>Pf,removeRadialOverlap:()=>ty,stressMinimizationStep:()=>K_,stressMinimizationStepGeneral:()=>KF,weightedStress:()=>YT});var Qr=11102230246251565e-32,Un=134217729,QF=(3+8*Qr)*Qr;function Pp(t,e,s,n,i){let r,o,a,l,u=e[0],h=n[0],g=0,f=0;h>u==h>-u?(r=u,u=e[++g]):(r=h,h=n[++f]);let m=0;if(g<t&&f<s)for(h>u==h>-u?(o=u+r,a=r-(o-u),u=e[++g]):(o=h+r,a=r-(o-h),h=n[++f]),r=o,a!==0&&(i[m++]=a);g<t&&f<s;)h>u==h>-u?(o=r+u,l=o-r,a=r-(o-l)+(u-l),u=e[++g]):(o=r+h,l=o-r,a=r-(o-l)+(h-l),h=n[++f]),r=o,a!==0&&(i[m++]=a);for(;g<t;)o=r+u,l=o-r,a=r-(o-l)+(u-l),u=e[++g],r=o,a!==0&&(i[m++]=a);for(;f<s;)o=r+h,l=o-r,a=r-(o-l)+(h-l),h=n[++f],r=o,a!==0&&(i[m++]=a);return r===0&&m!==0||(i[m++]=r),m}function JF(t,e){let s=e[0];for(let n=1;n<t;n++)s+=e[n];return s}function ph(t){return new Float64Array(t)}var tP=(3+16*Qr)*Qr,eP=(2+12*Qr)*Qr,sP=(9+64*Qr)*Qr*Qr,El=ph(4),gE=ph(8),fE=ph(12),mE=ph(16),Jn=ph(4);function nP(t,e,s,n,i,r,o){let a,l,u,h,g,f,m,y,p,x,v,b,S,A,w,L,k,F;const O=t-i,j=s-i,V=e-r,Z=n-r;A=O*Z,f=Un*O,m=f-(f-O),y=O-m,f=Un*Z,p=f-(f-Z),x=Z-p,w=y*x-(A-m*p-y*p-m*x),L=V*j,f=Un*V,m=f-(f-V),y=V-m,f=Un*j,p=f-(f-j),x=j-p,k=y*x-(L-m*p-y*p-m*x),v=w-k,g=w-v,El[0]=w-(v+g)+(g-k),b=A+v,g=b-A,S=A-(b-g)+(v-g),v=S-L,g=S-v,El[1]=S-(v+g)+(g-L),F=b+v,g=F-b,El[2]=b-(F-g)+(v-g),El[3]=F;let at=JF(4,El),mt=eP*o;if(at>=mt||-at>=mt||(g=t-O,a=t-(O+g)+(g-i),g=s-j,u=s-(j+g)+(g-i),g=e-V,l=e-(V+g)+(g-r),g=n-Z,h=n-(Z+g)+(g-r),a===0&&l===0&&u===0&&h===0)||(mt=sP*o+QF*Math.abs(at),at+=O*h+Z*a-(V*u+j*l),at>=mt||-at>=mt))return at;A=a*Z,f=Un*a,m=f-(f-a),y=a-m,f=Un*Z,p=f-(f-Z),x=Z-p,w=y*x-(A-m*p-y*p-m*x),L=l*j,f=Un*l,m=f-(f-l),y=l-m,f=Un*j,p=f-(f-j),x=j-p,k=y*x-(L-m*p-y*p-m*x),v=w-k,g=w-v,Jn[0]=w-(v+g)+(g-k),b=A+v,g=b-A,S=A-(b-g)+(v-g),v=S-L,g=S-v,Jn[1]=S-(v+g)+(g-L),F=b+v,g=F-b,Jn[2]=b-(F-g)+(v-g),Jn[3]=F;const K=Pp(4,El,4,Jn,gE);A=O*h,f=Un*O,m=f-(f-O),y=O-m,f=Un*h,p=f-(f-h),x=h-p,w=y*x-(A-m*p-y*p-m*x),L=V*u,f=Un*V,m=f-(f-V),y=V-m,f=Un*u,p=f-(f-u),x=u-p,k=y*x-(L-m*p-y*p-m*x),v=w-k,g=w-v,Jn[0]=w-(v+g)+(g-k),b=A+v,g=b-A,S=A-(b-g)+(v-g),v=S-L,g=S-v,Jn[1]=S-(v+g)+(g-L),F=b+v,g=F-b,Jn[2]=b-(F-g)+(v-g),Jn[3]=F;const ut=Pp(K,gE,4,Jn,fE);A=a*h,f=Un*a,m=f-(f-a),y=a-m,f=Un*h,p=f-(f-h),x=h-p,w=y*x-(A-m*p-y*p-m*x),L=l*u,f=Un*l,m=f-(f-l),y=l-m,f=Un*u,p=f-(f-u),x=u-p,k=y*x-(L-m*p-y*p-m*x),v=w-k,g=w-v,Jn[0]=w-(v+g)+(g-k),b=A+v,g=b-A,S=A-(b-g)+(v-g),v=S-L,g=S-v,Jn[1]=S-(v+g)+(g-L),F=b+v,g=F-b,Jn[2]=b-(F-g)+(v-g),Jn[3]=F;const ht=Pp(ut,fE,4,Jn,mE);return mE[ht-1]}function zc(t,e,s,n,i,r){const o=(e-r)*(s-i),a=(t-i)*(n-r),l=o-a,u=Math.abs(o+a);return Math.abs(l)>=tP*u?l:-nP(t,e,s,n,i,r,u)}var pE=Math.pow(2,-52),Dc=new Uint32Array(512),Lx=class XT{static from(e,s=lP,n=uP){const i=e.length,r=new Float64Array(2*i);for(let o=0;o<i;o++){const a=e[o];r[2*o]=s(a),r[2*o+1]=n(a)}return new XT(r)}constructor(e){const s=e.length>>1;if(s>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*s-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(s)),this._hullPrev=new Uint32Array(s),this._hullNext=new Uint32Array(s),this._hullTri=new Uint32Array(s),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(s),this._dists=new Float64Array(s),this.update()}update(){const{coords:e,_hullPrev:s,_hullNext:n,_hullTri:i,_hullHash:r}=this,o=e.length>>1;let a=1/0,l=1/0,u=-1/0,h=-1/0;for(let O=0;O<o;O++){const j=e[2*O],V=e[2*O+1];j<a&&(a=j),V<l&&(l=V),j>u&&(u=j),V>h&&(h=V),this._ids[O]=O}const g=(a+u)/2,f=(l+h)/2;let m,y,p;for(let O=0,j=1/0;O<o;O++){const V=zp(g,f,e[2*O],e[2*O+1]);V<j&&(m=O,j=V)}const x=e[2*m],v=e[2*m+1];for(let O=0,j=1/0;O<o;O++){if(O===m)continue;const V=zp(x,v,e[2*O],e[2*O+1]);V<j&&V>0&&(y=O,j=V)}let b=e[2*y],S=e[2*y+1],A=1/0;for(let O=0;O<o;O++){if(O===m||O===y)continue;const j=oP(x,v,b,S,e[2*O],e[2*O+1]);j<A&&(p=O,A=j)}let w=e[2*p],L=e[2*p+1];if(A===1/0){for(let V=0;V<o;V++)this._dists[V]=e[2*V]-e[0]||e[2*V+1]-e[1];Gl(this._ids,this._dists,0,o-1);const O=new Uint32Array(o);let j=0;for(let V=0,Z=-1/0;V<o;V++){const at=this._ids[V],mt=this._dists[at];mt>Z&&(O[j++]=at,Z=mt)}return this.hull=O.subarray(0,j),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(zc(x,v,b,S,w,L)<0){const O=y,j=b,V=S;y=p,b=w,S=L,p=O,w=j,L=V}const k=aP(x,v,b,S,w,L);this._cx=k.x,this._cy=k.y;for(let O=0;O<o;O++)this._dists[O]=zp(e[2*O],e[2*O+1],k.x,k.y);Gl(this._ids,this._dists,0,o-1),this._hullStart=m;let F=3;n[m]=s[p]=y,n[y]=s[m]=p,n[p]=s[y]=m,i[m]=0,i[y]=1,i[p]=2,r.fill(-1),r[this._hashKey(x,v)]=m,r[this._hashKey(b,S)]=y,r[this._hashKey(w,L)]=p,this.trianglesLen=0,this._addTriangle(m,y,p,-1,-1,-1);for(let O,j,V=0;V<this._ids.length;V++){const Z=this._ids[V],at=e[2*Z],mt=e[2*Z+1];if(V>0&&Math.abs(at-O)<=pE&&Math.abs(mt-j)<=pE||(O=at,j=mt,Z===m||Z===y||Z===p))continue;let K=0;for(let Mt=0,Q=this._hashKey(at,mt);Mt<this._hashSize&&(K=r[(Q+Mt)%this._hashSize],K===-1||K===n[K]);Mt++);K=s[K];let ut,ht=K;for(;ut=n[ht],zc(at,mt,e[2*ht],e[2*ht+1],e[2*ut],e[2*ut+1])>=0;)if(ht=ut,ht===K){ht=-1;break}if(ht===-1)continue;let nt=this._addTriangle(ht,Z,n[ht],-1,-1,i[ht]);i[Z]=this._legalize(nt+2),i[ht]=nt,F++;let ot=n[ht];for(;ut=n[ot],zc(at,mt,e[2*ot],e[2*ot+1],e[2*ut],e[2*ut+1])<0;)nt=this._addTriangle(ot,Z,ut,i[Z],-1,i[ot]),i[Z]=this._legalize(nt+2),n[ot]=ot,F--,ot=ut;if(ht===K)for(;ut=s[ht],zc(at,mt,e[2*ut],e[2*ut+1],e[2*ht],e[2*ht+1])<0;)nt=this._addTriangle(ut,Z,ht,-1,i[ht],i[ut]),this._legalize(nt+2),i[ut]=nt,n[ht]=ht,F--,ht=ut;this._hullStart=s[Z]=ht,n[ht]=s[ot]=Z,n[Z]=ot,r[this._hashKey(at,mt)]=Z,r[this._hashKey(e[2*ht],e[2*ht+1])]=ht}this.hull=new Uint32Array(F);for(let O=0,j=this._hullStart;O<F;O++)this.hull[O]=j,j=n[j];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,s){return Math.floor(iP(e-this._cx,s-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:s,_halfedges:n,coords:i}=this;let r=0,o=0;for(;;){const a=n[e],l=e-e%3;if(o=l+(e+2)%3,a===-1){if(r===0)break;e=Dc[--r];continue}const u=a-a%3,h=l+(e+1)%3,g=u+(a+2)%3,f=s[o],m=s[e],y=s[h],p=s[g];if(rP(i[2*f],i[2*f+1],i[2*m],i[2*m+1],i[2*y],i[2*y+1],i[2*p],i[2*p+1])){s[e]=p,s[a]=f;const x=n[g];if(x===-1){let b=this._hullStart;do{if(this._hullTri[b]===g){this._hullTri[b]=e;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(e,x),this._link(a,n[o]),this._link(o,g);const v=u+(a+1)%3;r<Dc.length&&(Dc[r++]=v)}else{if(r===0)break;e=Dc[--r]}}return o}_link(e,s){this._halfedges[e]=s,s!==-1&&(this._halfedges[s]=e)}_addTriangle(e,s,n,i,r,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=s,this._triangles[a+2]=n,this._link(a,i),this._link(a+1,r),this._link(a+2,o),this.trianglesLen+=3,a}};function iP(t,e){const s=t/(Math.abs(t)+Math.abs(e));return(e>0?3-s:1+s)/4}function zp(t,e,s,n){const i=t-s,r=e-n;return i*i+r*r}function rP(t,e,s,n,i,r,o,a){const l=t-o,u=e-a,h=s-o,g=n-a,f=i-o,m=r-a,y=h*h+g*g,p=f*f+m*m;return l*(g*p-y*m)-u*(h*p-y*f)+(l*l+u*u)*(h*m-g*f)<0}function oP(t,e,s,n,i,r){const o=s-t,a=n-e,l=i-t,u=r-e,h=o*o+a*a,g=l*l+u*u,f=.5/(o*u-a*l),m=(u*h-a*g)*f,y=(o*g-l*h)*f;return m*m+y*y}function aP(t,e,s,n,i,r){const o=s-t,a=n-e,l=i-t,u=r-e,h=o*o+a*a,g=l*l+u*u,f=.5/(o*u-a*l);return{x:t+(u*h-a*g)*f,y:e+(o*g-l*h)*f}}function Gl(t,e,s,n){if(n-s<=20)for(let i=s+1;i<=n;i++){const r=t[i],o=e[r];let a=i-1;for(;a>=s&&e[t[a]]>o;)t[a+1]=t[a--];t[a+1]=r}else{let i=s+1,r=n;Xu(t,s+n>>1,i),e[t[s]]>e[t[n]]&&Xu(t,s,n),e[t[i]]>e[t[n]]&&Xu(t,i,n),e[t[s]]>e[t[i]]&&Xu(t,s,i);const o=t[i],a=e[o];for(;;){do i++;while(e[t[i]]<a);do r--;while(e[t[r]]>a);if(r<i)break;Xu(t,i,r)}t[s+1]=t[r],t[r]=o,n-i+1>=r-s?(Gl(t,e,i,n),Gl(t,e,s,r-1)):(Gl(t,e,s,r-1),Gl(t,e,i,n))}}function Xu(t,e,s){const n=t[e];t[e]=t[s],t[s]=n}function lP(t){return t[0]}function uP(t){return t[1]}function ZT(t,e=1,s=0,n,i){if(!n||!i){const g=t.map((m=>[m.x,m.y])),f=Lx.from(g,(m=>m[0]),(m=>m[1]));n=Gd(f.triangles,g),i=Gd(f.hull,g)}if(!i)return[];const r=s*s,o=[],a={};for(let g=0;g<n.length;g+=3)if(dP(i,Nx(n[g],n[g+1],n[g+2]))){const f=cP(n[g],n[g+1],n[g+2]);f>r&&(o.push(g),a[g]=f)}if(o.length===0)return[];o.sort(((g,f)=>a[g]-a[f]));let l=o[0],u=a[l];const h=[];for(let g=0;g<o.length;g++){const f=o[g],m=a[f];m>u&&m>r&&(l=f,u=m,h.push(l),h.length>e&&h.shift())}return h.map((g=>hP(n[g],n[g+1],n[g+2])))}function dP(t,e){const s=t.length,n=t[s-1],[i,r]=e;let[o,a]=n,l=!1;for(let u=0;u<s;u++){const h=t[u],[g,f]=h;f>r!=a>r&&i<(o-g)*(r-f)/(a-f)+g&&(l=!l),o=g,a=f}return l}function hP(t,e,s){const n=Nx(t,e,s);let i=0;for(let r=0;r<3;r++){const o=arguments[r],a=o[0]-n[0],l=o[1]-n[1],u=Math.sqrt(a*a+l*l);u>i&&(i=u)}return[n[0],n[1],i]}function cP(t,e,s){const[n,i]=Nx(t,e,s),[r,o]=t,a=n-r,l=i-o;return a*a+l*l}function Nx(t,e,s){const n=[(t[0]+e[0])/2,(t[1]+e[1])/2],i=[(e[0]+s[0])/2,(e[1]+s[1])/2],r=-1/((e[1]-t[1])/(e[0]-t[0])),o=-1/((s[1]-e[1])/(s[0]-e[0])),a=n[1]-r*n[0],l=(a-(i[1]-o*i[0]))/(o-r);return[l,r*l+a]}function _h(t,e,s,n){let i;if(n)i=n;else{i=new Uint32Array(t.length);for(let S=0,A=t.length;S<A;S++)i[S]=S}let r=t[i[0]],o=r,a=e[i[0]],l=a;for(let S=1;S<i.length;S++){const A=i[S],w=t[A],L=e[A];w<r&&(r=w),w>o&&(o=w),L<a&&(a=L),L>l&&(l=L)}const u=(r+o)/2,h=(a+l)/2;for(let S=0;S<i.length;S++){const A=i[S];t[A]-=u,e[A]-=h}function g(S,A,w,L,k,F){const O=w-F+1e-9*Math.max(w,F,1),j=L-S,V=k-A;return O>0&&O*O>j*j+V*V}function f(S,A,w,L,k,F,O){for(let j=0;j<L.length;++j){const V=L[j];if(!g(S,A,w,k[V],F[V],O[V]))return!1}return!0}function m(S,A,w,L,k,F){const O=L-S,j=k-A,V=F-w,Z=Math.sqrt(O*O+j*j);return[(S+L+O/Z*V)/2,(A+k+j/Z*V)/2,(Z+w+F)/2]}function y(S,A,w,L,k,F,O,j,V){const Z=(S+L+O)/3,at=(A+k+j)/3,mt=S-Z,K=A-at,ut=L-Z,ht=k-at,nt=O-Z,ot=j-at,Mt=mt-ut,Q=mt-nt,Et=K-ht,qt=K-ot,Vt=F-w,Wt=V-w,oe=mt*mt+K*K-w*w,me=oe-ut*ut-ht*ht+F*F,se=oe-nt*nt-ot*ot+V*V,Jt=Q*Et-Mt*qt,ee=(Et*se-qt*me)/(2*Jt)-mt,ce=(qt*Vt-Et*Wt)/Jt,Ce=(Q*me-Mt*se)/(2*Jt)-K,ve=(Mt*Wt-Q*Vt)/Jt,Me=ce*ce+ve*ve-1,ge=2*(w+ee*ce+Ce*ve),ze=ee*ee+Ce*Ce-w*w,is=-(Math.abs(Me)>1e-6?(ge+Math.sqrt(ge*ge-4*Me*ze))/(2*Me):ze/ge);return[Z+mt+ee+ce*is,at+K+Ce+ve*is,is]}function p(S,A,w,L){switch(S.length){case 1:const k=S[0];return(function(mt,K,ut){return[mt,K,ut]})(A[k],w[k],L[k]);case 2:const[F,O]=S;return m(A[F],w[F],L[F],A[O],w[O],L[O]);case 3:const[j,V,Z]=S;return y(A[j],w[j],L[j],A[V],w[V],L[V],A[Z],w[Z],L[Z]);default:return null}}function x(S,A,w,L,k,F){const O=w-F,j=L-S,V=k-A;return O<0||O*O<j*j+V*V}function v(S,A,w,L,k){const F=w[A],O=L[A],j=k[A];if(f(F,O,j,S,w,L,k))return[A];for(let V=0;V<S.length;++V){const Z=S[V],at=w[Z],mt=L[Z],K=k[Z];if(x(F,O,j,at,mt,K)){const[ut,ht,nt]=m(at,mt,K,F,O,j);if(f(ut,ht,nt,S,w,L,k))return[S[V],A]}}for(let V=0;V<S.length-1;++V)for(let Z=V+1;Z<S.length;++Z){const at=S[V],mt=S[Z],K=w[at],ut=L[at],ht=k[at],nt=w[mt],ot=L[mt],Mt=k[mt],Q=m(K,ut,ht,nt,ot,Mt);if(x(Q[0],Q[1],Q[2],F,O,j)){const Et=m(K,ut,ht,F,O,j);if(x(Et[0],Et[1],Et[2],nt,ot,Mt)){const qt=m(nt,ot,Mt,F,O,j);if(x(qt[0],qt[1],qt[2],K,ut,ht)){const Vt=y(K,ut,ht,nt,ot,Mt,F,O,j);if(f(Vt[0],Vt[1],Vt[2],S,w,L,k))return[at,mt,A]}}}}throw new Error}i=(function(A){for(let w=A.length-1;w>=0;w--){let L=Math.floor(Math.random()*(w+1));L=Math.max(Math.min(L,w),0);const k=A[w];A[w]=A[L],A[L]=k}return A})(i),s=s||new Array(t.length).fill(0);const b=(function(A,w,L,k,F){let O=null,j=[],V=0;for(;V<w;){const Z=A[V];O&&g(O[0],O[1],O[2],L[Z],k[Z],F[Z])?V++:(j=v(j,Z,L,k,F),O=p(j,L,k,F),V=0)}return O})(i,i.length,t,e,s);b[0]+=u,b[1]+=h;for(let S=0;S<i.length;S++){const A=i[S];t[A]+=u,e[A]+=h}return b}var KT=[1/0,1/0,-1/0,-1/0];function nf(t,e,s,n,i,r={x:0,y:0}){const o=Math.cos(i),a=Math.sin(i),l=t-s,u=e-n;return r.x=o*l-a*u+s,r.y=a*l+o*u+n,r}function gP(t,e,s=0,n={x:0,y:0}){return n.x=t.x+s*Math.sin(e),n.y=t.y+s*Math.cos(e),n}var pn=(t,e,s,n)=>Math.hypot(t-s,e-n);function Ig(t,e,s,n){const i=t-s,r=e-n;return i*i+r*r}function QT(t){const e=Math.sqrt(t.x*t.x+t.y*t.y);return t.x/=e,t.y/=e,t}function J_(t){return 180*t/Math.PI}function fP(t){return t*Math.PI/180}function JT(t,e){return t.minX-=e,t.minY-=e,t.maxX+=e,t.maxY+=e,t.width===void 0&&(t.width=t.maxX-t.minX),t.height===void 0&&(t.height=t.maxY-t.minY),t.width+=2*e,t.height+=2*e,t}function Mx(t,e,s,n,i,r){const o=n-t,a=i-e,l=Math.sqrt(o*o+a*a);if(l>s+r||l<Math.abs(s-r))return null;const u=(s*s-r*r+l*l)/(2*l),h=t+o*u/l,g=e+a*u/l,f=Math.sqrt(s*s-u*u),m=f/l*-a,y=o*(f/l);return[[h+m,g+y],[h-m,g-y]]}function Ix(t,e,s,n,i,r){if(t-i>=0&&s-i<0)return 1;if(t-i<0&&s-i>=0)return-1;if(t-i==0&&s-i==0)return e-n>=0||n-r>=0?e-n:n-e;const o=(t-i)*(n-r)-(s-i)*(e-r);return o<0?1:o>0?-1:(t-i)*(t-i)+(e-r)*(e-r)-((s-i)*(s-i)+(n-r)*(n-r))}function mP([t,e,s],n,i){const r=Math.abs(t-n),o=Math.abs(e-i);return r+o<=s||!(r>s||o>s)&&Math.sqrt(r*r+o*o)<s+1e-12}function pP(t,e,s,n){const i=t[0]-e,r=t[1]-s,o=t[2]-n;return i*i+r*r<o*o+1e-6}function kx(t,e,s,n,i,r,o){const a=t-Math.max(n,Math.min(r,t)),l=e-Math.max(i,Math.min(o,e));return a*a+l*l<s*s}function t2(t,e,s,n,i,r,o,a={x:0,y:0}){const l=a||{x:0,y:0};let u,h,g,f;if(s===t){const v=t-i,b=o*o-v*v;if(b<0)return null;const S=Math.sqrt(b);u=t,g=t,h=r+S,f=r-S}else{const v=(n-e)/(s-t),b=e-v*t,S=b-r,A=v*v+1,w=2*(v*S-i),L=w*w-4*A*(i*i+S*S-o*o);if(L<0)return null;const k=-w,F=Math.sqrt(L),O=2*A;u=(k+F)/O,g=(k-F)/O,h=v*u+b,f=v*g+b}const m=t-u,y=e-h,p=t-g,x=e-f;return m*m+y*y<p*p+x*x?(l.x=u,l.y=h):(l.x=g,l.y=f),l}function ty({X:t,Y:e,sizes:s,indexes:n,R:i,center:r,gap:o=0,epsilon:a=.001,maxLoops:l=5,inPlace:u=!0}){const h=n.length,g=r[0],f=r[1];let m=h;u||(t=t.slice(),e=e.slice());const y=Mx,p=Ix,x=n.slice().sort(((j,V)=>p(t[j],e[j],t[V],e[V],g,f))),v=x[h-1],b=t[v],S=e[v];let A=!1;for(let j=0;j<m-1;j++){let V=j%h,Z=(j+1)%h;j===-1&&(V=h-1,Z=0),V=x[V],Z=x[Z];const at=t[V],mt=e[V];let K=t[Z],ut=e[Z];const ht=s[V]+s[Z]+o;let nt=p(at,mt,K,ut,g,f);if(nt===-1&&A&&(nt=1),!(ht>i)){if(nt===1||ht-pn(at,mt,K,ut)>a){const ot=y(g,f,i,at,mt,ht);if(ot){const Mt=ot[0];A=K>g&&Mt[0]<g,K=t[Z]=Mt[0],ut=e[Z]=Mt[1]}}else A=!1;if(j%h==h-2){const ot=x[h-1],Mt=x[0];if(e[ot]>f&&e[Mt]>f&&t[ot]-s[ot]<t[Mt]+s[ot]){let Q=0;for(m=Math.min(h*l,m+h);e[x[ot]]>f&&e[x[0]]>f&&t[x[ot]]<t[x[0]]&&++Q<h;){const Et=x.pop();Et&&x.unshift(Et)}}}}}const w=b-g,L=S-f,k=t[v]-g,F=e[v]-f,O=w===k?0:Math.abs(Math.acos((w*k+L*F)/(Math.sqrt(w*w+L*L)*Math.sqrt(k*k+F*F))));if(O!==0){const j=Math.sin(-O),V=Math.cos(-O);let Z;for(let at=0;at<h;at++){Z=x[at];const mt=t[Z]-g,K=e[Z]-f;t[Z]=mt*V-K*j+g,e[Z]=mt*j+K*V+f}}return{X:t,Y:e}}function _E(t,e,s,n,i,r){const o={},a=s[t];let l=a,u=0;const h=a*i;for(const g in e){const f=e[g];let m=0,y=0;for(let b=0,S=f.length;b<S;b++){const A=s[f[b]];y=Math.max(y,A),m+=2*A+n}const p=m/(2*Math.PI),x=y+l,v=r?u+Math.max(r,x):u*i;u=Math.max(x,u,p,h,v),o[g]=u,l=y}return o[0]=0,o[Number.POSITIVE_INFINITY]=u,o}function _P(t,e,s){return(e[0]-t[0])*(s[1]-t[1])-(e[1]-t[1])*(s[0]-t[0])}function yE(t){const e=t.length,s=[0,1];let n=2;for(let i=2;i<e;i++){for(;n>1&&_P(t[s[n-2]],t[s[n-1]],t[i])<=0;)--n;s[n++]=i}return s.slice(0,n)}function yP(t){const e=t.length;if(e<3)return null;const s=new Array(e),n=new Array(e);for(let g=0;g<e;g++)s[g]=[+t[g][0],+t[g][1],g];s.sort(((g,f)=>g[0]-f[0]||g[1]-f[1]));for(let g=0;g<e;g++)n[g]=[s[g][0],-s[g][1]];const i=yE(s),r=yE(n),o=r[r.length-1],a=i[i.length-1],l=r[0]===i[0],u=o===a?1:0,h=[];for(let g=i.length-1;g>=0;--g)h.push(t[s[i[g]][2]]);for(let g=+l;g<r.length-u;g++)h.push(t[s[r[g]][2]]);return h}var xE=t=>--t*t*t+1,vE=(t,e,s)=>{const n=t-s[0],i=e-s[1];return n*n+i*i},xP=(t,e)=>{let s=1/0,n=-1/0;for(let i=0;i<t.length;i++){const r=t[i],o=e?e[r]:r;s=Math.min(o,s),n=Math.max(o,n)}return{min:s,max:n}};function vP({X:t,Y:e,R:s,center:n,maxSteps:i=1e3,padding:r=5,epsilon:o=1e-9,damping:a=2,pinned:l=-1,indexes:u,onUpdate:h,pushSmallerOut:g=!0}){const f=u?u.length:t.length;let m=u;if(m===void 0){m=new Uint32Array(f);for(let A=0;A<f;A++)m[A]=A}else m=u;if(l!==-1)n=[t[l],e[l]];else if(!n){let A=0,w=0;for(let L=0;L<f;L++)A+=t[m[L]],w+=e[m[L]];n=[A/f,w/f]}const{min:y,max:p}=xP(m,s);function x(A,w){let L=0;for(let j=0;j<f-1;j++)for(let V=j+1;V<f;V++){if(j===V)continue;const Z=m[j],at=m[V],mt=t[Z],K=e[Z],ut=s[Z],ht=t[at],nt=e[at],ot=s[at],Mt=ht-mt,Q=nt-K,Et=ut+ot+r,qt=Mt*Mt+Q*Q;if(qt<Et*Et-A){const Vt=(Et-Math.sqrt(qt))*w,Wt=1/qt,oe=Mt*Wt*Vt,me=Q*Wt*Vt,se=oe*oe+me*me;if(at!==l){const Jt=ut/y;L+=se*Jt,t[at]+=oe*Jt,e[at]+=me*Jt}if(Z!==l){const Jt=ot/y;L+=se*Jt,t[Z]-=oe*Jt,e[Z]-=me*Jt}}}const k=A*a*(1-w),F=n[0],O=n[1];for(let j=0;j<f;j++){const V=m[j];if(V!==l){const Z=t[V],at=e[V],mt=s[V]/p,K=g?k*mt:k,ut=(Z-F)*K,ht=(at-O)*K;L+=ut*ut+ht*ht,t[V]-=ut,e[V]-=ht}}return L}m.sort(((A,w)=>s[w]*vE(t[w],e[w],n)-s[A]*vE(t[A],e[A],n)));let v=0,b=0;const S=xE(1/f);for(let A=0;A<i&&(v=x(S,xE((A+1)/i)),h&&setTimeout((()=>h(t,e))),!(Math.abs(v-b)<o));A++)b=v;return{X:t,Y:e}}var Oc=t=>({data:t,next:null,prev:null});function e2(t,e=0,s=0){const n=t.length;if(n===0)return t;const i=t[0];if(i.x=e,i.y=s,n===1)return t;const r=t[1];if(i.x=e-r.radius,r.x=e+i.radius,r.y=s,n===2)return t;const o=t[2];bE(r,i,o);let a=Oc(i),l=Oc(r),u=Oc(o);a.next=u.prev=l,l.next=a.prev=u,u.next=l.prev=a;t:for(let h=3;h<n;h++){u=Oc(t[h]),bE(a.data,l.data,t[h]);let g=l.next,f=a.prev,m=l.data.radius,y=a.data.radius;do if(m<=y){if(EE(g.data,u.data)){l=g,a.next=l,l.prev=a,--h;continue t}m+=g.data.radius,g=g.next}else{if(EE(f.data,u.data)){a=f,a.next=l,l.prev=a,--h;continue t}y+=f.data.radius,f=f.prev}while(g!==f.next);u.prev=a,u.next=l,a.next=l.prev=l=u;let p=SE(a);for(;(u=u.next)!==l;){const x=SE(u);x<p&&(a=u,p=x)}l=a.next}return t}function bE(t,e,s){const n=t.x-e.x;let i,r;const o=t.y-e.y,a=n*n+o*o;let l,u;a?(r=e.radius+s.radius,r*=r,u=t.radius+s.radius,u*=u,r>u?(i=(a+u-r)/(2*a),l=Math.sqrt(Math.max(0,u/a-i*i)),s.x=t.x-i*n-l*o,s.y=t.y-i*o+l*n):(i=(a+r-u)/(2*a),l=Math.sqrt(Math.max(0,r/a-i*i)),s.x=e.x+i*n-l*o,s.y=e.y+i*o+l*n)):(s.x=e.x+s.radius,s.y=e.y)}var bP=1e-6;function EE(t,e){const s=t.radius+e.radius-bP,n=e.x-t.x,i=e.y-t.y;return s>0&&s*s>n*n+i*i}function SE(t){const e=t.data,s=t.next.data,n=e.radius+s.radius,i=(e.x*s.radius+s.x*e.radius)/n,r=(e.y*s.radius+s.y*e.radius)/n;return i*i+r*r}function EP(t,e,s,n,i){const r=t.get(e),o=t.get(s),a=i.get(r._index)||r.getAttributes(["x","y","r"]),l=i.get(o._index)||o.getAttributes(["x","y","r"]),u=Number(l.radius),h=Number(a.radius),g=pn(a.x,a.y,l.x,l.y),f=g;return n.push({source:e,target:s,weight:f}),g<=h+u+20?1:0}function SP(t){return t%3==2?t-2:t+1}function AP(t,e,s){const n=[],{triangles:i,halfedges:r}=t;for(let o=0;o<i.length;o++)o>r[o]&&EP(e,i[o],i[SP(o)],n,s);return n}var wP=(t,e)=>t.weight-e.weight;function TP(t,e){const s=new Set,n=new Array(t.length),i=[];for(const o of e)n[o.source]||(n[o.source]=[]),n[o.source].push(o),n[o.target]||(n[o.target]=[]),n[o.target].push(o);s.add(0);const r=Pf(wP,n[0]);for(;r.size!==0;){const o=r.pop(),a=s.has(o.source)?s.has(o.target)?null:o.target:o.source;if(a){const l=o.source===a?o.target:o.source,u=a;i.push({source:l,target:u,weight:o.weight}),s.add(a);for(const h of n[a])r.push(h)}}return i}function AE(t,e,s){let n=t.x-e.x,i=t.y-e.y;const r=Math.sqrt(n*n+i*i);n/=r,i/=r;const o=s*n,a=s*i;t.x+=o,t.y+=a}function CP(t,e,s,n,i){const r=new Set;let o={x:0,y:0},a=-1;const l=i.map(((u,h)=>(t===s.get(h)&&(a=h,o={index:h,...u}),{x:u.x,y:u.y,r:u.radius,index:h})));if(s.size<3)return l.map(((u,h)=>{if(h===a)return u;const g=u.x-o.x,f=u.y-o.y,m=Math.sqrt(g*g+f*f),y=e*g/m,p=e*f/m;return{x:u.x+y,y:u.y+p,radius:u.r}}));for(const u of n){const h=l[u.target],g=l[u.source],f=1;g.index===a||r.has(u.source)||(AE(g,o,f*e),r.add(u.source)),h.index===a||r.has(u.target)||(AE(h,o,f*e),r.add(u.target))}return l.map((u=>({x:u.x,y:u.y})))}function s2(t,e,s,n){t.includes(e)||(t=t.concat(e.toList())),n||(n=t.getAttributes(["x","y","radius"]));const i=Lx.from(n||t.getPosition(),(l=>l.x),(l=>l.y)),r=new Map;for(let l=0;l<t.size;l++)r.set(t._indexes[l],n[l]);const o=AP(i,t,r),a=TP(t.toArray(),o);return CP(e,s,t,a,n)}var LP=class{constructor(){this._intersects=null,this._getBounds=null}setBoundsGetter(t){return this._getBounds=t,this}setIntersector(t){return this._intersects=t,this}};function NP(t,e,s,n,i,r,o,a){return t>i&&t<o&&e>r&&e<a||s>i&&s<o&&n>r&&n<a}function Hr(t,e,s,n,i,r,o,a){return n>=r&&e<=a&&s>=i&&t<=o}var Vr=(t,e,s,n,i,r)=>({minX:t,minY:e,maxX:s,maxY:n,leaf:!0,level:r,parent:i,objects:[],final:!1,children:null});function n2(t){const{minX:e,minY:s,maxX:n,maxY:i}=t;return[e,s,n,i]}function gd(t,e,s,n,i,r,o,a){return t>=i&&s<=o&&e>=r&&n<=a}var MP=0,IP=1,kP=2,RP=3;function Bc(t,e,s,n,i,r,o,a){const l=(r+a)/2,u=(e+n)/2;return(t+s)/2<=(i+o)/2?u<=l?MP:IP:u<=l?RP:kP}var FP=t=>t,kl=class extends LP{constructor(t=FP,e=10,s,n=0){super(),this._nodeCapacity=10,this._root=null,this._objects={},this._size=0,this._rootLevel=0,this._maxLevel=30,this._idToCell={},this._nodeCapacity=e,this._root=null,this._getBounds=t,this._rootLevel=n,this._maxLevel=n+30,this._idToCell={},s&&(this._root=Vr(s[0],s[1],s[2],s[3],null,n))}get size(){return this._size}get root(){return this._root}clear(){return this._root=null,this._objects={},this._size=0,this._idToCell={},this._rootLevel=0,this._maxLevel=this._rootLevel+30,this}insert(t,e,s,n,i,r=this._root){if(e||([e,s,n,i]=this._getBounds(t)),this._objects[t])return;if(this._objects[t]=!0,this._size++,!this._root){const m=Math.max(Math.abs(n-e),Math.abs(i-s));return this._root=Vr(e,s,e+m,s+m,null,this._rootLevel),this._idToCell[t]=[this._root],this._root.objects=[t],t}let o,a=[r],l=!1;const u=this._nodeCapacity,h=this._idToCell,g=this._maxLevel;let f;for(;f=a.pop();){o=f;const{minX:m,minY:y,maxX:p,maxY:x}=o;Hr(e,s,n,i,m,y,p,x)&&(o.leaf?o.objects&&(o.objects.length<u||o.final)?(o.objects.push(t),h[t]?h[t].push(o):h[t]=[o],l=!0,(o.level>=g||Math.abs(p-m)<=Math.abs(n-e)||Math.abs(x-y)<=Math.abs(i-s))&&(o.final=!0)):(this.splitNode(o),a.push(o)):a.push.apply(a,o.children))}if(!gd(e,s,n,i,(r=this._root).minX,r.minY,r.maxX,r.maxY)){let m=this._rootLevel;for(;!gd(e,s,n,i,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){r=this._root;const{minX:y,minY:p,maxX:x,maxY:v}=r;let b=y,S=p,A=x,w=v;const L=Math.abs(x-y),k=Math.abs(v-p);if(k===0&&L===0)break;const F=Math.max(L,k);e<y?(b-=F,s<p?S-=F:w+=F):(A+=F,s<p?S-=F:w+=F);const O=Vr(b,S,A,w,null,--m);this.splitNode(O),O.children[Bc(y,p,x,v,b,S,A,w)]=r,this._root=r.parent=O}for(a=[this._root],this._root.level=this._rootLevel;f=a.shift();)if(o=f,!o.leaf)for(let y=0;y<4;y++){const p=o.children[y];p.level=o.level+1,a.push(p)}r=this._root;for(let y=0;y<4;y++){const p=r.children[y];p&&p.leaf&&p.objects&&(p.objects.push(t),h[t]?h[t].push(p):h[t]=[p])}}return l?t:void 0}removeById(t){if(!this._objects[t])return t;this._size--;const e=this._idToCell[t];for(let s=0;s<e.length;s++){const n=e[s].objects||[];for(let i=0,r=n.length;i<r;i++)if(n[i]===t){n.splice(i,1);break}}return delete this._objects[t],delete this._idToCell[t],t}remove(t){const[e,s,n,i]=this._getBounds(t),r=[this._root];let o,a;const l=[];for(;o=r.pop();)if(Hr(e,s,n,i,o.minX,o.minY,o.maxX,o.maxY))if(o.leaf){const u=o.objects||[];for(let h=0,g=u.length;h<g;h++)if(u[h]===t){u.splice(h,1),g===1&&l.push(o);break}}else r.push.apply(r,o.children);if(delete this._idToCell[t],delete this._objects[t],this._size--,l.length)for(;a=l.pop();){let u=a.parent,h=!0;for(;u&&h;){if(!u.leaf){for(let g=0;g<4;g++)if(o=u.children[g],!o.leaf||o.objects&&o.objects.length!==0){h=!1;break}h&&(u.leaf=!0,u.children=[],u.objects=[])}u=u.parent}}return t}splitNode(t){const{minX:e,minY:s,maxX:n,maxY:i}=t,r=(e+n)/2,o=(s+i)/2,a=t.level+1,l=this._idToCell,u=this._maxLevel,h=[Vr(e,s,r,o,t,a),Vr(e,o,r,i,t,a),Vr(r,o,n,i,t,a),Vr(r,s,n,o,t,a)];if(t.objects!==null){const g=t.objects,f=this._getBounds;for(let m=0,y=g.length;m<y;m++){const p=g[m],x=f(p);let v=l[p];for(let b=0;b<4;b++){const S=h[b],{minX:A,minY:w,maxX:L,maxY:k}=S;Hr(x[0],x[1],x[2],x[3],A,w,L,k)&&(S.objects&&S.objects.push(p),(S.level>=u||Math.abs(L-A)<=Math.abs(x[2]-x[0])||Math.abs(k-w)<=Math.abs(x[3]-x[1]))&&(S.final=!0),v?v.push(S):v=[S])}v&&v.splice(v.indexOf(t),1)}}t.children=h,t.objects=null,t.leaf=!1}point(t,e,s){let n=[];const i=[this._root];let r,o,a;const l=this._getBounds;for(;r=i.pop();)if(t>=r.minX&&t<=r.maxX&&e>=r.minY&&e<=r.maxY){if(r.leaf){s&&r.objects&&(n=r.objects);const u=r.objects||[];for(let h=0,g=u.length;h<g;h++)a=u[h],o=l(a),t>=o[0]&&t<=o[2]&&e>=o[1]&&e<=o[3]&&n.push(a);break}i.push.apply(i,r.children)}return n.length?n:null}neigbours(t,e){let s,n=[];const i=[this._root];for(;s=i.pop();)if(t>=s.minX&&t<=s.maxX&&e>=s.minY&&e<=s.maxY){if(s.leaf){n=s.objects;break}i.push.apply(i,s.children)}return n}query(t,e,s,n){const i=[],r=[this._root];let o,a,l;const u=this._getBounds,h={},g=this._intersects;let f;for(;o=r.pop();)if(Hr(t,e,s,n,o.minX,o.minY,o.maxX,o.maxY))if(o.leaf){const m=o.objects||[];for(let y=0,p=m.length;y<p;y++)l=m[y],h[l]||(a=u(l),Hr(t,e,s,n,a[0],a[1],a[2],a[3])&&(g&&!g(l,t,e,s,n)||i.push(l)),h[l]=!0)}else f=Bc(t,e,s,n,o.minX,o.minY,o.maxX,o.maxY),r.push(o.children[(f+3)%4],o.children[(f+2)%4],o.children[(f+1)%4],o.children[f]);return i}traverse(t,e,s,n,i){const r=[],o=[this._root];let a,l,u;const h=this._getBounds,g={},f=this._intersects;let m;for(;a=o.pop();)if(Hr(t,e,s,n,a.minX,a.minY,a.maxX,a.maxY))if(a.leaf){const y=a.objects||[];for(let p=0,x=y.length;p<x;p++)if(u=y[p],!g[u]){if(l=h(u),Hr(t,e,s,n,l[0],l[1],l[2],l[3])&&(!f||f(u,t,e,s,n))&&(r.push(u),i(u)))return r;g[u]=!0}}else m=Bc(t,e,s,n,a.minX,a.minY,a.maxX,a.maxY),o.push(a.children[(m+3)%4],a.children[(m+2)%4],a.children[(m+1)%4],a.children[m]);return r}getOverlaps(){const t=[this._root];let e,s,n;const i=[],r=this._getBounds,o={};for(;e=t.pop();)if(e.leaf){const a=e.objects||[],l=a.length;for(let u=0;u<l;u++)for(let h=0;h<l;h++)if(s=a[u],n=a[h],u!==h&&!o[s+":"+n]&&!o[n+":"+s]){o[s+":"+n]=!0;const g=r(s),f=r(n);Hr(g[0],g[1],g[2],g[3],f[0],f[1],f[2],f[3])&&i.push(s,n)}}else t.push.apply(t,e.children);return i}cover(t,e,s,n){if(this._root===null)return this._root=Vr(t,e,s,n,null,0),this;let i=this._root;if(!gd(t,e,s,n,i.minX,i.minY,i.maxX,i.maxY)){let r=this._rootLevel;for(;!gd(t,e,s,n,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){i=this._root;const{minX:u,minY:h,maxX:g,maxY:f}=i;let m=u,y=h,p=g,x=f;const v=Math.abs(g-u),b=Math.abs(f-h);if(b===0&&v===0)break;const S=Math.max(v,b);t<u?(m-=S,e<h?y-=S:x+=S):(p+=S,e<h?y-=S:x+=S);const A=Vr(m,y,p,x,null,--r);this.splitNode(A),A.children[Bc(u,h,g,f,m,y,p,x)]=i,this._root=i.parent=A}const o=[this._root];let a,l;for(this._root.level=this._rootLevel;a=o.shift();)if(l=a,!l.leaf)for(let u=0;u<4;u++){const h=l.children[u];h.level=l.level+1,o.push(h)}}return this}getAll(){return Object.keys(this._objects).map((t=>Number(t)))}forEach(t,e){const s=[this._root];let n;for(;n=s.pop();)if(n.leaf&&n.objects)for(let i=0,r=n.objects.length;i<r;i++)t.call(e,n.objects[i]);else s.push.apply(s,n.children);return this}getLeafs(){const t=[this._root],e=[];let s;for(;s=t.pop();)s.leaf?e.push(s):t.push.apply(t,s.children);return e}traverseFromRoot(t,e){const s=[this._root];let n;for(;n=s.pop();)t.call(e,n,n.objects)||n.leaf||s.push.apply(s,n.children);return this}update(t,e,s,n,i){return this.remove(t),this.insert(t,e,s,n,i),this}getNodeBounds(t){return n2(t)}};kl.flatAccessor=(t,e)=>s=>{const n=e*s;return t.slice(n,n+e)},kl.inside=gd,kl.intersects=NP,kl.overlaps=Hr,kl.getNodeBBox=n2;var PP=kl;function Rx(t,e,s,n,i){const r=new Array(t.length);for(let o=0;o<e.length;o++){const a=n[e[o]],l=n[s[o]];r[a]=r[a]||[],r[a].push(l),i&&(r[l]=r[l]||[],r[l].push(a))}return r}function qd(t,e){return t[e]===-1?e:qd(t,t[e])}function zP(t,e,s){const n=qd(t,e),i=qd(t,s);t[n]=i}function DP(t,e,s,n=!1){const i=new Int32Array(t.length),r={};for(let o=0;o<t.length;o++)i[o]=-1,r[t[o]]=o;for(let o=0;o<e.length;o++){const a=r[e[o]],l=r[s[o]];if(n&&a===l)return!0;const u=qd(i,a),h=qd(i,l);if(u===h)return!0;zP(i,u,h)}return!1}function i2(t,e,s,n,i,r,o,a){if(n[t]=i,s[t])return!0;if(e[t])return!1;e[t]=1,s[t]=1;const l=r[t];if(l){for(const u of l)if(i2(u,e,s,n,t,r,o,a))return o.push(a[u]),!0}return s[t]=0,!1}function r2(t,e,s){const n=t.length,i=new Uint8Array(n),r=new Uint8Array(n),o=new Int32Array(n),a={};for(let u=0;u<n;u++)a[t[u]]=u;const l=Rx(t,e,s,a,!1);for(let u=0;u<n;u++){const h=[];if(i2(u,i,r,o,-1,l,h,t)&&h.length>1){const g=h[0];for(let f=1;f<h.length;f++)if(h[f]===g){h.length=f;break}return h.push(g),h.reverse()}}return!1}function o2(t,e,s,n,i,r,o){e[t]=1,n[t]=s;const a=i[t];if(a){for(const l of a)if(e[l]){if(l!==s)return n[l]=t,r.push(o[l]),!0}else if(o2(l,e,t,n,i,r,o))return r.push(o[l]),!0}return!1}function OP(t,e,s){const n=t.length,i=new Uint8Array(n),r=new Int32Array(n),o={};for(let l=0;l<n;l++)o[t[l]]=l,r[l]=-1;const a=Rx(t,e,s,o,!0);for(let l=0;l<e.length;l++){const u=o[e[l]],h=o[s[l]];a[u]=a[u]||[],a[u].push(h)}for(let l=0;l<n;l++){const u=l,h=[];if(!i[u]&&o2(u,i,-1,r,a,h,t))return!0}return!1}var a2=class{constructor(t,e,s){this.cycles=[],this.visitedLength=0,this.visitedStack=[],this.stack=[],this.idToIndex={},this.removed={},this.nodes=t,this.visited=new Uint8Array(this.nodes.length);for(let n=0;n<t.length;n++)this.idToIndex[t[n]]=n;this.adjacency=Rx(t,e,s,this.idToIndex)}getCycles(){this.visited=new Uint8Array(this.nodes.length),this.visitedStack=[];for(let t=0;t<this.nodes.length;t++)for(this.backtrack(t,t);this.visitedLength!==0;){const e=this.visitedStack.pop();e!==void 0&&this.visited[e]&&(this.visited[e]=0,this.visitedLength--)}return this.cycles}backtrack(t,e){let s=!1;this.stack.push(e),this.visited[e]||(this.visited[e]=1,this.visitedLength++),this.visitedStack.push(e);const n=this.adjacency[e]||[];for(const i of n)if(this.removed[e]=this.removed[e]||{},!this.removed[e][i]){if(i<t)this.removed[e][i]=!0;else if(i===t){s=!0;const r=[];for(let o=0,a=!1;o<this.stack.length;o++){const l=this.stack[o];t===l&&(a=!0),a&&r.push(this.nodes[l])}this.cycles.push(r)}else if(!this.visited[i]){const r=this.backtrack(t,i);s=s||r}}if(s){let i;do i=this.visitedStack.pop(),this.visited[i]&&(this.visited[i]=0,this.visitedLength--);while(i!==e)}return this.stack.pop(),s}};function BP(){return{index:{},parent:[],count:0}}function UP(t,e){t.index[e]===void 0&&(t.count+=1,t.index[e]=t.parent.push(-t.count))}function wE(t,e){let s=t.index[e];if(s===void 0)return-1;for(;s>=0;)e=s,s=t.parent[s];return e}function GP(t,e,s){t.parent[s]=e,t.count-=1}function VP(t){return t.count<=1}function l2(t,e,s,n,i){i&&e.sort(((a,l)=>i(a)-i(l)));const r=[],o=BP();t.forEach((a=>UP(o,a)));for(let a=0;a<e.length&&!VP(o);a++){const l=wE(o,s(e[a])),u=wE(o,n(e[a]));l!==u&&l>0&&u>0&&(GP(o,l,u),r.push(e[a]))}return r}function u2({adjacency:t,directed:e=!1,normalized:s=!0}){const n=[],i=[],r={},o={},a={},l={};let u;const h=new Array(t.length),g={},f={},m={};for(let b=0;b<t.length;b++){const S=t[b];m[S.id]=S.adj,g[S.id]=!0,f[S.id]=b,e||S.adj.forEach((A=>{g[A]=!0}))}const y=Object.keys(g).map((b=>+b));for(let b=0;b<y.length;b++)h[b]=0;for(let b=0;b<y.length;b++)u=y[b],v(u),x();const p=s?y.length>2?1/((y.length-1)*(y.length-2)):0:e?0:.5;if(p)for(let b=0;b<h.length;b++)h[b]*=p;return h;function x(){for(let b=0;b<y.length;b++)l[y[b]]=0;for(;i.length;){const b=i.pop(),S=(1+l[b])/a[b],A=r[b];for(let w=0;w<A.length;++w){const L=A[w];l[L]+=a[L]*S}b!==u&&(h[f[b]]+=l[b])}}function v(b){for(let S=0;S<y.length;S++){const A=y[S];r[A]=[],o[A]=-1,a[A]=0}for(o[b]=0,a[b]=1,n.push(b);n.length;){const S=n.shift();i.push(S),m[S].forEach((A=>{o[A]===-1&&(o[A]=o[S]+1,n.push(A)),o[A]===o[S]+1&&(a[A]+=a[S],r[A].push(S))}))}}}var d2=class{constructor(t){this._heap=[],this._size=0,this._keyToValue=t,this._keyToIndex=new Int32Array(t.length),this._keyToIndex.fill(-1)}add(t){let e=this._keyToIndex[t];e===-1&&(e=this._size++,this._heap[e]=t),this._keyToIndex[t]=this._bubble(e)}removeMin(){if(this._size===0)return NaN;const t=this._heap[0];return this._heap[0]=this._heap[--this._size],this._bubble(0),t}isEmpty(){return this._size===0}has(t){return this._keyToIndex[t]!==-1}_bubble(t){const e=this._indexToValue(t),s=this._getParentIndex(t),n=this._indexToValue(s);let i=t;if(t!==0&&n>e)i=this._swap(t,s);else{const r=this._getLeftChildIndex(t),o=this._getRightChildIndex(t),a=this._indexToValue(r),l=this._indexToValue(o),u=Math.min(e,a,l);u===e||(i=u===a?this._swap(t,r):this._swap(t,o))}return i===t?t:this._bubble(i)}_indexToValue(t){return t>=this._size?1/0:this._keyToValue[this._heap[t]]}_getParentIndex(t){return(t-1)/2|0}_getLeftChildIndex(t){return 2*t+1}_getRightChildIndex(t){return 2*t+2}_swap(t,e){const s=this._heap[t],n=this._heap[e];return this._heap[t]=n,this._heap[e]=s,this._keyToIndex[s]=e,this._keyToIndex[n]=t,e}},h2=Vo&&!!window.PointerEvent,zf="pointerdown",Df="pointermove",Of="pointerup",yh="pointercancel",ru={},rf=0,c2=t=>t.pointerType==="mouse",g2=t=>t.pointerType!=="mouse";function jP(){if(eo&&rf===0&&h2){const t=document.documentElement;t.addEventListener(zf,f2,!0),t.addEventListener(Df,m2,!0),t.addEventListener(Of,of,!0),t.addEventListener(yh,of,!0)}rf++}function HP(){if(rf--,eo&&rf===0){const t=document.documentElement;t.removeEventListener(zf,f2,!0),t.removeEventListener(Df,m2,!0),t.removeEventListener(Of,of,!0),t.removeEventListener(yh,of,!0)}}function f2(t){ru[t.pointerId]=t}function m2(t){ru[t.pointerId]&&(ru[t.pointerId]=t)}function of(t){delete ru[t.pointerId]}function Bf(t,e){t.touches=[];for(const s in ru)t.touches.push(ru[s]);t.changedTouches=[t],e(t)}function $P(t,e,s){const n=i=>{c2(i)||(g2(i)&&i.preventDefault(),Bf(i,s))};return t(e,zf,n,!1),n}function qP(t,e,s){const n=i=>{g2(i)&&i.preventDefault(),Bf(i,s)};return t(e,yh,n,!1),n}function YP(t,e,s){const n=i=>{c2(i)&&i.buttons===0||Bf(i,s)};return t(e,Df,n,!1),n}function WP(t,e,s){const n=i=>Bf(i,s);return t(e,Of,n,!1),t(e,yh,n,!1),n}function TE(t,e,s,n){return s==="touchstart"?t(e,zf,n,!1):s==="touchmove"?t(e,Df,n,!1):s==="touchend"?(t(e,Of,n,!1),t(e,yh,n,!1)):void 0}var Ke=class{constructor(t){this._ogma=t}_setModules(t){this._modules=t}onMounted(){}onReady(t){}destroy(t){}},XP=["graphics","legend","brand"],Dp=300,Op=300,ZP=200,KP=class extends Ke{constructor(){super(...arguments),this._width=Dp,this._height=Op,this._resizeObserver=MT((()=>this._resize())),this._layers={},this._focus=!1,this._container=null,this._isFullScreen=!1,this._beforeNextFramePromises=[],this._afterNextFramePromises=[],this._onNextFramePromises=[],this._refreshUntil=0,this._currentTime=$n(),this._timeouts=[],this._isDestroyed=!1,this._onDetachDom=[],this._isRealBrowser=If,this._isDocumentReady=kf,this._inFrame=!1,this._mustRefresh=!1,this._nextFrame=null,this._onWindowFocus=()=>this.refresh(),this._onFullscreenChange=()=>{this._isFullScreen=Ld()},this._resize=t=>{if(!this._container&&!t)return;const e=this._width,s=this._height;let n=0,i=0;if(this._container){const r=this._modules.settings.get("minimumWidth"),o=this._modules.settings.get("minimumHeight"),a=this._container.clientWidth||1,l=this._container.clientHeight||1;n=Math.max(r,t?t.width:a),i=Math.max(o,t?t.height:l)}else t&&(n=t.width,i=t.height);n===e&&i===s||(this._width=n,this._height=i,Cr(this._layers,(({element:r,automaticResize:o})=>{o&&tf(r,n,i)})),this._modules.events.fire("resize",{prevWidth:e,prevHeight:s,width:n,height:i,difWidth:n-e,difHeight:i-s}))}}onMounted(){this._modules.settings.register("minimumWidth",Dp,(()=>this._resize()),!1),this._modules.settings.register("minimumHeight",Op,(()=>this._resize()),!1),this._modules.events.register(["beforeNewFrame","frame","afterNewFrame","setContainer","resize"]),this._onDetachDom=[],jP(),this.addWindowEventListener("focus",this._onWindowFocus)}onReady(t){var e,s;t.container&&this.setContainer(t.container),(e=t.options)!=null&&e.width||(s=t.options)!=null&&s.height?this._resize({width:t.options.width||Dp,height:t.options.height||Op}):this._resize()}addWindowEventListener(t,e,s){return this._isRealBrowser&&this.addElementEventListener(window,t,e,s),this}addDirectWindowEventListener(t,e,s){this._isRealBrowser&&window.addEventListener(t,e,s)}removeDirectWindowEventListener(t,e){this._isRealBrowser&&window.removeEventListener(t,e)}addDocumentEventListener(t,e,s){return this._isDocumentReady&&this.addElementEventListener(document.documentElement,t,e,s),e}removeDocumentEventListener(t,e){this._isDocumentReady&&document.documentElement.removeEventListener(t,e)}addMediaListener(t,e){if(this._isDocumentReady&&typeof window.matchMedia=="function"){const s=window.matchMedia(t);s.addListener(e),this._onDetachDom.push((()=>s.removeListener(e)))}}addElementEventListener(t,e,s,n){return this._isDestroyed||(t.addEventListener(e,s,n),this._onDetachDom.push((()=>t.removeEventListener(e,s,n)))),s}detachFromDom(){this._onDetachDom.forEach((t=>t())),this._onDetachDom=[],this._emptyContainer()}setTimeout(t,e=0){const s=setTimeout((()=>{this._timeouts.splice(this._timeouts.indexOf(s),1),t()}),e);return this._timeouts.push(s),s}clearTimeout(t){return t&&(clearTimeout(t),this._timeouts.splice(this._timeouts.indexOf(t),1)),null}clearAllTimeouts(){this._timeouts.forEach(clearTimeout),this._timeouts=[]}stopFrames(){this._isDestroyed=!0,this._nextFrame&&(AT(this._nextFrame),this._nextFrame=null)}isDestroyed(){return this._isDestroyed}getDimensions(){return{width:this._width,height:this._height}}setDimensions(t){this._resize(t)}setLayer(t,e,{automaticResize:s=!1}={}){e?(e._ogmaLayer=t,s&&(e.style.position="absolute",e.style.top="0px",e.style.left="0px",tf(e,this._width,this._height,mi())),this._layers[t]={element:e,automaticResize:s}):e===null&&delete this._layers[t],this._updateContainerContent()}setContainer(t){let e;if(typeof t=="string"){if(e=document.getElementById(t),!e)throw new Error(`unable to find DOM element with id "${t}"`)}else e=t;if(e===this._container)return;e===null&&this._emptyContainer();const s=this._container;this._isFullScreen=!1,this._container&&this._resizeObserver.unobserve(this._container),this._container=e,this._container&&(["fullscreenchange","webkitfullscreenchange"].forEach((n=>{this.addElementEventListener(this._container,n,this._onFullscreenChange)})),this._resizeObserver.observe(this._container)),this._resize(),this._updateContainerContent(),this._modules.events.fire("setContainer",{element:e,prevElement:s})}getContainer(){return this._container}appendElement(t){this._container!==null&&this._container.appendChild(t)}focus(){this._focus=!0}blur(){this._focus=!1}hasFocus(){return this._focus}forceResize(){this._resize()}_beforeOrAfterNextFrame(t){const e=t===1?this._onNextFramePromises:t===2?this._afterNextFramePromises:this._beforeNextFramePromises,s=new Promise((n=>{e.push((()=>(n(void 0),s)))}));return this._refresh(),s}beforeNextFrame(){return this._beforeOrAfterNextFrame(0)}onNextFrame(){return this._beforeOrAfterNextFrame(1)}afterNextFrame(){return this._beforeOrAfterNextFrame(2)}refresh(t){t&&(this._refreshUntil=Math.max(this._refreshUntil,t)),this._refresh()}_emptyContainer(){if(this._container){const t=[];for(let e=0;e<this._container.childNodes.length;++e){const s=this._container.childNodes[e];s._ogmaLayer&&t.push(s)}for(let e=0;e<t.length;++e)this._container.removeChild(t[e])}}_fillContainer(){if(this._container){const t=IT(this._container,"position");t!=="absolute"&&t!=="relative"&&t!=="fixed"&&(this._container.style.position="relative");const e=this._container.firstChild;XP.forEach((s=>{const n=this._layers[s];n&&n.element&&this._container&&this._container.insertBefore(n.element,e)}))}}_updateContainerContent(){this._emptyContainer(),this._fillContainer()}_refresh(){this._inFrame?this._mustRefresh=!0:this._nextFrame||this._isDestroyed||(this._nextFrame=yx((()=>this._playFrame())))}_playFrame(){const t=$n(),e={elapsed:t-this._currentTime},s=this._modules.events,n=Pw([this._beforeNextFramePromises,()=>s.fire("beforeNewFrame",e),()=>s.fire("frame",e),this._onNextFramePromises,()=>s.fire("afterNewFrame",e),this._afterNextFramePromises,()=>{this._inFrame=!1,(this._mustRefresh||t<this._refreshUntil+17)&&(this._mustRefresh=!1,this._refresh())}]);this._inFrame=!0,this._nextFrame=null,this._mustRefresh=!1,this._currentTime=t,this._beforeNextFramePromises=[],this._onNextFramePromises=[],this._afterNextFramePromises=[],n.reduce(((i,r)=>i.then((()=>{if(!this._isDestroyed)return r()}))),Promise.resolve())}isPlayingFrame(){return this._inFrame||!!this._nextFrame}setFullScreen(t){let e=Promise.resolve();return t!==this._isFullScreen?(this._container&&(e=t?QP(this._container):JP()),e.then((()=>new Promise((s=>{this.setTimeout((()=>{this._isFullScreen=Ld(),s(void 0)}),ZP)}))))):e}isFullScreen(){return Ld()}debounceBeforeFrame(t){let e=!1,s=[];const n=()=>{const i=s;e=!1,s=[],t(),i.forEach((r=>r()))};return()=>new Promise((i=>{s.push(i),e||(e=!0,this.beforeNextFrame().then(n))}))}destroy(){this._resizeObserver.disconnect(),HP(),this.detachFromDom(),this.clearAllTimeouts(),this.stopFrames()}};function Ld(){return typeof document<"u"&&!!(document.fullscreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)}function QP(t){return Ld()?Promise.resolve():t.requestFullscreen?t.requestFullscreen():t.requestFullScreen?t.requestFullScreen():t.webkitRequestFullScreen?Promise.resolve(t.webkitRequestFullScreen()):t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen?t.msRequestFullscreen():Promise.resolve()}function JP(){return Ld()?typeof document>"u"?Promise.resolve():document.exitFullscreen?document.exitFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.webkitCancelFullScreen?Promise.resolve(document.webkitCancelFullScreen()):document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():Promise.resolve():Promise.resolve()}var tz=class extends Ke{constructor(){super(...arguments),this._nodeChanges=[],this._edgeChanges=[],this._shouldTriggerEvents=!1}onMounted(){this._nodeDataList=this._modules.graph.createAttribute(!0,{name:"data",storage:"any"},!1),this._edgeDataList=this._modules.graph.createAttribute(!1,{name:"data",storage:"any"},!1),this._nodeList=this._modules.graph.getNodeAttribute("object"),this._edgeList=this._modules.graph.getEdgeAttribute("object"),this._modules.events.register(["setData","updateNodeData","updateEdgeData"]),this._modules.events.on("addNodes",(({nodes:t,objects:e})=>this._onAddElements(t,e))).on("addEdges",(({edges:t,objects:e})=>this._onAddElements(t,e))).on("beforeNewFrame",(()=>{this._shouldTriggerEvents&&(this._shouldTriggerEvents=!1,this._triggerEvents())}))}_onAddElements(t,e){const{isNode:s,size:n,_indexes:i}=t,r=this[s?"_nodeDataList":"_edgeDataList"];for(let o=0;o<n;++o)r.set(i[o],e[o].data)}setProperty(t,e,s,{dispatch:n=!1,virtual:i=!1}={}){this._setDataProperty(t.isNode,t._indexes,e,s,n,i),this._modules.events.fire("setData",{elements:t,virtual:i})}getProperty(t,e){return this._getDataProperty(t.isNode,t._indexes,e)}_setDataProperty(t,e,s,n,i,r){i&&typeof n=="function"&&(i=!1);const o=CE(s),a=typeof n=="function",l=t?this._nodeList:this._edgeList,u=t?this._nodeDataList:this._edgeDataList,h=ez(t?this._nodeChanges:this._edgeChanges,o);for(let g=0;g<e.length;++g){const f=e[g];let m=u.get(f);const y=l.get(f),p=i?n[g]:n;let x,v;if(o===null)x=m,v=a?p(y):p,u.set(f,v);else{m==null&&(m={},u.set(f,m));const b=o.length;for(let S=0;S<b;S++){const A=o[S];let w=m[A];S<b-1?(w==null&&(w={},m[A]=w),m=w):(x=w,v=a?p(y):p,m[A]=v)}}h.indexes.push(f),h.previousValues.push(x),h.newValues.push(v),h.virtual=r}this._scheduleEvents()}_getDataProperty(t,e,s,n){const i=CE(s);n||(n=new Array(e.length));const r=t?this._nodeDataList:this._edgeDataList;for(let o=0;o<e.length;++o){const a=e[o];let l,u=r.get(a);if(i!==null&&i.length)if(u==null)l=void 0;else{const h=i.length;for(let g=0;g<h&&u;++g)l=u=u[i[g]]}else l=u;n[o]=l}return n}_scheduleEvents(){this._shouldTriggerEvents=!0,this._modules.dom.refresh()}_triggerEvents(){const t=this._prepareEvtPayload(!0),e=this._prepareEvtPayload(!1);this._modules.events.fire("updateNodeData",t),this._modules.events.fire("updateEdgeData",e)}_prepareEvtPayload(t){const e=t?this._modules.graph.nodeList:this._modules.graph.edgeList,s=t?"_nodeChanges":"_edgeChanges";let n=[];const i=this[s];this[s]=[];const r=[];for(let o=0;o<i.length;++o){const{indexes:a,property:l,newValues:u,previousValues:h,virtual:g}=i[o];n=n.concat(a||[]),t?r.push({property:l,newValues:u,previousValues:h,virtual:g,nodes:e(a)}):r.push({property:l,newValues:u,previousValues:h,virtual:g,edges:e(a)})}return t?{nodes:e(n).dedupe(),isNode:t,changes:r}:{edges:e(n).dedupe(),isNode:t,changes:r}}};function ez(t,e){for(let n=0;n<t.length;++n){const i=t[n],r=i.property;if(e===null&&r===null)return i;if(e&&r&&r.length===e.length){let o=!0;for(let a=0;a<r.length;++a)if(r[a]!==e[a]){o=!1;break}if(o)return i}}const s={property:e&&e.slice(),indexes:[],previousValues:[],newValues:[],nodes:null,virtual:!1,edges:null};return t.push(s),s}function CE(t){return typeof t=="string"?t.split("."):Rn(t)?t:null}var To=()=>(t,e)=>t[e],Co=()=>(t,e,s)=>{t[e]=s},LE={1:Bp(1),2:Bp(2),4:Bp(4),8:To(),16:To(),32:To(),int8:To(),int16:To(),int32:To(),float:To(),any:To()},NE={1:Up(1),2:Up(2),4:Up(4),8:Co(),16:Co(),32:Co(),int8:Co(),int16:Co(),int32:Co(),float:Co(),any:Co()};function Bp(t){const e=8/t,s=(1<<t)-1;return(n,i)=>n[i/e|0]>>i%e*t&s}function Up(t){const e=8/t,s=Math.pow(2,t)-1;return(n,i,r)=>{const o=i%e*t,a=i/e|0,l=r<<o,u=255-(s-r<<o);n[a]=n[a]&u|l}}function sz(t,e){return t===void 0&&e!=="any"&&e!=="resource"?0:t}var nz={get(t){return this._getArrayElt(this._buffer,t)},set(t,e){this._setArrayElt(this._buffer,t,e)}},iz={get(t){return this._byIndex[this._getArrayElt(this._buffer,t)]},set(t,e){let s=this._byName[e];s===void 0&&(s=this._nextIndex++,this._byIndex.push(e),this._getElementBitSize()>this._elementSize&&this.increaseElementSize(),this._byName[e]=s),this._setArrayElt(this._buffer,t,s)}},rz=0,af=class{constructor(t){this._id=rz++,this._initialized=!1;const e=t.name,s=t.storage,n=t.size||0,i=sz(t.default,s),r=Math.max(8,ME(n+1)),o=s==="resource"?1:s;this._name=e,this._storage=s,this._getArrayElt=LE[o],this._setArrayElt=NE[o],this._elementSize=o,this._nbElements=r,this._fallback=null,this._byName=void 0,this._byIndex=void 0,this._nextIndex=void 0,this._defaultValue=i,this._BASE_VALUE=s==="any"?void 0:0,this._methods=nz,this._initialized=!1,this._buffer=null,s==="resource"&&(this._methods=iz,this._byName=Object.create(null),this._byIndex=[],this._nextIndex=1,this._byName[i]=0,this._byIndex.push(i))}getValues(){return Object.keys(this._byName||{})}getName(){return this._name||""}setDefaultValue(t){this._defaultValue=t,this._storage==="resource"&&(this._byName[t]=0,this._byIndex[0]=t)}get(t){return this._get(t)}set(t,e){this._set(t,e)}_get(t){return this._defaultValue}_set(t,e){e!==this._defaultValue&&(this._initialize(),this._set(t,e))}setFallback(t){this._fallback=t,this.get=this._getWithFallback}_getWithFallback(t){const e=this._get(t);return e===void 0&&this._fallback?this._fallback.get(t):e}_initialize(){this._initialized=!0,this._buffer=Gp(this._nbElements,this._elementSize),this._get=this._methods.get,this._set=this._methods.set,this._storage!=="resource"&&this._defaultValue!==this._BASE_VALUE&&this._reset(0)}grow(t){const e=ME(t+1);if(!(e<=this._nbElements)){if(this._initialized)if(this._elementSize==="any")for(let s=this._nbElements;s<e;++s)this._buffer.push(this._defaultValue);else{const s=Gp(e,this._elementSize);s.set(this._buffer),this._buffer=s,this._storage!=="resource"&&this._defaultValue!==this._BASE_VALUE&&this._reset(this._nbElements)}this._nbElements=e}}increaseElementSize(){const t=this._elementSize;if(typeof t!="number"||t===32)throw new Error("FlexArray: cannot increase element size");const e=2*t,s=LE[e],n=NE[e];if(this._initialized){const i=this._nbElements,r=this._getArrayElt,o=this._buffer,a=Gp(i,e);if(t>=8)a.set(o);else for(let l=0;l<i;++l)n(a,l,r(o,l));this._buffer=a}this._elementSize=e,this._getArrayElt=s,this._setArrayElt=n}buffer(){if(!this._buffer)throw new Error("FlexArray: buffer not instantiated");return this._buffer}elementBitSize(){return this._elementSize}capacity(){return this._nbElements}byteSize(){return this._nbElements*this._elementSize/8}isInitialized(){return this._initialized||this._fallback&&this._fallback.isInitialized()}getMultiple(t,e){const s=t.length;e===void 0&&(e=new Array(s));for(let n=0,i=s;n<i;++n)e[n]=this.get(t[n]);return e}fill(t,e){for(let s=0,n=t.length;s<n;++s)this.set(t[s],e)}setMultiple(t,e,s){if(s||!Array.isArray(e)&&!ArrayBuffer.isView(e))for(let n=0,i=t.length;n<i;++n)this.set(t[n],e);else for(let n=0,i=t.length;n<i;++n)this.set(t[n],e[n])}reset(){return this._initialized&&this._reset(0),this}_reset(t){const e=this._storage==="resource"?0:this._defaultValue;if(this._buffer)if(typeof this._elementSize!="number"||this._elementSize>=8)this._buffer.fill(e,t);else{const s=8/this._elementSize;let n=0;for(let i=0;i<s;++i)n<<=this._elementSize,n+=e;if(t===void 0)this._buffer.fill(n);else{const i=t+(8-t%8);for(let r=t;r<i;++r)this._setArrayElt(this._buffer,r,e);this._buffer.fill(n,i/8)}}}_getElementBitSize(){if(this._nextIndex)return Math.pow(2,Math.ceil(Math.log2(Math.log2(this._nextIndex))))}};function ME(t){let e=2;for(;e<t;)e*=2;return e}function Gp(t,e){return e==="any"?new Array(t):e==="float"?new Float32Array(t):e==="int8"?new Int8Array(t):e==="int16"?new Int16Array(t):e==="int32"?new Int32Array(t):e===32?new Uint32Array(t):e===16?new Uint16Array(t):new Uint8Array(Math.ceil(t/8*e))}var IE=4,p2=class{constructor(){this._buffer=new Uint32Array(IE),this._capacity=IE,this._size=0,this._busy=!1}isBusy(){return this._busy}markBusy(){return this._busy=!0,this}sliceAndReset(){this._busy=!1;const t=this.slice(0,this._size);return this.reset(),t}reset(){return this._size=0,this}reserve(t){return t>this._capacity&&this._setCapacity(Do(t)),this}_setCapacity(t){const e=new Uint32Array(t);e.set(this._buffer),this._buffer=e,this._capacity=t}push(t){return this._size===this._capacity&&this._setCapacity(2*this._capacity),this._buffer[this._size++]=t,this}pushUnchecked(t){return this._buffer[this._size++]=t,this}slice(t=0,e=this._size){return this._buffer.slice(t,e)}getBuffer(){return this._buffer}getLength(){return this._size}getCapacity(){return this._capacity}setLength(t){return this._size=t,this}isEmpty(){return this._size===0}},kE=class{constructor(t){this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._flexArrays=[],this._defaultValues=[],this._flexArraysByName={},this._indexLists=[],this._name=t?"node":"edge",this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._idFlexArray=new af({storage:"int32"}),this._idFlexArray.get=e=>this._indexToId[e],this._idFlexArray.getMultiple=e=>{const s=new Array(e.length);for(let n=0;n<e.length;++n)s[n]=this._indexToId[e[n]];return s},this._flexArraysByName.id=this._idFlexArray}addElements(t){const e=[];for(let s=0,n=t.length;s<n;++s){const i=t[s];let r=this._idToIndex[i];r===void 0&&(r=this._getNextIndex(),this._idToIndex[i]=r,this._indexToId[r]=i),e.push(r)}for(const s of this._flexArrays)s.grow(this._nextIndex);for(const s of this._indexLists)s.reserve(this._nextIndex);return new Uint32Array(e)}removeElements(t){for(let e=0,s=t.length;e<s;++e){const n=t[e],i=this._indexToId[n];i!==void 0&&(delete this._idToIndex[i],this._removeIndex(n))}}clear(){this._idToIndex=Object.create(null),this._indexToId=[void 0],this._nextIndex=1,this._freeIndexes=[];for(const t of this._flexArrays)t.reset();for(const t of this._indexLists)t.reset()}has(t){return this._indexToId[t]!==void 0}getIndex(t,e=!1){const s=this._idToIndex[t];if(s===void 0&&e)throw new Error(`${this._name} id "${t}" not found`);return s}createFlexArray(t,e){const{name:s}=t;if(s&&e&&this._flexArraysByName[s])throw new Error(`${this._name} flexArray "${s}" already exists`);let n=t.default;n===void 0&&t.storage!=="any"&&t.storage!=="resource"&&(n=0);const i=this._nextIndex,r={storage:t.storage,size:i,name:s,default:n};let o;return o=(n===void 0&&t.storage!=="any"&&t.storage,new af(r)),this._flexArrays.push(o),this._defaultValues.push(t.default),s&&e&&(this._flexArraysByName[s]=o),o}getFlexArray(t){return this._flexArraysByName[t]}getAllFlexArrays(){return this._flexArraysByName}createIndexList(){const t=new p2;return t.reserve(this._nextIndex),this._indexLists.push(t),t}getId(t){return this._indexToId[t]}getMaxIndex(){return this._nextIndex-1}_removeIndex(t){this._indexesToBeFreed.push(t)}_getNextIndex(){let t=this._freeIndexes.pop();return t===void 0&&(t=this._nextIndex++),t}freeIndexes(){for(const t of this._indexesToBeFreed)this._indexToId[t]=void 0,this._freeIndexes.push(t);for(let t=0;t<this._flexArrays.length;++t){const e=this._flexArrays[t],s=this._defaultValues[t];for(const n of this._indexesToBeFreed)e.set(n,s)}this._indexesToBeFreed=[]}};function RE(t,e,s={},n={}){const i=Yd(t,e,[s],n);return t.fireEvent("postAddElements",{nodes:e?i:void 0,edges:e?void 0:i,virtual:n&&n.virtual}),i.get(0)}function oz(t,{nodes:e=[],edges:s=[]},n={}){if(t.fireEvent("preAddGraph",{name:"preAddGraph"}),!n.batchSize)return Promise.all([Yd(t,!0,e,n),Yd(t,!1,s,n)]).then((([r,o])=>(t.fireEvent("postAddElements",{nodes:r,edges:o,virtual:n&&n.virtual}),t.fireEvent("postAddGraph",{name:"postAddGraph"}),t.fireEvent("addGraph",{nodes:r,edges:o}),{nodes:r,edges:o})));let i;return lf(t,!0,e,n).then((r=>(i=r,lf(t,!1,s,n)))).then((r=>({nodes:i,edges:r}))).then((r=>(t.fireEvent("postAddGraph",{name:"postAddGraph"}),t.fireEvent("addGraph",{name:"addGraph"}),r)))}function lf(t,e,s,n={}){if(n.batchSize){const i=[];for(let a=0;a<s.length;a+=n.batchSize)i.push(s.slice(a,a+n.batchSize));const r=(a,l)=>{let u;return a.then((h=>(u=h,t.getDom().afterNextFrame()))).then((()=>Yd(t,e,l,n))).then((h=>u.concat(h)))},o=e?t.nodeList():t.edgeList();return i.reduce(r,Promise.resolve(o)).then((a=>(t.fireEvent("postAddElements",{nodes:e?a:void 0,edges:e?void 0:a,virtual:n&&n.virtual}),a)))}return Promise.resolve(Yd(t,e,s,n)).then((i=>(t.fireEvent("postAddElements",{nodes:e?i:void 0,edges:e?void 0:i,virtual:n&&n.virtual}),i)))}function Yd(t,e,s,n){const{virtual:i=!1}=n;t.fireEvent("preAddElements",{name:"preAddElements",objects:s,virtual:i,isNode:e});const r=!!n.ignoreInvalid,o=t.storage.fetch(e),a=[],l=[],u=[],h=[],g=new Set;for(const w of s){if(typeof w!="object"||w===null||Array.isArray(w)){if(r)continue;throw new Error(`${w} is not a valid ${e?"node":"edge"}`)}const L=OR(w.id);if(!o.getIndex(L,!1)&&!g.has(L)){if(!e){const k=w,F=t.getExtremityIndex(L,k.source,0,r),O=t.getExtremityIndex(L,k.target,1,r);if(r&&(!F||!O))continue;u.push(F),h.push(O)}l.push(L),a.push(w),g.add(L)}}const f=o.addElements(l);e?t.topology.allocateNodes(f):t.topology.allocateEdges(f,u,h);const m=o.getFlexArray("object"),y=o.getFlexArray("excluded"),p=o.getFlexArray("removed"),x=o.getFlexArray("virtual"),v=e?t.node:t.edge,b=e?t.nodeList:t.edgeList,S=t.getCacheLists(e),A=b(f);for(let w=0;w<f.length;w++){const L=f[w];m.set(L,v(L))}return y.setMultiple(f,0),p.setMultiple(f,0),x.setMultiple(f,i?1:0),S.visible.invalidList(),S.all.invalidList(),S._all.invalidList(),i||S.raw.invalidList(),A.size!==0&&(e?t.fireEvent("addNodes",{virtual:i,objects:a,nodes:A}):t.fireEvent("addEdges",{virtual:i,objects:a,edges:A})),A}var az=1,lz=2,uz=3,dz=4,hz=5,cz=6,ey="_visible",sy="_data",Nd="_hovered",ny="_hoverExtremityHighlighted",Gs="_selected",iy="_selectionExtremityHighlighted",kg="_dragged",_2="_rewirable",wa="_export",y2="_faded",x2="_transparent",gz="_visual_groups",xh=-1,Uc="in",Gc="out",Vp="both",FE=[Gs,kg,iy,Nd,ny,_2,wa,y2,x2,gz],v2=2,b2=3,fz=3,mz=4,E2=-1,pz=["hover","zoom","panning","rotation","gesture","drag","selection","tooltip","user","interactions","resizing","rewiring","connectNodes","lasso"],PE=(t,e)=>(t+e)*(t+e+1)/2+e;function Zu(t,e){const s=t<e?t:e;return 67108864*s+(t+e-s)}var _z=8,ry=class{constructor(){this._BIG_LIST=255,this._MAX_LIST_SIZE=8,this._capacity=_z,this._buffer=new Uint32Array(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._constList=new Array(this._MAX_LIST_SIZE)}addEntry(t){return t===void 0&&(t=this._nextIndex++),t>=this._capacity&&this._reserve(t+1),this._sizes[t]=0,t}get(t){const e=this._sizes[t],s=this._MAX_LIST_SIZE*t;if(e<=this._MAX_LIST_SIZE){this._constList.length=e;for(let n=0,i=e;n<i;++n)this._constList[n]=this._buffer[s+n];return this._constList}if(e===this._BIG_LIST){const n=this._buffer[s];return this._bigLists[n]}throw new Error(`Table: ${t} out of bounds (${e})`)}size(t){const e=this._sizes[t];return e<=this._MAX_LIST_SIZE?e:this._bigLists[this._buffer[t*this._MAX_LIST_SIZE]].length}sizes(t){const e=this._sizes,s=this._bigLists,n=this._buffer,i=this._MAX_LIST_SIZE,r=t.length,o=new Array(r);for(let a=0;a<r;a++){const l=t[a],u=e[l];o[a]=u<=i?u:s[n[l*i]].length}return o}addTo(t,e){const s=this._sizes[t],n=t*this._MAX_LIST_SIZE;if(s<this._MAX_LIST_SIZE)this._buffer[n+s]=e,this._sizes[t]=s+1;else if(s===this._BIG_LIST){const i=this._buffer[n];this._bigLists[i].push(e)}else{const i=new Array(this._MAX_LIST_SIZE);for(let r=0;r<this._MAX_LIST_SIZE;++r)i[r]=this._buffer[n+r];i.push(e),this._bigLists.push(i),this._sizes[t]=this._BIG_LIST,this._buffer[n]=this._bigLists.length-1}return this}removeFrom(t,e){return this.removeFromAndGetSize(t,e),this}removeFromAndGetSize(t,e){const s=this._MAX_LIST_SIZE*t;let n=this._sizes[t];if(n<=this._MAX_LIST_SIZE){for(let i=s,r=s+n;i<r;++i)if(this._buffer[i]===e)return n-=1,this._buffer[i]=this._buffer[r-1],this._sizes[t]=n,n}else if(n===this._BIG_LIST){const i=this._buffer[s],r=this._bigLists[i],o=r.indexOf(e);if(o!==-1)return r.splice(o,1),r.length}throw new Error('topology: Table: "removeFrom" failed, should not happen')}reserve(t){return this._capacity<t&&this._reserve(t),this}_reserve(t){this._capacity=Math.pow(2,Math.ceil(Math.log2(t))),this._buffer=zE(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=zE(this._sizes,this._capacity)}};function zE(t,e){const s=new t.constructor(e);return s.set(t),s}var Sl=void 0,yz=class{constructor(t){this._neighborTable=new ry,this._parallelTable=new ry,this._parallelEdgesIndex=[],this._hasParallelEdges=new Set,this._fakeDeduper={get:()=>0,set:os,reset(){return this}},this._fakeInvertedDeduper={get:()=>1,set:os,reset(){return this}},this._graph=t,this.nodeDeduper=t.createNodeAttribute({storage:1},!1),this.edgeDeduper=t.createEdgeAttribute({storage:1},!1),this._sourceList=t.getEdgeAttribute("source"),this._targetList=t.getEdgeAttribute("target")}getAdjacentDirections(t){return this._neighborTable.get(t)}getEdgeIndexesInDirection(t){return this._parallelTable.get(t)}allocateNodes(t){this._neighborTable.reserve(t.length);for(let e=0;e<t.length;++e)this._neighborTable.addEntry(t[e])}allocateEdges(t,e,s){this._parallelTable.reserve(Math.floor(t.length/2));for(let n=0;n<t.length;n++){const i=t[n],r=e[n],o=s[n];this._sourceList.set(i,r),this._targetList.set(i,o),this.addToAdjacencyList(i)}}getExtremity(t,e){const s=t?this._sourceList:this._targetList;if(e.isList){const n=this._graph.acquireIndexList(!0);for(let i=0;i<e._indexes.length;i++)n.push(s.get(e._indexes[i]));return this._graph.nodeList(n.sliceAndReset())}return this._graph.getObjectList(!0).get(s.get(e._index))}setExtremities(t,e,s){for(let n=0;n<t.length;++n)this.removeFromAdjacencyList(t[n]);e!==null&&this._sourceList.setMultiple(t,e),s!==null&&this._targetList.setMultiple(t,s);for(let n=0;n<t.length;++n)this.addToAdjacencyList(t[n])}addToAdjacencyList(t){const e=this._sourceList.get(t),s=this._targetList.get(t),n=Zu(e,s);let i=this._parallelEdgesIndex[n];if(i===Sl)i=this._parallelTable.addEntry(),this._parallelEdgesIndex[n]=i,this._neighborTable.addTo(e,i),e!==s&&this._neighborTable.addTo(s,i);else{this._hasParallelEdges.add(t);const r=this._parallelTable.get(+i);if(r)for(const o of r)this._hasParallelEdges.add(o)}this._parallelTable.addTo(i,t)}hasParallelEdges(t){return this._hasParallelEdges.has(t)}removeFromAdjacencyList(t){const e=this._sourceList.get(t),s=this._targetList.get(t),n=Zu(e,s),i=this._parallelEdgesIndex[n];i!==Sl&&this._parallelTable.removeFromAndGetSize(i,t)===0&&(this._neighborTable.removeFrom(e,i),e!==s&&this._neighborTable.removeFrom(s,i),this._parallelEdgesIndex[n]=Sl,this._hasParallelEdges.delete(t))}getParallelEdges(t,e={}){const s=e.filter||"visible",n=this._graph.acquireIndexList(!1),i=this._graph.getFilter(!1,s);for(let r=0;r<t._indexes.length;r++){const o=t._indexes[r],a=Zu(this._sourceList.get(o),this._targetList.get(o)),l=this._parallelEdgesIndex[a];if(l!==Sl){const u=this._parallelTable.get(+l);if(u)for(const h of u)i(h)&&n.push(h)}}return this._graph.edgeList(n.sliceAndReset())}fastGetNodesAdjacentElements(t){const e=this._graph.acquireIndexList(!0),s=this._graph.acquireIndexList(!1),n=this._sourceList,i=this._targetList;for(let r=0;r<t.length;r++){const o=t[r],a=this._neighborTable.get(o);for(const l of a){const u=this._parallelTable.get(l),h=u[0],g=n.get(h),f=i.get(h);if(g!==0&&f!==0){e.push(g+f-o);for(const m of u)s.push(m)}}}return{nodes:this._graph.nodeList(e.sliceAndReset()),edges:this._graph.edgeList(s.sliceAndReset())}}fastGetEdgesAdjacentElements(t){const e=this._graph.acquireIndexList(!0),s=this._graph.acquireIndexList(!1),n=this._sourceList,i=this._targetList;for(let r=0;r<t.length;r++){const o=t[r],a=n.get(o),l=i.get(o),u=Zu(a,l),h=this._parallelEdgesIndex[u];if(h!==Sl){const g=this._parallelTable.get(+h);if(g)for(const f of g)s.push(f)}e.push(a),e.push(l)}return{nodes:this._graph.nodeList(e.sliceAndReset()),edges:this._graph.edgeList(s.sliceAndReset())}}getDeduper(t){return(t?this.nodeDeduper:this.edgeDeduper).reset()}collectAdjacentEdges(t,e,s,n=!1,i=!1){const r=e===Uc,o=!(e===Gc||r||i),a=this._graph.acquireIndexList(!1),l=this._graph.getFilter(!1,s),u=n?this.getDeduper(!1):this._fakeDeduper;let h=this._fakeInvertedDeduper;const g=this._sourceList,f=this._targetList;if(i){h=this.getDeduper(!0);for(let m=0;m<t.length;m++)h.set(t[m],1)}for(let m=0;m<t.length;m++){const y=t[m],p=this._neighborTable.get(y);for(const x of p){const v=this._parallelTable.get(x);if(o)for(const b of v)l(b)&&u.get(b)===0&&(a.push(b),u.set(b,1));else for(const b of v){const S=g.get(b),A=f.get(b),w=S+A-y;r!==(A===y)&&S!==A||!l(b)||u.get(b)!==0||h.get(w)!==1||(a.push(b),u.set(b,1))}}}return a.sliceAndReset()}collectAdjacentNodes(t,e,s,n=!1,i,r){const o=e!==Uc,a=e!==Gc,l=this._graph.acquireIndexList(!0),u=this._graph.getFilter(!1,s),h=n?this.getDeduper(!0):this._fakeDeduper,g=this._sourceList,f=this._targetList;if(i)for(let m=0;m<i.length;m++){const y=i[m];l.push(y),h.set(y,1)}if(r)for(let m=0;m<r.length;m++){const y=r[m];h.set(y,1)}for(let m=0;m<t.length;m++){const y=t[m],p=this._neighborTable.get(y);for(const x of p){const v=this._parallelTable.get(x);for(const b of v)if(u(b)){const S=g.get(b),A=f.get(b),w=S+A-y;if((a&&y===A||o&&y===S)&&h.get(w)===0){l.push(w),h.set(w,1);break}}}}return l.sliceAndReset()}getAdjacentElements(t,e,s={}){const n=s.direction||Vp,i=s.filter||"visible",r=s.policy||"union",o=!!s.bothExtremities;if(t){const a=r==="include-sources"?e:null,l=r==="exclude-sources"?e:null;return this.collectAdjacentNodes(e,n,i,!0,a,l)}return this.collectAdjacentEdges(e,n,i,!0,o)}getEdgesBetweenTwoNodes(t,e){const s=Zu(t,e),n=this._parallelEdgesIndex[s];if(n===Sl)return new Uint32Array;const i=this._parallelTable.get(+n);return new Uint32Array(i)}getConnectedComponents(t,{filter:e="visible",returnIds:s=!1,internalIndexes:n=!1}={}){const i=this._graph,r=[],o={},a=i.acquireIndexList(!0);let l;typeof e=="string"?l=i.getFilter(!0,e):(l=e,e="visible");for(let g=0;g<t.length;g++){const f=t[g];l(f)&&a.push(f)}const u=a.sliceAndReset(),h={filter:e};for(let g=0;g<u.length;g++){const f=u[g];if(!o[f]){const m=[f],y=[];for(;m.length!==0;){const p=m.pop();!o[p]&&l(p)&&(m.push.apply(m,this.getAdjacentElements(!0,new Uint32Array([p]),h)),o[p]=!0,y.push(p))}y.length>0&&r.push(y)}}if(s){const g=i.getNodeAttribute("id");for(let f=0;f<r.length;f++)r[f]=g.getMultiple(r[f])}else if(!n)for(let g=0;g<r.length;g++)r[g]=i.nodeList(new Uint32Array(r[g]));return r}getAdjacencyList({directed:t,ids:e,weight:s,nodes:n}){const i=t?Gc:Vp,r=new Array(n.length),o=this._graph;for(let y=0;y<n.length;++y)r[y]=this.collectAdjacentEdges(new Uint32Array([n[y]]),i,"all");const a=o.getEdgeAttribute("source"),l=o.getEdgeAttribute("target"),u=o.getEdgeAttribute("width"),h=o.getNodeAttribute("id"),g=[],f=typeof s=="number",m=typeof s!="function"&&!f&&!!s;for(let y=0;y<r.length;y++){const p=r[y],x=n[y],v=p.length,b=e?new Array(v):new Uint32Array(v),S=new Array(v);for(let w=0;w<v;w++){const L=p[w],k=a.get(L),F=l.get(L);let O=t||x===k?F:k;if(e&&(O=h.get(O)),b[w]=O,s){if(f&&(S[w]=s),typeof s=="function"){const j=o.getNode(k),V=o.getNode(F);S[w]=s(j,V)}m&&(S[w]=u.get(L)||1)}}const A={nodes:b,id:e?h.get(x):x,...s&&{weights:S}};g.push(A)}return g}degrees(t,e){if(e!==Uc&&e!==Gc)return this._neighborTable.sizes(t);const s=new Array(t.length),n=e===Uc;for(let i=0,r=t.length;i<r;i++)s[i]=this._degree(t[i],n);return s}_degree(t,e){const s=this._neighborTable.get(t),n=this._sourceList,i=this._targetList;let r=0;for(let o=0;o<s.length;++o){const a=this._parallelTable.get(s[o]);for(let l=0;l<a.length;++l){const u=a[l],h=n.get(u),g=i.get(u);if(e&&g===t||!e&&h===t){r+=1;break}}}return r}getDegree(t,e){const{direction:s,filter:n}=this._getDegreeOptions(e),i=new Array(t.length),r=new Uint32Array(1);for(let o=0;o<t.length;++o)r[0]=t[o],i[o]=this.collectAdjacentNodes(r,s,n).length;return i}_getDegreeOptions(t){const e={direction:Vp,filter:"visible"};return typeof t=="string"?e.direction=t:t&&(typeof t.direction=="string"&&(e.direction=t.direction),typeof t.filter=="string"&&(e.filter=t.filter)),e}},xz=class extends Ke{constructor(){super(...arguments),this.storage={nodes:new kE(!0),edges:new kE(!1),fetch(t){return t?this.nodes:this.edges}},this._promisesToResolve=[],this._nodeIndexLists=[],this._edgeIndexLists=[],this._onNewFrame=()=>{this.storage.nodes.freeIndexes(),this.storage.edges.freeIndexes()}}onMounted(){this._modules.events.register(["preAddElements","postAddElements","addNodes","addEdges","preAddGraph","postAddGraph","addGraph","excludedStateChange","clearGraph","afterRemoveNodes","beforeRemoveNodes","requestElementsToDelete","removeNodes","beforeRemoveEdges","afterRemoveEdges","removeEdges"]),[{name:"excluded",storage:1,default:1},{name:"removed",storage:1,default:1},{name:"virtual",storage:1,default:0}].forEach((t=>{this.createNodeAttribute(t,!0),this.createEdgeAttribute(t,!0)})),this.node=this._ogma.node,this.edge=this._ogma.edge,this.nodeList=this._ogma.nodeList,this.edgeList=this._ogma.edgeList,this._nodes=this.createAttribute(!0,{name:"object",storage:"any"},!0),this._edges=this.createAttribute(!1,{name:"object",storage:"any"},!0),this.createAttribute(!1,{name:"source",storage:32},!0),this.createAttribute(!1,{name:"target",storage:32},!0),this._nodeFilters=jb(this.storage.nodes),this._edgeFilters=jb(this.storage.edges),this._initialize(),this._modules.events.on("frame",this._onNewFrame)}onReady(t){if(t.graph){const{nodes:e,edges:s}=t.graph;e&&this.addNodes(e),s&&this.addEdges(s)}}createIndexList(t){return this.storage.fetch(t).createIndexList()}getDom(){return this._modules.dom}acquireIndexList(t){const e=t?this._nodeIndexLists:this._edgeIndexLists;let s=e.find((n=>!n.isBusy()));return s||(s=this.createIndexList(t),e.push(s)),s.markBusy(),s}getObjectList(t){return t?this._nodes:this._edges}getListFactory(t){return t?this.nodeList:this.edgeList}getStorage(t){return t?this.storage.nodes:this.storage.edges}getFilter(t,e){const s=t?this._nodeFilters:this._edgeFilters;return s[e]||s.visible}fireEvent(t,e){this._modules.events.fire(t,e)}getCacheLists(t){return t?this._nodeCacheLists:this._edgeCacheLists}_resolvePromises(){const t=this._promisesToResolve;this._promisesToResolve=[],t.forEach((e=>e()))}_initialize(){this._nodeCacheLists=Hb((()=>this.getNodeMaxIndex()),(()=>this.acquireIndexList(!0)),this._nodeFilters),this._edgeCacheLists=Hb((()=>this.getEdgeMaxIndex()),(()=>this.acquireIndexList(!1)),this._edgeFilters),this.topology=new yz(this),this._resolvePromises()}getNodeMaxIndex(){return this.storage.nodes.getMaxIndex()}getEdgeMaxIndex(){return this.storage.edges.getMaxIndex()}isExcluded(t){return this.storage.fetch(t.isNode).getFlexArray("excluded").getMultiple(t._indexes)}setExcluded(t,e){const s=e?1:0,n=t.isNode,i=this.storage.fetch(n),r=i.getFlexArray("excluded"),o=i.getFlexArray("removed"),a=this.acquireIndexList(n),l=this.getListFactory(n);for(let h=0;h<t._indexes.length;h++){const g=t._indexes[h],f=r.get(g),m=o.get(g);s!==f&&m===0&&a.push(g)}const u=a.sliceAndReset();if(u.length){this.getCacheLists(t.isNode).visible.invalidList();const h=l(u);r.setMultiple(u,s),this._modules.events.fire("excludedStateChange",{elements:h,value:e})}}addNode(t,e){return RE(this,!0,t,e)}addEdge(t,e){return RE(this,!1,t,e)}addNodes(t,e){return lf(this,!0,t,e)}addEdges(t,e){return lf(this,!1,t,e)}addGraph(t,e){return oz(this,t,e)}getExtremityIndex(t,e,s,n){if(e instanceof ji)return e._index;{const i=this.storage.nodes.getIndex(e);if(!i&&!n)throw new Error(`addEdge(s): invalid ${s===0?"source":"target"} for edge "${t}"; node "${e}" does not exist`);return i}}getNodes(t){return this.getElements(!0,t)}getEdges(t){return this.getElements(!1,t)}getElements(t,e){const s=t?this.nodeList:this.edgeList,n=t?io:Va,i=t?ji:so;if(e&&typeof e!="string"){const r=this.acquireIndexList(t),o=this.storage.fetch(t);if(e instanceof i)r.push(e._index);else if(Rn(e)){const a=e;for(const l of a)if(l instanceof i)r.push(l._index);else{const u=o.getIndex(l);u&&r.push(u)}}else if(e instanceof n){const a=this.getFilter(t,"all"),l=e;for(let u=0;u<l._indexes.length;u++){const h=l._indexes[u];a(h)&&r.push(h)}}return s(r.sliceAndReset())}{const r=e||"visible",o=this.getCacheLists(t)[r];if(!o)throw new Error(`getNodes/getEdges: unexpected argument "${r}"`);return s(o.getList())}}getNode(t){return this._getElement(!0,t)}getEdge(t){return this._getElement(!1,t)}_getElement(t,e){if(e instanceof(t?ji:so))return e;const s=this.getStorage(t),n=this.getObjectList(t),i=s.getIndex(e);return i?n.get(i):void 0}clear(){this._modules.events.fire("clearGraph",{nodes:this.getNodes("all"),edges:this.getEdges("all")}),this.storage.nodes.clear(),this.storage.edges.clear(),this._initialize()}createAttribute(t,e,s=!1){return this.storage.fetch(t).createFlexArray(e,s)}createNodeAttribute(t,e){return this.createAttribute(!0,t,e)}createEdgeAttribute(t,e){return this.createAttribute(!1,t,e)}getAttribute(t,e){return this.storage.fetch(t).getFlexArray(e)}getAttributes(t,e){return e.map((s=>this.getAttribute(t,s)))}getNodeAttribute(t){return this.storage.nodes.getFlexArray(t)}getNodeAttributes(t){return this.getAttributes(!0,t)}getEdgeAttribute(t){return this.storage.edges.getFlexArray(t)}getEdgeAttributes(t){return this.getAttributes(!1,t)}getAllNodeAttributes(){return this.storage.nodes.getAllFlexArrays()}getAllEdgeAttributes(){return this.storage.edges.getAllFlexArrays()}setSource(t,e){const s=this.getNode(e);s&&this.topology.setExtremities(t._indexes,s._indexes,null)}setTarget(t,e){const s=this.getNode(e);s&&this.topology.setExtremities(t._indexes,null,s._indexes)}getParallelEdges(t,e={}){return this.topology.getParallelEdges(t,e)}hasParallelEdges(t){return this.topology.hasParallelEdges(t._index)}getEdgesBetweenTwoNodes(t,e){return this.edgeList(this.topology.getEdgesBetweenTwoNodes(t._index,e._index))}getAdjacentDirections(t){return this.topology.getAdjacentDirections(t)}getEdgeIndexesInDirection(t){return this.topology.getEdgeIndexesInDirection(t)}fastGetNodesAdjacentElements(t){const e=this._ogma.getNodes();let s=!1;if(e.size===t.size){const n=new Set(t._indexes);for(let i=0;i<e.size;i++)n.delete(e._indexes[i]);s=n.size===0}return s?{nodes:e,edges:this._ogma.getEdges()}:this.topology.fastGetNodesAdjacentElements(t._indexes)}fastGetEdgesAdjacentElements(t){const e=this._ogma.getEdges();let s=!1;if(e.size===t.size){const n=new Set(t._indexes);for(let i=0;i<e.size;i++)n.delete(e._indexes[i]);s=n.size===0}return s?{nodes:this._ogma.getNodes(),edges:e}:this.topology.fastGetEdgesAdjacentElements(t._indexes)}getAdjacentNodes(t,e){return this.nodeList(this.topology.getAdjacentElements(!0,t._indexes,e))}getAdjacentEdges(t,e){return this.edgeList(this.topology.getAdjacentElements(!1,t._indexes,e))}getDegree(t,e){return this.topology.getDegree(t._indexes,e)}degrees(t,e){return this.topology.degrees(t,e)}getAdjacencyList({directed:t=!1,internalIndexes:e=!1,weight:s=1,nodes:n,indexes:i}={}){return this.topology.getAdjacencyList({directed:t,weight:s,ids:!e,nodes:i||this.getNodes(n)._indexes})}getConnectedComponents(t,e){return this.topology.getConnectedComponents(t._indexes,e)}getConnectedComponentByNode(t,e){return this.topology.getConnectedComponents(t._indexes,e)}},Fx=512,Px=128,S2=Math.round(Math.log2(Fx)),zx=Math.round(Math.log2(Px)),vz=S2+zx,Vl=255,bz=32767,A2=65535,Vc=16384,oy=15,jl=3,uf=15,Rg=32,Po=128,ay=8,ly=1/16,uy=Math.round(Math.sqrt(uf+1)),dy=Po*uy,Hn=16,jo=1,nr=256,Ez=128,Sz=128,df=1.5,w2=1,ou=56,Az=16,wz=2*ou+Az,Fg=6,T2=3,C2=3,fi=41,Uf=5,hf=5,L2=.9721,Wd=24,Tz=1.4142,Cz=/^rgba?\((\d+),?\s*(\d+),?\s*(\d+),?\s*((\d+)?\.?\d+)*\)$/;function Dx(t,e=[0,0,0,0]){const s=Cz.exec(t);return s?(e[0]=parseInt(s[1])/255,e[1]=parseInt(s[2])/255,e[2]=parseInt(s[3])/255,e[3]=s[4]===void 0?1:parseFloat(s[4]),e):null}function Pg(t){return t<16?"0"+t.toString(16):t.toString(16)}function N2([t,e,s,n=1]){return`rgba(${256*t|0},${256*e|0},${256*s|0},${n})`}function Ox(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((s,n,i,r)=>n+n+i+i+r+r));const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255,1]:null}var jp=["AliceBlue","#F0F8FF","AntiqueWhite","#FAEBD7","Aqua","#00FFFF","Aquamarine","#7FFFD4","Azure","#F0FFFF","Beige","#F5F5DC","Bisque","#FFE4C4","Black","#000000","BlanchedAlmond","#FFEBCD","Blue","#0000FF","BlueViolet","#8A2BE2","Brown","#A52A2A","BurlyWood","#DEB887","CadetBlue","#5F9EA0","Chartreuse","#7FFF00","Chocolate","#D2691E","Coral","#FF7F50","CornflowerBlue","#6495ED","Cornsilk","#FFF8DC","Crimson","#DC143C","Cyan","#00FFFF","DarkBlue","#00008B","DarkCyan","#008B8B","DarkGoldenRod","#B8860B","DarkGray","#A9A9A9","DarkGrey","#A9A9A9","DarkGreen","#006400","DarkKhaki","#BDB76B","DarkMagenta","#8B008B","DarkOliveGreen","#556B2F","DarkOrange","#FF8C00","DarkOrchid","#9932CC","DarkRed","#8B0000","DarkSalmon","#E9967A","DarkSeaGreen","#8FBC8F","DarkSlateBlue","#483D8B","DarkSlateGray","#2F4F4F","DarkSlateGrey","#2F4F4F","DarkTurquoise","#00CED1","DarkViolet","#9400D3","DeepPink","#FF1493","DeepSkyBlue","#00BFFF","DimGray","#696969","DimGrey","#696969","DodgerBlue","#1E90FF","FireBrick","#B22222","FloralWhite","#FFFAF0","ForestGreen","#228B22","Fuchsia","#FF00FF","Gainsboro","#DCDCDC","GhostWhite","#F8F8FF","Gold","#FFD700","GoldenRod","#DAA520","Gray","#808080","Grey","#808080","Green","#008000","GreenYellow","#ADFF2F","HoneyDew","#F0FFF0","HotPink","#FF69B4","IndianRed","#CD5C5C","Indigo","#4B0082","Ivory","#FFFFF0","Khaki","#F0E68C","Lavender","#E6E6FA","LavenderBlush","#FFF0F5","LawnGreen","#7CFC00","LemonChiffon","#FFFACD","LightBlue","#ADD8E6","LightCoral","#F08080","LightCyan","#E0FFFF","LightGoldenRodYellow","#FAFAD2","LightGray","#D3D3D3","LightGrey","#D3D3D3","LightGreen","#90EE90","LightPink","#FFB6C1","LightSalmon","#FFA07A","LightSeaGreen","#20B2AA","LightSkyBlue","#87CEFA","LightSlateGray","#778899","LightSlateGrey","#778899","LightSteelBlue","#B0C4DE","LightYellow","#FFFFE0","Lime","#00FF00","LimeGreen","#32CD32","Linen","#FAF0E6","Magenta","#FF00FF","Maroon","#800000","MediumAquaMarine","#66CDAA","MediumBlue","#0000CD","MediumOrchid","#BA55D3","MediumPurple","#9370DB","MediumSeaGreen","#3CB371","MediumSlateBlue","#7B68EE","MediumSpringGreen","#00FA9A","MediumTurquoise","#48D1CC","MediumVioletRed","#C71585","MidnightBlue","#191970","MintCream","#F5FFFA","MistyRose","#FFE4E1","Moccasin","#FFE4B5","NavajoWhite","#FFDEAD","Navy","#000080","OldLace","#FDF5E6","Olive","#808000","OliveDrab","#6B8E23","Orange","#FFA500","OrangeRed","#FF4500","Orchid","#DA70D6","PaleGoldenRod","#EEE8AA","PaleGreen","#98FB98","PaleTurquoise","#AFEEEE","PaleVioletRed","#DB7093","PapayaWhip","#FFEFD5","PeachPuff","#FFDAB9","Peru","#CD853F","Pink","#FFC0CB","Plum","#DDA0DD","PowderBlue","#B0E0E6","Purple","#800080","RebeccaPurple","#663399","Red","#FF0000","RosyBrown","#BC8F8F","RoyalBlue","#4169E1","SaddleBrown","#8B4513","Salmon","#FA8072","SandyBrown","#F4A460","SeaGreen","#2E8B57","SeaShell","#FFF5EE","Sienna","#A0522D","Silver","#C0C0C0","SkyBlue","#87CEEB","SlateBlue","#6A5ACD","SlateGray","#708090","SlateGrey","#708090","Snow","#FFFAFA","SpringGreen","#00FF7F","SteelBlue","#4682B4","Tan","#D2B48C","Teal","#008080","Thistle","#D8BFD8","Tomato","#FF6347","Turquoise","#40E0D0","Violet","#EE82EE","Wheat","#F5DEB3","White","#FFFFFF","WhiteSmoke","#F5F5F5","Yellow","#FFFF00","YellowGreen","#9ACD32"],Ku=[0,0,0,0],Xd=new Map;Xd.set(null,[0,0,0,0]),Xd.set("transparent",[0,0,0,0]);for(let t=0;t<jp.length;t+=2){const e=jp[t].toLowerCase(),s=jp[t+1];Xd.set(e,Ox(s))}var Yn=t=>{let e=Xd.get(t);if(e===void 0){const s=t+"",n=s.charAt(0)==="#"?Ox(s):Dx(s);Xd.set(t,n),e=n}return e},hy=t=>{const e=Yn(t);if(!e)return null;const[s,n,i]=e;return`#${Pg(255*s)}${Pg(255*n)}${Pg(255*i)}`},Rl=t=>{let e=1,s=t;return s&&Dx(t,Ku)&&(s=`rgb(${255*+Ku[0]},${255*+Ku[1]},${255*+Ku[2]})`,e=parseFloat(Ku[3].toString())),{color:s,opacity:e}},vh=class{on(e,s){if(typeof e!="string")throw new TypeError("Event name must be string");if(typeof s!="function")throw new TypeError("Event handler must be function");const n=this._events=this._events||{};return(n[e]=n[e]||[]).push(s),this}off(e,s){if(typeof e!="string")throw new TypeError("Event name must be string");const n=this._events=this._events||{},i=n[e];if(Rn(i))if(typeof s!="function")n[e]=null;else{const r=i.indexOf(s);r!==-1&&i.splice(r,1),i.length===0&&(n[e]=null)}return this}fire(e,...s){if(typeof e!="string")throw new TypeError("Event name must be string");const n=(this._events=this._events||{})[e];if(Rn(n)){const i=s;for(let r=0;r<n.length;r++){const o=n[r];o&&o.apply(this,i)}}return this}once(e,s){const n=this,i=function(...r){s.apply(n,r),n.off(e,i)};return i.handler=s,this.on(e,i)}hasListener(e,s){if(!e||!s)return!1;const n=(this._events=this._events||{})[e];if(Rn(n))for(let i=0,r=n.length;i<r;i++){const o=n[i];if(o===s||o.handler===s)return!0}return!1}clearEvents(){this._events={}}getListeners(e){return(this._events=this._events||{})[e]}};function M2(t){if(t.keys)return Array.from(t.keys());const e=[];return t.forEach(((s,n)=>e.push(n))),e}function I2(t){if(t.values)return Array.from(t.values());const e=[];return t.forEach((s=>e.push(s))),e}var k2=class{constructor(){this._map=new Map}reset(){this._map.clear()}set(t,e,s){this._map.set(PE(t,e),s)}get(t,e){return this._map.get(PE(t,e))}},Lz=class{constructor({elementSize:t,sideElementSize:e,nbSideElementsPerMainElement:s,id:n,depth:i,elementType:r,animated:o,stencilUsage:a}){this._nbCellsAllocated=0,this._nbCellsFreed=0,this._isFullyAllocated=!1,this._isFullyFreed=!1,this._mustUpdate=!0,this._capacity=Fx,this.version=0,this._id=n,this.depth=i,this.type=r,this.animated=o,this.stencilUsage=a,this.elementSize=t,this._nbSideElementsPerMainElement=s,this._totalSideElementsSize=s*e,this._byteCapacity=this._capacity*this.elementSize,this._byteArray=new Uint8Array(this._byteCapacity),this._dataView=new DataView(this._byteArray.buffer),this._sideByteCapacity=this._capacity*this._totalSideElementsSize,this._sideByteArray=new Uint8Array(this._sideByteCapacity),this._sideDataView=new DataView(this._sideByteArray.buffer)}update(){this._mustUpdate&&(this.version+=1,this._mustUpdate=!1,this._isFullyAllocated&&this._nbCellsFreed===this._nbCellsAllocated&&(this._isFullyFreed=!0))}allocate(t){let e=-1;return!this._isFullyAllocated&&this._nbCellsAllocated+t<=this._capacity?(e=this._nbCellsAllocated,this._nbCellsAllocated+=t,this._mustUpdate=!0):this._isFullyAllocated=!0,e}free(t,e){for(let s=0;s<e;s++){const n=(t+s)*this.elementSize;this._dataView.setUint16(n,0)}this._mustUpdate=!0,this._nbCellsFreed+=e}triggerUpdate(){this._mustUpdate=!0}isEmpty(){return this._nbCellsFreed===this._nbCellsAllocated}isFullyFreed(){return this._isFullyFreed}getId(){return this._id}getDataView(){return this._dataView}getByteArray(){return this._byteArray}getSize(){return this._nbCellsAllocated}getNbSideElementsPerMainElement(){return this._nbSideElementsPerMainElement}hasSideData(){return this._nbSideElementsPerMainElement>0}getSideDataView(){return this._sideDataView}getSideByteArray(){return this._sideByteArray}getTotalSideElementsSize(){return this._totalSideElementsSize}},DE=8,Nz=class{constructor(){this.version=0,this.version=0,this._blockInfo={buffer:null,offset:0,size:0,address:0},this._init_()}reset(){this._init_()}_init_(){this._buffersByDepth=new Array(100),this._buffersById=[],this._buffersByAscendingDepth=[],this._buffersByDescendingDepth=[],this._mustUpdate=!0}_fillBlockInfo(t,e,s,n){return this._blockInfo.buffer=t,this._blockInfo.offset=e,this._blockInfo.size=s,this._blockInfo.address=n,this._blockInfo}_createBuffer(t,e,s,n,i){const r=e?wz:ou,o=this._buffersById.length,a=new Lz({elementSize:r,sideElementSize:Fg,nbSideElementsPerMainElement:n,id:o,depth:s,elementType:t,animated:e,stencilUsage:i});return this._buffersById.push(a),a}getBlockInfo(t){return this._fillBlockInfo(this._buffersById[t>>vz],(t>>zx)%Fx,t%Px,t)}allocateBlock(t,e,s,n,i,r,o){const a=Iz(r,DE);this._mustUpdate=!0;let l=null,u=-1;if(t){const g=this.getBlockInfo(t),f=g.buffer,m=g.offset,y=g.size,p=g.size===i,x=f.depth===n,v=f.type===e,b=f.animated===s,S=f.getNbSideElementsPerMainElement()===a,A=f.stencilUsage===o;p&&x&&v&&b&&S&&A?(f.triggerUpdate(),l=f,u=m):f.free(m,y)}if(u===-1){const g=+s,f=a/DE,m=this._buffersByDepth[n]||Array(2);this._buffersByDepth[n]=m;const y=m[g]||[];m[g]=y;const p=y[e]||Array(16);y[e]=p;const x=p[f]||Array(4);p[f]=x;const v=x[o]||[];x[o]=v;const b=v[v.length-1];b&&(l=b,u=b.allocate(i)),u===-1&&(l=this._createBuffer(e,s,n,a,o),u=l.allocate(i),v.push(l))}const h=Mz(l.getId(),u,i);return this._fillBlockInfo(l,u,i,h)}freeBlock(t){if(t){this._mustUpdate=!0;const e=this.getBlockInfo(t);e.buffer.free(e.offset,e.size)}return 0}_sortBuffersByDepth(){const t=[];for(let e=0;e<this._buffersByDepth.length;e++){const s=this._buffersByDepth[e];if(s)for(let n=0;n<s.length;n++){const i=s[n];if(i)for(let r=0;r<i.length;r++){const o=i[r];if(o)for(let a=0;a<o.length;a++){const l=o[a];if(l)for(let u=0;u<l.length;u++){const h=l[u];if(h)for(let g=0;g<h.length;g++){const f=h[g];f.update(),f.isFullyFreed()?(this._buffersById[f.getId()]=void 0,h.splice(g,1),g-=1):t.push(f)}}}}}}this._buffersByAscendingDepth=t,this._buffersByDescendingDepth=t.slice().reverse()}update(){this._mustUpdate&&(this._sortBuffersByDepth(),this.version+=1,this._mustUpdate=!1)}getBuffers(){return this._buffersById}getBuffersByAscendingDepth(){return this._buffersByAscendingDepth}getBuffersByDescendingDepth(){return this._buffersByDescendingDepth}};function Mz(t,e,s){return((t<<S2)+e<<zx)+s}function Iz(t,e){let s=0;for(;s<t;)s+=e;return s}var ar=1,ka=2,cf=3,Wn=1,Go=2,Ta=3,bh=4,Ra=5,Fa=6,Ho=7,qi=1,Gf=2,Bx=3,Ux=4,xa=5,Ca=6,Kl=1,R2=2,F2=3;function OE(){return{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:Wn,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,isBadge:!1,bentEnable:!1,bentVertical:!1}}function BE(t={}){return t.pieceId=0,t.shape="",t.x1=0,t.y1=0,t.x2=0,t.y2=0,t.rectWidthOrSourceRadiusScaled=0,t.rectWidthOrSourceRadiusFixed=0,t.rectHeightOrTargetRadiusScaled=0,t.rectHeightOrTargetRadiusFixed=0,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern=t.pattern||{type:Wn,attributes:{}},t.pattern.type=Wn,t.opacity=1,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=0,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isBodyTriangle=!1,t.isSelfLoop=!1,t.isText=!1,t.adjustTextAngle=!1,t.isBadge=!1,t.bentEnable=!1,t.bentVertical=!1,t}function kz(t={}){return t.duration=0,t.beginTime=-1,t.easing="linear",t}function Gx(){return{valid:!1,id:void 0,end:OE(),start:OE(),animation:{duration:0,beginTime:-1,easing:"linear"}}}function P2(t,e,s,n){t.width=e*n,t.height=s*n,Ga(t,`${e}px`,`${s}px`)}function Rz(t){return 1/(1+Math.exp(-t))}var Fz=class{constructor(){this._capacity=Px,this._id=0,this.size=0,this.depth=0,this.animated=!1,this.stencilUsage=Kl,this.type=ar,this._list=Array(this._capacity);for(let t=0;t<this._capacity;++t)this._list[t]=Gx()}reset(t,e,s,n){return this.type=t,this.animated=e,this.depth=s,n!==void 0&&(this._id=n),this.stencilUsage=Kl,this.size=0,this}next(){if(this.size>=this._capacity)throw new Error("internal error: block.next() was called on a full block");return this._list[this.size++]}nextAndReset(){const t=this.next();return t.end=BE(t.end),t.start=BE(t.start),t.animation=kz(t.animation),t}forEach(t){this._list.forEach(t)}getElement(t){return this._list[t]}getCurrentElement(){return this._list[this.size-1]}getElements(){return this._list}getId(){return this._id}setGlobalAnimation(t,e,s){for(let n=0;n<this.size;++n){const i=this._list[n].animation;i.duration=t,i.beginTime=e,i.easing=s}}},Pz=class{constructor(){this._version=0,this._initialize()}reset(){this._initialize()}_initialize(){this._mustUpdate=!0,this.maxCoord=0,this.maxScaledSize=0,this.maxMinVisibleSize=0,this.maxSymbolicSize=0,this.maxDashLength=0,this.maxGapLength=0,this.maxPatternScale=0}set({maxCoord:t,maxScaledSize:e,maxMinVisibleSize:s,maxSymbolicSize:n,maxDashLength:i,maxGapLength:r,maxPatternScale:o}){const a=this.maxCoord<t||this.maxScaledSize<e||this.maxMinVisibleSize<s||this.maxSymbolicSize<n||this.maxDashLength<i||this.maxGapLength<r||this.maxPatternScale<o;return a&&(this.maxCoord=t,this.maxScaledSize=e,this.maxMinVisibleSize=s,this.maxSymbolicSize=n,this.maxDashLength=i,this.maxGapLength=r,this.maxPatternScale=o,this._mustUpdate=!0),a}update(){return this._mustUpdate&&(this._version+=1,this._mustUpdate=!1),this}getVersion(){return this._version}},zz={linear:[0,1,0,0],quadraticIn:[0,0,1,0],quadraticOut:[0,2,-1,0],quadraticInOut:[0,0,2,0,-1,4,-2,0],cubicIn:[0,0,0,1],cubicOut:[0,3,-3,1],cubicInOut:[0,0,0,4,-3,12,-12,4]},Dz=class{constructor(){this._linearEasing=[0,1,0,0,0,1,0,0],this._nameToPolygon={},this._polygonToName={},this.add(zz)}add(t){Object.keys(t).forEach((e=>{const s=t[e].slice();s.length<8&&(s[4]=s[0],s[5]=s[1],s[6]=s[2],s[7]=s[3]);const n=z_(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]);this._nameToPolygon[e]=s,this._polygonToName[n]=e}))}getCoefficients(t){return this._nameToPolygon[t]||this._linearEasing}getName(t,e,s,n,i,r,o,a){const l=z_(t,e,s,n,i,r,o,a);return this._polygonToName[l]||"linear"}},Vx=new Dz;function Vf(t){return typeof t=="number"&&isFinite(t)}var Oz=t=>{if(t===0)return 0;if(isNaN(t))return 32256;if(!isFinite(t))return t>0?31744:64512;const e=t<0?32768:0;if((t=Math.abs(t))<6103515625e-14)return e|Math.round(4096*t);if(t>65504)return 31744|e;let s=Math.floor(Math.log2(t)),n=Math.round(1024*(t/Math.pow(2,s)-1));return n===1024&&(n=0,s++),e|s+15<<10|n},UE=t=>{const e=32768&t?-1:1,s=t>>10&31,n=1023&t;return s===0?n===0?0*e:e*Math.pow(2,-14)*(n/1024):s===31?n?NaN:e*(1/0):e*Math.pow(2,s-15)*(1+n/1024)},Bz=0,Uz=1,Gz=2,Vz=3,jz=4,Hz=5,$z=6,qz=7,Yz=8,Wz=9,jf=10,Xz=0,z2=1,D2=2,jx=30,O2=0,Zz=1,Kz=2,Hx=3,Qz=4,Jz=5,$x=6,Hf=1e-6,Vi=Math.PI,Md=2*Math.PI,B2=Vi*(5/4),U2=Vi*(7/4),G2=Vi*(3/4),V2=Vi*(1/4),GE=1.1,VE=.07,tD=1,jE=1,HE=.17,eD=1,sD=-Vi/2,nD=Vi/2,iD={plain:{dash:0,gap:0},dashed:{dash:3,gap:1},dotted:{dash:1,gap:3}},rD={right:0,top:-Math.PI/2,left:Math.PI,bottom:Math.PI/2,center:0},oD={right:Math.PI,top:-Math.PI/2,left:0,bottom:Math.PI/2,center:0},Al=8,aD=class{constructor(t,e,s,n,i){this._littleEndian=Cf(),this._maxScaledSize=0,this._maxMinVisibleSize=0,this._maxSymbolicSize=0,this._maxDashLength=0,this._maxGapLength=0,this._maxPatternScale=0,this._actualScaledSizeToBytes=bz,this._actualMinVisibleSizeToBytes=oy,this._actualSymbolicSizeToBytes=Vl,this._actualDashLengthToBytes=jl,this._actualGapLengthToBytes=jl,this._actualPatternScaleToBytes=Vl,this._genericObject=Gx(),this._shapeManager=e,this._patternManager=t,this._textManager=s,this._bufferOffsetToId=n,this._colorParser=i}resizeBoundaries(t,e,s,n,i,r){this._maxScaledSize=t,this._maxMinVisibleSize=e,this._maxSymbolicSize=s,this._maxDashLength=n,this._maxGapLength=i,this._maxPatternScale=r,this._actualScaledSizeToBytes=A2/t,this._actualMinVisibleSizeToBytes=oy/e,this._actualSymbolicSizeToBytes=Vl/s,this._actualDashLengthToBytes=jl/n,this._actualGapLengthToBytes=jl/i,this._actualPatternScaleToBytes=Vl/r}storeGenericObject(t,e,s){const n=this._shapeManager.getIdFromName(s.shape),i=s.pieceId,r=this._dashLengthToBytes(s.dashLength),o=this._gapLengthToBytes(s.gapLength),a=+s.hasHead,l=+s.hasTail,u=+s.isBodyTriangle,h=+s.isSelfLoop,g=this._patternScaleToBytes(s.patternScale),f=this._offsetAngleToBytes(s.offsetAngle),m=+s.isText,y=+s.adjustTextAngle,p=+s.isBadge,x=+s.bentEnable,v=+s.bentVertical,b=this._opacityToBytes(s.opacity),S=this._minVisibleSizeToBytes(s.globalMinVisibleSize),A=this._minVisibleSizeToBytes(s.strokeMinVisibleSize),w=this._minVisibleSizeToBytes(s.patternMinVisibleSize),L=this._symbolicSizeToBytes(s.symbolicSize),k=this._curvatureToBytes(s.curvature),F=s.pattern.attributes.colors;F&&(s.pattern.attributes.colors=F.split(";").map((ve=>jc(this._colorToBytes(ve.trim())))).join(";"));const O=this._patternManager.getIdFromDefinition(s.pattern),j=this._colorToBytes(s.fillColor),V=this._colorToBytes(s.strokeColor),Z=this._colorToBytes(s.patternColor),{x1:at,y1:mt,x2:K,y2:ut}=s,ht=this._fixedSizeToBytes(s.rectWidthOrSourceRadiusFixed),nt=this._fixedSizeToBytes(s.rectHeightOrTargetRadiusFixed),ot=this._scaledSizeToBytes(s.thicknessOrFontSizeScaled),Mt=this._fixedSizeToBytes(s.thicknessOrFontSizeFixed),Q=this._scaledSizeToBytes(s.strokeWidthScaled),Et=this._fixedSizeToBytes(s.strokeWidthFixed),qt=this._scaledSizeToBytes(s.offsetScaled),Vt=this._fixedSizeToBytes(s.offsetFixed),Wt=this._fixedSizeToBytes(s.pattern.attributes.paddingTop||0),oe=this._fixedSizeToBytes(s.pattern.attributes.paddingLeft||0),me=n+(i<<4)+(r<<8)+(o<<10)+(a<<12)+(l<<13)+(u<<14)+(h<<15),se=g+(f<<8)+(m<<11)+(y<<12)+(p<<13)+(x<<14)+(v<<15),Jt=b+(S<<4)+(A<<8)+(w<<12),ee=L+(k<<8),ce=s.rectWidthOrSourceRadiusScaled/this._maxScaledSize*Vc,Ce=s.rectHeightOrTargetRadiusScaled/this._maxScaledSize*Vc;this._setUint16(t,e+0,me),this._setUint16(t,e+2,se),this._setUint16(t,e+4,Jt),this._setUint16(t,e+6,ee),this._setUint16(t,e+8,O),this._setUint16(t,e+10,j),this._setUint16(t,e+12,V),this._setUint16(t,e+14,Z),this._setFloat32(t,e+16,at),this._setFloat32(t,e+20,mt),this._setFloat32(t,e+24,K),this._setFloat32(t,e+28,ut),this._setFloat16(t,e+32,ce),this._setUint16(t,e+34,ht),this._setFloat16(t,e+36,Ce),this._setUint16(t,e+38,nt),this._setUint16(t,e+40,ot),this._setUint16(t,e+42,Mt),this._setUint16(t,e+44,Q),this._setUint16(t,e+46,Et),this._setUint16(t,e+48,qt),this._setInt16(t,e+50,Vt),this._setInt16(t,e+52,Wt),this._setInt16(t,e+54,oe)}_setUint16(t,e,s){t.setUint16(e,s,this._littleEndian)}_setFloat16(t,e,s){t.setUint16(e,Oz(s),this._littleEndian)}_setInt16(t,e,s){t.setUint16(e,this._signedToUnsignedInt16(s),this._littleEndian)}_setFloat32(t,e,s){t.setFloat32(e,s,this._littleEndian)}_colorToBytes(t){const e=this._colorParser(t);return Math.round(15*e[0])+(Math.round(15*e[1])<<4)+(Math.round(15*e[2])<<8)+(Math.round(15*e[3])<<12)}_scaledSizeToBytes(t){return Math.ceil(Math.min(t,this._maxScaledSize)*this._actualScaledSizeToBytes)}_fixedSizeToBytes(t){return t}_minVisibleSizeToBytes(t){return Math.round(Math.min(t,this._maxMinVisibleSize)*this._actualMinVisibleSizeToBytes)}_symbolicSizeToBytes(t){return Math.round(Math.min(t,this._maxSymbolicSize)*this._actualSymbolicSizeToBytes)}_dashLengthToBytes(t){return Math.round(Math.min(t,this._maxDashLength)*this._actualDashLengthToBytes)}_gapLengthToBytes(t){return Math.round(Math.min(t,this._maxGapLength)*this._actualGapLengthToBytes)}_patternScaleToBytes(t){return Math.round(Math.min(t,this._maxPatternScale)*this._actualPatternScaleToBytes)}_offsetAngleToBytes(t){return Math.round((t+Md)%Md*(8/Md))}_opacityToBytes(t){return Math.round(15*Math.min(t,1))}_curvatureToBytes(t){return this._signedToUnsignedByte(t)}_signedToUnsignedByte(t){return $i(t,-128,127)+128}_signedToUnsignedInt16(t){return $i(t,-32768,32767)+32768}storeAnimationInformation(t,e,{beginTime:s,duration:n},i){this._setAnimationBeginTime(t,e,s),this._setAnimationDuration(t,e,n),this._setAnimationEasing(t,e,i)}_setAnimationBeginTime(t,e,s){this._setFloat32(t,e,s)}_setAnimationDuration(t,e,s){this._setFloat32(t,e+4,s)}_setAnimationEasing(t,e,s){this._setUint16(t,e+8,(s[0]+128<<8)+(s[4]+128)),this._setUint16(t,e+10,(s[1]+128<<8)+(s[5]+128)),this._setUint16(t,e+12,(s[2]+128<<8)+(s[6]+128)),this._setUint16(t,e+14,(s[3]+128<<8)+(s[7]+128))}extractGenericElement(t,e,s){const n=t.type,i=t.animated,r=t.getDataView(),o=e*t.elementSize,a=this._genericObject;if(a.valid=!1,r.getUint16(o)&&(a.valid=!0,this._extractGenericObject(a.end,r,o,s),i&&(this._extractGenericObject(a.start,r,o+ou,s),this._extractAnimationInformation(a.animation,r,o+2*ou)),a.id=this._bufferOffsetToId.get(t.getId(),e),n===ka)){const l=t.getSideDataView(),u=e*t.getTotalSideElementsSize(),h=u+t.getTotalSideElementsSize();a.end.pattern=this._textManager.extractTextFromDataView(l,u,h)}return a}_extractGenericObject(t,e,s,{bytesToActualCoord:n,bytesToActualScaledSize:i,bytesToActualMinVisibleSize:r,bytesToActualPatternScale:o,bytesToActualSymbolicSize:a,bytesToActualDashLength:l,bytesToActualGapLength:u}){const h=e,g=s,f=this._littleEndian,m=h.getUint16(g,f),y=Us(m,0,4),p=Us(m,4,8),x=Us(m,8,10),v=Us(m,10,12),b=Us(m,12,13),S=Us(m,13,14),A=Us(m,14,15),w=Us(m,15,16),L=h.getUint16(g+2,f),k=Us(L,0,8),F=Us(L,8,11),O=Us(L,11,12),j=Us(L,12,13),V=Us(L,13,14),Z=Us(L,14,15),at=Us(L,15,16),mt=h.getUint16(g+4,f),K=Us(mt,0,4),ut=Us(mt,4,8),ht=Us(mt,8,12),nt=Us(mt,12,16),ot=h.getUint16(g+6,f),Mt=Us(ot,0,8),Q=Us(ot,8,16),Et=h.getUint16(g+8,f),qt=h.getUint16(g+10,f),Vt=h.getUint16(g+12,f),Wt=h.getUint16(g+14,f),oe=h.getFloat32(g+16,f),me=h.getFloat32(g+20,f),se=h.getFloat32(g+24,f),Jt=h.getFloat32(g+28,f),ee=h.getUint16(g+32,f),ce=h.getUint16(g+34,f),Ce=h.getUint16(g+36,f),ve=h.getUint16(g+38,f),Me=h.getUint16(g+40,f),ge=h.getUint16(g+42,f),ze=h.getUint16(g+44,f),is=h.getUint16(g+46,f),Ge=h.getUint16(g+48,f),De=Hp(h.getUint16(g+50,f)),He=Hp(h.getUint16(g+52,f)),Je=Hp(h.getUint16(g+54,f));t.pieceId=p,t.shape=this._shapeManager.getNameFromId(y),t.x1=xr(oe,n),t.y1=xr(me,n),t.x2=xr(se,n),t.y2=xr(Jt,n),t.rectWidthOrSourceRadiusScaled=UE(ee)*this._maxScaledSize/Vc,t.rectWidthOrSourceRadiusFixed=ce,t.rectHeightOrTargetRadiusScaled=UE(Ce)*this._maxScaledSize/Vc,t.rectHeightOrTargetRadiusFixed=ve,t.thicknessOrFontSizeScaled=xr(Me,i),t.thicknessOrFontSizeFixed=ge,t.strokeWidthScaled=xr(ze,i),t.strokeWidthFixed=is,t.offsetScaled=xr(Ge,i),t.offsetFixed=De,t.pattern=this._patternManager.getDefinitionFromId(Et),t.pattern.attributes.paddingTop=He,t.pattern.attributes.paddingLeft=Je,t.opacity=K/15,t.fillColor=jc(qt),t.strokeColor=jc(Vt),t.patternColor=jc(Wt),t.globalMinVisibleSize=xr(ut,r),t.strokeMinVisibleSize=xr(ht,r),t.patternMinVisibleSize=xr(nt,r),t.offsetAngle=F*(2*Math.PI/8),t.patternScale=k*o,t.symbolicSize=Mt*a,t.curvature=lD(Q),t.dashLength=x*l,t.gapLength=v*u,t.hasHead=!!b,t.hasTail=!!S,t.isBodyTriangle=!!A,t.isSelfLoop=!!w,t.isText=!!O,t.adjustTextAngle=!!j,t.isBadge=!!V,t.bentEnable=!!Z,t.bentVertical=!!at}_extractAnimationInformation(t,e,s){const n=this._littleEndian,i=e.getFloat32(s,n),r=e.getFloat32(s+4,n),o=e.getUint16(s+8,n),a=e.getUint16(s+10,n),l=e.getUint16(s+12,n),u=e.getUint16(s+14,n),h=(o>>8)-128,g=(a>>8)-128,f=(l>>8)-128,m=(u>>8)-128,y=o%256-128,p=a%256-128,x=l%256-128,v=u%256-128;t.beginTime=i,t.duration=r,t.easing=Vx.getName(h,g,f,m,y,p,x,v)}};function Us(t,e,s){return t%(1<<s)>>e}function lD(t){return t-128}function Hp(t){return t-32768}function xr(t,e){return t*e}var $E=new Array(65535);function jc(t){let e=$E[t];if(!e){const s=Us(t,0,4)/15,n=Us(t,4,8)/15,i=Us(t,8,12)/15,r=Us(t,12,16)/15;e=`rgba(${255*s|0}, ${255*n|0}, ${255*i|0}, ${r})`,s+n+i+r===0&&(e=null),$E[t]=e}return e}var uD={[Go]:"image",[bh]:"piechart",[Ta]:"text",[Ra]:"icon",[Fa]:"badge"},dD=class{constructor(){this._pixelRatio=1,this._nextPatternId=1,this._version=0,this._init_()}reset(){this._init_()}_init_(){this._mustUpdate=!0,this._nextPatternId=1,this._patterns=[null],this._patternsByHash={},this._pixelRatio=1,this._nullPattern={id:-1,type:Wn,attributes:{}}}_increaseNextId(){let t=this._nextPatternId++;for(t%256==255&&(t=this._nextPatternId++);this._patterns.length<=t;)this._patterns.push(void 0);return t}_createPattern({type:t,attributes:e}){const s={id:this._increaseNextId(),type:t,attributes:this._getAttributes(t,e)};return this._patterns[s.id]=s,this._mustUpdate=!0,s}_getAttributes(t,e){return t===Go?{image:e.image,scaled:e.scaled,duplicated:e.duplicated}:t===Ta||t===Ra||t===Fa?{font:e.font,size:e.size,style:e.style,text:e.text,paddingLeft:e.paddingLeft,paddingTop:e.paddingTop,align:e.align||"center",offset:e.offset||0}:t===bh&&e.colors?{colors:e.colors,colorArray:e.colors.split(";").map((s=>s.trim()))}:{}}getPatternList(){return this._patterns.filter((t=>t))}update(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)}setPixelRatio(t){t!==this._pixelRatio&&(this._pixelRatio=t,this._mustUpdate=!0)}getPixelRatio(){return this._pixelRatio}notifyUpdate(){this._mustUpdate=!0}getIdFromDefinition(t){const{type:e,attributes:s}=t,n=e===Ta||e===Ra||e===Fa;let i=0;return e&&e!==Wn&&e!==Ho&&(e!==Go||s.image)&&(!n||s.text&&s.font)&&(i=this._addPattern(t),e===Ta&&s.style==="normal"&&(s.style="bold",this._addPattern(t))),i}_addPattern(t){const e=this._getPatternHash(t);let s=this._patternsByHash[e];return s||(this._nextPatternId>65500?Uo("maximum number of pattern exceeded"):(s=this._createPattern(t).id,this._patternsByHash[e]=s)),s}_getPatternHash({type:t,attributes:e}){const s=[uD[t]];return t===Go?s.push(e.scaled?"scaled":"non-scaled",e.duplicated?"duplicated":"non-duplicated",e.image.src||e.image.toDataURL()):t===Ta?s.push(e.text,e.font,e.style,e.size,e.align||"center",e.offset||0):t===Ra||t===Fa?s.push(e.text,e.font,e.style,e.size,e.paddingLeft,e.paddingTop):s.push(e.colors),s.join("+")}getDefinitionFromId(t){if(t&&this._patterns[t]){const e=this._patterns[t];if(e)return e}return this._nullPattern}getVersion(){return this._version}};function qE(t){return t.map((({x:e,y:s,r:n=0})=>({x:e,y:s,r:n})))}var hD=class{constructor(){this._version=0,this._mustUpdate=!0,this._byName={},this._byId=new Array(uf+1)}register(t,{getDistanceFromStrokeVertically:e,getDistanceFromStrokeHorizontally:s,points:n,hole:i,isSimple:r}){if(this._byName[t])return;let o=r?1:ay;const a=r?ay-1:uf;for(;this._byId[o];)o+=1;if(o>a)throw new Error("max number of shape exceeded");const l={id:o,name:t,getDistanceFromStrokeVertically:e,getDistanceFromStrokeHorizontally:s,points:qE(n.slice()),hole:i?qE(i.slice()):null,isSimple:!!r};return this._mustUpdate=!0,this._byId[o]=l,this._byName[t]=l,l}updateShape(t,e){const s=this._byName[t];s&&(delete this._byId[s.id],delete this._byName[t],this.register(t,e))}getIdFromName(t){return this._byName[t].id}getNameFromId(t){const e=this._byId[t];return e?e.name:""}getDefinitionFromName(t){return this._byName[t]}update(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)}getVersion(){return this._version}getShapeList(){return this._byId.filter((t=>t))}},cy=300,gy=150,j2=class{constructor(){this.style={},this.width=cy,this.height=gy,this.__context=new H2,this.style={},this.width=cy,this.height=gy}get __dummy(){return!0}get parentNode(){return null}getContext(t){return t==="2d"?this.__context:null}toDataURL(t="png"){return`data:image/${t};base64,`}addEventListener(){}removeEventListener(){}getBoundingClientRect(){return{left:0,top:0,bottom:0,right:0,width:this.width,height:this.height}}},H2=class{constructor(){this._fontSize=10}set font(t){const e=t.match(/\d+/);e&&(this._fontSize=parseFloat(e[0]))}set fillStyle(t){}set textBaseline(t){}set textAlign(t){}set strokeStyle(t){}set lineWidth(t){}fill(){}stroke(){}clearRect(){}fillRect(){}strokeRect(){}beginPath(){}closePath(){}moveTo(){}lineTo(){}rect(){}arc(){}save(){}restore(){}clip(){}translate(){}rotate(){}fillText(){}setLineDash(){}quadraticCurveTo(){}bezierCurveTo(){}drawImage(){}measureText(t){return{width:t.length*Math.ceil(.625*this._fontSize)}}getImageData(){return{width:0,height:0,data:new Uint8ClampedArray(0)}}},Hc=Hi("canvas")||Hi("canvas-prebuilt");function Fn(t=cy,e=gy){if(eo){const n=document.createElement("canvas");return n.width=t,n.height=e,n}if(Hc){let n=null;return n="createCanvas"in Hc?Hc.createCanvas(t,e):new Hc(t,e),n.style={},n}const s=new j2;return s.width=t,s.height=e,s}function fy(t,e,s=t.width,n=t.height){e.clearRect(0,0,s,n)}function $o(t,e,s,n=""){t.font=`${n} ${s}px ${e}`}function $2(){return qx(Fn(),{},"webgl")!==null}var q2=t=>{const{canvas:e,width:s,height:n}={canvas:document.createElement("canvas"),width:window.innerWidth*devicePixelRatio,height:window.innerHeight*devicePixelRatio,...t};e.width=Math.ceil(s),e.height=Math.ceil(n),e.style.width=Math.ceil(s/devicePixelRatio)+"px",e.style.height=Math.ceil(n/devicePixelRatio)+"px";const i=e.getContext("webgl2",{antialias:!0});if(!i)throw new Error("WebGL 2.0 not supported");return i},Y2=(t,e,s)=>{const n=q2();return n.canvas.addEventListener("webglcontextlost",s),{context:n,cleanUp:()=>{var i;n.canvas.removeEventListener("webglcontextlost",s),(i=n.getExtension("WEBGL_lose_context"))==null||i.loseContext()}}};function qx(t,e,s){let n=t.getContext(s,e);return n||(n=t.getContext("experimental-webgl",e)),n||null}function Yx(t,e){if(e<2)return t;const s=t.split(`
`),n=[];for(let i=0;i<s.length;++i){const r=s[i];if(r.length<e)n.push(r);else{const o=W2(s[i],e);for(let a=0;a<o.length;++a)n.push(o[a])}}return n.join(`
`)}function W2(t,e){const s=[""],n=t.split(" ");for(let i=0;i<n.length;i++){const r=s[s.length-1],o=n[i];r.length+1+o.length<=e&&r.length?s[s.length-1]+=(r.length>0?" ":"")+o:s.push(o)}return s}function X2(t,e){if(t===null)return null;const s=(t=t.toString()).split(`
`),n=[];let i=0;for(let r=0;r<s.length;r++){let o=s[r];if(!e||e<=1||o.length<e)n.push(o),i=Math.max(i,o.length);else{const a=W2(s[r],e);for(let l=0;l<a.length;l++)o=a[l],n.push(o),i=Math.max(i,o.length)}}return{data:n,maxLength:i,lines:n.length}}function Z2(){const t=Hi("@mapbox/mapbox-gl-rtl-text")||Hi("mapbox-gl-rtl-text"),e=t?t.processBidirectionalText:Vo?window.processBidirectionalText:null,s=t?t.applyArabicShaping:Vo?window.applyArabicShaping:null;return{processBidirectionalText:e?n=>{if(n===null||n==null)return"";const i=[];let r=0,o="";const a=n.split(`
`);for(let l=0;l<a.length;l++){const u=a[l],h=a[l].length+r;h>0&&l<a.length-1&&i.push(h),o+=l>0?""+u:u,r+=u.length}return e(o,i).join(`
`)}:n=>n,applyArabicShaping:s?n=>n==null?null:typeof n=="number"?n.toString():s(n):n=>n==null?null:n.toString()}}var $p=Cf(),$c=10,cD=1<<17,gD=65536,fD=256,YE=128,mD=25,K2=1e3,my=2,Q2=["100","200","300","400","500","600","700","800","900","none","bold","italic","normal","italic bold","bold italic","100 italic","200 italic","300 italic","400 italic","500 italic","600 italic","700 italic","800 italic","900 italic"],WE=()=>{const t={};for(const e of Q2)t[e]={};return t},pD=class{constructor(t){this._widthAtlases=WE(),this._patternManager=t,this._canvas=Fn(),this._ctx=this._canvas.getContext("2d",{willReadFrequently:!0}),this._processBidirectionalText=Z2().processBidirectionalText,this._cornerRadius=0,this._version=0,this._textPattern={id:0,type:Ho,attributes:{text:"",font:"",size:0,style:"normal",align:"center"},dimensions:{width:0,height:0}},this._textDimensions={width:0,height:0},this._lineWidthList=new Array(64),this._init()}_init(){this._mustClear=!1,this._clear()}reset(){this._init()}clear(){this._mustClear=!0}_measureChar(t,e,s){return $o(this._ctx,e,Wd,s),this._ctx.measureText(t).width/Wd}_getAtlas(t,e,s,n){const i=s===xh?0:s,r=this._byFont[t]||(this._byFont[t]=Q2.reduce(((l,u)=>(l[u]=void 0,l)),{})),o=r[n]||(r[n]={}),a=o[e]||(o[e]=new Array(50));return a[i]||(a[i]=new Array(256))}_getMeasurementAtlas(t,e){const s=this._widthAtlases[e];return s[t]||(s[t]=new Array(256))}measureText(t,e,s,n=1){if(!e||t===null)return this._textDimensions.width=0,this._textDimensions.height=0,this._textDimensions;const i=this._getMeasurementAtlas(e,s);let r=0,o=0,a=1;for(let l=0;l<t.length;++l){const u=t.charCodeAt(l);if(u===$c)o>r&&(r=o),o=0,a+=1;else{let h=i[u];h===void 0&&(h=this._measureChar(t[l],e,s),i[u]=h),o+=h}}return o>r&&(r=o),this._textDimensions.width=r*n,this._textDimensions.height=a*n,this._textDimensions}_getCharInfo(t,e,s,n,i,r){let o=t[e];if(!o){const a=String.fromCharCode(e);o={ratio:this._measureChar(a,s,n),patternId:0},o.patternId=this._patternManager.getIdFromDefinition({id:0,type:Ta,attributes:{text:a,font:s,style:n,size:i,align:r}}),t[e]=o}return o}storeTextInDataView(t,e,s,n){let i=e;if(n&&n.type===Ho){const{font:r,style:o,size:a,align:l}=n.attributes,u=l==="center",h=this._getAtlas(r,o,a,l);let g=0,f=1,m=0,y=0;const p=this._lineWidthList,x=this._processBidirectionalText(n.attributes.text);for(let A=0;A<x.length;++A){const w=x.charCodeAt(A);w===$c?(m>g&&(g=m),p[y]=m,y++,m=0,f++):m+=this._getCharInfo(h,w,r,o,a,l).ratio}p[y]=m,m>g&&(g=m),y=0;let v=-(u?p[y]:g)/2,b=(1-f)/2,S=0;for(let A=0;A<x.length;++A){const w=x.charCodeAt(A),L=h[w];if(w===$c)y+=1,v=-(u?p[y]:g)/2,b+=A===0?.5:1,S=0;else{const k=L.ratio,F=L.patternId;v+=(k+S)/2,S=k;const O=($i(v*K2+gD,0,cD-1)<<8)+$i(b*my+YE,0,fD-1);t.setUint16(i,F,$p),t.setUint32(i+2,O,$p),i+=Fg}}}this._fillWithZeros(t,i,s)}extractTextFromDataView(t,e,s){const n=t,i=$p,r=n.getUint16(e,i),o=this._textPattern,a=this._patternManager.getDefinitionFromId(r),{font:l,style:u,size:h,align:g}=a.attributes,f=this._getAtlas(l,u,h,g),m=[];let y=0,p=0,x=0,v=null;for(let S=e;S<s;S+=Fg){const A=n.getUint16(S,i);if(!A)break;const w=(n.getUint8(S+2)-YE)/my,L=this._patternManager.getDefinitionFromId(A);if(!L||!L.attributes||!L.attributes.text)break;const k=L.attributes.text.charCodeAt(0),F=f[k];v===null?v=w:w>v&&(y>p&&(p=y),y=0,x+=1,m.push($c),v=w),m.push(k),F&&(y+=F.ratio)}y>p&&(p=y);const b=String.fromCharCode.apply(null,m);return o.attributes.style=u,o.attributes.font=l,o.attributes.size=h,o.attributes.align=g,o.attributes.text=this._processBidirectionalText(b),o.dimensions&&(o.dimensions.width=p,o.dimensions.height=x),o}_fillWithZeros(t,e,s){for(let n=e;n<s;n+=Fg)t.setUint16(n,0)}_clear(){this._byFont={},this._widthAtlases=WE()}update(){this._mustClear&&(this._clear(),this._mustClear=!1)}getVersion(){return this._version}getCornerRadius(){return this._cornerRadius}setCornerRadius(t){t!==this._cornerRadius&&(this._cornerRadius=t,this._version++)}},Wx=()=>({minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),ii=class Fl{constructor(e={}){const{xValues:s=[],yValues:n=[],scaledSizeValues:i=[],fixedSizeValues:r=[]}=e;this.minX=Yr(s),this.minY=Yr(n),this.maxX=Ul(s),this.maxY=Ul(n),this.minScaledSize=Yr(i),this.maxScaledSize=Ul(i),this.minFixedSize=Yr(r),this.maxFixedSize=Ul(r),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY}reset(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.minScaledSize=1/0,this.maxScaledSize=-1/0,this.minFixedSize=1/0,this.maxFixedSize=-1/0,this.width=0,this.height=0,this.cx=0,this.cy=0,this}addPoint(e,s,n,i){if(!isFinite(e)||!isFinite(s))return this;this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,s),n!==void 0&&i!==void 0&&(i==="scaled"?(this.minScaledSize=Math.min(this.minScaledSize,n),this.maxScaledSize=Math.max(this.maxScaledSize,n)):(this.minFixedSize=Math.min(this.minFixedSize,n),this.maxFixedSize=Math.max(this.maxFixedSize,n)));const r=this.maxX-this.minX,o=this.maxY-this.minY;return this.cx=this.minX+r/2,this.cy=this.minY+o/2,this.width=r,this.height=o,this}computeForZoom(e){const s=Math.max(this.maxScaledSize,this.maxFixedSize/e);return Fl.from({minX:this.minX-s/2,minY:this.minY-s/2,maxX:this.maxX+s/2,maxY:this.maxY+s/2,width:this.width+s,height:this.height+s})}static from({minX:e,minY:s,maxX:n,maxY:i,width:r,height:o}={}){const a=new Fl;return e!=null&&(a.minX=e),s!=null&&(a.minY=s),n!=null&&(a.maxX=n),i!=null&&(a.maxY=i),n!=null&&e!=null&&(a.width=r||Math.abs(n-e),a.cx=(e+n)/2),i!=null&&s!=null&&(a.height=o||Math.abs(i-s),a.cy=(s+i)/2),a.maxScaledSize=a.minScaledSize=0,a}static fromValues(e,s,n){let i=1/0,r=1/0,o=-1/0,a=-1/0,l=-1/0;for(let h=0;h<e.length;h++){const g=e[h],f=s[h],m=n[h];g-m<i&&(i=g-m),f-m<r&&(r=f-m),g+m>o&&(o=g+m),f+m>a&&(a=f+m),m>l&&(l=m)}const u=Fl.from({minX:i,minY:r,maxX:o,maxY:a});return u.maxScaledSize=l,u}pad(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,this.width+=2*e,this.height+=2*e,this}isValid(){return isFinite(this.width)&&isFinite(this.height)}extend(e){let s,n,i,r;return e instanceof Fl?(s=e.minX,n=e.minY,i=e.maxX,r=e.maxY):Array.isArray(e)&&(s=e[0],n=e[1],i=e[2],r=e[3]),this.addPoint(s,n).addPoint(i,r)}bottomLeft(){return{x:this.minX,y:this.minY}}topRight(){return{x:this.maxX,y:this.maxY}}center(){return{x:this.cx,y:this.cy}}clone(){const e=new Fl;return e.minX=this.minX,e.minY=this.minY,e.maxX=this.maxX,e.maxY=this.maxY,e.minScaledSize=this.minScaledSize,e.maxScaledSize=this.maxScaledSize,e.minFixedSize=this.minFixedSize,e.maxFixedSize=this.maxFixedSize,e.cx=this.cx,e.cy=this.cy,e.width=this.width,e.height=this.height,e}},_D=1e-6,yD=1e-12;function J2(){for(var t=arguments,e=t.length-1,s=e,n=[],i=0;i<=e&&Math.abs(t[i])<=yD;i++)e--;switch(e){case 1:xD(t[s],t[s-1],n);break;case 2:vD(t[s],t[s-1],t[s-2],n);break;case 3:bD(t[s],t[s-1],t[s-2],t[s-3],n)}return n}function xD(t,e,s=[]){return e!==0&&s.push(-t/e),s}function vD(t,e,s,n=[]){var i=e/s,r=i*i-4*(t/s);if(r>0){var o=Math.sqrt(r);n.push(.5*(-i+o)),n.push(.5*(-i-o))}else r===0&&n.push(.5*-i);return n}function bD(t,e,s,n,i=[]){var r,o,a=s/n,l=e/n,u=(3*l-a*a)/3,h=(2*a*a*a-9*l*a+27*(t/n))/27,g=a/3,f=h*h/4+u*u*u/27,m=h/2;if(Math.abs(f)<=_D&&(f=0),f>0){var y=Math.sqrt(f);o=(r=-m+y)>=0?Math.pow(r,1/3):-Math.pow(-r,1/3),(r=-m-y)>=0?o+=Math.pow(r,1/3):o-=Math.pow(-r,1/3),i.push(o-g)}else if(f<0){var p=Math.sqrt(-u/3),x=Math.atan2(Math.sqrt(-f),-m)/3,v=Math.cos(x),b=Math.sin(x),S=Math.sqrt(3);i.push(2*p*v-g),i.push(-p*(v+S*b)-g),i.push(-p*(v-S*b)-g)}else r=m>=0?-Math.pow(m,1/3):Math.pow(-m,1/3),i.push(2*r-g),i.push(-r-g);return i}function Lo(t,e,s,n,i,r,o,a,l,u,h){for(var g,f,m=Math.min(o,l),y=Math.min(a,u),p=Math.max(o,l),x=Math.max(a,u),v=J2((g=a-u)*(t+-2*s+i)+(f=l-o)*(e+-2*n+r),g*(-2*t+2*s)+f*(-2*e+2*n),g*t+f*e+(o*u-l*a)),b=0;b<v.length;b++){var S=v[b];if(0<=S&&S<=1){var A=t+(s-t)*S,w=e+(n-e)*S,L=A+(s+(i-s)*S-A)*S,k=w+(n+(r-n)*S-w)*S;if(o===l){if(y<=k&&k<=x){if(!h)return 1;h.push(L,k)}}else if(a===u){if(m<=L&&L<=p){if(!h)return 1;h.push(L,k)}}else if(L>=m&&k>=y&&L<=p&&k<=x){if(!h)return 1;h.push(L,k)}}}return h?h.length/2:0}function tC(t,e,s,n,i,r,o,a,l,u,h){return h?(Lo(t,e,s,n,i,r,o,a,l,a,h),Lo(t,e,s,n,i,r,l,a,l,u,h),Lo(t,e,s,n,i,r,o,u,l,u,h),Lo(t,e,s,n,i,r,o,a,o,u,h),h.length/2):o<=t&&l>=t&&a<=e&&u>=e||o<=i&&l>=i&&a<=r&&u>=r||Lo(t,e,s,n,i,r,o,a,l,a)||Lo(t,e,s,n,i,r,l,a,l,u)||Lo(t,e,s,n,i,r,o,u,l,u)||Lo(t,e,s,n,i,r,o,a,o,u)?1:0}function No(t,e,s,n,i,r,o,a,l,u,h,g,f){for(var m,y,p=Math.min(l,h),x=Math.min(u,g),v=Math.max(l,h),b=Math.max(u,g),S=J2((m=u-g)*(-1*t+3*s+-3*i+o)+(y=h-l)*(-1*e+3*n+-3*r+a),m*(3*t+-6*s+3*i)+y*(3*e+-6*n+3*r),m*(-3*t+3*s)+y*(-3*e+3*n),m*t+y*e+(l*g-h*u)),A=0;A<S.length;A++){var w=S[A];if(0<=w&&w<=1){var L=t+(s-t)*w,k=e+(n-e)*w,F=s+(i-s)*w,O=n+(r-n)*w,j=L+(F-L)*w,V=k+(O-k)*w,Z=j+(F+(i+(o-i)*w-F)*w-j)*w,at=V+(O+(r+(a-r)*w-O)*w-V)*w;if(l===h){if(x<=at&&at<=b){if(!f)return 1;f.push(Z,at)}}else if(u===g){if(p<=Z&&Z<=v){if(!f)return 1;f.push(Z,at)}}else if(Z>=p&&at>=x&&Z<=v&&at<=b){if(!f)return 1;f.push(Z,at)}}}return f?f.length/2:0}function py(t,e,s,n,i,r,o,a,l,u,h,g,f){return f?(No(t,e,s,n,i,r,o,a,l,u,h,u,f),No(t,e,s,n,i,r,o,a,h,u,h,g,f),No(t,e,s,n,i,r,o,a,l,g,h,g,f),No(t,e,s,n,i,r,o,a,l,u,l,g,f),f.length/2):l<=t&&h>=t&&u<=e&&g>=e||l<=o&&h>=o&&u<=a&&g>=a||No(t,e,s,n,i,r,o,a,l,u,h,u)||No(t,e,s,n,i,r,o,a,h,u,h,g)||No(t,e,s,n,i,r,o,a,l,g,h,g)||No(t,e,s,n,i,r,o,a,l,u,l,g)?1:0}function XE(t,e,s,n,i){const r=1-i;return r*r*r*t+3*i*r*r*e+3*i*i*r*s+i*i*i*n}function Hl(t,e,s,n){const i=1-n;return i*i*t+2*i*n*e+n*n*s}var ED=(t,e)=>2/(1+Math.exp(-Math.abs(t*e))),SD=5,ZE=5;function $f(t,e,s,n,i,r){const o=r||{x1:0,y1:0,x2:0,y2:0},a=(n+n/ZE*s)*ZE,l=-i+Math.PI,u=-i+Math.PI/2;return o.x1=t+Math.cos(l)*a,o.y1=e+Math.sin(l)*a,o.x2=t+Math.cos(u)*a,o.y2=e+Math.sin(u)*a,o}function qf(t,e,s,n,i,r,o,a){const l=a||{x1:0,y1:0,x2:0,y2:0};if(r){const u=Rz(i);if(o){const h=u*e+(1-u)*n;l.x1=t,l.y1=h,l.x2=s,l.y2=h}else{const h=u*t+(1-u)*s;l.x1=h,l.y1=e,l.x2=h,l.y2=n}}else l.x1=t,l.y1=e,l.x2=s,l.y2=n;return l}function ja(t,e,s,n,i,r){const o=r||{x:0,y:0},a=(t+s)/2,l=(e+n)/2,u=t-s,h=e-n,g=Math.sqrt(u*u+h*h);if(g===0)return o.x=a,o.y=l,o;const f=h/g,m=-u/g,y=-g*i/SD;return o.x=a+f*y,o.y=l+m*y,o}function Yf(t,e,s,n,i,r,o,a={x:0,y:0}){return a.x=(1-t)*(1-t)*e+2*(1-t)*t*r+t*t*n,a.y=(1-t)*(1-t)*s+2*(1-t)*t*o+t*t*i,a}function Xx(t,e,s,n,i,r,o,a={x:0,y:0}){return a.x=(2*t-2)*e+(2*n-4*r)*t+2*r,a.y=(2*t-2)*s+(2*i-4*o)*t+2*o,QT(a)}function eC(t,e,s,n,i,r,o,a={x:0,y:0}){return Xx(t,e,s,n,i,r,s,a),nf(a.x,a.y,0,0,Math.PI/2,a),a}function sC(t,e,s,n,i,r,o,a,l,u=0,h=!1){const g=s-2*o+i,f=n-2*a+r,m=-((s-t)*f-(n-e)*g)/((2*o-2*s)*f-(2*a-2*n)*g);if(m<0||m>1)return!1;let y=l/2;h&&(y*=1-m),y+=u;const p=Hl(s,o,i,m),x=Hl(n,a,r,m);return pn(p,x,t,e)<=y}function AD(t,e){const s=t.getAttribute("curvature"),[n,i]=t.getExtremities().getAttributes(["x","y"]),r=ja(n.x,n.y,i.x,i.y,s);return Yf(e,n.x,n.y,i.x,i.y,r.x,r.y)}function wD(t,e){const s=t.getAttribute("curvature"),[n,i]=t.getExtremities().getAttributes(["x","y"]),r=ja(n.x,n.y,i.x,i.y,s);return eC(e,n.x,n.y,i.x,i.y,r.x,r.y)}function TD(t,e){const s=t.getAttribute("curvature"),[n,i]=t.getExtremities().getAttributes(["x","y"]),r=ja(n.x,n.y,i.x,i.y,s);return Xx(e,n.x,n.y,i.x,i.y,r.x,r.y)}function Zd(t,e,s,n,i,r,o,a,l,u={x:0,y:0}){const h=(1-t)*(1-t)*(1-t),g=3*t*(1-t)*(1-t),f=3*t*t*(1-t),m=t*t*t;return u.x=h*e+g*r+f*a+m*n,u.y=h*s+g*o+f*l+m*i,u}function _y(t,e,s,n,i,r,o,a,l,u,h,g){let f=.5,m=pn(t,e,s,n)<pn(t,e,i,r)?-.01:.01,y=100;const p=Zd(f,s,n,i,r,o,a,l,u);let x,v=pn(t,e,p.x,p.y);const b=h/2+g;for(;y-- >0&&f>=0&&f<=1&&v>b&&(m>.001||m<-.001);)x=v,Zd(f,s,n,i,r,o,a,l,u,p),v=pn(t,e,p.x,p.y),v>x?(m=-m/2,f+=m):f+m<0||f+m>1?(m/=2,v=x):f+=m;return v<b}function Zx(t,e,s,n,i,r,o=Wx()){const a=t+.6666666666666666*(s-t),l=e+2/3*(n-e);return Wf(t,e,a,l,a+1/3*(i-t),l+1/3*(r-e),i,r,o)}function Wf(t,e,s,n,i,r,o,a,l=Wx()){const{min:u,max:h,sqrt:g}=Math;let f,m,y,p,x;l.minX=u(t,o),l.maxX=h(t,o),l.minY=u(e,a),l.maxY=h(e,a);for(let v,b,S,A,w,L,k,F=0;F<2;++F)if(F===0?(m=t,y=s,p=i,x=o):(m=e,y=n,p=r,x=a),b=6*m-12*y+6*p,v=-3*m+9*y-9*p+3*x,S=3*y-3*m,b|=0,v|=0,S|=0,v!==0)w=b*b-4*S*v,w<0||(L=(-b+g(w))/(2*v),L>0&&L<1&&(f=qp(L,m,y,p,x),F===0?(l.minX=u(l.minX,f),l.maxX=h(l.maxX,f)):(l.minY=u(l.minY,f),l.maxY=h(l.maxY,f))),k=(-b-g(w))/(2*v),k>0&&k<1&&(f=qp(k,m,y,p,x),F===0?(l.minX=u(l.minX,f),l.maxX=h(l.maxX,f)):(l.minY=u(l.minY,f),l.maxY=h(l.maxY,f))));else{if(b===0)continue;A=-S/b,A>0&&A<1&&(f=qp(A,m,y,p,x),F===0?(l.minX=u(l.minX,f),l.maxX=h(l.maxX,f)):(l.minY=u(l.minY,f),l.maxY=h(l.maxY,f)))}return l}function qp(t,e,s,n,i){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*s+3*(1-t)*Math.pow(t,2)*n+Math.pow(t,3)*i}function CD(t,e,s,n,i,r){const o=t-2*s+i,a=e-2*n+r,l=2*s-2*t,u=2*n-2*e,h=4*(o*o+a*a),g=4*(o*l+a*u),f=l*l+u*u,m=2*Math.sqrt(h+g+f),y=Math.sqrt(h),p=2*h*y,x=2*Math.sqrt(f),v=g/y;return(p*m+y*g*(m-x)+(4*f*h-g*g)*Math.log((2*y+v+m)/(v+x)))/(4*p)}var Zr,Jr=(Zr=class extends vh{constructor({bufferList:e,patternManager:s,boundariesManager:n,shapeManager:i,textManager:r,memoryManager:o}){super(),this._firstFrame=!0,this._width=0,this._height=0,this._pixelRatio=0,this._viewX=0,this._viewY=0,this._viewZoom=0,this._viewAngle=0,this._viewAngleCos=0,this._viewAngleSin=0,this._currentTime=0,this._scales={bytesToActualCoord:0,bytesToActualScaledSize:0,bytesToActualMinVisibleSize:0,bytesToActualSymbolicSize:0,bytesToActualDashLength:0,bytesToActualGapLength:0,bytesToActualPatternScale:0},this._shapesVersion=0,this._patternsVersion=0,this._boundariesVersion=0,this._textsVersion=0,this._backgroundRgba=[1,1,1,0],this._renderBackground=!1,this._hideImages=!1,this._genericObject=Gx(),this._littleEndian=Cf(),this._bufferList=e,this._shapeManager=i,this._patternManager=s,this._boundariesManager=n,this._textManager=r,this._memoryManager=o}static createInitData(){return null}static getName(){return null}static isAvailable(){return!0}static setEdgeArrowSizeRatio(e){Zr.edgeArrowSizeRatio=e}static setMinEdgeTipSize(e){Zr.minEdgeTipSize=e}getDomElement(){return null}_initCanvas(e){e.style.touchAction="none"}export(e){return Promise.resolve()}extractElement(e,s){return this._memoryManager.extractGenericElement(e,s,this._scales)}_compareDimensions(e,s,n){return(e!==this._width||s!==this._height||n!==this._pixelRatio)&&(this._width=e,this._height=s,this._pixelRatio=n,!0)}_compareView(e,s,n,i){return(e!==this._viewX||s!==this._viewY||n!==this._viewZoom||i!==this._viewAngle)&&(this._viewX=e,this._viewY=s,this._viewZoom=n,this._viewAngle=i,this._viewAngleCos=Math.cos(i),this._viewAngleSin=Math.sin(i),!0)}_compareCurrentTime(e){return e!==this._currentTime&&(this._currentTime=e,!0)}_compareBackgroundColor(e,s){return(e!==this._backgroundColor||s!==this._renderBackground)&&(this._renderBackground=s,this._backgroundColor=e,this._backgroundRgba=Yn(this._backgroundColor),!0)}_compareShapes(){return this._shapesVersion!==this._shapeManager.getVersion()&&(this._shapesVersion=this._shapeManager.getVersion(),!0)}_comparePatterns(){return this._patternsVersion!==this._patternManager.getVersion()&&(this._patternsVersion=this._patternManager.getVersion(),!0)}_compareBoundaries(){return this._boundariesVersion!==this._boundariesManager.getVersion()&&(this._boundariesVersion=this._boundariesManager.getVersion(),!0)}_compareTexts(){return this._textsVersion!==this._textManager.getVersion()&&(this._textsVersion=this._textManager.getVersion(),!0)}_compareIsDisplayableBuffer(e){return this._isBufferDisplayable!==e&&(this._isBufferDisplayable=e,!0)}_compareHideImages(e){return this._hideImages!==e&&(this._hideImages=e,!0)}renderFrame({x:e,y:s,zoom:n,angle:i,width:r,height:o,pixelRatio:a,backgroundColor:l,currentTime:u,isBufferDisplayable:h,hideImages:g,renderBackground:f}){const m=this._compareShapes(),y=this._comparePatterns(),p=this._compareBoundaries(),x=this._compareTexts(),v=this._compareDimensions(r,o,a),b=this._compareView(e,s,n,i),S=this._compareCurrentTime(u),A=this._compareBackgroundColor(l,f),w=this._compareIsDisplayableBuffer(h),L=this._compareHideImages(g);if(p){const k=this._boundariesManager,F=this._scales;F.bytesToActualCoord=1,F.bytesToActualScaledSize=k.maxScaledSize/A2,F.bytesToActualMinVisibleSize=k.maxMinVisibleSize/oy,F.bytesToActualSymbolicSize=k.maxSymbolicSize/Vl,F.bytesToActualDashLength=k.maxDashLength/jl,F.bytesToActualGapLength=k.maxGapLength/jl,F.bytesToActualPatternScale=k.maxPatternScale/Vl}this._firstFrame&&this._beforeFirstFrame(),this._render({shapesChanged:m,patternsChanged:y,boundariesChanged:p,textsChanged:x,dimensionsChanged:v,viewChanged:b,currentTimeChanged:S,backgroundColorChanged:A,isBufferDisplayableChanged:w,isHideImagesChanged:L}),this._firstFrame&&(this._afterFirstFrame(),this._firstFrame=!1)}_render(e){}_beforeFirstFrame(){}_afterFirstFrame(){}destroy(){}ensureAnimationsReady(){}getImageData(){return null}setViewportClipping(e){}},Zr.edgeArrowSizeRatio=T2,Zr.minEdgeTipSize=C2,Zr);function nC(t,e,s,n,i,r,o,a=0,l=!1){const u=pn(s,n,i,r),h=(o/2*(l?pn(t,e,i,r)/u:1)+a)/u,g=(i-s)*h,f=(r-n)*h,m=s+f,y=n-g,p=t-m,x=e-y,v=s-f-m,b=n+g-y,S=i+f-m,A=r-g-y,w=p*v+x*b,L=p*S+x*A;return w>0&&w<v*v+b*b&&L>0&&L<S*S+A*A}function LD(t,e,s,n,i=!1){if(i&&(qc(t,s)||qc(t,n)||qc(e,s)||qc(e,n)))return!1;let r=(t.y-s.y)*(n.x-s.x)-(t.x-s.x)*(n.y-s.y);const o=(e.x-t.x)*(n.y-s.y)-(e.y-t.y)*(n.x-s.x);if(o===0)return!1;const a=r/o;r=(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y);const l=r/o;return!(a<=0||a>=1||l<=0||l>=1)}function qc(t,e){return t.x===e.x&&t.y===e.y}function au(t,e,s,n){return Math.atan2(n-e,s-t)}function ND(t,e,s){const n=au(t.x,t.y,e.x,e.y)-au(s.x,s.y,e.x,e.y);return n<0?n+2*Math.PI:n}function MD(t,e,s,n,i,r,o,a){const l=(a-r)*(s-t)-(o-i)*(n-e);if(l===0)return null;let u=e-r;return u=((o-i)*u-(a-r)*(t-i))/l,{x:t+u*(s-t),y:e+u*(n-e)}}function fd(t,e,s,n,i,r,o,a){const l=t-s,u=e-n,h=i-o,g=r-a,f=l*g-h*u,m=(u*(t-i)-l*(e-r))/f;if(m<0||m>1)return null;const y=(h*(r-e)+g*(t-i))/f;return y>=0&&y<=1?{x:t-y*l,y:e-y*u}:null}function iC(t,e,s,n,i,r,o,a){let l;const u=[];return l=fd(t,e,s,n,i,r,i,a),l&&u.push(l),l=fd(t,e,s,n,i,a,o,a),l&&u.push(l),l=fd(t,e,s,n,o,a,o,r),l&&u.push(l),l=fd(t,e,s,n,o,r,i,r),l&&u.push(l),u}function $l(t,e,s,n,i,r,o,a){const l=((o-i)*(e-r)-(a-r)*(t-i))/((a-r)*(s-t)-(o-i)*(n-e)),u=((s-t)*(e-r)-(n-e)*(t-i))/((a-r)*(s-t)-(o-i)*(n-e));return l>=0&&l<=1&&u>=0&&u<=1}function Kx(t,e,s,n,i,r,o,a){return t>=i&&e>=r&&t<=o&&e<=a||s>=i&&n>=r&&s<=o&&n<=a||!!$l(t,e,s,n,i,r,i,a)||!!$l(t,e,s,n,o,r,o,a)||!!$l(t,e,s,n,i,r,o,r)||!!$l(t,e,s,n,i,a,o,a)}function rC(t,e,s){return Math.sqrt(Qx(t.x,t.y,e.x,e.y,s.x,s.y))}function Qx(t,e,s,n,i,r){const o=Ig(s,n,i,r);if(o===0)return Ig(t,e,s,n);let a=((t-s)*(i-s)+(e-n)*(r-n))/o;return a=Math.max(0,Math.min(1,a)),Ig(t,e,s+a*(i-s),n+a*(r-n))}function oC(t,e,s,n,i,r){const o=i-s,a=r-n;if(o===0&&a===0)return{x:s,y:n};const l=((t-s)*o+(e-n)*a)/(o*o+a*a);return l<0?{x:s,y:n}:l>1?{x:i,y:r}:{x:s+l*o,y:n+l*a}}function ID(t,e,s,n,i,r){const o=i-s,a=r-n,l=((t-s)*o+(e-n)*a)/(o*o+a*a);return{x:s+o*l,y:n+a*l}}function Xf(t,e,s,n,i,r){const o=r||{x:0,y:0},a=(t+s)/2,l=(e+n)/2,u=t-s,h=e-n,g=Math.sqrt(u*u+h*h);if(g===0)return o.x=a,o.y=l,o;const f=h/g,m=-u/g,y=-g*i/Uf;return o.x=a+f*y,o.y=l+m*y,o}function Jx(t,e,s,n,i,r){const o=r||{x1:0,y1:0,x2:0,y2:0},a=(n+n/hf*s)*hf,l=-i+Vi,u=Vi/2-i;return o.x1=t+Math.cos(l)*a,o.y1=e+Math.sin(l)*a,o.x2=t+Math.cos(u)*a,o.y2=e+Math.sin(u)*a,o}function kD(t,e,s,n){const i=Math.abs(t.x-e.x-s.x+n.x)+Math.abs(t.y-e.y-s.y+n.y)<.01,r=9*(e.x-t.x)**2,o=(-243*t.x+189*e.x+51*s.x+3*n.x)**2/1e4,a=(-48*t.x+24*e.x+21*s.x+3*n.x)**2/625,l=(-147*t.x+21*e.x+99*s.x+27*n.x)**2/1e4,u=(-27*t.x-9*e.x+24*s.x+12*n.x)**2/625,h=9/16*(s.x+n.x-t.x-e.x)**2,g=9*(e.y-t.y)**2,f=(-243*t.y+189*e.y+51*s.y+3*n.y)**2/1e4,m=(-48*t.y+24*e.y+21*s.y+3*n.y)**2/625,y=(-147*t.y+21*e.y+99*s.y+27*n.y)**2/1e4,p=(-27*t.y-9*e.y+24*s.y+12*n.y)**2/625,x=9/16*(s.y+n.y-t.y-e.y)**2,v=Math.sqrt(r+g),b=Math.sqrt(o+f),S=Math.sqrt(a+m),A=Math.sqrt(l+y),w=Math.sqrt(u+p),L=Math.sqrt(h+x);if(i)return 5/2993760*(32134*v+212600*b-97050*S+544800*A-521100*w+427368*L);const k=(-12*t.x-24*e.x+9*s.x+27*n.x)**2/625,F=(-27*t.x-99*e.x-21*s.x+147*n.x)**2/1e4,O=(-3*t.x-21*e.x-24*s.x+48*n.x)**2/625,j=(-3*t.x-51*e.x-189*s.x+243*n.x)**2/1e4,V=9*(n.x-s.x)**2,Z=(-12*t.y-24*e.y+9*s.y+27*n.y)**2/625,at=(-27*t.y-99*e.y-21*s.y+147*n.y)**2/1e4,mt=(-3*t.y-21*e.y-24*s.y+48*n.y)**2/625,K=(-3*t.y-51*e.y-189*s.y+243*n.y)**2/1e4,ut=9*(n.y-s.y)**2,ht=Math.sqrt(k+Z),nt=Math.sqrt(F+at),ot=Math.sqrt(O+mt),Mt=Math.sqrt(j+K);return 5/2993760*(16067*(v+Math.sqrt(V+ut))+106300*(b+Mt)-48525*(S+ot)+272400*(A+nt)-260550*(w+ht)+427368*L)}var RD={left:{x:-1,y:0},right:{x:1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},center:{x:0,y:0}},FD=[{name:"topLeft",dx:-1,dy:-1,cornerIndex:2},{name:"topRight",dx:1,dy:-1,cornerIndex:3},{name:"bottomLeft",dx:-1,dy:1,cornerIndex:1},{name:"bottomRight",dx:1,dy:1,cornerIndex:0}],$r={x:0,y:0};function PD(t,e,s,n,i,r,o,a,l,u,h,g){r=r||o.getNodes()._indexes;const f=l.getZoom(),m=o.getObjectList(!0),y=a.getFlexArrays().nodes.current;let p=1/0,x=0,v=-1/0;a.update();for(let b=0;b<r.length;++b){const S=r[b];if(y.excluded.get(S)||!y.detectable.get(S)||h.has(S))continue;const A=y.x.get(S),w=y.y.get(S),L=y.layer.get(S);if(L<v)continue;$r.x=A,$r.y=w;const k=l.graphToScreenCoordinates($r),F=k.x,O=k.y,j=y.shape.get(S),V=y.scalingMethod.get(S)==="scaled",Z=y.radius.get(S)*(V?f:1),at=Z+i,mt=(t-F)/at,K=(e-O)/at;if($r.x=t,$r.y=e,!(n&&aC($r,S,a,l,u)))if(u.checkShapeHit(j,mt,K)){const ut=o.getAttribute(!0,"virtual").get(S)!==0;if(at>p&&ut)continue;p=at}else{if(!s)continue;{const ut=g(y.text.content.get(S)||null),ht=y.textHidden.get(S),nt=y.text.minVisibleSize.get(S),ot=V?2*Z:1/0;if(ht||!ut||ot<nt)continue;const Mt=Yx(ut,y.text.maxLineLength.get(S)),Q=y.innerStroke.width.get(S),Et=y.text.margin.get(S),qt=y.text.padding.get(S),Vt=y.text.size.get(S),Wt=y.text.scale.get(S),oe=y.text.scaling.get(S),me=y.text.font.get(S),se=y.text.style.get(S),Jt=y.text.position.get(S),ee=u.measureText(Mt,me,se,1),ce=oe?Wt*Z*2:Vt,Ce=ee.width*ce/2+qt,ve=ee.height*ce/2+qt,Me=RD[Jt],ge=Q+Et+Z,ze=F+(ge+Ce)*Me.x,is=O+(ge+ve)*Me.y,Ge=ze+Ce,De=is-ve,He=is+ve;if(t<=ze-Ce||t>=Ge||e<=De||e>=He)continue}}x=S,v=L}return m.get(x)||null}function aC(t,e,s,n,i){const r=s.getFlexArrays().nodes.current,o=n.getZoom(),a=r.scalingMethod.get(e)==="scaled",l=r.radius.get(e)*(a?o:1),u=r.x.get(e),h=r.y.get(e),g=r.radius.get(e);for(let f=0;f<4;f++){const{name:m,cornerIndex:y}=FD[f],p=r.badges[m].scalingMethod.get(e)==="fixed",x=r.badges[m].scale.get(e),v=p?Math.min(x*l,r.radius.get(e)*x):x*l,b=r.badges[m].minVisibleSize.get(e)/2,S=r.badges[m].positionScale.get(e);if(!r.badges[m].text.content.get(e)&&!r.badges[m].image.url.get(e)||v<b)continue;const A=n.graphToScreenCoordinates({x:u+g*S*n.getCornerCos(y),y:h+g*S*n.getCornerSin(y)}),{x:w,y:L}=A,k=(t.x-w)/v,F=(t.y-L)/v;if(i.checkShapeHit("circle",k,F))return m}}function zD(t,e,s,n,i,r,o,a,l,u,h){i=i||r.getEdges()._indexes;const g=r.getObjectList(!1),f=l.getFlexArrays(),m=f.edges.current,y=f.nodes.current,p=o.getZoom(),x=o.getAngle(),v=Math.cos(x),b=Math.sin(x),S=n/p;$r.x=t,$r.y=e;const A=o.screenToGraphCoordinates($r),w=A.x,L=A.y;let k=0;l.update();for(let F=0;F<i.length;++F){const O=i[F],j=m.source.get(O),V=m.target.get(O),Z=m.excluded.get(O),at=m.detectable.get(O),mt=a.has(j),K=a.has(V);if(Z||!at||mt||K)continue;const ut=j===V,ht=m.curvature.get(O),nt=m.shape.body.get(O)==="triangle",ot=m.scalingMethod.get(O)==="scaled",Mt=m.width.get(O)/(ot?1:p),Q=y.x.get(j),Et=y.y.get(j),qt=y.x.get(V),Vt=y.y.get(V);if(ut){const Wt=y.scalingMethod.get(j)==="scaled",oe=Jx(Q,Et,ht,y.radius.get(j)/(Wt?1:p),0);if(!_y(w,L,Q,Et,Q,Et,oe.x1,oe.y1,oe.x2,oe.y2,Mt,S))continue}else if(u){const Wt=qf(Q*v-Et*b,Et*v+Q*b,qt*v-Vt*b,Vt*v+qt*b,ht,u,h);if(!_y(w,L,Q,Et,qt,Vt,Wt.x1*v+Wt.y1*b,Wt.y1*v-Wt.x1*b,Wt.x2*v+Wt.y2*b,Wt.y2*v-Wt.x2*b,Mt,S))continue}else if(ht!==0){const Wt=Xf(Q,Et,qt,Vt,ht);if(!sC(w,L,Q,Et,qt,Vt,Wt.x,Wt.y,Mt,S,nt))continue}else if(!nC(w,L,Q,Et,qt,Vt,Mt,S,nt))continue;k=O}return g.get(k)||null}function DD(t){const e=t.getNodeAttribute("radius"),s=t.getEdgeAttribute("width"),n=t.getNodes(),i=t.getEdges();let r=0,o=0;for(let a=0;a<n._indexes.length;a++){const l=n._indexes[a],u=e.get(l);u>r&&(r=u)}for(let a=0;a<i._indexes.length;a++){const l=i._indexes[a],u=s.get(l);u>o&&(o=u)}return Math.max(2*r,o)}function OD(t){return t===null?"none":t==="webgl"?"WebGL":t==="svg"?"SVG":t==="canvas"?"Canvas":t}function lC(t,e,s,n){const i=(t-e)/s,r=i*i,o=r*i,a=Vx.getCoefficients(n),l=i<.5?0:4;return $i(a[l]+a[l+1]*i+a[l+2]*r+a[l+3]*o,0,1)}function md(t,e,s,n){if(t===e)return t;const[i,r,o,a]=Yn(t),[l,u,h,g]=Yn(e);return`rgba(${Math.round(255*bs(i,l,s))},${Math.round(255*bs(r,u,s))},${Math.round(255*bs(o,h,s))},${bs(a,g,n)})`}function BD(t,e){const[s,n,i,r]=Yn(t);return`rgba(${255*s},${255*n},${255*i},${r*e})`}var KE=1/fi,uC=class extends Jr{constructor(t){super(t),this._cachePoints=[],this._nextCachePoint=0,this._tmp={x1:0,y1:0,x2:0,y2:0},this._ccp={x1:0,y1:0,x2:0,y2:0},this._pointCopies=Array(128),this._clipViewport=!0}_resetCachePoints(){this._nextCachePoint=0}_point(t,e){let s=this._cachePoints[this._nextCachePoint++];return s||(s={x:0,y:0},this._cachePoints.push(s)),s.x=t,s.y=e,s}setViewportClipping(t){this._clipViewport=t}_displayBuffer(t){const e=t.getSize(),s=t.animated;for(let n=0;n<e;++n){const i=this.extractElement(t,n);i.valid&&this._displayElement(i,s)}}_mixAttributes(t,e,s){const n=lC(this._currentTime,s.beginTime,s.duration,s.easing);return t.dashLength=bs(e.dashLength,t.dashLength,n),t.gapLength=bs(e.gapLength,t.gapLength,n),t.offsetAngle=bs(e.offsetAngle,t.offsetAngle,n),t.opacity=bs(e.opacity,t.opacity,n),t.globalMinVisibleSize=bs(e.globalMinVisibleSize,t.globalMinVisibleSize,n),t.strokeMinVisibleSize=bs(e.strokeMinVisibleSize,t.strokeMinVisibleSize,n),t.patternMinVisibleSize=bs(e.patternMinVisibleSize,t.patternMinVisibleSize,n),t.symbolicSize=bs(e.symbolicSize,t.symbolicSize,n),t.curvature=bs(e.curvature,t.curvature,n),t.fillColor=md(e.fillColor,t.fillColor,n,n),t.strokeColor=md(e.strokeColor,t.strokeColor,n,n),t.patternColor=md(e.patternColor,t.patternColor,n,n),t.x1=bs(e.x1,t.x1,n),t.y1=bs(e.y1,t.y1,n),t.x2=bs(e.x2,t.x2,n),t.y2=bs(e.y2,t.y2,n),t.rectWidthOrSourceRadiusScaled=bs(e.rectWidthOrSourceRadiusScaled,t.rectWidthOrSourceRadiusScaled,n),t.rectWidthOrSourceRadiusFixed=bs(e.rectWidthOrSourceRadiusFixed,t.rectWidthOrSourceRadiusFixed,n),t.rectHeightOrTargetRadiusScaled=bs(e.rectHeightOrTargetRadiusScaled,t.rectHeightOrTargetRadiusScaled,n),t.rectHeightOrTargetRadiusFixed=bs(e.rectHeightOrTargetRadiusFixed,t.rectHeightOrTargetRadiusFixed,n),t.thicknessOrFontSizeScaled=bs(e.thicknessOrFontSizeScaled,t.thicknessOrFontSizeScaled,n),t.thicknessOrFontSizeFixed=bs(e.thicknessOrFontSizeFixed,t.thicknessOrFontSizeFixed,n),t.strokeWidthScaled=bs(e.strokeWidthScaled,t.strokeWidthScaled,n),t.strokeWidthFixed=bs(e.strokeWidthFixed,t.strokeWidthFixed,n),t.offsetScaled=bs(e.offsetScaled,t.offsetScaled,n),t.offsetFixed=bs(e.offsetFixed,t.offsetFixed,n),t}_computeRenderInfo(t){const e=this._viewZoom,s=this._point(t.x1,t.y1),n=this._point(t.x2,t.y2),i=t.isBadge,r=i&&t.rectWidthOrSourceRadiusScaled&&t.rectWidthOrSourceRadiusFixed,o=r?Math.min(t.rectWidthOrSourceRadiusScaled*e,t.rectWidthOrSourceRadiusFixed):t.rectWidthOrSourceRadiusScaled*e+t.rectWidthOrSourceRadiusFixed,a=r?o:t.rectHeightOrTargetRadiusScaled*e+t.rectHeightOrTargetRadiusFixed,l=t.symbolicSize===0?1/0:t.symbolicSize*e;return{shape:this._shapeManager.getDefinitionFromName(t.shape),pieceId:t.pieceId,dashLength:t.dashLength,gapLength:t.gapLength,hasHead:t.hasHead,hasTail:t.hasTail,isBodyTriangle:t.isBodyTriangle,isSelfLoop:t.isSelfLoop,patternScale:t.patternScale,offsetAngle:sf(t.offsetAngle),isText:t.isText,adjustTextAngle:t.adjustTextAngle,isBadge:i,bentEnable:t.bentEnable,bentVertical:t.bentVertical,opacity:t.opacity,globalMinVisibleSize:t.globalMinVisibleSize,strokeMinVisibleSize:t.strokeMinVisibleSize,patternMinVisibleSize:t.patternMinVisibleSize,symbolicSize:l,curvature:t.curvature,pattern:t.pattern,fillColor:t.fillColor,strokeColor:t.strokeColor,patternColor:t.patternColor,pos1OnGraph:s,pos2OnGraph:n,pos1:this._graphToScreenCoordinates(s),pos2:this._graphToScreenCoordinates(n),rectWidthOrSourceRadius:o,rectHeightOrTargetRadius:a,thicknessOrFontSize:t.thicknessOrFontSizeScaled*e+t.thicknessOrFontSizeFixed,strokeWidth:t.strokeWidthScaled*e+t.strokeWidthFixed,offset:t.offsetScaled*e+t.offsetFixed}}_applyBackgroundBlending(t){t.opacity!==1&&(t.fillColor=this._blendColor(t.fillColor,t.opacity),t.strokeColor=this._blendColor(t.strokeColor,t.opacity),t.textColor=this._blendColor(t.textColor,t.opacity))}_pointArray(t){let e=this._pointCopies[t];if(!e){e=new Array(t),this._pointCopies[t]=e;for(let s=0;s<t;++s)e[s]={x:0,y:0,r:0}}return e}_scalePoints(t,e,s,n){const i=t.shape.points.length,r=this._pointArray(i);for(let l=0;l<i;++l){const u=t.shape.points[l],h=r[l];h.x=e.x+u.x*s,h.y=e.y+u.y*n,h.r=u.r*s}const o=t.pos2OnGraph.x-t.pos1OnGraph.x,a=t.pos2OnGraph.y-t.pos1OnGraph.y;if(o!==0||a!==0){const l=Math.sqrt(o*o+a*a),u=o/l,h=a/l;for(const g of r){const f=g.x-e.x,m=g.y-e.y;g.x=e.x+u*f+h*m,g.y=e.y-h*f+u*m}}return r}_drawPoints(t,e=!1){t.length===1?this._drawCircle(t[0],t[0].r):this._drawPolygon(t,e)}_computeCenter(t){const e=Math.cos(t.offsetAngle),s=Math.sin(t.offsetAngle),n=(t.pos1.x+t.pos2.x)/2+e*t.offset,i=(t.pos1.y+t.pos2.y)/2+s*t.offset;return this._point(n,i)}_displayTextBox(t,e,s,n){const i=this._computeCenter(t),r=t.rectWidthOrSourceRadius/2,o=t.rectHeightOrTargetRadius/2;(e||n)&&this._drawRoundedRectangle(i,r,o,0,t.fillColor)}_displayNodeComponent(t,e,s,n){const i=this._computeCenter(t);if(t.pattern.type!==Ho){const r=t.rectWidthOrSourceRadius/2,o=t.rectHeightOrTargetRadius/2,a=this._scalePoints(t,i,r,o);if((e||n)&&this._drawPoints(a,!0),e&&this._fill(t.fillColor),n){if(this._startClip(),t.pattern.type===bh){let l=t.pattern.attributes.colorArray;t.opacity!==1&&(l=l.map((u=>this._blendColor(u,t.opacity)))),this._displayPieChart(i,r,l)}else if(t.pattern.type===Ra||t.pattern.type===Fa){const u=Math.round(t.rectHeightOrTargetRadius*t.patternScale),h=t.pattern.attributes.text,g=this._blendColor(t.patternColor,t.opacity),f=t.pattern.attributes.font,m=t.pattern.attributes.style,y=t.pattern.attributes.align,p=t.rectWidthOrSourceRadius,x=t.pattern.attributes.paddingTop,v=t.pattern.attributes.paddingLeft;this._displayText(i,0,h,g,f,u,m,y,p,v,x,!0)}else if(t.pattern.type===Go){const l=t.pattern.attributes.image;if(l.isDummy||l.width&&l.height){const u=t.pattern.attributes.duplicated,h=u?1:t.patternScale,g=t.rectWidthOrSourceRadius*h,f=t.rectHeightOrTargetRadius*h,m=t.pattern.attributes.scaled,y=t.opacity;this._displayImage(i,g,f,l,m,u,y)}}this._endClip()}if(s){const l=t.strokeWidth/2,u=this._scalePoints(t,i,r+l,o+l);this._drawPoints(u),this._stroke(t.strokeColor,t.strokeWidth)}}else if(n){const o=t.thicknessOrFontSize,a=t.pattern.attributes.text,l=this._blendColor(t.patternColor,t.opacity),u=t.pattern.attributes.font,h=t.pattern.attributes.style,g=t.pattern.attributes.align,f=t.rectWidthOrSourceRadius;this._displayText(i,0,a,l,u,o,h,g,f,0,0,!1)}}_displayElement(t,e){if(!t.end||!t.end.shape||!t.end.pieceId||e&&(!t.start||!t.animation))return;this._resetCachePoints();const s=e?this._mixAttributes(t.end,t.start,t.animation):t.end,n=this._computeRenderInfo(s);if(n.symbolicSize<n.globalMinVisibleSize||n.opacity===0)return;this._applyBackgroundBlending(n);const i=!!(n.strokeColor&&n.strokeWidth>0&&n.symbolicSize>=n.strokeMinVisibleSize),r=n.pattern.type!==Wn&&n.symbolicSize>=n.patternMinVisibleSize,o=!!n.fillColor;if(n.pieceId===qi)return this._displayNodeComponent(n,o,i,r);if(n.pieceId===Ca)return this._displayTextBox(n,o,i,r);const a=n.pos2.x-n.pos1.x,l=n.pos2.y-n.pos1.y,u=Math.sqrt(a*a+l*l);let h,g=null,f=null;if(n.bentEnable&&!n.isSelfLoop)this._tmp.x1=n.pos1.x,this._tmp.y1=n.pos1.y,this._tmp.x2=n.pos2.x,this._tmp.y2=n.pos2.y,n.pos1.x=this._tmp.x1*this._viewAngleCos-this._tmp.y1*this._viewAngleSin,n.pos1.y=this._tmp.y1*this._viewAngleCos+this._tmp.x1*this._viewAngleSin,n.pos2.x=this._tmp.x2*this._viewAngleCos-this._tmp.y2*this._viewAngleSin,n.pos2.y=this._tmp.y2*this._viewAngleCos+this._tmp.x2*this._viewAngleSin,qf(n.pos1.x,n.pos1.y,n.pos2.x,n.pos2.y,n.curvature,n.bentEnable,n.bentVertical,this._ccp),n.pos1.x=this._tmp.x1,n.pos1.y=this._tmp.y1,n.pos2.x=this._tmp.x2,n.pos2.y=this._tmp.y2,this._tmp.x1=this._ccp.x1,this._tmp.y1=this._ccp.y1,this._tmp.x2=this._ccp.x2,this._tmp.y2=this._ccp.y2,this._ccp.x1=this._tmp.x1*this._viewAngleCos+this._tmp.y1*this._viewAngleSin,this._ccp.y1=this._tmp.y1*this._viewAngleCos-this._tmp.x1*this._viewAngleSin,this._ccp.x2=this._tmp.x2*this._viewAngleCos+this._tmp.y2*this._viewAngleSin,this._ccp.y2=this._tmp.y2*this._viewAngleCos-this._tmp.x2*this._viewAngleSin,g=this._point(this._ccp.x1,this._ccp.y1),f=this._point(this._ccp.x2,this._ccp.y2),h=kD(n.pos1,g,f,n.pos2);else if(n.isSelfLoop){const m=n.pieceId===xa||n.pieceId===xa+Ca?n.strokeWidth/2:n.rectWidthOrSourceRadius,{x1:y,y1:p,x2:x,y2:v}=this._getSelfLoopControlPoints(n.pos1,n.curvature,m);g=this._point(y,p),f=this._point(x,v),h=GD(n.pos1,g,f,n.pos2,1)}else n.curvature?(g=this._getQuadraticCurveControlPoint(n),h=UD(n.curvature,u,1)):h=u;if(n.pieceId===xa||n.pieceId===xa+Ca){const m=n.strokeWidth,y=this._getPointOnLine(n.pos1,g,f,n.pos2,.5),p=this._getTangentOnLine(n.pos1,g,f,n.pos2,.5);if(n.rectWidthOrSourceRadius>=h-m&&!n.isSelfLoop){if(!n.adjustTextAngle)return;p.x=1,p.y=0}let x=-Math.atan2(p.y,p.x);const v=sf(n.offsetAngle-x);(!n.isSelfLoop&&v<0||n.isSelfLoop&&n.offsetAngle<0)&&(p.x*=-1,p.y*=-1),(x>Math.PI/2||x<-Math.PI/2)&&(x+=Math.PI);const b=this._getOrthogonal(p),S=y.x+b.x*n.offset,A=y.y+b.y*n.offset;if(n.pieceId===xa+Ca){if(!n.fillColor)return;const w=n.rectWidthOrSourceRadius/2,L=n.rectHeightOrTargetRadius/2;this._drawRoundedRectangle(this._point(S,A),w,L,v+Math.PI/2,n.fillColor)}else{const w=this._point(S,A),L=x,k=n.thicknessOrFontSize,F=n.pattern.attributes.text,O=this._blendColor(n.patternColor,n.opacity),j=n.pattern.attributes.font,V=n.pattern.attributes.style,Z=n.pattern.attributes.align,at=n.rectWidthOrSourceRadius;this._displayText(w,L,F,O,j,k,V,Z,at,0,0,!1)}}else{const m=n.pieceId===Bx,y=n.pieceId===Ux,p=Math.cos(n.offsetAngle),x=Math.sin(n.offsetAngle);n.pos1.x+=p*n.offset,n.pos1.y+=x*n.offset,n.pos2.x+=p*n.offset,n.pos2.y+=x*n.offset;const v=n.shape.name==="line",b=n.thicknessOrFontSize,S=n.rectWidthOrSourceRadius,A=n.rectHeightOrTargetRadius,w=+n.hasHead,L=+n.hasTail,k=Math.max(Jr.minEdgeTipSize,b*Jr.edgeArrowSizeRatio),F=w*Math.min(5*S,k),O=L*Math.min(5*A,k),j=n.isSelfLoop?1/0:u-S-A,V=Math.min(0,j-F-O)/2,Z=b/2;let at=S>Z?S-Math.sqrt(S*S-Z*Z):Z;const mt=Math.max(S+O+L*V,0)-(1-w)*at;at=S>Z?A-Math.sqrt(A*A-Z*Z):Z;const K=Math.max(A+F+w*V,0)-(1-L)*at;if(m||y){const ut=y?-1:1,ht=(m?h-K:mt)-ut;let nt=null,ot=null;if((n.bentEnable||n.isSelfLoop)&&g&&f){const Mt=this._getTFromLengthOnCubicCurve(n.pos1,g,f,n.pos2,(m?K:mt)+1+n.strokeWidth/2,y);nt=this._getPointOnCubicCurve(n.pos1,g,f,n.pos2,Mt),ot=this._getTangentOnCubicCurve(n.pos1,g,f,n.pos2,Mt)}else if(n.curvature&&g){const Mt=this._getTFromLengthOnQuadraticCurve(n.pos1,g,n.pos2,ht-n.strokeWidth/2*ut);nt=this._getPointOnQuadraticCurve(n.pos1,g,n.pos2,Mt),ot=this._getTangentOnQuadraticCurve(n.pos1,g,n.pos2,Mt)}else{const Mt=ht/h;nt=this._mixPoints(n.pos1,n.pos2,Mt),ot=this._point(a/u,l/u)}if(ot.x*=ut,ot.y*=ut,o){if(n.shape.hole){const Q=this._makeEdgeExtremityPoints(nt,ot,k,n.shape.hole);this._drawPoints(Q),this._startReverseClip()}const Mt=this._makeEdgeExtremityPoints(nt,ot,k,n.shape.points);this._drawPoints(Mt),this._fill(n.fillColor),n.shape.hole&&this._endReverseClip()}if(i){if(n.shape.hole){const Et=this._makeEdgeExtremityPoints(nt,ot,k,n.shape.hole);this._drawPoints(Et),this._stroke(n.strokeColor,n.strokeWidth)}const Mt=k+n.strokeWidth/2,Q=this._makeEdgeExtremityPoints(nt,ot,Mt,n.shape.points);this._drawPoints(Q),this._stroke(n.strokeColor,n.strokeWidth)}}else{if(h-mt-K<=0)return;if(v){const ut=VD(h,b,mt,K,n.dashLength,n.gapLength);i&&(this._drawLine(n.pos1,g,f,n.pos2),this._stroke(n.strokeColor,b+2*n.strokeWidth,ut)),o&&(this._drawLine(n.pos1,g,f,n.pos2),this._stroke(n.fillColor,b,ut))}else{const ut=mt,ht=h-K;if(i){const nt=this._makeTriangleEdgeBody(n.pos1,g,f,n.pos2,ut,ht,b+n.strokeWidth/2,n.strokeWidth/2,h);this._drawPoints(nt),this._stroke(n.strokeColor,n.strokeWidth)}if(o){const nt=this._makeTriangleEdgeBody(n.pos1,g,f,n.pos2,ut,ht,b,0,h);this._drawPoints(nt),this._fill(n.fillColor)}}}}}_makeTriangleEdgeBody(t,e,s,n,i,r,o,a,l){return e?s?this._makeSelfLoopTriangleEdge(t,e,s,n,i,r,o,a,l):this._makeCurveTriangleEdge(t,e,n,i,r,o,a):this._makeStraightTriangleEdge(t,n,i,r,o,a)}_makeCurveTriangleEdge(t,e,s,n,i,r,o){const a=2*fi+2,l=this._pointArray(a),u=this._getTFromLengthOnQuadraticCurve(t,e,s,n),h=(this._getTFromLengthOnQuadraticCurve(t,e,s,i)-u)/fi,g=(o-r)/fi/2;let f=r/2,m=u;for(let y=0;y<=fi;++y){const p=this._getPointOnQuadraticCurve(t,e,s,m),x=this._getTangentOnQuadraticCurve(t,e,s,m),v=this._getOrthogonal(x),b=v.x*f,S=v.y*f,A=l[y],w=l[a-1-y];A.x=p.x+b,A.y=p.y+S,w.x=p.x-b,w.y=p.y-S,m+=h,f+=g}return l}_makeSelfLoopTriangleEdge(t,e,s,n,i,r,o,a,l){const u=2*fi+2,h=this._pointArray(u),g=this._getTFromLengthOnCubicCurve(t,e,s,n,i),f=(this._getTFromLengthOnCubicCurve(t,e,s,n,l-r,!1)-g)/fi,m=(a-o)/fi/2;let y=o/2,p=g;for(let x=0;x<=fi;++x){const v=this._getPointOnCubicCurve(t,e,s,n,p),b=this._getTangentOnCubicCurve(t,e,s,n,p),S=this._getOrthogonal(b),A=S.x*y,w=S.y*y,L=h[x],k=h[u-1-x];L.x=v.x+A,L.y=v.y+w,k.x=v.x-A,k.y=v.y-w,p+=f,y+=m}return h}_makeStraightTriangleEdge(t,e,s,n,i,r){const o=e.x-t.x,a=e.y-t.y,l=Math.sqrt(o*o+a*a),u=this._point(o/l,a/l),h=this._getOrthogonal(u),g=i/2,f=r/2,m=this._pointArray(4),y=m[0],p=m[1],x=m[2],v=m[3],b=t.x+u.x*s,S=t.y+u.y*s,A=t.x+u.x*n,w=t.y+u.y*n,L=h.x*g,k=h.y*g,F=h.x*f,O=h.y*f;return y.x=b+L,y.y=S+k,p.x=b-L,p.y=S-k,x.x=A-F,x.y=w-O,v.x=A+F,v.y=w+O,m}_makeEdgeExtremityPoints(t,e,s,n){const i=this._pointArray(n.length),r=s/2,o=t.x+e.x*r,a=t.y+e.y*r,l=e.x,u=e.y;for(let h=0;h<n.length;++h){const g=n[h],f=i[h],m=(l*g.x-u*g.y)*r,y=(u*g.x+l*g.y)*r;f.x=o+m,f.y=a+y,f.r=g.r*r}return i}_drawLine(t,e,s,n){e?s?this._drawCubicCurve(t,e,s,n):this._drawQuadraticCurve(t,e,n):this._drawStraightLine(t,n)}_getSelfLoopControlPoints(t,e,s){return Jx(t.x,t.y,e,s,this._viewAngle,this._tmp)}_getQuadraticCurveControlPoint(t){return Xf(t.pos1.x,t.pos1.y,t.pos2.x,t.pos2.y,t.curvature,this._point(0,0))}_graphToScreenCoordinates(t){const e=this._width/2,s=this._height/2,n=(t.x-this._viewX)*this._viewZoom,i=(t.y-this._viewY)*this._viewZoom,r=this._viewAngleCos,o=this._viewAngleSin,a=r*n+o*i+e,l=-o*n+r*i+s;return this._point(a,l)}_blendColor(t,e){return t&&this._backgroundColor?md(this._backgroundColor,t,e,1):t?BD(t,e):null}_getTangentOnLine(t,e,s,n,i){return e?s?this._getTangentOnCubicCurve(t,e,s,n,i):this._getTangentOnQuadraticCurve(t,e,n,i):this._getTangentOnStraightLine(t,n)}_getTangentOnStraightLine(t,e){const s=e.x-t.x,n=e.y-t.y,i=Math.sqrt(s*s+n*n);return this._point(s/i,n/i)}_getTangentOnQuadraticCurve(t,e,s,n){const i=1-n,r=i*e.x+n*s.x-(i*t.x+n*e.x),o=i*e.y+n*s.y-(i*t.y+n*e.y),a=Math.sqrt(r*r+o*o);return this._point(r/a,o/a)}_getTangentOnCubicCurve(t,e,s,n,i){const r=1-i,o=r*r,a=i*i,l=o*(e.x-t.x)+2*r*i*(s.x-e.x)+a*(n.x-s.x),u=o*(e.y-t.y)+2*r*i*(s.y-e.y)+a*(n.y-s.y),h=Math.sqrt(l*l+u*u);return this._point(l/h,u/h)}_mixPoints(t,e,s){const n=bs(t.x,e.x,s),i=bs(t.y,e.y,s);return this._point(n,i)}_getOrthogonal(t){return this._point(-t.y,t.x)}_getPointOnLine(t,e,s,n,i){return e?s?this._getPointOnCubicCurve(t,e,s,n,i):this._getPointOnQuadraticCurve(t,e,n,i):this._mixPoints(t,n,i)}_getPointOnQuadraticCurve(t,e,s,n){const i=Hl(t.x,e.x,s.x,n),r=Hl(t.y,e.y,s.y,n);return this._point(i,r)}_getPointOnCubicCurve(t,e,s,n,i){const r=XE(t.x,e.x,s.x,n.x,i),o=XE(t.y,e.y,s.y,n.y,i);return this._point(r,o)}_getTFromLengthOnCubicCurve(t,e,s,n,i,r=!0){if(!r)return 1-this._getTFromLengthOnCubicCurve(n,s,e,t,i,!0);let o=0,a=1,l=0;for(let u=0;u<10;u++){const h=(o+a)/2,g=h,f=this._getPointOnCubicCurve(t,e,s,n,g),m=Math.hypot(t.x-f.x,t.y-f.y);if(Math.abs(m-i)<.01)return h;m<i?(o=h,l=h):a=h}return l}_getTFromLengthOnQuadraticCurve(t,e,s,n){let i=t.x,r=t.y,o=0,a=0;for(let l=0;l<fi;++l){o+=KE;const u=Hl(t.x,e.x,s.x,o),h=Hl(t.y,e.y,s.y,o),g=u-i,f=h-r,m=Math.sqrt(g*g+f*f),y=a+m;if(y>n)return o-KE*((y-n)/m);a=y,i=u,r=h}return 1}};function UD(t,e,s){const n=Math.abs(t)/Uf+Hf,i=n*n,r=s-.5,o=r*r,a=1/(16*i),l=Math.sqrt(o+a),u=.5/n*Math.sqrt(i+.25);return Math.abs(2*n)*(r*l+.5*u+a*Math.log(Math.abs((r+l)/(-.5+u))))*e}function GD(t,e,s,n,i){const r=(t.x+e.x+s.x)/3,o=(t.y+e.y+s.y)/3,a=r-e.x,l=o-e.y,u=e.x-s.x,h=e.y-s.y,g=a*a+l*l,f=(u*u+h*h)/4,m=Math.sqrt(g-f);return 2*L2*m*3.14159265359*i}function VD(t,e,s,n,i,r){const o=[];if(s&&o.push(0,s),i&&r){const a=i*e,l=r*e,u=a+l,h=t-n-s-u;let g=0;for(;g<h;)o.push(a,l),g+=u;const f=t-n-s-g,m=Math.min(a,f),y=Math.max(f-m,0);o.push(m,y)}else o.push(t-n-s,0);return n&&o.push(0,n),o}var ql=0,Id=1,kd=2,va=3,QE=4,t0=0,yy=1,jD={[ql]:{min:"NEAREST",mag:"NEAREST",mipmap:!1},[Id]:{min:"LINEAR",mag:"LINEAR",mipmap:!1},[kd]:{min:"LINEAR",mag:"LINEAR",mipmap:!1},[va]:{min:"LINEAR_MIPMAP_LINEAR",mag:"LINEAR",mipmap:!0}},HD={[t0]:"ALPHA",[yy]:"RGBA"};function lu(t){return Math.ceil((t+2*jo)/Hn)*Hn}function $D(t,e,s,n,i){for(let r=0,o=t.length;r<o;++r){const a=t[r],l=a.x,u=a.y,h=l+n,g=u+i;let f=h<s&&g<s;if(f){for(let m=l;m<h;++m)if(e[m+u*s]===1){f=!1;break}}if(f){for(let m=u;m<g;++m)if(e[l+m*s]===1){f=!1;break}}if(f){for(let m=l;m<h;++m)for(let y=u;y<g;++y)e[m+y*s]=1;return t.splice(r,1),t.push({x:l,y:g},{x:h,y:u}),a}}return null}function JE(t,e,s,n,i,r,o){const a=4*t,l=e>>1<<7,u=e%2<<7;o[a]=s/Hn,o[a+1]=n/Hn,o[a+2]=l+i/Hn,o[a+3]=u+r/Hn}function qD(t,e,s,n,i,r,o){n|=0,i|=0,r|=0,o|=0,e|=0;for(let a=0;a<r;++a)for(let l=0;l<o;++l){const u=4*(n+a+(i+l)*e),h=4*(a+l*r);t[u]=s[h],t[u+1]=s[h+1],t[u+2]=s[h+2],t[u+3]=s[h+3]}}function YD(t,e){let s=0,n=4;for(let r=0;r<t.length;++r){const{width:o,height:a}=t[r],l=lu(o),u=lu(a);s+=l*u,n=Math.max(n,Math.max(l,u))}const i=Do(Math.max(n,Math.sqrt(s)));return Math.min(i,e)}function tS(t,e){return Math.floor((e-t)/2)}function eS(t,e,s,n,i,r,o){const{min:a,mag:l,mipmap:u}=jD[r],h=t[HD[o]];if(o===t0){const g=new Uint8Array(i*i);for(let f=0;f<g.length;++f)g[f]=n[4*f+3];n=g}t.activeTexture(t.TEXTURE0+s),t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,h,i,i,0,h,t.UNSIGNED_BYTE,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[l]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[a]),u&&t.generateMipmap(t.TEXTURE_2D)}function dC(t,e,s,n,i){const r=new Uint8Array(s*s*4),o=Math.ceil(s/Hn),a=new Uint8Array(o*o),l=[{x:0,y:0}];for(let u=0;u<e.length;++u){const h=e[u],g=h.id,f=lu(h.width)/Hn,m=lu(h.height)/Hn,y=$D(l,a,o,f,m);if(y){const p=h.width,x=h.height,v=h.pixels,b=f*Hn,S=m*Hn,A=y.x*Hn+tS(p,b),w=y.y*Hn+tS(x,S);qD(r,s,v,A,w,p,x),JE(g,t,A,w,b,S,i)}else{if(s<n)return dC(t,e,2*s,n,i);Uo(`exceeded max WebGL texture size of ${n}; some texts/icons/images won't be displayed`),JE(g,t,0,0,0,0,i)}}return{texture:r,size:s}}function WD(t,e,s,n){const{getDistanceFromStrokeVertically:i,getDistanceFromStrokeHorizontally:r}=t,o=e*(1-s)/2,a=(e-1)/2;for(let l=0;l<e;++l)for(let u=0;u<e;++u){const h=4*(u*e+l),g=(l-a)/o,f=(u-a)/o,m=$i(i(g,f),-1,1),y=$i(r(g,f),-1,1);XD(n,h,sS(m),sS(y))}}function sS(t){const e=(t+1)/2;return Math.floor(32768*e)}function XD(t,e,s,n){t[e]=s>>8,t[e+1]=s%256,t[e+2]=n>>8,t[e+3]=n%256}function hC(t,e){let s=-Math.PI/2;const n=2*Math.PI/t.length;for(const i of t){const r=s+n;e(i,s,r),s=r}}function cC(t,e,s,n,i){hC(e,((r,o,a)=>{t.beginPath(),t.moveTo(s,n),t.arc(s,n,i,o,a),t.fillStyle=r,t.fill()}))}var ZD=!Fn().__dummy,KD=class extends uC{constructor(t){super(t),this._canvas=Fn(),this._imgCanvas=Fn(),this._initCanvas(this._canvas),this._ctx=this._canvas.getContext("2d"),this._imgCtx=this._imgCanvas.getContext("2d")}static getName(){return"Canvas"}static isAvailable(){return ZD}getDomElement(){return this._canvas}_render({dimensionsChanged:t}){t&&P2(this._canvas,this._width,this._height,this._pixelRatio);const e=this._ctx,s=this._width*this._pixelRatio,n=this._height*this._pixelRatio;e.clearRect(0,0,s,n),this._backgroundColor&&this._renderBackground&&(e.fillStyle=this._backgroundColor,e.fillRect(0,0,s,n));const i=this._bufferList.getBuffersByAscendingDepth();for(const r of i)this._isBufferDisplayable(r)&&this._displayBuffer(r)}_drawRoundedRectangle(t,e,s,n,i){const r=this._ctx,o=this._pixelRatio,a=t.x*o,l=t.y*o;e*=o,s*=o;const u=this._textManager.getCornerRadius(),h=Math.min(u*o,s);e+=h/2,r.save(),r.translate(a,l),r.rotate(n),r.beginPath(),r.arc(e-h,s-h,h,0,Math.PI/2),r.arc(-e+h,s-h,h,Math.PI/2,Math.PI),r.arc(-e+h,-s+h,h,Math.PI,3*Math.PI/2),r.arc(e-h,-s+h,h,3*Math.PI/2,0),i&&(r.fillStyle=i,r.fill()),r.restore()}_drawCircle(t,e){const s=this._ctx,n=this._pixelRatio,i=t.x*n,r=t.y*n,o=e*n;s.beginPath(),s.arc(i,r,o,0,2*Math.PI)}_drawPolygon(t){const e=this._ctx,s=this._pixelRatio;e.beginPath();const n=t[0];e.moveTo(n.x*s,n.y*s);for(let i=1;i<t.length;++i){const r=t[i];e.lineTo(r.x*s,r.y*s)}e.closePath()}_drawStraightLine(t,e){const s=this._ctx,n=this._pixelRatio;s.beginPath(),s.moveTo(t.x*n,t.y*n),s.lineTo(e.x*n,e.y*n)}_drawQuadraticCurve(t,e,s){const n=this._ctx,i=this._pixelRatio;n.beginPath(),n.moveTo(t.x*i,t.y*i),n.quadraticCurveTo(e.x*i,e.y*i,s.x*i,s.y*i)}_drawCubicCurve(t,e,s,n){const i=this._ctx,r=this._pixelRatio;i.beginPath(),i.moveTo(t.x*r,t.y*r),i.bezierCurveTo(e.x*r,e.y*r,s.x*r,s.y*r,n.x*r,n.y*r)}_fill(t){const e=this._ctx;e.fillStyle=t,e.fill()}_stroke(t,e,s=[]){if(e===0)return;const n=this._ctx,i=this._pixelRatio;n.setLineDash(s.map((r=>r*this._pixelRatio))),n.lineWidth=e*i,n.strokeStyle=t,n.stroke()}_startClip(){this._ctx.save(),this._ctx.clip()}_endClip(){this._ctx.restore()}_startReverseClip(){this._ctx.save(),this._ctx.rect(0,0,this._canvas.width,this._canvas.height),this._ctx.clip("evenodd")}_endReverseClip(){this._ctx.restore()}_displayText(t,e,s,n,i,r,o,a,l,u,h){const g=this._ctx,f=this._pixelRatio,m=t.x*f,y=t.y*f,p=r*f,x=a==="center"?0:-l/2;if(h=h*this._viewZoom*f,u=u*this._viewZoom*f,g.save(),g.translate(m,y+f),g.rotate(-e),g.textBaseline="middle",g.textAlign=a,$o(g,i,p,o),g.fillStyle=n,s.indexOf(`
`)!==-1){const v=s.split(`
`),b=v.length;let S=(1-b)/2*p;for(let A=0;A<b;++A)g.fillText(v[A],u+x,h+S),S+=p}else g.fillText(s,u+x,h);g.restore()}_displayImage(t,e,s,n,i,r,o){if(this._hideImages||"isDummy"in n)return;let a=n;o!==1&&(a=this._blendImageOnBackground(n,o));const l=this._ctx,u=this._pixelRatio,h=t.x*u,g=t.y*u,f=e*u,m=s*u,y=a.width*u,p=a.height*u;if(i)l.drawImage(a,h-f/2,g-m/2,f,m);else if(r){const x=h-f/2,v=g-m/2,b=h+f/2,S=g+m/2;let A=h-y/2,w=g-p/2;for(;A>x;)A-=y;for(;w>v;)w-=p;const L=w;for(;A<b;){for(;w<S;)l.drawImage(a,A,w,y,p),w+=p;A+=y,w=L}}else l.drawImage(a,h-y/2,g-p/2,y,p)}_displayPieChart(t,e,s){const n=this._ctx,i=this._pixelRatio,r=t.x*i,o=t.y*i,a=e*i*2,l=2*a;s.length===1&&(n.fillStyle=s[0],n.fillRect(r-a,o-a,l,l)),s.length>1&&cC(n,s,r,o,a)}_blendImageOnBackground(t,e){const s=this._backgroundRgba,n=`rgb(${Math.round(255*s[0])},${Math.round(255*s[1])},${Math.round(255*s[2])})`;return this._imgCanvas.width=t.width,this._imgCanvas.height=t.height,this._imgCtx.clearRect(0,0,t.width,t.height),this._imgCtx.globalAlpha=1,this._imgCtx.fillStyle=n,this._imgCtx.fillRect(0,0,t.width,t.height),this._imgCtx.globalAlpha=e,this._imgCtx.drawImage(t,0,0),this._imgCanvas}getImageData(){return this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)}},gC=!1;try{gC=!!ys("svg")}catch{}var Qu="none",QD={left:"start",center:"middle",right:"end"},Bi="data-element-id",nS="data-text-component",JD="node-text",tO="edge-text",eO="badge-text";function Yl(t){return Math.round(1e3*t)/1e3}function iS(t,e,s,n,i,r){const o=ys("image");return o.setAttribute("width",Yl(n)),o.setAttribute("height",Yl(i)),o.setAttribute("x",Yl(e)),o.setAttribute("y",Yl(s)),o.setAttribute("href",t),r&&r.appendChild(o),o}function sO(t,e,s,n,i,r=1,o){const a=ys("rect");return a.setAttribute("x",t),a.setAttribute("y",e),a.setAttribute("width",s),a.setAttribute("height",n),a.setAttribute("fill",i),a.setAttribute("fill-opacity",r),o&&o.appendChild(a),a}var nO=class extends uC{constructor(t){super(t),this._svg=ys("svg"),this._defs=ys("defs"),this._styles=ys("g",{class:"styles"}),this._background=ys("rect",{width:"100%",height:"100%",fill:"none",class:"ogma-svg-background"}),this._currentElementId="0",this._currentClipPathId=null,this._clipPathCounter=0,this._defs.appendChild(this._styles),this._svg.setAttribute("pointer-events","none"),this._svg.style.userSelect="none",this._svg.appendChild(this._defs),this._svg.appendChild(this._background),this._clear()}static getName(){return"SVG"}static isAvailable(){return gC}getDomElement(){return this._svg}_render({dimensionsChanged:t}){if(t&&vx(this._svg,{width:this._width,height:this._height}),this._backgroundColor&&this._renderBackground){const s=Rl(this._backgroundColor);this._background.setAttribute("fill",s.color),this._background.setAttribute("fill-opacity",s.opacity)}const e=this._bufferList.getBuffersByAscendingDepth();this._clear(),this._svg.removeChild(this._container);for(let s=0;s<e.length;++s){const n=e[s];this._isBufferDisplayable(n)&&this._displayBuffer(n)}this._svg.appendChild(this._container)}_clear(){this._container&&this._svg.removeChild(this._container),this._container=ys("g"),this._svg.appendChild(this._container),this._clipPaths&&this._defs.removeChild(this._clipPaths),this._clipPaths=ys("g"),this._defs.appendChild(this._clipPaths),this._clipPaths.setAttribute("class","clip-paths"),this._filters&&this._defs.removeChild(this._filters),this._filters=ys("g"),this._defs.appendChild(this._filters)}_displayElement(t,e){this._currentElementId=t.id>=0?`n${t.id}`:"e"+-t.id,super._displayElement(t,e)}_addBackgroundBlendingFilter(t){const e=Yn(this._backgroundColor),s=t,n=1-t,i=[s,0,0,0,e[0]*n,0,s,0,0,e[1]*n,0,0,s,0,e[2]*n,0,0,0,1,0].join(" "),r=`filter-${this._currentElementId}`,o=ys("filter",{id:r}),a=ys("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:i});return o.appendChild(a),this._filters.appendChild(o),r}_drawRoundedRectangle(t,e,s,n,i){const r=t.x,o=t.y,a=Math.min(this._textManager.getCornerRadius(),s);e+=a/2;const l=ys("path"),u=`M ${r+e-a} ${o+s}     A ${a} ${a} 0 0 0 ${r+e} ${o+s-a}     L ${r+e} ${o-s+a}     A ${a} ${a} 0 0 0 ${r+e-a} ${o-s}     L ${r-e+a} ${o-s}     A ${a} ${a} 0 0 0 ${r-e} ${o-s+a}     L ${r-e} ${o+s-a}     A ${a} ${a} 0 0 0 ${r-e+a} ${o+s}     L ${r+e-a} ${o+s}`;l.setAttribute("d",u),l.setAttribute("fill",Qu),l.setAttribute("transform",`rotate(${J_(n)} ${t.x} ${t.y})`),l.setAttribute(Bi,this._currentElementId),this._container.appendChild(l),this._element=l,i&&this._fill(i)}_drawCircle(t,e){const{x:s,y:n}=t,i=`M ${s-e}, ${n} a ${e},${e} 0 1,0 ${2*e},0 a ${e},${e} 0 1,0 -${2*e},0`,r=ys("path");r.setAttribute("d",i),r.setAttribute("fill",Qu),r.setAttribute(Bi,this._currentElementId),this._container.appendChild(r),this._element=r}_drawPolygon(t,e){const s=ys("path");let n="";for(let i=0;i<t.length;i++){const{x:r,y:o}=t[i];n+=`${i===0?"M":"L"}${r},${o} `}n+="Z",s.setAttribute("d",n),s.setAttribute(Bi,this._currentElementId),s.setAttribute("fill",Qu),e&&s.setAttribute(nS,!0),this._container.appendChild(s),this._element=s}_drawStraightLine(t,e){const s=ys("path"),n=`M ${t.x},${t.y} L${e.x},${e.y}`;s.setAttribute("d",n),s.setAttribute(Bi,this._currentElementId),this._container.appendChild(s),this._element=s}_drawQuadraticCurve(t,e,s){const n=ys("path"),i=`M ${t.x},${t.y} Q${e.x},${e.y} ${s.x},${s.y}`;n.setAttribute("d",i),n.setAttribute("fill",Qu),n.setAttribute(Bi,this._currentElementId),this._container.appendChild(n),this._element=n}_drawCubicCurve(t,e,s,n){const i=ys("path"),r=`M ${t.x},${t.y} C${e.x},${e.y} ${s.x},${s.y} ${n.x},${n.y}`;i.setAttribute("d",r),i.setAttribute("fill",Qu),i.setAttribute(Bi,this._currentElementId),this._container.appendChild(i),this._element=i}_fill(t){const e=Rl(t);this._element.setAttribute("fill",e.color),this._element.setAttribute("fill-opacity",e.opacity),this._currentClipPathId&&this._element.setAttribute("clip-path",`url(#${this._currentClipPathId})`)}_stroke(t,e,s=[]){if(e===0)return;const n=this._element;n.setAttribute("stroke-width",e);const i=Rl(t);n.setAttribute("stroke",i.color),n.setAttribute("stroke-opacity",i.opacity),s.length>0&&n.setAttribute("stroke-dasharray",s.map(Yl).toString())}_startClip(){const t=ys("clipPath"),e=this._element.cloneNode(!1);this._currentClipPathId="clip-path-"+ ++this._clipPathCounter,t.appendChild(e),this._clipPaths.appendChild(t),t.setAttribute("id",this._currentClipPathId)}_endClip(){this._currentClipPathId=null}_startReverseClip(){const t=ys("clipPath"),e=this._element.cloneNode(!1),s=e.getAttribute("d");e.setAttribute("clip-rule","evenodd"),e.setAttribute("d",`${s} M 0 0 L ${this._width} 0 L ${this._width} ${this._height} L 0 ${this._height}`),this._currentClipPathId="clip-path-"+ ++this._clipPathCounter,t.appendChild(e),this._clipPaths.appendChild(t),t.setAttribute("id",this._currentClipPathId)}_endReverseClip(){this._currentClipPathId=null}_displayText(t,e,s,n,i,r,o="normal",a,l,u,h,g){const f=ys("g");f.setAttribute(Bi,this._currentElementId),f.setAttribute(nS,!0);let m=this._currentElementId[0]==="n"?JD:tO;g&&(m+=" "+eO),f.setAttribute("class",m);const y=Rl(n),p=y.opacity,x=Rl(y.color),v=t.x+u*this._viewZoom,b=t.y+1+h*this._viewZoom,S=Yl(v);if(f.setAttribute("font-family",i),f.setAttribute("font-size",r),o==="normal"||o==="italic")f.setAttribute("font-style",o);else if(o.includes("italic")){f.setAttribute("font-style","italic");const F=o.replace("italic","").trim();F&&f.setAttribute("font-weight",F)}else f.setAttribute("font-weight",o);f.setAttribute("fill",x.color),f.setAttribute("fill-opacity",p),e&&f.setAttribute("transform",`rotate(${J_(-e)} ${v}, ${b})`),f.setAttribute("text-anchor",QD[a]||"middle"),f.setAttribute("dominant-baseline","middle");const A=s.split(`
`),w=A.length,L=b-(w+1)/2*r,k=a==="center"?0:-l/2;for(let F=0;F<w;F++){const O=ys("text");O.appendChild(Ex(A[F])),O.setAttribute("x",S+k),O.setAttribute("y",L+(F+1)*r),f.appendChild(O)}this._currentClipPathId&&f.setAttribute("clip-path",`url(#${this._currentClipPathId})`),this._container.appendChild(f)}_displayImage(t,e,s,n,i,r,o){const a=t.x,l=t.y;if(this._hideImages||!("isDummy"in n)&&(!n.width||!n.height))return;const u=e,h=s;let g,f=n.width,m=n.height;if(i&&(f=u,m=h),r){const y=a-u/2,p=l-h/2,x=a+u/2,v=l+h/2;let b=a-f/2,S=l-m/2;for(g=ys("g"),g.setAttribute(Bi,this._currentElementId);b>y;)b-=f;for(;S>p;)S-=m;const A=S;for(;b<x;){for(;S<v;)iS(n.src,b,S,f,m,g),S+=m;S=A,b+=f}}else g=iS(n.src,a-f/2,l-m/2,f,m),g.setAttribute(Bi,this._currentElementId);if(this._currentClipPathId&&g.setAttribute("clip-path",`url(#${this._currentClipPathId})`),o!==1){const y=this._addBackgroundBlendingFilter(o);g.setAttribute("filter",`url(#${y})`)}this._container.appendChild(g)}_displayPieChart(t,e,s){const n=2*e,i=2*n,r=t.x,o=t.y;let a;const l=ys("g");l.setAttribute(Bi,this._currentElementId),s.length===1&&(a=sO(r-n,o-n,i,i,s[0],1,l)),s.length>1&&hC(s,((u,h,g)=>{const f=r+e*Math.cos(g),m=o+e*Math.sin(g),y=r+e*Math.cos(h),p=o+e*Math.sin(h),x=g-h<=Math.PI?0:1,v=`M ${f},${m} A ${e},${e} 0 ${x} 0 ${y},${p} L ${r},${o} L ${f},${m}`;a=ys("path"),a.setAttribute("d",v),a.setAttribute("fill",u),a.setAttribute("stroke-width",0),l.appendChild(a)})),this._currentClipPathId&&l.setAttribute("clip-path",`url(#${this._currentClipPathId})`),this._container.appendChild(l)}},iO=6,rO=class{constructor({gl:t,ext:e,staticProgram:s,animationProgram:n}){this._version=0,this._used=!1,this._dataBufferChanged=!1,this._gl=t,this._ext=e,this._staticProgram=s,this._animationProgram=n,this._glBuffer=this._gl.createBuffer()}setDataBuffer(t){this._dataBuffer!==t&&(this._program=t.animated?this._animationProgram:this._staticProgram,this._dataBuffer=t,this._dataBufferChanged=!0,t.hasSideData()&&!this._sideGlBuffer?this._sideGlBuffer=this._gl.createBuffer():!t.hasSideData()&&this._sideGlBuffer&&(this._gl.deleteBuffer(this._sideGlBuffer),delete this._sideGlBuffer))}setPrograms(t,e){this._staticProgram=t,this._animationProgram=e}markAsUnused(){return this._used=!1,this}getProgram(){return this._program}markAsUsed(){return this._used=!0,this}isUsed(){return this._used}draw(){const t=this._gl,e=this._dataBuffer.type,s=e===ka,n=s?this._dataBuffer.getNbSideElementsPerMainElement():1,i=e===cf?fi:1,r=this._dataBuffer.getSize(),o=this._dataBuffer.stencilUsage,a=this._dataBuffer.version,l=this._version!==a||this._dataBufferChanged;this._program.setupBaseAttributes({glBuffer:this._glBuffer,dataBuffer:l?this._dataBuffer.getByteArray():null,divisor:n}),this._program.setupTextAttributes({glBuffer:this._sideGlBuffer,dataBuffer:l&&s?this._dataBuffer.getSideByteArray():null,divisor:1}),this._program.setupStencil(o),l&&(this._version=a,this._dataBufferChanged=!1),this._ext.drawArraysInstancedANGLE(t.TRIANGLES,0,iO*i,r*n)}destroy(){this._gl.deleteBuffer(this._glBuffer),this._sideGlBuffer&&this._gl.deleteBuffer(this._sideGlBuffer)}},oO={byte:1,ubyte:1,short:2,ushort:2,ulong:4,float:4},aO={byte:"BYTE",ubyte:"UNSIGNED_BYTE",short:"SHORT",ushort:"UNSIGNED_SHORT",ulong:"UNSIGNED_LONG",float:"FLOAT"},rS=class{constructor({gl:t,ext:e,specialGlBuffers:s,metaData:n,programWrapper:i}){this._stencilUsage=Kl,this._gl=t,this._ext=e,this._specialGlBuffers=s,this._metaData=Ws(n),this._programWrapper=i}_finishInit(){const t=this._gl,e=this._ext,s=this._programWrapper.getError();if(s)throw new Error(`WebGL compilation at step "${s.step}:
${s.message}"`);const n=this._programWrapper.getProgram();this._program=n,t.useProgram(n),this._metaData.attributes.forEach((o=>{o.location=t.getAttribLocation(this._program,o.name),o.byteSize=o.size*oO[o.type],o.glType=aO[o.type]})),this._specialAttributes=this._createSpecialAttributesFunctions();const i=[],r=[];for(const o of this._metaData.attributes)o.location!==-1&&(o.name.startsWith("a_text")?r.push(o):i.push(o));this._baseAttributes=Yp(i,t,e),this._textAttributes=Yp(r,t,e),this._setupUniforms=uO(this._metaData.uniforms,t,n)}_createSpecialAttributesFunctions(){return Yp([{location:this._gl.getAttribLocation(this._program,this._metaData.vertexInfoAttribute),size:3,glType:"BYTE",byteSize:3,type:"byte",name:"special"}],this._gl,this._ext)}startPass(t){this._program||this._finishInit(),this._gl.useProgram(this._program),this._resetStencil(),this._setupUniforms(this._gl,t),this._specialAttributes.enable(this._gl),this._specialAttributes.setup(this._specialGlBuffers.vertexInfo,null,0)}_setupAttributes(t,{glBuffer:e,dataBuffer:s,divisor:n}){t.enabled&&!e?t.disable(this._gl):!t.enabled&&e&&t.enable(this._gl),e&&t.setup(e,s,n)}setupBaseAttributes(t){this._setupAttributes(this._baseAttributes,t)}setupTextAttributes(t){this._setupAttributes(this._textAttributes,t)}_resetStencil(){const t=this._gl;this._stencilUsage=Kl,t.disable(t.STENCIL_TEST)}setupStencil(t){if(t!==this._stencilUsage){const e=this._gl;t!==Kl?(e.enable(e.STENCIL_TEST),t===R2?(e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.stencilFunc(e.ALWAYS,1,1)):t===F2&&(e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.stencilFunc(e.EQUAL,0,1))):e.disable(e.STENCIL_TEST),this._stencilUsage=t}}endPass(){const t=this._gl;this._specialAttributes.disable(t),this._baseAttributes.disable(t),this._textAttributes.disable(t)}};function lO(t,e,s){return(n,i,r)=>{let o=0,a=0;for(let l=0;l<t.length;l++)a+=t[l].byteSize;e.bindBuffer(e.ARRAY_BUFFER,n),i&&e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW);for(let l=0;l<t.length;l++){const{location:u,size:h,glType:g,byteSize:f}=t[l];e.vertexAttribPointer(u,h,e[g],!1,a,o),o+=f,s.vertexAttribDivisorANGLE(u,r)}}}function uO(t,e,s){const n={};for(let i=0;i<t.length;++i){const{id:r,name:o}=t[i],a=e.getUniformLocation(s,o);a&&(n[r]=a)}return(i,r)=>{for(let o=0;o<t.length;++o){const{id:a,type:l}=t[o],u=n[a],h=r[a];if(u)switch(l){case"int":case"sampler2D":i.uniform1i(u,h);break;case"float":i.uniform1f(u,h);break;case"vec2":i.uniform2f(u,h[0],h[1]);break;case"vec3":i.uniform3f(u,h[0],h[1],h[2]);break;case"vec4":i.uniform4f(u,h[0],h[1],h[2],h[3])}}}}function dO(t){return e=>{for(let s=0;s<t.length;s++){const n=t[s].location;e.enableVertexAttribArray(n)}}}function hO(t){return e=>{for(let s=0;s<t.length;++s){const n=t[s].location;e.disableVertexAttribArray(n)}}}function Yp(t,e,s){const n=dO(t),i=hO(t);return{enable(r){n(r),this.enabled=!0},disable(r){i(r),this.enabled=!1},setup:lO(t,e,s),enabled:!1}}var Wp=`#define D3D9_FIX 0
precision highp float;
precision mediump int;
uniform vec3 u_backgroundColor;
uniform sampler2D u_patternNearestTexture;
uniform sampler2D u_patternLinearTexture;
uniform sampler2D u_patternLinearSdfTexture;
uniform sampler2D u_patternMipmapTexture;
uniform sampler2D u_shapeTexture;
varying vec4 a;
varying vec4 b;
varying vec4 c;
varying vec2 d;
varying vec2 e;
varying vec4 f;
varying float g;
#if D3D9_FIX
#else
varying float l;
varying vec2 m;
varying vec2 n;
varying vec2 o;
varying float p;
varying float q;
varying vec2 r;
varying vec2 s;
varying float t;
varying float u;
#endif
const float FILTER_NEAREST = 0.0;
const float FILTER_LINEAR = 0.0;
const float FILTER_LINEAR_SDF = 0.0;
const float FILTER_MIPMAP = 0.0;
const float SDF_GAMMA = 0.0;
const float EPSILON = 0.000000001;
const float SDF_BUFFER = (256.0 - 64.0) / 256.0; 
vec4 af(in vec4 ag, in vec4 ah) {
float ai = ah.a;
float aj = ag.a + EPSILON;
float ak = min(ai + aj, 1.0);
float r = ai / ak;
return vec4(mix(ag.rgb, ah.rgb, r), ak);
}
float al(in float am, in float an) {
float ao = (am * 256.0 + an) * 256.0;
float ap = ao / 32768.0;
return ap * 2.0 - 1.0;
}
bool aq(float ar, float as) {
return abs(ar - as) < EPSILON;
}
float at(float au) {
float bh = 2.;
vec2 bi = abs(c.rg) - c.ba - vec2(bh) + vec2(au);
float bj = min(max(bi.x, bi.y), 0.0) + length(max(bi, 0.0)) - au;
return smoothstep(0.1, .5, (1. - bj) / 10.);
}
void main() {
#if D3D9_FIX
#else
float br = o.x;
float bs = o.y;
float bt = r.x;
float bu = r.y;
#endif
vec4 bx = texture2D(u_shapeTexture, d);
float by = al(bx.b, bx.a) * s.x;
float bz = al(bx.r, bx.g) * s.y;
float ch = float(f.z > EPSILON);
float ci = float(f.w > EPSILON);
float cj = 1. - smoothstep(
0.01,
0.25760,
distance(f.xy * f.z - vec2(0.0586), d * f.z)
);
cj = cj * 2.5 - 1.5;
cj *= 0.5;
cj *= s.x;
float ck = at(g) ;
vec4 cl = a;
vec4 cm = b;
if (u > -EPSILON) {
vec2 cq = e;
float dd =
step(m.x, cq.x) *
step(cq.x, n.x) *
step(m.y, cq.y) *
step(cq.y, n.y);
float de = dd;
vec4 dh;
if (aq(u, FILTER_NEAREST)) {
dh = texture2D(u_patternNearestTexture, cq);
} else if (aq(u, FILTER_LINEAR)) { 
dh = texture2D(u_patternLinearTexture, cq);
} else if (aq(u, FILTER_LINEAR_SDF)) { 
dh = texture2D(u_patternLinearSdfTexture, cq);
dh.a = smoothstep(SDF_BUFFER - t, SDF_BUFFER + t, dh.a);
} else if (aq(u, FILTER_MIPMAP)) { 
dh = texture2D(u_patternMipmapTexture, cq);
}
dh.rgb += c.rgb;
dh.a *= de;
cl = af(cl, dh);
}
float dw = (1. - ch) * min(by, bz)
+ ch * cj;
dw = (1. - ci) * dw + ci * ck;
float ek = clamp(dw, 0.0, 1.0);
float en = clamp(dw - l, 0.0, 1.0);
float eo = ek - en;
eo = 1.0 - clamp(dw - l, 0.0, 1.0);
cl.a *= en;
cm.a *= eo * step(EPSILON, l);
vec4 ew = af(cl, cm);
float ex = ek;
ew.rgb = mix(u_backgroundColor, ew.rgb, br);
if (q > EPSILON) {
float fk = fract(bu) * q;
float fl = clamp(min(fk, bt - fk), 0.0, 1.0);
ex *= fl;
}
if (p < 0.0 || p > 1.0 || ex < EPSILON) {
discard;
}
ew.a *= ex;
ew.rgb *= ew.a;
gl_FragColor = ew;
}
`,Xp=`#define D3D9_FIX 0
#define ANIMATED 0
precision highp float;
precision mediump int;
attribute /*ushort*/ vec4 a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;
attribute /*ushort*/ vec4 a_final_patternId_fillRGBA_strokeRGBA_patternRGBA;
attribute /*float*/ vec4 a_final_x1_y1_x2_y2;
attribute /*ushort*/ vec4 a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;
attribute /*ushort*/ vec4 a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;
attribute /*ushort*/ vec4 a_final_offsetScaled_offsetFixed_paddingTop_paddingLeft;
attribute /*ushort*/ vec4 a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;
attribute /*ushort*/ vec4 a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA;
attribute /*float*/ vec4 a_prev_x1_y1_x2_y2;
attribute /*ushort*/ vec4 a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;
attribute /*ushort*/ vec4 a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;
attribute /*ushort*/ vec4 a_prev_offsetScaled_offsetFixed_paddingTop_paddingLeft;
attribute /*float*/ vec2 a_animationBeginTime_animationDuration; 
attribute /*ushort*/ vec4 a_animationEasing; 
attribute /*ushort*/ vec3 a_text_charId_charOffsetXY; 
attribute vec3 a_vertexInfo;
uniform float u_viewWidth;
uniform float u_viewHeight;
uniform float u_viewX;
uniform float u_viewY;
uniform float u_viewAngle;
uniform float u_viewZoom;
uniform float u_currentTime;
uniform float u_pixelRatio;
uniform sampler2D u_patternInfoTexture;
varying vec4 a;
varying vec4 b;
varying vec4 c;
varying vec2 d;
varying vec2 e;
varying float g;
#if D3D9_FIX
#else
varying float l;
varying vec2 m;
varying vec2 n;
varying vec2 o;
varying float p;
varying float q;
varying vec2 r;
varying vec2 s;
varying float t;
varying float u;
#endif
varying vec4 f;
const float EPSILON = 0.000001;
const float INFINITY = 10000000.0;
const float PI = 3.14159265359;
const float P2_17 = 131072.0;
const float P2_16 = 65536.0;
const float P2_14 = 32768.0;
const float P2_12 = 4096.0;
const float P2_8 = 256.0;
const float P2_7 = 128.0;
const float P2_6 = 64.0;
const float P2_5 = 32.0;
const float P2_4 = 16.0;
const float P2_3 = 8.0;
const float P2_2 = 4.0;
const float P2_1 = 2.0;
const float MAX_FLOAT16_OFFSET = 16384.0;
const float MAX_FLOAT16 = 65535.0;
const float MAX_PROGRESS = 1.0;
uniform float BYTES_TO_COORD;
uniform float BYTES_TO_SCALED_SIZE;
uniform float BYTES_TO_MIN_VISIBLE_SIZE;
uniform float BYTES_TO_SYMBOLIC_SIZE;
uniform float BYTES_TO_CURVATURE;
uniform float BYTES_TO_DASH_LENGTH;
uniform float BYTES_TO_GAP_LENGTH;
uniform float BYTES_TO_PATTERN_SCALE;
uniform float PATTERN_POSITION_UNIT_SIZE;
uniform float PATTERN_INFO_TEXTURE_SIZE;
uniform float PATTERN_NEAREST_TEXTURE_SIZE;
uniform float PATTERN_LINEAR_TEXTURE_SIZE;
uniform float PATTERN_LINEAR_SDF_TEXTURE_SIZE;
uniform float PATTERN_MIPMAP_TEXTURE_SIZE;
uniform float ROUNDED_BOX_RADIUS;
const float BYTES_TO_OFFSET_ANGLE = 0.0;
const float BYTES_TO_COLOR = 0.0;
const float SDF_FONT_SIZE = 0.0;
const float SDF_GAMMA = 0.0;
const float CURVATURE_RATIO = 0.0;
const float PATTERN_PADDING = 0.0;
const float TEXT_WIDTH_MULTIPLIER = 0.0;
const float TEXT_HEIGHT_MULTIPLIER = 0.0;
const float SELF_LOOP_CURVATURE_RATIO = 0.0;
const float EDGE_ARROW_SIZE_RATIO = 0.0;
const float EDGE_MIN_TIP_SIZE = 0.0;
const float CURVE_SUBDIVISIONS = 0.0;
const float PIECE_NODE_COMPONENT = 0.0;
const float PIECE_TEXT_BOX = 0.0;
const float PIECE_EDGE_BODY = 0.0;
const float PIECE_EDGE_HEAD = 0.0;
const float PIECE_EDGE_TAIL = 0.0;
const float PIECE_EDGE_TEXT = 0.0;
const float MAX_TEXT_SIZE = 0.0;
const float BYTES_TO_TEXT_OFFSET_X = 0.0;
const float BYTES_TO_TEXT_OFFSET_Y = 0.0;
const float FILTER_NEAREST = 0.0;
const float FILTER_LINEAR = 0.0;
const float FILTER_LINEAR_SDF = 0.0;
const float FILTER_MIPMAP = 0.0;
const float SHAPE_TEXTURE_SIZE = 0.0;
const float SIMPLE_SHAPE_SAMPLING_SIZE = 0.0;
const float COMPLEX_SHAPE_SAMPLING_SIZE = 0.0;
const float SHAPE_SAMPLING_BUFFER_RATIO = 0.0;
const float MAX_SHAPES = 0.0;
const float FIRST_COMPLEX_SHAPE_ID = 0.0;
const float SELF_LOOP_TO_CIRCLE_APPROX = 0.0;
const float NB_SHAPES_BY_SIDE = SHAPE_TEXTURE_SIZE / COMPLEX_SHAPE_SAMPLING_SIZE;
const float SHAPE_FILL_PERCENT = 1.0 - SHAPE_SAMPLING_BUFFER_RATIO;
const float T_STEP_PER_CURVE_PIECE = 1.0 / CURVE_SUBDIVISIONS;
const float HEAD_TAIL_PX_ADJUST = 1.5;
const float SDF_SMOOTH_FACTOR = 2.0;
struct pv {
float pw;
float px;
float py;
float pz;
float qa;
float qb;
float qc;
float qd;
};
struct qe {
float qf;
float qg;
float qh;
float qi;
float qj;
float qk;
float ql;
};
struct qm {
float pw;
float px;
float py;
float pz;
float qa;
float qb;
float qc;
float qd;
float qf;
float qg;
float qh;
float qi;
float qj;
float qk;
float ql;
float dc;
float qn;
float qo;
float qp;
float qq;
float qr;
float qs;
vec4 cl;
vec4 cm;
vec4 dh;
float qt;
float qu;
float qv;
float qw;
float qx;
float qy;
float qz;
float ra;
float rb;
float rc;
float rd;
float re;
float rf;
float rg;
float rh;
float ri;
float rj;
float rk;
float rl;
};
struct rm {
float eu;
vec2 rn;
vec4 cl;
vec4 cm;
float dc;
float ro;
float rp;
float py;
float rq;
vec2 rr;
float rs;
vec2 cq;
vec2 rt;
vec2 ru;
float rv;
float rw;
vec4 dh;
vec2 bd;
float rx;
float or;
vec2 ry;
vec2 rz;
vec2 sa;
};
float sb(float nq, float sc, float sd) {
float se = mod(nq, pow(2.0, sd));
return floor(se / pow(2.0, sc));
}
pv sf(float nq) {
pv sg;
sg.pw = sb(nq, 0.0, 4.0);
sg.px = sb(nq, 4.0, 8.0);
sg.py = sb(nq, 8.0, 10.0);
sg.pz = sb(nq, 10.0, 12.0);
sg.qa = sb(nq, 12.0, 13.0);
sg.qb = sb(nq, 13.0, 14.0);
sg.qc = sb(nq, 14.0, 15.0);
sg.qd = sb(nq, 15.0, 16.0);
return sg;
}
qe sh(float nq) {
qe sg;
sg.qf = sb(nq, 0.0, 8.0);
sg.qg = sb(nq, 8.0, 11.0);
sg.qh = sb(nq, 11.0, 12.0);
sg.qi = sb(nq, 12.0, 13.0);
sg.qj = sb(nq, 13.0, 14.0);
sg.qk = sb(nq, 14.0, 15.0);
sg.ql = sb(nq, 15.0, 16.0);
return sg;
}
float si(float ll) {
float sj = mod(floor(ll / 32768.0), 2.0) == 1.0 ? -1.0 : 1.0; 
float sl = mod(floor(ll / 1024.0), 32.0); 
float sn = mod(ll, 1024.0); 
float sq = float(sl == 0.0 || sl == 31.0);
return (1. - sq)
* sj * pow(2.0, sl - 15.0) * (1.0 + sn / 1024.0);
}
vec4 sr(in float nq) {
return vec4(
sb(nq, 0.0, 4.0),
sb(nq, 4.0, 8.0),
sb(nq, 8.0, 12.0),
sb(nq, 12.0, 16.0)
);
}
vec2 ss(in float nq) {
return vec2(mod(nq, 256.0), floor(nq / 256.0));
}
vec2 st(in float nq) {
float su = floor(nq / P2_6);
float sv = nq - (su * P2_6);
return vec2(su, sv);
}
vec2 sw(in float nq) {
float sx = floor(nq / P2_7);
float sy = nq - (sx * P2_7);
return vec2(sx, sy);
}
vec2 sz(in vec2 ta, in float tb) {
float tc = cos(tb);
float td = sin(tb);
return vec2(tc * ta.x + td * ta.y, -td * ta.x + tc * ta.y);
}
vec4 te(in vec4 tf) {
return floor(tf / 256.0) - 128.0;
}
vec4 tg(in vec4 tf) {
return mod(tf, 256.0) - 128.0;
}
float th(float nq) {
return nq - 128.0;
}
vec2 th(vec2 nq) {
return nq - 128.0;
}
vec2 ti(vec2 tj) {
return vec2(-tj.y, tj.x);
}
vec2 tk(vec2 tl, vec2 ih, vec2 tm, float t) {
float tn = 1.0 - t;
return (tn * tn * tl) + (2.0 * tn * t * ih) + (t * t * tm);
}
vec2 to(vec2 tl, vec2 tp, vec2 tq, vec2 tm, float t) {
float tn = 1.0 - t;
float tr = tn * tn;
float ts = tr * tn;
float tt = t * t;
float tu = tt * t;
return (ts * tl) + (3.0 * tr * t * tp) + (3.0 * tn * tt * tq) + (tu * tm);
}
vec2 tv(vec2 tl, vec2 ih, vec2 tm, float t) {
float tn = (1.0 - t);
vec2 ta = (tn * ih + t * tm) - (tn * tl + t * ih);
return normalize(ta);
}
vec2 tw(vec2 tl, vec2 ih, vec2 tm, float t) {
return ti(tv(tl, ih, tm, t));
}
vec2 tx(vec2 tl, vec2 tp, vec2 tq, vec2 tm, float t) {
float tn = 1.0 - t;
float tr = tn * tn;
float tt = t * t;
vec2 ta = tr * (tp - tl) + 2.0 * tn * t * (tq - tp) + tt * (tm - tq);
return normalize(ta);
}
vec2 ty(vec2 tl, vec2 tp, vec2 tq, vec2 tm, float t) {
return ti(tx(tl, tp, tq, tm, t));
}
float uj(float qr, float uk, float t) {
float y = abs(qr) / CURVATURE_RATIO + EPSILON;
float qw = y * y;
float tn = t - 0.5;
float tr = tn * tn;
float ul = 1.0 / (16.0 * qw);
float um = sqrt(tr + ul);
float un = (0.5 / y) * sqrt(qw + 0.25);
float uo = (abs(2.0 * y)) * ((tn * um) + (0.5 * un) + (ul * log(abs((tn + um) / (-0.5 + un)))));
return uo * uk;
}
float uz(vec2 va, vec2 vb, vec2 vc, vec2 vd) {
bool vk = abs(va.x - vb.x - vc.x + vd.x) + abs(va.y - vb.y - vc.y + vd.y) < EPSILON;
float vl = 9.0 * pow(vb.x - va.x, 2.0); 
float vo = pow(-243.0 * va.x + 189.0 * vb.x + 51.0 * vc.x + 3.0 * vd.x, 2.0) / 10000.0; 
float vp = pow(-48.0 * va.x + 24.0 * vb.x + 21.0 * vc.x + 3.0 * vd.x, 2.0) / 625.0; 
float vq = pow(-147.0 * va.x + 21.0 * vb.x + 99.0 * vc.x + 27.0 * vd.x, 2.0) / 10000.0; 
float vr = pow(-27.0 * va.x - 9.0 * vb.x + 24.0 * vc.x + 12.0 * vd.x, 2.0) / 625.0; 
float vs = (9.0 / 16.0) * pow(vc.x + vd.x - va.x - vb.x, 2.0); 
float vt = 9.0 * pow(vb.y - va.y, 2.0); 
float vv = pow(-243.0 * va.y + 189.0 * vb.y + 51.0 * vc.y + 3.0 * vd.y, 2.0) / 10000.0; 
float vw = pow(-48.0 * va.y + 24.0 * vb.y + 21.0 * vc.y + 3.0 * vd.y, 2.0) / 625.0; 
float vx = pow(-147.0 * va.y + 21.0 * vb.y + 99.0 * vc.y + 27.0 * vd.y, 2.0) / 10000.0; 
float vy = pow(-27.0 * va.y - 9.0 * vb.y + 24.0 * vc.y + 12.0 * vd.y, 2.0) / 625.0; 
float vz = (9.0 / 16.0) * pow(vc.y + vd.y - va.y - vb.y, 2.0); 
float wa = sqrt(vl + vt); 
float wc = sqrt(vo + vv); 
float wd = sqrt(vp + vw); 
float we = sqrt(vq + vx); 
float wf = sqrt(vr + vy); 
float wg = sqrt(vs + vz); 
if(vk)
return (5.0 / 2993760.0) *
(32134.0 * wa +
212600.0 * wc -
97050.0 * wd +
544800.0 * we -
521100.0 * wf +
427368.0 * wg);
float wh = pow(-12.0 * va.x - 24.0 * vb.x + 9.0 * vc.x + 27.0 * vd.x, 2.0) / 625.0; 
float wi = pow(-27.0 * va.x - 99.0 * vb.x - 21.0 * vc.x + 147.0 * vd.x, 2.0) / 10000.0; 
float wj = pow(-3.0 * va.x - 21.0 * vb.x - 24.0 * vc.x + 48.0 * vd.x, 2.0) / 625.0; 
float wk = pow(-3.0 * va.x - 51.0 * vb.x - 189.0 * vc.x + 243.0 * vd.x, 2.0) / 10000.0; 
float wl = 9.0 * pow(vd.x - vc.x, 2.0); 
float wm = pow(-12.0 * va.y - 24.0 * vb.y + 9.0 * vc.y + 27.0 * vd.y, 2.0) / 625.0; 
float wn = pow(-27.0 * va.y - 99.0 * vb.y - 21.0 * vc.y + 147.0 * vd.y, 2.0) / 10000.0; 
float wo = pow(-3.0 * va.y - 21.0 * vb.y - 24.0 * vc.y + 48.0 * vd.y, 2.0) / 625.0; 
float wp = pow(-3.0 * va.y - 51.0 * vb.y - 189.0 * vc.y + 243.0 * vd.y, 2.0) / 10000.0; 
float wq = 9.0 * pow(vd.y - vc.y, 2.0); 
float wr = sqrt(wh + wm); 
float ws = sqrt(wi + wn); 
float wt = sqrt(wj + wo); 
float wu = sqrt(wk + wp); 
float wv = sqrt(wl + wq); 
return (5.0 / 2993760.0) *
(16067.0 * (wa + wv) +
106300.0 * (wc + wu) -
48525.0 * (wd + wt) +
272400.0 * (we + ws) -
260550.0 * (wf + wr) +
427368.0 * wg);
}
float ww(float nq) {
return nq - 32.0;
}
float wx(float nq) {
return nq - 512.0;
}
float wy(float nq) {
return nq - P2_14;
}
void wz() {
gl_Position = vec4(-10.0, -10.0, 1.0, 1.0);
}
vec4 xa(vec2 xb) {
return vec4(((vec2(xb.x, u_viewHeight - xb.y) / vec2(u_viewWidth, u_viewHeight)) * 2.0 - 1.0), 0.5, 1.0);
}
float xf(float ar, float as) {
return step(ar - EPSILON, as) * step(as, ar + EPSILON);
}
bool aq(float ar, float as) {
return abs(ar - as) < EPSILON;
}
bool xg(float nq) {
return nq > 0.5;
}
vec2 xh(vec2 xi) {
return sz((xi - vec2(u_viewX, u_viewY)) * u_viewZoom, u_viewAngle) + vec2(u_viewWidth, u_viewHeight) / 2.0;
}
float xj(float or) {
return max(EDGE_MIN_TIP_SIZE, or * EDGE_ARROW_SIZE_RATIO);
}
float xk(float xl, float xm) {
return xl * BYTES_TO_SCALED_SIZE * u_viewZoom + xm;
}
float xn(float xl, float xm) {
return xl * BYTES_TO_SCALED_SIZE * MAX_FLOAT16 / MAX_FLOAT16_OFFSET * u_viewZoom + xm;
}
float xo(float xl, float xm) {
return min(xl * BYTES_TO_SCALED_SIZE * MAX_FLOAT16 / MAX_FLOAT16_OFFSET * u_viewZoom, xm);
}
float xu(float ro, float xs, float xt) {
float xv = xt - xs;
float a = 1.0 / xv;
float b = -xs / xv;
return ro * a + b;
}
struct xw {
vec2 vb;
vec2 vc;
};
xw xx(vec2 xy, float au, float qr) {
xw ns;
float xz = (au + au / SELF_LOOP_CURVATURE_RATIO * qr) * SELF_LOOP_CURVATURE_RATIO;
float ya = -u_viewAngle + PI;
float yb = -u_viewAngle + PI / 2.0;
ns.vb = xy + vec2(cos(ya), sin(ya)) * xz;
ns.vc = xy + vec2(cos(yb), sin(yb)) * xz;
return ns;
}
float yc(vec2 yd, vec2 ye, vec2 yf, vec2 yg, float yh) {
const int MAX_ITERATIONS = 10; 
const float EPSILON = 0.01; 
float yo = 0.0;
float cf = 1.0;
float yp = 0.0;
for (int yq = 0; yq < MAX_ITERATIONS; yq++) {
float yr = (yo + cf) * 0.5;
vec2 ys = to(yd, ye, yf, yg, yr);
float yt = distance(yd, ys);
if (abs(yt - yh) < EPSILON) {
return yr;
}
if (yt < yh) {
yo = yr;
yp = yr;
} else {
cf = yr;
}
}
return yp;
}
float za(vec2 yd, vec2 ye, vec2 yf, vec2 yg, float yh, bool zb) {
if (!zb) {
return 1.0 - yc(yg, yf, ye, yd, yh);
}
return yc(yd, ye, yf, yg, yh);
}
qm ze(
vec4 zf,
vec4 zg,
vec4 zh,
vec4 zi,
vec4 zj,
vec4 zk,
vec3 zl
) {
qm a;
pv bx = sf(zf.x);
qe zm = sh(zf.y);
vec4 zn = sr(zf.z);
vec2 zo = ss(zf.w);
a.pw = bx.pw;
a.px = bx.px;
a.py = bx.py;
a.pz = bx.pz;
a.qa = bx.qa;
a.qb = bx.qb;
a.qc = bx.qc;
a.qd = bx.qd;
a.qf = zm.qf;
a.qg = zm.qg;
a.qh = zm.qh;
a.qi = zm.qi;
a.qj = zm.qj;
a.qk = zm.qk;
a.ql = zm.ql;
a.dc = zn.x;
a.qn = zn.y;
a.qo = zn.z;
a.qp = zn.w;
a.qq = zo.x;
a.qr = zo.y;
a.qs = zg.x;
a.cl = sr(zg.y);
a.cm = sr(zg.z);
a.dh = sr(zg.w);
a.qt = zh.x;
a.qu = zh.y;
a.qv = zh.z;
a.qw = zh.w;
a.qx = si(zi.x);
a.qy = zi.y;
a.qz = si(zi.z);
a.ra = zi.w;
a.rb = zj.x;
a.rc = zj.y;
a.rd = zj.z;
a.re = zj.w;
a.rf = zk.x;
a.rg = wy(zk.y);
a.rk = wy(zk.z);
a.rl = wy(zk.w);
a.rh = zl.x;
float x = zl.y;
float y = mod(x, P2_8);
if (zl.z > 0.0) x += zl.z * P2_16;
a.ri = ((x - y) / P2_8) - P2_16;
a.rj = (y - P2_7) * BYTES_TO_TEXT_OFFSET_Y;
return a;
}
bool aar(const in qm a, out rm ns) {
float pw = a.pw;
float px = a.px;
float py = a.py * BYTES_TO_DASH_LENGTH;
float pz = a.pz * BYTES_TO_GAP_LENGTH;
float qa = a.qa;
float qb = a.qb;
float qc = a.qc;
float qd = a.qd;
float qf = a.qf * BYTES_TO_PATTERN_SCALE;
float qg = a.qg * BYTES_TO_OFFSET_ANGLE;
float qh = a.qh;
float qi = a.qi;
float qj = a.qj;
float qk = a.qk;
float ql = a.ql;
float dc = a.dc * BYTES_TO_COLOR;
float qn = a.qn * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;
float qo = a.qo * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;
float qp = a.qp * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;
float qr = th(a.qr);
float qs = a.qs;
vec4 cl = a.cl * BYTES_TO_COLOR;
vec4 cm = a.cm * BYTES_TO_COLOR;
vec4 dh = a.dh * BYTES_TO_COLOR;
vec2 aas = vec2(a.qt, a.qu) * BYTES_TO_COORD;
vec2 aat = vec2(a.qv, a.qw) * BYTES_TO_COORD;
vec2 yd = xh(aas);
vec2 yg = xh(aat);
float aax = float(
qj > EPSILON &&
a.qy > EPSILON &&
a.ra > EPSILON
);
float aay = 1. - aax;
float aaz = aax * xo(
a.qx,
a.qy
) + aay * xn(
a.qx,
a.qy
);
float aba = aax * xo(
a.qz,
a.ra
) + aay * xn(
a.qz,
a.ra
);
float qq = a.qq * BYTES_TO_SYMBOLIC_SIZE * u_viewZoom +
step(a.qq, EPSILON) * INFINITY;
float abb = xk(a.rb, a.rc);
float eu = xk(a.rd, a.re);
float zt = xk(a.rf, a.rg);
vec2 abc = a_vertexInfo.xy;
vec2 abd = vec2(0.0, 0.0);
float abe = aaz;
float abf = aba;
float abg = aba * qf;
if (qh > EPSILON || dc< EPSILON) {
if (a.rh < EPSILON || dc< EPSILON) return false;
abg = abb;
qs = a.rh;
aaz = abg * TEXT_WIDTH_MULTIPLIER * u_pixelRatio;
aba = abg * TEXT_HEIGHT_MULTIPLIER * u_pixelRatio;
}
bool aca = abs(qr) > EPSILON && xf(px, PIECE_EDGE_BODY) < EPSILON;
bool acb = aca && a_vertexInfo.z > EPSILON;
if (pw < EPSILON || px < EPSILON || qq < qn || acb) {
return false;
}
eu *= step(qo, qq);
float aco = 0.0;
float acp = 1.0;
float acl = 0.0;
float acn = 1.0;
float acq = 0.0;
float ada = 1.0;
float adc = 1.0;
float adm = 0.0;
float adn = 0.0;
vec2 bd;
vec2 ry;
vec2 rz;
vec2 sa;
float or;
float rx;
float aee = 0.0;
float aef = 1.0;
bool ci = xf(px, PIECE_TEXT_BOX) > EPSILON;
if (xf(px, PIECE_NODE_COMPONENT) > EPSILON || ci) {
bd = ceil((yd + yg) / 2.0);
if(length(aat - aas) > EPSILON){
ry = normalize(aat - aas) * vec2(1.,-1.);
}else{
ry = vec2(1.0, 0.0);
}
rz = ti(ry);
sa = rz;
or = aaz;
rx = aba;
} else {
adc = 0.0;
float aev = distance(yd, yg);
vec2 aew = normalize(yg - yd);
vec2 aex = (yd + yg) / 2.0;
vec2 aey = ti(aew);
vec2 ye;
vec2 yf;
if (qk > EPSILON) {
vec2 afe = sz(yd, -u_viewAngle);
vec2 aff = sz(yg, -u_viewAngle);
float afi = 1. / (1. + exp(-qr));
if (ql > EPSILON) {
float afj = afi * afe.y + (1. - afi) * aff.y;
ye = vec2(afe.x, afj);
yf = vec2(aff.x, afj);
} else {
float afk = afi * afe.x + (1. - afi) * aff.x;
ye = vec2(afk, afe.y);
yf = vec2(afk, aff.y);
}
ye = sz(ye, u_viewAngle);
yf = sz(yf, u_viewAngle);
}
vec2 afl = aex + (aey * aev * -qr / CURVATURE_RATIO);
if (xf(px, PIECE_EDGE_TEXT) > 0.0
|| xf(px, PIECE_EDGE_TEXT + PIECE_TEXT_BOX) > 0.0
) {
ci = xf(px, PIECE_EDGE_TEXT + PIECE_TEXT_BOX) > 0.0;
float afm;
float afn = eu;
eu = 0.0;
if (qd > EPSILON) {
xw ih = xx(yd, afn / 2.0, qr);
bd = to(yd, ih.vb, ih.vc, yg, 0.5);
ry = tx(yd, ih.vb, ih.vc, yg, 0.5);
rz = ti(ry);
sa = rz;
afm = .5 * uz(yd, ih.vb, ih.vc, yg);
} else if (qk > EPSILON) {
bd = to(yd, ye, yf, yg, 0.5);
ry = tx(yd, ye, yf, yg, 0.5);
rz = ti(ry);
sa = rz;
afm = uz(yd, ye, yf, yg);
} else if (abs(qr) > EPSILON) {
bd = tk(yd, afl, yg, 0.5);
ry = tv(yd, afl, yg, 0.5);
rz = ti(ry);
sa = rz;
afm = uj(qr, aev, 1.0);
} else {
bd = aex;
ry = aew;
rz = aey;
sa = aey;
afm = aev;
}
or = aaz;
rx = aba;
if(abe > afm - afn && qd < EPSILON){
if(qi > EPSILON){
ry = vec2(1.0, 0.0);
rz = vec2(0.0, 1.0);
sa = vec2(0.0, 1.0);
} else {
ry = vec2(0,0);
rz = vec2(0.0, 0.0);
sa = vec2(0.0, 0.0);
}
} else {
float tb = -atan(ry.y, ry.x);
aee = tb;
qg -= tb;
if ((tb > PI / 2.0 || tb < -PI / 2.0)) {
qg += (1.0 - qd) * PI;
aef = -1.0;
ry *= -1.0;
rz *= -1.0;
sa *= -1.0;
}
}
} else {
float afu = aaz;
float afv = aba;
float afw = xj(abb);
float afx = qa
* min(5. * afu, afw);
float afy = qb
* min(5. * afv, afw);
float afz = xf(px, PIECE_EDGE_HEAD);
float aga = xf(px, PIECE_EDGE_TAIL);
float agb = INFINITY * qd + aev - afu - afv;
float agk = min(0., agb - afx - afy)/2.;
float agp = abb / 2.;
float agq =
afu > agp
? afu - sqrt(afu * afu - agp * agp)
: agp;
float agr = max( afu +
afy
+ qb * agk,
0.) - (1. - qa) * agq;
agq =
afv > agp
? afv - sqrt(afv * afv - agp * agp)
: agp;
float ags = max( afv +
afx
+ qa * agk
, 0.) - (1. - qb) * agq;
if(qk > EPSILON && qd < EPSILON) {
agr = afu + afy / 2.;
ags = afv + afx / 2.;
}
if (afz > EPSILON || aga > EPSILON) {
vec2 agx = afz * yg + aga * yd;
float zt = afz * ags + aga * agr + (HEAD_TAIL_PX_ADJUST - 0.5);
float agy = afz * afx + aga * afy;
vec2 agz;
if (qk > EPSILON && qd < EPSILON) {
float yh = afz > EPSILON ? ags : agr;
float t = za(yd, ye, yf, yg, yh, aga > EPSILON);
agz = to(yd, ye, yf, yg, t);
ry = normalize(agz - to(yd, ye, yf, yg, t - 0.01));
if(aga > EPSILON) ry *= -1.;
bd = agz;
} else {
if (qd > EPSILON) {
xw ih = xx(yd, afu, qr);
float yh = afz * ags + aga * agr;
float t = za(yd, ih.vb, ih.vc, yg, yh, aga > EPSILON);
agz = to(yd, ih.vb, ih.vc, yg, t);
} else {
float afm = uj(qr, aev, 1.0);
float t = (afz * (afm - ags) + aga * agr) / afm;
agz = tk(yd, afl, yg, t);
}
ry = normalize(agx - agz);
bd = agx - ry * (zt - agy / 2.0);
}
rz = ti(ry);
sa = rz;
or = agy;
rx = agy;
py = 0.0;
pz = 0.0;
} else {
float ahd;
float ahe;
float ahf;
if(qk > EPSILON && qd < EPSILON) {
float ahg = za(yd, ye, yf, yg, agr, true);
float ahh = za(yd, ye, yf, yg, ags, false);
float ahi = ahh - ahg;
float ahj = a_vertexInfo.z;
float ahk = (ahg + ahi * ahj * T_STEP_PER_CURVE_PIECE);
float tt = (ahg + ahi * (ahj + 1.) * T_STEP_PER_CURVE_PIECE);
vec2 ahl = to(yd, ye, yf, yg, ahk);
vec2 ahm = to(yd, ye, yf, yg, tt);
bd = (ahl + ahm) / 2.0;
ry = normalize(ahm - ahl);
rz = ty(yd, ye, yf, yg, ahk);
sa = ty(yd, ye, yf, yg, tt);
or = distance(ahl, ahm);
ahd = uz(yd, ye, yf, yg);
ahe = ahd * ahk;
ahf = ahd * tt;
} else {
if (abs(qr) < EPSILON) {
bd = aex;
ry = aew;
rz = aey;
sa = rz;
or = aev;
ahd = aev;
ahe = 0.0;
ahf = aev;
} else {
float ahj = a_vertexInfo.z;
float ahk = ahj * T_STEP_PER_CURVE_PIECE;
float tt = ahk + T_STEP_PER_CURVE_PIECE;
if (qd < EPSILON) {
vec2 ahl = tk(yd, afl, yg, ahk);
vec2 ahm = tk(yd, afl, yg, tt);
bd = (ahl + ahm) / 2.0;
ry = normalize(ahm - ahl);
rz = tw(yd, afl, yg, ahk);
sa = tw(yd, afl, yg, tt);
or = distance(ahl, ahm);
ahd = uj(qr, aev, 1.0);
ahe = uj(qr, aev, ahk);
ahf = uj(qr, aev, tt);
} else {
xw ih = xx(yd, afu, qr);
vec2 ye = ih.vb;
vec2 yf = ih.vc;
vec2 ahl = to(yd, ye, yf, yg, ahk);
vec2 ahm = to(yd, ye, yf, yg, tt);
bd = (ahl + ahm) / 2.0;
ry = normalize(ahm - ahl);
rz = ty(yd, ye, yf, yg, ahk);
sa = ty(yd, ye, yf, yg, tt);
or = distance(ahl, ahm);
ahd = uz(yd, ye, yf, yg);
ahe = ahk * ahd;
ahf = tt * ahd;
}
}
}
rx = abb;
if(qd > EPSILON) {
xw ih = xx(yd, afu, qr);
float ahq = za(yd, ih.vb, ih.vc, yg, agr, true);
float ahh = za(yd, ih.vb, ih.vc, yg, ags, false);
acl = ahq;
acn = ahh;
} else if(qk < EPSILON) {
acl = (agr - 1.0) / ahd;
acn = MAX_PROGRESS - (ags - HEAD_TAIL_PX_ADJUST) / ahd;
}
aco = ahe / ahd;
acp = ahf / ahd;
acq = ahd;
if (abb < EPSILON)
cl.a = 0.; 
if (qc > 0.0 && agb > 5.0) {
float ahu = (ahd * rx) / (ahd - agr);
float ahv = ahd;
float qt = agr;
float qv = ahd - ags;
float a = -ahu / ahv;
float b = ahu;
float qu = a * qt + b;
float qw = a * qv + b;
float ahw = qu / (qt - qv);
float bi = -ahw * qv;
rx = min(min(bi, afu), afv);;
adn = ahw * ahv + bi + 1.0;
}
}
}
}
vec2 cq = vec2(0.0, 0.0);
vec2 rt = vec2(EPSILON, EPSILON);
vec2 ru = vec2(-EPSILON, -EPSILON);
float rv = -1.0;
float rw = 0.0;
bool ahy = false;
vec2 ahz = vec2(0,0);
vec2 aia = vec2(0,0);
vec2 aib = vec2(0,0);
if (qs > EPSILON && qq > qp) {
float aie = floor(qs / PATTERN_INFO_TEXTURE_SIZE);
float aif = qs - (aie * PATTERN_INFO_TEXTURE_SIZE);
vec4 aig = texture2D(u_patternInfoTexture, vec2(aif, aie) / 255.0) * 255.0;
vec2 aih = sw(aig.z);
vec2 aii = sw(aig.w);
rv = aih.x * 2.0 + aii.x;
float aij = 0.0;
if (aq(rv, FILTER_NEAREST)) { 
aij = PATTERN_NEAREST_TEXTURE_SIZE;
} else if (aq(rv, FILTER_LINEAR)) { 
aij = PATTERN_LINEAR_TEXTURE_SIZE;
} else if (aq(rv, FILTER_LINEAR_SDF)) { 
aij = PATTERN_LINEAR_SDF_TEXTURE_SIZE;
ahy = true;
} else if (aq(rv, FILTER_MIPMAP)) { 
aij = PATTERN_MIPMAP_TEXTURE_SIZE;
}
float aim = 1.0 / aij;
vec2 ain = (vec2(aih.y, aii.y) * PATTERN_POSITION_UNIT_SIZE) * aim / 2.0;
aia += (aig.xy * PATTERN_POSITION_UNIT_SIZE * aim) + ain;
ain -= PATTERN_PADDING * aim * 2.0;
vec2 aio = vec2(or / 2.0, rx / 2.0) * aim;
vec2 aip = vec2(eu, eu) * aim;
float air = 1.0 * u_pixelRatio;
float ais = SDF_SMOOTH_FACTOR;
if (qf > EPSILON) {
if (ahy) { 
if (a.qj > EPSILON) {
ais = SDF_SMOOTH_FACTOR * u_pixelRatio / SDF_GAMMA;
ahz = vec2(-a.rl,-a.rk);
}
rw = ais * SDF_GAMMA / abg / u_pixelRatio;
air = SDF_FONT_SIZE / abg;
} else { 
air = (ain.y / aio.y) / qf;
}
}
aib = (aio + aip) * air;
ain += PATTERN_PADDING * aim;
rt = aia - ain;
ru = aia + ain;
}
if (qh > EPSILON) {
abd.y = (a.rj) * abg;
ada = 0.0;
adc = 0.0;
abd.x = a.ri * abg * BYTES_TO_TEXT_OFFSET_X;
abd = sz(abd, aee);
abd *= aef;
}
vec2 aix = vec2(cos(qg), sin(qg)) * zt;
vec2 aiy = bd + aix + abd;
float aiz = eu * 2.0;
float aja = or + adc * (aiz + 1.0);
float ajb = rx + ada * (aiz + 1.0);
vec2 ajc = ry * aja / 2.0;
vec2 ajd = rz * ajb / 2.0;
vec2 aje = sa * ajb / 2.0;
float ajf = (acp - aco);
float ajg = abc.x / 2.0 + 0.5;
float ro = aco + ajf * ajg;
float rs = adm + (adn - adm) * ro / 2.0;
float ajh = step(pw, FIRST_COMPLEX_SHAPE_ID - EPSILON);
float aji = ajh * SIMPLE_SHAPE_SAMPLING_SIZE + (1.0 - ajh) * COMPLEX_SHAPE_SAMPLING_SIZE;
float ajj = aji / COMPLEX_SHAPE_SAMPLING_SIZE;
float ajk = ajj * SHAPE_SAMPLING_BUFFER_RATIO / 2.0;
float ajl = ajj * (1.0 - SHAPE_SAMPLING_BUFFER_RATIO);
vec2 ajs = vec2(
mod(pw, NB_SHAPES_BY_SIDE),
floor(pw / NB_SHAPES_BY_SIDE)
);
vec2 ajt = ajs + vec2(ajk) +
vec2(aco * ajl, 0.0);
vec2 ajw = vec2(ajf, 1.0) * ajl;
vec2 rn = (ajt + ajw * (abc / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE;
vec2 rr = vec2(aja / ajf, ajb) / 2.0;
float akc = py * abb;
float akd = pz * abb;
float rp = akc + akd;
float rq = (ro * acq) / rp;
cq = aia
+ aib
* (abc + ahz / rr * u_viewZoom);
ns.rn = rn;
float ch = float(pw == 1.);
f = vec4(
(ajt + ajw * (vec2(0.5,0.5) / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE,
NB_SHAPES_BY_SIDE * (1. - qh) * ch,
float(ci)
);
ns.rr = rr;
ns.eu = eu;
ns.cl = cl;
ns.cm = cm;
ns.dc = dc;
ns.ro = xu(ro, acl, acn);
ns.rp = rp;
ns.py = akc;
ns.rq = rq;
ns.rs = rs;
ns.cq = cq;
ns.rt = rt;
ns.ru = ru;
ns.rv = rv;
ns.rw = rw;
ns.dh = dh;
ns.bd = aiy;
ns.or = aja + ch;
ns.rx = ajb + ch;
ns.ry = ry;
ns.rz = rz;
ns.sa = sa;
return true;
}
float aki(float akj, float akk, vec4 akl) {
float akm = clamp(((u_currentTime - akj) / akk), 0.0, 1.0);
float r = akm;
float akn = r * r;
float ako = akn * r;
vec4 akp = akm < 0.5 ? te(akl) : tg(akl);
float akq = akp.x;
float akr = akp.y;
float aks = akp.z;
float akt = akp.w;
float aku = akq + akr * r + aks * akn + akt * ako;
return aku;
}
void main() {
qm a_final = ze(
a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,
a_final_patternId_fillRGBA_strokeRGBA_patternRGBA,
a_final_x1_y1_x2_y2,
a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,
a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,
a_final_offsetScaled_offsetFixed_paddingTop_paddingLeft,
a_text_charId_charOffsetXY
);
#if ANIMATED
float akj = a_animationBeginTime_animationDuration.x;
float akk = a_animationBeginTime_animationDuration.y;
vec4 akl = a_animationEasing;
float aaq = aki(akj, akk, akl);
qm a_prev = ze(
a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,
a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA,
a_prev_x1_y1_x2_y2,
a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,
a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,
a_prev_offsetScaled_offsetFixed_paddingTop_paddingLeft,
a_text_charId_charOffsetXY
);
const float ONE = 1.0;
a_final.pw = mix(a_prev.pw, a_final.pw, ONE);
a_final.py = mix(a_prev.py, a_final.py, aaq);
a_final.pz = mix(a_prev.pz, a_final.pz, aaq);
a_final.qa = mix(a_prev.qa, a_final.qa, ONE);
a_final.qb = mix(a_prev.qb, a_final.qb, ONE);
a_final.px = mix(a_prev.px, a_final.px, ONE);
a_final.qf = mix(a_prev.qf, a_final.qf, ONE);
a_final.qh = mix(a_prev.qh, a_final.qh, ONE);
a_final.qi = mix(a_prev.qi, a_final.qi, ONE);
a_final.qj = mix(a_prev.qj, a_final.qj, ONE);
a_final.qk = mix(a_prev.qk, a_final.qk, ONE);
a_final.qd = mix(a_prev.qd, a_final.qd, ONE);
a_final.qg = mix(a_prev.qg, a_final.qg, aaq);
a_final.dc = mix(a_prev.dc, a_final.dc, aaq);
a_final.qn = mix(a_prev.qn, a_final.qn, aaq);
a_final.qo = mix(a_prev.qo, a_final.qo, aaq);
a_final.qp = mix(a_prev.qp, a_final.qp, aaq);
a_final.qq =mix(a_prev.qq, a_final.qq, aaq);
a_final.qr = mix(a_prev.qr, a_final.qr, aaq);
a_final.qs = mix(a_prev.qs, a_final.qs, ONE);
a_final.cl = mix(a_prev.cl, a_final.cl, aaq);
a_final.cm = mix(a_prev.cm, a_final.cm, aaq);
a_final.dh = mix(a_prev.dh, a_final.dh, aaq);
a_final.qt = mix(a_prev.qt, a_final.qt, aaq);
a_final.qu = mix(a_prev.qu, a_final.qu, aaq);
a_final.qv = mix(a_prev.qv, a_final.qv, aaq);
a_final.qw = mix(a_prev.qw, a_final.qw, aaq);
a_final.qx = mix(a_prev.qx, a_final.qx, aaq);
a_final.qy = mix(a_prev.qy, a_final.qy, aaq);
a_final.qz = mix(a_prev.qz, a_final.qz, aaq);
a_final.ra = mix(a_prev.ra, a_final.ra, aaq);
a_final.rb = mix(a_prev.rb, a_final.rb, aaq);
a_final.rc = mix(a_prev.rc, a_final.rc, aaq);
a_final.rd = mix(a_prev.rd, a_final.rd, aaq);
a_final.re = mix(a_prev.re, a_final.re, aaq);
a_final.rf = mix(a_prev.rf, a_final.rf, aaq);
a_final.rg = mix(a_prev.rg, a_final.rg, aaq);
a_final.rh = mix(a_prev.rh, a_final.rh, ONE);
a_final.ri = mix(a_prev.ri, a_final.ri, ONE);
a_final.rj = mix(a_prev.rj, a_final.rj, ONE);
#endif
rm ns;
bool aky = aar(a_final, ns);
if (!aky) {
wz();
return;
}
vec2 abc = a_vertexInfo.xy;
a = ns.cl;
b = ns.cm;
c = ns.dh;
d = ns.rn;
e = ns.cq;
#if D3D9_FIX
#else
l = ns.eu;
m = ns.rt;
n = ns.ru;
o = vec2(ns.dc, ns.rs);
p = ns.ro;
q = ns.rp;
r = vec2(ns.py, ns.rq);
s = ns.rr;
t = ns.rw;
u = ns.rv;
#endif
float alb = step(abc.x, 0.0);
float alc = 1.0 - alb;
g = min(ns.rx, ROUNDED_BOX_RADIUS * 2.) * u_pixelRatio;
vec2 xb = ns.bd
+ ns.ry * (ns.or / 2.0) * abc.x
+ (alb * ns.rz + alc * ns.sa) * ns.rx / 2.0 * abc.y;
c = c * (1. - f.w)
+ vec4(
abc.x * ns.or,
abc.y * ns.rx,
ns.or,
ns.rx
) * u_pixelRatio * f.w;
gl_Position = xa(xb);
}
`,Rd=1e20,cO=class{constructor({fontSize:t=24,buffer:e=8,radius:s=6,cutoff:n=.25}={}){this._maxDimension=1,this._gridSize=1,this._fontSize=t,this._buffer=e,this._radius=s,this._cutoff=n,this._height=Math.ceil(this._fontSize+2*this._buffer*df),this._canvas=Fn(),this._canvas.height=this._height,this._canvas.width=1;const i=this._canvas.getContext("2d",{willReadFrequently:!0});this._ctx=i,i.textBaseline="middle",i.textAlign="center",i.fillStyle="black"}setOptions({fontSize:t=24,buffer:e=8,cutoff:s=.25,radius:n=6}){this._fontSize=t,this._buffer=e,this._cutoff=s,this._radius=n,this._height=Math.ceil(this._fontSize+2*this._buffer*df)}draw(t,e,s){$o(this._ctx,e,this._fontSize,s);const n=gO(this._ctx.measureText(t).width+2*this._buffer)-2*jo,i=this._height,r=n*i,o=Math.max(n,i);this._canvas.width<n&&(this._canvas.width=n,$o(this._ctx,e,this._fontSize,s),this._ctx.textAlign="center",this._ctx.textBaseline="middle",this._ctx.fillStyle="black"),r>this._gridSize&&(this._gridOuter=new Float64Array(r),this._gridInner=new Float64Array(r),this._gridSize=r),o>this._maxDimension&&(this._f=new Float64Array(o),this._d=new Float64Array(o),this._z=new Float64Array(o+1),this._v=new Int16Array(o),this._maxDimension=o),this._ctx.clearRect(0,0,n,i),this._ctx.fillText(t,n/2,i/2);const a=this._ctx.getImageData(0,0,n,i),l=new Uint8ClampedArray(r);for(let u=0;u<r;u++){const h=a.data[4*u+3]/255;this._gridOuter[u]=h===1?0:h===0?Rd:Math.pow(Math.max(0,.5-h),2),this._gridInner[u]=h===1?Rd:h===0?0:Math.pow(Math.max(0,h-.5),2)}oS(this._gridOuter,n,i,this._f,this._d,this._v,this._z),oS(this._gridInner,n,i,this._f,this._d,this._v,this._z);for(let u=0;u<r;u++){const h=this._gridOuter[u]-this._gridInner[u];l[u]=Math.max(0,Math.min(255,Math.round(255-255*(h/this._radius+this._cutoff))))}return{height:i,width:n,distance:l}}};function oS(t,e,s,n,i,r,o){for(let a=0;a<e;a++){for(let l=0;l<s;l++)n[l]=t[l*e+a];aS(n,i,r,o,s);for(let l=0;l<s;l++)t[l*e+a]=i[l]}for(let a=0;a<s;a++){for(let l=0;l<e;l++)n[l]=t[a*e+l];aS(n,i,r,o,e);for(let l=0;l<e;l++)t[a*e+l]=Math.sqrt(i[l])}}function aS(t,e,s,n,i){s[0]=0,n[0]=-Rd,n[1]=+Rd;for(let r=1,o=0;r<i;r++){let a=(t[r]+r*r-(t[s[o]]+s[o]*s[o]))/(2*r-2*s[o]);for(;a<=n[o];)o--,a=(t[r]+r*r-(t[s[o]]+s[o]*s[o]))/(2*r-2*s[o]);o++,s[o]=r,n[o]=a,n[o+1]=+Rd}for(let r=0,o=0;r<i;r++){for(;n[o+1]<r;)o++;e[r]=(r-s[o])*(r-s[o])+t[s[o]]}}function gO(t){return Math.ceil((t+2*jo)/Hn)*Hn}var Yc=256,fO=.275,mO=.25,pO=6,_O=Sz-2*jo,yO=Ez-2*jo,lS={fontSize:Wd,cutoff:fO,radius:pO},xO={fontSize:Wd,cutoff:mO,radius:8},vO=class{constructor(t,e){this._patternIdToInfoTexture=new Uint8Array(Yc*Yc*4),this._glTextures=[],this._textureSizes=[],this._pixelRatio=1,this._gl=t,this._glUnit=e;const s=Fn(nr,nr),n=s.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("Pattern: could not get 2d context");this._imageCanvasContext=n,this._imageCanvas=s,this._sdfGenerator=new cO(lS),this._maxTextureSize=Math.min(4096,t.getParameter(t.MAX_TEXTURE_SIZE))}refresh(t){this._pixelRatio=t.getPixelRatio();const e=this._gl,s=this._getPatternsByFilter(t.getPatternList());for(let r=0;r<s.length;++r){const o=r,a=s[r],l=YD(a,this._maxTextureSize),{texture:u,size:h}=dC(o,a,l,this._maxTextureSize,this._patternIdToInfoTexture),g=this._glTextures[o]||(this._glTextures[o]=e.createTexture()),f=o===ql?t0:yy;eS(e,g,this._glUnit+1+o,u,h,o,f),this._textureSizes[o]=h}const n=this._glTextureInfo||(this._glTextureInfo=e.createTexture()),i=this._patternIdToInfoTexture;eS(e,n,this._glUnit,i,Yc,ql,yy)}bindMetaDataTexture(){const t=this._gl;t.activeTexture(t.TEXTURE0+this._glUnit),t.bindTexture(t.TEXTURE_2D,this._glTextureInfo)}getInfoTextureUnit(){return this._glUnit}getNearestTextureUnit(){return this._glUnit+1+ql}getLinearTextureUnit(){return this._glUnit+1+Id}getLinearSdfTextureUnit(){return this._glUnit+1+kd}getMipmapTextureUnit(){return this._glUnit+1+va}getInfoTextureSize(){return Yc}getNearestTextureSize(){return this._textureSizes[ql]}getLinearTextureSize(){return this._textureSizes[Id]}getLinearSdfTextureSize(){return this._textureSizes[kd]}getMipmapTextureSize(){return this._textureSizes[va]}_getPatternsByFilter(t){const e=new Array(QE);for(let s=0;s<QE;++s)e[s]=[];for(let s=0;s<t.length;++s){const n=this._getPatternPixels(t[s]);e[n.filter].push(n)}return e}_getPatternPixels({id:t,type:e,attributes:s}){let n;const{text:i,font:r,style:o,image:a,scaled:l,duplicated:u,colorArray:h}=s;switch(e){case Go:n=u?this._getDuplicatedImagePixels(a):l?this._getScaledImagePixels(a):this._getNonScaledImagePixels(a);break;case Ta:n=this._getSdfTextPixels(i,r,o);break;case Ra:n=this._getIconPixels(i,r,o);break;case Fa:n=this._getBadgeIconPixels(i,r,o);break;case bh:n=this._getPieChartPixels(h);break;default:throw new Error(`pattern type "${e}" does not exist`)}return n.id=t,n}_getScaledImagePixels(t){let e=t.width,s=t.height;if(e>0){const n=nr/Math.max(t.width,t.height);e*=n,s*=n}return e&&s&&(e=lu(e),s=lu(s)),e-=2*jo,s-=2*jo,this._getImagePixels(t,e,s)}_getNonScaledImagePixels(t){return this._getImagePixels(t,t.width,t.height)}_getDuplicatedImagePixels(t){if(t.width===0||t.height===0)return this._getImagePixels(t,0,0);this._canvasForDuplicatedImage||(this._canvasForDuplicatedImage=Fn(nr,nr));const e=this._canvasForDuplicatedImage,s=e.getContext("2d"),n=t.width,i=t.height;let r=(nr-n)/2,o=(nr-i)/2;for(;r>0;)r-=n;for(;o>0;)o-=i;for(let a=r;a<nr;a+=n)for(let l=o;l<nr;l+=i)s.drawImage(t,a,l);return this._getImagePixels(e,nr,nr)}_getImagePixels(t,e,s){let n;if(e===0||s===0)n=new Uint8Array(0);else{(this._imageCanvas.width<e||this._imageCanvas.height<s)&&(this._imageCanvas.width=e,this._imageCanvas.height=s);const i=this._imageCanvasContext;fy(this._imageCanvas,i,e,s);try{i.drawImage(t,0,0,e,s)}catch{}n=i.getImageData(0,0,e,s).data}return{width:e,height:s,pixels:n,filter:va}}_getPieChartPixels(t){const e=yO,s=this._imageCanvasContext,n=e/2,i=e/2;return fy(this._imageCanvas,s,e,e),s.save(),s.rect(0,0,e,e),s.clip(),cC(s,t,n,i,e),s.restore(),{width:e,height:e,pixels:s.getImageData(0,0,e,e).data,filter:Id}}_getTextPixels(t,e,s,n,i,r){const o=this._imageCanvasContext,a=i*this._pixelRatio;$o(o,s,a,n);let l=Math.ceil(o.measureText(e).width);l===0&&(l=a);let u=0,h=0;t===va||(u=2*Math.ceil(a*df/2),h=2*Math.ceil(l*w2/2));const g=Math.ceil(l+h),f=Math.ceil(a+u),m=this._imageCanvas.height<f||this._imageCanvas.width<g;return this._imageCanvas.height<f&&(this._imageCanvas.height=f),this._imageCanvas.width<g&&(this._imageCanvas.width=g),m&&$o(o,s,a,n),o.clearRect(0,0,g,f),o.fillStyle="black",o.textBaseline="middle",o.textAlign="left",o.fillText(e,r+h/2,f/2),{width:g,height:f,pixels:o.getImageData(0,0,g,f).data,filter:t}}_getIconPixels(t,e,s){return this._getTextPixels(va,t,e,s,_O,0)}_getBadgeIconPixels(t,e,s){return this._sdfGenerator.setOptions(xO),this._getSdfPixels(t,e,s)}_getSdfTextPixels(t,e,s){return this._sdfGenerator.setOptions(lS),this._getSdfPixels(t,e,s)}_getSdfPixels(t,e,s){const{width:n,height:i,distance:r}=this._sdfGenerator.draw(t,e,s),o=new Uint8Array(n*i*4);for(let a=0;a<r.length;++a)o[4*a+3]=r[a];return{width:n,height:i,pixels:o,filter:kd}}},bO=class{constructor(t,e){this._gl=t,this._glTextureUnit=e,this._simpleShapePixels=new Uint8Array(Rg*Rg*4),this._complexShapePixels=new Uint8Array(Po*Po*4),this._shapesWritten=new Set}refresh(t){const e=t.getShapeList();for(const s of e)if(!this._shapesWritten.has(s.id)){const n=s.isSimple?Rg:Po,i=s.isSimple?this._simpleShapePixels:this._complexShapePixels;WD(s,n,ly,i),this._loadShapeInGpu(s.id,n,i),this._shapesWritten.add(s.id)}}_loadShapeInGpu(t,e,s){const n=this._gl,i=dy,r=t%uy*Po,o=Math.floor(t/uy)*Po;if(this._texture)n.bindTexture(n.TEXTURE_2D,this._texture);else{const a=new Uint8Array(i*i*4);this._texture=n.createTexture(),n.activeTexture(n.TEXTURE0+this._glTextureUnit),n.bindTexture(n.TEXTURE_2D,this._texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,i,i,0,n.RGBA,n.UNSIGNED_BYTE,a)}n.texSubImage2D(n.TEXTURE_2D,0,r,o,e,e,n.RGBA,n.UNSIGNED_BYTE,s)}getTextureSize(){return dy}getSamplingSize(){return Po}getBufferRatio(){return ly}getTextureUnit(){return this._glTextureUnit}rewriteShape(t){this._shapesWritten.delete(t)}},uS=class{constructor(t,{vertex:e,fragment:s,constants:n,macros:i}){this._state=0,this._gl=t,this._vertexSource=e,this._fragmentSource=s,this._constants=Ws(n||{}),this._macros=Ws(i||{})}setConstant(t,e){this._constants[t]=e}setMacro(t,e){this._macros[t]=e}getState(){return this._state}getProgram(){return this._program}compile(){const t=this._gl,e=dS(this._vertexSource,this._macros,this._constants),s=dS(this._fragmentSource,this._macros,this._constants);this._program&&(t.deleteProgram(this._program),t.deleteShader(this._vertexShader),t.deleteShader(this._fragmentShader));const n=t.createProgram(),i=t.createShader(t.VERTEX_SHADER),r=t.createShader(t.FRAGMENT_SHADER);if(!(n&&i&&r))throw new Error("Error instantiating WebGL program");this._program=n,this._vertexShader=i,this._fragmentShader=r,t.shaderSource(this._vertexShader,e),t.compileShader(this._vertexShader),t.attachShader(this._program,this._vertexShader),t.shaderSource(this._fragmentShader,s),t.compileShader(this._fragmentShader),t.attachShader(this._program,this._fragmentShader),t.linkProgram(this._program),this._state=1}getError(){const t=this._gl;if(!t.getShaderParameter(this._vertexShader,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(this._vertexShader)||"";let s=e;const n=e.match(/ERROR: (\d+):(\d+):(.*)\n/g);if(n&&n.length){const i=this._vertexSource.split(`
`);s=n.map((r=>{const o=r.match(/ERROR: (\d+):(\d+):(.*)\n/);if(!o)return r;const[a,l]=o.slice(2);return`${i[+a]}
${i[+a+1]}
~~~~~~~~~~~
${i[+a+2]}
 -> ${l}`})).join(`
`)}return{step:"vertex",message:s}}return t.getShaderParameter(this._fragmentShader,t.COMPILE_STATUS)?t.getProgramParameter(this._program,t.LINK_STATUS)?(this._state=2,null):{step:"link",message:t.getProgramInfoLog(this._program)||""}:{step:"fragment",message:t.getShaderInfoLog(this._fragmentShader)||""}}};function dS(t,e,s){const n=Object.keys(e),i=Object.keys(s);for(let r=0;r<n.length;++r){const o=n[r],a=e[o];t=t.replace(`#define ${o} 0`,`#define ${o} ${a}`)}for(let r=0;r<i.length;++r){const o=i[r],a=s[o],l=a+(a%1==0?".0":"");t=t.replace(`const float ${o} = 0.0;`,`const float ${o} = ${l};`)}return t}function EO(){return typeof window<"u"&&!!window.FORCE_WEBGL}/** @preserve instance id */var hS=$2(),SO={stencil:!0,antialias:!1,alpha:!0,premultipliedAlpha:!0,failIfMajorPerformanceCaveat:!EO()},AO=0,wO=1,TO={NO_WEBGL:'Unable to create a WebGL context: `canvas.getContext("webgl")` and `canvas.getContext("experimental-webgl")` returned `null`',NO_ANGLE_INSTANCED_ARRAYS:'WebGL extension "ANGLE_instanced_arrays" unavailable: `gl.getExtension("ANGLE_instanced_arrays")` returned `null`'},fC=class extends Error{};function Zp(t,e){if(!t&&e){const s=new fC(TO[e]);throw s.code=e,s}}var CO=class mC extends Jr{constructor(e){super(e),this._2dcanvas=Fn(),this._ctx=this._2dcanvas.getContext("2d"),this._bufferDrawers=[],this._mustResize=!1,this._error=null,this._onContextLost=l=>{l.preventDefault(),this._error=new fC("WebGL context lost"),this.fire("error",this._error)};const s=mC.createInitData(),{canvas:n,gl:i,ext:r,staticProgramWrapper:o,animationProgramWrapper:a}=s;Zp(i,"NO_WEBGL"),Zp(r,"NO_ANGLE_INSTANCED_ARRAYS"),this._glCanvas=n,this._gl=i,this._ext=r,this._staticProgramWrapper=o,this._animationProgramWrapper=a,this._shapeTexture=new bO(this._gl,AO),this._patternTexture=new vO(this._gl,wO),this._initCanvas(this._glCanvas),this._computeShaderInfo(),this._initSpecialGlBuffers(),this._initGlPrograms(),this._initGl()}_initCanvas(e){super._initCanvas(e),e.addEventListener("webglcontextlost",this._onContextLost,!1)}static isAvailable(){return hS||Zp(null,"NO_WEBGL"),hS}static createInitData(){const e=Fn(),s=qx(e,SO,"webgl"),n=s&&typeof s.getExtension=="function"?s.getExtension("ANGLE_instanced_arrays"):null,i=MO(),r=new uS(s,{vertex:Xp,fragment:Wp,constants:i,macros:{ANIMATED:0}}),o=new uS(s,{vertex:Xp,fragment:Wp,constants:i,macros:{ANIMATED:1}});return s&&n&&(r.compile(),s.flush()),{canvas:e,gl:s,ext:n,staticProgramWrapper:r,animationProgramWrapper:o}}static getName(){return"WebGL"}_beforeFirstFrame(){this._animationProgramWrapper.getState()===0&&this._animationProgramWrapper.compile()}ensureAnimationsReady(){const e=this._animationProgramWrapper.getState();e!==2&&(e===0&&this._animationProgramWrapper.compile(),this._animationProgramWrapper.getError())}getDomElement(){return this._glCanvas}_initGl(){const e=this._gl;e.clearColor(0,0,0,0),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA)}_computeShaderInfo(){this._shaderMetadata=LO(Xp,Wp)}_initGlPrograms(){this._staticProgram=new rS({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._staticProgramWrapper}),this._animationProgram=new rS({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._animationProgramWrapper})}_initSpecialGlBuffers(){const e=this._gl,s=e.createBuffer(),n=new Int8Array(18*fi);for(let i=0;i<fi;++i){const r=[-1,-1,i,1,-1,i,1,1,i,-1,-1,i,-1,1,i,1,1,i],o=i*r.length;for(let a=0;a<r.length;a++)n[a+o]=r[a]}e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),this._specialGlBuffers={vertexInfo:s}}_computeUniforms(){return{viewWidth:this._width,viewHeight:this._height,viewX:this._viewX,viewY:this._viewY,viewZoom:this._viewZoom,viewAngle:this._viewAngle,currentTime:this._currentTime,pixelRatio:this._pixelRatio,backgroundColor:this._backgroundRgba,patternInfoTexture:this._patternTexture.getInfoTextureUnit(),patternNearestTexture:this._patternTexture.getNearestTextureUnit(),patternLinearTexture:this._patternTexture.getLinearTextureUnit(),patternLinearSdfTexture:this._patternTexture.getLinearSdfTextureUnit(),patternMipmapTexture:this._patternTexture.getMipmapTextureUnit(),shapeTexture:this._shapeTexture.getTextureUnit(),BYTES_TO_COORD:this._scales.bytesToActualCoord,BYTES_TO_SCALED_SIZE:this._scales.bytesToActualScaledSize,BYTES_TO_MIN_VISIBLE_SIZE:this._scales.bytesToActualMinVisibleSize,BYTES_TO_SYMBOLIC_SIZE:this._scales.bytesToActualSymbolicSize,BYTES_TO_DASH_LENGTH:this._scales.bytesToActualDashLength,BYTES_TO_GAP_LENGTH:this._scales.bytesToActualGapLength,BYTES_TO_PATTERN_SCALE:this._scales.bytesToActualPatternScale,PATTERN_INFO_TEXTURE_SIZE:this._patternTexture.getInfoTextureSize(),PATTERN_NEAREST_TEXTURE_SIZE:this._patternTexture.getNearestTextureSize(),PATTERN_LINEAR_TEXTURE_SIZE:this._patternTexture.getLinearTextureSize(),PATTERN_LINEAR_SDF_TEXTURE_SIZE:this._patternTexture.getLinearSdfTextureSize(),PATTERN_MIPMAP_TEXTURE_SIZE:this._patternTexture.getMipmapTextureSize(),PATTERN_POSITION_UNIT_SIZE:Hn,ROUNDED_BOX_RADIUS:this._textManager.getCornerRadius(),SHAPE_TEXTURE_SIZE:this._shapeTexture.getTextureSize(),SHAPE_SAMPLING_SIZE:this._shapeTexture.getSamplingSize(),SHAPE_SAMPLING_BUFFER_RATIO:this._shapeTexture.getBufferRatio(),NB_SHAPES_BY_SIDE:this._shapeTexture.getTextureSize()/this._shapeTexture.getSamplingSize(),SHAPE_DIMENSIONS:this._shapeTexture.getSamplingSize()/this._shapeTexture.getTextureSize(),SHAPE_ACTUAL_RATIO:1-this._shapeTexture.getBufferRatio()}}_render({shapesChanged:e,patternsChanged:s,dimensionsChanged:n,backgroundColorChanged:i}){const r=this._gl;if(this._error)throw this._error;if(e&&(this._shapeTexture.refresh(this._shapeManager),this._patternTexture.bindMetaDataTexture()),s&&this._patternTexture.refresh(this._patternManager),n&&(this._mustResize=!0),i){const[l,u,h,g]=this._renderBackground?this._backgroundRgba:[0,0,0,0];r.clearColor(l*g,u*g,h*g,g)}const o=this._computeUniforms(),a=this._getSortedBufferList();this._mustResize&&a.length&&(tf(this._glCanvas,this._width,this._height,this._pixelRatio),r.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),this._mustResize=!1),r.clear(r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT);for(let l=0;l<a.length;++l)this._displayBuffer(a[l],o);this._endFrame()}_displayBuffer(e,s){const n=e.getProgram();n!==this._currentProgram&&(this._currentProgram&&this._currentProgram.endPass(),this._currentProgram=n,this._currentProgram.startPass(s)),e.markAsUsed(),e.draw()}_getSortedBufferList(){const e=this._bufferList.getBuffersByAscendingDepth(),s=[];for(let n=0;n<this._bufferDrawers.length;++n){const i=this._bufferDrawers[n];i&&i.markAsUnused()}for(let n=0;n<e.length;++n){const i=e[n],r=this._getBufferDrawer(i);r.markAsUsed(),!i.isEmpty()&&this._isBufferDisplayable(i)&&s.push(r)}for(let n=0;n<this._bufferDrawers.length;++n){const i=this._bufferDrawers[n];i&&!i.isUsed()&&(i.destroy(),this._bufferDrawers[n]=void 0)}return s}_endFrame(){this._currentProgram&&(this._currentProgram.endPass(),this._currentProgram=null)}_getBufferDrawer(e){const s=e.getId();let n=this._bufferDrawers[s];if(!n){for(;this._bufferDrawers.length<=s;)this._bufferDrawers.push(void 0);n=new rO({gl:this._gl,ext:this._ext,staticProgram:this._staticProgram,animationProgram:this._animationProgram}),this._bufferDrawers[s]=n}return n.setDataBuffer(e),n}destroy(){this._glCanvas&&this._glCanvas.removeEventListener("webglcontextlost",this._onContextLost);const e=this._gl.getExtension("WEBGL_lose_context");e&&e.loseContext()}getImageData(){const e=this._glCanvas.width,s=this._glCanvas.height;return(this._2dcanvas.width<e||this._2dcanvas.height<s)&&(this._2dcanvas.width=e,this._2dcanvas.height=s),this._ctx.clearRect(0,0,e,s),this._ctx.drawImage(this._glCanvas,0,0),this._ctx.getImageData(0,0,e,s)}_getImageDataFlippedYAxis(){const e=this._gl,s=this._glCanvas.width,n=this._glCanvas.height,i=this._ctx.createImageData(s,n),r=new Uint8Array(i.data.buffer);return e.readPixels(0,0,s,n,e.RGBA,e.UNSIGNED_BYTE,r),i}setConstant(e,s){this._staticProgramWrapper.setConstant(e,s),this._animationProgramWrapper.setConstant(e,s),this._staticProgramWrapper.compile(),this._animationProgramWrapper.compile(),this._initGlPrograms(),this._bufferDrawers.forEach((n=>{n==null||n.destroy()})),this._bufferDrawers=[]}getShapeTexture(){return this._shapeTexture}};function LO(t,e){const s={vertexInfoAttribute:"a_vertexInfo",attributes:[],uniforms:[]};return cS(s,t),cS(s,e),s}var NO={float:1,vec2:2,vec3:3,vec4:4};function cS(t,e){const s=/(?:attribute\s+\/\*\s*(byte|ubyte|short|ushort|float)\s*\*\/\s*(float|vec2|vec3|vec4)\s+(\w+)\s*;)|(?:#if\s*(\w+))|(?:#endif)/g,n=/uniform\s+(float|vec2|vec3|vec4|sampler2D|int)\s+(\w+)\s*;/g,i=[];let r=s.exec(e);for(;r;){const o=r[0];o==="#endif"?i.pop():o.startsWith("#if")?i.push(r[4]):t.attributes.push({name:r[3],size:NO[r[2]],type:r[1],tags:i.slice(),location:null,byteSize:0,glType:null}),r=s.exec(e)}for(r=n.exec(e);r;){if(!t.uniforms.some((({id:o})=>o===r[1]))){const o=r[1],a=r[2],l=a.replace("u_","");t.uniforms.push({id:l,name:a,type:o})}r=n.exec(e)}}function MO(){return{BYTES_TO_OFFSET_ANGLE:2*Math.PI/8,BYTES_TO_COLOR:1/15,SDF_FONT_SIZE:Wd,CURVATURE_RATIO:Uf,PATTERN_PADDING:jo,TEXT_WIDTH_MULTIPLIER:w2,TEXT_HEIGHT_MULTIPLIER:df,SELF_LOOP_CURVATURE_RATIO:hf,EDGE_ARROW_SIZE_RATIO:Jr.edgeArrowSizeRatio,EDGE_MIN_TIP_SIZE:Jr.minEdgeTipSize,CURVE_SUBDIVISIONS:fi,PIECE_NODE_COMPONENT:qi,PIECE_TEXT_BOX:Ca,PIECE_EDGE_BODY:Gf,PIECE_EDGE_HEAD:Bx,PIECE_EDGE_TAIL:Ux,PIECE_EDGE_TEXT:xa,MAX_TEXT_SIZE:mD,BYTES_TO_TEXT_OFFSET_X:1/K2,BYTES_TO_TEXT_OFFSET_Y:1/my,FILTER_NEAREST:ql,FILTER_LINEAR:Id,FILTER_LINEAR_SDF:kd,FILTER_MIPMAP:va,SHAPE_TEXTURE_SIZE:dy,SIMPLE_SHAPE_SAMPLING_SIZE:Rg,COMPLEX_SHAPE_SAMPLING_SIZE:Po,SHAPE_SAMPLING_BUFFER_RATIO:ly,MAX_SHAPES:uf.toString(),FIRST_COMPLEX_SHAPE_ID:ay,SELF_LOOP_TO_CIRCLE_APPROX:L2,SDF_GAMMA:Tz}}var IO={x:0,y:0,zoom:1,angle:0,width:80,height:60,pixelRatio:1,backgroundColor:null,currentTime:0,isBufferDisplayable:mx,hideImages:!1,renderBackground:!1,bentEnable:!1,bentVertical:!1},Wc={webgl:CO,canvas:KD,svg:nO},gS=[0,0,0,0],Kp={webgl:null,svg:null,canvas:null},Qp=class extends vh{constructor(t){super(),this._view=Ws(IO),this._domWrapper=eo?document.createElement("div"):Jg(),this._domElement=this._domWrapper.appendChild(eo?document.createElement("div"):Jg()),this._currentElementSize=0,this._currentBlockOffset=0,this._currentByteOffset=0,this._blockIdToAddress=new Uint32Array(0),this._renderersByType={},this._switchMainRenderer=!0,this._refreshTexts=!1,this._backgroundColor=null,this._initData=t||{},this._patternManager=new dD,this._shapeManager=new hD,this._boundariesManager=new Pz,this._textManager=new pD(this._patternManager),this._bufferOffsetToId=new k2,this._memoryManager=new aD(this._patternManager,this._shapeManager,this._textManager,this._bufferOffsetToId,(e=>this.parseColor(e)||gS)),this._bufferList=new Nz}static createInitData(){const t={};for(const e in Wc)t[e]=Wc[e].createInitData();return t}static cacheInitData(t){Kp=t}static getCachedInitData(){return Kp}static clearCachedInitData(){Kp={webgl:null,svg:null,canvas:null}}freeBlock(t){this._checkBlockId(t);const e=this._blockIdToAddress[t],s=this._bufferList.freeBlock(e);return this._blockIdToAddress[t]=s,s}_ensureDomElementsFitParent(){const t=this._domElement.parentNode;!t||t.offsetWidth===this._view.width&&t.offsetHeight===this._view.height||Ga(t,`${this._view.width}px`,`${this._view.height}px`)}_ensureCorrectBackgroundColor(){const t=this._domElement.parentNode;this._backgroundColor!==this._view.backgroundColor&&t&&(t.style.backgroundColor=this._view.backgroundColor||"",this._backgroundColor=this._view.backgroundColor)}createGroup(){return new Fz}parseColor(t){return Yn(t)}clear(){this._blockIdToAddress.fill(0),this._patternManager.reset(),this._boundariesManager.reset(),this._textManager.reset(),this._bufferList.reset(),this._bufferOffsetToId.reset()}notifyFontsReloaded(){this._patternManager.notifyUpdate(),this._textManager.clear(),this._refreshTexts=!0}notifyPatternUpdate(){this._patternManager.notifyUpdate()}getShapePoints(t){return this._shapeManager.getDefinitionFromName(t).points}checkShapeHit(t,e,s){const{getDistanceFromStrokeVertically:n,getDistanceFromStrokeHorizontally:i}=this._shapeManager.getDefinitionFromName(t);return Math.min(n(e,s),i(e,s))>=0}setGlobalBoundaries(t){const{maxBlockId:e=0,maxScaledSize:s,maxMinVisibleSize:n,maxSymbolicSize:i,maxDashLength:r,maxGapLength:o,maxPatternScale:a}=t;return e>this._blockIdToAddress.length&&this._resizeBlockArray(e),!!this._boundariesManager.set(t)&&(this._memoryManager.resizeBoundaries(s,n,i,r,o,a),!0)}_resizeBlockArray(t){const e=new Uint32Array(t);e.set(this._blockIdToAddress),this._blockIdToAddress=e}registerShape(t,e){this._shapeManager.register(t,e)}updateShape(t,e){var n;this._shapeManager.updateShape(t,e);const s=(n=this._renderersByType.webgl)==null?void 0:n.getShapeTexture();s&&s.rewriteShape(this._shapeManager.getIdFromName(t))}_bindBlock(t,e,s,n,i,r,o){this._checkBlockId(t);const a=this._blockIdToAddress[t],l=this._bufferList.allocateBlock(a,e,s,n,i,r,o);return this._blockIdToAddress[t]=l.address,this._currentDataView=l.buffer.getDataView(),this._currentElementSize=l.buffer.elementSize,this._currentBlockOffset=l.offset,this._currentByteOffset=this._currentBlockOffset*this._currentElementSize,this._currentSideDataView=l.buffer.getSideDataView(),this._currentSideElementSize=l.buffer.getTotalSideElementsSize(),this._currentSideByteOffset=this._currentBlockOffset*this._currentSideElementSize,l}_setItemIndex(t){const e=this._currentBlockOffset+t;this._currentByteOffset=e*this._currentElementSize,this._currentSideByteOffset=e*this._currentSideElementSize}_checkBlockId(t){t>=this._blockIdToAddress.length&&this._resizeBlockArray(Do(t+1))}_setTextCharacters(t){this._textManager.storeTextInDataView(this._currentSideDataView,this._currentSideByteOffset,this._currentSideByteOffset+this._currentSideElementSize,t)}_storeElement(t,e){this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset,t.end),e&&(this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset+ou,t.start),this._memoryManager.storeAnimationInformation(this._currentDataView,this._currentByteOffset+2*ou,t.animation,Vx.getCoefficients(t.animation.easing)))}storeGroup(t,e){if(!e||e.size===0)return this.freeBlock(t);const s=e.type,n=e.depth,i=e.size,r=e.getElements(),o=e.animated,a=e.stencilUsage,l=e.getId();let u=0;if(s===ka)for(let g=0;g<i;++g){const f=r[g],{start:m,end:y}=f;if(y.pattern.type===Ho){const p=y.pattern.attributes.text;u=Math.max(u,p.length)}if(o&&m.pattern.type===Ho){const p=m.pattern.attributes.text;u=Math.max(u,p.length)}}const h=this._bindBlock(t,s,o,n,i,u,a);for(let g=0;g<i;++g){const f=r[g];this._setItemIndex(g),this._storeElement(f,o),this._bufferOffsetToId.set(h.buffer.getId(),h.offset+g,l)}if(s===ka)for(let g=0;g<i;++g){const f=r[g];this._setItemIndex(g),this._setTextCharacters(f.end.pattern)}return h.address}_refreshTextElements(){const t=this._bufferList.getBuffers();for(const e of t)if(e&&e.type===ka){const s=e.getSideDataView(),n=e.getTotalSideElementsSize(),i=e.getSize();let r=0,o=n;for(let a=0;a<i;++a){const l=this._textManager.extractTextFromDataView(s,r,o);this._textManager.storeTextInDataView(s,r,o,l),r=o,o+=n}e.triggerUpdate()}}extractElement(t,e=0){if(!t)return null;const s=this._bufferList.getBlockInfo(t);return this._renderer.extractElement(s.buffer,s.offset+e)}getDomElement(){return this._domElement}getDomWrapper(){return this._domWrapper}measureText(t,e,s,n=1){return this._textManager.measureText(t,e,s,n)}setRenderType(t){this._renderType!==t&&(this._renderType=t,this._switchMainRenderer=!0)}setEdgeArrowSizeRatio(t){Jr.setEdgeArrowSizeRatio(t),this._renderersByType.webgl&&this._renderersByType.webgl.setConstant("EDGE_ARROW_SIZE_RATIO",t)}setEdgeMinTipSize(t){Jr.setMinEdgeTipSize(t),this._renderersByType.webgl&&this._renderersByType.webgl.setConstant("EDGE_MIN_TIP_SIZE",t)}setBentEdges(t,e){this._view.bentEnable=t,this._view.bentVertical=e}getBentEdges(){return{bentEnable:this._view.bentEnable,bentVertical:this._view.bentVertical}}_ensureMainRendererReady(){if(this._switchMainRenderer){this._renderType===null&&(this._renderType="canvas");const t=Wc[this._renderType];t&&t.isAvailable()||(this._renderType="canvas"),this._renderer=this._renderersByType[this._renderType],this._renderer||(this._renderer=this._instanciateRenderer(this._renderType),this._renderer.on("error",(e=>this.fire("error",e))),this._renderersByType[this._renderType]=this._renderer),this._updateDomElement()}}_updateDomElement(){const t=this._renderer&&this._renderer.getDomElement(),e=this._domElement;for(;e&&e.firstChild;)e.removeChild(e.firstChild);t&&this._appendDomChild(t)}_appendDomChild(t){t.style.position="absolute",t.style.left="0",t.style.top="0",this._domElement.appendChild(t)}_instanciateRenderer(t){return new(t===null?Jr:Wc[t])({initData:t===null?null:this._initData[t],bufferList:this._bufferList,shapeManager:this._shapeManager,patternManager:this._patternManager,boundariesManager:this._boundariesManager,textManager:this._textManager,memoryManager:this._memoryManager})}setView(t){this._view={...this._view,...t}}getTextManager(){return this._textManager}_updateManagers(){this._patternManager.setPixelRatio(this._view.pixelRatio),this._shapeManager.update(),this._patternManager.update(),this._textManager.update(),this._boundariesManager.update(),this._bufferList.update(),this._refreshTexts&&(this._refreshTexts=!1,this._refreshTextElements())}_resizeCanvas(t){P2(t,this._view.width,this._view.height,this._view.pixelRatio)}render(){this._ensureMainRendererReady(),this._ensureDomElementsFitParent(),this._ensureCorrectBackgroundColor(),this._updateManagers(),this._renderer.renderFrame(this._view)}ensureAnimationsReady(){this._ensureMainRendererReady(),this._renderer.ensureAnimationsReady()}export(t,e,s){const n=this._instanciateRenderer(t),i={...this._view,...e};return"setViewportClipping"in n&&n.setViewportClipping(!1),this._updateManagers(),n.renderFrame(i),n.export(s).then((()=>n.getDomElement()))}getCurrentTime(){return $n()}getImageData(){return this._renderer&&this._renderer.getImageData()}destroy(){for(const t of Object.keys(this._renderersByType)){const e=this._renderersByType[t];e&&e.destroy()}}transparentify(t){const e=this.parseColor(t)||gS;return`rgba(${Math.round(255*e[0])},${Math.round(255*e[1])},${Math.round(255*e[2])},0)`}initDebugRenderingLoop({triggerKey:t="r",start:e=!0}={}){let s=e;document.addEventListener("keydown",(({key:i})=>{i===t&&(s=!s)}));const n=i=>{(s||i)&&(this.setView({currentTime:$n()}),this.render()),window.requestAnimationFrame((()=>{n()}))};window.requestAnimationFrame((()=>{document.body.appendChild(this.getDomElement()),n(!0)}))}},kO=kf&&document.fonts,RO=200,Jp="/qwerty/ [HELLO] ",fS="serif",FO=16,PO=class{constructor(){this._fontFaceSet=kO?document.fonts:null,this._canvas=Fn(),this._ctx=this._canvas.getContext("2d")}_measureText(t,e){return this._ctx.font=`12px ${e}`,this._ctx.measureText(t).width}check(t){if(t===fS)return!0;const e=this._measureText(Jp,fS);return this._measureText(Jp,t)!==e}load(t){return this._fontFaceSet&&this._fontFaceSet.load?this._fontFaceSet.load(`12px ${t}`):(this._ctx.font=`12px ${t}`,this._ctx.fillText(Jp,10,50),Promise.resolve())}},zO=class{constructor(t,e){this._fontLoaderCounter=0,this._loaded=!1,this._value=null,this._timeout=0,this._fontFaceSet=t,this._fontName=e,this._loaded=!1,this._value=null,this._timeout=0,kf&&!this._fontFaceSet.check(this._fontName)||this._setLoaded()}_setLoaded(){this._loaded=!0,this._value=this._fontName}getValue(){return this._value}isLoaded(){return this._loaded}destroy(){clearTimeout(this._timeout)}load(){return this._tryLoad(RO).then((()=>this._setLoaded()))}_tryLoad(t){return this._fontFaceSet.load(this._fontName).then((()=>{if(!this._fontFaceSet.check(this._fontName)&&this._fontLoaderCounter<FO)return new Promise((e=>{t<6e4&&(this._timeout=setTimeout(e,t))})).then((()=>(this._fontLoaderCounter++,this._tryLoad(1.5*t))))}))}},DO=class{constructor(){this._fontFaceSet=new PO,this._fonts={},this._onFontLoaded=[],this._hideUntilFontsLoaded=!0}setHideUntilFontsLoaded(t){this._hideUntilFontsLoaded=t}getFont(t){let e=this._fonts[t];return e||(e=new zO(this._fontFaceSet,t),this._fonts[t]=e,e.isLoaded()||e.load().then((()=>this._triggerFontLoaded(t)))),!this._hideUntilFontsLoaded&&t||e.getValue()}onFontLoaded(t){this._onFontLoaded.push(t)}destroy(){this._onFontLoaded=[],Object.keys(this._fonts).forEach((t=>this._fonts[t].destroy()))}_triggerFontLoaded(t){this._onFontLoaded.forEach((e=>e(t)))}},Eh="shifted",OO="centered";/**
 * Ogma Parsers
 * @description Parsers for Ogma
 * @version 0.0.27 (built on Thu Apr 10 2025 15:39:50 GMT+0000 (Coordinated Universal Time))
 * @author Alexander Milevski - Leo Nicolle - Sylvain Milan - Marco Liberati
 * @license (c) Linkurious 2025. All rights reserved.
 * @preserve
 */function Mo(t,e,s){s=s||e,e in t&&(t.attributes[s]=t[e])}function pC(t,e=(s=>s)){const s=e(JSON.parse(t)),n=s.nodes||[],i=s.edges||[];for(let r=0;r<n.length;r++){const o=n[r];o.attributes||(o.attributes={}),typeof o.size=="string"&&(o.size=+o.size),typeof o.x=="string"&&(o.x=+o.x),typeof o.y=="string"&&(o.y=+o.y),Mo(o,"x"),Mo(o,"y"),Mo(o,"size","radius"),Mo(o,"color"),Mo(o,"text")}for(let r=0;r<i.length;r++){const o=i[r];o.attributes||(o.attributes={}),typeof o.size=="string"&&(o.size=+o.size),Mo(o,"size","width"),Mo(o,"color"),Mo(o,"text")}return{nodes:n,edges:i}}function BO(t){return t.type==="vertex"||t._type==="vertex"||t.inE||t.outE||t._inE||t._outE}function UO(t){return t.type==="edge"||t._type==="edge"||t.inV||t.outV||t._outV||t._inV}function pd(t,e,s){if(t&&typeof t=="object"){if(Array.isArray(t))return t.forEach((n=>pd(n,e,s)));if(BO(t)){const n={};t.properties&&Object.keys(t.properties).forEach((r=>{n[r]=t.properties[r][0].value}));const i=xy(t);e.push({id:i,data:{id:t.id+"",categories:[t.label],properties:n}});for(const r in t)r!=="properties"&&pd(t[r],e,s);return}if(UO(t)){const n=xy(t);s.push({id:n,source:mS(t,["inV","_inV"]),target:mS(t,["outV","_outV"]),data:{id:n,type:t.label,properties:t.properties||{}}});for(const i in t)i!=="properties"&&pd(t[i],e,s);return}Object.keys(t).forEach((n=>pd(t[n],e,s)))}}function mS(t,e){for(const s of e)if(t[s])return xy(t[s])}function xy(t){if(typeof t=="string"||isFinite(t))return String(t);const e=t;return String(e.id||e._id)}function GO(t){const e=[],s=[];return pd(typeof t=="string"?JSON.parse(t):t,e,s),{nodes:e,edges:s}}var ri=t=>t.charCodeAt(0),VO=ri(" "),pS=ri("<"),zg=ri(">"),_S=ri('"'),jO=ri(`
`),HO=ri("\r"),Dg=ri("/"),$O=ri("\\"),qO=ri("a"),YO=ri("z"),WO=ri("A"),XO=ri("Z"),ZO=ri("0"),KO=ri("9"),QO=ri(":"),_C=-1,vy=-2,yC=-3,xC=-4;function JO(t){const e=new Int32Array(t.length);for(let s=0,n=t.length;s<n;++s)e[s]=t.charCodeAt(s);return e}function tB(t,e,s,n){const i=n.length;if(s-e!==i)return!1;for(let r=0;r<i;++r)if(t[e+r]!==n[r])return!1;return!0}function eB(t,e,s,n){return vC(t.tags,e,s,n)}function sB(t,e,s,n){return vC(t.attributes,e,s,n)}function vC(t,e,s,n){const i=t.length;for(let r=0;r<i;++r)if(tB(e,s,n,t[r]))return r;return t.push(e.slice(s,n)),i}function nB(t,e,s){let n=Og(e,s),i=e[n];if(i===zg||i===Dg)return n;let r=n;n=EC(e,n);const o=sB(t,e,r,n);for(;e[n]!==_S;)++n;for(++n,r=n;(i=e[n])!==_S;)i===$O&&++n,++n;return t.tokens.push(yC,o,r,n),n+1}function iB(t,e){let s,n;const i={tags:[],attributes:[],tokens:[]},r=i.tokens;let o=Og(t,e);for(;o<t.length;){let a=t[o];if(a===pS){if(o=Og(t,++o),t[o]===Dg)for(r.push(vy);t[++o]!==zg;);else{s=o,o=EC(t,s);const l=eB(i,t,s,o);for(r.push(_C,l),a=t[o];a!==zg&&a!==Dg;)o=nB(i,t,o),a=t[o];if(a===Dg)for(r.push(vy);t[++o]!==zg;);}o+=1}else{for(s=o;t[++o]!==pS;);for(n=o-1;bC(t[n]);)--n;r.push(xC,s,n+1)}o=Og(t,o)}return i}function bC(t){return t===VO||t===jO||t===HO}function Og(t,e){for(;bC(t[e]);)++e;return e}function rB(t){return t>=qO&&t<=YO||t>=WO&&t<=XO||t===QO||t>=ZO&&t<=KO}function EC(t,e){for(;rB(t[e]);)++e;return e}function yS(t,e){const s=Object.keys(e),n={};if(s.length>0)for(let i=0;i<s.length;++i){const r=e[s[i]],o=r.title;n[o]=r.default!==void 0?JSON.stringify(r.default):void 0}return t?()=>({id:void 0,attributes:{text:void 0,color:void 0,radius:void 0,x:void 0,y:void 0},data:{...n}}):()=>({id:void 0,source:void 0,target:void 0,attributes:{color:void 0,text:void 0,width:void 0},data:{...n}})}function xS(t){return t.indexOf("\\")===-1||(t=t.replace(/\\"/g,'"')),t}function SC(t){if(t.indexOf("<gexf")===-1)throw new Error("not a GEXF file");const e=JO(t),s=iB(e,t.indexOf("<gexf ")),n={},i={};s.tags.forEach(((hs,Fe)=>{const Oe=String.fromCharCode.apply(null,hs);n[Oe]=Fe})),s.attributes.forEach(((hs,Fe)=>{const Oe=String.fromCharCode.apply(null,hs);i[Oe]=Fe}));const r=n.attributes,o=n.attribute,a=n.node,l=n.edge,u=n.default,h=n["viz:position"],g=n["viz:size"],f=n["viz:color"],m=n.attvalue,y=i.class,p=i.id,x=i.type,v=i.title,b=i.label,S=i.source,A=i.target,w=i.x,L=i.y,k=i.r,F=i.g,O=i.b,j=i.a,V=i.value,Z=i.for,at=i.weight,mt={float:1,double:1,integer:2,boolean:3,string:4,"list-string":5};let K=0;const ut=s.tokens,ht=ut.length,nt=new Array(16);let ot=0,Mt=0,Q=0,Et=!0;const qt={},Vt={};let Wt,oe,me="",se="",Jt="",ee={attributes:{}},ce=0,Ce=0,ve=0,Me=1,ge="",ze=!1,is=!0,Ge=null,De=null;const He=[],Je=[];let ss=0,ts={};for(;K<ht;){const hs=ut[K];if(hs===_C)Mt=ot,ot=ut[K+1],nt[Q]=ot,Q+=1,ot===a?(Ge||(Ge=yS(!0,qt)),ee=Ge(),is=!0,ts=qt):ot===l&&(De||(De=yS(!1,Vt)),ee=De(),is=!1,ts=Vt),K+=2;else if(hs===vy){if(me&&ot===o){ts=Et?qt:Vt;const Fe=mt[se];let Oe=Wt;Oe&&(Fe===1?Oe=+Oe:Fe===2?Oe=0|+Oe:Fe===3?Oe=Oe==="true":Fe===5&&(Oe=Oe.split(" ").filter((Cs=>Cs)))),ts[me]={title:Jt||me,default:Oe,type:Fe},me="",Jt="",se="",Wt=void 0}else if(ot===a&&Q===4)ze&&ee.attributes&&(ee.attributes.color=`rgba(${ce}, ${Ce}, ${ve}, ${Me})`,ce=0,Ce=0,ve=0,Me=1,ze=!1),ee.id||(ee.id=++ss),He.push(ee);else if(ot===l&&Q===4)ee.id||(ee.id=++ss),Je.push(ee);else if(ot===m&&Q===6&&ge){const Fe=(is?qt:Vt)[ge];if(Fe){if(oe===void 0)oe=Fe.default;else{const Cs=Fe.type;Cs&&(Cs===1?oe=+oe:Cs===2?oe=0|+oe:Cs===3?oe=oe==="true":Cs===5?oe=oe.split(" ").filter((Fs=>Fs)).map((Fs=>xS(Fs))):typeof e=="string"&&(oe=xS(oe)))}ee.data||(ee.data={});const Oe=ts;ee.data[Oe[ge].title]=oe}ge="",oe=null}Q-=1,ot=Mt,Mt=nt[Q-2],K+=1}else if(hs===yC){const Fe=ut[K+1],Oe=t.substring(ut[K+2],ut[K+3]);if(ot===r)Fe===y&&(Et=Oe!=="edge"&&Oe!=="edges");else if(ot===o)Fe===p?me=Oe:Fe===x?se=Oe:Fe===v&&(Jt=Oe);else if(ot!==a&&ot!==l||Q!==4)if(ot===h&&Q===5){if(Fe===w)ee.attributes.x=parseFloat(Oe);else if(Fe===L){const Cs=parseFloat(Oe);ee.attributes.y=Cs===0?Cs:-Cs}}else ot===f&&Q===5?(ze=!0,Fe===k?ce=parseInt(Oe):Fe===F?Ce=parseInt(Oe):Fe===O?ve=parseInt(Oe):Fe===j&&(Me=parseFloat(Oe))):ot===g&&Q===5?Fe===V&&(is?ee.attributes.radius=+Oe:ee.attributes.width=+Oe):ot===m&&Q===6&&(Fe===Z||Fe===p?ge=Oe:Fe===V&&(oe=Oe));else Fe===p?ee.id=Oe:Fe===b?ee.attributes.text=Oe:Fe===S?ee.source=Oe:Fe===A?ee.target=Oe:Fe===at&&(ee.attributes.width=+Oe);K+=4}else{if(hs!==xC)throw new Error(`at index ${K}: token ${hs}`);{const Fe=t.substring(ut[K+1],ut[K+2]);ot===u&&(Wt=Fe),K+=3}}}return{nodes:He,edges:Je}}function oB(t){for(let e=0;e<64;++e)t[e]^=1;for(let e=0;e<64&&!(t[e]^=1);++e);}function aB(t,e,s){for(let n=0;n<32;++n)s[n]=+!!(t&1<<n);for(let n=0;n<32;++n)s[n+32]=+!!(e&1<<n);return s}function vS(t,e){let s=0;for(let n=0;n<20;++n){const i=s+t[n]+e[n];s=+(i>=10),t[n]=i%10}}var lB=class{constructor(){this._decimalPowerOfTwo=new Uint8Array(20),this._binaryNumber=new Uint8Array(64),this._decimalNumber=new Uint8Array(20)}int64ToString({low:e,high:s}){if(e===0&&s===0)return"0";aB(e,s,this._binaryNumber),this._decimalNumber.fill(0),this._decimalPowerOfTwo.fill(0),this._decimalPowerOfTwo[0]=1;const n=this._binaryNumber[63]===1;n&&oB(this._binaryNumber);for(let o=0;o<64;++o)this._binaryNumber[o]&&vS(this._decimalNumber,this._decimalPowerOfTwo),vS(this._decimalPowerOfTwo,this._decimalPowerOfTwo);const i=[];let r=this._decimalNumber.length-1;for(n&&i.push("-");!this._decimalNumber[r];)r-=1;for(let o=r;o>=0;--o)i.push(String(this._decimalNumber[o]));return i.join("")}},uB=new lB;function Xc(t){return uB.int64ToString(t)}function Zc(t){return typeof t=="object"&&"high"in t&&"low"in t}function dB(t){return"start"in t&&"end"in t}function hB(t){if(typeof t!="object"||t===null)throw new Error("Ogma can only retrieve nodes and relationships from Neo4j. Please make sure that your Cypher query returns nodes and edges, not values.");const e=Object.keys(t.properties);for(const s of e){const n=t.properties[s];Zc(n)&&(t.properties[s]=Xc(n))}if(t.identity!==void 0){if(Zc(t.identity)&&(t.identity=Xc(t.identity)),dB(t)){const s=t.start.identity||t.start,n=t.end.identity||t.end;Zc(s)&&(t.start=Xc(s)),Zc(n)&&(t.end=Xc(n))}}else t.id&&(t.identity=t.id)}var cB=t=>"start"in t&&"end"in t&&"type"in t,gB=t=>"segments"in t;function fB(t,e,s,n){e.segments.forEach((i=>{Fd(t,i.start,s,n),Fd(t,i.end,s,n),Fd(t,i.relationship,s,n)}))}function Fd(t,e,s,n){if(e)if(Array.isArray(e))e.forEach((i=>Fd(t,i,s,n)));else if(gB(e))fB(t,e,s,n);else if(hB(e),cB(e))n.has(e.identity)||(n.add(e.identity),t.edges.push({id:e.identity,source:e.start,target:e.end,data:{neo4jType:e.type,neo4jProperties:e.properties}}));else{const i=e;s.has(i.identity)||(s.add(i.identity),t.nodes.push({id:i.identity,attributes:{},data:{neo4jLabels:i.labels,neo4jProperties:i.properties}}))}}var mB=t=>"queryKeys"in t&&"values"in t;function pB(t){const e=[];return t.values.forEach((s=>{const{nodes:n=[],relationships:i=[],segments:r=[]}=s.adapted,o=[{segments:r,properties:{}}];e.push({_fields:[...n,...i,...o]})})),{records:e}}function _B(t){let e=typeof t=="string"?JSON.parse(t):t;const s={nodes:[],edges:[]},n=new Set,i=new Set;return mB(e)&&(e=pB(e)),e.records.forEach((({_fields:r})=>r.forEach((o=>Fd(s,o,n,i))))),s}var yB={boolean:t=>t.toLowerCase()==="true",int:parseFloat,long:parseFloat,float:parseFloat,double:parseFloat,string:t=>t};function xB(t){const e={graph:{},node:{},edge:{}},s={graph:{},node:{},edge:{}};for(let n=0;n<t.length;n++){const i=t[n],r=i.getAttribute("for")||"node",o=i.getAttribute("id"),a=i.getAttribute("attr.name"),l=i.getAttribute("attr.type")||"string",u=i.getElementsByTagName("default"),h=u.length!==0?u[0].textContent:void 0;e[r][o]={name:a,parse:yB[l]},typeof h<"u"&&(s[r][a]=h)}return{definitions:e,defaults:s}}function bS(t,e,s){const n=t.getElementsByTagName("data"),i={};for(let r=0;r<n.length;r++){const o=n[r],a=o.getAttribute("key");if(a===null)continue;const l=e[a];typeof l>"u"?i[a]=o.textContent:o.textContent&&o.textContent.length!==0&&(i[l.name]=l.parse(o.textContent))}for(const r in s)r in i||(i[r]=s[r]);return i}function t_(t){return t.color?t.color:t.r&&t.g&&t.b?`rgb(${t.r}, ${t.g}, ${t.b})`:void 0}var vB=new Set(["x","y","size","color","r","g","b","label"]);function ES(t){const e={};for(const s in t)vB.has(s)||t[s]===void 0||(e[s]=t[s]);return e}function AC(t,e){if(!e){if(typeof DOMParser>"u")throw new Error("DOMParser is not available. You need to provide a DOMParser instance as second argument, if you are not in the browser environment");e=new DOMParser}const s=e.parseFromString(t,"application/xml"),n=s.getElementsByTagName("key"),i=s.getElementsByTagName("node"),r=s.getElementsByTagName("edge"),{definitions:o,defaults:a}=xB(n),l=[],u=new Set;for(let g=0;g<i.length;g++){const f=i[g],m=f.getAttribute("id"),y=f.getAttribute("href")||void 0,p=bS(f,o.node,a.node);u.add(m);const x={id:m,attributes:{x:p.x,y:p.y,radius:p.size,color:t_(p),text:p.label},data:ES(p)};p.x!==void 0&&(x.attributes.x=p.x),p.y!==void 0&&(x.attributes.y=p.y),p.size!==void 0&&(x.attributes.radius=p.size),p.label!==void 0&&(x.attributes.text=p.label);const v=t_(p);v!==void 0&&(x.attributes.color=v),y!==void 0&&(x.data.href=y),l.push(x)}const h=[];for(let g=0;g<r.length;g++){const f=r[g],m=f.getAttribute("id")||g,y=f.getAttribute("source"),p=f.getAttribute("target"),x=f.getAttribute("xlink:href")||void 0;if(!u.has(y)||!u.has(p))throw new Error(`Invalid edge: ${y} -> ${p}`);const v=bS(f,o.edge,a.edge),b={id:m,source:y,target:p,attributes:{},data:ES(v)},S=t_(v);S!==void 0&&(b.attributes.color=S),x!==void 0&&(b.data.href=x),h.push(b)}return{nodes:l,edges:h}}var wC=t=>{const e=t.split(`
`).filter((i=>!i.startsWith("%"))),[s]=e[0].split(" ").map(Number),n=e.slice(1).map((i=>i.split(" ").slice(0,2).map(Number))).filter((i=>i.length===2));return{nodes:Array.from({length:Number(s)},((i,r)=>({id:r}))),edges:n.map((([i,r])=>({source:i%s,target:r%s})))}};function bB(t,e,s,n){e0(t,e,s,n),t.thicknessOrFontSizeScaled=e.widthScaled,t.thicknessOrFontSizeFixed=e.widthFixed,t.strokeWidthScaled=e.stroke.widthScaled,t.strokeWidthFixed=e.stroke.widthFixed,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=e.color,t.strokeColor=e.stroke.color,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=e.stroke.minVisibleSize,t.offsetAngle=0,t.symbolicSize=e.widthScaled,t.dashLength=e.shape.dashLength,t.gapLength=e.shape.gapLength,t.hasHead=!!e.shape.head,t.hasTail=!!e.shape.tail,t.isBodyTriangle=e.shape.isBodyTriangle}function e0(t,e,s,n){t.pieceId=s,t.shape=n,t.x1=e.sourceX,t.y1=e.sourceY,t.x2=e.targetX,t.y2=e.targetY,t.rectWidthOrSourceRadiusScaled=e.sourceRadiusScaled,t.rectWidthOrSourceRadiusFixed=e.sourceRadiusFixed,t.rectHeightOrTargetRadiusScaled=e.targetRadiusScaled,t.rectHeightOrTargetRadiusFixed=e.targetRadiusFixed,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=Wn,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.widthScaled,t.curvature=e.curvature,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=e.isSelfLoop,t.isText=!1}function EB(t,e,s){const n=e.widthScaled+2*e.halo.widthScaled,i=e.widthFixed+2*e.halo.widthFixed;e0(t,e,s,"line"),t.thicknessOrFontSizeScaled=n,t.thicknessOrFontSizeFixed=i,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=e.halo.color,t.strokeColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.offsetAngle=0,t.symbolicSize=e.widthScaled,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isBodyTriangle=!1}function SB(t,e,s,n){e0(t,e,s,n);const i=e.widthFixed*HE+eD;t.thicknessOrFontSizeScaled=e.widthScaled*jE,t.thicknessOrFontSizeFixed=e.widthFixed*jE,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=e.widthScaled*HE,t.offsetFixed=i,t.fillColor=e.outline.color,t.strokeColor=null,t.globalMinVisibleSize=Math.max(e.minVisibleSize,e.outline.minVisibleSize),t.strokeMinVisibleSize=0,t.offsetAngle=Math.PI/2,t.symbolicSize=e.widthScaled,t.dashLength=e.shape.dashLength,t.gapLength=e.shape.gapLength,t.hasHead=!!e.shape.head,t.hasTail=!!e.shape.tail,t.isBodyTriangle=e.shape.isBodyTriangle}function AB(t,e,s){TC(t,e,s),t.pattern.type=Ho,t.pattern.attributes.text=e.content,t.pattern.attributes.size=xh,t.pattern.attributes.font=e.font,t.pattern.attributes.style=e.style,t.pattern.attributes.align=e.align,t.patternColor=e.color,t.patternScale=1,t.thicknessOrFontSizeScaled=e.sizeScaled,t.thicknessOrFontSizeFixed=e.sizeFixed,t.isText=!0}function wB(t,e,s){TC(t,e,s),t.pieceId+=Ca,t.fillColor=e.backgroundColor,t.shape="square"}function TC(t,e,s){let n=e.position==="centered"?0:(s.widthScaled+e.heightScaled)/2+s.stroke.widthScaled,i=e.position==="centered"?0:(s.widthFixed+e.heightFixed)/2+s.stroke.widthFixed+e.padding+e.margin;if(e===s.texts.secondary&&s.texts.primary.position==="centered"&&(i=s.texts.primary.heightFixed/2+s.texts.primary.padding+s.texts.primary.margin+e.padding+e.margin,n=0),t.pieceId=xa,t.shape="square",t.x1=s.sourceX,t.y1=s.sourceY,t.x2=s.targetX,t.y2=s.targetY,!s.isSelfLoop&&s.curvature===0){const r=Math.atan2(t.y2-t.y1,t.x2-t.x1),o=s.sourceRadiusScaled-s.targetRadiusScaled,a=Math.cos(r),l=Math.sin(r);t.x1+=a*o,t.y1+=l*o}t.rectWidthOrSourceRadiusScaled=e.widthScaled,t.rectWidthOrSourceRadiusFixed=e.widthFixed+2*e.padding+1,t.rectHeightOrTargetRadiusScaled=e.heightScaled,t.rectHeightOrTargetRadiusFixed=e.heightFixed+2*e.padding,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=s.sourceRadiusScaled+s.targetRadiusScaled,t.strokeWidthFixed=s.sourceRadiusFixed+s.targetRadiusFixed,t.offsetScaled=n,t.offsetFixed=i,t.pattern.type=Wn,t.opacity=s.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=Math.max(e.minVisibleSize,s.minVisibleSize),t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.offsetAngle,t.patternScale=0,t.symbolicSize=s.widthScaled,t.curvature=s.curvature,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=s.isSelfLoop,t.isText=!1,t.adjustTextAngle=e.adjustAngle}var TB=t=>!!t||t===0;function dr(t,e,s=0){return t==="inherit"?Array.isArray(e)?e[((s/(2*Math.PI)*e.length|0)+1)%e.length]:e:t}function CB(t,e,s){return t==="source"?Array.isArray(e)?e[0]:e:t==="target"?Array.isArray(s)?s[0]:s:t}function LB(t){const e=t.depth;return e===D2||e===z2||(e-jx)%$x>=Hx}function CC(t){const e=(t.depth-jx)%$x;return e>=0&&e!==O2&&e!==Hx}function SS(t,e,s,n,i,r){NB(t,e,s,n,i,r),AS(t,e,s,n.text,i.texts.primary,r.texts.primary,r),AS(t,e,s,n.text.secondary,i.texts.secondary,r.texts.secondary,r)}function NB(t,e,s,n,i,r){if(e_(i.body,r,bB),i.halo.body){const o=n.halo.width.get(s),a=+(n.halo.scalingMethod.get(s)==="scaled");r.halo.widthScaled=o*a,r.halo.widthFixed=o*(1-a),e_(i.halo,r,EB)}i.outline.body&&(r.outline.color=n.outline.color.get(s),r.outline.minVisibleSize=n.outline.minVisibleSize.get(s),e_(i.outline,r,SB))}function e_(t,e,s){s(t.body,e,Gf,e.shape.body),t.head&&e.shape.head!==null&&s(t.head,e,Bx,e.shape.head),t.tail&&e.shape.tail!==null&&s(t.tail,e,Ux,e.shape.tail)}function AS(t,e,s,n,i,r,o){if(i.text&&r.content){const a=n,l=a.scaling.get(s);if(r.font=e.fontManager.getFont(a.font.get(s)),r.color=dr(a.color.get(s),o.color),r.position=a.position?a.position.get(s):Eh,r.style=a.style.get(s),r.minVisibleSize=a.minVisibleSize.get(s),r.margin=a.margin.get(s),r.padding=a.padding.get(s),r.maxLineLength=a.maxLineLength.get(s),r.content=Yx(r.content,r.maxLineLength),r.adjustAngle=a.adjustAngle.get(s),r.align=a.align.get(s),l){const h=a.scale.get(s);r.sizeScaled=o.widthScaled*h,r.sizeFixed=o.widthFixed*h}else r.sizeFixed=a.size.get(s),r.sizeScaled=0;const u=t.measureText(r.content,r.font,r.style);r.widthScaled=u.width*r.sizeScaled,r.widthFixed=u.width*r.sizeFixed,r.heightScaled=u.height*r.sizeScaled,r.heightFixed=u.height*r.sizeFixed,r.offsetAngle=r===o.texts.primary?sD:nD,AB(i.text,r,o),i.background&&wB(i.background,r,o)}}function wS(t,e){s_(t.body,e,!0,!0),s_(t.outline,e,e.outline.enabled,!0),s_(t.halo,e,!!e.halo.color,!1),TS(t.texts.primary,e.texts.primary),TS(t.texts.secondary,e.texts.secondary)}function s_(t,e,s,n){t.body=s,t.head=s&&n&&!!e.shape.head,t.tail=s&&n&&!!e.shape.tail}function TS(t,e){t.text=!e.hidden&&!!e.content,t.background=t.text&&!!e.backgroundColor}function CS(t,e,s,n,i,r){MB(t,e,s,n,i,r),LS(t,e.texts.primary,s.text,n,e),LS(t,e.texts.secondary,s.text.secondary,n,e)}function MB(t,e,s,n,i,r){const o=i.source,a=i.target,l=s.source.get(n),u=s.target.get(n),h=o.x.get(l),g=o.y.get(l),f=o.radius.get(l),m=o.innerStroke.width.get(l),y=+(o.innerStroke.color.get(l)!==null),p=+(o.innerStroke.scalingMethod.get(l)==="scaled"),x=o.outerStroke.width.get(l),v=+(o.outerStroke.color.get(l)!==null),b=+(o.outerStroke.scalingMethod.get(l)==="scaled"),S=o.color.get(l),A=+(o.scalingMethod.get(l)==="scaled"),w=a.x.get(u),L=a.y.get(u),k=a.radius.get(u),F=a.innerStroke.width.get(u),O=+(a.innerStroke.color.get(u)!==null),j=+(a.innerStroke.scalingMethod.get(u)==="scaled"),V=a.outerStroke.width.get(u),Z=+(a.outerStroke.color.get(u)!==null),at=+(a.outerStroke.scalingMethod.get(u)==="scaled"),mt=a.color.get(u),K=+(a.scalingMethod.get(u)==="scaled"),ut=CB(s.color.get(n),S,mt),ht=s.width.get(n),nt=s.scalingMethod.get(n)==="scaled"?1:0,ot=s.stroke.width.get(n),Mt=s.stroke.scalingMethod.get(n)==="scaled"?1:0,Q=iD[s.shape.style.get(n)],Et=s.adjustAnchors.get(n);if(e.source=l,e.target=u,e.sourceX=h,e.sourceY=g,e.targetX=w,e.targetY=L,e.sourceRadiusScaled=m*y*p+x*v*b+f*A,e.sourceRadiusFixed=m*y*(1-p)+x*v*(1-b)+f*(1-A),e.targetRadiusScaled=F*O*j+V*Z*at+k*K,e.targetRadiusFixed=F*O*(1-j)+V*Z*(1-at)+k*(1-K),e.widthScaled=ht*nt,e.widthFixed=ht*(1-nt),e.curvature=s.curvature.get(n),e.isSelfLoop=l===u,e.color=ut,e.opacity=s.opacity.get(n),e.minVisibleSize=s.minVisibleSize.get(n),e.shape.body=s.shape.body.get(n),e.shape.head=s.shape.head.get(n),e.shape.tail=s.shape.tail.get(n),e.shape.dashLength=Q.dash,e.shape.gapLength=Q.gap,e.shape.isBodyTriangle=e.shape.body==="triangle",e.stroke.color=dr(s.stroke.color.get(n),ut),e.stroke.widthScaled=ot*Mt,e.stroke.widthFixed=ot*(1-Mt),e.stroke.minVisibleSize=s.stroke.minVisibleSize.get(n),e.halo.color=s.halo.color.get(n),e.outline.enabled=s.outline.enabled.get(n),e.textHidden=s.textHidden.get(n)===1,Et&&(e.shape.head||e.shape.tail||e.shape.body==="triangle")){const qt=e,Vt=qt.curvature,Wt=qt.sourceX,oe=qt.sourceY,me=qt.targetX,se=qt.targetY;let Jt=1,ee=1;if(Vt){if(!qt.isSelfLoop){const ce=Xf(Wt,oe,me,se,Vt/2);Jt=Kc(qt,r,o,l,Wt,oe,ce.x,ce.y),ee=Kc(qt,r,a,u,me,se,ce.x,ce.y)}}else Jt=Kc(qt,r,o,l,Wt,oe,me,se),ee=Kc(qt,r,a,u,me,se,Wt,oe);e.sourceRadiusScaled*=Jt,e.sourceRadiusFixed*=Jt,e.targetRadiusScaled*=ee,e.targetRadiusFixed*=ee}}function LS(t,e,s,n,i){e.hidden=i.textHidden,e.content=t.formatText(s.content.get(n)),e.backgroundColor=dr(s.backgroundColor.get(n),i.color)}function Kc(t,e,s,n,i,r,o,a){const l=e.angle||0;let u,h=Math.atan2(a-r,o-i)-l,g=1,f=0;h<-Vi?h+=Md:h>Vi&&(h-=Md),h<-Vi/2?(f=B2,u=s.badges.topLeft):h<0?(f=U2,u=s.badges.topRight):h<Vi/2?(f=V2,u=s.badges.bottomRight):(f=G2,u=s.badges.bottomLeft),f+=l;const m=u.text.content&&u.text.content.get(n),y=u.image.url&&u.image.url.get(n);if(TB(m)||y){const p=u.positionScale.get(n),x=u.scale.get(n),v=t2(o,a,i,r,i+Math.cos(f)*p,r+Math.sin(f)*p,x);if(v){const b=v.x-i,S=v.y-r,A=Math.sqrt(b*b+S*S);g=Math.max(g,A)}}if(s.shape.get(n)==="square"){const p=Math.abs(Math.cos(h)),x=Math.abs(Math.sin(h)),v=1/Math.max(p,x);g=Math.max(g,v)}return g}function NS(){return{source:0,target:0,sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:!1,color:"",opacity:0,minVisibleSize:0,shape:{body:"line",head:null,tail:null,dashLength:0,gapLength:0,isBodyTriangle:!1},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:!1,color:"",minVisibleSize:0},textHidden:!1,texts:{primary:MS(),secondary:MS()}}}function MS(){return{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,position:Eh,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0}}function IB(t){return t===null?t:void 0}function In(t){return typeof t=="boolean"||t===0||t===1?t:void 0}function Pa(t){return typeof t=="number"&&isFinite(t)?t:void 0}function Vs(t){return typeof t=="number"&&isFinite(t)&&t>=0?t:void 0}var LC=-100,kB=400,NC=t=>typeof t=="number"&&isFinite(t)&&t>=LC&&t<=kB?t:void 0;function Wr(t){return t===null||typeof t=="string"||typeof t=="number"?t:void 0}function Xr(t){return t==="fixed"||t==="scaled"?t:void 0}function Oo(t){return Yn(t)?t:void 0}function RB(t){return t===OO||t===Eh?t:void 0}function Vn(t){return t==="inherit"||Yn(t)?t:void 0}function FB(t){return t==="source"||t==="target"||Yn(t)?t:void 0}function Ql(t){return t===null?null:typeof t=="string"?t.split(",").map((e=>{const s=e.trim(),n=s.indexOf(" ")!==-1,i=s[0];return n&&i!=='"'&&i!=="'"?`"${s}"`:s})).join(","):void 0}function Jl(t){return t==="none"?"normal":t==="normal"||t==="italic"||t==="bold"||t==="italic bold"||t==="bold italic"||t==="100"||t==="200"||t==="300"||t==="400"||t==="500"||t==="600"||t==="700"||t==="800"||t==="900"?t:void 0}function gf(t){return t==="left"||t==="center"?t:void 0}function PB(t){return t==="equilateral"?"pentagon":t==="triangle"?"triangleUp":t==="triangleRight"?"triangle":t==="circle"||t==="square"||t==="cross"||t==="diamond"||t==="pentagon"||t==="hexagon"||t==="star"||t==="triangleUp"||t==="triangleDown"||t==="triangleLeft"||t==="triangle"?t:void 0}var zB=new Set(["line","tapered","arrow","dashed","dotted"]);function DB(t){return zB.has(t)?t:void 0}function OB(t){return t==="line"||t==="triangle"?t:void 0}function IS(t){return t===null||t==="arrow"||t==="circle-hole-arrow"||t==="triangle-hole-arrow"||t==="short-arrow"||t==="sharp-arrow"||t==="circle"||t==="square"?t:void 0}function BB(t){return t==="plain"||t==="dashed"||t==="dotted"?t:void 0}function UB(t){return t==="top"||t==="bottom"||t==="left"||t==="right"||t==="center"?t:void 0}function GB(t){if(Yn(t))return t;if(Array.isArray(t)){if(t.length<1)return;for(let e=0;e<t.length;++e)if(!Yn(t[e]))return;return t}}function Es(t){return function(e){if(typeof e=="number")return isFinite(e)&&e>=0?e:void 0;if(typeof e!="string"||e.charAt(e.length-1)!=="%")return;const s=parseFloat(e);return isNaN(s)?void 0:t*s/100}}function s0(){return{edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0}}function Kd(t,e=s0()){const s=(t-LC)*$x+jx;return e.edgeHalo=Xz,e.nodeHaloStroke=z2,e.nodeHalo=D2,e.edgeBody=s+O2,e.edgeTextBackground=s+Zz,e.edgeText=s+Kz,e.nodeBody=s+Hx,e.nodeTextBackground=s+Qz,e.nodeText=s+Jz,e}var VB=(t,e)=>{e.halo.body=e.halo.body||t.halo.body,e.halo.head=e.halo.head||t.halo.head,e.halo.tail=e.halo.tail||t.halo.tail,e.outline.body=e.outline.body||t.outline.body,e.outline.head=e.outline.head||t.outline.head,e.outline.tail=e.outline.tail||t.outline.tail,e.body.body=e.body.body||t.body.body,e.body.head=e.body.head||t.body.head,e.body.tail=e.body.tail||t.body.tail;const s=e.texts,n=t.texts;s.primary.text=s.primary.text||n.primary.text,s.primary.background=s.primary.background||n.primary.background,s.secondary.text=s.secondary.text||n.secondary.text,s.secondary.background=s.secondary.background||n.secondary.background},MC=t=>(e,s)=>{s.halo.body=e.halo.body[t],s.halo.head=e.halo.head[t],s.halo.tail=e.halo.tail[t],s.outline.body=e.outline.body[t],s.outline.head=e.outline.head[t],s.outline.tail=e.outline.tail[t],s.body.body=e.body.body[t],s.body.head=e.body.head[t],s.body.tail=e.body.tail[t],s.texts.primary.text=e.texts.primary.text[t],s.texts.primary.background=e.texts.primary.background[t],s.texts.secondary.text=e.texts.secondary.text[t],s.texts.secondary.background=e.texts.secondary.background[t]},jB=MC("start"),HB=MC("end"),$B=class{constructor({engine:t,imageManager:e,fontManager:s,formatText:n,view:i,attributes:r,attributesPrev:o,nodeAttributes:a,nodeAttributesPrev:l}){this._fullComponents=Ju(),this._startComponents=Ju(),this._endComponents=Ju(),this._startFlags=Ju(),this._endFlags=Ju(),this._startInput=NS(),this._endInput=NS(),this._depthInfo=s0(),this._nullElt={id:-1,valid:!0},this._engine=t,this._view=i,this._helper={imageManager:e,fontManager:s,formatText:n},this._attributes=r,this._attributesPrev=o,this._nodeAttributes=a,this._nodeAttributesPrev=l,this._layers=kS((()=>t.createGroup())),this._blockIds=kS((()=>0))}drawEdge(t){if(this._computeBlockIds(t),this._attributes.excluded.get(t))return this._freeBlocks();const e=this._engine,s=this._helper,n=-t,i=this._attributes,{bentEnable:r,bentVertical:o}=e.getBentEdges(),a=Kd(i.layer.get(t)-(i.detectable.get(t)?0:1),this._depthInfo),l=i.source.get(t),u=i.target.get(t),h=i.curvature.get(t),g=this._attributesPrev.curvature.get(t),f=i.animationDuration.get(t),m=i.animationStart.get(t),y=i.animationEasing.get(t),p=f>0,x=h!==0||p&&g!==0||this._engine.getBentEdges().bentEnable;this._prepareBlocks(p,a,n,x);const v=this._extremitiesAttributes={source:this._nodeAttributes,target:this._nodeAttributes};if(CS(s,this._endInput,i,t,v,this._view),wS(this._endFlags,this._endInput),p){const b=this._nodeAttributes.animationDuration.get(l)>0,S=this._nodeAttributes.animationDuration.get(u)>0;v.source=b?this._nodeAttributesPrev:this._nodeAttributes,v.target=S?this._nodeAttributesPrev:this._nodeAttributes,CS(s,this._startInput,this._attributesPrev,t,v,this._view),wS(this._startFlags,this._startInput),VB(this._endFlags,this._startFlags)}this._initComponents(this._fullComponents,this._endFlags,this._layers),HB(this._fullComponents,this._endComponents),this._endComponents.body.body.bentEnable=r,this._endComponents.body.body.bentVertical=o,this._endComponents.body.head&&(this._endComponents.body.head.bentEnable=r,this._endComponents.body.head.bentVertical=o),this._endComponents.body.tail&&(this._endComponents.body.tail.bentEnable=r,this._endComponents.body.tail.bentVertical=o),SS(e,s,t,this._attributes,this._endComponents,this._endInput),this._endComponents.texts.primary.text&&(this._endComponents.texts.primary.background&&(this._endComponents.texts.primary.background.bentEnable=r,this._endComponents.texts.primary.background.bentVertical=o),this._endComponents.texts.primary.text.bentEnable=r,this._endComponents.texts.primary.text.bentVertical=o),this._endComponents.texts.secondary.text&&(this._endComponents.texts.secondary.background&&(this._endComponents.texts.secondary.background.bentEnable=r,this._endComponents.texts.secondary.background.bentVertical=o),this._endComponents.texts.secondary.text.bentEnable=r,this._endComponents.texts.secondary.text.bentVertical=o),p&&(jB(this._fullComponents,this._startComponents),SS(e,s,t,this._attributesPrev,this._startComponents,this._startInput),this._setBlocksAnimation(f,m,y)),this._setupHaloMasking(l,u),this._storeBlocks()}_setupHaloMasking(t,e){const s=this._nodeAttributes.halo,n=this._layers,i=s.color.get(t)&&s.hideNonAdjacentEdges.get(t),r=s.color.get(e)&&s.hideNonAdjacentEdges.get(e),o=!i&&!r?F2:Kl;n.body.stencilUsage=n.text.stencilUsage=n.textBg.stencilUsage=o}_computeBlockIds(t){const e=t*jf,s=this._blockIds;s.body=e+Hz,s.halo=e+Yz,s.text=e+$z,s.textBg=e+qz}_prepareBlocks(t,e,s,n){const i=this._layers;i.body.reset(n?cf:ar,t,e.edgeBody,s),i.halo.reset(n?cf:ar,t,e.edgeHalo,s),i.text.reset(ka,t,e.edgeText,s),i.textBg.reset(ar,t,e.edgeTextBackground,s)}_storeBlocks(){const t=this._engine,e=this._layers,s=this._blockIds;t.storeGroup(s.body,e.body),t.storeGroup(s.halo,e.halo),t.storeGroup(s.text,e.text),t.storeGroup(s.textBg,e.textBg)}_freeBlocks(){const t=this._engine,e=this._blockIds;t.freeBlock(e.body),t.freeBlock(e.halo),t.freeBlock(e.text),t.freeBlock(e.textBg)}_setBlocksAnimation(t,e,s){const n=this._layers;n.body.setGlobalAnimation(t,e,s),n.halo.setGlobalAnimation(t,e,s),n.text.setGlobalAnimation(t,e,s),n.textBg.setGlobalAnimation(t,e,s)}_initComponents(t,e,s){this._initEdgeComponents(t.halo,e.halo,s.halo),this._initEdgeComponents(t.outline,e.outline,s.body),this._initEdgeComponents(t.body,e.body,s.body),this._initTextComponents(t.texts.primary,e.texts.primary,s),this._initTextComponents(t.texts.secondary,e.texts.secondary,s)}_initEdgeComponents(t,e,s){t.head=this._nextElement(e.head,s),t.tail=this._nextElement(e.tail,s),t.body=this._nextElement(e.body,s)}_initTextComponents(t,e,s){t.background=this._nextElement(e.background,s.textBg),t.text=this._nextElement(e.text,s.text)}_nextElement(t,e){return t?e.next():this._nullElt}};function kS(t){return{body:t(),halo:t(),text:t(),textBg:t()}}function Ju(){return{halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}}}function qB(t,e,s){IC(t,e,s),e.imageContent!==null?(t.pattern.type=Go,t.pattern.attributes.image=e.imageContent,t.pattern.attributes.scaled=!0,t.pattern.attributes.duplicated=!1,t.patternScale=e.imageScale,t.patternMinVisibleSize=0,t.patternColor=null):(t.fillColor=null,t.strokeColor=null)}function YB(t,e,s){IC(t,e,s),e.textContent&&(t.pattern.type=Fa,t.pattern.attributes.text=e.textContent,t.pattern.attributes.font=e.textFont,t.pattern.attributes.style=e.textStyle,t.pattern.attributes.paddingLeft=e.scale*e.textPaddingLeft*2,t.pattern.attributes.paddingTop=e.scale*e.textPaddingTop*2,t.pattern.attributes.size=xh,t.patternMinVisibleSize=0,t.patternColor=e.textColor,t.patternScale=e.textScale,t.isBadge=!0),!e.imageUrl&&e.textContent||(t.fillColor=null,t.strokeColor=null)}function IC(t,e,s){const n=e.scalingMethod==="fixed",i=s.diameterScaled*e.scale;let r=0;const o=s.diameterScaled;n&&(r=s.diameterScaled*e.scale);const a=s.diameterScaled*e.positionScale/2,l=s.diameterFixed*e.positionScale/2;t.pieceId=qi,t.shape="circle",t.x1=s.x,t.y1=s.y,t.x2=s.x,t.y2=s.y,t.rectWidthOrSourceRadiusScaled=i,t.rectWidthOrSourceRadiusFixed=r,t.rectHeightOrTargetRadiusScaled=i,t.rectHeightOrTargetRadiusFixed=r,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.strokeWidthScaled,t.strokeWidthFixed=e.strokeWidthFixed,t.offsetScaled=a,t.offsetFixed=l,t.pattern.type=Wn,t.opacity=s.opacity,t.fillColor=e.color,t.strokeColor=e.strokeColor,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.angle,t.patternScale=0,t.symbolicSize=o,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1,t.isBadge=!0}function WB(t,e,s){Zf(t,e),t.fillColor=Array.isArray(e.color)?null:e.color,t.strokeColor=e.innerStroke.color,t.strokeMinVisibleSize=e.innerStroke.minVisibleSize,t.strokeWidthScaled=e.innerStroke.widthScaled,t.strokeWidthFixed=e.innerStroke.widthFixed,s&&(t.pattern.type=Wn)}function Zf(t,e){t.pieceId=qi,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=e.diameterScaled,t.rectWidthOrSourceRadiusFixed=e.diameterFixed,t.rectHeightOrTargetRadiusScaled=e.diameterScaled,t.rectHeightOrTargetRadiusFixed=e.diameterFixed,t.shape=e.shape,t.opacity=e.opacity,t.symbolicSize=e.diameterScaled,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=null,t.strokeColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.offsetAngle=0,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function XB(t,e){const s=e.diameterScaled+2*e.halo.widthScaled,n=e.diameterFixed+2*e.halo.widthFixed;t.pieceId=qi,t.shape="circle",t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=s,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=s,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=Wn,t.opacity=e.opacity,t.fillColor=e.halo.color,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function ZB(t,e){const s=e.diameterScaled+2*e.halo.widthScaled,n=e.diameterFixed+2*e.halo.widthFixed;t.pieceId=qi,t.shape="circle",t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=s,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=s,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.halo.strokeWidthScaled,t.strokeWidthFixed=e.halo.strokeWidthFixed,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=Wn,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=e.halo.strokeColor,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function KB(t,e){Zf(t,e),t.pattern.type=Ra,t.pattern.attributes.text=e.icon.content,t.pattern.attributes.font=e.icon.font,t.pattern.attributes.style=e.icon.style,t.pattern.attributes.size=xh,t.patternMinVisibleSize=e.icon.minVisibleSize,t.patternColor=e.icon.color,t.patternScale=e.icon.scale}function QB(t,e){const s=e.image.fit&&!e.image.tile;Zf(t,e),t.pattern.type=Go,t.pattern.attributes.image=e.image.content,t.pattern.attributes.scaled=s,t.pattern.attributes.duplicated=e.image.tile,t.patternScale=s?e.image.scale:0,t.patternMinVisibleSize=e.image.minVisibleSize,t.patternColor=null}function JB(t,e){const s=e.diameterScaled+2*e.innerStroke.widthScaled,n=e.diameterFixed+2*e.innerStroke.widthFixed;t.pieceId=qi,t.shape=e.shape,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=s,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=s,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.outerStroke.widthScaled,t.strokeWidthFixed=e.outerStroke.widthFixed,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=Wn,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=e.outerStroke.color,t.patternColor=null,t.globalMinVisibleSize=e.outerStroke.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function tU(t,e){const s=e.diameterScaled*GE,n=e.diameterFixed*GE;let i=e.diameterScaled*VE,r=e.diameterFixed*VE+tD;e.outerStroke.color&&(i+=e.outerStroke.widthScaled/2,r+=e.outerStroke.widthFixed/2),t.pieceId=qi,t.shape=e.shape,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=s,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=s,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=i,t.offsetFixed=r,t.pattern.type=Wn,t.opacity=e.opacity,t.fillColor=e.outline.color,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.outline.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=1.5707963267948966,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function eU(t,e){Zf(t,e),Array.isArray(e.color)&&(t.pattern.type=bh,t.pattern.attributes.colors=e.color.join(";"),t.patternScale=1,t.patternMinVisibleSize=0,t.patternColor=null)}function sU(t,e,s){kC(t,e,s),t.pattern.type=Ho,t.pattern.attributes.text=e.content,t.pattern.attributes.font=e.font,t.pattern.attributes.style=e.style,t.pattern.attributes.align=e.align,t.patternMinVisibleSize=0,t.patternColor=e.color,t.thicknessOrFontSizeScaled=e.sizeScaled,t.thicknessOrFontSizeFixed=e.sizeFixed,t.isText=!0}function nU(t,e,s){kC(t,e,s),t.fillColor=e.backgroundColor,t.pieceId=Ca,t.shape="square"}function iU(t,e,s){const n=Math.ceil(e.margin/2),i=s.diameterScaled/2,r=s.diameterFixed/2+n,o=oD[e.position],a=Math.cos(o),l=Math.sin(o),u=e.margin<12?1:e.margin<30?1-(e.margin-12)/18*.7:.25;t.pieceId=qi,t.shape="triangle",t.x1=s.x-a,t.y1=s.y-l,t.x2=s.x+a,t.y2=s.y+l,t.rectWidthOrSourceRadiusScaled=0,t.rectWidthOrSourceRadiusFixed=e.margin,t.rectHeightOrTargetRadiusScaled=0,t.rectHeightOrTargetRadiusFixed=e.margin*u,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=i,t.offsetFixed=r,t.pattern.type=Wn,t.opacity=s.opacity,t.fillColor=e.backgroundColor,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.positionAngle,t.patternScale=0,t.symbolicSize=s.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1}function kC(t,e,s){let n=0,i=0;if(e.isPositionCenter||(n+=s.diameterScaled/2,i+=s.diameterFixed/2+e.margin+e.paddingFixed+e.paddingScaled),e.isPositionVertical){if(n+=e.heightScaled/2,i+=e.heightFixed/2,e===s.texts.secondary&&s.texts.primary.position==="bottom"){const o=s.texts.primary;n+=o.heightScaled,i+=o.heightFixed+o.margin+2*(o.paddingFixed+o.paddingScaled)}}else e.isPositionHorizontal&&(n+=e.widthScaled/2,i+=e.widthFixed/2);const r=xh;t.pieceId=qi,t.shape="square",t.x1=s.x,t.y1=s.y,t.x2=s.x,t.y2=s.y,t.rectWidthOrSourceRadiusScaled=e.widthScaled+2*e.paddingScaled,t.rectWidthOrSourceRadiusFixed=e.widthFixed+2*e.paddingFixed,t.rectHeightOrTargetRadiusScaled=e.heightScaled+2*e.paddingScaled,t.rectHeightOrTargetRadiusFixed=e.heightFixed+2*e.paddingFixed,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=n,t.offsetFixed=i,t.pattern.type=Wn,t.pattern.attributes.size=r,t.opacity=s.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.positionAngle,t.patternScale=1,t.symbolicSize=s.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function RS(t,e,s,n,i,r){const o=i.badges,a=n.badges,l=r.badges;rU(t,e,s,n,i,r),FS(t,e,s,n.text,i.texts.primary,r.texts.primary,r),FS(t,e,s,n.text.secondary,i.texts.secondary,r.texts.secondary,r),Qc(t,e,s,a.topLeft,o.topLeft,l.topLeft,r),Qc(t,e,s,a.topRight,o.topRight,l.topRight,r),Qc(t,e,s,a.bottomLeft,o.bottomLeft,l.bottomLeft,r),Qc(t,e,s,a.bottomRight,o.bottomRight,l.bottomRight,r)}function rU(t,e,s,n,i,r){if(i.halo){const o=n.halo.width.get(s),a=+(n.halo.scalingMethod.get(s)==="scaled");r.halo.widthScaled=o*a,r.halo.widthFixed=o*(1-a),XB(i.halo,r),i.haloStroke&&(r.halo.strokeWidthScaled=0,r.halo.strokeWidthFixed=n.halo.strokeWidth.get(s),ZB(i.haloStroke,r))}if(i.outline&&(r.outline.color=n.outline.color.get(s),r.outline.minVisibleSize=n.outline.minVisibleSize.get(s),tU(i.outline,r)),i.outerStroke&&(r.outerStroke.minVisibleSize=n.outerStroke.minVisibleSize.get(s),JB(i.outerStroke,r)),i.pieChart&&eU(i.pieChart,r),i.image&&(r.image.content=e.imageManager.getImage(r.image.url),r.image.fit=n.image.fit.get(s),r.image.tile=n.image.tile.get(s),r.image.scale=n.image.scale.get(s),r.image.minVisibleSize=n.image.minVisibleSize.get(s),QB(i.image,r)),i.icon&&(r.icon.font=e.fontManager.getFont(n.icon.font.get(s)),r.icon.style=n.icon.style.get(s),r.icon.color=n.icon.color.get(s),r.icon.scale=n.icon.scale.get(s),r.icon.minVisibleSize=n.icon.minVisibleSize.get(s),KB(i.icon,r)),i.body){const o=!i.pieChart&&!i.image&&!i.icon;WB(i.body,r,o)}}function Qc(t,e,s,n,i,r,o){if(i.image||i.text){const a=n.stroke.width.get(s),l=+(n.stroke.scalingMethod.get(s)==="scaled");r.color=dr(n.color.get(s),o.color,r.angle),r.strokeColor=n.stroke.color.get(s),r.strokeWidthScaled=a*l,r.strokeWidthFixed=a*(1-l),r.minVisibleSize=n.minVisibleSize.get(s),r.positionScale=n.positionScale.get(s),r.scale=n.scale.get(s)}if(i.image&&(r.imageContent=e.imageManager.getImage(r.imageUrl),r.imageScale=n.image.scale.get(s),qB(i.image,r,o)),i.text){if(r.textFont=e.fontManager.getFont(n.text.font.get(s)),r.textStyle=n.text.style.get(s),r.textColor=dr(n.text.color.get(s),o.color),r.textScale=n.text.scale.get(s),r.textPaddingTop=n.text.paddingTop.get(s),r.textPaddingLeft=n.text.paddingLeft.get(s),t.measureText(r.textContent,r.textFont,r.textStyle,r.textScale).width>1){let a=0,l=0;for(;l<r.textContent.length&&a<1;)a+=t.measureText(r.textContent[l],r.textFont,r.textStyle,r.textScale).width,l+=1;l!==r.textContent.length&&(r.textContent=r.textContent.substring(0,l-1)+"")}YB(i.text,r,o)}}function FS(t,e,s,n,i,r,o){if(i.text&&r.content){const a=n,l=a.scaling.get(s);r.font=e.fontManager.getFont(a.font.get(s)),r.color=dr(a.color.get(s),o.color),r.style=a.style.get(s),r.align=a.align.get(s),r.minVisibleSize=a.minVisibleSize.get(s),r.margin=a.margin.get(s);const u=a.padding.get(s);if(r.maxLineLength=a.maxLineLength.get(s),r.content=Yx(r.content,r.maxLineLength),l){const g=a.scale.get(s);r.paddingFixed=0,r.paddingScaled=u*g,r.sizeScaled=o.diameterScaled*g,r.sizeFixed=o.diameterFixed*g}else r.sizeFixed=a.size.get(s),r.sizeScaled=0,r.paddingFixed=u,r.paddingScaled=0;const h=t.measureText(r.content,r.font,r.style);r.widthScaled=h.width*r.sizeScaled,r.widthFixed=h.width*r.sizeFixed,r.heightScaled=h.height*r.sizeScaled,r.heightFixed=h.height*r.sizeFixed,r.positionAngle=rD[r.position],r.isPositionCenter=r.position==="center",r.isPositionVertical=r.position==="top"||r.position==="bottom",r.isPositionHorizontal=r.position==="left"||r.position==="right",sU(i.text,r,o),i.background&&(nU(i.background,r,o),i.tip&&iU(i.tip,r,o))}}function PS(t,e){oU(t,e),zS(t.texts.primary,e.texts.primary),zS(t.texts.secondary,e.texts.secondary),Jc(t.badges.topLeft,e.badges.topLeft),Jc(t.badges.topRight,e.badges.topRight),Jc(t.badges.bottomLeft,e.badges.bottomLeft),Jc(t.badges.bottomRight,e.badges.bottomRight)}function oU(t,e){t.body=!0,t.icon=!!e.icon.content,t.image=!!e.image.url,t.pieChart=Array.isArray(e.color),t.outerStroke=!!e.outerStroke.color,t.outline=!!e.outline.enabled,t.halo=!!e.halo.color,t.haloStroke=t.halo&&!!e.halo.strokeColor}function zS(t,e){t.text=!e.hidden&&!!e.content,t.background=t.text&&!!e.backgroundColor,t.tip=t.background&&e.tip&&e.position!=="center"}function Jc(t,e){t.text=!!e.textContent,t.image=!!e.imageUrl}function DS(t,e,s,n){aU(t,e,s,n),OS(t,e.texts.primary,s.text,n,e),OS(t,e.texts.secondary,s.text.secondary,n,e),tg(t,e.badges.topLeft,s.badges.topLeft,n),tg(t,e.badges.topRight,s.badges.topRight,n),tg(t,e.badges.bottomLeft,s.badges.bottomLeft,n),tg(t,e.badges.bottomRight,s.badges.bottomRight,n)}function aU(t,e,s,n){const i=+(s.scalingMethod.get(n)==="scaled"),r=2*s.radius.get(n),o=s.innerStroke.width.get(n),a=+(s.innerStroke.scalingMethod.get(n)==="scaled"),l=s.outerStroke.width.get(n),u=+(s.outerStroke.scalingMethod.get(n)==="scaled");e.x=s.x.get(n),e.y=s.y.get(n),e.shape=s.shape.get(n),e.color=s.color.get(n),e.opacity=s.opacity.get(n),e.diameterScaled=r*i,e.diameterFixed=r*(1-i),e.innerStroke.color=dr(s.innerStroke.color.get(n),e.color),e.innerStroke.widthScaled=o*a,e.innerStroke.widthFixed=o*(1-a),e.innerStroke.minVisibleSize=s.innerStroke.minVisibleSize.get(n),e.outerStroke.color=dr(s.outerStroke.color.get(n),e.color),e.outerStroke.widthScaled=l*u,e.outerStroke.widthFixed=l*(1-u),e.halo.color=s.halo.color.get(n),e.halo.strokeColor=s.halo.strokeColor.get(n),e.icon.content=t.formatText(s.icon.content.get(n)),e.image.url=s.image.url.get(n),e.outline.enabled=s.outline.enabled.get(n),e.textHidden=s.textHidden.get(n)===1}function OS(t,e,s,n,i){if(e.hidden=i.textHidden,e.content=t.formatText(s.content.get(n)),e.backgroundColor=dr(s.backgroundColor.get(n),i.color),e===i.texts.primary){const r=s;e.tip=r.tip.get(n),e.position=r.position.get(n)}else e.position="bottom"}function tg(t,e,s,n){const i=s.text.content.get(n);e.textContent=t.formatText(i),e.imageUrl=s.image.url.get(n),e.scalingMethod=s.scalingMethod.get(n)}var eg=t=>({angle:t,color:"",scale:0,positionScale:0,minVisibleSize:0,strokeColor:"",strokeWidthScaled:0,strokeWidthFixed:0,scalingMethod:"scaled",textContent:"",textFont:"",textColor:"",textScale:0,textStyle:"none",imageUrl:"",imageContent:null,imageScale:0,textPaddingLeft:0,textPaddingTop:0}),BS=()=>({hidden:!1,content:"",position:"",backgroundColor:"",tip:!1,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",align:"left",minVisibleSize:0,margin:0,paddingScaled:0,paddingFixed:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:!1,isPositionVertical:!1,isPositionHorizontal:!1}),US=()=>({x:0,y:0,shape:"",color:"",opacity:0,diameterScaled:0,diameterFixed:0,innerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},outerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},icon:{content:"",font:"",color:"",scale:0,size:0,style:"none",minVisibleSize:0},image:{url:"",content:null,scale:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,color:"",strokeColor:""},outline:{enabled:!1,color:"",minVisibleSize:0},badges:{topLeft:eg(B2),topRight:eg(U2),bottomLeft:eg(G2),bottomRight:eg(V2)},textHidden:!1,texts:{primary:BS(),secondary:BS()}}),lU=(t,e)=>{e.haloStroke=e.haloStroke||t.haloStroke,e.halo=e.halo||t.halo,e.outline=e.outline||t.outline,e.outerStroke=e.outerStroke||t.outerStroke,e.body=e.body||t.body,e.pieChart=e.pieChart||t.pieChart,e.image=e.image||t.image,e.icon=e.icon||t.icon;const s=t.badges,n=e.badges;n.topLeft.text=n.topLeft.text||s.topLeft.text,n.topLeft.image=n.topLeft.image||s.topLeft.image,n.topRight.text=n.topRight.text||s.topRight.text,n.topRight.image=n.topRight.image||s.topRight.image,n.bottomLeft.text=n.bottomLeft.text||s.bottomLeft.text,n.bottomLeft.image=n.bottomLeft.image||s.bottomLeft.image,n.bottomRight.text=n.bottomRight.text||s.bottomRight.text,n.bottomRight.image=n.bottomRight.image||s.bottomRight.image;const i=t.texts,r=e.texts;r.primary.text=r.primary.text||i.primary.text,r.primary.background=r.primary.background||i.primary.background,r.primary.tip=r.primary.tip||i.primary.tip,r.secondary.text=r.secondary.text||i.secondary.text,r.secondary.background=r.secondary.background||i.secondary.background,r.secondary.tip=r.secondary.tip||i.secondary.tip},RC=t=>(e,s)=>{s.haloStroke=e.haloStroke[t],s.halo=e.halo[t],s.outline=e.outline[t],s.outerStroke=e.outerStroke[t],s.body=e.body[t],s.pieChart=e.pieChart[t],s.image=e.image[t],s.icon=e.icon[t];const n=e.badges,i=s.badges;i.topLeft.text=n.topLeft.text[t],i.topLeft.image=n.topLeft.image[t],i.topRight.text=n.topRight.text[t],i.topRight.image=n.topRight.image[t],i.bottomLeft.text=n.bottomLeft.text[t],i.bottomLeft.image=n.bottomLeft.image[t],i.bottomRight.text=n.bottomRight.text[t],i.bottomRight.image=n.bottomRight.image[t];const r=e.texts,o=s.texts;o.primary.text=r.primary.text[t],o.primary.background=r.primary.background[t],o.primary.tip=r.primary.tip[t],o.secondary.text=r.secondary.text[t],o.secondary.background=r.secondary.background[t],o.secondary.tip=r.secondary.tip[t]},uU=RC("start"),dU=RC("end"),hU=class{constructor({engine:t,imageManager:e,fontManager:s,formatText:n,attributes:i,attributesPrev:r}){this._fullComponents=td(),this._startComponents=td(),this._endComponents=td(),this._startFlags=td(),this._endFlags=td(),this._startInput=US(),this._endInput=US(),this._depthInfo=s0(),this._nodePatternAssigned=!1,this._nullElt={id:-1,valid:!0},this._engine=t,this._attributes=i,this._attributesPrev=r,this._helper={imageManager:e,fontManager:s,formatText:n},this._layers=GS((()=>t.createGroup())),this._blockIds=GS((()=>0))}drawNode(t){if(this._computeBlockIds(t),this._attributes.excluded.get(t))return this._freeBlocks();const e=this._engine,s=this._helper,n=t,i=this._attributes,r=Kd(i.layer.get(t)-(i.detectable.get(t)?0:1),this._depthInfo),o=i.animationDuration.get(t),a=o>0;if(this._prepareBlocks(a,r,n),DS(s,this._endInput,i,t),PS(this._endFlags,this._endInput),a&&(DS(s,this._startInput,this._attributesPrev,t),PS(this._startFlags,this._startInput),lU(this._endFlags,this._startFlags)),this._initComponents(this._fullComponents,this._endFlags,this._layers),dU(this._fullComponents,this._endComponents),RS(e,s,t,i,this._endComponents,this._endInput),a&&(uU(this._fullComponents,this._startComponents),RS(e,s,t,this._attributesPrev,this._startComponents,this._startInput)),a){const l=this._attributes.animationStart.get(t),u=this._attributes.animationEasing.get(t);this._setBlocksAnimation(o,l,u)}this._endFlags.halo&&this._attributes.halo.hideNonAdjacentEdges.get(t)&&(this._layers.halo.stencilUsage=this._layers.haloStroke.stencilUsage=R2),this._storeBlocks()}_computeBlockIds(t){const e=t*jf,s=this._blockIds;s.body=e+Bz,s.text=e+Uz,s.textBg=e+Gz,s.halo=e+Vz,s.haloStroke=e+jz}_prepareBlocks(t,e,s){const n=this._layers;n.body.reset(ar,t,e.nodeBody,s),n.text.reset(ka,t,e.nodeText,s),n.textBg.reset(ar,t,e.nodeTextBackground,s),n.halo.reset(ar,t,e.nodeHalo,s),n.haloStroke.reset(ar,t,e.nodeHaloStroke,s)}_storeBlocks(){const t=this._engine,e=this._layers,s=this._blockIds;t.storeGroup(s.body,e.body),t.storeGroup(s.text,e.text),t.storeGroup(s.textBg,e.textBg),t.storeGroup(s.halo,e.halo),t.storeGroup(s.haloStroke,e.haloStroke)}_freeBlocks(){const t=this._engine,e=this._blockIds;t.freeBlock(e.body),t.freeBlock(e.text),t.freeBlock(e.textBg),t.freeBlock(e.halo),t.freeBlock(e.haloStroke)}_setBlocksAnimation(t,e,s){const n=this._layers;n.body.setGlobalAnimation(t,e,s),n.text.setGlobalAnimation(t,e,s),n.textBg.setGlobalAnimation(t,e,s),n.halo.setGlobalAnimation(t,e,s),n.haloStroke.setGlobalAnimation(t,e,s)}_initComponents(t,e,s){this._nodePatternAssigned=!1,this._initBaseComponents(t,e,s),this._initBadgeComponents(t.badges.topLeft,e.badges.topLeft,s),this._initBadgeComponents(t.badges.topRight,e.badges.topRight,s),this._initBadgeComponents(t.badges.bottomLeft,e.badges.bottomLeft,s),this._initBadgeComponents(t.badges.bottomRight,e.badges.bottomRight,s),this._initTextComponents(t.texts.primary,e.texts.primary,s),this._initTextComponents(t.texts.secondary,e.texts.secondary,s)}_initBaseComponents(t,e,s){t.haloStroke=this._nextElement(e.haloStroke,s.haloStroke),t.halo=this._nextElement(e.halo,s.halo),t.outline=this._nextElement(e.outline,s.body),t.outerStroke=this._nextElement(e.outerStroke,s.body),t.body=this._nextElement(e.body,s.body),t.pieChart=this._getNodePatternElement(e.pieChart,s),t.image=this._getNodePatternElement(e.image,s),t.icon=this._getNodePatternElement(e.icon,s)}_initBadgeComponents(t,e,s){t.image=this._nextElement(e.image,s.body),t.text=this._nextElement(e.text,s.body)}_initTextComponents(t,e,s){t.background=this._nextElement(e.background,s.textBg),t.tip=this._nextElement(e.tip,s.textBg),t.text=this._nextElement(e.text,s.text)}_nextElement(t,e){return t?e.next():this._nullElt}_getNodePatternElement(t,e){return t?this._nodePatternAssigned?e.body.next():(this._nodePatternAssigned=!0,e.body.getCurrentElement()):this._nullElt}};function GS(t){return{body:t(),text:t(),textBg:t(),halo:t(),haloStroke:t()}}function td(){return{haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}}}function cU({graph:t,elements:e,engine:s,imageManager:n,fontManager:i,view:r,attributes:o,boundaries:a,formatText:l}){const{nodeAttributes:u,nodeAttributesPrev:h,edgeAttributes:g,edgeAttributesPrev:f}=gU(o),{nodes:m,edges:y}=e,{maxSize:p,maxMinVisibleSize:x}=a;if(!m.size&&!y.size)return;const v=(Math.max(t.getNodeMaxIndex(),t.getEdgeMaxIndex())+1)*jf,b=p<1024?8*p:2*p,S=s.setGlobalBoundaries({maxBlockId:Do(v),maxScaledSize:Do(b),maxMinVisibleSize:Do(x),maxSymbolicSize:Do(p),maxDashLength:3,maxGapLength:1,maxPatternScale:2,maxCoord:-1/0}),A=(S?t.getNodes("_all"):m)._indexes,w=(S?t.getEdges("_all"):y)._indexes;if(A.length){const L=new hU({engine:s,imageManager:n,fontManager:i,formatText:l,attributes:u,attributesPrev:h});for(let k=0;k<A.length;++k)L.drawNode(A[k])}if(w.length){const L=new $B({engine:s,imageManager:n,fontManager:i,formatText:l,view:r,attributes:g,attributesPrev:f,nodeAttributes:u,nodeAttributesPrev:h});for(let k=0;k<w.length;++k)L.drawEdge(w[k])}}function gU(t){const e=Ol(t.nodes.current,{text:{secondary:{scaling:t.nodes.current.text.scaling,maxLineLength:t.nodes.current.text.maxLineLength}}});return{nodeAttributes:e,nodeAttributesPrev:Ol(t.nodes.previous,{textHidden:e.textHidden,text:{secondary:{scaling:t.nodes.previous.text.scaling,maxLineLength:t.nodes.previous.text.maxLineLength}}}),edgeAttributes:Ol(t.edges.current,{text:{secondary:{scaling:t.edges.current.text.scaling,maxLineLength:t.edges.current.text.maxLineLength,adjustAngle:t.edges.current.text.adjustAngle}}}),edgeAttributesPrev:Ol(t.edges.previous,{source:t.edges.current.source,target:t.edges.current.target,textHidden:t.edges.current.textHidden,text:{secondary:{scaling:t.edges.previous.text.scaling,maxLineLength:t.edges.previous.text.maxLineLength,adjustAngle:t.edges.previous.text.adjustAngle}}})}}function Qd(t,e,s){const n=s.length;let i=n-1,r=!1;for(let o=0;o<n;++o)(s[o].y<e&&s[i].y>=e||s[i].y<e&&s[o].y>=e)&&(s[o].x<=t||s[i].x<=t)&&(r=r!==s[o].x+(e-s[o].y)/(s[i].y-s[o].y)*(s[i].x-s[o].x)<t),i=o;return r}function sg(t){const e=t.x*t.x+t.y*t.y;return{x:t.x/e,y:t.y/e}}function VS(t,e){let s=1/0,n=-1/0;for(let i=0,r=t.length;i<r;i++){const o=t[i],a=o.x*e.x+o.y*e.y;a<s&&(s=a),a>n&&(n=a)}return{x:s,y:n}}function fU(t,e){let s=t[1],n=t[0],i=sg({x:s.x-n.x,y:s.y-n.y}),r=i.x;i.x=-i.y,i.y=r;const o=i;s=t[2],n=t[1],i=sg({x:s.x-n.x,y:s.y-n.y}),r=i.x,i.x=-i.y,i.y=r;const a=i;s=e[1],n=e[0],i=sg({x:s.x-n.x,y:s.y-n.y}),r=i.x,i.x=-i.y,i.y=r;const l=i;return s=e[2],n=e[1],i=sg({x:s.x-n.x,y:s.y-n.y}),r=i.x,i.x=-i.y,i.y=r,[o,a,l,i]}function FC(t,e){const s=fU(t,e);for(let n=0,i=s.length;n<i;n++){const r=s[n],o=VS(t,r),a=VS(e,r);if((o.x<=a.y&&o.y>=a.x?Math.min(o.y,a.y)-Math.max(o.x,a.x):0)===0)return!1}return!0}function mU(t){let e=0,s=0;const n=t.length;if(n===0)throw new Error("Compute centroid: at least one point is required");for(let i=0;i<n;++i){const r=t[i];e+=r.x,s+=r.y}return e/=n,s/=n,{x:e,y:s}}var PC=Sh(4),zC=Sh(5),DC=Sh(10,.4),Bo=1/3,pU=[{x:-1,y:-Bo},{x:0,y:-Bo},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:0,y:Bo},{x:-1,y:Bo}],OC=[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],_U=[{x:-1,y:-Bo},{x:-.55,y:-Bo},{x:-1,y:-1},{x:1,y:0},{x:-1,y:1},{x:-.55,y:Bo},{x:-1,y:Bo}],jS=[{x:-.6,y:-.3},{x:.1,y:0},{x:-.6,y:.3}],BC=[{x:-1,y:.31},{x:-1,y:-.31},{x:-.31,y:-.31},{x:-.31,y:-1},{x:.31,y:-1},{x:.31,y:-.31},{x:1,y:-.31},{x:1,y:.31},{x:.31,y:.31},{x:.31,y:1},{x:-.31,y:1},{x:-.31,y:.31}],Ro={circle:{getDistanceFromStrokeVertically:(t,e)=>1,getDistanceFromStrokeHorizontally:(t,e)=>1-Math.sqrt(t*t+e*e),points:[{x:0,y:0,r:1}],isSimple:!0},square:{getDistanceFromStrokeVertically:(t,e)=>.996-Math.abs(e),getDistanceFromStrokeHorizontally:(t,e)=>.996-Math.abs(t),points:OC,isSimple:!0},line:{getDistanceFromStrokeVertically:(t,e)=>1-Math.abs(e),getDistanceFromStrokeHorizontally:(t,e)=>1,points:[{x:-1,y:0},{x:1,y:0}],isSimple:!0},triangle:{getDistanceFromStrokeVertically:(t,e)=>(1-t)/2-Math.abs(e),getDistanceFromStrokeHorizontally:(t,e)=>1-Math.abs(t),points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},arrow:{getDistanceFromStrokeVertically:(t,e)=>(1-t)/2-Math.abs(e),getDistanceFromStrokeHorizontally:(t,e)=>1-Math.abs(t),points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},"circle-hole-arrow":{getDistanceFromStrokeVertically:(t,e)=>Math.min(Math.sqrt((t+.4)*(t+.4)+e*e)-.27,(1-t)/2-Math.abs(e)),getDistanceFromStrokeHorizontally:(t,e)=>1-Math.abs(t),points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:[{x:-.4,y:0,r:.3}],isSimple:!0},"triangle-hole-arrow":{getDistanceFromStrokeVertically:(t,e)=>{const s=Math.min((1-t)/2-Math.abs(e),1-Math.abs(t)),n=-UC(t,e,jS);return Math.min(s,n)},getDistanceFromStrokeHorizontally:(t,e)=>1,points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:jS,isSimple:!0},"short-arrow":ei(pU,!1),"sharp-arrow":ei(_U,!1),cross:{getDistanceFromStrokeVertically:(t,e)=>1,getDistanceFromStrokeHorizontally:(t,e)=>{const s=Math.abs(t),n=Math.abs(e),i=.31-Math.min(s,n),r=1-Math.max(s,n);return Math.min(i,r)},points:BC,isSimple:!1},diamond:ei(PC),pentagon:ei(zC),star:ei(DC),triangleUp:ei([{x:-1,y:1},{x:1,y:1},{x:0,y:-1}],!0),triangleDown:ei([{x:-1,y:-1},{x:1,y:-1},{x:0,y:1}],!0),triangleLeft:ei([{x:1,y:-1},{x:1,y:1},{x:-1,y:0}],!0),hexagon:ei(Sh(6,1,-Math.PI/2+Hf),!1)},yU=["circle","square","triangle","line","triangleUp","triangleDown","triangleLeft"],xU=["cross","diamond","pentagon","star","hexagon"],vU=["arrow","triangle-hole-arrow","circle-hole-arrow","short-arrow","sharp-arrow"];function HS(t,e){for(const r of yU)n_(t,r);const s=e.nodes.current.shape.getValues(),n=e.edges.current.shape.head.getValues(),i=e.edges.current.shape.tail.getValues();for(const r of xU)s.includes(r)&&n_(t,r);for(const r of vU)r&&(n.includes(r)||i.includes(r))&&n_(t,r)}function n_(t,e){t.registerShape(e,Ro[e])}function bU(t,e){Ro.star=ei(wl(DC,e,Al)),Ro.pentagon=ei(wl(zC,e,Al)),Ro.hexagon=ei(wl(Sh(6,1,-Math.PI/2+Hf),e,Al)),Ro.square=ei(wl(OC,e,Al)),Ro.cross=ei(wl(BC,e,Al)),Ro.diamond=ei(wl(PC,e,Al)),["star","pentagon","hexagon","square","cross","diamond"].forEach((s=>t.updateShape(s,Ro[s])))}function UC(t,e,s){let n=1/0;const i={x:t,y:e};for(let r=0;r<s.length;++r){const o=s[r],a=s[(r+1)%s.length];n=Math.min(n,rC(i,o,a))}return n*(Qd(t,e,s)?1:-1)}function Sh(t,e=1,s=-Math.PI/2+Hf){const n=[],i=2*Math.PI/t;let r=s;for(let o=0;o<t;++o){const a=o%2==1?e:1;n.push({x:Math.cos(r)*a,y:Math.sin(r)*a}),r+=i}return n}function ei(t,e=!1){return{getDistanceFromStrokeVertically:()=>1,getDistanceFromStrokeHorizontally:(s,n)=>UC(s,n,t),points:t,isSimple:e}}function wl(t,e,s=5){if(e===0)return t;const n=[],i=t.length;for(let r=0;r<i;r++){const o=t[(r+i-1)%i],a=t[r%i],l=t[(r+1)%i],u=o.x-a.x,h=o.y-a.y,g=Math.sqrt(u*u+h*h),f=u/g,m=h/g,y=Math.atan2(m,f),p=l.x-a.x,x=l.y-a.y,v=Math.sqrt(p*p+x*x),b=p/v,S=x/v,A=Math.atan2(S,b),w=f*S-m*b,L=f*b-m*-S;let k=Math.asin(w<-1?-1:w>1?1:w),F=1,O=!1;L<0?k<0?k=Math.PI+k:(k=Math.PI-k,F=-1,O=!0):k>0&&(F=-1,O=!0);const j=k/2;let V=Math.abs(Math.cos(j)*e/Math.sin(j)),Z=e;V>Math.min(g/2,v/2)&&(V=Math.min(g/2,v/2),Z=Math.abs(V*Math.sin(j)/Math.cos(j)));let at=a.x+b*V,mt=a.y+S*V;at+=-S*Z*F,mt+=b*Z*F;const K=y+Math.PI/2*F;let ut=A-Math.PI/2*F-K;ut=O?ut>0?ut-2*Math.PI:ut:ut<0?ut+2*Math.PI:ut;for(let ht=0;ht<s;ht++){const nt=K+ut*(ht/(s-1)),ot=at+Z*Math.cos(nt),Mt=mt+Z*Math.sin(nt);n.push({x:ot,y:Mt})}}return n}var EU=class extends vh{constructor(t,e){super(),this.isDummy=!0,this.width=0,this.height=0,this.namespaceURI="http://www.w3.org/1999/xhtml"}setAttribute(t,e){t==="src"&&(this.src=e),t==="crossOrigin"&&(this.crossOrigin=e)}set src(t){t&&(this._src=t,setTimeout((()=>{this.onload&&this.onload.call(this),this.width=1,this.height=1,this.fire("load")}),10))}get src(){return this._src}addEventListener(t,e){this.on(t,e)}};function SU(t,e){return new(typeof Image<"u"?Image:EU)(t,e)}var AU=class{constructor(){this._images={},this._crossOrigin="anonymous",this._whenReady=[],this._onFetch=[],this._nbLoaded=0,this._nbToLoad=0}setImgCrossOrigin(t){this._crossOrigin=t}clear(){this._images={},this._nbLoaded=0,this._nbToLoad=0}getImage(t){let e=this._images[t];return e===void 0&&(this._nbToLoad+=1,e=SU(),e.crossOrigin=this._crossOrigin,e.addEventListener("load",(()=>this._onImgLoad(t))),e.addEventListener("error",(()=>{this._onImgLoad(t),this._images[t]=null})),MR(e,"src",t),this._images[t]=e),e}_onImgLoad(t){this._nbLoaded+=1,this._onFetch.forEach((e=>e(t))),this._nbLoaded===this._nbToLoad&&(this._whenReady.forEach((e=>e())),this._whenReady=[])}onFetch(t){this._onFetch.push(t)}whenReady(){return this._nbLoaded===this._nbToLoad?Promise.resolve():new Promise((t=>this._whenReady.push(t)))}destroy(){this._whenReady=[],this._onFetch=[]}},n0={};hh(n0,{BUTTON_MAPPING:()=>Sx,BoundingBox:()=>ii,DummyCanvas:()=>j2,DummyCanvasRenderingContext2D:()=>H2,DummyDomElement:()=>kT,DummyFileReader:()=>NT,DummyTextNode:()=>bL,DummyXHR:()=>LT,ElementSet:()=>Ah,EventTarget:()=>vh,FlexArray:()=>af,IndexList:()=>p2,MOUSE_WHEEL_THROTTLE:()=>ST,Map2:()=>k2,PathMap:()=>pL,PrioritySet:()=>d2,SVG_NS:()=>bx,Table:()=>ry,XLINK:()=>PT,XML_NS:()=>Y_,applyCursorStyle:()=>ef,baseURI:()=>GT,binaryIndexOf:()=>zw,cancelAnimFrame:()=>AT,clamp:()=>$i,clearCanvas:()=>fy,componentsToRGBA:()=>N2,computeMax:()=>Ul,computeMin:()=>Yr,concatenateArrays:()=>yk,createBlob:()=>$d,createCanvas:()=>Fn,createDummyDomElement:()=>Jg,createDummyXmlDocument:()=>SL,createElement:()=>W_,createSvgElement:()=>ys,createTextNode:()=>Ex,createWebGL2Context:()=>q2,createWorker:()=>xL,createXmlDocument:()=>AL,dataUrlToBlob:()=>RT,debounce:()=>bk,deepCopy:()=>Ws,displayPixelsOnScreen:()=>VU,ensureTransferable:()=>Nf,escapeDOMAttribute:()=>Bl,extendList:()=>Ak,fadeElement:()=>VT,fetch:()=>fu,fetchBinary:()=>BT,fetchBinaryAsBase64:()=>UT,flatten:()=>jd,flattenArray:()=>Pw,fontSizeToBadgeScale:()=>mL,forEach:()=>Cr,formatAngle:()=>sf,formatHex:()=>Pg,formatWorkerMessage:()=>yL,getBaseLog:()=>jT,getCurrentTime:()=>$n,getDate:()=>Zw,getDocument:()=>no,getDocumentFontRules:()=>cL,getEmbeddedFontRules:()=>gL,getFlattenedKeys:()=>Ba,getGlContext:()=>Y2,getImage:()=>zT,getLeafValues:()=>Lf,getOptions:()=>Ci,getPixelRatio:()=>mi,getProperty:()=>qs,getResizeObserver:()=>MT,getStyle:()=>IT,getTime:()=>Kw,getValues:()=>Cd,getWebglContext:()=>qx,hash8:()=>z_,htmlSanitizer:()=>Ax,indexArrayToArray:()=>Gd,indexByName:()=>wk,insertSortAsc:()=>ud,insertSortDesc:()=>_k,isArray:()=>Rn,isBlob:()=>wF,isHTMLElement:()=>OT,isInteger:()=>vk,isLittleEndian:()=>Cf,isObject:()=>dn,isRawObject:()=>Oa,isWebGLSupported:()=>$2,lerp:()=>bs,lightDebounce:()=>Dw,mapKeys:()=>M2,mapValues:()=>I2,merge:()=>Ol,mergeValues:()=>Hg,mix:()=>X_,nextPowerOfTwo:()=>Do,objToValueList:()=>Kf,parseColor:()=>Yn,parseColorHex:()=>Ox,parseColorRgba:()=>Dx,pick:()=>O_,processQueue:()=>Ek,promiseQueue:()=>Bw,promptDownload:()=>Xo,propertyPathToString:()=>P_,removeFromArray:()=>xk,requestAnimFrame:()=>yx,resizeElement:()=>tf,resolvePath:()=>fL,rgbaToRgb:()=>Rl,serializeXMLDocument:()=>d0,setAttributes:()=>vx,setCtxFont:()=>$o,setElementSize:()=>Ga,setKeys:()=>DU,setProperty:()=>Kr,setValues:()=>vd,smartRequire:()=>Hi,throttle:()=>Vd,toArray:()=>F_,toHexa:()=>hy,toPropertyPath:()=>Da,traverse:()=>Gw,unflatten:()=>D_,unorderedHash:()=>Sk,workerIsAvailable:()=>_L});var si="Arial",qo="black",ff="rgba(255,255,255,0)",uu=12,Jd=3,i0=7,wU=!0,r0=10,TU=5,GC=.08,VC="rgba(255,255,255,0)",jC="normal",HC="center",$C=!1,qC=0,by="red",YC="rgb(220, 220, 220)",WC="red",XC="rgb(220, 220, 220)",ZC="grey",KC="white",o0=2,QC=null,a0=5,Ey=0,JC="rgba(0, 0, 0, 0.36)",CU=1,LU="circle",Sy=12,_d="white",Wl=40,yd="black",Xl=2,xd="black",l0=40,tL=null,eL=null,u0=1,sL="black",nL=1e3,iL=800,rL=1,oL=2,aL="rgba(0, 0, 0, 0.0)",lL="rgba(0, 0, 0, 0.6)",uL=50,NU=.1,Tl=12,ng=24,th=1,Ay=th/2,$S=.45,qS=.7,MU=10,dL=MU/2,hL=5;function IU(t){let e="";for(let s=0;s<t.length;s++)e+=t[s].cssText+`
`;return e}function cL(){const t=no(),e=t.styleSheets||[],s=GT(t),n=[],i=[];for(let o=0;o<e.length;o++){const a=e[o];a.href==null?n.push({href:s,content:IU(a.cssRules)}):i.push(a.href)}const r=/@font-face\s*\{[^}]+\}/g;return Promise.all(i.map((o=>fu(o).then((a=>({href:o,content:a}))).catch(Yg)))).then((o=>o.concat(n))).then((o=>{const a=[];for(let l=0;l<o.length;l++){const u=o[l];if(u!==null){const{href:h,content:g}=u,f=g.match(r);if(f){const m=RU(f,h);a.push.apply(a,m)}}}return a}))}function gL(t,e){return Promise.all(t.map((({formats:s,originalRule:n})=>Promise.all(s.map((({format:i,url:r})=>e?UT(r).then((o=>({format:i,src:o}))).catch(Yg):{format:i,src:r}))).then((i=>{const r=[];for(const o of i)o!==null&&r.push(`url('${o.src}') format('${o.format}')`);if(r.length!==0){const o=`src: ${r.join(",")}`;return n.replace(/@font-face\s*{([^}]*);?}/,`@font-face{$1;${o}}`).replace(/\s+/," ").replace(/;+/,";")}return n})))))}var kU={"embedded-opentype":!0,svg:!0};function RU(t,e){const s=/url\(['"]?([^'")]+)['"]?\)\s+format\(['"]?([^'")]+)['"]?\)/g,n=/font-family\s*:\s*['"]?([^;'"]+)['"]?;/,i=[];for(let r=0;r<t.length;r++){const o=t[r],a=o.match(n);if(a){const l=a[1],u=[];let h;for(;h=s.exec(o);){const g=h[1],f=h[2];kU[f.toLowerCase()]||u.push({format:f,url:fL(g,e)})}i.push({name:l,formats:u,originalRule:o})}}return i}function fL(t,e){if(/^http(s)?:/.test(t))return t;if(t[0]==="/"){const i=e.match(/((\w+:\/\/)([^/]+))/);return i?i[1]+t:t}const s=t.split("/"),n=e.split("/");for(e[e.length-1]!=="/"&&n.pop();s[0]==="..";)s.shift(),n.pop();return n.concat(s).join("/").replace(/[\w](\/{2,})/g,(i=>i[0]+"/"))}function mL(t,e,s=Ay){return t/s/(2*e)}function FU(t){return t instanceof RegExp||t instanceof Date}var PU=typeof HTMLElement>"u"?t=>!1:t=>t instanceof HTMLElement,zU=function(t){return typeof t!="object"||t===null||Rn(t)||FU(t)};function Kf(t,e=[],s=[]){if(!PU(t)){if(zU(t))e.push({path:s.slice(),value:t});else{const n=Object.keys(t);for(let i=0;i<n.length;++i){const r=n[i],o=s.slice();o.push(r),Kf(t[r],e,o)}}return e}}var pL=class{constructor(){this._keys=[],this._values=[],this._size=0,this._cachedPath=[],this._cachedIndex=-1}get size(){return this._size}set(t,e){const s=this._getIndex(t);s!==-1?this._values[s]=e:(i_(this._cachedPath,t)&&(this._cachedIndex=this._keys.length),this._keys.push(t),this._values.push(e),this._size+=1)}get(t){const e=this._getIndex(t);if(e!==-1)return this._values[e]}has(t){return this._getIndex(t)!==-1}keys(){return this._keys.slice()}_getIndex(t){if(i_(t,this._cachedPath))return this._cachedIndex;this._cachedPath=t.slice();const e=this._keys;for(let s=0;s<e.length;++s)if(i_(e[s],t))return this._cachedIndex=s,s;return this._cachedIndex=-1,-1}};function i_(t,e){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(t[s]!==e[s])return!1;return!0}var wy,DU=function(e){return Array.from(e.keys())},vd=function(e){return Array.from(e.values())},eh=Hi("web-worker"),_L=!!eh||typeof Worker<"u"&&typeof Blob<"u";function yL(t){return eh?Ty(t):t}function Ty(t){if(ArrayBuffer.isView(t))return Array.from(t);if(Array.isArray(t)){for(let e=0;e<t.length;e++)t[e]=Ty(t[e]);return t}if(dn(t)){const e=Object.keys(t);for(const s of e)t[s]=Ty(t[s]);return t}return t}function xL(t){return eh?BU(t.toString()):OU(t)}function OU(t){return IR(gR(t))}function BU(t){if(eh)return new eh("data:application/javascript,"+t.replace(/\n/g,""))}var YS=Hi("@xmldom/xmldom");wy=typeof XMLSerializer<"u"?XMLSerializer:YS?YS.XMLSerializer:null;var UU=class vL{constructor(e){this._attributes={},this._children=[],this._name=e}setAttribute(e,s){this._attributes[e]=s}appendChild(e){this._children.push(e)}get tagName(){return this._name}get children(){return this._children}get childNodes(){return this._children}get firstChild(){return this._children[0]||null}serialize(){const e=this._name,s=this._attributes,n=this._children,i=Object.keys(s).filter((o=>s[o]!==void 0)).map((o=>` ${o}="${""+s[o]}"`)).join(""),r=n.map((o=>o.serialize())).join("");return r.length?`<${e}${i}>${r}</${e}>`:`<${e}${i}/>`}cloneNode(e){const s=new vL(this._name),n=Object.keys(this._attributes);for(const i of n)s.setAttribute(i,this._attributes[i]);if(e)for(let i=0;i<this._children.length;i++)s.appendChild(this._children[i].cloneNode(e));return s}},bL=class EL{constructor(e){this._text=e}serialize(){return this._text}cloneNode(){return new EL(this._text)}},GU=class{constructor(){this._children=[],this._meta=[],this._children=[],this._meta=[]}appendChild(t){this._children.push(t)}serialize(){return this._meta.concat(this._children.map((t=>t.serialize()))).join("")}createElement(t){return new UU(t)}createTextNode(t){return new bL(t)}},SL=()=>new GU;function d0(t){if(wy)return new wy().serializeToString(t)}var AL=()=>no().implementation.createDocument("","",null),Ah=class{constructor(t,e){this._graph=t,this._nodes={elementList:t.nodeList,flexArray:t.createNodeAttribute({storage:1,name:e},!!e),indexList:t.createIndexList(!0)},this._edges={elementList:t.edgeList,flexArray:t.createEdgeAttribute({storage:1,name:e},!!e),indexList:t.createIndexList(!1)}}_get(t){return t.isNode?this._nodes:this._edges}addOrRemoveElements(t,e){return e?this.addElements(t):this.removeElements(t)}addElements(t){const{elementList:e,flexArray:s,indexList:n}=this._get(t),i=n.getLength();for(let r=0;r<t._indexes.length;r++){const o=t._indexes[r];s.get(o)!==1&&(s.set(o,1),n.pushUnchecked(o))}return e(n.slice(i))}removeElements(t){const{elementList:e,flexArray:s,indexList:n}=this._get(t),i=n.getLength(),r=n.getBuffer();if(i>r.length)return this.clear(),this.addElements(t),t;let o=0;for(let a=0;a<t._indexes.length;a++){const l=t._indexes[a];s.get(l)!==0&&(s.set(l,0),o+=1)}if(o===i)return e(n.sliceAndReset());if(o===0)return e();{const a=this._graph.acquireIndexList(t.isNode);let l=0;for(let u=0;u<i;++u){const h=r[u];s.get(h)===0?(l+=1,a.pushUnchecked(h)):r[u-l]=h}return n.setLength(i-o),e(a.sliceAndReset())}}hasElement(t){return!!this._get(t).flexArray.get(t._index)}clear(){this._nodes.indexList.isEmpty()||(this._nodes.indexList.reset(),this._nodes.flexArray.reset()),this._edges.indexList.isEmpty()||(this._edges.indexList.reset(),this._edges.flexArray.reset())}isEmpty(){return this._nodes.indexList.isEmpty()&&this._edges.indexList.isEmpty()}getElements(){return{nodes:this._nodes.elementList(this._nodes.indexList.slice()),edges:this._edges.elementList(this._edges.indexList.slice())}}};function VU(t,e,s,n=0){e===void 0&&(e=s=Math.sqrt(t.length/4)),s===void 0&&(s=e);const i=document.createElement("canvas"),r=i.getContext("2d");if(r){const o=r.createImageData(e,s);i.style.imageRendering="pixelated",i.style.border="1px solid black",i.style.margin="2px",i.style.position="absolute",i.style.top=i.style.left="0px",i.width=e,i.height=s,o.data.set(t),r.putImageData(o,0,0);const a=document.getElementById("graph-container");a&&(a.style.position="static"),setTimeout((()=>document.body.appendChild(i)),n)}}var jU=class{constructor(t,e){this._attributesManager=t,this._id=e}getDefinition(){return this._attributesManager.getAttributeLayerDefinition(this._id)}update(t){this._attributesManager.updateAttributeLayer(this._id,t)}destroy(){this._attributesManager.destroyAttributeLayer(this._id)}updateElements(t){this._attributesManager.updateElementsForAttributeLayer(this._id,t)}updateAll(){this._attributesManager.updateAllForAttributeLayer(this._id)}setAttributeValues(t,e,s){this._attributesManager.setAttributeLayerValues(this._id,t,e,s)}getUsedAttributeNames(t){return this._attributesManager.getUsedAttributeLayerAttributes(this._id,t)}getFlexArrays(){return this._attributesManager.getAttributeLayerFlexArrays(this._id)}},h0={};hh(h0,{cubicIn:()=>YU,cubicInOut:()=>XU,cubicOut:()=>WU,linear:()=>mf,quadraticIn:()=>HU,quadraticInOut:()=>qU,quadraticOut:()=>$U});var mf=t=>t,HU=t=>t*t,$U=t=>t*(2-t),qU=t=>(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1),YU=t=>t*t*t,WU=t=>--t*t*t+1,XU=t=>(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2),ZU={name:"animationStart",storage:32,default:0},KU={name:"animationDuration",storage:16,default:0},QU={name:"animationEasing",storage:"resource",default:"linear"},JU={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentNodes:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:void 0,allEdges:void 0},t3={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},extremities:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},parallelEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:void 0,allEdges:void 0},e3={x:1,y:1,radius:1,"halo.hideNonAdjacentEdges":1};function Pd(t){return typeof t=="string"}var Cy=1,wL="scaled",TL="grey",CL=1,LL=0,NL=0,ML=!0,IL=0,kL=!0,RL="line",FL=null,PL=null,zL="plain",DL="inherit",Ly=0,OL="fixed",BL=0,UL=null,Ny=10,GL="fixed",VL=1e3,jL=800,HL="rgba(0, 0, 0, 0.6)",$L="rgba(0, 0, 0, 0)",qL=10,YL=1,WL=2,XL="rgba(0, 0, 0, 0.36)",ZL=0,s3=1,KL="normal",QL="center",JL=2,My=2,tN=Eh,eN=4,sN=!0,nN=4,Iy=2,ky=12,iN=2;function n3(t,e,s){let n,i,r,o;s==="line"?(n="line",i="plain",r=null,o=null):s==="arrow"?(n="line",i="plain",r="arrow",o=null):s==="tapered"?(n="triangle",i="plain",r=null,o=null):s==="dashed"?(n="line",i="dashed",r=null,o=null):s==="dotted"&&(n="line",i="dotted",r=null,o=null),t.shape.body.set(e,n),t.shape.style.set(e,i),t.shape.head.set(e,r),t.shape.tail.set(e,o)}var rN={width:{_flexArray:Cy,_check:Es(Cy)},scalingMethod:{_flexArray:wL,_check:Xr},color:{_flexArray:TL,_check:FB},opacity:{_flexArray:CL,_check:Vs},minVisibleSize:{_flexArray:LL,_check:Vs},layer:{_flexArray:NL,_check:NC},detectable:{_flexArray:ML,_check:In},curvature:{_flexArray:IL,_check:Pa},adjustAnchors:{_flexArray:kL,_check:In},shape:{_check:DB,_set:n3,type:"shape.head",body:{_flexArray:RL,_check:OB},head:{_flexArray:FL,_check:IS},tail:{_flexArray:PL,_check:IS},style:{_flexArray:zL,_check:BB}},stroke:{color:{_flexArray:DL,_check:Vn},width:{_flexArray:Ly,_check:Es(Ly)},scalingMethod:{_flexArray:OL,_check:Xr},minVisibleSize:{_flexArray:BL,_check:Vs}},strokeWidth:"stroke.width",halo:{_alias:"halo.color",color:{_flexArray:UL,_check:Oo},width:{_flexArray:Ny,_check:Es(Ny)},scalingMethod:{_flexArray:GL,_check:Xr},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:In},duration:{_flexArray:VL,_check:Vs},interval:{_flexArray:jL,_check:Vs},startColor:{_flexArray:HL,_check:Vn},endColor:{_flexArray:$L,_check:Vn},width:{_flexArray:qL,_check:Vs},startRatio:{_flexArray:YL,_check:Vs},endRatio:{_flexArray:WL,_check:Vs}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:In},color:{_flexArray:XL,_check:Oo},minVisibleSize:{_flexArray:ZL,_check:Vs}},text:{_alias:"text.content",content:{_flexArray:null,_check:Wr},font:{_flexArray:si,_check:Ql},color:{_flexArray:qo,_check:Oo},size:{_flexArray:uu,_check:Es(uu)},scale:{_flexArray:1,_check:Vs},style:{_flexArray:KL,_check:Jl},align:{_flexArray:QL,_check:gf},margin:{_flexArray:JL,_check:Pa},padding:{_flexArray:My,_check:Es(My)},backgroundColor:{_flexArray:ff,_check:Vn},minVisibleSize:{_flexArray:eN,_check:Vs},position:{_flexArray:tN,_check:RB},adjustAngle:{_flexArray:sN,_check:In},scaling:{_flexArray:$C,_check:In},maxLineLength:{_flexArray:qC,_check:Vs},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Wr},font:{_flexArray:si,_check:Ql},color:{_flexArray:qo,_check:Oo},size:{_flexArray:ky,_check:Es(ky)},scale:{_flexArray:GC,_check:Vs},style:{_flexArray:jC,_check:Jl},align:{_flexArray:HC,_check:gf},margin:{_flexArray:iN,_check:Pa},padding:{_flexArray:Iy,_check:Es(Iy)},backgroundColor:{_flexArray:VC,_check:Vn},minVisibleSize:{_flexArray:nN,_check:Vs}}}},i3=Es(hL),r3=Es(uu),o3=Es(r0),a3=Es(o0),l3=Es(a0),u3=Es(i0),WS=Es(Jd),d3=Es(dL),h3=Es(l0),c3=Es(u0);function ig(t){return{_check:Wr,_set:(e,s,n)=>{e.badges[t].text.content.set(s,n),n==null&&e.badges[t].image.url.set(s,n)},_get:(e,s)=>e.badges[t].text.content.get(s),color:{_flexArray:_d,_check:Vn},scale:{_flexArray:$S,_check:Es($S)},positionScale:{_flexArray:1,_check:Vs},minVisibleSize:{_flexArray:Wl,_check:Es(Wl)},scalingMethod:{_flexArray:"scaled",_check:Xr},image:{_alias:`badges.${t}.image.url`,url:{_flexArray:null,_check:Wr},scale:{_flexArray:th,_check:Es(th)}},stroke:{color:{_flexArray:yd,_check:Vn},width:{_flexArray:Xl,_check:Es(Xl)},scalingMethod:{_flexArray:"fixed",_check:Xr}},text:{_alias:`badges.${t}.text.content`,content:{_flexArray:null,_check:Wr},color:{_flexArray:xd,_check:Vn},font:{_flexArray:si,_check:Ql},style:{_flexArray:"normal",_check:Jl},scale:{_flexArray:Ay,_check:Es(Ay)},paddingLeft:{_flexArray:0,_check:Pa},paddingTop:{_flexArray:0,_check:Pa}}}}var oN={x:{_flexArray:0,_check:Pa,_disableMemoryOptimization:!0},y:{_flexArray:0,_check:Pa,_disableMemoryOptimization:!0},radius:{_flexArray:hL,_check:i3},scalingMethod:{_flexArray:"scaled",_check:Xr},color:{_flexArray:ZC,_check:GB},opacity:{_flexArray:1,_check:Vs},shape:{_flexArray:"circle",_check:PB},layer:{_flexArray:0,_check:NC},detectable:{_flexArray:!0,_check:In},draggable:{_flexArray:!0,_check:In},layoutable:{_flexArray:!0,_check:In},innerStroke:{_alias:"innerStroke.color",width:{_flexArray:o0,_check:a3},scalingMethod:{_flexArray:"fixed",_check:Xr},color:{_flexArray:KC,_check:Vn},minVisibleSize:{_flexArray:Sy,_check:Es(Sy)}},outerStroke:{_alias:"outerStroke.color",width:{_flexArray:a0,_check:l3},scalingMethod:{_flexArray:"fixed",_check:Xr},color:{_flexArray:QC,_check:Vn},minVisibleSize:{_flexArray:Ey,_check:Es(Ey)}},badges:{_check:IB,_set(t,e,s){t.badges.topLeft.text.content.set(e,s),t.badges.topLeft.image.url.set(e,s),t.badges.topRight.text.content.set(e,s),t.badges.topRight.image.url.set(e,s),t.badges.bottomLeft.text.content.set(e,s),t.badges.bottomLeft.image.url.set(e,s),t.badges.bottomRight.text.content.set(e,s),t.badges.bottomRight.image.url.set(e,s)},topLeft:ig("topLeft"),topRight:ig("topRight"),bottomLeft:ig("bottomLeft"),bottomRight:ig("bottomRight")},halo:{_alias:"halo.color",color:{_flexArray:tL,_check:Oo},width:{_flexArray:l0,_check:h3},scalingMethod:{_flexArray:"fixed",_check:Xr},strokeColor:{_flexArray:eL,_check:Oo},strokeWidth:{_flexArray:u0,_check:c3},clustering:{_flexArray:!1,_check:In},hideNonAdjacentEdges:{_flexArray:!1,_check:In}},pulse:{enabled:{_flexArray:!1,_check:In},duration:{_flexArray:nL,_check:Vs},interval:{_flexArray:iL,_check:Vs},startColor:{_flexArray:lL,_check:Vn},endColor:{_flexArray:aL,_check:Vn},width:{_flexArray:uL,_check:Vs},startRatio:{_flexArray:rL,_check:Vs},endRatio:{_flexArray:oL,_check:Vs}},icon:{_alias:"icon.content",content:{_flexArray:null,_check:Wr},font:{_flexArray:si,_check:Ql},color:{_flexArray:sL,_check:Oo},scale:{_flexArray:qS,_check:Es(qS)},style:{_flexArray:"normal",_check:Jl},minVisibleSize:{_flexArray:Tl,_check:Es(Tl)}},image:{_alias:"image.url",url:{_flexArray:null,_check:Wr},scale:{_flexArray:th,_check:Es(th)},fit:{_flexArray:!0,_check:In},tile:{_flexArray:!1,_check:In},minVisibleSize:{_flexArray:Tl,_check:Es(Tl)}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:In},color:{_flexArray:JC,_check:Oo},minVisibleSize:{_flexArray:Tl,_check:Es(Tl)}},text:{_alias:"text.content",content:{_flexArray:null,_check:Wr},font:{_flexArray:si,_check:Ql},color:{_flexArray:qo,_check:Vn},size:{_flexArray:uu,_check:r3},scale:{_flexArray:NU,_check:Vs},style:{_flexArray:"normal",_check:Jl},align:{_flexArray:"center",_check:gf},margin:{_flexArray:i0,_check:u3},padding:{_flexArray:Jd,_check:WS},backgroundColor:{_flexArray:null,_check:Vn},tip:{_flexArray:!0,_check:In},minVisibleSize:{_flexArray:ng,_check:Es(ng)},scaling:{_flexArray:!1,_check:In},position:{_flexArray:"bottom",_check:UB},maxLineLength:{_flexArray:0,_check:Vs},truncateLength:{_flexArray:0,_check:Vs},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Wr},font:{_flexArray:si,_check:Ql},color:{_flexArray:qo,_check:Vn},size:{_flexArray:r0,_check:o3},scale:{_flexArray:.08,_check:Vs},style:{_flexArray:"normal",_check:Jl},align:{_flexArray:"center",_check:gf},margin:{_flexArray:dL,_check:d3},padding:{_flexArray:Jd,_check:WS},backgroundColor:{_flexArray:null,_check:Vn},minVisibleSize:{_flexArray:ng,_check:Es(ng)}}}},g3=t=>(e,s)=>e[t].get(s),f3=(t,e)=>(s,n)=>s[t][e].get(n),m3=(t,e,s)=>(n,i)=>n[t][e][s].get(i),p3=(t,e,s,n)=>(i,r)=>i[t][e][s][n].get(r),_3=t=>(e,s,n)=>e[t].set(s,n),y3=(t,e)=>(s,n,i)=>s[t][e].set(n,i),x3=(t,e,s)=>(n,i,r)=>n[t][e][s].set(i,r),v3=(t,e,s,n)=>(i,r,o)=>i[t][e][s][n].set(r,o),b3=[g3,f3,m3,p3],E3=[_3,y3,x3,v3];function XS(t,e){if(!t._check)throw new Error(`error somewhere for ${e}`);const s=e.split("."),n=s.length-1,i=b3[n].apply(null,s),r=E3[n].apply(null,s);return{check:t._check,set:r,get:i,nested:{}}}function pf(t,e){const s=e?oN:rN,n=typeof t=="string"?[t]:Ba(t,"",[]);let i=!1;const r=[];for(let o=0;o<n.length;o++){const a=n[o].split(".");let l=s[a[0]];for(let h=1;h<a.length;h++)l=l[a[h]];l.type&&(n[o]=l.type),l._alias&&(n[o]=l._alias),n[o]==="badges"&&(n[o]="badges.topLeft.text.content",i=!0);const u=a[a.length-1];u!=="topLeft"&&u!=="topRight"&&u!=="bottomLeft"&&u!=="bottomRight"||(n[o]=`badges.${u}.text.content`,r.push(`badges.${u}.image.url`)),n[o]==="strokeWidth"&&(n[o]="stroke.width")}return i&&(n.push("badges.topLeft.image.url"),n.push("badges.topRight.text.content"),n.push("badges.topRight.image.url"),n.push("badges.bottomLeft.text.content"),n.push("badges.bottomLeft.image.url"),n.push("badges.bottomRight.text.content"),n.push("badges.bottomRight.image.url")),n.push(...r),n}var rg=t=>(e,s)=>({url:e.badges[t].image.url.get(s),scale:e.badges[t].image.scale.get(s)}),og=t=>(e,s)=>({color:e.badges[t].stroke.color.get(s),width:e.badges[t].stroke.width.get(s),scalingMethod:e.badges[t].stroke.scalingMethod.get(s)}),ag=t=>(e,s)=>({content:e.badges[t].text.content.get(s),color:e.badges[t].text.color.get(s),font:e.badges[t].text.font.get(s),style:e.badges[t].text.style.get(s),scale:e.badges[t].text.scale.get(s),paddingLeft:e.badges[t].text.paddingLeft.get(s),paddingTop:e.badges[t].text.paddingTop.get(s)}),lg=t=>(e,s)=>({color:e.badges[t].color.get(s),scale:e.badges[t].scale.get(s),positionScale:e.badges[t].positionScale.get(s),minVisibleSize:e.badges[t].minVisibleSize.get(s),image:{url:e.badges[t].image.url.get(s),scale:e.badges[t].image.scale.get(s)},stroke:{color:e.badges[t].stroke.color.get(s),width:e.badges[t].stroke.width.get(s),scalingMethod:e.badges[t].stroke.scalingMethod.get(s)},text:{content:e.badges[t].text.content.get(s),color:e.badges[t].text.color.get(s),font:e.badges[t].text.font.get(s),style:e.badges[t].text.style.get(s),scale:e.badges[t].text.scale.get(s),paddingLeft:e.badges[t].text.paddingLeft.get(s),paddingTop:e.badges[t].text.paddingTop.get(s)}}),Io={topLeft:lg("topLeft"),topRight:lg("topRight"),bottomLeft:lg("bottomLeft"),bottomRight:lg("bottomRight")},ir={stroke:(t,e)=>({color:t.stroke.color.get(e),width:t.stroke.width.get(e),scalingMethod:t.stroke.scalingMethod.get(e),minVisibleSize:t.stroke.minVisibleSize.get(e)}),innerStroke:(t,e)=>({width:t.innerStroke.width.get(e),scalingMethod:t.innerStroke.scalingMethod.get(e),color:t.innerStroke.color.get(e),minVisibleSize:t.innerStroke.minVisibleSize.get(e)}),outerStroke:(t,e)=>({width:t.outerStroke.width.get(e),scalingMethod:t.outerStroke.scalingMethod.get(e),color:t.outerStroke.color.get(e),minVisibleSize:t.outerStroke.minVisibleSize.get(e)}),pulse:(t,e)=>({enabled:t.pulse.enabled.get(e),duration:t.pulse.duration.get(e),interval:t.pulse.interval.get(e),startColor:t.pulse.startColor.get(e),endColor:t.pulse.endColor.get(e),width:t.pulse.width.get(e),startRatio:t.pulse.startRatio.get(e),endRatio:t.pulse.endRatio.get(e)}),outline:(t,e)=>({enabled:t.outline.enabled.get(e),color:t.outline.color.get(e),minVisibleSize:t.outline.minVisibleSize.get(e)}),halo:(t,e)=>({color:t.halo.color.get(e),width:t.halo.width.get(e),scalingMethod:t.halo.scalingMethod.get(e),strokeColor:t.halo.strokeColor.get(e),strokeWidth:t.halo.strokeWidth.get(e),clustering:t.halo.clustering.get(e),hideNonAdjacentEdges:t.halo.hideNonAdjacentEdges.get(e)}),"text.secondary":(t,e)=>({content:t.text.secondary.content.get(e),font:t.text.secondary.font.get(e),color:t.text.secondary.color.get(e),size:t.text.secondary.size.get(e),scale:t.text.secondary.scale.get(e),style:t.text.secondary.style.get(e),align:t.text.secondary.align.get(e),margin:t.text.secondary.margin.get(e),padding:t.text.secondary.padding.get(e),backgroundColor:t.text.secondary.backgroundColor.get(e),minVisibleSize:t.text.secondary.minVisibleSize.get(e)}),text:(t,e)=>({content:t.text.content.get(e),font:t.text.font.get(e),color:t.text.color.get(e),size:t.text.size.get(e),scale:t.text.scale.get(e),style:t.text.style.get(e),align:t.text.align.get(e),margin:t.text.margin.get(e),padding:t.text.padding.get(e),backgroundColor:t.text.backgroundColor.get(e),tip:t.text.tip.get(e),minVisibleSize:t.text.minVisibleSize.get(e),scaling:t.text.scaling.get(e),position:t.text.position.get(e),maxLineLength:t.text.maxLineLength.get(e),truncateLength:t.text.truncateLength.get(e),secondary:ir["text.secondary"](t,e)}),image:(t,e)=>({url:t.image.url.get(e),scale:t.image.scale.get(e),fit:t.image.fit.get(e),tile:t.image.tile.get(e),minVisibleSize:t.image.minVisibleSize.get(e)}),icon:(t,e)=>({content:t.icon.content.get(e),font:t.icon.font.get(e),color:t.icon.color.get(e),scale:t.icon.scale.get(e),style:t.icon.style.get(e),minVisibleSize:t.icon.minVisibleSize.get(e)}),badges:(t,e)=>({topLeft:Io.topLeft(t,e),topRight:Io.topRight(t,e),bottomLeft:Io.bottomLeft(t,e),bottomRight:Io.bottomRight(t,e)}),"badges.topLeft":Io.topLeft,"badges.topRight":Io.topRight,"badges.bottomLeft":Io.bottomLeft,"badges.bottomRight":Io.bottomRight,"badges.topLeft.image":rg("topLeft"),"badges.topLeft.stroke":og("topLeft"),"badges.topLeft.text":ag("topLeft"),"badges.topRight.image":rg("topRight"),"badges.topRight.stroke":og("topRight"),"badges.topRight.text":ag("topRight"),"badges.bottomLeft.image":rg("bottomLeft"),"badges.bottomLeft.stroke":og("bottomLeft"),"badges.bottomLeft.text":ag("bottomLeft"),"badges.bottomRight.image":rg("bottomRight"),"badges.bottomRight.stroke":og("bottomRight"),"badges.bottomRight.text":ag("bottomRight"),all:(t,e)=>({x:t.x.get(e),y:t.y.get(e),radius:t.radius.get(e),scalingMethod:t.scalingMethod.get(e),color:t.color.get(e),opacity:t.opacity.get(e),shape:t.shape.get(e),layer:t.layer.get(e),detectable:t.detectable.get(e),draggable:t.draggable.get(e),layoutable:t.layoutable.get(e),innerStroke:ir.innerStroke(t,e),outerStroke:ir.outerStroke(t,e),badges:ir.badges(t,e),halo:ir.halo(t,e),pulse:ir.pulse(t,e),icon:ir.icon(t,e),image:ir.image(t,e),outline:ir.outline(t,e),text:ir.text(t,e)})},Fo={shape:(t,e)=>({body:t.shape.body.get(e),head:t.shape.head.get(e),tail:t.shape.tail.get(e),style:t.shape.style.get(e)}),"text.secondary":(t,e)=>({content:t.text.secondary.content.get(e),font:t.text.secondary.font.get(e),color:t.text.secondary.color.get(e),size:t.text.secondary.size.get(e),scale:t.text.secondary.scale.get(e),style:t.text.secondary.style.get(e),align:t.text.secondary.align.get(e),margin:t.text.secondary.margin.get(e),padding:t.text.secondary.padding.get(e),backgroundColor:t.text.secondary.backgroundColor.get(e),minVisibleSize:t.text.secondary.minVisibleSize.get(e)}),text:(t,e)=>({content:t.text.content.get(e),font:t.text.font.get(e),color:t.text.color.get(e),size:t.text.size.get(e),scale:t.text.scale.get(e),style:t.text.style.get(e),align:t.text.align.get(e),margin:t.text.margin.get(e),padding:t.text.padding.get(e),position:t.text.position.get(e),backgroundColor:t.text.backgroundColor.get(e),minVisibleSize:t.text.minVisibleSize.get(e),adjustAngle:t.text.adjustAngle.get(e),scaling:t.text.scaling.get(e),maxLineLength:t.text.maxLineLength.get(e),secondary:Fo["text.secondary"](t,e)}),outline:(t,e)=>({enabled:t.outline.enabled.get(e),color:t.outline.color.get(e),minVisibleSize:t.outline.minVisibleSize.get(e)}),pulse:(t,e)=>({enabled:t.pulse.enabled.get(e),duration:t.pulse.duration.get(e),interval:t.pulse.interval.get(e),startColor:t.pulse.startColor.get(e),endColor:t.pulse.endColor.get(e),width:t.pulse.width.get(e),startRatio:t.pulse.startRatio.get(e),endRatio:t.pulse.endRatio.get(e)}),stroke:(t,e)=>({color:t.stroke.color.get(e),width:t.stroke.width.get(e),scalingMethod:t.stroke.scalingMethod.get(e),minVisibleSize:t.stroke.minVisibleSize.get(e)}),halo:(t,e)=>({color:t.halo.color.get(e),width:t.halo.width.get(e),scalingMethod:t.halo.scalingMethod.get(e)}),all:(t,e)=>({width:t.width.get(e),scalingMethod:t.scalingMethod.get(e),color:t.color.get(e),opacity:t.opacity.get(e),minVisibleSize:t.minVisibleSize.get(e),layer:t.layer.get(e),detectable:t.detectable.get(e),curvature:t.curvature.get(e),adjustAnchors:t.adjustAnchors.get(e),shape:Fo.shape(t,e),stroke:Fo.stroke(t,e),halo:Fo.halo(t,e),pulse:Fo.pulse(t,e),outline:Fo.outline(t,e),text:Fo.text(t,e)})};function c0(t,e,s,n=!0){if((e=e||t)._flexArray!==void 0)return XS(e,s);let i={check:lr,get:os,set:os,nested:{}};if(Pd(e)||e._alias){const r=Pd(e)?e:e._alias;i=XS(qs(t,r),r)}else{if(e._set?(i.set=e._set,i.check=e._check):(i.set=os,i.check=os),e._get)i.get=e._get;else{const r=n?ir:Fo;i.get=r[s||"all"]}i.nested={}}if(!Pd(e)){const r=Object.keys(e);for(const o of r){const a=e[o];o.startsWith("_")||(i.nested[o]=c0(t,a,s?s+"."+o:o,n))}}return i}var S3=c0(oN,void 0,void 0,!0),A3=c0(rN,void 0,void 0,!1),w3=[];function ZS(t){let e=w3;return t.output===void 0?(typeof t.attributes=="function"&&(e="all"),dn(t.attributes)&&(e=Ba(t.attributes))):t.output&&(e=t.output.attributes),g0(e,t.allAttributePaths)}function T3(t,e,s,n){if(n>s){for(const i of e.attributes)for(const r of t.attributes)if(r===i)return!0}for(const i of e.tags)for(const r of t.tags)if(i===r)return!0;return!1}function vr(t,e,s,n,i,r){T3(s,n,i,r)&&t.push(e)}function C3(t){let e=t.dependencies;e===void 0?e=JU:dn(e)||(e={});const s=Lf(t.attributes).some((o=>typeof o=="function")),n=t.selector&&!t.standaloneSelector,i=!(!s&&!n);let r=e.adjacentEdges;return!r&&e.adjacentNodes&&(r=!0),{self:Tr(e.self,i,t.allAttributePaths),adjacentNodes:Tr(e.adjacentNodes,i,t.allAttributePaths),adjacentEdges:Tr(r,i,t.allAttributePaths),allNodes:Tr(e.allNodes,i,t.allAttributePaths),allEdges:Tr(e.allEdges,i,t.allAttributePaths)}}function L3(t){let e=t.dependencies;e===void 0?e=t3:dn(e)||(e={});const s=Lf(t.attributes).some((r=>typeof r=="function")),n=t.selector&&!t.standaloneSelector,i=!(!s&&!n);return{self:Tr(e.self,i,t.allAttributePaths),extremities:Tr(e.extremities,i,t.allAttributePaths),parallelEdges:Tr(e.parallelEdges,i,t.allAttributePaths),allNodes:Tr(e.allNodes,i,t.allAttributePaths),allEdges:Tr(e.allEdges,i,t.allAttributePaths)}}function Tr(t,e,s){if(!e)return{attributes:[],tags:[]};if(t===!0)return{attributes:[],tags:[ey]};const n={attributes:g0((t=t||{}).attributes,s),tags:I3(t.tags)};return t.data&&n.tags.push(sy),t.selection&&n.tags.push(Gs),t.hover&&n.tags.push(Nd),n}function N3(t){return Array.isArray(t)?t.join("."):t}function M3(t){return t.map(N3).filter(Pd)}function g0(t,e){if(t==="all")return e.slice();if(!Array.isArray(t))return[];const s=M3(t);return e?e.filter((n=>s.some((i=>n.startsWith(i))))):s}function I3(t){return Array.isArray(t)?t.filter(Pd):[]}var KS={storage:1,default:0},_f=class{constructor({graph:t,isNode:e,includeRemovedElements:s}){this._all=!1,this._isNode=e,this._graph=t,this._includeRemovedElements=s,this._eltList=e?this._graph.nodeList:this._graph.edgeList,this._flexArray=e?t.createNodeAttribute(KS,!1):t.createEdgeAttribute(KS,!1),this._all=!1,this._indexList=t.createIndexList(e)}_getAllIndexes(){const t=this._isNode?this._graph.getNodeMaxIndex():this._graph.getEdgeMaxIndex(),e=new Uint32Array(t);for(let s=1;s<=t;++s)e[s-1]=s;return e}addAll(){this._all=!0}add(t){if(!this._all)for(let e=0;e<t._indexes.length;e++){const s=t._indexes[e];this.addIndex(s)}}addIndex(t){this._flexArray.get(t)===0&&(this._flexArray.set(t,1),this._indexList.push(t))}isEmpty(){return!this._all&&this._indexList.isEmpty()}isFull(){return this._all}getListAndClear(){const t=this.getList();return this.clear(),t}getList(){let t;if(this._all&&!this._includeRemovedElements)t=this._isNode?this._graph.getNodes("all"):this._graph.getEdges("all");else{const e=this._all?this._getAllIndexes():this._indexList.slice();t=this._eltList(e)}return t}clear(){this._all=!1,this._indexList.isEmpty()||(this._indexList.reset(),this._flexArray.reset())}addSet(t){if(t._all)this.addAll();else{const e=t._indexList.getBuffer(),s=t._indexList.getLength();for(let n=0;n<s;++n)this.addIndex(e[n])}}};function aN(t,e=[],s=""){return t.constructor===af?t.isInitialized()&&e.push(s):t.constructor===Object&&Object.keys(t).forEach((n=>{aN(t[n],e,s?s+"."+n:n)})),e}var QS=class{constructor(t,e,s){this._updatedAttributes=new Set,this._updatedAttributesTmp=new Set,this._allUsedAttributes=new Set,this._graph=t,this._eltName=e?"node":"edge",this._accessors=e?S3:A3,this._createFlexArrays=s;const n=this._createFlexArrays(t,{original:!0,useDefaultValues:!0});this._finalFlexArrays=n;const i=this._createFlexArrays(t,{original:!1,useDefaultValues:!0});this._prevFlexArrays=i;const r=this._createFlexArrays(t,{original:!1,useDefaultValues:!0});this._defaultFlexArrays=r,this._currentFlexArrays=this._defaultFlexArrays,this.setLastFlexArrays(this._defaultFlexArrays),this._elementsToRedraw=new _f({graph:t,isNode:e,includeRemovedElements:!0}),this._elementsUpdated=new _f({graph:t,isNode:e,includeRemovedElements:!1}),this._finalFlexArraysWrapped={...this._finalFlexArrays,excluded:t.getAttribute(e,"excluded"),textHidden:t.getAttribute(e,"textHidden"),animationStart:t.createAttribute(e,ZU),animationDuration:t.createAttribute(e,KU),animationEasing:t.createAttribute(e,QU),id:this._graph.getAttribute(e,"id"),...!e&&{source:t.getEdgeAttribute("source"),target:t.getEdgeAttribute("target")}}}clear(){this._elementsToRedraw.clear(),this._elementsUpdated.clear(),this._updatedAttributes.clear(),this._updatedAttributesTmp.clear()}getAttributeFlexArrays(){return this._finalFlexArraysWrapped}getPrevAttributeFlexArrays(){return this._prevFlexArrays}getAnimationInformation(t){const e=t._indexes,s=Array(e.length),n=this._finalFlexArraysWrapped;for(let i=0;i<e.length;i++){const r=e[i];s[i]={duration:n.animationDuration.get(r),start:n.animationStart.get(r),easing:n.animationEasing.get(r)}}return s}setDefaultAttributes(t){Ba(t).forEach((e=>{const s=qs(this._currentFlexArrays,e),n=qs(this._prevFlexArrays,e),i=qs(this._defaultFlexArrays,e),r=qs(this._finalFlexArrays,e);if(!s)return;const o=qs(t,e);s.setDefaultValue(o),i.setDefaultValue(o),n.setDefaultValue(o),r.setDefaultValue(o)})),this.redrawAll()}startUpdate(){}prepareFlexArraysUpdate(t){this._currentFlexArrays=t.inputFlexArrays}setLastFlexArrays(t){this._lastFlexArrays=t}updateFlexArrays(t){const{attributes:e,selector:s,context:n,outputFlexArrays:i,toUpdate:r,formattedOutput:o}=t;this._elementsUpdated.addSet(r),this._elementsToRedraw.addSet(r);const a=r.getListAndClear();if(e&&a.size){const{valid:l,invalid:u}=iT(this._graph,a,s,n);for(const h of o.attributes){const g=qs(i,h);for(let f=0;f<u._indexes.length;f++){const m=u._indexes[f];g.set(m,void 0)}}this._assignAttributesToFlexArrays(this._accessors,i,l,e,n),this._addUpdatedAttributes(t)}}endUpdate(){const t=this._elementsUpdated.getList(),e=vd(this._updatedAttributesTmp);for(const s of e){const n=qs(this._lastFlexArrays,s),i=qs(this._finalFlexArrays,s);for(let r=0;r<t._indexes.length;r++){const o=t._indexes[r];i.set(o,n.get(o))}}this._updatedAttributesTmp.clear(),this._currentFlexArrays=this._finalFlexArrays}setAttributeValues(t,e,s,n,i){const r=t.outputFlexArrays,o=this._accessors;this._assignAttributesToFlexArrays(o,r,e,s,null),this._addUpdatedAttributes(t,n),this._elementsUpdated.add(e),this._elementsToRedraw.add(e)}notifyLayerDestroyed(t){this._addUpdatedAttributes(t)}_addUpdatedAttributes(t,e){const{outputFlexArrays:s,formattedOutput:n}=t,i=Array.isArray(e)?g0(e):n.attributes;for(const r of i)qs(s,r).isInitialized()&&(this._updatedAttributes.add(r),this._updatedAttributesTmp.add(r),this._allUsedAttributes.add(r))}addUpdatedAttribute(t){this._updatedAttributes.add(t),this._updatedAttributesTmp.add(t),this._allUsedAttributes.add(t)}getUsedAttributeNames(t){return aN(t.outputFlexArrays)}redrawElements(t){this._elementsToRedraw.add(t)}redrawAll(){this._elementsToRedraw.addAll()}getAndResetElementsToRedraw(){return this._elementsToRedraw.getListAndClear()}getAndResetElementsUpdated(){return this._elementsUpdated.getListAndClear()}getAndResetAttributesUpdated(){const t=vd(this._updatedAttributes);return this._updatedAttributes.clear(),t}getUpdatedAttributes(){return this._updatedAttributes}getUpdatedElementsList(){return this._elementsUpdated.getList()}getUpdatedAttributesSet(){return new Set(this._updatedAttributes)}createFlexArrays(){return this._createFlexArrays(this._graph,{original:!1,useDefaultValues:!1})}getAttributeValues(t,e,s,n){const i=n?this._prevFlexArrays:this._currentFlexArrays;return s?this._getMultipleAttributeValues(t,e,i):this._getSingleAttributeValues(t,e,i)}_getAccessor(t=""){let e=this._accessors;const s=Da(t);for(const n of s)if(e=e.nested[n],!e)throw new Error(`${this._eltName} attribute "${s.join("")}" does not exist`);return e}_getSingleAttributeValues(t,e,s){const n=this._getAccessor(e),i=t._indexes,r=Array(i.length);for(let o=0;o<i.length;o++)r[o]=n.get(s,i[o]);return r}_getMultipleAttributeValues(t,e,s){if(!e||e==="all")return this._getSingleAttributeValues(t,"",s);const n=Array(t.size);for(let i=0;i<n.length;++i)n[i]={};for(let i=0;i<e.length;i++){const r=e[i],o=this._getSingleAttributeValues(t,r,s);for(let a=0;a<n.length;++a)Kr(n[a],r,o[a])}return n}setAnimationAttributes(t,{duration:e,startTime:s,easing:n}){const i=t._indexes,r=this._finalFlexArraysWrapped,o=r.animationDuration,a=r.animationStart,l=r.animationEasing,u=vd(this._allUsedAttributes);if(e){let h=!1;for(const g of u){if(g==="x"||g==="y"){h=!0;continue}const f=qs(this._finalFlexArrays,g),m=qs(this._prevFlexArrays,g);for(let y=0;y<i.length;y++){const p=i[y];m.set(p,f.get(p))}}if(h){const g=$n(),f=this._finalFlexArrays.x,m=this._finalFlexArrays.y,y=this._prevFlexArrays.x,p=this._prevFlexArrays.y;for(let x=0;x<i.length;x++){const v=i[x],b=o.get(v);if(b){const S=a.get(v),A=l.get(v),w=(h0[A]||mf)(Math.min((g-S)/b,1)),L=X_(y.get(v),f.get(v),w),k=X_(p.get(v),m.get(v),w);y.set(v,L),p.set(v,k)}else y.set(v,f.get(v)),p.set(v,m.get(v))}}}o.fill(i,e),a.fill(i,s),l.fill(i,n)}resetAnimationAttributes(t){this._finalFlexArraysWrapped.animationDuration.fill(t._indexes,0)}getUsedAttributes(){return vd(this._allUsedAttributes)}getDefaultFlexArrays(){return this._defaultFlexArrays}_assignAttributesToFlexArrays(t,e,s,n,i,r=[]){if(typeof n=="function"){const o=r.join(".");for(let a=0;a<s.size;++a){const l=s.get(a);if(l){const u=n(l,i,o);this._assignSingleValueToFlexArray(e,l,t,u,r)}}}else if(dn(n)){const o=Object.keys(n);for(let a=0;a<o.length;++a){const l=o[a];r.push(l);const u=this._getNestedAccessor(t,l,r),h=n[l];this._assignAttributesToFlexArrays(u,e,s,h,i,r),r.pop()}}else if((Array.isArray(n)||ArrayBuffer.isView(n))&&r[0]!=="color")if(r.length===0)for(let o=0;o<s.size;++o)this._assignSingleValueToFlexArray(e,s.get(o),t,n[o],r);else for(let o=0;o<s.size;++o){const a=s._indexes[o],l=t.check(n[o]);t.set(e,a,l)}else{const o=t.check(n);for(let a=0;a<s.size;++a){const l=s.get(a);t.set(e,l._index,o)}}}_getNestedAccessor(t,e,s){const n=t.nested[e];if(!n)throw new Error(`${this._eltName} attribute "${s.join(".")}" does not exist`);return n}_assignSingleValueToFlexArray(t,e,s,n,i){if(dn(n)){const r=Object.keys(n);for(const o of r){i.push(o);const a=n[o],l=this._getNestedAccessor(s,o,i);this._assignSingleValueToFlexArray(t,e,l,a,i),i.pop()}}else{const r=s.check(n);s.set(t,e._index,r)}}};function k3(t,{original:e,useDefaultValues:s}){const n="resource";return{width:t.createAttribute(!1,{storage:n,default:s?Cy:void 0,name:"width"},e),scalingMethod:t.createAttribute(!1,{storage:n,default:s?wL:void 0,name:"scalingMethod"},e),color:t.createAttribute(!1,{storage:n,default:s?TL:void 0,name:"color"},e),opacity:t.createAttribute(!1,{storage:n,default:s?CL:void 0,name:"opacity"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?LL:void 0,name:"minVisibleSize"},e),layer:t.createAttribute(!1,{storage:n,default:s?NL:void 0,name:"layer"},e),detectable:t.createAttribute(!1,{storage:n,default:s?ML:void 0,name:"detectable"},e),curvature:t.createAttribute(!1,{storage:n,default:s?IL:void 0,name:"curvature"},e),adjustAnchors:t.createAttribute(!1,{storage:n,default:s?kL:void 0,name:"adjustAnchors"},e),shape:{body:t.createAttribute(!1,{storage:n,default:s?RL:void 0,name:"shape.body"},e),head:t.createAttribute(!1,{storage:n,default:s?FL:void 0,name:"shape.head"},e),tail:t.createAttribute(!1,{storage:n,default:s?PL:void 0,name:"shape.tail"},e),style:t.createAttribute(!1,{storage:n,default:s?zL:void 0,name:"shape.style"},e)},stroke:{color:t.createAttribute(!1,{storage:n,default:s?DL:void 0,name:"stroke.color"},e),width:t.createAttribute(!1,{storage:n,default:s?Ly:void 0,name:"stroke.width"},e),scalingMethod:t.createAttribute(!1,{storage:n,default:s?OL:void 0,name:"stroke.scalingMethod"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?BL:void 0,name:"stroke.minVisibleSize"},e)},halo:{color:t.createAttribute(!1,{storage:n,default:s?UL:void 0,name:"halo.color"},e),width:t.createAttribute(!1,{storage:n,default:s?Ny:void 0,name:"halo.width"},e),scalingMethod:t.createAttribute(!1,{storage:n,default:s?GL:void 0,name:"halo.scalingMethod"},e)},pulse:{enabled:t.createAttribute(!1,{storage:n,default:!s&&void 0,name:"pulse.enabled"},e),duration:t.createAttribute(!1,{storage:n,default:s?VL:void 0,name:"pulse.duration"},e),interval:t.createAttribute(!1,{storage:n,default:s?jL:void 0,name:"pulse.interval"},e),startColor:t.createAttribute(!1,{storage:n,default:s?HL:void 0,name:"pulse.startColor"},e),endColor:t.createAttribute(!1,{storage:n,default:s?$L:void 0,name:"pulse.endColor"},e),width:t.createAttribute(!1,{storage:n,default:s?qL:void 0,name:"pulse.width"},e),startRatio:t.createAttribute(!1,{storage:n,default:s?YL:void 0,name:"pulse.startRatio"},e),endRatio:t.createAttribute(!1,{storage:n,default:s?WL:void 0,name:"pulse.endRatio"},e)},outline:{enabled:t.createAttribute(!1,{storage:n,default:!s&&void 0,name:"outline.enabled"},e),color:t.createAttribute(!1,{storage:n,default:s?XL:void 0,name:"outline.color"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?ZL:void 0,name:"outline.minVisibleSize"},e)},text:{content:t.createAttribute(!1,{storage:n,default:s?null:void 0,name:"text.content"},e),font:t.createAttribute(!1,{storage:n,default:s?si:void 0,name:"text.font"},e),color:t.createAttribute(!1,{storage:n,default:s?qo:void 0,name:"text.color"},e),size:t.createAttribute(!1,{storage:n,default:s?uu:void 0,name:"text.size"},e),scale:t.createAttribute(!1,{storage:n,default:s?s3:void 0,name:"text.scale"},e),style:t.createAttribute(!1,{storage:n,default:s?KL:void 0,name:"text.style"},e),align:t.createAttribute(!1,{storage:n,default:s?QL:void 0,name:"text.align"},e),margin:t.createAttribute(!1,{storage:n,default:s?JL:void 0,name:"text.margin"},e),padding:t.createAttribute(!1,{storage:n,default:s?My:void 0,name:"text.padding"},e),position:t.createAttribute(!1,{storage:n,default:s?tN:void 0,name:"text.position"},e),backgroundColor:t.createAttribute(!1,{storage:n,default:s?ff:void 0,name:"text.backgroundColor"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?eN:void 0,name:"text.minVisibleSize"},e),adjustAngle:t.createAttribute(!1,{storage:n,default:s?sN:void 0,name:"text.adjustAngle"},e),scaling:t.createAttribute(!1,{storage:n,default:s?$C:void 0,name:"text.scaling"},e),maxLineLength:t.createAttribute(!1,{storage:n,default:s?qC:void 0,name:"text.maxLineLength"},e),secondary:{content:t.createAttribute(!1,{storage:n,default:s?null:void 0,name:"text.secondary.content"},e),font:t.createAttribute(!1,{storage:n,default:s?si:void 0,name:"text.secondary.font"},e),color:t.createAttribute(!1,{storage:n,default:s?qo:void 0,name:"text.secondary.color"},e),size:t.createAttribute(!1,{storage:n,default:s?ky:void 0,name:"text.secondary.size"},e),scale:t.createAttribute(!1,{storage:n,default:s?GC:void 0,name:"text.secondary.scale"},e),style:t.createAttribute(!1,{storage:n,default:s?jC:void 0,name:"text.secondary.style"},e),align:t.createAttribute(!1,{storage:n,default:s?HC:void 0,name:"text.secondary.align"},e),margin:t.createAttribute(!1,{storage:n,default:s?iN:void 0,name:"text.secondary.margin"},e),padding:t.createAttribute(!1,{storage:n,default:s?Iy:void 0,name:"text.secondary.padding"},e),backgroundColor:t.createAttribute(!1,{storage:n,default:s?VC:void 0,name:"text.secondary.backgroundColor"},e),minVisibleSize:t.createAttribute(!1,{storage:n,default:s?nN:void 0,name:"text.secondary.minVisibleSize"},e)}}}}function R3(t,{original:e,useDefaultValues:s}){const n="resource";return{x:t.createAttribute(!0,{storage:"any",default:s?0:void 0,name:"x"},e),y:t.createAttribute(!0,{storage:"any",default:s?0:void 0,name:"y"},e),radius:t.createAttribute(!0,{storage:n,default:s?5:void 0,name:"radius"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"scalingMethod"},e),color:t.createAttribute(!0,{storage:n,default:s?ZC:void 0,name:"color"},e),opacity:t.createAttribute(!0,{storage:n,default:s?CU:void 0,name:"opacity"},e),shape:t.createAttribute(!0,{storage:n,default:s?LU:void 0,name:"shape"},e),layer:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"layer"},e),detectable:t.createAttribute(!0,{storage:n,default:!!s||void 0,name:"detectable"},e),draggable:t.createAttribute(!0,{storage:n,default:!!s||void 0,name:"draggable"},e),layoutable:t.createAttribute(!0,{storage:n,default:!!s||void 0,name:"layoutable"},e),innerStroke:{width:t.createAttribute(!0,{storage:n,default:s?o0:void 0,name:"innerStroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"innerStroke.scalingMethod"},e),color:t.createAttribute(!0,{storage:n,default:s?KC:void 0,name:"innerStroke.color"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?Sy:void 0,name:"innerStroke.minVisibleSize"},e)},outerStroke:{width:t.createAttribute(!0,{storage:n,default:s?a0:void 0,name:"outerStroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"outerStroke.scalingMethod"},e),color:t.createAttribute(!0,{storage:n,default:s?QC:void 0,name:"outerStroke.color"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?Ey:void 0,name:"outerStroke.minVisibleSize"},e)},badges:{topLeft:{color:t.createAttribute(!0,{storage:n,default:s?_d:void 0,name:"badges.topLeft.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.45:void 0,name:"badges.topLeft.scale"},e),positionScale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.topLeft.positionScale"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?Wl:void 0,name:"badges.topLeft.minVisibleSize"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"badges.topLeft.scalingMethod"},e),image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.topLeft.image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.topLeft.image.scale"},e)},stroke:{color:t.createAttribute(!0,{storage:n,default:s?yd:void 0,name:"badges.topLeft.stroke.color"},e),width:t.createAttribute(!0,{storage:n,default:s?Xl:void 0,name:"badges.topLeft.stroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"badges.topLeft.stroke.scalingMethod"},e)},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.topLeft.text.content"},e),color:t.createAttribute(!0,{storage:n,default:s?xd:void 0,name:"badges.topLeft.text.color"},e),font:t.createAttribute(!0,{storage:n,default:s?si:void 0,name:"badges.topLeft.text.font"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"badges.topLeft.text.style"},e),scale:t.createAttribute(!0,{storage:n,default:s?.5:void 0,name:"badges.topLeft.text.scale"},e),paddingLeft:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.topLeft.text.paddging.left"},e),paddingTop:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.topLeft.text.paddging.top"},e)}},topRight:{color:t.createAttribute(!0,{storage:n,default:s?_d:void 0,name:"badges.topRight.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.45:void 0,name:"badges.topRight.scale"},e),positionScale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.topRight.positionScale"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?Wl:void 0,name:"badges.topRight.minVisibleSize"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"badges.topRight.scalingMethod"},e),image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.topRight.image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.topRight.image.scale"},e)},stroke:{color:t.createAttribute(!0,{storage:n,default:s?yd:void 0,name:"badges.topRight.stroke.color"},e),width:t.createAttribute(!0,{storage:n,default:s?Xl:void 0,name:"badges.topRight.stroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"badges.topRight.stroke.scalingMethod"},e)},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.topRight.text.content"},e),color:t.createAttribute(!0,{storage:n,default:s?xd:void 0,name:"badges.topRight.text.color"},e),font:t.createAttribute(!0,{storage:n,default:s?si:void 0,name:"badges.topRight.text.font"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"badges.topRight.text.style"},e),scale:t.createAttribute(!0,{storage:n,default:s?.5:void 0,name:"badges.topRight.text.scale"},e),paddingTop:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.topRight.text.paddging.left"},e),paddingLeft:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.topRight.text.paddging.top"},e)}},bottomLeft:{color:t.createAttribute(!0,{storage:n,default:s?_d:void 0,name:"badges.bottomLeft.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.45:void 0,name:"badges.bottomLeft.scale"},e),positionScale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.bottomLeft.positionScale"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?Wl:void 0,name:"badges.bottomLeft.minVisibleSize"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"badges.bottomLeft.scalingMethod"},e),image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.bottomLeft.image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.bottomLeft.image.scale"},e)},stroke:{color:t.createAttribute(!0,{storage:n,default:s?yd:void 0,name:"badges.bottomLeft.stroke.color"},e),width:t.createAttribute(!0,{storage:n,default:s?Xl:void 0,name:"badges.bottomLeft.stroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:e?"badges.bottomLeft.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.bottomLeft.text.content"},e),color:t.createAttribute(!0,{storage:n,default:s?xd:void 0,name:"badges.bottomLeft.text.color"},e),font:t.createAttribute(!0,{storage:n,default:s?si:void 0,name:"badges.bottomLeft.text.font"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"badges.bottomLeft.text.style"},e),scale:t.createAttribute(!0,{storage:n,default:s?.5:void 0,name:"badges.bottomLeft.text.scale"},e),paddingLeft:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.bottomLeft.text.paddging.left"},e),paddingTop:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.bottomLeft.text.paddging.top"},e)}},bottomRight:{color:t.createAttribute(!0,{storage:n,default:s?_d:void 0,name:"badges.bottomRight.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.45:void 0,name:"badges.bottomRight.scale"},e),positionScale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.bottomRight.positionScale"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?Wl:void 0,name:"badges.bottomRight.minVisibleSize"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"scaled":void 0,name:"badges.bottomRight.scalingMethod"},e),image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.bottomRight.image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"badges.bottomRight.image.scale"},e)},stroke:{color:t.createAttribute(!0,{storage:n,default:s?yd:void 0,name:"badges.bottomRight.stroke.color"},e),width:t.createAttribute(!0,{storage:n,default:s?Xl:void 0,name:"badges.bottomRight.stroke.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:e?"badges.bottomRight.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"badges.bottomRight.text.content"},e),color:t.createAttribute(!0,{storage:n,default:s?xd:void 0,name:"badges.bottomRight.text.color"},e),font:t.createAttribute(!0,{storage:n,default:s?si:void 0,name:"badges.bottomRight.text.font"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"badges.bottomRight.text.style"},e),scale:t.createAttribute(!0,{storage:n,default:s?.5:void 0,name:"badges.bottomRight.text.scale"},e),paddingLeft:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.bottomRight.text.paddging.left"},e),paddingTop:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"badges.bottomRight.text.paddging.top"},e)}}},halo:{color:t.createAttribute(!0,{storage:n,default:s?tL:void 0,name:"halo.color"},e),width:t.createAttribute(!0,{storage:n,default:s?l0:void 0,name:"halo.width"},e),scalingMethod:t.createAttribute(!0,{storage:n,default:s?"fixed":void 0,name:"halo.scalingMethod"},e),strokeColor:t.createAttribute(!0,{storage:n,default:s?eL:void 0,name:"halo.strokeColor"},e),strokeWidth:t.createAttribute(!0,{storage:n,default:s?u0:void 0,name:"halo.strokeWidth"},e),clustering:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"halo.clustering"},e),hideNonAdjacentEdges:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"halo.hideNonAdjacentEdges"},e)},pulse:{enabled:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"pulse.enabled"},e),duration:t.createAttribute(!0,{storage:n,default:s?nL:void 0,name:"pulse.duration"},e),interval:t.createAttribute(!0,{storage:n,default:s?iL:void 0,name:"pulse.interval"},e),startColor:t.createAttribute(!0,{storage:n,default:s?lL:void 0,name:"pulse.startColor"},e),endColor:t.createAttribute(!0,{storage:n,default:s?aL:void 0,name:"pulse.endColor"},e),width:t.createAttribute(!0,{storage:n,default:s?uL:void 0,name:"pulse.width"},e),startRatio:t.createAttribute(!0,{storage:n,default:s?rL:void 0,name:"pulse.startRatio"},e),endRatio:t.createAttribute(!0,{storage:n,default:s?oL:void 0,name:"pulse.endRatio"},e)},icon:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"icon.content"},e),font:t.createAttribute(!0,{storage:n,default:s?si:void 0,name:"icon.font"},e),color:t.createAttribute(!0,{storage:n,default:s?sL:void 0,name:"icon.color"},e),scale:t.createAttribute(!0,{storage:n,default:s?.7:void 0,name:"icon.scale"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"icon.style"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?12:void 0,name:"icon.minVisibleSize"},e)},image:{url:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"image.url"},e),scale:t.createAttribute(!0,{storage:n,default:s?1:void 0,name:"image.scale"},e),fit:t.createAttribute(!0,{storage:n,default:!!s||void 0,name:"image.fit"},e),tile:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"image.tile"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?12:void 0,name:"image.minVisibleSize"},e)},outline:{enabled:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"outline.enabled"},e),color:t.createAttribute(!0,{storage:n,default:s?JC:void 0,name:"outline.color"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?12:void 0,name:"outline.minVisibleSize"},e)},text:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"text.content"},e),font:t.createAttribute(!0,{storage:n,default:s?si:void 0,name:"text.font"},e),color:t.createAttribute(!0,{storage:n,default:s?qo:void 0,name:"text.color"},e),size:t.createAttribute(!0,{storage:n,default:s?uu:void 0,name:"text.size"},e),scale:t.createAttribute(!0,{storage:n,default:s?.1:void 0,name:"text.scale"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"text.style"},e),align:t.createAttribute(!0,{storage:n,default:s?"center":void 0,name:"text.align"},e),margin:t.createAttribute(!0,{storage:n,default:s?i0:void 0,name:"text.margin"},e),padding:t.createAttribute(!0,{storage:n,default:s?Jd:void 0,name:"text.padding"},e),backgroundColor:t.createAttribute(!0,{storage:n,default:s?ff:void 0,name:"text.backgroundColor"},e),tip:t.createAttribute(!0,{storage:n,default:s?wU:void 0,name:"text.tip"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?24:void 0,name:"text.minVisibleSize"},e),scaling:t.createAttribute(!0,{storage:n,default:!s&&void 0,name:"text.scaling"},e),position:t.createAttribute(!0,{storage:n,default:s?"bottom":void 0,name:"text.position"},e),maxLineLength:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"text.maxLineLength"},e),truncateLength:t.createAttribute(!0,{storage:n,default:s?0:void 0,name:"text.truncateLength"},e),secondary:{content:t.createAttribute(!0,{storage:n,default:s?null:void 0,name:"text.secondary.content"},e),font:t.createAttribute(!0,{storage:n,default:s?si:void 0,name:"text.secondary.font"},e),color:t.createAttribute(!0,{storage:n,default:s?qo:void 0,name:"text.secondary.color"},e),size:t.createAttribute(!0,{storage:n,default:s?r0:void 0,name:"text.secondary.size"},e),scale:t.createAttribute(!0,{storage:n,default:s?.08:void 0,name:"text.secondary.scale"},e),style:t.createAttribute(!0,{storage:n,default:s?"normal":void 0,name:"text.secondary.style"},e),align:t.createAttribute(!0,{storage:n,default:s?"center":void 0,name:"text.secondary.align"},e),margin:t.createAttribute(!0,{storage:n,default:s?TU:void 0,name:"text.secondary.margin"},e),padding:t.createAttribute(!0,{storage:n,default:s?Jd:void 0,name:"text.secondary.padding"},e),backgroundColor:t.createAttribute(!0,{storage:n,default:s?ff:void 0,name:"text.secondary.backgroundColor"},e),minVisibleSize:t.createAttribute(!0,{storage:n,default:s?24:void 0,name:"text.secondary.minVisibleSize"},e)}}}}var F3=class{constructor(t){this.nodes=new QS(t,!0,R3),this.edges=new QS(t,!1,k3)}setNodeDefaultAttributes(t){this.nodes.setDefaultAttributes(t)}setEdgeDefaultAttributes(t){this.edges.setDefaultAttributes(t)}getFlexArrays(){return{nodes:{current:this.nodes.getAttributeFlexArrays(),previous:this.nodes.getPrevAttributeFlexArrays()},edges:{current:this.edges.getAttributeFlexArrays(),previous:this.edges.getPrevAttributeFlexArrays()}}}redrawAll(){this.nodes.redrawAll(),this.edges.redrawAll()}clear(){this.nodes.clear(),this.edges.clear()}redrawElements(t){this._fetch(t).redrawElements(t)}getAnimationInformation(t){return this._fetch(t).getAnimationInformation(t)}redrawNodes(t){this.nodes.redrawElements(t)}getUsedAttributes(t,e){return this._fetch(e).getUsedAttributeNames(e.isNode?t.nodes:t.edges)}startUpdate(){this.nodes.startUpdate(),this.edges.startUpdate()}notifyDestroyed(t){this.nodes.notifyLayerDestroyed(t.nodes),this.edges.notifyLayerDestroyed(t.edges)}prepareUpdate(t){this.nodes.prepareFlexArraysUpdate(t.nodes),this.edges.prepareFlexArraysUpdate(t.edges)}onUpdate(t){this.nodes.updateFlexArrays(t.nodes),this.edges.updateFlexArrays(t.edges)}afterLayersUpdate(){this.nodes.endUpdate(),this.edges.endUpdate()}getAndResetElementsToRedraw(){return{nodes:this.nodes.getAndResetElementsToRedraw(),edges:this.edges.getAndResetElementsToRedraw()}}getAndResetElementsUpdated(){const t=this.nodes,e=this.edges;return{nodes:t.getAndResetElementsUpdated(),edges:e.getAndResetElementsUpdated(),nodeAttributesSet:t.getUpdatedAttributesSet(),nodeAttributes:t.getAndResetAttributesUpdated(),edgeAttributes:e.getAndResetAttributesUpdated()}}setAnimationAttributes({nodes:t,edges:e},s){this.nodes.setAnimationAttributes(t,s),this.edges.setAnimationAttributes(e,s)}resetAnimationAttributes({nodes:t,edges:e}){this.nodes.resetAnimationAttributes(t),this.edges.resetAnimationAttributes(e)}setLastOutput(t,e){this.nodes.setLastFlexArrays(t),this.edges.setLastFlexArrays(e)}getCurrentInput(){const t=Ws(this.nodes.getDefaultFlexArrays()),e=Ws(this.edges.getDefaultFlexArrays());return{currentNodeFlexArrays:t,currentEdgeFlexArrays:e,allNodeAttributePaths:Ba(t),allEdgeAttributePaths:Ba(e)}}initializeLayer(t,e,s){t.nodes.allAttributePaths=e,t.edges.allAttributePaths=s,t.nodes.formattedDependencies=C3(t.nodes),t.edges.formattedDependencies=L3(t.edges),t.nodes.formattedOutput={attributes:ZS(t.nodes),tags:t.tag?[t.tag]:[]},t.edges.formattedOutput={attributes:ZS(t.edges),tags:t.tag?[t.tag]:[]},t.nodes.redrawAdjacentEdges=t.nodes.formattedOutput.attributes.some((n=>e3[n])),t.initialized=!0}connectLayerInputOutput(t,e,s){const n=t.nodes.formattedOutput,i=t.edges.formattedOutput;for(const r of n.attributes){const o=qs(e,r),a=qs(t.nodes.outputFlexArrays,r);a.setFallback(o),Kr(e,r,a)}for(const r of i.attributes){const o=qs(s,r),a=qs(t.edges.outputFlexArrays,r);a.setFallback(o),Kr(s,r,a)}}setupLayerDependencies(t,e){if(t===e)return;const s=t.priority,n=e.priority,i=t.nodes.formattedOutput,r=t.edges.formattedOutput,o=e.nodes.formattedDependencies,a=e.edges.formattedDependencies;vr(t.depsNodeSelf,e,i,o.self,s,n),vr(t.depsNodeAdjacentNodes,e,i,o.adjacentNodes,s,n),vr(t.depsNodeAdjacentEdges,e,r,a.extremities,s,n),vr(t.depsNodeAllNodes,e,i,o.allNodes,s,n),vr(t.depsNodeAllEdges,e,r,a.allNodes,s,n),vr(t.depsEdgeSelf,e,r,a.self,s,n),vr(t.depsEdgeExtremities,e,i,o.adjacentEdges,s,n),vr(t.depsEdgeParallelEdges,e,r,a.parallelEdges,s,n),vr(t.depsEdgeAllNodes,e,i,o.allEdges,s,n),vr(t.depsEdgeAllEdges,e,r,a.allEdges,s,n)}createAttributeLayerData(t,e,s,{tag:n,onBeforeUpdate:i,standaloneSelectors:r}){const o=!!r;return{index:-1,id:e,name:t,tag:n||null,priority:0,depsNodeSelf:[],depsNodeAdjacentNodes:[],depsNodeAdjacentEdges:[],depsNodeAllNodes:[],depsNodeAllEdges:[],depsEdgeSelf:[],depsEdgeExtremities:[],depsEdgeParallelEdges:[],depsEdgeAllNodes:[],depsEdgeAllEdges:[],initialized:!1,onBeforeUpdate:i,nodes:{type:"node",name:t,standaloneSelector:o,toUpdate:new _f({graph:s,isNode:!0,includeRemovedElements:!1}),outputFlexArrays:this.nodes.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null},edges:{type:"edge",name:t,standaloneSelector:o,toUpdate:new _f({graph:s,isNode:!1,includeRemovedElements:!1}),outputFlexArrays:this.edges.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null}}}setAttributeValues(t,e,s,n,i){this._fetch(e).setAttributeValues(t,e,s,n,i)}getAttributeValues(t,e,s,n){return this._fetch(t).getAttributeValues(t,e,s,n)}_fetch(t){return t.isNode?this.nodes:this.edges}},P3=(t,e)=>new jU(t,e),z3=class{constructor(t,{graph:e,dom:s}){this._layerIdCounter=0,this._layers=[],this._destroyedLayers=[],this._layersNeedUpdate=!1,this._updateOngoing=!1,this._needUpdate=!1,this._ogma=t,this._graph=e,this._dom=s,this._emptySubgraph={nodes:t.nodeList(),edges:t.edgeList()},this._textHiddenSet=new Ah(this._graph,"textHidden"),this._layerController=new F3(this._graph)}_getLayerById(t){for(let e=0;e<this._layers.length;++e){const s=this._layers[e];if(s.id===t)return s.index=e,s}throw new Error("usage of a destroyed style rule or class")}setDefaultAttributes(t,e){this._layerController.setNodeDefaultAttributes(t),this._layerController.setEdgeDefaultAttributes(e)}getFlexArrays(){return this._layerController.getFlexArrays()}clear(){this._updateOngoing=!1,this._needUpdate=!1,this._destroyedLayers=[],this._layerController.clear(),this.updateAllForAllAttributeLayers()}redrawElements(t){t.size&&(this._layerController.redrawElements(t),this._dom.refresh())}redrawAll(){this._layerController.redrawAll(),this._dom.refresh()}_triggerUpdate(){this._needUpdate=!0,this._dom.refresh()}_reconstructAttributeLayersIfNecessary(){return!!this._layersNeedUpdate&&(this._reconstructAttributeLayers(),this._layersNeedUpdate=!1,this._dom.refresh(),!0)}getAnimationInformation(t){return this._layerController.getAnimationInformation(t)}update(){if(!this._needUpdate||this._updateOngoing||!this._ogma._token)return!1;this._reconstructAttributeLayersIfNecessary(),this._updateOngoing=!0,this._layerController.startUpdate();for(const t of this._destroyedLayers)t.initialized&&this._layerController.notifyDestroyed(t);for(const t of this._layers)this._layerController.prepareUpdate(t),typeof t.onBeforeUpdate=="function"&&t.onBeforeUpdate(t,this,this._layerController),this._layerController.onUpdate(t);return this._layerController.afterLayersUpdate(),this._updateOngoing=!1,this._needUpdate=!1,!0}setAttributeLayerValues(t,e,s,n){const i=this._getLayerById(t),r=e.isNode?i.nodes:i.edges;this._reconstructAttributeLayersIfNecessary(),this._layerController.setAttributeValues(r,e,s,n,i),this._updateElementsForAttributeLayers([i],e)}getAttributeLayerFlexArrays(t){const e=this._getLayerById(t);return{nodes:e.nodes.outputFlexArrays,edges:e.edges.outputFlexArrays}}getUsedAttributeLayerAttributes(t,e){const s=this._getLayerById(t);return this._layerController.getUsedAttributes(s,e)}getUpdatedElements(){return{elementsToRedraw:this._layerController.getAndResetElementsToRedraw(),elementsUpdated:this._layerController.getAndResetElementsUpdated()}}addAttributeLayer(t){const{name:e,layerFactory:s=P3}=t;if(!e)throw new Error("Attribute layer must have a name");if(e&&this._layers.find((i=>i.name===e)))throw new Error(`attribute layer with name "${t.name}" already exists`);const n=this._layerController.createAttributeLayerData(e,++this._layerIdCounter,this._graph,t);return this._layers.push(n),this._updateLayer(n,t),s(this,this._layerIdCounter)}_reconstructAttributeLayers(){this._layers.sort(((i,r)=>i.priority-r.priority));const{currentNodeFlexArrays:t,currentEdgeFlexArrays:e,allNodeAttributePaths:s,allEdgeAttributePaths:n}=this._layerController.getCurrentInput();for(const i of this._layers)this._layerController.initializeLayer(i,s,n);for(const i of this._layers){i.nodes.inputFlexArrays=Ws(t),i.edges.inputFlexArrays=Ws(e),i.depsNodeSelf=[],i.depsNodeAdjacentNodes=[],i.depsNodeAdjacentEdges=[],i.depsNodeAllNodes=[],i.depsNodeAllEdges=[],i.depsEdgeSelf=[],i.depsEdgeExtremities=[],i.depsEdgeParallelEdges=[],i.depsEdgeAllNodes=[],i.depsEdgeAllEdges=[],i.nodes.toUpdate.addAll(),i.edges.toUpdate.addAll(),this._layerController.connectLayerInputOutput(i,t,e);for(const r of this._layers)this._layerController.setupLayerDependencies(i,r)}this._layerController.setLastOutput(t,e);for(const i of this._layers)i.nodes.needAdjacentElements=i.nodes.redrawAdjacentEdges||i.depsNodeAdjacentNodes.length>0||i.depsNodeAdjacentEdges.length>0,i.edges.needAdjacentElements=i.depsEdgeExtremities.length>0||i.depsEdgeParallelEdges.length>0}_updateLayer(t,{priority:e,fullOverwrite:s,nodeAttributes:n,nodeSelector:i,nodeContext:r,nodeDependencies:o,nodeOutput:a,edgeAttributes:l,edgeSelector:u,edgeContext:h,edgeDependencies:g,edgeOutput:f}={}){n!==void 0&&(t.nodes.attributes=s?n:Hg(t.nodes.attributes,n)),i!==void 0&&(t.nodes.selector=i),r!==void 0&&(t.nodes.context=r),o!==void 0&&(t.nodes.dependencies=o),a!==void 0&&(t.nodes.output=a),l!==void 0&&(t.edges.attributes=s?l:Hg(t.edges.attributes,l)),u!==void 0&&(t.edges.selector=u),h!==void 0&&(t.edges.context=h),g!==void 0&&(t.edges.dependencies=g),f!==void 0&&(t.edges.output=f),e!==void 0&&(t.priority=e),this._triggerLayerUpdate()}_triggerLayerUpdate(){this._layersNeedUpdate=!0,this._triggerUpdate()}updateAllForAttributeLayer(t){const e=this._getLayerById(t);this._updateAllForAttributeLayer(e)}updateAllForAllAttributeLayers(){for(const t of this._layers)this._updateAllForAttributeLayer(t)}_updateAllForAttributeLayer(t,e=!0,s=!0){if(e&&!t.nodes.toUpdate.isFull()){t.nodes.toUpdate.addAll();for(const n of t.depsNodeSelf)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsNodeAdjacentNodes)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsNodeAdjacentEdges)this._updateAllForAttributeLayer(n,!1,!0);for(const n of t.depsNodeAllNodes)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsNodeAllEdges)this._updateAllForAttributeLayer(n,!1,!0)}if(s&&!t.edges.toUpdate.isFull()){t.edges.toUpdate.addAll();for(const n of t.depsEdgeSelf)this._updateAllForAttributeLayer(n,!1,!0);for(const n of t.depsEdgeExtremities)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsEdgeParallelEdges)this._updateAllForAttributeLayer(n,!1,!0);for(const n of t.depsEdgeAllNodes)this._updateAllForAttributeLayer(n,!0,!1);for(const n of t.depsEdgeAllEdges)this._updateAllForAttributeLayer(n,!1,!0)}this._triggerUpdate()}updateElementsForAttributeLayer(t,e){const s=this._getLayerById(t);this._updateElementsForAttributeLayers([s],e)}updateForAllAttributeLayers(t){this._updateElementsForAttributeLayers(this._layers,t)}_updateElementsForAttributeLayers(t,e){let s=this._emptySubgraph;if(e.isNode){for(const n of t)if(!n.nodes.toUpdate.isFull()){n.nodes.needAdjacentElements&&(s=s===this._emptySubgraph?e.fastGetAdjacentElements():s),n.nodes.toUpdate.add(e);for(const i of n.depsNodeSelf)i.nodes.toUpdate.add(e);for(const i of n.depsNodeAdjacentNodes)i.nodes.toUpdate.add(s.nodes);for(const i of n.depsNodeAdjacentEdges)i.edges.toUpdate.add(s.edges);for(const i of n.depsNodeAllNodes)this._updateAllForAttributeLayer(i,!0,!1);for(const i of n.depsNodeAllEdges)this._updateAllForAttributeLayer(i,!1,!0);n.nodes.redrawAdjacentEdges&&this._layerController.redrawElements(s.edges)}}else for(const n of t)if(!n.edges.toUpdate.isFull()){n.edges.needAdjacentElements&&(s=s===this._emptySubgraph?e.fastGetAdjacentElements():s),n.edges.toUpdate.add(e);for(const i of n.depsEdgeSelf)i.edges.toUpdate.add(e);for(const i of n.depsEdgeExtremities)i.nodes.toUpdate.add(s.nodes);for(const i of n.depsEdgeParallelEdges)i.edges.toUpdate.add(s.edges);for(const i of n.depsEdgeAllNodes)this._updateAllForAttributeLayer(i,!0,!1);for(const i of n.depsEdgeAllEdges)this._updateAllForAttributeLayer(i,!1,!0)}this._triggerUpdate()}destroyAttributeLayer(t){const e=this._getLayerById(t);this._destroyedLayers.push(e),this._layers.splice(e.index,1),this._triggerLayerUpdate()}updateAttributeLayer(t,e){const s=this._getLayerById(t);this._updateLayer(s,e)}getAttributeLayerDefinition(t){const e=this._getLayerById(t),{priority:s,nodes:n,edges:i}=e;return{priority:s,nodeAttributes:n.attributes,nodeSelector:n.selector,nodeContext:n.context,nodeDependencies:n.dependencies,nodeOutput:n.output,edgeAttributes:i.attributes,edgeSelector:i.selector,edgeContext:i.context,edgeDependencies:i.dependencies,edgeOutput:i.output}}getAttributeValues(t,e,s,n){return this.update(),this._layerController.getAttributeValues(t,e,s,n)}setAnimationAttributes(t,e){return this._layerController.setAnimationAttributes(t,e)}resetAnimationAttributes(t){return this._layerController.resetAnimationAttributes(t)}setTextHidden(t,e){const s=this._textHiddenSet.addOrRemoveElements(t,e);this.redrawElements(s)}resetTextHidden(){const{nodes:t,edges:e}=this._textHiddenSet.getElements();this._textHiddenSet.clear(),this._layerController.redrawElements(t),this._layerController.redrawElements(e)}getUsedNodeAttributes(){return this._layerController.nodes.getUsedAttributes()}getUsedEdgeAttributes(){return this._layerController.edges.getUsedAttributes()}interpolateAttributes(t){const e=$n(),s=this._ogma.modules.graphics.getAttributesManager(),n=this._layerController,i=t.isNode?s.getUsedNodeAttributes():s.getUsedEdgeAttributes(),{animationDuration:r,animationEasing:o,animationStart:a}=n.getFlexArrays().nodes.current,l=r.getMultiple(t._indexes),u=o.getMultiple(t._indexes),h=a.getMultiple(t._indexes),g=[];for(let f=0;f<t.size;f++){const m={};i.forEach((y=>{const p=typeof y=="string"?y:y.join("."),x=qs(n.getFlexArrays().nodes.previous,y),v=qs(n.getFlexArrays().nodes.current,y);if(!v)return;const b=lC(e,h[f],l[f],u[f]);isNaN(b)?m[p]=v.get(t._indexes[f]):p.match(/color/gi)?m[p]=md(x.get(t._indexes[f]),v.get(t._indexes[f]),b,b):m[p]=bs(x.get(t._indexes[f]),v.get(t._indexes[f]),b)})),g.push(m)}return g}},D3=1e-12;function JS(t){return((t=Math.exp(t))+1/t)/2}function O3(t){return((t=Math.exp(t))-1/t)/2}function B3(t){return((t=Math.exp(2*t))-1)/(t+1)}var U3=(function t(e,s,n){function i(r,o){var a,l,u=r[0],h=r[1],g=r[2],f=o[0],m=o[1],y=o[2],p=f-u,x=m-h,v=p*p+x*x;if(v<D3)l=Math.log(y/g)/e,a=function(k){return[u+k*p,h+k*x,g*Math.exp(e*k*l)]};else{var b=Math.sqrt(v),S=(y*y-g*g+n*v)/(2*g*s*b),A=(y*y-g*g-n*v)/(2*y*s*b),w=Math.log(Math.sqrt(S*S+1)-S),L=Math.log(Math.sqrt(A*A+1)-A);l=(L-w)/e,a=function(k){var F=k*l,O=JS(w),j=g/(s*b)*(O*B3(e*F+w)-O3(w));return[u+j*p,h+j*x,g*O/JS(e*F+w)]}}return a.duration=1e3*l*e/Math.SQRT2,a}return i.rho=function(r){var o=Math.max(.001,+r),a=o*o;return t(o,a,a*a)},i})(Math.SQRT2,2,4),G3="cubicOut",V3=({graphWidth:t,graphHeight:e,viewWidth:s,viewHeight:n})=>.2*Math.min(s/t,n/e),j3=({smallestNodeSize:t,viewWidth:e,viewHeight:s})=>t===1/0?1/0:Math.min(e,s)/t*.5;function H3(t,e,s){return e===void 0?$3(t):e==="alt"?t.altKey:e==="shift"?t.shiftKey:e==="space"?s.isPressed("space"):void 0}function $3(t){return!t.altKey&&(FR?t.metaKey:t.ctrlKey)&&!t.shiftKey}var Ry=Math.SQRT2,t1=.15,q3=class extends Ke{constructor(t,e){super(t),this._zooming=!1,this.debug=!1,this._smoothZoom=Vd(((s,n,i)=>{const r=this._modules.settings,o=r.get("interactions.zoom.duration"),a=r.get("interactions.zoom.easing"),l=this._modules.camera.getZoom(),u={duration:o,easing:a};this._zooming||(this._zooming=!0,this._updateVisibility("zoom",!0));const h=r.get("interactions.zoom.speed")||t1;let g=ED(s,h);s<0&&g!==0&&(g=1/g);const f=l*g;this._modules.camera.setZoom(f,u,{x:n,y:i}).then((()=>{this._zooming&&(this._zooming=!1,this._updateVisibility("zoom",!1))}))}),ST),this.debug=e}onMounted(){const t=this._modules.settings;t.register("interactions.zoom.enabled",!0),t.register("interactions.zoom.onDoubleClick",!1),t.register("interactions.zoom.duration",150),t.register("interactions.zoom.modifier",Ry),t.register("interactions.zoom.speed",t1),t.register("interactions.zoom.easing",G3),t.register("interactions.zoom.minValue",this.debug?null:V3),t.register("interactions.zoom.maxValue",this.debug?null:j3),t.register("interactions.zoom.hideNodes",!1),t.register("interactions.zoom.hideEdges",!1),t.register("interactions.zoom.hideNodeTexts",!1),t.register("interactions.zoom.hideEdgeTexts",!1),t.register("interactions.zoom.scrollToPan",!1),t.register("interactions.zoom.metaKey",void 0),t.register("interactions.pan.enabled",!0),t.register("interactions.pan.hideNodes",!1),t.register("interactions.pan.hideEdges",!1),t.register("interactions.pan.hideNodeTexts",!1),t.register("interactions.pan.hideEdgeTexts",!1),t.register("interactions.rotation.enabled",!0),t.register("interactions.rotation.hideNodes",!1),t.register("interactions.rotation.hideEdges",!1),t.register("interactions.rotation.hideNodeTexts",!1),t.register("interactions.rotation.hideEdgeTexts",!1),t.register("interactions.gesture.enabled",!0),t.register("interactions.gesture.hideNodes",!1),t.register("interactions.gesture.hideEdges",!1),t.register("interactions.gesture.hideNodeTexts",!1),t.register("interactions.gesture.hideEdgeTexts",!1),this._setupInteractions()}_setupInteractions(){this._modules.interactions.onMouseWheel({priority:"zoom",check:()=>!!this._modules.settings.get("interactions.zoom.enabled"),handler:({x:t,y:e,delta:s,dx:n,dy:i,domEvent:r})=>{const o=n%1!=0||i%1!=0,a=this._modules.settings;!a.get("interactions.zoom.scrollToPan")||H3(r,a.get("interactions.zoom.metaKey"),this._modules.keyboard)||o?this._smoothZoom(s,t,e):this._modules.camera.move({x:n,y:i})}}),this._modules.interactions.onDoubleClick({priority:"zoom",check:()=>{const t=this._modules.settings.get("interactions.zoom.enabled"),e=this._modules.settings.get("interactions.zoom.onDoubleClick");return!(!t||!e)},handler:({x:t,y:e})=>this._smoothZoom(1,t,e)}),this._modules.interactions.onDrag({priority:"panning",disableDetection:!0,check:({button:t})=>{const e=!!this._modules.settings.get("interactions.pan.enabled");return t==="left"&&e},onStart:()=>this._updateVisibility("pan",!0),onProgress:({dx:t,dy:e})=>this._modules.camera.move({x:-t,y:-e}),onStop:()=>this._updateVisibility("pan",!1)}),this._modules.interactions.onDrag({priority:"rotation",disableDetection:!0,check:({button:t,domEvent:e})=>(t==="right"||e&&e.buttons===2)&&!!this._modules.settings.get("interactions.rotation.enabled"),onStart:({x:t,y:e})=>{this._rotationStart={x:t,y:e},this._updateVisibility("rotation",!0)},onProgress:({x:t,y:e})=>this._rotate({x:t,y:e}),onStop:()=>this._updateVisibility("rotation",!1)}),this._modules.interactions.onGesture({priority:"gesture",disableDetection:!0,check:()=>!!this._modules.settings.get("interactions.gesture.enabled"),onStart:()=>this._updateVisibility("gesture",!0),onProgress:({dx:t,dy:e,rotation:s,scale:n,x:i,y:r})=>{this._modules.settings.get("interactions.rotation.enabled")&&this._modules.camera.rotate(-s),this._modules.camera.zoomIn({modifier:n},{x:i,y:r}),this._modules.camera.move({x:-t,y:-e})},onStop:()=>this._updateVisibility("gesture",!0)})}_rotate({x:t,y:e}){const{width:s,height:n}=this._modules.camera.getSize(),i=s/2,r=n/2,o=this._rotationStart.x-i,a=this._rotationStart.y-r,l=t-i,u=e-r,h=Math.atan2(a,o)-Math.atan2(u,l);this._rotationStart.x=t,this._rotationStart.y=e,this._modules.camera.rotate(h)}_updateVisibility(t,e){const s=!e,n=this._modules.settings,i=n.get(`interactions.${t}.hideNodes`),r=n.get(`interactions.${t}.hideEdges`),o=n.get(`interactions.${t}.hideNodeTexts`),a=n.get(`interactions.${t}.hideEdgeTexts`);i&&this._modules.graphics.setNodesVisibility(s),o&&this._modules.graphics.setNodeTextsVisibility(s),r&&this._modules.graphics.setEdgesVisibility(s),a&&this._modules.graphics.setEdgeTextsVisibility(s)}},Y3=1e-8,W3=1e8,r_={duration:0,startAfter:0,ignoreZoomLimits:!1,callback:os,easing:"quadraticOut"};function ug(t){return Math.abs(t)<1e-9}var X3=80,Z3=class lN extends Ke{constructor(){super(...arguments),this._minZoom=Y3,this._maxZoom=W3,this._timeout=0,this._cornerCosSin=new Float32Array([0,0,0,0,0,0,0,0])}onMounted(){this._reset(),this._modules.events.on("setContainer",(()=>{this._reset(),this._modules.events.fire("move")})).on("resize",(()=>{this._reloadDimensions(),this._modules.events.fire("move")}))}get x(){return this._x}get y(){return this._y}get zoom(){return this._zoom}get angle(){return this._angle}get width(){return this._dimensions.width}get height(){return this._dimensions.height}moveEnd(e){this._modules.dom.clearTimeout(this._timeout),this._timeout=this._modules.dom.setTimeout((()=>{this._modules.events.fire("viewChanged",{type:e})}),X3)}getSize(){return{width:this._dimensions.width,height:this._dimensions.height}}getCenter(){return{x:this._x,y:this._y}}setCenter({x:e,y:s},n){const i=this._x,r=this._y,o=e-this._x,a=s-this._y;return ug(o)&&ug(a)?Promise.resolve():new Promise((l=>{this._moveAnimation&&this._modules.animations.cancel(this._moveAnimation);const u=this._modules.animations.play((h=>{this._x=i+o*h,this._y=r+a*h,this._modules.events.fire("move").fire("pan")}),{...r_,...n,callback:()=>this.moveEnd("pan"),resolve:l});u&&(this._moveAnimation=u)}))}move({x:e,y:s},n){const i=e1({x:e,y:s},this._zoom,this._sinAngle,this._cosAngle);return this.setCenter({x:this._x+i.x,y:this._y+i.y},n)}getZoom(){return this._zoom}setZoom(e,s,n={x:void 0,y:void 0}){const{x:i,y:r}=n;let o=$i(e,this._minZoom,this._maxZoom);return s&&s.ignoreZoomLimits||(o=this._applyZoomLimits(o)),ug(this._zoom-o)?Promise.resolve():new Promise((a=>{const l={...r_,...s,callback:()=>this.moveEnd("zoom"),resolve:a},u=this._dimensions.width/2,h=this._dimensions.height/2,g=this._zoom,f=u/g-u/o;if(i!==void 0&&r!==void 0){const y=(i-u)/g-(i-u)/o,p=(r-h)/g-(r-h)/o,x=this._cosAngle,v=this._sinAngle,b=x*y-v*p,S=v*y+x*p;this.setCenter({x:this._x+b,y:this._y+S},s)}this._zoomAnimation&&this._modules.animations.cancel(this._zoomAnimation),this._modules.dom.afterNextFrame().then((()=>this._modules.events.fire("zoomStart",{duration:l.duration,easing:l.easing,startZoom:g,endZoom:o})));const m=this._modules.animations.play((y=>{this._zoom=u/(u/g-f*y),this._modules.events.fire("move").fire("zoom")}),l);m&&(this._zoomAnimation=m)}))}_applyZoomLimits(e){const s=this._modules.settings.get("interactions.zoom.minValue"),n=this._modules.settings.get("interactions.zoom.maxValue"),{minScaledSize:i,maxScaledSize:r,width:o,height:a,cx:l}=this._modules.locate.getGraphBoundingBox(),u=this._zoom,h=this.getSize();let g=e;if(!isNaN(l)){const f={smallestNodeSize:i,biggestNodeSize:r,graphWidth:o+r,graphHeight:a+r,viewWidth:h.width,viewHeight:h.height},m=s&&s(f),y=n&&n(f);s1(m)&&g<m?g<u&&(g=Math.min(u,m)):s1(y)&&g>y&&g>u&&(g=Math.max(u,y))}return g}zoomIn(e,s={x:void 0,y:void 0}){let n=1;return e===void 0&&(e={}),typeof e=="number"&&(e={modifier:e}),n=typeof e.modifier!="number"?this._modules.settings.get("interactions.zoom.modifier")||Ry:e.modifier,this.setZoom(this._zoom*n,e,s)}moveToBounds(e,s={}){const n=this._modules.locate.computeConfigForBounds(e,{ignoreZoomLimits:!0});return this.moveTo(n,s)}moveTo(e,s={}){const n=this.getZoom(),i=this.getCenter(),r=e.zoom||this._zoom;return s.duration===0?this.setView(e):new Promise((o=>{const a=Math.min(this.width,this.height),l=U3([i.x,i.y,a/n],[e.x,e.y,a/r]),u=l.duration,h=s.duration||u;this._moveAnimation&&this._modules.animations.cancel(this._moveAnimation);const g=this._modules.animations.play((f=>{const[m,y,p]=l(f);this._x=m,this._y=y,this._zoom=a/p,this._modules.events.fire("move"),this._modules.events.fire("pan")}),{duration:h,easing:s.easing,callback:()=>this.moveEnd("pan"),resolve:o});g&&(this._moveAnimation=g)}))}zoomOut(e,s={x:void 0,y:void 0}){let n=1;return e===void 0&&(e={}),typeof e=="number"&&(e={modifier:e}),n=typeof e.modifier!="number"?this._modules.settings.get("interactions.zoom.modifier")||Ry:e.modifier,this.setZoom(this._zoom/n,e,s)}getAngle(){return this._angle}setAngle(e,s){const n=this._angle,i=e-n;return ug(i)?Promise.resolve():new Promise((r=>{this._rotateAnimation&&this._modules.animations.cancel(this._rotateAnimation);const o=this._modules.animations.play((a=>{for(this._angle=n+i*a,this.calculateBoxCornerAngles();this._angle>Math.PI;)this._angle-=2*Math.PI;for(;this._angle<-Math.PI;)this._angle+=2*Math.PI;this._sinAngle=Math.sin(this._angle),this._cosAngle=Math.cos(this._angle),this._modules.events.fire("move").fire("rotate")}),{...r_,...s,callback:()=>this.moveEnd("rotate"),resolve:r});o&&(this._rotateAnimation=o)}))}rotate(e,s){return this.setAngle(this._angle+e,s)}getScreenCenter(){return{x:this._dimensions.width/2,y:this._dimensions.height/2}}graphToScreenCoordinates({x:e,y:s},n={x:0,y:0}){const i=this._dimensions.width/2,r=this._dimensions.height/2;return nf((e-this._x)*this._zoom+i,(s-this._y)*this._zoom+r,i,r,-this._angle,n)}screenToGraphCoordinates({x:e,y:s},n={x:0,y:0}){return nf(this._x+(e-this._dimensions.width/2)/this._zoom,this._y+(s-this._dimensions.height/2)/this._zoom,this._x,this._y,this._angle,n)}projectBounds(e,s=e){const n=e[0],i=e[1],r=e[2],o=e[3],a=this._x,l=this._y,u=this._dimensions.width/2,h=this._dimensions.height/2,g=this._sinAngle,f=this._cosAngle,m=1/this._zoom;let y=1/0,p=1/0,x=-1/0,v=-1/0;const b=[n,i,n,o,r,o,r,i];for(let S=0;S<b.length;S+=2){let A=b[S],w=b[S+1];A=a+(A-u)*m,w=l+(w-h)*m;const L=A-a,k=w-l;A=f*L-g*k+a,w=g*L+f*k+l,A<y&&(y=A),A>x&&(x=A),w<p&&(p=w),w>v&&(v=w)}return s[0]=y,s[1]=p,s[2]=x,s[3]=v,s}screenToGraphVector({x:e,y:s}){return e1({x:e,y:s},this._zoom,this._sinAngle,this._cosAngle)}getView(){return{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,width:this._dimensions.width,height:this._dimensions.height}}setView(e,s){const{x:n,y:i,zoom:r,angle:o}={x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,...e};return Promise.all([this.setCenter({x:n,y:i},s),this.setZoom(r,s),this.setAngle(o,s)]).then(os)}_reloadDimensions(){this._dimensions=this._modules.dom.getDimensions()}animationInProgress(){const e=this._moveAnimation,s=this._zoomAnimation,n=this._rotateAnimation;return!!(e&&!e.done||s&&!s.done||n&&!n.done)}getProjectedScreenBounds(e=0){const{width:s,height:n}=this._dimensions,i=Math.max(s,n)*e;return this.projectBounds([0-i,0-i,s+i,n+i])}calculateBoxCornerAngles(){const e=this._angle;this._cornerCosSin[0]=Math.cos(e+Math.PI/4),this._cornerCosSin[1]=Math.sin(e+Math.PI/4),this._cornerCosSin[2]=Math.cos(e+3*Math.PI/4),this._cornerCosSin[3]=Math.sin(e+3*Math.PI/4),this._cornerCosSin[4]=Math.cos(e-3*Math.PI/4),this._cornerCosSin[5]=Math.sin(e-3*Math.PI/4),this._cornerCosSin[6]=Math.cos(e-Math.PI/4),this._cornerCosSin[7]=Math.sin(e-Math.PI/4)}getCornerCos(e){return this._cornerCosSin[2*e]}getCornerSin(e){return this._cornerCosSin[2*e+1]}_reset(){this._zoom=1,this._x=0,this._y=0,this._angle=0,this.calculateBoxCornerAngles(),this._sinAngle=0,this._cosAngle=1,this._dimensions=this._modules.dom.getDimensions()}clone(e){const s=new lN(this._ogma);return s._zoom=e.zoom||this._zoom,s._x=e.x||this._x,s._y=e.y||this._y,s._angle=e.angle||this._angle,s._sinAngle=Math.sin(s._angle),s._cosAngle=Math.cos(s._angle),s.calculateBoxCornerAngles(),s._dimensions={width:e.width||this._dimensions.width,height:e.height||this._dimensions.height},s}};function e1({x:t,y:e},s,n,i){return{x:i*(t/=s)-n*(e/=s),y:n*t+i*e}}function s1(t){return typeof t=="number"&&isFinite(t)}function K3(t){const e=t.filter((s=>isFinite(s)&&s>0));return e.length?Yr(e):1}var Q3="anonymous",J3="white",t4="default",e4={maxBlockId:1024,maxCoord:-1/0,maxScaledSize:16,maxPixelSize:255,maxMinVisibleSize:64,maxDashOffset:4,maxDashLength:3,maxGapLength:1,maxSymbolicSize:0,maxPatternScale:0},s4=If?"webgl":null,n1=5,n4=class extends Ke{constructor(){super(...arguments),this._debug=!1,this._initDone=!1,this._boundaries={maxSize:10,maxMinVisibleSize:64},this._visibility={nodes:0,edges:0,nodeTexts:0,edgeTexts:0},this._nextAnimationId=1,this._animations=[],this._rendererState={type:null,code:null,state:"ok",message:""},this._cursorStyle=[],this._fontsNewlyLoaded=[],this._nextGeIndex=1,this._availableGeIndexes=[],this._renderOnNewFrame=!0,this._isBufferDisplayable=t=>{const e=LB(t),s=CC(t),n=e?this._visibility.nodes:this._visibility.edges,i=e?this._visibility.nodeTexts:this._visibility.edgeTexts;return n===0&&(!s||i===0)},this._onRendererChange=t=>{this._updateRendererState({type:t,state:"requested",code:null,message:void 0}),this._engine.setRenderType(t),this._modules.dom.refresh()},this._onNewFrame=()=>{this._processAnimations(),this._loadGraphInGraphicsEngine(),this._renderOnNewFrame&&this._render()},this._applyCursorStyle=()=>{const t=this._cursorStyle[this._cursorStyle.length-1]||this._modules.settings.get("cursor.default");ef(this._domWrapper,t)},this._updateImageCrossOrigin=()=>{this._imageManager.setImgCrossOrigin(this._modules.settings.get("imgCrossOrigin")||null)}}onMounted(){this._debug=this._ogma.isDebug(),this._renderOnNewFrame=!0,this._formatText=Z2().applyArabicShaping,this._attributesManager=new z3(this._ogma,this._modules),this._imageManager=new AU,this._fontManager=new DO,this._engine=new Qp(Qp.getCachedInitData()),this._domWrapper=this._engine.getDomWrapper(),this._engine.on("error",this._onNewFrame),this._nodeAnimationMap=new Map,this._edgeAnimationMap=new Map,this._movingNodes=new Set,this._movingEdges=new Set,this._modules.events.register(["reloadFonts","rendererStateChange","beforeUpdateAttributes","updateAttributes","animate","move","pan","zoom","rotate","viewExportStart","viewExportEnd","afterImageExport","viewChanged","zoomStart"]),this._modules.settings.register("renderer",s4,this._onRendererChange),this._modules.settings.register("edgeTipRatio",T2,(t=>{this._engine.setEdgeArrowSizeRatio(t),this._modules.dom.refresh()})),this._modules.settings.register("nodeCornerRadius",0,(t=>{bU(this._engine,t),this._modules.dom.refresh()})),this._modules.settings.register("edgeMinTipSize",C2,(t=>{this._engine.setEdgeMinTipSize(t),this._modules.dom.refresh()})),this._modules.settings.register("backgroundColor",J3,(t=>{this._engine.parseColor(t)?this._modules.dom.refresh():(Uo(`Invalid background color "${t}" specified; will default to black.`),this._modules.settings.set("backgroundColor","black"))})),this._modules.settings.register("texts.hideUntilFontsLoaded",!0,(t=>{this._fontManager.setHideUntilFontsLoaded(!!t)})),this._modules.settings.register("texts.cornerRadius",n1,(t=>{this._engine.getTextManager().setCornerRadius(typeof t=="number"?t:n1),this._modules.dom.refresh()})),this._modules.settings.register("imgCrossOrigin",Q3,this._updateImageCrossOrigin),this._modules.settings.register("cursor.default",t4,this._applyCursorStyle),this._modules.dom.setLayer("graphics",this._domWrapper),this._engine.setGlobalBoundaries(e4),this._modules.dom.beforeNextFrame().then((()=>{this._initDone=!0,this._fireRendererStateChangeEvent()})),this._imageManager.onFetch((()=>{this._engine.notifyPatternUpdate(),this._modules.dom.refresh()})),this._fontManager.onFontLoaded((t=>{this._fontsNewlyLoaded.push(t),this._engine.notifyPatternUpdate(),this._engine.notifyFontsReloaded(),this._modules.dom.refresh()})),this._modules.dom.addMediaListener("(min-resolution: 2dppx)",(()=>this._modules.dom.refresh())),this._visibleAttributeLayer=this._attributesManager.addAttributeLayer({priority:0,name:`internal(${ey})`,tag:ey,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),this._dataAttributeLayer=this._attributesManager.addAttributeLayer({priority:0,name:`internal(${sy})`,tag:sy,nodeDependencies:void 0,edgeDependencies:void 0}),HS(this._engine,this._attributesManager.getFlexArrays()),this._modules.events.on("move",(()=>this._modules.dom.refresh())).on("frame",this._onNewFrame).on("viewExportStart",(()=>{this._renderOnNewFrame=!1})).on("viewExportEnd",(()=>{this._renderOnNewFrame=!0})).on("clearGraph",(()=>{this._nextGeIndex=1,this._availableGeIndexes=[],this._engine.clear(),this._attributesManager.clear(),this._modules.dom.refresh(),this._animations=[],this._nodeAnimationMap.clear(),this._edgeAnimationMap.clear()})).on("viewChanged",(({type:t})=>{if(t==="rotate"){const e=this._modules.graph.getEdges().filter((s=>s.getAttribute("adjustAnchors")));this._attributesManager.redrawElements(e)}})).on("addNodes",(t=>{this._attributesManager.updateForAllAttributeLayers(t.nodes)})).on("addEdges",(t=>{this._attributesManager.updateForAllAttributeLayers(t.edges)})).on("excludedStateChange",(t=>{this._visibleAttributeLayer.updateElements(t.elements)})).on("setData",(t=>{this._dataAttributeLayer.updateElements(t.elements)})),Qp.clearCachedInitData(),this._modules.dom.addWindowEventListener("unload",(()=>this.destroy()))}onReady(t){t.renderer!==void 0&&this._ogma.setOptions({renderer:t.renderer}),t.imgCrossOrigin!==void 0&&this._ogma.setOptions({imgCrossOrigin:t.imgCrossOrigin})}getTransparentBackgroundColor(){const t=this._modules.settings.get("backgroundColor");return t?this._engine.transparentify(t):null}pauseRendering(){this._renderOnNewFrame=!1}resumeRendering(){this._renderOnNewFrame=!0}_render(){const t=this._modules.dom.getDimensions(),e=this._modules.camera.getView(),s=mi(),n=$n(),i=this._modules.settings.get("backgroundColor"),r=this._isBufferDisplayable;this._engine.setView({x:e.x,y:e.y,zoom:e.zoom,angle:e.angle,width:t.width,height:t.height,pixelRatio:s,currentTime:n,backgroundColor:i,isBufferDisplayable:r});try{this._engine.render(),this._rendererState.state==="requested"&&this._updateRendererState({state:"ok"})}catch(o){if(this._debug)throw o;const{message:a,code:l="OTHER"}=o,u=this._rendererState.type,h=OD(u),g=`Error while initializing the ${h} renderer`,f=`The ${h} renderer encountered an unexpected runtime error`;let m=this._rendererState.state==="requested"?g:f,y=null;u==="webgl"&&(m+="; fallbacking on canvas renderer",y="canvas"),Uo(a||""),Uo(m),this._updateRendererState({state:"error",code:l,message:a}),this._modules.settings.set("renderer",y)}}_fireRendererStateChangeEvent(){const t=this._rendererState;this._modules.events.fire("rendererStateChange",{type:t.type,state:t.state,code:t.code,message:t.message})}_updateRendererState({type:t,state:e,code:s,message:n}){let i=!1;t!==void 0&&this._rendererState.type!==t&&(this._rendererState.type=t,i=!0),e!==void 0&&this._rendererState.state!==e&&(this._rendererState.state=e,i=!0),s!==void 0&&this._rendererState.code!==s&&(this._rendererState.code=s,i=!0),n!==void 0&&this._rendererState.message!==n&&(this._rendererState.message=n,i=!0),i&&this._initDone&&this._fireRendererStateChangeEvent()}getImageData(){return this._modules.dom.afterNextFrame().then((()=>this._engine.getImageData()))}getNodeAttributes(){return this._attributesManager.getFlexArrays().nodes.current}getEdgeAttributes(){return this._attributesManager.getFlexArrays().edges.current}getGraphicsEngine(){return this._engine}getImageManager(){return this._imageManager}getFontManager(){return this._fontManager}allocateGraphicsEngineBlockId(){return this._availableGeIndexes.length?this._availableGeIndexes.pop():this._nextGeIndex++*jf+Wz}releaseGraphicsEngineBlockId(t){this._engine.freeBlock(t),this._availableGeIndexes.push(t),this._modules.dom.refresh()}addCursorStyle(t){t&&(this._cursorStyle.push(t),this._applyCursorStyle())}removeCursorStyle(t){if(!t)return;const e=this._cursorStyle.lastIndexOf(t);e!==-1&&(this._cursorStyle.splice(e,1),this._applyCursorStyle())}reloadFonts(){this._modules.events.fire("reloadFonts"),this._engine.notifyFontsReloaded(),this._modules.dom.refresh()}getDomElement(){return this._domWrapper}setTextHidden(t,e){this._attributesManager.setTextHidden(t,e)}resetTextHidden(){this._attributesManager.resetTextHidden(),this._modules.dom.refresh()}getAttributesManager(){return this._attributesManager}_checkFontsNewlyLoaded(){return!!this._fontsNewlyLoaded.length&&(this._fontsNewlyLoaded=[],!0)}_loadGraphInGraphicsEngine(){this._attributesManager.update(),this._checkFontsNewlyLoaded()&&this._attributesManager.redrawAll(),this._modules.events.fire("beforeUpdateAttributes");const{elementsToRedraw:t,elementsUpdated:e}=this._attributesManager.getUpdatedElements(),s=e.nodes.size>0||e.edges.size>0;(e.nodeAttributesSet.has("radius")||e.edgeAttributes.includes("width"))&&(this._boundaries.maxSize=DD(this._modules.graph)),(e.nodeAttributesSet.has("shape")||e.edgeAttributes.includes("shape.head")||e.edgeAttributes.includes("shape.tail"))&&HS(this._engine,this._attributesManager.getFlexArrays()),cU({graph:this._modules.graph,elements:t,engine:this._engine,imageManager:this._imageManager,fontManager:this._fontManager,view:this._modules.camera.getView(),attributes:this._attributesManager.getFlexArrays(),boundaries:this._boundaries,formatText:this._formatText}),s&&this._modules.events.fire("updateAttributes",e)}_forceCompleteGraphRefresh(){this._attributesManager.redrawAll(),this._loadGraphInGraphicsEngine()}export(t,e,s,n){let i;return Promise.all([this._modules.graph.getNodes().addClass(wa),this._modules.graph.getEdges().addClass(wa)]).then((()=>this.resolveAtNextFrame())).then((()=>this._imageManager.whenReady())).then((()=>{s==="all"?(i=o4(this._modules.graph),this._forceCompleteGraphRefresh()):this._loadGraphInGraphicsEngine();const r=this._modules.camera.clone({...e});return this._modules.events.fire("viewExportStart",{preventOverlap:n.preventOverlap,camera:r,view:r.getView()}),this._ogma.view.afterNextFrame().then((()=>this._engine.export(t,e,n)))})).then((r=>Promise.all([this._modules.graph.getNodes().removeClass(wa),this._modules.graph.getEdges().removeClass(wa)]).then((()=>r)))).then((r=>(s==="all"&&(a4(i),this._forceCompleteGraphRefresh()),this._modules.events.fire("viewExportEnd"),r)))}addAttributeLayer(t){return this._attributesManager.addAttributeLayer(t)}getAttributeValues(t,e,s,n){return this._attributesManager.getAttributeValues(t,e,s,n)}forceAttributesComputation(){this._attributesManager.update()}resolveAtNextFrame(t){return this._modules.dom.afterNextFrame().then((()=>t))}isMoving(t){return(t.isNode?this._movingNodes:this._movingEdges).has(t._index)}animate(t,e,s,n){const i=i4(n);return i.duration&&this._engine.ensureAnimationsReady(),this._animate(t,e,s,i)}isAnimating(){return this._animations.length>0}getAnimationInformation(t){return this._attributesManager.getAnimationInformation(t)}_toSubGraph(t){if(t instanceof io||t instanceof ji)return{nodes:t.toList(),edges:t.getAdjacentEdges()};if(t instanceof Va||t instanceof so)return{nodes:this._modules.graph.nodeList(),edges:t.toList()};const e=t,s={nodes:e.nodes||this._modules.graph.nodeList(),edges:e.edges||this._modules.graph.edgeList()};return s.nodes.size&&(s.edges.size?s.edges=s.edges.concat(s.nodes.getAdjacentEdges()).dedupe():s.edges=s.nodes.getAdjacentEdges()),s}_animate(t,e,s,{duration:n,easing:i}){if((!this._animations.length||s)&&!n)return e(t),Promise.resolve(t);const r=this._toSubGraph(t),o=r.nodes,a=r.edges;if(o.size===0&&a.size===0)return e(t),Promise.resolve(t);if(o.size){if(s)for(let f=0;f<o._indexes.length;f++)this._movingNodes.add(o._indexes[f]);this._modules.events.fire("animate",{elements:o,duration:n,updatesPositions:s,easing:i})}if(a.size){if(s)for(let f=0;f<a._indexes.length;f++)this._movingEdges.add(a._indexes[f]);this._modules.events.fire("animate",{elements:a,duration:n,updatesPositions:s,easing:i})}const l={id:this._nextAnimationId++,startTime:$n(),finished:!1,func:()=>e(t),duration:n,easing:i,nodes:o,edges:a,started:!1,updatesPositions:s,resolve:os};let u=l;const h=new Set;if(u=this._getLongestAnimation(u,l.nodes,h),u=this._getLongestAnimation(u,l.edges,h),u.updatesPositions){for(let f=0;f<o._indexes.length;f++)this._nodeAnimationMap.set(o._indexes[f],u);for(let f=0;f<a._indexes.length;f++)this._edgeAnimationMap.set(a._indexes[f],u);l.duration=u.duration,l.startTime=u.startTime}if(l.duration===0&&u.id===l.id)return e(t),Promise.resolve(t);const g=new Promise((f=>l.resolve=()=>f(t)));return this._animations.push(l),this._modules.dom.refresh(),n||this._processAnimations(),g}_removeFinishedAnimations(){this._animations=this._animations.filter((t=>!t.finished))}_getAnimationElements(t){return{nodes:t.nodes,edges:t.edges}}_resetAnimationAttributes({nodes:t,edges:e}){this._attributesManager.resetAnimationAttributes({nodes:t,edges:e});for(let s=0;s<t._indexes.length;s++)this._nodeAnimationMap.delete(t._indexes[s]),this._movingNodes.delete(t._indexes[s]);for(let s=0;s<e._indexes.length;s++)this._edgeAnimationMap.delete(e._indexes[s]),this._movingEdges.delete(t._indexes[s])}_getLongestAnimation(t,e,s){const n=e.isNode?this._nodeAnimationMap:this._edgeAnimationMap;for(let i=0;i<e._indexes.length;i++){const r=n.get(e._indexes[i]);r&&!s.has(r.id)&&(s.add(r.id),(t.updatesPositions||!r.updatesPositions)&&r.duration+r.startTime<t.duration+t.startTime||(t=r))}return t}_processAnimations(){if(!this._animations.length)return;const t=$n(),e=[];this._attributesManager.update();for(const s of this._animations)s.started||(s.started=!0,e.push(s.func),this._attributesManager.setAnimationAttributes(this._getAnimationElements(s),s));for(const s of e)s();for(const s of this._animations)t>=s.startTime+s.duration&&(this._resetAnimationAttributes(this._getAnimationElements(s)),s.resolve(s.elements),s.finished=!0);this._removeFinishedAnimations(),this._animations.length&&this._modules.dom.refresh()}hideTexts(){this.setNodeTextsVisibility(!1),this.setEdgeTextsVisibility(!1)}showTexts(){this.setNodeTextsVisibility(!0),this.setEdgeTextsVisibility(!0)}setNodesVisibility(t){return this._updateVisibilityCounter("nodes",t)}setNodeTextsVisibility(t){return this._updateVisibilityCounter("nodeTexts",t)}setEdgesVisibility(t){return this._updateVisibilityCounter("edges",t)}setEdgeTextsVisibility(t){return this._updateVisibilityCounter("edgeTexts",t)}_updateVisibilityCounter(t,e){this._visibility[t]+=e?-1:1,this._modules.dom.refresh()}detectNode(t,e,s,n,i,r){return PD(t,e,s,n,i,r,this._modules.graph,this._attributesManager,this._modules.camera,this._engine,this._movingNodes,this._formatText)}detectEdge(t,e,s,n,i){const{bentEnable:r,bentVertical:o}=this._modules.graphics.getGraphicsEngine().getBentEdges();return zD(t,e,s,n,i,this._modules.graph,this._modules.camera,this._movingNodes,this._attributesManager,r,o)}getVisibilityCounters(){return this._visibility}destroy(){this.getGraphicsEngine().destroy(),this.getImageManager().destroy(),this.getFontManager().destroy()}};function i4(t){return typeof t=="number"?t={duration:t}:typeof t=="object"&&t!==null||(t={duration:0}),{duration:r4(t.duration),easing:t.easing||"linear",chain:!!t.chain}}function r4(t){return typeof t!="number"||!isFinite(t)||t<0?0:t}function i1(t,e){const s=e?t.getNodeAttribute("excluded"):t.getEdgeAttribute("excluded"),n=(e?t.getNodes("all"):t.getEdges("all"))._indexes,i=s.getMultiple(n);return s.fill(n,0),{excludedList:s,indexes:n,values:i}}function r1({excludedList:t,indexes:e,values:s}){t.setMultiple(e,s)}function o4(t){return{nodes:i1(t,!0),edges:i1(t,!1)}}function a4({nodes:t,edges:e}){r1(t),r1(e)}var l4=180,u4=50,d4=class extends Ke{constructor(){super(...arguments),this._onAnyEvents=[],this._registeredEvents={},this.onIdle=Vd((()=>this.fire("idle")),u4),this.fireIdle=Dw(this.onIdle,l4)}onMounted(){this._registeredEvents={},this.register(["idle"]),this._ogma.onReady((()=>{this.on(["viewChanged","layoutEnd","addNodes","addEdges","removeNodes","removeEdges","animate","setMultipleAttributes","transformationRefresh"],this.fireIdle)}))}isRegistered(t){return!!this._registeredEvents[t]}register(t,e=[]){t.forEach((s=>{this._registeredEvents[s]||(this._registeredEvents[s]=new h4(!1,s))}))}onAnyEvent(t){this._onAnyEvents.push(t)}on(t,e){return Array.isArray(t)?(t.forEach((s=>this.on(s,e))),this):this._registeredEvents[t]?(this._registeredEvents[t].on(e),this):this}off(t){return Object.values(this._registeredEvents).forEach((e=>e.off(t))),this}fire(t,e=null){const s=this._getEvent(t);return this._onAnyEvents.forEach((n=>n(e,t))),s.trigger(e),this}once(t,e){return Array.isArray(t)?(t.forEach((s=>this.once(s,e))),this):this._registeredEvents[t]?(this._registeredEvents[t].once(e),this):this}_getEvent(t){if(!(t in this._registeredEvents))throw new Error(`Event ${t} does not exist`);return this._registeredEvents[t]}destroy(){Object.values(this._registeredEvents).forEach((t=>{t.destroy()}))}},h4=class{constructor(t,e){this._subscribers=[],this._handlers=[],this._onceWrappers=new WeakMap,this._reverseOrder=t,this._name=e}trigger(t){for(const e of this._handlers)e(t,this._name);return this}on(t){if(typeof t!="function")throw new Error("handler is not a function");const e=this._reverseOrder?0:this._subscribers.length;return this._handlers.splice(e,0,t),this._subscribers.splice(e,0,t),this}once(t){if(typeof t!="function")throw new Error("handler is not a function");const e=this,s=function(){t.apply(null,arguments),e.off(s)};return this._onceWrappers.set(t,s),this.on(s),this}off(t){const e=this._onceWrappers.get(t),s=e||t;let n;for(;(n=this._subscribers.indexOf(s))!==-1;)this._subscribers.splice(n,1),this._handlers.splice(n,1);return e&&this._onceWrappers.delete(t),this}destroy(){this._subscribers=[],this._handlers=[]}},c4=class extends Ke{onMounted(){this._graphics=this._modules.graphics,this._modules.events.register(["setMultipleAttributes"]),this._modules.events.on(["addNodes","addEdges"],(({nodes:t,edges:e,objects:s})=>{this._onAddElements(t||e,s)})),this._originalAttributesLayer=this._graphics.addAttributeLayer({name:"original-attributes",priority:az,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),this._individualAttributesLayer=this._graphics.addAttributeLayer({name:"individual-attributes",priority:dz,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0})}_onAddElements(t,e){const s=e.map((n=>n.attributes));this._originalAttributesLayer.setAttributeValues(t,s)}getOriginalAttributes(){return this._originalAttributesLayer.getFlexArrays()}getIndividualAttributes(){return this._individualAttributesLayer.getFlexArrays()}setMultipleAttributes(t,e,s){const n=Array.isArray(e)?e.length&&e[0]?pf(e[0],t.isNode):[]:pf(e,t.isNode),i=n.includes("x")||n.includes("y"),r=[];return this._modules.events.fire("setMultipleAttributes",{elements:t,values:e,updatedAttributes:n,options:s,promises:r}),this._graphics.animate(t,(()=>{this._individualAttributesLayer.setAttributeValues(t,e)}),i,s).then((o=>Promise.all(r).then((()=>o))))}setSingleAttribute(t,e,s,n){const i={};return Kr(i,e,s),this.setMultipleAttributes(t,i,n)}resetMultipleAttributes(t,e,s){const n=e||this._individualAttributesLayer.getUsedAttributeNames(t),i=n&&(n.includes("x")||n.includes("y")),r={};for(const o of n)Kr(r,o,void 0);return this._graphics.animate(t,(()=>{this._individualAttributesLayer.setAttributeValues(t,r)}),i,s)}getMultipleAttributes(t,e){return this._graphics.getAttributeValues(t,e,!0,!1)}getSingleAttribute(t,e){return this._graphics.getAttributeValues(t,e,!1,!1)}replaceOriginalAttributes(t,e,s=[]){const n={},i=this._originalAttributesLayer.getUsedAttributeNames(t).filter((r=>!s.includes(r)));for(let r=0;r<i.length;++r)Kr(n,i[r],void 0);this._originalAttributesLayer.setAttributeValues(t,n),this._originalAttributesLayer.setAttributeValues(t,e)}getSinglePreviousAttribute(t,e){return this._graphics.getAttributeValues(t,e,!1,!0)}getMultiplePreviousAttributes(t,e){return this._graphics.getAttributeValues(t,e,!0,!0)}},g4=class extends Ke{constructor(){super(...arguments),this._currentValue={},this._onChange={},this._defaultValues={},this._keys=[]}onReady(t){t.renderer&&this.update({renderer:t.renderer}),t.options&&this.update(t.options)}register(t,e,s,n){return n===void 0&&(n=!0),this._keys.push(t),this._currentValue[t]=e,this._defaultValues[t]=e,this._onChange[t]=s||os,s&&n&&s(e),this}update(t){t=jd(t);const e=this._keys,s={},n=this._currentValue;for(let r=0;r<e.length;++r){const o=e[r];if(o in t){let a=t[o];a===void 0&&(a=this._defaultValues[o]),s[o]=n[o],n[o]=a}}const i=Object.keys(s);for(let r=0;r<i.length;++r){const o=i[r],a=this._currentValue[o],l=s[o];a!==l&&this._onChange[o](a,l)}return D_(s)}get(t){return arguments.length===0?D_(this._currentValue):this._currentValue[t]}set(t,e){const s=this._currentValue[t],n=this._onChange[t];this._currentValue[t]=e,n&&n(e,s)}},f4=class{constructor(t,e){this._classes=t,this._name=e}getName(){return this._name}getIndex(){return this._classes.getIndex(this._name)}setIndex(t){return this._classes.setIndex(this._name,t)}update(t){return this._classes.update(this._name,t),this}getDefinition(){return this._classes.getDefinition(this._name)}getNodes(t){return this._classes.getElementsByClass(this._name,t).nodes}getEdges(t){return this._classes.getElementsByClass(this._name,t).edges}clearNodes(t){this.getNodes(t).removeClass(this._name)}clearEdges(t){this.getEdges(t).removeClass(this._name)}add(t){t.addClass(this._name)}remove(t){t.removeClass(this._name)}destroy(){const t=this._classes.getElementsByClass(this._name);return Promise.all([t.nodes.removeClass(this._name),t.edges.removeClass(this._name)]).then((()=>this._classes.removeClass(this._name)))}},m4=1e3,p4=.5/m4,_4=class extends Ke{constructor(){super(...arguments),this._builtinClasses=[],this._userClasses=[],this._classesByName={},this._onExcludedStateChange=({elements:t,value:e})=>{if(e){const s=this._builtinClasses.map((n=>n.name));this._addOrRemoveClassesToElements(s,t,!1)}},this._onClearGraph=()=>{this._builtinClasses.concat(this._userClasses).forEach((t=>t.elementSet.clear()))},this._onRemoveElements=({nodes:t,edges:e})=>{const s=t||e;this._builtinClasses.concat(this._userClasses).forEach((n=>n.elementSet.removeElements(s)))}}onMounted(){this._modules.events.on("excludedStateChange",this._onExcludedStateChange).on("clearGraph",this._onClearGraph).on("removeEdges",this._onRemoveElements).on("removeNodes",this._onRemoveElements)}_getClassList(t){return t?this._builtinClasses:this._userClasses}createClass({name:t,isBuiltin:e=!1,after:s,nodeAttributes:n,nodeDependencies:i,nodeOutput:r,edgeAttributes:o,edgeDependencies:a,edgeOutput:l}={}){if(typeof t!="string")throw new Error('the "name" argument should be a string');const u=this._getClassList(e),h=s?y4(u,s)+1:u.length;if(h===-1)throw new Error(`createClass: class specified as \`after\` parameter "${s}" does not exist`);if(e&&!t.startsWith("_"))throw new Error(`invalid builtin class name "${t}": builtin classes should start with '_'`);const g=new Ah(this._modules.graph),f=new f4(this,t),m={name:t,elementSet:g,attributeLayer:this._modules.graphics.addAttributeLayer({name:`class(${t})`,tag:t,standaloneSelectors:!0,nodeAttributes:n||void 0,edgeAttributes:o||void 0,nodeSelector:(y,p)=>p.hasElement(y),edgeSelector:(y,p)=>p.hasElement(y),nodeContext:g,edgeContext:g,nodeOutput:r,edgeOutput:l,nodeDependencies:i,edgeDependencies:a}),isBuiltin:e,wrapper:f};return u.splice(h,0,m),e&&u.sort(((y,p)=>FE.indexOf(y.name)-FE.indexOf(p.name))),this._updatePriorities(e),this._classesByName[t]=m,this._modules.events.register([Cl(t,!0,!0),Cl(t,!0,!1),Cl(t,!1,!0),Cl(t,!1,!1)]),f}removeClass(t){const e=this._get(t),s=this._getClassList(e.isBuiltin),n=s.indexOf(e);return n!==-1&&(s.splice(n,1),e.attributeLayer.destroy(),delete this._classesByName[t],this._updatePriorities(e.isBuiltin)),Promise.resolve(void 0)}_updatePriorities(t){const e=this._getClassList(t),s=hz+(t?.5:0);for(let n=0;n<e.length;++n){const i=e[n],r=s+p4*n;i.attributeLayer.update({priority:r})}}_get(t){const e=this._classesByName[t];if(!e)throw new Error(`class "${t}" does not exist`);return e}getIndex(t){const e=this._get(t);return this._getClassList(e.isBuiltin).indexOf(e)}setIndex(t,e){const s=this._get(t),n=this._getClassList(s.isBuiltin),i=n.indexOf(s),r=$i(e,0,n.length-1);n.splice(i,1),n.splice(r,0,s),this._updatePriorities(s.isBuiltin)}update(t,{nodeAttributes:e,edgeAttributes:s,nodeDependencies:n,edgeDependencies:i,nodeOutput:r,edgeOutput:o,fullOverwrite:a}={}){this._get(t).attributeLayer.update({nodeAttributes:e,edgeAttributes:s,nodeDependencies:n,edgeDependencies:i,nodeOutput:r,edgeOutput:o,fullOverwrite:a})}getDefinition(t){const e=this._get(t),{nodeAttributes:s,nodeDependencies:n,nodeOutput:i,edgeAttributes:r,edgeDependencies:o,edgeOutput:a}=e.attributeLayer.getDefinition();return{nodeAttributes:s||void 0,edgeAttributes:r||void 0,nodeDependencies:n,edgeDependencies:o,nodeOutput:i,edgeOutput:a}}_addOrRemoveClassesToElements(t,e,s){const n=e.isNode;for(let i=0;i<t.length;++i){const r=t[i],{elementSet:o,attributeLayer:a}=this._get(r),l=o.addOrRemoveElements(e,s),u=Cl(r,n,s);l.size&&(a.updateElements(l),this._modules.events.fire(u,n?{nodes:l}:{edges:l}))}}_animatedAttributesUpdatePositions(t,e){for(let s=0;s<t.length;++s){const n=t[s],i=this.getDefinition(n);if(e.isNode&&i.nodeAttributes&&(i.nodeAttributes.x||i.nodeAttributes.y))return!0}return!1}_getAnimatedAtrributes(t,e){return t.reduce(((s,n)=>{const i=this.getDefinition(n);return e.isNode&&i.nodeAttributes&&s.push(...pf(i.nodeAttributes,!0)),!e.isNode&&i.edgeAttributes&&s.push(...pf(i.edgeAttributes,!1)),s}),[])}addClassesToElements(t,e,s){const n=e.toList(),i=this._animatedAttributesUpdatePositions(t,n);return this._modules.graphics.animate(e,(()=>{this._addOrRemoveClassesToElements(t,n,!0)}),i,s)}removeClassesFromElements(t,e,s){const n=e.toList(),i=this._animatedAttributesUpdatePositions(t,n);return this._modules.graphics.animate(e,(()=>{this._addOrRemoveClassesToElements(t,n,!1)}),i,s)}hasSingleElementClass(t,e){return!!this._classesByName[t]&&this._get(t).elementSet.hasElement(e)}getElementsClassList(t,e={}){const{includeBuiltinClasses:s=!1}=e,n=new Array(t.size);for(let i=0;i<n.length;++i)n[i]=[];return this._addClassNamesToList(n,t,this._userClasses),s&&this._addClassNamesToList(n,t,this._builtinClasses),n}_addClassNamesToList(t,e,s){const n=e.toList();for(let i=0;i<s.length;++i){const{name:r,elementSet:o}=s[i];for(let a=0;a<n.size;++a){const l=n.get(a);o.hasElement(l)&&t[a].push(r)}}}getClassByName(t,e=!1){const s=this._classesByName[t]||null;if(e&&!s)throw new Error(`class "${t}" does not exist`);return s&&s.wrapper}getClassList(){return this._userClasses.map((t=>t.wrapper))}getElementsByClass(t,e="visible"){const{elementSet:s}=this._get(t),n=s.getElements();let i=n.nodes,r=n.edges;return e==="visible"?(i=i.filter((o=>o.isVisible())),r=r.filter((o=>o.isVisible()))):e==="raw"&&(i=i.filter((o=>!o.isVirtual())),r=r.filter((o=>!o.isVirtual()))),{nodes:i,edges:r}}_onClassEvent(t,e,s,n){const i=Cl(t,s,n);this._modules.events.on(i,e)}onNodeClassAdded(t,e){this._onClassEvent(t,e,!0,!0)}onNodeClassRemoved(t,e){this._onClassEvent(t,e,!0,!1)}onEdgeClassAdded(t,e){this._onClassEvent(t,e,!1,!0)}onEdgeClassRemoved(t,e){this._onClassEvent(t,e,!1,!1)}};function Cl(t,e,s){return`${e?"node":"edge"}Class${s?"Added":"Removed"}_${t}`}function y4(t,e){for(let s=0;s<t.length;++s)if(t[s].name===e)return s;return-1}var x4=Rw(Fw()),uN=()=>({x:0,y:0,x1:0,y1:0,x2:0,y2:0});function o1(t,e,s,{cells:n=!0,boxes:i=!0,query:r=!0}={}){const o=e.keys().map((l=>e.keyToBBox(Number(l)))),a=e.getBoxes();if(n&&(t.beginPath(),t.lineWidth=1,t.strokeStyle="#707070",o.forEach((l=>{t.rect(l[0],l[1],l[2]-l[0],l[3]-l[1])})),t.stroke()),i&&(t.beginPath(),t.lineWidth=1,t.strokeStyle="#ff7070",a.forEach((l=>{t.rect(l[0],l[1],l[2]-l[0],l[3]-l[1])})),t.closePath(),t.stroke()),r&&s){const l=s;t.beginPath(),t.lineWidth=2,t.strokeStyle="#3030ff",t.rect(l[0],l[1],l[2]-l[0],l[3]-l[1]),t.closePath(),t.stroke()}}function v4(t){const[e,s,n]=t.getNodeAttributes(["x","y","radius"]),[i,r,o]=t.getEdgeAttributes(["source","target","curvature"]),a=uN(),l=Wx();return u=>{if(u<0){u=-u;const h=i.get(u),g=r.get(u),f=o.get(u),m=e.get(h),y=s.get(h),p=e.get(g),x=s.get(g);h===g?($f(m,y,f,n.get(h),0,a),Wf(m,y,a.x1,a.y1,a.x2,a.y2,p,x,l)):f===0?(l.minX=Math.min(m,p),l.minY=Math.min(y,x),l.maxX=Math.max(m,p),l.maxY=Math.max(y,x)):(ja(m,y,p,x,f,a),Zx(m,y,a.x,a.y,p,x,l))}else{const h=e.get(u),g=s.get(u),f=n.get(u);l.minX=h-f,l.minY=g-f,l.maxX=h+f,l.maxY=g+f}return[l.minX,l.minY,l.maxX,l.maxY]}}var b4=["x","y","radius"],E4=["width","curvature"],S4=.5,a1=1,l1=128,u1=4,d1=16,A4=1e4,w4=class extends Ke{constructor(){super(...arguments),this._minCellSize=d1,this._clear=()=>{this._index.clear(),this._elementsToUpdate.clear()},this._onGraphUpdate=t=>{if(t.nodes&&(!t.nodeAttributes||t.nodeAttributes.some((e=>b4.includes(e))))){const e=t.nodes.fastGetAdjacentElements().edges;this._elementsToUpdate.addElements(t.nodes),this._elementsToUpdate.addElements(e)}t.edges&&(t.edgeAttributes&&!t.edgeAttributes.some((e=>E4.includes(e)))||this._elementsToUpdate.addElements(t.edges))}}onMounted(){this._index=new x4.HGrid(this._getIntersector(),v4(this._modules.graph),this._minCellSize,1e6),this._elementsToUpdate=new Ah(this._modules.graph),this._removedNodes=this._modules.graph.getNodeAttribute("removed"),this._removedEdges=this._modules.graph.getEdgeAttribute("removed"),this._excludedNodes=this._modules.graph.getNodeAttribute("excluded"),this._excludedEdges=this._modules.graph.getEdgeAttribute("excluded"),this._queryResult={edges:[],nodes:[]},this._queryBounds=[0,0,0,0],this._modules.events.on(["addNodes","addEdges","removeNodes","removeEdges","updateAttributes"],this._onGraphUpdate).on("excludedStateChange",(({elements:t})=>{this._elementsToUpdate.addElements(t)})).on("clearGraph",this._clear)}_getIntersector(){const t=this._modules.graph,[e,s,n]=t.getNodeAttributes(["x","y","radius"]),[i,r,o,a]=t.getEdgeAttributes(["source","target","width","curvature"]),l=uN(),u=this._modules.camera.getAngle(),h=Math.cos(u),g=Math.sin(u);return(f,m,y,p,x)=>{const{bentEnable:v,bentVertical:b}=this._modules.graphics.getGraphicsEngine().getBentEdges();if(f<0){f=-f;const S=i.get(f),A=r.get(f),w=a.get(f),L=o.get(f)/2,k=e.get(S),F=s.get(S),O=e.get(A),j=s.get(A);return v?(qf(k*h-F*g,F*h+k*g,O*h-j*g,j*h+O*g,w,v,b,l),py(k,F,l.x1*h+l.y1*g,l.y1*h-l.x1*g,l.x2*h+l.y2*g,l.y2*h-l.x2*g,O,j,m-L,y-L,p+L,x+L)):S===A?($f(k,F,w,n.get(S),0,l),py(k,F,l.x1,l.y1,l.x2,l.y2,O,j,m-L,y-L,p+L,x+L)):w===0?Kx(k,F,O,j,m-L,y-L,p+L,x+L):(ja(k,F,O,j,w,l),tC(k,F,l.x,l.y,O,j,m-L,y-L,p+L,x+L))}return kx(e.get(f),s.get(f),n.get(f),m,y,p,x)}}reindex(){this._modules.graphics.forceAttributesComputation(),this._index.clear(),this._elementsToUpdate.clear(),this._updateItems(this._modules.graph.getNodes("all")._indexes,this._modules.graph.getEdges("all")._indexes)}getSize(){return this._index.size}_updateIndex(){if(this._elementsToUpdate.isEmpty())return;const{nodes:t,edges:e}=this._elementsToUpdate.getElements(),s=t._indexes.length,n=this._modules.graph.getNodes("all").size;let i=!1;if(this._index.averageCellOccupancy<a1)for(;this._index.averageCellOccupancy<a1&&this._minCellSize<A4;)this._minCellSize=this._minCellSize*u1,this._index.setMinCellSize(this._minCellSize),this.reindex(),i=!0;if(!i&&this._index.averageCellOccupancy>l1)for(;this._index.averageCellOccupancy>l1&&this._minCellSize>d1;)this._minCellSize=this._minCellSize/u1,this._index.setMinCellSize(this._minCellSize),this.reindex(),i=!0;!i&&s/n>S4&&this.reindex(),this._updateItems(t._indexes,e._indexes),this._elementsToUpdate.clear()}_updateItems(t,e){const s=this._index,n=this._removedNodes,i=this._removedEdges,r=this._excludedNodes,o=this._excludedEdges,a=[],l=[];if(n&&r)for(let u=0;u<t.length;u++){const h=t[u];n.get(h)!==0||r.get(h)!==0?a.push(h):(s.has(h)&&a.push(h),l.push(h))}if(i&&o)for(let u=0;u<e.length;u++){const h=-e[u];i.get(-h)!==0||o.get(-h)!==0?a.push(h):(s.has(h)&&a.push(h),l.push(h))}for(const u of a)s.remove(u);for(const u of l)s.insert(u)}getNodesInScreenByDistance(t){const{x:e,y:s}=t.getPositionOnScreen();return this._modules.graph.getNodes().filter((n=>n.isInScreen()&&n!==t)).sort(((n,i)=>{const r=n.getPositionOnScreen(),o=i.getPositionOnScreen();return pn(r.x,r.y,e,s)-pn(o.x,o.y,e,s)}))}getNearestNodesForNode(t,e=240,s){const{x:n,y:i}=t.getPosition();return this.getNearestNodes(n,i,e,s,t)}getNearestNodes(t,e,s,n,i){if(this._updateIndex(),n){const r=this._modules.camera.screenToGraphVector({x:s,y:s});s=pn(0,0,r.x,r.y)}return this._getNearestNodes(t,e,s,i)}_getNearestNodes(t,e,s,n){const i=[],r=s*s,o=n?n._index:0,a=this._modules.graph.getNodes()._indexes,[l,u]=this._modules.graph.getNodeAttributes(["x","y"]);for(let h=0,g=a.length;h<g;h++){const f=a[h];if(f===o)continue;const m=t-l.get(f),y=e-u.get(f);m*m+y*y<=r&&i.push(f)}return this._modules.graph.nodeList(new Uint32Array(i))}queryRaw(t,e,s,n){this._updateIndex();const i=this._queryBounds;i[0]=t,i[1]=e,i[2]=s,i[3]=n;const r=this._index.query(t,e,s,n),{nodes:o,edges:a}=this._queryResult;o.length=a.length=0;for(let l=0;l<r.length;l++){const u=r[l];u<0?a.push(-u):o.push(u)}return this._queryResult}queryRawProjected(t,e,s,n){const i=this._queryBounds;i[0]=t,i[1]=e,i[2]=s,i[3]=n,this._modules.camera.projectBounds(i);const r=this.queryRaw(i[0],i[1],i[2],i[3]);return this._modules.labels.query(i[0],i[1],i[2],i[3],r),r}query(t,e,s,n){const i=this._modules.graph,{nodes:r,edges:o}=this.queryRaw(t,e,s,n);return{nodes:i.nodeList(new Uint32Array(r.slice())),edges:i.edgeList(new Uint32Array(o.slice()))}}queryProjected(t,e,s,n){const i=this._modules.graph,{nodes:r,edges:o}=this.queryRawProjected(t,e,s,n);return{nodes:i.nodeList(new Uint32Array(r)),edges:i.edgeList(new Uint32Array(o))}}getNodesByBoundingBox(t,e,s,n,i){if(this._updateIndex(),i){let g;g=this._modules.camera.screenToGraphVector({x:t,y:e}),t=g.x,e=g.y,g=this._modules.camera.screenToGraphVector({x:s,y:n}),s=g.x,n=g.y}const r=this._modules.graph,o=r.getNodes()._indexes,a=[],l=r.getNodeAttribute("excluded"),[u,h]=r.getNodeAttributes(["x","y"]);for(let g=0,f=o.length;g<f;g++){const m=o[g];if(l&&l.get(m))continue;const y=u&&u.get(m),p=h&&h.get(m);y>=t&&y<=s&&p>=e&&p<=n&&a.push(m)}return r.nodeList(new Uint32Array(a))}toggleDebug(t){t?(this._layer=this._modules.layers.addCanvasLayer((e=>{o1(e,this._index,this._queryBounds)}),{isStatic:!1,noClear:!1}),this._layer.moveToTop()):this._layer&&(this._layer.destroy(),this._layer=null)}renderDebug(t){if(!this._layer)return this.toggleDebug(!0);this._layer.refresh((e=>{o1(e,this._index,this._queryBounds,t)}))}},dN={};function Qf(t,e,s,n,i=0,r=Math.sin(i),o=Math.cos(i),a=[0,0,0,0]){const l=s/2,u=n/2,h=t+l,g=e+u;if(i===0)return a[0]=t,a[1]=e,a[2]=t+s,a[3]=e+n,a;let f,m,y,p,x,v,b,S;return y=-l,p=-u,f=h+y*o-p*r,m=g+y*r+p*o,x=b=f,v=S=m,y=-l,p=u,f=h+y*o-p*r,m=g+y*r+p*o,f<x?x=f:f>b&&(b=f),m<v?v=m:m>S&&(S=m),y=l,p=u,f=h+y*o-p*r,m=g+y*r+p*o,f<x?x=f:f>b&&(b=f),m<v?v=m:m>S&&(S=m),y=l,p=-u,f=h+y*o-p*r,m=g+y*r+p*o,f<x?x=f:f>b&&(b=f),m<v?v=m:m>S&&(S=m),a[0]=x,a[1]=v,a[2]=b,a[3]=S,a}function wh(t,e,s,n,i=0){const r=s/2,o=n/2,a=t+r,l=e+o;if(i===0)return[{x:t,y:e},{x:t+s,y:e},{x:t+s,y:e+n},{x:t,y:e+n}];const u=Math.sin(i),h=Math.cos(i);let g,f,m,y;m=-r,y=-o,g=a+m*h-y*u,f=l+m*u+y*h;const p={x:g,y:f};m=-r,y=o,g=a+m*h-y*u,f=l+m*u+y*h;const x={x:g,y:f};m=r,y=o,g=a+m*h-y*u,f=l+m*u+y*h;const v={x:g,y:f};return m=r,y=-o,g=a+m*h-y*u,f=l+m*u+y*h,[p,x,v,{x:g,y:f}]}function Fy(t,e=0,s=1,n=KT.slice()){const i=s*Math.sin(e),r=s*Math.cos(e);return n[0]=t[0]+i,n[1]=t[1]+r,n[2]=t[2]+i,n[3]=t[3]+r,n}function T4(t,e){return JT(t,e)}function C4(t,e){return hN(t[0],t[1],t[2],t[3],e[0],e[1],e[2],e[3])}function L4(t,e,s,n,i,r,o,a){return t>i&&t<o&&e>r&&e<a||s>i&&s<o&&n>r&&n<a}function hN(t,e,s,n,i,r,o,a){return n>=r&&e<=a&&s>=i&&t<=o}hh(dN,{angle:()=>ND,circleCircleIntersection:()=>Mx,circleContainsCircle:()=>pP,circleContainsPoint:()=>mP,circleIntersectsBox:()=>kx,circleLineIntersection:()=>t2,circleSortCompare:()=>Ix,computeCentroid:()=>mU,cubicBezierAABB:()=>py,defaultAABB:()=>KT,degreesToRadians:()=>fP,distToSegmentSquared:()=>Qx,distance:()=>pn,distancePointSegment:()=>rC,extendBounds:()=>JT,getAABB:()=>Qf,getBentEdgesControlPoints:()=>qf,getBezierCurveBoundingBox:()=>Wf,getClosestPointOnLine:()=>ID,getClosestPointOnSegment:()=>oC,getNormalOnEdge:()=>wD,getNormalOnQuadraticCurve:()=>eC,getOBBPoints:()=>wh,getPointOnBezierCurve:()=>Zd,getPointOnEdge:()=>AD,getPointOnQuadraticCurve:()=>Yf,getQuadraticBezierCurveLength:()=>CD,getQuadraticCurveBoundingBox:()=>Zx,getQuadraticCurveControlPoint:()=>ja,getSelfLoopControlPoints:()=>$f,getTangentOnEdge:()=>TD,getTangentOnQuadraticCurve:()=>Xx,intersects:()=>L4,isPointInLine:()=>nC,isPointInPolygon:()=>Qd,isPointOnBezierCurve:()=>_y,isPointOnQuadraticCurve:()=>sC,lineAABB:()=>Kx,lineAngle:()=>au,lineIntersection:()=>MD,lineLine:()=>$l,minDisk:()=>_h,move:()=>gP,moveAABB:()=>Fy,normalize:()=>QT,overlaps:()=>hN,overlapsAABB:()=>C4,padBounds:()=>T4,polygonsIntersect:()=>FC,quadBezierAABB:()=>tC,radiansToDegrees:()=>J_,rotate:()=>nf,segmentIntersection:()=>fd,segmentRectangleIntersection:()=>iC,squaredDistance:()=>Ig,twoSegmentsIntersect:()=>LD});var dg=40;function cN(t,e){const s=t.getAttribute("curvature"),n=t.getSource(),i=t.getTarget(),r=n.getPositionOnScreen();if(n===i){const p=(s+n.getAttribute("radius"))*hf*e,x=r.x,v=r.y,b=x-p,S=v,A=x,w=v+p;return[r,...[.2,.4,.6,.8].map((L=>Zd(L,x,v,x,v,b,S,A,w))),r]}const o=i.getPositionOnScreen();if(s===0)return[r,o];const a=o.x-r.x,l=o.y-r.y,u=Math.sqrt(a*a+l*l),h=(r.x+o.x)/2,g=(r.y+o.y)/2,f=s*(u/Uf)*2,m=h+l/u*f,y=g+-a/u*f;return[r,...[.25,.5,.75].map((p=>Yf(p,r.x,r.y,o.x,o.y,m,y))),o]}function N4(t,e,s){const n=t.getSource(),i=t.getTarget(),r=n.getPositionOnScreen(),o=i.getPositionOnScreen();if(Qd(r.x,r.y,e)||Qd(o.x,o.y,e))return!0;const a=cN(t,s);for(let l=0;l<a.length-1;++l){const u=a[l],h=a[l+1];for(let g=0;g<e.length-1;++g){const f=e[g],m=e[g+1];if($l(u.x,u.y,h.x,h.y,f.x,f.y,m.x,m.y))return!0}}return!1}function M4(t,e,s){const n=t.getPositionOnScreen(),i=Number(t.getAttribute("radius"))*s;return gN(n.x,n.y,i,e)}function gN(t,e,s,n){const i=t-s,r=e-s,o=e+s;return t+s>=n.minX&&i<=n.maxX&&o>=n.minY&&r<=n.maxY}function I4(t,e,s){const n=cN(t,s);for(let i=0;i<n.length-1;++i){const r=n[i],o=n[i+1];if(Kx(r.x,r.y,o.x,o.y,e.minX,e.minY,e.maxX,e.maxY))return!0}return!1}function h1(t,e,s,n){typeof s=="number"&&(s={left:s,right:s,top:s,bottom:s});const i=s.left===void 0?dg:s.left,r=s.right===void 0?dg:s.right,o=s.top===void 0?dg:s.top,a=s.bottom===void 0?dg:s.bottom,l=i+r,u=o+a,h=t.width===0?t.maxFixedSize:t.width,g=t.height===0?t.maxFixedSize:t.height,f=K3([(e.width-l)/(h+t.maxScaledSize),(e.height-u)/(g+t.maxScaledSize),(e.width-l-t.maxFixedSize)/h,(e.height-u-t.maxFixedSize)/g,n/t.maxScaledSize||NaN]);return{x:t.cx+(r-i)/(2*f),y:t.cy+(a-o)/(2*f),zoom:f}}var k4="cubicOut",c1=200,R4=class extends Ke{constructor(){super(...arguments),this._isLocating=!1,this._cacheValid=!0,this._cachedGraphBoundingBox=new ii,this._onLocateStart=()=>{this._isLocating=!0},this._onLocated=()=>{this._isLocating=!1,this._modules.events.fire("locate")},this._invalidCache=()=>{this._cacheValid=!1}}onMounted(){this._modules.events.register(["locate"]),this._modules.events.on(["addNodes","removeNodes","addEdges","removeEdges","excludedStateChange","clearGraph","updateAttributes"],this._invalidCache)}onReady(){this.locateGraph({},!0)}locateGraph(t,e=!1){return this._onLocateStart(),e?this._locateGraph(t):this._modules.transformations.whenApplied().then((()=>this._locateGraph(t)))}_locateGraph(t){return this._locateBoundingBox(this.getGraphBoundingBox(),t).then(this._onLocated)}locateElements(t,e){return this._modules.transformations.whenApplied().then((()=>this._locateBoundingBox(this.getBoundingBox(t),e))).then(this._onLocated)}locateRawGraph(t,e){return this._onLocateStart(),this._locateBoundingBox(this.getRawGraphBoundingBox(t),e).then(this._onLocated)}isLocating(){return this._isLocating}getGraphBoundingBox(t=!1){if(t){const e=this.getBoundingBox(this._ogma.getNodes(),!0,t),s=this.getBoundingBox(this._ogma.getEdges(),!1,t);return e.extend(s)}return this._cacheValid||this._updateCache(),this._cachedGraphBoundingBox.clone()}forceInvalidCache(){this._invalidCache()}_updateCache(){this._cacheValid=!0,this._cachedGraphBoundingBox=this.getBoundingBox(this._modules.graph.getNodes()).extend(this.getBoundingBox(this._modules.graph.getEdges()))}getBoundingBox(t,e=!1,s=!1,n){let i;if(i=t.isNode?this._getNodesBoundingBox(t.toList(),e):this._getEdgesBoundingBox(t.toList(),n),s){const r=this._ogma.modules.labels.getTextsBoundingBox(t.isNode?t.toList():null,t.isNode?null:t.toList());i=i.extend(r)}return i}_getNodesBoundingBox(t,e=!1){this._modules.graphics.forceAttributesComputation();const s=this._modules.graphics.getNodeAttributes(),n=[],i=[],r=[],o=[];for(let a=0;a<t.size;++a){const l=t._indexes[a];if(s.excluded.get(l)===0){const u=s.x.get(l),h=s.y.get(l),g=s.radius.get(l),f=2*g;s.scalingMethod.get(l)==="scaled"?r.push(f):o.push(f),e?(n.push(u-g,u+g),i.push(h-g,h+g)):(n.push(u),i.push(h))}}return new ii({xValues:n,yValues:i,scaledSizeValues:r,fixedSizeValues:o})}_getEdgesBoundingBox(t,e=!1){return this._getEdgesBoundingBoxInternal(t._indexes,e)}_getEdgesBoundingBoxInternal(t,e=!1,s,n){this._modules.graphics.forceAttributesComputation();const i=this._modules.graphics.getEdgeAttributes(),r=this._modules.graphics.getNodeAttributes(),o={x1:0,y1:0,x2:0,y2:0},a={x:0,y:0},l={minX:0,minY:0,maxX:0,maxY:0},u=[],h=[],g=[],f=[],m=s||r.x,y=n||r.y;for(let p=0;p<t.length;++p){const x=t[p],v=i.source.get(x),b=i.target.get(x),S=i.curvature.get(x),A=m.get(v),w=y.get(v),L=r.scalingMethod.get(v)==="scaled",k=2*r.radius.get(v),F=m.get(b),O=y.get(b),j=r.scalingMethod.get(b)==="scaled",V=2*r.radius.get(b);L?g.push(k):f.push(k),j?g.push(V):f.push(V),e||S===0?(u.push(A,F),h.push(w,O)):v===b?(Jx(A,w,S,k/2,0,o),Wf(A,w,o.x1,o.y1,o.x2,o.y2,F,O,l),u.push(l.minX,l.maxX),h.push(l.minY,l.maxY)):(Xf(A,w,F,O,S,a),Zx(A,w,a.x,a.y,F,O,l),u.push(l.minX,l.maxX),h.push(l.minY,l.maxY))}return new ii({xValues:u,yValues:h,scaledSizeValues:g,fixedSizeValues:f})}getRawGraphBoundingBox(t){const e=t.nodes.length,s=new Array(e),n=new Array(e),i=new Array(e);for(let r=0;r<e;r++){const o=t.nodes[r].attributes||{};s[r]=o.x||0,n[r]=o.y||0,i[r]=o.radius||5}return new ii({xValues:s,yValues:n,scaledSizeValues:i})}_locateBoundingBox(t,e={}){if(isNaN(t.cx))return Promise.resolve();const{padding:s={},easing:n=k4,duration:i=0,maxNodeSizeOnScreen:r=c1,ignoreZoomLimits:o=!1}=e,a=h1(t,this._modules.dom.getDimensions(),s,r),l=a.x,u=a.y,h=a.zoom,g=h/this._modules.camera.getZoom();return this._moveCamera(l,u,h,i,n,g,o)}_moveCamera(t,e,s,n,i,r,o){const a={duration:n,easing:i,ignoreZoomLimits:o},l=this._modules.camera.setCenter({x:t,y:e},a);return r>1.01||r<.99?this._modules.camera.setZoom(s,a):l}computeConfigForBounds(t,e={}){const{padding:s={},maxNodeSizeOnScreen:n=c1}=e;return h1(t,this._modules.dom.getDimensions(),s,n)}layoutDataBoundingBox({x:t,y:e,indexes:s}){const n=this._modules.graphics.getNodeAttributes(),i=[],r=[],o=[],a=[],l=new Map,u=new Map;for(let f=0;f<s.length;++f){const m=s[f],y=t[f],p=e[f];l.set(m,y),u.set(m,p);const x=2*n.radius.get(m),v=n.scalingMethod.get(m)==="scaled";i.push(y),r.push(p),v?o.push(x):a.push(x)}const h=this._modules.graph.topology.getAdjacentElements(!1,s,{bothExtremities:!0}),g=this._getEdgesBoundingBoxInternal(h,!1,l,u);return new ii({xValues:i,yValues:r,scaledSizeValues:o,fixedSizeValues:a}).extend(g)}isEdgeInPolygon(t,e){return N4(t,e,this._modules.camera.getZoom())}isElementInView(t,{margin:e=0}={}){const{width:s,height:n}=this._modules.camera.getSize(),i={minX:-e,minY:-e,maxX:s+e,maxY:n+e};return t.isNode?this.isNodeInRectangle(t,i):this.isEdgeInRectangle(t,i)}isNodeInRectangle(t,e){if(this._modules.geo.isEnabled()){const s=this._modules.geo.getContainerCoord(t);return gN(s.x,s.y,Number(t.getAttribute("radius")),e)}return M4(t,e,this._modules.camera.getZoom())}isNodeInPolygon(t,e){const s=t.getPositionOnScreen();return Qd(s.x,s.y,e)}isEdgeInRectangle(t,e){return I4(t,e,this._modules.camera.getZoom())}},F4=Vo&&typeof navigator<"u"&&"msLaunchUri"in navigator&&eo&&!("documentMode"in document);function P4(t){return F4?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/mi():t.deltaY&&t.deltaMode===1?20*-t.deltaY:t.deltaY&&t.deltaMode===2?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}var z4=6,D4=class extends Ke{constructor(){super(...arguments),this._px=0,this._py=0,this._pressX=0,this._pressY=0,this._left=!1,this._middle=!1,this._right=!1,this._clickCounter={left:0,middle:0,right:0},this._buttons={left:!1,middle:!1,right:!1},this._skipNextMove=!1,this._onMouseWheel=t=>{this._isEnabled()&&this._isWheelEnabled()&&(!this._disableWheelUntilMouseDown()||this._modules.dom.hasFocus())&&(t.preventDefault(),t.stopPropagation(),this._applyMouseWheelZoom(t))},this._onMouseMove=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=e-this._px,i=s-this._py;n===0&&i===0||(this._skipNextMove?this._skipNextMove=!1:pn(e,s,this._pressX,this._pressY)>=z4&&(this._resetClickCounter(),this._modules.events.fire("mousemoveInternal",{x:e,y:s,dx:n,dy:i,domEvent:this._evt})))},this._onDocumentMouseMove=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=this._bounds,i=e-this._px,r=s-this._py;(e<0||e>n.width||s<0||s>n.height)&&this._modules.events.fire("documentMouseMove",{x:e,y:s,dx:i,dy:r,domEvent:this._evt})},this._onMouseUp=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=this._button,i=this._evt;this._buttons[n]=!1,this._clickCounter[this._button]===1?this._modules.events.fire("clickInternal",{button:n,x:e,y:s,domEvent:i}):this._clickCounter[n]>1&&(this._modules.events.fire("doubleclickInternal",{button:n,x:e,y:s,domEvent:i}),this._resetClickCounter(n)),this._modules.events.fire("mouseupInternal",{button:n,x:e,y:s,domEvent:i})},this._onDocumentMouseup=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=this._button;this._buttons[n]=!1;const i=this._modules.dom;this._modules.events.fire("documentMouseUp",{button:n,x:e,y:s,domEvent:this._evt}),i.removeDirectWindowEventListener("mousemove",this._onDocumentMouseMove),i.removeDirectWindowEventListener("mouseup",this._onDocumentMouseup)},this._onMouseDown=t=>{if(!this._isEnabled()||!this._setXY(t))return;const e=this._modules.position.x,s=this._modules.position.y,n=this._button,i=this._modules.dom;this._skipNextMove=!0,this._pressX=e,this._pressY=s,this._lastMouseDownTarget=t.target,i.focus(),this._buttons[n]=!0,this._clickCounter[n]+=1;const r=n;this._dbclickTimer=i.setTimeout((()=>{this._resetClickCounter(r,0)}),this._getDoubleClickTimer()),this._modules.events.fire("mousedownInternal",{button:n,x:e,y:s,domEvent:this._evt}),i.addDirectWindowEventListener("mousemove",this._onDocumentMouseMove),i.addDirectWindowEventListener("mouseup",this._onDocumentMouseup)},this._onDrop=t=>{if(!this._isEnabled()||!this._setXY(t))return;t.preventDefault();const{x:e,y:s}=this._modules.camera.screenToGraphCoordinates(this._modules.position);this._modules.events.fire("drop",{domEvent:this._evt,x:e,y:s})}}onMounted(){this._domElt=this._modules.graphics.getDomElement(),this._modules.settings.register("mouse.enabled",!0),this._modules.settings.register("mouse.wheelEnabled",!0),this._modules.settings.register("mouse.disableWheelUntilMouseDown",!1),this._modules.settings.register("mouse.doubleClickTimer",500),this._modules.events.register(["mousedownInternal","mouseupInternal","mousemoveInternal","mousewheelInternal","clickInternal","doubleclickInternal","mouseoverInternal","mouseoutInternal","documentMouseUp","documentMouseMove","drop"]),this._modules.dom.afterNextFrame().then((()=>this._initializeListeners()))}get x(){return this._modules.position.x}get y(){return this._modules.position.y}get left(){return this._left}get right(){return this._right}get middle(){return this._middle}_isEnabled(){return this._modules.settings.get("mouse.enabled")}_isWheelEnabled(){return this._modules.settings.get("mouse.wheelEnabled")}_disableWheelUntilMouseDown(){return this._modules.settings.get("mouse.disableWheelUntilMouseDown")}_getDoubleClickTimer(){return this._modules.settings.get("mouse.doubleClickTimer")}_resetClickCounter(t,e=0){t?this._clickCounter[t]=e:(this._clickCounter.left=e,this._clickCounter.middle=e,this._clickCounter.right=e),this._modules.dom.clearTimeout(this._dbclickTimer),this._lastMouseDownTarget=null}_setXY(t){const e=this._domElt.getBoundingClientRect();return this._bounds=e,!!e&&(this._evt=t,this._button=Sx[t.button],this._px=this._modules.position.x,this._py=this._modules.position.y,this._modules.position.x=t.clientX-e.left,this._modules.position.y=t.clientY-e.top,this._left=this._buttons.left,this._right=this._buttons.right,this._middle=this._buttons.middle,!0)}_applyMouseWheelZoom(t){this._setXY(t)&&this._modules.events.fire("mousewheelInternal",{delta:P4(t),dx:t.deltaX,dy:t.deltaY,x:this._modules.position.x,y:this._modules.position.y,domEvent:this._evt})}_initializeListeners(){const t=this._domElt,e=this._modules.dom;kf&&this._modules.dom.addElementEventListener(document,"contextmenu",(n=>{this._lastMouseDownTarget&&n.target!==this._lastMouseDownTarget&&n.preventDefault()})),e.addElementEventListener(t,"contextmenu",(n=>{this._setXY(n),this._modules.dom.hasFocus()&&this._modules.settings.get("mouse.enabled")&&n.preventDefault()}),!1);const s="onwheel"in t?"wheel":t.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll";e.addElementEventListener(t,s,this._onMouseWheel,{passive:!1}),e.addElementEventListener(t,"mousemove",this._onMouseMove),e.addElementEventListener(t,"mouseleave",(n=>{if(!this._isEnabled())return;this._modules.dom.blur();const i=t.getBoundingClientRect();n.clientX>=i.left+1&&n.clientX<=i.right-1&&n.clientY>=i.top+1&&n.clientY<=i.bottom-1||this._modules.events.fire("mouseout",{domEvent:this._evt})})),e.addElementEventListener(t,"mousedown",this._onMouseDown),e.addElementEventListener(t,"mouseup",this._onMouseUp),e.addElementEventListener(t,"dragover",(n=>{n.preventDefault()})),e.addElementEventListener(t,"drop",this._onDrop)}},O4={doubleTapTimer:500},B4=class extends Ke{constructor(){super(...arguments),this._pressed=!1,this._addEvent=(t,e,s,n)=>{this._modules.dom.addElementEventListener(t,e,s,n)},this._addWinEvent=(t,e,s,n)=>{this._modules.dom.addDirectWindowEventListener(e,s,n)},this._removeWinEvent=(t,e,s)=>{this._modules.dom.removeDirectWindowEventListener(e,s)}}onMounted(){this._domElt=this._modules.graphics.getDomElement(),this._modules.settings.register("touch.enabled",!0),this._modules.events.register(["touchDown","touchUp","touchTap","touchDoubleTap","touchMove","touchStartGesture","touchProgressGesture","touchEndGesture","documentTouchMove","documentTouchUp"]),this._modules.dom.afterNextFrame().then((()=>{this._initialize(this)}))}get x(){return this._modules.position.x}get y(){return this._modules.position.y}get pressed(){return this._pressed}_listen(t,e,s){if(h2){if(e==="touchstart")return $P(this._addEvent,t,s);if(e==="touchmove")return YP(this._addWinEvent,t,s);if(e==="touchend")return WP(this._addWinEvent,t,s);if(e==="touchcancel")return qP(this._addWinEvent,t,s)}return this._modules.dom.addElementEventListener(t,e,s)}_initialize(t){let e=0,s=0,n=0,i=0,r=!1,o="left",a=0,l=!1,u=!1,h=0,g=1,f=null,m=null;const y=()=>{this._modules.position.x=e,this._modules.position.y=s,this._pressed=r},p=(w,L)=>{const k=this._domElt.getBoundingClientRect();if(!k||w.touches==null)return null;const[F,O]=w.touches,j=F.clientX-k.left,V=F.clientY-k.top,Z=O.clientX-k.left,at=O.clientY-k.top,mt=(j+Z)/2,K=(V+at)/2,ut=mt-e,ht=K-s,nt=pn(j,V,Z,at),ot=nt/g,Mt=au(j,V,Z,at),Q={dx:ut,dy:ht,rotation:Mt-h,scale:ot};return((Et,qt,Vt,Wt)=>{g=Et,h=qt,e=Vt,s=Wt,y()})(nt,Mt,mt,K),Q},x=w=>{if(w.touches&&w.touches.length===2&&u){const L=p(w);if(L){const{dx:k,dy:F,rotation:O,scale:j}=L;this._modules.events.fire("touchProgressGesture",{dx:k,dy:F,rotation:O,scale:j,x:e,y:s,domEvent:f,button:o})}}},v=w=>{if(o=Sx[w.button],!w.touches)return!1;if(w.touches.length!==1)return r=!1,w.touches.length>1&&this._modules.events.fire("touchUp",{x:e,y:s,domEvent:f,button:o}),!1;const L=this._domElt.getBoundingClientRect();return L&&(n=e,i=s,e=w.touches[0].clientX-L.left|0,s=w.touches[0].clientY-L.top|0,r=!0,f=w,y()),!0},b=()=>{a=0,this._modules.dom.clearTimeout(m)},S=w=>{if(w.preventDefault(),!w.touches)return;if(w.touches.length!==2&&u&&(u=!1,this._modules.events.fire("touchEndGesture",{domEvent:f})),v(w),w.touches.length===0){const k={x:e,y:s,domEvent:f,button:o};a===1&&this._modules.events.fire("touchTap",k),a>1&&(this._modules.events.fire("touchDoubleTap",k),b()),this._modules.events.fire("touchUp",k)}const L=no().documentElement;TE(this._removeWinEvent,L,"touchmove",this._onMove),TE(this._removeWinEvent,L,"touchend",this._onEnd)},A=w=>{x(w),l?l=!1:(b(),v(w)&&this._modules.events.fire("touchMove",{x:e,y:s,dx:e-n,dy:s-i,domEvent:f,button:o}))};this._listen(this._domElt,"touchstart",(w=>{if(!w.touches)return;w.touches.length!==2||u||(g=1,p(w)&&(u=!0,this._modules.events.fire("touchStartGesture",{domEvent:f}))),v(w)&&(this._modules.dom.focus(),this._modules.events.fire("touchDown",{x:e,y:s,domEvent:f,button:o}),a+=1,m=this._modules.dom.setTimeout(b,O4.doubleTapTimer),l=!0);const L=no().documentElement;this._onMove=this._listen(L,"touchmove",A),this._onEnd=this._listen(L,"touchend",S)}))}},U4=class extends Ke{constructor(t){super(t),this.getSubElements=e=>this.api.getSubElements(e),this.getSubNodes=e=>this.api.getSubNodes(e),this.getSubEdges=e=>this.api.getSubEdges(e),this.getXYR=e=>this.api.getXYR(e),this.onGroupsUpdated=e=>this.api.onGroupsUpdated(e)}onMounted(){this._modules.classes.createClass({name:y2,isBuiltin:!0,nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0}}),this._modules.classes.createClass({name:x2,isBuiltin:!0,nodeAttributes:{opacity:0},edgeAttributes:{opacity:0}}),this._modules.settings.register("transformations.updateOnDataChange",!0),this._modules.events.register(["transformationEnabled","transformationDisabled","transformationSetIndex","transformationDestroyed","transformationRefresh"])}onReady(t){this.api=new Rq(this._ogma)}destroy(){}isElementVirtual(t){return this.api.isVirtual(t._index,t.isNode)}getElementTransformation(t){return this.api.getTransformation(t._index,t.isNode)}getMetaElements(t){return t.map((e=>this.getMetaElement(e)))}getMetaElement(t){var s;const e=t.isNode?this.api.getMetaNode(t):this.api.getMetaEdge(t);return e&&((s=this.api.getTransformation(e._index,e.isNode))!=null&&s.isEnabled())?e:null}getMetaEdge(t){return this.getMetaElement(t)}getMetaNode(t){return this.getMetaElement(t)}getMetaNodes(t){return this.getMetaElements(t)}getMetaEdges(t){return this.getMetaElements(t)}getNodeFilters(){return this.api.getList().filter((t=>t.getName()===Xn.NodeFilter))}getEdgeFilters(){return this.api.getList().filter((t=>t.getName()===Xn.EdgeFilter))}whenApplied(){return this.api.afterNextUpdate()}afterNextUpdate(){return this.api.afterNextUpdate()}isRefreshing(){return this.api.isRefreshing()}triggerGroupUpdated(t){const e=t._indexes,s=this._ogma.modules.transformations.api.groupController.layoutController.shouldRelayout;for(let n=0;n<t.size;n++)s.add(e[n])}},g1={layer:v2,outline:!0,outerStroke:{color:by,width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:YC,minVisibleSize:0}},G4={layer:v2,color:by,text:{backgroundColor:YC,minVisibleSize:0},stroke:{color:by,width:0}},V4=class extends Ke{onMounted(){this.shouldTriggerEvents=!0,this._modules.events.register(["nodesSelected","nodesUnselected","edgesSelected","edgesUnselected"]),this._selectionExtremityHighlightedClass=this._modules.classes.createClass({name:iy,isBuiltin:!0,nodeAttributes:g1}),this._selectedClass=this._modules.classes.createClass({name:Gs,isBuiltin:!0,nodeAttributes:g1,edgeAttributes:G4}),this._modules.events.on(`nodeClassAdded_${Gs}`,(e=>{this.shouldTriggerEvents&&this._modules.events.fire("nodesSelected",e)})),this._modules.events.on(`edgeClassAdded_${Gs}`,(e=>{this.shouldTriggerEvents&&this._modules.events.fire("edgesSelected",e)})),this._modules.events.on(`nodeClassRemoved_${Gs}`,(e=>{this.shouldTriggerEvents&&this._modules.events.fire("nodesUnselected",e)})),this._modules.events.on(`edgeClassRemoved_${Gs}`,(e=>{this.shouldTriggerEvents&&this._modules.events.fire("edgesUnselected",e)})),this._modules.settings.register("interactions.selection.enabled",!0),this._modules.settings.register("interactions.selection.multiSelectionKey","ctrl"),this._modules.interactions.onClick({priority:"selection",check:({button:e})=>{const s=!!this._modules.settings.get("interactions.selection.enabled");return e==="left"&&s},handler:({target:e})=>{if(e){const s=this._modules.settings.get("interactions.selection.multiSelectionKey"),n=s&&this._modules.keyboard.isPressed(s);e.isNode?this._selectedClass.clearEdges():this._selectedClass.clearNodes(),n?e.hasClass(Gs)?e.removeClass(Gs):e.addClass(Gs):((e.isNode?this._selectedClass.getNodes():this._selectedClass.getEdges()).filter((i=>i!==e)).removeClass(Gs),e.hasClass(Gs)||e.addClass(Gs))}else this._selectedClass.clearNodes(),this._selectedClass.clearEdges()}});const t=()=>{this._selectionExtremityHighlightedClass.clearNodes(),this._selectedClass.getEdges().getExtremities().addClass(iy)};this._modules.events.on("beforeRemoveEdges",(({edges:e})=>e.setSelected(!1))).on("excludedStateChange",(({elements:e,value:s})=>{s||e.setSelected(!1)})).on(`edgeClassAdded_${Gs}`,t).on(`edgeClassRemoved_${Gs}`,t)}setNodeAttributes(t,e){this._selectedClass.update({nodeAttributes:t,fullOverwrite:e}),this._selectionExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()}setEdgeAttributes(t,e){this._selectedClass.update({edgeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()}setEdgeExtremitiesAttributes(t,e){this._selectionExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e})}_updateExtremityHighlightLayer(){const t=this._selectedClass.getDefinition().edgeAttributes,e=t?t.layer:void 0;this._selectionExtremityHighlightedClass.update({nodeAttributes:{layer:e},fullOverwrite:!1})}setActive(t,e){if(Rn(e)){const s=[],n=[];t.toList().forEach(((i,r)=>{(e[r]?s:n).push(i.getId())})),s.length!==0&&this._modules.graph.getElements(t.isNode,s).addClass(Gs),n.length!==0&&this._modules.graph.getElements(t.isNode,n).removeClass(Gs)}else t.size&&t[e?"addClass":"removeClass"](Gs)}areActive(t){return t.hasClass(Gs)}getSelectedNodes(){return this._selectedClass.getNodes()}getSelectedEdges(){return this._selectedClass.getEdges()}getNonSelectedNodes(){return this._modules.graph.getNodes().filter((t=>!t.hasClass(Gs)))}getNonSelectedEdges(){return this._modules.graph.getEdges().filter((t=>!t.hasClass(Gs)))}disableEvents(){this.shouldTriggerEvents=!1}enableEvents(){this.shouldTriggerEvents=!0}clear(){this._selectedClass.clearNodes(),this._selectedClass.clearEdges()}},j4=class extends Ke{onMounted(){this._delayedCalls=[],this._idIdle=()=>!this._modules.captor.isAnyButtonPressed()&&!this._modules.dom.isPlayingFrame(),this._modules.events.on(["mousedown","mouseup","beforeNewFrame","frame"],(()=>{this._delayedCalls.forEach((t=>t.reset()))}))}_nextTimeIdle(t){const e=new H4(this._modules.dom,this._idIdle,t);return this._delayedCalls.push(e),e.whenDone().then((()=>{this._delayedCalls.splice(this._delayedCalls.indexOf(e),1)}))}debounceIdle(t,e=0){let s=!1,n=[];const i=()=>{const r=n;s=!1,n=[],t(),r.forEach((o=>o()))};return()=>new Promise((r=>{n.push(r),s||(s=!0,this._nextTimeIdle(e).then(i))}))}},H4=class{constructor(t,e,s){this._timeout=null,this._done=!1,this._dom=t,this._promise=new Promise((n=>this._resolve=n)),this._isIdle=e,this._delay=s,this._startTimeout()}_startTimeout(){this._timeout=this._dom.setTimeout((()=>{this._isIdle()?(this._done=!0,this._resolve()):this._startTimeout()}),this._delay)}reset(){this._done||(this._dom.clearTimeout(this._timeout),this._startTimeout())}whenDone(){return this._promise}},hg=-2,$4={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:50,startRatio:1,endRatio:2,enabled:!1},q4={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:10,startRatio:1,endRatio:2,enabled:!1},Y4=class extends Ke{constructor(){super(...arguments),this._nodePromiseMap=new Map,this._edgePromiseMap=new Map,this._onAttributeChange=({nodes:t,edges:e,nodeAttributes:s,edgeAttributes:n})=>{this._onElementsAttributeChange(t,s),this._onElementsAttributeChange(e,n,!1)},this._refreshPulses=()=>{const{nodes:t,edges:e}=this._hasPulses.getElements();if(t.size!==0||e.size!==0){const s=this._engine.getCurrentTime();this._refreshElementsPulses(t,s),this._refreshElementsPulses(e,s),this._modules.dom.refresh()}}}onMounted(){this._modules.events.on("updateAttributes",this._onAttributeChange).on("frame",this._refreshPulses).on("beforeRemoveEdges",(({edges:t})=>{this._removePulses(t)})).on("beforeRemoveNodes",(({nodes:t})=>{this._removePulses(t)})).on("excludedStateChange",(({elements:t,value:e})=>{e&&(this._hasPulses.removeElements(t),this._removePulses(t))})).on("clearGraph",(()=>this._hasPulses.clear())),this._engine=this._modules.graphics.getGraphicsEngine(),this._group=this._engine.createGroup(),this._nodePulses=this._modules.graph.createNodeAttribute({storage:"any"},!1),this._edgePulses=this._modules.graph.createEdgeAttribute({storage:"any"},!1),this._nodeNbPulsesRemaining=this._modules.graph.createNodeAttribute({storage:"int16",default:-1},!1),this._edgeNbPulsesRemaining=this._modules.graph.createEdgeAttribute({storage:"int16",default:-1},!1),this._nodeFlexArrays=this._modules.graphics.getNodeAttributes(),this._edgeFlexArrays=this._modules.graphics.getEdgeAttributes(),this._edgeSourceList=this._modules.graph.getEdgeAttribute("source"),this._edgeTargetList=this._modules.graph.getEdgeAttribute("target"),this._hasPulses=new Ah(this._modules.graph)}_onElementsAttributeChange(t,e,s=!0){if(!e.includes("pulse.enabled"))return;const{valid:n,invalid:i}=iT(this._modules.graph,t,(o=>o.getAttribute("pulse.enabled")&&o.isVisible()));this._hasPulses.removeElements(i),this._hasPulses.addElements(n);const r=s?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining;for(let o=0;o<n.size;o++)r.get(n._indexes[o])>0||r.set(n._indexes[o],hg);this._removePulses(i)}_removePulses(t){const e=t.isNode?this._nodePulses:this._edgePulses,s=t.isNode?this._nodePromiseMap:this._edgePromiseMap;for(let n=0;n<t._indexes.length;n++){const i=t._indexes[n],r=e.get(i);if(r){for(let a=0;a<r.length;a++){const l=r[a];this._modules.graphics.releaseGraphicsEngineBlockId(l.blockId)}e.set(i,null);const o=s.get(i);o&&(o.resolve(),s.delete(i))}}}_refreshElementsPulses(t,e){const s=t.isNode,n=s?this._nodePulses:this._edgePulses,i=s?this._nodeFlexArrays.pulse.duration:this._edgeFlexArrays.pulse.duration,r=s?"_createNodePulseBlock":"_createEdgePulseBlock",o=s?this._nodeFlexArrays.pulse.interval:this._edgeFlexArrays.pulse.interval,a=s?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining;for(let l=0;l<t._indexes.length;l++){const u=t._indexes[l];let h=n.get(u);h||(h=[],n.set(u,h));for(let p=0;p<h.length;p++){const{startTime:x,duration:v,blockId:b}=h[p];e>=x+v&&(this._modules.graphics.releaseGraphicsEngineBlockId(b),h.splice(p--,1))}const g=h[h.length-1];if(g&&e<g.startTime+o.get(u))continue;const f=i.get(u),m=a.get(u);if(m<1&&m!==hg)continue;h.push({blockId:this[r](u,e,f),startTime:e,duration:f});const y=m===hg?hg:m-1;a.set(u,y)}}_createNodePulseBlock(t,e,s){const n=this._nodeFlexArrays,i=n.color.get(t),r=n.layer.get(t),o=n.x.get(t),a=n.y.get(t),l=n.radius.get(t),u=n.scalingMethod.get(t)==="scaled",h=n.pulse.startRatio.get(t),g=n.pulse.endRatio.get(t),f=n.pulse.width.get(t),m=2*l*h,y=2*l*g,p=Kd(r).nodeBody,x=n.pulse.startColor.get(t),v=n.pulse.endColor.get(t),b=this._modules.graphics.allocateGraphicsEngineBlockId(),S=this._group.reset(ar,!0,p),A=S.nextAndReset(),w=dr(x,i),L=dr(v,i);return A.end.shape="circle",A.end.pieceId=qi,A.end.x1=o,A.end.y1=a,A.end.x2=o,A.end.y2=a,A.end.rectWidthOrSourceRadiusScaled=u?y:0,A.end.rectHeightOrTargetRadiusScaled=u?y:0,A.end.rectWidthOrSourceRadiusFixed=u?0:y,A.end.rectHeightOrTargetRadiusFixed=u?0:y,A.end.strokeWidthFixed=f,A.end.strokeColor=L,A.start.shape="circle",A.start.pieceId=qi,A.start.x1=o,A.start.y1=a,A.start.x2=o,A.start.y2=a,A.start.rectWidthOrSourceRadiusScaled=u?m:0,A.start.rectHeightOrTargetRadiusScaled=u?m:0,A.start.rectWidthOrSourceRadiusFixed=u?0:m,A.start.rectHeightOrTargetRadiusFixed=u?0:m,A.start.strokeWidthFixed=f,A.start.strokeColor=w,A.animation.duration=s,A.animation.beginTime=e,this._engine.storeGroup(b,S),b}_createEdgePulseBlock(t,e,s){const n=this._edgeFlexArrays,i=this._nodeFlexArrays,r=n.pulse.startRatio.get(t),o=n.pulse.endRatio.get(t),a=n.pulse.startColor.get(t),l=n.pulse.endColor.get(t),u=Kd(n.layer.get(t)).edgeBody,h=this._edgeSourceList.get(t),g=this._edgeTargetList.get(t),f=n.curvature.get(t),m=f!==0,y=this._modules.graphics.allocateGraphicsEngineBlockId(),p=this._group.reset(m?cf:ar,!0,u),x=p.nextAndReset(),v={isSelfLoop:h===g,curvature:f,sourceX:i.x.get(h),sourceY:i.y.get(h),targetX:i.x.get(g),targetY:i.y.get(g),sourceRadius:i.radius.get(h),targetRadius:i.radius.get(g),isSourceRadiusScaled:i.scalingMethod.get(h)==="scaled",isTargetRadiusScaled:i.scalingMethod.get(g)==="scaled",width:n.width.get(t),isWidthScaled:n.scalingMethod.get(t)==="scaled",strokeWidth:n.pulse.width.get(t)};return f1(x.start,v),f1(x.end,v),x.start.strokeColor=a,x.end.strokeColor=l,x.start.thicknessOrFontSizeScaled*=r,x.start.thicknessOrFontSizeFixed*=r,x.end.thicknessOrFontSizeScaled*=o,x.end.thicknessOrFontSizeFixed*=o,x.animation.duration=s,x.animation.beginTime=e,this._engine.storeGroup(y,p),y}pulse(t,e){const s=t.isNode,n={...s?$4:q4,...s?this._nodePulseTheme:this._edgePulseTheme,...e},i=n.number,r=n.interval,o=n.duration,a=s?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,l=(i-1)*r+o;let u;n.enabled=!0,delete n.number,t.setAttributes({pulse:n}),a.setMultiple(t._indexes,i),this._modules.dom.setTimeout((()=>{t.isList?t.filter(lr).setAttribute("pulse.enabled",!1):t.setAttribute("pulse.enabled",!1),a.setMultiple(t._indexes,-1)}),l);const h=new Promise((f=>{u=()=>f(t)})),g=t.isNode?this._nodePromiseMap:this._edgePromiseMap;return t.isList?t._indexes.forEach((f=>{this._setPromise(f,g,h,u)})):this._setPromise(t._index,g,h,u),h}_setPromise(t,e,s,n){e.has(t)&&e.get(t).resolve(),e.set(t,{promise:s,resolve:n})}setTheme(t,e){this._nodePulseTheme=t,this._edgePulseTheme=e}};function f1(t,{sourceX:e,sourceY:s,targetX:n,targetY:i,isSourceRadiusScaled:r,isTargetRadiusScaled:o,targetRadius:a,sourceRadius:l,isWidthScaled:u,width:h,strokeWidth:g,curvature:f,isSelfLoop:m}){t.pieceId=Gf,t.shape="line",t.x1=e,t.y1=s,t.x2=n,t.y2=i,t.rectWidthOrSourceRadiusScaled=r?l:0,t.rectWidthOrSourceRadiusFixed=r?0:l,t.rectHeightOrTargetRadiusScaled=o?a:0,t.rectHeightOrTargetRadiusFixed=o?0:a,t.thicknessOrFontSizeScaled=u?h:0,t.thicknessOrFontSizeFixed=u?0:h,t.strokeWidthFixed=g,t.curvature=f,t.isSelfLoop=m}var W4={duration:0,easing:"linear",callback:os,resolve:os,startAfter:0},X4=0,Z4=class extends Ke{constructor(){super(...arguments),this._animationList=[],this._update=()=>{if(this._animationList.length===0)return;const t=$n(),e=[];for(let s=0;s<this._animationList.length;++s){const n=this._animationList[s],i=(t-n.creationDate)/n.duration,r=n.startAfter;let o=n.easing(i);i>=1?(n.func(1),n.done=!0,n.resolve(void 0),this._animationList.splice(s,1),s-=1,e.push(n.callback)):o>=r&&(o=(o-r)*(1/(1-r)),n.func(o))}for(let s=0;s<e.length;s++)e[s](!1);this._modules.dom.refresh()}}onMounted(){this._modules.events.on("beforeNewFrame",this._update)}play(t,e){const{duration:s,easing:n,callback:i,startAfter:r,resolve:o}=Ci(e,W4);if(s<=0)return t(1),i(),o(void 0),null;const a={func:t,easing:typeof n=="function"?n:h0[n],duration:s,callback:i,resolve:o,startAfter:r,creationDate:$n(),done:!1,id:++X4};return this._animationList.push(a),this._modules.dom.refresh(),a}cancel(t){const e=this._animationList.indexOf(t);e!==-1&&(t.func(1),this._animationList.splice(e,1),t.done=!0,t.resolve(void 0))}},f0=t=>typeof t.export=="function",K4=(t,e,s,n)=>{const i=s._getMapPanePos(),r=t.getMapboxMap(),o=t.getCanvas(),a=t.getSize().round(),l=n.DomUtil.getPosition(t.getContainer()),u=l.x+i.x,h=l.y+i.y;return new Promise((g=>{function f(){e.drawImage(o,u,h,a.x,a.y),g()}if(r.loaded())return f();r.once("idle",f)}))},Q4=(t,e,s,n,i)=>{if(f0(t))return t.export(e);const r=s._getMapPanePos(),o=t.getContainer();if(!o)throw new Error(`Trying to access the container of ${t} but it does not exist.`);const a=n.DomUtil.getPosition(o);s.removeLayer(t),t.options.crossOrigin="anonymous";const l=[],u=[];return t.on("tileload",(({tile:h})=>{const{x:g,y:f}=n.DomUtil.getPosition(h);l.push(h),u.push({x:g-a.x+r.x,y:f-a.y+r.y})})),s.addLayer(t),new Promise((h=>{t.once("load",(()=>{const g=t.getTileSize();l.forEach(((f,m)=>{const{x:y,y:p}=u[m];e.drawImage(f,y,p,g.x,g.y)})),h()}))}))},J4=(t,e,s,n,i,r)=>new Promise((o=>{const a=t.options.renderer;s.removeLayer(t),t.options.renderer=r,s.addLayer(t),r._updatePaths();const l=s._getMapPanePos(),u=r._container,h=n.DomUtil.getPosition(u);e.drawImage(r._container,h.x+l.x,h.y+l.y,u.width/i,u.height/i),s.removeLayer(t),t.options.renderer=a,s.addLayer(t),o()})),tG=(t,e,s,n,i)=>new Promise((r=>{if(f0(t))return t.export(e).then(r);const o=s.getPixelBounds().min,a=s.project(t.getLatLng(),s.getZoom());if(!t._icon||t._icon.tagName!=="IMG")return r();const l=/^data:/.test(t._icon.src),u=l?t._icon.src:fN(t._icon.src),h=new Image,g=t.options.icon;if(g){const f=g.options;let m=f.iconSize||[24,24];const y=a.subtract(o);let p=f.iconAnchor||[0,0];Array.isArray(m)||(m=[m.x,m.y]),Array.isArray(p)||(p=[p.x,p.y]);const x=Math.round(y.x-(m[0]-p[0])*i),v=Math.round(y.y-p[1]*i);h.crossOrigin="";const b=()=>{e.drawImage(h,x,v,m[0]*i,m[1]*i),r()};h.onload=b,h.src=u,l&&b()}}));function eG(t){if(t.options.pane==="overlayPane"&&"getElement"in t){const e=t.getElement();return e&&e.tagName.toLowerCase()==="canvas"}return!1}var sG=(t,e,s,n,i)=>new Promise((r=>{const o=t.getElement(),a=o.width,l=o.height;e.drawImage(o,0,0,a,l),r()})),nG=(t,e,s,n,i)=>new Promise((r=>{s.removeLayer(t),t.setUrl(fN(t.getUrl())),t.options.crossOrigin="anonymous",t.once("load",(()=>{const o=t.getBounds(),a=s.latLngToContainerPoint(o.getNorthWest()),l=s.latLngToContainerPoint(o.getSouthEast()),u=l.x-a.x,h=l.y-a.y;e.drawImage(t._image,a.x,a.y,u,h),r()})),s.addLayer(t)}));function fN(t){return t+(t.indexOf("?")===-1?"?":"&")+"noCache="+Date.now()}var iG={tileLayers:Q4,imageOverlays:nG,canvasOverlays:sG,vectorLayers:J4,markers:tG,vectorMap:K4};function rG(t,e){return t instanceof e.TileLayer||t.options.pane==="tilePane"&&f0(t)?"tileLayers":eG(t)?"canvasOverlays":t instanceof e.ImageOverlay?"imageOverlays":t instanceof e.Path?"vectorLayers":t instanceof e.Marker?"markers":"MapboxGL"in e&&t instanceof e.MapboxGL?"vectorMap":void 0}function oG(t,e,s,n,i,r){const o={vectorMap:[],tileLayers:[],vectorLayers:[],canvasOverlays:[],imageOverlays:[],markers:[]};return e.eachLayer((a=>{if(a!==t){const l=rG(a,n);if(l&&l in o){const u=iG[l];o[l].push((()=>u(a,s,e,n,i,r)))}}})),o}function aG(t){t.TileLayer.prototype.getUrl=function(){return this._url},t.ImageOverlay.prototype.getUrl=function(){return this._url};const e="leaflet-zoom-animated";t.OgmaOverlay||(t.OgmaOverlay=t.Layer.extend({options:{pane:"overlayPane",padding:0,onUpdate:()=>{}},initialize:function(s){const{container:n}=s;t.Util.setOptions(this,s),this._container=n},setLocked:function(s){return this._locked=s,this},onAdd:function(s){this._map=s,this.getPane().appendChild(this._container),this._wgsOrigin=t.latLng([0,0]),this._wgsInitialShift=s.project(this._wgsOrigin,this._initialZoom),t.DomUtil.addClass(this._container,"leaflet-layer"),this._zoomAnimated&&(t.DomUtil.addClass(this._container,e),this._container.style.position="absolute",this._container.style.zIndex=9999),this._initialZoom=(this._map.getMaxZoom()+this._map.getMinZoom())/2,this._mapInitialZoom=this._map.getZoom(),this._updateBounds(),this._update({})},_updateBounds(){const s=this.options.padding,n=this._map.getSize(),i=this._map.containerPointToLayerPoint(n.multiplyBy(-s));this._bounds=new t.Bounds(i,i.add(n.multiplyBy(1+2*s))),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},_update(s){this._updateBounds(),this._redraw(this._bounds.min,s),this._positionTimer=t.Util.requestAnimFrame((()=>{this._container&&t.DomUtil.setPosition(this._container,this._bounds.min)}))},_redraw(s,n){this.options.onUpdate()},_updateTransform(s,n){if(this._locked)return;const i=this._map.getZoomScale(n,this._zoom),r=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,n),a=r.multiplyBy(-i).add(o).subtract(this._map._getNewPixelOrigin(s,n));t.Browser.any3d?t.DomUtil.setTransform(this._container,a,i):t.DomUtil.setPosition(this._container,a)},_onZoom(s){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_onMoveEnd(s){this._update(s)},_onAnimZoom({center:s,zoom:n}){this._updateTransform(s,n)},bringToFront(){t.DomUtil.toFront(this._container)},getEvents(){return{zoom:this._onZoom,moveend:this._onMoveEnd,zoomanim:this._onAnimZoom,layeradd:this.bringToFront,zoomend:this.options.onUpdate}},onRemove:function(){t.DomUtil.removeClass(this._container,e);const s=this._container;["transform","webkitTransform","OTransform","MozTransform","msTransform","zIndex","position"].forEach((n=>s.style[n]=null)),t.Util.cancelAnimFrame(this._positionTimer),this._container=null}}))}function lG(t,e,s,n){const i=t.filter((L=>L.isVisible())),r=i.size===0,{mapX:o,mapY:a}=i.reduce(((L,k)=>{const{latitude:F,longitude:O}=k.getGeoCoordinates(),{x:j,y:V}=n(F,O);return L.mapX.push(j),L.mapY.push(V),L}),{mapX:[],mapY:[]}),l=i.getAttribute("x"),u=i.getAttribute("y"),h=i.getAttribute("radius").map(Number),g=new ii({xValues:l,yValues:u,scaledSizeValues:h}),f=new ii({xValues:o,yValues:a});r&&(g.cx=g.cy=0,g.width=g.height=0),isFinite(f.width)&&isFinite(f.height)||(f.cx=f.cy=0,f.width=f.height=0);let m=f.cx-g.cx,y=f.cy-g.cy;const p=r?1:Math.max(f.width,f.height)/Math.max(g.width,g.height),[x,v]=h.reduce(((L,k)=>(L[0]=Math.min(L[0],k*p),L[1]=Math.max(L[1],k*p),L)),[1/0,0]);f.pad(v),f.minScaledSize=x,f.maxScaledSize=v;const b=s.computeConfigForBounds(f),S=e.zoom/NF(b.zoom);m+=(g.cx-e.x)*S,y+=(g.cy-e.y)*S;const A=g.cx+m,w=g.cy+y;return{offsetChanges:{name:"graph-to-geo",nodeAttributes:{radius:L=>Number(L.getAttribute("radius"))*S,x:L=>(L.getAttribute("x")+m-A)*S+A,y:L=>(L.getAttribute("y")+y-w)*S+w},edgeAttributes:{width:L=>Number(L.getAttribute("width"))*S}},camera:{zoom:e.zoom/S,x:(e.x+m-A)*S+A,y:(e.y+y-w)*S+w,angle:0,...e.getSize()}}}function uG(t,e,s,n){const i=t.getAttributes(["x","y","radius"]),r=t.getBoundingBox(),o=t.size===0,a=t.reduce(((A,{_index:w},L)=>(A[w]=L,A)),{});n();const l=t.getAttribute("x"),u=t.getAttribute("y"),h=t.getAttribute("radius"),g=new ii({xValues:l,yValues:u,scaledSizeValues:h.map((A=>2*A))});o&&(r.reset(),g.reset());let f=g.cx-r.cx,m=g.cy-r.cy,y=0,p=0;const x=s.computeConfigForBounds(g),v=e.zoom/x.zoom;let b,S;return isNaN(r.cx)||isNaN(r.cy)?(r.cx=e.x,r.cy=e.y,b=x.x,S=x.y):(f+=(r.cx-e.x)*v,m+=(r.cy-e.y)*v,y=r.cx+f,p=r.cy+m,b=(e.x+f-y)*v+y,S=(e.y+m-p)*v+p),{offsetChanges:{name:"geo-to-graph",nodeAttributes:{x:A=>(i[a[A._index]].x+f-y)*v+y,y:A=>(i[a[A._index]].y+m-p)*v+p}},camera:{zoom:x.zoom,x:b,y:S,angle:0,...e.getSize()}}}var mN={"top-left":"left","bottom-left":"left","top-right":"right","bottom-right":"right"},dG={"top-left":"top","bottom-left":"bottom","top-right":"top","bottom-right":"bottom"},m1={position:"bottom-right",horizontalMargin:0,verticalMargin:0,className:void 0},hG=class extends Ke{onMounted(){this._brand=null}set(t,e){let{position:s,horizontalMargin:n,verticalMargin:i,className:r}={...m1,...e};mN[s]||(s=m1.position),this.remove();const o=document.createElement("div");return Ww(o,Ax.sanitize(t)),o.style.position="absolute",pN(o,s,n,i),o.style.zIndex="10",r&&o.setAttribute("class",r),this._brand=o,this._modules.dom.setLayer("brand",this._brand),o}remove(){this._modules.dom.setLayer("brand",null),this._brand=null}};function pN(t,e,s,n){const i=s===void 0?"":s+"px",r=n===void 0?"":n+"px";t.style[mN[e]]=i,t.style[dG[e]]=r}var p1={},cG=class extends Ke{constructor(){super(...arguments),this._enabled=!1,this._settings={...Aa},this._edgesOriginalTextStyle={},this._nodesOriginalTextStyle={},this._nodeDraggingSetting=!1,this._transition=!1,this._attribution=null,this._updating=!1,this._updateRate=50,this._x=0,this._y=0,this._onCameraUpdate=t=>{if(this.L&&this._enabled&&this._map&&this._map._loaded){const e=this._x-this._modules.camera.x,s=this._y-this._modules.camera.y;(e||s)&&this._syncMapWithCamera()}},this._syncMapWithCamera=()=>{if(!this._map)return;this._updating||(this._updating=!0,this._layer.setLocked(!0),this._map._moveStart(!0,!1));const t=this._fromPointToLatLng(this._modules.camera.x,this._modules.camera.y),e=Fp(this._modules.camera.zoom),s=this.L.latLng(t.latitude,t.longitude);this._map._move(s,e,{pinch:!0,round:!1}),clearTimeout(this._updateRequest),this._updateRequest=this._modules.dom.setTimeout((()=>{this._updating=!1,this._layer.setLocked(!1),this._map&&this._map._move(s,e,{pinch:!0})._moveEnd(!0)}),this._updateRate)},this._onNodesDragStart=()=>{this._enabled&&(this._setMapDragging(!1),this._nodeDragOffsetX=this._nodeDragOffsetY=0)},this._onNodesDragged=({nodes:t,dx:e,dy:s})=>{if(this._enabled){const n=t.map((i=>{const{x:r,y:o}=i.getAttributes(["x","y"]);return this._fromPointToLatLng(r+e-this._nodeDragOffsetX,o+s-this._nodeDragOffsetY)}));return this._nodeDragOffsetX=e,this._nodeDragOffsetY=s,t.setGeoCoordinates(n)}return Promise.resolve(this._modules.graph.nodeList())},this._onMapUpdate=()=>{if(!this._map)return Promise.resolve(void 0);const{lat:t,lng:e}=this._map.getCenter(),s=this._fromLatLngToPoint(t,e);this._x=s.x,this._y=s.y;const n=LF(this._map.getZoom());return this._modules.events.fire("beforeGeoCameraMove",{zoom:this._map.getZoom()}),this._modules.camera.setView({zoom:n,x:s.x,y:s.y},{ignoreZoomLimits:!0}).then((()=>this._adjustMinvisibleSizes()))},this.runLayout=async({type:t,nodes:e,latitudePath:s=Ar,longitudePath:n=wr,options:i,center:r})=>{const o=$F(r),a=o([r.longitude,r.latitude]),l=e.getPosition(),u=[];return e.setAttributes(e.map((h=>{const g=h.getData(s),f=h.getData(n);if(isNaN(g)||isNaN(f))return{x:a[0],y:a[1]};const m=o([f,g]);return{x:m[0],y:m[1]}}))).then((()=>this._ogma.layouts[t]({...i,nodes:e,dryRun:!0}))).then((h=>{const g=h.positions.current,f=new Array(g.length),m=new Array(g.length),y=new Array(g.length).fill(10);g.forEach(((b,S)=>{const A=o.invert([b.x,b.y]);f[S]=A[1],m[S]=A[0],u.push({latitude:A[1],longitude:A[0]})}));const p=_h(m,f,y),x=p[0]-r.longitude,v=p[1]-r.latitude;for(let b=0;b<u.length;b++)f[b]-=v,m[b]-=x,u[b].latitude-=v,u[b].longitude-=x;return e.setData(s,f),e.setData(n,m),e.setAttributes(l)})).then((()=>this._ogma.modules.geo._updateNodesCoordinates(e))).then((()=>u))}}onMounted(){this._modules.events.register(["geoEnabled","beforeGeoDisabled","geoDisabled","geoNodesMoved","geoLoaded","geoReady"]),uE()&&(this.L=Hi("L")||Hi("leaflet"),this.L&&aG(this.L)),this._modules.graph.createNodeAttribute({name:"geo.prevLat",storage:"float"},!0),this._modules.graph.createNodeAttribute({name:Mp,storage:"float"},!0),this._modules.graph.createNodeAttribute({name:Ar,storage:"float"},!0),this._modules.graph.createNodeAttribute({name:wr,storage:"float"},!0),this._modules.events.register(["beforeGeoCameraMove"]),this._modules.events.on("addNodes",(t=>{t.virtual||this._refreshOrAddNodes(t.nodes,!0)})).on("updateNodeData",(t=>{this._onDataChange(t.changes)})).on("nodesDragProgress",this._onNodesDragged).on(["nodesDragStart","lassoEnabled"],this._onNodesDragStart).on(["nodesDragEnd","lassoDisabled"],(()=>this._setMapDragging(!0))).on("viewChanged",this._onCameraUpdate)}_onDataChange(t){const e=P_(this.latitudePath),s=P_(this.longitudePath),n=t.filter((({virtual:r,property:o,newValues:a})=>!(r||!a.length)&&(o&&typeof o!="string"?o.find((l=>e.startsWith(l)||s.startsWith(l))):o===null||e.startsWith(o)||s.startsWith(o))));if(!n.length)return;const i=GF(n);i&&(this._modules.events.fire("geoNodesMoved",{nodes:i}),this._refreshOrAddNodes(i,!1))}_refreshOrAddNodes(t,e){e&&this._updatePrevNodesCoordinates(t),this._updateNodesCoordinates(t),this._enabled&&(this._cacheOriginalTextStyles(t,null),this._filter.refresh())}_updatePrevNodesCoordinates(t){Pc(this._modules.graph,t,Ar,qb),Pc(this._modules.graph,t,wr,Mp)}_restorePrevNodesCoordinates(t){Pc(this._modules.graph,t,qb,Ar),Pc(this._modules.graph,t,Mp,wr)}_updateNodesCoordinates(t){OF(this._modules.graph,t,this._settings)}_createMapTileLayer(t,e,s){if(t&&!dn(t))return t;const n=t,i=n.wms?this.L.tileLayer.wms:this.L.tileLayer,r=MF(n,e)||"";return i(n.url,{attribution:r,maxZoom:s,...t})}_setupTileLayer(t,e,s,n){const i=this._createMapTileLayer(t,e,n);return i.once("load",(()=>{this._modules.events.fire("geoLoaded")})),i.addTo(this._map),lE(i,s),i}_onSettingsChanged(t,e){var i;const s=t.wrapCoordinates!==e.wrapCoordinates,n=t.latitudePath!==e.latitudePath||t.longitudePath!==e.longitudePath;if(s||n){let r=Promise.resolve();this._enabled&&this._filter&&(r=r.then((()=>this._filter.refresh()))),r.then((()=>this._updateNodesCoordinates(this._modules.graph.getNodes("all"))))}this._enabled&&(RF(t,e)&&this._map&&(this._map.removeLayer(this._tileLayer),this._tileLayer=this._setupTileLayer(e.tiles,e.attribution,e.opacity,e.maxZoomLevel)),t.sizeRatio!==e.sizeRatio&&this._updateSizes(),t.maxZoomLevel!==e.maxZoomLevel&&(this._modules.settings.update({minZoom:1,maxZoom:Math.pow(2,e.maxZoomLevel)}),(i=this._map)==null||i.setMaxZoom(e.maxZoomLevel),this._tileLayer&&this._tileLayer.options&&(this._tileLayer.options.maxZoom=e.maxZoomLevel)),t.disableNodeDragging!==e.disableNodeDragging&&this._setDragging(!e.disableNodeDragging),t.attributionOptions!==e.attributionOptions&&this._setAttributionOptions(e.attributionOptions,e.attribution),lE(this._tileLayer,e.opacity))}_setMapDragging(t){if(this._map){const e=t?"enable":"disable";this._map.dragging[e]()}}_fromLatLngToPoint(t,e){return this._map.options.crs.latLngToPoint(this.L.latLng(t,e),Wg)}_fromPointToLatLng(t,e){const{lat:s,lng:n}=this._map.options.crs.pointToLatLng(this.L.point({x:t,y:e}),Wg);return{latitude:s,longitude:n}}_updateSizes(){this._enabled&&this._projection&&this._projection.updateAll()}enable(t){return this.setEnabled(!0,t)}getMap(){return this._enabled?this._map:null}getOptions(){return this._enabled?{...this._settings,tiles:dn(this._settings.tiles)?{...this._settings.tiles}:this._settings.tiles}:{...Aa}}setOptions(t){if(!this._enabled||this._transition)return;IF(t,this.L);const e=this._settings;this._settings={...Aa,...e,...t,tiles:kF(Aa,t)},this._onSettingsChanged(e,this._settings)}disable(t){return this.setEnabled(!1,t)}isEnabled(){return this._enabled}toggle(t={}){return this.setEnabled(!this._enabled,t)}getContainerCoords(t){return t.getGeoCoordinates().map((({latitude:e,longitude:s})=>this._map.latLngToContainerPoint([e,s])))}getContainerCoord(t){const{latitude:e,longitude:s}=t.getGeoCoordinates();return this._map.latLngToContainerPoint([e||0,s||0])}setEnabled(t,e){if(!uE())throw new Error("Ogma Geo cannot be used outside a browser");if(!this.L)throw new Error("You are trying to use Geo mode but Leaflet has not been found. Please follow our migration guide: https://bit.ly/2SYkF8A");if(this._transition||t===this._enabled)return Promise.resolve();const s=this._modules.settings;this._enabled||(this._prevSettings=s.get(),this._nodeDraggingSetting=!!s.get("interactions.drag.enabled")),this._enabled=t,this.setOptions(e),this._transition=!0;const n=this._settings;return t?this._show(e==null?void 0:e.latitude,e==null?void 0:e.longitude,e==null?void 0:e.zoom).then((()=>(this._registerTextStyle(this._modules.graph.getNodes(),this._modules.graph.getEdges()),this._setDragging(!n.disableNodeDragging),this._transition=!1,this._updating=!1,this._modules.events.fire("geoEnabled").fire("geoReady"),this._adjustMinvisibleSizes()))):this._restoreTextStyle().then((()=>this._hide())).then((()=>{this._transition=!1,this._modules.events.fire("geoDisabled"),this._setDragging(this._nodeDraggingSetting,!0)})).then((()=>this._ogma.view.afterNextFrame()))}destroy(){return this._enabled&&this._destroyMapSync(),Promise.resolve()}_cacheOriginalTextStyles(t,e){e&&(this._edgesOriginalTextStyle=hE(e,this._edgesOriginalTextStyle)),t&&(this._nodesOriginalTextStyle=VF(t,this._nodesOriginalTextStyle))}_registerTextStyle(t,e){this._cacheOriginalTextStyles(t,e);const{nodeAttributes:s,edgeAttributes:n}=this._modules.hover.getHoverClassDefinition();this._hoverEdgesOriginalTextStyle=n||null,this._hoverNodesOriginalTextStyle=s||null,this._modules.hover.updateEdgeAttributes({text:{size:i=>(this._edgesOriginalTextStyle[i.getId()]||p1)["text.size"]}}),this._modules.hover.updateNodeAttributes({text:{size:i=>(this._nodesOriginalTextStyle[i.getId()]||p1)["text.size"]}})}_restoreTextStyle(){return this._modules.hover.updateEdgeAttributes(this._hoverEdgesOriginalTextStyle,!0),this._modules.hover.updateNodeAttributes(this._hoverNodesOriginalTextStyle,!0),Promise.all([HF(this._modules.graph.getEdges(),this._edgesOriginalTextStyle)]).then((()=>{this._edgesOriginalTextStyle=hE(this._modules.graph.edgeList(),{}),this._nodesOriginalTextStyle={},this._edgesOriginalTextStyle={}}))}_setDragging(t,e=!1){this._modules.settings.update({interactions:{drag:{enabled:t,applyResult:e}}})}_setAttributionOptions(t,e){if(this._map){if(this._attribution&&(this._attribution.remove(),this._attribution=null),this._attribution=this.L.control.attribution({prefix:!1}).addTo(this._map),dn(t)){this._attribution.setPrefix(""),t.position=t.position||"bottom-right";const s=t.position.replace("-","");this._attribution.setPosition(s);const n=this._attribution.getContainer();n&&(t.className&&this.L.DomUtil.addClass(n,t.className),pN(n,t.position||"bottom-right",t.horizontalMargin,t.verticalMargin))}e!=null&&this._attribution.addAttribution(e)}}_nodeIsVisible(t){return BF(t,this._settings,this._hasCustomProjection())}_updateSettingsForMap(){const t=this._modules.graphics.getGraphicsEngine().parseColor(this._settings.backgroundColor);t[3]=0,this._modules.settings.update({backgroundColor:N2(t),minZoom:1e-6,interactions:{rotation:{enabled:!1},drag:{enabled:!1},pan:{enabled:!1},zoom:{enabled:!1,onDoubleClick:!1}},mouse:{wheelEnabled:!1}})}getGraphPosition(t){const e=this.L.latLngBounds(zF(t));return{center:t.size>0?e.getCenter():this.L.latLng([0,0]),zoom:this._clampZoom(this._map.getBoundsZoom(e))}}_initMap(){this._updateSettingsForMap(),this._mapContainer=PF(this._modules.dom.getContainer());const t={...GR,minZoom:this._settings.minZoomLevel,maxZoom:this._settings.maxZoomLevel};this._hasCustomProjection()&&(t.crs=this._settings.crs,t.worldCopyJump=!1,t.maxBoundsViscosity=0),this._map=new this.L.Map(this._mapContainer,t),this._map.on("movestart zoomstart",(()=>{this._updating=!0})).on("moveend zoomend",(()=>{this._updating=!1})),this._setAttributionOptions(this._settings.attributionOptions,this._settings.attribution),this._setupLayers()}_clampZoom(t){let e=this._tileLayer.options.maxZoom;return e===void 0&&(e=1/0),Math.min(t,e)}_show(t,e,s){let n;return this._initMap(),this._filter?n=this.filter.enable(0):(this._filter=this._modules.transformations.api.addNodeFilter({criteria:i=>this._nodeIsVisible(i)}),this._filter.setIndex(0),n=this._filter.whenApplied()),n.then((()=>{const i=this._map,r=this._modules.graph.getNodes(),o=this._modules.graph.getEdges(),a=this.getGraphPosition(r),l=a.center;t!==void 0&&e!==void 0&&(l.lat=t,l.lng=e);const u=s??a.zoom,{offset:h,newCameraView:g}=this._transformToGeo();return this._modules.camera.setView(g,{ignoreZoomLimits:!0}).then((()=>(this._updatePrevNodesCoordinates(r),i.setView(l,u,{animate:!1}),this._modules.graphics.animate({nodes:r,edges:o},(()=>{this._projection=this._createFinalPositionLayer()}),!0,this._settings.duration)))).then((()=>h.destroy()))}))}updateProjection(){var t;(t=this._projection)==null||t.update()}_hasCustomProjection(){return this._settings.crs!=null}_setupLayers(){this._settings.tiles&&(this._tileLayer=this._setupTileLayer(this._settings.tiles,this._settings.attribution,this._settings.opacity,this._settings.maxZoomLevel)),this._layer=new this.L.OgmaOverlay({container:this._modules.graphics.getDomElement(),mapContainer:this._mapContainer,onUpdate:()=>this._onMapUpdate()}),this._layer.addTo(this._map)}_adjustMinvisibleSizes(){return Promise.all([jF(this._modules.graph.getEdges(),this._edgesOriginalTextStyle,this._map.getZoom())])}_hide(){if(!this._map)return Promise.resolve();this._modules.settings.update(this._prevSettings);const t=this._map;t.removeLayer(this._layer);const e=this._modules.dom.getContainer(),s=this._modules.graphics.getDomElement();e&&e.appendChild(s),t.getContainer().style.zIndex="0";const n=this._modules.graph.getNodes("all"),i=this._modules.graph.getEdges("all"),{offset:r,newCameraView:o}=this._transformToGraph();return this._modules.camera.setView(o||{}).then((()=>(this._modules.events.fire("beforeGeoDisabled"),Promise.all([VT(t.getContainer(),1,0,this._settings.duration/2).then((()=>this._destroyMapSync())),this._modules.graphics.animate({nodes:n,edges:i},(()=>r&&r.destroy()),!0,this._settings.duration)])))).then((()=>(this._map=null,this._filter.disable(0).then((()=>{})))))}_destroyMapSync(){if(this._map){this._layer&&this._layer._map&&this._map.removeLayer(this._layer),this._map.remove(),this._map._animatingZoom=!1,this._map=null;const t=this._mapContainer.parentNode;t&&t.removeChild(this._mapContainer)}}_transformToGeo(){const t=this._modules.graph.getNodes(),{offsetChanges:e,camera:s}=lG(t,this._modules.camera,this._modules.locate,((n,i)=>this._fromLatLngToPoint(n,i)));return{offset:this._addGraphAttributesLayer(e),newCameraView:s}}_addGraphAttributesLayer(t){return this._modules.graphics.addAttributeLayer({priority:cz,nodeSelector:e=>e.isVisible(),edgeSelector:e=>e.isVisible(),...t})}_transformToGraph(){const t=this._modules.graph.getNodes("all"),{offsetChanges:e,camera:s}=uG(t,this._modules.camera,this._modules.locate,(()=>{this._projection&&(this._projection.destroy(),this._projection=null)}));return{offset:this._addGraphAttributesLayer(e),newCameraView:s}}getPointFromLatLng(t){const{latitude:e,longitude:s}=t.getGeoCoordinates();return e==null?t.getAttributes(["x","y"]):this._fromLatLngToPoint(e,s)}_createFinalPositionLayer(){return this._addGraphAttributesLayer({name:"graph-2-geo-animation",nodeAttributes:{scalingMethod:"fixed",radius:t=>Number(t.getAttribute("radius"))*this._settings.sizeRatio,x:t=>this.getPointFromLatLng(t).x,y:t=>this.getPointFromLatLng(t).y},edgeAttributes:{scalingMethod:"fixed",width:t=>Number(t.getAttribute("width"))*this._settings.sizeRatio}})}setCenter(t,e){return this._enabled?this.setView(t,e,Fp(this._modules.camera.getZoom())):Promise.resolve()}setZoom(t){return this._enabled&&this._map?(t=this._clampZoom(t),this._map.setZoom(t),new Promise((e=>{const s=this._map;if(s.getZoom()===t)return e(void 0);s.once("moveend zoomend",e)})).then(this._onMapUpdate)):Promise.resolve()}zoomIn(){return this.setZoom(this.getZoom()+1)}zoomOut(){return this.setZoom(this.getZoom()-1)}setView(t,e,s){if(!this._enabled||!this._map)return Promise.resolve();const n=this._map;s=this._clampZoom(s);const i=this.L.latLng([t,e]);return n.setView(i,s,{animate:!1,reset:!0}),new Promise((r=>{if(n.getZoom()===s&&n.getCenter().equals(i))return r(void 0);n.once("moveend zoomend",r)})).then(this._onMapUpdate)}getView(){if(!this._enabled||!this._map)return;const t=this._map.getCenter();return{zoom:this._map.getZoom(),latitude:t.lat,longitude:t.lng}}getCenter(){if(!this._enabled||!this._map)return;const t=this._map.getCenter();return{latitude:t.lat,longitude:t.lng}}getZoom(){if(this._enabled&&this._map)return this._map.getZoom()}resetCoordinates(){if(!this._enabled||!this._projection)return;const t=this._modules.graph.getNodes();this._restorePrevNodesCoordinates(this._modules.graph.getNodes());const e=this._modules.graph.getNodeAttribute(Ar).getMultiple(t._indexes),s=this._modules.graph.getNodeAttribute(wr).getMultiple(t._indexes);t.setData(this._settings.latitudePath,e),t.setData(this._settings.longitudePath,s),this._projection.update()}getUnprojectedCoordinates(t){this._projection&&this._projection.destroy();const e=t.getPosition();return this._projection=this._createFinalPositionLayer(),e}get latitudePath(){return this._settings.latitudePath}get longitudePath(){return this._settings.longitudePath}get filter(){return this._filter}exportBackground(t){if(!this._map)return Promise.reject("Map is not ready");const{pixelRatio:e,width:s,height:n,zoom:i,x:r,y:o}=t,a=s*e,l=n*e,u=Fn(a,l),h=u.getContext("2d"),g=this._map;if(!h)throw new Error(`Unable to get 2d context from  ${u}`);const f=this.getView(),m={zoom:Math.round(Fp(i*e)),...this._fromPointToLatLng(r,o)},y=new this.L.Canvas;g.addLayer(y);const{vectorMap:p,tileLayers:x,vectorLayers:v,canvasOverlays:b,imageOverlays:S,markers:A}=oG(this._layer,g,h,this.L,e,y),w=g.options.zoomSnap;return Promise.resolve().then((()=>(Ga(this._mapContainer,a+"px",l+"px"),g.invalidateSize({animate:!1}),this.setView(m.latitude,m.longitude,m.zoom)))).then((()=>Bw([...p,...x,...b,...S,...v,...A]))).then((()=>{Ga(this._mapContainer,"100%","100%"),g.invalidateSize({animate:!1}),g.options.zoomSnap=w,this.setView(f.latitude,f.longitude,f.zoom)})).then((()=>new Promise((L=>this.L.Util.requestAnimFrame(L))))).then((()=>g.removeLayer(y))).then((()=>u))}},gG=class extends Ke{constructor(){super(...arguments),this._context={edgesAlwaysCurvy:!1,edgesRoutingStyle:"none",directedEdges:!1}}onMounted(){this._attributeLayer=this._addAttributeLayer(),this._modules.settings.register("edgesAlwaysCurvy",!1,(t=>{this._context.edgesAlwaysCurvy=t,this._attributeLayer.updateAll()})),this._modules.settings.register("directedEdges",!1,(t=>{this._context.directedEdges=t,this._attributeLayer.updateAll()})),this._modules.settings.register("edgesRoutingStyle","none",(t=>{var i;const e=t&&t!=="none",s=t==="vertical",n=(i=this._ogma.modules)==null?void 0:i.graphics.getGraphicsEngine();n&&n.setBentEdges(e,s),this._attributeLayer.updateAll()}))}computeCurvature(t,e="visible",s){const{edgesAlwaysCurvy:n,directedEdges:i}=this._context,r=t.getSource()===t.getTarget();if(!n&&t.hasParallelEdges()===!1&&!r)return 0;let o=t.getParallelEdges({filter:e});s&&(o=o.filter((u=>s(u))));const a=o.indexOf(t);if(a===-1)return 0;let l;if(r)l=(a+1)*Math.max(+t.getAttribute("width")||0,1);else{const u=t.getSource(),h=o.size;if(h===1&&!n)return 0;if(i){let g=0;for(let f=0;f<a;++f)o.get(f).getSource()===u&&(g+=1);l=g+1}else{const g=u!==o.get(0).getSource();l=h%2!=1||n?(1+(a/2|0))*(a%2==0?1:-1)*(g?-1:1):a===0?0:((a+1)/2|0)*(a%2==0?1:-1)*(g?-1:1)}}return l}_addAttributeLayer(){return this._modules.graphics.addAttributeLayer({name:"curvature",priority:lz,edgeDependencies:{parallelEdges:!0},edgeContext:this._context,edgeAttributes:{curvature:t=>this.computeCurvature(t)}})}};/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fG(t){if(typeof t!="string"||t.trim()===""){let e="Calls to uncheckedconversion functions must go through security review.";throw e+=" A justification must be provided to capture what security assumptions are being made.",new Error(e)}}function ed(t,e){return fG(e.justification),fx(t)}var _N="worker_start",yN="worker_configure",yf="worker_stop",sh="worker_update",mG=0,xN=class extends vh{constructor(t,e){super(),this._complete=!1,this._busy=!1,this._destroyed=!1,this._data=null,this._onStart=os,this._onStop=os,this._setIdle=os,this._onPause=os,this.timer={start:0,steps:0},this._modules=e,this._busy=!1,this.id=++mG,this.configure(t)}configure({configure:t=lr,update:e=os,context:s=os,stop:n=os,isRunning:i=qg,onStart:r=os,onStop:o=os,onPause:a=os,setIdle:l=os}){this._configure=t,this._update=e,this._createContext=s,this._isRunning=i,this._stop=n,this._onStart=r,this._onStop=o,this._setIdle=l,this._onPause=a}setData(t){this._data=t}getData(){return this._data}start(t){this.promise=new Promise(((s,n)=>{this.resolve=s,this.reject=n})),this._complete=!1,this._busy=!0,this._onStart(),this.fire(_N,{target:this});const e=this._configure(t,this._modules);return this.fire(yN,e),this.send(e),this}stop(t=!0){return this._complete?Promise.resolve():(this._onStop(),t&&this.send({type:yf}),this.promise.then((()=>{this.fire(yf,{target:this}),this.clearEvents(),this._complete=!0})))}pause(){this._onPause()}setIdle(t){this._setIdle(t)}isBusy(){return!this._complete||this._busy}setBusy(t){this._busy=t}getPromise(){return this.promise}destroy(){this._destroyed||(this._destroyed=!0,this._modules&&(this._busy&&this.stop(),delete this._modules))}},vN=/^function\s*\(/,bN=/^\(|^\w+\s?=>/,pG="Layout control code for the worker",sd={justification:pG};function cg(t){const e=t.toString();return e.indexOf("function")===0||bN.test(e)?e:`function ${e}`}var _G=class extends xN{constructor(t,e){super(t,e);const s=fR([ed(yG(t.imports),sd),Wu`\nconst __CONTEXT = (`,ed(cg(this._createContext),sd),Wu`)();\nconst __UPDATE_FUNC = `,ed(cg(this._update),sd),Wu`\nconst __IS_RUNNING_FUNC = `,ed(cg(this._isRunning),sd),Wu`\nconst __STOP_FN = `,ed(cg(this._stop),sd),Wu`\nlet result;
      self.addEventListener("message", function (evt) {
        if (evt.data && evt.data.type === 'worker_stop') {
          __STOP_FN(__CONTEXT);
          return self.postMessage({ result, isRunning: false, stopped: true });
        }
        result = __UPDATE_FUNC(evt.data, __CONTEXT);
        const isRunning = __IS_RUNNING_FUNC(__CONTEXT, evt.data);
        self.postMessage({ result, isRunning });
      });
    `]);this._worker=xL(s),this._worker.addEventListener("message",(n=>{e.dom.isDestroyed()||this.onWorkerMessage(n)}))}onWorkerMessage(t){const e=t.data.isRunning,s=t.data.stopped,n={data:void 0},i={worker:this,workerMessage:t.data.result,modules:this._modules,data:n,isRunning:e};if(!s)return e?(this.fire(sh,i),this.send(n.data)):(this.fire(sh,i),this.stop());this.resolve()}destroy(){super.destroy(),this._worker.terminate()}send(t){return this._complete||this._worker.postMessage(yL(t)),this}};function yG(t={}){const e=Object.keys(t),s=[];for(let n=0,i=e.length;n<i;n++){const r=e[n],o=t[r];if(typeof o!="function")throw new Error(`Asynchronous worker: dependency "${r}" is not found`);{const a=xG(o);a?(s.push(_1(o,r)),a!==r&&s.push(`var ${r} = ${a};`)):s.push(`var ${r} = ${_1(o,r)};`)}}return s.join(`
`)}function _1(t,e){const s=t.toString();return vN.test(s)?`function ${t.name||e} ${s.substring(s.indexOf("("))}`:bN.test(s)?`const ${t.name||e} = ${s.toString()}`:s}function xG(t){const e=t.toString();return t.name?t.name:vN.test(e)?null:e.substring(9,e.indexOf("(")).trim()}var vG=class extends xN{constructor(t,e){super(t,e),this._context=this._createContext()}sync(t){if(t&&t.type===yf)return this._stop(this._context),void this.resolve();const e=this._update(t,this._context),s=this._isRunning(this._context,t),n={data:void 0},i={worker:this,workerMessage:e,modules:this._modules,data:n,isRunning:s};return s?(this.fire(sh,i),this.send(n.data)):(this.fire(sh,i),this.stop())}send(t){return this._complete||this._modules.dom.setTimeout((()=>{this.sync(t)}),0),this}},bG=3,EG=class extends Ke{constructor(){super(...arguments),this._pool={}}create(t,e){const s=e&&_L,n=this._modules,i=`${t.name||"worker"}-${s?"async":"sync"}`;let r=this._pool[i];r||(r=this._pool[i]=[]);let o=r.find((a=>!a.isBusy()));return o?o.configure(t):(o=s?new _G(t,n):new vG(t,n),this._pool[i].push(o)),o.on(yf,(()=>{this._pool[i].length<=bG||(o.destroy(),this._pool[i]=this._pool[i].filter((a=>a!==o)))})),o}start(t,e){return t.start(e)}run(t,e,s){const n=this.create(t,s);return this.start(n,e)}destroy(){for(const t in this._pool)this._pool[t].forEach((e=>e.destroy())),delete this._pool[t]}};function SG(t,e,s,n=t.getNodes()){if(!e)return s?t.nodeList():n.filter((i=>i.getMetaNode()===null));if(!(e instanceof io)){if(Array.isArray(e)&&e.length>0)return t.getNodes(e);throw Error("[Layout]: 'nodes' must be a NodeList or an NodeId[]")}return e}function AG(t,e,s=t.getEdges()){if(!e)return s;if(!(e instanceof Va)){if(Array.isArray(e)&&e.length>0)return t.getEdges(e);throw Error("[Layout]: 'edges' must be a EdgeList or a valid EdgeId[]")}return e}function wG(t){if(!t.size)return;const e=new Set(t.getId());return t.getAdjacentEdges().filter((s=>s.getExtremities().getId().every((n=>e.has(n)))))}function EN(t,e={},s=!0){s||(e.edges=void 0);const n=SG(t,e.nodes,e.edges),i=AG(t,e.edges,wG(n));return{...e,nodes:n.concat(i.getExtremities()).dedupe(),edges:i}}var TG=16,y1="cubicOut",x1={duration:300,locate:!1},CG=new Set(["force"]),LG=class extends Ke{constructor(){super(...arguments),this.resolves=new Map,this._batchMode=!1,this._batchStarted=!1,this._batches=new Map,this._running=[],this._textsHidden=!1,this.onInteractionStart=()=>{this.setWorkersIdle(!0)},this.onViewChanged=()=>{this.setWorkersIdle(!1)},this.onVisibilityChange=()=>{no().hidden?this.setWorkersIdle(!0):this.setWorkersIdle(!1)},this._onWorkerUpdate=(t,e,s,n,i)=>{const{duration:r,onSync:o,onUpdate:a,dryRun:l,locate:u}=n,h=i.workerMessage,g=i.isRunning;if(o&&this._modules.dom.setTimeout((()=>o(h,this._modules,g)),r),s){const f=s(h,this._modules,g);this._modules.events.fire("layoutComputed",{type:"layoutComputed",name:e,positions:f}),a&&a(h,f,g),this._assignNodePositions(f,r,l,n.easing).then((()=>{g||this._onWorkerComplete(t,f,h,this._layouts[e],n,t.getData())})),g||u&&f&&this._animateCamera(f,u,n.duration)}else g||t.fire("taskComplete",h)},this._onWorkerComplete=(t,e,s,n,i,r)=>{for(let f=0;f<this._running.length;f++)if(this._running[f]===t){this._running.splice(f,1);break}n.onStop&&e&&n.onStop(i,e,this._modules);const o=this._batchMode&&this._batchStarted&&this._batches.get(n.name);if(o){const f=this._batches.get(n.name),m=f.subGraphs,y=f.resolves;let p=0;for(let x=0;x<m.length;x++){const v=y[x],b=m[x].length,S=p,A=new Uint32Array(r.indexes.slice(p,p+b)),w=this._modules.graph.nodeList(A),L=i.dryRun&&e?e:this.collectNodesData(w),k=w.getId(),F={before:nd({...r,indexes:A},S),current:nd({...L,indexes:A},S)};this._modules.events.fire("layoutEnd",{type:"layoutEnd",name:n.name,positions:F,ids:k}),v({name:n.name,positions:F,ids:k}),p+=b}}const a=this._modules.graph.nodeList(new Uint32Array(r.indexes)),l=i.dryRun&&e?e:this.collectNodesData(a),u=a.getId(),h={before:nd(r),current:nd(l)};if(o||this._modules.events.fire("layoutEnd",{type:"layoutEnd",name:n.name,positions:h,ids:u}),i.onEnd&&i.onEnd(s),i.skipTextDrawing&&this._textsHidden&&(this._modules.graphics.showTexts(),this._textsHidden=!1),!this.resolves.has(t))throw new Error("Worker not found");const g=this.resolves.get(t);this.resolves.delete(t),g({name:n.name,positions:h,ids:u}),t.setBusy(!1)},this._onWorkerStart=(t,e,s)=>{e.skipTextDrawing&&!this._textsHidden&&(this._modules.graphics.hideTexts(),this._textsHidden=!0);const n=this._modules.graph.getNodes(e.nodes),i=this.collectNodesData(n),r=i.ids;s.setData(i),this._modules.events.fire("layoutStart",{type:"layoutStart",name:t.name,ids:r,worker:s})}}onMounted(){this._layouts={},this.timers=new Map,this.resolves=new Map,this._modules.events.register(["layoutGetData","layoutPrepare","layoutStart","layoutEnd","layoutComputed"]),this._modules.events.on("clearGraph",(()=>this.stop())).on(["dragStart","zoomStart"],this.onInteractionStart).on(["dragEnd","viewChanged"],this.onViewChanged),this._modules.dom.addDocumentEventListener("visibilitychange",this.onVisibilityChange)}setWorkersIdle(t){this._running.forEach((e=>e.setIdle(t)))}register(t){if(this._layouts[t.name])throw new Error(`Layout ${t.name} already exists`);this._layouts[t.name]=t}getAvailableLayouts(){return Object.keys(this._layouts)}enableBatching(){this._batchMode||(this._batches.clear(),this._batchMode=!0,this._batchStarted=!1)}runBatch(){const t=Array.from(this._batches.keys());return this._batchStarted=!0,Promise.all(t.map((e=>{const s=this._batches.get(e);return s.options.groups=s.subGraphs,this.start(e,s.options)}))).finally((()=>{this._batchStarted=!1,this._batches.clear(),this._batchMode=!1}))}_addToBatch(t,e,s){e.nodes.isList||(e.nodes=this._modules.graph.getNodes(e.nodes));const n=e.nodes.size;if(e.edges.isList||(e.edges=this._modules.graph.getEdges(e.edges)),!this._batches.has(t))return this._batches.set(t,{resolves:[s],subGraphs:[Array.from({length:n}).map(((o,a)=>a))],options:e});const i=this._batches.get(t);i.resolves.push(s);const r=i.options.nodes.size;i.options.nodes=i.options.nodes.concat(e.nodes),i.options.edges=i.options.edges.concat(e.edges),i.options.xs&&e.xs&&(i.options.xs=i.options.xs.concat(e.xs)),i.options.ys&&e.ys&&(i.options.ys=i.options.ys.concat(e.ys)),i.options.rs&&e.rs&&(i.options.rs=i.options.rs.concat(e.rs)),i.subGraphs.push(Array.from({length:n}).map(((o,a)=>a+r)))}start(t,e={}){const s=this._layouts[t];this._modules.events.fire("layoutPrepare",{name:t,params:e});const n=EN(this._modules.graph,e,["radial","grid"].indexOf(t)===-1);return new Promise((i=>{if(!s)throw new Error(`layout ${t} does not exist`);if(this._batchMode&&!this._batchStarted&&CG.has(t))return this._addToBatch(t,n,i);n.duration=typeof n.duration=="number"?n.duration:x1.duration;const r=s.onSync;n.skipTextDrawing=n.skipTextDrawing===void 0?!0:!!n.skipTextDrawing;let o=n.locate||x1.locate;o&&typeof o=="boolean"&&(o={}),n.locate=o;const a={name:t,update:s.update,isRunning:s.isRunning,configure:s.configure,context:s.context,imports:s.imports,stop:s.stop,setIdle:s.setIdle};this._modules.graphics.forceAttributesComputation();const l=n.useWebWorker===void 0?!0:!!n.useWebWorker,u=this._modules.workers.create(a,l);this.resolves.set(u,i),u.on(_N,(()=>{var h;(h=s.onStart)==null||h.call(s,e),this._onWorkerStart(s,n,u)})).on(yN,(h=>{this._modules.events.fire("layoutGetData",{name:t,data:h})})).on(sh,(h=>{const g=h.workerMessage,f=g.lastUpdate||-1/0,m=h.isRunning,y=$n();m&&(!n.continuous||y-f<TG)||(g.lastUpdate=y,this._onWorkerUpdate(u,t,r,n,h))})),this._modules.workers.start(u,n),this._running.push(u)}))}_animateCamera(t,e,s){if(t.indexes.length===0)return Promise.resolve();const n=this._modules.locate.layoutDataBoundingBox(t),i=this._modules.locate.computeConfigForBounds(n,e);return this._modules.camera.setView(i,{duration:s,easing:e.easing||y1,ignoreZoomLimits:!0})}stop(){for(;this._running.length!==0;){const t=this._running.pop();t.stop(),t.fire("taskComplete",null)}return Promise.resolve()}isRunning(){return this._running.length!==0}_assignNodePositions(t,e,s,n=y1){if(!t||s){const u=t?new Uint32Array(t.indexes):void 0,h=this._modules.graph.nodeList(u);return Promise.resolve(h)}const{indexes:i,x:r,y:o}=t,a=this._modules.graph.nodeList(new Uint32Array(i)),l=nd(t);for(let u=0;u<l.length;u++)l[u]={x:r[u],y:o[u]};return a.setAttributes(l,{duration:e,easing:n})}collectNodesData(t){const e=t._indexes,s=this._modules.graph.getNodeAttribute("x").getMultiple(e),n=this._modules.graph.getNodeAttribute("y").getMultiple(e);return{ids:t.getId(),indexes:e,x:s,y:n}}};function nd({x:t,y:e,indexes:s},n=0){const i=s.length,r=new Array(i);for(let o=0;o<i;o++)r[o]={x:t[o+n],y:e[o+n]};return r}function v1(t){return typeof t=="number"&&isNaN(t)}var b1=class{constructor(){this._keys=[],this._values=[]}set(t,e){const s=this._getIndex(t);return s===-1?(this._keys.push(t.slice()),this._values.push(e),!0):(this._values[s]=e,!1)}get(t){const e=this._getIndex(t);return e===-1?void 0:this._values[e]}has(t){return this._getIndex(t)!==-1}delete(t){const e=this._getIndex(t);return e!==-1&&(this._keys.splice(e,1),this._values.splice(e,1),!0)}keys(){return this._keys.map((t=>t.slice()))}values(){return this._values.slice()}_getIndex(t){for(let e=0;e<this._keys.length;e++){const s=this._keys[e];if(s.length===t.length){let n=!0;for(let i=0;i<t.length;i++){const r=s[i],o=t[i];if(!(r===o||v1(r)&&v1(o))){n=!1;break}}if(n)return e}}return-1}get size(){return this._keys.length}},NG=class{constructor(){this._map=new Map,this._arrays=new b1}clear(){return this._arrays=new b1,this._map.clear()}delete(t){return Rn(t)?this._arrays.delete(t):this._map.delete(t)}get(t){return Rn(t)?this._arrays.get(t):this._map.get(t)}set(t,e){return Rn(t)?this._arrays.set(t,e):this._map.set(t,e),this}keys(){return[...M2(this._map),...this._arrays.keys()]}values(){return[...I2(this._map),...this._arrays.values()]}get size(){return this._map.size+this._arrays.size}},MG=class{constructor(t,e,{path:s,filter:n,unwindArrays:i}){this._module=t,this._isNode=e,this._path=s||[],this._filter=n,this._unwindArrays=i,this._onUpdateHandlers=[],this._triggerUpdate=r=>{for(let o=0;o<this._onUpdateHandlers.length;++o)this._onUpdateHandlers[o](r)},this._info=t.watchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}onUpdate(t){this._onUpdateHandlers.push(t)}getPropertyInfo(){return this._info}getPath(){return this._path.slice()}destroy(){this._module.unwatchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}},IG=class{constructor(t,e,{path:s,filter:n,unwindArrays:i}){this._module=t,this._isNode=e,this._path=s,this._filter=n,this._unwindArrays=i,this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[]}get path(){return this._path}onPropertyAdded(t){return this._onAddHandlers.push(t),this}onPropertyRemoved(t){return this._onRemoveHandlers.push(t),this}onPropertyUpdated(t){return this._onUpdateHandlers.push(t),this}getPath(){return this._path.slice()}getProperties(){return this._propertyList.slice()}getPropertyInfo(t){const e=this._properties[t];return e?e.info:null}destroy(){Cr(this._properties,(({handler:e},s)=>{const n=this._path.concat([s]);this._module.unwatchPropertyInformation(this._isNode,n,e,this._filter,this._unwindArrays)})),this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[];const t=this._module._objectPropertyWatchers.indexOf(this);this._module._objectPropertyWatchers.splice(t,1)}updateSubPropertiesToWatch(t,e){if(t!==this._isNode)return;const s=e.getData(this._path);for(let n=0;n<s.length;n++){const i=s[n];if(Oa(i)){const r=Object.keys(i);for(let o=0;o<r.length;o++)this._addSubPropertyToWatch(r[o])}}}_addSubPropertyToWatch(t){if(!this._properties[t]){const e=this._path.concat([t]),s=()=>this._triggerPropertyUpdate(t),n=this._unwindArrays,i=this._isNode,r=this._filter,o=this._module.watchPropertyInformation(i,e,s,r,n);this._properties[t]={handler:s,info:o},this._triggerPropertyUpdate(t)}}_triggerPropertyUpdate(t){const{info:e}=this._properties[t],s=this._propertyList.indexOf(t),n=s!==-1,i=e.getType()!=="undefined";!n&&i?(this._propertyList.push(t),this._triggerHandlers("_onAddHandlers",t,e),this._triggerHandlers("_onUpdateHandlers",t,e)):n&&!i?(this._propertyList.splice(s,1),this._triggerHandlers("_onUpdateHandlers",t,e),this._triggerHandlers("_onRemoveHandlers",t,e)):n&&i&&this._triggerHandlers("_onUpdateHandlers",t,e)}_triggerHandlers(t,e,s){const n=this[t];for(let i=0,r=n.length;i<r;i++)n[i](e,s)}},kG=class{constructor(){}setWatcher(t){this._watcher=t}isNode(){return this._watcher.isNode}getPath(){return this._watcher.property.slice()}getBoundaries(){const t=this._watcher.boundaries;return t?{min:t.min,max:t.max}:null}getValues(){return this._watcher.values.keys()}getValueCount(t){return this._watcher.values.get(t)||0}getCount(){return this._watcher.total}getType(){return this._watcher.any>0?"any":this._watcher.numbers>0?"number":"undefined"}},RG=class extends Ke{constructor(){super(...arguments),this._onExcludedStateChange=({elements:t,value:e})=>{const s=!e;for(let n=0,i=this._propertyWatchers.length;n<i;n++){const r=this._propertyWatchers[n];r.isNode===t.isNode&&r.filter==="visible"&&(s?bd(r,t.getData(r.property)):Bg(r,t.getData(r.property)),gg(r))}},this._onDataChange=({isNode:t,changes:e})=>{for(let s=0;s<this._propertyWatchers.length;++s){const n=this._propertyWatchers[s],i=n.property,r=n.filter==="all";if(n.isNode===t)for(let o=0;o<e.length;++o){const a=e[o],l=zG(a.property||[],i);if(l){const u=a.nodes||a.edges,h=[],g=[];if(u)for(let f=0;f<u.size;++f){const m=u.get(f);(r||m.isVisible())&&(h.push(qs(a.newValues[f],l)),g.push(qs(a.previousValues[f],l)))}h.length&&(bd(n,h),Bg(n,g),gg(n))}}}for(let s=0,n=this._objectPropertyWatchers.length;s<n;s++){const i=this._objectPropertyWatchers[s],r=i.path;for(let o=0;o<e.length;++o){const{property:a,nodes:l,edges:u}=e[o],h=l||u;if(h){const g=h.isNode;(!a||a.length<=r.length+1&&r.every(((f,m)=>f===a[m])))&&i.updateSubPropertiesToWatch(g,h)}}}},this._onElementsAdded=t=>{const e=t.nodes||t.edges;for(let s=0;s<this._propertyWatchers.length;++s){const n=this._propertyWatchers[s];if(n.isNode===e.isNode){const i=e.getData(n.property);i.length&&(bd(n,i),gg(n))}}for(let s=0;s<this._objectPropertyWatchers.length;s++)this._objectPropertyWatchers[s].updateSubPropertiesToWatch(e.isNode,e)},this._onElementsRemoved=t=>{const e=t.nodes||t.edges;for(let s=0;s<this._propertyWatchers.length;++s){const n=this._propertyWatchers[s],i=n.filter==="all";if(n.isNode===e.isNode&&i){const r=e.getData(n.property);r.length&&(Bg(n,r),gg(n))}}},this._onGraphClear=()=>{this._propertyWatchers.forEach((t=>{t.numbers=0,t.any=0,t.total=0,t.boundaries=null,t.values.clear()}))}}onMounted(){this._propertyWatchers=[],this._objectPropertyWatchers=[],this._modules.events.on("excludedStateChange",this._onExcludedStateChange).on(["updateNodeData","updateEdgeData"],this._onDataChange).on(["addNodes","addEdges"],this._onElementsAdded).on(["removeNodes","removeEdges"],this._onElementsRemoved).on("clearGraph",this._onGraphClear)}watchNodeObjectProperty(t){return this._watchObjectProperty(!0,fg(t))}watchEdgeObjectProperty(t){return this._watchObjectProperty(!1,fg(t))}watchNodeNonObjectProperty(t){return this._watchNonObjectProperty(!0,fg(t))}watchEdgeNonObjectProperty(t){return this._watchNonObjectProperty(!1,fg(t))}watchPropertyInformation(t,e,s,n,i){const r=this._findWatcher(t,e,n,i)||this._createWatcher(t,e,n,i);return s&&r.onChange.push(s),r.info}unwatchPropertyInformation(t,e,s,n,i){const r=this._findWatcher(t,e,n,i);if(!r)return;const o=r.onChange,a=o.indexOf(s);if(a!==-1&&(o.splice(a,1),o.length===0)){const l=this._propertyWatchers.indexOf(r);this._propertyWatchers.splice(l,1)}}_watchObjectProperty(t,e){const s=new IG(this,t,e);return this._objectPropertyWatchers.push(s),s.updateSubPropertiesToWatch(t,this._modules.graph[t?"getNodes":"getEdges"](e.filter)),s}_watchNonObjectProperty(t,e){return new MG(this,t,e)}_findWatcher(t,e,s,n){for(let i=0;i<this._propertyWatchers.length;++i){const r=this._propertyWatchers[i];if(r.isNode===t&&r.filter===s&&r.unwindArrays===n&&PG(r.property,e))return r}return null}_createWatcher(t,e,s,n){const i={isNode:t,property:e,numbers:0,any:0,total:0,values:new NG,boundaries:null,onChange:[],filter:s,unwindArrays:n,info:new kG};return i.info.setWatcher(i),bd(i,this._modules.graph[t?"getNodes":"getEdges"](s).getData(e)),this._propertyWatchers.push(i),i}};function E1(t){return t==null?[]:Da(t)}function FG(t){return t==="all"?"all":"visible"}function gg(t){for(let e=0;e<t.onChange.length;++e)t.onChange[e](t.info)}function PG(t,e){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(t[s]!==e[s])return!1;return!0}function zG(t,e){if(t.length>e.length)return null;let s=0;for(;s<t.length;++s)if(t[s]!==e[s])return null;return e.slice(s)}function bd(t,e,s){const n=t.values,i=!s&&t.unwindArrays;for(let r=0;r<e.length;++r){const o=e[r];if(s||o===void 0||(t.total+=1),i&&Array.isArray(o))bd(t,o,!0);else{const a=n.get(o);a?n.set(o,a+1):(n.set(o,1),Vf(o)?(t.boundaries?o<t.boundaries.min?t.boundaries.min=o:o>t.boundaries.max&&(t.boundaries.max=o):t.boundaries={min:o,max:o},t.numbers+=1):o!==void 0&&(t.any+=1))}}}function Bg(t,e,s){const n=t.values,i=!s&&t.unwindArrays,r=t.boundaries;let o=!1;for(let a=0;a<e.length;++a){const l=e[a];if(s||l===void 0||(t.total-=1),i&&Array.isArray(l))o=o||Bg(t,l,!0);else{const u=n.get(l);u>1?n.set(l,u-1):(n.delete(l),Vf(l)?(t.numbers-=1,!r||r.min!==l&&r.max!==l||(o=!0)):l!==void 0&&(t.any-=1))}}return!s&&o&&(t.boundaries=DG(n.keys())),o}function DG(t){let e=null,s=null;for(let n=0;n<t.length;++n){const i=t[n];Vf(i)&&((e==null||i<e)&&(e=i),(s==null||i>s)&&(s=i))}return e==null||s==null?null:{min:e,max:s}}function fg(t){return typeof t!="object"||t===null||Array.isArray(t)?{path:E1(t),filter:"visible",unwindArrays:!1}:{path:E1(t.path),filter:FG(t.filter||"visible"),unwindArrays:!!t.unwindArrays}}var OG=class extends Ke{onMounted(){this._modules.events.register(["virtualDown","virtualUp","virtualMove","virtualClick","virtualDoubleClick","virtualWheel"])}get x(){return this._modules.position.x||0}get y(){return this._modules.position.y||0}_later(){return this._modules.dom.afterNextFrame()}move({x:t,y:e}){if(t!==void 0&&e!==void 0){const s=t-this.x,n=e-this.y;this._modules.events.fire("virtualMove",{x:t,y:e,dx:s,dy:n})}return Promise.resolve()}down({x:t,y:e,button:s="left"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualDown",{x:this.x,y:this.y,button:s}),this._modules.events.fire("virtualMove",{x:this.x,y:this.y,dx:0,dy:0,button:s})}))}up({x:t,y:e,button:s="left"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualUp",{x:t,y:e,button:s})}))}click({x:t,y:e,button:s="left"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualClick",{x:t,y:e,button:s})}))}rightClick({x:t,y:e,button:s="right"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualClick",{x:t,y:e,button:s})}))}doubleclick({x:t,y:e,button:s="left"}={}){return this.move({x:t,y:e}).then((()=>{this._modules.events.fire("virtualDoubleClick",{x:t,y:e,button:s})}))}drag(t,e){return this.down(t).then((()=>this.move(e))).then((()=>this.up(e)))}wheel({x:t,y:e,dx:s,dy:n,delta:i,metaKey:r,ctrlKey:o}){return this.move({x:t,y:e}).then((()=>(this._modules.events.fire("virtualWheel",{x:t,y:e,dx:s,dy:n,delta:i,domEvent:{metaKey:r,ctrlKey:o}}),this._later())))}};function zi(t,e,s,n,i,r){const o=mi(),a=r.graphToScreenCoordinates(t),l=r.graphToScreenCoordinates(e);i.beginPath(),i.moveTo(a.x*o,a.y*o),i.lineTo(l.x*o,l.y*o),i.strokeStyle=n,i.lineWidth=s,i.stroke()}function S1(t,e,s,n){let i,r,o,a=0,l=t.length-1;for(;a<l&&a>-1;)if(i=(a+l)/2|0,r=Math.abs(e[t[i]]-s),o=Math.abs(e[t[i+1]]-s),o<r)a=i+1;else if(o>r)l=i;else{const u=Math.abs(e[t[a]]-s),h=Math.abs(e[t[l]]-s);if(u<h)l=i;else{if(!(u>h))return l;a=i+1}}return n?l:t[l]}function A1(t,e,s,n,i,r,o){let a,l,u,h,g,f;for(let m=0,y=t.length;m<y;m++)for(let p=0;p<y;p++){if(m===p)continue;let x=t[m],v=t[p];p<m&&(h=v,v=x,x=h);const b=e[x],S=e[v],A=r.get(x),w=r.get(v);if(b+A<n-i&&S-w>n+i&&Math.abs(Math.abs(b+A-(n-i))-Math.abs(S-w-(n+i)))<=o)return a=x,l=s,u=v,f=b+A+Math.abs(S-w-(b+A))/2,g=[b+A,f-i,f+i,S-w],{a,b:l,c:u,current:s,target:f,points:g};if(b+A<n-i&&S+w<n-i&&Math.abs(Math.abs(b+A-(S-w))-Math.abs(Math.max(b+A,S+w)-(n-i)))<=o)return a=x,l=v,u=s,f=S+A+Math.abs(Math.abs(b+A-(S-w)))+i,g=[b+A,S-w,S+w,f-i],{a,b:l,c:u,current:s,target:f,points:g};if(b-A>n+i&&S-w>n+i&&Math.abs(Math.abs(b+A-(S-w))-Math.abs(Math.min(b-A,S-w)-(n+i)))<=o)return a=s,l=x,u=v,f=b-A-Math.abs(Math.abs(b+A-(S-w)))-i,g=[f+i,b-A,b+A,S-w],{a,b:l,c:u,current:s,target:f,points:g}}return null}var o_={enabled:!1,tolerance:5,centerSnapDistance:240,sideSnapDistanceFactor:3,guidelineWidth:1,guidelineColor:"#ff0000",preferredDistance:{enabled:!0,ratio:1.13,tolerance:10,lineColor:"#00C3FF",lineWidth:1},neighbours:{enabled:!0,offset:5,tolerance:3,lineColor:"#00C3FF",lineWidth:1}},BG=class extends Ke{constructor(){super(...arguments),this._options=Ws(o_),this._enabled=!1,this._ysnap=0,this._xsnap=0,this._node=null,this._nodes=null,this._r=0,this._vguideline={start:{x:0,y:0},end:{x:0,y:0}},this._hguideline={start:{x:0,y:0},end:{x:0,y:0}},this._gridResolution=0,this._onNodeDragStart=({nodes:t})=>{t.size===1&&(this._node=t.get(0),this._cacheViewportData(),this._r=Number(this._node.getAttribute("radius")))},this._onNodeDragEnd=()=>{this._node=null,this._layer.refresh()}}onMounted(){this._options=Ws(o_),this._enabled=!1}enable(t){this._enabled||(this._options=Ci(t,o_),this._enabled=!0,this._layer=this._modules.layers.addCanvasLayer((e=>{e.clearRect(0,0,e.canvas.width,e.canvas.height)}),{isStatic:!0,noClear:!1}),this._layer.moveToTop(),this._modules.events.on("nodesDragStart",this._onNodeDragStart).on("nodesDragEnd",this._onNodeDragEnd),this._modules.settings.update({"interactions.drag.onBeforeDrag":(e,s,n,i)=>this._onBeforeDrag(s,n,i)}))}disable(){this._enabled&&(this._modules.events.off(this._onNodeDragStart).off(this._onNodeDragEnd),this._layer.destroy(),this._modules.settings.update({"interactions.drag.onBeforeDrag":null}),this._enabled=!1)}enabled(){return this._enabled}_onBeforeDrag(t,e,s){if(this._node){const n=s[0];this._layer.refresh((i=>{this._scan(i,n)})),this._node.setAttributes(n)}}_cacheViewportData(){const t=this._modules.camera,e=t.screenToGraphCoordinates({x:0,y:0}),s=t.screenToGraphCoordinates({x:t.width,y:t.height});if(this._nodes=this._modules.spatial.getNodesByBoundingBox(e.x,e.y,s.x,s.y),this._node==null)return;const n=this._node._index,i=Array.from(this._nodes._indexes);i.splice(i.indexOf(n),1);const r=this._modules.graph.getNodeAttribute("radius"),o=this._modules.graph.getNodeAttribute("x"),a=this._modules.graph.getNodeAttribute("y"),l=o.buffer(),u=a.buffer(),h=ud(i.slice(),o),g=ud(i.slice(),a),f={},m={};this._gridResolution=Number(this._node.getAttribute("radius"));const y=this._gridResolution;for(let p=0,x=i.length;p<x;p++){const v=h[p],b=g[p],S=l[v]/y|0,A=u[b]/y|0;f[S]||(f[S]=[]),m[A]||(m[A]=[]),f[S].push(v),m[A].push(b)}this._nodesByX=h,this._nodesByY=g,this._xGrid=f,this._yGrid=m,this._xList=o,this._yList=a,this._X=l,this._Y=u,this._R=r}_scan(t,e){if(this._node==null)return;const s=this._node._index,n=e.x,i=e.y,r=this._r,o=this._options,a=this._xList,l=this._yList,u=this._R,h=this._X,g=this._Y,f=this._modules.camera.zoom,m=Math.min(r,this._options.tolerance/f),y=2*r*o.sideSnapDistanceFactor,p=o.guidelineWidth,x=o.guidelineColor;let v,b,S,A,w,L,k,F,O=s,j=s,V=null,Z=!1,at=!1;if(O=S1(this._nodesByX,h,n),j=S1(this._nodesByY,g,i),Math.abs(h[O]-n)>o.centerSnapDistance&&(O=s),Math.abs(g[j]-i)>o.centerSnapDistance&&(j=s),this._xsnap=0,O!==s){v=this._vguideline.start,b=this._vguideline.end,F=O,S=h[F],A=g[F],V=u.get(F),k=Math.abs(n-S);const mt=Math.abs(n-r-(S-V)),K=Math.abs(n+r-(S+V));if(k<Math.max(r,V)){A<i?(v.y=A-V,b.y=i+r):(v.y=A+V,b.y=i-r);const ut=Math.min(mt,k,K);ut===k?(v.x=b.x=S,b.y=i,v.y=A,this._xsnap=1):Math.abs(i-A)<V+r+y&&(ut===mt?(v.x=b.x=S-V,this._xsnap=2):(v.x=b.x=S+V,this._xsnap=3)),ut<m&&(Z=!0)}this._xsnap!==0&&zi(v,b,p,x,t,this._modules.camera)}if(this._ysnap=0,j!==s){v=this._hguideline.start,b=this._hguideline.end,F=j,S=h[F],A=g[F],V=u.get(F),k=Math.abs(i-A);const mt=Math.abs(i-r-(A-V)),K=Math.abs(i+r-(A+V));if(k<Math.max(r,V)){S<n?(v.x=S-V,b.x=n+r):(v.x=S+V,b.x=n-r);const ut=Math.min(mt,k,K);ut===k?(v.y=b.y=A,b.x=n,v.x=S,this._ysnap=1):Math.abs(n-S)<V+r+y&&(ut===mt?(v.y=b.y=A-V,this._ysnap=4):(v.y=b.y=A+V,this._ysnap=5)),ut<m&&(at=!0)}this._ysnap!==0&&zi(v,b,p,x,t,this._modules.camera)}if(V!=null&&o.preferredDistance.enabled){const mt=o.preferredDistance.ratio,K=Math.min(o.preferredDistance.tolerance/f,r),ut=Math.max(r,V);if(O===s||this._xsnap!==0&&Z){if(j!==s&&(this._ysnap===0||!at)&&(F=j,S=h[F],A=g[F],V=u.get(F),L=Math.abs(i-A)-(r+V)*(1+mt),L<=K&&L>=-K)){const ht=i<A?-1:1;v=this._hguideline.start,b=this._hguideline.end,v.x=S-ut,b.x=S+ut,v.y=b.y=A,zi(v,b,p,x,t,this._modules.camera),v.x=n-ut,b.x=n+ut,v.y=b.y=A+ht*(1+mt)*(r+V),zi(v,b,p,x,t,this._modules.camera),this._ysnap=1,at=!0}}else if(F=O,S=h[F],A=g[F],V=u.get(F),w=Math.abs(n-S)-(r+V)*(1+mt),w<=K&&w>=-K){const ht=n<S?-1:1;v=this._vguideline.start,b=this._vguideline.end,v.x=b.x=S+ht*(1+mt)*(r+V),v.y=A-ut,b.y=A+ut,v.x=b.x=S,zi(v,b,p,x,t,this._modules.camera),v.y=i-ut,b.y=i+ut,v.x=b.x=S+ht*(1+mt)*(r+V),zi(v,b,p,x,t,this._modules.camera),this._xsnap=1,Z=!0}}if(o.neighbours.enabled){const mt=this._gridResolution,K=n/mt|0,ut=i/mt|0,ht=this._xGrid,nt=this._yGrid,ot=[],Mt=[].concat(nt[ut-1]||ot,nt[ut]||ot,nt[ut+1]||ot),Q=[].concat(ht[K-1]||ot,ht[K]||ot,ht[K+1]||ot);let Et;Mt.length>1&&(ud(Mt,a),Et=A1(Mt,h,s,n,r,u,m),Et&&(this._drawNeighbourGuidelines(t,Et,e,!1),Z=!1)),Q.length>1&&!Et&&(ud(Q,l),Et=A1(Q,g,s,i,r,u,m),Et&&(this._drawNeighbourGuidelines(t,Et,e,!0),at=!1))}(Z||at)&&this._snap(e,!Z,!at)}_drawNeighbourGuidelines(t,{a:e,b:s,c:n,points:i,target:r},o,a){const l={x:0,y:0},u={x:0,y:0},h=this._R,g=this._X,f=this._Y;let[m,y,p]=h.getMultiple([e,s,n]);const{offset:x,lineWidth:v,lineColor:b}=this._options.neighbours;let S,A;a?(o.y=r,m=-m,y=-y,p=-p,S=u.x=l.x=Math.min(g[e]+m,g[s]+y,g[n]+p)-x,A=g):(o.x=r,S=u.y=l.y=Math.max(f[e]+m,f[s]+y,f[n]+p)+x,A=f);const w=a?"y":"x",L=a?"x":"y";l[w]=i[0],u[w]=i[1],zi(l,u,v,b,t,this._modules.camera),l[w]=i[2],u[w]=i[3],zi(l,u,v,b,t,this._modules.camera),l[w]=i[0],l[L]=S-x/2,u[w]=i[0],l[L]=A[e]+m,zi(l,u,v,b,t,this._modules.camera),l[w]=i[1],l[L]=S-x/2,u[w]=i[1],l[L]=A[s]+y,zi(l,u,v,b,t,this._modules.camera),l[w]=i[2],l[L]=S-x/2,u[w]=i[2],l[L]=A[s]+y,zi(l,u,v,b,t,this._modules.camera),l[w]=i[3],l[L]=S-x/2,u[w]=i[3],l[L]=A[n]+p,zi(l,u,v,b,t,this._modules.camera)}_snap(t,e,s){const n=this._xsnap,i=this._ysnap;let r;e||n===0||(r=this._vguideline.end,t.x=n===2?r.x+this._r:n===3?r.x-this._r:r.x),s||i===0||(r=this._hguideline.end,t.y=i===4?r.y+this._r:i===5?r.y-this._r:r.y)}},UG=class{constructor(t,e,s){this._module=t,this._id=e,this._whenApplied=s.then((()=>this))}getId(){return this._id}whenApplied(){return this._whenApplied}refresh(){return this._module.refreshRule(this._id)}getIndex(){return this._module.getRuleIndex(this._id)}setIndex(t){return this._module.setRuleIndex(this._id,t)}update(t){return this._module.updateRule(this._id,t)}getDefinition(){return this._module.getRuleDefinition(this._id)}destroy(){return this._module.destroyRule(this._id)}},GG=1e3,VG=1/GG,jG=class extends Ke{constructor(){super(...arguments),this._idCounter=1,this._rules=[]}onMounted(){this._rules=[],this._modules.events.register(["addStyleRule","removeStyleRule","updateStyleRule","refreshStyleRule"])}_get(t){for(let e=0;e<this._rules.length;++e){const s=this._rules[e];if(s.id===t)return s.index=e,s}throw new Error("calling a method on a destroyed style rule")}_updatePriorities(){for(let t=0;t<this._rules.length;++t){const e=this._rules[t],s=uz+t*VG;e.attributeLayer.update({priority:s})}}addRule(t={}){const e=this._idCounter++,s=this._modules.graphics.addAttributeLayer({name:`rule(${e})`,...w1(t)}),n=this._modules.dom.afterNextFrame(),i=new UG(this,e,n),r={id:e,attributeLayer:s,wrapper:i};return this._rules.push(r),this._updatePriorities(),this._modules.events.fire("addStyleRule",{rule:r,options:t,id:r.id}),i}getRuleIndex(t){const e=this._get(t);return e.index==null?null:e.index}setRuleIndex(t,e){const s=this._get(t),n=$i(e,0,this._rules.length-1);return this._rules.splice(s.index,1),this._rules.splice(n,0,s),this._updatePriorities(),this._modules.dom.afterNextFrame()}updateRule(t,e){const s=this._get(t),n=Object.assign({fullOverwrite:e.fullOverwrite},e);return s.attributeLayer.update(n),this._modules.events.fire("updateStyleRule",{rule:s,options:e}),this._modules.dom.afterNextFrame()}getRuleDefinition(t){return w1(this._get(t).attributeLayer.getDefinition())}destroyRule(t){const e=this._get(t);return this._modules.events.fire("removeStyleRule",{rule:e,id:e.id}),e.attributeLayer.destroy(),this._rules.splice(e.index,1),this._modules.dom.afterNextFrame()}refreshRule(t){const e=this._get(t);return e.attributeLayer.updateAll(),this._modules.events.fire("refreshStyleRule",{rule:e,id:t}),this._modules.dom.afterNextFrame()}refreshAllRules(){for(const t of this._rules)t.attributeLayer.updateAll(),this._modules.events.fire("refreshStyleRule",{rule:t,id:t.id});return this._modules.dom.afterNextFrame()}getRuleList(){return this._rules.map((t=>t.wrapper))}};function w1(t){return{nodeAttributes:t.nodeAttributes,edgeAttributes:t.edgeAttributes,nodeSelector:t.nodeSelector,edgeSelector:t.edgeSelector,nodeDependencies:t.nodeDependencies,edgeDependencies:t.edgeDependencies,nodeOutput:t.nodeOutput,edgeOutput:t.edgeOutput}}var Py,T1={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:({nodes:t})=>t.setSelected(!0),bothExtremities:!1},SN=class extends Ke{constructor(){super(...arguments),this._enabled=!1,this._points=[],this._bbox=new ii,this._onStart=({x:t,y:e})=>{this._bbox.reset(),this.savePoint(t,e,!1)},this._onStop=()=>{const{minX:t,minY:e,maxX:s,maxY:n}=this._bbox,{nodes:i,edges:r}=this._modules.spatial.queryProjected(t,e,s,n),o={},a=i.filter((h=>{const g=h.isVisible(),f=h.getAttribute("detectable"),m=g&&f&&this._modules.locate.isNodeInPolygon(h,this._points);return o[h._index]=m,m}));let l=r.filter((h=>{const g=h.isVisible(),f=h.getAttribute("detectable");return g&&f&&this._modules.locate.isEdgeInPolygon(h,this._points)}));this._options.bothExtremities&&(l=this.filterByExtremities(l,o)),this._layer.clear();const u=this._points.slice();this._points=[],this.disable(),this._options.callback({nodes:a,edges:l,points:u})}}onMounted(){this._options=Ws(T1),this._cachedCursor="",this._modules.events.isRegistered("lassoEnabled")||this._modules.events.register(["lassoEnabled","lassoDisabled"]),this._interaction=this._modules.interactions.onDrag({priority:"lasso",check:()=>this._enabled,onStart:this._onStart,onProgress:({x:t,y:e})=>this.savePoint(t,e,!0),onStop:this._onStop})}enable(t={}){var e;return this._enabled||(this._enabled=!0,this._modules.captor.setDetectionEnabled(!1),this._options=Ci(t,T1),this._layer=this._modules.layers.addCanvasLayer(os,{isStatic:!0,noClear:!1}),this._layer.moveToTop(),this._cachedCursor=((e=this._layer.element.parentElement)==null?void 0:e.style.cursor)||"",ef(this._layer.element.parentElement,this._options.cursorStyle),this._modules.captor.isLeftPressed()&&this._interaction.start(this._modules.captor.getCursorPosition()),this._modules.events.fire("lassoEnabled")),this}disable(){return this._enabled?(this._enabled=!1,this._modules.captor.setDetectionEnabled(!0),ef(this._layer.element.parentElement,this._cachedCursor),this._layer.destroy(),this._modules.events.fire("lassoDisabled"),this):this}enabled(){return this._enabled}savePoint(t,e,s){const n=mi(),i=this._options,r=this._points;if(this._bbox.addPoint(t,e),r.push({x:t,y:e}),s){const o=r[0];this._layer.refresh((a=>{a.lineWidth=i.strokeWidth,a.lineJoin="bevel",a.strokeStyle=i.strokeColor,a.fillStyle=i.fillColor,a.beginPath(),a.moveTo(o.x*n,o.y*n);for(let l=1;l<r.length;++l){const u=r[l];a.lineTo(u.x*n,u.y*n)}a.stroke(),i.fillColor&&a.fill()}))}}filterByExtremities(t,e){const s=this._modules.graph.getEdgeAttribute("source"),n=this._modules.graph.getEdgeAttribute("target");return t.filter((i=>{const r=i._index,o=s.get(r),a=n.get(r);return e[o]&&e[a]}))}},C1={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:({nodes:t,edges:e})=>{t.size?t.setSelected(!0):e.setSelected(!0)},bothExtremities:!1},HG=class extends SN{constructor(){super(...arguments),this._onStart=({x:t,y:e})=>{var s;this._rectangle.reset(),this._start={x:t,y:e},(s=this._layer)==null||s.refresh((n=>{n.fillStyle=this._options.fillColor,n.strokeStyle=this._options.strokeColor,n.lineWidth=this._options.strokeWidth}))},this._onStop=()=>{var a;const t=this._modules.captor.getCursorPosition(),e=this._formatRectangle(t),{nodes:s,edges:n}=this._modules.spatial.queryProjected(e.minX,e.minY,e.maxX,e.maxY),i={},r=s.filter((l=>{const u=l.isVisible(),h=l.getAttribute("detectable"),g=u&&h&&this._modules.locate.isNodeInRectangle(l,e);return i[l._index]=g,g}));let o=n.filter((l=>{const u=l.isVisible(),h=l.getAttribute("detectable");return u&&h&&this._modules.locate.isEdgeInRectangle(l,e)}));this._options.bothExtremities&&(o=this.filterByExtremities(o,i)),(a=this._layer)==null||a.clear(),this.disable(),this._options.callback({nodes:r,edges:o,rectangle:{minX:e.minX,minY:e.minY,maxX:e.maxX,maxY:e.maxY,width:e.width,height:e.height,cx:e.cx,cy:e.cy}})}}onMounted(){this._options=Ws(C1),this._enabled=!1,this._rectangle=new ii,this._interaction=this._modules.interactions.onDrag({priority:"lasso",disableDetection:!0,check:()=>this._enabled,onStart:this._onStart,onProgress:({x:t,y:e})=>this._refreshRectangle({x:t,y:e}),onStop:this._onStop})}enable(t){return super.enable(Ci(t,C1))}_formatRectangle(t){const e=this._start.x,s=this._start.y,n=t.x,i=t.y,r=Math.abs(e-n),o=Math.abs(s-i),a=e<n?e:n,l=s<i?s:i;return this._rectangle.reset().addPoint(a,l).addPoint(a+r,l+o)}_refreshRectangle(t){var o;const{minX:e,minY:s,width:n,height:i}=this._formatRectangle(t),r=mi();(o=this._layer)==null||o.refresh((a=>{a.strokeRect(e*r,s*r,n*r,i*r),this._options.fillColor&&a.fillRect(e*r,s*r,n*r,i*r)}))}},$G=Rw(Fw()),Sr=6,AN=5,zd=1,wN=0,TN=0,zy=-1;function CN(t,e,s,n){wN=t,Py=s,TN=e?1:0,zy=n}var L1=(t,e,s,n)=>i=>{const{rects:r,bboxes:o,intersects:a,indexToLayer:l,indexToRemoveNodeText:u,indexToRemoveEdgeText:h}=n;if(o[i*Sr+5]===wN&&o[i*Sr+4]===s)return!1;const g=i*AN,f=wh(r[g],r[g+1],r[g+2],r[g+3],r[g+4]);if(FC(Py,f)){if(n.realIntersection=!0,zy<=0&&a.push(Py,f),!(l[o[i*Sr+5]]<zy))return!0;t.remove(i),n.realIntersection=!1,o[i*Sr+4]===TN?u[o[i*Sr+5]]=!0:h[o[i*Sr+5]]=!0}return!1};function N1(t,e,s="#22ff00"){return Dy([[t[0],t[1]],[t[2],t[1]],[t[2],t[3]],[t[0],t[3]]].map((n=>({x:n[0],y:n[1]}))),e,s)}function Dy(t,e,s="#ff0000"){e.strokeStyle=s,e.beginPath();for(let n=0,i=t.length;n<i;n++)n===0?e.moveTo(t[n].x,t[n].y):e.lineTo(t[n].x,t[n].y);e.closePath(),e.stroke()}function qG(t,e,s,n,i){for(let a=0,l=e.length;a<l;a+=Sr)N1(e.slice(a,a+4),t,"#aaaaaa");for(let a=0;a<s.length;a+=AN)Dy(wh(s[a],s[a+1],s[a+2],s[a+3],s[a+4]),t,"green");const r=[i.root];let o=i.root;for(;o=r.pop();)o.leaf||r.push.apply(r,o.children),N1(i.getNodeBounds(o),t,"rgba(0,0,0,0.2)"),o=r.pop();n.forEach((a=>Dy(a,t,"red")))}var id={x1:0,y1:0,x2:0,y2:0},a_={x:0,y:0},Ll={x:0,y:0},YG=Math.PI/2,WG=0;function XG(t,e,s,n,i,r,o,a,l,u,h){const g=a.remove.nodes,f=a.remove.edges,m=a.redraw.edges,y=s.angle,p=s.zoom,x=i.x,v=i.y,b=i.radius,S=Math.PI,{source:A,target:w,scalingMethod:L}=n,k=n.width,F=n.curvature,O=n.layer,j=n.text.content,V=n.text.scaling,Z=n.text.size,at=n.text.font,mt=n.text.style,K=n.text.scale,ut=n.text.maxLineLength,ht=n.text.margin,nt=n.text.minVisibleSize,ot=n.text.padding,Mt=n.animationDuration,Q=n.text.adjustAngle,Et=n.text.position;a.indexToLayer={},a.indexToQuadIndex={},a.indexToRemoveNodeText={},a.indexToRemoveEdgeText={},a.indexToRedrawEdgeText={},a.byLayer=[];const{byLayer:qt,indexToLayer:Vt,indexToQuadIndex:Wt,indexToRedrawEdgeText:oe,indexToRemoveNodeText:me,indexToRemoveEdgeText:se}=a;for(let ge=0;ge<t.length;ge++){const ze=t[ge],is=O.get(ze)-E2;for(let Ge=1;Ge<=is;Ge++)(qt[Ge]=qt[Ge]||[]).push(ze);Vt[ze]=is}if(l!==null){const ge=qt.length;for(let ze=Vt[l]+1;ze<=ge;ze++)(qt[ze]=qt[ze]||[]).unshift(l);Vt[l]=ge}const Jt=[0,0,0,0],ee=[0,0,0,0,0],{bboxes:ce,rects:Ce}=a,ve=(ge,ze=-1)=>{const is=Mt.get(ge);let Ge=j?j.get(ge):"";if(Ge===null||Ge===""||is)return!1;const De=A.get(ge),He=w.get(ge);let Je=k.get(ge);const ss=F.get(ge),ts=nt.get(ge);if(Je*p<ts)return se[ge]=!0,!1;L.get(ge)==="fixed"&&(Je/=p);let hs=(x.get(De)+x.get(He))/2,Fe=(v.get(De)+v.get(He))/2;Ge=Ge?Ge.toString():"";const Oe=!V.get(ge),Cs=K.get(ge)*(Oe?1:p),Fs=at.get(ge),Hs=(Oe?Z.get(ge):Cs*Je)*zd,Ls=mt.get(ge),En=ut.get(ge),hn=Et.get(ge)===Eh;let on=+hn*ht.get(ge)+n.text.padding.get(ge);const xs=x.get(De),Ps=v.get(De),gt=x.get(He),M=v.get(He),P=b.get(De),D=b.get(He);if(ss===0){const Bt=au(xs,Ps,gt,M)-y,he=P-D;hs+=he*Math.cos(Bt)/2,Fe+=he*Math.sin(Bt)/2}let B;const $=De===He;if($)B=S/4-y,$f(xs,Ps,ss,P,0,id),Zd(.5,xs,Ps,gt,M,id.x1,id.y1,id.x2,id.y2,Ll),hs=Ll.x,Fe=Ll.y,on/=-p;else{if(xs===gt&&Ps===M)return!1;B=au(xs,Ps,gt,M)-y,ss!==0&&(ja(xs,Ps,gt,M,ss,a_),Yf(.5,xs,Ps,gt,M,a_.x,a_.y,Ll),hs=Ll.x,Fe=Ll.y)}const H=on+WG,X=X2(Ge,En);if(!X)return!1;const{lines:lt,data:dt}=X;let ct=r(dt[0],Fs,Ls,Hs).width*zd;for(let Bt=1;Bt<lt;Bt++)ct=Math.max(ct,r(dt[Bt],Fs,Ls,Hs).width*zd);const pt=lt*Hs,yt=ct/p/2,Nt=pt/p/2,Tt=Math.abs(sf(B))<YG?1:-1;let At=hn?$?pt/p+Je/2+on:Tt*(H/p+Je/2+Nt):0;if(!$&&ss===0&&Q.get(ge)){const Bt=ot.get(ge);pn(xs,Ps,gt,M)*p-(P+D)*(h?1:p)<ct+2*Bt+1&&(At*=Tt,B=0)}if(ee[0]=hs-yt,ee[1]=Fe-Nt,ee[2]=hs+yt,ee[3]=Fe+Nt,ee[4]=B+y,Fy(ee,-(B+y),-At,ee),ee[2]=ee[2]-ee[0],ee[3]=ee[3]-ee[1],B=S-B-y,Qf(hs-yt,Fe-Nt,2*yt,2*Nt,B,void 0,void 0,Jt),Fy(Jt,B,At,Jt),a.realIntersection=!1,CN(ge,!1,wh(ee[0],ee[1],ee[2],ee[3],ee[4]),ze),e.traverse(Jt[0],Jt[1],Jt[2],Jt[3],u),a.realIntersection&&!o)return se[ge]=!0,!1;if(oe[ge]=!0,me[ge]=!1,ze<=0){const Bt=ce.length/Sr;Wt[ge]=Bt,ce.push(Jt[0],Jt[1],Jt[2],Jt[3],0,ge),e.insert(Bt,Jt[0],Jt[1],Jt[2],Jt[3]),Ce.push(ee[0],ee[1],ee[2],ee[3],ee[4])}else e.insert(Wt[ge],Jt[0],Jt[1],Jt[2],Jt[3])};for(const ge of t)ve(ge);let Me=!0;for(let ge=0;ge<qt.length;ge++){const ze=qt[ge];if(ze)if(Me)Me=!1;else for(const is of ze)ve(is,ge)}for(let ge=0;ge<t.length;ge++){const ze=t[ge];me[ze]?g.push(ze):oe[ze]&&m.push(ze),se[ze]&&f.push(ze)}return a}var ZG={left:-1,right:1,top:0,bottom:0,center:0},KG={left:0,right:0,top:-1,bottom:1,center:0},QG={left:-1,right:0,top:-.5,bottom:-.5,center:-.5},JG={left:-.5,right:-.5,top:-1,bottom:0,center:-.5},t5=(t,e,s)=>X2(e,s.get(t))||{lines:0,data:[" "],maxLength:1},e5=(t,e,s,n,i,r,o)=>{const{lines:a,data:l}=t5(t,e,n);let u=s(l[0],i,r,o).width;for(let h=1;h<a;h++)u=Math.max(u,s(l[h],i,r,o).width);return[u,a*o*zd]},s5=(t,e,s)=>{const n=e.text.content,i=e.radius,r=e.text.scaling,o=e.text.position,a=e.text.padding,l=e.text.scale,u=e.text.size,h=e.text.style,g=e.text.font,f=e.text.maxLineLength,m=e.text.margin,y=n.get(t),p=i.get(t),x=!r.get(t),v=o.get(t),b=a.get(t),S=l.get(t),A=(x?u.get(t):S*p*2)*zd,w=h.get(t),L=g.get(t),k=b+m.get(t),F=ZG[v],O=KG[v],[j,V]=e5(t,`${y}`,s,f,L,w,A),Z=j/2,at=V/2;return[QG[v]*j,JG[v]*V,F*k,O*k,F*p,O*p,j,V,Z,at]};function n5(t,e,s,n,i,r,o,a,l){const u=o.remove.nodes,h=o.remove.edges,g=o.redraw.nodes,f=s.angle,m=s.zoom,y=s.sin,p=s.cos,x=n.x,v=n.y,b=n.radius,S=n.layer,A=n.scalingMethod,w=n.text.content,L=n.text.scaling,k=n.text.minVisibleSize,F=n.animationDuration,O=n.textHidden,j=n.excluded;o.indexToLayer={},o.indexToQuadIndex={},o.indexToRemoveNodeText={},o.indexToRemoveEdgeText={},o.indexToRedrawNodeText={},o.byLayer=[];const{indexToLayer:V,indexToRedrawNodeText:Z,indexToRemoveNodeText:at,indexToRemoveEdgeText:mt,indexToQuadIndex:K,byLayer:ut}=o;for(let Vt=0;Vt<t.length;Vt++){const Wt=t[Vt],oe=S.get(Wt)-E2;(ut[oe]=ut[oe]||[]).push(Wt),V[Wt]=oe}if(a!==null){const Vt=ut.length;for(let Wt=V[a]+1;Wt<=Vt;Wt++)(ut[Wt]=ut[Wt]||[]).unshift(a);V[a]=Vt}let ht;const nt=[0,0,0,0],ot=[0,0,0,0,0],{bboxes:Mt,rects:Q}=o,Et=(Vt,Wt=-1)=>{const oe=F.get(Vt);let me=w.get(Vt);if(me===null||me===""||oe!==0)return!1;let se=b.get(Vt);const Jt=k.get(Vt);if(j.get(Vt)===1)return at[Vt]=!0,!1;if(2*se*m<Jt)return O.get(Vt)===0&&(at[Vt]=!0),!1;A.get(Vt)==="fixed"&&(se/=m);const ee=x.get(Vt),ce=v.get(Vt);typeof me=="number"&&(me=me.toString());let[Ce,ve,Me,ge,ze,is,Ge,De,He,Je]=i(Vt);const ss=!L.get(Vt),ts=ss?m:1,hs=A.get(Vt)==="fixed"?m:1;ss?(Me+=He,ge+=Je,He/=m,Je/=m,Ge/=m,De/=m):(Me+=He*m,ge+=Je*m),Ce=Ce/ts+Me/m+ze/hs,ve=ve/ts+ge/m+is/hs,Qf(ee-He,ce-Je,Ge,De,-f,y,-p,nt),ot[0]=ee-He,ot[1]=ce-Je,ot[2]=Ge,ot[3]=De,ot[4]=f;const Fe=p*Ce-y*ve,Oe=y*Ce+p*ve;if(nt[0]+=Fe,nt[1]+=Oe,nt[2]+=Fe,nt[3]+=Oe,ot[0]+=Fe,ot[1]+=Oe,o.realIntersection=!1,CN(Vt,!0,wh(ot[0],ot[1],ot[2],ot[3],ot[4]),Wt),e.traverse(nt[0],nt[1],nt[2],nt[3],l),o.realIntersection&&!r)return at[Vt]=!0,!1;Z[Vt]=!0,at[Vt]=!1,Wt<=0?(ht=Mt.length/Sr,K[Vt]=ht,Mt.push(nt[0],nt[1],nt[2],nt[3],1,Vt),e.insert(ht,nt[0],nt[1],nt[2],nt[3]),Q.push(ot[0],ot[1],ot[2],ot[3],ot[4])):e.insert(K[Vt],nt[0],nt[1],nt[2],nt[3])};for(const Vt of t)Et(Vt);let qt=!0;for(let Vt=0;Vt<ut.length;Vt++){const Wt=ut[Vt];if(Wt)if(qt)qt=!1;else for(const oe of Wt)Et(oe,Vt)}for(let Vt=0;Vt<t.length;Vt++){const Wt=t[Vt];at[Wt]?u.push(Wt):Z[Wt]&&g.push(Wt),mt[Wt]&&h.push(Wt)}return o}var i5=1,r5="topDown",o5="bottomUp",a5=.15,l5=200,M1=80,u5=["x","y","radius","width","layer","text.content","text.minVisibleSize","text.size","text.scale","text.scaling","text.padding","text.margin","text.position","text.style"].reduce(((t,e)=>(t.add(e),t)),new Set),d5=class extends Ke{constructor(t,e){super(t),this._textBBoxes=[],this._rects=[],this._enabled=!1,this._geoEnabled=!1,this._intersects=[],this._textDisplacement={},this._textDisplacementUpdate={},this._skipFrames=!1,this._output={remove:{nodes:[],edges:[]},redraw:{nodes:[],edges:[]},rects:this._rects,bboxes:this._textBBoxes,intersects:this._intersects,realIntersection:!1,indexToLayer:{},byLayer:[],indexToRedrawEdgeText:{},indexToRemoveEdgeText:{},indexToRedrawNodeText:{},indexToRemoveNodeText:{},indexToQuadIndex:{}},this._onZoomStart=Vd((({startZoom:s,endZoom:n})=>{this._enabled&&n<s&&this._updateLabels(this._modules.camera.clone({zoom:n}))}),M1),this._onLayoutEnd=Vd((()=>{this._enabled&&this._updateLabels()}),M1),this._onAttributesChanged=s=>{if([...s.edgeAttributes,...s.nodeAttributes].some((n=>u5.has(n)))){const n=s.nodes._indexes;for(let i=0;i<n.length;i++)this._textDisplacementUpdate[n[i]]=!0;this._update()}},this._onToggle=s=>(s?this._update():this._reset(),this),this._update=()=>{(this._enabled||this._forceEnabled)&&this._updateDebounced()},this._toggleDebug=s=>{s?this._modules.layers.whenReady((()=>{this._layer=this._modules.layers.addCanvasLayer((n=>{n.lineWidth=1/this._modules.camera.getZoom(),qG(n,this._textBBoxes,this._rects,this._intersects,this._quadtree)}),{isStatic:!1,noClear:!1}),this._layer.moveToTop(),this._canvas=this._layer.element,this._ctx=this._canvas.getContext("2d"),this._update()})):this._canvas&&(this._layer.destroy(),this._canvas=this._ctx=null)},this._measureText=(s,n,i,r)=>this._engine.measureText(s,n,i,r),this._textDisplacement={},this._textDisplacementUpdate={},this._quadtree=new $G.Quadtree((s=>{const n=Sr,i=n*s;return this._textBBoxes.slice(i,i+n)}),i5),e.forceEnableTextOverlapRemoval&&this.forceEnable()}onMounted(){this._engine=this._modules.graphics.getGraphicsEngine(),this._modules.events.register(["labelCollisionsRemoved"]),this.setRate(l5),this._modules.settings.register("texts.preventOverlap",!0,this._onToggle),this._modules.settings.register("texts.debug",!1,this._toggleDebug),this._modules.settings.register("texts.removalStrategy",r5);const t=this._output;this._nodeTraversal=L1(this._quadtree,!1,1,t),this._edgeTraversal=L1(this._quadtree,!1,0,t),this._modules.events.on(["layoutEnd","locate"],this._onLayoutEnd).on(["viewChanged","mouseover","mouseout"],this._update).on("updateAttributes",this._onAttributesChanged).on("setContainer",(({element:e})=>{if(e)return this._enable();this._disable()})).on("zoomStart",this._onZoomStart).on("viewExportStart",(({preventOverlap:e,camera:s})=>{e&&this.forceUpdate(s)})).on("viewExportEnd",(()=>{this.forceUpdate()})).on("geoEnabled",(()=>this._geoEnabled=!0)).on("geoDisabled",(()=>this._geoEnabled=!1))}getTextsBoundingBox(t,e){if(this._skipFrames=!0,t||e?this._updateLabels(this._modules.camera,t?Array.from(t._indexes):[],e?Array.from(e._indexes):[]):this._updateLabels(),this._skipFrames=!1,this._rects===void 0)throw new Error("this._rects is undefined");const s=this._rects,n=new ii;for(let i=0;i<s.length;i+=5){const r=s[i],o=s[i+1],a=s[i+2],l=s[i+3],u=s[i+4],[h,g,f,m]=Qf(r,o,a,l,u);n.addPoint(h,g).addPoint(f,m)}return n}setRate(t){this._updateDebounced=this._modules.sync.debounceIdle((e=>this._updateLabels(e)),t)}forceEnable(){this._forceEnabled=!0}update(){this._update()}forceUpdate(t=this._modules.camera){this._updateLabels(t)}query(t,e,s,n,i){const r=this._quadtree.query(t,e,s,n);for(let o=0;o<r.length;o++){const a=this._textBBoxes[6*r[o]+4],l=this._textBBoxes[6*r[o]+5];a?i.nodes.push(l):i.edges.push(l)}}_enable(){this._enabled=!0,this._update()}_disable(){this._textBBoxes=[],this._rects=[],this._intersects=[],this._enabled=!1}_onCameraMove(){this._update()}_updateLabels(t=this._modules.camera,e,s){if(!this._modules.settings.get("texts.preventOverlap"))return;const n=this._modules.graphics.getNodeAttributes(),i=this._modules.graphics.getEdgeAttributes();this._intersects=[],this._textBBoxes=[],this._rects=[];const r=t.getAngle(),o=t.getProjectedScreenBounds(a5),a=this._modules.settings.get("texts.removalStrategy")===o5,l={angle:r,zoom:t.zoom,sin:Math.sin(r),cos:Math.cos(r)};this._resetOutput();const u=this._output;if(!e||!s){const y=this._modules.spatial.queryRaw(o[0],o[1],o[2],o[3]);e=y.nodes,s=y.edges}const h=this._quadtree.clear().cover(o[0],o[1],o[2],o[3]);if(e.length+s.length===0)return;const g=this._modules.captor.getPointedElement();let f=null,m=null;g!==null&&(g.isNode?f=g._index:m=g._index);for(const y of e)!this._textDisplacementUpdate[y]&&this._textDisplacement[y]||(this._textDisplacement[y]=s5(y,n,this._measureText),this._textDisplacementUpdate[y]=!1);n5(e,h,l,n,(y=>this._textDisplacement[y]),a,u,f,this._nodeTraversal),XG(s,h,l,i,n,this._measureText,a,u,m,this._edgeTraversal,this._geoEnabled),this._skipFrames||this._clearOverlaps(this._output),this._modules.settings.get("texts.debug")&&this._layer.refresh()}_clearOverlaps(t){const e=this._modules.graph.nodeList,s=this._modules.graph.edgeList,n=this._modules.graphics,i=e(new Uint32Array(t.remove.nodes)),r=s(new Uint32Array(t.remove.edges)),o=e(new Uint32Array(t.redraw.nodes)),a=s(new Uint32Array(t.redraw.edges));n.setTextHidden(i,!0),n.setTextHidden(r,!0),n.setTextHidden(o,!1),n.setTextHidden(a,!1),this._modules.events.fire("labelCollisionsRemoved",t)}_resetOutput(){const t=this._output;t.remove.nodes=[],t.remove.edges=[],t.redraw.nodes=[],t.redraw.edges=[],t.rects=this._rects,t.bboxes=this._textBBoxes,t.intersects=this._intersects,t.realIntersection=!1,t.indexToLayer={},t.byLayer=[],t.indexToRedrawEdgeText={},t.indexToRemoveEdgeText={},t.indexToRedrawNodeText={},t.indexToRemoveNodeText={},t.indexToQuadIndex={}}_reset(){this._modules.graphics.resetTextHidden(),this._textDisplacement={},this._textDisplacementUpdate={}}},h5=class extends Ke{constructor(){super(...arguments),this._onStartInteractionEvent=(t,e)=>{const s=e==="mousewheel";if(this._current&&!s)return;const n=this._interactionsByStartEvent[e];let i;for(const r of n)r.check(t)&&(!i||r.priority>=i.priority)&&(i=r);i&&(s?i.onStart&&i.onStart(t):this._startInteraction(i,t))},this._onProgressInteractionEvent=(t,e)=>{this._current&&this._current.progressEventName===e&&this._current.onProgress&&this._current.onProgress(t)},this._onStopInteractionEvent=(t,e)=>{this._current&&this._current.stopEventName===e&&this._stopCurrentInteraction(null)}}onMounted(){this._interactionsByStartEvent={},this._boundProgressEvents={},this._boundStopEvents={}}_startInteraction(t,e){t.onStart&&t.onStart(e),t.onStop&&(this._current=t,t.disableDetection&&this._modules.captor.setDetectionEnabled(!1))}_stopCurrentInteraction(t){this._current&&this._current.disableDetection&&this._modules.captor.setDetectionEnabled(!0),this._current&&this._current.onStop&&this._current.onStop(t),this._current=void 0}_forceStartInteraction(t,e){this._current&&this._stopCurrentInteraction(e),this._startInteraction(t,e)}_createWrapper(t){return{start:e=>this._forceStartInteraction(t,e)}}_addInteraction(t,e){const s=this._interactionsByStartEvent[t];return s?s.push(e):(this._interactionsByStartEvent[t]=[e],this._modules.events.on(t,this._onStartInteractionEvent)),this._createWrapper(e)}_createProgressiveInteraction(t,e,s,n){const i={priority:I1(n.priority),check:n.check||qg,onStart:n.onStart||os,onProgress:n.onProgress||os,onStop:n.onStop||os,disableDetection:!!n.disableDetection,progressEventName:e,stopEventName:s};return this._boundProgressEvents[e]||(this._boundProgressEvents[e]=!0,this._modules.events.on(e,this._onProgressInteractionEvent)),this._boundStopEvents[s]||(this._boundStopEvents[s]=!0,this._modules.events.on(s,this._onStopInteractionEvent)),this._addInteraction(t,i)}_createNonProgressiveInteraction(t,e){return this._addInteraction(t,{priority:I1(e.priority),check:e.check||qg,onStart:e.handler||os,onProgress:void 0,onStop:void 0,disableDetection:!1,progressEventName:void 0,stopEventName:void 0})}onDrag(t){return this._createProgressiveInteraction("dragStart","dragProgress","dragEnd",t)}onGesture(t){return this._createProgressiveInteraction("gestureStart","gestureProgress","gestureEnd",t)}onClick(t){return this._createNonProgressiveInteraction("click",t)}onDoubleClick(t){return this._createNonProgressiveInteraction("doubleclick",t)}onHover(t){return this._createNonProgressiveInteraction("mouseover",t)}onUnhover(t){return this._createNonProgressiveInteraction("mouseout",t)}onMouseWheel(t){return this._createNonProgressiveInteraction("mousewheel",t)}onMouseDown(t){return this._createNonProgressiveInteraction("mousedown",t)}onMouseUp(t){return this._createNonProgressiveInteraction("mouseup",t)}onMouseMove(t){return this._createNonProgressiveInteraction("mousemove",t)}};function I1(t){return typeof t=="string"?pz.indexOf(t):typeof t!="number"||isNaN(t)?0:t}var c5=["virtualUp","mouseupInternal","touchUp"],g5=["virtualDown","mousedownInternal","touchDown"],f5=["virtualMove","mousemoveInternal","touchMove"],m5=["virtualClick","clickInternal","touchTap"],p5=["virtualDoubleClick","doubleclickInternal","touchDoubleTap"],_5=["virtualWheel","mousewheelInternal"],y5=100,x5=class extends Ke{constructor(){super(...arguments),this.spatialIndexMarginRatio=5,this._elt=null,this._hoveredElt=null,this._draggedElt=null,this._hover=!1,this._disabledCounter=0,this._accDx=0,this._accDy=0,this._prevX=0,this._prevY=0,this._buttons={left:{isPressed:!1,isDragging:!1},middle:{isPressed:!1,isDragging:!1},right:{isPressed:!1,isDragging:!1}},this._onGraphChanged=()=>{this._resetCurrent(this._modules.position.x,this._modules.position.y),this._onMove({x:this._modules.position.x,y:this._modules.position.y,source:null,domEvent:null})}}onMounted(){this._modules.events.register(["mousemove","mousedown","mouseup","click","doubleclick","mousewheel","mouseout","mouseover","dragStart","dragProgress","dragEnd","gestureStart","gestureProgress","gestureEnd"]),this._modules.settings.register("detect.nodes",!0).register("detect.edges",!0).register("detect.nodeTexts",!0).register("detect.nodeBadges",!0).register("detect.edgeTexts",!0).register("detect.nodeErrorMargin",5).register("detect.edgeErrorMargin",2).register("detect.enableSpatialIndex",!0),this._modules.events.on(["removeNodes","removeEdges","clearGraph"],this._onGraphChanged).on(f5,((t,e)=>{this._onMove({...t,source:_a(e)})})).on(g5,(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onDown({domEvent:t,x:e,y:s,button:n,source:_a(i)})})).on(c5,(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onUp({domEvent:t,x:e,y:s,button:n,source:_a(i)})})).on(m5,(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onClick({domEvent:t,x:e,y:s,button:n,source:_a(i)})})).on(p5,(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onDoubleClick({domEvent:t,x:e,y:s,button:n,source:_a(i)})})).on(_5,(({domEvent:t,x:e,y:s,delta:n,dx:i,dy:r})=>this._onWheel({domEvent:t,x:e,y:s,delta:n,source:"mouse",dx:i,dy:r}))).on("touchStartGesture",(t=>this._modules.events.fire("gestureStart",t))).on("touchProgressGesture",(t=>this._modules.events.fire("gestureProgress",t))).on("touchEndGesture",(t=>this._modules.events.fire("gestureEnd",t))).on("documentMouseMove",(({domEvent:t,x:e,y:s},n)=>{this._onDocumentMove({domEvent:t,x:e,y:s,source:_a(n)})})).on("documentMouseUp",(({domEvent:t,x:e,y:s,button:n="left"},i)=>{this._onDocumentUp({domEvent:t,x:e,y:s,source:_a(i),button:n})}))}triggerUnhover(){this._hover=!1,this._hoveredElt=null}triggerDetection(){this._detectElement(this._modules.position.x,this._modules.position.y,!1,!1),this._elt&&(this._hoveredElt=this._elt,this._hover=!0)}getPointedElement(){return this._hoveredElt}getDraggedElement(){return this._draggedElt}isAnyButtonPressed(){return this._buttons.left.isPressed||this._buttons.right.isPressed||this._buttons.middle.isPressed}isAnyButtonDragging(){return this._buttons.left.isDragging||this._buttons.right.isDragging||this._buttons.middle.isDragging}isButtonPressed(t){return this._buttons[t].isPressed}isLeftPressed(){return this.isButtonPressed("left")}getCursorPosition(){return{x:this._modules.position.x,y:this._modules.position.y}}getCursorInformation(){return{x:this._modules.position.x,y:this._modules.position.y,target:this._hoveredElt}}setDetectionEnabled(t){this._disabledCounter=Math.max(0,this._disabledCounter+(t?-1:1))}_resetCurrent(t,e){for(const s in this._buttons){const n=this._buttons[s];n.isDragging&&this._modules.events.fire("dragEnd",{domEvent:null,x:t,y:e,button:s,target:this._draggedElt}),n.isPressed=!1,n.isDragging=!1}this._hover&&this._hoveredElt&&this._modules.events.fire("mouseout",{domEvent:null,x:t,y:e,target:this._hoveredElt}),this._hover=!1,this._hoveredElt=null,this._draggedElt=null}_onMove({domEvent:t,x:e,y:s,source:n}){let{dx:i,dy:r}=this._setPointerPosition(e,s);this._modules.events.fire("mousemove",{domEvent:t,x:e,y:s,dx:i,dy:r,source:n});for(const o in this._buttons){const a=this._buttons[o];if(a.isPressed)if(a.isDragging){const l=this._getStoredDXY();i+=l.dx,r+=l.dy,this._modules.events.fire("dragProgress",{domEvent:t,x:e,y:s,dx:i,dy:r,button:o,source:n,target:this._draggedElt})}else a.isDragging=!0,this._hoveredElt&&this._hover&&(this._modules.events.fire("mouseout",{domEvent:t,x:e,y:s,source:n,target:this._hoveredElt}),this._hover=!1),this._draggedElt||(this._draggedElt=this._hoveredElt),this._storeDXY(i,r),this._modules.events.fire("dragStart",{domEvent:t,x:e,y:s,button:o,source:n,target:this._draggedElt})}t&&!this._modules.graphics.getDomElement().contains(t.target)||this._detectElement(e,s,!1,!1),this._elt!==this._hoveredElt&&(this._hoveredElt&&this._hover&&(this._hover=!0,this._modules.events.fire("mouseout",{domEvent:t,x:e,y:s,source:n,target:this._hoveredElt})),this._hoveredElt=this._elt,this._elt&&(this._hover=!0,this._modules.events.fire("mouseover",{domEvent:t,x:e,y:s,source:n,target:this._hoveredElt})))}_onDocumentMove({domEvent:t,x:e,y:s,source:n}){for(const i in this._buttons){const{isDragging:r}=this._buttons[i];if(r){const{dx:o,dy:a}=this._setPointerPosition(e,s);this._modules.events.fire("dragProgress",{domEvent:t,x:e,y:s,dx:o,dy:a,button:i,source:n,target:this._draggedElt})}}}_onDocumentUp({domEvent:t,x:e,y:s,source:n,button:i}){if(i!=null&&this._buttons[i].isDragging){this._modules.events.fire("dragEnd",{domEvent:t,x:e,y:s,button:i,source:n,target:this._draggedElt});const r=this._buttons[i];r.isDragging=!1,r.isPressed=!1,this.isAnyButtonDragging()||(this._draggedElt=null)}}_onDown({domEvent:t,x:e,y:s,button:n,source:i}){if(n==null)return;this._detectElement(e,s,!1,!1),this._elt!==this._hoveredElt&&this._resetCurrent(e,s);const r=this._buttons[n];this._hoveredElt=this._elt,r.isPressed=!0,this._elt&&t&&(t.stopPropagation(),t.preventDefault()),this._modules.events.fire("mousedown",{domEvent:t,x:e,y:s,button:n,source:i,target:this._hoveredElt})}_onDoubleClick({domEvent:t,x:e,y:s,button:n,source:i}){n!=null&&(R1(t,"doubleclick")||this._modules.events.fire("doubleclick",{domEvent:t,x:e,y:s,button:n,source:i,target:this._hoveredElt}))}_onUp({domEvent:t,x:e,y:s,button:n,source:i}){if(n==null)return;const r=this._buttons[n];r.isPressed&&(r.isDragging&&(this._modules.events.fire("dragEnd",{domEvent:t,x:e,y:s,button:n,source:i,target:this._draggedElt}),r.isDragging=!1,this.isAnyButtonDragging()||(this._draggedElt=null)),r.isPressed=!1,this._detectElement(e,s,!1,!1),this._modules.events.fire("mouseup",{domEvent:t,x:e,y:s,button:n,source:i,target:this._elt}),this.isAnyButtonPressed()||this._hover||i==="touch"||(this._hoveredElt=this._elt,this._hoveredElt&&(this._modules.events.fire("mouseover",{domEvent:t,x:e,y:s,source:i,target:this._hoveredElt}),this._hover=!0)))}_onClick({domEvent:t,x:e,y:s,button:n,source:i}){R1(t,"click")||this._modules.events.fire("click",{domEvent:t,x:e,y:s,button:n,source:i,target:this._hoveredElt})}_onWheel({domEvent:t,x:e,y:s,delta:n,source:i,dx:r,dy:o}){this._modules.position.x=e,this._modules.position.y=s,this._modules.events.fire("mousewheel",{domEvent:t,x:e,y:s,dx:r,dy:o,delta:n,source:i,target:this._hoveredElt})}_storeDXY(t,e){this._accDx=t,this._accDy=e}_getStoredDXY(){const t=this._accDx,e=this._accDy;return this._accDx=0,this._accDy=0,{dx:t,dy:e}}_setPointerPosition(t,e){const s=t-this._prevX,n=e-this._prevY;return this._modules.position.x=t,this._modules.position.y=e,this._prevX=t,this._prevY=e,this._accDx=0,this._accDy=0,{dx:s,dy:n}}_detectElement(t,e,s,n){this._elt=this.detectElementAt(t,e,s,n)}detectElementAt(t,e,s,n){if(this._disabledCounter!==0)return null;const i=this._modules.settings,r=i.get("detect.enableSpatialIndex"),o=i.get("detect.nodeErrorMargin")||0,a=i.get("detect.edgeErrorMargin")||0;let l=i.get("detect.nodes"),u=i.get("detect.edges");n&&(l=!0,u=!0);let h=null,g=[],f=[];if(!s&&r&&(l||u)){const p=this.spatialIndexMarginRatio,x=Math.max(o*p,a*p),v=this._modules.spatial.queryRawProjected(t-x,e-x,t+x,e+x);g=v.nodes,f=v.edges}let m=null,y=null;if(l&&(m=this._modules.graphics.detectNode(t,e,!!i.get("detect.nodeTexts"),!!i.get("detect.nodeBadges"),o,g)),u&&(f.length<y5||!m)&&(y=this._modules.graphics.detectEdge(t,e,!!i.get("detect.edgeTexts"),a,f)),m&&y){const p=this._modules.graphics.getAttributesManager().getFlexArrays();h=p.nodes.current.layer.get(m._index)>=p.edges.current.layer.get(y._index)?m:y}else m?h=m:y&&(h=y);return h}};function _a(t){return t.indexOf("touch")===0?"touch":"mouse"}var l_=!1,k1={down:{trigger:"pointerdown",duplicate:"mousedown"},click:{trigger:"pointerdown",duplicate:"mouseup"},doubleclick:{trigger:"pointerdown",duplicate:"mouseup"}};function R1(t,e){if(t)return t.type===k1[e].trigger&&(l_=!0),t.type===k1[e].duplicate&&l_?(l_=!1,!0):void 0}var v5=class extends Ke{constructor(){super(...arguments),this._dragged=null,this._start=[],this._end=[],this._shouldDrag=({target:t,button:e})=>{const s=e==="left",n=this._modules.settings.get("interactions.drag.enabled"),i=t!==null&&t.isNode&&t.getAttribute("draggable")===!0;return!!(s&&n&&i)},this._onDragStart=({x:t,y:e,target:s})=>{s&&(s.isSelected()?this._dragged=this._modules.selection.getSelectedNodes().filter((n=>n.getAttribute("draggable"))):this._dragged=s.toList()),this._dragged&&(this._start=this._dragged.getPosition(),this._end=Ws(this._start),this._onBeforeDrag=this._modules.settings.get("interactions.drag.onBeforeDrag"),this._startDrag=this._modules.camera.screenToGraphCoordinates({x:t,y:e}),this._dragged.addClass(kg),this._modules.events.fire("nodesDragStart",{nodes:this._dragged}),this._modules.graphics.addCursorStyle(this._modules.settings.get("interactions.drag.cursor")))},this._onDrag=()=>{if(!this._dragged||!this._startDrag)return;const{x:t,y:e}=this._modules.captor.getCursorInformation(),s=this._dragged._indexes,n=this._modules.camera.screenToGraphCoordinates({x:t,y:e}),i=n.x-this._startDrag.x,r=n.y-this._startDrag.y;for(let o=0;o<s.length;++o){const a=this._start[o],l=this._end[o];l.x=a.x+i,l.y=a.y+r}this._onBeforeDrag&&this._onBeforeDrag(this._dragged,t,e,this._end),this._modules.settings.get("interactions.drag.applyResult")&&this._modules.individualAttributes.setMultipleAttributes(this._dragged,this._end),this._modules.events.fire("nodesDragProgress",{nodes:this._dragged,dx:i,dy:r})},this._onDragEnd=()=>{this._dragged&&(this._dragged.removeClass(kg),this._modules.graphics.removeCursorStyle(this._modules.settings.get("interactions.drag.cursor")),this._modules.events.fire("nodesDragEnd",{nodes:this._dragged,start:this._start,end:this._end}),this._dragged=null,this._start=[],this._end=[])}}onMounted(){this._modules.classes.createClass({name:kg,isBuiltin:!0,nodeAttributes:{layer:fz}}),this._modules.events.register(["nodesDragStart","nodesDragProgress","nodesDragEnd"]),this._modules.settings.register("interactions.drag.enabled",!0).register("interactions.drag.cursor","move").register("interactions.drag.onBeforeDrag",void 0),this._modules.settings.register("interactions.drag.applyResult",!0),this._modules.interactions.onDrag({priority:"drag",disableDetection:!0,check:this._shouldDrag,onStart:this._onDragStart,onProgress:this._onDrag,onStop:this._onDragEnd})}},b5={color:"#00C3FF",radius:4,cursorOnHover:"grab",cursorOnDrag:"grabbing"},E5=class extends Ke{constructor(){super(...arguments),this._hoveredNode=null,this._hoverHandle=!1,this._grabHandle=!1,this._x=0,this._y=0,this._enabled=!1,this._onMouseUp=()=>this._grabHandle=!1,this._onMouseDown=()=>{this._hoverHandle&&(this._grabHandle=!0)},this._onDragProgress=()=>{this._grabHandle&&this._refreshCanvas()},this._onDragStart=()=>{if(!this._movedEdges)return;this._nodesToHighlight=this._nodesToHighlight.filter((e=>e!==this._startNode&&!e.isVirtual())),this._movedEdges.setExcluded(!0);const t=this._options.cursorOnDrag;this._prevSettings=this._modules.settings.update({edgeHover:!1,cursor:{default:t,node:t,edge:t}})},this._onDragEnd=()=>{if(!this._movedEdges)return;this._restoreSettings();const t=this._getPointedNode();t?this._movedEdges.forEach((e=>{e.getTarget()===this._startNode?e.setTarget(t):e.setSource(t)})):this._options.onMouseUpInVoid&&this._options.onMouseUpInVoid(this._modules.camera.screenToGraphCoordinates({x:this._x,y:this._y}),this._startNode,this._movedEdges,this._movedEdges.map((e=>e.getSource()===this._startNode))),this._movedEdges.setExcluded(!1),this._movedEdges.setSelected(!0),this._movedEdges=null,this._refreshHandles()},this._refreshHandles=()=>{if(!this._enabled||this._movedEdges)return;const t=this._modules.selection.getSelectedEdges();this._nodesToHighlight=t.getExtremities().dedupe().filter((e=>!e.isVirtual())),this._rewirableClass.clearEdges(),this._rewirableClass.add(t),this._refreshCanvas()},this._shouldInteractionStart=()=>{if(!this._enabled||!this._hoveredNode||!this._hoverHandle||this._hoveredNode.isVirtual())return!1;const t=this._hoveredNode.getAdjacentEdges().filter((e=>e.isSelected()));return!!t.size&&(this._movedEdges=t,this._edgeColors=this._movedEdges.getAttribute("color"),this._startNode=this._hoveredNode,!0)},this._refreshCanvas=()=>{this._enabled&&this._layer.refresh()},this._checkForHover=()=>{if(!this._enabled||!this._nodesToHighlight)return;const t=this._options.radius,e=this._nodesToHighlight.getPosition(),s=this._modules.camera.screenToGraphCoordinates(this._modules.captor.getCursorPosition());for(let n=0;n<e.length;n++){const{x:i,y:r}=e[n];if(!(i-t>s.x||i+t<s.x||r-t>s.y||r+t<s.y))return this._hoveredNode=this._nodesToHighlight.get(n),void this._enableCursorOnHover()}this._hoveredNode=null,this._disableCursorOnHover()}}onMounted(){this._rewirableClass=this._modules.classes.createClass({name:_2,isBuiltin:!0,edgeAttributes:{layer:mz}})}enable(t){this._enabled||(this._modules.events.on("move",this._checkForHover).on("mousemove",this._checkForHover).on("dragProgress",this._onDragProgress).on("nodesDragProgress",this._refreshCanvas).on("mousedown",this._onMouseDown).on("mouseup",this._onMouseUp).on("edgesSelected",this._refreshHandles).on("edgesUnselected",this._refreshHandles),this._interaction=this._modules.interactions.onDrag({priority:"rewiring",check:this._shouldInteractionStart,onStart:this._onDragStart,onProgress:({x:e,y:s})=>{this._x=e,this._y=s},onStop:this._onDragEnd}),this._options={...b5,...t},this._enabled=!0,this._layer=this._modules.layers.addCanvasLayer((e=>{if(!this._enabled||!this._nodesToHighlight)return;const s=this._modules.captor.getCursorPosition(),n=this._getPointedNode(),i=this._options.color,r=this._options.radius,o=2*r;if(this._displayMovedEdges(e),e.fillStyle=i,e.strokeStyle=i,this._nodesToHighlight.forEach((a=>{const{x:l,y:u}=a.getPosition();e.fillRect(l-r,u-r,o,o)})),this._movedEdges){const a=n?n.getPosition():s;e.fillRect(a.x-r,a.y-r,o,o)}}),{isStatic:!1,noClear:!1}),this._layer.moveToTop(),this._refreshHandles())}disable(){this._enabled&&(this._interaction&&this._interaction.stop&&this._interaction.stop(),this._interaction=void 0,this._modules.graphics.removeCursorStyle(this._options.cursorOnDrag),this._disableCursorOnHover(),this._hoveredNode=null,this._restoreSettings(),this._layer.destroy(),this._rewirableClass.clearEdges(),this._enabled=!1,[this._checkForHover,this._onDragProgress,this._refreshCanvas,this._onMouseDown,this._onMouseUp,this._refreshHandles].forEach((t=>this._ogma.events.off(t))))}enabled(){return this._enabled}_restoreSettings(){this._prevSettings&&(this._modules.settings.update(this._prevSettings),this._prevSettings=void 0)}_disableCursorOnHover(){this._hoverHandle&&!this._grabHandle&&(this._hoverHandle=!1,this._modules.graphics.removeCursorStyle(this._options.cursorOnHover))}_enableCursorOnHover(){this._hoverHandle||(this._hoverHandle=!0,this._modules.graphics.addCursorStyle(this._options.cursorOnHover))}_displayMovedEdges(t){if(!this._movedEdges)return;const e=this._x,s=this._y,n=this._modules.camera.screenToGraphCoordinates({x:e,y:s});this._movedEdges.forEach(((i,r)=>{const o=this._edgeColors[r],a=i.getSource(),l=i.getTarget(),u=this._getPointedNode(),h=l===this._startNode?a:l,g=Number(i.getAttribute("width")),f=h.getPosition(),m=u?u.getPosition():n;t.beginPath(),t.moveTo(f.x,f.y),t.lineTo(m.x,m.y),t.strokeStyle=o,t.lineWidth=g,t.stroke()}))}_getPointedNode(){const t=this._modules.captor.getPointedElement();return t&&t.isNode&&!t.isVirtual()?t:null}},F1={cursor:"nesw-resize",color:"#00C3FF",lineWidth:1,handleSize:6,detectionMargin:5,snappingRatio:1.25,nbNodesToSnapTo:5,previewColor:"rgba(0, 0, 0, 0.2)",sizeIndicatorColor:"black",sizeIndicatorOffset:5,sizeIndicatorWidth:3,sizeIndicatorThickness:1},S5=class extends Ke{constructor(){super(...arguments),this._enabled=!1,this._nodesToHighlight=null,this._cursorEnabled=!1,this._x=0,this._y=0,this._additionalRadiuses=[],this._onSelectionChange=()=>{this._enabled&&(this._nodesToHighlight=this._modules.selection.getSelectedNodes(),this._displayHandles())},this._displayHandlesHandler=()=>this._displayHandles(),this._moveHandler=({x:t,y:e})=>{this._modules.dom.setTimeout((()=>this._detectBoundingBoxes(t,e)),0)}}onMounted(){this._engine=this._modules.graphics.getGraphicsEngine(),this._modules.interactions.onDrag({priority:"resizing",disableDetection:!0,check:()=>!(!this._enabled||!this._pointedNode),onStart:({x:t,y:e})=>{this._x=t,this._y=e,this._nodeBeingResized=this._pointedNode},onProgress:({x:t,y:e})=>{this._x=t,this._y=e,this._displayHandles()},onStop:()=>{if(this._nodesToHighlight){const t=this._modules.camera.zoom,e=this._nodesToHighlight.getAttributes(["x","y","radius"]).map((({x:s,y:n,radius:i},r)=>{const o=this._additionalRadiuses[r]/t;return{radius:+i+o,x:s+o,y:n-o}}));this._nodesToHighlight.setAttributes(e)}this._pointedNode=null,this._nodeBeingResized=null,this._displayHandles()}})}onReady(){this._modules.events.on(["nodesSelected","nodesUnselected"],this._onSelectionChange)}_enableCursor(){this._cursorEnabled||(this._modules.graphics.addCursorStyle(this._options.cursor),this._cursorEnabled=!0)}_disableCursor(){this._cursorEnabled&&(this._modules.graphics.removeCursorStyle(this._options.cursor),this._cursorEnabled=!1)}_detectBoundingBoxes(t,e){if(!this._enabled||this._nodeBeingResized||!this._nodesToHighlight)return;const s=this._options.handleSize/2,n=this._options.detectionMargin;return this._pointedNode=null,this._forEachNodeToHighlight(((i,r,o)=>{const a=r.x+o-s-n,l=r.x+o+s+n,u=r.y-o-s-n,h=r.y-o+s+n;t>=a&&t<=l&&e>=u&&e<=h&&(this._pointedNode=i)})),this._pointedNode?this._enableCursor():this._disableCursor()}_forEachNodeToHighlight(t){this._nodesToHighlight&&this._nodesToHighlight.forEach((e=>{const s=e.getPositionOnScreen(),n=this._getTotalRadius(e);t(e,s,n)}))}_displayHandles(){this._enabled&&this._nodesToHighlight&&this._layer.refresh()}_displayNodePreview(t,e,s,n,i,r){if(i*=1/this._modules.camera.getZoom(),t.beginPath(),r.length===1)t.arc(s,n,i,0,2*Math.PI);else for(let o=0;o<r.length;++o){const a=r[o],l=s+a.x*i,u=n+a.y*i;o===0?t.moveTo(l,u):t.lineTo(l,u)}t.fillStyle=this._options.previewColor,t.fill()}_getTotalRadius(t,e=!0){return Number(t.getAttribute("radius"))*(this._modules.camera.zoom*(e?1:0))+Number(t.getAttribute("innerStroke.width"))+Number(t.getAttribute("outerStroke.width"))+this._options.lineWidth/2}_snap(t,e,s){const n=this._modules.spatial.getNodesInScreenByDistance(e).filter((g=>!g.isSelected())).slice(0,this._options.nbNodesToSnapTo),i=this._getTotalRadius(e),r=i+s,o=this._options.snappingRatio,a=r/i,l=Math.round(jT(a,o));let u=i*Math.pow(o,l),h=null;if(n.forEach((g=>{const f=this._getTotalRadius(g);Math.abs(f-r)<=Math.abs(u-r)&&(u=f,h=g)})),h){t.save(),t.strokeStyle=this._options.sizeIndicatorColor,t.lineWidth=this._options.sizeIndicatorThickness/this._modules.camera.getZoom();const g=h.getAttribute("radius");this._displaySizeIndicator(t,e,u),n.filter((f=>f.getAttribute("radius")===g)).forEach((f=>this._displaySizeIndicator(t,f))),t.restore()}return u-i}_displaySizeIndicator(t,e,s){s=s||void 0;const n=this._modules.camera.getZoom(),i=e.getPosition(),r=this._getTotalRadius(e),o=(s||r)/n,a=(s?s-r:0)/n,l=a+(-this._options.sizeIndicatorOffset-(s?Number(e.getAttribute("innerStroke.width"))+Number(e.getAttribute("outerStroke.width")):0))/n,u=i.x-o+l|0,h=i.y-o-a|0,g=i.y+o-a|0,f=this._options.sizeIndicatorWidth/n;t.beginPath(),t.moveTo(u-f,h),t.lineTo(u+f,h),t.moveTo(u,h),t.lineTo(u,g),t.moveTo(u-f,g),t.lineTo(u+f,g),t.stroke()}enable(t={}){this._enabled||(this._options={...F1,...t},this._layer=this._modules.layers.addCanvasLayer((e=>{const s=mi(),n=this._modules.camera.getZoom(),{color:i,lineWidth:r}=this._options;let o=this._options.handleSize,a=0;if(this._nodeBeingResized){const l=this._getTotalRadius(this._nodeBeingResized),u=this._nodeBeingResized.getPositionOnScreen();a=Math.max(this._x-(u.x+l),-(this._y-(u.y-l)))/2}this._additionalRadiuses=[],this._nodesToHighlight&&this._nodesToHighlight.forEach((l=>{const u=l.getPosition();let h=this._getTotalRadius(l),g=0;if(this._nodeBeingResized){g=a;const f=-h+Number(l.getAttribute("innerStroke.width"))+Number(l.getAttribute("outerStroke.width"))+r/2+1;g=g<f?f:this._snap(e,l,g),this._additionalRadiuses.push(g);const m=l.getAttribute("shape"),y=this._engine.getShapePoints(m),p=u.x+g/n,x=u.y-g/n,v=h+g;this._displayNodePreview(e,s,p,x,v,y)}e.strokeStyle=i,e.fillStyle=i,e.lineWidth=r/n,h/=n,g/=n,o/=n*s,e.strokeRect(u.x-h,u.y-h-2*g,2*(g+h),2*(g+h)),e.fillRect(u.x+h+2*g-o/2,u.y-h-2*g-o/2,o,o)}))}),{isStatic:!1,noClear:!1}),this._layer.moveToTop(),this._modules.events.on(["mousemove","mousedown"],this._moveHandler),this._enabled=!0)}disable(){this._enabled&&(this._modules.events.off(this._displayHandlesHandler).off(this._moveHandler),this._layer.destroy(),this._disableCursor(),this._reset())}_reset(){this._enabled=!1,this._nodesToHighlight=null,this._options={...F1},this._nodeBeingResized=null,this._pointedNode=null,this._cursorEnabled=!1,this._x=0,this._y=0,this._additionalRadiuses=[]}enabled(){return this._enabled}},A5={strokeColor:"black",strokeWidth:5,dashed:!0,cursorStyle:"cell",createNodes:!0,condition:mx,onNodeCreated:os,onEdgeCreated:os,createNode:lr,createEdge:lr,onComplete:os},w5=class extends Ke{constructor(){super(...arguments),this._enabled=!1,this._blockId=0,this._cursorEnabled=!1}onMounted(){this._engine=this._modules.graphics.getGraphicsEngine(),this._group=this._engine.createGroup(),this._depth=Kd(0).edgeBody,this._modules.events.register(["connectNodes"]),this._interaction=this._modules.interactions.onDrag({priority:"connectNodes",check:({target:t,button:e="left"})=>this._enabled&&e==="left"&&t&&t.isNode&&!t.isVirtual(),onStart:({target:t})=>this._onStart(t),onProgress:({x:t,y:e})=>this._onMove(t,e),onStop:()=>this._onStop()}),this._modules.events.on("clearGraph",(()=>this.disable()))}_onStart(t){t&&(this._cursorEnabled=!0,this._startNode=t,this._startPos=t.getPosition(),this._modules.graphics.addCursorStyle(this._options.cursorStyle),this._blockId=this._modules.graphics.allocateGraphicsEngineBlockId())}_onMove(t,e){this._startNode!==null&&(this._endPos=this._modules.camera.screenToGraphCoordinates({x:t,y:e}),this._drawLine())}_onStop(){if(this._startNode===null)return;const{condition:t,onNodeCreated:e,onEdgeCreated:s,createEdge:n,createNode:i,onComplete:r,createNodes:o}=this._options;let a=this._modules.captor.getPointedElement(),l=null,u=null;if(this._modules.graphics.releaseGraphicsEngineBlockId(this._blockId),!a&&o){const h=i({attributes:{x:this._endPos.x,y:this._endPos.y}});a=this._modules.graph.addNode(h),u=a,e&&e(u)}if(a&&!a.isVirtual()&&(u||!t||t(this._startNode,a))){const h=n({source:this._startNode.getId(),target:a.getId()});l=this._modules.graph.addEdge(h),s&&s(l)}r&&(this._modules.events.fire("connectNodes",{source:this._startNode,target:a,edge:l}),r(this._startNode,a,l||void 0)),this.disable()}_drawLine(){this._group.reset(ar,!1,this._depth);const t=this._group.nextAndReset().end;t.pieceId=Gf,t.shape="line",t.x1=this._startPos.x,t.y1=this._startPos.y,t.x2=this._endPos.x,t.y2=this._endPos.y,t.fillColor=this._options.strokeColor,t.thicknessOrFontSizeFixed=this._options.strokeWidth,this._options.dashed&&(t.dashLength=3,t.gapLength=1),this._engine.storeGroup(this._blockId,this._group),this._modules.dom.refresh()}enable(t={}){return this._enabled||(this._options={...A5,...t},this._enabled=!0,this._cursorEnabled=!1,this._startNode=null,this._prevSettings=this._modules.settings.update({"cursor.node":this._options.cursorStyle,"detect.edges":!1}),this._modules.captor.isLeftPressed()&&this._interaction.start(this._modules.captor.getCursorInformation())),this}disable(){return this._enabled?(this._enabled=!1,this._modules.settings.update(this._prevSettings),this._cursorEnabled&&this._modules.graphics.removeCursorStyle(this._options.cursorStyle),this):this}enabled(){return this._enabled}},T5=["top","bottom","left","right","cssDefined"],C5=1e4,L5={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}},N5={position:"top",autoAdjust:!0,delay:100},M5={hover:{node:({target:t})=>t&&t.isNode,edge:({target:t})=>t&&!t.isNode},click:{left:{node:({target:t,button:e})=>e==="left"&&t&&t.isNode,edge:({target:t,button:e})=>e==="left"&&t&&!t.isNode,background:({target:t,button:e})=>e==="left"&&!t},right:{node:({target:t,button:e})=>e==="right"&&t&&t.isNode,edge:({target:t,button:e})=>e==="right"&&t&&!t.isNode,background:({target:t,button:e})=>e==="right"&&!t}},doubleclick:{left:{node:({target:t,button:e})=>e==="left"&&t&&t.isNode,edge:({target:t,button:e})=>e==="left"&&t&&!t.isNode,background:({target:t,button:e})=>e==="left"&&!t},right:{node:({target:t,button:e})=>e==="right"&&t&&t.isNode,edge:({target:t,button:e})=>e==="right"&&t&&!t.isNode,background:({target:t,button:e})=>e==="right"&&!t}}},I5=class extends Ke{constructor(){super(...arguments),this._x=0,this._y=0}onMounted(){this._handlers={},this._currentHandlerName=null,this._tooltip=null,this._isHover=!1,this._modules.events.register(["tooltipShow","tooltipHide"]),this._modules.events.on(["mouseup","dragStart"],(()=>{this._isHover||this._hideTooltip(!1)})).on("mouseout",(()=>{this._isHover&&this._hideTooltip(!1)})).on("clearGraph",(()=>this._hideTooltip(!1))),this._modules.interactions.onHover(this._createInteraction("hover",!0)),this._modules.interactions.onClick(this._createInteraction("click")),this._modules.interactions.onDoubleClick(this._createInteraction("doubleclick"))}hide(){this._hideTooltip(!0)}isShown(){return!!this._tooltip}refresh(){this._refreshTooltip()}show(t,{position:e="top",autoAdjust:s=!0,className:n,x:i=0,y:r=0}={}){this._showTooltip(t,{position:e,autoAdjust:s,className:n},{x:i,y:r})}setHandler(t,e,s){const n={...N5,...s};n.position&&T5.indexOf(n.position)===-1&&(n.position="top"),this._handlers[t]={handler:e,condition:qs(M5,t),settings:n}}_hideTooltip(t){if(this._timeout&&(this._modules.dom.clearTimeout(this._timeout),this._timeout=null),t&&(this._currentHandlerName=null),this._tooltip){const e=this._tooltip;this._tooltip.parentNode&&this._tooltip.parentNode.removeChild(this._tooltip),this._tooltip=null,this._modules.events.fire("tooltipHide",{tooltip:e})}}_createInteraction(t,e=!1){return{priority:"tooltip",check:s=>{const n=P1(t,s),i=this._handlers[n];return(!e||!this._modules.connectNodes.enabled())&&(!(!i||!i.condition(s))||!(e||!this._currentHandlerName||this._isHover)&&this._tooltip!==null)},handler:s=>{const{target:n,x:i,y:r}=s;this._hideTooltip(!1),this._isHover=e,this._elt=n,this._x=i,this._y=r,this._currentHandlerName=P1(t,s),this._refreshTooltip()}}}_refreshTooltip(){if(!this._currentHandlerName)return void this._hideTooltip(!1);const t=this._handlers[this._currentHandlerName];if(!t)return;const{settings:e,handler:s}=t,n=this._elt;if(n){const r=n.isNode?"node":"edge";if(this._currentHandlerName.indexOf(r)===-1)return}const i=s(n);Promise.resolve(i).then((r=>this._schedule((()=>this._showTooltip(r,e)),e.delay)))}_schedule(t,e){this._timeout&&this._modules.dom.clearTimeout(this._timeout),this._timeout=this._modules.dom.setTimeout((()=>{this._timeout=null,t()}),e)}_showTooltip(t,e,s){this._hideTooltip(!1);const{position:n,className:i,autoAdjust:r}=e;let o=this._x,a=this._y,l=this._elt;const u=this._modules.dom.getDimensions();let h=0,g=0;if(s&&(o=s.x,a=s.y,l=null),typeof t=="string")this._tooltip=k5("div"),Ww(this._tooltip,Ax.sanitize(t));else{if(!OT(t))throw new Error(`invalid tooltip ${t}, expected HTML string or HTML element`);this._tooltip=t}const f=this._tooltip;if(i&&this._tooltip.classList.add(i),n!=="cssDefined"&&(f.style.position="absolute"),f.style.zIndex=C5.toString(),this._modules.dom.appendElement(f),l&&l.isNode){const p=l,x=p.getPositionOnScreen(),v=Number(p.getAttribute("radius"))*(p.getAttribute("scalingMethod")==="fixed"?1:this._modules.camera.getZoom())+Number(p.getAttribute("innerStroke.width"))+Number(p.getAttribute("outerStroke.width"));o=x.x,a=x.y,h=v,g=v}const m=f.offsetWidth/2,y=f.offsetHeight/2;if(h+=m,g+=y,n&&n!=="cssDefined"){const p=L5[n];let x=p.x,v=p.y;if(r){const b=o+h*p.x,S=a+g*p.y;(b-m<0||b+m>=u.width)&&(n==="left"||n==="right"?x*=-1:x=b-m<0?(m-b+1)/h:(u.width-(b+m)-1)/h),(S-y<0||S+y>=u.height)&&(n==="top"||n==="bottom"?v*=-1:v=S-y<0?(y-S+1)/g:(u.height-(S+y)-1)/g)}f.style.left=o+h*x-m+"px",f.style.top=a+g*v-y+"px"}this._modules.events.fire("tooltipShow",{tooltip:f})}};function P1(t,{button:e,target:s}){return`${t}${e?`.${e}`:""}.${s!==null?s.isNode?"node":"edge":"background"}`}function k5(t){return eo?document.createElement(t):Jg()}var Dd={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",46:"del",8:"backspace",32:"space",224:"cmd",91:"cmd",92:"cmd",93:"cmd",187:"+",189:"-"},z1=Object.keys(Dd).reduce(((t,e)=>{const s=Dd[e];return t[s]||(t[s]=[]),t[s].push(e),t}),{}),R5=38,F5=40,P5=37,z5=39,D5=187,O5=189,B5=class extends Ke{constructor(){super(...arguments),this._onKeyPress=t=>{if((t==="zoomIn"||t==="zoomOut")&&!this._modules.settings.get("interactions.zoom.keyboard")||(t==="moveUp"||t==="moveDown"||t==="moveLeft"||t==="moveRight")&&!this._modules.settings.get("interactions.pan.keyboard")||this._modules.dom.hasFocus()===!1)return;const{width:e,height:s}=this._ogma.view.getGraphBoundingBox(),n=Math.max(e,s)/10,i={duration:150,easing:"cubicOut"};if(t==="zoomIn")return this._ogma.view.zoomIn(i);if(t==="zoomOut")return this._ogma.view.zoomOut(i);const r={x:0,y:0};return t==="moveLeft"?r.x=-n:t==="moveRight"?r.x=n:t==="moveUp"?r.y=-n:t==="moveDown"&&(r.y=n),this._ogma.view.move(r,i)},this._onBlur=()=>this.resetKeys(),this._onKeyUp=t=>{const e=t.keyCode||t.which;this._pressed[e]=!1,this._modules.events.fire("keyup",{domEvent:t,key:Dd[e],code:e})},this._onKeyDown=t=>{const e=t.keyCode||t.which,s=this._binds[e];if(!this._pressed[e]){if(this._pressed[e]=!0,s)for(const n of s)n.keys.every((i=>i.some((r=>this._pressed[r]))))&&n.handler({domEvent:t});this._modules.events.fire("keydown",{domEvent:t,key:Dd[e],code:e})}}}onMounted(){this._modules.events.register(["keyup","keydown"]),this._binds=[],this._pressed=[],this._modules.dom.addWindowEventListener("keydown",this._onKeyDown).addWindowEventListener("keyup",this._onKeyUp).addWindowEventListener("visibilitychange",this._onBlur).addWindowEventListener("blur",this._onBlur,!1),this._idleTimeout=4e3,this._prevEventTimeStamp=$n(),this._modules.events.onAnyEvent((()=>{const t=$n();t-this._prevEventTimeStamp>this._idleTimeout&&this.resetKeys(),this._prevEventTimeStamp=t})),this._modules.settings.register("interactions.pan.keyboard",!0),this._modules.settings.register("interactions.zoom.keyboard",!0),this._setupManualControls()}_setupManualControls(){this.onKeyPress(D5,(()=>this._onKeyPress("zoomIn"))).onKeyPress(O5,(()=>this._onKeyPress("zoomOut"))).onKeyPress(R5,(()=>this._onKeyPress("moveUp"))).onKeyPress(F5,(()=>this._onKeyPress("moveDown"))).onKeyPress(P5,(()=>this._onKeyPress("moveLeft"))).onKeyPress(z5,(()=>this._onKeyPress("moveRight")))}setIdleTimeout(t){if(!isFinite(t)||t<=1)throw new TypeError("Idle timeout must be a positive number > 1");this._idleTimeout=t}resetKeys(){for(let t=0;t<this._pressed.length;t++)this._pressed[t]&&(this._pressed[t]=!1,this._modules.events.fire("keyup",{key:Dd[t],code:t}))}onKeyPress(t,e){let s=[];if(typeof t=="number")s=[t];else if(typeof t=="string")s=t.split(" ");else{if(!Array.isArray(t))throw new TypeError(`${t} is not a number, string or array`);s=t}if(s.length===0)throw new Error("the array should contain at least one element");const n=s.map((o=>{if(typeof o=="number")return[o];if(typeof o=="string"){const a=z1[o];if(!a)throw new Error(`${o} is not a valid key identifier`);return a}throw new TypeError(`${o} is not a valid key identifier`)})),i=n.pop(),r={keys:n,handler:e};return i&&i.forEach((o=>{this._binds[o]||(this._binds[o]=[]),this._binds[o].push(r)})),this}isPressed(t){if(typeof t=="number")return this._pressed[t];if(typeof t=="string"){const e=z1[t];if(e)return e.some((s=>this._pressed[s]))}return!1}},U5=[{name:"color",isNode:!0},{name:"shape",isNode:!0},{name:"radius",isNode:!0},{name:"icon.content",isNode:!0},{name:"image.url",isNode:!0},{name:"image",isNode:!0},{name:"color",isNode:!1},{name:"shape",isNode:!1},{name:"width",isNode:!1}],ro=Math.PI,oo=2*Math.PI,LN=Math.cos(ro/2-oo/5),NN=Math.cos(ro/2-oo/5*2),MN=Math.cos(ro/2-oo/5*3),IN=Math.cos(ro/2-oo/5*4),kN=Math.sin(-ro/2+oo/5),RN=Math.sin(-ro/2+oo/5*2),FN=Math.sin(-ro/2+oo/5*3),PN=Math.sin(-ro/2+oo/5*4),xf=1.6,zN=3,G5=.9,mg=.31,u_=1/3,V5=[8,3],j5=[3,3],pg={position:"bottom",widgetWidth:130,fontFamily:"Arial",fontSize:10,fontColor:"black",titleFontSize:12,titleFontColor:"black",titleMaxLength:20,titleTextAlign:"left",shapeColor:"grey",backgroundColor:"white",borderColor:"black",borderRadius:0,borderWidth:1,innerMargin:10,outerMargin:5,circleStrokeWidth:3,titleFunction:t=>t[t.length-1]},H5=["widgetWidth","fontSize","titleFontSize","borderRadius","borderWidth","innerMargin","outerMargin","circleStrokeWidth"];function DN(t){return Array.isArray(t)?t.reduce(((e,s)=>e&&DN(s)),!0):t==="undefined"||!isNaN(Number(t))}function ON(t){return Array.isArray(t)?t.reduce(((e,s)=>Math.min(e,ON(s))),1/0):typeof(t=Number(t))=="number"?isNaN(t)?1/0:+t:1/0}function BN(t){return Array.isArray(t)?t.reduce(((e,s)=>Math.max(e,BN(s))),-1/0):typeof(t=Number(t))=="number"?isNaN(t)?-1/0:+t:-1/0}function to(t){const e=["K","M","B","T","P","E","Z","Y"];if(t>9999){let s=0;for(;s<e.length&&t>999;)t/=1e3,s++;return(D1(t,3)+e[s-1]).toString()}return D1(t,4).toString()}function D1(t,e=3){const s=e===4?10:1;return t<10?Math.round(100*t*s)/(100*s):t<100?Math.round(10*t*s)/(10*s):t<1e3?Math.round(t*s)/s:Math.round(t)}function UN(t){return t.innerMargin+(t.titleFontSize+t.fontSize)*xf}var $5=(t,e)=>t.isNode!==e.isNode?t.isNode?-1:1:t.title<=e.title?-1:1,q5=(t,e)=>t.height-e.height,Y5=(t,e)=>t.isNode!==e.isNode?t.isNode?-1:1:e.height-t.height,W5=(t,e)=>t.isNode!==e.isNode?t.isNode?-1:1:t.content[0].title<=e.content[0].title?-1:1;function X5(t,e,s){const n=e.getContext("2d"),{x:i,y:r,height:o,isNode:a,styleProperty:l,title:u,mapping:h,iconFont:g,iconFontStyle:f}=s;Q5(n,t,i,r,o),J5(n,t,u,i,r);const m=t.fontSize*xf,y=t.fontSize/2*xf*G5,p=t.fontSize*zN,x=t.fontSize,v=K5(t,a);let b=r+UN(t);const S=i+t.innerMargin+v/2,A=i+2*t.innerMargin+v,w=Cd(h),L=DN(w),k=t.fontColor,F=t.shapeColor,O=Object.keys(h);if(L&&(O.sort(((j,V)=>Yr(h[V])-Yr(h[j]))),l==="radius"||l==="width")){const j=ON(w),V=BN(w);return(a?fV:mV)(t,n,i,b,j,(j+V)/2,V,F)}O.forEach((j=>{const V=h[j];l==="color"&&(a?GN(n,S,b,y,j):eV(n,S,b,p,x,j)),l==="shape"&&(a?lV(n,S,b,y,j,F):cV(n,S,b,p,x,j,F)),l==="icon.content"&&sV(n,S,b,j,g,y,k,f),l!=="image"&&l!=="image.url"||nV(n,S,b,y,j),tV(n,t,A,b,V,L),b+=m}))}function Z5(t,e,s,n,i,r){t.beginPath(),t.arc(e,s,n,0,oo),t.strokeStyle=i,t.lineWidth=r,t.stroke()}function Th(t,e,s,n,i="left",r="normal"){t.textAlign=i,t.textBaseline="middle",t.fillStyle=n,t.font=`${r} ${s}px "${e}"`}function K5(t,e){const s=e?1:zN;return t.fontSize*s}function Q5(t,e,s,n,i){return gV(t,s,n,e.widgetWidth,i,e.borderRadius,e.backgroundColor,e.borderColor,e.borderWidth)}function J5(t,e,s,n,i){Th(t,e.fontFamily,e.titleFontSize,e.titleFontColor,e.titleTextAlign);const r=e.titleTextAlign==="center",o=e.widgetWidth-2*e.innerMargin,a=t.measureText(s).width,l=n+(r?e.widgetWidth/2:e.innerMargin),u=i+e.titleFontSize/2+e.innerMargin;if(a>o){const h=o/a,g=(s.length*h|0)-2;s=s.substr(0,g)+""}t.fillText(s,l,u)}function tV(t,e,s,n,i,r){let o=i.join();if(r)if(i.length===1)o=to(i[0]);else{const a=Yr(i),l=Ul(i);o=`${to(a)} - ${to(l)}`}Th(t,e.fontFamily,e.fontSize,e.fontColor),t.fillText(o,s,n)}function GN(t,e,s,n,i){t.beginPath(),t.arc(e,s,n,0,2*ro),t.fillStyle=i,t.fill()}function eV(t,e,s,n,i,r){t.fillStyle=r,t.fillRect(e-n/2,s-i/2,n,i)}function sV(t,e,s,n,i,r,o,a){Th(t,i,2*r,o,"center",a),t.fillText(n,e,s)}function nV(t,e,s,n,i){if(typeof Image>"u")return;t._imgStore||(t._imgStore={});let r=t._imgStore[i];if(r)return t.drawImage(r,e-n,s-n,2*n,2*n);r=new Image,r.src=i,r.onload=()=>{t.drawImage(r,e-n,s-n,2*n,2*n)},t._imgStore[i]=r}function iV(t,e,s,n){t.fillRect(e-n,s-n*mg,2*n,2*n*mg),t.fillRect(e-n*mg,s-n,2*n*mg,2*n)}function rV(t,e,s,n){return t.beginPath(),t.moveTo(e-n,s),t.lineTo(e,s-n),t.lineTo(e+n,s),t.lineTo(e,s+n),t.fill()}function oV(t,e,s,n){t.beginPath(),t.moveTo(e,s-n),t.lineTo(e+LN*n,s+kN*n),t.lineTo(e+NN*n,s+RN*n),t.lineTo(e+MN*n,s+FN*n),t.lineTo(e+IN*n,s+PN*n),t.fill()}function aV(t,e,s,n){t.beginPath(),t.moveTo(e,s-n),t.lineTo(e+NN*n,s+RN*n),t.lineTo(e+IN*n,s+PN*n),t.lineTo(e+LN*n,s+kN*n),t.lineTo(e+MN*n,s+FN*n),t.fill()}function lV(t,e,s,n,i,r){switch(t.fillStyle=r,i){case"square":return t.fillRect(e-n,s-n,2*n,2*n);case"circle":return GN(t,e,s,n,r);case"cross":return iV(t,e,s,n);case"diamond":return rV(t,e,s,n);case"equilateral":return oV(t,e,s,n);case"star":return aV(t,e,s,n)}}function uV(t,e,s,n,i){t.fillRect(e-n/2,s-i/4,n*(1-u_),i/2),t.beginPath(),t.moveTo(e+n*(1-u_-.5),s-i/2),t.lineTo(e+n*(1-u_-.5),s+i/2),t.lineTo(e+n/2,s),t.fill()}function dV(t,e,s,n,i,r,o){t.beginPath(),t.moveTo(e-n/2,s),t.lineTo(e+n/2,s),t.strokeStyle=r,t.lineWidth=i/2,t.setLineDash(o==="dashed"?V5:j5),t.stroke()}function hV(t,e,s,n,i){t.beginPath(),t.moveTo(e-n/2,s-i/2),t.lineTo(e-n/2,s+i/2),t.lineTo(e+n/2,s),t.fill()}function cV(t,e,s,n,i,r,o){return t.fillStyle=o,r==="line"&&t.fillRect(e-n/2,s-i/4,n,i/2),r==="arrow"?uV(t,e,s,n,i):r==="dashed"||r==="dotted"?dV(t,e,s,n,i,o,r):r==="tapered"?hV(t,e,s,n,i):void 0}function gV(t,e,s,n,i,r,o,a,l){t.setLineDash([]),t.beginPath(),t.moveTo(e+r,s),t.lineTo(e+n-r,s),t.quadraticCurveTo(e+n,s,e+n,s+r),t.lineTo(e+n,s+i-r),t.quadraticCurveTo(e+n,s+i,e+n-r,s+i),t.lineTo(e+r,s+i),t.quadraticCurveTo(e,s+i,e,s+i-r),t.lineTo(e,s+r),t.quadraticCurveTo(e,s,e+r,s),t.closePath(),t.fillStyle=o,t.fill(),t.strokeStyle=a,t.lineWidth=l,t.stroke()}function fV(t,e,s,n,i,r,o,a){const l=.7*t.fontSize,u=3*l,h=(l+u)/2,g=s+t.innerMargin+u,f=g+u+t.innerMargin,m=n+2*u-.5*t.innerMargin,y=t.circleStrokeWidth;for(const p of[l,h,u])Z5(e,g,m-p,p,a,y);Th(e,t.fontFamily,t.fontSize,t.fontColor,"left"),e.fillText(to(i),f,m+l-2*l),e.fillText(to(r),f,m+l-2*h),e.fillText(to(o),f,m+l-2*u)}function mV(t,e,s,n,i,r,o,a){const l=(t.widgetWidth-2*t.innerMargin)/3,u=t.fontSize,h=n-t.innerMargin/2,g=h+2*u,f=s+t.innerMargin;e.fillStyle=a,e.fillRect(f,h-u/2,l+1,u),e.fillRect(f+l,h-u/3,l+1,u/1.5),e.fillRect(f+2*l,h-u/6,l,u/3),Th(e,t.fontFamily,t.fontSize,t.fontColor,"center"),e.fillText(to(o),f+.5*l,g),e.fillText(to(r),f+1.5*l,g),e.fillText(to(i),f+2.5*l,g)}function pV(t,e,s,n){const i=n.outerMargin+UN(n),r=n.fontSize*xf,o=i-.8*n.innerMargin;return e==="radius"||e==="width"?o+r*(s?3:2):o+Object.keys(t).length*r}function _V(t,e,s){const n={width:e.width,height:e.height};let i=!1;return!!(n.width&&n.height&&s)&&(i=t.position==="top"||t.position==="bottom"?bV(n,t,s,t.position==="bottom"):yV(n,t,s,t.position==="left"),i&&s.forEach((r=>X5(t,e,r))),i)}function yV(t,e,s,n){const i=e.widgetWidth+e.outerMargin,r=Math.floor((t.width-e.outerMargin)/i),o=t.height;let a=e.outerMargin,l=n?e.outerMargin:t.width-i,u=1;s=s.slice().sort($5);for(let h=0;h<s.length;++h){const g=s[h];if(a+g.height>o){if(a===e.outerMargin)return!1;a=e.outerMargin,u+=1,n?l+=i:l-=i}g.x=l,g.y=a,a+=g.height}return u<=r}function xV(t,e,s){let n=null;for(let i=0;i<e.length;++i){const r=e[i];r.isNode!==t.isNode&&e.length!==1||!(n===null||r.height<e[n].height)||(n=i)}if(n!=null){const i=e[n];i.content.push(t),i.height+=t.height+s.outerMargin}}function vV(t){let e=0;for(let s=1;s<t.length;++s)t[s].height>t[e].height&&(e=s);return e}function bV(t,e,s,n){s=s.slice();const i=e.widgetWidth+e.outerMargin,r=Math.floor((t.width-e.outerMargin)/i),o=t.height-e.outerMargin,a=new Array(Math.min(r,s.length)),l=s.length;let u=0,h=0,g=0,f=0;for(let S=0;S<l;++S){const A=s[S];A.isNode?(u+=1,h+=A.height):(g+=1,f+=A.height)}const m=h+f,y=h/m,p=f/m;let x=Math.round(y*r);const v=Math.round(p*r);if(x>u?x=u:v>g&&(x=r-g),r===0)return!1;for(let S=0;S<a.length;S++)a[S]={content:[],height:0,isNode:S<x};for(let S=0;S<l;++S){const A=vV(s);xV(s[A],a,e),s.splice(A,1)}a.every((({content:S})=>S.length===1))?a.sort(W5):a.sort(Y5);let b=e.outerMargin;for(let S=0;S<a.length;++S){const A=a[S];if(A.height>o)return!1;A.content.sort(q5);let w=0;for(let L=0;L<A.content.length;++L){const k=A.content[L];k.x=b,k.y=n?t.height-w-k.height-e.outerMargin:w+e.outerMargin,w+=k.height+e.outerMargin}b+=i}return!0}var EV=class extends Ke{constructor(){super(...arguments),this._enabled=!1,this._mustRefresh=!1,this._promises=[]}onMounted(){this._modules.events.on("frame",(()=>{this._enabled&&this._mustRefresh&&this._layer.refresh()})).on(["resize","reloadFonts"],(()=>{this._mustRefresh=!0}))}enable(t={}){const e=this._settings;return this._settings={...pg,...t},this._mustRefresh=!this._enabled||!this._sameOptions(e,this._settings),this._enabled?Promise.resolve():(this._enabled=!0,this._layer=this._modules.layers.addCanvasLayer((s=>{this._drawOnCanvas(this._settings,s.canvas,mi());const n=this._promises;this._promises=[],n.forEach((i=>i())),this._mustRefresh=!1}),{isStatic:!0,noClear:!1}),this._layer.moveToTop(),this.refresh())}_afterNextUpdate(){return new Promise((t=>this._promises.push(t)))}_formatSettings(t,e){const s={...pg,...t};return H5.forEach((n=>s[n]*=e)),s}disable(){return this._enabled&&(this._enabled=!1,this._layer.destroy()),Promise.resolve()}enabled(){return this._enabled}refresh(){return this._mustRefresh=!0,this._modules.dom.refresh(),this._afterNextUpdate()}destroy(){this._enabled=!1,this._mustRefresh=!1,this._settings={...pg},this._promises=[]}getOptions(){return this._enabled?{...this._settings}:{...pg}}getCurrentOptions(){return this._settings}_sameOptions(t,e){return t===e||Object.keys(t).reduce(((s,n)=>s&&t[n]===e[n]),!0)}_drawOnCanvas(t,e,s){const n=this._formatSettings(t,s);_V(n,e,this._computeWidgetList(n))}exportOnCanvas(t,e,s){return this._drawOnCanvas(e,t,s)}export(t={}){const{width:e,height:s}={...this._modules.camera.getSize(),...t},n=mi(),i=Fn(e*n,s*n);return this._drawOnCanvas(t,i,n),Promise.resolve().then((()=>i))}_computeWidgetList(t){const e=[];return U5.forEach((({name:s,isNode:n})=>{const i=this._computeWidget(t,s,n);i&&e.push(i)})),e}_computeWidget(t,e,s){const n=this._computePropertyMapping(t,e,s);if(n){if(e!=="icon.content")return n;const i=this._getRulesForAttribute(s,"icon.font"),r=this._getRulesForAttribute(s,"icon.style");let o=null,a=null;if(i.length||(o="Arial",a="normal"),typeof i[0]=="string"&&(o=i[0],a=r[0]),o&&a)return n.iconFont=o,n.iconFontStyle=a,n}return null}_computePropertyMapping(t,e,s){const[n]=this._getRulesForAttribute(s,e),i=n&&n.mapping,r=i&&i.getValues(s);if(i&&r){const o=i.getField(),a={};return Cr(r,((l,u)=>{l!==void 0&&u!=="undefined"&&(a[l]=a[l]||[],a[l].push(u))})),Object.keys(a).length===0?null:{isNode:s,title:t.titleFunction(o,e),styleProperty:e,dataProperty:o,mapping:a,height:pV(a,e,s,t)}}return null}_getRulesForAttribute(t,e){return this._modules.styleRules.getRuleList().map((s=>{const n=s.getDefinition();return qs(t?n.nodeAttributes:n.edgeAttributes,e)})).filter(lr).sort(((s,n)=>s.mapping&&n.mapping?0:s.mapping?-1:1))}},O1={layer:b2,outerStroke:{color:WC,width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:XC,minVisibleSize:0}},SV={layer:b2,color:WC,text:{backgroundColor:XC,minVisibleSize:0}},B1={duration:150,easing:"quadradicOut"},AV=class extends Ke{constructor(){super(...arguments),this._delay=16,this._manualTriggerDetection=!1,this._hovered=null,this._hoveredTextHidden=!1,this._onAnimate=({updatesPositions:t})=>{t&&this._hovered&&this._modules.graphics.isMoving(this._hovered)&&(this._manualTriggerDetection=!0,this._resetHover())},this._onBeforeNewFrame=()=>{if(this._manualTriggerDetection){this._manualTriggerDetection=!1,this._modules.captor.triggerDetection();const t=this._modules.captor.getPointedElement();t&&this._hover(t)}},this._onClear=()=>{this._hovered=null,this._timeout&&this._modules.dom.clearTimeout(this._timeout)},this._resetHover=()=>{this._hovered&&(this._unhover(this._hovered),this._modules.captor.triggerUnhover()),this._timeout&&(this._modules.dom.clearTimeout(this._timeout),this._timeout=null)}}_setAnimationOptions(t){this._animationOptions={duration:(t==null?void 0:t.duration)!==void 0?t.duration:B1.duration,easing:(t==null?void 0:t.easing)!==void 0?t.easing:B1.easing},t==null||delete t.duration,t==null||delete t.easing}setRate(t){return this._delay=t,this}replaceNullColor(t,e){t&&qs(t,e)===null&&Kr(t,e,this._modules.settings.get("backgroundColor"))}updateNodeAttributes(t,e){this._setAnimationOptions(t),this.replaceNullColor(t,"text.backgroundColor"),this._hoverClass.update({nodeAttributes:t,fullOverwrite:e}),this._hoverExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()}updateEdgeAttributes(t,e){this.replaceNullColor(t,"text.backgroundColor"),this.replaceNullColor(t,"text.secondary.backgroundColor"),this._setAnimationOptions(t),this._hoverClass.update({edgeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()}getHoverClassDefinition(){return this._hoverClass.getDefinition()}onMounted(){this._registerSettings(),this._setAnimationOptions(null),this._hoverExtremityHighlightedClass=this._modules.classes.createClass({name:ny,isBuiltin:!0,nodeAttributes:O1}),this._hoverClass=this._modules.classes.createClass({name:Nd,isBuiltin:!0,nodeAttributes:O1,edgeAttributes:SV}),this._modules.events.on("mouseover",(({target:t})=>t&&this._hover(t))).on("mouseout",(({target:t})=>t&&this._unhover(t))).on("animate",this._onAnimate).on("beforeNewFrame",this._onBeforeNewFrame).on("mouseout",this._resetHover).on("clearGraph",this._onClear)}_registerSettings(){this._modules.settings.register("cursor.node","pointer",((t,e)=>{this._hovered&&this._hovered.isNode&&(this._modules.graphics.removeCursorStyle(e),this._modules.graphics.addCursorStyle(t))})),this._modules.settings.register("cursor.edge","pointer",((t,e)=>{this._hovered&&!this._hovered.isNode&&(this._modules.graphics.removeCursorStyle(e),this._modules.graphics.addCursorStyle(t))})),this._modules.settings.register("nodeHover",!0,(t=>{!t&&this._hovered&&this._hovered.isNode&&this._unhover(this._hovered)})),this._modules.settings.register("edgeHover",!0,(t=>{t||!this._hovered||this._hovered.isNode||this._unhover(this._hovered)}))}setEdgeExtremitiesAttributes(t,e){this._hoverExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e})}_updateExtremityHighlightLayer(){const t=this._hoverClass.getDefinition().edgeAttributes,e=t?t.layer:void 0;this._hoverExtremityHighlightedClass.update({nodeAttributes:{layer:e},fullOverwrite:!1})}_removeTimeout(){this._timeout&&(this._modules.dom.clearTimeout(this._timeout),this._timeout=null)}_hover(t){const e=t.isNode?"nodeHover":"edgeHover";this._modules.settings.get(e)&&t&&(this._removeTimeout(),this._timeout=this._modules.dom.setTimeout((()=>{this._setElementHighlight(!0,t),this._timeout=null}),this._delay))}_unhover(t){this._removeTimeout(),this._hovered===t&&(this._setElementHighlight(!1,t),this._hoverExtremityHighlightedClass.clearNodes(),this._hovered=null)}_setElementHighlight(t,e){const s=this._modules.settings.get(e.isNode?"cursor.node":"cursor.edge");if(t?(this._modules.graphics.addCursorStyle(s),e.addClass(Nd,this._animationOptions),this._hovered=e):(this._modules.graphics.removeCursorStyle(s),e.removeClass(Nd,this._animationOptions)),e.isNode){const n=this._modules.graph.getAttribute(e.isNode,"textHidden"),i=e._index;t&&(this._hoveredTextHidden=n.get(i)!==0);const r=!t&&this._hoveredTextHidden;n.set(i,r)}else this._hoverExtremityHighlightedClass.clearNodes(),t&&e.getExtremities().addClass(ny,this._animationOptions)}},wV=class extends Ke{constructor(){super(...arguments),this.x=0,this.y=0}},TV=class{constructor(t,e){this._nodeMapping={valid:!1,values:{}},this._edgeMapping={valid:!1,values:{}},this._computeMapping=e,this._field=t,this._assignedRules=[]}getValue(t,e){const s=t.isNode,n=s?this._nodeMapping:this._edgeMapping;n.valid||(n.values=this._computeMapping(s),n.valid=!0);const i=t.getData(this._field);return Array.isArray(i)?e==="color"?i.map((r=>n.values[r])):n.values[i[0]]:n.values[i]}markAsInvalid(){this._nodeMapping.valid=!1,this._edgeMapping.valid=!1}getValues(t){return t?this._nodeMapping.values:this._edgeMapping.values}getField(){return this._field}isAssignedTo(t){return this._assignedRules.find((e=>e===t))}getAssignedRules(){return this._assignedRules.slice()}assignTo(t){this.isAssignedTo(t)||this._assignedRules.push(t)}unAssignTo(t){this._assignedRules=this._assignedRules.filter((e=>e!==t))}};function VN(t,e,s){const n=(e?t.getNodes():t.getEdges()).getData(s),i={};return n.forEach((r=>{if(!Array.isArray(r))return i[r]=1;r.forEach((o=>i[o]=1))})),Object.keys(i).sort()}function CV(t,e,s,n){const{values:i={},fallback:r}=s,o=VN(t,n,e),a={};let l=0;for(let u=0;u<o.length;++u){const h=o[u];h in i?a[h]=i[h]:(a[h]=r[l],l=(l+1)%r.length)}return a}function LV(t,{nbSlices:e,minValue:s,maxValue:n}){if(Array.isArray(t))return t.slice();const{min:i=s,max:r=n}=t,o=(r-i)/e,a=[];for(let l=1;l<e;++l)a.push(i+o*l);return a}function NV(t,e){if(Array.isArray(t))return t;const{min:s,max:n}=t,i=e.length+1,r=(n-s)/e.length,o=[];for(let a=0;a<i;a++)o.push(s+a*r);return o}function MV(t,e,s,n){const{fallback:i,stops:r={},values:o,reverse:a}=s,l=VN(t,n,e);let u=1/0,h=-1/0;for(let y=0;y<l.length;y++){const p=+l[y];Vf(p)&&(u=Math.min(u,p),h=Math.max(h,p),l[y]=p)}const g={};if(!isFinite(u)){for(let y=0;y<l.length;y++)g[l[y]]=i;return g}const f=LV(r,{nbSlices:Array.isArray(o)?o.length:o.nbSlices,minValue:u,maxValue:h}),m=NV(o,f);a&&m.reverse();for(let y=0;y<l.length;++y){const p=l[y];if(isFinite(p)){let x=0;for(;x<f.length&&f[x]<=p;)x+=1;g[p]=m[x]}else g[p]=i}return g}var IV=class extends Ke{constructor(){super(...arguments),this._mappingList=[],this._onStyleRuleRemoved=({rule:t})=>{for(const e of this._mappingList)e.unAssignTo(t.id)},this._onStyleRuleAdded=({rule:t,options:e})=>{const s=e.nodeAttributes&&typeof e.nodeAttributes!="function"?e.nodeAttributes:{},n=e.edgeAttributes&&typeof e.edgeAttributes!="function"?e.edgeAttributes:{};[...Cd(s),...Cd(n)].forEach((i=>{i&&this._recursiveGetMapping(i).forEach((r=>r.assignTo(t.id)))}))},this._refreshRulesAndLegend=()=>{this._mappingList.forEach((t=>{const e=t.getAssignedRules();t.markAsInvalid(),e.forEach((s=>this._modules.styleRules.refreshRule(s)))})),this._modules.legend.refresh()}}onMounted(){this._modules.events.on(["addStyleRule","updateStyleRule"],this._onStyleRuleAdded).on("removeStyleRule",this._onStyleRuleRemoved).on(["addNodes","addEdges","updateNodeData","updateEdgeData","removeNodes","beforeRemoveEdges","excludedStateChange","clearGraph"],this._refreshRulesAndLegend)}_recursiveGetMapping(t,e=[]){if(!t)return e;if(t.mapping)return e.push(t.mapping),e;if(typeof t!="object")return e;const s=Cd(t).map((n=>this._recursiveGetMapping(n)));return e.concat(...s)}createMapping({field:t,values:e={},fallback:s}={field:""}){if(t=Da(t),Array.isArray(s)?s.length===0&&(s=[void 0]):s=[s],!Oa(e))throw new Error('"mapping" should be an object');return this._createMappingFunction(CV,t,{values:e,fallback:s})}createSlices({field:t,fallback:e,stops:s={},values:n,reverse:i=!1}={field:"",values:[]}){if(t=Da(t),Array.isArray(n)||n.nbSlices||(n.nbSlices=7),Array.isArray(s)&&Array.isArray(n)&&s.length!==n.length-1)throw new Error("there should be exactly one more value that stops");return this._createMappingFunction(MV,t,{fallback:e,stops:s,values:n,reverse:i})}_createMappingFunction(t,e,s){const n=new TV(e,(r=>t(this._modules.graph,e,s,r)));this._mappingList.push(n);const i=(r,o,a)=>n.getValue(r,a);return i.mapping=n,i}createTemplate(t){if(typeof t!="string")throw new TypeError('"template" should be a string');const e=[];let s=0,n=!1;for(;!n;){let i=-1;const r=t.indexOf("{{",s);r!==-1&&(i=t.indexOf("}}",r+2)),i!==-1?(e.push(t.substring(s,r)),e.push(t.substring(r+2,i)),s=i+2):(e.push(t.slice(s)),n=!0)}return function(i){let r=e[0];for(let o=1;o<e.length;o+=2)r+=i.getData(e[o]),r+=e[o+1];return r}}},U1=t=>t.stopPropagation(),kV=(t,e)=>{e.style.position="absolute",e.style.left="0",e.style.top="0",t.appendChild(e)},RV=t=>e=>{for(;t.firstChild;)t.removeChild(t.firstChild);for(let s=0;s<e.length;++s)kV(t,e[s])},FV=(t,e)=>{const s=document.createElement("img");return new Promise((n=>{s.addEventListener("load",(()=>{e.drawImage(s,0,0,e.canvas.width,e.canvas.height),n(e)}));const i=`data:image/svg+xml;base64,${btoa(new XMLSerializer().serializeToString(t))}`;s.src=i}))},PV=class extends Ke{constructor(){super(...arguments),this._elements=[],this._layers=[],this.readyCallbacks=[],this.render=(t,e,s,n)=>{const i=n&&n.pixelRatio?n.pixelRatio:mi(),{zoom:r,x:o,y:a,width:l,height:u}=n||this._modules.camera.getView();if(r===void 0||o===void 0||a===void 0||l===void 0||u===void 0)return null;const h=i*r;s.noClear||t.clearRect(0,0,l*i,u*i),s.isStatic||(t.save(),t.translate(l*i/2,u*i/2),t.rotate(n?-(n.angle||0):-this._modules.camera.getAngle()),t.translate(-o*h,-a*h),t.scale(h,h)),e(t),s.isStatic||t.restore()},this.createCanvas=(t,e)=>{const{width:s,height:n}=this._modules.camera.getSize(),i=e.canvas||Fn(s,n),r=e.ctx||i.getContext("2d"),o=(h=t)=>{r&&this.render(r,h,e)},a=()=>{const{width:h,height:g}=this._modules.camera.getSize(),f=mi();i.width=h*f,i.height=g*f,i.style.width=`${h}px`,i.style.height=`${g}px`,o()};let l,u;if(e.isStatic)this._modules.events.on("resize",a),l=()=>this._modules.events.off(a);else{let h=this._modules.camera.getCenter(),g=this._modules.camera.getZoom(),f=!1;const m=0;let y;const p=500,x=()=>{f||(o(),f=!0,h=this._modules.camera.getCenter(),g=this._modules.camera.getZoom())},v=()=>{f||x();const{x:A,y:w}=this._modules.camera.getCenter(),L=A-h.x,k=w-h.y,F=-L*g,O=-k*g,j=this._modules.camera.getZoom()/g,V=-this._modules.camera.getAngle();i.style.transform=`
          scale(${j})
          rotate(${-V}rad)
          translateX(${F}px)
          translateY(${O}px)
          rotate(${V}rad)
        `.replace(/\n/g,"")};u=()=>!f||(o(),f=!1,i.style.transform="scale(1) translateX(0px) translateY(0px)",!1);const b=A=>{y&&clearTimeout(y),x()},S=A=>{Date.now()<m&&y&&clearTimeout(y),y=setTimeout(u,A.duration+p),x()};this._modules.events.on("dragStart",b).on("zoomStart",S).on("dragEnd",u).on(["viewChanged","zoom","rotate","move","animate"],v),this._modules.dom.addDirectWindowEventListener("resize",u),this._modules.events.on("resize",a),l=()=>{this._modules.events.off(a).off(b).off(S).off(u).off(v),this._modules.dom.removeDirectWindowEventListener("resize",u)}}return i.style.touchAction="none",i.style.pointerEvents="none",a(),{element:i,removeListeners:l,refresh:h=>{u&&!u()||o(h)},clear:()=>r==null?void 0:r.clearRect(0,0,i.width,i.height)}},this.createSVG=t=>{const{element:e}=t;e.style["pointer-events"]="none";const s=()=>{t.draw(t.element)},n=i=>{let{zoom:r,x:o,y:a,width:l,height:u}=i||this._modules.camera.getView();if(l=Math.floor(l),u=Math.floor(u),r===void 0||o===void 0||a===void 0||l===void 0||u===void 0)return null;const h=l/2/r,g=u/2/r,f=Math.cos(-this._modules.camera.getAngle()),m=Math.sin(-this._modules.camera.getAngle()),y=f*o-m*a-h,p=m*o+f*a-g,x=l/r,v=u/r;e.style.width=`${l}px`,e.style.height=`${u}px`,e.setAttribute("width",`${l}`),e.setAttribute("height",`${u}`),e.setAttribute("viewBox",`${y} ${p} ${x} ${v}`)};return this._modules.events.on(["viewChanged","zoom","rotate","move","animate","afterImageExport"],(()=>n())),e.addEventListener("mousemove",U1),n(),s(),{element:e,removeListeners:()=>{this._modules.events.off(n)},updateTransformation:n,refresh:s}},this._createOverlay=t=>{const e=()=>{const{element:i,position:r}=t,{zoom:o,x:a,y:l,width:u,height:h}=this._modules.camera.getView();if(o===void 0||a===void 0||l===void 0||u===void 0||h===void 0)return null;const g=o,f=u/2,m=h/2,y=-this._modules.camera.getAngle(),p=(r.x-a)*g,x=(r.y-l)*g;i.style.transformOrigin="top left",i.style.transform=`translate(${f}px, ${m}px) rotate(${y}rad) translate(${p}px, ${x}px) ${t.scaled?`scale(${g}, ${g})`:""}`};this._modules.events.on(["viewChanged","zoom","rotate","move","animate","afterImageExport"],e);const{element:s,size:n}=t;return n&&(s.style.width=`${n.width}`,s.style.height=`${n.height}`),s.addEventListener("mousemove",U1),e(),{element:s,removeListeners:()=>{this._modules.events.off(e)},updateTransformation:e}},this.addLayer=(t,e="layer",s=this._elements.length)=>{const n=typeof t=="string"?W_(t):t;this._elements.push(n);const i={element:n};return i.type=e,i.getLevel=()=>this._elements.indexOf(n),i.moveTo=r=>(this._elements.splice(r,0,this._elements.splice(i.getLevel(),1)[0]),this._updateDom(this._elements),i),i.moveUp=()=>i.moveTo(i.getLevel()+1),i.moveDown=()=>i.moveTo(i.getLevel()-1),i.moveToTop=()=>i.moveTo(this._elements.length-1),i.moveToBottom=()=>i.moveTo(0),i.destroy=()=>this._removeLayer(i),i.hide=()=>(i.element&&(i.element.style.visibility="hidden"),i),i.show=()=>(i.element&&(i.element.style.visibility="visible"),i),i.isHidden=()=>i.element.style.visibility==="hidden",i.setOpacity=r=>(i.element&&(i.element.style.opacity=r.toString()),i),i.getOpacity=()=>parseFloat(i.element.style.opacity||"1"),i.setPosition=r=>{if(i.element){const o=i.element.style;o.left=`${r.x}px`,o.top=`${r.y}px`}return i},i.setSize=r=>{if(i.element&&r){const{width:o,height:a}=r,l=i.element.style;l.width=`${o}px`,l.height=`${a}px`}return i},i.moveTo(s),this._layers.push(i),i},this.addCanvasLayer=(t,e={isStatic:!1,noClear:!1},s=this._elements.length)=>{const n=this.createCanvas(t,e),{element:i,removeListeners:r,refresh:o,clear:a}=n,l=this.addLayer(i,"canvas",s);return i.classList.add("ogma-canvas-layer"),l.destroy=()=>this._removeLayer(l,r),l.refresh=o,l.clear=a,l.draw=t,l.options=e,l},this.addOverlay=(t,e=this._elements.length)=>{typeof t.element=="string"&&(t.element=W_(t.element)),t.scaled=t.scaled===void 0||t.scaled;const s=this._createOverlay(t),{element:n,removeListeners:i,updateTransformation:r}=s,o=this.addLayer(n,"overlay",e);return o._onViewChange=r,o._onDestroy=i,o.destroy=()=>this._removeLayer(o,i),o.setPosition=a=>(t.position=a,r(),o),t.size&&o.setSize(t.size),o},this.addSVGLayer=(t,e=this._elements.length)=>{const s=this.createSVG(t),{element:n,refresh:i,removeListeners:r,updateTransformation:o}=s,a=this.addLayer(n,"svg",e);return a._onViewChange=o,a._onDestroy=r,a.destroy=()=>this._removeLayer(a,r),a.refresh=i,a}}canvasToImage(t,e){const s=document.createElement("canvas");s.width=e.width,s.height=e.height;const n=s.getContext("2d");this.render(n,t.draw,{...t.options,noClear:!0},{...e,pixelRatio:1});const i=ys("image");return i.setAttribute("href",s.toDataURL("image/png")),i.setAttribute("width",s.width),i.setAttribute("height",s.height),i}exportPNG(t,e,s){const n=t.getContext("2d");let i=Promise.resolve();return e.forEach((r=>{i=i.then((()=>{var o;if(r.type!=="canvas")return(o=r._onViewChange)==null||o.call(r,s),FV(r.element,n);this.render(n,r.draw,{...r.options,noClear:!0},s)}))})),i}exportSVG(t,e,s,n){let i=Promise.resolve();return e.forEach((r=>{i=i.then((()=>{var o;return r.type==="canvas"?this.canvasToImage(r,s):((o=r._onViewChange)==null||o.call(r,s),r.element.cloneNode(!0))})).then((o=>n?t.insertBefore(o,t.querySelector(".ogma-nodes").parentNode||t.firstChild):t.appendChild(o)))})),i}export(t){const e=this._layers.sort(((i,r)=>i.getLevel()-r.getLevel())).filter((i=>i.type==="canvas"||i.type==="svg")),s=this.ogmaLayer?this.ogmaLayer.getLevel():0,n=t.below?e.filter((i=>i.getLevel()<s)):e.filter((i=>i.getLevel()>s));return t.canvas?this.exportPNG(t.canvas,n,t.view):this.exportSVG(t.svg,n,t.view,t.below)}onMounted(){const t=this._modules.graphics.getDomElement();this._updateDom=RV(t);const e=t.firstChild;e&&(this.ogmaLayer=this.addLayer(e)),this.runCallbacks()}runCallbacks(){this.ogmaLayer&&(this.readyCallbacks.forEach((t=>t())),this.readyCallbacks=[])}whenReady(t){this.readyCallbacks.push(t),this.ogmaLayer&&this.runCallbacks()}_removeLayer(t,e){return t.element&&t.element.parentNode&&(this._elements.splice(t.getLevel(),1),e&&e(),t.element=null,this._updateDom(this._elements)),this._layers=this._layers.filter((s=>s!==t)),t}destroy(){this._elements=[]}},zV=class extends Ke{onMounted(){const t=this._modules.graph;this._nodeList=t.getNodeAttribute("object"),this._edgeList=t.getEdgeAttribute("object"),this._sourceList=t.getEdgeAttribute("source"),this._targetList=t.getEdgeAttribute("target"),this._excludedList=t.getEdgeAttribute("excluded"),this._virtualList=t.getEdgeAttribute("virtual")}shortestPath(t={source:void 0,target:void 0}){const{source:e,target:s,directed:n=!1,edges:i=this._ogma.getEdges(),nodes:r=this._ogma.getNodes(),edgeCostFunction:o=(()=>1),heuristicFunction:a=(()=>0)}=t,l=i.reduce(((p,x)=>(p[x._index]=!0,p)),{}),u=r.reduce(((p,x)=>(p[x._index]=!0,p)),{}),h=this._modules.graph.getNode(e),g=this._modules.graph.getNode(s);if(!h)throw new Error("the source is not a node");if(!g)throw new Error("the target is not a node");const f=h._index,m=g._index;u[f]=!0,u[m]=!0;let y=null;if(f===m)y={nodes:h.toList(),edges:this._modules.graph.edgeList()};else{const p=this._modules.graph.getNodeMaxIndex()+1,x=new Int32Array(p),v=new Float32Array(p),b=new Float32Array(p),S=new Set,A=new d2(b);for(v.fill(1/0),b.fill(1/0),x.fill(-1),A.add(f),v[f]=0,b[f]=a(h,g);!A.isEmpty();){const w=A.removeMin();if(w===m){y=this._constructPath(x,f,m);break}S.add(w);const L=this._modules.graph.getAdjacentDirections(w);if(L)for(let k=0;k<L.length;++k){const F=L[k],O=this._modules.graph.getEdgeIndexesInDirection(F);let j=-1,V=0,Z=-1;for(let at=0;at<O.length;++at){const mt=O[at],K=this._sourceList.get(mt),ut=this._targetList.get(mt);if(K===ut||!u[K]||!u[ut]||n&&w!==K||!l[mt])continue;const ht=o(this._edgeList.get(mt));(j===-1||ht<V)&&(j=mt,V=ht,Z=K===w?ut:K)}if(Z!==-1||S.has(Z)){const at=v[w]+V;if(!A.has(Z)||at<v[Z]){const mt=this._nodeList.get(w);x[Z]=j,v[Z]=at,b[Z]=at+a(mt,g),A.add(Z)}}}}}return Promise.resolve(y)}_constructPath(t,e,s){const n=[s],i=[];let r=s;for(;r!==e;){const o=t[r],a=this._sourceList.get(o),l=this._targetList.get(o);r=r===a?l:a,n.push(r),i.push(o)}return n.reverse(),i.reverse(),{nodes:this._modules.graph.nodeList(new Uint32Array(n)),edges:this._modules.graph.edgeList(new Uint32Array(i))}}detectCycle(t,e){const s=e.getSource(),n=e.getTarget(),i=r2(t._indexes,s._indexes,n._indexes);return i?this._modules.graph.nodeList(new Uint32Array(i)).dedupe():this._modules.graph.nodeList()}getAllSimpleCycles(t,e){const s=e.getSource(),n=e.getTarget();return new a2(t._indexes,s._indexes,n._indexes).getCycles().map((i=>this._modules.graph.nodeList(new Uint32Array(i))))}minimumSpanningTree(t,e,s){const n=this._modules.graph;t=n.getNodes(t),e=n.getEdges(e);const i=new Set;t.forEach((l=>i.add(l._index)));const r=n.getConnectedComponents(t,{filter:l=>i.has(l),internalIndexes:!0}),o={};r.forEach(((l,u)=>l.forEach((h=>o[h]=u))));const a=[];return e.forEach((l=>{const u=o[l.getSource()._index];u!==void 0&&(a[u]===void 0&&(a[u]=[]),a[u].push(l._index))})),r.map(((l,u)=>{const h=l2(l,a[u]||[],(g=>n.edge(g).getSource()._index),(g=>n.edge(g).getTarget()._index),s?g=>s(n.edge(g)):void 0);return{nodes:n.nodeList(new Uint32Array(l)),edges:n.edgeList(new Uint32Array(h))}}))}bfs({root:t,onNode:e,onEdge:s=os,directed:n=!1}){const i=this._modules.graph,r=[t],o=new Set,a={direction:n?"out":"both"};for(;r.length;){const l=r.pop();if(!o.has(l._index)){if(e(l)===!0)return;o.add(l._index),i.getAdjacentEdges(l,a).forEach((u=>{if(s(u)===!1)return;const h=u.getSource()===l?u.getTarget():u.getSource();r.unshift(h)}))}}}dfs({root:t,onNode:e,onEdge:s=os,directed:n=!1}){const i=this._modules.graph,r=[t],o=new Set,a={direction:n?"out":"both"};for(;r.length;){const l=r.pop();if(!o.has(l._index)){if(e(l)===!0)return;o.add(l._index),i.getAdjacentEdges(l,a).forEach((u=>{if(s(u)===!1)return;const h=u.getSource()===l?u.getTarget():u.getSource();r.push(h)}))}}}betweenness({nodes:t,edges:e,directed:s,normalized:n}){const i=this._ogma.getNodes().subtract(t),r=this._ogma.getEdges().subtract(e).concat(i.fastGetAdjacentElements().edges).dedupe();return u2({adjacency:t.map((o=>{const a=this._ogma.edgeList(this._ogma.modules.graph.topology.getAdjacentElements(!1,o.toList()._indexes,{direction:s?"out":"both"})).subtract(r).dedupe();return{id:o._index,adj:a.map((l=>l.getSource()._index===o._index?l.getTarget()._index:l.getSource()._index))}})),directed:s,normalized:n})}fishEyeExpand(t,e,s,n){return s2(t,e,s,n)}},G1=(t,e)=>{if(!t)throw new Error("Traversal options are required");if(typeof t.onNode!="function")throw new Error("onNode callback is required");if(t.root=e.getNode(t.root),!t.root)throw new Error(`Root node '${t.root}' does not exist`);return t},_g=()=>({nodes:void 0,edges:void 0}),DV=class extends Rs{constructor(){super(...arguments),this.shortestPath=t=>this._ogma.modules.algorithms.shortestPath(t),this.hasCycle=t=>{const{nodes:e,edges:s}=t||_g();return this.detectCycle({nodes:e,edges:s})!==null},this.getAllSimpleCycles=t=>{let{nodes:e,edges:s}=t||_g();return e||(e=this._ogma.getNodes()),s||(s=e.getAdjacentEdges({bothExtremities:!0})),this._ogma.modules.algorithms.getAllSimpleCycles(e,s)},this.detectCycle=t=>{let{nodes:e,edges:s}=t||_g();e||(e=this._ogma.getNodes()),s||(s=e.getAdjacentEdges({bothExtremities:!0}));const n=this._ogma.modules.algorithms.detectCycle(e,s);return n.size?n:null},this.minimumSpanningTree=t=>{const{nodes:e,edges:s,edgeCostFunction:n}=t||{..._g(),edgeCostFunction:void 0};return this._ogma.modules.algorithms.minimumSpanningTree(e,s,n)},this.dfs=t=>this._ogma.modules.algorithms.dfs(G1(t,this._ogma.modules.graph)),this.bfs=t=>this._ogma.modules.algorithms.bfs(G1(t,this._ogma.modules.graph)),this.betweenness=(t={})=>(t={nodes:t.nodes||this._ogma.getNodes(),edges:t.edges||this._ogma.getEdges(),directed:t.directed!==void 0&&t.directed,normalized:t.normalized===void 0||t.normalized},this._ogma.modules.algorithms.betweenness(t)),this.getMinimumEnclosingCircle=t=>{if(!t||t.size===0)throw new Error("getMinimumEnclosingCircle: no nodes provided");const e=t.getAttribute("x"),s=t.getAttribute("y"),n=t.getAttribute("radius"),[i,r,o]=_h(e,s,n);return{x:i,y:r,radius:o}},this.circlePack=({nodes:t,margin:e=0,origin:s={x:0,y:0},duration:n=0,easing:i="linear",sort:r,dryRun:o})=>{if(!t||t.size===0)throw new Error("circlePack: no nodes provided");let a=t.map(((u,h)=>({index:h,radius:+u.getAttribute("radius")+e,id:u.getId()})));if(r)if(r==="asc")a=a.sort(((u,h)=>h.radius-u.radius));else if(r==="desc")a=a.sort(((u,h)=>u.radius-h.radius));else{if(typeof r!="function")throw new Error("circlePack: invalid sort option");a=a.sort(((u,h)=>r(t.get(u.index),t.get(h.index))))}if(s&&(!isFinite(s.x)||!isFinite(s.y)))throw new Error("circlePack: invalid origin");const l=e2(a,s.x,s.y).reduce(((u,{index:h,x:g,y:f})=>(u[h]={x:g,y:f},u)),new Array(t.size));return o?l:t.setAttributes(l,{duration:n,easing:i}).then((()=>l))},this.fishEyeExpand=({nodes:t,focusNode:e,deltaRadius:s,duration:n=0,dryRun:i=!1,easing:r="linear",xyr:o})=>{if(!t||t.size===0)throw new Error("Expand/collapse: no nodes provided");if(!(e instanceof ji))throw new Error("Expand/collapse: no focus node provided");if(!isFinite(s))throw new Error("Expand/collapse: invalid delta radius");const a=this._ogma.modules.algorithms.fishEyeExpand(t,e,s,o);return i?a:t.setAttributes(a,{duration:n,easing:r}).then((()=>a))}}},OV=class{getHoveredElement(){return this.modules.captor.getPointedElement()}getPointerInformation(){return this.modules.captor.getCursorInformation()}},BV=class{getNodesByClassName(t,e){return this.modules.classes.getClassByName(t,!0).getNodes(e)}getEdgesByClassName(t,e){return this.modules.classes.getClassByName(t,!0).getEdges(e)}},m0={};hh(m0,{gexf:()=>jN,gexfFromUrl:()=>p0,graphml:()=>YN,graphmlFromUrl:()=>WN,janus:()=>HN,json:()=>$N,jsonFromUrl:()=>_0,mtx:()=>UV,mtxFromUrl:()=>GV,neo4j:()=>qN});var jN=t=>Promise.resolve(SC(t)),p0=t=>fu(t).then((e=>SC(e))),HN=t=>Promise.resolve(GO(t)),$N=(t,e)=>Promise.resolve(pC(t,e)),_0=(t,e)=>fu(t).then((s=>pC(s,e))),qN=t=>Promise.resolve(_B(t)),YN=(t,e)=>Promise.resolve(AC(t,e)),WN=(t,e)=>fu(t).then((s=>AC(s,e))),UV=t=>Promise.resolve(wC(t)),GV=t=>fu(t).then((e=>wC(e))),VV=class extends Rs{constructor(){super(...arguments),this.wait=t=>new Promise((e=>setTimeout(e,t))),this.initRandomGraph=t=>this._ogma.generate.random(t).then(this._ogma.setGraph).then((()=>this._ogma.view.locateGraph())).then((()=>this._ogma.view.afterNextFrame())),this.initGrid=t=>{const e=Math.ceil(Math.sqrt(t));return this._ogma.generate.grid({rows:e,columns:e}).then((s=>this._ogma.setGraph(s))).then((()=>this._ogma.view.locateGraph()))},this.initLine=t=>(this._ogma.setGraph({nodes:[{id:0,attributes:{x:0,y:0}},{id:1,attributes:t?{x:0,y:50}:{x:50,y:0}}],edges:[{id:0,source:1,target:0}]}),this._ogma.view.locateGraph()),this.initSingleNode=()=>(this._ogma.setGraph({nodes:[{id:0,attributes:{x:0,y:0}}],edges:[]}),this._ogma.view.locateGraph()),this.initContinuousRenderLoop=({triggerKey:t="r",start:e=!0}={})=>{let s=e;const n=()=>{s&&this._ogma.modules.dom.beforeNextFrame().then(n)};document.addEventListener("keydown",(({key:i})=>{i===t&&(s=!s,n())})),n()},this.appendToBody=()=>{const t=document.createElement("div");t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.bottom="0",t.style.right="0",document.body.appendChild(t),this._ogma.setContainer(t)},this.loadFile=t=>(t.endsWith(".gexf")?p0(t):_0(t)).then((e=>this._ogma.setGraph(e))).then((()=>this._ogma.view.locateGraph())).then((()=>this._ogma.view.afterNextFrame())),this.enableLasso=t=>{this._ogma.events.on("dragStart",(()=>{this._ogma.keyboard.isKeyPressed("ctrl")&&this._ogma.tools.lasso.enable(t)}))},this.randomizeGraph=({minX:t=0,minY:e=0,maxX:s=500,maxY:n=500}={})=>this._ogma.getNodes().setAttributes(this._ogma.getNodes().map((()=>({x:t+Math.random()*(s-t),y:e+Math.random()*(n-e)}))))}},jV=class{setContainer(t){this.modules.dom.setContainer(t)}getContainer(){return this.modules.dom.getContainer()}},HV=class extends Rs{constructor(){super(...arguments),this.once=(t,e)=>(this._ogma.modules.events.once(t,e),this),this.removeListener=t=>{this._ogma.modules.events.off(t)},this.onNodesAdded=t=>(this._ogma.events.on("addNodes",t),this._ogma),this.onBeforeNodesRemoved=t=>(this._ogma.events.on("beforeRemoveNodes",t),this._ogma),this.onNodesRemoved=t=>(this._ogma.events.on("removeNodes",t),this._ogma),this.onEdgesAdded=t=>(this._ogma.events.on("addEdges",t),this._ogma),this.onBeforeEdgesRemoved=t=>(this._ogma.events.on("beforeRemoveEdges",t),this._ogma),this.onEdgesRemoved=t=>(this._ogma.events.on("removeEdges",t),this._ogma),this.onGraphCleared=t=>(this._ogma.events.on("clearGraph",t),this._ogma),this.onNodesClassAdded=(t,e)=>(this._ogma.modules.classes.onNodeClassAdded(t,e),this._ogma),this.onNodesClassRemoved=(t,e)=>(this._ogma.modules.classes.onNodeClassRemoved(t,e),this._ogma),this.onEdgesClassAdded=(t,e)=>(this._ogma.modules.classes.onEdgeClassAdded(t,e),this._ogma),this.onEdgesClassRemoved=(t,e)=>(this._ogma.modules.classes.onEdgeClassRemoved(t,e),this._ogma),this.onNodeDragStart=t=>(this._ogma.events.on("nodesDragStart",t),this._ogma),this.onNodeDragProgress=t=>(this._ogma.events.on("nodesDragProgress",t),this._ogma),this.onNodeDragEnd=t=>(this._ogma.events.on("nodesDragEnd",t),this._ogma),this.onDrop=t=>(this._ogma.events.on("drop",t),this._ogma),this.onNodesSelected=t=>this.onNodesClassAdded(Gs,t),this.onNodesUnselected=t=>this.onNodesClassRemoved(Gs,t),this.onEdgesSelected=t=>this.onEdgesClassAdded(Gs,t),this.onEdgesUnselected=t=>this.onEdgesClassRemoved(Gs,t),this.onNodeDataChange=t=>(this._ogma.events.on("updateNodeData",t),this._ogma),this.onEdgeDataChange=t=>(this._ogma.events.on("updateEdgeData",t),this._ogma),this.onAnimate=t=>(this._ogma.events.on("animate",t),this._ogma),this.onMouseMove=t=>(this._ogma.events.on("mousemove",t),this._ogma),this.onMouseButtonDown=t=>(this._ogma.events.on("mousedown",t),this._ogma),this.onMouseButtonUp=t=>(this._ogma.events.on("mouseup",t),this._ogma),this.onClick=t=>(this._ogma.events.on("click",t),this._ogma),this.onDoubleClick=t=>(this._ogma.events.on("doubleclick",t),this._ogma),this.onMouseWheel=t=>(this._ogma.events.on("mousewheel",t),this._ogma),this.onHover=t=>(this._ogma.events.on("mouseover",t),this._ogma),this.onUnhover=t=>(this._ogma.events.on("mouseout",t),this._ogma),this.onDragStart=t=>(this._ogma.events.on("dragStart",t),this._ogma),this.onDragProgress=t=>(this._ogma.events.on("dragProgress",t),this._ogma),this.onDragEnd=t=>(this._ogma.events.on("dragEnd",t),this._ogma),this.onGestureStart=t=>(this._ogma.events.on("gestureStart",t),this._ogma),this.onGestureProgress=t=>(this._ogma.events.on("gestureProgress",t),this._ogma),this.onGestureEnd=t=>(this._ogma.events.on("gestureEnd",t),this._ogma),this.onRendererStateChange=t=>(this._ogma.events.on("rendererStateChange",t),this._ogma),this.onZoomProgress=t=>(this._ogma.events.on("zoom",t),this._ogma),this.onViewChanged=t=>(this._ogma.events.on("viewChanged",t),this._ogma),this.onNodesConnected=t=>(this._ogma.events.on("connectNodes",t),this._ogma),this.onGeoModeEnabled=t=>(this._ogma.events.on("geoEnabled",t),this._ogma),this.onGeoModeDisabled=t=>(this._ogma.events.on("geoDisabled",t),this._ogma),this.onGeoModeLoaded=t=>(this._ogma.events.on("geoLoaded",t),this._ogma),this.onLayoutStart=t=>(this._ogma.events.on("layoutStart",t),this._ogma),this.onLayoutComplete=t=>(this._ogma.events.on("layoutEnd",t),this._ogma),this.onLayoutComputed=t=>(this._ogma.events.on("layoutComputed",t),this._ogma),this.onTooltipShown=t=>(this._ogma.events.on("tooltipShow",t),this._ogma),this.onTooltipHidden=t=>(this._ogma.events.on("tooltipHide",t),this._ogma),this.onTransformationEnabled=t=>(this._ogma.events.on("transformationEnabled",t),this._ogma),this.onTransformationDisabled=t=>(this._ogma.events.on("transformationDisabled",t),this._ogma),this.onTransformationSetIndex=t=>(this._ogma.events.on("transformationSetIndex",t),this._ogma),this.onTransformationDestroyed=t=>(this._ogma.modules.events.on("transformationDestroyed",t),this._ogma),this.onTransformationRefreshed=t=>(this._ogma.events.on("transformationRefresh",t),this._ogma)}on(t,e){return this._ogma.modules.events.on(t,e),this}off(t){return this._ogma.modules.events.off(t),this}onKeyPress(t,e){return this._ogma.modules.keyboard.onKeyPress(t,e),this._ogma}};function vf(t,e,s){if(t!=null)return Array.isArray(t)?t[0]:t}function Oy(t){return t==null?null:typeof t=="string"||typeof t=="number"?`${t}`:t&&Oy(t.content)}function $V(t){if(t!=null)return typeof t=="string"?t:t.style||"line"}var qV=["color","radius","shape","text.content","x","y"],YV=["color","width","shape.body","text.content"];function WV(t){return t!=="all"?{nodes:["x","y"],edges:[]}:{nodes:qV,edges:YV}}function XV(t,{nodes:e,edges:s}){const n=t.getOriginalAttributes();return{nodes:e.reduce(((i,r)=>(i[r.getId()]={x:n.nodes.x.get(r._index),y:n.nodes.y.get(r._index),color:vf(n.nodes.color.get(r._index)),radius:n.nodes.radius.get(r._index),shape:n.nodes.shape.get(r._index),text:{content:n.nodes.text.content.get(r._index)}},i)),{}),edges:s.reduce(((i,r)=>(i[r.getId()]={color:vf(n.edges.color.get(r._index)),width:n.edges.width.get(r._index),shape:{type:n.edges.shape.body.get(r._index)},text:{content:n.edges.text&&n.edges.text.content&&n.edges.text.content.get(r._index)}},i)),{})}}function ZV(t){return{nodes:t.nodes.map((({id:e,attributes:s={},data:n})=>{const{color:i,radius:r,shape:o,text:a,x:l,y:u}=s;return{id:e,x:l,y:u,color:vf(i),size:r,shape:o,text:Oy(a),data:n}})),edges:t.edges.map((({id:e,source:s,target:n,attributes:i={},data:r})=>{const{color:o,width:a,text:l,shape:u}=i;return{id:e,source:s,target:n,color:vf(o),size:a,shape:$V(u),text:Oy(l),data:r}}))}}function V1(t){return t instanceof ji?t.getId():t}function j1(t){return t instanceof so?t.getId():t}function H1(t){return t instanceof io?t.getId():t instanceof ji?[t.getId()]:Rn(t)?t.map(V1):[V1(t)]}function $1(t){return t instanceof Va?t.getId():t instanceof so?[t.getId()]:Rn(t)?t.map(j1):[j1(t)]}var y0="visible";function KV(t,e){return t?H1(t):typeof e=="object"?H1(e.nodes):e||y0}function QV(t,e){return t?$1(t):typeof e=="object"?$1(e.edges):e||y0}function XN(t,e,s,n){const i=KV(e,n),r=QV(s,n);return{nodes:t.getNodes(i),edges:t.getEdges(r)}}function ZN(t,{nodeAttributes:e,edgeAttributes:s,nodes:n,edges:i,filter:r,nodeData:o,edgeData:a}){const l=XN(t,n,i,r);return{nodes:l.nodes.toJSON({attributes:e,data:o}),edges:l.edges.toJSON({attributes:s,data:a})}}function Jf(t,e,{styles:s,nodes:n,edges:i,filter:r,nodeData:o,edgeData:a}){const{nodes:l,edges:u}=WV(s),h=ZN(t,{nodeAttributes:l,edgeAttributes:u,nodes:n,edges:i,filter:r,nodeData:o,edgeData:a});if(s==="original"){const g=XV(e,XN(t,n,i,r));for(const f of h.nodes)f.id!=null&&(f.attributes=g[f.id]);for(const f of h.edges)f.id!=null&&(f.attributes=g[f.id])}return s==="all"&&h.edges.forEach((({source:g,target:f,attributes:m})=>{if(m){const y=t.getNode(g);if(m.color==="source"&&y){const x=y.getAttribute("color");m.color=Array.isArray(x)?x[0]:x}const p=t.getNode(f);if(m.color==="target"&&p){const x=p.getAttribute("color");m.color=Array.isArray(x)?x[0]:x}}})),ZV(h)}function JV(t,e){for(let s=0;s<e.length;++s){if(t==null)return;t=t[e[s]]}return t}function tj(t,e,s){for(let n=0;n<e.length-1;++n){const i=e[n];let r=t[i];r===void 0&&(r={},t[i]=r),t=r}t[e[e.length-1]]=s}function ej(t){const e={...t[0]};for(const s of t)for(const n of Object.keys(s))n in e||(e[n]=void 0);return Object.keys(e)}function q1(t,e){return t==null||Array.isArray(t)&&!t.length?e:t}function sj(t){return typeof t=="string"}function nj(t,e,s,n,i){const r=e==="edges",o={};return t.forEach(((a,l)=>{const u=i.get(l),h=F_(q1(s(u),e));if(!h.every(sj))throw Error(`The tab ${e} function returned an invalid value.`);const g=F_(n(a.data,h));h.forEach(((f,m)=>{const y=q1(g[m],{}),p=Kf({internal___id:a.id,...r?{internal___source:a.source,internal___target:a.target}:{},...y}).reduce(((x,{path:v,value:b})=>(x[v.join(".")]=b,x)),{});o[f]=o[f]||[],o[f].push(p)}))})),o}function ij(t){if(!t.length)return[];const e=ej(t),s=[e];for(const n of t)s.push(e.map((i=>n[i])));return s[0]=s[0].map((n=>n.replace("internal___",""))),s}function rj(t,e,s){const n=new pL;let i=e?1:3;const r=[];for(let a=0;a<t.length;++a){const l=t[a],u=new Array(i);let h=l.data;if(s){const f={};s.forEach((m=>{const y=Da(m),p=JV(h,y);tj(f,y,p)})),h=f}const g=Kf(h);u[0]=l.id,e||(u[1]=l.source,u[2]=l.target);for(let f=0;f<g.length;++f){const{path:m,value:y}=g[f];m.length&&(n.has(m)?u[n.get(m)]=y:(n.set(m,i),u[i]=y,i++))}r.push(u)}const o=[];return o.push("id"),e||(o.push("source"),o.push("target")),n.keys().forEach((a=>o.push(a[a.length-1]))),r.unshift(o),r.forEach((a=>a.length=i)),r}var oj=/[=+\-@|%]/,aj=t=>t.length>0&&oj.test(t[0])?!isNaN(Number(t))&&isFinite(Number(t))?`${t}`:`'${t=t.replace("|","|")}`:t;function KN(t){return t===void 0?"":t instanceof Date?t.toISOString():aj(""+t)}var lj={what:void 0,dataProperties:void 0,separator:",",textSeparator:'"',download:!0,filename:"graph.csv",filter:"visible",nodes:void 0,edges:void 0,nodeData:lr,edgeData:lr,styles:"none"};function uj(t,e){const{what:s,dataProperties:n,nodes:i,edges:r,separator:o,textSeparator:a,download:l,nodeData:u,edgeData:h,filename:g,filter:f}=Ci(typeof e=="string"?{what:e}:e,lj),m=Jf(t.modules.graph,t.modules.individualAttributes,{styles:"none",nodes:i,edges:r,filter:f,nodeData:u,edgeData:h});try{const y=dj(m,{what:s,separator:o,textSeparator:a,dataProperties:n});return l&&Xo(y,g,"text","text/csv"),Promise.resolve(y)}catch(y){return Promise.reject(y)}}function dj(t,{what:e,separator:s,textSeparator:n,dataProperties:i}){const r=new RegExp(n,"g");if(n&&n!=='"'&&n!=="'")throw new TypeError(`Invalid argument :"textSeparator" is not single-quote or double-quote, was ${n}`);if(e!=="nodes"&&e!=="edges")throw new TypeError('missing argument: "what": should have value "nodes" or "edges"');const o=e==="nodes";return rj(o?t.nodes:t.edges,o,i).map((a=>a.map((l=>(function(h){return n+KN(h).replace(r,`${n}${n}`).replace(/\n/g,"\\n").replace(/\r/g,"")+n})(l))))).map((a=>a.join(s))).join(`
`)}var Nl=t=>Math.round(255*t);function Y1(t,e){if(e==="integer"&&typeof t=="number"){if(t%1!=0)return"float"}else if(typeof t!="number")return typeof t=="boolean"?"boolean":"string";return e}var By=t=>typeof t=="object"&&t!==null&&t.constructor===Object;function Uy(t,e={}){return Cr(t,((s,n)=>{By(s)?Uy(s,e):e[n]=s})),e}var hj={creator:void 0,description:void 0,styles:"all",download:!0,filename:"graph.gexf",nodes:void 0,edges:void 0,nodeData:t=>t,edgeData:t=>t,filter:"visible"};function cj(t,e={}){const{styles:s,nodes:n,edges:i,download:r,filename:o,creator:a,description:l,filter:u,nodeData:h,edgeData:g}=Ci(e,hj),f=gj(Jf(t.modules.graph,t.modules.individualAttributes,{styles:s,nodes:n,edges:i,filter:u,nodeData:h,edgeData:g}),{creator:a,description:l});return r&&Xo(f,o,"text","text/xml"),Promise.resolve(f)}function gj(t,e){const s=SL(),n={},i={};let r,o=0,a=0;const l=s.createElement("gexf");l.setAttribute("xmlns","http://www.gexf.net/1.2draft"),l.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz"),l.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),l.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd"),l.setAttribute("version","1.2");const u=s.createElement("meta");if(u.setAttribute("lastmodifieddate",Zw()),e.creator){const p=s.createElement("creator");r=s.createTextNode(""+e.creator),p.appendChild(r),u.appendChild(p)}if(e.description){const p=s.createElement("description");r=s.createTextNode(""+e.description),p.appendChild(r),u.appendChild(p)}const h=s.createElement("graph");h.setAttribute("mode","static");const g=s.createElement("nodes");t.nodes.forEach((p=>{const x=s.createElement("node");if(x.setAttribute("id",String(p.id)),p.text&&x.setAttribute("label",Bl(p.text)),By(p.data)){const b=Uy(p.data),S=s.createElement("attvalues");Object.keys(b).forEach((A=>{A in n||(n[A]={id:o,type:"integer"},o++);const w=b[A];n[A].type=Y1(w,n[A].type);const L=s.createElement("attvalue");L.setAttribute("for",n[A].id),L.setAttribute("value",Bl(w)),S.appendChild(L)})),x.appendChild(S)}if(p.color){const b=Yn(p.color);if(b){const S=s.createElement("viz:color");S.setAttribute("r",Nl(b[0])),S.setAttribute("g",Nl(b[1])),S.setAttribute("b",Nl(b[2])),S.setAttribute("a",b[3]),x.appendChild(S)}}const v=s.createElement("viz:position");if(v.setAttribute("x",p.x),v.setAttribute("y",-p.y),x.appendChild(v),p.size){const b=s.createElement("viz:size");b.setAttribute("value",p.size),x.appendChild(b)}g.appendChild(x)}));const f=s.createElement("attributes");f.setAttribute("class","node"),Object.keys(n).forEach((p=>{const x=s.createElement("attribute");x.setAttribute("id",n[p].id),x.setAttribute("title",p),x.setAttribute("type",n[p].type),f.appendChild(x)}));const m=s.createElement("edges");t.edges.forEach((p=>{const x=s.createElement("edge");if(x.setAttribute("id",p.id.toString()),x.setAttribute("source",p.source),x.setAttribute("target",p.target),p.size&&x.setAttribute("weight",p.size),p.text&&x.setAttribute("label",Bl(p.text)),By(p.data)){const v=Uy(p.data),b=s.createElement("attvalues");Object.keys(v).forEach((S=>{S in i||(i[S]={id:a,type:"integer"},a++);const A=v[S];i[S].type=Y1(A,i[S].type);const w=s.createElement("attvalue");w.setAttribute("for",i[S].id),w.setAttribute("value",Bl(A)),b.appendChild(w)})),x.appendChild(b)}if(p.color){const v=Yn(p.color);if(v){const b=s.createElement("viz:color");b.setAttribute("r",Nl(v[0])),b.setAttribute("g",Nl(v[1])),b.setAttribute("b",Nl(v[2])),b.setAttribute("a",v[3]),x.appendChild(b)}}if(p.size){const v=s.createElement("viz:size");v.setAttribute("value",p.size),x.appendChild(v)}m.appendChild(x)}));const y=s.createElement("attributes");return y.setAttribute("class","edge"),Object.keys(i).forEach((p=>{const x=s.createElement("attribute");x.setAttribute("id",i[p].id),x.setAttribute("title",p),x.setAttribute("type",i[p].type),y.appendChild(x)})),h.appendChild(f),h.appendChild(y),h.appendChild(g),h.appendChild(m),l.appendChild(u),l.appendChild(h),s.appendChild(l),`<?xml version="1.0" encoding="UTF-8"?>${s.serialize()}`}var fj={graphId:"G",directedEdges:!0,styles:"all",download:!0,filename:"graph.graphml",nodes:void 0,edges:void 0,nodeData:t=>t,edgeData:t=>t,filter:"visible"};function mj(t,e){const{styles:s,nodes:n,edges:i,download:r,filename:o,graphId:a,directedEdges:l,filter:u,nodeData:h,edgeData:g}=Ci(e,fj),f=pj(Jf(t.modules.graph,t.modules.individualAttributes,{styles:s,nodes:n,edges:i,filter:u,nodeData:h,edgeData:g}),{graphId:a,directedEdges:l,noStyles:s==="none"});return r&&Xo(f,o,"text","text/xml"),Promise.resolve(f)}function pj(t,e){const s=AL();function n(f,m,y,p,x){y=y||{};const v=s.createElement(m);for(const b in y){if(!Object.prototype.hasOwnProperty.call(y,b))continue;const S=y[b];S!==void 0&&v.setAttribute(b,S)}return(p!==void 0||x)&&(Object.prototype.toString.call(p)==="[object Object]"&&(p=JSON.stringify(p)),v.appendChild(s.createTextNode(p))),f.appendChild(v),v}const i=["id","source","target"],r=["size","x","y","shape","text","color"],o={size:{for:"all",type:"double"},x:{for:"node",type:"double"},y:{for:"node",type:"double"},shape:{for:"all",type:"string"},color:{for:"all",type:"string"},r:{for:"all",type:"int"},g:{for:"all",type:"int"},b:{for:"all",type:"int"},a:{for:"all",type:"double"},text:{for:"all",type:"string"}};e.noStyles&&(delete o.color,delete o.r,delete o.g,delete o.b,delete o.a,delete o.shape,r.pop());const a=[],l=[];function u(f,m){const y={id:f.id};r.forEach((p=>{let x=f[p];p==="y"&&x&&(x=-parseFloat(x)),x!==void 0&&(y[(m==="edge"?"edge_":"")+p]=x,p==="color"&&(function(b,S){const A=Yn(S);A&&(b.r=A[0],b.g=A[1],b.b=A[2])})(y,x))})),Cr(f.data||{},((p,x)=>{r.indexOf(x)===-1&&i.indexOf(x)===-1&&(o[x]?o[x].for!==m&&(o[x].for="all"):o[x]={for:m,type:"string"},y[x]=p)})),m==="edge"?(y.source=f.source,y.target=f.target,l.push(y)):a.push(y)}t.nodes.forEach((f=>u(f,"node"))),t.edges.forEach((f=>u(f,"edge")));const h=n(s,"graphml",{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml","xmlns:java":"http://www.yworks.com/xml/yfiles-common/1.0/java","xmlns:sys":"http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0","xmlns:x":"http://ww.yworks.com/xml/yfiles-common/markup/2.0"});Cr(o,((f,m)=>{f.for!=="node"&&f.for!=="all"||n(h,"key",{"attr.name":m,"attr.type":f.type,for:"node",id:m}),f.for!=="edge"&&f.for!=="all"||n(h,"key",{"attr.name":m,"attr.type":f.type,for:"edge",id:"edge_"+m})})),n(h,"key",{id:"nodegraphics",for:"node","yfiles.type":"nodegraphics","attr.type":"string"}),n(h,"key",{id:"edgegraphics",for:"edge","yfiles.type":"edgegraphics","attr.type":"string"});const g=n(h,"graph",{edgedefault:e.directedEdges||e.directedEdges===void 0?"directed":"undirected",id:e.graphId?e.graphId:"G","parse.nodes":t.nodes.length,"parse.edges":t.edges.length,"parse.order":"nodesfirst"});return a.forEach((f=>{const m=n(g,"node",{id:f.id});(function(p,x){const v=n(p,"data",{key:"nodegraphics"}),b=n(v,"y:ShapeNode");n(b,"y:Geometry",{x:x.x,y:x.y,width:x.size,height:x.size}),e.noStyles||n(b,"y:Fill",{color:hy(x.color),transparent:!1}),n(b,"y:NodeLabel",null,x.text||""),n(b,"y:Shape",{type:x.shape})})(m,f),Cr(f,((y,p)=>{i.indexOf(p)===-1&&n(m,"data",{key:p},y,!0)}))})),l.forEach((f=>{const m=n(g,"edge",{id:f.id,source:f.source,target:f.target});(function(p,x){const v=n(p,"data",{key:"edgegraphics"}),b=n(v,"y:PolyLineEdge");n(b,"y:LineStyle",{type:x.edge_type,color:e.noStyles?void 0:hy(x.edge_color),width:x.edge_size}),n(b,"y:EdgeLabel",null,x.edge_label)})(m,f),Cr(f,((y,p)=>{i.indexOf(p)===-1&&n(m,"data",{key:p},y,!0)}))})),`<?xml version="1.0" encoding="UTF-8"?>
${d0(s)}`}var _j={nodeAttributes:["x","y","color","radius","shape","text"],edgeAttributes:["color","width","text"],nodeData:lr,edgeData:lr,filter:"visible",pretty:!1,download:!0,filename:"graph.json",anonymize:!1};function yj(t,e={}){e.anonymize&&(e={nodeAttributes:"all",edgeAttributes:"all",nodeData:Yg,edgeData:Yg,filter:e.filter||"all",download:e.download,pretty:e.pretty,filename:e.filename});const{nodeAttributes:s,edgeAttributes:n,nodeData:i,edgeData:r,filter:o,pretty:a,download:l,filename:u}=Ci(e,_j),h=ZN(t.modules.graph,{nodeAttributes:s,edgeAttributes:n,filter:o,nodeData:i,edgeData:r}),g=a?JSON.stringify(h,null," "):JSON.stringify(h);return l&&Xo(g,u,"text","application/json"),Promise.resolve(h)}function xj(t,e){return t.getBoundingBox().computeForZoom(e).extend(ii.fromValues(t.getAttribute("x"),t.getAttribute("y"),t.map((s=>s.getAttribute("radius")+s.getAttribute("innerStroke.width")+s.getAttribute("outerStroke.width")))))}function vj(t,e,s){const n=e.view.graphToScreenCoordinates(s.bottomLeft()),i=e.view.graphToScreenCoordinates(s.topRight()),r=Math.abs(i.x-n.x),o=Math.abs(i.y-n.y),a=Math.min(t.width/r,t.height/o);t.width=r*a,t.height=o*a}function QN(t,e={}){const s=t.view.get(),n=typeof e.margin=="number"?e.margin:0,i={pixelRatio:e.pixelRatio||mi(),angle:0,backgroundColor:null,zoom:0,x:0,y:0,width:0,height:0,hideImages:!1,renderBackground:!0,isBufferDisplayable:qg};if(e.width&&e.height?(i.width=e.width,i.height=e.height):(i.width=s.width,i.height=s.height),e.clip)i.zoom=s.zoom,i.x=s.x,i.y=s.y;else{const r=xj(t.getNodes(e.filter),s.zoom);if(e.texts){const o=t.modules.labels.getTextsBoundingBox();o.isValid()&&r.extend(o)}e.width!=null&&isFinite(e.width)&&e.height!=null&&isFinite(e.height)||vj(i,t,r),i.width=Math.max(i.width,2*n),i.height=Math.max(i.height,2*n),i.x=r.cx,i.y=r.cy,i.zoom=Math.min((i.width-2*n)/r.width,(i.height-2*n)/r.height)}return t.modules.geo.isEnabled()?i.backgroundColor=null:e.background!==void 0&&(i.backgroundColor=e.background),i}function Gy(t,e,s,n,i=!1){const r={...s,hideImages:i,angle:s.angle||0,currentTime:$n(),isBufferDisplayable:l=>e.texts||!CC(l),bentEnable:!1,bentVertical:!1},o={};if(e.badges===!1){const l={text:null,image:null};o.badges={topLeft:l,topRight:l,bottomRight:l,bottomLeft:l}}const a=t.styles.getClass(wa);return a&&a.update({nodeAttributes:o}),t.modules.graphics.export(n,r,e.filter||y0,e)}var yg=t=>({download:!0,filter:"visible",filename:`graph.${t}`,clip:!1,margin:10,width:void 0,height:void 0,background:null,badges:!0,legend:void 0,texts:!0,preventOverlap:!0,images:!0,textWatermark:{content:"",fontFamily:"Arial",fontSize:48,fontStyle:void 0,fontColor:"red",repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageWatermark:{url:void 0,width:void 0,height:void 0,repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageCrossOrigin:void 0,layers:!0,pixelRatio:void 0}),bj={png:yg("png"),jpg:yg("jpg"),tiff:yg("tiff"),gif:yg("gif")};function Ej(t){const{canvas:e,parameters:s}=t;return s.textWatermark.content&&W1(e,s.textWatermark,Mj,Ij),s.imageWatermark.url?zT(s.imageWatermark.url).then((n=>(n&&(s.imageWatermark.content=n,W1(e,s.imageWatermark,Rj,kj)),t))):t}function Sj(t){const{ogma:e,canvas:s,parameters:n}=t,i=e.modules.legend;let r=null;return n.legend===void 0&&(r=!!i.enabled()&&i.getCurrentOptions()),n.legend===!0&&(r={}),r&&i.exportOnCanvas(s,r,t.parameters.pixelRatio),t}function Aj(t){const{canvas:e,parameters:s,view:n}=t;if(!n.renderBackground)return t;n.renderBackground=!1;const i=e.getContext("2d");return i.fillStyle=s.background,i.fillRect(0,0,e.width,e.height),t}function wj(t){const{ogma:e,view:s}=t;return e.modules.geo.isEnabled()?e.modules.geo.exportBackground(s).then((n=>{const i=s.width*s.pixelRatio,r=s.height*s.pixelRatio,o=Fn(i,r),a=o.getContext("2d");return a.drawImage(n,(i-n.width)/2,(r-n.height)/2),a.drawImage(t.canvas,0,0),t.canvas=o,t})):t}function Tj(t){const{ogma:e,view:s,canvas:n,parameters:i}=t;return i.layers?e.modules.layers.export({view:s,canvas:n,below:!0}).then((()=>t)):t}function Cj(t){const{ogma:e,view:s,canvas:n,parameters:i}=t;return i.layers?e.modules.layers.export({view:s,below:!1,canvas:n}).then((()=>t)):t}function Lj(t){const{ogma:e,parameters:s,canvas:n,view:i}=t,r=n.getContext("2d");return Gy(e,s,i,"canvas",!s.images).then((o=>{try{const a=o.getContext("2d");if(!a)throw new Error("Failed to render graph");return a.getImageData(0,0,1,1),r.drawImage(o,0,0,n.width,n.height),t}catch(a){return Uo(a),Gy(e,s,i,"canvas",!0).then((l=>(r.drawImage(l,0,0,n.width,n.height),t)))}}))}function Nj({canvas:t,parameters:e,type:s}){const n=t.toDataURL("image/"+s);return e.download&&Xo(n,e.filename,"dataURL","image/"+s),n}function xg(t,e,s){const n=Ci(e,bj[s]);n.filename.endsWith(s)||(n.filename+="."+s),n.background===null&&(n.background=t.modules.graphics.getTransparentBackgroundColor());const i=QN(t,n);n.pixelRatio=i.pixelRatio;const r=Fn(i.width*i.pixelRatio,i.height*i.pixelRatio),o={ogma:t,parameters:n,canvas:r,view:i,type:s};return Promise.resolve().then((()=>o)).then(Aj).then(wj).then(Tj).then(Lj).then(Cj).then(Ej).then(Sj).then(Nj).then((a=>(t.modules.events.fire("afterImageExport"),a)))}function Mj(t,e,s,n){t.textAlign="center",t.textBaseline="middle",t.fillText(e,s,n)}function Ij(t,e,s){return{width:t.measureText(e).width,height:s}}function kj(t,e,s,n,i){return{width:n===void 0?e.width:n,height:i===void 0?e.height:i}}function Rj(t,e,s,n,i,r){t.drawImage(e,s-i/2,n-r/2,i,r)}function W1(t,e,s,n){if(!e)return;if(typeof e!="object")e={content:e};else if(!e.content)return;const{fontFamily:i,fontSize:r,fontStyle:o,fontColor:a,repeat:l,alpha:u,space:h,content:g}=e;let f=e.angle;const m=t.getContext("2d"),y=t.width,p=t.height,x=e.x===void 0?y/2:e.x,v=e.y===void 0?p/2:e.y,b=e.height,S=e.width;f=f/180*Math.PI,$o(m,i,r,o),m.fillStyle=a,m.globalAlpha=u;const A=n(m,g,r,S,b);if(l){const w=A.width+h,L=A.height+h,k=Math.sqrt(y*y+p*p);m.save(),m.translate(0,0),m.rotate(f);for(let F=0;F<k;F+=w)for(let O=0;O<k;O+=L)s(m,g,F,O,A.width,A.height),O!==0&&s(m,g,F,-O,A.width,A.height);m.restore()}else m.save(),m.translate(x,v),m.rotate(f),s(m,g,0,0,A.width,A.height),m.restore()}var Fj={download:!0,filename:"graph.svg",width:void 0,height:void 0,background:null,texts:!0,preventOverlap:!0,groupSemantically:!0,images:!0,badges:!0,embedFonts:!1,layers:!0,clip:!1,margin:10,prefix:"ogma"};function Pj(t,e){const s=Ci(e,Fj),{background:n,filename:i,download:r,layers:o}=s,a=t.modules.graphics;n===null&&(s.background=a.getTransparentBackgroundColor());const l=QN(t,s);return Gy(t,s,l,"svg",!s.images).then((u=>(u.removeAttribute("pointer-events"),u.setAttribute("version","1.1"),u.setAttributeNS(Y_,"xmlns",bx),u.setAttributeNS(Y_,"xmlns:xlink",PT),u))).then((u=>s.groupSemantically?Dj(t,u,s):u)).then((u=>Bj(u,s))).then((u=>zj(t,l,u))).then((u=>X1(t,l,u,o,!0))).then((u=>X1(t,l,u,o,!1))).then((u=>(t.modules.events.fire("afterImageExport"),u))).then((u=>{const h=`<?xml version="1.0" encoding="utf-8"?>${d0(u)}`;return r&&Xo(h,i,"text","image/svg+xml"),h}))}function zj(t,e,s){return t.modules.geo.isEnabled()?t.modules.geo.exportBackground({...e,pixelRatio:1}).then((n=>{const i=ys("image",{width:n.width,height:n.height,x:0,y:0,href:n.toDataURL()});return s.insertBefore(i,s.children[0]),s})):Promise.resolve(s)}function X1(t,e,s,n,i=!1){return n?t.modules.layers.export({view:e,svg:s,below:i}).then((()=>s)):Promise.resolve(s)}function Dj(t,e,s){const n=e.childNodes[2],i=n.childNodes,r={},o=s.prefix;for(let m=0;m<i.length;m++){const y=i[m],p=y.getAttribute(Bi);p!=null&&(r[p]=r[p]||[],r[p].push(y))}const a=Object.keys(r),l=t.modules.graph,u=l.getNodeAttribute("id"),h=l.getEdgeAttribute("id"),g=ys("g",{class:`${o}-edges`}),f=ys("g",{class:`${o}-nodes`});for(let m=0;m<a.length;m++){const y=a[m],p=y.charAt(0)==="n",x=parseInt(y.substring(1)),v=r[y],b=Bl((p?u:h).get(x).toString()),S=ys("g");S.setAttribute(`data-${p?"node":"edge"}-id`,b),S.setAttribute("class",`${o}-${p?"node":"edge"}`);for(let A=0;A<v.length;A++){const w=v[A];S.appendChild(w),w.removeAttribute(Bi)}(p?f:g).appendChild(S)}return n.appendChild(g),n.appendChild(f),e}function Oj(t){const e=[].concat(Array.prototype.slice.call(t.getElementsByTagName("text")||[])),s=[],n={};for(let i=0;i<e.length;i++){const r=e[i].parentNode.getAttribute("font-family");if(typeof r=="string"){const o=r.split(",");for(let a=0;a<o.length;a++){const l=o[a].replace(/['"]/g,"");l===""||n[l]||(n[l]=!0,s.push(l))}}}return{list:s,map:n}}function Bj(t,e){const s=Oj(t).map;return cL().then((n=>n.filter((i=>s[i.name])))).then((n=>gL(n,!!e.embedFonts))).then((n=>{if(n.length!==0){const i=ys("style");for(let r=0;r<n.length;r++)i.appendChild(Ex(n[r]));t.childNodes[0].appendChild(i)}return t}))}var Uj={what:void 0,dataProperties:void 0,filter:"visible",nodes:void 0,edges:void 0,download:!0,filename:"graph.xlsx",tab:void 0,nodeData:void 0,edgeData:void 0};function Gj(t,e={}){typeof e=="string"&&(e={what:e});const{what:s,nodes:n,edges:i,tab:r={nodes:()=>"nodes",edges:()=>"edges"},download:o,filename:a,dataProperties:l,filter:u,nodeData:h,edgeData:g}=Ci(e,Uj);r.nodes||(r.nodes=()=>"nodes"),r.edges||(r.edges=()=>"edges");const f=Jf(t.modules.graph,t.modules.individualAttributes,{styles:"none",nodes:n,edges:i,filter:u,nodeData:y=>y,edgeData:y=>y}),m=Vj(f,{what:s,tabFunctions:r,tabContentFunctions:{nodes:h||(y=>O_(jd(y||{}),l)),edges:g||(y=>O_(jd(y||{}),l))}},{nodes:t.modules.graph.getNodes(f.nodes.map((({id:y})=>y))),edges:t.modules.graph.getEdges(f.edges.map((({id:y})=>y)))});return o&&Xo(m,a,"blob","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),Promise.resolve(m)}function Vj(t,{what:e,tabFunctions:s,tabContentFunctions:n},i){const r=Hi("XLSX")||Hi("xlsx",{throwOnError:!0});if(!r)throw Error('The xlsx exports requires the "xlsx" peer dependency to be associated');const o=new Hj;if(e){if(e!=="nodes"&&e!=="edges")throw new TypeError(`Invalid argument: "what" is not "nodes" or "edges", was ${e}`);e==="nodes"&&(t.edges=[]),e==="edges"&&(t.nodes=[])}const a={};for(const l of["nodes","edges"]){const u=nj(t[l],l,s[l],n[l],i[l]);for(const h of Object.keys(u))a[h]=[...a[h]||[],...u[h]]}for(const l of Object.keys(a))o.SheetNames.push(l),o.Sheets[l]=jj(r,ij(a[l]));return o.SheetNames.length===0&&(o.SheetNames=["nodes","edges"],o.Sheets.nodes={},o.Sheets.edges={}),$d([$j(r.write(o,{bookType:"xlsx",bookSST:!1,type:"binary"}))],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")}function jj(t,e){const s={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}};for(let i=0;i!==e.length;++i){const r=e[i];for(let o=0;o!==r.length;++o){const a=r[o];n.s.r>i&&(n.s.r=i),n.s.c>o&&(n.s.c=o),n.e.r<i&&(n.e.r=i),n.e.c<o&&(n.e.c=o);const l={v:a,t:"s"};typeof a=="number"?l.t="n":a instanceof Date?l.t="d":typeof a=="boolean"?l.t="b":l.v=KN(a),s[t.utils.encode_cell({c:o,r:i})]=l}}return n.s.c<1e7&&(s["!ref"]=t.utils.encode_range(n)),s}var Hj=class{constructor(){this.SheetNames=[],this.Sheets={}}};function $j(t){const e=new ArrayBuffer(t.length),s=new Uint8Array(e);for(let n=0;n!==t.length;++n)s[n]=255&t.charCodeAt(n);return e}var qj=class extends Rs{constructor(t){super(t),this.csv=e=>uj(this._ogma,e),this.xlsx=e=>(e&&e.dataProperties&&void 0,Gj(this._ogma,e)),this.gexf=e=>cj(this._ogma,e),this.graphml=(e={})=>mj(this._ogma,e),this.json=(e={})=>yj(this._ogma,e),this.svg=(e={})=>Pj(this._ogma,e),this.png=(e={})=>xg(this._ogma,e,"png"),this.jpg=(e={})=>xg(this._ogma,e,"jpg"),this.tiff=(e={})=>xg(this._ogma,e,"tiff"),this.gif=(e={})=>xg(this._ogma,e,"gif"),t.styles.createClass({name:wa,isBuiltin:!0})}};/**
 * Ogma Generators
 * @description Graphs Generators for Ogma
 * @version 0.0.18 (built on Wed Aug 06 2025 13:07:32 GMT+0000 (Coordinated Universal Time))
 * @author Alexander Milevski - Leo Nicolle - Sylvain Milan - Marco Liberati
 * @license (c) Linkurious 2025. All rights reserved.
 * @preserve
 */function Yj(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Z1,K1={exports:{}};function Wj(){return Z1||(Z1=1,K1.exports=(function(){return t.importState=function(s){var n=new t;return n.importState(s),n},t;function t(){return(function(s){var n=0,i=0,r=0,o=1;s.length==0&&(s=[+new Date]);var a=e();n=a(" "),i=a(" "),r=a(" ");for(var l=0;l<s.length;l++)(n-=a(s[l]))<0&&(n+=1),(i-=a(s[l]))<0&&(i+=1),(r-=a(s[l]))<0&&(r+=1);a=null;var u=function(){var h=2091639*n+23283064365386963e-26*o;return n=i,i=r,r=h-(o=0|h)};return u.next=u,u.uint32=function(){return 4294967296*u()},u.fract53=function(){return u()+11102230246251565e-32*(2097152*u()|0)},u.version="Alea 0.9",u.args=s,u.exportState=function(){return[n,i,r,o]},u.importState=function(h){n=+h[0]||0,i=+h[1]||0,r=+h[2]||0,o=+h[3]||0},u})(Array.prototype.slice.call(arguments))}function e(){var s=4022871197,n=function(i){i=i.toString();for(var r=0;r<i.length;r++){var o=.02519603282416938*(s+=i.charCodeAt(r));o-=s=o>>>0,s=(o*=s)>>>0,s+=4294967296*(o-=s)}return 23283064365386963e-26*(s>>>0)};return n.version="Mash 0.9",n}})()),K1.exports}var Xj=Wj(),Zj=Yj(Xj),Kj=Zj(42),un=()=>Kj.next(),Qj=({nodes:t=10,edges:e=10,texts:s=!1,scale:n=100}={})=>({nodes:t,edges:e,texts:s,scale:n});function Jj({nodes:t,scale:e,texts:s,edges:n}){const i=[],r=[];for(let o=0;o<t;o++)i.push({id:o,attributes:{x:un()*e,y:un()*e,text:s?`Node ${o}`:void 0}});for(let o=0;o<n;o++)r.push({id:o,source:un()*t|0,target:un()*t|0,attributes:{text:s?`Edge ${o}`:void 0}});return{nodes:i,edges:r}}var Q1=Object.freeze(Object.defineProperty({__proto__:null,configure:Qj,generate:Jj},Symbol.toStringTag,{value:"Module"})),t6=({rows:t=4,columns:e=4,columnDistance:s=20,rowDistance:n=20,xmin:i=0,ymin:r=0}={})=>({rows:t,columns:e,columnDistance:s,rowDistance:n,xmin:i,ymin:r});function e6({rows:t,columns:e,columnDistance:s,rowDistance:n,xmin:i,ymin:r}){const o={nodes:[],edges:[]};let a=0;for(let l=0;l<t;++l)for(let u=0;u<e;++u){const h=l*e+u;o.nodes.push({id:h,attributes:{x:i+u*s,y:r+l*n}}),u!==e-1&&(o.edges.push({id:a,source:h,target:l*e+u+1}),a++),l!==t-1&&(o.edges.push({id:a,source:h,target:(l+1)*e+u}),a++)}return o}var J1=Object.freeze(Object.defineProperty({__proto__:null,configure:t6,generate:e6},Symbol.toStringTag,{value:"Module"})),s6=({length:t=5,scale:e=100}={})=>({length:t,scale:e});function n6({length:t,scale:e}){const s={nodes:[],edges:[]};if(t<=0)return s;s.nodes.push({id:0,attributes:{x:un()*e,y:un()*e}});for(let n=1;n<t;++n)s.nodes.push({id:n,attributes:{x:un()*e,y:un()*e}}),s.edges.push({id:n-1,source:n-1,target:n});return s}var tA=Object.freeze(Object.defineProperty({__proto__:null,configure:s6,generate:n6},Symbol.toStringTag,{value:"Module"}));function i6(t){return typeof t=="number"&&isFinite(t)&&t>=0?t:void 0}function r6(t){return typeof t=="number"&&isFinite(t)&&t>0?t:void 0}function Ed(t){return typeof t=="number"&&isFinite(t)?t:void 0}function o6({children:t=2,height:e=3}={}){if(!r6(t))throw new TypeError('Invalid argument: "children" is not a positive number, was '+t);if(!i6(e))throw new TypeError('Invalid argument: "height" is not a positive number, was '+e);return{children:t,height:e}}function a6({children:t,height:e}){e+=1;const s=Math.pow(t,e),n=[],i=[];let r=1,o=0,a=0;for(let l=0;l<e;++l){const u=s/(r+1)/1.5;for(let h=0;h<r;++h){const g=o++;if(n.push({id:g,attributes:{x:(h+1)*u*10,y:20*l}}),l!==e-1)for(let f=0;f<t;++f)i.push({id:a,source:g,target:g*t+f+1}),a+=1}r*=t}return{nodes:n,edges:i}}var eA=Object.freeze(Object.defineProperty({__proto__:null,configure:o6,generate:a6},Symbol.toStringTag,{value:"Module"}));function l6({nodes:t=20,edges:e,p:s,scale:n=100}={}){if(!Ed(t)||t<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+t);if(e!==void 0&&s!==void 0)throw new TypeError("Invalid argument: choose between options.edges and options.p");return e===void 0&&s===void 0&&(s=.1),s===void 0&&(s=-1),e===void 0&&(e=-1),{nodes:t,p:s,edges:e,scale:n}}function u6(t){const e={nodes:[],edges:[]},s=t.nodes,n=t.p,i=t.scale;if(n>=0){let r=0;for(let o=0;o<s;o++){e.nodes.push({id:o,attributes:{x:un()*i,y:un()*i}});for(let a=0;a<o;a++)un()<n&&e.edges.push({id:r++,source:o,target:a})}}else{const r=[],o=t.edges;for(let l=0;l<s;l++){e.nodes.push({id:l,attributes:{x:100*un(),y:100*un()}});for(let u=l+1;u<s;u++)r.push({source:l,target:u})}let a=r.length-1;for(let l=0;l<o;l++){const u=r.splice(Math.floor(un()*a),1)[0];u.id=l,e.edges.push(u),a--}}return e}var sA=Object.freeze(Object.defineProperty({__proto__:null,configure:l6,generate:u6},Symbol.toStringTag,{value:"Module"}));function d6({nodes:t=40,m0:e=5,m:s=1,scale:n=100}={}){if(!Ed(t)||t<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+t);if(!Ed(e)||e>=t)throw new TypeError(`Invalid argument: options.m0 is not a number < ${t}, was ${e}`);if(!Ed(e)||s>=e)throw new TypeError(`Invalid argument: options.m is not a number <= ${e}, was ${s}`);if(!Ed(n)||n<0)throw new TypeError("Invalid argument: options.scale is not a number or is less than 0");return{nodes:t,m0:e,m:s,scale:n}}function h6({scale:t,nodes:e,m0:s,m:n}){const i={nodes:[],edges:[]},r={},o=[],a=t/10;let l=0;for(let u=0;u<s;u++)i.nodes.push({id:u,attributes:{x:un()*a,y:un()*a}}),o[u]=0;for(let u=0;u<s;u++)for(let h=u+1;h<s;h++){const g={id:l++,source:u,target:h};r[g.source+"-"+g.target]=g,i.edges.push(g),o[u]++,o[h]++}for(let u=s;u<e;u++){i.nodes.push({id:u,attributes:{x:un()*t,y:un()*t}}),o[u]=0;let h=0;for(let f=0;f<u;f++)h+=o[f];let g=0;for(let f=0;f<n;f++){const m=un();let y=0;for(let p=0;p<u;p++)if(!r[`${u}-${p}`]&&!r[`${p}-${u}`]&&(y=u===1?1:y+o[p]/h+g/(u-f),m<=y)){g+=o[p]/h;const x={id:l++,source:u,target:p};r[`${x.source}-${x.target}`]=x,i.edges.push(x),o[u]++,o[p]++;break}}}return i}var nA=Object.freeze(Object.defineProperty({__proto__:null,configure:d6,generate:h6},Symbol.toStringTag,{value:"Module"}));function c6({nodes:t=50,width:e=100,height:s=100,x:n=0,y:i=0}={}){if(!isFinite(t)||t<1)throw new RangeError("Tree generator: number of nodes must be a positive integer");return{nodes:t,width:e,height:s,x:n,y:i}}function g6({nodes:t,x:e,y:s,width:n,height:i}){const r=e-n/2,o=s-i/2;return{nodes:new Array(t).fill(0).map(((a,l)=>({id:l,attributes:{x:r+un()*n,y:o+un()*i}}))),edges:new Array(t-1).fill(0).map(((a,l)=>({id:l,source:Math.floor(Math.sqrt(l)),target:l+1})))}}var iA=Object.freeze(Object.defineProperty({__proto__:null,configure:c6,generate:g6},Symbol.toStringTag,{value:"Module"})),f6=5,m6=10,p6=10,_6=2.7,y6=.2;function x6({depth:t=3,breadth:e=3,nodes:s}){return s!==void 0?(e=5,t=Math.ceil(Math.log(s)/Math.log(5))):s=-1,{depth:t,breadth:e,nodes:s}}function v6({depth:t,breadth:e,nodes:s}){const n={id:0,attributes:{x:0,y:0,radius:tM(t+1)}},i={nodes:[n],edges:[]};return eM(i,e,t,n,1),s!==void 0&&s>=0&&(i.nodes=i.nodes.slice(0,s),i.edges=i.edges.slice(0,Math.max(s-1,0))),i}function JN(t){return Math.pow(_6,t)*m6}function tM(t){return f6+JN(t)/p6}function eM(t,e,s,n,i){if(s===0)return i;const r=JN(s),o=tM(s),a=o*y6;let l=-Math.PI;const u=2*Math.PI/e,h=n.attributes.x||0,g=n.attributes.y||0;for(let f=0;f<e;++f){const m={id:i,attributes:{x:h+r*Math.cos(l),y:g+r*Math.sin(l),radius:o}},y={id:i,source:n.id,target:i,attributes:{width:a}};t.nodes.push(m),t.edges.push(y),i=eM(t,e,s-1,m,i+1),l+=u}return i}var rA=Object.freeze(Object.defineProperty({__proto__:null,configure:x6,generate:v6},Symbol.toStringTag,{value:"Module"})),b6=class extends Rs{constructor(){super(...arguments),this.balancedTree=t=>Promise.resolve(eA.generate(eA.configure(t))),this.barabasiAlbert=t=>Promise.resolve(nA.generate(nA.configure(t))),this.erdosRenyi=t=>Promise.resolve(sA.generate(sA.configure(t))),this.flower=t=>Promise.resolve(rA.generate(rA.configure(t))),this.grid=t=>Promise.resolve(J1.generate(J1.configure(t))),this.path=t=>Promise.resolve(tA.generate(tA.configure(t))),this.random=t=>Promise.resolve(Q1.generate(Q1.configure(t))),this.randomTree=t=>Promise.resolve(iA.generate(iA.configure(t)))}},E6=class extends Rs{constructor(){super(...arguments),this.enable=t=>this._ogma.modules.geo.enable(t),this.disable=t=>this._ogma.modules.geo.disable(t),this.setOptions=t=>this._ogma.modules.geo.setOptions(t),this.getOptions=()=>this._ogma.modules.geo.getOptions(),this.getMap=()=>this._ogma.modules.geo.getMap(),this.enabled=()=>this._ogma.modules.geo.isEnabled(),this.getCenter=()=>this._ogma.modules.geo.getCenter(),this.getView=()=>this._ogma.modules.geo.getView(),this.getZoom=()=>this._ogma.modules.geo.getZoom(),this.setZoom=t=>this._ogma.modules.geo.setZoom(t),this.setView=(t,e,s)=>this._ogma.modules.geo.setView(t,e,s),this.setCenter=(t,e)=>this._ogma.modules.geo.setCenter(t,e),this.toggle=t=>this._ogma.modules.geo.toggle(t),this.resetCoordinates=()=>this._ogma.modules.geo.resetCoordinates(),this.getUnprojectedCoordinates=t=>this._ogma.modules.geo.getUnprojectedCoordinates(this._ogma.getNodes(t)),this.runLayout=async({type:t,nodes:e,latitudePath:s=Ar,longitudePath:n=wr,options:i,center:r})=>{if(t===void 0||i===void 0)throw new Error("Ogma.geo.runLayout: Both layout type and options are required");if(e=this._ogma.getNodes(e),r===void 0){let o=0;if(r=e.reduce(((a,l)=>{const u=l.getData(s),h=l.getData(n);return isNaN(u)||isNaN(h)||(a.latitude+=u,a.longitude+=h,o++),a}),{latitude:0,longitude:0}),isNaN(r.latitude)||isNaN(r.longitude))throw new Error("Ogma.geo.runLayout: No valid center coordinates found");r.latitude/=o,r.longitude/=o}return this._ogma.modules.geo.runLayout({center:r,nodes:e,type:t,options:i,latitudePath:s,longitudePath:n})}}},S6=class{reloadFonts(){this.modules.graphics.reloadFonts()}},A6=class extends Rs{constructor(){super(...arguments),this.gexf=t=>jN(t),this.gexfFromUrl=t=>p0(t),this.janus=t=>HN(t),this.json=(t,e)=>$N(t,e),this.jsonFromUrl=(t,e)=>_0(t,e),this.neo4j=t=>qN(t),this.graphml=(t,e)=>YN(t,e),this.graphmlFromUrl=(t,e)=>WN(t,e)}},w6=class extends Rs{constructor(){super(...arguments),this.isKeyPressed=t=>this._ogma.modules.keyboard.isPressed(t),this.resetKeys=()=>{this._ogma.modules.keyboard.resetKeys()}}},T6=class extends Rs{addLayer(t,e){return this._ogma.modules.layers.addLayer(t,"layer",e)}addCanvasLayer(t,e,s){return this._ogma.modules.layers.addCanvasLayer(t,e,s)}addOverlay(t,e){if(!t.position)throw new Error("options.position argument is required");return this._ogma.modules.layers.addOverlay(t,e)}addSVGLayer(t,e){return t.element||(t.element=document.createElementNS("http://www.w3.org/2000/svg","svg")),t.draw||(t.draw=()=>{}),this._ogma.modules.layers.addSVGLayer(t,e)}},oA={name:"concentric",configure:function(t,{graph:e,data:s}){if(t.centralNode===void 0)throw new Error('concentric layout: missing parameter "centralNode"');const n={...t,centralNode:(function(A,w){return w instanceof ji?w:A.getNode(w)})(e,t.centralNode)},{centralNode:i,nodes:r}=n,o=e.getNode(i);if(o===void 0)throw new Error('concentric layout: "centralNode" parameter is not valid');const a=o._index,{x:l,y:u}=o.getPosition(),h=r.getAttribute("layoutable"),g=e.getNodes(r)._indexes,f=Array.from(g.filter(((S,A)=>h[A])));f.indexOf(a)===-1&&f.push(a);const m=t.rs?t.rs:e.getNodeAttribute("radius").getMultiple(g),y=(function(A,w,L,k){if(w)return w==="random"?"random":w==="radius"?k.slice():w==="degree"?L.getDegree():A.getProperty(L,w)})(s,n.sortBy,r,m),p=f.reduce(((S,A,w)=>(S[A]=w,S)),{}),x=f.map(((S,A)=>A)),v=new Set(t.edges.getExtremities()._indexes),b=f.map((S=>e.topology.getAdjacentElements(!0,new Uint32Array([S])).filter((A=>v.has(A))).map((A=>p[A]))));return{sourceNodeIndex:f.indexOf(a),centerX:typeof n.centerX=="number"?n.centerX:l,centerY:typeof n.centerY=="number"?n.centerY:u,list:f,indexes:x,size:f.length,totalSize:f.length,attributes:{adjacentNodes:b,size:m},sortAttr:y,clockwise:n.clockwise===void 0||n.clockwise,circleHopRatio:n.circleHopRatio||5,allowOverlap:!!n.allowOverlap}},context:function(){return{dijkstra:function(t,e,s,n,i){const r=Math.pow(2,31)-1,o=new Int32Array(n),a=new Int32Array(n),l=new Int8Array(n);o.fill(r),a.fill(-1);for(let h=0;h<n;++h){const g=e[h];g!==void 0&&(o[g]=r,a[g]=-1)}o[i]=0;let u=0;for(;u!==-1;){let h=r;u=-1;for(let g=0;g<s;++g){const f=e[g],m=o[f];!l[f]&&m<h&&(h=m,u=f,l[f]=1)}if(u>-1){const g=t[u],f=h+1;g.forEach((m=>{const y=o[m];f<y&&(o[m]=f,a[m]=u)}))}}return o},determinePropertyType:function(t,e,s){return e.some((n=>t[n]!=="number"))?"string":"number"}}},update:function(t,e){const{attributes:s,indexes:n,size:i}=t,{sourceNodeIndex:r,centerX:o,centerY:a,sortAttr:l}=t,u=s.adjacentNodes,h=s.size,g=new Array(t.totalSize),f=new Array(t.totalSize),m=e.dijkstra(u,n,t.size,t.totalSize,r);let y=0;const p={};for(let L=0;L<i;L++){const k=h[n[L]];k>y&&(y=k)}const x=y*t.circleHopRatio;let v=0,b=0;const S=Math.PI/9;for(let L=0;L<i;L++){const k=n[L],F=m[k];let O=p[F];O||(O=[],p[F]=O),O.push(k)}const A=(function(k,F,O){if(k==="random")return function(){return Math.random()-.5};if(k)return O.determinePropertyType(k,F,F.length)==="number"?function(j,V){return k[j]-k[V]}:function(j,V){return k[j]<k[V]?-1:1}})(l,n,e),w=l==="random"||l;return Object.keys(p).sort(((L,k)=>parseInt(L)-parseInt(k))).forEach(((L,k)=>{const F=p[L],O=F.length;let j=0,V=b;const Z=2*Math.PI/O;if(k!==0&&!t.allowOverlap){const at=2*Math.PI*v;let mt=0;j+=F.reduce(((K,ut)=>K+h[ut]),0),mt=2*j*Math.SQRT2,mt>at&&(v+=mt/(2*Math.PI)-v)}w&&(F.sort(A),t.clockwise||F.reverse());for(let at=0;at<O;at++){const mt=F[at];g[mt]=Math.cos(V)*v+o,f[mt]=Math.sin(V)*v+a;const K=h[mt];V+=Z*(t.allowOverlap?1:K/j*O)}v+=x,b+=S})),{x:g,y:f,indexes:t.list}},isRunning:function(){return!1},onSync:function({indexes:t,x:e,y:s}){return{indexes:t,x:e,y:s}}},C6=t=>(t.modules.layouts.register(oA),e=>t.modules.layouts.start(oA.name,e)),L6=Object.defineProperty,Se=(t,e)=>L6(t,"name",{value:e,configurable:!0});function du(t){let e=0,s=0;for(const o of t)e+=o.w*o.h,s=Math.max(s,o.w);t.sort(((o,a)=>a.h-o.h));const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),s),h:1/0}];let i=0,r=0;for(const o of t)for(let a=n.length-1;a>=0;a--){const l=n[a];if(!(o.w>l.w||o.h>l.h)){if(o.x=l.x,o.y=l.y,r=Math.max(r,o.y+o.h),i=Math.max(i,o.x+o.w),o.w===l.w&&o.h===l.h){const u=n.pop();a<n.length&&(n[a]=u)}else o.h===l.h?(l.x+=o.w,l.w-=o.w):o.w===l.w?(l.y+=o.h,l.h-=o.h):(n.push({x:l.x+o.w,y:l.y,w:l.w-o.w,h:o.h}),l.y+=o.h,l.h-=o.h);break}}return{w:i,h:r,fill:e/(i*r)||0}}Se(du,"g");var aA=Se(((t,e)=>Array.from({length:t},((s,n)=>e(n)))),"me"),ao=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),N6=Se((()=>({[WebGL2RenderingContext.FLOAT]:"uniform1f",[WebGL2RenderingContext.FLOAT_VEC2]:"uniform2fv",[WebGL2RenderingContext.FLOAT_VEC3]:"uniform3fv",[WebGL2RenderingContext.FLOAT_VEC4]:"uniform4fv",[WebGL2RenderingContext.INT]:"uniform1i",[WebGL2RenderingContext.INT_VEC2]:"uniform2iv",[WebGL2RenderingContext.INT_VEC3]:"uniform3iv",[WebGL2RenderingContext.INT_VEC4]:"uniform4iv",[WebGL2RenderingContext.UNSIGNED_INT]:"uniform1ui",[WebGL2RenderingContext.UNSIGNED_INT_VEC2]:"uniform2uiv",[WebGL2RenderingContext.UNSIGNED_INT_VEC3]:"uniform2uiv",[WebGL2RenderingContext.UNSIGNED_INT_VEC4]:"uniform2uiv",[WebGL2RenderingContext.FLOAT_MAT2]:"uniformMatrix2fv",[WebGL2RenderingContext.FLOAT_MAT3]:"uniformMatrix3fv",[WebGL2RenderingContext.FLOAT_MAT4]:"uniformMatrix4fv",[WebGL2RenderingContext.SAMPLER_2D]:"uniform1i",[WebGL2RenderingContext.INT_SAMPLER_2D]:"uniform1i",[WebGL2RenderingContext.UNSIGNED_INT_SAMPLER_2D]:"uniform1i",[WebGL2RenderingContext.SAMPLER_CUBE]:"uniform1i"})),"we"),vg=new Map,d_=new Map,M6=Se(((t,e,s,n)=>{vg.has(t)||vg.set(t,vg.size);const i=`${vg.get(t)}:${e}:${s}`;return d_.has(i)||d_.set(i,n()),d_.get(i)}),"ze"),Yo=Se(((t,e)=>()=>([t,e]=[e,t],[t,e])),"$"),Qe=Se(((t,e=ao)=>{const s=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),s}),"b"),lA=Se(((t,e,s)=>{const n=t.createShader(e);if(n===null)throw new Error("Cannot create WebGL shader.");return t.shaderSource(n,s),t.compileShader(n),n}),"ce"),Zo=Se(((t,e,s)=>M6(t,e,s,(()=>{const n=t.createProgram();if(t.attachShader(n,lA(t,t.VERTEX_SHADER,e)),t.attachShader(n,lA(t,t.FRAGMENT_SHADER,s)),t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS)){const i=t.getProgramInfoLog(n);throw t.deleteProgram(n),new Error(`Could not link WebGL program: 
${i}`)}return n}))),"q"),ni=Se(((t,{size:e,data:s,type:n,internalFormat:i=t.RGBA32F,format:r=t.RGBA})=>{const o=t.createTexture(),[a,l]=e.map((u=>Math.max(1,u)));return s instanceof Float32Array&&s.byteLength===0?s=new Float32Array(a*l*4):s instanceof Uint32Array&&s.byteLength===0&&(s=new Uint32Array(a*l*4)),t.bindTexture(t.TEXTURE_2D,o),t.texImage2D(t.TEXTURE_2D,0,i,a,l,0,r,n,s),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),{size:e,data:s,type:n,format:r,handle:o}}),"k"),Wo=Se(((t,e)=>{const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);const n=t.checkFramebufferStatus(t.FRAMEBUFFER);if(n!==t.FRAMEBUFFER_COMPLETE){const i={[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT]:"Attachment is NOT complete.",[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT]:"No valid attachment.",[t.FRAMEBUFFER_UNSUPPORTED]:"Attachment types are not supported."}[n];throw i?new Error(`Framebuffer: ${i}`):new Error(`Framebuffer: Unknown reason (status: ${n})`)}return s}),"W"),Ha=Se(((t,e,s)=>{t.useProgram(e);const n={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let r=0;r<i;r++){const o=t.getActiveUniform(e,r);if(!o)throw new Error(`Cannot get GL active uniform ${r}.`);const{name:a,size:l,type:u}=o,h=t.getUniformLocation(e,a);if(!h)throw new Error(`Cannot get GL uniform location ${a}.`);n[a]={size:l,data:s[a],type:u,location:h}}return n}),"Y");function Ko(t,e,s={}){let n=0;const i=N6();return Object.entries(e).forEach((([r,{location:o,type:a,data:l}])=>{let u=s[r]!==void 0?s[r]:l;(a===t.SAMPLER_2D||a===t.INT_SAMPLER_2D||a===t.UNSIGNED_INT_SAMPLER_2D)&&(t.activeTexture(t.TEXTURE0+n),t.bindTexture(t.TEXTURE_2D,u),u=n,n++),t[i[a]](o,u)}))}Se(Ko,"J");var uA=Se(((t,e=!1)=>{const s=e?1<<Math.ceil(Math.log2(Math.sqrt(t))):Math.ceil(Math.sqrt(t));return{w:s,h:s}}),"ue"),Pl=Se(((t,e,{x:s,y:n,w:i})=>{const r=s+t%i;return(n+Math.floor(t/i))*e+r}),"Q"),Vy=Se((t=>{const e=new Map,s={nodes:[],edges:[]};return t.nodes.forEach(((n,i)=>{e.has(n.id)&&console.warn(`Duplicated ID ${n.id}@${i}`),s.nodes.push({...n,id:i}),e.set(n.id,i)})),t.edges.forEach((n=>{const i=e.get(n.source),r=e.get(n.target);return i===void 0?console.warn(`Missing source ${n.source}`):r===void 0?console.warn(`Missing target ${n.target}`):void s.edges.push({...n,source:Math.min(i,r),target:Math.max(i,r)})})),s.edges.sort(((n,i)=>n.source-i.source||n.target-i.target)),s}),"it"),I6=Se((({nodes:t,edges:e},[s,n]=[0,0],i=.001)=>{const r=Math.PI*(3-Math.sqrt(5)),o=t.map((l=>(l.x=(l.x||0)-s,l.y=(l.y||0)-n,l))).map((l=>({n:l,key:l.pinned?0:.5+Math.floor(l.x/i)+Math.floor(l.y/i)/i}))).sort(((l,u)=>l.key-u.key));let a=0;return o.forEach((({n:l,key:u},h)=>{if(u*h==0||u!==o[h-1].key)return a=h;const g=Math.sqrt(h-a);l.x=o[a].n.x+g*Math.cos(r*(h-a)),l.y=o[a].n.y+g*Math.sin(r*(h-a))})),{nodes:t,edges:e}}),"at"),dA=Se(((t,e)=>{const s={};return e.forEach(((n,i)=>(s[n]??(s[n]=new Set)).add(i))),[...Object.values(s)].map((n=>({nodes:[...n].map((i=>t.nodes[i])),edges:t.edges.filter((({source:i,target:r})=>n.has(i)&&n.has(r)))})))}),"st");function jy(t,e){const s=e.map((({nodes:S})=>({x:0,y:0,...uA(S.length,!0)}))),n=e.map((({edges:S})=>({x:0,y:0,...uA(2*S.length)}))),i=du(s.slice()),r=du(n.slice()),o=i.w*i.h,a=r.w*r.h,l=new Float32Array(4*o),u=new Uint32Array(3*o),h=new Uint32Array(2*a),g=new Float32Array(4*o),f=new Float32Array(a);e.forEach((({nodes:S,edges:A},w)=>{const L=S.length,k=A.length,F=s[w],O=n[w],j=new Uint32Array(k),V=new Uint32Array(k),Z=new Uint32Array(L);for(let ht=0;ht<k;ht++){const{source:nt,target:ot}=A[ht];j[ht]=nt,V[ht]=ot,Z[nt]++,Z[ot]++}const at=aA(L,(()=>[]));j.forEach(((ht,nt)=>{at[ht].push(V[nt]),at[V[nt]].push(ht)}));const mt=aA(L,(()=>[]));j.forEach(((ht,nt)=>{if(A[nt].stiffness!==void 0)mt[ht].push(A[nt].stiffness),mt[V[nt]].push(A[nt].stiffness);else{const ot=Z[ht],Mt=Z[V[nt]],Q=ot*Mt/(Math.min(ot,Mt)*(ot+Mt));mt[ht].push(Q),mt[V[nt]].push(Q)}}));for(let ht=0;ht<L;ht++){const nt=4*Pl(ht,i.w,F);l[nt]=S[ht].x||0,l[nt+1]=S[ht].y||0}let K=0;for(let ht=0;ht<L;ht++){const nt=3*Pl(ht,i.w,F);u[nt]=K%O.w,u[nt+1]=Math.floor(K/O.w),u[nt+2]=Z[ht],K+=Z[ht]}let ut=0;for(let ht=0;ht<L;ht++)for(const nt of at[ht]){const ot=2*Pl(ut,r.w,O);h[ot]=nt%F.w,h[ot+1]=Math.floor(nt/F.w),ut++}for(let ht=0;ht<L;ht++){const nt=4*Pl(ht,i.w,F);g[nt]=S[ht].mass||Z[ht]+1,g[nt+1]=S[ht].r||1,g[nt+2]=S[ht].pinned?1:0}ut=0;for(let ht=0;ht<L;ht++)for(const nt of mt[ht]){const ot=Pl(ut,r.w,O);f[ot]=nt,ut++}}));const m=ni(t,{size:[i.w,i.h],data:l,type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F}),y=ni(t,{size:[i.w,i.h],data:g,type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F}),p=ni(t,{size:[i.w,i.h],data:u,type:t.UNSIGNED_INT,format:t.RGB_INTEGER,internalFormat:t.RGB32UI}),x=ni(t,{size:[r.w,r.h],data:h,type:t.UNSIGNED_INT,format:t.RG_INTEGER,internalFormat:t.RG32UI}),v=ni(t,{size:[r.w,r.h],data:f,type:t.FLOAT,format:t.RED,internalFormat:t.R32F}),b=ni(t,{size:[i.w,i.h],data:g,type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F});return{items:e.map((({nodes:S,edges:A},w)=>({N:S.length,E:A.length,particlesPositionsSlot:s[w],particlesChargesSlot:s[w],adjacencyOffsetsSlot:s[w],adjacencyListsSlot:n[w],stiffnessSlot:n[w],nodesExtraPropertiesSlot:s[w]}))),texture:{particlesPositions:()=>m,particlesCharges:()=>y,adjacencyOffsets:()=>p,adjacencyLists:()=>x,stiffness:()=>v,nodesExtraProperties:()=>b}}}Se(jy,"mt");var hA=Se(((t,e)=>{t.deleteTexture(e.texture.particlesPositions().handle),t.deleteTexture(e.texture.particlesCharges().handle),t.deleteTexture(e.texture.adjacencyOffsets().handle),t.deleteTexture(e.texture.adjacencyLists().handle),t.deleteTexture(e.texture.stiffness().handle),t.deleteTexture(e.texture.nodesExtraProperties().handle)}),"ct"),Od=Se((()=>({x:0,y:0,w:0,h:0})),"Z"),k6=`#version 300 es
precision highp float;precision highp int;vec2 c(vec2 c,vec2 e){return vec2(c.x*e.x-c.y*e.y,c.x*e.y+c.y*e.x);}vec2 c(vec2 c){return c.y=-c.y,c;}vec2 c(vec2 i[8],vec2 s,vec2 a){vec2 t,o=a-s,e=vec2(1,0);for(int s;s<8;++s)t+=c(i[s],e),e=c(e,o);return t;}vec2 c(vec2 e,vec4 c){return(e-c.xy)/c.zw;}uniform float m_x,m_y,m_z,m_10,m_11,m_12,m_u,m_v,m_w;uniform highp sampler2D m_13;uniform highp usampler2D m_14,m_15;uniform highp sampler2D m_16,m_17,m_7;uniform highp usampler2D m_18,m_19;uniform highp sampler2D m_1j,m_1k;flat in uvec4 m_2b,m_2c,m_2d,m_2e,m_2f,m_26,m_29,m_28,m_1y;flat in uint m_22,m_27,m_20;out vec4 outColor;void main(){uvec2 s=uvec2(gl_FragCoord.xy)-m_2b.xy;if(m_2b.z*s.y+s.x>=m_22)return;vec3 a=texelFetch(m_16,ivec2(m_2c.xy+s),0).xyz;if(a.z>0.)return;vec4 l=texelFetch(m_13,ivec2(m_2b.xy+s),0);vec2 i=l.xy,e=l.zw;ivec4 t=ivec4(texelFetch(m_14,ivec2(m_2e.xy+s),0));vec4 o=texelFetch(m_7,ivec2(m_26.xy),0);float r=float(1u<<m_27-1u);ivec2 u=ivec2(r*c(i,o));vec2 v=(vec2(u)+.5)/r;ivec2 p=u-ivec2(1);for(int c;c<9;++c){ivec2 t=p+ivec2(c%3,c/3);if(t>>m_27-1u!=ivec2(0))continue;uvec2 s=texelFetch(m_19,ivec2(m_28.xy)+t,0).xy;for(uint c=s.x;c<s.y;c++){uint l=texelFetch(m_18,ivec2(m_29.xy)+ivec2(c%m_29.z,c/m_29.z),0).x;ivec2 o=ivec2(l%m_2b.z,l/m_2b.z);vec2 t=texelFetch(m_13,ivec2(m_2b.xy)+o,0).xy-i;float u=dot(t,t)+1e-4;if(m_11>0.&&m_u<.5){float i=texelFetch(m_16,ivec2(m_2c.xy)+o,0).y,c=max(a.y+i+m_12,.01);if(u<c*c){float s=sqrt(u);e-=(c-s)*m_11*i/c*t/s;}}float r=texelFetch(m_16,ivec2(m_2c.xy)+o,0).x;e-=m_u*m_x*r*t/u;}}if(m_27>2u){vec2 t[8];ivec2 s=ivec2(m_1y.xy)+u;vec4 a=texelFetch(m_1j,s,0),l=texelFetch(m_1k,s,0);if(t[0]=a.xy,t[1]=a.zw,t[2]=l.xy,t[3]=l.zw,m_20>4u){vec4 c=texelFetch(m_1j,s,0);t[4]=c.xy,t[5]=c.zw;}if(m_20>6u){vec4 c=texelFetch(m_1k,s,0);t[6]=c.xy,t[7]=c.zw;}vec2 r=c(c(t,v,c(i,o))/o.z);e+=m_u*m_x*r;}ivec2 n;for(int s;s<t.z;s++){n=ivec2(texelFetch(m_15,ivec2(m_2d.xy)+t.xy,0).xy);float o=texelFetch(m_17,ivec2(m_2f.xy)+t.xy,0).x;vec2 c=texelFetch(m_13,ivec2(m_2b.xy)+n,0).xy-i;if(c*=1.-m_10/(length(c)+1e-4),e+=m_u*m_z*o*c/a.x,t.x+=1,t.x>=int(m_2d.z))t.x=0,t.y+=1;}e=m_v*(e-m_u*m_y*i);float x=dot(e,e);if(x>m_w)e*=sqrt(m_w/x);outColor=vec4(i+e,e);}`,R6=`#version 300 es
precision highp int;
precision highp float;

uniform uint m_c; 
uniform uvec2 m_1b;

in vec2 position; 
in uvec4 m_1c; 
in uvec4 m_1d; 
in uvec4 m_1e; 
in uvec4 m_1f; 
in uvec4 m_1g; 
in uvec4 m_s; 
in uvec4 m_1h; 
in uvec4 m_1i; 
in uvec4 m_e; 

in uint m_5; 
in uint m_t; 
in uint m_g; 

flat out uvec4 m_2b;
flat out uvec4 m_2c;
flat out uvec4 m_2d;
flat out uvec4 m_2e;
flat out uvec4 m_2f;
flat out uvec4 m_26;
flat out uvec4 m_29;
flat out uvec4 m_28;
flat out uvec4 m_1y;

flat out uint m_22;
flat out uint m_27;
flat out uint m_20;

void main() {
  m_2b = m_1c;
  m_2c = m_1d;
  m_2d = m_1e;
  m_2e = m_1f;
  m_2f = m_1g;
  m_26 = m_s;
  m_29 = m_1h;
  m_28 = m_1i;
  m_1y = m_e;

  m_22 = m_5;
  m_27 = m_t;
  m_20 = m_g;

  
  if(m_c != m_t - 1u) {
    gl_Position = vec4(0.f, 0.f, 0.f, 1.f);
    return;
  }

  
  vec2 posPx = (position + 1.f) * vec2(m_1c.zw) * .5f + vec2(m_1c.xy);
  gl_Position = vec4(posPx / vec2(m_1b) * 2.f - 1.f, 0.f, 1.f);
}`,F6=Se(((t,e,{charge:s,gravity:n,inertia:i,edgeStrength:r,edgeLength:o,elasticity:a,margin:l,maxDisplacement:u})=>{const h=Zo(t,R6,k6),g=e.texture.particlesPositions(),f=ni(t,{type:t.FLOAT,size:g.size,data:new Float32Array(g.data.buffer.slice(0)),format:t.RGBA,internalFormat:t.RGBA32F}),m=Yo(g,f),y=Wo(t,f.handle),p=Wo(t,g.handle),x=Yo(y,p),v=Ha(t,h,{m_u:1,m_v:i,m_w:u**2,m_x:s,m_y:n,m_z:r,m_10:o,m_11:a,m_12:l,m_13:g.handle,m_14:e.texture.adjacencyOffsets().handle,m_15:e.texture.adjacencyLists().handle,m_16:e.texture.nodesExtraProperties().handle,m_17:e.texture.stiffness().handle,m_c:2,m_7:e.texture.spatialBoundaries().handle,m_18:e.texture.spatialKeys().handle,m_19:e.texture.gridCells().handle,m_1a:null,m_1b:g.size});let b=g;const S=[],A=new Set;function w(k=1){t.viewport(0,0,g.size[0],g.size[1]),t.useProgram(h),t.bindFramebuffer(t.FRAMEBUFFER,x()[0]);const[F,O]=m();b=O,A.forEach((j=>{var V,Z;t.bindVertexArray(S[j]),Ko(t,v,{m_u:k,m_13:F.handle,m_7:e.texture.spatialBoundaries().handle,m_18:e.texture.spatialKeys().handle,m_c:j,m_1j:(V=e.texture.localExpansions(j,0))==null?void 0:V.handle,m_1k:(Z=e.texture.localExpansions(j,1))==null?void 0:Z.handle,m_14:e.texture.adjacencyOffsets().handle,m_15:e.texture.adjacencyLists().handle,m_16:e.texture.nodesExtraProperties().handle,m_17:e.texture.stiffness().handle,m_19:e.texture.gridCells().handle}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}))}e.items.forEach((({depth:k})=>{A.add(k-1)})),A.forEach((k=>{S[k]=t.createVertexArray(),t.bindVertexArray(S[k]);const F=t.getAttribLocation(h,"position");t.enableVertexAttribArray(F),Qe(t,ao),t.vertexAttribPointer(F,2,t.FLOAT,!1,0,0);const O=t.getAttribLocation(h,"m_1c");t.enableVertexAttribArray(O);const j=e.items.map((ce=>ce.particlesPositionsSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(j)),t.vertexAttribIPointer(O,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(O,1);const V=t.getAttribLocation(h,"m_1d");t.enableVertexAttribArray(V);const Z=e.items.map((ce=>ce.nodesExtraPropertiesSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(Z)),t.vertexAttribIPointer(V,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(V,1);const at=t.getAttribLocation(h,"m_1e");t.enableVertexAttribArray(at);const mt=e.items.map((ce=>ce.adjacencyListsSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(mt)),t.vertexAttribIPointer(at,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(at,1);const K=t.getAttribLocation(h,"m_1f");t.enableVertexAttribArray(K);const ut=e.items.map((ce=>ce.adjacencyOffsetsSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(ut)),t.vertexAttribIPointer(K,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(K,1);const ht=t.getAttribLocation(h,"m_1g");t.enableVertexAttribArray(ht);const nt=e.items.map((ce=>ce.stiffnessSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(nt)),t.vertexAttribIPointer(ht,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(ht,1);const ot=t.getAttribLocation(h,"m_s");t.enableVertexAttribArray(ot);const Mt=e.items.map((ce=>ce.spatialBoundariesSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(Mt)),t.vertexAttribIPointer(ot,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(ot,1);const Q=t.getAttribLocation(h,"m_1h");t.enableVertexAttribArray(Q);const Et=e.items.map((ce=>ce.spatialKeysSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(Et)),t.vertexAttribIPointer(Q,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(Q,1);const qt=t.getAttribLocation(h,"m_1i");t.enableVertexAttribArray(qt);const Vt=e.items.map((ce=>ce.gridCellsSlot)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(Vt)),t.vertexAttribIPointer(qt,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(qt,1);const Wt=t.getAttribLocation(h,"m_e");t.enableVertexAttribArray(Wt);const oe=Od(),me=e.items.map((ce=>ce.localExpansionsSlot[k]||oe)).map((({x:ce,y:Ce,w:ve,h:Me})=>[ce,Ce,ve,Me])).flat();Qe(t,new Uint32Array(me)),t.vertexAttribIPointer(Wt,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(Wt,1);const se=t.getAttribLocation(h,"m_5");t.enableVertexAttribArray(se),Qe(t,new Uint32Array(e.items.map((({N:ce})=>ce)))),t.vertexAttribIPointer(se,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(se,1);const Jt=t.getAttribLocation(h,"m_t");t.enableVertexAttribArray(Jt),Qe(t,new Uint32Array(e.items.map((ce=>ce.depth)))),t.vertexAttribIPointer(Jt,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(Jt,1);const ee=t.getAttribLocation(h,"m_g");t.enableVertexAttribArray(ee),Qe(t,new Uint32Array(e.items.map((ce=>ce.order)))),t.vertexAttribIPointer(ee,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(ee,1)})),Se(w,"P");const L=Se((()=>{t.deleteFramebuffer(y),t.deleteFramebuffer(p),t.deleteTexture(f.handle)}),"h");return{step:w,outputs:{items:e.items.map((k=>({N:k.N,pointsSlot:k.particlesPositionsSlot}))),texture:{points:()=>b}},destroy:L}}),"Fe"),P6=`#version 300 es
precision highp float;vec2 l(vec2 l,vec2 x){return vec2(l.x*x.x-l.y*x.y,l.x*x.y+l.y*x.x);}vec2 x(vec2 x,vec2 l){return vec2(dot(x,l),x.y*l.x-x.x*l.y)/dot(l,l);}uniform uint m_c;uniform highp sampler2D m_l,m_m,m_n,m_o,m_h,m_i,m_j,m_k;flat in uvec4 m_1y,m_1z;flat in uint m_20;layout(location=0)out vec4 l01;layout(location=1)out vec4 l23;layout(location=2)out vec4 l45;layout(location=3)out vec4 l67;void main(){float a=float(1u<<m_c);uvec2 i=uvec2(gl_FragCoord.xy)-m_1y.xy;vec2 r=(vec2(i)+.5)/a,e=texelFetch(m_h,ivec2(m_1y.xy+i),0).xy;if(e.x==0.)return;if(m_c>2u){uvec2 o=i>>1u;vec2 w=r-(vec2(i&65534u)+1.)/a,x=vec2(1,0);vec4 u=texelFetch(m_l,ivec2(m_1z.xy+o),0),y=m_20>2u?texelFetch(m_m,ivec2(m_1z.xy+o),0):vec4(0),e=m_20>4u?texelFetch(m_n,ivec2(m_1z.xy+o),0):vec4(0),z=m_20>6u?texelFetch(m_o,ivec2(m_1z.xy+o),0):vec4(0);switch(m_20){case 2u:l01.xy+=l(u.xy,1.*x),l01.zw+=l(u.zw,1.*x),x=l(x,w),l01.xy+=l(u.zw,1.*x);break;case 3u:case 4u:l01.xy+=l(u.xy,1.*x),l01.zw+=l(u.zw,1.*x),l23.xy+=l(y.xy,1.*x),l23.zw+=l(y.zw,1.*x),x=l(x,w),l01.xy+=l(u.zw,1.*x),l01.zw+=l(y.xy,2.*x),l23.xy+=l(y.zw,3.*x),x=l(x,w),l01.xy+=l(y.xy,1.*x),l01.zw+=l(y.zw,3.*x),x=l(x,w),l01.xy+=l(y.zw,1.*x);break;case 5u:case 6u:l01.xy+=l(u.xy,1.*x),l01.zw+=l(u.zw,1.*x),l23.xy+=l(y.xy,1.*x),l23.zw+=l(y.zw,1.*x),l45.xy+=l(e.xy,1.*x),l45.zw+=l(e.zw,1.*x),x=l(x,w),l01.xy+=l(u.zw,1.*x),l01.zw+=l(y.xy,2.*x),l23.xy+=l(y.zw,3.*x),l23.zw+=l(e.xy,4.*x),l45.xy+=l(e.zw,5.*x),x=l(x,w),l01.xy+=l(y.xy,1.*x),l01.zw+=l(y.zw,3.*x),l23.xy+=l(e.xy,6.*x),l23.zw+=l(e.zw,10.*x),x=l(x,w),l01.xy+=l(y.zw,1.*x),l01.zw+=l(e.xy,4.*x),l23.xy+=l(e.zw,10.*x),x=l(x,w),l01.xy+=l(e.xy,1.*x),l01.zw+=l(e.zw,5.*x),x=l(x,w),l01.xy+=l(e.zw,1.*x);break;case 7u:case 8u:l01.xy+=l(u.xy,1.*x),l01.zw+=l(u.zw,1.*x),l23.xy+=l(y.xy,1.*x),l23.zw+=l(y.zw,1.*x),l45.xy+=l(e.xy,1.*x),l45.zw+=l(e.zw,1.*x),l67.xy+=l(z.xy,1.*x),l67.zw+=l(z.zw,1.*x),x=l(x,w),l01.xy+=l(u.zw,1.*x),l01.zw+=l(y.xy,2.*x),l23.xy+=l(y.zw,3.*x),l23.zw+=l(e.xy,4.*x),l45.xy+=l(e.zw,5.*x),l45.zw+=l(z.xy,6.*x),l67.xy+=l(z.zw,7.*x),x=l(x,w),l01.xy+=l(y.xy,1.*x),l01.zw+=l(y.zw,3.*x),l23.xy+=l(e.xy,6.*x),l23.zw+=l(e.zw,10.*x),l45.xy+=l(z.xy,15.*x),l45.zw+=l(z.zw,21.*x),x=l(x,w),l01.xy+=l(y.zw,1.*x),l01.zw+=l(e.xy,4.*x),l23.xy+=l(e.zw,10.*x),l23.zw+=l(z.xy,20.*x),l45.xy+=l(z.zw,35.*x),x=l(x,w),l01.xy+=l(e.xy,1.*x),l01.zw+=l(e.zw,5.*x),l23.xy+=l(z.xy,15.*x),l23.zw+=l(z.zw,35.*x),x=l(x,w),l01.xy+=l(e.zw,1.*x),l01.zw+=l(z.xy,6.*x),l23.xy+=l(z.zw,21.*x),x=l(x,w),l01.xy+=l(z.xy,1.*x),l01.zw+=l(z.zw,7.*x),x=l(x,w),l01.xy+=l(z.zw,1.*x);break;}}ivec2 y=(ivec2(i)&65534)-2;for(uint n;n<36u;n++){ivec2 t=y+ivec2(int(n)%6,int(n)/6);vec4 w=texelFetch(m_h,ivec2(m_1y.xy)+t,0);if(w.x==0.)continue;vec2 s=vec2(t-ivec2(i));if(dot(s,s)<=2.||t>>ivec2(m_c)!=ivec2(0))continue;vec2 c=x(vec2(1,0),r-(vec2(t)+.5)/a),e=c;vec4 z=m_20>2u?texelFetch(m_i,ivec2(m_1y.xy)+t,0):vec4(0),u=m_20>4u?texelFetch(m_j,ivec2(m_1y.xy)+t,0):vec4(0),o=m_20>6u?texelFetch(m_k,ivec2(m_1y.xy)+t,0):vec4(0);if(l01.xy+=l(w.xy,e),e=l(e,c),l01.xy+=l(w.zw,1.*e),l01.zw+=l(w.xy,-e),e=l(e,c),m_20>=3u)l01.xy+=l(z.xy,1.*e),l23.xy+=l(w.xy,e);if(l01.zw+=l(w.zw,-2.*e),m_20<3u)continue;if(e=l(e,c),l01.xy+=l(z.zw,1.*e),l01.zw+=l(z.xy,-3.*e),l23.xy+=l(w.zw,3.*e),l23.zw+=l(w.xy,-e),e=l(e,c),m_20>=5u)l01.xy+=l(u.xy,1.*e);if(l01.zw+=l(z.zw,-4.*e),l23.xy+=l(z.xy,6.*e),l23.zw+=l(w.zw,-4.*e),m_20>=5u)l45.xy+=l(w.xy,e);if(e=l(e,c),l23.xy+=l(z.zw,10.*e),l23.zw+=l(z.xy,-10.*e),m_20>=5u)l01.xy+=l(u.zw,1.*e),l01.zw+=l(u.xy,-5.*e),l45.xy+=l(w.zw,5.*e),l45.zw+=l(w.xy,-e);if(e=l(e,c),l23.zw+=l(z.zw,-20.*e),m_20>=7u)l01.xy+=l(o.xy,1.*e),l67.xy+=l(w.xy,e);if(m_20>=5u)l01.zw+=l(u.zw,-6.*e),l23.xy+=l(u.xy,15.*e),l45.xy+=l(z.xy,15.*e),l45.zw+=l(w.zw,-6.*e);if(m_20<5u)continue;if(e=l(e,c),m_20>=7u)l67.zw+=l(w.xy,-e),l67.xy+=l(w.zw,7.*e),l01.zw+=l(o.xy,-7.*e),l01.xy+=l(o.zw,1.*e);if(l45.zw+=l(z.xy,-21.*e),l45.xy+=l(z.zw,35.*e),l23.zw+=l(u.xy,-35.*e),l23.xy+=l(u.zw,21.*e),e=l(e,c),m_20>=7u)l67.zw+=l(w.zw,-8.*e),l67.xy+=l(z.xy,28.*e),l23.xy+=l(o.xy,28.*e),l01.zw+=l(o.zw,-8.*e);if(l45.zw+=l(z.zw,-56.*e),l45.xy+=l(u.xy,70.*e),l23.zw+=l(u.zw,-56.*e),e=l(e,c),m_20>=7u)l67.zw+=l(z.xy,-36.*e),l67.xy+=l(z.zw,84.*e),l23.zw+=l(o.xy,-84.*e),l23.xy+=l(o.zw,36.*e);if(l45.zw+=l(u.xy,-126.*e),l45.xy+=l(u.zw,126.*e),e=l(e,c),m_20>=7u)l67.zw+=l(z.zw,-120.*e),l67.xy+=l(u.xy,210.*e),l45.xy+=l(o.xy,210.*e),l23.zw+=l(o.zw,-120.*e);if(l45.zw+=l(u.zw,-252.*e),m_20<7u)continue;e=l(e,c),l67.zw+=l(u.xy,-330.*e),l67.xy+=l(u.zw,462.*e),l45.zw+=l(o.xy,-462.*e),l45.xy+=l(o.zw,330.*e),e=l(e,c),l67.zw+=l(u.zw,-792.*e),l67.xy+=l(o.xy,924.*e),l45.zw+=l(o.zw,-792.*e),e=l(e,c),l67.zw+=l(o.xy,-1716.*e),l67.xy+=l(o.zw,1716.*e),e=l(e,c),l67.zw+=l(o.zw,-3432.*e);}}`,z6=`#version 300 es
precision mediump int;
precision highp float;

uniform uvec2 m_d;

in vec2 position; 
in uvec4 m_e; 
in uvec4 m_f; 
in uint m_g; 

flat out uvec4 m_1y;
flat out uvec4 m_1z;
flat out uint m_20;

void main() {
  m_1y = m_e;
  m_1z = m_f;
  m_20 = m_g;

  
  vec2 posPx = (position + 1.f) * vec2(m_e.zw) * .5f + vec2(m_e.xy);
  gl_Position = vec4(posPx / vec2(m_d) * 2.f - 1.f, 0.f, 1.f);
}`,D6=Se(((t,e)=>{const s=Zo(t,z6,P6),n=Math.max(...e.items.map((({depth:h})=>h))),i=[];e.items.forEach((({order:h,depth:g,multipolesSlot:f})=>{const m={};for(let y=n-1;y>=2;y--)m[y]=f[y];i.push({order:h,depth:g,localExpansionsSlot:m})}));const r=[];for(let h=n-1;h>=1;h--){r[h]=[];const[g,f]=h===1?[1,1]:e.texture.multipoles(h,0).size;for(let m=0;m<4;m++)r[h][m]=ni(t,{size:[g,f],data:new Float32Array(4*g*f),type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F})}const o=r.map(((h,g)=>{const f=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,f),h.forEach(((m,y)=>{t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+y,t.TEXTURE_2D,m.handle,0)})),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1,t.COLOR_ATTACHMENT2,t.COLOR_ATTACHMENT3]),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&console.error(`FBO incomplete for level ${g}`),f})),a=Ha(t,s,{m_c:2,m_d:[0,0]}),l=[];for(let h=n-1;h>=2;h--){l[h]=t.createVertexArray(),t.bindVertexArray(l[h]);const g=t.getAttribLocation(s,"position");t.enableVertexAttribArray(g),Qe(t,ao),t.vertexAttribPointer(g,2,t.FLOAT,!1,0,0);const f=t.getAttribLocation(s,"m_e");t.enableVertexAttribArray(f);const m=i.map((({localExpansionsSlot:v})=>v[h])).map((({x:v,y:b,w:S,h:A})=>[v,b,S,A])).flat();Qe(t,new Uint32Array(m)),t.vertexAttribIPointer(f,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(f,1);const y=t.getAttribLocation(s,"m_f");t.enableVertexAttribArray(y);const p=i.map((({localExpansionsSlot:v})=>h>=3?v[h-1]:Od())).map((({x:v,y:b,w:S,h:A})=>[v,b,S,A])).flat();Qe(t,new Uint32Array(p)),t.vertexAttribIPointer(y,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(y,1);const x=t.getAttribLocation(s,"m_g");t.enableVertexAttribArray(x),Qe(t,new Uint32Array(e.items.map((v=>v.order)))),t.vertexAttribIPointer(x,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(x,1)}function u(){t.useProgram(s);for(let h=2;h<n;h++){t.bindVertexArray(l[h]);const g=r[h-1],f=r[h];t.viewport(0,0,...f[0].size),t.bindFramebuffer(t.FRAMEBUFFER,o[h]),Ko(t,a,{m_c:h,m_h:e.texture.multipoles(h,0).handle,m_i:e.texture.multipoles(h,1).handle,m_j:e.texture.multipoles(h,2).handle,m_k:e.texture.multipoles(h,3).handle,m_l:g[0].handle,m_m:g[1].handle,m_n:g[2].handle,m_o:g[3].handle,m_d:f[0].size}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}}return Se(u,"u"),{step:u,outputs:{items:i,texture:{localExpansions:(h,g)=>r[h]&&r[h][g]}},destroy:()=>{o.forEach((h=>t.deleteFramebuffer(h))),r.forEach((h=>h.forEach((({handle:g})=>t.deleteTexture(g))))),l.forEach((h=>t.deleteVertexArray(h)))}}}),"Ie"),O6=`#version 300 es
precision highp float;precision highp int;vec2 l(vec2 l,vec2 i){return vec2(l.x*i.x-l.y*i.y,l.x*i.y+l.y*i.x);}vec2 l(vec2 i,vec4 l){return(i-l.xy)/l.zw;}uniform highp sampler2D m_13,m_1n,m_7;uniform highp usampler2D m_18,m_19;uniform uint m_c;uniform highp sampler2D m_1s,m_1t,m_1u,m_1v;flat in uvec4 m_2g,m_2h,m_2b,m_26,m_29,m_28;flat in uint m_27,m_20;layout(location=0)out vec4 m01;layout(location=1)out vec4 m23;layout(location=2)out vec4 m45;layout(location=3)out vec4 m67;void main(){float s=float(1u<<m_c);uvec2 i=uvec2(gl_FragCoord.xy)-m_2g.xy;vec2 v=(vec2(i)+.5)/s;if(m_c==m_27-1u){vec4 e=texelFetch(m_7,ivec2(m_26.xy),0);uvec2 s=texelFetch(m_19,ivec2(m_28.xy+i),0).xy;for(uint t=s.x;t<s.y;t++){uint o=texelFetch(m_18,ivec2(m_29.xy)+ivec2(t%m_29.z,t/m_29.z),0).x;ivec2 c=ivec2(m_2b.xy)+ivec2(o%m_2b.w,o/m_2b.w);vec2 u=l(texelFetch(m_13,c,0).xy,e)-v;float x=texelFetch(m_1n,c,0).x;vec2 i=vec2(x,0.);if(m01.xy+=i,i=l(i,u),m01.zw+=i,m_20<3u)continue;if(i=l(i,u),m23.xy+=i,i=l(i,u),m23.zw+=i,m_20<5u)continue;if(i=l(i,u),m45.xy+=i,i=l(i,u),m45.zw+=i,m_20<7u)continue;i=l(i,u),m67.xy+=i,i=l(i,u),m67.zw+=i;}}else for(uint y;y<4u;++y){uvec2 x=2u*i+uvec2(y&1u,y>>1u);vec2 u=(vec2(x)+.5)/s/2.-v,e=vec2(1,0);vec4 t=texelFetch(m_1s,ivec2(m_2h.xy+x),0);if(m01.xy+=l(t.xy,1.*e),e=vec2(1,0),m01.zw+=l(t.zw,1.*e),e=l(e,u),m01.zw+=l(t.xy,1.*e),m_20<3u)continue;vec4 o=texelFetch(m_1t,ivec2(m_2h.xy+x),0);if(e=vec2(1,0),m23.xy+=l(o.xy,1.*e),e=l(e,u),m23.xy+=l(t.zw,2.*e),e=l(e,u),m23.xy+=l(t.xy,1.*e),e=vec2(1,0),m23.zw+=l(o.zw,1.*e),e=l(e,u),m23.zw+=l(o.xy,3.*e),e=l(e,u),m23.zw+=l(t.zw,3.*e),e=l(e,u),m23.zw+=l(t.xy,1.*e),m_20<5u)continue;vec4 c=texelFetch(m_1u,ivec2(m_2h.xy+x),0);if(e=vec2(1,0),m45.xy+=l(c.xy,1.*e),e=l(e,u),m45.xy+=l(o.zw,4.*e),e=l(e,u),m45.xy+=l(o.xy,6.*e),e=l(e,u),m45.xy+=l(t.zw,4.*e),e=l(e,u),m45.xy+=l(t.xy,1.*e),e=vec2(1,0),m45.zw+=l(c.zw,1.*e),e=l(e,u),m45.zw+=l(c.xy,5.*e),e=l(e,u),m45.zw+=l(o.zw,10.*e),e=l(e,u),m45.zw+=l(o.xy,10.*e),e=l(e,u),m45.zw+=l(t.zw,5.*e),e=l(e,u),m45.zw+=l(t.xy,1.*e),m_20<7u)continue;vec4 m=texelFetch(m_1v,ivec2(m_2h.xy+x),0);e=vec2(1,0),m67.xy+=l(m.xy,1.*e),e=l(e,u),m67.xy+=l(c.zw,6.*e),e=l(e,u),m67.xy+=l(c.xy,15.*e),e=l(e,u),m67.xy+=l(o.zw,20.*e),e=l(e,u),m67.xy+=l(o.xy,15.*e),e=l(e,u),m67.xy+=l(t.zw,6.*e),e=l(e,u),m67.xy+=l(t.xy,1.*e),e=vec2(1,0),m67.zw+=l(m.zw,1.*e),e=l(e,u),m67.zw+=l(m.xy,7.*e),e=l(e,u),m67.zw+=l(c.zw,21.*e),e=l(e,u),m67.zw+=l(c.xy,35.*e),e=l(e,u),m67.zw+=l(o.zw,35.*e),e=l(e,u),m67.zw+=l(o.xy,21.*e),e=l(e,u),m67.zw+=l(t.zw,7.*e),e=l(e,u),m67.zw+=l(t.xy,1.*e);}}`,B6=`#version 300 es
precision highp int;
precision highp float;

uniform uvec2 m_1p;

in vec2 position; 
in uvec4 m_1q; 
in uvec4 m_1r; 
in uvec4 m_1c; 

in uvec4 m_s; 
in uvec4 m_1h; 
in uvec4 m_1i; 
in uint m_t; 
in uint m_g; 

flat out uvec4 m_2g;
flat out uvec4 m_2h;
flat out uvec4 m_2b;

flat out uvec4 m_26;
flat out uvec4 m_29;
flat out uvec4 m_28;
flat out uint m_27;
flat out uint m_20;

void main() {
  m_2g = m_1q;
  m_2h = m_1r;
  m_2b = m_1c;
  
  m_26 = m_s;
  m_29 = m_1h;
  m_28 = m_1i;
  m_27 = m_t;
  m_20 = m_g;

  
  vec2 posPx = (position + 1.f) * vec2(m_1q.zw) * .5f + vec2(m_1q.xy);
  gl_Position = vec4(posPx / vec2(m_1p) * 2.f - 1.f, 0.f, 1.f);
}`,U6=Se(((t,e)=>{const s=Zo(t,B6,O6),n=Math.max(...e.items.map((({depth:h})=>h))),i=[];e.items.forEach((({order:h,depth:g})=>{const f={};for(let m=n-1;m>=2;m--)f[m]=m>=g?Od():{x:0,y:0,w:1<<m,h:1<<m};i.push({order:h,depth:g,multipolesSlot:f})}));const r=[];for(let h=n;h>=2;h--){r[h]=[];const{w:g,h:f}=du(i.map((({multipolesSlot:m})=>m[h]||Od())));for(let m=0;m<4;m++)r[h][m]=ni(t,{size:[g,f],data:new Float32Array(4*g*f),type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F})}const o=r.map(((h,g)=>{const f=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,f),h.forEach(((m,y)=>{t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+y,t.TEXTURE_2D,m.handle,0)})),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1,t.COLOR_ATTACHMENT2,t.COLOR_ATTACHMENT3]),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&console.error(`FBO incomplete for level ${g}`),f})),a=Ha(t,s,{m_c:n-1,m_13:e.texture.particlesPositions().handle,m_1n:e.texture.particlesCharges().handle,m_7:e.texture.spatialBoundaries().handle,m_18:e.texture.spatialKeys().handle,m_19:e.texture.gridCells().handle,m_1o:null,m_1p:[0,0]}),l=[];for(let h=n-1;h>=2;h--){l[h]=t.createVertexArray(),t.bindVertexArray(l[h]);const g=t.getAttribLocation(s,"position");t.enableVertexAttribArray(g),Qe(t,ao),t.vertexAttribPointer(g,2,t.FLOAT,!1,0,0);const f=t.getAttribLocation(s,"m_1q");t.enableVertexAttribArray(f);const m=i.map((({multipolesSlot:j})=>j[h])).map((({x:j,y:V,w:Z,h:at})=>[j,V,Z,at])).flat();Qe(t,new Uint32Array(m)),t.vertexAttribIPointer(f,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(f,1);const y=t.getAttribLocation(s,"m_1r");t.enableVertexAttribArray(y);const p=i.map((({multipolesSlot:j,depth:V})=>h>=V-1?Od():j[h+1])).map((({x:j,y:V,w:Z,h:at})=>[j,V,Z,at])).flat();Qe(t,new Uint32Array(p)),t.vertexAttribIPointer(y,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(y,1);const x=t.getAttribLocation(s,"m_1c");t.enableVertexAttribArray(x);const v=e.items.map((j=>j.particlesPositionsSlot)).map((({x:j,y:V,w:Z,h:at})=>[j,V,Z,at])).flat();Qe(t,new Uint32Array(v)),t.vertexAttribIPointer(x,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(x,1);const b=t.getAttribLocation(s,"m_s");t.enableVertexAttribArray(b);const S=e.items.map((j=>j.spatialBoundariesSlot)).map((({x:j,y:V,w:Z,h:at})=>[j,V,Z,at])).flat();Qe(t,new Uint32Array(S)),t.vertexAttribIPointer(b,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(b,1);const A=t.getAttribLocation(s,"m_1h");t.enableVertexAttribArray(A);const w=e.items.map((j=>j.spatialKeysSlot)).map((({x:j,y:V,w:Z,h:at})=>[j,V,Z,at])).flat();Qe(t,new Uint32Array(w)),t.vertexAttribIPointer(A,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(A,1);const L=t.getAttribLocation(s,"m_1i");t.enableVertexAttribArray(L);const k=e.items.map((j=>j.gridCellsSlot)).map((({x:j,y:V,w:Z,h:at})=>[j,V,Z,at])).flat();Qe(t,new Uint32Array(k)),t.vertexAttribIPointer(L,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(L,1);const F=t.getAttribLocation(s,"m_t");t.enableVertexAttribArray(F),Qe(t,new Uint32Array(e.items.map((j=>j.depth)))),t.vertexAttribIPointer(F,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(F,1);const O=t.getAttribLocation(s,"m_g");t.enableVertexAttribArray(O),Qe(t,new Uint32Array(e.items.map((j=>j.order)))),t.vertexAttribIPointer(O,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(O,1)}function u(){t.useProgram(s);for(let h=n-1;h>=2;h--){t.bindVertexArray(l[h]);const g=r[h+1],f=r[h][0].size;t.viewport(0,0,...f),t.bindFramebuffer(t.FRAMEBUFFER,o[h]),Ko(t,a,{m_13:e.texture.particlesPositions().handle,m_7:e.texture.spatialBoundaries().handle,m_1n:e.texture.particlesCharges().handle,m_18:e.texture.spatialKeys().handle,m_19:e.texture.gridCells().handle,m_c:h,m_1s:g[0].handle,m_1t:g[1].handle,m_1u:g[2].handle,m_1v:g[3].handle,m_1p:f}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}}return Se(u,"u"),{step:u,outputs:{items:i,texture:{multipoles:(h,g)=>r[h]&&r[h][g]}},destroy:()=>{o.forEach((h=>t.deleteFramebuffer(h))),r.forEach((h=>h.forEach((({handle:g})=>t.deleteTexture(g))))),l.forEach((h=>t.deleteVertexArray(h)))}}}),"Re"),G6=`#version 300 es
precision highp int;uint u(uint u){return u&=65535u,u=(u|u<<8)&16711935u,u=(u|u<<4)&252645135u,u=(u|u<<2)&858993459u,u=(u|u<<1)&1431655765u,u;}uint u(uvec2 i){return u(i.y)<<1|u(i.x);}uniform highp usampler2D m_18;flat in uvec4 m_28,m_29;flat in uint m_22;out uvec2 outColor;uint i(uint e){uint u,i=m_22;for(;u<i;){uint t=u+i>>1,l=texelFetch(m_18,ivec2(m_29.xy)+ivec2(t%m_29.z,t/m_29.z),0).y;l<e?u=t+1u:i=t;}return u;}void main(){uvec2 t=uvec2(gl_FragCoord.xy);uint e=u((t-m_28.xy)%m_28.z);outColor=uvec2(i(e),i(e+1u));}`,V6=`#version 300 es
precision highp int;
precision mediump float;

uniform uvec2 m_1m;

in vec2 position; 
in uvec4 m_1i; 
in uvec4 m_1h; 
in uint m_5; 

flat out uvec4 m_28;
flat out uvec4 m_29;
flat out uint m_22;

void main() {
  m_28 = m_1i;
  m_29 = m_1h;
  m_22 = m_5;

  
  vec2 posPx = (position + 1.f) * vec2(m_1i.zw) * .5f + vec2(m_1i.xy);
  gl_Position = vec4(posPx / vec2(m_1m) * 2.f - 1.f, 0.f, 1.f);
}`,j6=Se(((t,e)=>{const s=Zo(t,V6,G6),n=e.items.map((({depth:v})=>{const b=1<<v-1;return{x:0,y:0,w:b,h:b}})),i=du(n.slice()),r=ni(t,{size:[i.w,i.h],data:new Uint32Array(2*i.w*i.h),type:t.UNSIGNED_INT,format:t.RG_INTEGER,internalFormat:t.RG32UI}),o=Wo(t,r.handle),a=Ha(t,s,{m_18:e.texture.spatialKeys().handle,m_1m:r.size}),l=t.createVertexArray();t.bindVertexArray(l);const u=t.getAttribLocation(s,"position");t.enableVertexAttribArray(u),Qe(t,ao),t.vertexAttribPointer(u,2,t.FLOAT,!1,0,0);const h=t.getAttribLocation(s,"m_1i");t.enableVertexAttribArray(h);const g=n.map((({x:v,y:b,w:S,h:A})=>[v,b,S,A])).flat();Qe(t,new Uint32Array(g)),t.vertexAttribIPointer(h,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(h,1);const f=t.getAttribLocation(s,"m_1h");t.enableVertexAttribArray(f);const m=e.items.map((({spatialKeysSlot:v})=>v)).map((({x:v,y:b,w:S,h:A})=>[v,b,S,A])).flat();Qe(t,new Uint32Array(m)),t.vertexAttribIPointer(f,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(f,1);const y=t.getAttribLocation(s,"m_5");function p(){t.viewport(0,0,r.size[0],r.size[1]),t.useProgram(s),t.bindVertexArray(l),t.bindFramebuffer(t.FRAMEBUFFER,o),Ko(t,a,{m_18:e.texture.spatialKeys().handle}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}t.enableVertexAttribArray(y),Qe(t,new Uint32Array(e.items.map((({N:v})=>v)))),t.vertexAttribIPointer(y,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(y,1),Se(p,"d");const x=Se((()=>{t.deleteFramebuffer(o),t.deleteTexture(r.handle)}),"N");return{step:p,outputs:{items:e.items.map((({N:v,depth:b},S)=>({N:v,depth:b,spatialBoundariesSlot:e.items[S].spatialBoundariesSlot,spatialKeysSlot:e.items[S].spatialKeysSlot,gridCellsSlot:n[S]}))),texture:{spatialBoundaries:e.texture.spatialBoundaries,spatialKeys:e.texture.spatialKeys,gridCells:()=>r}},destroy:x}}),"Me"),H6=`#version 300 es
precision highp int;uniform uint m_0,m_1;uniform highp usampler2D m_2;flat in uvec4 m_1w;flat in uint m_1x;out uvec2 outColor;uvec2 e(uvec2 e,uvec2 u,bool y){uvec2 t=e.x<4294967295u?texelFetch(m_2,ivec2(m_1w.xy)+ivec2(e.x%m_1w.z,e.x/m_1w.z),0).xy:e,o=u.x<4294967295u?texelFetch(m_2,ivec2(m_1w.xy)+ivec2(u.x%m_1w.z,u.x/m_1w.z),0).xy:u;if(y)return t.y<o.y?t:o;return t.y>o.y?t:o;}void main(){uvec2 u=uvec2(gl_FragCoord.xy);if(m_1x==1u){outColor=texelFetch(m_2,ivec2(u),0).xy;return;}uint t=uint(u.x-m_1w.x+m_1w.z*(u.y-m_1w.y)),s=texelFetch(m_2,ivec2(u),0).x,o=t^1u<<m_0-m_1,l=texelFetch(m_2,ivec2(m_1w.xy)+ivec2(o%m_1w.z,o/m_1w.z),0).x;bool y=(t>>m_0-m_1&1u)==0u;(t>>m_0&2u)==2u&&(y=!y),outColor=e(uvec2(t,s),uvec2(o,l),y);}`,$6=`#version 300 es
precision highp int;
precision highp float;

uniform uvec2 m_3;
uniform uint m_0;

in vec2 position; 
in uvec4 m_4; 
in uint m_5; 

flat out uvec4 m_1w;
flat out uint m_1x;

void main() {
  m_1w = m_4;
  m_1x = 0u;

  
  uint minN = 1u << m_0;
  if(minN >= m_5) {
    if(minN >= 2u * m_5) {
      gl_Position = vec4(0.f, 0.f, 0.f, 1.f);
      return;
    }
    
    m_1x = 1u;
  }

  
  vec2 posPx = (position + 1.f) * vec2(m_4.zw) * .5f + vec2(m_4.xy);
  gl_Position = vec4(posPx / vec2(m_3) * 2.f - 1.f, 0.f, 1.f);
}`,q6=Se((t=>{for(let e=0;e<t.length/2;e++)t[2*e]=e,t[2*e+1]=4294967295;return t}),"je"),sM=Se((t=>1<<Math.ceil(Math.log2(t))),"le"),Y6=Se((t=>{if(t<2)return[1,1];const e=32-Math.clz32(t-1);return[1<<(e>>>1)+(1&e),1<<(e>>>1)]}),"ke"),nM=Se(((t,[e,s],n=q6(new Uint32Array(2*e*s)))=>ni(t,{size:[e,s],data:n,type:t.UNSIGNED_INT,format:t.RG_INTEGER,internalFormat:t.RG32UI})),"fe"),cA=Se(((t,[e,s],n=new Uint32Array(4*e*s))=>ni(t,{size:[e,s],data:n,type:t.UNSIGNED_INT,format:t.RGBA_INTEGER,internalFormat:t.RGBA32UI})),"xe"),W6=Se((t=>Math.max(0,Math.ceil(Math.log2(t)))),"He"),X6=Se((t=>t*(t+1)/2),"Ke"),Z6=Se(((t,e)=>{const s=Zo(t,$6,H6),n=e.texture.spatialKeys(),i=nM(t,n.size),r=Yo(i,n),o=Wo(t,n.handle),a=Wo(t,i.handle),l=Yo(o,a),u=Ha(t,s,{m_0:0,m_1:0,m_2:n.handle,m_3:n.size}),h=e.items.map((({N:w})=>W6(w))).reduce(((w,L)=>Math.max(w,L)),0),g=t.createVertexArray();t.bindVertexArray(g);const f=t.getAttribLocation(s,"position");t.enableVertexAttribArray(f),Qe(t,ao),t.vertexAttribPointer(f,2,t.FLOAT,!1,0,0);const m=t.getAttribLocation(s,"m_4");t.enableVertexAttribArray(m);const y=e.items.map((({spatialKeysSlot:w})=>w)).map((({x:w,y:L,w:k,h:F})=>[w,L,k,F])).flat();Qe(t,new Uint32Array(y)),t.vertexAttribIPointer(m,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(m,1);const p=t.getAttribLocation(s,"m_5");t.enableVertexAttribArray(p),Qe(t,new Uint32Array(e.items.map((({N:w})=>w)))),t.vertexAttribIPointer(p,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(p,1);let x=0,v=0,b=n;function S(w=X6(h)){t.useProgram(s),t.bindVertexArray(g),t.viewport(0,0,i.size[0],i.size[1]);const L=e.texture.spatialKeys();b!==L&&(l(),r(),b=L);for(let k=0;k<w;k++){t.bindFramebuffer(t.FRAMEBUFFER,l()[0]);const[F,O]=r();b=O,Ko(t,u,{m_0:x,m_1:v,m_2:F.handle}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length),v=(v+1)%(x+1),v===0&&(x=(x+1)%h)}}Se(S,"E");const A=Se((()=>{t.deleteFramebuffer(o),t.deleteFramebuffer(a),t.deleteTexture(i.handle)}),"P");return{step:S,outputs:{items:e.items,texture:{spatialKeys:()=>b}},destroy:A}}),"$e"),K6=`#version 300 es
precision highp int;uniform uint m_0,m_1;uniform highp usampler2D m_2,m_1l;flat in uvec4 m_1w,m_2a;flat in uint m_1x;layout(location=0)out uvec2 outKeys;layout(location=1)out uvec4 outIntervals;uint n(uint n,uint e,uint u,uint i){uint t=n<u?e+n:i-u+n;return texelFetch(m_2,ivec2(m_1w.xy)+ivec2(t%m_1w.z,t/m_1w.z),0).y;}void main(){ivec2 o=ivec2(gl_FragCoord.xy);if(m_1x==1u){outKeys=texelFetch(m_2,ivec2(o),0).xy;return;}uint i=m_2a.z*(uint(o.y)-m_2a.y)+(uint(o.x)-m_2a.x);uvec4 u;if(m_1==0u)u=uvec4(i&4294967294u,1u,(i&4294967294u)+1u,1u)<<m_0;else{uint n=i>>1u,t=m_2a.z==m_2a.w?m_2a.z:m_2a.z>>1u;u=texelFetch(m_1l,ivec2(m_2a.xy)+ivec2(n%t,n/t),0);}uint e=u.y+u.w>>1u,t=u.y<e?0u:u.y-e,y=u.y<e?u.y:e;for(;t<y;){uint i=t+(y-t>>1u);n(i,u.x,u.y,u.z)<n(i+e,u.x,u.y,u.z)?t=i+1u:y=i;}uvec4 l=(i&1u)==(i>>m_1+1u&1u)?uvec4(u.x,t,u.z+u.w-e+t,e-t):uvec4(u.x+t,u.y-t,u.z,u.w-e+t);if(m_0==m_1){uint n=l.y*l.x+l.w*l.z;outKeys=texelFetch(m_2,ivec2(m_1w.xy)+ivec2(n%m_1w.z,n/m_1w.z),0).xy;}else outIntervals=l;}`,Q6=`#version 300 es
precision highp int;
precision highp float;

uniform uvec2 m_3;
uniform uint m_0;
uniform uint m_1;

in vec2 position; 
in uvec4 m_4; 
in uint m_5; 

flat out uvec4 m_1w;
flat out uvec4 m_2a;
flat out uint m_1x;

void main() {
  
  uint minN = 1u << m_0;
  if(minN >= m_5) {
    if(minN >= 2u * m_5) {
      gl_Position = vec4(0.f, 0.f, 0.f, 1.f);
      return;
    }
    
    m_1x = 1u;
  }

  
  uint delta = m_0 - m_1;
  uvec4 intervalSlot = m_4;
  if(intervalSlot.z == intervalSlot.w) {
    
    intervalSlot.z = intervalSlot.z >> (delta >> 1u);
    intervalSlot.w = intervalSlot.w >> ((delta + 1u) >> 1u);
  } else {
    
    intervalSlot.z = intervalSlot.z >> ((delta + 1u) >> 1u);
    intervalSlot.w = intervalSlot.w >> (delta >> 1u);
  }
  m_1w = m_4;
  m_2a = intervalSlot;

  
  vec2 posPx = (position + 1.f) * vec2(intervalSlot.zw) * .5f + vec2(intervalSlot.xy);
  gl_Position = vec4(posPx / vec2(m_3) * 2.f - 1.f, 0.f, 1.f);
}`,J6=Se((t=>Math.max(0,Math.ceil(Math.log2(t)))),"qe"),bg=Se(((t,e,s)=>{const n=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.handle,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT1,t.TEXTURE_2D,s.handle,0),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1]),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&console.error("FBO incomplete"),{handle:n,ca0:e,ca1:s}}),"te"),tH=Se(((t,e)=>{const s=Zo(t,Q6,K6),n=t.getUniformLocation(s,"m_0"),i=t.getUniformLocation(s,"m_1"),r=t.getUniformLocation(s,"m_2"),o=t.getUniformLocation(s,"m_1l"),a=t.getUniformLocation(s,"m_3"),l=e.texture.spatialKeys(),u=nM(t,l.size),h=cA(t,l.size),g=cA(t,l.size),f=Yo(bg(t,l,g),bg(t,l,h)),m=Yo(bg(t,u,g),bg(t,u,h)),y=e.items.map((({N:L})=>J6(sM(L)))).reduce(((L,k)=>Math.max(L,k)),0),p=t.createVertexArray();t.bindVertexArray(p);const x=t.getAttribLocation(s,"position");t.enableVertexAttribArray(x),Qe(t,ao),t.vertexAttribPointer(x,2,t.FLOAT,!1,0,0);const v=t.getAttribLocation(s,"m_4");t.enableVertexAttribArray(v);const b=e.items.map((({spatialKeysSlot:L})=>L)).map((({x:L,y:k,w:F,h:O})=>[L,k,F,O])).flat();Qe(t,new Uint32Array(b)),t.vertexAttribIPointer(v,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(v,1);const S=t.getAttribLocation(s,"m_5");function A(){t.bindVertexArray(p),t.viewport(0,0,...l.size),t.useProgram(s),t.uniform2ui(a,...l.size),t.uniform1i(r,0),t.uniform1i(o,1);for(let L=0;L<y;L++){t.activeTexture(t.TEXTURE0);const k=(1&L?u:l).handle;t.bindTexture(t.TEXTURE_2D,k),t.uniform1ui(n,L);for(let F=0;F<=L;F++){const[O,j]=1&L?f():m();t.bindFramebuffer(t.FRAMEBUFFER,O.handle),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,j.ca1.handle),t.uniform1ui(i,F),L===F?t.drawBuffers([t.COLOR_ATTACHMENT0,t.NONE]):F<2&&t.drawBuffers([t.NONE,t.COLOR_ATTACHMENT1]),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}}}t.enableVertexAttribArray(S),Qe(t,new Uint32Array(e.items.map((({N:L})=>L)))),t.vertexAttribIPointer(S,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(S,1),Se(A,"P");const w=Se((()=>{t.deleteTexture(u.handle),t.deleteTexture(g.handle),t.deleteTexture(h.handle),m().forEach((L=>t.deleteFramebuffer(L.handle))),f().forEach((L=>t.deleteFramebuffer(L.handle)))}),"h");return{step:A,outputs:{items:e.items,texture:{spatialKeys:()=>y-1&1?l:u}},destroy:w}}),"Ye"),eH=`#version 300 es
precision highp float;precision highp int;uint u(uint u){return u&=65535u,u=(u|u<<8)&16711935u,u=(u|u<<4)&252645135u,u=(u|u<<2)&858993459u,u=(u|u<<1)&1431655765u,u;}uint u(uvec2 t){return u(t.y)<<1|u(t.x);}vec2 u(vec2 t,vec4 u){return(t-u.xy)/u.zw;}uniform highp sampler2D m_b,m_7;flat in uvec4 m_24,m_25,m_26;flat in uint m_22,m_27;out uvec2 outColor;void main(){uvec2 o=uvec2(gl_FragCoord.xy);uint t=o.x-m_24.x+(o.y-m_24.y)*m_24.z;if(t>=m_22){outColor=uvec2(t,4294967295u);return;}uvec2 e=uvec2(t%m_25.z,t/m_25.z)+m_25.xy;vec4 i=texelFetch(m_7,ivec2(m_26.xy),0);vec2 n=u(texelFetch(m_b,ivec2(e),0).xy,i);outColor=uvec2(t,u(uvec2(float(1u<<m_27-1u)*n)));}`,sH=`#version 300 es
precision highp int;
precision highp float;

uniform uvec2 m_p;

in vec2 position; 
in uvec4 m_q; 
in uvec4 m_r; 
in uvec4 m_s; 
in uint m_5; 
in uint m_t; 

flat out uvec4 m_24;
flat out uvec4 m_25;
flat out uvec4 m_26;
flat out uint m_22;
flat out uint m_27;

void main() {
  m_24 = m_q;
  m_25 = m_r;
  m_26 = m_s;
  m_22 = m_5;
  m_27 = m_t;

  
  vec2 posPx = (position + 1.f) * vec2(m_q.zw) * .5f + vec2(m_q.xy);
  gl_Position = vec4(posPx / vec2(m_p) * 2.f - 1.f, 0.f, 1.f);
}`,nH=Se(((t,e)=>{const s=Zo(t,sH,eH),n=e.items.map((({N:w})=>{const[L,k]=Y6(sM(w));return{x:0,y:0,w:L,h:k}})),i=du(n.slice()),r=new Uint32Array(2*i.w*i.h);n.forEach((w=>{for(let L=0;L<w.w*w.h;L++){const k=2*Pl(L,i.w,w);r[k]=L,r[k+1]=4294967295}}));const o=ni(t,{size:[i.w,i.h],data:r,type:t.UNSIGNED_INT,format:t.RG_INTEGER,internalFormat:t.RG32UI}),a=Wo(t,o.handle),l=Ha(t,s,{m_b:e.texture.points().handle,m_7:e.texture.spatialBoundaries().handle,m_p:o.size}),u=t.createVertexArray();t.bindVertexArray(u);const h=t.getAttribLocation(s,"position");t.enableVertexAttribArray(h),Qe(t,ao),t.vertexAttribPointer(h,2,t.FLOAT,!1,0,0);const g=t.getAttribLocation(s,"m_q");t.enableVertexAttribArray(g);const f=n.map((({x:w,y:L,w:k,h:F})=>[w,L,k,F])).flat();Qe(t,new Uint32Array(f)),t.vertexAttribIPointer(g,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(g,1);const m=t.getAttribLocation(s,"m_r");t.enableVertexAttribArray(m);const y=e.items.map((({pointsSlot:w})=>w)).map((({x:w,y:L,w:k,h:F})=>[w,L,k,F])).flat();Qe(t,new Uint32Array(y)),t.vertexAttribIPointer(m,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(m,1);const p=t.getAttribLocation(s,"m_s");t.enableVertexAttribArray(p);const x=e.items.map((({spatialBoundariesSlot:w})=>w)).map((({x:w,y:L,w:k,h:F})=>[w,L,k,F])).flat();Qe(t,new Uint32Array(x)),t.vertexAttribIPointer(p,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(p,1);const v=t.getAttribLocation(s,"m_5");t.enableVertexAttribArray(v),Qe(t,new Uint32Array(e.items.map((({N:w})=>w)))),t.vertexAttribIPointer(v,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(v,1);const b=t.getAttribLocation(s,"m_t");function S(){t.viewport(0,0,o.size[0],o.size[1]),t.useProgram(s),t.bindVertexArray(u),t.bindFramebuffer(t.FRAMEBUFFER,a),Ko(t,l,{m_b:e.texture.points().handle,m_7:e.texture.spatialBoundaries().handle}),t.drawArraysInstanced(t.TRIANGLES,0,6,n.length)}t.enableVertexAttribArray(b),Qe(t,new Uint32Array(e.items.map((({depth:w})=>w)))),t.vertexAttribIPointer(b,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(b,1),Se(S,"x");const A=Se((()=>{t.deleteFramebuffer(a),t.deleteTexture(o.handle)}),"E");return{step:S,outputs:{items:e.items.map(((w,L)=>({N:e.items[L].N,spatialKeysSlot:n[L]}))),texture:{spatialKeys:()=>o}},destroy:A}}),"Ze"),iH=`#version 300 es
precision mediump float;uniform mediump sampler2D m_b,m_7;uniform uint m_8;flat in uvec4 m_21;flat in uint m_22,m_23;out vec4 outColor;void main(){uvec2 o=uvec2(gl_FragCoord.xy);uint u=o.x-m_21.x+(o.y-m_21.y)*m_21.z;if(outColor=vec4(1e9,1e9,-1e9,-1e9),u>=m_22)return;if(m_8>=m_23){outColor=texelFetch(m_7,ivec2(o),0);return;}if(m_8==0u)outColor.xy=outColor.zw=texelFetch(m_b,ivec2(o),0).xy;else for(uint u;u<4u;u++){uvec2 e=(o-m_21.xy<<1u)+uvec2(u&1u,u>>1u)+m_21.xy;vec4 t=texelFetch(m_7,ivec2(e),0);outColor=vec4(min(outColor.xy,t.xy),max(outColor.zw,t.zw));}if(m_8==m_23-1u){vec2 o=outColor.zw-outColor.xy;outColor=vec4(outColor.xy-1.,vec2(max(o.x,o.y))+2.);}}`,rH=`#version 300 es
precision mediump int;
precision mediump float;

uniform uvec2 m_6;
uniform uint m_8;

in vec2 position; 
in uvec4 m_9; 
in uint m_5; 
in uint m_a; 

flat out uvec4 m_21;
flat out uint m_22;
flat out uint m_23;

void main() {
  uvec4 slot = uvec4(m_9.xy, m_9.zw >> min(m_8, m_23));
  m_21 = slot;
  m_22 = m_5;
  m_23 = m_a;

  
  vec2 posPx = (position + 1.f) * vec2(slot.zw) * .5f + vec2(m_21.xy);
  gl_Position = vec4(posPx / vec2(m_6) * 2.f - 1.f, 0.f, 1.f);
}`,oH=Se((t=>Math.ceil(Math.log2(Math.sqrt(t)))+1),"tt"),aH=Se(((t,e)=>{const s=Zo(t,rH,iH),n=e.texture.points(),i=ni(t,{size:n.size,data:new Float32Array(n.data.buffer.slice(0)),type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F}),r=ni(t,{size:n.size,data:new Float32Array(n.data.buffer.slice(0)),type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F}),o=Yo(i,r),a=Wo(t,r.handle),l=Wo(t,i.handle),u=Yo(a,l),h=Ha(t,s,{m_6:n.size,m_7:i.handle,m_8:0}),g=e.items.map((({N:L})=>oH(L))),f=g.reduce(((L,k)=>Math.max(L,k)),0),m=t.createVertexArray();t.bindVertexArray(m);const y=t.getAttribLocation(s,"position");t.enableVertexAttribArray(y),Qe(t,ao),t.vertexAttribPointer(y,2,t.FLOAT,!1,0,0);const p=t.getAttribLocation(s,"m_9");t.enableVertexAttribArray(p);const x=e.items.map((({pointsSlot:L})=>L)).map((({x:L,y:k,w:F,h:O})=>[L,k,F,O])).flat();Qe(t,new Uint32Array(x)),t.vertexAttribIPointer(p,4,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(p,1);const v=t.getAttribLocation(s,"m_5");t.enableVertexAttribArray(v),Qe(t,new Uint32Array(e.items.map((({N:L})=>L)))),t.vertexAttribIPointer(v,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(v,1);const b=t.getAttribLocation(s,"m_a");t.enableVertexAttribArray(b),Qe(t,new Uint32Array(g)),t.vertexAttribIPointer(b,1,t.UNSIGNED_INT,0,0),t.vertexAttribDivisor(b,1);let S=i;function A(){t.viewport(0,0,...i.size),t.useProgram(s),t.bindVertexArray(m);for(let L=0;L<f;L++){t.bindFramebuffer(t.FRAMEBUFFER,u()[0]);const[k,F]=o();S=F,Ko(t,h,{m_b:e.texture.points().handle,m_6:e.texture.points().size,m_7:k.handle,m_8:L}),t.drawArraysInstanced(t.TRIANGLES,0,6,e.items.length)}}Se(A,"E");const w=Se((()=>{t.deleteFramebuffer(a),t.deleteFramebuffer(l),t.deleteTexture(r.handle),t.deleteTexture(i.handle)}),"P");return{step:A,outputs:{items:e.items.map((({pointsSlot:L})=>L)).map((({x:L,y:k})=>({spatialBoundariesSlot:{x:L,y:k,w:1,h:1}}))),texture:{spatialBoundaries:()=>S}},destroy:w}}),"rt"),lH=Se((t=>{let e;return()=>e||t().finally((()=>e=void 0))}),"nt"),uH=Se(((t,e)=>Math.max(.1,1-(t/Math.max(1,e-20))**7.39)),"ye"),dH=Se(((t,e=25,s=24e3)=>{const n=(s-e)/(e-1);return Math.ceil(e*n*4/(n+t))}),"ve"),gA=Se((t=>{const e=Math.max(1,Math.ceil(Math.log2(t)/2));return t>65535?e+1:e}),"_e"),fA={charge:10,edgeStrength:.5,edgeLength:30,elasticity:.9,margin:1,gravity:.01,inertia:.9,maxDisplacement:1e3,steps:200},hH=Se(((t,e)=>{let[s,n]=[0,0];const i=Se((()=>{for(let o=0;o<t;o++,s++)if(!e(s))return!0}),"i"),r=Se((o=>{i()?o(s):n=requestAnimationFrame((()=>r(o)))}),"a");return{start:lH((()=>new Promise((o=>(s=0)||r(o))))),step:i,stop:()=>cancelAnimationFrame(n)}}),"Ae"),h_=Se(((t,e,s)=>{let n=e.texture.particlesPositions();const{steps:i,batch:r,sortingMethod:o}=s,a=s.order??4,l={items:e.items.map((({N:v,particlesPositionsSlot:b})=>({N:v,pointsSlot:b}))),texture:{points:()=>n}},u=aH(t,l),h=nH(t,{items:e.items.map((({N:v},b)=>({depth:Math.max(1,s.depth??gA(v)),...l.items[b],...u.outputs.items[b]}))),texture:{...l.texture,...u.outputs.texture}}),g=(o==="ibr"?tH:Z6)(t,h.outputs),f=j6(t,{items:e.items.map((({N:v},b)=>({depth:Math.max(1,s.depth??gA(v)),...u.outputs.items[b],...g.outputs.items[b]}))),texture:{...u.outputs.texture,...g.outputs.texture}}),m=U6(t,{items:e.items.map(((v,b)=>({order:a,...v,...f.outputs.items[b]}))),texture:{particlesPositions:()=>n,particlesCharges:e.texture.particlesCharges,...f.outputs.texture}}),y=D6(t,{items:m.outputs.items,texture:{...m.outputs.texture}}),p=F6(t,{items:e.items.map(((v,b)=>({...v,...f.outputs.items[b],...y.outputs.items[b]}))),texture:{...e.texture,...f.outputs.texture,...y.outputs.texture}},s),x=e.items.reduce(((v,{N:b})=>Math.max(v,b)),0);return{...hH(r??dH(x),(v=>(n=p.outputs.texture.points(),u.step(),h.step(),g.step(),f.step(),m.step(),y.step(),p.step(uH(v,i)),v<i))),destroy:()=>{u.destroy(),h.destroy(),g.destroy(),f.destroy(),m.destroy(),y.destroy(),p.destroy()}}}),"_t"),mA=0,iM=typeof window>"u",cH=typeof performance<"u"&&performance.now?performance:Date,gH=iM?t=>{const e=cH.now(),s=Math.max(0,16-(e-mA)),n=setTimeout((()=>t(e+s)),s);return mA=e+s,n}:window.requestAnimationFrame,fH=iM?t=>clearTimeout(t):window.cancelAnimationFrame;function rM(t,e,s){for(let n=0;n<t.length;n++){const i=t[n];i.x=e[n],i.y=s[n]}}Se(rM,"defaultUpdate");var mH=Se((()=>{}),"noop"),pH=.001,c_={movementRatio:7e-8,surfaceRatio:.0025},_H=.003,yH=Se(((t,e)=>_H*t**2+(e+1)),"defaultMass"),Hy=class{constructor(t={}){this.onUpdate=Se((e=>{}),"onUpdate"),this.update=rM,this.nextTick=gH,this.cancelTick=fH,this.onEnd=mH,this.charge=10,this.maxIterations=200,this.minMovement=.1,this.edgeLength=30,this.edgeStrength=3,this.friction=.1,this.elasticity=.9,this.margin=1,this.cx=void 0,this.cy=void 0,this.gravity=.01,this.theta=.34,this.batch=void 0,this.inertia=.9,this.integrator=0,this.multilevel=!1,this.placement="none",this.placementOffset=10,this.alignSiblings=!1,this.bucketSize=void 0,this.maxDisplacement=1e3,this.siblingsMinAngle=0,this.siblingsOffset=.15,this.steps=200,this.scaling=1,this.defaultRadius=1,this.autoStop=c_,this.gpuAcceleration=!0,this.barnesHutOptimization=!0,"autoStop"in t?t.autoStop&&(typeof t.autoStop=="boolean"?t.autoStop=c_:t.autoStop={...t.autoStop,...c_}):t.steps;for(const e in t)t[e]===void 0&&e!=="order"&&e!=="depth"||(this[e]=t[e])}};Se(Hy,"Settings");var xH=Se((({nodes:t,edges:e})=>{const s=t.length,n=e.length,i=new Uint32Array(s);for(let r=0;r<n;r++){const{source:o,target:a}=e[r];i[o]++,i[a]++}return i}),"degrees"),vH=Se(((t,e)=>({nodes:t.nodes.map(((s,n)=>{let i=(s.mass??1)*yH(s.r||1,e[n]);return i=Math.max(i,pH),{...s,mass:i}})),edges:t.edges.map((s=>{const n=s.weight||1,i=e[s.target]+1,r=e[s.source]+1,o=n*(i*r)/Math.min(i,r)/(i+r);return{...s,stiffness:o}}))})),"defaultSettings"),Eg=Se(((t,e)=>{const s=I6(Vy(t),e);return vH(s,xH(s))}),"cleanGraph"),pA=class{constructor(t){this.promise=new Promise(t)}then(t){return this.promise.then(t)}stop(){return this.simulation.stop(),this}get iterations(){return this.simulation.iterations()}};function Ug(t,e,s={}){var x;let n,i;e.getExtension("EXT_color_buffer_float")||((x=e.getExtension("WEBGL_lose_context"))==null||x.loseContext());let r=new Hy({...fA,...s});const o=t.nodes.length,a=s.cx||t.nodes.reduce(((v,b)=>v+(b.x||0)),0)/o,l=s.cy||t.nodes.reduce(((v,b)=>v+(b.y||0)),0)/o,u=[a,l],h=Array.from({length:o},((v,b)=>b)),g=Se((v=>{if(!n)throw new Error("No graph has been set");const{size:b}=n.texture.particlesPositions();if(b[0]*b[1]<=1)return{X:[0],Y:[0]};const S=[],A=[];let w=0;const L=new Float32Array(4*b[0]*b[1]);return e.readPixels(0,0,b[0],b[1],e.RGBA,e.FLOAT,L),n.items.forEach((({N:k,particlesPositionsSlot:F})=>{const{x:O,y:j,w:V}=F;for(let Z=0;Z<k;Z++){const at=O+Z%V,mt=4*((j+Math.floor(Z/V))*b[0]+at);S[h[w+Z]]=L[mt]+a,A[h[w+Z]]=L[mt+1]+l}w+=k})),v&&(f(),m()),{X:S,Y:A}}),"readLayoutData"),f=Se((()=>{i&&(i.stop(),i.destroy(),i=void 0)}),"simulationCleanup"),m=Se((()=>{n&&(hA(e,n),n=void 0)}),"graphLayoutCleanup"),y={setOptions:(v={})=>(r=new Hy({...fA,...v}),n&&(f(),i=h_(e,n,r)),y),setGraph:(v={nodes:[],edges:[]})=>{let b;if(n&&hA(e,n),s.groups){const S={};Object.entries(s.groups).forEach((([A,w])=>w.forEach((L=>S[L]=Number(A))))),b=dA(Vy(v),Object.values(S)),b.map((({nodes:A})=>A)).flat().forEach(((A,w)=>h[w]=A.id)),b=b.map((A=>Eg(A,u)))}else b=[Eg(v,u)];return n=jy(e,b),r&&(f(),i=h_(e,n,r)),y},start:()=>{if(!i)throw new Error("No graph has been set");return i.start().finally((()=>{var v;return(v=s.onEnd)==null?void 0:v.call(s,1)})).catch((v=>{throw new Error("Something went wrong during GPU layout: "+v)})),y},stop:()=>(i&&i.stop(),y),step:()=>{if(!i)throw new Error("No graph has been set");return i.step(),y},data:v=>g(v),iterations:()=>1};let p;if(s.groups){const v={};Object.entries(s.groups).forEach((([b,S])=>S.forEach((A=>v[A]=Number(b))))),p=dA(Vy(t),Object.values(v)),p.map((({nodes:b})=>b)).flat().forEach(((b,S)=>h[S]=b.id)),p=p.map((b=>Eg(b,u)))}else p=[Eg(t,u)];return n=jy(e,p),i=h_(e,n,r),y}/**
* @preserve
* @linkurious/force-layout@1.0.9
* Ogma general-purpose force-directed layout
*/function _A(){var t=(()=>{var e=Object.defineProperty,s=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,r=(Y,et)=>e(Y,"name",{value:et,configurable:!0}),o={};((Y,et)=>{for(var J in et)e(Y,J,{get:et[J],enumerable:!0})})(o,{IntegratorType:()=>ss,force:()=>cs});var a=class{constructor(Y){let et=l();this.c=1,this.s0=et(" "),this.s1=et(" "),this.s2=et(" "),this.s0-=et(String(Y)),this.s0<0&&(this.s0+=1),this.s1-=et(String(Y)),this.s1<0&&(this.s1+=1),this.s2-=et(Y),this.s2<0&&(this.s2+=1),et=null}next(){return()=>{const Y=2091639*this.s0+23283064365386963e-26*this.c;return this.s0=this.s1,this.s1=this.s2,this.s2=Y-(this.c=0|Y)}}nextDouble(){const Y=this.next();return()=>Y()+11102230246251565e-32*(2097152*Y()|0)}nextInt32(){const Y=this.next();return()=>4294967296*Y()|0}};function l(){let Y=4022871197;return et=>{et=et.toString();for(let J=0;J<et.length;J++){Y+=et.charCodeAt(J);let tt=.02519603282416938*Y;Y=tt>>>0,tt-=Y,tt*=Y,Y=tt>>>0,tt-=Y,Y+=4294967296*tt}return 23283064365386963e-26*(Y>>>0)}}function u(Y){return new a(Y.toString()).next()}r(a,"Alea"),r(l,"Mash"),r(u,"impl");var h=u(42);function g(Y){h=u(Y)}function f(){return 1e-6*(h()-.5)}function m(Y,et,J,{edgeStrength:tt,edgeLength:ft}){const _t=J.sources,it=J.targets,vt=J.X,Ct=J.Y,Ft=J.R,Pt=J.fx,Lt=J.fy,$t=J.degrees,jt=J.masses,Ot=J.weights;for(let Ut=0;Ut<et.length;Ut++){const Ht=et[Ut],Xt=_t[Ht],te=it[Ht],re=1,ie=$t[Xt]+re,C=$t[te]+re,R=tt*Ot[Ht];let U=vt[te]+Pt[te]-vt[Xt]-Pt[Xt]||f(),W=Ct[te]+Lt[te]-Ct[Xt]-Lt[Xt]||f();const St=U*U+W*W,bt=Math.sqrt(St),kt=ft+Ft[Xt]+Ft[te];if(bt<=kt)continue;const Zt=kt-bt,ne=Zt*(C*ie/Math.min(C,ie)/(C+ie)),Ee=Math.min(1,Y*R*Zt/St*(ne*(C+ie)/(C*ie))),we=C*ie/(C+ie);U*=Ee,W*=Ee,Pt[Xt]+=U*we/jt[Xt],Lt[Xt]+=W*we/jt[Xt],Pt[te]-=U*we/jt[te],Lt[te]-=W*we/jt[te]}}r(g,"setSeed"),r(f,"randomize"),r(m,"attraction");var y=r(((Y,et)=>{const J=et.sources,tt=et.targets,ft=et.degrees,_t=et.weights,it=et.edgeIds,vt=et.nodeToGroup,Ct=et.hasGroups;for(let Ft=0;Ft<Y.length;Ft++){const{source:Pt,target:Lt,weight:$t=1}=Y[Ft];J[Ft]=Pt,tt[Ft]=Lt,_t[Ft]=$t,ft[Pt]++,ft[Lt]++,it[Ft]=Ft,_t[Ft]=$t===void 0?1:$t,Ct&&vt[Pt]!==vt[Lt]&&(_t[Ft]=0)}}),"initialize");function p(Y,et,J,{gravity:tt,cx:ft,cy:_t}){const it=J.X,vt=J.Y,Ct=J.fx,Ft=J.fy,Pt=J.nodeToGroup,Lt=J.cells,$t=J.hasGroups,jt=et.length;for(let Ot=0;Ot<jt;Ot++){const Ut=et[Ot],Ht=$t?Lt[Pt[Ot]].cx:ft,Xt=$t?Lt[Pt[Ot]].cy:_t,te=Ht-it[Ut]||f(),re=Xt-vt[Ut]||f(),ie=tt*Y;Ct[Ut]+=te*ie,Ft[Ut]+=re*ie}}m.initialize=y,r(p,"center");var x=r(((Y,et,J)=>{const{X:tt,Y:ft}=et;let _t=J.cx,it=J.cy;const vt=Y.length;if(_t===void 0||it===void 0){_t=it=0;for(let Ct=0;Ct<vt;Ct++)_t+=tt[Ct],it+=ft[Ct];_t/=vt,it/=vt}J.cx=_t,J.cy=it}),"initialize");p.initialize=x;var v=class{constructor(Y,et,J,tt){this.left=null,this.right=null,this.data=null,this.code=Y,this.data=et,this.left=J,this.right=tt}};function b(Y,et,J,tt,ft){const _t=new v(null,null,null,null),it=[_t],vt=[tt,ft];for(;it.length!==0;){const Ct=vt.pop(),Ft=vt.pop(),Pt=it.pop();if(Ct-Ft==0)Pt.code=J[Ft],Pt.data=Y[et[Ft]];else{const Lt=w(et,J,Ft,Ct);Pt.code=Lt,Ft<=Lt&&(Pt.left=new v(null,null,null,null),it.push(Pt.left),vt.push(Ft,Lt)),Ct>Lt&&(Pt.right=new v(null,null,null,null),it.push(Pt.right),vt.push(Lt+1,Ct))}}return _t}function S(Y,et,J,tt,ft,_t){const it=new v(null,null,null,null),vt=[it],Ct=[tt,ft];for(;vt.length!==0;){const Ft=Ct.pop(),Pt=Ct.pop(),Lt=vt.pop();if(Ft-Pt<_t){const $t=new Array(Ft-Pt+1);for(let jt=Pt,Ot=0;jt<=Ft;jt++,Ot++)$t[Ot]=Y[et[jt]];Lt.code=J[Pt],Lt.data=$t}else{const $t=w(et,J,Pt,Ft);Lt.code=$t,Pt<=$t&&(Lt.left=new v(null,null,null,null),vt.push(Lt.left),Ct.push(Pt,$t)),Ft>$t&&(Lt.right=new v(null,null,null,null),vt.push(Lt.right),Ct.push($t+1,Ft))}}return it}r(v,"Node"),r(b,"buildIterative"),r(S,"buildIterativeBuckets");var A=Math.clz32||r((function(et){let J=-2147483648;for(let tt=0;tt<31;tt+=1){if(J&et)return tt;J>>>=1}return 32}),"clz");function w(Y,et,J,tt){const ft=et[Y[J]],_t=et[Y[tt]];if(ft===_t)return J;const it=A(ft^_t);let vt,Ct,Ft,Pt=J,Lt=tt-J;do Lt=Lt+1>>1,vt=Pt+Lt,vt<tt&&(Ct=et[Y[vt]],Ft=A(ft^Ct),Ft>it&&(Pt=vt));while(Lt>1);return Pt}function L(Y,et){let J=Y^et,tt=65535^J,ft=65535^(Y|et),_t=Y&(65535^et),it=J|tt>>1,vt=J>>1^J,Ct=ft>>1^tt&_t>>1^ft,Ft=J&ft>>1^_t>>1^_t;J=it,tt=vt,ft=Ct,_t=Ft,it=J&J>>2^tt&tt>>2,vt=J&tt>>2^tt&(J^tt)>>2,Ct^=J&ft>>2^tt&_t>>2,Ft^=tt&ft>>2^(J^tt)&_t>>2,J=it,tt=vt,ft=Ct,_t=Ft,it=J&J>>4^tt&tt>>4,vt=J&tt>>4^tt&(J^tt)>>4,Ct^=J&ft>>4^tt&_t>>4,Ft^=tt&ft>>4^(J^tt)&_t>>4,J=it,tt=vt,ft=Ct,_t=Ft,Ct^=J&ft>>8^tt&_t>>8,Ft^=tt&ft>>8^(J^tt)&_t>>8,J=Ct^Ct>>1,tt=Ft^Ft>>1;let Pt=Y^et,Lt=tt|65535^(Pt|J);return Pt=16711935&(Pt|Pt<<8),Pt=252645135&(Pt|Pt<<4),Pt=858993459&(Pt|Pt<<2),Pt=1431655765&(Pt|Pt<<1),Lt=16711935&(Lt|Lt<<8),Lt=252645135&(Lt|Lt<<4),Lt=858993459&(Lt|Lt<<2),Lt=1431655765&(Lt|Lt<<1),(Lt<<1|Pt)>>>0}r(w,"findSplit"),r(L,"hilbert");var k=[0,1],F=[0,2];for(let Y=4;Y<65535;Y<<=2)for(let et=0,J=k.length;et<J;et++)k.push(k[et]|Y),F.push((k[et]|Y)<<1);function O(Y,et){return(F[255&et]|k[255&Y])+65536*(F[et>>8&255]|k[Y>>8&255])+4294967296*(F[et>>16&255]|k[Y>>16&255])}r(O,"morton");var j=new Uint32Array(1024);function V(Y,et){const J=new Uint32Array(et.length);for(let ft=0;ft<1024;ft++)j[ft]=0;const tt=255;for(let ft=0;ft<et.length;ft++){const _t=et[ft];j[_t&tt]++,j[256+(_t>>8&tt)]++,j[512+(_t>>16&tt)]++,j[768+(_t>>24&tt)]++}for(let ft=0;ft<4;ft++){let _t=0,it=0;const vt=256*ft;for(let Ct=0;Ct<256;Ct++)_t=j[Ct+vt],j[Ct+vt]=it,it+=_t}for(let ft=0;ft<et.length;ft++){const _t=et[ft];J[j[_t&tt]++]=ft}for(let ft=0;ft<et.length;ft++){const _t=J[ft],it=et[_t];Y[j[256+(it>>8&tt)]++]=_t}for(let ft=0;ft<et.length;ft++){const _t=Y[ft],it=et[_t];J[j[512+(it>>16&tt)]++]=_t}for(let ft=0;ft<et.length;ft++){const _t=J[ft],it=et[_t];Y[j[768+(it>>24&tt)]++]=_t}}r(V,"radixSort");var Z=class{constructor(Y,{getX:et,getY:J,bucketSize:tt=0,sfc:ft=1}={}){this.bucketSize=0,this._root=null;const _t=Y.length,it=new Uint32Array(_t);let vt=1/0,Ct=1/0,Ft=-1/0,Pt=-1/0;this._x=et,this._y=J;const Lt=ft===1?L:O;this._project=Lt;const $t=new Uint32Array(_t);for(let Ut=0;Ut<_t;Ut++){const Ht=Y[Ut],Xt=et(Ht),te=J(Ht);Xt<vt&&(vt=Xt),te<Ct&&(Ct=te),Xt>Ft&&(Ft=Xt),te>Pt&&(Pt=te),$t[Ut]=Ut}this._minX=vt,this._minY=Ct,this._maxX=Ft,this._maxY=Pt;const jt=65535/Math.max(Ft-vt,1),Ot=65535/Math.max(Pt-Ct,1);this._hw=jt,this._hh=Ot;for(let Ut=0;Ut<_t;Ut++){const Ht=Y[Ut];it[Ut]=Lt(jt*(et(Ht)-vt),Ot*(J(Ht)-Ct))}V($t,it),this._root=tt===0?b(Y,$t,it,0,_t-1):S(Y,$t,it,0,_t-1,tt),this.bucketSize=tt}get root(){return this._root}inOrder(Y,et){let J=this._root;const tt=[];let ft=!1;for(;!ft;)if(J)tt.push(J),J=J.left;else if(tt.length!==0){if(J=tt.pop(),Y.call(et,J))break;J=J.right}else ft=!0;return this}preOrder(Y,et){const J=[this._root];for(;J.length!==0;){const tt=J.pop();Y.call(et,tt)||(tt.right&&J.push(tt.right),tt.left&&J.push(tt.left))}return this}postOrder(Y,et){const J=[];let tt,ft=this._root;do{for(;ft;)ft.right&&J.push(ft.right),J.push(ft),ft=ft.left;ft=J.pop(),tt=J.length-1,ft.right&&J[tt]===ft.right?(J[tt]=ft,ft=ft.right):(Y.call(et,ft),ft=null)}while(J.length!==0);return this}map(Y,et){const J=[];return this.inOrder((tt=>{J.push(Y.call(et,tt))})),J}height(){return at(this._root)}toString(Y=(et=>et.code.toString())){const et=[];return mt(this._root,"",!0,(J=>et.push(J)),Y),et.join("")}size(){let Y=0;return this.preOrder((()=>{Y++})),Y}destroy(){return this._root=null,this}};function at(Y){return Y?1+Math.max(at(Y.left),at(Y.right)):0}function mt(Y,et,J,tt,ft){if(Y){tt(et+(J?"^-- ":"|-- ")+ft(Y)+`
`);const _t=et+(J?"    ":"|   ");Y.left&&mt(Y.left,_t,!1,tt,ft),Y.right&&mt(Y.right,_t,!0,tt,ft)}}function K(Y){for(let et=Y.length-1;et>=0;et--){let J=Math.floor(Math.random()*(et+1));J=Math.max(Math.min(J,et),0);const tt=Y[et];Y[et]=Y[J],Y[J]=tt}return Y}r(Z,"BVH"),r(at,"treeHeight"),r(mt,"row"),r(K,"shuffle");var ut,ht,nt,ot,Mt,Q,Et,qt,Vt,Wt=r((Y=>Y.x),"getX"),oe=r((Y=>Y.y),"getY"),me=r((Y=>Y.r),"getR");function se(Y,et=Wt,J=oe,tt=me){const ft=K(Y.slice()),_t=ft.length;let it,vt=[],Ct=0;for(;Ct<_t;){const Ft=ft[Ct];it&&ce(it,et(Ft),J(Ft),tt(Ft))?Ct++:(vt=Jt(vt,Ft,et,J,tt),it=ve(vt,et,J,tt),Ct=0)}return it}function Jt(Y,et,J,tt,ft){const _t=J(et),it=tt(et),vt=ft(et),Ct={x:_t,y:it,r:vt};if(Ce(Ct,Y,J,tt,ft))return[et];for(let Ft=0;Ft<Y.length;++Ft){const Pt=Y[Ft],Lt=J(Pt),$t=tt(Pt),jt=ft(Pt);if(!ee(Ct,Lt,$t,jt)&&Ce(ge(Lt,$t,jt,_t,it,vt),Y,J,tt,ft))return[Y[Ft],et]}for(let Ft=0;Ft<Y.length-1;Ft++)for(let Pt=Ft+1;Pt<Y.length;Pt++){const Lt=Y[Ft],$t=Y[Pt],jt=J(Lt),Ot=tt(Lt),Ut=ft(Lt),Ht=J($t),Xt=tt($t),te=ft($t);if(!ee(ge(jt,Ot,Ut,Ht,Xt,te),_t,it,vt)&&!ee(ge(jt,Ot,Ut,_t,it,vt),Ht,Xt,te)&&!ee(ge(Ht,Xt,te,_t,it,vt),jt,Ot,Ut)&&Ce(ze(jt,Ot,Ut,Ht,Xt,te,_t,it,vt),Y,J,tt,ft))return[Y[Ft],Y[Pt],et]}throw new Error}function ee(Y,et,J,tt){const ft=Y.r-tt,_t=et-Y.x,it=J-Y.y;return ft>=0&&ft*ft>_t*_t+it*it}function ce(Y,et,J,tt){const ft=Y.r-tt+1e-6,_t=et-Y.x,it=J-Y.y;return ft>0&&ft*ft>_t*_t+it*it}function Ce(Y,et,J,tt,ft){for(let _t=0;_t<et.length;++_t){const it=et[_t];if(!ce(Y,J(it),tt(it),ft(it)))return!1}return!0}function ve(Y,et,J,tt){return Y.length===1?Me(et(Y[0]),J(Y[0]),tt(Y[0])):Y.length===2?ge(et(Y[0]),J(Y[0]),tt(Y[0]),et(Y[1]),J(Y[1]),tt(Y[1])):ze(et(Y[0]),J(Y[0]),tt(Y[0]),et(Y[1]),J(Y[1]),tt(Y[1]),et(Y[2]),J(Y[2]),tt(Y[2]))}function Me(Y,et,J){return{x:Y,y:et,r:J}}function ge(Y,et,J,tt,ft,_t){const it=tt-Y,vt=ft-et,Ct=_t-J,Ft=Math.sqrt(it*it+vt*vt);return{x:(Y+tt+it/Ft*Ct)/2,y:(et+ft+vt/Ft*Ct)/2,r:(Ft+J+_t)/2}}function ze(Y,et,J,tt,ft,_t,it,vt,Ct){const Ft=(Y+tt+it)/3,Pt=(et+ft+vt)/3,Lt=Y-Ft,$t=et-Pt,jt=tt-Ft,Ot=ft-Pt,Ut=it-Ft,Ht=vt-Pt,Xt=Lt-jt,te=Lt-Ut,re=$t-Ot,ie=$t-Ht,C=_t-J,R=Ct-J,U=Lt*Lt+$t*$t-J*J,W=U-jt*jt-Ot*Ot+_t*_t,St=U-Ut*Ut-Ht*Ht+Ct*Ct,bt=te*re-Xt*ie,kt=(re*St-ie*W)/(2*bt)-Lt,Zt=(ie*C-re*R)/bt,ne=(te*W-Xt*St)/(2*bt)-$t,Ee=(Xt*R-te*C)/bt,we=Zt*Zt+Ee*Ee-1,We=2*(J+kt*Zt+ne*Ee),ls=kt*kt+ne*ne-J*J,ps=-(Math.abs(we)>1e-6?(We+Math.sqrt(We*We-4*we*ls))/(2*we):ls/We);return{x:Ft+Lt+kt+Zt*ps,y:Pt+$t+ne+Ee*ps,r:ps}}function is(Y,et,J,{X:tt,Y:ft,R:_t,fx:it,fy:vt,bucketSize:Ct},{elasticity:Ft}){if(Ft===0)return J;J||(J=new Z(et,{getX:ut,getY:ht,bucketSize:Ct})).postOrder(ot);for(let Pt=0;Pt<et.length;Pt++)Q=et[Pt],Et=tt[Q]+it[Q],qt=ft[Q]+vt[Q],Vt=_t[Q],J.preOrder(Mt);return J}r(se,"med"),r(Jt,"extend"),r(ee,"contains"),r(ce,"containsWeak"),r(Ce,"containsWeakAll"),r(ve,"enclose"),r(Me,"from1"),r(ge,"from2"),r(ze,"from3"),r(is,"collisionForce");var Ge=r((Y=>{const et=Y.X,J=Y.Y,tt=Y.R,ft=Y.bucketSize;return _t=>{let it,vt,Ct,Ft;const Pt=_t.data;if(Pt!==null)if(ft!==0){const Lt=se(Pt,ut,ht,nt);it=Lt.x,vt=Lt.y,Ct=Lt.r}else{const Lt=Pt;it=et[Lt],vt=J[Lt],Ct=tt[Lt]}else if(_t.left&&_t.right){const Lt=_t.left.cx,$t=_t.left.cy,jt=_t.right.cx,Ot=_t.right.cy,Ut=_t.left.r,Ht=_t.right.r,Xt=jt-Lt,te=Ot-$t,re=Ht-Ut,ie=Math.sqrt(Xt*Xt+te*te);it=(Lt+jt+Xt/ie*re)/2,vt=($t+Ot+te/ie*re)/2,Ct=(ie+Ut+Ht)/2}else Ft=_t.left||_t.right,Ft&&(it=Ft.cx,vt=Ft.cy,Ct=Ft.r);_t.cx=it,_t.cy=vt,_t.r=Ct}}),"getMeasureBodies"),De=r(((Y,{elasticity:et,margin:J})=>{const tt=Y.X,ft=Y.Y,_t=Y.R,it=Y.fx,vt=Y.fy,Ct=Y.bucketSize,Ft=Y.nodeToGroup,Pt=Y.cellSize,Lt=Y.hasGroups;return $t=>{const jt=$t.data;if(jt===null){const Ot=$t.cx-Et,Ut=$t.cy-qt,Ht=$t.r+Vt;return Lt?Ot*Ot+Ut*Ut>Pt*Pt:Ot*Ot+Ut*Ut>Ht*Ht}if(Ct!==0){const Ot=jt;for(let Ut=0;Ut<Ot.length;Ut++){const Ht=Ot[Ut];if(Ht>Q){const Xt=_t[Ht];let te=Et-tt[Ht]-it[Ht],re=qt-ft[Ht]-vt[Ht];const ie=Vt+Xt+J;let C=te*te+re*re;if(C<ie*ie){te===0&&(te=f(),C+=te*te),re===0&&(re=f(),C+=re*re);const R=Math.sqrt(C),U=(ie-R)*et/R,W=Xt/ie;it[Q]+=te*U*W,vt[Q]+=re*U*W,it[Ht]-=te*U*(1-W),vt[Ht]-=re*U*(1-W)}}}}else{const Ot=$t.data;if(Lt&&Ft[Q]!==Ft[Ot])return;if(Ot>Q){const Ut=_t[Ot];let Ht=Et-tt[Ot],Xt=qt-ft[Ot];const te=Vt+Ut+J;let re=Ht*Ht+Xt*Xt;if(re<te*te){Ht===0&&(Ht=f(),re+=Ht*Ht),Xt===0&&(Xt=f(),re+=Xt*Xt);const ie=Math.sqrt(re),C=(te-ie)*et/ie,R=Ut/te;it[Q]+=Ht*C*R,vt[Q]+=Xt*C*R,it[Ot]-=Ht*C*(1-R),vt[Ot]-=Xt*C*(1-R)}}}}}),"getApplyForce"),He=r(((Y,et,J)=>{const{X:tt,Y:ft,R:_t}=et;ut=r((it=>tt[it]),"getX"),ht=r((it=>ft[it]),"getY"),nt=r((it=>_t[it]),"getR"),ot=Ge(et),Mt=De(et,J)}),"initialize");function Je(Y,et,{masses:J,X:tt,Y:ft,fx:_t,fy:it},{charge:vt}){const Ct=et.length;let Ft,Pt,Lt,$t,jt,Ot,Ut,Ht,Xt;for(let te=0;te<Ct;te++){Ft=et[te];for(let re=te+1;re<Ct;re++)if(te!==re){if(Pt=et[re],Ft===Pt)continue;Lt=tt[Ft]-tt[Pt]||f(),$t=ft[Ft]-ft[Pt]||f(),jt=Lt*Lt+$t*$t,jt<1&&(jt=Math.sqrt(1*jt)),Ot=vt*J[Pt],Ut=Y*Ot/jt,Ht=vt*J[Ft],Xt=Y*Ht/jt,_t[Ft]+=Lt*Ut,it[Ft]+=$t*Ut,_t[Pt]-=Lt*Xt,it[Pt]-=$t*Xt}}}is.initialize=He,r(Je,"repulsion"),Je.initialize=()=>{};var ss=(Y=>(Y[Y.verlet=0]="verlet",Y[Y.euler=1]="euler",Y))(ss||{}),ts=0,hs=typeof window>"u",Fe=typeof performance<"u"&&performance.now?performance:Date,Oe=hs?Y=>{const et=Fe.now(),J=Math.max(0,16-(et-ts)),tt=setTimeout((()=>Y(et+J)),J);return ts=et+J,tt}:window.requestAnimationFrame,Cs=hs?Y=>clearTimeout(Y):window.cancelAnimationFrame;function Fs(Y,et,J){for(let tt=0;tt<Y.length;tt++){const ft=Y[tt];ft.x=et[tt],ft.y=J[tt]}}r(Fs,"defaultUpdate");var Hs,Ls,En,hn,on,xs,Ps,gt,M,P,D,B=r((()=>{}),"noop"),$={movementRatio:7e-8,surfaceRatio:.0025},H=r(((Y,et)=>.003*Y**2+(et+1)),"defaultMass"),X=class{constructor(Y={}){this.onUpdate=r((et=>{}),"onUpdate"),this.update=Fs,this.nextTick=Oe,this.cancelTick=Cs,this.onEnd=B,this.charge=10,this.maxIterations=200,this.minMovement=.1,this.edgeLength=30,this.edgeStrength=3,this.friction=.1,this.elasticity=.9,this.margin=1,this.cx=void 0,this.cy=void 0,this.gravity=.01,this.theta=.34,this.batch=void 0,this.inertia=.9,this.integrator=0,this.multilevel=!1,this.placement="none",this.placementOffset=10,this.alignSiblings=!1,this.bucketSize=void 0,this.maxDisplacement=1e3,this.siblingsMinAngle=0,this.siblingsOffset=.15,this.steps=200,this.scaling=1,this.defaultRadius=1,this.autoStop=$,this.gpuAcceleration=!0,this.barnesHutOptimization=!0,"autoStop"in Y?Y.autoStop&&(typeof Y.autoStop=="boolean"?Y.autoStop=$:Y.autoStop={...Y.autoStop,...$}):Y.steps;for(const et in Y)Y[et]===void 0&&et!=="order"&&et!=="depth"||(this[et]=Y[et])}};r(X,"Settings");var lt=0;function dt(Y,et,J,tt){const ft=tt.X,_t=tt.Y,it=tt.R,vt=tt.masses,Ct=tt.bucketSize;lt=Y,J===null&&(J=new Z(et,{getX:En,getY:hn,bucketSize:Ct})).postOrder(Hs);const Ft=et.length;for(let Pt=0;Pt<Ft;Pt++)xs=et[Pt],Ps=ft[xs],gt=_t[xs],M=it[xs],P=vt[xs],D=P,J.preOrder(Ls);return J}r(dt,"repulsion");var ct=r(((Y,{charge:et,theta:J})=>{const tt=Y.fx,ft=Y.fy,_t=Y.X,it=Y.Y,vt=Y.R,Ct=Y.masses,Ft=Y.bucketSize,Pt=Y.cellSize;return Lt=>{let $t=0,jt=0,Ot=Ps-Lt.cx||f(),Ut=gt-Lt.cy||f(),Ht=Ot*Ot+Ut*Ut,Xt=M+Lt.r;const te=Lt.data;if(te!==null){if(te===xs)return!1;if(Ft!==0){const re=te;for(let ie=0;ie<re.length;ie++){const C=re[ie];if(C===xs)continue;Ot=Ps-_t[C]||f(),Ut=gt-it[C]||f(),Ht=Ot*Ot+Ut*Ut,Xt=M+vt[C],Ht<1&&(Ht=Math.sqrt(1*Ht));const R=Ct[C];$t=et*R*D,jt=lt*$t/Ht,tt[xs]+=Ot*jt/P,ft[xs]+=Ut*jt/P}}else{if(Ht<1&&(Ht=Math.sqrt(1*Ht)),Ht>(Pt/2)**2)return!0;$t=et*Lt.mass*D,jt=lt*$t/Ht,tt[xs]+=Ot*jt/P,ft[xs]+=Ut*jt/P}}else{const re=Xt/J;if(Ht>re*re)return Ht<1&&(Ht=Math.sqrt(1*Ht)),Ht>(Pt/2)**2||($t=et*Lt.mass,$t=et*Lt.mass*D,jt=lt*$t/Ht,tt[xs]+=Ot*jt/P,ft[xs]+=Ut*jt/P),!0}}}),"getApplyForce"),pt=r((Y=>{const et=Y.X,J=Y.Y,tt=Y.R,ft=Y.masses,_t=Y.bucketSize;return it=>{let vt,Ct,Ft=0,Pt=0,Lt=0,$t=0;const jt=it.data;if(jt!==null)if(_t!==0){const Ot=jt,Ut=se(Ot,En,hn,on);Ft=Ut.x,Pt=Ut.y,Lt=Ut.r;for(let Ht=0;Ht<Ot.length;Ht++)$t+=ft[Ot[Ht]]}else Ct=jt,Ft=et[Ct],Pt=J[Ct],Lt=tt[Ct],$t=ft[Ct];else if(it.left&&it.right){const Ot=it.left.cx,Ut=it.left.cy,Ht=it.right.cx,Xt=it.right.cy,te=it.left.r,re=it.right.r,ie=Ht-Ot,C=Xt-Ut,R=re-te,U=Math.sqrt(ie*ie+C*C);Ft=(Ot+Ht+ie/U*R)/2,Pt=(Ut+Xt+C/U*R)/2,Lt=(U+te+re)/2,$t=it.left.mass+it.right.mass}else vt=it.left||it.right,Ft=vt.cx,Pt=vt.cy,Lt=vt.r,$t=vt.mass;it.cx=Ft,it.cy=Pt,it.r=Lt,it.mass=$t}}),"getAccumulateBodies"),yt=r(((Y,et,J)=>{const tt=Y.length,ft=et.X,_t=et.Y,it=et.R,vt=et.degrees,Ct=et.pinned,Ft=et.masses,Pt=et.nodeIds,Lt=J.scaling,$t=J.defaultRadius,jt=J.bucketSize;et.bucketSize=jt===void 0?Math.floor(Math.log(tt)):jt;let Ot=1/0,Ut=1/0,Ht=-1/0,Xt=-1/0;const te=Math.PI*(3-Math.sqrt(5));let re=0;for(let ie=0;ie<Y.length;ie++){const C=Y[ie];let{x:R,y:U,r:W}=C,{mass:St=1}=C;if(St=Math.max(St*H(W||$t,vt[ie]),.001),isNaN(R)||isNaN(U)){const bt=5*Math.sqrt(ie),kt=ie*te;R=bt*Math.cos(kt),U=bt*Math.sin(kt)}W=W||$t,ft[ie]=R,_t[ie]=U,it[ie]=W,Ct[ie]=C.pinned?1:0,Ft[ie]=St*Lt,Pt[ie]=ie,W>re&&(re=W),R<Ot&&(Ot=R),U<Ut&&(Ut=U),R>Ht&&(Ht=R),U>Xt&&(Xt=U)}if(Y.length>1&&(Ht-Ot<2*re||Xt-Ut<2*re)){const ie=(Ot+Ht)/2,C=(Ut+Xt)/2;for(let R=0;R<tt;R++)if(!Ct[R]){const U=5*Math.sqrt(R),W=R*te,St=ie+U*Math.cos(W),bt=C+U*Math.sin(W);ft[R]=St,_t[R]=bt,St<Ot&&(Ot=St),bt<Ut&&(Ut=bt),St>Ht&&(Ht=St),bt>Xt&&(Xt=bt)}}et.updateGroups(),En=r((ie=>ft[ie]),"getX"),hn=r((ie=>_t[ie]),"getY"),on=r((ie=>it[ie]),"getR"),Hs=pt(et),Ls=ct(et,J)}),"initialize");function Nt(Y,et,J,{maxDisplacement:tt}){const{X:ft,Y:_t,fx:it,fy:vt,pinned:Ct,layer:Ft,layers:Pt,surfaces:Lt,movements:$t}=J;$t.fill(0);let jt=0;const Ot=Y.length;let Ut=1/0,Ht=1/0,Xt=-1/0,te=-1/0;const re=tt*tt;for(let R=0;R<Ot;R++){const U=Y[R],W=it[U]*=et,St=vt[U]*=et,bt=Ft[U];let kt=W,Zt=St;const ne=ft[U],Ee=_t[U];if(kt*kt+Zt*Zt>re){const We=Math.sqrt(kt*kt+Zt*Zt)/tt;Zt/=We,kt/=We}Ct[U]||(ft[U]+=kt,_t[U]+=Zt);const we=Math.sqrt(kt*kt+Zt*Zt);Ct[U]||(ne<Ut&&(Ut=ne),Ee<Ht&&(Ht=Ee),ne>Ut&&(Xt=ne),Ee>Ht&&(te=Ee),$t[bt-1]+=we),jt+=bt*we}const ie=Math.max(Xt-Ut,0),C=Math.max(te-Ht,0);for(let R=0;R<Pt.length;R++){const U=Pt[R],W=U.length;let St=1/0,bt=1/0,kt=-1/0,Zt=-1/0,ne=0;for(let us=0;us<W;us++){const Ns=U[us];if(Ct[Ns])continue;const gs=ft[Ns],Ms=_t[Ns];gs<St&&(St=gs),Ms<bt&&(bt=Ms),gs>kt&&(kt=gs),Ms>Zt&&(Zt=Ms),ne++}const Ee=kt-St,we=Zt-bt,We=Math.max(1,Math.sqrt(Ee**2+we**2));Lt[R]=We;const ls=ne===0?0:$t[R]/ne,ps=ie*C||1;$t[R]=ls>ne?ls/ps:0}return J.updateGroups(),jt}function Tt(Y,et,J){At(Y,et,J),Bt(J)}function At(Y,et,{sources:J,targets:tt,degrees:ft,nodeIds:_t,edgeIds:it}){const vt={};for(let Ct=0;Ct<Y.length;Ct++)vt[Ct]=_t[Ct]=Ct;for(let Ct=0;Ct<et.length;Ct++){const{source:Ft,target:Pt}=et[Ct],Lt=vt[Ft],$t=vt[Pt];it[Ct]=Ct,J[Ct]=Lt,tt[Ct]=$t,ft[Lt]++,ft[$t]++}}function Bt({nodeIds:Y,edgeIds:et,sources:J,targets:tt,degrees:ft,layer:_t,layers:it,component:vt,components:Ct,cluster:Ft,parent:Pt}){let Lt=0,$t=1;const jt=new Uint32Array(Y.length);for(let re=0;re<Y.length;re++)jt[re]=ft[re];const Ot=new Array(Y.length);for(let re=0;re<et.length;re++){const ie=et[re],C=J[ie],R=tt[ie];Ot[C]=Ot[C]||[],Ot[R]=Ot[R]||[],Ot[C].push(R),Ot[R].push(C)}const Ut=new Uint8Array(Y.length),Ht=new Uint8Array(Y.length);Pt.fill(-1);let Xt=0;for(let re=0;re<Y.length;re++)if(Ut[re]===0){const ie=[re];for(;ie.length!==0;){const C=ie.pop();if(Ut[C]===0&&Ot[C]!==void 0){const R=Ot[C];for(let U=0;U<R.length;U++)ie.push(R[U])}Ut[C]=1,vt[C]=Xt}Xt++}const te=new Array(Y.length);for(let re=0;re<Y.length;re++)_t[re]=0,te[re]=re;for(;te.length!==0;){const re=[],ie=[];for(let C=0;C<te.length;C++)jt[te[C]]<=Lt&&(re.push(C),ie.push(te[C]));for(let C=0;C<ie.length;C++){const R=ie[C];Ht[R]=Lt,_t[R]=$t;const U=Ot[R];if(U)for(let W=0;W<U.length;W++)jt[U[W]]--}for(let C=0;C<ie.length;C++){const R=ie[C],U=Ot[R];if(U)for(let W=0;W<U.length;W++){const St=U[W],bt=_t[St];if(bt===void 0||bt>$t){Pt[R]=St;break}}}re.reverse();for(let C=0;C<re.length;C++)te.splice(re[C],1);if($t+=1,te.length>0){let C=1/0;for(let R=0;R<te.length;R++){const U=jt[te[R]];U<C&&(C=U)}C>=Lt+1&&(Lt=C,$t=1)}}Ut.fill(0);for(let re=0;re<Y.length;re++){const ie=Y[re],C=_t[ie];if(Pt[ie]===-1||_t[Pt[ie]]===C){const R=[ie];for(Ut.fill(0);R.length!==0;){const U=R.pop();if(Ut[U])continue;if(_t[U]>C){Pt[ie]=U;break}const W=Ot[U];if(Ut[U]=1,W)for(let St=0;St<W.length;St++)R.push(W[St])}}}for(let re=0;re<Y.length;re++){const ie=Y[re],C=vt[ie];Ct[C]=Ct[C]||[],Ct[C].push(ie);const R=_t[ie]-1;it[R]=it[R]||[],it[R].push(ie),Ft[ie]=Pt[ie]}}dt.initialize=yt,r(Nt,"velocityVerlet"),r(Tt,"topology"),r(At,"initTopology"),r(Bt,"decomposition");var he=class{constructor(Y,et=!0,J){this.bucketSize=0,this.cells=[];const tt=Y.nodes.length,ft=Y.edges.length;if(g(tt+ft),this.X=new Array(tt),this.Y=new Array(tt),this.R=new Array(tt),this.fx=new Float32Array(tt),this.fy=new Float32Array(tt),this.vx=new Float32Array(tt),this.vy=new Float32Array(tt),this.pinned=new Uint8Array(tt),this.masses=new Float32Array(tt),this.weights=new Float32Array(ft),this.lengths=new Float32Array(ft),this.sources=new Uint32Array(ft),this.targets=new Uint32Array(ft),this.degrees=new Uint32Array(tt),this.layer=new Uint32Array(tt),this.parent=new Int32Array(tt),this.cluster=new Int32Array(tt),this.component=new Uint32Array(tt),this.components=[],this.layers=[],this.nodeIds=new Array(tt),this.edgeIds=new Array(ft),this.groups=J&&J.groups||[],this.maxR=new Float32Array(Math.max(this.groups.length,1)),this.cellSize=0,this.cells=[],this.hasGroups=this.groups.length>0,this.hasGroups){this.nodeToGroup=new Int32Array(tt);for(let _t=0;_t<this.groups.length;_t++){const it=this.groups[_t];this.cells[_t]={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,ox:0,oy:0,cx:0,cy:0},this.maxR[_t]=0;for(let vt=0;vt<it.length;vt++){const Ct=it[vt];this.nodeToGroup[Ct]=_t,this.maxR[_t]=Math.max(this.maxR[_t],Y.nodes[Ct].r)}}}et&&Tt(Y.nodes,Y.edges,this),this.movements=new Array(this.layers.length).fill(0),this.surfaces=new Array(this.layers.length).fill(0),this.movementsPrev=new Array(this.layers.length).fill(0),this.surfacesPrev=new Array(this.layers.length).fill(0)}updateGroups(){if(!this.hasGroups)return void(this.cellSize=1/0);const Y=this.X,et=this.Y,J=this.groups,tt=this.cells,ft=this.maxR;let _t=0;J.forEach(((Ft,Pt)=>{const Lt=tt[Pt];Lt.minX=1/0,Lt.minY=1/0,Lt.maxX=-1/0,Lt.maxY=-1/0,Ft.forEach((Ut=>{const Ht=Y[Ut],Xt=et[Ut];Lt.minX=Math.min(Ht,Lt.minX),Lt.minY=Math.min(Xt,Lt.minY),Lt.maxX=Math.max(Ht,Lt.maxX),Lt.maxY=Math.max(Xt,Lt.maxY)}));const $t=ft[Pt];Lt.minX-=$t,Lt.minY-=$t,Lt.maxX+=$t,Lt.maxY+=$t;const jt=Math.abs(Lt.maxX-Lt.minX),Ot=Math.abs(Lt.maxY-Lt.minY);_t=Math.max(_t,jt,Ot),Lt.cx=(Lt.maxX+Lt.minX)/2,Lt.cy=(Lt.maxY+Lt.minY)/2})),_t=Math.ceil(2*_t+1),this.cellSize=_t;const it=Math.ceil(Math.sqrt(J.length)),vt=it*_t/2,Ct=_t/2;for(let Ft=0;Ft<J.length;Ft++){const Pt=J[Ft],Lt=Ft%it,$t=Math.floor(Ft/it),jt=tt[Ft],Ot=(Lt+.5)*_t-vt,Ut=($t+.5)*_t-vt,Ht=Ot-jt.cx,Xt=Ut-jt.cy;jt.cx=Ot,jt.cy=Ut,jt.minX=Ot-Ct,jt.minY=Ut-Ct,jt.maxX=Ot+Ct,jt.maxY=Ut+Ct;for(const te of Pt)Y[te]+=Ht,et[te]+=Xt}}};function xe(Y,et){return Y<et?Y*et+Math.pow(et-Y-1,2)/4:Y*et+Math.pow(Y-et-1,2)/4}function be(Y,et){return(Y+et)*(Y+et+1)/2+et}function le({edgeIds:Y,sources:et,targets:J,pinned:tt,degrees:ft,X:_t,Y:it,R:vt},Ct=0,Ft=.5){const Pt={},Lt={};for(const $t of Y){const jt=et[$t],Ot=J[$t];jt!==Ot&&(Pt[jt]=Pt[jt]||{},Pt[Ot]=Pt[Ot]||{},Pt[jt][Ot]=!0,Pt[Ot][jt]=!0)}Object.keys(Pt).forEach(($t=>{const jt=Number($t),Ot=Object.keys(Pt[Number(jt)]);if(Ot.length===2){const[Ut,Ht]=Ot,Xt=xe(Number(Ut),Number(Ht));Xt in Lt||(Lt[Xt]=[Number(Ht),Number(Ut)]),tt[jt]||Lt[Xt].push(jt)}})),Object.keys(Lt).forEach(($t=>{const[jt,Ot,...Ut]=Lt[Number($t)];if(Ut.length<3)return;const Ht=_t[jt],Xt=it[jt],te=_t[Ot],re=it[Ot],ie=ft[jt],C=.25+.5*ie/(ie+ft[Ot]);let R=Ht+(te-Ht)*C,U=Xt+(re-Xt)*C,W=-(re-Xt),St=te-Ht;const bt=Math.sqrt(Math.pow(Ht-te,2)+Math.pow(Xt-re,2));W=-2*W/bt,St=-2*St/bt;const kt=Math.acos(W/Math.sqrt(W*W+St*St));Ct>0&&(kt<Ct||kt>Math.PI-Ct&&kt<=Math.PI?(W=2*Math.cos(Math.PI-Ct),St=2*Math.sin(Math.PI-Ct)):(kt>2*Math.PI-Ct||kt>=Math.PI&&kt<Math.PI+Ct)&&(W=2*Math.cos(Ct),St=2*Math.sin(Ct)));let Zt=0,ne=1;Ut.sort(((ps,us)=>vt[us]-vt[ps]));let Ee=0,we=0;const We=Math.max(vt[Ut[0]],vt[Ut[1]])/2;Ut.length%2==1&&(Zt=1,R-=W*We,U-=St*We);const ls=1+Ft;for(let ps=0;ps<Ut.length;ps++){const us=(Zt+ps)%2,Ns=Ut[ps],gs=ps>=2?vt[Ns]:We,Ms=(us?Ee:we)+gs;_t[Ns]=R+W*ne*Ms,it[Ns]=U+St*ne*Ms,us?Ee+=gs*ls:we+=gs*ls,ne=-ne}}))}function _e(Y){let et=0,J=0;for(const it of Y)et+=it.w*it.h,J=Math.max(J,it.w);Y.sort(((it,vt)=>vt.h-it.h));const tt=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(et/.95)),J),h:1/0}];let ft=0,_t=0;for(const it of Y)for(let vt=tt.length-1;vt>=0;vt--){const Ct=tt[vt];if(!(it.w>Ct.w||it.h>Ct.h)){if(it.x=Ct.x,it.y=Ct.y,_t=Math.max(_t,it.y+it.h),ft=Math.max(ft,it.x+it.w),it.w===Ct.w&&it.h===Ct.h){const Ft=tt.pop();vt<tt.length&&(tt[vt]=Ft)}else it.h===Ct.h?(Ct.x+=it.w,Ct.w-=it.w):it.w===Ct.w?(Ct.y+=it.h,Ct.h-=it.h):(tt.push({x:Ct.x+it.w,y:Ct.y,w:Ct.w-it.w,h:it.h}),Ct.y+=it.h,Ct.h-=it.h);break}}}function Te(Y,et=1){return _e(Y.map((J=>(J.w+=J.maxr+et,J.h+=J.maxr+et,J))).sort(((J,tt)=>J.w*J.h-tt.w*tt.h)))}r(he,"LayoutData"),r(xe,"unorderedPair"),r(be,"orderedPair"),r(le,"alignSiblings"),r(_e,"potpack"),r(Te,"boxpack");var Ve=class{constructor(){this.ids=[],this.xmin=1/0,this.ymin=1/0,this.xmax=-1/0,this.ymax=-1/0,this.x=0,this.y=0,this.w=0,this.h=0,this.cx=0,this.cy=0,this.radius=0,this.mx=0,this.my=0,this.m=0,this.maxr=0}add(Y,et,J,tt){this.ids.push(Y),et-tt<this.xmin&&(this.xmin=et-tt),J-tt<this.ymin&&(this.ymin=J-tt),et+tt>this.xmax&&(this.xmax=et+tt),J+tt>this.ymax&&(this.ymax=J+tt),tt>this.maxr&&(this.maxr=tt),this.mx+=tt*et,this.my+=tt*J,this.m+=tt}measure(Y=0){return this.w=this.xmax-this.xmin+2*Y,this.h=this.ymax-this.ymin+2*Y,this.cx=this.mx/this.m,this.cy=this.my/this.m,this.x=this.xmin,this.y=this.ymin,this.radius=Math.sqrt(this.w*this.w+this.h*this.h)/2,this}};function ke(Y,et=20,J,tt,ft){for(const Ot of Y){const{x:Ut,y:Ht,r:Xt}=se(Ot.ids,(te=>J[te]),(te=>tt[te]),(te=>ft[te]));Ot.cx=Ut,Ot.cy=Ht,Ot.radius=Xt+et}const _t=Y.slice().sort(((Ot,Ut)=>Ot.radius-Ut.radius)),it=_t.map((Ot=>({x:Ot.cx,y:Ot.cy,r:Ot.radius}))),vt=_t.pop();let Ct=3*Math.PI/2,Ft=vt.radius;const Pt=2*Math.PI,{cx:Lt,cy:$t}=vt,jt=[vt];for(;_t.length!==0;){const Ot=_t[_t.length-1],Ut=Ft+Ot.radius,Ht=Lt+Math.cos(Ct)*Ut,Xt=$t+Math.sin(Ct)*Ut;jt.some((te=>{const re=te.cx-Ht,ie=te.cy-Xt;return Math.sqrt(re*re+ie*ie)<te.radius+Ot.radius}))?Ft+=1:(Ot.x=Ht-Ot.w/2,Ot.y=Xt-Ot.h/2,Ot.cx=Ht,Ot.cy=Xt,it[_t.length-1].x=Ht,it[_t.length-1].y=Xt,jt.push(_t.pop()),Ct+=(2*Ot.radius+1)/Ut*1%Pt)}}function je(Y,et,J,tt){let ft=0;const _t=[];for(const it of tt){const vt=new Ve;for(const Ct of it)vt.add(Ct,Y[Ct],et[Ct],J[Ct]);_t.push(vt.measure()),it.length>_t[ft].ids.length&&(ft=_t.length-1)}return{boxes:_t,biggest:ft}}function Pe(Y,et,{X:J,Y:tt,R:ft,components:_t,pinned:it,degrees:vt,sources:Ct,targets:Ft,edgeIds:Pt},{update:Lt,onUpdate:$t,placement:jt,placementOffset:Ot,alignSiblings:Ut,siblingsMinAngle:Ht,siblingsOffset:Xt}){if(Ut&&(le({X:J,Y:tt,R:ft,degrees:vt,pinned:it,sources:Ct,targets:Ft,edgeIds:Pt},Ht,Xt),Lt(Y,J,tt)),jt){const{boxes:te,biggest:re}=je(J,tt,ft,_t);if(jt==="spiral")ke(te,Ot,J,tt,ft);else{if(jt!=="box")return;Te(te,Ot)}const ie=te[re].xmin-te[re].x,C=te[re].ymin-te[re].y;for(const R of te){const{xmin:U,ymin:W,x:St,y:bt,ids:kt}=R,Zt=U-St-ie,ne=W-bt-C;for(const Ee of kt)J[Ee]-=Zt,tt[Ee]-=ne}Lt(Y,J,tt),$t()}}function Be(Y,et,{X:J,Y:tt,R:ft,degrees:_t,nodeIds:it,edgeIds:vt,layers:Ct,layer:Ft,cluster:Pt,masses:Lt,weights:$t,sources:jt,targets:Ot},{cx:Ut,cy:Ht,nextTick:Xt,cancelTick:te,update:re,onUpdate:ie,batch:C,maxIterations:R,steps:U,minMovement:W},St,bt){const kt=Ct.slice();C=C??1;let Zt,ne=0;function Ee(){te(Zt),re(Y,J,tt),ie(),bt(ne)}r(Ee,"stop");const we={};for(let Ss=0;Ss<et.length;Ss++)we[Number(et[Ss].id)||Ss]=Ss;const We=new Map;for(let Ss=0;Ss<vt.length;Ss++){const zs=vt[Ss];We.set(be(jt[zs],Ot[zs]),zs)}for(let Ss=0;Ss<Ct.length;Ss++){const zs=Ct[Ss],_n=Ss;for(let Js=0;Js<zs.length;Js++){const Xs=zs[Js],Ds=Pt[Xs];Ds!==-1&&(Lt[Ds]+=Lt[Xs])}for(let Js=0;Js<et.length;Js++){const Xs=et[Js],Ds=Number(Xs.id)||Js,Sn=Xs.source,Yi=Xs.target,Cn=$t[we[Ds]];if(Ft[Sn]===_n&&Ft[Yi]===_n){const Wi=Pt[Sn],hr=Pt[Yi];if(Wi!==hr){const vs=We.get(be(Wi,hr));vs!==void 0&&($t[vs]+=Cn)}}}}it.length=0,vt.length=0;let ls=1;const ps=1-Math.pow(.1,1/U/2),us=(ls-.1)/U;let Ns,gs,Ms=.5;function cn(){ls+=(0-ls)*ps;const Ss=St(ls,it,vt);let zs=ls<=Ms||Ss<W;if(ne===0||zs){const _n=kt.pop();if(_n){Ns&&(gs=Ns.reduce(((Xs,Ds)=>Math.max(Xs,Ut-J[Ds],Ht-tt[Ds])),0)),it.push.apply(it,_n);for(let Xs=0;Xs<_n.length;Xs++){const Ds=_n[Xs],Sn=Pt[Ds];if(Sn!==-1){const Yi=_t[Ds]>1?2:1,Cn=ft[Sn]+ft[Ds];Lt[Sn]-=Lt[Ds],J[Ds]=J[Sn]+Yi*Cn*(2*h()-1),tt[Ds]=tt[Sn]+Yi*Cn*(2*h()-1)}else Ns&&(J[Ds]=Ut+2*gs*(1-2*h()),tt[Ds]=Ht+2*gs*(1-2*h()))}Ns=_n;const Js=it.reduce(((Xs,Ds)=>(Xs[Ds]=!0,Xs)),{});vt.length=0;for(let Xs=0;Xs<et.length;Xs++){const{source:Ds,target:Sn,id:Yi}=et[Xs];Js[Ds]&&Js[Sn]&&vt.push(we[Number(Yi)])}zs=!1,kt.length===0?(ls=.2,Ms=.1):(ls=.1+2*us,Ms=.1)}}ne%C==0&&(re(Y,J,tt),ie()),++ne>=1/0||zs?Ee():Zt=Xt(cn)}return r(cn,"simulationStep"),{done:!1,start(){return Zt=setTimeout(cn),this},stop(){return Ee(),this},get iterations(){return ne}}}r(Ve,"Component"),r(ke,"spiralpack"),r(je,"groupAndMeasure"),r(Pe,"postprocessing"),r(Be,"multiLevel");var Ue,es=class{constructor(Y){this.promise=new Promise(Y)}then(Y){return this.promise.then(Y)}stop(){return this.simulation.stop(),this}get iterations(){return this.simulation.iterations()}};function rs(Y,et,{X:J,Y:tt,nodeIds:ft,edgeIds:_t,layers:it,movements:vt,movementsPrev:Ct,surfaces:Ft,surfacesPrev:Pt},Lt,$t,jt){const{nextTick:Ot,cancelTick:Ut,steps:Ht,minMovement:Xt,update:te,onUpdate:re,autoStop:ie}=Lt,C=Lt.batch??1;let R=0,U=1,W,St=1-Math.pow(.05,1/Ht),bt=!1;const kt=r((()=>{bt=!0,Ut(W),re(),jt(R)}),"stop");let Zt=!1;const ne=r((()=>{U+=(.001-U)*St;const Ee=$t(U,ft,_t),we=it.length;let We=!1,ls=!1;if(ie){We=ls=!0;const{movementRatio:us,surfaceRatio:Ns}=ie;for(let gs=0;gs<we;gs++)We&&Math.abs(1-Ft[gs]/Pt[gs])>Ns&&(We=!1),ls&&Math.abs(vt[gs]-Ct[gs])>us&&(ls=!1)}We&&ls&&!Zt&&(St=1-Math.pow(.001,1/Math.max(10,R)),Zt=!0);const ps=bt||U<.05||Ee!==0&&Ee<=Xt;if(R%C==0&&(te(Y,J,tt),re()),++R>=Ht||ps)return kt();for(let us=0;us<we;us++)Ct[us]=vt[us],Pt[us]=Ft[us];W=Ot(ne)}),"simulationStep");return{done:!1,start(){return W=setTimeout(ne),this},stop(){return kt(),this},get iterations(){return R}}}function cs(Y,et={}){let J,tt;const ft=r((($t={nodes:[],edges:[]})=>(J=$t.nodes,tt=$t.edges,g(be(J.length,tt.length)),new he($t,!0,et))),"setGraph"),_t=r((($t={})=>new X($t)),"setOptions");let it=ft(Y),vt=_t(et);y(tt,it),yt(J,it,vt),He(J,it,vt),x(J,it,vt);const Ct=Nt;let Ft=null;const Pt=r((($t,jt,Ot)=>(Ft&&(Ft.destroy(),Ft=null),jt.length<=1?0:(vt.barnesHutOptimization?Ft=dt($t,jt,Ft,it):Je($t,jt,it,vt),m($t,Ot,it,vt),Ft&&vt.elasticity!==0&&is(0,jt,Ft,it,vt),p($t,jt,it,vt),Ct(jt,vt.inertia,it,vt)))),"step");let Lt;return{setOptions:($t={})=>(vt=_t($t),this),setGraph:({nodes:$t,edges:jt})=>(it=ft(Y),y(jt,it),yt($t,it,vt),He($t,it,vt),x($t,it,vt),this),start(){return Lt=(vt.multilevel?Be:rs)(J,tt,it,vt,Pt,($t=>{Lt.done||Pe(J,0,it,vt),vt.onEnd($t);const jt=et.groups;if(jt)for(let Ot=0;Ot<jt.length;Ot++){const Ut=jt[Ot],Ht=Ut.reduce(((Xt,te)=>(Xt.x+=it.X[te],Xt.y+=it.Y[te],Xt)),{x:0,y:0});Ht.x/=Ut.length,Ht.y/=Ut.length,et.cx&&(Ht.x-=et.cx),et.cy&&(Ht.y-=et.cy);for(let Xt=0;Xt<Ut.length;Xt++)it.X[Ut[Xt]]-=Ht.x,it.Y[Ut[Xt]]-=Ht.y}Lt.done=!0})).start(),this},iterations:()=>Lt.iterations,data:()=>it,stop(){return Lt&&Lt.stop(),this},step($t=1){return Pt($t,it.nodeIds,it.edgeIds),vt.update(J,it.X,it.Y),this}}}return r(es,"SimulationPromise"),r(rs,"singleLevel"),r(cs,"force"),cs.run=(Y,et)=>{let J;const tt=new es((ft=>{et.onEnd=ft,J=cs(Y,et).start()}));return tt.simulation=J,tt.stop=()=>(J.stop(),tt),tt},Ue=o,((Y,et,J,tt)=>{if(et&&typeof et=="object"||typeof et=="function")for(let ft of n(et))i.call(Y,ft)||ft===J||e(Y,ft,{get:()=>et[ft],enumerable:!(tt=s(et,ft))||tt.enumerable});return Y})(e({},"__esModule",{value:!0}),Ue)})();return t.force.apply(this,arguments)}Se(pA,"SimulationPromise"),Se(Ug,"gpuLayout"),Ug.run=(t,e,s)=>{let n;const i=new pA((r=>{s.onEnd=r,n=Ug(t,e,s).start()}));return i.simulation=n,i.stop=()=>(n.stop(),i),i};var bH=2,EH=1.25,yA=t=>{},xA={name:"force",imports:{force:_A},configure(t,{graph:e,events:s}){const n=t.nodes._indexes,i=t.xs?t.xs:e.getNodeAttribute("x").getMultiple(n),r=t.ys?t.ys:e.getNodeAttribute("y").getMultiple(n),o=t.rs?t.rs:e.getNodeAttribute("radius").getMultiple(n),a=e.getNodeAttribute("layoutable").getMultiple(n),l=t.edges,u=[],h=[],g={},f=t.edgeWeight||yA,m=t.nodeMass?x=>t.nodeMass(t.nodes.get(x)):yA;t.edgeStrength===void 0&&(t.edgeStrength=.5),t.gpu&&(t.edgeStrength/=bH),t.gravity==null&&(t.gravity=.01),t.siblingsOffset==null&&(t.siblingsOffset=0),t.theta==null&&(t.theta=.62),t.autoStop=!!t.autoStop,t.alignSiblings=!!t.alignSiblings;const y=t.radiusRatio||EH;for(let x=0;x<t.nodes._indexes.length;x++){const v=t.nodes._indexes[x];g[v]=x,u.push({id:x,x:i[x],y:r[x],r:o[x]*y,mass:m(x),pinned:!a[x]})}l.forEach((x=>{const v=g[x.getSource()._index],b=g[x.getTarget()._index];v!==b&&v!==void 0&&b!==void 0&&h.push({source:v,target:b,weight:f(x)})}));const p=Nf({...t});return delete p.nodes,delete p.edges,{graph:{nodes:u,edges:h},options:p,indexes:t.nodes._indexes,done:!1,x:i,y:r,chunkPeriod:250}},update:function(t,e){if(!e.simulation&&t){let s;e.done=!1,e.graph=t.graph,e.options=t.options,e.indexes=t.indexes;let n=!1;if(t.options.gpu){const l=Y2("webgl2",{},(()=>{Uo("GPU layout: WebGL context not available. Falling back on CPU."),e.simulation=void 0,e.options.gpu=!1,e.cleanUp&&e.cleanUp(),this._update(t,e)}));l&&(s=l.context,e.cleanUp=l.cleanUp),n=!!s}let i=Date.now();n||(t.options.nextTick=l=>Date.now()-i<=e.chunkPeriod?l():(i=Date.now(),setTimeout(l,0))),t.options.update=(l,u,h)=>{e.x=u,e.y=h},t.options.onEnd=()=>{if(n&&s){const{X:l,Y:u}=e.simulation.data(!0);e.x=l,e.y=u}e.done=!0,e.simulation=void 0,e.cleanUp&&e.cleanUp()},t.options.bucketSize=0;const r=n&&s?Ug(t.graph,s,t.options).start():_A(t.graph,t.options).start();e.simulation=r;const{X:o,Y:a}=n&&s?{X:new Float32Array(t.graph.nodes.length),Y:new Float32Array(t.graph.nodes.length)}:r.data();e.x=o,e.y=a}return{graph:e.graph,indexes:e.indexes,x:e.x,y:e.y}},context:function(){return{done:!1,graph:{nodes:[],edges:[]},x:null,y:null,indexes:null,chunkPeriod:250}},stop:function(t){t.done=!0,t.simulation&&(t.simulation.stop(),delete t.simulation)},isRunning:function(t){return!t.done||(t.done=!1,!1)},onSync:function({indexes:t,x:e,y:s}){return{indexes:t,x:e,y:s}}};function SH(t,e,s,n,i){return{x:t+i*(s-t),y:e+i*(n-e)}}var AH=10;function wH(t,e,s){let n,i,r=1/0;for(let o=0,a=e.length;o<a;o++){const l=e[o],u=e[(o+1)%a],h=Qx(t[0],t[1],l[0],l[1],u[0],u[1]);h<r&&(r=h,n=l,i=u)}return TH(t[0],t[1],n[0],n[1],i[0],i[1],s)}function TH(t,e,s,n,i,r,o){const a=oC(t,e,s,n,i,r);let l=-(n-r),u=s-i;const h=Math.sqrt(l*l+u*u);return l/=h,u/=h,[a.x-o*l,a.y-o*u]}function CH(t,e,s,n){for(let i=0;i<t.length;i++){const[r,o]=t[i],a=Math.abs(r-e),l=Math.abs(o-s);if(a+l<=n||!(a>n||l>n)&&a*a+l*l<=n*n)return!0}return!1}function LH(t,e,s){const n=iC(s.cx,s.cy,t,e,s.minX,s.minY,s.maxX,s.maxY);let i,r=1/0,o={x:s.maxX,y:e};for(const a of n)i=pn(t,e,a.x,a.y),i<r&&(r=i,o=a);return o}function NH(t){const e=t.bottomLeft(),s=t.topRight();return[[e.x,e.y],[e.x,s.y],[s.x,s.y],[s.x,e.y]]}function MH(t,e,s,n){const i=[],r=[],o=[];return t.forEach(((a,l)=>{n[l]&&(i.push(a),r.push(e[l]),o.push(s[l]))})),{ids:i,subgraphPositions:r,radii:o}}function IH(t,e,s){const{duration:n=0,margin:i=5,referenceNodes:r,nodes:o}=e,{ids:a,subgraphPositions:l,radii:u}=MH(o.getId(),s,o.getAttribute("radius"),o.getAttribute("layoutable")),h=t.getNodes(a);let g=r;!g||g instanceof io||(g=t.getNodes(g));const f=g||h.inverse(),m=f.getPosition().map((F=>[F.x,F.y])),y=h.getBoundingBox(),p=f.getBoundingBox();p.pad(p.maxScaledSize);const x={layoutName:"incremental",ids:h.getId(),positions:{before:l,current:l}};if(!h.size)return Promise.resolve(x);const v=_h(l.map((F=>F.x)),l.map((F=>F.y)),u),[b,S]=v,A=v[2]+p.maxScaledSize+i;let w,L=0,k=0;if(CH(m,b,S,A))if(f.size<=3){if(kx(b,S,v[2],p.minX,p.minY,p.maxX,p.maxY)){const F=LH(b,S,p);w=pn(p.cx,p.cy,F.x,F.y);const O=SH(p.cx,p.cy,F.x,F.y,(w+A)/w);L=O.x-b,k=O.y-S}}else{const F=Lx.from(m,(at=>at[0]),(at=>at[1])),O=Gd(F.triangles,m),j=m.length>3?Gd(F.hull,m):NH(p),V=ZT(f.getPosition(),AH,A,O,j);let Z=wH([b,S],j,A);if(V.length>0){let at=Math.pow(b-Z[0],2)+Math.pow(S-Z[1],2);for(const mt of V)L=b-mt[0],k=S-mt[1],w=L*L+k*k,w<at&&(at=w,Z=mt.slice(0,2));L=Z[0]-b,k=Z[1]-S}else L=Z[0]-y.cx,k=Z[1]-y.cy}if(L||k){const F=l.map((O=>(O.x+=L,O.y+=k,O)));if(e.locate){typeof e.locate=="boolean"&&(e.locate={});const O=t.modules.locate.layoutDataBoundingBox({x:[...m.map((V=>V[0])),...F.map((V=>V.x))],y:[...m.map((V=>V[1])),...F.map((V=>V.y))],indexes:t.getNodes()._indexes}),j=t.modules.locate.computeConfigForBounds(O,e.locate);t.modules.camera.setView(j,{duration:n,easing:e.locate.easing,ignoreZoomLimits:!0})}return x.positions.current=F,h.setAttributes(F,n).then((()=>x))}return h.setAttributes(l,n).then((()=>x))}function kH(t,e,s){const n=Ws(e);return n.duration=0,n.dryRun=!0,n.locate=!1,delete n.incremental,s(n).then((i=>IH(t,e,i.positions.current)))}function RH(t,e,s){const{nodes:n,duration:i,centralNode:r}=e,o=n,a=o.reduce(((u,h)=>(u[h._index]=!0,u)),{}),l=t.getNodes();if(e.focusOnGroupShape)return s({nodes:o,duration:0}).then((()=>{const u=o.concat(r),h=u.getAttribute("layoutable");return u.setAttributes({layoutable:!1}),s({nodes:t.getNodes(),duration:i}).then((()=>u.setAttributes(h)))}));{const u=Ws(e);return delete u.centralNode,u.incremental=!1,u.nodes=l,u.nodeMass=(h,g)=>(g+1)*(a[h._index]?1:2),s(u)}}function oM(t,e,s){const n=EN(e.modules.graph,t);if(typeof n.incremental!="boolean"&&"margin"in n.incremental&&!isFinite(n.incremental.margin))throw new Error("Incremental layout: margin has to be a positive number");const i=Ws(n);return typeof n.incremental!="boolean"&&(i.margin=n.incremental.margin,i.referenceNodes=n.incremental.referenceNodes),i.centralNode&&!i.centralNode.getAttribute("layoutable")?RH(e,i,s):kH(e,i,s)}var FH=t=>(t.modules.layouts.register(xA),(e={})=>{if(e.incremental)return oM(e,t,t.layouts.force);if(e.edgeStrength!==void 0&&(!isFinite(e.edgeStrength)||e.edgeStrength<0))throw new Error("force layout: edgeStrength must be a positive number");if(e.steps!==void 0&&(!isFinite(e.steps)||e.steps<=0))throw new Error("force layout: 'steps' must be a positive integer");if(e.edgeLength!==void 0&&(!isFinite(e.edgeLength)||e.edgeLength<=0))throw new Error("force layout: 'edgeLength' must be positive");if(e.gravity!==void 0&&(!isFinite(e.gravity)||e.gravity<0||e.gravity>=1))throw new Error("force layout: 'gravity' must be between 0 and 1");if(e.charge!==void 0&&!isFinite(e.charge))throw new Error("force layout: 'charge' must be a number");if(e.radiusRatio!==void 0&&(!isFinite(e.radiusRatio)||e.radiusRatio<0))throw new Error("force layout: 'radiusRatio' must be a positive number");if(e.theta!==void 0&&(!isFinite(e.theta)||e.theta<0||e.theta>1))throw new Error("force layout: 'theta' must be between 0 and 1");if(!(e.cx===void 0&&e.cy===void 0||typeof e.cx=="number"&&typeof e.cy=="number"))throw new Error("force layout: both 'cx' and 'cy' must be numbers");if(e.siblingsOffset!==void 0&&!isFinite(e.siblingsOffset))throw new Error("force layout: 'siblingsOffset' must be a number");return e.gpu=!!e.gpu,e.gpu&&(e.useWebWorker=!1),t.modules.layouts.start(xA.name,e)}),vA={name:"forceLink",configure:function(t,{graph:e,camera:s,graphics:n}){const i=t.nodes._indexes,r=t.edges._indexes,o={},a={},l=i.length,u=r.length;let h;var g=e.getObjectList(!0),f=e.getObjectList(!1);(t.nodes||t.edges)&&(delete(t=Ws(t)).nodes,delete t.edges);const m=e.getNodeAttribute("innerStroke.width").getMultiple(i),y=e.getNodeAttribute("outerStroke.width").getMultiple(i),p=e.degrees(i),x=t.xs?t.xs:e.getNodeAttribute("x").getMultiple(i),v=t.ys?t.ys:e.getNodeAttribute("y").getMultiple(i),b=t.rs?t.rs:e.getNodeAttribute("radius").getMultiple(i),S=e.nodeList(i).getAttribute("layoutable"),A=typeof t.nodeMass=="function"?t.nodeMass:function(K,ut,ht){return ut+1};delete t.nodeMass;const w=typeof t.edgeWeight=="function"?t.edgeWeight:function(K){return 1};delete t.edgeWeight,isFinite(t.scalingRatio)||delete t.scalingRatio;const L=i.reduce(((K,ut,ht)=>(S[ht]||(K[ut]=!0),K)),{});let k=0,F=0,O=0;const j=s.getZoom();for(h=0;h<i.length;++h){const K=i[h],ut=x[h],ht=v[h],nt=b[h]+(m[h]+y[h])/j;o[K]={id:K,x:ut,y:ht,degree:p[h],size:nt,pinned:!!L[K],mass:A(g.get(K),p[h],h)},O=Math.max(nt,O)}if(l>1)for(h=0;h<l;h++){const K=o[i[h]];k+=K.x,F+=K.y}k/=l,F/=l;const V={x:k,y:F},Z=e.edgeList(r),at=Z.getSource()._indexes,mt=Z.getTarget()._indexes;for(h=0;h<u;h++){const K=r[h],ut=at[h],ht=mt[h];o[ut]&&o[ht]&&(a[K]={source:ut,target:ht},a[K].weight=w(f.get(K)))}return{nodes:o,edges:a,maxSize:O,config:Nf(t),barycentre:V}},context:function(){return{chunkPeriod:250}},update:function(t,e){let s;!e.W&&t?(s={ppn:10,ppe:3,ppr:9,MAX_SUBDIVISION_RETRIES:3,maxForce:10,iterations:0,converged:!1,settings:{linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:0,scalingRatio:100,strongGravityMode:!0,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5,startingIterations:10,iterationsPerRender:10,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:!0,alignNodeSiblings:!0,nodeSiblingsScale:5,nodeSiblingsAngleMin:0}},e.W=s,(function(u,h){const g=(function(m,y){let p,x,v,b=m.nodes,S=m.edges,A=m.maxSize,w=Object.keys(m.nodes),L=Object.keys(m.edges),k=w.length*s.ppn,F=L.length*s.ppe,O={};const j=Math.pow(10,Math.log(Math.max(A,1))-6),V=j/2,Z=Math.random,at=y.randomizeFactor||1;let mt;mt=y.randomize==="locally"?ht=>ht+Z()*at:y.randomize==="globally"?ht=>Z()*at:ht=>ht+Z()*j-V;const K=new Float32Array(k),ut=new Float32Array(F);for(p=x=0,v=w.length;p<v;p++){const ht=w[p],nt=b[ht];let ot=nt.x,Mt=nt.y;nt.pinned||(ot=mt(ot),Mt=mt(Mt)),O[ht]=x,K[x]=ot,K[x+1]=Mt,K[x+2]=0,K[x+3]=0,K[x+4]=0,K[x+5]=0,K[x+6]=nt.mass,K[x+7]=1,K[x+8]=nt.size,K[x+9]=nt.pinned||0,x+=s.ppn}for(p=x=0,v=L.length;p<v;p++){const ht=S[L[p]];ut[x]=O[ht.source],ut[x+1]=O[ht.target],ut[x+2]=ht.weight||0,x+=s.ppe}return{nodes:K,edges:ut}})(u,h);e.NodeMatrix=g.nodes,e.EdgeMatrix=g.edges,s.nodesLength=e.NodeMatrix.length,s.edgesLength=e.EdgeMatrix.length})(t,t.config),s.settings=(function(u,h){for(const g in u)h[g]=u[g];return h})(t.config,s.settings),e.nodes=t.nodes,e.edges=t.edges,e.barycentre=t.barycentre):s=e.W;let n,i=e.NodeMatrix,r=e.EdgeMatrix;function o(){let l,u,h,g,f,m,y,p,x,v,b,S,A,w,L,k,F;for(h=0;h<s.nodesLength;h+=s.ppn)i[h+4]=i[h+2],i[h+5]=i[h+3],i[h+2]=0,i[h+3]=0;if(s.settings.outboundAttractionDistribution){for(x=0,h=0;h<s.nodesLength;h+=s.ppn)x+=i[h+6];x/=s.nodesLength}if(s.settings.barnesHutOptimize){let mt,K,ut,ht,nt=1/0,ot=-1/0,Mt=1/0,Q=-1/0;for(n=[],h=0;h<s.nodesLength;h+=s.ppn)nt=Math.min(nt,i[h+0]),ot=Math.max(ot,i[h+0]),Mt=Math.min(Mt,i[h+1]),Q=Math.max(Q,i[h+1]);const Et=ot-nt,qt=Q-Mt;for(Et>qt?(Mt-=(Et-qt)/2,Q=Mt+Et):(nt-=(qt-Et)/2,ot=nt+qt),n[0]=-1,n[1]=(nt+ot)/2,n[2]=(Mt+Q)/2,n[3]=Math.max(ot-nt,Q-Mt),n[4]=-1,n[5]=-1,n[6]=0,n[7]=0,n[8]=0,l=1,h=0;h<s.nodesLength;h+=s.ppn)for(u=0,ut=s.MAX_SUBDIVISION_RETRIES;;){if(!(n[u+5]>=0)){if(n[u+0]<0){n[u+0]=h;break}if(n[u+5]=l*s.ppr,y=n[u+3]/2,p=n[u+5],n[p+0]=-1,n[p+1]=n[u+1]-y,n[p+2]=n[u+2]-y,n[p+3]=y,n[p+4]=p+s.ppr,n[p+5]=-1,n[p+6]=0,n[p+7]=0,n[p+8]=0,p+=s.ppr,n[p+0]=-1,n[p+1]=n[u+1]-y,n[p+2]=n[u+2]+y,n[p+3]=y,n[p+4]=p+s.ppr,n[p+5]=-1,n[p+6]=0,n[p+7]=0,n[p+8]=0,p+=s.ppr,n[p+0]=-1,n[p+1]=n[u+1]+y,n[p+2]=n[u+2]-y,n[p+3]=y,n[p+4]=p+s.ppr,n[p+5]=-1,n[p+6]=0,n[p+7]=0,n[p+8]=0,p+=s.ppr,n[p+0]=-1,n[p+1]=n[u+1]+y,n[p+2]=n[u+2]+y,n[p+3]=y,n[p+4]=n[u+4],n[p+5]=-1,n[p+6]=0,n[p+7]=0,n[p+8]=0,l+=4,ht=u+0,mt=i[n[ht]+0]<n[u+1]?i[n[ht]+1]<n[u+2]?n[u+5]:n[u+5]+s.ppr:i[n[ht]+1]<n[u+2]?n[u+5]+2*s.ppr:n[u+5]+3*s.ppr,n[u+6]=i[n[ht]+6],n[u+7]=i[n[ht]+0],n[u+8]=i[n[ht]+1],n[mt+0]=n[u+0],n[u+0]=-1,K=i[h+0]<n[u+1]?i[h+1]<n[u+2]?n[u+5]:n[u+5]+s.ppr:i[h+1]<n[u+2]?n[u+5]+2*s.ppr:n[u+5]+3*s.ppr,mt===K){if(ut--){u=mt;continue}ut=s.MAX_SUBDIVISION_RETRIES;break}n[K+0]=h;break}mt=i[h+0]<n[u+1]?i[h+1]<n[u+2]?n[u+5]:n[u+5]+s.ppr:i[h+1]<n[u+2]?n[u+5]+2*s.ppr:n[u+5]+3*s.ppr,n[u+7]=(n[u+7]*n[u+6]+i[h+0]*i[h+6])/(n[u+6]+i[h+6]),n[u+8]=(n[u+8]*n[u+6]+i[h+1]*i[h+6])/(n[u+6]+i[h+6]),n[u+6]+=i[h+6],u=mt}}if(s.settings.barnesHutOptimize)for(v=s.settings.scalingRatio,h=0;h<s.nodesLength;h+=s.ppn)for(u=0;;)if(n[u+5]>=0){if(k=Math.sqrt((i[h+0]-n[u+7])*(i[h+0]-n[u+7])+(i[h+1]-n[u+8])*(i[h+1]-n[u+8])),2*n[u+3]/k<s.settings.barnesHutTheta){if(b=i[h+0]-n[u+7],S=i[h+1]-n[u+8],s.settings.adjustSizes?k>0?(F=v*i[h+6]*n[u+6]/k/k,i[h+2]+=b*F,i[h+3]+=S*F):k<0&&(F=-v*i[h+6]*n[u+6]/k,i[h+2]+=b*F,i[h+3]+=S*F):k>0&&(F=v*i[h+6]*n[u+6]/k/k,i[h+2]+=b*F,i[h+3]+=S*F),n[u+4]<0)break;u=n[u+4];continue}u=n[u+5]}else{if(n[u+0]>=0&&n[u+0]!==h&&(b=i[h+0]-i[n[u+0]+0],S=i[h+1]-i[n[u+0]+1],k=Math.sqrt(b*b+S*S),s.settings.adjustSizes?k>0?(F=v*i[h+6]*i[n[u+0]+6]/k/k,i[h+2]+=b*F,i[h+3]+=S*F):k<0&&(F=-v*i[h+6]*i[n[u+0]+6]/k,i[h+2]+=b*F,i[h+3]+=S*F):k>0&&(F=v*i[h+6]*i[n[u+0]+6]/k/k,i[h+2]+=b*F,i[h+3]+=S*F)),n[u+4]<0)break;u=n[u+4]}else for(v=s.settings.scalingRatio,g=0;g<s.nodesLength;g+=s.ppn)for(f=0;f<g;f+=s.ppn)b=i[g+0]-i[f+0],S=i[g+1]-i[f+1],s.settings.adjustSizes?(k=Math.sqrt(b*b+S*S)-i[g+8]-i[f+8],k>0?(F=v*i[g+6]*i[f+6]/k/k,i[g+2]+=b*F,i[g+3]+=S*F,i[f+2]+=b*F,i[f+3]+=S*F):k<0&&(F=100*v*i[g+6]*i[f+6],i[g+2]+=b*F,i[g+3]+=S*F,i[f+2]-=b*F,i[f+3]-=S*F)):(k=Math.sqrt(b*b+S*S),k>0&&(F=v*i[g+6]*i[f+6]/k/k,i[g+2]+=b*F,i[g+3]+=S*F,i[f+2]-=b*F,i[f+3]-=S*F));for(p=s.settings.gravity/s.settings.scalingRatio,v=s.settings.scalingRatio,h=0;h<s.nodesLength;h+=s.ppn)F=0,b=i[h+0],S=i[h+1],k=Math.sqrt(b*b+S*S),s.settings.strongGravityMode?k>0&&(F=v*i[h+6]*p):k>0&&(F=v*i[h+6]*p/k),i[h+2]-=b*F,i[h+3]-=S*F;for(v=1*(s.settings.outboundAttractionDistribution?x:1),m=0;m<s.edgesLength;m+=s.ppe)g=r[m+0],f=r[m+1],y=r[m+2],L=Math.pow(y,s.settings.edgeWeightInfluence),b=i[g+0]-i[f+0],S=i[g+1]-i[f+1],s.settings.adjustSizes?(k=Math.sqrt(b*b+S*S)-i[g+8]-i[f+8],s.settings.linLogMode?s.settings.outboundAttractionDistribution?k>0&&(F=-v*L*Math.log(1+k)/k/i[g+6]):k>0&&(F=-v*L*Math.log(1+k)/k):s.settings.outboundAttractionDistribution?k>0&&(F=-v*L/i[g+6]):k>0&&(F=-v*L)):(k=Math.sqrt(b*b+S*S),s.settings.linLogMode?s.settings.outboundAttractionDistribution?k>0&&(F=-v*L*Math.log(1+k)/k/i[g+6]):k>0&&(F=-v*L*Math.log(1+k)/k):s.settings.outboundAttractionDistribution?(k=1,F=-v*L/i[g+6]):(k=1,F=-v*L)),k>0&&(i[g+2]+=b*F,i[g+3]+=S*F,i[f+2]-=b*F,i[f+3]-=S*F);let O,j,V,Z,at=0;if(s.settings.adjustSizes)for(h=0;h<s.nodesLength;h+=s.ppn)i[h+9]||(O=Math.sqrt(i[h+2]*i[h+2]+i[h+3]*i[h+3]),O>s.maxForce&&(i[h+2]=i[h+2]*s.maxForce/O,i[h+3]=i[h+3]*s.maxForce/O),j=i[h+6]*Math.sqrt((i[h+4]-i[h+2])*(i[h+4]-i[h+2])+(i[h+5]-i[h+3])*(i[h+5]-i[h+3])),V=Math.sqrt((i[h+4]+i[h+2])*(i[h+4]+i[h+2])+(i[h+5]+i[h+3])*(i[h+5]+i[h+3]))/2,Z=.1*Math.log(1+V)/(1+Math.sqrt(j)),A=i[h+0],w=i[h+1],i[h+0]=i[h+0]+i[h+2]*(Z/s.settings.slowDown),i[h+1]=i[h+1]+i[h+3]*(Z/s.settings.slowDown),b=i[h+0],S=i[h+1],k=Math.sqrt((b-A)*(b-A)+(S-w)*(S-w)),at+=k);else for(h=0;h<s.nodesLength;h+=s.ppn)i[h+9]||(j=i[h+6]*Math.sqrt((i[h+4]-i[h+2])*(i[h+4]-i[h+2])+(i[h+5]-i[h+3])*(i[h+5]-i[h+3])),V=Math.sqrt((i[h+4]+i[h+2])*(i[h+4]+i[h+2])+(i[h+5]+i[h+3])*(i[h+5]+i[h+3]))/2,Z=i[h+7]*Math.log(1+V)/(1+Math.sqrt(j)),i[h+7]=Math.min(1,Math.sqrt(Z*(i[h+2]*i[h+2]+i[h+3]*i[h+3])/(1+Math.sqrt(j)))),A=i[h+0],w=i[h+1],i[h+0]=i[h+0]+i[h+2]*(Z/s.settings.slowDown),i[h+1]=i[h+1]+i[h+3]*(Z/s.settings.slowDown),b=i[h+0],S=i[h+1],k=Math.sqrt((b-A)*(b-A)+(S-w)*(S-w)),at+=k);if(s.iterations++,s.settings.autoStop&&(s.converged=s.iterations>s.settings.maxIterations||at/s.nodesLength<s.settings.avgDistanceThreshold,s.converged&&s.settings.alignNodeSiblings)){let mt,K,ut={},ht={};for(m=0;m<s.edgesLength;m+=s.ppe)g=r[m+0],f=r[m+1],g!==f&&(ut[g]=ut[g]||{},ut[f]=ut[f]||{},ut[g][f]=!0,ut[f][g]=!0);Object.keys(ut).forEach((Me=>{var ge=~~Me;K=Object.keys(ut[ge]),K.length==2&&(mt=K[0]+";"+K[1],mt in ht||(mt=K[1]+";"+K[0],ht[mt]||(ht[mt]=[~~K[1],~~K[0]])),ht[mt].push(ge))}));let nt,ot,Mt,Q,Et,qt,Vt,Wt,oe,me,se,Jt,ee,ce,Ce,ve=s.settings.nodeSiblingsAngleMin;Object.keys(ht).forEach((Me=>{if(ot=ht[Me].shift(),Mt=ht[Me].shift(),nt=ht[Me].filter((Ge=>!i[Ge+9])),nt.length==1)return;if(qt=i[ot+0],Vt=i[ot+1],Wt=i[Mt+0],oe=i[Mt+1],Q=Object.keys(ut[ot]).length,Et=Object.keys(ut[Mt]).length,me=(function(De,He,Je,ss,ts){return(ts-ss)*(De-He)/(Je-He)+ss})(Q/(Q+Et),0,1,1/4,3/4),Jt=(function(De,He,Je,ss,ts){return{x:De+(Je-De)*ts,y:He+(ss-He)*ts}})(qt,Vt,Wt,oe,me),ee=(function(De,He,Je,ss){return{xi:-(ss-He),yi:Je-De,xiPrime:ss-He,yiPrime:-(Je-De)}})(qt,Vt,Wt,oe),se=(function(De,He,Je,ss){const ts=Je-De,hs=ss-He;return Math.sqrt(ts*ts+hs*hs)})(qt,Vt,Wt,oe),ce=(function(De,He){return{x:(De.xiPrime-De.xi)/He,y:(De.yiPrime-De.yi)/He}})(ee,se),Ce=(function(De){return Math.acos(De.x/Math.sqrt(De.x*De.x+De.y*De.y))})(ce),2*ve>Math.PI)throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.");ve>0&&(Ce<ve||Ce>Math.PI-ve&&Ce<=Math.PI?ce={x:2*Math.cos(Math.PI-ve),y:2*Math.sin(Math.PI-ve)}:(Ce>2*Math.PI-ve||Ce>=Math.PI&&Ce<Math.PI+ve)&&(ce={x:2*Math.cos(ve),y:2*Math.sin(ve)}));let ge=0,ze=1,is=1;nt.length%2==1&&(is=0,ge=1);for(let Ge=0;Ge<nt.length;Ge++)i[nt[Ge]+0]=Jt.x+ze*ce.x*is*(ge||Ge>=2?s.settings.nodeSiblingsScale:2*s.settings.nodeSiblingsScale/3),i[nt[Ge]+1]=Jt.y+ze*ce.y*is*(ge||Ge>=2?s.settings.nodeSiblingsScale:2*s.settings.nodeSiblingsScale/3),ze=-ze,is+=(Ge+ge)%2}))}}function a(l){const u=Object.keys(l),h={};for(let g=0;g<i.length;g+=s.ppn){const f=u[g/s.ppn];h[f]={id:f,x:i[g+0],y:i[g+1],pinned:i[g+9]}}return h}return(function(){if(s.settings.autoStop){const u=Date.now();for(;!(s.converged||Date.now()-u>=e.chunkPeriod);)o()}else{const u=s.iterations===0?s.settings.startingIterations:s.iterations+s.settings.iterationsPerRender;for(;s.iterations!==u;)o()}return{nodes:a(e.nodes),barycentre:e.barycentre}})()},isRunning:function(t){return!t.W.settings.autoStop||!t.W.converged||(t.W=void 0,!1)},stop:function(t){t.W&&(t.W.converged=!0)},onSync:function({nodes:t,barycentre:e},{graph:s}){const n=Object.keys(t),i=n.length;let r,o,a,l,u,h,g,f,m=0,y=0;const p=new Array(i),x=new Array(i),v=new Array(i),b=new Array(i),[S,A]=s.getAttributes(!0,["x","y"]);for(r=0;r<i;r++)o=n[r],a=t[o],f=parseInt(o),p[r]=f,b[r]=a.pinned,a.pinned?(l=S.get(f),u=A.get(f)):(l=a.x,u=a.y),x[r]=l,v[r]=u,m+=l,y+=u;for(h=m/i-e.x,g=y/i-e.y,r=0;r<i;r++)b[r]||(x[r]-=h,v[r]-=g);return{indexes:p,x,y:v}}},PH=t=>(t.modules.layouts.register(vA),(e={})=>e.incremental?oM(e,t,t.layouts.forceLink):t.modules.layouts.start(vA.name,e)),bA={name:"grid",configure:function(t,{graph:e,camera:s}){function n(w){return w===void 0||typeof w=="number"&&isFinite(w)&&w>0}const i=t.sortBy,r=t,o=r.nodes,a=Array.from(o._indexes),l=a.length,{rows:u,cols:h,rowDistance:g,colDistance:f}=(function(L,k,F,O,j){if(!n(k))throw new TypeError('"rows" should be a positive integer');if(!n(F))throw new TypeError('"cols" should be a positive integer');if(!n(O))throw new TypeError('"rowDistance" should be a positive number');if(!n(j))throw new TypeError('"colDistance" should be a positive number');if(k)return{rows:k,cols:Math.ceil(L/k),rowDistance:O,colDistance:j};if(F)return{cols:F,rows:Math.ceil(L/F),rowDistance:O,colDistance:j};const V=Math.ceil(Math.sqrt(L));return{cols:V,rows:Math.ceil(L/V),rowDistance:O,colDistance:j}})(l,r.rows,r.cols,r.colDistance,r.rowDistance),m=(function(L,k,F,O,j){return typeof L!="string"?O.map(((V,Z)=>Z)):L==="radius"?k.getAttribute(!0,"radius").getMultiple(O):L==="degree"?F.getDegree():L==="random"?O.map((()=>Math.random())):F.getData(L).map((V=>V||j))})(i,e,o,a,t.sortFallbackValue),y=o.getAttribute("layoutable"),p=a.reduce(((w,L,k)=>(y[k]&&w.push({id:L,attr:m[k]}),w)),[]),x=o.getAttribute("x"),v=o.getAttribute("y"),b=o.getAttribute("radius");let S=1/0,A=1/0;for(let w=0;w<a.length;w++)S=Math.min(S,x[w]),A=Math.min(A,v[w]);return{sort:!!i,nodes:p,reverse:!!r.reverse,cols:h,rows:u,minX:S,minY:A,rs:b,rowDistance:g,colDistance:f}},update:function({sort:t,nodes:e,minX:s,rs:n,minY:i,reverse:r,cols:o,rowDistance:a,colDistance:l}){const u=e.map(((v,b)=>b));t&&u.sort(((v,b)=>e[v].attr-e[b].attr)),r&&u.reverse();let h=0;for(let v=0;v<e.length;v++){const b=v>0&&(v+1)%o==0,S=v%o==0,A=b?0:n[u[v+1]]||0,w=S?0:n[u[v+o-1]]||0,L=n[u[v+o]]||0,k=b?0:n[u[v+o+1]]||0,F=n[u[v]]||0;h=Math.max(h,F+A,F+w,F+L,F+k)}let g=h+5,f=h+5;const m=s,y=i;isFinite(g)||(g=0),isFinite(f)||(f=0),a!==void 0&&isFinite(a)&&(g=h+a),l!==void 0&&isFinite(l)&&(f=h+l);let p=0,x=0;return u.forEach((v=>{const b=e[v];b.x=m+p*g,b.y=y+x*f,p+=1,p===o&&(x+=1,p=0)})),e},onSync:function(t){return{indexes:t.map((({id:e})=>e)),x:t.map((({x:e})=>e)),y:t.map((({y:e})=>e))}}},zH=t=>(t.modules.layouts.register(bA),(e={})=>t.modules.layouts.start(bA.name,e)),x0={id:"__SENTINEL__",layer:-1,sink:!1,fixed:!1,siblingIndex:-1,parentIds:[],children:[],radius:0,ref:null},Sd=t=>t.data===x0||!1,$y=t=>!Sd(t),DH=[],OH=(t,e)=>({id:t,layer:e,data:x0,children:DH,ref:void 0,x:0,y:0}),aM=(t,e)=>({id:t,layer:-1,data:e,children:[],x:0,y:0}),EA=class{constructor(t,e,s){this.data=t,this.prev=e,this.next=s}toString(){return this.data}},lM=t=>t.reduce(((e,s)=>(e[s]=!0,e)),{});function BH(t,e){const s=[t],n=lM(s),i=[t];for(;s.length;){const r=s.shift();for(const o of e.get(r))n[o]||(n[o]=!0,i.push(o),s.push(o))}return i}function v0(t){return t.reduce(((e,{source:s,target:n})=>(e.set(s,e.get(s)||[]),e.set(n,e.get(n)||[]),e.get(s).push(n),e.get(n).push(s),e)),new Map)}function UH(t){return t.reduce(((e,{source:s,target:n})=>(e[s]=e[s]||[],e[s].push(n),e)),{})}function GH(t,e,s){const n=s||v0(e||[]);return t.filter((({id:i})=>!n.has(i)))}function VH(t,e){const s=lM(e);return t.filter((n=>!(n in s)))}function Di(t,e){t.forEach(((s,n)=>{s.forEach(((i,r,o)=>{e(i,r,o,n)}))}))}var SA=t=>{const e=Math.floor(t.length/2);return(t=[...t].sort(((s,n)=>s-n))).length%2!=0?t[e]:(t[e-1]+t[e])/2};function jH(t,e,s){const n=v0(e);let i=Array.from(n.keys());const r=[];for(;i.length;){const o=BH(i[0],n);r.push(o),i=VH(i,o)}return s.skipSingletons?r:r.concat(GH(t,e,n).map((({id:o})=>[o])))}var Gg=({id:t,layer:e,sink:s,siblingIndex:n,radius:i,layoutable:r})=>({id:t,layer:e!==void 0?e:void 0,sink:s,siblingIndex:n||0,radius:i||0,fixed:r===!1,parentIds:[],children:[],ref:null});function HH(t){const e={x:0,y:0};let s=0;for(let n=0;n<t.length;n++){const i=t[n];for(let r=0;r<i.nodes.length;r++){const o=i.nodes[r];e.x+=o.x||0,e.y+=o.y||0,s++}}return e.x/=s,e.y/=s,e}function $H(t){const e={x:0,y:0};let s=0;for(const[,{x:n,y:i}]of t)e.x+=n||0,e.y+=i||0,s++;return e.x/=s,e.y/=s,e}function qH(t,e,s){const n=HH(s),i=t.x-n.x,r=t.y-n.y;for(let o=0;o<s.length;o++){const a=s[o];for(let l=0;l<a.nodes.length;l++){const u=a.nodes[l],h=e.get(u.id);!h||u.data&&u.data.fixed||(h.x=u.x+i,h.y=u.y+r)}}}function AA(t){return Math.ceil(Math.sqrt(t))}var wA=5,YH=class{constructor(t,e,s=0,n=!1){this.groupToSubNodes=new Map,this.nodeToGroup=new Map,this.lookup=new Map,this.shouldPackSiblings=!0,this.shouldSort=!1,this.shouldPackSiblings=t,this.packSiblingsFn=e||(()=>1),this.siblingsGap=s,this.shouldSort=n}packSiblings(t){if(!this.shouldPackSiblings)return;const e=this.groupToSubNodes,s=this.nodeToGroup,n=this.siblingsGap,i=this.packSiblingsFn,r=[],o=new Set,a=new Map,l=new Map,u=this.lookup;t.nodes.forEach((h=>{u.set(h.id,h)})),t.nodes.forEach((h=>{if(!h.children.length)return;const g=[];h.children.forEach((f=>{f.id===h.id||f.children.length||g.push(f)})),!(g.length<wA)&&l.set(h.id,g)})),l.forEach(((h,g)=>{const f=new Map;h.length<wA||(h.forEach((m=>{if(a.has(m.id))return;const y=i(m.data);if(y===void 0)return;const p=`${g}-${y}`;a.set(m.id,p),f.has(p)?f.get(p).push(m):f.set(p,[m])})),f.forEach(((m,y)=>{this.shouldSort&&m.sort(((S,A)=>S.data.siblingIndex-A.data.siblingIndex));const p=AA(m.length);let x=p*n;for(let S=0;S<p;S++){let A=0;for(let w=0;w<p;w++){const L=m[S*p+w];A=Math.max(A,L?2*L.data.radius:0)}x+=A}x/=2,e.set(y,m);const v=m[0].layer,b=aM(y,Gg({id:y,layer:v,radius:x}));b.layer=v,u.set(y,b),r.push(b),m.forEach((S=>{s.set(S.id,y),o.add(S.id)}))})))})),t.nodes=t.nodes.filter((h=>o.has(h.id)===!1)),r.forEach((h=>{t.nodes.push(h)})),t.nodes.forEach((h=>{const g=new Set;h.children=h.children.filter((f=>{if(!a.has(f.id))return!0;const m=a.get(f.id);return g.add(m),!1})),h.children.push(...Array.from(g).map((f=>u.get(f))))}))}unpackSiblings(t){if(!this.shouldPackSiblings)return;const e=this.siblingsGap,s=this.groupToSubNodes,n=new Set,i=[];t.nodes.forEach((r=>{if(!s.has(r.id))return;n.add(r.id);const o=s.get(r.id)||[],a=AA(o.length),l=new Array(a).fill(0);o.forEach(((h,g)=>{i.push(h);const f=Math.floor(g/a);l[f]=Math.max(l[f],2*h.data.radius)})),l[0]-=r.data.radius;for(let h=1;h<a;h++)l[h]+=l[h-1]+e;const u=2*r.data.radius/a;o.forEach(((h,g)=>{const f=Math.floor(g/a),m=g%a;h.y=r.y+l[f],h.x=r.x-r.data.radius+m*u}))})),t.nodes=t.nodes.filter((r=>!n.has(r.id))),i.forEach((r=>{t.nodes.push(r)}))}};function WH(t){let e=0,s=0;for(const o of t)e+=o.w*o.h,s=Math.max(s,o.w);t.sort(((o,a)=>a.h-o.h));const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),s),h:1/0}];let i=0,r=0;for(const o of t)for(let a=n.length-1;a>=0;a--){const l=n[a];if(!(o.w>l.w||o.h>l.h)){if(o.x=l.x,o.y=l.y,r=Math.max(r,o.y+o.h),i=Math.max(i,o.x+o.w),o.w===l.w&&o.h===l.h){const u=n.pop();a<n.length&&(n[a]=u)}else o.h===l.h?(l.x+=o.w,l.w-=o.w):o.w===l.w?(l.y+=o.h,l.h-=o.h):(n.push({x:l.x+o.w,y:l.y,w:l.w-o.w,h:o.h}),l.y+=o.h,l.h-=o.h);break}}return{w:i,h:r,fill:e/(i*r)||0}}var XH={down:()=>{},up:t=>t.y=-t.y,left:t=>{const e=t.x;t.x=-t.y,t.y=e},right:t=>{const e=t.x;t.x=t.y,t.y=-e}},g_=(t,e)=>isFinite(t)&&t>0?t:e;function ZH(t){return{nodesSeparation:g_(t.nodesSeparation,0),componentsSeparation:g_(t.componentsSeparation,25),layerSeparation:g_(t.layerSeparation,50)}}function KH(t,{componentsSeparation:e,packing:s}){const n=[];for(let i=0;i<t.length;i++){const r=t[i],o=r.nodes;if(r.isFake&&r.w!==void 0&&r.h!==void 0){n.push({w:r.w,h:r.h,x:void 0,y:void 0,dag:r});continue}if(r.nodes.length===1){const f=2*o[0].data.radius;n.push({w:f+e/2,h:f+e/2,x:void 0,y:void 0,dag:r});continue}const{minX:a,maxX:l,minY:u,maxY:h}=o.reduce(((f,{x:m,y,data:p})=>{const x=p.radius||0;return f.minX=Math.min(f.minX,m-x),f.maxX=Math.max(f.maxX,m+x),f.minY=Math.min(f.minY,y-x),f.maxY=Math.max(f.maxY,y+x),f}),{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0}),g=(l+a)/2;o.forEach((f=>{f.x-=g})),n.push({w:Math.abs(l-a)+e/2,h:Math.abs(h-u)+e/2,minX:a,x:void 0,y:void 0,dag:r})}if(s!=="singleline")WH(n);else{let i=0;for(let r=0;r<n.length;r++){const o=n[r];o.x=i,o.y=0,i+=o.w}}return n}function QH(t,e={}){const{componentsSeparation:s}=ZH(e);e.direction===void 0&&(e.direction="down");const n=KH(t,{componentsSeparation:s,packing:e.packing});for(let i=0;i<n.length;i++){const{x:r=0,y:o=0,dag:a}=n[i];for(const l of a.nodes)l.x+=r,l.y+=o,XH[e.direction](l)}}var JH=t=>t.reduce(((e,{radius:s})=>Math.max(e,2*s)),0);function t$(t,e){return{nodes:t.map((s=>({...s,data:s}))),isFake:!0,...e}}function e$(t,e,s){const n=v0(e||[]),i=t.filter((({id:m})=>!n.has(m))).sort(((m,y)=>y.radius-m.radius)),r=Math.sqrt(i.length);let o=Math.floor(r),a=Math.ceil(r);o*a<i.length&&(o<a?o++:a++);const l=Math.max(1,JH(i)),u=Math.max(s.nodesGridSeparation||0,1),h=l*a+u*(a-1),g=l*o+u*Math.max(o-1,0),f=t$(i,{w:h,h:g});return f.nodes.forEach(((m,y)=>{const p=y%a,x=Math.floor(y/a);m.x=h*p/a,m.y=g*x/o})),f}function TA(t,e,s){const n=e.reduce(((o,a)=>(o.set(a.source,o.get(a.source)||[]),o.get(a.source).push(a),o)),new Map),{result:i}=t.reduce((function o(a,l){const{visited:u,stack:h,result:g}=a;if(u.has(l.id))return a;h.add(l.id),u.add(l.id);const f=n.get(l.id)||[];for(const m of f)h.has(m.target)?g.push(m):o(a,s.get(m.target));return h.delete(l.id),a}),{visited:new Set,stack:new Set,result:[]}),r=i.reduce(((o,{source:a,target:l})=>(o.set(a,o.get(a)||new Set),o.get(a).add(l),o)),new Map);return e.map((o=>{const{source:a,target:l,id:u}=o;return r.has(a)&&r.get(a).has(l)?{id:u,source:l,target:a}:o}))}function s$(t){if(!t||!t.length)throw Error("Cannot stratify empty data");for(const i of t){if(!i)throw Error('Node data is "null"');if(i.id==null)throw Error('Node id contains a "null" value')}const e=t.map((i=>aM(i.id,i))),s=e.reduce(((i,r)=>{if(i[r.id])throw Error(`The connected component contains id duplicates: ${r.id}`);return i[r.id]=r,i}),{}),n=[];for(let i=0;i<e.length;i++){const r=e[i];for(let o=0;o<r.data.parentIds.length;o++){const a=r.data.parentIds[o],l=s[a];if(!l)throw Error(`The node ${r.id} has a missing parent id ${a}`);l.children.push(r)}r.data.parentIds.length||n.push(r)}return{isFake:!1,nodes:n$(n)}}function n$(t){const e={},s=[];for(;t.length;){const n=t.pop();e[n.id]||(s.push(n),e[n.id]=!0,t.push(...n.children))}return s}var i$=t=>{var h,g,f;const e=[];if(t.nodes.forEach((m=>{if(m&&!isNaN(m.layer)&&m.layer!==null){if(m.layer<0)throw new Error("Layer must be greater than or equal to 0");e.push([m.id,m.layer])}})),e.length===0)return t.edges;e.sort(((m,y)=>m[1]-y[1]));const s=new Set;for(let m=0;m<e.length;m++)e[m][1]!==0&&s.add(e[m][0]);const n=new Map;for(const m of t.nodes)n.set(m.id,[]);for(const m of t.edges)(h=n.get(m.source))==null||h.push(m.target),(g=n.get(m.target))==null||g.push(m.source);if(!e.map((([,m])=>m)).some((m=>m===0))){e.sort(((x,v)=>x[1]-v[1]));const m=new Set,y=[e[0]];let p;for(;y.length>0;){const[x,v]=y.shift();if(v===0){p=x;break}m.add(x);const b=n.get(x)||[];for(const S of b)s.has(S)||m.has(S)||y.push([S,v-1])}if(p)e.push([p,0]);else{const x=e[0][1];for(let v=0;v<e.length;v++)e[v][1]-=x}}const i=e.filter((([,m])=>m===0)).map((([m])=>m)),r=i.slice(),o=new Map,a=new Map,l=new Map;for(const m of i)o.set(m,0),a.set(m,[]);for(;r.length>0;){const m=r.shift(),y=o.get(m),p=n.get(m)||[];for(const x of p){const v=o.get(x);v===void 0?(o.set(x,y+1),a.set(x,[m]),r.push(x)):v===y+1&&((f=a.get(x))==null||f.push(m))}}for(const[m,y]of a.entries())for(const p of y)l.set(p,(l.get(p)||[]).concat(m));for(const[m,y]of e)if(o.get(m)!==y)if(y===0){const p=a.get(m)||[];a.set(m,[]),p.forEach((b=>{l.set(b,(l.get(b)||[]).filter((S=>S!==m)))}));const x=t.nodes.filter((b=>o.get(b.id)===0));o.clear(),x.forEach((b=>o.set(b.id,0)));const v=x.map((b=>b.id));for(;v.length>0;){const b=v.shift(),S=o.get(b),A=l.get(b)||[];for(const w of A)o.get(w)===void 0&&(o.set(w,S+1),v.push(w))}}else{const p=t.nodes.find((S=>o.get(S.id)===y-1&&S.id!==m));if(!p)continue;const x=a.get(m)||[];a.set(m,[p.id]),x.forEach((S=>{l.set(S,(l.get(S)||[]).filter((A=>A!==m)))})),l.set(p.id,(l.get(p.id)||[]).concat(m));const v=t.nodes.filter((S=>o.get(S.id)===0));o.clear(),v.forEach((S=>o.set(S.id,0)));const b=v.map((S=>S.id));for(;b.length>0;){const S=b.shift(),A=o.get(S),w=l.get(S)||[];for(const L of w)o.get(L)===void 0&&(o.set(L,A+1),b.push(L))}}const u=[];for(const[m,y]of a.entries())if(y.length>0)for(const p of y)u.push({id:`${p}-${m}`,source:p,target:m});return u},r$=class{constructor(){this.byId={},this.byIndex={},this.length=0}append(t,e){let s;return this.head?(s=new EA(t,this.tail),this.tail=this.tail.next=s):(s=new EA(t),this.tail=this.head=s),this.byId[e]=s,this.byIndex[this.length++]=s,s}find(t){let e=this.head;do{if(e.data===t)return e;e=e.next}while(e)}forEach(t){let e=this.head,s=0;do t(e,s),s++;while(e=e.next)}},Oi=-1,en=1e-5,f_=[],o$=class{constructor(t,e,s){this.edges=[],this.nodeMap={},this.nodeIndexTopDown={},this.nodeToLayer={},this.longEdges={},this.virt={},this.height={},this.breadth={},this.first=[],this.totalW={},this.mDist={},this.X={},this.block={},this.nodeList=new r$,this.nodeDistance=e,this.layerDistance=s,this.layers=t;const{breadth:n,virt:i,height:r,nodeToLayer:o,nodeIndexTopDown:a,nodeMap:l,longEdges:u,edges:h}=this;let g=0;Di(this.layers,((p,x,v,b)=>{if(a[p.id]=g++,l[p.id]=p,o[p.id]=b,this.nodeList.append(p,p.id),p.children.forEach((A=>{const w=Sd(A)||Sd(p);h.push({source:p.id,target:A.id,virtual:w,id:h.length})})),u[p.id])return;const S=[p.id];if(u[p.id]=S,!$y(p))for(let A=0;A<p.children.length;A++){const w=p.children[A];if($y(w))continue;let L=w;for(;Sd(L);)S.push(L.id),u[L.id]=S,L=L.children[0]}}));const f=this.adjacencyList=UH(h);this.N=t.reduce(((p,x)=>p+x.length),0),this.Y=new Float32Array(t.length),this.first=t.map((p=>p[0])),t.forEach(((p,x)=>r[x]=0)),Di(this.layers,((p,x,v,b)=>{const S=f[p.id]?f[p.id].length:0;i[p.id]=Sd(p)&&S===1,this.nodeToLayer[p.id]=b,i[p.id]?n[p.id]=0:(n[p.id]=2*p.data.radius,r[b]=Math.max(r[b]||0,2*p.data.radius))}));const m={},y={};h.forEach((p=>{const x=p.source,v=p.target;m[v]=m[v]||[],m[v].push(x),y[x]=y[x]||[],y[x].push(v)})),Object.values(m).forEach((p=>{p.sort(((x,v)=>this.nodeIndexTopDown[x]-this.nodeIndexTopDown[v]))})),Object.values(y).forEach((p=>{p.sort(((x,v)=>this.nodeIndexTopDown[x]-this.nodeIndexTopDown[v]))})),this.neighbours={prev:m,next:y}}computeMinNodeDistances(){const{layers:t,totalW:e}=this;Di(t,(s=>{e[s.id]=0})),Di(t,(s=>e[s.data.id]=0)),this.layers.forEach((s=>{e[s[0].id]=0,s.slice(1).forEach(((n,i)=>{const r=s[i],o=n.id;e[o]=e[r.id]+r.data.radius+n.data.radius+this.nodeDistance}))}))}decrossVirtualEdges(){this.layers.forEach((t=>{let e=-1;t.forEach((s=>{if(!this.virt[s.id])return;const n=this.neighbours.next[s.id][0];if(this.virt[n])if(e!==-1&&e>this.nodeIndexTopDown[n]){const i=this.longEdges[s.id];let r=0;for(r=0;r<i.length&&i[r]!==n;r++);const o=i.slice(r);o.forEach((l=>this.longEdges[l]=o));const a=i.slice(0,r);a.forEach((l=>this.longEdges[l]=a))}else e=this.nodeIndexTopDown[n]}))}))}placeLongEdges(){const{X:t,layers:e}=this;Di(e,(s=>t[s.id]=0));for(let s=1;s>=-1;s-=2){const n={};let i=0;const r={};Di(e,(u=>r[u.id]=0)),r[x0.id]=0;const o=s;e.forEach((u=>{let h=o===1?u[0]:u[u.length-1];r[h.id]||(this.longEdges[h.id].forEach((m=>{r[m]=i})),i++);let g=o===1?0:u.length-1,f=g+o;for(;f>=0&&f<u.length;)h=u[f],r[h.id]||this.longEdges[h.id].forEach((m=>{r[m]=r[u[g].id]})),g=f,f+=o}));const a={};e.forEach((u=>{for(let h=o===1?0:u.length-1;o===1?h<u.length:h>=0;h+=o){const g=u[h],f=r[g.id];a[f]=a[f]||[],a[f].push(g.id)}}));const l={};this.nodeList.forEach((u=>l[u.data.id]=0));for(let u=0;u<i;u++){const h={done:!1,dist:0},g=a[u];for(let f=0;f<g.length;f++){const m=g[f];this.sortLongEdges(m,s,l,h,r,n)}if(!h.done){const f=this.layers[this.nodeToLayer[a[u][0]]],m=[];f.forEach((y=>{for(const p of this.neighbours.prev[y.id]||f_){const x=Math.abs(l[p]-l[y.id]);m.push(x)}})),m.length!==0&&(h.dist=SA(m))}for(let f=0;f<g.length;f++)l[g[f]]-=s*h.dist}Di(e,(u=>t[u.id]+=l[u.id]/2))}}sortLongEdges(t,e,s,n,i,r){if(r[t])return!1;let o=!1,a=0;const{nodeToLayer:l,totalW:u}=this,h=this.longEdges[t];h.forEach((g=>r[g]=!0)),h.forEach((g=>{const f=this.nodeList.byIndex[this.nodeIndexTopDown[g]-e];if(!f)return;const m=f.data.id,y=g,p=l[m]===l[y],x=i[m]===i[y];!p||!x||(this.sortLongEdges(m,e,s,n,i,r),(!o||e*(a-s[m])<e*(u[y]-u[m]))&&(o=!0,a=s[m]+u[y]-u[m]))})),h.forEach((g=>{s[g]=a;const f=this.nodeList.byId[g],m=e===1?f.next:f.prev;if(!m)return;const y=m.data.id,p=g,x=l[y]===l[p],v=i[y]!==i[p],b=e*(u[y]-u[p]-s[y]+s[p]);x&&v&&(!n.done||b>n.dist)&&(n.dist=b,n.done=!0)}))}placeNonVirtualNodes(){const t={};Di(this.layers,(l=>t[l.id]=-1));const{X:e,totalW:s,virt:n,nodeIndexTopDown:i,mDist:r,nodeList:o}=this,a={};Di(this.layers,((l,u,h,g)=>{if(!n[l.id])return void(a[l.id]=!1);let f=this.nodeList.byId[l.id].next;for(;f&&this.nodeToLayer[f.data.id]===g&&!n[f.data.id];)f=f.next;a[l.id]=this.nodeToLayer[f.data.id]===g&&e[f.data.id]-e[l.id]<s[f.data.id]-s[l.id]+en})),Di(this.layers,(({id:l})=>{a[l]&&t[l]===-1&&this.longEdges[l].forEach((u=>{u!==l&&(t[u]=i[u]<i[l]?1:0)}))})),Di(this.layers,(({id:l})=>r[l]=s[l]));for(let l=0;l<2;l++)for(let u=l?this.layers.length-1:0;u>=0&&u<this.layers.length;l?u--:u++){let h=Oi;const g=this.layers[u];if(g.forEach((({id:f},m,y)=>{if(n[f]){if(h===Oi){this.placeSequence(Oi,f,y[0].id,o.byId[f].prev.data.id,l);for(let p=0;p<m;p++){const x=y[p].id;r[x]=r[f]-e[f]+e[x]}}else if(t[h]!==1-l){a[h]||this.placeSequence(h,f,o.byId[h].next.data.id,o.byId[f].prev.data.id,l);const p=l===1?this.neighbours.prev:this.neighbours.next,x=p[h][0],v=p[f][0];if(n[x]&&n[v])for(let b=i[x]+1;b<i[v];b++)t[o.byIndex[b].data.id]=l}h=f}})),h===Oi)this.placeSequence(Oi,Oi,g[0].id,g[g.length-1].id,l),g.forEach((({id:f})=>r[f]=e[f]));else{this.placeSequence(h,Oi,o.byId[h].next.data.id,g[g.length-1].id,l);for(let f=g.length-1;f>=0;f--){const m=g[f].id;if(m===h)break;r[m]=r[h]-e[h]+e[m]}}}}placeSequence(t,e,s,n,i,r=0){if(r===2048)return;const o=this.nodeIndexTopDown[s],a=this.nodeIndexTopDown[n],{X:l,nodeIndexTopDown:u,mDist:h}=this;if(o===a)l[s]=this.placeNode(s,t,e,l[s],i);else if(o<a){const g=Math.floor((u[s]+u[n])/2),f=this.nodeList.byIndex[g],m=f.next.data.id,y=h[m]-h[f.data.id];this.placeSequence(t,e,s,f.data.id,i,r+1),this.placeSequence(t,e,m,n,i,r+1),this.combineSequences(t,e,s,n,m,f.data.id,i,y)}}calculateBends(t,e,s,n,i,r,o,a){let l=0;const u=[],{X:h,mDist:g,neighbours:f}=this,m=this.nodeIndexTopDown[s],y=this.nodeIndexTopDown[n];for(let p=this.nodeList.byId[r],x=this.nodeIndexTopDown[p.data.id];x>=m&&x<=y&&p;p=t===-1?p.prev:p.next,x=p&&this.nodeIndexTopDown[p.data.id]){const v=p.data.id,b=(e===0?f.prev[v]:f.next[v])||f_;let S=0;for(let w=0;w<b.length;w++){const L=b[w];if(t*(h[L]-h[v])<en)S++;else{S--;const k=h[L]+g[r]-g[v];t*(h[r]-k)>-en?l++:(a===Oi||t*(k-h[a]+g[a]-g[r])<en)&&t*(k-h[i])<o-en&&u.push({value:2,key:k})}}const A=h[v]+g[r]-g[v];t*(h[r]-A)>-en?l+=S:(a===Oi||t*(A-h[a]+g[a]-g[r])<en)&&t*(A-h[i])<o-en&&u.push({value:S,key:A})}return a!==Oi&&u.push({value:this.edges.length,key:h[a]-g[a]+g[r]}),u.sort((({key:p},{key:x})=>p-x)),{res:l,bends:u.reduce(((p,x,v)=>{if(v<u.length-1){const b=u[v+1];Math.abs(x.key-b.key)>en?x.value>0&&p.push(x):x.value+=b.value}else x.value>0&&p.push(x);return p}),[])}}combineSequences(t,e,s,n,i,r,o,a){const{X:l,mDist:u,nodeIndexTopDown:h}=this;let{res:g,bends:f}=this.calculateBends(-1,o,s,n,i,r,a,t),{res:m,bends:y}=this.calculateBends(1,o,s,n,r,i,a,e);for(f.length>0&&f.reverse();l[i]-l[r]<a-en;){let v=0,b=0;if(g<m){const S=f.length;if(S>0){const A=f.pop();v=A.value,l[r]=A.key}(S===0||l[i]-l[r]>a+en)&&(l[r]=l[i]-a)}else if(g>m){const S=y.length;if(S>0){const A=y.pop();b=A.value,l[i]=A.key}(S===0||l[i]-l[r]>a+en)&&(l[i]=l[r]+a)}else{let S=(a-l[i]+l[r])/2;const A=f.length===0?S+1:l[r]-f[f.length-1].key,w=y.length===0?S+1:y[y.length-1].key-l[i];A<S+en&&A<w+en&&(v=f.pop().value),w<S+en&&w<A+en&&(b=y.pop().value),S=Math.min(S,A,w),l[r]-=S,l[i]+=S}g+=v,m+=b}let p,x=this.nodeList.byId[r].prev;for(;x&&h[p=x.data.id]>=h[s]&&l[r]-l[p]<u[r]-u[p];)l[p]=l[r]-u[r]+u[p],x=x.prev;for(x=this.nodeList.byId[i].next;x&&h[p=x.data.id]<=h[n]&&l[i]-l[p]>u[i]-u[p];)l[p]=l[i]-u[i]+u[p],x=x.next}placeNode(t,e,s,n,i){const{X:r,neighbours:o,mDist:a}=this,l=((i===0?o.prev:o.next)[t]||f_).map((u=>r[u]));return l.length===0?r[t]:(n=SA(l),e!==Oi&&(n=Math.max(n,r[e]+a[t]-a[e])),s!==Oi&&(n=Math.min(n,r[s]+a[t]-a[s])),n)}moveLongEdge(t,e,s){const{X:n,virt:i,totalW:r,nodeList:o}=this,{id:a}=t.data;if(s[a]||!i[a])return;const l=this.longEdges[a];if(!l)return;l.forEach((p=>s[p]=!0));const u=l[0],h=l[l.length-1],g=[];e<0?g.push(n[u]<n[h]?n[u]:n[h],n[u]<n[h]?n[h]:n[u]):e>0?g.push(n[u]<n[h]?n[h]:n[u],n[u]<n[h]?n[u]:n[h]):g.push(n[u],n[h]);const f=g[0];let m,y=!1;for(;!y&&g.length!==0;)m=g.pop(),y=!0,l.forEach((p=>{const x=this.layers[this.nodeToLayer[p]];if(p!==x[0].id){const v=o.byId[p].prev.data;m-n[v.data.id]<r[p]-r[v.data.id]&&this.moveLongEdge(v,-1,s),y=y&&m-n[v.data.id]>=r[p]-r[v.data.id]-en}if(p!==x[x.length-1].id){const v=o.byId[p].next.data;m-n[v.data.id]>r[p]-r[v.data.id]&&this.moveLongEdge(v,1,s),y=y&&m-n[v.data.id]<=r[p]-r[v.data.id]+en}}));y||(m=f,l.forEach((p=>{const x=this.layers[this.nodeToLayer[p]];if(p!==x[0].id){const v=o.byId[p].prev.data;m=Math.max(m,n[v.data.id]+r[p]-r[v.data.id])}if(p!==x[x.length-1].id){const v=o.byId[p].next.data;m=Math.min(m,n[v.data.id]+r[p]-r[v.data.id])}}))),l.forEach((p=>n[p]=m))}moveLongEdges(){const t={};this.layers.forEach((e=>{const s=Math.floor(e.length/2);for(let n=s;n<e.length;n++)this.moveLongEdge(e[n],0,t);for(let n=s-1;n>=0;n--)this.moveLongEdge(e[n],0,t)}))}computeY(){const{Y:t,layers:e,height:s}=this;t[0]=0,e.slice(1).forEach(((n,i)=>{t[i+1]=t[i]+(s[i]+s[i+1])/2+this.layerDistance}))}straightenLongEdge(t,e){const{nodeList:s,longEdges:n,neighbours:i,X:r,Y:o,nodeToLayer:a,totalW:l}=this,u=n[t.id];if(e[t.id]||!i.prev[t.id]||i.prev[t.id].length!==1||!i.next[t.id]||i.next[t.id].length!==1||!(u&&u.length<2))return;e[t.id]=!0;const h=i.prev[t.id][0],g=i.next[t.id][0];if(a[g]===a[h])return;const f=r[h]+(r[g]-r[h])*(o[a[t.id]]-o[a[h]])/(o[a[g]]-o[a[h]]);if(t!==this.first[a[t.id]]){const y=s.byId[t.id].prev.data;if(f-r[y.id]<l[t.id]-l[y.id]-en&&this.straightenLongEdge(y,e),f-r[y.id]<l[t.id]-l[y.id]-en)return}const m=this.layers[a[t.id]];if(t!==m[m.length-1]){const y=s.byId[t.id].next.data;if(r[y.id]-f<l[y.id]-l[t.id]-en&&this.straightenLongEdge(y,e),r[y.id]-f<l[y.id]-l[t.id]-en)return}r[t.id]=f}straightenEdges(){const t={};this.layers.forEach((e=>{const s=Math.floor(e.length/2);for(let n=s;n<e.length;n++)this.straightenLongEdge(e[n],t);for(let n=s-1;n>=0;n--)this.straightenLongEdge(e[n],t)}))}run(){this.computeMinNodeDistances(),this.decrossVirtualEdges(),this.placeLongEdges(),this.placeNonVirtualNodes(),this.moveLongEdges(),this.computeY(),this.straightenEdges(),Di(this.layers,((t,e,s,n)=>{t.x=this.X[t.id],t.y=this.Y[n]}))}},a$=(t,e=20,s=50)=>new o$(t,e,s).run();function l$(t){if(t.sort(((n,i)=>n-i)),t.length===0)return 0;const e=Math.floor(t.length/2),s=Math.floor(t.length/2);return(t[e]+t[s])/2}function qy(t,e,s){const n={};return e.forEach(((i,r)=>n[i.id]=r)),t.map((i=>(s[i.id]||[]).map((r=>n[r])).sort())).reduce(((i,r,o,a)=>{const l=r.length?r[r.length-1]:-1;for(let u=o+1;u<a.length;u++)i+=a[u].filter((h=>h<l)).length;return i}),0)}function u$(t,e,s,n,i){const r={};for(let o=0;o<t.length;o++)r[t[o].id]=l$((e[t[o].id]||[]).map((a=>s[a])))||0;i?t.sort(((o,a)=>{const l=r[o.id]-r[a.id],u=n[o.id]===n[a.id],h=o.data.siblingIndex,g=a.data.siblingIndex;return u&&h>-1&&g>-1?h-g:l===0?s[a.id]-s[o.id]:l})):t.sort(((o,a)=>{const l=r[o.id]-r[a.id];return l===0?s[a.id]-s[o.id]:l}))}function CA({layers:t,topDown:e,topDownAdj:s,bottomUpAdj:n,idToIndex:i,crossings:r,sortSiblings:o}){const a=e?s:n;for(let l=e?0:t.length-1;e?l<t.length:l>=0;e?l++:l--){u$(t[l],a[l]||{},i,n[l],o);const u=l>0?qy(t[l-1],t[l],s[l-1]):0,h=l<t.length-1?qy(t[l],t[l+1],s[l]):0;h+u<=(r[l]||0)+(r[l-1]||0)?(r[l]=h,l>0&&(r[l-1]=u),t[l].forEach(((g,f)=>i[g.id]=f))):t[l].sort(((g,f)=>i[g.id]-i[f.id]))}}var d$=(t,e,s)=>{if(!s&&!e)return;const n={},i=t.map((()=>({}))),r=t.map((()=>({})));if(t.forEach(((h,g)=>{h.forEach(((f,m)=>{n[f.id]=s?f.data.siblingIndex:m,f.children.forEach((y=>{const p=y.layer;p>g?(i[g][f.id]=i[g][f.id]||[],i[g][f.id].push(y.id),r[p][y.id]=r[p][y.id]||[],r[p][y.id].push(f.id)):(i[p][y.id]=i[p][y.id]||[],i[p][y.id].push(f.id),r[g][f.id]=r[g][f.id]||[],r[g][f.id].push(y.id))}))}))})),n[-1]=-1,s&&(t.forEach((h=>h.sort(((g,f)=>n[g.id]-n[f.id])))),!e))return;const o=t.slice(1).map(((h,g)=>qy(t[g],h,i[g]))),a=[[50,100],[100,10],[1e3,1],[5e3,0]],l=Math.max(...t.map((h=>h.length))),u=(a.find((([h])=>l<h))||a[a.length-1])[1];for(let h=0;h<u;h++)CA({layers:t,topDown:!0,topDownAdj:i,bottomUpAdj:r,idToIndex:n,crossings:o,sortSiblings:s}),CA({layers:t,topDown:!1,topDownAdj:i,bottomUpAdj:r,idToIndex:n,crossings:o,sortSiblings:s})};function h$(t){const e={},s={},n={};t.nodes.forEach((o=>{n[o.id]=o}));const i=o=>{if(e[o.id])return s[o.id];e[o.id]=!0;let a=1/0;for(const l of o.children)a=Math.min(a,i(n[l.id])-1);return a===1/0&&(a=0),s[o.id]=a,a};t.nodes.forEach((o=>{o.data.parentIds.length===0&&i(o)}));let r=1/0;t.nodes.forEach((o=>{r=Math.min(r,s[o.id])})),t.nodes.forEach((o=>{s[o.id]-=r,o.layer=s[o.id]})),t.nodes.forEach((o=>{typeof o.data.layer=="number"&&!isNaN(o.data.layer)&&(o.layer=o.data.layer)}))}function c$(t){const e=t.nodes.reduce(((s,n)=>n.data.fixed&&(s===null||s.layer>n.layer)?n:s),null);return e&&t.nodes.forEach((s=>s.ref=e.id)),t}function g$(t){if(t.nodes.every((e=>e.layer))){const e=t.nodes.reduce(((s,n)=>Math.min(s,n.layer)),1/0);t.nodes.forEach((s=>s.layer-=e))}}function f$(t){if(t.nodes.some((e=>e.data.sink))){const e=t.nodes.reduce(((s,n)=>Math.max(s,n.layer)),-1/0);t.nodes.forEach((s=>{s.data.sink&&(s.layer=e+1)}))}}function m$(t){const e=[];t.nodes.forEach((n=>e[n.layer]=0));const s=Array.from(e).reduce(((n,i,r)=>{if(r===0)return n.push(0),n;const o=n[r-1];return i!==void 0?(n.push(o),n):(n.push(o-1),n)}),[]);t.nodes.forEach((n=>n.layer+=s[n.layer]))}function p$(t){return h$(t),f$(t),g$(t),m$(t),t.nodes.forEach((e=>{const{below:s,above:n}=e.children.reduce(((i,r)=>(e.layer>r.layer?i.above.push(r):i.below.push(r),i)),{above:[],below:[]});n.forEach((i=>i.children.push(e))),e.children=s})),c$(t)}var _$=(t,{nodeDistance:e,layerDistance:s,nodeLookup:n,customSort:i,customLayering:r,sortSiblings:o,siblingsPacking:a,shouldDecross:l=!0})=>{p$(t),a.packSiblings(t),r&&r(t);const u=y$(t);return t.nodes.length>1?(d$(u,l,o),i&&u.forEach((h=>{h.sort(((g,f)=>i(n.get(g.id),n.get(f.id))))})),a$(u,e,s)):(t.nodes[0].x=0,t.nodes[0].y=0),a.unpackSiblings(t),x$(t),t};function y$(t){return t.nodes.reduce(((e,s)=>(e[s.layer]=e[s.layer]||[],e[s.layer].push(s),s.children=s.children.map((n=>{if(n.layer===s.layer+1)return n;let i=n;for(let r=n.layer-1;r>s.layer;r--){const o=OH(`${s.id}->${n.id}@${r}`,r);o.children=[i],e[r]=e[r]||[],e[r].push(o),i=o}return i})),e)),[])}function x$(t){t.nodes.forEach((e=>{e.data&&(e.children=e.children.filter($y))}))}var v$=(t,e={})=>{const s=new Map,n=new Map;for(const u of t.nodes)s.set(u.id,u);const i=t.nodes.slice(),r=(t.edges||[]).filter((({source:u,target:h})=>u!==h)),o=TA(i,r,s).filter((u=>{const h=n.get(u.source);if(!h){const g=new Map;return g.set(u.target,!0),n.set(u.source,g),!0}return!h.get(u.target)&&(h.set(u.target,!0),!0)})),a=jH(i,o,{skipSingletons:e.packing==="grid"}),l=a.map((u=>{const h=u.map((f=>s.get(f))),g=o.filter((f=>u.includes(f.source)));return TA(h,i$({nodes:h,edges:g}),s)})).flat().reduce(((u,h)=>(u.has(h.source)||u.set(h.source,Gg(s.get(h.source))),u.has(h.target)||u.set(h.target,Gg(s.get(h.target))),u.get(h.target).children.push(h.source),u.get(h.target).parentIds.push(h.source),u)),new Map);return{components:a.map((u=>u.map((h=>l.get(h)||Gg(s.get(h)))))),lookup:s}};function b$(t,e,s,n){const i=[];for(const r of t){const o=s$(r);i.push(o),_$(o,{nodeDistance:n.nodesSeparation,layerDistance:n.layerSeparation,shouldDecross:n.shouldDecross,siblingsPacking:s,customSort:n.customSort,customLayering:n.customLayering,sortSiblings:!!n.sortSiblings,nodeLookup:e})}return i}var LA=(t,e={})=>{if(!t||!t.nodes)return t;const s={direction:"down",packing:"fit",nodesGridSeparation:1,...e,shouldDecross:e.shouldDecross!==!1},n=new YH(e.shouldPackSiblings,e.siblingPacking,e.siblingsGap,e.sortSiblings),{components:i,lookup:r}=v$(t,s),o=$H(r),a=b$(i,r,n,s);if(s.packing==="grid"){const l=e$(t.nodes,t.edges,s);a.push(l)}return QH(a,s),qH(o,r,a),t},m_={direction:"TB",nodeDistance:5,levelDistance:50,componentDistance:50,gapWidth:1,arrangeComponents:"fit",gridDistance:50,layer:"layer",siblingIndex:""},Yy={name:"hierarchical",imports:{sequential:LA},configure:function(t,{graph:e,data:s}){function n(S,A,w=S.getNodes()){return A?A instanceof io?A:S.getNodes(A):w}const i={...m_,...t,nodeList:t.nodes};i.direction=t.direction||m_.direction,i.layerSeparation=i.levelDistance,i.nodesSeparation=i.nodeDistance,i.componentsSeparation=i.componentDistance,i.gapDistance=i.gapWidth,i.packing=i.arrangeComponents;const r=t.decross!==!1,o={...i},a=i.edges,l=i.nodeList;if(["TB","BT","LR","RL"].indexOf(i.direction)===-1)throw new Error('direction should be one of the "TB", "BT", "LR", "RL"');if(["fit","grid","singleLine"].indexOf(i.packing)===-1)throw new Error('arrangeComponents should be one of the "fit", "grid", "singleLine"');i.nodesGridSeparation=t.gridDistance||m_.gridDistance;const u=l.getId(),h=l.getAttribute("layoutable").reduce(((S,A,w)=>(S[u[w]]=A,S)),{}),g=l.getAttributes(["x","y"]).reduce(((S,A,w)=>(S[u[w]]=A,S)),{}),f=t.rs?t.rs:l.getAttribute("radius");if(typeof o.layer!="string")throw new Error("'layer' should be the valid data field name");if(o.siblingIndex===void 0&&(o.siblingIndex=""),typeof o.siblingIndex!="string")throw new Error("'siblingIndex' should be the valid data field name");const m=n(e,i.roots,e.nodeList()),y=s.getProperty(i.nodeList,o.layer),p=o.siblingIndex.length?s.getProperty(i.nodeList,o.siblingIndex):[],x=m.map((S=>{let A=-1;return i.nodeList.forEach(((w,L)=>{w===S&&(A=L)})),A}));for(const S of x)y[S]=0;const v=n(e,i.sinks,e.nodeList()).toArray().reduce(((S,A)=>(S[A.getId()]=!0,S)),{}),b=u.map((S=>v[S]));return{nodes:u,edges:a.map((S=>({id:S.getId(),source:S.getSource().getId(),target:S.getTarget().getId()}))),decross:r,options:Nf(i),layoutable:h,radiuses:f,siblingIndexes:p,layers:y,sinks:b,coords:g}},context:os,update:function({nodes:t,edges:e,options:s,layoutable:n,radiuses:i,layers:r,siblingIndexes:o,decross:a,sinks:l,coords:u}){const h=e.filter((({source:m,target:y})=>m in n&&y in n)),g={nodes:t.map(((m,y)=>({id:m,radius:i[y],layer:r[y],siblingIndex:o[y],sink:l[y],layoutable:n[m],x:u[m].x,y:u[m].y}))),edges:h},{nodes:f}=LA(g,{packing:{fit:"fit",singleLine:"singleline",grid:"grid"}[s.arrangeComponents],direction:{TB:"down",BT:"up",RL:"left",LR:"right"}[s.direction],layerSeparation:s.layerSeparation,nodesSeparation:s.nodesSeparation,shouldDecross:s.decross,sortSiblings:o.length>0,componentsSeparation:s.componentsSeparation,nodesGridSeparation:s.nodesGridSeparation,evenDistribution:s.evenDistribution});return{positions:f}},isRunning:function(){return!1},onSync:function({positions:t},{graph:e}){return{indexes:t.map((({id:s})=>(e.getNode(s)||{_index:-1})._index)),x:t.map((({x:s})=>s)),y:t.map((({y:s})=>s))}}},E$=t=>(t.modules.layouts.register(Yy),(e={})=>(e.useWebWorker=!1,t.modules.layouts.start(Yy.name,e))),Wy=(t,e)=>t-e,NA={name:"radial",imports:{minHeap:Pf,bellmanFord:Tx,dijkstra:Cx,johnson:Q_,distance:pn,circleCircleIntersection:Mx,circleSortCompare:Ix,weightedStress:YT,distanceStress:WT,constrainedStress:Z_,stressMinimizationStep:K_,removeRadialOverlap:ty,linear:mf,calculateRadii:_E},configure(t,{graph:e}){let s=t.nodes;const n=s.size;function i(L,k){return L!=null&&isFinite(L)?L:k}if(t.centralNode===void 0)throw new Error('radial layout: missing parameter "centralNode"');const r=e.getNode(t.centralNode);if(r===void 0)throw new Error('radial layout: parameter "centralNode" is not valid');t.radiusRatio=i(t.radiusRatio,Math.SQRT2),t.radiusDelta=i(t.radiusDelta,0),t.nodeGap=i(t.nodeGap,10),t.repulsion=n*i(t.repulsion,1);const o=r.getPosition(),a=i(t.centerX,o.x),l=i(t.centerY,o.y),u=r._index;s.includes(r)||(s=s.concat(r.toList()));let h=s._indexes;const g=s.getAttribute("layoutable");h=h.filter(((L,k)=>g[k]||L===u)),h.sort(Wy);const f=h.length,m=S$(h,e.getConnectedComponents(s,{internalIndexes:!0}),u),y=e.degrees(h),p=new Float32Array(t.xs?t.xs:e.getNodeAttribute("x").getMultiple(h)),x=new Float32Array(t.ys?t.ys:e.getNodeAttribute("y").getMultiple(h)),v=t.rs?t.rs:e.getNodeAttribute("radius").getMultiple(h),b=e.getEdges()._indexes,S=e.getEdgeAttribute("source").getMultiple(b),A=e.getEdgeAttribute("target").getMultiple(b),w=e.getAdjacencyList({internalIndexes:!0,weight:1,indexes:h});return{centerIndex:u,centerIndexPos:0,cx:a,cy:l,D:null,indexes:h,components:m,normIndexes:null,radii:null,rings:null,x:p,y:x,degree:y,size:f,attributes:{size:v,adjacency:w,weights:A.map((()=>1)),sources:S,targets:A},sortAttr:null,allowOverlap:!!t.allowOverlap,nodeGap:t.nodeGap,radiusRatio:t.radiusRatio,radiusDelta:t.radiusDelta,repulsion:t.repulsion,randomize:!("randomize"in t)||!!t.randomize,renderSteps:!!t.renderSteps,epsilon:i(t.epsilon,.001),maxSteps:i(t.maxIterations,100),iterationsPerRender:i(t.iterationsPerRender,20),step:-1,stress:Number.POSITIVE_INFINITY,prevStress:0,converged:!1,overlapRemoved:!1,done:!1}},context:()=>({data:null,gridPlacement(t,e,s=8){const n=t.length,i=new Float32Array(n),r=new Float32Array(n);let o=0;for(let f=0,m=t.length;f<m;f++){const y=e[t[f]];y>o&&(o=y)}const a=o*s,l=Math.ceil(Math.sqrt(n)),u=Math.ceil(n/l),h=-Math.floor((u-1)*a/2),g=-Math.floor((l-1)*a/2);for(let f=0;f<l;f++)for(let m=0;m<u;m++)i[f*u+m]=h+m*a,r[f*u+m]=g+f*a;return{x:i,y:r}},connectComponents(t,e,s,n,i,r){let o;function a(l,u){const h=new Uint32Array(l.length+1);return h.set(l),h[l.length]=u,h}for(let l=1;l<t.length;l++){const u=t[l];let h=0,g=0;u.forEach(((y,p)=>{const x=i.get(y);x!=null&&x>h&&(g=p,h=x)})),o=u[g];const f=e[r.get(o)];f.weights=f.weights||[],f.nodes=a(f.nodes,s),f.weights.push(n);const m=e[r.get(s)];m.weights=m.weights||[],m.nodes=a(m.nodes,o),m.weights.push(n)}},correctSubgraphsDistances(t,e,s,n,i){const r=Array.prototype.reduce.call(t[s],((a,l,u)=>(u!==s&&l<n&&l>a&&(a=l),a)),0),o=n-r-1;for(let a=1;a<e.length;a++){const l=e[a];for(let u=0,h=l.length;u<h;u++){const g=i.get(l[u]);g!=null&&(t[s][g]-=o,t[g][s]-=o)}}},initialize(t,e){t.data=e,e.step=0;const s=new Map,n=new Map;e.normIndexes=e.indexes.reduce(((u,h,g)=>(u[g]=g,s.set(h,g),n.set(h,e.degree[g]),t.data&&h===e.centerIndex&&(t.data.centerIndexPos=g),u)),new Uint32Array(e.indexes.length));const i=e.centerIndexPos,r=e.components[0].length;t.connectComponents(e.components,e.attributes.adjacency,e.centerIndex,r,n,s);const o=Q_({sources:e.attributes.sources,targets:e.attributes.targets,weights:e.attributes.weights,indexes:e.indexes,adjacency:e.attributes.adjacency,undirected:!0});t.correctSubgraphsDistances(o,e.components,i,r,s),e.D=o;const a=o[i],l={};for(let u=0,h=e.normIndexes.length;u<h;u++)if(u!==i){const g=a[u];l[g]=l[g]||[],l[g].push(e.normIndexes[u])}e.rings=l,e.radii=_E(i,e.rings,e.attributes.size,e.nodeGap,e.radiusRatio,e.radiusDelta)},removeOverlaps(t,e){if(!t.data)return;const s=t.data.centerIndexPos,n=e.attributes.size,{rings:i,radii:r}=e,o=e.x[s],a=e.y[s];for(const l in i){const u=i[l];for(let h=0;h<u.length;h++){const g=u[h],f=r[l];let m=e.x[g]-o,y=e.y[g]-a;m+y===0&&(m=Math.sin(g)*Math.random()*.001,y=Math.cos(g)*Math.random()*.001);const p=Math.sqrt(m*m+y*y),x=f;if(p-x<0){const v=x/p;e.x[g]=o+m*v,e.y[g]=a+y*v}}}for(const l in i){const u=i[l],h=pn(o,a,e.x[u[0]],e.y[u[0]]);ty({X:e.x,Y:e.y,sizes:n,indexes:u,center:[o,a],R:h,gap:e.nodeGap,inPlace:!0})}}}),update(t,e){t||(t=e.data);const s=t.indexes,n=t.centerIndex;let i;t.x=t.x||new Float32Array(t.size),t.y=t.y||new Float32Array(t.size),t.step===-1&&e.initialize(e,t);const r=t.repulsion,o=a=>t.radii&&t.radii[a]||1;if(t.step===0&&t.randomize&&(i=e.gridPlacement(t.indexes,t.attributes.size),t.x=i.x,t.y=i.y),!t.converged){const a=t.maxSteps,l=t.iterationsPerRender;let u=t.step;const h=Math.min(u+l,a),{D:g,x:f,y:m,size:y,centerIndexPos:p,normIndexes:x}=t;for(;u<=h&&!t.converged;){const v=mf(Math.min(u,a)/a);t.step=u++,i=K_(g,f,m,y,p,r,v,x,o),t.x=i.x,t.y=i.y,t.prevStress=t.stress,t.stress=Z_(g,f,m,y,p,r,v,x),t.converged=t.converged||Math.abs(t.stress-t.prevStress)<=t.epsilon}}if(t.converged)if(t.overlapRemoved||t.allowOverlap){t.done=!0;const a=t.rings||{};t.rings=Object.keys(a).reduce(((l,u)=>(l[u]=a[u].map((h=>s[h])),l)),{})}else e.removeOverlaps(e,t,n),t.overlapRemoved=!0;return t},isRunning:({data:t})=>!(!t||t.converged&&(t.allowOverlap||t.done))||(t&&(t.step=-1),!1),onSync(t){if(t.renderSteps||t.done)return MA(t)},onEnd:t=>MA(t)};function MA(t){const e=t.x,s=t.y,n=t.indexes.length,i=e[t.centerIndexPos]-t.cx,r=s[t.centerIndexPos]-t.cy;for(let o=0;o<n;o++)e[o]-=i,s[o]-=r;return{indexes:t.indexes,x:e,y:s}}function S$(t,e,s){const n=t.slice().sort(Wy),i=[];for(let r=0,o=e.length;r<o;r++){const a=[],l=e[r];let u=!1;for(let h=0,g=l.length;h<g;h++){const f=l[h];zw(n,f)!==-1&&(f===s&&(u=!0),a.push(f))}a.length!==0&&i[u?"unshift":"push"](a.sort(Wy))}return i}var A$=t=>(t.modules.layouts.register(NA),e=>{if(e.centralNode===void 0)throw new Error('concentric layout: missing parameter "centralNode"');if(e.maxIterations=e.maxIterations&&isFinite(e.maxIterations)?Math.floor(e.maxIterations):100,e.maxIterations<1)throw new RangeError("maxIterations must be a positive integer");if(e.iterationsPerRender=e.iterationsPerRender&&isFinite(e.iterationsPerRender)?Math.floor(e.iterationsPerRender):20,e.iterationsPerRender<1)throw new RangeError("iterationsPerRender must be a positive integer");if(e.epsilon=e.epsilon&&isFinite(e.epsilon)?e.epsilon:.001,e.epsilon<=0)throw new RangeError("epsilon has to be a positive number");return t.modules.layouts.start(NA.name,e)}),IA={...Yy,name:"sequential"},w$=t=>(t.modules.layouts.register(IA),(e={})=>{e.useWebWorker=!1;const s={...e,evenDistribution:!0};return t.modules.layouts.start(IA.name,s)}),T$=class extends Rs{constructor(t){super(t),this.stop=()=>this._ogma.modules.layouts.stop(),this.concentric=C6(t),this.radial=A$(t),this.force=FH(t),this.forceLink=PH(t),this.hierarchical=E$(t),this.sequential=w$(t),this.grid=zH(t)}},C$=class extends Rs{constructor(){super(...arguments),this.move=t=>this._ogma.modules.virtualMouse.move(t),this.down=t=>this._ogma.modules.virtualMouse.down(t),this.up=t=>this._ogma.modules.virtualMouse.up(t),this.click=t=>this._ogma.modules.virtualMouse.click(t),this.rightClick=t=>this._ogma.modules.virtualMouse.rightClick(t),this.doubleclick=t=>this._ogma.modules.virtualMouse.doubleclick(t),this.drag=(t,e)=>this._ogma.modules.virtualMouse.drag(t,e),this.wheel=t=>this._ogma.modules.virtualMouse.wheel(t)}},L$=class extends Rs{constructor(){super(...arguments),this.map=t=>this._ogma.modules.rules.createMapping(t),this.slices=t=>this._ogma.modules.rules.createSlices(t),this.template=t=>this._ogma.modules.rules.createTemplate(t)}},N$=class extends Rs{constructor(){super(...arguments),this.watchNodeObjectProperty=t=>this._ogma.modules.watcher.watchNodeObjectProperty(t),this.watchEdgeObjectProperty=t=>this._ogma.modules.watcher.watchEdgeObjectProperty(t),this.watchNodeNonObjectProperty=t=>this._ogma.modules.watcher.watchNodeNonObjectProperty(t),this.watchEdgeNonObjectProperty=t=>this._ogma.modules.watcher.watchEdgeNonObjectProperty(t)}},M$=class{clearSelection(){return this.modules.selection.clear()}getSelectedNodes(){return this.modules.selection.getSelectedNodes()}getNonSelectedNodes(){return this.modules.selection.getNonSelectedNodes()}getSelectedEdges(){return this.modules.selection.getSelectedEdges()}getNonSelectedEdges(){return this.modules.selection.getNonSelectedEdges()}},I$=class{setOptions(t){return this.modules.settings.update(t)}getOptions(){return this.modules.settings.get()}},k$=class extends Rs{constructor(){super(...arguments),this.setNodesVisibility=t=>this._ogma.modules.graphics.setNodesVisibility(t),this.setEdgesVisibility=t=>this._ogma.modules.graphics.setEdgesVisibility(t),this.setNodeTextsVisibility=t=>this._ogma.modules.graphics.setNodeTextsVisibility(t),this.setEdgeTextsVisibility=t=>this._ogma.modules.graphics.setEdgeTextsVisibility(t),this.addRule=(t={})=>this._ogma.modules.styleRules.addRule(t),this.getRuleList=()=>this._ogma.modules.styleRules.getRuleList(),this.addNodeRule=(t,e)=>{let s,n;return e===void 0?(s=t,n=void 0):(s=e,n=t),this.addRule({nodeAttributes:s,nodeSelector:n})},this.addEdgeRule=(t,e)=>{let s,n;return e===void 0?(s=t,n=void 0):(s=e,n=t),this.addRule({edgeAttributes:s,edgeSelector:n})},this.getNodeRules=()=>this.getRuleList().filter((t=>t.getDefinition().edgeAttributes===void 0)),this.getEdgeRules=()=>this.getRuleList().filter((t=>t.getDefinition().nodeAttributes===void 0)),this.createClass=t=>this._ogma.modules.classes.createClass(t),this.getClass=t=>this._ogma.modules.classes.getClassByName(t),this.getClassList=()=>this._ogma.modules.classes.getClassList(),this.setHoveredNodeAttributes=(t,e)=>{this._ogma.modules.hover.updateNodeAttributes(t,e)},this.setHoveredEdgeAttributes=(t,e)=>{this._ogma.modules.hover.updateEdgeAttributes(t,e)},this.setHoveredEdgeExtremitiesAttributes=(t,e)=>this._ogma.modules.hover.setEdgeExtremitiesAttributes(t,!!e),this.setSelectedNodeAttributes=(t,e)=>this._ogma.modules.selection.setNodeAttributes(t,!!e),this.setSelectedEdgeAttributes=(t,e)=>this._ogma.modules.selection.setEdgeAttributes(t,!!e),this.setSelectedEdgeExtremitiesAttributes=(t,e)=>this._ogma.modules.selection.setEdgeExtremitiesAttributes(t,!!e),this.setTheme=({nodeAttributes:t,edgeAttributes:e,selectedNodeAttributes:s,selectedEdgeAttributes:n,selectedEdgeExtremitiesAttributes:i,hoveredNodeAttributes:r,hoveredEdgeAttributes:o,hoveredEdgeExtremitiesAttributes:a})=>{this._ogma.modules.pulses.setTheme(t&&t.pulse||{},e&&e.pulse||{}),this._ogma.modules.graphics.getAttributesManager().setDefaultAttributes(t||{},e||{}),this.setSelectedNodeAttributes(s||{}),this.setSelectedEdgeAttributes(n||{}),this.setHoveredNodeAttributes(r||{}),this.setHoveredEdgeAttributes(o||{}),this.setHoveredEdgeExtremitiesAttributes(a||{}),this.setSelectedEdgeExtremitiesAttributes(i||{})},this.fontSizeToBadgeScale=mL}},R$=class extends Rs{constructor(){super(...arguments),this.set=(t,e)=>this._ogma.modules.brand.set(t,e),this.remove=()=>{this._ogma.modules.brand.remove()}}},F$=class extends Rs{constructor(){super(...arguments),this.enable=t=>(this._ogma.modules.connectNodes.enable(t),this),this.disable=()=>(this._ogma.modules.connectNodes.disable(),this),this.enabled=()=>this._ogma.modules.connectNodes.enabled()}},P$=class extends Rs{constructor(){super(...arguments),this.enable=t=>(this._ogma.modules.lasso.enable(t),this),this.disable=()=>(this._ogma.modules.lasso.disable(),this),this.enabled=()=>this._ogma.modules.lasso.enabled()}},z$=class extends Rs{constructor(){super(...arguments),this.enable=t=>this._ogma.modules.legend.enable(t),this.disable=()=>this._ogma.modules.legend.disable(),this.enabled=()=>this._ogma.modules.legend.enabled(),this.getOptions=()=>this._ogma.modules.legend.getOptions(),this.export=t=>this._ogma.modules.legend.export(t)}},D$=class extends Rs{constructor(){super(...arguments),this.enable=(t={})=>{this._ogma.modules.rectangleSelect.enable(t)},this.disable=()=>{this._ogma.modules.rectangleSelect.disable()},this.enabled=()=>this._ogma.modules.rectangleSelect.enabled()}},O$=class extends Rs{constructor(){super(...arguments),this.enable=t=>{this._ogma.modules.resizing.enable(t)},this.disable=()=>{this._ogma.modules.resizing.disable()},this.enabled=()=>this._ogma.modules.resizing.enabled()}},B$=class extends Rs{constructor(){super(...arguments),this.enable=(t={})=>{this._ogma.modules.rewiring.enable(t)},this.disable=()=>{this._ogma.modules.rewiring.disable()},this.enabled=()=>this._ogma.modules.rewiring.enabled()}},U$=class extends Rs{constructor(){super(...arguments),this.enable=(t={})=>{this._ogma.modules.snapping.enable(t)},this.disable=()=>{this._ogma.modules.snapping.disable()},this.enabled=()=>this._ogma.modules.snapping.enabled()}},G$=class extends Rs{constructor(){super(...arguments),this.onNodeHover=(t,e={})=>{this._ogma.modules.tooltip.setHandler("hover.node",t,e)},this.onNodeClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.left.node",t,e)},this.onNodeRightClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.right.node",t,e)},this.onNodeDoubleClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("doubleclick.left.node",t,e)},this.onEdgeHover=(t,e={})=>{this._ogma.modules.tooltip.setHandler("hover.edge",t,e)},this.onEdgeClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.left.edge",t,e)},this.onEdgeRightClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.right.edge",t,e)},this.onEdgeDoubleClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("doubleclick.left.edge",t,e)},this.onBackgroundClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.left.background",t,e)},this.onBackgroundRightClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("click.right.background",t,e)},this.onBackgroundDoubleClick=(t,e={})=>{this._ogma.modules.tooltip.setHandler("doubleclick.left.background",t,e)},this.refresh=()=>this._ogma.modules.tooltip.refresh(),this.isShown=()=>this._ogma.modules.tooltip.isShown(),this.hide=()=>{this._ogma.modules.tooltip.hide()},this.show=(t,e)=>this._ogma.modules.tooltip.show(t,e)}},V$=class extends Rs{constructor(t){super(t),this.lasso=new P$(t),this.connectNodes=new F$(t),this.legend=new z$(t),this.rectangleSelect=new D$(t),this.resize=new O$(t),this.rewire=new B$(t),this.snapping=new U$(t),this.tooltip=new G$(t),this.brand=new R$(t)}},j$=class extends Rs{constructor(t){super(t),this.getList=()=>this._ogma.modules.transformations.api.getList(),this.clear=()=>this._ogma.modules.transformations.api.clear().then((()=>{})),this.getById=e=>this._ogma.modules.transformations.api.getById(e),this.afterNextUpdate=()=>this._ogma.modules.transformations.afterNextUpdate(),this.onGroupsUpdated=e=>{this._ogma.modules.transformations.onGroupsUpdated(e)},this.layoutGroups=(e,s,n=!1)=>this._ogma.modules.transformations.api.layoutGroups(e,s,n),this.triggerGroupUpdated=e=>this._ogma.modules.transformations.triggerGroupUpdated(e),this.triggerGroupsUpdated=()=>this._ogma.modules.transformations.api.triggerGroupsUpdated()}addNodeGrouping(t){return this._ogma.modules.transformations.api.addNodeGrouping(t)}addNodeClustering(t){return this._ogma.modules.transformations.api.addNodeClustering(t)}addEdgeGrouping(t){return this._ogma.modules.transformations.api.addEdgeGrouping(t)}addDrillDown(t){return this._ogma.modules.transformations.api.addDrilldown(t)}addNodeFilter(t){return this._ogma.modules.transformations.api.addNodeFilter(t)}addEdgeFilter(t){return this._ogma.modules.transformations.api.addEdgeFilter(t)}getNodeFilters(){return this._ogma.modules.transformations.getNodeFilters()}getEdgeFilters(){return this._ogma.modules.transformations.getEdgeFilters()}addNeighborGeneration(t){return this._ogma.modules.transformations.api.addNeighborGeneration(t)}addNeighborMerging(t){return this._ogma.modules.transformations.api.addNeighborMerging(t)}addNodeCollapsing(t){return this._ogma.modules.transformations.api.addNodeCollapsing(t)}addGeoClustering(t){return this._ogma.modules.transformations.api.addGeoClustering(t)}addVirtualProperties(t){return this._ogma.modules.transformations.api.addVirtualProperties(t)}getXYR(t){return this._ogma.modules.transformations.getXYR(t)}expandGroup({node:t,computeSubNodesPosition:e,onExpand:s}){return this._ogma.modules.transformations.api.fishEyeExpand(t,s,e)}collapseGroup({node:t,onCollapse:e}){return this._ogma.modules.transformations.api.fishEyeCollapse(t,e)}},H$=class extends Rs{constructor(){super(...arguments),this.setZoom=(t,e)=>this._ogma.modules.camera.setZoom(t,e),this.zoomIn=t=>this._ogma.geo.enabled()?this._ogma.modules.geo.zoomIn():this._ogma.modules.camera.zoomIn(t),this.zoomOut=t=>this._ogma.geo.enabled()?this._ogma.modules.geo.zoomOut():this._ogma.modules.camera.zoomOut(t),this.getZoom=()=>this._ogma.modules.camera.getZoom(),this.setCenter=(t,e)=>this._ogma.modules.camera.setCenter(t,e),this.move=(t,e)=>this._ogma.modules.camera.move(t,e),this.moveToBounds=(t,e)=>{if(!(t&&t instanceof ii)){if(!Rn(t)||t.length!==4)throw new Error("ogma.view.zoomToBounds requires a BoundingBox as a parameter");{const[s,n,i,r]=t;t=ii.from({minX:s,minY:n,maxX:i,maxY:r})}}return this._ogma.modules.camera.moveToBounds(t,e)},this.moveTo=(t,e)=>this._ogma.modules.camera.moveTo(t,e),this.getCenter=()=>this._ogma.modules.camera.getCenter(),this.setAngle=(t,e)=>this._ogma.modules.camera.setAngle(t,e),this.rotate=(t,e)=>this._ogma.modules.camera.rotate(t,e),this.getAngle=()=>this._ogma.modules.camera.getAngle(),this.set=(t,e)=>this._ogma.modules.camera.setView(t,e),this.get=()=>this._ogma.modules.camera.getView(),this.graphToScreenCoordinates=t=>this._ogma.modules.camera.graphToScreenCoordinates(t),this.screenToGraphCoordinates=t=>this._ogma.modules.camera.screenToGraphCoordinates(t),this.getImageData=()=>this._ogma.modules.graphics.getImageData(),this.getElementAt=t=>this._ogma.modules.captor.detectElementAt(t.x,t.y,!1,!0),this.getElementsInView=()=>{const{width:t,height:e}=this.get(),s=this.screenToGraphCoordinates({x:0,y:0}),n=this.screenToGraphCoordinates({x:t,y:e});return this._ogma.modules.spatial.query(s.x,s.y,n.x,n.y)},this.getBounds=()=>{const{width:t,height:e}=this.getSize(),s=this.screenToGraphCoordinates({x:0,y:0}),n=this.screenToGraphCoordinates({x:t,y:e});return{cx:(s.x+n.x)/2,cy:(s.y+n.y)/2,width:n.x-s.x,height:n.y-s.y,minX:s.x,minY:s.y,maxX:n.x,maxY:n.y}},this.getElementsInside=(t,e,s,n,i=!0)=>{const{spatial:r,camera:o}=this._ogma.modules;if(i){const a=o.graphToScreenCoordinates({x:t,y:e}),l=o.graphToScreenCoordinates({x:s,y:n});return r.queryProjected(a.x,a.y,l.x,l.y)}return r.queryProjected(t,e,s,n)},this.beforeNextFrame=()=>this._ogma.modules.dom.beforeNextFrame(),this.afterNextFrame=()=>this._ogma.modules.dom.afterNextFrame(),this.setFullScreen=t=>this._ogma.modules.dom.setFullScreen(t),this.isFullScreen=()=>this._ogma.modules.dom.isFullScreen(),this.forceResize=()=>this._ogma.modules.dom.forceResize(),this.getSize=()=>this._ogma.modules.dom.getDimensions(),this.setSize=t=>{if(!t||isNaN(t.width)||isNaN(t.height))throw new Error("Size must follow the format { width: number, height: number }");if(t.width<0)throw new Error("width must be positive");if(t.height<0)throw new Error("height must be positive");return this._ogma.modules.dom.setDimensions(t),Promise.resolve()},this.locateGraph=t=>this._ogma.modules.locate.locateGraph(t),this.locateRawGraph=(t,e)=>this._ogma.modules.locate.locateRawGraph(t,e),this.getGraphBoundingBox=({withTexts:t=!1}={})=>this._ogma.modules.locate.getGraphBoundingBox(t),this.animationInProgress=()=>this._ogma.modules.locate.isLocating()||this._ogma.modules.camera.animationInProgress(),this.getTextBoundingBox=t=>{if(!t)throw new Error("ogma.view.getTextBoundingBox: item must be a Node or an Edge");const e=t.getAttribute("text"),s=this._ogma.modules.labels;return e==null||e===""?null:t.isList?t.isNode?void s.getTextsBoundingBox(t):s.getTextsBoundingBox(void 0,t):t.isNode?s.getTextsBoundingBox(t.toList()):s.getTextsBoundingBox(void 0,t.toList())},this.getNodeBadgeAt=(t,e)=>{if(!t)throw new Error("ogma.view.getNodeBadgeAt: node is not defined");return aC(e,t._index,this._ogma.modules.graphics.getAttributesManager(),this._ogma.modules.camera,this._ogma.modules.graphics.getGraphicsEngine())}}},$$=class{constructor(t,e){this._ogma=t,this.settings=new g4(t),this.events=new d4(t),this.dom=new KP(t),this.animations=new Z4(t),this.camera=new Z3(t),this.graph=new xz(t),this.data=new tz(t),this.graphics=new n4(t),this.layers=new PV(t),this.individualAttributes=new c4(t),this.algorithms=new zV(t),this.position=new wV(t),this.touch=new B4(t),this.mouse=new D4(t),this.virtualMouse=new OG(t),this.spatial=new w4(t),this.captor=new x5(t),this.interactions=new h5(t),this.classes=new _4(t),this.cameraInteractions=new q3(t,!!e.debug),this.hover=new AV(t),this.keyboard=new B5(t),this.selection=new V4(t),this.styleRules=new jG(t),this.legend=new EV(t),this.sync=new j4(t),this.rules=new IV(t),this.transformations=new U4(t),this.locate=new R4(t),this.drag=new v5(t),this.pulses=new Y4(t),this.curvatureManager=new gG(t),this.workers=new EG(t),this.layouts=new LG(t),this.watcher=new RG(t),this.rectangleSelect=new HG(t),this.labels=new d5(t,e),this.brand=new hG(t),this.lasso=new SN(t),this.rewiring=new E5(t),this.resizing=new S5(t),this.snapping=new BG(t),this.connectNodes=new w5(t),this.tooltip=new I5(t),this.geo=new cG(t),Object.keys(this).forEach((s=>{const n=this[s];n instanceof Ke&&(n._setModules(this),n.onMounted())})),t.onReady((()=>{Object.keys(this).forEach((s=>{const n=this[s];n instanceof Ke&&n.onReady(e)}))}))}destroy(){Object.keys(this).forEach((t=>{const e=this[t];e instanceof Ke&&e.destroy(this._ogma)}))}},q$=1,Y$=[BV,OV,jV,ZF,S6,M$,I$],Xy={version:"5.3.8",commit:"aff4ac91d",buildTime:"Fri Dec 05 2025 16:07:05 GMT+0000 (Coordinated Universal Time)"},bi,zl=(bi=class{constructor(e={}){this.node=s=>new ji(s,this),this.edge=s=>new so(s,this),this.nodeList=s=>new io(s||new Uint32Array(0),this),this.edgeList=s=>new Va(s||new Uint32Array(0),this),this._onReady=[],this.build=Xy,this._init(e)}_init(e){this._initParameters=e,this._debug=!!e.debug,this._token=q$++,this.modules=new $$(this,e),this.styles=new k$(this),this.algorithms=new DV(this),this.export=new qj(this),this.keyboard=new w6(this),this.generate=new b6(this),this.layouts=new T$(this),this.parse=new A6(this),this.transformations=new j$(this),this.tools=new V$(this),this.view=new H$(this),this.mouse=new C$(this),this.events=new HV(this),this.schema=new N$(this),this.rules=new L$(this),this.geo=new E6(this),this.layers=new T6(this),this.debug=new VV(this),this._onReady.forEach((s=>s(this))),this.safelyBindToInstance(),this.modules.events.register(["destroy"]),this.build={version:"5.3.8",commit:"aff4ac91d",buildTime:"Fri Dec 05 2025 16:07:05 GMT+0000 (Coordinated Universal Time)"}}safelyBindToInstance(){for(const e of Object.getOwnPropertyNames(bi.prototype))typeof bi.prototype[e]=="function"&&(this[e]=this[e].bind(this))}onReady(e){this._onReady.push(e)}_destroy(){if(!this._token)throw new Error('"destroy" called twice on the same instance of Ogma');this._onReady=[],this.modules.destroy(),this.modules=null}destroy(){this.modules.events.fire("destroy",{}),this._destroy()}isDestroyed(){return!this.modules}reset(){const e=this._initParameters;this._destroy(),this._init(e)}isDebug(){return this._debug}},bi.libraries=TT,bi.geometry=dN,bi.parse=m0,bi.build=Xy,bi.algorithms=wx,bi.utils=n0,bi);zl.algorithms=wx,zl.utils=n0,zl.parse=m0,zl.build=Xy,zR(zl,Y$);var b0=zl,Xn=(t=>(t.NodeFilter="node-filter",t.EdgeFilter="edge-filter",t.NodeCollapsing="node-collapsing",t.VirtualProperties="virtual-properties",t.NeighborGeneration="neighbor-generation",t.NeighborMerging="neighbor-merging",t.NodeGrouping="node-grouping",t.EdgeGrouping="edge-grouping",t.NodeClustering="node-clustering",t.GeoClustering="geo-clustering",t.Unknown="unknown",t))(Xn||{}),Qo=class{constructor({id:t,duration:e,easing:s,ogma:n,module:i}){this.animation=s?{duration:e,easing:s}:e===void 0?0:e,this.destroyed=!1,this.id=t,this.ogma=n,this.context={},this.module=i,this.resetContext()}setOptions(t){var e;let s=typeof this.animation=="number"?this.animation:(e=this.animation)==null?void 0:e.duration,n=typeof this.animation=="object"?this.animation.easing:void 0;return typeof t.duration=="number"&&(s=t.duration),t.easing!==void 0&&(n=t.easing),this.animation=n?{duration:s,easing:n}:s===void 0?0:s,this.module.setOptions(this),this.module.afterNextUpdate()}enable(t){return this.animation=t===void 0?this.animation:t,this.module.enable(this)}disable(t){return this.animation=t===void 0?this.animation:t,this.module.disable(this)}isEnabled(){return this.module.isEnabled(this)}getId(){return this.id}whenApplied(){return this.module.afterNextUpdate().then((()=>this))}toggle(t){return this.animation=t===void 0?this.animation:t,this.isEnabled()?this.module.disable(this):this.module.enable(this)}run(t=!0){return Promise.resolve()}undo(t=!0){return Promise.resolve()}cleanup(){return this.resetContext(),Promise.resolve()}refresh(){return this.module.refreshTransformation(this),this.module.afterNextUpdate()}getIndex(){return this.module.getIndex(this)}setIndex(t){return this.module.setIndex(this,t),this.module.afterNextUpdate()}getAnimation(){return typeof this.animation=="number"?{duration:this.animation,easing:"linear"}:this.animation}getContext(){return this.context}setContent(t){this.context=t}resetContext(){this.context={}}getName(){return Xn.Unknown}destroy(t){return t!==void 0&&(this.animation=t),this.module.remove(this)}},W$=class{constructor(t){this.xs=new Map,this.ys=new Map,this.rs=new Map,this.curvatures=new Map,this.hiddenNodes=new Set,this.hiddenEdges=new Set,this.animations=[],this.before=[],this.after=[],this.applying=!1,this._onNodesRemoved=e=>{const s=e.nodes._indexes;for(const n of s)this.xs.delete(n),this.ys.delete(n),this.rs.delete(n)},this.ogma=t,this.afterMod={nodesToHide:new Set,edgesToHide:new Set},this.layer=this.ogma.modules.graphics.addAttributeLayer({name:"ogma-transformations-animations",priority:5.99999,nodeOutput:{attributes:["radius"]},edgeOutput:{attributes:["curvature"]},nodeDependencies:void 0,edgeDependencies:void 0}),this.attributeLayerData=this.layer._attributesManager._getLayerById(this.layer._id),this.initEvents()}initEvents(){this.ogma.events.on("removeNodes",this._onNodesRemoved)}apply(t){const e=Array.from(this.xs.values()),s=Array.from(this.ys.values()),n=Array.from(this.rs.values()).map((g=>({radius:g}))),i=Array.from(this.curvatures.values()).map((g=>({curvature:g}))),r=this.ogma.nodeList(Array.from(this.hiddenNodes)),o=this.ogma.edgeList(Array.from(this.hiddenEdges)),a=e.map(((g,f)=>({x:g,y:s[f]}))),l=this.ogma.nodeList(Array.from(this.xs.keys())),u=this.ogma.nodeList(Array.from(this.rs.keys())),h=this.ogma.edgeList(Array.from(this.curvatures.keys()));return this.xs.clear(),this.ys.clear(),this.rs.clear(),this.curvatures.clear(),this.hiddenNodes.clear(),this.hiddenEdges.clear(),this.before.forEach((g=>g())),this.initCurvature(h._indexes),this.applying=a.length>0||n.length>0||i.length>0,Promise.all([a.length?l.setAttributes(a,t):Promise.resolve(),n.length?this.ogma.modules.graphics.animate(u,(()=>this.layer.setAttributeValues(u,n)),!1,t):Promise.resolve(),i.length?this.ogma.modules.graphics.animate(h,(()=>this.layer.setAttributeValues(h,i)),!1,t):Promise.resolve(),...this.animations.map((g=>g()))]).then((()=>(this.ogma.nodeList(Array.from(this.afterMod.nodesToHide)).setVisible(!1),this.ogma.edgeList(Array.from(this.afterMod.edgesToHide)).setVisible(!1),Promise.all(this.after.map((g=>g())))))).then((()=>{this.deleteCurvatures(h._indexes),r.setVisible(!1),o.setVisible(!1),this.animations=[],this.before=[],this.after=[],this.afterMod.nodesToHide.clear(),this.afterMod.edgesToHide.clear(),this.applying=!1}))}setXYR(t,e,s,n){if(typeof t=="number")this.xs.set(t,e),this.ys.set(t,s),n!==void 0&&this.rs.set(t,n);else for(const i of t)this.xs.set(i,e),this.ys.set(i,s),n!==void 0&&this.rs.set(i,n)}getOpenRadius(t){return this.attributeLayerData.nodes.outputFlexArrays.radius.get(t)}getInputFlexArrays(){return this.attributeLayerData.nodes.inputFlexArrays}getCloseRadius(t){return this.attributeLayerData.nodes.inputFlexArrays.radius.get(t)}deleteOpenRadius(t){this.layer.getFlexArrays().nodes.radius.set(t,void 0)}initCurvature(t){const e=this.attributeLayerData.edges.inputFlexArrays.curvature,s=this.attributeLayerData.edges.outputFlexArrays.curvature;for(let n=0;n<t.length;n++)s.set(t[n],e.get(t[n]))}deleteCurvatures(t){const e=this.layer.getFlexArrays().edges.curvature;for(let s=0;s<t.length;s++)e.set(t[s],void 0)}hideNode(t){this.hiddenNodes.add(t)}showNode(t){this.hiddenNodes.delete(t)}hideNodes(t){for(const e of t)this.hiddenNodes.add(e)}showNodes(t){for(const e of t)this.hiddenNodes.delete(e)}hideEdge(t){this.hiddenEdges.add(t)}showEdge(t){this.hiddenEdges.delete(t)}hideEdges(t){for(const e of t)this.hiddenEdges.add(e)}showEdges(t){for(const e of t)this.hiddenEdges.delete(e)}pushBefore(t){Array.isArray(t)?this.before.push(...t):this.before.push(t)}pushAfter(t){Array.isArray(t)?this.after.push(...t):this.after.push(t)}setXY(t,e,s){this.xs.set(t,e),this.ys.set(t,s)}getXYR(t){const e=this.xs,s=this.ys,n=this.rs,i=t.getAttributes(["x","y","radius"]);for(let r=0;r<t.size;r++){const o=t._indexes[r];e.has(o)&&(i[r].x=e.get(o)),s.has(o)&&(i[r].y=s.get(o)),n.has(o)&&(i[r].radius=n.get(o))}return i}getXs(t){return this.getMapValues(t,"x",this.xs)}getYs(t){return this.getMapValues(t,"y",this.ys)}getRs(t){return this.getMapValues(t,"radius",this.rs)}getMapValues(t,e,s){const n=this.ogma.modules.graphics.getAttributesManager()._layerController.nodes._currentFlexArrays[e],i=new Array(t.size);for(let r=0;r<t.size;r++){const o=t._indexes[r];s.has(o)?i[r]=s.get(o):i[r]=n.get(o)}return i}setR(t,e){this.rs.set(t,e)}setRs(t,e){for(let s=0;s<t.length;s++)e[s]!==void 0&&this.rs.set(t[s],e[s])}setCurvatures(t,e){for(let s=0;s<t.length;s++)this.curvatures.set(t[s],e[s])}setCurvature(t,e){this.curvatures.set(t,e)}hideNodesAfter(t){for(let e=0;e<t.length;e++)this.afterMod.nodesToHide.add(t[e])}hideEdgesAfter(t){for(let e=0;e<t.length;e++)this.afterMod.edgesToHide.add(t[e])}setOpenRadius(t,e){this.attributeLayerData.nodes.outputFlexArrays.radius.set(t,e)}push(t){Array.isArray(t)?this.animations.push(...t):this.animations.push(t)}getMaxAnimation(t,e){return(typeof t=="number"?t:t.duration)>(typeof e=="number"?e:e.duration)?t:e}isApplying(){return this.applying}};function La(t,e,s){const n=typeof e=="string"?e.split("."):e;for(let i=0;i<n.length-1;++i){const r=n[i];let o=t[r];o||(o={},t[r]=o),t=o}t[n[n.length-1]]=s}function X$(t){let e=0,s=0;const n=t.length;if(n===0)throw new Error("Ogma transformations: Compute centroid: at least one point is required");for(let i=0;i<n;++i){const r=t[i];e+=r.x,s+=r.y}return e/=n,s/=n,{x:e,y:s}}function Z$(t,e){const s=t.get(0);return{data:s.getData(),attributes:s.getAttributes(e)}}function bf(t,e){return`gen_grp_${e}_${t}`}function K$(t){return t.map((({id:e,source:s,target:n})=>({id:e,source:s,target:n})))}function Q$(t,e,s,n){let i=e,r=s;return!n&&i.toString()>r.toString()&&(i=s,r=e),`${t}[${i}-${r}]`}function J$(t){if(t===void 0)return Math.round(Math.random()*Number.MAX_SAFE_INTEGER);if(typeof t!="string"&&(typeof t!="number"||!isFinite(t)))throw new Error(`Ogma transformation: ${t} is not a valid id, expected string or number`);return t}function Sg(t){return`data.${t}`}var tq=class{constructor(t){this.groupsByDepth=new Map,this.treeMap=new Map,this.dataMap=new Map,this.invalidEdges=new Map,this.edges=new Map,this.ogma=t.ogma,this.module=t.module,this.enabled=t.enabled===void 0||t.enabled,this.onGetSubgraph=t.onGetSubgraph,this.duration=t.duration||0,this.easing=t.easing||"quadraticOut",this.parentPath=t.parentPath||"parent",this.depthPath=t.depthPath||"depth",this.padding=t.padding||0,this.nodeGenerator=t.nodeGenerator||(()=>({})),this.showContents=t.showContents===void 0||t.showContents,this.onGroupUpdate=t.onGroupUpdate||(()=>{}),this.copyData=t.copyData===void 0||t.copyData,this.context={virtualEdges:this.ogma.edgeList()}}createGrouping(t){var e;const{ogma:s,groupsByDepth:n}=this,i=s.transformations.addNodeGrouping({selector:o=>o.getData(this.depthPath)===t,groupIdFunction:o=>o.getData(this.parentPath),showContents:o=>typeof this.showContents=="boolean"?this.showContents:this.showContents(o,t),onBeforeAddMetaEdges:(o,a)=>this.addEdges(o,a),onGroupUpdate:(o,a,l)=>this.onGroupUpdate(o,a,l,t),padding:o=>typeof this.padding=="number"?this.padding:this.padding(o,t),duration:this.duration,enabled:this.enabled,nodeGenerator:(o,a)=>{const l=this.nodeGenerator(o,a,i);return this.copyData&&(l.data||(l.data={}),l.data={...l.data,...this.dataMap.get(a)}),La(l,Sg(this.parentPath),this.treeMap.get(a)),La(l,Sg(this.depthPath),t-1),l.id=a,l}});if(!n.size)return n.set(t,i);const r=Array.from(n.keys()).reduce(((o,a)=>Math.max(o,a)));n.set(t,i),i.setIndex((e=n.get(r))==null?void 0:e.getIndex())}async drill(t){if(this.treeMap.has(t.getId()))return;const{ogma:e,groupsByDepth:s}=this;try{e.modules.graphics.pauseRendering();const n=t.getId(),i=this.getGroupId(n);this.treeMap.set(i,t.getData(this.parentPath)),this.dataMap.set(i,t.getData());const r=t.getData(this.depthPath)||0,o=t.getPosition(),a=await this.onGetSubgraph(t);this.edges.set(i,t.getAdjacentEdges().map((u=>{const h=u.getSource().getId(),g=u.getTarget().getId();return{source:h===n?i:h,target:g===n?i:g,data:{...u.getData()}}}))),a.nodes.forEach((u=>{La(u,Sg(this.parentPath),i),La(u,Sg(this.depthPath),r+1),u.attributes||(u.attributes={}),u.attributes.x=o.x,u.attributes.y=o.y})),this.module.pause(),e.removeEdges(t.getAdjacentEdges()),e.removeNode(t),await e.view.afterNextFrame(),await e.addNodes(a.nodes);const l=a.edges.filter((u=>{const h=u.source,g=u.target;if(e.getNode(h)&&e.getNode(g))return!0;const f=e.getNode(h)?g:h;return this.invalidEdges.has(f)?this.invalidEdges.get(f).push(u):this.invalidEdges.set(f,[u]),!1}));a.nodes.forEach((u=>{if(!this.invalidEdges.has(u.id))return;const{valid:h,invalid:g}=this.invalidEdges.get(u.id).reduce(((f,m)=>(e.getNode(m.source)&&e.getNode(m.target)?f.valid.push(m):f.invalid.push(m),f)),{valid:[],invalid:[]});e.addEdges(h),g.length?this.invalidEdges.set(u.id,g):this.invalidEdges.delete(u.id)})),await e.addEdges(l),s.has(r+1)||this.createGrouping(r+1),this.module.resume(),e.modules.graphics.resumeRendering(),await this.module.afterNextUpdate()}catch(n){throw e.modules.graphics.resumeRendering(),n}}async addEdges(t,e){e.forEach((s=>{const n=this.edges.get(s.getId());n&&this.ogma.addEdges(n,{virtual:!0}).then((i=>{this.context.virtualEdges=this.context.virtualEdges.concat(i)}))}))}getGroupId(t){return`ogma-group-${t}`}getMaxDepth(){return this.groupsByDepth.size}disable(t){return this.enabled=!1,this.duration=typeof t=="number"?t:this.duration,this.easing=typeof t=="object"?t.easing:this.easing,this.groupsByDepth.forEach((e=>e.disable(t))),this.module.animations.hideEdges(this.context.virtualEdges._indexes),this.context.virtualEdges.setSelected(!0),this.module.afterNextUpdate()}enable(t){return this.enabled=!0,this.duration=typeof t=="number"?t:this.duration,this.easing=typeof t=="object"?t.easing:this.easing,this.groupsByDepth.forEach((e=>e.enable(t))),this.module.animations.showEdges(this.context.virtualEdges._indexes),this.module.afterNextUpdate().then((()=>this.context.virtualEdges.setVisible(!0)))}toggle(t){return this.enabled?this.disable(t):this.enable(t)}setOptions(t){this.onGetSubgraph=t.onGetSubgraph?t.onGetSubgraph:this.onGetSubgraph,this.duration=t.duration!==void 0?t.duration:this.duration,this.easing=t.easing||this.easing,this.parentPath=t.parentPath||this.parentPath,this.depthPath=t.depthPath||this.depthPath,this.padding=t.padding!==void 0?t.padding:this.padding,this.nodeGenerator=t.nodeGenerator||this.nodeGenerator,this.showContents=t.showContents!==void 0?t.showContents:this.showContents,this.onGroupUpdate=t.onGroupUpdate||this.onGroupUpdate,this.copyData=t.copyData!==void 0?t.copyData:this.copyData;const e=this.enabled;return this.enabled=t.enabled!==void 0?t.enabled:this.enabled,this.enabled!==e&&this.groupsByDepth.forEach((s=>this.enabled?s.enable({duration:this.duration,easing:this.easing}):s.disable({duration:this.duration,easing:this.easing}))),this.groupsByDepth.forEach((s=>s.refresh())),this.module.afterNextUpdate()}onRemove(t){this.context.virtualEdges=this.context.virtualEdges.filter((e=>!t.has(e._index)))}},eq=class{constructor(t){this.drilldowns=[],this.module=t}addDrilldown(t){this.drilldowns.push(t)}removeDrilldown(t){this.drilldowns=this.drilldowns.filter((e=>e!==t))}onRemove(t,e){e||this.drilldowns.forEach((s=>s.onRemove(t)))}},uM=2;function sq(t){return typeof t.then=="function"}var nq=class{constructor(t,e){this.relayouted=new Set,this.shouldRelayout=new Set,this.layoutPerGroup=new Map,this.nextLayout=new Map,this.nextOnGroupUpdate=null,this.onGroupsUpdate=()=>null,this._onLayoutPrepare=s=>{if(!s.params.nodes)return;const n=s.params.nodes,i=Array.isArray(n)?this.ogma.getNode(n[0])._index:n._indexes[0],r=this.module.nodeToMeta.get(i);if(!r)return;const o={...s,params:{...s.params}};delete o.params.nodes,delete o.params.groups,this.layoutPerGroup.set(r._index,o)},this.ogma=t,this.module=e,this.ogma.events.on("layoutPrepare",this._onLayoutPrepare)}getNodesToRecompute(t){const e=Array.from(t),s=new Set,n=[];for(;e.length>0;){const i=e.shift();if(s.has(i))continue;n.push(i),s.add(i);const r=this.module.nodeToMeta.get(i);r&&e.push(r._index)}return this.ogma.nodeList(n)}getLayoutFunction(t,e,s,n){const i=this.getNextLayout(e._index),r=this.ogma.modules.graphics.getAttributesManager()._layerController.nodes._currentFlexArrays,o={x:r.x.get(e._index),y:r.y.get(e._index)};return()=>{const a=i?i(e,s,n):t(e,s,n);return this._runLayout(a,s,o)}}_runLayout(t,e,s){let n;if(!t)return Promise.resolve(null);if(sq(t))n=t;else{if(!t)return;{const o=this.module.animations.getXs(e),a=this.module.animations.getYs(e),l=this.module.animations.getRs(e);n=this.ogma.layouts[t.layout]({...t.params,nodes:e,dryRun:!0,xs:o,ys:a,rs:l}).then((u=>u.positions.current))}}const i=this.module.animations,r=e._indexes;return n.then((o=>{if(!o)throw new Error("Ogma tansformations, onGroupUpdated callback should return either a layout or a promise containing  positions");let a=0,l=0;if(s){let u=-1/0,h=-1/0,g=1/0,f=1/0;for(let m=0;m<r.length;m++){const y=o[m];y&&(u=Math.max(u,y.x),h=Math.max(h,y.y),g=Math.min(g,y.x),f=Math.min(f,y.y))}a=s.x-(u+g)/2,l=s.y-(h+f)/2}for(let u=0;u<r.length;u++){const h=o[u];h&&(i.xs.set(r[u],h.x+a),i.ys.set(r[u],h.y+l))}}))}handleLayoutFunctions(t){const e=!!this.ogma.modules.layouts.enableBatching;e&&this.ogma.modules.layouts.enableBatching();const s=t.map((i=>i())),n=e?this.ogma.modules.layouts.runBatch():Promise.resolve();return Promise.all(s).then((()=>n))}async handleGlobalLayout(t,e){const s=this.getNextOnGroupUpdate(),n=s?s(t,e):this.onGroupsUpdate(t,e);await this._runLayout(n,t)}async layoutGroups(t,e,s=!1){const n=new Map,i=this.ogma.getNodes(t.map((({groupId:a})=>a)));t.forEach(((a,l)=>{n.set(a.groupId,(()=>this._runLayout(a,this.module.metaToNodes.get(i.get(l)._index))))}));const r=this.getNodesToRecompute(i._indexes),o=new Map;r.forEach((a=>o.set(a._index,this.module.nodeToTransformation.get(a._index).getIndex()))),r.sort(((a,l)=>o.get(a._index)-o.get(l._index)));for(let a=0;a<r.size;a++){const l=o.get(r._indexes[a]);let u;for(u=a+1;u<r.size&&o.get(r._indexes[u])===l;u++);const h=r.slice(a,u);a=u-1,await Promise.all(h.map((g=>{this.relayouted.add(g._index);let f=Promise.resolve();if(n.has(g.getId()))f=n.get(g.getId())();else if(s&&this.layoutPerGroup.has(g._index)){const m=this.module.metaToNodes.get(g._index),y=this.layoutPerGroup.get(g._index);f=this.ogma.layouts[y.name]({...y.params,nodes:m})}return f.then((()=>{this.module.groupController.setGroupXYR(g)}))})))}return await this.module.groupController.onAfterLayouts(),this.module.animations.apply(e||0).finally((()=>{this.relayouted.clear()}))}setNextLayout(t,e){this.nextLayout.set(t,e)}getNextLayout(t){const e=this.nextLayout.get(t);return this.nextLayout.delete(t),e}setNextOnGroupUpdate(t){this.nextOnGroupUpdate=t}getNextOnGroupUpdate(){const t=this.nextOnGroupUpdate;return this.nextOnGroupUpdate=null,t}hasRelayouted(t){return this.relayouted.has(t)}clear(){this.relayouted.clear(),this.shouldRelayout.clear()}},Ag=14,iq=class{constructor(t,e){this.subNodeOffsetX=new Map,this.subNodeOffsetY=new Map,this.openRadius=new Map,this.isExpanding=new Set,this.alreadyGrouped=new Set,this.openGroups=new Set,this.closeGroups=new Set,this.fadedGroups=new Set,this.nodeGroupinCount=0,this.destroyed=!1,this.nodeLayer=new Map,this.edgeLayer=new Map,this.savedNodeLayer=new Map,this.savedEdgeLayer=new Map,this.padding=new Map,this.geoRadius=new Map,this.collapsedGroups=new Set,this.hasUpdated=new Set,this.shouldRunGroupUpdate=!1,this.runningLayouts=!1,this.onSetMultipleAttributes=({elements:n,values:i,options:r,updatedAttributes:o,promises:a})=>{if(this.module.isRefreshing()||this.destroyed||this.runningLayouts||this.module.animations.isApplying())return;const l=new Set(o),u=i;if(!n.isNode||!l.has("x")&&!l.has("y")&&!l.has("radius"))return Promise.resolve();const h=n.toList();if(!h.size)return Promise.resolve();const g=[],f=new Set,m=Array.from(h._indexes);for(;m.length;){const p=m.shift(),x=this.module.nodeToMeta.get(p);if(!x||f.has(x._index))continue;const v=this.getGroupXYR(x,this.module.getSubNodes(x),h,u);v.isGeo?g.push(x.setAttribute("radius",v.radius,r)):(delete v.isGeo,this.closeGroups.has(x._index)||this.collapsedGroups.has(x._index)?(this.openRadius.set(x._index,v.radius),this.module.animations.setXY(x._index,v.x,v.y)):this.module.animations.setXYR(x._index,v.x,v.y,v.radius),f.add(x._index)),m.push(x._index)}const y=h.map(((p,x)=>{if(!this.openGroups.has(p._index))return null;const v=p.getPosition();return Array.isArray(u)&&u[x]?(u[x].x!==void 0&&(v.x=u[x].x),u[x].y!==void 0&&(v.y=u[x].y)):(u.x!==void 0&&(v.x=u.x),u.y!==void 0&&(v.y=u.y)),{group:p,position:v}})).filter((p=>p));y.length&&y.forEach((({group:p,position:x})=>this.animateChildren(p,x))),(f.size>0||y.length)&&g.push(this.module.animations.apply(r)),a.push(...g)},this.ogma=t,this.layoutController=new nq(t,e),this.groupLayer=this.ogma.modules.graphics.addAttributeLayer({name:"groups-layer",priority:5.98,edgeAttributes:{layer:n=>this.edgeLayer.get(n._index)},nodeAttributes:{layer:n=>this.nodeLayer.get(n._index)},nodeDependencies:void 0,edgeDependencies:void 0});const s=t.styles.getClass("_group-fading_");this.fadingClass=s||this.ogma.styles.createClass({name:"_group-fading_",nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0}}),this.module=e,t.events.on("setMultipleAttributes",this.onSetMultipleAttributes).on("beforeGeoCameraMove",(({zoom:n})=>{const i=this.ogma.nodeList(Array.from(this.geoRadius.keys())).filter((r=>r&&!this.collapsedGroups.has(r._index)&&this.openGroups.has(r._index)));i.forEach((r=>{const o=this.geoRadius.get(r._index)*2**n;this.module.animations.setOpenRadius(r._index,o)})),this.ogma.modules.geo._projection&&this.ogma.modules.geo._projection.updateElements(i)})).on(["geoEnabled","beforeGeoDisabled"],(()=>this._onToggleGeo())).on("geoNodesMoved",(({nodes:n})=>{const i=n._indexes;for(let r=0;r<i.length;r++){const o=this.module.getMetaNode(n.get(r));!o||!this.openGroups.has(o._index)||this.layoutController.shouldRelayout.add(o._index)}}))}setSubEltsLayer(t,e,s){const n=s?uM:-2;if(!this.isOpen(t))return;const i=this.module.getSubNodes(t);i.forEach((o=>{this.nodeLayer.set(o._index,e+n),this.setSubEltsLayer(o,e+n,s)}));const r=i.getAdjacentEdges({bothExtremities:!0});for(let o=0;o<r.size;o++)this.edgeLayer.set(r._indexes[o],e+n)}setNodeGroupingCount(t){this.nodeGroupinCount=t}getNodeGroupingCount(){return this.nodeGroupinCount}updateGroupLayer(t,e){this.groupLayer.updateElements(t||this.ogma.getNodes()),this.groupLayer.updateElements(e||this.ogma.getEdges())}closeGroup(t,e,s,n,i=!1){const r=[e],o=this.closeGroups.has(t._index)||this.collapsedGroups.has(t._index);this.openGroups.delete(t._index),this.closeGroups.add(t._index),i?this.fadedGroups.add(t._index):this.fadedGroups.delete(t._index),this.hasUpdated.add(t._index);const a=this.module.animations,l=i?0:a.getCloseRadius(t._index),u=a.getOpenRadius(t._index);if(u!==void 0&&!o&&this.openRadius.set(t._index,u),a.setXYR(t._index,s,n,l),i)return;for(;r.length;){const g=r.shift(),f=g._indexes,m=g.getAdjacentEdges({bothExtremities:!0}),y=new Set;for(let x=0;x<m._indexes.length;x++)y.add(m._indexes[x]);const p=g.getAdjacentEdges({bothExtremities:!1}).filter((x=>!y.has(x._index)));a.setXYR(f,s,n,l),a.hideNodesAfter(f),a.hideEdgesAfter(m._indexes),a.hideEdgesAfter(p._indexes),a.pushAfter((()=>{const x=[];a.deleteOpenRadius(t._index);for(let v=0;v<f.length;v++){const b=this.closeGroups.has(f[v]);x.push(b?l:this.openRadius.get(f[v]))}this.module.animations.setRs(g._indexes,x)}));for(let x=0;x<f.length;x++){if(!this.openGroups.has(f[x]))continue;const v=g.get(x);this.collapsedGroups.add(v._index);const b=this.module.getSubNodes(g.get(x));b.size&&r.push(b)}}const h=this.module.getMetaNode(t);h&&this.openGroups.has(h._index)&&this.layoutController.shouldRelayout.add(h._index)}setGroupXYR(t){const e=this.getGroupXYR(t,this.module.getSubNodes(t),void 0,void 0);e.isGeo?(this.setGeoLatLng(t,e.y,e.x),this.module.animations.setR(t._index,e.radius)):this.module.animations.setXYR(t._index,e.x,e.y,e.radius)}setGeoLatLng(t,e,s){this.ogma.modules.data.setProperty(t,this.ogma.modules.geo.latitudePath,e,{virtual:!0}),this.ogma.modules.data.setProperty(t,this.ogma.modules.geo.longitudePath,s,{virtual:!0})}expandGroup(t,e,s=!1){const n=this.module.animations,i=t.getPosition(),r=this.fadedGroups.has(t._index);s?this.fadedGroups.add(t._index):(this.fadedGroups.delete(t._index),this.openGroups.add(t._index),this.closeGroups.delete(t._index),this.collapsedGroups.delete(t._index)),this.isExpanding.add(t._index),this.hasUpdated.add(t._index);const o=[{subNodes:e,offset:this.getOffset(t._index),isClosed:!1,wasCollapsed:!r}];for(;o.length;){const{subNodes:l,offset:u,isClosed:h,wasCollapsed:g}=o.shift();if((h||g)&&n.pushBefore((()=>l.setAttributes(i,0))),h)continue;const f=l._indexes,m=l.getAdjacentEdges({bothExtremities:!0,filter:"all"});l.setVisible(!0),m.setVisible(!0);for(let y=0;y<f.length;y++){const p=this.closeGroups.has(f[y]);n.setXYR(f[y],i.x+u.x+this.subNodeOffsetX.get(f[y])||0,i.y+u.y+this.subNodeOffsetY.get(f[y])||0,p?this.module.animations.getCloseRadius(f[y]):this.openRadius.get(f[y])),this.collapsedGroups.delete(f[y]);const x=this.module.getSubNodes(l.get(y));x.size&&o.push({subNodes:x,isClosed:p,wasCollapsed:g||this.collapsedGroups.has(f[y]),offset:{x:u.x+this.subNodeOffsetX.get(f[y])||0,y:u.y+this.subNodeOffsetY.get(f[y])||0}})}}const a=this.module.getMetaNode(t);a&&this.openGroups.has(a._index)&&this.layoutController.shouldRelayout.add(a._index),n.setXYR(t._index,i.x,i.y,s?0:this.openRadius.get(t._index))}getOffset(t){return this.collapsedGroups.has(t)&&this.subNodeOffsetX.has(t)?{x:this.subNodeOffsetX.get(t),y:this.subNodeOffsetY.get(t)}:{x:0,y:0}}restorePositions(t,e){const s=t.getPosition(),n=(e=e.filter((o=>!o.isVirtual())))._indexes,i=this.getOffset(t._index),r=[];for(let o=0;o<n.length;o++)r.push({x:i.x+s.x+this.subNodeOffsetX.get(n[o])||0,y:i.x+s.y+this.subNodeOffsetY.get(n[o])||0});e.setAttributes(r,0)}animateChildren(t,e){const s=[{parent:t,position:e}];for(;s.length;){const{parent:n,position:i}=s.shift();if(!n.isNode)continue;const r=this.module.getSubNodes(n);r.size&&r.forEach((o=>{const a=this.subNodeOffsetX.get(o._index)||0,l=this.subNodeOffsetY.get(o._index)||0,u={x:i.x+a,y:i.y+l};this.module.animations.setXY(o._index,u.x,u.y),s.push({parent:o,position:u})}))}}addOpenGroup(t){this.openGroups.add(t._index),this.closeGroups.delete(t._index)}isOpen(t){return this.openGroups.has(t._index)}isClose(t){return this.closeGroups.has(t._index)}setPadding(t,e){const s=new Set,n=isNaN(+e),i=e;return t.forEach((r=>{const o=n?i(r):+e;this.padding.get(r._index)!==o&&s.add(r._index),this.padding.set(r._index,o)})),s}getGroupXYR(t,e,s,n){let i,r,o;const a=this.module.animations,l=this.ogma.geo.enabled();if(i=new Array(e.size).fill(0),r=new Array(e.size).fill(0),o=new Array(e.size).fill(0),l){const y=e.getData(this.ogma.modules.geo.latitudePath),p=e.getData(this.ogma.modules.geo.longitudePath);i=[],r=[],o=[];for(let x=0;x<y.length;x++){const{x:v,y:b}=this.ogma.geo.getMap().project({lat:y[x],lng:p[x]},Ag);i.push(v),r.push(b),o.push(2**Ag*this.geoRadius.get(e._indexes[x])||10)}}else{const y=this.ogma.modules.graphics.getAttributesManager()._layerController.nodes._currentFlexArrays,p=this.openGroups.has(t._index),x=this.isExpanding.has(t._index),v=p&&!x?y.radius:a.getInputFlexArrays().radius;for(let b=0;b<e.size;b++)i[b]=y.x.get(e._indexes[b]),r[b]=y.y.get(e._indexes[b]),o[b]=v.get(e._indexes[b])}if(s&&n&&s.isNode){const y=s._indexes,p=new Map,x=new Map,v=new Map;for(let S=0;S<y.length;S++){const A=Array.isArray(n)?n[S]:n;!isNaN(A.x)&&p.set(y[S],A.x),!isNaN(A.y)&&x.set(y[S],A.y),!isNaN(A.radius)&&v.set(y[S],A.radius)}const b=e._indexes;for(let S=0;S<b.length;S++)p.has(b[S])&&(i[S]=p.get(b[S])),x.has(b[S])&&(r[S]=x.get(b[S])),v.has(b[S])&&(o[S]=v.get(b[S]))}const u=e._indexes;for(let y=0;y<u.length;y++)!this.closeGroups.has(u[y])&&!this.collapsedGroups.has(u[y])&&this.openRadius.has(u[y])&&(o[y]=this.openRadius.get(u[y]));if(!l)for(let y=0;y<u.length;y++)a.xs.get(u[y])!==void 0&&(i[y]=a.xs.get(u[y])),a.ys.get(u[y])!==void 0&&(r[y]=a.ys.get(u[y])),a.rs.get(u[y])!==void 0&&(o[y]=a.rs.get(u[y]));let h=0,g=0,f=0;const m=b0.algorithms.minDisk(i,r,o);if(h=m[0],g=m[1],f=m[2],f+=this.padding.get(t._index)||0,l){const{lat:y,lng:p}=this.ogma.geo.getMap().unproject({x:h,y:g},Ag);h=p,g=y,f/=2**Ag,this.geoRadius.set(t._index,f),f*=2**this.ogma.geo.getZoom()}else this.openRadius.set(t._index,f),e.forEach(((y,p)=>{this.subNodeOffsetX.set(y._index,i[p]-h),this.subNodeOffsetY.set(y._index,r[p]-g)}));return{x:h,y:g,radius:f,isGeo:l}}async onAfterLayouts(){const t=this.module.animations,e=this.module.getList().filter((r=>r.getName()===Xn.NodeGrouping&&r.isEnabled())),s=[];let n=!1;for(let r=e.length-1;r>=0;r--)e[r].getContext().metaNodes.forEach((o=>{if(o.getMetaNode())return;n||(n=this.hasUpdated.has(o._index)||this.layoutController.relayouted.has(o._index)||this.layoutController.shouldRelayout.has(o._index));const a=!this.collapsedGroups.has(o._index)&&!this.closeGroups.has(o._index);s.push({group:o,collapsed:!a})}));if(n||this.shouldRunGroupUpdate){this.shouldRunGroupUpdate=!1;const r=this.ogma.getNodes().filter((a=>{const l=this.module.getMetaNode(a);return!l||!this.module.nodeToTransformation.get(l._index).isEnabled()})),o=new Array(r.size);for(let a=0;a<r.size;a++)o[a]=this.openRadius.get(r._indexes[a])||this.module.animations.getCloseRadius(r._indexes[a])||0;await this.layoutController.handleGlobalLayout(r,o)}const i=new Set;for(;s.length;){const{group:r,collapsed:o}=s.shift();if(i.has(r._index))continue;i.add(r._index);const a=this.module.getSubNodes(r),l=a._indexes,u=t.xs.get(r._index),h=t.ys.get(r._index);if(u!==void 0&&h!==void 0){if(o){t.deleteOpenRadius(r._index);for(let g=0;g<l.length;g++)t.setXY(l[g],u,h)}else for(let g=0;g<l.length;g++)t.setXY(l[g],u+this.subNodeOffsetX.get(l[g])||0,h+this.subNodeOffsetY.get(l[g])||0);for(let g=0;g<l.length;g++)this.module.isVirtual(l[g],!0)&&s.push({group:a.get(g),collapsed:this.collapsedGroups.has(l[g])||this.closeGroups.has(l[g])||o})}}this.hasUpdated.clear(),this.layoutController.clear(),this.isExpanding.clear()}cleanup(t,e,s){let n=t._indexes;for(let i=0;i<n.length;i++)this.padding.delete(n[i]),this.openGroups.delete(n[i]),this.closeGroups.delete(n[i]),this.nodeLayer.delete(n[i]),this.savedNodeLayer.delete(n[i]),this.savedEdgeLayer.delete(n[i]);for(let i=0;i<e.size;i++)this.edgeLayer.delete(e._indexes[i]);if(s){n=s._indexes;for(let i=0;i<n.length;i++)this.subNodeOffsetX.delete(n[i]),this.subNodeOffsetY.delete(n[i])}}getPositions(t,e){const{x:s,y:n}=t.getPosition();return e.map((i=>({x:s+(this.subNodeOffsetX.get(i._index)||0),y:n+(this.subNodeOffsetY.get(i._index)||0)})))}hideSubNodes(t){const e=[t];for(;e.length;){const s=e.pop();s.setVisible(!1);for(let n=0;n<s._indexes.length;n++)this.collapsedGroups.add(s._indexes[n]),this.openGroups.has(s._indexes[n])&&e.push(this.module.getSubNodes(s.get(n)))}}onRemove(t,e){if(!e)return;const s=[],n=new Set;for(let i=0;i<t.length;i++){const r=this.module.nodeToMeta.get(t[i]);if(!r)continue;const o=r._index;this.openRadius.delete(o),this.isExpanding.delete(o),this.alreadyGrouped.delete(o),this.collapsedGroups.delete(o),this.closeGroups.delete(o),this.openGroups.delete(o),this.padding.delete(o),this.geoRadius.delete(o),this.hasUpdated.delete(o),this.subNodeOffsetX.delete(o),this.subNodeOffsetY.delete(o),this.nodeLayer.delete(o),this.edgeLayer.delete(o),this.savedNodeLayer.delete(o),this.savedEdgeLayer.delete(o),this.openGroups.has(o)&&(this.layoutController.shouldRelayout.add(o),s.push(o))}for(;s.length;){const i=s.shift();if(n.has(i))continue;n.add(i);const r=this.module.nodeToMeta.get(i);r&&this.openGroups.has(r._index)&&(this.layoutController.shouldRelayout.add(r._index),s.push(r._index))}}async fishEyeExpand(t,e,s){if(!t.isVirtual())throw new Error("Focus node is not virtual.");const n=this.module.nodeToMeta.get(t._index);if(n&&n.isVisible())throw new Error("Focus node is not at top level.");const i=this.module.animations,r=this.ogma,o=i.getCloseRadius(t._index);s&&(this.layoutController.setNextLayout(t._index,s),this.layoutController.shouldRelayout.add(t._index)),this.layoutController.setNextOnGroupUpdate((async a=>{const l=i.getXYR(t.toList())[0].radius-o,u=i.getXYR(a);return await r.algorithms.fishEyeExpand({nodes:a,focusNode:t,dryRun:!0,deltaRadius:l,xyr:u})})),await e(),await this.module.afterNextUpdate()}setNodeLayer(t,e){this.nodeLayer.set(t,e),this.savedNodeLayer.set(t,e)}setEdgeLayer(t,e){this.edgeLayer.set(t,e),this.savedEdgeLayer.set(t,e)}async fishEyeCollapse(t,e){if(!t.isVirtual())throw new Error("Focus node is not virtual.");const s=this.module.nodeToMeta.get(t._index);if(s&&s.isVisible())throw new Error("Focus node is not at top level.");const n=this.module.animations,i=this.ogma,r=t.getAttribute("radius");this.layoutController.setNextOnGroupUpdate((async o=>{const a=n.getXYR(t.toList())[0].radius-r,l=n.getXYR(o);return await i.algorithms.fishEyeExpand({nodes:o,focusNode:t,dryRun:!0,deltaRadius:a,xyr:l})})),await e(),await this.module.afterNextUpdate()}triggerGroupsUpdate(){this.shouldRunGroupUpdate=!0}layoutGroups(t,e,s=!1){return this.runningLayouts=!0,this.layoutController.layoutGroups(t,e,s).finally((()=>{this.runningLayouts=!1}))}_onToggleGeo(){this.geoRadius.clear();const t=this.module.getList().find((s=>s.getName()===Xn.NodeGrouping));if(!t)return;const e=Array.from(this.openGroups.keys());for(let s=0;s<e.length;s++)this.layoutController.shouldRelayout.add(e[s]);t.refresh()}startRefresh(){this.alreadyGrouped.clear()}clear(){this.subNodeOffsetX.clear(),this.subNodeOffsetY.clear(),this.openRadius.clear(),this.isExpanding.clear(),this.layoutController.clear(),this.alreadyGrouped.clear(),this.openGroups.clear(),this.closeGroups.clear(),this.nodeLayer.clear(),this.edgeLayer.clear(),this.padding.clear(),this.geoRadius.clear(),this.collapsedGroups.clear(),this.hasUpdated.clear()}destroy(){this.destroyed||(this.destroyed=!0,this.ogma.events.off(this.onSetMultipleAttributes))}},rq=class{constructor(t){this.ogma=t}save(){this.selectedNodes=this.ogma.getSelectedNodes(),this.selectedEdges=this.ogma.getSelectedEdges(),this.ogma.modules.selection.disableEvents()}restore(){const t=this.selectedNodes.filter((i=>!this.ogma.getNode(i.getId()))),e=this.selectedEdges.filter((i=>!this.ogma.getEdge(i.getId()))),s=new Set,n=new Set;if(t.size){this.ogma.modules.events.fire("nodesUnselected",{nodes:t});for(let i=0;i<t.size;i++)s.add(t._indexes[i])}if(e.size){this.ogma.modules.events.fire("edgesUnselected",{edges:e});for(let i=0;i<e.size;i++)n.add(e._indexes[i])}this.selectedNodes.filter((i=>!i.isSelected()&&!s.has(i._index))).setSelected(!0),this.selectedEdges.filter((i=>!i.isSelected()&&!n.has(i._index))).setSelected(!0),this.ogma.modules.selection.enableEvents()}cleanup(){this.selectedNodes=void 0,this.selectedEdges=void 0,this.ogma.modules.selection.enableEvents&&this.ogma.modules.selection.enableEvents()}},oq={setData:!1,addElement:!0,removeElement:!0,setOptions:!1,refresh:!1},aq=class Zy{constructor(){this.prev={},this.next={},this.prevorder=[],this.nextorder=[],this.shouldAnimate=!1,this.minRefreshIndex=0}addTransformation(e,s){this.next[e]=s,this.nextorder.push(e)}removeTransformation(e){delete this.next[e]}setIndex(e,s){const n=this.nextorder.indexOf(e);this.nextorder.splice(n,1),this.nextorder.splice(s,0,e),this.minRefreshIndex=Math.min(this.minRefreshIndex,n,s)}setEnabled(e,s){this.next[e]=s}isEnabled(e){return this.prev[e]||!1}static getDiff(e,s){const n=new Map;for(const i in e)s[i]!==void 0?s[i]!==e[i]&&n.set(+i,{shouldDo:s[i],shouldUndo:e[i]}):n.set(+i,{shouldDo:!1,shouldUndo:e[i],shouldCleanup:!0});for(const i in s)e[i]===void 0&&s[i]===!0&&n.set(+i,{shouldDo:!0,shouldUndo:!1});return n}getFirstChange(e){const{nextorder:s}=this;let n=s.length;for(let i=0;i<s.length;i++){const r=e.get(s[i]);if(r&&(r.shouldUndo||r.shouldDo)){n=i;break}}return n}refreshFrom(e,s){const{nextorder:n}=this;for(let i=s;i<this.nextorder.length;i++)e.set(n[i],{shouldUndo:this.prev[n[i]],shouldDo:this.prev[n[i]],...e.get(n[i])||{}});return e}isDirty(){const e=Zy.getDiff(this.prev,this.next),s=Math.min(this.minRefreshIndex,this.getFirstChange(e));return(e.size>0||s<this.nextorder.length)&&{reason:e.size>0?"diff":"refresh",index:s}}invalidateFrom(e,s){this.shouldAnimate||(this.shouldAnimate=oq[s]),this.minRefreshIndex=Math.min(this.minRefreshIndex,e)}step(){const e=Zy.getDiff(this.prev,this.next);this.prev={...this.next};const s=Math.min(this.minRefreshIndex,this.getFirstChange(e)),n=this.nextorder.reduce(((o,a,l)=>o.set(a,l)),new Map),i=this.prevorder.reduce(((o,a,l)=>o.set(a,l)),new Map);this.nextorder=this.nextorder.filter((o=>this.prev[o]!==void 0)),this.prevorder=[...this.nextorder],this.minRefreshIndex=this.nextorder.length;const r=this.shouldAnimate;return this.shouldAnimate=!1,{diff:this.refreshFrom(e,s),nextorder:n,prevorder:i,shouldAnimate:r}}done(){}},lq=class{constructor(t){this.transformations=[],this.addingGraph=!1,this.addingElements=!1,this.nodeToTransformation=new Map,this.edgeToTransformation=new Map,this.nodeVirtual=new Set,this.edgeVirtual=new Set,this.nodeToMeta=new Map,this.edgeToMeta=new Map,this.metaToNodes=new Map,this.metaToEdges=new Map,this._onDestroy=()=>{this.destroy()},this._onAddElements=({nodes:e,edges:s,virtual:n})=>{if(n){if(e)for(let i=0;i<e.size;i++)this.nodeVirtual.add(e._indexes[i]);if(s)for(let i=0;i<s.size;i++)this.edgeVirtual.add(s._indexes[i])}else this.addingGraph||this.addingElements||(this.state.invalidateFrom(0,"addElement"),this.invalidate())},this._onSetData=({elements:e,virtual:s})=>{if(s)return;const{isNode:n,_indexes:i}=e;let r=1/0;for(const o of i){const a=this.getTransformation(o,n);if(!a){r=0;break}r=Math.min(r,a.getIndex())}return this.state.invalidateFrom(r,"setData"),this.invalidate(),r},this._onRequestElementsToDelete=e=>{const{elementsToRemove:s}=e,n=s.isNode,i=s._indexes,r=this.getLeafElements(i,n);e.elementsToRemove=n?this.ogma.nodeList(r):this.ogma.edgeList(r)},this._onAfterRemoveElements=({nodes:e,edges:s})=>{if(!this.ogma.isDestroyed()){if(e)for(let n=0;n<e.size;n++)this.nodeVirtual.delete(e._indexes[n]);if(s)for(let n=0;n<s.size;n++)this.edgeVirtual.delete(s._indexes[n])}},this._onRemoveElements=({nodes:e,edges:s,virtual:n})=>{n||this.ogma.isDestroyed()||this._refreshPromise.then((()=>{const i=!!e,r=i?e._indexes:s._indexes,o=new Set(r);this.transformations.forEach((a=>a.onRemove(o,i))),this.groupController.onRemove(r,i),this.drilldownController.onRemove(o,i),i?(this.nodeToMeta.clear(),this.metaToNodes.clear(),this.nodeToTransformation.clear()):(this.edgeToMeta.clear(),this.metaToEdges.clear(),this.edgeToTransformation.clear()),this.state.invalidateFrom(0,"removeElement"),this.invalidate()}))},this._onClearGraph=()=>{this.transformations.forEach((e=>{e.cleanup()})),this.groupController.clear(),this.nodeToMeta.clear(),this.edgeToMeta.clear(),this.metaToNodes.clear(),this.metaToEdges.clear(),this.nodeToTransformation.clear(),this.edgeToTransformation.clear(),this.state.invalidateFrom(0,"removeElement"),this.invalidate()},this.ogma=t,this.state=new aq,this.animations=new W$(t),this._shouldRefresh=!1,this._refreshing=!1,this.isDestroyed=!1,this.isPaused=!1,this.selection=new rq(t),this._refreshPromise=Promise.resolve(),this.groupController=new iq(t,this),this.drilldownController=new eq(this),this.ogma.events.on("setData",this._onSetData).on("preAddGraph",(()=>{this.addingGraph=!0})).on("postAddGraph",(()=>{this.addingGraph=!1,this.state.invalidateFrom(0,"addElement"),this.invalidate()})).on("preAddElements",(({virtual:e})=>{e||this.addingGraph||(this.addingElements=!0)})).on("postAddElements",(({virtual:e})=>{e||this.addingGraph||(this.addingElements=!1,this.state.invalidateFrom(0,"addElement"),this.invalidate())})).on(["addNodes","addEdges"],this._onAddElements).on(["removeNodes","removeEdges"],this._onRemoveElements).on("clearGraph",this._onClearGraph).on(["afterRemoveNodes","afterRemoveEdges"],this._onAfterRemoveElements).on("requestElementsToDelete",this._onRequestElementsToDelete).on("destroy",this._onDestroy)}addTransformation(t,e=!0){this.state.addTransformation(t.getId(),e),this.transformations.push(t),this.invalidate()}removeTransformation(t){const e=this.transformations.indexOf(t);e!==-1&&this.transformations.splice(e,1),this.invalidate()}async step(t=0,e={fireEnabled:[],fireDisabled:[],fireRefresh:[],fireDestroy:[],fireSetIndex:[]}){var s;if(t>5)throw new Error("Ogma transformations: Transformations refresh in loop");const{diff:n,prevorder:i,nextorder:r}=this.state.step(),{fireEnabled:o,fireDisabled:a,fireRefresh:l,fireDestroy:u,fireSetIndex:h}=e,g=[],f=[],m=[];this.groupController.startRefresh();for(const p of this.transformations){const x=p.getId();if(!n.has(x))continue;const{shouldDo:v,shouldUndo:b,shouldCleanup:S}=n.get(x);v&&!b?o.push(p):b&&!v?a.push(p):v&&b&&l.push(p),i.has(x)&&i.get(x)!==r.get(x)&&h.push(p),b&&g.push(p),v&&f.push(p),S&&(u.push(p),m.push(p))}let y=0;g.sort(((p,x)=>i.get(x.getId())-i.get(p.getId())||0));for(const p of g){const x=!((s=n.get(p.getId()))!=null&&s.shouldDo);x&&(y=this.animations.getMaxAnimation(y,p.getAnimation())),await p.undo(x)}f.sort(((p,x)=>r.get(p.getId())-r.get(x.getId())||0)),this.ogma.modules.graphics.pauseRendering();for(let p=0;p<f.length;p++){const x=f[p],v=p===f.length-1;v&&(y=this.animations.getMaxAnimation(y,x.getAnimation())),await x.run(v)}for(const p of m)await p.cleanup();if((g.length||f.length||m.length)&&(this.groupController.updateGroupLayer(),await this.groupController.onAfterLayouts()),this.ogma.modules.graphics.resumeRendering(),await this.animations.apply(y),!this.isDestroyed)return this.state.isDirty()?this.step(t+1,e):e}refresh(){this.isDestroyed||this.ogma.isDestroyed()||!this._shouldRefresh||!this.transformations.length||this._refreshing||this.addingGraph||this.addingElements||this.isPaused||(this._shouldRefresh=!1,this._refreshing=!0,this._refreshPromise=this._refreshPromise.then((()=>(this.selection.save(),this.step().then((t=>{this._refreshing=!1;const{fireEnabled:e,fireDisabled:s,fireRefresh:n,fireDestroy:i,fireSetIndex:r}=t,o=this.ogma.modules.events;s.reverse().forEach((a=>o.fire("transformationDisabled",{target:a}))),e.forEach((a=>o.fire("transformationEnabled",{target:a}))),r.forEach((a=>o.fire("transformationSetIndex",{target:a}))),n.forEach((a=>o.fire("transformationRefresh",{target:a}))),i.forEach((a=>o.fire("transformationDestroyed",{target:a})))})).finally((()=>{this.selection.restore(),this.selection.cleanup(),this.ogma.modules.graphics.resumeRendering()}))))).catch((t=>{const e=this.state.isDirty();if(!e)throw new Error(`Ogma transformations, refresh failed.
${t.stack}`);const s=e.reason==="diff"?"You are constantly adding/removing/changing index of a transformation":"You are constantly adding/removing/updating nodes or edges while transformations refresh";throw new Error(`Ogma transformations, refresh failed.
${s}`)})).catch((t=>{if(!this.onRefreshError)throw t;this.onRefreshError(t)})).finally((()=>{})))}enable(t){return this.state.setEnabled(t.getId(),!0),this.invalidate(),this.afterNextUpdate()}disable(t){return this.state.setEnabled(t.getId(),!1),this.invalidate(),this.afterNextUpdate()}remove(t){return this.disable(t),this.state.removeTransformation(t.getId()),this.afterNextUpdate().then((()=>{this.transformations.splice(this.getIndex(t),1)}))}isEnabled(t){return this.state.isEnabled(t.getId())}getList(){return this.transformations.slice()}getIndex(t){for(let e=0;e<this.transformations.length;e++)if(this.transformations[e]===t)return e;return-1}setIndex(t,e){const s=this.getIndex(t);this.state.setIndex(t.getId(),e),this.transformations.splice(s,1),this.transformations.splice(e,0,t),this.invalidate()}setOptions(t){this.state.invalidateFrom(this.getIndex(t),"setOptions"),this.invalidate()}refreshTransformation(t){this.state.invalidateFrom(this.getIndex(t),"refresh"),this.invalidate()}clear(){return this.transformations.forEach((t=>t.destroy(0))),this.invalidate(),this.afterNextUpdate()}destroy(){this.transformations.forEach((t=>t.destroy(0))),this.groupController.destroy(),this._refreshPromise=Promise.resolve(),this.isDestroyed=!0}invalidate(){this.ogma.isDestroyed()||(this._shouldRefresh=!0,this.ogma.modules.dom.refresh(),this.ogma.modules.dom.onNextFrame().then((()=>{this.refresh()})))}afterNextUpdate(){return this.ogma.view.afterNextFrame().then((()=>this._refreshPromise))}getTransformation(t,e){return e?this.nodeToTransformation.get(t):this.edgeToTransformation.get(t)}setTransformation(t,e,s){s?this.nodeToTransformation.set(t,e):this.edgeToTransformation.set(t,e)}deleteTransformation(t){const e=t.isNode?this.nodeToTransformation:this.edgeToTransformation,s=t._indexes;for(const n of s)e.delete(n)}setMetaNode(t,e){this.nodeToMeta.set(t,e)}setSubNodes(t,e){this.metaToNodes.set(t,e)}setMetaElement(t,e,s){s?this.setMetaNode(t,e):this.setMetaEdge(t,e)}setSubElements(t,e,s){s?this.setSubNodes(t,e):this.setSubEdges(t,e)}removeMetaNodes(t){const e=t._indexes;for(const s of e){const n=this.metaToNodes.get(s);n&&n.forEach((i=>this.nodeToMeta.delete(i._index))),this.nodeToTransformation.delete(s),this.metaToNodes.delete(s)}}removeMetaEdges(t){const e=t._indexes;for(const s of e){const n=this.metaToEdges.get(s);n&&n.forEach((i=>this.edgeToMeta.delete(i._index))),this.edgeToTransformation.delete(s),this.metaToEdges.delete(s)}}clearSubNodes(t){this.metaToNodes.delete(t)}clearMetaNode(t){this.nodeToMeta.delete(t)}setMetaEdge(t,e){this.edgeToMeta.set(t,e)}setSubEdges(t,e){this.metaToEdges.set(t,e)}clearSubEdges(t){this.metaToEdges.delete(t)}clearMetaEdge(t){this.edgeToMeta.delete(t)}getMetaNode(t){return this.nodeToMeta.get(t._index)||null}getMetaEdge(t){return this.edgeToMeta.get(t._index)||null}getLeafElements(t,e){const s=[t],n=e?this.metaToNodes:this.metaToEdges,i=[];for(;s.length;){const r=s.pop();for(let o=0;o<r.length;o++){i.push(r[o]);const a=n.get(r[o]);a&&s.push(a._indexes)}}return i}getSubElements(t){const e=t.isNode?this.metaToNodes:this.metaToEdges,s=t.toList()._indexes;let n=0;for(let o=0;o<s.length;o++){const a=e.get(s[o]);a&&(n+=a.size)}const i=new Uint32Array(n);let r=0;for(let o=0;o<s.length;o++){const a=e.get(s[o]);if(a)for(let l=0;l<a.size;l++)i[r++]=a._indexes[l]}return t.isNode?this.ogma.nodeList(i):this.ogma.edgeList(i)}getSubNodes(t){return this.getSubElements(t)}getSubEdges(t){return this.getSubElements(t)}getById(t){return this.transformations.find((e=>e.getId()===t))}isIntraEdge(t){const e=t.getSource()._index;return this.nodeToMeta.has(e)&&this.nodeToMeta.get(e)===this.nodeToMeta.get(t.getTarget()._index)}isVirtual(t,e){return e?this.nodeVirtual.has(t):this.edgeVirtual.has(t)}isRefreshing(){return this._refreshing}pause(){this.isPaused=!0}resume(){this.isPaused=!1,this.refresh()}},ti="_transparent",hu=t=>!0,uq=()=>{};function dM(t){if(t.keys)return Array.from(t.keys());const e=[];return t.forEach(((s,n)=>e.push(n))),e}function Ef(t){if(t.values)return Array.from(t.values());const e=[];return t.forEach((s=>e.push(s))),e}function kA(t){return!(!t||t.constructor!==Object&&t.constructor)}var Na=(...t)=>{const e={};for(let s=0;s<t.length;s++){const n=t[s];for(const i in n)n.hasOwnProperty(i)&&(Array.isArray(e[i])&&Array.isArray(n[i])?e[i]=Array.from(new Set(e[i].concat(n[i]))):kA(e[i])&&kA(n[i])?e[i]=Na(e[i],n[i]):e[i]=n[i])}return e};function dq(t){return Array.isArray(t)?t:[t]}var Ky=()=>!0,hM=()=>!1,hq=()=>null,cq=class extends Qo{constructor(t){super(t),this.nodeSelector=t.criteria||hu}setOptions(t){return this.nodeSelector=t.criteria||this.nodeSelector,super.setOptions(t)}getName(){return Xn.NodeFilter}run(){const t=this.nodeSelector,e=this.ogma.getNodes().filter((a=>!t||!t(a))),s=e.getAdjacentEdges();this.module.animations.hideNodes(e._indexes),this.module.animations.hideEdges(s._indexes),e.setVisible(!1),s.setVisible(!1);const n=e.subtract(this.context.hiddenNodes),i=s.subtract(this.context.hiddenEdges),r=this.context.hiddenNodes.subtract(e),o=this.context.hiddenEdges.subtract(s);return this.module.animations.pushBefore((()=>{r.setVisible(!0),r.setVisible(!0),i.setVisible(!0),n.setVisible(!0),r.addClass(ti),o.addClass(ti)})),this.module.animations.push((()=>Promise.all([o.removeClass(ti,this.animation),r.removeClass(ti,this.animation),n.addClass(ti,this.animation),i.addClass(ti,this.animation)]))),this.context={...this.context,hiddenNodes:e,hiddenEdges:s},Promise.resolve()}undo(t=!0){const{hiddenNodes:e,hiddenEdges:s}=this.context,n=t?this.animation:0;return e.setExcluded(!1),s.setExcluded(!1),t&&(e.addClass(ti),s.addClass(ti),this.module.animations.push((()=>Promise.all([e.removeClass(ti,n),s.removeClass(ti,n)]))),this.context.hiddenNodes=this.ogma.nodeList(),this.context.hiddenEdges=this.ogma.edgeList()),Promise.resolve()}onRemove(t,e){e?this.context.hiddenNodes=this.context.hiddenNodes.filter((s=>!t.has(s._index))):this.context.hiddenEdges=this.context.hiddenEdges.filter((s=>!t.has(s._index)))}resetContext(){this.context={...this.context,hiddenEdges:this.ogma.edgeList(),hiddenNodes:this.ogma.nodeList()}}},gq=class extends Qo{constructor(t){super(t),this.edgeSelector=t.criteria||hu}setOptions(t){return this.edgeSelector=t.criteria||this.edgeSelector,super.setOptions(t)}getName(){return Xn.EdgeFilter}run(){const t=this.edgeSelector,e=this.ogma.getEdges().filter((r=>!t||!t(r))),s=this.module.animations;e.setVisible(!1);const n=e.subtract(this.context.hiddenEdges),i=this.context.hiddenEdges.subtract(e);return this.module.animations.pushBefore((()=>{n.setVisible(!0),i.setVisible(!0),i.addClass(ti)})),s.hideEdges(e._indexes),s.push((()=>Promise.all([i.removeClass(ti,this.animation),n.addClass(ti,this.animation)]))),this.context={...this.context,hiddenEdges:e},Promise.resolve()}undo(t=!0){super.undo(t);const{hiddenEdges:e}=this.context,s=t?this.animation:0;return e.setExcluded(!1),t&&(e.addClass(ti),this.module.animations.push((()=>Promise.all([e.removeClass(ti,s)]))),this.context.hiddenEdges=this.ogma.edgeList()),Promise.resolve()}onRemove(t,e){e||(this.context.hiddenEdges=this.context.hiddenEdges.filter((s=>!t.has(s._index))))}resetContext(){this.context={...this.context,hiddenEdges:this.ogma.edgeList()}}},ln="_faded",fq=class extends Qo{constructor(t){super(t),this.selector=t.selector||hM,this.dataFunction=t.dataFunction||uq}getName(){return Xn.NeighborMerging}run(t=!0){const{ogma:e}=this,s=t?this.animation:0,n=e.getNodes().filter(this.selector),i=[],r=new Map;for(let f=0;f<n.size;++f){const m=n.get(f),y=m.getAdjacentEdges(),p=this.dataFunction(m);for(let x=0;x<y.size;++x){const v=y.get(x),b=v.getSource(),S=v.getTarget();if(b!==S&&p!==void 0){const A=b===m?S:b;let w=r.get(A);w||(w=[],r.set(A,w)),w.push(p)}i.push(v)}}const o=e.getEdges(i),a=e.getNodes(dM(r)),l=Ef(r),u=a.getData(),h=new Array(a.size);for(let f=0;f<h.length;++f){const m=l[f];let y=u[f];for(let p=0;p<m.length;++p)y=Na(y,m[p]);h[f]=y}const g=this.module.animations;return g.hideNodes(n._indexes),g.hideEdges(o._indexes),g.push((()=>Promise.all([n.addClass(ln,s),o.addClass(ln,s)]).then((()=>{this.ogma.modules.data.setProperty(a,null,h,{dispatch:!0,virtual:!0})})))),this.context={...this.context,hiddenNodes:n,hiddenEdges:o,nodesWithDataChange:a,oldDataList:u},Promise.resolve()}resetContext(){super.resetContext(),this.context={...this.context,hiddenNodes:this.ogma.nodeList(),hiddenEdges:this.ogma.edgeList(),nodesWithDataChange:this.ogma.nodeList(),oldDataList:[]}}undo(t=!0){const{hiddenNodes:e,hiddenEdges:s,nodesWithDataChange:n,oldDataList:i}=this.context,r=t?this.animation:0,o=this.module.animations;return this.context.hiddenEdges=this.ogma.edgeList(),this.context.hiddenNodes=this.ogma.nodeList(),this.context.nodesWithDataChange=this.ogma.nodeList(),this.context.oldDataList=[],e.setVisible(!0),s.setVisible(!0),o.pushBefore((()=>{e.addClass(ln),s.addClass(ln)})),o.push((()=>Promise.all([e.removeClass(ln,r),s.removeClass(ln,r)]).then((()=>{this.ogma.modules.data.setProperty(n,null,i,{dispatch:!0,virtual:!0})})))),Promise.resolve()}onRemove(t,e){e&&(this.context.hiddenNodes=this.context.hiddenNodes.filter((s=>!t.has(s._index)))),this.context.hiddenEdges=this.context.hiddenEdges.filter((s=>!t.has(s._index)))}cleanup(){return Promise.resolve()}setOptions(t){return this.selector=t.selector||this.selector,this.dataFunction=t.dataFunction||this.dataFunction,super.setOptions(t)}};function mq(t){return t!=null}var pq=(t,e)=>({source:t.getId(),target:e.getId()}),_q=class extends Qo{constructor(t){super(t);const{selector:e=Ky,neighborIdFunction:s=hq,nodeGenerator:n=(()=>({})),edgeGenerator:i=pq}=t;this.neighborIdFunction=s,this.selector=e,this.generateIds=r=>this.selector(r)&&this.neighborIdFunction(r)||null,this.nodeGenerator=n,this.edgeGenerator=i}getName(){return Xn.NeighborGeneration}run(t=!0){const{ogma:e,id:s}=this,n=t?this.animation:0,i=e.getNodes(),r=new Map;for(let f=0;f<i.size;++f){const m=i.get(f),y=(yq(this.generateIds(m))||[]).filter(mq);if(y)for(const p of y){let x=r.get(p);x||(x=[],r.set(p,x)),x.push(m)}}const o=new Array(r.size),a=[],l=dM(r),u=Ef(r).map((f=>e.getNodes(f)));for(let f=0;f<o.length;++f){const m=l[f],y=u[f],p=this.nodeGenerator(m,y);p.id=`_gen_${s}_${m}`;const x=X$(y.getPosition());p.attributes=p.attributes||{},p.attributes.x=x.x,p.attributes.y=x.y,o[f]=p}let h,g;return e.addNodes(o.map((f=>({id:f.id,attributes:f.attributes}))),{virtual:!0}).then((()=>{h=e.getNodes(o.map((m=>m.id)));const f=h._indexes;this.context.virtualNodes&&this.module.removeMetaNodes(this.context.virtualNodes);for(let m=0;m<h.size;m++)this.module.setTransformation(f[m],this,!0),this.module.setSubNodes(f[m],this.ogma.createNodeList());h.replaceOriginalAttributes(o.map((m=>m.attributes)),["x","y"]),this.ogma.modules.data.setProperty(h,null,o.map((m=>m.data)),{dispatch:!0,virtual:!0});for(let m=0;m<h.size;++m){const y=h.get(m),p=u[m];for(let x=0;x<p.size;++x){const v=p.get(x),b=this.edgeGenerator(v,y);!b.source&&!b.target&&(b.source=v.getId(),b.target=y.getId()),b.id||(b.id=`${b.source}-${b.target}`),a.push(b)}}return e.addEdges(a,{virtual:!0})})).then((()=>{g=e.getEdges(a.map((m=>m.id)));const f=g._indexes;this.context.virtualEdges&&this.module.removeMetaEdges(this.context.virtualEdges);for(let m=0;m<g.size;m++)this.module.setTransformation(f[m],this,!1),this.module.setSubEdges(f[m],this.ogma.createEdgeList());this.context={virtualEdges:g,virtualNodes:h},e.removeNodes(this.context.virtualNodes.subtract(h),{virtual:!0}),e.removeEdges(this.context.virtualEdges.subtract(g),{virtual:!0}),h.setVisible(!0),g.setVisible(!0),this.module.animations.pushBefore((()=>{h.addClass(ln),g.addClass(ln)})),this.module.animations.push((()=>Promise.all([h.removeClass(ln,n),g.removeClass(ln,n)])))}))}undo(t=!0){const{virtualNodes:e,virtualEdges:s}=this.context;if(!s||!e)return Promise.resolve(this.context);const n=t?this.animation:0,i=this.module.animations;t?(i.hideNodes(e._indexes),i.hideEdges(s._indexes),i.push((()=>Promise.all([e.addClass(ln,n),s.addClass(ln,n)])))):(e.setVisible(!1),s.setVisible(!1))}onRemove(){}cleanup(){const{virtualEdges:t,virtualNodes:e}=this.context;return t&&e&&(this.module.removeMetaNodes(e),this.module.removeMetaEdges(t),this.ogma.removeNodes(e,{virtual:!0}),this.ogma.removeEdges(t,{virtual:!0}),this.context.virtualEdges=this.ogma.edgeList(),this.context.virtualNodes=this.ogma.nodeList()),Promise.resolve()}setOptions(t){const{selector:e,neighborIdFunction:s,nodeGenerator:n,edgeGenerator:i}=t;return this.selector=e||this.selector,this.neighborIdFunction=s||this.neighborIdFunction,this.generateIds=r=>this.selector(r)&&this.neighborIdFunction(r)||null,this.nodeGenerator=n||this.nodeGenerator,this.edgeGenerator=i||this.edgeGenerator,super.setOptions(t)}resetContext(){super.resetContext(),this.context={...this.context,virtualNodes:this.ogma.nodeList(),virtualEdges:this.ogma.edgeList()}}};function yq(t){return Array.isArray(t)?t:t?[t]:null}function xq(t,e){return t.size===e.size&&t.filter((s=>e.includes(s))).size>0}var vq=class extends Qo{constructor(t){super(t),this.selector=t.selector||hM,this.edgeGenerator=t.edgeGenerator||(()=>({}))}getName(){return Xn.NodeCollapsing}resetContext(){this.context={hiddenNodes:this.ogma.nodeList(),hiddenEdges:this.ogma.edgeList(),virtualEdges:this.ogma.edgeList()}}run(t=!0){const{ogma:e}=this,s=t?this.animation:0,n=e.getNodes().filter(this.selector),i=n.getAdjacentEdges(),r=[],o=n.map((l=>l.getAdjacentNodes().filter((u=>!this.selector(u)))));for(let l=0;l<n.size;l++)for(let u=l;u<n.size;u++){const h=n.get(l),g=n.get(u);if(this.ogma.modules.graph.getEdgesBetweenTwoNodes(h,g).size>0&&(o[l].size||o[u].size)&&!xq(o[l],o[u]))throw Error(`addNodeCollapsing: invalid connected nodes [${h.getId()}] and [${g.getId()}] to be collapsed. The addNodeCollapsing function supports only disconnected nodes.`)}const a=new Map;for(let l=0;l<n.size;++l){const u=n.get(l),h=o[l];for(let g=0;g<h.size-1;++g){const f=h.get(g),m=this.ogma.modules.graph.getEdgesBetweenTwoNodes(u,f);if(f!==u)for(let y=g+1;y<h.size;++y){const p=h.get(y),x=this.ogma.modules.graph.getEdgesBetweenTwoNodes(u,p),v=this.edgeGenerator(u,f,p,m,x);if(v){const b=dq(v);for(let S=0;S<b.length;++S)r.push(bq(e,b[S],S,u,f,p,m,x)),a.set(r[r.length-1].id,m.concat(x))}}}}return e.addEdges(r,{virtual:!0}).then((()=>{const l=this.ogma.getEdges(r.map((g=>g.id)));this.context.virtualEdges&&this.module.removeMetaEdges(this.context.virtualEdges);const u=l._indexes;for(let g=0;g<l.size;g++){this.module.setTransformation(u[g],this,!1);const f=a.get(l.get(g).getId());this.module.setSubEdges(u[g],f);for(let m=0;m<f.size;m++)this.module.setMetaEdge(f._indexes[m],l.get(g))}e.removeEdges(this.context.virtualEdges.subtract(l),{virtual:!0});const h=this.module.animations;l.setVisible(!0),h.pushBefore((()=>l.addClass(ln))),h.push((()=>Promise.all([l.removeClass(ln,s),n.addClass(ln,s),i.addClass(ln,s)]))),h.hideNodes(n._indexes),h.hideEdges(i._indexes),this.context={hiddenEdges:i,hiddenNodes:n,virtualEdges:l}}))}undo(t=!0){const{hiddenNodes:e,hiddenEdges:s,virtualEdges:n}=this.context,i=t?this.animation:0,r=this.module.animations;return e.setVisible(!0),s.setVisible(!0),t?(r.hideEdges(n._indexes),r.pushBefore((()=>Promise.all([e.addClass(ln),s.addClass(ln)]))),r.push((()=>Promise.all([n.addClass(ln,i),e.removeClass(ln,i),s.removeClass(ln,i)])))):n.setVisible(!1),Promise.resolve()}cleanup(){const t=this.context.virtualEdges||this.ogma.createEdgeList();return this.module.removeMetaEdges(t),this.ogma.removeEdges(t,{virtual:!0}).then((()=>{this.resetContext()}))}onRemove(t,e){e&&(this.context.hiddenNodes=this.context.hiddenNodes.filter((s=>!t.has(s._index)))),this.context.hiddenEdges=this.context.hiddenEdges.filter((s=>!t.has(s._index)))}setOptions(t){return this.selector=t.selector||this.selector,this.edgeGenerator=t.edgeGenerator||this.edgeGenerator,super.setOptions(t)}};function bq(t,e,s,n,i,r,o,a){let l,u;if(e.source!==void 0&&(l=t.getNode(e.source),l!==i&&l!==r))throw new Error([`addNodeCollapsing: edge generator produced RawEdge with invalid source [${e.source}]`,`expected to be [${i.getId()}] or [${r.getId()}]`].join("; "));if(e.target!==void 0&&(u=t.getNode(e.target),u!==i&&u!==r))throw new Error([`addNodeCollapsing: edge generator produced RawEdge with invalid target [${e.target}]`,`expected to be [${i.getId()}] or [${r.getId()}]`].join("; "));if(l&&u&&l===u)throw new Error(`addNodeCollapsing: edge generator produced RawEdge with same source and target [${l.getId()}]`);if(l&&!u)u=l===i?r:i;else if(u&&!l)l=u===i?r:i;else if(!l&&!u){let h=!0;for(let g=0;g<o.size;++g)o.get(g).getSource()===i&&(h=!1);for(let g=0;g<a.size;++g)a.get(g).getTarget()===r&&(h=!1);h?(l=r,u=i):(l=i,u=r)}return l&&u?{...e,id:`_gen_${n.getId()}_${l.getId()}_${u.getId()}_${s}`,source:l.getId(),target:u.getId()}:{}}var Eq=class extends Qo{constructor(t){super(t),this.nodeSelector=t.nodeSelector||Ky,this.edgeSelector=t.edgeSelector||Ky,this.nodeDataFunction=t.nodeDataFunction||null,this.edgeDataFunction=t.edgeDataFunction||null}getName(){return Xn.VirtualProperties}resetContext(){this.context={nodes:this.ogma.nodeList(),oldNodesData:[],edges:this.ogma.edgeList(),oldEdgesData:[]}}run(){const{ogma:t,context:e}=this;return this.nodeDataFunction&&(e.nodes=t.getNodes().filter(this.nodeSelector),e.oldNodesData=RA(e.nodes,this.nodeDataFunction,this.ogma)),this.edgeDataFunction&&(e.edges=t.getEdges().filter(this.edgeSelector),e.oldEdgesData=RA(e.edges,this.edgeDataFunction,this.ogma)),Promise.resolve()}undo(){const{nodes:t,oldNodesData:e,edges:s,oldEdgesData:n}=this.context,i=this.ogma.modules.data;return t&&i.setProperty(t,null,e,{dispatch:!0,virtual:!0}),s&&i.setProperty(s,null,n,{dispatch:!0,virtual:!0}),Promise.resolve()}onRemove(t,e){e&&(this.context.nodes=this.context.nodes.filter((s=>!t.has(s._index)))),this.context.edges=this.context.edges.filter((s=>!t.has(s._index)))}cleanup(){return this.resetContext(),Promise.resolve()}setOptions(t){return this.nodeSelector=t.nodeSelector||this.nodeSelector,this.edgeSelector=t.edgeSelector||this.edgeSelector,this.nodeDataFunction=t.nodeDataFunction||this.nodeDataFunction,this.edgeDataFunction=t.edgeDataFunction||this.edgeDataFunction,super.setOptions(t)}};function RA(t,e,s){const n=[],i=[];for(let r=0;r<t.size;++r){const o=t.get(r),a=o.getData(),l=e(o);i.push(Na(a,l)),n.push(a)}return s.modules.data.setProperty(t,null,i,{dispatch:!0,virtual:!0}),n}var cu=()=>"";function nh(){return{}}var cM=class extends Qo{constructor(t){super(t),this.nodeSelector=t.nodeSelector||hu,this.nodeGroupIdFunction=t.nodeGroupIdFunction||cu,this.nodeGenerator=t.nodeGenerator||nh,this.edgeSelector=t.edgeSelector||hu,this.edgeGroupIdFunction=t.edgeGroupIdFunction||cu,this.edgeGenerator=t.edgeGenerator||nh,this.separateEdgesByDirection=t.separateEdgesByDirection!==void 0&&t.separateEdgesByDirection,this.groupSelfLoopEdges=!!t.groupSelfLoopEdges,this.groupEdges=t.groupEdges===void 0||t.groupEdges,this.ogma.events.on("updateNodeData",(({changes:e})=>this.checkChanges(e,!0))).on("updateEdgeData",(({changes:e})=>this.checkChanges(e,!1)))}computeNodeGroupId(t){if(this.nodeGroupIdFunction){if(!this.nodeSelector(t)||this.module.groupController.alreadyGrouped.has(t._index)||this.module.animations.hiddenNodes.has(t._index))return;const e=this.nodeGroupIdFunction(t);return e===void 0?void 0:e}}computeEdgeGroupId(t){if(this.edgeGroupIdFunction)return this.edgeSelector(t)&&!this.module.animations.hiddenEdges.has(t._index)?this.edgeGroupIdFunction(t):void 0}addMetaNodes(){const t=this.id,e=this.ogma,s=e.getNodes(),n=new Map;for(let h=0;h<s.size;++h){const g=s.get(h),f=this.computeNodeGroupId(g);if(f===void 0)continue;let m=n.get(f);m||(m={id:f,nodes:[]},n.set(f,m)),m.nodes.push(g)}const i=Array.from(n.values()),r=i.map((({nodes:h})=>e.getNodes(h))),o=[],a=[],l=new Set,{nodeDataUpdates:u}=this.context;for(let h=0;h<i.length;++h){const g=i[h].id,f=r[h],m=this.nodeGenerator(f,g,this);if(m){if(m.id===void 0&&(m.id=bf(g,t)),l.has(m.id))throw new Error(`Ogma transformations: NodeGrouping ${this.id} is trying to create two different metaNodes with the same id.`);l.add(m.id),a.push(m.id),o.push(m)}else i.splice(h,1),r.splice(h,1),h--}return e.addNodes(o.map((({id:h})=>({id:h}))),{virtual:!0}).then((h=>{const g=e.getNodes(a);e.modules.individualAttributes.replaceOriginalAttributes(g,o.map((({attributes:m})=>m)));const f=g.getData();for(let m=0;m<f.length;m++){const y=f[m],p=o[m];f[m]=Na(Na(y,p.data),u.get(a[m]))}return e.modules.data.setProperty(g,null,f,{dispatch:!0,virtual:!0}),g.setVisible(!0),this.context.metaNodes&&this.module.removeMetaNodes(this.context.metaNodes),this.assignMetaSubNodes(g,r),{metaNodes:g,newNodes:h}}))}assignMetaSubNodes(t,e){const s=t._indexes;for(let n=0;n<s.length;n++){const i=e[n]._indexes,r=s[n],o=t.get(n);for(let a=0;a<i.length;a++)this.module.setMetaNode(i[a],o),this.module.groupController.alreadyGrouped.add(i[a]);this.module.setSubNodes(r,e[n]),this.module.setTransformation(r,this,!0)}}addMetaEdges(t){const e=this.id,s=this.ogma;let n,i=!1;const r=new Set;t?(n=this.module.getSubNodes(t).getAdjacentElements({bothExtremities:!1}).edges,i=!0):n=s.getEdges();const o=new Map,a=this.ogma.modules.graphics.getAttributesManager().getUsedEdgeAttributes().filter((p=>p!=="curvature")),l=new Map;for(let p=0;p<n.size;++p){const x=n.get(p),v=this.computeEdgeGroupId(x);if(v==null)continue;let b=x.getSource(),S=x.getTarget();if(i){let L=this.module.nodeToMeta.get(b._index);L&&L.getTransformation().getId()!==this.getId()&&(L=b);let k=this.module.nodeToMeta.get(S._index);if(k&&k.getTransformation().getId()!==this.getId()&&(k=S),b=L||b,S=k||S,b&&b===S&&(l.has(b._index)?l.get(b._index).push(x._index):l.set(b._index,[x._index]),!this.groupSelfLoopEdges))continue}const A=this.groupEdges?Q$(v,b.getId(),S.getId(),this.separateEdgesByDirection):`${x.getId()}:${b.getId()}->${S.getId()}`;let w=o.get(A);w||(w={id:A,source:b,target:S,edges:[]},o.set(A,w)),w.edges.push(x)}const u=Array.from(o.values()),h=u.map((({edges:p})=>s.getEdges(p))),g=[],{edgeDataUpdates:f}=this.context,m=[],y=[];r.clear();for(let p=0;p<u.length;++p){const x=u[p],v=x.id,b=h[p],S=this.groupEdges?this.edgeGenerator(b,v,x.source,x.target,this):Z$(b,a);if(S){if(S.id===null)throw Error(`The id ${S.id} returned by the edgeGenerator function is not unique.`);if(S.id===void 0&&(S.id=bf(v,e)),r.has(S.id))throw new Error(`Ogma transformations: NodeGrouping ${this.id} is trying to create two different metaEdges with the same id.`);r.add(S.id),m.push(S.id),x.source===x.target&&y.push(S.id),S.source=x.source.getId(),S.target=x.target.getId(),g.push(S)}}return s.addEdges(K$(g),{virtual:!0}).then((()=>{const p=s.getEdges(m),x=s.getEdges(y);x.setVisible(!1),p.setVisible(!1),s.modules.individualAttributes.replaceOriginalAttributes(p,g.map((b=>b.attributes)));const v=p.getData();for(let b=0;b<v.length;b++){const S=g[b],A=v[b];v[b]=Na(Na(A,S.data),f.get(m[b]))}return s.modules.data.setProperty(p,null,v,{dispatch:!0,virtual:!0}),this.context.metaEdges&&this.module.removeMetaEdges(this.context.metaEdges),this.assignMetaSubEdges(p,h),{intraEdges:l,metaEdges:p,selfLoopEdges:x,subEdges:h}}))}assignMetaSubEdges(t,e){const s=t._indexes;for(let n=0;n<s.length;n++){const i=e[n]._indexes,r=s[n],o=t.get(n);for(let a=0;a<i.length;a++)this.module.setMetaEdge(i[a],o);this.module.setSubEdges(r,e[n]),this.module.setTransformation(r,this,!1)}}removeMetaEdges(t){t.forEach((e=>{const s=this.module.getSubEdges(e);if(!s)return;const n=s._indexes;for(let r=0;r<n.length;r++)this.module.clearMetaEdge(n[r]);this.module.clearSubEdges(e._index);const i=this.module.getMetaEdge(e);if(i){for(let r=0;r<n.length;r++)this.module.setMetaEdge(n[r],i);this.module.setSubEdges(i._index,this.module.getSubEdges(i).filter((r=>r!==e)).concat(s))}s.filter((r=>r.getTarget().isVisible()&&r.getSource().isVisible())).setVisible(!0)})),t.setVisible(!1)}removeMetaNodes(t){t.forEach((e=>{const s=this.module.getSubNodes(e);if(!s)return;const n=s._indexes;for(const i of n)this.module.clearMetaNode(i);this.module.clearSubNodes(e._index),s.setVisible(!0)})),t.setVisible(!1)}onRemove(t,e){}checkChanges(t,e){const s=e?this.context.nodeDataUpdates:this.context.edgeDataUpdates,n=this.module;for(let i=0;i<t.length;i++){const{property:r,newValues:o,virtual:a,nodes:l,edges:u}=t[i];if(a)continue;const h=e?l.filter((g=>n.getTransformation(g._index,e)===this)):u.filter((g=>n.getTransformation(g._index,e)===this));if(h.size)for(let g=0;g<h._indexes.length;g++){const f=h.get(g).getId();let m=s.get(f)||{};const y=o[g];r?La(m,r,y):m=y,s.set(f,m)}}}setOptions(t){return this.nodeSelector=t.nodeSelector||this.nodeSelector,this.nodeGroupIdFunction=t.nodeGroupIdFunction||this.nodeGroupIdFunction,this.nodeGenerator=t.nodeGenerator||this.nodeGenerator,this.edgeSelector=t.edgeSelector||this.edgeSelector,this.edgeGroupIdFunction=t.edgeGroupIdFunction||this.edgeGroupIdFunction,this.edgeGenerator=t.edgeGenerator||this.edgeGenerator,this.separateEdgesByDirection=t.separateEdgesByDirection!==void 0?!!t.separateEdgesByDirection:this.separateEdgesByDirection,this.groupSelfLoopEdges=t.groupSelfLoopEdges!==void 0?!!t.groupSelfLoopEdges:this.groupSelfLoopEdges,this.groupEdges=t.groupEdges!==void 0?!!t.groupEdges:this.groupEdges,super.setOptions(t)}resetContext(){super.resetContext(),this.context={...this.context,nodeDataUpdates:new Map,edgeDataUpdates:new Map}}},gM=class extends cM{constructor({duration:e,easing:s,id:n,ogma:i,module:r,enabled:o,padding:a=2,onBeforeAddMetaEdges:l,selector:u=hu,groupIdFunction:h=cu,edgeGroupIdFunction:g=cu,nodeGenerator:f=nh,edgeGenerator:m=nh,onGroupUpdate:y=(()=>{}),separateEdgesByDirection:p=!1,groupSelfLoopEdges:x=!1,groupEdges:v=!0,restorePositions:b=!0,showContents:S=!1}){super({id:n,ogma:i,module:r,nodeSelector:u,nodeGroupIdFunction:h,edgeGroupIdFunction:g,nodeGenerator:f,edgeSelector:A=>!(!this.module.getMetaNode(A.getSource())&&!this.module.getMetaNode(A.getTarget())),edgeGenerator:m,separateEdgesByDirection:p,groupEdges:v,groupSelfLoopEdges:x,duration:e,easing:s,enabled:o}),this.onBeforeAddMetaEdges=l||(()=>Promise.resolve()),this.onGroupUpdate=y,this._padding=a,this._showContents=typeof S!="function"?()=>S:S,this._restorePositions=b,this.module.groupController.setNodeGroupingCount(this.module.groupController.getNodeGroupingCount()+1)}getName(){return Xn.NodeGrouping}get padding(){return this._padding}set padding(e){this._padding=e,this.refresh()}resetContext(){super.resetContext(),this.context={...this.context,metaNodes:this.ogma.nodeList(),metaEdges:this.ogma.edgeList(),subNodes:this.ogma.nodeList(),intraEdges:this.ogma.edgeList(),subNodesPerMetaNode:new Map,subEdges:this.ogma.edgeList()}}run(){let e,s;const n=this.ogma,i=this.module.animations,r=this.module.groupController,o=r.layoutController;let a=n.createNodeList(),l=n.createEdgeList();const u=[];let h=n.createEdgeList();const g=new Map,f=-(this.getIndex()+uM),m=new Set,y=[],p=[],x=[];let v;const b=n.geo.enabled();return this.addMetaNodes().then((({metaNodes:S,newNodes:A})=>{v=r.setPadding(S,this._padding),e=S;for(let w=0;w<A.size;w++)m.add(A._indexes[w]);for(let w=0;w<e.size;w++)r.setNodeLayer(e._indexes[w],f);return this.onBeforeAddMetaEdges(e,A).then((()=>this.addMetaEdges(e)))})).then((({intraEdges:S,metaEdges:A,selfLoopEdges:w})=>{s=A,l=this.module.getSubEdges(s),s.filter((F=>F.getExtremities().map((O=>O.isVisible())).every((O=>O)))).setVisible(!0);for(let F=0;F<s.size;F++)r.edgeLayer.set(s._indexes[F],f);l.setVisible(!1);const L=this.context.metaNodes.subtract(e),k=this.context.metaEdges.subtract(s);return this.module.removeMetaNodes(L),this.module.removeMetaEdges(k),r.cleanup(L,k),n.removeNodes(L,{virtual:!0}).then((()=>n.removeEdges(k,{virtual:!0}))).then((()=>({intraEdges:S,metaEdges:A,selfLoopEdges:w})))})).then((({intraEdges:S,selfLoopEdges:A})=>{const w=e._indexes,L=[],k=e.getPosition();for(let F=0;F<w.length;F++){const O=e.get(F),j=r.isClose(O),V=!j&&!r.isOpen(O),Z=r.collapsedGroups.has(O._index),at=this._showContents(O),mt=this.module.getSubNodes(O),K=k[F],ut=mt._indexes,ht=new Set;if(V){const{x:Et,y:qt}=r.getGroupXYR(O,this.module.getSubNodes(O),void 0,void 0);b?r.setGeoLatLng(O,qt,Et):(p.push({x:Et,y:qt}),x.push(O._index),K.x=Et,K.y=qt)}g.set(w[F],ht);const nt=S.has(O._index)&&n.edgeList(S.get(O._index));nt&&(h=h.concat(nt),nt.setVisible(at&&!Z)),A.setVisible(!0),a=a.concat(mt);for(let Et=0;Et<ut.length;Et++)ht.add(ut[Et]);const ot=this.context.subNodesPerMetaNode.get(w[F]),Mt=v.has(O._index);let Q=!ot||o.shouldRelayout.has(O._index);if(!Q&&ot)for(const Et of ot.keys())Q||(Q=!ht.has(Et));if(!Q&&ot)for(let Et=0;Et<ut.length;Et++)Q||(Q=!ot.has(ut[Et]));if(Q&&(o.shouldRelayout.add(O._index),L.push(r.layoutController.getLayoutFunction(this.onGroupUpdate,O,mt,at))),at){if(j?r.expandGroup(O,mt):r.addOpenGroup(O),Q||Mt||j){y.push(O);const Et=this.module.getMetaNode(O);Et&&o.shouldRelayout.add(Et._index)}}else r.closeGroup(O,mt,K.x,K.y)}return x.length&&i.pushBefore((()=>{n.nodeList(x).setAttributes(p)})),r.layoutController.handleLayoutFunctions(L).then((()=>{y.forEach((F=>r.setGroupXYR(F))),b&&this.ogma.modules.geo._updateNodesCoordinates(e)}))})).then((()=>(this.context={metaNodes:e,metaEdges:s,subNodesPerMetaNode:g,subNodes:a,intraEdges:h,nodeDataUpdates:this.context.nodeDataUpdates,edgeDataUpdates:this.context.edgeDataUpdates,subEdges:l},u)))}undo(e=!0){super.undo(e);const{metaNodes:s,metaEdges:n,intraEdges:i,subNodes:r,subEdges:o}=this.context,a=this.module.animations,l=this.module.groupController;if(i.setVisible(!0),o.setVisible(!0),n.setVisible(!1),r.setVisible(!0),s.setVisible(!1),e){a.pushBefore((()=>{s.setVisible(!0),n.setVisible(!0)})),a.pushAfter((()=>{s.setVisible(!1),n.setVisible(!1)}));for(let u=0;u<n.size;u++)this.module.isVirtual(n._indexes[u],!1)||l.edgeLayer.delete(n._indexes[u]);for(let u=0;u<o.size;u++)this.module.isVirtual(o._indexes[u],!1)||l.edgeLayer.delete(o._indexes[u]);for(let u=0;u<i.size;u++)this.module.isVirtual(i._indexes[u],!1)||l.edgeLayer.delete(i._indexes[u]);for(let u=0;u<r.size;u++)this.module.isVirtual(r._indexes[u],!0)||l.nodeLayer.delete(r._indexes[u]);this.context.subNodesPerMetaNode.clear(),s.forEach((u=>{const h=this.module.getSubNodes(u);if(l.nodeLayer.delete(u._index),l.isClose(u))l.expandGroup(u,h,!0);else{const g=u.getPosition();l.closeGroup(u,h,g.x,g.y,!0)}}))}}onRemove(e,s){if(s){const n=this.context.metaNodes.size;this.context.metaNodes=this.context.metaNodes.filter((r=>!e.has(r._index)));const i=this.context.subNodes.size;this.context.subNodes=this.context.subNodes.filter((r=>!e.has(r._index))),(this.context.subNodes.size!==n||this.context.metaNodes.size!==i)&&this.context.subNodesPerMetaNode.clear()}else this.context.subEdges=this.context.subEdges.filter((n=>!e.has(n._index))),this.context.metaEdges=this.context.metaEdges.filter((n=>!e.has(n._index)))}cleanup(){const{ogma:e}=this,s=this.context,{metaNodes:n,metaEdges:i,subNodes:r}=s;return this.module.removeMetaNodes(n),this.module.removeMetaEdges(i),this.module.groupController.cleanup(n,i,r),this.module.groupController.setNodeGroupingCount(this.module.groupController.getNodeGroupingCount()-1),super.cleanup(),Promise.all([e.removeEdges(i,{virtual:!0}),e.removeNodes(n,{virtual:!0})]).then((()=>Promise.resolve()))}setOptions({duration:e,easing:s,enabled:n,padding:i,selector:r,groupIdFunction:o,nodeGenerator:a,edgeGroupIdFunction:l,edgeGenerator:u,separateEdgesByDirection:h,groupSelfLoopEdges:g,groupEdges:f,restorePositions:m,showContents:y}){return this._padding=i!==void 0?i:this.padding,this._showContents=y!==void 0?typeof y!="function"?()=>y:y:this._showContents,this._restorePositions=m===void 0?this._restorePositions:m,super.setOptions({nodeSelector:r,nodeGroupIdFunction:o,nodeGenerator:a,edgeSelector:p=>!(!this.module.getMetaNode(p.getSource())&&!this.module.getMetaNode(p.getTarget())),edgeGroupIdFunction:l,edgeGenerator:u,separateEdgesByDirection:h,groupEdges:f,groupSelfLoopEdges:g,duration:e,easing:s,enabled:n})}},Sq=class extends cM{constructor({duration:t,easing:e,id:s,ogma:n,module:i,enabled:r,selector:o=hu,groupIdFunction:a=cu,generator:l=nh,separateEdgesByDirection:u=!1}){super({id:s,ogma:n,module:i,nodeSelector:null,nodeGroupIdFunction:null,nodeGenerator:null,edgeSelector:o,edgeGroupIdFunction:a,edgeGenerator:l,separateEdgesByDirection:u,groupEdges:!0,groupSelfLoopEdges:!0,duration:t,easing:e,enabled:r})}resetContext(){super.resetContext(),this.context={...this.context,metaEdges:this.ogma.edgeList(),subEdges:this.ogma.edgeList()}}getName(){return Xn.EdgeGrouping}run(){let t,e;const s=this.module.animations,n=new Set(this.context.metaEdges.getId());return this.addMetaEdges().then((({metaEdges:i})=>{t=i,e=this.module.getSubEdges(t),t.setVisible(!0),e.setVisible(!1),s.hideEdges(e._indexes);const r=t.concat(this.context.metaEdges).getParallelEdges().dedupe().filter((u=>!n.has(u.getId()))),o=new Array(r.size),a=new Map;for(let u=0;u<r.size;u++)o[u]=this.ogma.modules.curvatureManager.computeCurvature(r.get(u),"visible"),a.set(r._indexes[u],o[u]);const l=this.module.getSubEdges(r);l.setVisible(!0),this.module.animations.setCurvatures(r._indexes,o);for(let u=0;u<l._indexes.length;u++)this.module.animations.setCurvature(e._indexes[u],a.get(this.module.getMetaEdge(e.get(u))._index)||0)})).then((()=>{this.context.metaEdges=t,this.context.subEdges=e}))}undo(t=!0){super.undo(t);const{metaEdges:e,subEdges:s}=this.context;if(s.setVisible(!0),e.setVisible(!1),!t)return Promise.resolve();const n=s.getParallelEdges().dedupe(),i=new Array(n.size),r=new Map;for(let o=0;o<n.size;o++)i[o]=this.ogma.modules.curvatureManager.computeCurvature(n.get(o),"visible"),r.set(n._indexes[o],i[o]);return this.module.animations.setCurvatures(n._indexes,i),Promise.resolve()}onRemove(t,e){e||(this.context.subEdges=this.context.subEdges.filter((s=>!t.has(s._index))))}_getCurvatures(t){return t.map((e=>this.ogma.modules.curvatureManager.computeCurvature(e,"visible",(()=>!0))))}cleanup(){const{metaEdges:t}=this.context;return this.module.removeMetaEdges(t),this.ogma.removeEdges(t,{virtual:!0}).then((()=>(this.context.metaEdges=this.ogma.edgeList(),this.context.subEdges=this.ogma.edgeList(),Promise.resolve())))}setOptions({duration:t,easing:e,enabled:s,selector:n,groupIdFunction:i,generator:r,separateEdgesByDirection:o}){return super.setOptions({nodeSelector:void 0,nodeGroupIdFunction:void 0,nodeGenerator:void 0,edgeSelector:n,edgeGroupIdFunction:i,edgeGenerator:r,separateEdgesByDirection:o,groupEdges:!0,duration:t,easing:e,enabled:s})}},FA=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],p_=1,rd=8,Aq=class fM{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,n]=new Uint8Array(e,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const i=n>>4;if(i!==p_)throw new Error(`Got v${i} data when expected v${p_}.`);const r=FA[15&n];if(!r)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(e,2,1),[a]=new Uint32Array(e,4,1);return new fM(a,o,r,e)}constructor(e,s=64,n=Float64Array,i){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const r=FA.indexOf(this.ArrayType),o=2*e*this.ArrayType.BYTES_PER_ELEMENT,a=e*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-a%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${n}.`);i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,rd,e),this.coords=new this.ArrayType(this.data,rd+a+l,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(rd+o+a+l),this.ids=new this.IndexArrayType(this.data,rd,e),this.coords=new this.ArrayType(this.data,rd+a+l,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(p_<<4)+r]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=e)}add(e,s){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=s,n}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Qy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,s,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:o,nodeSize:a}=this,l=[0,r.length-1,0],u=[];for(;l.length;){const h=l.pop()||0,g=l.pop()||0,f=l.pop()||0;if(g-f<=a){for(let x=f;x<=g;x++){const v=o[2*x],b=o[2*x+1];v>=e&&v<=n&&b>=s&&b<=i&&u.push(r[x])}continue}const m=f+g>>1,y=o[2*m],p=o[2*m+1];y>=e&&y<=n&&p>=s&&p<=i&&u.push(r[m]),(h===0?e<=y:s<=p)&&(l.push(f),l.push(m-1),l.push(1-h)),(h===0?n>=y:i>=p)&&(l.push(m+1),l.push(g),l.push(1-h))}return u}within(e,s,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:r,nodeSize:o}=this,a=[0,i.length-1,0],l=[],u=n*n;for(;a.length;){const h=a.pop()||0,g=a.pop()||0,f=a.pop()||0;if(g-f<=o){for(let x=f;x<=g;x++)PA(r[2*x],r[2*x+1],e,s)<=u&&l.push(i[x]);continue}const m=f+g>>1,y=r[2*m],p=r[2*m+1];PA(y,p,e,s)<=u&&l.push(i[m]),(h===0?e-n<=y:s-n<=p)&&(a.push(f),a.push(m-1),a.push(1-h)),(h===0?e+n>=y:s+n>=p)&&(a.push(m+1),a.push(g),a.push(1-h))}return l}};function Qy(t,e,s,n,i,r){if(i-n<=s)return;const o=n+i>>1;mM(t,e,o,n,i,r),Qy(t,e,s,n,o-1,1-r),Qy(t,e,s,o+1,i,1-r)}function mM(t,e,s,n,i,r){for(;i>n;){if(i-n>600){const u=i-n+1,h=s-n+1,g=Math.log(u),f=.5*Math.exp(2*g/3),m=.5*Math.sqrt(g*f*(u-f)/u)*(h-u/2<0?-1:1);mM(t,e,s,Math.max(n,Math.floor(s-h*f/u+m)),Math.min(i,Math.floor(s+(u-h)*f/u+m)),r)}const o=e[2*s+r];let a=n,l=i;for(od(t,e,n,s),e[2*i+r]>o&&od(t,e,n,i);a<l;){for(od(t,e,a,l),a++,l--;e[2*a+r]<o;)a++;for(;e[2*l+r]>o;)l--}e[2*n+r]===o?od(t,e,n,l):(l++,od(t,e,l,i)),l<=s&&(n=l+1),s<=l&&(i=l-1)}}function od(t,e,s,n){__(t,s,n),__(e,2*s,2*n),__(e,2*s+1,2*n+1)}function __(t,e,s){const n=t[e];t[e]=t[s],t[s]=n}function PA(t,e,s,n){const i=t-s,r=e-n;return i*i+r*r}var wq=t=>t/360+.5,Tq=t=>{const e=Math.sin(t*Math.PI/180),s=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return s<0?0:s>1?1:s},Cq=t=>{const e=Math.PI-2*Math.PI*t;return 360/Math.PI*Math.atan(Math.exp(e))-90},Lq=t=>360*(t-.5);function Nq(t,e,s,n,i,r){let o=t._indexes.length;const a=t.getData(r.modules.geo.latitudePath),l=t.getData(r.modules.geo.longitudePath),u=new Float32Array(o),h=new Float32Array(o),g=new Uint32Array(o),f=new Uint32Array(o),m=new Map,y=new Map;let p,x=-1,v=!0;for(let L=0;L<a.length;L++){const k=a[L],F=l[L];y.set(t._indexes[L],e[L]);const O=Tq(k),j=wq(F);u[L]=O,h[L]=j,g[L]=t._indexes[L],x=Math.max(x,t._indexes[L])}let b=x+1;const[S,A]=s,w=[];for(let L=0,k=A;L<20;L++,k=A-(A-S)*L/19){if(v){p=new Aq(o,64,Float32Array);for(let K=0;K<o;K++)p.add(h[K],u[K]);p.finish()}v=!1;const F=n/(i*Math.pow(2,k)),O=[],j=new Set,V=new Set;for(let K=0;K<o;K++){if(j.has(g[K]))continue;const ut=p.within(h[K],u[K],F);if(ut.length===0&&ut.push(K),ut.length===1){const me=g[ut[0]];if(j.add(me),m.has(me)){V.add(me);const se=m.get(me);O.push(se),m.set(se.id,se),y.set(se.id,se.groupId)}continue}const ht=b++,nt=[];let ot=0;const Mt=y.get(g[K]);let Q=0,Et=0;for(let me=0;me<ut.length;me++){const se=ut[me];if(!j.has(g[se])&&Mt===y.get(g[se])){if(j.add(g[se]),V.add(g[se]),m.has(g[se])){const Jt=m.get(g[se]),ee=Jt.subNodes.size;ot+=ee,Q+=Jt.mercatorLat*ee,Et+=Jt.mercatorLng*ee}else ot+=1,Q+=u[se],Et+=h[se];nt.push(g[se])}}if(Q/=ot,Et/=ot,ot<2){V.delete(g[K]);continue}const qt=new Uint32Array(ot);let Vt=0;for(let me=0;me<nt.length;me++){const se=nt[me];if(m.has(se)){const Jt=m.get(se);for(let ee=0;ee<Jt.subNodes.size;ee++)qt[Vt++]=Jt.subNodes._indexes[ee]}else qt[Vt++]=se}const Wt=r.nodeList(qt);y.set(ht,Mt);const oe={id:ht,groupId:Mt,zoom:k,lat:Cq(Q),lng:Lq(Et),mercatorLat:Q,mercatorLng:Et,subNodes:Wt};m.set(oe.id,oe),O.push(oe),v=!0}let Z=0,at=0;for(let K=0;K<o;K++)V.has(g[K])||(g[Z]=g[K],u[Z]=u[K],h[Z]=h[K],f[at]=g[K],Z++,at++);const mt=new Uint32Array(at);for(let K=0;K<at;K++)mt[K]=f[K];for(const K of O)g[Z]=K.id,u[Z]=K.mercatorLat,h[Z]=K.mercatorLng,Z++;o=at+O.length,(!(L>0)||O.length)&&w.push({zoom:k,clusters:O,unclusteredNodeIndexes:mt})}return w}var Mq=256,Iq=class extends gM{constructor(t){super({...t,enabled:t.enabled&&t.ogma.geo.enabled(),showContents:!1,selector:e=>{const s=this.getPosition(e);return s&&!isNaN(s.x)&&!isNaN(s.y)&&(!t.selector||t.selector(e))},groupIdFunction:t.groupIdFunction,edgeGroupIdFunction:t.edgeGroupIdFunction,nodeGenerator:t.nodeGenerator}),this._clustersByZoom=[],this._nullZoomLevel={zoom:-1/0,nodes:this.ogma.nodeList(),edges:this.ogma.edgeList(),metaNodes:this.ogma.nodeList(),subNodes:[],subEdges:[],metaEdges:this.ogma.edgeList()},this._currentClusters=this._nullZoomLevel,this._zoomLevels=t.zoomLevels?t.zoomLevels:[0,22],this._groupingRadius=t.radius===void 0?60:t.radius,this._generateIdFunction=t.groupIdFunction||(()=>""),this._shouldEnable=t.enabled,this._shouldRefreshClusters=!0,this._selectedNodes=this.ogma.nodeList(),this._selectedEdges=this.ogma.edgeList(),this.ogma.events.on("beforeGeoCameraMove",(({zoom:e})=>{!this.isEnabled()||!this.ogma.geo.enabled()||Math.abs(this.getBestZoomLevel(e).zoom-this._currentClusters.zoom)<.01||(this._shouldRefreshClusters=!1,this.refresh())})).on("geoDisabled",(()=>{this.isEnabled()&&this.disable(0).then((()=>{this._shouldEnable=!0}))})).on("geoEnabled",(()=>{this._shouldEnable&&this.enable(0)}))}getPosition(t){return{x:t.getData(this.ogma.modules.geo.latitudePath),y:t.getData(this.ogma.modules.geo.longitudePath)}}getName(){return Xn.GeoClustering}enable(t){return this.ogma&&!this.ogma.geo.enabled()?(this._shouldEnable=!0,Promise.resolve()):super.enable(t)}undo(t=!0){const{metaNodes:e,metaEdges:s}=this._currentClusters;return e.setVisible(!1),s.setVisible(!1),this._selectedNodes.setVisible(!0),this._selectedEdges.setVisible(!0),Promise.resolve()}disable(t){return this._shouldEnable=!1,super.disable(t)}async onePassCluster(){for(let i=0;i<this._clustersByZoom.length;i++){const r=this._clustersByZoom[i];this.module.removeMetaNodes(r.metaNodes),this.module.removeMetaEdges(r.metaEdges),await this.ogma.removeNodes(r.metaNodes,{virtual:!0}),await this.ogma.removeEdges(r.metaEdges,{virtual:!0})}const t=this.ogma.getNodes().filter((i=>this.nodeSelector(i)));this._selectedEdges=t.getAdjacentEdges({bothExtremities:!0});const e=[],s=t.map((i=>this._generateIdFunction(i))),n=Nq(t,s,this._zoomLevels,this._groupingRadius,Mq,this.ogma);for(let i=0;i<n.length;i++){const{clusters:r,zoom:o,unclusteredNodeIndexes:a}=n[i],l=r.map((({id:p,groupId:x,lat:v,lng:b,subNodes:S})=>{const A=this.nodeGenerator(S,x,this);return A.data||(A.data={}),La(A.data,this.ogma.modules.geo.latitudePath,v),La(A.data,this.ogma.modules.geo.longitudePath,b),A.id=`geo-cluster-${p}-${x}`,A}));await this.ogma.addNodes(l,{virtual:!0});const u=this.ogma.getNodes(r.map((p=>`geo-cluster-${p.id}-${p.groupId}`))),h=r.map((p=>p.subNodes));this.assignMetaSubNodes(u,h);const{metaEdges:g,subEdges:f}=await this.addMetaEdges(u),m=this.ogma.nodeList(a),y=m.getAdjacentEdges({bothExtremities:!0});this.module.removeMetaNodes(u),this.module.removeMetaEdges(g),u.setVisible(!1),g.setVisible(!1),e.push({nodes:m,edges:y,zoom:o,metaNodes:u,subNodes:h,subEdges:f,metaEdges:g})}this._clustersByZoom=e,this._selectedNodes=t}getBestZoomLevel(t){return this._clustersByZoom.reduce(((e,s)=>t<s.zoom?s:e),this._nullZoomLevel)}async run(){var t;this._shouldRefreshClusters&&await this.onePassCluster(),this._shouldRefreshClusters=!0;const e=this._currentClusters,s=((t=this.ogma.geo.getMap())==null?void 0:t.getZoom())||0,n=this.getBestZoomLevel(s);return this._currentClusters=n,e&&(this.module.removeMetaNodes(e.metaNodes),this.module.removeMetaEdges(e.metaEdges)),this._selectedEdges.setVisible(!1),this._selectedNodes.setVisible(!1),n.nodes.setVisible(!0),n.edges.setVisible(!0),n.metaNodes.setVisible(!0),n.metaEdges.setVisible(!0),this.assignMetaSubNodes(n.metaNodes,n.subNodes),this.assignMetaSubEdges(n.metaEdges,n.subEdges),this.ogma.modules.geo._updateNodesCoordinates(n.metaNodes),this.ogma.modules.geo.updateProjection(),[]}setOptions(t){const e=super.setOptions({...t,selector:s=>{const n=this.getPosition(s);return n&&!isNaN(n.x)&&!isNaN(n.y)&&(!t.selector||t.selector(s))},groupIdFunction:t.groupIdFunction,nodeGenerator:t.nodeGenerator,edgeGroupIdFunction:t.edgeGroupIdFunction});return this._groupingRadius=t.radius===void 0?this._groupingRadius:t.radius,this._generateIdFunction=t.groupIdFunction||this._generateIdFunction,this._shouldRefreshClusters=!0,this._shouldEnable=t.enabled,this._zoomLevels=t.zoomLevels!==void 0?t.zoomLevels:this._zoomLevels,e}},zA=()=>({}),kq=class extends Qo{constructor(t){super(t),this._groupSelfLoopEdges=!1,this._isCleaningUp=!1,this._isRunning=!1,this.shouldDo=!0,this.enabled=!1,this._onBeforeAdd=e=>{if(this._isCleaningUp||!this.enabled||e.virtual)return;const{isNode:s,objects:n}=e;if(s){const i=n;DA(i,this._groupNodes(i))}else{const i=n;DA(i,this._groupEdges(i))}this._shouldSetVirtual=!0},this._onAfterAdd=e=>{this._shouldSetVirtual&&(this._shouldSetVirtual=!1,this._setVirtual(e.nodes||e.edges,!!e.nodes))},this._onRequestElementsToDelete=e=>{if(e.virtual)return;const{ogma:s,context:n}=this,i=e.elementsToRemove.isNode,r=i?s.getNodes:s.getEdges,o=i?n.metaNodesSet:n.metaEdgesSet,a=i?n.nodeGroups:n.edgeGroups,l=i?s.removeNodes:s.removeEdges,u=e.elementsToRemove.size,h=r(Array.from(o)),g=e.elementsToRemove.slice();if(e.elementsToRemove=e.elementsToRemove.subtract(h),e.elementsToRemove.size===u)return;const f=g.subtract(e.elementsToRemove);if(f.forEach((m=>{a.delete(m.getId())})),i){const m=f.getAdjacentEdges().filter((y=>y.isVirtual()));s.removeEdges(m)}l(f,{virtual:!0})},this._nodeToGroupId=t.groupIdFunction||cu,this._groupSelfLoopEdges=!!t.groupSelfLoopEdges,this._nodeGenerator=t.nodeGenerator||zA,this._edgeGenerator=t.edgeGenerator||zA,this._shouldSetVirtual=!1,this._selector=t.selector,this.shouldDo=t.enabled===void 0||!!t.enabled,this.ogma.events.on("preAddElements",this._onBeforeAdd).on("requestElementsToDelete",this._onRequestElementsToDelete).on(["postAddGraph","addNodes","addEdges"],this._onAfterAdd),this.shouldDo&&(this.enable(),this.shouldDo=!1)}getName(){return Xn.NodeClustering}enable(){if(this.enabled)return Promise.resolve();this.enabled=!0,this.shouldDo=!0,this._isRunning=!0;const{ogma:t}=this;return t.getNodes().size?t.export.json({download:!1,edgeAttributes:"all",nodeAttributes:"all"}).then((e=>(t.clearGraph(),t.setGraph(e)))).then((()=>(this._isRunning=!1,Promise.resolve()))):(this._isRunning=!1,Promise.resolve())}disable(){return this.enabled?(this.enabled=!1,this.shouldDo=!1,super.disable()):Promise.resolve()}destroy(){return this.disable(),super.destroy()}run(){const{ogma:t}=this;return this.enabled||!this.shouldDo?Promise.resolve():t.export.json({download:!1,edgeAttributes:"all",nodeAttributes:"all"}).then((e=>(this._isCleaningUp=!0,t.clearGraph(),this._isCleaningUp=!1,t.setGraph(e))))}undo(){if(this._isRunning||this.enabled)return Promise.resolve();const{ogma:t,context:e}=this;this._isCleaningUp=!0;const s=t.getNodes(Array.from(e.metaNodesSet));this.module.removeMetaNodes(s);const n=t.getEdges(Array.from(e.metaEdgesSet));this.module.removeMetaEdges(n);const i=this._getSubNodes(),r=this._getSubEdges();return this.resetContext(),t.removeNodes(s,{virtual:!0}).then((()=>t.removeEdges(n,{virtual:!0}))).then((()=>t.addNodes(i))).then((()=>t.addEdges(r))).then((()=>{this._isCleaningUp=!1,Promise.resolve()}))}cleanup(){return this._isRunning||this.ogma.events.off(this._onBeforeAdd).off(this._onRequestElementsToDelete).off(this._onAfterAdd),Promise.resolve()}resetContext(){this._isRunning||(this.context={nodeGroups:new Map,edgeGroups:new Map,metaNodesSet:new Set,metaEdgesSet:new Set,virtualNodes:this.ogma.createNodeList(),virtualEdges:this.ogma.createEdgeList(),nodeToGroupId:new Map})}getSubNodes(t){const e=this.context.nodeGroups.get(t.getId());return e?e.nodes:[]}getSubEdges(t){const e=this.context.edgeGroups.get(t.getId());return e?e.edges:[]}_getSubNodes(){return Array.from(this.context.nodeGroups.values()).reduce(((t,{nodes:e})=>(t.push(...e),t)),[])}_getSubEdges(){return Array.from(this.context.edgeGroups.values()).reduce(((t,{edges:e})=>(t.push(...e),t)),[])}_setVirtual(t,e){if(!t)return;const{context:s}=this,n=e?s.metaNodesSet:s.metaEdgesSet,i=t.filter((r=>n.has(r.getId())));if(e)for(let r=0;r<i.size;r++)this.module.setTransformation(i._indexes[r],this,e),this.module.setSubNodes(i._indexes[r],null);else for(let r=0;r<i.size;r++)this.module.setTransformation(i._indexes[r],this,e),this.module.setSubEdges(i._indexes[r],null);e?s.virtualNodes=s.virtualNodes.concat(i):s.virtualEdges=s.virtualEdges.concat(i)}setContext(){}_computeEdgeGroupId(t,e){return t>e?`${e}:${t}`:`${t}:${e}`}_groupEdges(t){const{ogma:e,id:s,context:n}=this,i=s,r=new Map,o=n.nodeToGroupId;n.edgeGroups.forEach((h=>{h.newEdges=[],r.set(h.id,h)}));const a=[];for(let h=0;h<t.length;++h){const g=t[h];let f=n.nodeToGroupId.get(g.source),m=n.nodeToGroupId.get(g.target);if(!f&&!m){a.push(g);continue}f=f||g.source,m=m||g.target;const y=this._computeEdgeGroupId(f,m);if(y!==void 0){const p=o.get(g.source)||g.source,x=o.get(g.target)||g.target;let v=r.get(y);v||(v={id:y,source:p,target:x,edges:[],newEdges:[]},r.set(y,v)),v.edges.push(g),v.newEdges.push(g)}}const l=Ef(r),u=l.map((({edges:h})=>h));for(let h=0;h<l.length;++h){const g=l[h];if(!g.newEdges.length)continue;const f=g.id,m=u[h],y=this._edgeGenerator(m,f);y.id===void 0&&(y.id=bf(f,i)),y.source=g.source,y.target=g.target,g.metaEdge=y,n.metaEdgesSet.add(y.id),n.edgeGroups.get(y.id)||n.edgeGroups.set(y.id,g),(this._groupSelfLoopEdges||y.source!==y.target)&&a.push(y)}return e.view.afterNextFrame().then((()=>{n.edgeGroups.forEach((({newEdges:h,metaEdge:g})=>{if(!(h.length&&g&&g.id&&g.attributes))return;const f=e.getEdge(g.id);f==null||f.setAttributes(g.attributes)}))})),a}_groupNodes(t){const{id:e,context:s,ogma:n}=this,i=e,r=new Map;s.nodeGroups.forEach((g=>{g.newNodes=[],r.set(g.id,g)}));const o=[];for(let g=0;g<t.length;g++){const f=t[g];if(this._selector&&!this._selector(f)){o.push(f);continue}f.id=J$(f.id);const m=this._nodeToGroupId(f);if(m!==void 0){let y=r.get(m);y||(y={id:m,nodes:[],newNodes:[]},r.set(m,y)),y.nodes.push(f),y.newNodes.push(f)}else s.nodeToGroupId.set(f.id,f.id)}const a=Ef(r),l=a.map((({nodes:g})=>g)),u=a.map((({newNodes:g})=>g)),h=[];for(let g=0;g<a.length;++g){if(!a[g].newNodes.length)continue;const f=a[g].id,m=l[g],y=this._nodeGenerator(m,f);a[g].metaNode=y,y.id===void 0&&(y.id=bf(f,i));for(const p of u[g])s.nodeToGroupId.set(p.id,y.id);s.metaNodesSet.add(y.id),s.nodeGroups.get(y.id)||s.nodeGroups.set(y.id,a[g]),h.push(y)}return h.push(...o),n.view.afterNextFrame().then((()=>{s.nodeGroups.forEach((({newNodes:g,metaNode:f})=>{if(!(g.length&&f&&f.id&&f.attributes))return;const m=n.getNode(f.id);m==null||m.setAttributes(f.attributes)}))})),h}setOptions(t){return this._nodeToGroupId=t.groupIdFunction||this._nodeToGroupId,this._groupSelfLoopEdges=t.groupSelfLoopEdges!==void 0?!!t.groupSelfLoopEdges:this._groupSelfLoopEdges,this._nodeGenerator=t.nodeGenerator||this._nodeGenerator,this._edgeGenerator=t.edgeGenerator||this._edgeGenerator,this._selector=t.selector||this._selector,this.disable().then((()=>this.undo())).then((()=>this.ogma.view.afterNextFrame())).then((()=>this.enable()))}onRemove(){}};function DA(t,e){const s=e.length;return t.length=s,t.splice(0,s,...e),t}function jr(t){return t.enabled!==!1}var Rq=class extends lq{_setOptions(t){const e=t;return e.ogma=this.ogma,e.module=this,e.id=this.transformations.length,e}addNodeGrouping(t={}){const e=new gM(this._setOptions(t));return this.addTransformation(e,jr(t)),e}addEdgeGrouping(t={}){const e=new Sq(this._setOptions(t));return this.addTransformation(e,jr(t)),e}addGeoClustering(t={}){const e=new Iq(this._setOptions(t));return this.addTransformation(e,t.enabled),e}addNodeFilter(t={}){let e={};e=typeof t=="function"?{criteria:t}:t;const s=new cq(this._setOptions(e));return this.addTransformation(s,jr(e)),s}addEdgeFilter(t={}){let e={};e=typeof t=="function"?{criteria:t}:t;const s=new gq(this._setOptions(e));return this.addTransformation(s,jr(e)),s}addNeighborMerging(t){const e=new fq(this._setOptions(t));return this.addTransformation(e,jr(t)),e}addNeighborGeneration(t){const e=new _q(this._setOptions(t));return this.addTransformation(e,jr(t)),e}addNodeCollapsing(t={}){const e=new vq(this._setOptions(t));return this.addTransformation(e,jr(t)),e}addVirtualProperties(t={}){const e=new Eq(this._setOptions(t));return this.addTransformation(e,jr(t)),e}addNodeClustering(t={}){const e=new kq(this._setOptions(t));return this.addTransformation(e,jr(t)),e}addDrilldown(t={onGetSubgraph:()=>Promise.resolve({nodes:[],edges:[]})}){const e=new tq(this._setOptions(t));return this.drilldownController.addDrilldown(e),e}onGroupsUpdated(t){this.groupController.layoutController.onGroupsUpdate=t}triggerGroupsUpdated(){this.groupController.triggerGroupsUpdate()}layoutGroups(t,e,s=!1){return this.groupController.layoutGroups(t,e,s)}getXYR(t){return this.animations.getXYR(t)}fishEyeExpand(t,e,s){return this.groupController.fishEyeExpand(t,e,s)}fishEyeCollapse(t,e){return this.groupController.fishEyeCollapse(t,e)}},Fq=b0,ko={},ya={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OA;function Pq(){if(OA)return ya;OA=1;var t=dh();function e(C){for(var R="https://reactjs.org/docs/error-decoder.html?invariant="+C,U=1;U<arguments.length;U++)R+="&args[]="+encodeURIComponent(arguments[U]);return"Minified React error #"+C+"; visit "+R+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=Object.prototype.hasOwnProperty,n=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,i={},r={};function o(C){return s.call(r,C)?!0:s.call(i,C)?!1:n.test(C)?r[C]=!0:(i[C]=!0,!1)}function a(C,R,U,W,St,bt,kt){this.acceptsBooleans=R===2||R===3||R===4,this.attributeName=W,this.attributeNamespace=St,this.mustUseProperty=U,this.propertyName=C,this.type=R,this.sanitizeURL=bt,this.removeEmptyString=kt}var l={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(C){l[C]=new a(C,0,!1,C,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(C){var R=C[0];l[R]=new a(R,1,!1,C[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(C){l[C]=new a(C,2,!1,C.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(C){l[C]=new a(C,2,!1,C,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(C){l[C]=new a(C,3,!1,C.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(C){l[C]=new a(C,3,!0,C,null,!1,!1)}),["capture","download"].forEach(function(C){l[C]=new a(C,4,!1,C,null,!1,!1)}),["cols","rows","size","span"].forEach(function(C){l[C]=new a(C,6,!1,C,null,!1,!1)}),["rowSpan","start"].forEach(function(C){l[C]=new a(C,5,!1,C.toLowerCase(),null,!1,!1)});var u=/[\-:]([a-z])/g;function h(C){return C[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(C){var R=C.replace(u,h);l[R]=new a(R,1,!1,C,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(C){var R=C.replace(u,h);l[R]=new a(R,1,!1,C,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(C){var R=C.replace(u,h);l[R]=new a(R,1,!1,C,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(C){l[C]=new a(C,1,!1,C.toLowerCase(),null,!1,!1)}),l.xlinkHref=new a("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(C){l[C]=new a(C,1,!1,C.toLowerCase(),null,!0,!0)});var g={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},f=["Webkit","ms","Moz","O"];Object.keys(g).forEach(function(C){f.forEach(function(R){R=R+C.charAt(0).toUpperCase()+C.substring(1),g[R]=g[C]})});var m=/["'&<>]/;function y(C){if(typeof C=="boolean"||typeof C=="number")return""+C;C=""+C;var R=m.exec(C);if(R){var U="",W,St=0;for(W=R.index;W<C.length;W++){switch(C.charCodeAt(W)){case 34:R="&quot;";break;case 38:R="&amp;";break;case 39:R="&#x27;";break;case 60:R="&lt;";break;case 62:R="&gt;";break;default:continue}St!==W&&(U+=C.substring(St,W)),St=W+1,U+=R}C=St!==W?U+C.substring(St,W):U}return C}var p=/([A-Z])/g,x=/^ms-/,v=Array.isArray;function b(C,R){return{insertionMode:C,selectedValue:R}}function S(C,R,U){switch(R){case"select":return b(1,U.value!=null?U.value:U.defaultValue);case"svg":return b(2,null);case"math":return b(3,null);case"foreignObject":return b(1,null);case"table":return b(4,null);case"thead":case"tbody":case"tfoot":return b(5,null);case"colgroup":return b(7,null);case"tr":return b(6,null)}return 4<=C.insertionMode||C.insertionMode===0?b(1,null):C}var A=new Map;function w(C,R,U){if(typeof U!="object")throw Error(e(62));R=!0;for(var W in U)if(s.call(U,W)){var St=U[W];if(St!=null&&typeof St!="boolean"&&St!==""){if(W.indexOf("--")===0){var bt=y(W);St=y((""+St).trim())}else{bt=W;var kt=A.get(bt);kt!==void 0||(kt=y(bt.replace(p,"-$1").toLowerCase().replace(x,"-ms-")),A.set(bt,kt)),bt=kt,St=typeof St=="number"?St===0||s.call(g,W)?""+St:St+"px":y((""+St).trim())}R?(R=!1,C.push(' style="',bt,":",St)):C.push(";",bt,":",St)}}R||C.push('"')}function L(C,R,U,W){switch(U){case"style":w(C,R,W);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<U.length)||U[0]!=="o"&&U[0]!=="O"||U[1]!=="n"&&U[1]!=="N"){if(R=l.hasOwnProperty(U)?l[U]:null,R!==null){switch(typeof W){case"function":case"symbol":return;case"boolean":if(!R.acceptsBooleans)return}switch(U=R.attributeName,R.type){case 3:W&&C.push(" ",U,'=""');break;case 4:W===!0?C.push(" ",U,'=""'):W!==!1&&C.push(" ",U,'="',y(W),'"');break;case 5:isNaN(W)||C.push(" ",U,'="',y(W),'"');break;case 6:!isNaN(W)&&1<=W&&C.push(" ",U,'="',y(W),'"');break;default:R.sanitizeURL&&(W=""+W),C.push(" ",U,'="',y(W),'"')}}else if(o(U)){switch(typeof W){case"function":case"symbol":return;case"boolean":if(R=U.toLowerCase().slice(0,5),R!=="data-"&&R!=="aria-")return}C.push(" ",U,'="',y(W),'"')}}}function k(C,R,U){if(R!=null){if(U!=null)throw Error(e(60));if(typeof R!="object"||!("__html"in R))throw Error(e(61));R=R.__html,R!=null&&C.push(""+R)}}function F(C){var R="";return t.Children.forEach(C,function(U){U!=null&&(R+=U)}),R}function O(C,R,U,W){C.push(Z(U));var St=U=null,bt;for(bt in R)if(s.call(R,bt)){var kt=R[bt];if(kt!=null)switch(bt){case"children":U=kt;break;case"dangerouslySetInnerHTML":St=kt;break;default:L(C,W,bt,kt)}}return C.push(">"),k(C,St,U),typeof U=="string"?(C.push(y(U)),null):U}var j=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,V=new Map;function Z(C){var R=V.get(C);if(R===void 0){if(!j.test(C))throw Error(e(65,C));R="<"+C,V.set(C,R)}return R}function at(C,R,U,W,St){switch(R){case"select":C.push(Z("select"));var bt=null,kt=null;for(we in U)if(s.call(U,we)){var Zt=U[we];if(Zt!=null)switch(we){case"children":bt=Zt;break;case"dangerouslySetInnerHTML":kt=Zt;break;case"defaultValue":case"value":break;default:L(C,W,we,Zt)}}return C.push(">"),k(C,kt,bt),bt;case"option":kt=St.selectedValue,C.push(Z("option"));var ne=Zt=null,Ee=null,we=null;for(bt in U)if(s.call(U,bt)){var We=U[bt];if(We!=null)switch(bt){case"children":Zt=We;break;case"selected":Ee=We;break;case"dangerouslySetInnerHTML":we=We;break;case"value":ne=We;default:L(C,W,bt,We)}}if(kt!=null)if(U=ne!==null?""+ne:F(Zt),v(kt)){for(W=0;W<kt.length;W++)if(""+kt[W]===U){C.push(' selected=""');break}}else""+kt===U&&C.push(' selected=""');else Ee&&C.push(' selected=""');return C.push(">"),k(C,we,Zt),Zt;case"textarea":C.push(Z("textarea")),we=kt=bt=null;for(Zt in U)if(s.call(U,Zt)&&(ne=U[Zt],ne!=null))switch(Zt){case"children":we=ne;break;case"value":bt=ne;break;case"defaultValue":kt=ne;break;case"dangerouslySetInnerHTML":throw Error(e(91));default:L(C,W,Zt,ne)}if(bt===null&&kt!==null&&(bt=kt),C.push(">"),we!=null){if(bt!=null)throw Error(e(92));if(v(we)&&1<we.length)throw Error(e(93));bt=""+we}return typeof bt=="string"&&bt[0]===`
`&&C.push(`
`),bt!==null&&C.push(y(""+bt)),null;case"input":C.push(Z("input")),ne=we=Zt=bt=null;for(kt in U)if(s.call(U,kt)&&(Ee=U[kt],Ee!=null))switch(kt){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,"input"));case"defaultChecked":ne=Ee;break;case"defaultValue":Zt=Ee;break;case"checked":we=Ee;break;case"value":bt=Ee;break;default:L(C,W,kt,Ee)}return we!==null?L(C,W,"checked",we):ne!==null&&L(C,W,"checked",ne),bt!==null?L(C,W,"value",bt):Zt!==null&&L(C,W,"value",Zt),C.push("/>"),null;case"menuitem":C.push(Z("menuitem"));for(var ls in U)if(s.call(U,ls)&&(bt=U[ls],bt!=null))switch(ls){case"children":case"dangerouslySetInnerHTML":throw Error(e(400));default:L(C,W,ls,bt)}return C.push(">"),null;case"title":C.push(Z("title")),bt=null;for(We in U)if(s.call(U,We)&&(kt=U[We],kt!=null))switch(We){case"children":bt=kt;break;case"dangerouslySetInnerHTML":throw Error(e(434));default:L(C,W,We,kt)}return C.push(">"),bt;case"listing":case"pre":C.push(Z(R)),kt=bt=null;for(ne in U)if(s.call(U,ne)&&(Zt=U[ne],Zt!=null))switch(ne){case"children":bt=Zt;break;case"dangerouslySetInnerHTML":kt=Zt;break;default:L(C,W,ne,Zt)}if(C.push(">"),kt!=null){if(bt!=null)throw Error(e(60));if(typeof kt!="object"||!("__html"in kt))throw Error(e(61));U=kt.__html,U!=null&&(typeof U=="string"&&0<U.length&&U[0]===`
`?C.push(`
`,U):C.push(""+U))}return typeof bt=="string"&&bt[0]===`
`&&C.push(`
`),bt;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":C.push(Z(R));for(var ps in U)if(s.call(U,ps)&&(bt=U[ps],bt!=null))switch(ps){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,R));default:L(C,W,ps,bt)}return C.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return O(C,U,R,W);case"html":return St.insertionMode===0&&C.push("<!DOCTYPE html>"),O(C,U,R,W);default:if(R.indexOf("-")===-1&&typeof U.is!="string")return O(C,U,R,W);C.push(Z(R)),kt=bt=null;for(Ee in U)if(s.call(U,Ee)&&(Zt=U[Ee],Zt!=null))switch(Ee){case"children":bt=Zt;break;case"dangerouslySetInnerHTML":kt=Zt;break;case"style":w(C,W,Zt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:o(Ee)&&typeof Zt!="function"&&typeof Zt!="symbol"&&C.push(" ",Ee,'="',y(Zt),'"')}return C.push(">"),k(C,kt,bt),bt}}function mt(C,R,U){if(C.push('<!--$?--><template id="'),U===null)throw Error(e(395));return C.push(U),C.push('"></template>')}function K(C,R,U,W){switch(U.insertionMode){case 0:case 1:return C.push('<div hidden id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 2:return C.push('<svg aria-hidden="true" style="display:none" id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 3:return C.push('<math aria-hidden="true" style="display:none" id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 4:return C.push('<table hidden id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 5:return C.push('<table hidden><tbody id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 6:return C.push('<table hidden><tr id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');case 7:return C.push('<table hidden><colgroup id="'),C.push(R.segmentPrefix),R=W.toString(16),C.push(R),C.push('">');default:throw Error(e(397))}}function ut(C,R){switch(R.insertionMode){case 0:case 1:return C.push("</div>");case 2:return C.push("</svg>");case 3:return C.push("</math>");case 4:return C.push("</table>");case 5:return C.push("</tbody></table>");case 6:return C.push("</tr></table>");case 7:return C.push("</colgroup></table>");default:throw Error(e(397))}}var ht=/[<\u2028\u2029]/g;function nt(C){return JSON.stringify(C).replace(ht,function(R){switch(R){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function ot(C,R){return R=R===void 0?"":R,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:R+"P:",segmentPrefix:R+"S:",boundaryPrefix:R+"B:",idPrefix:R,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:C}}function Mt(C,R,U,W){return U.generateStaticMarkup?(C.push(y(R)),!1):(R===""?C=W:(W&&C.push("<!-- -->"),C.push(y(R)),C=!0),C)}var Q=Object.assign,Et=Symbol.for("react.element"),qt=Symbol.for("react.portal"),Vt=Symbol.for("react.fragment"),Wt=Symbol.for("react.strict_mode"),oe=Symbol.for("react.profiler"),me=Symbol.for("react.provider"),se=Symbol.for("react.context"),Jt=Symbol.for("react.forward_ref"),ee=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),Ce=Symbol.for("react.memo"),ve=Symbol.for("react.lazy"),Me=Symbol.for("react.scope"),ge=Symbol.for("react.debug_trace_mode"),ze=Symbol.for("react.legacy_hidden"),is=Symbol.for("react.default_value"),Ge=Symbol.iterator;function De(C){if(C==null)return null;if(typeof C=="function")return C.displayName||C.name||null;if(typeof C=="string")return C;switch(C){case Vt:return"Fragment";case qt:return"Portal";case oe:return"Profiler";case Wt:return"StrictMode";case ee:return"Suspense";case ce:return"SuspenseList"}if(typeof C=="object")switch(C.$$typeof){case se:return(C.displayName||"Context")+".Consumer";case me:return(C._context.displayName||"Context")+".Provider";case Jt:var R=C.render;return C=C.displayName,C||(C=R.displayName||R.name||"",C=C!==""?"ForwardRef("+C+")":"ForwardRef"),C;case Ce:return R=C.displayName||null,R!==null?R:De(C.type)||"Memo";case ve:R=C._payload,C=C._init;try{return De(C(R))}catch{}}return null}var He={};function Je(C,R){if(C=C.contextTypes,!C)return He;var U={},W;for(W in C)U[W]=R[W];return U}var ss=null;function ts(C,R){if(C!==R){C.context._currentValue2=C.parentValue,C=C.parent;var U=R.parent;if(C===null){if(U!==null)throw Error(e(401))}else{if(U===null)throw Error(e(401));ts(C,U)}R.context._currentValue2=R.value}}function hs(C){C.context._currentValue2=C.parentValue,C=C.parent,C!==null&&hs(C)}function Fe(C){var R=C.parent;R!==null&&Fe(R),C.context._currentValue2=C.value}function Oe(C,R){if(C.context._currentValue2=C.parentValue,C=C.parent,C===null)throw Error(e(402));C.depth===R.depth?ts(C,R):Oe(C,R)}function Cs(C,R){var U=R.parent;if(U===null)throw Error(e(402));C.depth===U.depth?ts(C,U):Cs(C,U),R.context._currentValue2=R.value}function Fs(C){var R=ss;R!==C&&(R===null?Fe(C):C===null?hs(R):R.depth===C.depth?ts(R,C):R.depth>C.depth?Oe(R,C):Cs(R,C),ss=C)}var Hs={isMounted:function(){return!1},enqueueSetState:function(C,R){C=C._reactInternals,C.queue!==null&&C.queue.push(R)},enqueueReplaceState:function(C,R){C=C._reactInternals,C.replace=!0,C.queue=[R]},enqueueForceUpdate:function(){}};function Ls(C,R,U,W){var St=C.state!==void 0?C.state:null;C.updater=Hs,C.props=U,C.state=St;var bt={queue:[],replace:!1};C._reactInternals=bt;var kt=R.contextType;if(C.context=typeof kt=="object"&&kt!==null?kt._currentValue2:W,kt=R.getDerivedStateFromProps,typeof kt=="function"&&(kt=kt(U,St),St=kt==null?St:Q({},St,kt),C.state=St),typeof R.getDerivedStateFromProps!="function"&&typeof C.getSnapshotBeforeUpdate!="function"&&(typeof C.UNSAFE_componentWillMount=="function"||typeof C.componentWillMount=="function"))if(R=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),R!==C.state&&Hs.enqueueReplaceState(C,C.state,null),bt.queue!==null&&0<bt.queue.length)if(R=bt.queue,kt=bt.replace,bt.queue=null,bt.replace=!1,kt&&R.length===1)C.state=R[0];else{for(bt=kt?R[0]:C.state,St=!0,kt=kt?1:0;kt<R.length;kt++){var Zt=R[kt];Zt=typeof Zt=="function"?Zt.call(C,bt,U,W):Zt,Zt!=null&&(St?(St=!1,bt=Q({},bt,Zt)):Q(bt,Zt))}C.state=bt}else bt.queue=null}var En={id:1,overflow:""};function hn(C,R,U){var W=C.id;C=C.overflow;var St=32-on(W)-1;W&=~(1<<St),U+=1;var bt=32-on(R)+St;if(30<bt){var kt=St-St%5;return bt=(W&(1<<kt)-1).toString(32),W>>=kt,St-=kt,{id:1<<32-on(R)+St|U<<St|W,overflow:bt+C}}return{id:1<<bt|U<<St|W,overflow:C}}var on=Math.clz32?Math.clz32:gt,xs=Math.log,Ps=Math.LN2;function gt(C){return C>>>=0,C===0?32:31-(xs(C)/Ps|0)|0}function M(C,R){return C===R&&(C!==0||1/C===1/R)||C!==C&&R!==R}var P=typeof Object.is=="function"?Object.is:M,D=null,B=null,$=null,H=null,X=!1,lt=!1,dt=0,ct=null,pt=0;function yt(){if(D===null)throw Error(e(321));return D}function Nt(){if(0<pt)throw Error(e(312));return{memoizedState:null,queue:null,next:null}}function Tt(){return H===null?$===null?(X=!1,$=H=Nt()):(X=!0,H=$):H.next===null?(X=!1,H=H.next=Nt()):(X=!0,H=H.next),H}function At(){B=D=null,lt=!1,$=null,pt=0,H=ct=null}function Bt(C,R){return typeof R=="function"?R(C):R}function he(C,R,U){if(D=yt(),H=Tt(),X){var W=H.queue;if(R=W.dispatch,ct!==null&&(U=ct.get(W),U!==void 0)){ct.delete(W),W=H.memoizedState;do W=C(W,U.action),U=U.next;while(U!==null);return H.memoizedState=W,[W,R]}return[H.memoizedState,R]}return C=C===Bt?typeof R=="function"?R():R:U!==void 0?U(R):R,H.memoizedState=C,C=H.queue={last:null,dispatch:null},C=C.dispatch=be.bind(null,D,C),[H.memoizedState,C]}function xe(C,R){if(D=yt(),H=Tt(),R=R===void 0?null:R,H!==null){var U=H.memoizedState;if(U!==null&&R!==null){var W=U[1];t:if(W===null)W=!1;else{for(var St=0;St<W.length&&St<R.length;St++)if(!P(R[St],W[St])){W=!1;break t}W=!0}if(W)return U[0]}}return C=C(),H.memoizedState=[C,R],C}function be(C,R,U){if(25<=pt)throw Error(e(301));if(C===D)if(lt=!0,C={action:U,next:null},ct===null&&(ct=new Map),U=ct.get(R),U===void 0)ct.set(R,C);else{for(R=U;R.next!==null;)R=R.next;R.next=C}}function le(){throw Error(e(394))}function _e(){}var Te={readContext:function(C){return C._currentValue2},useContext:function(C){return yt(),C._currentValue2},useMemo:xe,useReducer:he,useRef:function(C){D=yt(),H=Tt();var R=H.memoizedState;return R===null?(C={current:C},H.memoizedState=C):R},useState:function(C){return he(Bt,C)},useInsertionEffect:_e,useLayoutEffect:function(){},useCallback:function(C,R){return xe(function(){return C},R)},useImperativeHandle:_e,useEffect:_e,useDebugValue:_e,useDeferredValue:function(C){return yt(),C},useTransition:function(){return yt(),[!1,le]},useId:function(){var C=B.treeContext,R=C.overflow;C=C.id,C=(C&~(1<<32-on(C)-1)).toString(32)+R;var U=Ve;if(U===null)throw Error(e(404));return R=dt++,C=":"+U.idPrefix+"R"+C,0<R&&(C+="H"+R.toString(32)),C+":"},useMutableSource:function(C,R){return yt(),R(C._source)},useSyncExternalStore:function(C,R,U){if(U===void 0)throw Error(e(407));return U()}},Ve=null,ke=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function je(C){return console.error(C),null}function Pe(){}function Be(C,R,U,W,St,bt,kt,Zt,ne){var Ee=[],we=new Set;return R={destination:null,responseState:R,progressiveChunkSize:W===void 0?12800:W,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:we,pingedTasks:Ee,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:St===void 0?je:St,onAllReady:Pe,onShellReady:kt===void 0?Pe:kt,onShellError:Pe,onFatalError:Pe},U=es(R,0,null,U,!1,!1),U.parentFlushed=!0,C=Ue(R,C,null,U,we,He,null,En),Ee.push(C),R}function Ue(C,R,U,W,St,bt,kt,Zt){C.allPendingTasks++,U===null?C.pendingRootTasks++:U.pendingTasks++;var ne={node:R,ping:function(){var Ee=C.pingedTasks;Ee.push(ne),Ee.length===1&&Lt(C)},blockedBoundary:U,blockedSegment:W,abortSet:St,legacyContext:bt,context:kt,treeContext:Zt};return St.add(ne),ne}function es(C,R,U,W,St,bt){return{status:0,id:-1,index:R,parentFlushed:!1,chunks:[],children:[],formatContext:W,boundary:U,lastPushedText:St,textEmbedded:bt}}function rs(C,R){if(C=C.onError(R),C!=null&&typeof C!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof C+'" instead');return C}function cs(C,R){var U=C.onShellError;U(R),U=C.onFatalError,U(R),C.destination!==null?(C.status=2,C.destination.destroy(R)):(C.status=1,C.fatalError=R)}function Y(C,R,U,W,St){for(D={},B=R,dt=0,C=U(W,St);lt;)lt=!1,dt=0,pt+=1,H=null,C=U(W,St);return At(),C}function et(C,R,U,W){var St=U.render(),bt=W.childContextTypes;if(bt!=null){var kt=R.legacyContext;if(typeof U.getChildContext!="function")W=kt;else{U=U.getChildContext();for(var Zt in U)if(!(Zt in bt))throw Error(e(108,De(W)||"Unknown",Zt));W=Q({},kt,U)}R.legacyContext=W,ft(C,R,St),R.legacyContext=kt}else ft(C,R,St)}function J(C,R){if(C&&C.defaultProps){R=Q({},R),C=C.defaultProps;for(var U in C)R[U]===void 0&&(R[U]=C[U]);return R}return R}function tt(C,R,U,W,St){if(typeof U=="function")if(U.prototype&&U.prototype.isReactComponent){St=Je(U,R.legacyContext);var bt=U.contextType;bt=new U(W,typeof bt=="object"&&bt!==null?bt._currentValue2:St),Ls(bt,U,W,St),et(C,R,bt,U)}else{bt=Je(U,R.legacyContext),St=Y(C,R,U,W,bt);var kt=dt!==0;if(typeof St=="object"&&St!==null&&typeof St.render=="function"&&St.$$typeof===void 0)Ls(St,U,W,bt),et(C,R,St,U);else if(kt){W=R.treeContext,R.treeContext=hn(W,1,0);try{ft(C,R,St)}finally{R.treeContext=W}}else ft(C,R,St)}else if(typeof U=="string"){switch(St=R.blockedSegment,bt=at(St.chunks,U,W,C.responseState,St.formatContext),St.lastPushedText=!1,kt=St.formatContext,St.formatContext=S(kt,U,W),it(C,R,bt),St.formatContext=kt,U){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:St.chunks.push("</",U,">")}St.lastPushedText=!1}else{switch(U){case ze:case ge:case Wt:case oe:case Vt:ft(C,R,W.children);return;case ce:ft(C,R,W.children);return;case Me:throw Error(e(343));case ee:t:{U=R.blockedBoundary,St=R.blockedSegment,bt=W.fallback,W=W.children,kt=new Set;var Zt={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:kt,errorDigest:null},ne=es(C,St.chunks.length,Zt,St.formatContext,!1,!1);St.children.push(ne),St.lastPushedText=!1;var Ee=es(C,0,null,St.formatContext,!1,!1);Ee.parentFlushed=!0,R.blockedBoundary=Zt,R.blockedSegment=Ee;try{if(it(C,R,W),C.responseState.generateStaticMarkup||Ee.lastPushedText&&Ee.textEmbedded&&Ee.chunks.push("<!-- -->"),Ee.status=1,Ft(Zt,Ee),Zt.pendingTasks===0)break t}catch(we){Ee.status=4,Zt.forceClientRender=!0,Zt.errorDigest=rs(C,we)}finally{R.blockedBoundary=U,R.blockedSegment=St}R=Ue(C,bt,U,ne,kt,R.legacyContext,R.context,R.treeContext),C.pingedTasks.push(R)}return}if(typeof U=="object"&&U!==null)switch(U.$$typeof){case Jt:if(W=Y(C,R,U.render,W,St),dt!==0){U=R.treeContext,R.treeContext=hn(U,1,0);try{ft(C,R,W)}finally{R.treeContext=U}}else ft(C,R,W);return;case Ce:U=U.type,W=J(U,W),tt(C,R,U,W,St);return;case me:if(St=W.children,U=U._context,W=W.value,bt=U._currentValue2,U._currentValue2=W,kt=ss,ss=W={parent:kt,depth:kt===null?0:kt.depth+1,context:U,parentValue:bt,value:W},R.context=W,ft(C,R,St),C=ss,C===null)throw Error(e(403));W=C.parentValue,C.context._currentValue2=W===is?C.context._defaultValue:W,C=ss=C.parent,R.context=C;return;case se:W=W.children,W=W(U._currentValue2),ft(C,R,W);return;case ve:St=U._init,U=St(U._payload),W=J(U,W),tt(C,R,U,W,void 0);return}throw Error(e(130,U==null?U:typeof U,""))}}function ft(C,R,U){if(R.node=U,typeof U=="object"&&U!==null){switch(U.$$typeof){case Et:tt(C,R,U.type,U.props,U.ref);return;case qt:throw Error(e(257));case ve:var W=U._init;U=W(U._payload),ft(C,R,U);return}if(v(U)){_t(C,R,U);return}if(U===null||typeof U!="object"?W=null:(W=Ge&&U[Ge]||U["@@iterator"],W=typeof W=="function"?W:null),W&&(W=W.call(U))){if(U=W.next(),!U.done){var St=[];do St.push(U.value),U=W.next();while(!U.done);_t(C,R,St)}return}throw C=Object.prototype.toString.call(U),Error(e(31,C==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":C))}typeof U=="string"?(W=R.blockedSegment,W.lastPushedText=Mt(R.blockedSegment.chunks,U,C.responseState,W.lastPushedText)):typeof U=="number"&&(W=R.blockedSegment,W.lastPushedText=Mt(R.blockedSegment.chunks,""+U,C.responseState,W.lastPushedText))}function _t(C,R,U){for(var W=U.length,St=0;St<W;St++){var bt=R.treeContext;R.treeContext=hn(bt,W,St);try{it(C,R,U[St])}finally{R.treeContext=bt}}}function it(C,R,U){var W=R.blockedSegment.formatContext,St=R.legacyContext,bt=R.context;try{return ft(C,R,U)}catch(ne){if(At(),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"){U=ne;var kt=R.blockedSegment,Zt=es(C,kt.chunks.length,null,kt.formatContext,kt.lastPushedText,!0);kt.children.push(Zt),kt.lastPushedText=!1,C=Ue(C,R.node,R.blockedBoundary,Zt,R.abortSet,R.legacyContext,R.context,R.treeContext).ping,U.then(C,C),R.blockedSegment.formatContext=W,R.legacyContext=St,R.context=bt,Fs(bt)}else throw R.blockedSegment.formatContext=W,R.legacyContext=St,R.context=bt,Fs(bt),ne}}function vt(C){var R=C.blockedBoundary;C=C.blockedSegment,C.status=3,Pt(this,R,C)}function Ct(C,R,U){var W=C.blockedBoundary;C.blockedSegment.status=3,W===null?(R.allPendingTasks--,R.status!==2&&(R.status=2,R.destination!==null&&R.destination.push(null))):(W.pendingTasks--,W.forceClientRender||(W.forceClientRender=!0,C=U===void 0?Error(e(432)):U,W.errorDigest=R.onError(C),W.parentFlushed&&R.clientRenderedBoundaries.push(W)),W.fallbackAbortableTasks.forEach(function(St){return Ct(St,R,U)}),W.fallbackAbortableTasks.clear(),R.allPendingTasks--,R.allPendingTasks===0&&(W=R.onAllReady,W()))}function Ft(C,R){if(R.chunks.length===0&&R.children.length===1&&R.children[0].boundary===null){var U=R.children[0];U.id=R.id,U.parentFlushed=!0,U.status===1&&Ft(C,U)}else C.completedSegments.push(R)}function Pt(C,R,U){if(R===null){if(U.parentFlushed){if(C.completedRootSegment!==null)throw Error(e(389));C.completedRootSegment=U}C.pendingRootTasks--,C.pendingRootTasks===0&&(C.onShellError=Pe,R=C.onShellReady,R())}else R.pendingTasks--,R.forceClientRender||(R.pendingTasks===0?(U.parentFlushed&&U.status===1&&Ft(R,U),R.parentFlushed&&C.completedBoundaries.push(R),R.fallbackAbortableTasks.forEach(vt,C),R.fallbackAbortableTasks.clear()):U.parentFlushed&&U.status===1&&(Ft(R,U),R.completedSegments.length===1&&R.parentFlushed&&C.partialBoundaries.push(R)));C.allPendingTasks--,C.allPendingTasks===0&&(C=C.onAllReady,C())}function Lt(C){if(C.status!==2){var R=ss,U=ke.current;ke.current=Te;var W=Ve;Ve=C.responseState;try{var St=C.pingedTasks,bt;for(bt=0;bt<St.length;bt++){var kt=St[bt],Zt=C,ne=kt.blockedSegment;if(ne.status===0){Fs(kt.context);try{ft(Zt,kt,kt.node),Zt.responseState.generateStaticMarkup||ne.lastPushedText&&ne.textEmbedded&&ne.chunks.push("<!-- -->"),kt.abortSet.delete(kt),ne.status=1,Pt(Zt,kt.blockedBoundary,ne)}catch(us){if(At(),typeof us=="object"&&us!==null&&typeof us.then=="function"){var Ee=kt.ping;us.then(Ee,Ee)}else{kt.abortSet.delete(kt),ne.status=4;var we=kt.blockedBoundary,We=us,ls=rs(Zt,We);if(we===null?cs(Zt,We):(we.pendingTasks--,we.forceClientRender||(we.forceClientRender=!0,we.errorDigest=ls,we.parentFlushed&&Zt.clientRenderedBoundaries.push(we))),Zt.allPendingTasks--,Zt.allPendingTasks===0){var ps=Zt.onAllReady;ps()}}}finally{}}}St.splice(0,bt),C.destination!==null&&Xt(C,C.destination)}catch(us){rs(C,us),cs(C,us)}finally{Ve=W,ke.current=U,U===Te&&Fs(R)}}}function $t(C,R,U){switch(U.parentFlushed=!0,U.status){case 0:var W=U.id=C.nextSegmentId++;return U.lastPushedText=!1,U.textEmbedded=!1,C=C.responseState,R.push('<template id="'),R.push(C.placeholderPrefix),C=W.toString(16),R.push(C),R.push('"></template>');case 1:U.status=2;var St=!0;W=U.chunks;var bt=0;U=U.children;for(var kt=0;kt<U.length;kt++){for(St=U[kt];bt<St.index;bt++)R.push(W[bt]);St=jt(C,R,St)}for(;bt<W.length-1;bt++)R.push(W[bt]);return bt<W.length&&(St=R.push(W[bt])),St;default:throw Error(e(390))}}function jt(C,R,U){var W=U.boundary;if(W===null)return $t(C,R,U);if(W.parentFlushed=!0,W.forceClientRender)return C.responseState.generateStaticMarkup||(W=W.errorDigest,R.push("<!--$!-->"),R.push("<template"),W&&(R.push(' data-dgst="'),W=y(W),R.push(W),R.push('"')),R.push("></template>")),$t(C,R,U),C=C.responseState.generateStaticMarkup?!0:R.push("<!--/$-->"),C;if(0<W.pendingTasks){W.rootSegmentID=C.nextSegmentId++,0<W.completedSegments.length&&C.partialBoundaries.push(W);var St=C.responseState,bt=St.nextSuspenseID++;return St=St.boundaryPrefix+bt.toString(16),W=W.id=St,mt(R,C.responseState,W),$t(C,R,U),R.push("<!--/$-->")}if(W.byteSize>C.progressiveChunkSize)return W.rootSegmentID=C.nextSegmentId++,C.completedBoundaries.push(W),mt(R,C.responseState,W.id),$t(C,R,U),R.push("<!--/$-->");if(C.responseState.generateStaticMarkup||R.push("<!--$-->"),U=W.completedSegments,U.length!==1)throw Error(e(391));return jt(C,R,U[0]),C=C.responseState.generateStaticMarkup?!0:R.push("<!--/$-->"),C}function Ot(C,R,U){return K(R,C.responseState,U.formatContext,U.id),jt(C,R,U),ut(R,U.formatContext)}function Ut(C,R,U){for(var W=U.completedSegments,St=0;St<W.length;St++)Ht(C,R,U,W[St]);if(W.length=0,C=C.responseState,W=U.id,U=U.rootSegmentID,R.push(C.startInlineScript),C.sentCompleteBoundaryFunction?R.push('$RC("'):(C.sentCompleteBoundaryFunction=!0,R.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),W===null)throw Error(e(395));return U=U.toString(16),R.push(W),R.push('","'),R.push(C.segmentPrefix),R.push(U),R.push('")<\/script>')}function Ht(C,R,U,W){if(W.status===2)return!0;var St=W.id;if(St===-1){if((W.id=U.rootSegmentID)===-1)throw Error(e(392));return Ot(C,R,W)}return Ot(C,R,W),C=C.responseState,R.push(C.startInlineScript),C.sentCompleteSegmentFunction?R.push('$RS("'):(C.sentCompleteSegmentFunction=!0,R.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),R.push(C.segmentPrefix),St=St.toString(16),R.push(St),R.push('","'),R.push(C.placeholderPrefix),R.push(St),R.push('")<\/script>')}function Xt(C,R){try{var U=C.completedRootSegment;if(U!==null&&C.pendingRootTasks===0){jt(C,R,U),C.completedRootSegment=null;var W=C.responseState.bootstrapChunks;for(U=0;U<W.length-1;U++)R.push(W[U]);U<W.length&&R.push(W[U])}var St=C.clientRenderedBoundaries,bt;for(bt=0;bt<St.length;bt++){var kt=St[bt];W=R;var Zt=C.responseState,ne=kt.id,Ee=kt.errorDigest,we=kt.errorMessage,We=kt.errorComponentStack;if(W.push(Zt.startInlineScript),Zt.sentClientRenderFunction?W.push('$RX("'):(Zt.sentClientRenderFunction=!0,W.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),ne===null)throw Error(e(395));if(W.push(ne),W.push('"'),Ee||we||We){W.push(",");var ls=nt(Ee||"");W.push(ls)}if(we||We){W.push(",");var ps=nt(we||"");W.push(ps)}if(We){W.push(",");var us=nt(We);W.push(us)}if(!W.push(")<\/script>")){C.destination=null,bt++,St.splice(0,bt);return}}St.splice(0,bt);var Ns=C.completedBoundaries;for(bt=0;bt<Ns.length;bt++)if(!Ut(C,R,Ns[bt])){C.destination=null,bt++,Ns.splice(0,bt);return}Ns.splice(0,bt);var gs=C.partialBoundaries;for(bt=0;bt<gs.length;bt++){var Ms=gs[bt];t:{St=C,kt=R;var cn=Ms.completedSegments;for(Zt=0;Zt<cn.length;Zt++)if(!Ht(St,kt,Ms,cn[Zt])){Zt++,cn.splice(0,Zt);var Ss=!1;break t}cn.splice(0,Zt),Ss=!0}if(!Ss){C.destination=null,bt++,gs.splice(0,bt);return}}gs.splice(0,bt);var zs=C.completedBoundaries;for(bt=0;bt<zs.length;bt++)if(!Ut(C,R,zs[bt])){C.destination=null,bt++,zs.splice(0,bt);return}zs.splice(0,bt)}finally{C.allPendingTasks===0&&C.pingedTasks.length===0&&C.clientRenderedBoundaries.length===0&&C.completedBoundaries.length===0&&R.push(null)}}function te(C,R){try{var U=C.abortableTasks;U.forEach(function(W){return Ct(W,C,R)}),U.clear(),C.destination!==null&&Xt(C,C.destination)}catch(W){rs(C,W),cs(C,W)}}function re(){}function ie(C,R,U,W){var St=!1,bt=null,kt="",Zt={push:function(Ee){return Ee!==null&&(kt+=Ee),!0},destroy:function(Ee){St=!0,bt=Ee}},ne=!1;if(C=Be(C,ot(U,R?R.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,re,void 0,function(){ne=!0}),Lt(C),te(C,W),C.status===1)C.status=2,Zt.destroy(C.fatalError);else if(C.status!==2&&C.destination===null){C.destination=Zt;try{Xt(C,Zt)}catch(Ee){rs(C,Ee),cs(C,Ee)}}if(St)throw bt;if(!ne)throw Error(e(426));return kt}return ya.renderToNodeStream=function(){throw Error(e(207))},ya.renderToStaticMarkup=function(C,R){return ie(C,R,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},ya.renderToStaticNodeStream=function(){throw Error(e(208))},ya.renderToString=function(C,R){return ie(C,R,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},ya.version="18.3.1",ya}var wg={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BA;function zq(){if(BA)return wg;BA=1;var t=dh();function e(N){for(var z="https://reactjs.org/docs/error-decoder.html?invariant="+N,q=1;q<arguments.length;q++)z+="&args[]="+encodeURIComponent(arguments[q]);return"Minified React error #"+N+"; visit "+z+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=null,n=0;function i(N,z){if(z.length!==0)if(512<z.length)0<n&&(N.enqueue(new Uint8Array(s.buffer,0,n)),s=new Uint8Array(512),n=0),N.enqueue(z);else{var q=s.length-n;q<z.length&&(q===0?N.enqueue(s):(s.set(z.subarray(0,q),n),N.enqueue(s),z=z.subarray(q)),s=new Uint8Array(512),n=0),s.set(z,n),n+=z.length}}function r(N,z){return i(N,z),!0}function o(N){s&&0<n&&(N.enqueue(new Uint8Array(s.buffer,0,n)),s=null,n=0)}var a=new TextEncoder;function l(N){return a.encode(N)}function u(N){return a.encode(N)}function h(N,z){typeof N.error=="function"?N.error(z):N.close()}var g=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},y={};function p(N){return g.call(y,N)?!0:g.call(m,N)?!1:f.test(N)?y[N]=!0:(m[N]=!0,!1)}function x(N,z,q,st,Dt,Rt,Kt){this.acceptsBooleans=z===2||z===3||z===4,this.attributeName=st,this.attributeNamespace=Dt,this.mustUseProperty=q,this.propertyName=N,this.type=z,this.sanitizeURL=Rt,this.removeEmptyString=Kt}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(N){v[N]=new x(N,0,!1,N,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(N){var z=N[0];v[z]=new x(z,1,!1,N[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(N){v[N]=new x(N,2,!1,N.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(N){v[N]=new x(N,2,!1,N,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(N){v[N]=new x(N,3,!1,N.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(N){v[N]=new x(N,3,!0,N,null,!1,!1)}),["capture","download"].forEach(function(N){v[N]=new x(N,4,!1,N,null,!1,!1)}),["cols","rows","size","span"].forEach(function(N){v[N]=new x(N,6,!1,N,null,!1,!1)}),["rowSpan","start"].forEach(function(N){v[N]=new x(N,5,!1,N.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function S(N){return N[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(N){var z=N.replace(b,S);v[z]=new x(z,1,!1,N,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(N){var z=N.replace(b,S);v[z]=new x(z,1,!1,N,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(N){var z=N.replace(b,S);v[z]=new x(z,1,!1,N,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(N){v[N]=new x(N,1,!1,N.toLowerCase(),null,!1,!1)}),v.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(N){v[N]=new x(N,1,!1,N.toLowerCase(),null,!0,!0)});var A={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},w=["Webkit","ms","Moz","O"];Object.keys(A).forEach(function(N){w.forEach(function(z){z=z+N.charAt(0).toUpperCase()+N.substring(1),A[z]=A[N]})});var L=/["'&<>]/;function k(N){if(typeof N=="boolean"||typeof N=="number")return""+N;N=""+N;var z=L.exec(N);if(z){var q="",st,Dt=0;for(st=z.index;st<N.length;st++){switch(N.charCodeAt(st)){case 34:z="&quot;";break;case 38:z="&amp;";break;case 39:z="&#x27;";break;case 60:z="&lt;";break;case 62:z="&gt;";break;default:continue}Dt!==st&&(q+=N.substring(Dt,st)),Dt=st+1,q+=z}N=Dt!==st?q+N.substring(Dt,st):q}return N}var F=/([A-Z])/g,O=/^ms-/,j=Array.isArray,V=u("<script>"),Z=u("<\/script>"),at=u('<script src="'),mt=u('<script type="module" src="'),K=u('" async=""><\/script>'),ut=/(<\/|<)(s)(cript)/gi;function ht(N,z,q,st){return""+z+(q==="s"?"\\u0073":"\\u0053")+st}function nt(N,z,q,st,Dt){N=N===void 0?"":N,z=z===void 0?V:u('<script nonce="'+k(z)+'">');var Rt=[];if(q!==void 0&&Rt.push(z,l((""+q).replace(ut,ht)),Z),st!==void 0)for(q=0;q<st.length;q++)Rt.push(at,l(k(st[q])),K);if(Dt!==void 0)for(st=0;st<Dt.length;st++)Rt.push(mt,l(k(Dt[st])),K);return{bootstrapChunks:Rt,startInlineScript:z,placeholderPrefix:u(N+"P:"),segmentPrefix:u(N+"S:"),boundaryPrefix:N+"B:",idPrefix:N,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function ot(N,z){return{insertionMode:N,selectedValue:z}}function Mt(N){return ot(N==="http://www.w3.org/2000/svg"?2:N==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function Q(N,z,q){switch(z){case"select":return ot(1,q.value!=null?q.value:q.defaultValue);case"svg":return ot(2,null);case"math":return ot(3,null);case"foreignObject":return ot(1,null);case"table":return ot(4,null);case"thead":case"tbody":case"tfoot":return ot(5,null);case"colgroup":return ot(7,null);case"tr":return ot(6,null)}return 4<=N.insertionMode||N.insertionMode===0?ot(1,null):N}var Et=u("<!-- -->");function qt(N,z,q,st){return z===""?st:(st&&N.push(Et),N.push(l(k(z))),!0)}var Vt=new Map,Wt=u(' style="'),oe=u(":"),me=u(";");function se(N,z,q){if(typeof q!="object")throw Error(e(62));z=!0;for(var st in q)if(g.call(q,st)){var Dt=q[st];if(Dt!=null&&typeof Dt!="boolean"&&Dt!==""){if(st.indexOf("--")===0){var Rt=l(k(st));Dt=l(k((""+Dt).trim()))}else{Rt=st;var Kt=Vt.get(Rt);Kt!==void 0||(Kt=u(k(Rt.replace(F,"-$1").toLowerCase().replace(O,"-ms-"))),Vt.set(Rt,Kt)),Rt=Kt,Dt=typeof Dt=="number"?Dt===0||g.call(A,st)?l(""+Dt):l(Dt+"px"):l(k((""+Dt).trim()))}z?(z=!1,N.push(Wt,Rt,oe,Dt)):N.push(me,Rt,oe,Dt)}}z||N.push(ce)}var Jt=u(" "),ee=u('="'),ce=u('"'),Ce=u('=""');function ve(N,z,q,st){switch(q){case"style":se(N,z,st);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<q.length)||q[0]!=="o"&&q[0]!=="O"||q[1]!=="n"&&q[1]!=="N"){if(z=v.hasOwnProperty(q)?v[q]:null,z!==null){switch(typeof st){case"function":case"symbol":return;case"boolean":if(!z.acceptsBooleans)return}switch(q=l(z.attributeName),z.type){case 3:st&&N.push(Jt,q,Ce);break;case 4:st===!0?N.push(Jt,q,Ce):st!==!1&&N.push(Jt,q,ee,l(k(st)),ce);break;case 5:isNaN(st)||N.push(Jt,q,ee,l(k(st)),ce);break;case 6:!isNaN(st)&&1<=st&&N.push(Jt,q,ee,l(k(st)),ce);break;default:z.sanitizeURL&&(st=""+st),N.push(Jt,q,ee,l(k(st)),ce)}}else if(p(q)){switch(typeof st){case"function":case"symbol":return;case"boolean":if(z=q.toLowerCase().slice(0,5),z!=="data-"&&z!=="aria-")return}N.push(Jt,l(q),ee,l(k(st)),ce)}}}var Me=u(">"),ge=u("/>");function ze(N,z,q){if(z!=null){if(q!=null)throw Error(e(60));if(typeof z!="object"||!("__html"in z))throw Error(e(61));z=z.__html,z!=null&&N.push(l(""+z))}}function is(N){var z="";return t.Children.forEach(N,function(q){q!=null&&(z+=q)}),z}var Ge=u(' selected=""');function De(N,z,q,st){N.push(ts(q));var Dt=q=null,Rt;for(Rt in z)if(g.call(z,Rt)){var Kt=z[Rt];if(Kt!=null)switch(Rt){case"children":q=Kt;break;case"dangerouslySetInnerHTML":Dt=Kt;break;default:ve(N,st,Rt,Kt)}}return N.push(Me),ze(N,Dt,q),typeof q=="string"?(N.push(l(k(q))),null):q}var He=u(`
`),Je=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,ss=new Map;function ts(N){var z=ss.get(N);if(z===void 0){if(!Je.test(N))throw Error(e(65,N));z=u("<"+N),ss.set(N,z)}return z}var hs=u("<!DOCTYPE html>");function Fe(N,z,q,st,Dt){switch(z){case"select":N.push(ts("select"));var Rt=null,Kt=null;for(Xe in q)if(g.call(q,Xe)){var pe=q[Xe];if(pe!=null)switch(Xe){case"children":Rt=pe;break;case"dangerouslySetInnerHTML":Kt=pe;break;case"defaultValue":case"value":break;default:ve(N,st,Xe,pe)}}return N.push(Me),ze(N,Kt,Rt),Rt;case"option":Kt=Dt.selectedValue,N.push(ts("option"));var Ye=pe=null,ns=null,Xe=null;for(Rt in q)if(g.call(q,Rt)){var ws=q[Rt];if(ws!=null)switch(Rt){case"children":pe=ws;break;case"selected":ns=ws;break;case"dangerouslySetInnerHTML":Xe=ws;break;case"value":Ye=ws;default:ve(N,st,Rt,ws)}}if(Kt!=null)if(q=Ye!==null?""+Ye:is(pe),j(Kt)){for(st=0;st<Kt.length;st++)if(""+Kt[st]===q){N.push(Ge);break}}else""+Kt===q&&N.push(Ge);else ns&&N.push(Ge);return N.push(Me),ze(N,Xe,pe),pe;case"textarea":N.push(ts("textarea")),Xe=Kt=Rt=null;for(pe in q)if(g.call(q,pe)&&(Ye=q[pe],Ye!=null))switch(pe){case"children":Xe=Ye;break;case"value":Rt=Ye;break;case"defaultValue":Kt=Ye;break;case"dangerouslySetInnerHTML":throw Error(e(91));default:ve(N,st,pe,Ye)}if(Rt===null&&Kt!==null&&(Rt=Kt),N.push(Me),Xe!=null){if(Rt!=null)throw Error(e(92));if(j(Xe)&&1<Xe.length)throw Error(e(93));Rt=""+Xe}return typeof Rt=="string"&&Rt[0]===`
`&&N.push(He),Rt!==null&&N.push(l(k(""+Rt))),null;case"input":N.push(ts("input")),Ye=Xe=pe=Rt=null;for(Kt in q)if(g.call(q,Kt)&&(ns=q[Kt],ns!=null))switch(Kt){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,"input"));case"defaultChecked":Ye=ns;break;case"defaultValue":pe=ns;break;case"checked":Xe=ns;break;case"value":Rt=ns;break;default:ve(N,st,Kt,ns)}return Xe!==null?ve(N,st,"checked",Xe):Ye!==null&&ve(N,st,"checked",Ye),Rt!==null?ve(N,st,"value",Rt):pe!==null&&ve(N,st,"value",pe),N.push(ge),null;case"menuitem":N.push(ts("menuitem"));for(var Pn in q)if(g.call(q,Pn)&&(Rt=q[Pn],Rt!=null))switch(Pn){case"children":case"dangerouslySetInnerHTML":throw Error(e(400));default:ve(N,st,Pn,Rt)}return N.push(Me),null;case"title":N.push(ts("title")),Rt=null;for(ws in q)if(g.call(q,ws)&&(Kt=q[ws],Kt!=null))switch(ws){case"children":Rt=Kt;break;case"dangerouslySetInnerHTML":throw Error(e(434));default:ve(N,st,ws,Kt)}return N.push(Me),Rt;case"listing":case"pre":N.push(ts(z)),Kt=Rt=null;for(Ye in q)if(g.call(q,Ye)&&(pe=q[Ye],pe!=null))switch(Ye){case"children":Rt=pe;break;case"dangerouslySetInnerHTML":Kt=pe;break;default:ve(N,st,Ye,pe)}if(N.push(Me),Kt!=null){if(Rt!=null)throw Error(e(60));if(typeof Kt!="object"||!("__html"in Kt))throw Error(e(61));q=Kt.__html,q!=null&&(typeof q=="string"&&0<q.length&&q[0]===`
`?N.push(He,l(q)):N.push(l(""+q)))}return typeof Rt=="string"&&Rt[0]===`
`&&N.push(He),Rt;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":N.push(ts(z));for(var oi in q)if(g.call(q,oi)&&(Rt=q[oi],Rt!=null))switch(oi){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,z));default:ve(N,st,oi,Rt)}return N.push(ge),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return De(N,q,z,st);case"html":return Dt.insertionMode===0&&N.push(hs),De(N,q,z,st);default:if(z.indexOf("-")===-1&&typeof q.is!="string")return De(N,q,z,st);N.push(ts(z)),Kt=Rt=null;for(ns in q)if(g.call(q,ns)&&(pe=q[ns],pe!=null))switch(ns){case"children":Rt=pe;break;case"dangerouslySetInnerHTML":Kt=pe;break;case"style":se(N,st,pe);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:p(ns)&&typeof pe!="function"&&typeof pe!="symbol"&&N.push(Jt,l(ns),ee,l(k(pe)),ce)}return N.push(Me),ze(N,Kt,Rt),Rt}}var Oe=u("</"),Cs=u(">"),Fs=u('<template id="'),Hs=u('"></template>'),Ls=u("<!--$-->"),En=u('<!--$?--><template id="'),hn=u('"></template>'),on=u("<!--$!-->"),xs=u("<!--/$-->"),Ps=u("<template"),gt=u('"'),M=u(' data-dgst="');u(' data-msg="'),u(' data-stck="');var P=u("></template>");function D(N,z,q){if(i(N,En),q===null)throw Error(e(395));return i(N,q),r(N,hn)}var B=u('<div hidden id="'),$=u('">'),H=u("</div>"),X=u('<svg aria-hidden="true" style="display:none" id="'),lt=u('">'),dt=u("</svg>"),ct=u('<math aria-hidden="true" style="display:none" id="'),pt=u('">'),yt=u("</math>"),Nt=u('<table hidden id="'),Tt=u('">'),At=u("</table>"),Bt=u('<table hidden><tbody id="'),he=u('">'),xe=u("</tbody></table>"),be=u('<table hidden><tr id="'),le=u('">'),_e=u("</tr></table>"),Te=u('<table hidden><colgroup id="'),Ve=u('">'),ke=u("</colgroup></table>");function je(N,z,q,st){switch(q.insertionMode){case 0:case 1:return i(N,B),i(N,z.segmentPrefix),i(N,l(st.toString(16))),r(N,$);case 2:return i(N,X),i(N,z.segmentPrefix),i(N,l(st.toString(16))),r(N,lt);case 3:return i(N,ct),i(N,z.segmentPrefix),i(N,l(st.toString(16))),r(N,pt);case 4:return i(N,Nt),i(N,z.segmentPrefix),i(N,l(st.toString(16))),r(N,Tt);case 5:return i(N,Bt),i(N,z.segmentPrefix),i(N,l(st.toString(16))),r(N,he);case 6:return i(N,be),i(N,z.segmentPrefix),i(N,l(st.toString(16))),r(N,le);case 7:return i(N,Te),i(N,z.segmentPrefix),i(N,l(st.toString(16))),r(N,Ve);default:throw Error(e(397))}}function Pe(N,z){switch(z.insertionMode){case 0:case 1:return r(N,H);case 2:return r(N,dt);case 3:return r(N,yt);case 4:return r(N,At);case 5:return r(N,xe);case 6:return r(N,_e);case 7:return r(N,ke);default:throw Error(e(397))}}var Be=u('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),Ue=u('$RS("'),es=u('","'),rs=u('")<\/script>'),cs=u('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),Y=u('$RC("'),et=u('","'),J=u('")<\/script>'),tt=u('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),ft=u('$RX("'),_t=u('"'),it=u(")<\/script>"),vt=u(","),Ct=/[<\u2028\u2029]/g;function Ft(N){return JSON.stringify(N).replace(Ct,function(z){switch(z){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var Pt=Object.assign,Lt=Symbol.for("react.element"),$t=Symbol.for("react.portal"),jt=Symbol.for("react.fragment"),Ot=Symbol.for("react.strict_mode"),Ut=Symbol.for("react.profiler"),Ht=Symbol.for("react.provider"),Xt=Symbol.for("react.context"),te=Symbol.for("react.forward_ref"),re=Symbol.for("react.suspense"),ie=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),U=Symbol.for("react.scope"),W=Symbol.for("react.debug_trace_mode"),St=Symbol.for("react.legacy_hidden"),bt=Symbol.for("react.default_value"),kt=Symbol.iterator;function Zt(N){if(N==null)return null;if(typeof N=="function")return N.displayName||N.name||null;if(typeof N=="string")return N;switch(N){case jt:return"Fragment";case $t:return"Portal";case Ut:return"Profiler";case Ot:return"StrictMode";case re:return"Suspense";case ie:return"SuspenseList"}if(typeof N=="object")switch(N.$$typeof){case Xt:return(N.displayName||"Context")+".Consumer";case Ht:return(N._context.displayName||"Context")+".Provider";case te:var z=N.render;return N=N.displayName,N||(N=z.displayName||z.name||"",N=N!==""?"ForwardRef("+N+")":"ForwardRef"),N;case C:return z=N.displayName||null,z!==null?z:Zt(N.type)||"Memo";case R:z=N._payload,N=N._init;try{return Zt(N(z))}catch{}}return null}var ne={};function Ee(N,z){if(N=N.contextTypes,!N)return ne;var q={},st;for(st in N)q[st]=z[st];return q}var we=null;function We(N,z){if(N!==z){N.context._currentValue=N.parentValue,N=N.parent;var q=z.parent;if(N===null){if(q!==null)throw Error(e(401))}else{if(q===null)throw Error(e(401));We(N,q)}z.context._currentValue=z.value}}function ls(N){N.context._currentValue=N.parentValue,N=N.parent,N!==null&&ls(N)}function ps(N){var z=N.parent;z!==null&&ps(z),N.context._currentValue=N.value}function us(N,z){if(N.context._currentValue=N.parentValue,N=N.parent,N===null)throw Error(e(402));N.depth===z.depth?We(N,z):us(N,z)}function Ns(N,z){var q=z.parent;if(q===null)throw Error(e(402));N.depth===q.depth?We(N,q):Ns(N,q),z.context._currentValue=z.value}function gs(N){var z=we;z!==N&&(z===null?ps(N):N===null?ls(z):z.depth===N.depth?We(z,N):z.depth>N.depth?us(z,N):Ns(z,N),we=N)}var Ms={isMounted:function(){return!1},enqueueSetState:function(N,z){N=N._reactInternals,N.queue!==null&&N.queue.push(z)},enqueueReplaceState:function(N,z){N=N._reactInternals,N.replace=!0,N.queue=[z]},enqueueForceUpdate:function(){}};function cn(N,z,q,st){var Dt=N.state!==void 0?N.state:null;N.updater=Ms,N.props=q,N.state=Dt;var Rt={queue:[],replace:!1};N._reactInternals=Rt;var Kt=z.contextType;if(N.context=typeof Kt=="object"&&Kt!==null?Kt._currentValue:st,Kt=z.getDerivedStateFromProps,typeof Kt=="function"&&(Kt=Kt(q,Dt),Dt=Kt==null?Dt:Pt({},Dt,Kt),N.state=Dt),typeof z.getDerivedStateFromProps!="function"&&typeof N.getSnapshotBeforeUpdate!="function"&&(typeof N.UNSAFE_componentWillMount=="function"||typeof N.componentWillMount=="function"))if(z=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),z!==N.state&&Ms.enqueueReplaceState(N,N.state,null),Rt.queue!==null&&0<Rt.queue.length)if(z=Rt.queue,Kt=Rt.replace,Rt.queue=null,Rt.replace=!1,Kt&&z.length===1)N.state=z[0];else{for(Rt=Kt?z[0]:N.state,Dt=!0,Kt=Kt?1:0;Kt<z.length;Kt++){var pe=z[Kt];pe=typeof pe=="function"?pe.call(N,Rt,q,st):pe,pe!=null&&(Dt?(Dt=!1,Rt=Pt({},Rt,pe)):Pt(Rt,pe))}N.state=Rt}else Rt.queue=null}var Ss={id:1,overflow:""};function zs(N,z,q){var st=N.id;N=N.overflow;var Dt=32-_n(st)-1;st&=~(1<<Dt),q+=1;var Rt=32-_n(z)+Dt;if(30<Rt){var Kt=Dt-Dt%5;return Rt=(st&(1<<Kt)-1).toString(32),st>>=Kt,Dt-=Kt,{id:1<<32-_n(z)+Dt|q<<Dt|st,overflow:Rt+N}}return{id:1<<Rt|q<<Dt|st,overflow:N}}var _n=Math.clz32?Math.clz32:Ds,Js=Math.log,Xs=Math.LN2;function Ds(N){return N>>>=0,N===0?32:31-(Js(N)/Xs|0)|0}function Sn(N,z){return N===z&&(N!==0||1/N===1/z)||N!==N&&z!==z}var Yi=typeof Object.is=="function"?Object.is:Sn,Cn=null,Wi=null,hr=null,vs=null,Xi=!1,cr=!1,Ni=0,pi=null,Wa=0;function Lr(){if(Cn===null)throw Error(e(321));return Cn}function Xa(){if(0<Wa)throw Error(e(312));return{memoizedState:null,queue:null,next:null}}function lo(){return vs===null?hr===null?(Xi=!1,hr=vs=Xa()):(Xi=!0,vs=hr):vs.next===null?(Xi=!1,vs=vs.next=Xa()):(Xi=!0,vs=vs.next),vs}function Jo(){Wi=Cn=null,cr=!1,hr=null,Wa=0,vs=pi=null}function pu(N,z){return typeof z=="function"?z(N):z}function Zi(N,z,q){if(Cn=Lr(),vs=lo(),Xi){var st=vs.queue;if(z=st.dispatch,pi!==null&&(q=pi.get(st),q!==void 0)){pi.delete(st),st=vs.memoizedState;do st=N(st,q.action),q=q.next;while(q!==null);return vs.memoizedState=st,[st,z]}return[vs.memoizedState,z]}return N=N===pu?typeof z=="function"?z():z:q!==void 0?q(z):z,vs.memoizedState=N,N=vs.queue={last:null,dispatch:null},N=N.dispatch=Ka.bind(null,Cn,N),[vs.memoizedState,N]}function Za(N,z){if(Cn=Lr(),vs=lo(),z=z===void 0?null:z,vs!==null){var q=vs.memoizedState;if(q!==null&&z!==null){var st=q[1];t:if(st===null)st=!1;else{for(var Dt=0;Dt<st.length&&Dt<z.length;Dt++)if(!Yi(z[Dt],st[Dt])){st=!1;break t}st=!0}if(st)return q[0]}}return N=N(),vs.memoizedState=[N,z],N}function Ka(N,z,q){if(25<=Wa)throw Error(e(301));if(N===Cn)if(cr=!0,N={action:q,next:null},pi===null&&(pi=new Map),q=pi.get(z),q===void 0)pi.set(z,N);else{for(z=q;z.next!==null;)z=z.next;z.next=N}}function Ch(){throw Error(e(394))}function Nr(){}var ta={readContext:function(N){return N._currentValue},useContext:function(N){return Lr(),N._currentValue},useMemo:Za,useReducer:Zi,useRef:function(N){Cn=Lr(),vs=lo();var z=vs.memoizedState;return z===null?(N={current:N},vs.memoizedState=N):z},useState:function(N){return Zi(pu,N)},useInsertionEffect:Nr,useLayoutEffect:function(){},useCallback:function(N,z){return Za(function(){return N},z)},useImperativeHandle:Nr,useEffect:Nr,useDebugValue:Nr,useDeferredValue:function(N){return Lr(),N},useTransition:function(){return Lr(),[!1,Ch]},useId:function(){var N=Wi.treeContext,z=N.overflow;N=N.id,N=(N&~(1<<32-_n(N)-1)).toString(32)+z;var q=ea;if(q===null)throw Error(e(404));return z=Ni++,N=":"+q.idPrefix+"R"+N,0<z&&(N+="H"+z.toString(32)),N+":"},useMutableSource:function(N,z){return Lr(),z(N._source)},useSyncExternalStore:function(N,z,q){if(q===void 0)throw Error(e(407));return q()}},ea=null,Ln=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function uo(N){return console.error(N),null}function Mr(){}function sa(N,z,q,st,Dt,Rt,Kt,pe,Ye){var ns=[],Xe=new Set;return z={destination:null,responseState:z,progressiveChunkSize:st===void 0?12800:st,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:Xe,pingedTasks:ns,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Dt===void 0?uo:Dt,onAllReady:Rt===void 0?Mr:Rt,onShellReady:Kt===void 0?Mr:Kt,onShellError:pe===void 0?Mr:pe,onFatalError:Ye===void 0?Mr:Ye},q=ho(z,0,null,q,!1,!1),q.parentFlushed=!0,N=_u(z,N,null,q,Xe,ne,null,Ss),ns.push(N),z}function _u(N,z,q,st,Dt,Rt,Kt,pe){N.allPendingTasks++,q===null?N.pendingRootTasks++:q.pendingTasks++;var Ye={node:z,ping:function(){var ns=N.pingedTasks;ns.push(Ye),ns.length===1&&bu(N)},blockedBoundary:q,blockedSegment:st,abortSet:Dt,legacyContext:Rt,context:Kt,treeContext:pe};return Dt.add(Ye),Ye}function ho(N,z,q,st,Dt,Rt){return{status:0,id:-1,index:z,parentFlushed:!1,chunks:[],children:[],formatContext:st,boundary:q,lastPushedText:Dt,textEmbedded:Rt}}function Ir(N,z){if(N=N.onError(z),N!=null&&typeof N!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof N+'" instead');return N}function gr(N,z){var q=N.onShellError;q(z),q=N.onFatalError,q(z),N.destination!==null?(N.status=2,h(N.destination,z)):(N.status=1,N.fatalError=z)}function na(N,z,q,st,Dt){for(Cn={},Wi=z,Ni=0,N=q(st,Dt);cr;)cr=!1,Ni=0,Wa+=1,vs=null,N=q(st,Dt);return Jo(),N}function yu(N,z,q,st){var Dt=q.render(),Rt=st.childContextTypes;if(Rt!=null){var Kt=z.legacyContext;if(typeof q.getChildContext!="function")st=Kt;else{q=q.getChildContext();for(var pe in q)if(!(pe in Rt))throw Error(e(108,Zt(st)||"Unknown",pe));st=Pt({},Kt,q)}z.legacyContext=st,Zn(N,z,Dt),z.legacyContext=Kt}else Zn(N,z,Dt)}function Lh(N,z){if(N&&N.defaultProps){z=Pt({},z),N=N.defaultProps;for(var q in N)z[q]===void 0&&(z[q]=N[q]);return z}return z}function xu(N,z,q,st,Dt){if(typeof q=="function")if(q.prototype&&q.prototype.isReactComponent){Dt=Ee(q,z.legacyContext);var Rt=q.contextType;Rt=new q(st,typeof Rt=="object"&&Rt!==null?Rt._currentValue:Dt),cn(Rt,q,st,Dt),yu(N,z,Rt,q)}else{Rt=Ee(q,z.legacyContext),Dt=na(N,z,q,st,Rt);var Kt=Ni!==0;if(typeof Dt=="object"&&Dt!==null&&typeof Dt.render=="function"&&Dt.$$typeof===void 0)cn(Dt,q,st,Rt),yu(N,z,Dt,q);else if(Kt){st=z.treeContext,z.treeContext=zs(st,1,0);try{Zn(N,z,Dt)}finally{z.treeContext=st}}else Zn(N,z,Dt)}else if(typeof q=="string"){switch(Dt=z.blockedSegment,Rt=Fe(Dt.chunks,q,st,N.responseState,Dt.formatContext),Dt.lastPushedText=!1,Kt=Dt.formatContext,Dt.formatContext=Q(Kt,q,st),vu(N,z,Rt),Dt.formatContext=Kt,q){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Dt.chunks.push(Oe,l(q),Cs)}Dt.lastPushedText=!1}else{switch(q){case St:case W:case Ot:case Ut:case jt:Zn(N,z,st.children);return;case ie:Zn(N,z,st.children);return;case U:throw Error(e(343));case re:t:{q=z.blockedBoundary,Dt=z.blockedSegment,Rt=st.fallback,st=st.children,Kt=new Set;var pe={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:Kt,errorDigest:null},Ye=ho(N,Dt.chunks.length,pe,Dt.formatContext,!1,!1);Dt.children.push(Ye),Dt.lastPushedText=!1;var ns=ho(N,0,null,Dt.formatContext,!1,!1);ns.parentFlushed=!0,z.blockedBoundary=pe,z.blockedSegment=ns;try{if(vu(N,z,st),ns.lastPushedText&&ns.textEmbedded&&ns.chunks.push(Et),ns.status=1,Ja(pe,ns),pe.pendingTasks===0)break t}catch(Xe){ns.status=4,pe.forceClientRender=!0,pe.errorDigest=Ir(N,Xe)}finally{z.blockedBoundary=q,z.blockedSegment=Dt}z=_u(N,Rt,q,Ye,Kt,z.legacyContext,z.context,z.treeContext),N.pingedTasks.push(z)}return}if(typeof q=="object"&&q!==null)switch(q.$$typeof){case te:if(st=na(N,z,q.render,st,Dt),Ni!==0){q=z.treeContext,z.treeContext=zs(q,1,0);try{Zn(N,z,st)}finally{z.treeContext=q}}else Zn(N,z,st);return;case C:q=q.type,st=Lh(q,st),xu(N,z,q,st,Dt);return;case Ht:if(Dt=st.children,q=q._context,st=st.value,Rt=q._currentValue,q._currentValue=st,Kt=we,we=st={parent:Kt,depth:Kt===null?0:Kt.depth+1,context:q,parentValue:Rt,value:st},z.context=st,Zn(N,z,Dt),N=we,N===null)throw Error(e(403));st=N.parentValue,N.context._currentValue=st===bt?N.context._defaultValue:st,N=we=N.parent,z.context=N;return;case Xt:st=st.children,st=st(q._currentValue),Zn(N,z,st);return;case R:Dt=q._init,q=Dt(q._payload),st=Lh(q,st),xu(N,z,q,st,void 0);return}throw Error(e(130,q==null?q:typeof q,""))}}function Zn(N,z,q){if(z.node=q,typeof q=="object"&&q!==null){switch(q.$$typeof){case Lt:xu(N,z,q.type,q.props,q.ref);return;case $t:throw Error(e(257));case R:var st=q._init;q=st(q._payload),Zn(N,z,q);return}if(j(q)){Qa(N,z,q);return}if(q===null||typeof q!="object"?st=null:(st=kt&&q[kt]||q["@@iterator"],st=typeof st=="function"?st:null),st&&(st=st.call(q))){if(q=st.next(),!q.done){var Dt=[];do Dt.push(q.value),q=st.next();while(!q.done);Qa(N,z,Dt)}return}throw N=Object.prototype.toString.call(q),Error(e(31,N==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":N))}typeof q=="string"?(st=z.blockedSegment,st.lastPushedText=qt(z.blockedSegment.chunks,q,N.responseState,st.lastPushedText)):typeof q=="number"&&(st=z.blockedSegment,st.lastPushedText=qt(z.blockedSegment.chunks,""+q,N.responseState,st.lastPushedText))}function Qa(N,z,q){for(var st=q.length,Dt=0;Dt<st;Dt++){var Rt=z.treeContext;z.treeContext=zs(Rt,st,Dt);try{vu(N,z,q[Dt])}finally{z.treeContext=Rt}}}function vu(N,z,q){var st=z.blockedSegment.formatContext,Dt=z.legacyContext,Rt=z.context;try{return Zn(N,z,q)}catch(Ye){if(Jo(),typeof Ye=="object"&&Ye!==null&&typeof Ye.then=="function"){q=Ye;var Kt=z.blockedSegment,pe=ho(N,Kt.chunks.length,null,Kt.formatContext,Kt.lastPushedText,!0);Kt.children.push(pe),Kt.lastPushedText=!1,N=_u(N,z.node,z.blockedBoundary,pe,z.abortSet,z.legacyContext,z.context,z.treeContext).ping,q.then(N,N),z.blockedSegment.formatContext=st,z.legacyContext=Dt,z.context=Rt,gs(Rt)}else throw z.blockedSegment.formatContext=st,z.legacyContext=Dt,z.context=Rt,gs(Rt),Ye}}function im(N){var z=N.blockedBoundary;N=N.blockedSegment,N.status=3,Mh(this,z,N)}function Nh(N,z,q){var st=N.blockedBoundary;N.blockedSegment.status=3,st===null?(z.allPendingTasks--,z.status!==2&&(z.status=2,z.destination!==null&&z.destination.close())):(st.pendingTasks--,st.forceClientRender||(st.forceClientRender=!0,N=q===void 0?Error(e(432)):q,st.errorDigest=z.onError(N),st.parentFlushed&&z.clientRenderedBoundaries.push(st)),st.fallbackAbortableTasks.forEach(function(Dt){return Nh(Dt,z,q)}),st.fallbackAbortableTasks.clear(),z.allPendingTasks--,z.allPendingTasks===0&&(st=z.onAllReady,st()))}function Ja(N,z){if(z.chunks.length===0&&z.children.length===1&&z.children[0].boundary===null){var q=z.children[0];q.id=z.id,q.parentFlushed=!0,q.status===1&&Ja(N,q)}else N.completedSegments.push(z)}function Mh(N,z,q){if(z===null){if(q.parentFlushed){if(N.completedRootSegment!==null)throw Error(e(389));N.completedRootSegment=q}N.pendingRootTasks--,N.pendingRootTasks===0&&(N.onShellError=Mr,z=N.onShellReady,z())}else z.pendingTasks--,z.forceClientRender||(z.pendingTasks===0?(q.parentFlushed&&q.status===1&&Ja(z,q),z.parentFlushed&&N.completedBoundaries.push(z),z.fallbackAbortableTasks.forEach(im,N),z.fallbackAbortableTasks.clear()):q.parentFlushed&&q.status===1&&(Ja(z,q),z.completedSegments.length===1&&z.parentFlushed&&N.partialBoundaries.push(z)));N.allPendingTasks--,N.allPendingTasks===0&&(N=N.onAllReady,N())}function bu(N){if(N.status!==2){var z=we,q=Ln.current;Ln.current=ta;var st=ea;ea=N.responseState;try{var Dt=N.pingedTasks,Rt;for(Rt=0;Rt<Dt.length;Rt++){var Kt=Dt[Rt],pe=N,Ye=Kt.blockedSegment;if(Ye.status===0){gs(Kt.context);try{Zn(pe,Kt,Kt.node),Ye.lastPushedText&&Ye.textEmbedded&&Ye.chunks.push(Et),Kt.abortSet.delete(Kt),Ye.status=1,Mh(pe,Kt.blockedBoundary,Ye)}catch(ai){if(Jo(),typeof ai=="object"&&ai!==null&&typeof ai.then=="function"){var ns=Kt.ping;ai.then(ns,ns)}else{Kt.abortSet.delete(Kt),Ye.status=4;var Xe=Kt.blockedBoundary,ws=ai,Pn=Ir(pe,ws);if(Xe===null?gr(pe,ws):(Xe.pendingTasks--,Xe.forceClientRender||(Xe.forceClientRender=!0,Xe.errorDigest=Pn,Xe.parentFlushed&&pe.clientRenderedBoundaries.push(Xe))),pe.allPendingTasks--,pe.allPendingTasks===0){var oi=pe.onAllReady;oi()}}}finally{}}}Dt.splice(0,Rt),N.destination!==null&&Eu(N,N.destination)}catch(ai){Ir(N,ai),gr(N,ai)}finally{ea=st,Ln.current=q,q===ta&&gs(z)}}}function tl(N,z,q){switch(q.parentFlushed=!0,q.status){case 0:var st=q.id=N.nextSegmentId++;return q.lastPushedText=!1,q.textEmbedded=!1,N=N.responseState,i(z,Fs),i(z,N.placeholderPrefix),N=l(st.toString(16)),i(z,N),r(z,Hs);case 1:q.status=2;var Dt=!0;st=q.chunks;var Rt=0;q=q.children;for(var Kt=0;Kt<q.length;Kt++){for(Dt=q[Kt];Rt<Dt.index;Rt++)i(z,st[Rt]);Dt=el(N,z,Dt)}for(;Rt<st.length-1;Rt++)i(z,st[Rt]);return Rt<st.length&&(Dt=r(z,st[Rt])),Dt;default:throw Error(e(390))}}function el(N,z,q){var st=q.boundary;if(st===null)return tl(N,z,q);if(st.parentFlushed=!0,st.forceClientRender)st=st.errorDigest,r(z,on),i(z,Ps),st&&(i(z,M),i(z,l(k(st))),i(z,gt)),r(z,P),tl(N,z,q);else if(0<st.pendingTasks){st.rootSegmentID=N.nextSegmentId++,0<st.completedSegments.length&&N.partialBoundaries.push(st);var Dt=N.responseState,Rt=Dt.nextSuspenseID++;Dt=u(Dt.boundaryPrefix+Rt.toString(16)),st=st.id=Dt,D(z,N.responseState,st),tl(N,z,q)}else if(st.byteSize>N.progressiveChunkSize)st.rootSegmentID=N.nextSegmentId++,N.completedBoundaries.push(st),D(z,N.responseState,st.id),tl(N,z,q);else{if(r(z,Ls),q=st.completedSegments,q.length!==1)throw Error(e(391));el(N,z,q[0])}return r(z,xs)}function Ih(N,z,q){return je(z,N.responseState,q.formatContext,q.id),el(N,z,q),Pe(z,q.formatContext)}function kh(N,z,q){for(var st=q.completedSegments,Dt=0;Dt<st.length;Dt++)sl(N,z,q,st[Dt]);if(st.length=0,N=N.responseState,st=q.id,q=q.rootSegmentID,i(z,N.startInlineScript),N.sentCompleteBoundaryFunction?i(z,Y):(N.sentCompleteBoundaryFunction=!0,i(z,cs)),st===null)throw Error(e(395));return q=l(q.toString(16)),i(z,st),i(z,et),i(z,N.segmentPrefix),i(z,q),r(z,J)}function sl(N,z,q,st){if(st.status===2)return!0;var Dt=st.id;if(Dt===-1){if((st.id=q.rootSegmentID)===-1)throw Error(e(392));return Ih(N,z,st)}return Ih(N,z,st),N=N.responseState,i(z,N.startInlineScript),N.sentCompleteSegmentFunction?i(z,Ue):(N.sentCompleteSegmentFunction=!0,i(z,Be)),i(z,N.segmentPrefix),Dt=l(Dt.toString(16)),i(z,Dt),i(z,es),i(z,N.placeholderPrefix),i(z,Dt),r(z,rs)}function Eu(N,z){s=new Uint8Array(512),n=0;try{var q=N.completedRootSegment;if(q!==null&&N.pendingRootTasks===0){el(N,z,q),N.completedRootSegment=null;var st=N.responseState.bootstrapChunks;for(q=0;q<st.length-1;q++)i(z,st[q]);q<st.length&&r(z,st[q])}var Dt=N.clientRenderedBoundaries,Rt;for(Rt=0;Rt<Dt.length;Rt++){var Kt=Dt[Rt];st=z;var pe=N.responseState,Ye=Kt.id,ns=Kt.errorDigest,Xe=Kt.errorMessage,ws=Kt.errorComponentStack;if(i(st,pe.startInlineScript),pe.sentClientRenderFunction?i(st,ft):(pe.sentClientRenderFunction=!0,i(st,tt)),Ye===null)throw Error(e(395));i(st,Ye),i(st,_t),(ns||Xe||ws)&&(i(st,vt),i(st,l(Ft(ns||"")))),(Xe||ws)&&(i(st,vt),i(st,l(Ft(Xe||"")))),ws&&(i(st,vt),i(st,l(Ft(ws)))),r(st,it)}Dt.splice(0,Rt);var Pn=N.completedBoundaries;for(Rt=0;Rt<Pn.length;Rt++)kh(N,z,Pn[Rt]);Pn.splice(0,Rt),o(z),s=new Uint8Array(512),n=0;var oi=N.partialBoundaries;for(Rt=0;Rt<oi.length;Rt++){var ai=oi[Rt];t:{Dt=N,Kt=z;var ia=ai.completedSegments;for(pe=0;pe<ia.length;pe++)if(!sl(Dt,Kt,ai,ia[pe])){pe++,ia.splice(0,pe);var Su=!1;break t}ia.splice(0,pe),Su=!0}if(!Su){N.destination=null,Rt++,oi.splice(0,Rt);return}}oi.splice(0,Rt);var fr=N.completedBoundaries;for(Rt=0;Rt<fr.length;Rt++)kh(N,z,fr[Rt]);fr.splice(0,Rt)}finally{o(z),N.allPendingTasks===0&&N.pingedTasks.length===0&&N.clientRenderedBoundaries.length===0&&N.completedBoundaries.length===0&&z.close()}}function Rh(N,z){try{var q=N.abortableTasks;q.forEach(function(st){return Nh(st,N,z)}),q.clear(),N.destination!==null&&Eu(N,N.destination)}catch(st){Ir(N,st),gr(N,st)}}return wg.renderToReadableStream=function(N,z){return new Promise(function(q,st){var Dt,Rt,Kt=new Promise(function(Xe,ws){Rt=Xe,Dt=ws}),pe=sa(N,nt(z?z.identifierPrefix:void 0,z?z.nonce:void 0,z?z.bootstrapScriptContent:void 0,z?z.bootstrapScripts:void 0,z?z.bootstrapModules:void 0),Mt(z?z.namespaceURI:void 0),z?z.progressiveChunkSize:void 0,z?z.onError:void 0,Rt,function(){var Xe=new ReadableStream({type:"bytes",pull:function(ws){if(pe.status===1)pe.status=2,h(ws,pe.fatalError);else if(pe.status!==2&&pe.destination===null){pe.destination=ws;try{Eu(pe,ws)}catch(Pn){Ir(pe,Pn),gr(pe,Pn)}}},cancel:function(){Rh(pe)}},{highWaterMark:0});Xe.allReady=Kt,q(Xe)},function(Xe){Kt.catch(function(){}),st(Xe)},Dt);if(z&&z.signal){var Ye=z.signal,ns=function(){Rh(pe,Ye.reason),Ye.removeEventListener("abort",ns)};Ye.addEventListener("abort",ns)}bu(pe)})},wg.version="18.3.1",wg}var UA;function Dq(){if(UA)return ko;UA=1;var t,e;return t=Pq(),e=zq(),ko.version=t.version,ko.renderToString=t.renderToString,ko.renderToStaticMarkup=t.renderToStaticMarkup,ko.renderToNodeStream=t.renderToNodeStream,ko.renderToStaticNodeStream=t.renderToStaticNodeStream,ko.renderToReadableStream=e.renderToReadableStream,ko}var Jy=Dq(),ih=Iw();const pM=Yt.createContext(null),rn=()=>{const t=Yt.useContext(pM);if(!t)throw new Error("useOgma must be used within an OgmaProvider");return t.ogma};function GA(t,e){Object.keys(t).forEach(s=>{const n=t[s];n&&e(s,n)})}function Oq(t){return t.startsWith("on")&&t.length>2?t[2].toLowerCase()+t.substring(3):null}const VA={},Bq=(t,e)=>{const{options:s=VA,children:n,graph:i,onReady:r,theme:o,className:a="ogma-container"}=t,l=Yt.useRef({}),[u,h]=Yt.useState(!1),[g,f]=Yt.useState(),[m,y]=Yt.useState(null),[p,x]=Yt.useState(),[v,b]=Yt.useState(VA),[S,A]=Yt.useState();return Yt.useImperativeHandle(e,()=>g,[g]),Yt.useEffect(()=>{if(!m)return;const w=new Fq({container:m,graph:i,options:s});o&&(A(o),w.styles.setTheme(o)),f(w),h(!0),r&&r(w)},[m]),Yt.useLayoutEffect(()=>{const w=()=>g==null?void 0:g.view.forceResize();return w(),window.addEventListener("resize",w),()=>window.removeEventListener("resize",w)},[]),Yt.useEffect(()=>{g&&(i&&i!==p&&(x(i),g.setGraph(i)),s&&v!==s&&(b(s),g.setOptions(s)))},[i,s]),Yt.useEffect(()=>{g&&o&&o!==S&&(A(o),g.styles.setTheme(o))},[o]),Yt.useEffect(()=>{if(!g)return;const w={};Object.keys(t).forEach(L=>{if(!L.startsWith("on"))return;const k=Oq(L),F=t[L];k&&typeof F=="function"&&(w[k]=F)}),GA(l.current,(L,k)=>{w[L]||(g.events.off(k),delete l.current[L])}),GA(w,(L,k)=>{const F=l.current[L];F&&F!==k&&g.events.off(F),(!F||F!==k)&&(g.events.on(L,k),l.current[L]=k)})},[t]),ds.createElement("div",{style:{width:"100%",height:"100%"},className:a,ref:w=>y(w)},g&&ds.createElement(pM.Provider,{value:{ogma:g}},u&&n))},Uq=Yt.memo(Yt.forwardRef(Bq)),Gq=Yt.forwardRef(({selector:t,attributes:e},s)=>{const n=rn(),[i,r]=Yt.useState();return Yt.useImperativeHandle(s,()=>i,[i]),Yt.useEffect(()=>{const o=t?n.styles.addNodeRule(t,e):n.styles.addNodeRule(e);return r(o),()=>{o.destroy(),r(void 0)}},[t,e]),null}),Vq=({attributes:t,fullOverwrite:e})=>{const s=rn();return Yt.useEffect(()=>(s.styles.setHoveredNodeAttributes(t,e),()=>{s.styles.setHoveredNodeAttributes(null)}),[t,e]),null},jq=({attributes:t,fullOverwrite:e})=>{const s=rn();return Yt.useEffect(()=>(s.styles.setSelectedNodeAttributes(t,e),()=>{s.styles.setSelectedNodeAttributes(null)}),[t,e]),null},Hq=Object.assign(Gq,{Hovered:Vq,Selected:jq}),$q=Yt.forwardRef(({selector:t,attributes:e},s)=>{const n=rn(),[i,r]=Yt.useState();return Yt.useImperativeHandle(s,()=>i,[i]),Yt.useEffect(()=>{const o=t?n.styles.addEdgeRule(t,e):n.styles.addEdgeRule(e);return r(o),()=>{o.destroy(),r(void 0)}},[t,e]),null}),qq=({attributes:t,fullOverwrite:e})=>{const s=rn();return Yt.useEffect(()=>(s.styles.setHoveredEdgeAttributes(t,e),()=>{s.styles.setHoveredEdgeAttributes(null)}),[t,e]),null},Yq=({attributes:t,fullOverwrite:e})=>{const s=rn();return Yt.useEffect(()=>(s.styles.setSelectedEdgeAttributes(t,e),()=>{s.styles.setSelectedEdgeAttributes(null)}),[t,e]),null},Wq=Object.assign($q,{Hovered:qq,Selected:Yq}),Xq=({name:t,edgeAttributes:e,edgeDependencies:s,edgeOutput:n,nodeAttributes:i,nodeDependencies:r,nodeOutput:o},a)=>{const l=rn(),[u,h]=Yt.useState(null);return Yt.useImperativeHandle(a,()=>u,[u]),Yt.useEffect(()=>{const g={edgeAttributes:e,edgeDependencies:s,edgeOutput:n,nodeAttributes:i,nodeDependencies:r,nodeOutput:o};async function f(){const m=l.styles.createClass({name:t,...g});await l.view.afterNextFrame(),h(m)}return f(),()=>{async function m(){const y=l.styles.getClass(t);y&&await y.destroy(),h(null)}m()}},[]),Yt.useEffect(()=>{u&&u.update({edgeAttributes:e,edgeDependencies:s,edgeOutput:n,nodeAttributes:i,nodeDependencies:r,nodeOutput:o})},[e,s,n,i,r,o]),null},Zq=(t,e)=>t.name===e.name&&t.edgeAttributes===e.edgeAttributes&&t.edgeDependencies===e.edgeDependencies&&t.edgeOutput===e.edgeOutput&&t.nodeAttributes===e.nodeAttributes&&t.nodeDependencies===e.nodeDependencies&&t.nodeOutput===e.nodeOutput;Yt.memo(Yt.forwardRef(Xq),Zq);function $a(t,e,s){e===t.isEnabled()&&(e?t.disable(s):t.enable(s))}function qa(t,e,s){const n=({target:l})=>{l===e&&t.onEnabled&&t.onEnabled(e)},i=({target:l})=>{l===e&&t.onDisabled&&t.onDisabled(e)},r=({target:l})=>{l===e&&t.onUpdated&&t.onUpdated(e)},o=({target:l,index:u})=>{l===e&&t.onSetIndex&&t.onSetIndex(e,u)},a=({target:l})=>{l===e&&(t.onDestroyed&&t.onDestroyed(e),s.events.off(n).off(i).off(r).off(o).off(a))};return s.events.on("transformationEnabled",n).on("transformationDisabled",i).on("transformationDestroyed",a).on("transformationSetIndex",o).on("transformationRefresh",r),()=>{s.events.off(n).off(i).off(r).off(o).off(a)}}function Kq(t,e){const s=rn(),[n,i]=Yt.useState();return Yt.useImperativeHandle(e,()=>n,[n]),Yt.useEffect(()=>{const r=s.transformations.addNodeGrouping({...t,enabled:!t.disabled});return qa(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),Yt.useEffect(()=>{n&&$a(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),Yt.useEffect(()=>{n==null||n.setOptions(t)},[t.groupIdFunction,t.groupSelfLoopEdges,t.edgeGenerator,t.nodeGenerator,t.groupEdges,t.padding,t.selector,t.showContents,t.separateEdgesByDirection]),null}Yt.forwardRef(Kq);function Qq(t,e){const s=rn(),[n,i]=Yt.useState();return Yt.useImperativeHandle(e,()=>n,[n]),Yt.useEffect(()=>{const r=s.transformations.addEdgeGrouping({...t,enabled:!t.disabled});return qa(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),Yt.useEffect(()=>{n&&$a(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),Yt.useEffect(()=>{n==null||n.setOptions(t)},[t.selector,t.generator,t.groupIdFunction,t.separateEdgesByDirection]),null}Yt.forwardRef(Qq);function Jq(t,e){const s=rn(),[n,i]=Yt.useState();return Yt.useImperativeHandle(e,()=>n,[n]),Yt.useEffect(()=>{const r=s.transformations.addNodeCollapsing({...t,enabled:!t.disabled});return qa(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),Yt.useEffect(()=>{n&&$a(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),Yt.useEffect(()=>{n==null||n.setOptions(t)},[t.edgeGenerator,t.selector]),null}Yt.forwardRef(Jq);function tY(t,e){const s=rn(),[n,i]=Yt.useState();return Yt.useImperativeHandle(e,()=>n,[n]),Yt.useEffect(()=>{const r=s.transformations.addNeighborMerging({...t,enabled:!t.disabled});return qa(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),Yt.useEffect(()=>{n&&$a(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),Yt.useEffect(()=>{n==null||n.setOptions(t)},[t.dataFunction,t.selector]),null}Yt.forwardRef(tY);function eY(t,e){const s=rn(),[n,i]=Yt.useState();return Yt.useImperativeHandle(e,()=>n,[n]),Yt.useEffect(()=>{const r=s.transformations.addNeighborGeneration({...t,enabled:!t.disabled});return qa(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),Yt.useEffect(()=>{n&&$a(n,!!t.disabled,t.duration)},[t.disabled,t.duration]),Yt.useEffect(()=>{n==null||n.setOptions(t)},[t.edgeGenerator,t.nodeGenerator,t.neighborIdFunction,t.selector]),null}Yt.forwardRef(eY);function sY(t,e){const s=rn(),[n,i]=Yt.useState();return Yt.useImperativeHandle(e,()=>n,[n]),Yt.useEffect(()=>{const r=s.transformations.addEdgeFilter({...t,enabled:!t.disabled});return qa(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),Yt.useEffect(()=>{n&&$a(n,!!t.disabled,t.duration)},[t.disabled]),Yt.useEffect(()=>{n==null||n.setOptions(t)},[t.criteria]),null}Yt.forwardRef(sY);function nY(t,e){const s=rn(),[n,i]=Yt.useState();return Yt.useImperativeHandle(e,()=>n,[n]),Yt.useEffect(()=>{const r=s.transformations.addNodeFilter({...t,enabled:!t.disabled});return qa(t,r,s),i(r),()=>{r.destroy(),i(void 0)}},[]),Yt.useEffect(()=>{n&&$a(n,!!t.disabled,t.duration)},[t.disabled]),Yt.useEffect(()=>{n==null||n.setOptions(t)},[t.criteria]),null}Yt.forwardRef(nY);function iY(t,e,s,n){return typeof s=="string"?s:typeof s=="function"?Jy.renderToString(s(t,e)):Jy.renderToString(n)}function Sf(t,e){return typeof t=="function"?t(e):t}const jA=(t,e)=>`${t} ${t}--${e}`;function rY(t="&times;",e){if(t){const s=typeof t=="string"?t:Jy.renderToString(t);return`<div class=${e}>${s}</div>`}return""}function oY(t){return t.endsWith("Doubleclick")?"doubleclick":t.toLowerCase().endsWith("click")?"click":"mouseover"}function aY(t,e){if(t instanceof ji){const s=t.getAttribute("radius"),n=HA("outer",t,e),i=HA("inner",t,e);return s+n+i}else if(t instanceof so)return t.size;return 0}function HA(t,e,s){const n=e.getAttribute(`${t}Stroke.width`);return e.getAttribute(`${t}Stroke.minVisibleSize`)<e.size?e.getAttribute(`${t}Stroke.scalingMethod`)!=="fixed"?n/s:n:0}function lY(t,e,s){const n=aY(t,e),i={x:0,y:0};switch(s){case"top":i.y=-n;break;case"bottom":i.y=n;break;case"left":i.x=-n;break;case"right":i.x=n;break}return i}function uY(){}const y_={x:-9999,y:-9999},dY="ogma-popup--content",hY="ogma-popup--close",cY="ogma-popup--body",gY="ogma-popup",fY=({content:t,position:e,children:s,isOpen:n=!0,closeButton:i,onClose:r=uY,placement:o="top",popupClass:a=gY,closeButtonClass:l=hY,contentClass:u=dY,popupBodyClass:h=cY,size:g,closeOnEsc:f=!0},m)=>{const y=rn(),[p,x]=Yt.useState(null);if(Yt.useImperativeHandle(m,()=>p,[p]),Yt.useEffect(()=>{let b=null,S=null,A=null;if(n){const w=Sf(e,y)||y_;if(b=y.layers.addOverlay({position:w||y_,element:`<div class="${jA(a,o)}"/>
          <div class="${h}">
            ${rY(i,l)}
            <div class="${u} "></div>
          </div>
        </div>`,size:g||{width:"auto",height:"auto"},scaled:!1}),A=L=>{const k=b==null?void 0:b.element.querySelector(`.${l}`);L.target&&k.contains(L.target)&&(L.stopPropagation(),L.preventDefault(),r())},S=({code:L})=>{L===27&&r()},f&&y.events.on("keyup",S),b.element.addEventListener("click",A),x(b),t&&!s){const L=b.element.querySelector(`.${u}`),k=iY(y,w,t,s);L&&(L.innerHTML=k)}x(b)}return()=>{b&&(A&&b.element.removeEventListener("click",A),S&&y.events.off(S),b.destroy(),x(null))}},[n,y]),Yt.useEffect(()=>{if(p&&p.element){const b=Sf(e,y)||y_;if(p.setPosition(b),p.element.className=jA(a,o),t&&!s){const S=p.element.querySelector(`.${u}`);S&&(S.innerHTML=typeof t=="string"?t:"")}n?p.show():p.hide()}},[p,e,n,o,a,t,s]),!p||!n)return null;const v=p.element.querySelector(`.${u}`);return v&&s?ih.createPortal(s,v):null};Yt.forwardRef(fY);const mY={x:-9999,y:-9999},pY=({eventName:t,position:e,children:s,placement:n="top",bodyClass:i="ogma-tooltip--body",translate:r={x:0,y:0},size:o},a)=>{const l=rn(),[u,h]=Yt.useState(),[g,f]=Yt.useState(null);Yt.useImperativeHandle(a,()=>g,[g]);function m(p,x){if(!e){const v=lY(p,l.view.getZoom(),n),b={x:x.x+v.x,y:x.y+v.y};g==null||g.setPosition(b)}g==null||g.show()}function y(){g==null||g.hide(),h(void 0)}if(Yt.useEffect(()=>{let p=`translate(${r.x}px, calc(-50% + ${r.y}px))`;n==="top"?p=`translate(calc(-50% + ${r.x}px), calc(-100% + ${r.y}px))`:n==="bottom"?p=`translate(calc(-50% + ${r.x}px), ${r.y}px)`:n==="left"&&(p=`translate(calc(-100% + ${r.x}px), calc(-50% + ${r.y}px))`);const x=l.layers.addOverlay({position:e||mY,element:`
      <div>
        <div class="${i}" style="transform: ${p}">
        </div>
      </div>`,size:o||{width:"auto",height:"auto"},scaled:!1});f(x)},[]),Yt.useEffect(()=>{if(!g)return;let p=()=>null,x=()=>null;const v=oY(t);return v==="mouseover"?(p=b=>{var S;if(t.startsWith("node")){if((S=b.target)!=null&&S.isNode){const A=b.target;h(A),m(A,A.getPosition())}}else if(t.startsWith("edge")&&b.target&&!b.target.isNode){const A=l.view.screenToGraphCoordinates({x:b.x,y:b.y});h(b.target),m(b.target,A)}},x=b=>{var S;(t.startsWith("node")&&(S=b.target)!=null&&S.isNode||t.startsWith("edge")&&b.target&&!b.target.isNode)&&y()},l.events.on("mouseout",x)):(p=b=>{var S;if(!(t.endsWith("Rightclick")&&b.button==="left")){if(t.startsWith("background")){if(!b.target){const A=l.view.screenToGraphCoordinates({x:b.x,y:b.y});h(A),m("background",A)}}else if(t.startsWith("node")){if((S=b.target)!=null&&S.isNode){const A=b.target;h(A),m(A,A.getPosition())}}else if(b.target&&!b.target.isNode){const A=l.view.screenToGraphCoordinates({x:b.x,y:b.y});h(b.target),m(b.target,A)}}},x=b=>{var S;t.startsWith("node")?(S=b.target)!=null&&S.isNode||y():t.startsWith("edge")?(!b.target||b.target.isNode)&&y():t.startsWith("background")&&(b.target||t.endsWith("Rightclick")&&b.button==="left"||t.endsWith("Click")&&b.button==="right")&&y()},l.events.on("click",x)),g.hide(),l.events.on(v,p),()=>{l.events.off(p),l.events.off(x),g&&(g.destroy(),f(null))}},[g]),Yt.useEffect(()=>{!g||!g.element||(e&&g.setPosition(e),(n||i)&&(g.element.firstElementChild.className="ogma-popup--body "+i),o&&g.setSize(o))},[e,n,o,i]),!g||!g.element)return null;if(s instanceof Function){if(!u)return null;const p=s(u);return p===null?(g.hide(),null):ih.createPortal(p,g.element.firstElementChild)}else return s?ih.createPortal(s,g.element.firstElementChild):null};Yt.forwardRef(pY);const _Y=({noClear:t=!1,isStatic:e=!1,render:s,index:n,visible:i=!0},r)=>{const o=rn(),[a,l]=Yt.useState(null);return Yt.useImperativeHandle(r,()=>a,[a]),Yt.useEffect(()=>{const u=o.layers.addCanvasLayer(s,{isStatic:e,noClear:t},n);return l(u),()=>{u&&(u.destroy(),l(null))}},[]),Yt.useEffect(()=>{a&&(n!==void 0&&isFinite(n)&&a.moveTo(n),i?a.show():a.hide())},[a,n,i]),null};Yt.forwardRef(_Y);const x_={x:-9999,y:-9999};Yt.forwardRef(({position:t,children:e,className:s="",size:n,scaled:i,index:r},o)=>{const a=rn(),[l,u]=Yt.useState(null);return Yt.useImperativeHandle(o,()=>l,[l]),Yt.useEffect(()=>{const h=Sf(t,a)||x_,g=document.createElement("div");g.className=s;const f=a.layers.addOverlay({position:h||x_,element:g,size:n||{width:"auto",height:"auto"},scaled:i},r);return u(f),()=>{l&&(l.destroy(),u(null))}},[]),Yt.useEffect(()=>{if(l){const h=Sf(t,a)||x_;s&&(l.element.className=s),r!==void 0&&isFinite(r)&&l.moveTo(r),l.setPosition(h)}},[t,s,r]),l?ih.createPortal(e,l.element):null});const Tg=Yt.forwardRef(({children:t,className:e="",index:s},n)=>{const i=rn(),[r,o]=Yt.useState(null);return Yt.useImperativeHandle(n,()=>r,[r]),Yt.useEffect(()=>{const a=document.createElement("div");a.className=e;const l=i.layers.addLayer(a,s);return o(l),()=>{r&&(r.destroy(),o(null))}},[]),Yt.useEffect(()=>{r&&(e&&(r.element.className=e),s!==void 0&&isFinite(s)&&r.moveTo(s))},[e,s]),r?ih.createPortal(t,r.element):null});function yY(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var $A={exports:{}},qA;function xY(){return qA||(qA=1,(function(t){var e=Object.prototype.hasOwnProperty,s="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(s=!1));function i(l,u,h){this.fn=l,this.context=u,this.once=h||!1}function r(l,u,h,g,f){if(typeof h!="function")throw new TypeError("The listener must be a function");var m=new i(h,g||l,f),y=s?s+u:u;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],m]:l._events[y].push(m):(l._events[y]=m,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,h;if(this._eventsCount===0)return l;for(h in u=this._events)e.call(u,h)&&l.push(s?h.slice(1):h);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=s?s+l:l,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var g=0,f=h.length,m=new Array(f);g<f;g++)m[g]=h[g].fn;return m},a.prototype.listenerCount=function(l){var u=s?s+l:l,h=this._events[u];return h?h.fn?1:h.length:0},a.prototype.emit=function(l,u,h,g,f,m){var y=s?s+l:l;if(!this._events[y])return!1;var p=this._events[y],x=arguments.length,v,b;if(p.fn){switch(p.once&&this.removeListener(l,p.fn,void 0,!0),x){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,u),!0;case 3:return p.fn.call(p.context,u,h),!0;case 4:return p.fn.call(p.context,u,h,g),!0;case 5:return p.fn.call(p.context,u,h,g,f),!0;case 6:return p.fn.call(p.context,u,h,g,f,m),!0}for(b=1,v=new Array(x-1);b<x;b++)v[b-1]=arguments[b];p.fn.apply(p.context,v)}else{var S=p.length,A;for(b=0;b<S;b++)switch(p[b].once&&this.removeListener(l,p[b].fn,void 0,!0),x){case 1:p[b].fn.call(p[b].context);break;case 2:p[b].fn.call(p[b].context,u);break;case 3:p[b].fn.call(p[b].context,u,h);break;case 4:p[b].fn.call(p[b].context,u,h,g);break;default:if(!v)for(A=1,v=new Array(x-1);A<x;A++)v[A-1]=arguments[A];p[b].fn.apply(p[b].context,v)}}return!0},a.prototype.on=function(l,u,h){return r(this,l,u,h,!1)},a.prototype.once=function(l,u,h){return r(this,l,u,h,!0)},a.prototype.removeListener=function(l,u,h,g){var f=s?s+l:l;if(!this._events[f])return this;if(!u)return o(this,f),this;var m=this._events[f];if(m.fn)m.fn===u&&(!g||m.once)&&(!h||m.context===h)&&o(this,f);else{for(var y=0,p=[],x=m.length;y<x;y++)(m[y].fn!==u||g&&!m[y].once||h&&m[y].context!==h)&&p.push(m[y]);p.length?this._events[f]=p.length===1?p[0]:p:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=s?s+l:l,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=s,a.EventEmitter=a,t.exports=a})($A)),$A.exports}var vY=xY();const bY=yY(vY),tm="dragging",tx="dragstart",EY="dragend",_M="select",yM="unselect",xM="remove",Vg="add",ex="cancelDrawing",Af="completeDrawing",vM="update",SY="link",bM="history",EM=5,AY=3,E0={SHAPES:1,EDITOR:2,HANDLES:3},Ui="start",ba="end",sn={default:"default",move:"move",pointer:"pointer",crosshair:"crosshair",grab:"grab",grabbing:"grabbing",ewResize:"ew-resize",nsResize:"ns-resize",nwResize:"nw-resize",neResize:"ne-resize",swResize:"sw-resize",seResize:"se-resize"},rh="collapsed",SM="expanded",AM=1.2,wY=.2,fn={TEXT:"text",NODE:"node",COMMENT:"comment",POLYGON:"polygon"},wM=`<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>`;let Ya=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,s)=>(s&=63,s<36?e+=s.toString(36):s<62?e+=(s-26).toString(36).toUpperCase():s>62?e+="-":e+="_",e),"");const Gn=(t,e)=>({x:t.x-e.x,y:t.y-e.y}),Er=t=>Math.sqrt(t.x*t.x+t.y*t.y),TM=t=>({x:-t.x,y:-t.y}),sx=t=>{const e=Er(t);return e===0?{x:0,y:0}:{x:t.x/e,y:t.y/e}},oh=(t,e)=>({x:t.x+e.x,y:t.y+e.y}),Ma=(t,e)=>({x:t.x*e,y:t.y*e}),YA=(t,e)=>{const s=Math.sin(e),n=Math.cos(e);return{x:t.x*n-t.y*s,y:t.x*s+t.y*n}},Zl=(t,e)=>t.x*e.x+t.y*e.y,TY=(t,e)=>t.x*e.y-t.y*e.x,wi=t=>t.properties.type==="arrow";function CM(t,e,s){const{start:n,end:i}=S0(t),r=Gn(e,n),o=t.properties.style.strokeWidth,a=Gn(i,n),l=Er(a),u=Zl(r,sx(a));return u>0&&u<l&&Math.abs(TY(r,sx(a)))<o/2+s}const ah={strokeType:"plain",strokeColor:"#202020",strokeWidth:1,head:"none",tail:"none"};({...ah});const nx=(t=0,e=0,s=0,n=0,i={...ah})=>({id:Ya(),type:"Feature",properties:{type:"arrow",style:{...ah,...i}},geometry:{type:"LineString",coordinates:[[t,e],[s,n]]}}),Ti=t=>t.properties.type==="box";function CY(t,e,s=0,n=1,i=0){const r=tu(t),{width:o,height:a}=qn(t),l=e.x-r.x,u=e.y-r.y,h=l*n-u*s,g=l*s+u*n;return h>-i&&h<o+i&&g>-i&&g<a+i}const lh={background:"#f5f5f5",strokeWidth:0,borderRadius:8,padding:16,strokeType:"plain"};({...lh});const WA=(t=0,e=0,s=100,n=50,i={...lh})=>({id:Ya(),type:"Feature",properties:{type:"box",width:s,height:n,style:{...lh,...i}},geometry:{type:"Point",coordinates:[t+s/2,e+n/2]}}),mn=t=>t.properties.type==="text",jn={font:"sans-serif",fontSize:18,color:"#505050",background:"#f5f5f5",strokeWidth:0,borderRadius:8,padding:16,strokeType:"plain",fixedSize:!1};Ya(),{...jn};const XA=(t=0,e=0,s=100,n=50,i="",r={...jn})=>({id:Ya(),type:"Feature",properties:{type:"text",content:i,width:s,height:n,style:{...jn,...r}},geometry:{type:"Point",coordinates:[t+s/2,e+n/2],bbox:[t,e,t+s,e+n]}});function LM(t,e,s=0,n=0,i=1,r=1){var x;const[o,a]=t.geometry.coordinates;let{width:l,height:u}=qn(t);(x=t.properties.style)!=null&&x.fixedSize&&(l/=r,u/=r);const h=l/2,g=u/2,f=e.x-o,m=e.y-a,y=f*i-m*n,p=f*n+m*i;return y>-h-s&&y<h+s&&p>-g-s&&p<g+s}const kn=t=>t.properties.type==="comment",Ea={background:"#FFFACD",padding:8,borderRadius:4,strokeColor:"#DDD",strokeWidth:1,strokeType:"plain",iconColor:"#FFCB2F",iconSymbol:"",iconBorderColor:"#aaa",iconBorderWidth:2,minHeight:60,iconSize:32,color:"#333",font:"Arial, sans-serif",fontSize:12,showSendButton:!0,autoGrow:!0,fixedSize:!0},v_={mode:"expanded",width:200,height:60};function LY(t,e,s,n){const i={type:"comment",content:s,mode:(n==null?void 0:n.mode)??v_.mode,width:(n==null?void 0:n.width)??v_.width,height:(n==null?void 0:n.height)??v_.height,author:n==null?void 0:n.author,timestamp:n==null?void 0:n.timestamp,style:{...Ea,...n==null?void 0:n.style}};return{id:Ya(),type:"Feature",properties:i,geometry:{type:"Point",coordinates:[t,e]}}}function NY(t,e,s=0,n,i,r=1){if(t.properties.mode!==rh)return LM(t,e,s,n,i,r);const o=t.properties,a={...Ea,...o.style};let l=a.iconSize,u=a.iconSize;a.fixedSize&&(l/=r,u/=r);const h=l/2,g=u/2,f=e.x-t.geometry.coordinates[0],m=e.y-t.geometry.coordinates[1];return f>=-h-s&&f<=h+s&&m>=-g-s&&m<=g+s}const za=t=>t.properties.type==="polygon";function NM(t,e,s=0){const n=t.geometry.coordinates[0],i=t.geometry.bbox;if(i){const[o,a,l,u]=i;if(e.x<o-s||e.x>l+s||e.y<a-s||e.y>u+s)return!1}let r=!1;for(let o=0,a=n.length-1;o<n.length;a=o++){const l=n[o][0],u=n[o][1],h=n[a][0],g=n[a][1];u>e.y!=g>e.y&&e.x<(h-l)*(e.y-u)/(g-u)+l&&(r=!r)}if(r)return!0;if(s>0)for(let o=0;o<n.length-1;o++){const[a,l]=n[o],[u,h]=n[o+1];if(MY(e,{x:a,y:l},{x:u,y:h})<=s)return!0}return!1}function MY(t,e,s){const n=s.x-e.x,i=s.y-e.y,r=n*n+i*i;if(r===0){const g=t.x-e.x,f=t.y-e.y;return Math.sqrt(g*g+f*f)}let o=((t.x-e.x)*n+(t.y-e.y)*i)/r;o=Math.max(0,Math.min(1,o));const a=e.x+o*n,l=e.y+o*i,u=t.x-a,h=t.y-l;return Math.sqrt(u*u+h*h)}function IY(t,e){const s=t[0];s.length>0&&(s[0][0]!==s[s.length-1][0]||s[0][1]!==s[s.length-1][1])&&s.push([s[0][0],s[0][1]]);let n=1/0,i=1/0,r=-1/0,o=-1/0;for(const[g,f]of s)g<n&&(n=g),g>r&&(r=g),f<i&&(i=f),f>o&&(o=f);const a=[n,i,r,o],{id:l,style:u,...h}=e||{};return{type:"Feature",id:l||Ya(),geometry:{type:"Polygon",coordinates:t,bbox:a},properties:{type:"polygon",style:{...Sa,...u},...h}}}const Sa={...lh,strokeColor:"#000000",strokeWidth:2,background:"transparent"};({...Sa});const ZA=t=>t.type==="FeatureCollection";function kY(t,e){const s=t[0]-e[0],n=t[1]-e[1];return s*s+n*n}function RY(t,e,s){let n=e[0],i=e[1],r=s[0]-n,o=s[1]-i;if(r!==0||o!==0){const a=((t[0]-n)*r+(t[1]-i)*o)/(r*r+o*o);a>1?(n=s[0],i=s[1]):a>0&&(n+=r*a,i+=o*a)}return r=t[0]-n,o=t[1]-i,r*r+o*o}function FY(t,e){let s=t[0];const n=[s];let i;for(let r=1,o=t.length;r<o;r++)i=t[r],kY(i,s)>e&&(n.push(i),s=i);return s!==i&&n.push(i),n}function ix(t,e,s,n,i){let r=n,o=0;for(let a=e+1;a<s;a++){const l=RY(t[a],t[e],t[s]);l>r&&(o=a,r=l)}r>n&&(o-e>1&&ix(t,e,o,n,i),i.push(t[o]),s-o>1&&ix(t,o,s,n,i))}function PY(t,e){const s=t.length-1,n=[t[0]];return ix(t,0,s,e,n),n.push(t[s]),n}function KA(t,e,s){if(t.length<=2)return t;const n=e!==void 0?e*e:1;return t=s?t:FY(t,n),t=PY(t,n),t}function QA(t){if(t.geometry.bbox)return t.geometry.bbox;const e=t.geometry.coordinates[0];let s=1/0,n=1/0,i=-1/0,r=-1/0;for(const[o,a]of e)o<s&&(s=o),o>i&&(i=o),a<n&&(n=a),a>r&&(r=a);return[s,n,i,r]}function zY(t){const e=t.geometry.coordinates[0];let s=0,n=0;const i=e.length-1;for(let r=0;r<i;r++)s+=e[r][0],n+=e[r][1];return{x:s/i,y:n/i}}function DY(t,e,s){const n=t.geometry.coordinates.map(o=>o.map(([a,l])=>[a+e,l+s])),i=t.geometry.bbox,r=i?[i[0]+e,i[1]+s,i[2]+e,i[3]+s]:void 0;return{...t,geometry:{...t.geometry,coordinates:n,bbox:r}}}function OY(t){const e=t.geometry.coordinates[0];let s=1/0,n=1/0,i=-1/0,r=-1/0;for(const[o,a]of e)o<s&&(s=o),o>i&&(i=o),a<n&&(n=a),a>r&&(r=a);t.geometry.bbox=[s,n,i,r]}const BY="http://www.w3.org/2000/svg";function As(t){return document.createElementNS(BY,t)}function qr(t){return t.geometry.bbox||em(t),t.geometry.bbox}function qn(t){if("width"in t.properties&&"height"in t.properties)return{width:t.properties.width,height:t.properties.height};const e=qr(t);return{width:e[2]-e[0],height:e[3]-e[1]}}function tu(t,e=!1,s=1){if(t.geometry.type==="Point"&&"width"in t.properties&&"height"in t.properties){const[i,r]=t.geometry.coordinates;let o=t.properties.width,a=t.properties.height;return e&&(o/=s,a/=s),{x:i-o/2,y:r-a/2}}const n=qr(t);return{x:n[0],y:n[1]}}function Ei(t){if(t.geometry.type==="Point")return{x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};const e=qr(t);return{x:(e[0]+e[2])/2,y:(e[1]+e[3])/2}}function em(t){if(wi(t)){const[e,s]=t.geometry.coordinates[0],[n,i]=t.geometry.coordinates[1];t.geometry.bbox=[Math.min(e,n),Math.min(s,i),Math.max(e,n),Math.max(s,i)]}else if(t.geometry.type==="Point"&&"width"in t.properties&&"height"in t.properties){const[e,s]=t.geometry.coordinates,n=t.properties.width/2,i=t.properties.height/2;t.geometry.bbox=[e-n,s-i,e+n,s+i]}else if(t.geometry.type==="Polygon"){const e=t.geometry.coordinates[0];let s=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY;for(const o of e){const a=o[0],l=o[1];a<s&&(s=a),l<n&&(n=l),a>i&&(i=a),l>r&&(r=l)}t.geometry.bbox=[s,n,i,r]}}function MM(t){const[e,s]=t.geometry.coordinates[0];return{x:e,y:s}}function b_(t,e){const[s,n]=t.geometry.coordinates[e===Ui?0:1];return{x:s,y:n}}function IM(t){const[e,s]=t.geometry.coordinates[1];return{x:e,y:s}}function S0(t){return{start:MM(t),end:IM(t)}}function kM(t){return jg(t).reduce((e,s)=>(e[0]=Math.min(s[0],e[0]),e[1]=Math.min(s[1],e[1]),e[2]=Math.max(s[0],e[2]),e[3]=Math.max(s[1],e[3]),e),[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY])}function jg(t){let e=[];if(t.type=="Point")t.bbox?e=[[t.bbox[0],t.bbox[1]],[t.bbox[2],t.bbox[3]]]:e=[t.coordinates];else if(t.type=="LineString"||t.type=="MultiPoint")e=t.coordinates;else if(t.type=="Polygon"||t.type=="MultiLineString")e=t.coordinates.reduce(function(s,n){return s.concat(n)},[]);else if(t.type=="MultiPolygon")e=t.coordinates.reduce((s,n)=>s.concat(n.reduce((i,r)=>i.concat(r),[])),[]);else if(t.type=="Feature")if(mn(t)||Ti(t)){const s=qr(t);e=[[s[0],s[1]],[s[2],s[3]]]}else e=jg(t.geometry);else t.type=="GeometryCollection"?e=t.geometries.reduce((s,n)=>s.concat(jg(n)),[]):t.type=="FeatureCollection"&&(e=t.features.reduce((s,n)=>s.concat(jg(n)),[]));return e}function rx(t,e){if(!e)return{x:t.clientX,y:t.clientY};const s=e.getBoundingClientRect();return{x:t.clientX-s.left-e.clientLeft,y:t.clientY-s.top-e.clientTop}}function UY(t){return t.length===4?t.split("").map(e=>e+e).join(""):t}function JA(){return typeof window<"u"?window:void 0}function GY(t){if((Ti(t)||mn(t))&&t.geometry.type==="Polygon"){const e=t.geometry.coordinates[0],s=e[0][0],n=e[0][1],i=e[2][0],r=e[2][1],o=i-s,a=r-n,l=s+o/2,u=n+a/2;return{...t,geometry:{type:"Point",coordinates:[l,u],bbox:[s,n,i,r]},properties:{...t.properties,width:o,height:a}}}return t}function VY(t,e){let s,n,i,r=1;const o=t.trim();if(o.startsWith("#")){const u=(o.length===4?UY(o):o).match(/#?(\w{2})(\w{2})(\w{2})/);if(!u)return t;s=parseInt(u[1],16),n=parseInt(u[2],16),i=parseInt(u[3],16)}else{const u=o.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([0-9.]+))?\)/);if(!u)return t;s=parseInt(u[1]),n=parseInt(u[2]),i=parseInt(u[3]),r=u[4]!==void 0?parseFloat(u[4]):1}const a=e*100,l=.299*s+.587*n+.114*i>186?-a/2:a;return s=Math.max(0,Math.min(255,s+Math.round(2.55*l))),n=Math.max(0,Math.min(255,n+Math.round(2.55*l))),i=Math.max(0,Math.min(255,i+Math.round(2.55*l))),`rgba(${s},${n},${i},${r})`}const sm=t=>VY(t,wY);class nm extends EventTarget{constructor(s,n){super();Qt(this,"annotation",null);Qt(this,"ogma");Qt(this,"dragging",!1);Qt(this,"dragStartPoint");Qt(this,"hoveredHandle");Qt(this,"ogmaPanningOption",!1);Qt(this,"store");Qt(this,"draggingWasEnabled",!0);Qt(this,"handleMouseMove",s=>{if(!this.isActive())return;const n=this.store.getState();if(!this.dragging&&n.mousePressed&&n.mousePressPoint&&(this.detectHandle(s,this.ogma.view.getZoom()),this.hoveredHandle)){this.dragStartPoint=n.mousePressPoint,this.onDragStart(s),this.dispatchEvent(new Event(tx)),this.disablePanning();return}this.dragging?this.dragStartPoint&&this.onDrag(s):this.detectHandle(s,this.ogma.view.getZoom())});Qt(this,"handleMouseDown",s=>{!this.isActive()||this.dragging||!this.hoveredHandle||(s.preventDefault(),s.stopPropagation(),this.dragStartPoint=this.clientToCanvas(s),this.onDragStart(s),this.dispatchEvent(new Event(tx)),this.disablePanning())});Qt(this,"disablePanning",()=>{var s,n;this.ogmaPanningOption=!!((n=(s=this.ogma.getOptions().interactions)==null?void 0:s.pan)!=null&&n.enabled),this.ogma.setOptions({interactions:{pan:{enabled:!1},drag:{enabled:!1}}})});Qt(this,"restorePanning",()=>{this.ogma.setOptions({interactions:{pan:{enabled:!0},drag:{enabled:!0}}})});Qt(this,"handleMouseUp",s=>{!this.isActive()||!this.dragging||(this.restorePanning(),this.onDragEnd(s),this.dispatchEvent(new Event(EY)))});this.store=n,this.ogma=s,this.store.subscribe(i=>i.features,i=>{this.isActive()&&!i[this.annotation]&&this.stopEditing()})}cancelEdit(){!this.isActive()||this.annotation===null||this.clearDragState()}clearDragState(){this.dragging=!1,this.dragStartPoint=void 0,this.hoveredHandle=void 0,this.restorePanning(),this.setCursor(sn.default)}commitChange(){this.store.getState().commitLiveUpdates()}onDrag(s){this.dispatchEvent(new Event(tm))}onDragStart(s){return this.isActive()?(this.dragging=!0,this.dragStartPoint=this.clientToCanvas(s),this.disablePanning(),!0):!1}onDragEnd(s){return this.isActive()?(this.restorePanning(),this.dragging=!1,!0):!1}clientToCanvas(s){const n=this.ogma,i=rx(s,n.getContainer());return n.view.screenToGraphCoordinates(i)}setAnnotation(s){if(this.annotation=s?s.id:null,this.annotation!==null){const n=this.ogma.getContainer();if(n){const o=JA()||n;o.addEventListener("mousemove",this.handleMouseMove),o.addEventListener("mouseup",this.handleMouseUp,!1),n.addEventListener("mousedown",this.handleMouseDown,!0)}const{x:i,y:r}=this.ogma.getPointerInformation();this.handleMouseMove({clientX:i,clientY:r})}else{const n=this.ogma.getContainer();if(n){const i=JA()||n;i.removeEventListener("mousemove",this.handleMouseMove),i.removeEventListener("mouseup",this.handleMouseUp),n.removeEventListener("mousedown",this.handleMouseDown)}this.clearDragState(),this.setCursor(sn.default)}}getAnnotation(){return this.store.getState().getFeature(this.annotation)}setCursor(s){var i;const n=(i=this.ogma.getContainer())==null?void 0:i.firstChild;n&&(n.style.cursor=s)}stopEditing(){this.isActive()&&this.setAnnotation(null)}cancelDrawing(){if(!this.isActive())return;const s=this.store.getState();s.drawingFeature===this.annotation&&s.removeFeature(this.annotation),this.stopEditing()}isActive(){return this.annotation!==null}}function jY(t){var s,n;const e=t.properties.link;return e?((s=e.start)==null?void 0:s.type)===fn.COMMENT||((n=e.end)==null?void 0:n.type)===fn.COMMENT:!1}function HY(t){var e,s;return((s=(e=t.properties.link)==null?void 0:e.start)==null?void 0:s.type)!==fn.COMMENT}class $Y extends nm{constructor(s,n,i,r){super(s,n);Qt(this,"snapping");Qt(this,"links");Qt(this,"snap",null);this.snapping=i,this.links=r}detectHandle(s){const n=this.getAnnotation(),i=this.clientToCanvas(s),r=EM,o=n.geometry.coordinates[0],a=n.geometry.coordinates[1],l=Math.sqrt(Math.pow(i.x-o[0],2)+Math.pow(i.y-o[1],2)),u=Math.sqrt(Math.pow(i.x-a[0],2)+Math.pow(i.y-a[1],2));l<r?this.grabHandle("start",o[0],o[1]):u<r?this.grabHandle("end",a[0],a[1]):CM(n,i,r)?(this.setCursor(sn.grab),this.hoveredHandle={type:"body",point:i},this.store.setState({hoveredHandle:2})):(this.store.setState({hoveredHandle:-1}),this.hoveredHandle=void 0)}grabHandle(s,n,i){this.hoveredHandle={type:s,point:{x:n,y:i}},this.store.setState({hoveredHandle:s==="start"?0:1}),this.setCursor(sn.move)}onDrag(s){var u;if(!(this.dragStartPoint||!this.hoveredHandle)||!this.isActive())return;s.stopPropagation(),s.stopImmediatePropagation();const n=this.clientToCanvas(s),i=this.hoveredHandle,r=this.getAnnotation();this.snap=this.snapping.snap(n);const o=((u=this.snap)==null?void 0:u.point)||n,a=r.properties.link||{},l=[...r.geometry.coordinates];if(i.type==="start")l[0]=[o.x,o.y],this.snap&&(a.start={side:i.type,id:this.snap.id,type:this.snap.type,magnet:this.snap.magnet});else if(i.type==="end")l[1]=[o.x,o.y],this.snap&&(a.end={side:i.type,id:this.snap.id,type:this.snap.type,magnet:this.snap.magnet});else if(i.type==="body"){const h=o.x-i.point.x,g=o.y-i.point.y,f=r.geometry.coordinates[0],m=r.geometry.coordinates[1];l[0]=[f[0]+h,f[1]+g],l[1]=[m[0]+h,m[1]+g]}this.store.getState().applyLiveUpdate(r.id,{id:r.id,properties:{...r.properties,link:a},geometry:{type:r.geometry.type,coordinates:l}}),this.dispatchEvent(new CustomEvent(tm,{detail:{point:o,annotation:this.annotation,handle:i}}))}onDragStart(s){if(!super.onDragStart(s))return!1;const n=this.getAnnotation(),i=this.hoveredHandle;return i.type==="end"&&!1||i.type==="start"&&!HY(n)?(this.clearDragState(),!1):(this.store.getState().startLiveUpdate([this.annotation]),!0)}onDragEnd(s){if(!super.onDragEnd(s))return!1;if(this.snap&&this.hoveredHandle){const n=this.hoveredHandle;n.type!=="body"&&this.links.add(this.getAnnotation(),n.type,this.snap.id,this.snap.type,this.snap.magnet)}else if(this.snap===null&&this.hoveredHandle){const n=this.getAnnotation(),i=this.hoveredHandle.type;n.properties.link&&n.properties.link[i]&&(this.links.remove(n,i),this.store.getState().applyLiveUpdate(n.id,{properties:{...n.properties,link:{[i]:void 0}}}))}return this.store.getState().drawingFeature===this.annotation&&this.store.setState({drawingFeature:null}),this.commitChange(),this.clearDragState(),this.snap=null,!0}snapDrawingStart(s,n,i){const r=this.snapping.snap({x:n,y:i});r&&(s.geometry.coordinates[0]=[r.point.x,r.point.y],s.properties.link={start:{side:Ui,id:r.id,type:r.type,magnet:r.magnet}},this.links.add(s,"start",r.id,r.type,r.magnet))}startDrawing(s,n,i){this.annotation=s;const r=this.getAnnotation();this.snapDrawingStart(r,n,i);const{x:o,y:a}=this.clientToCanvas({clientX:n,clientY:i});this.grabHandle("end",o,a),this.dragging=!0,this.dragStartPoint={x:o,y:a},this.onDragStart({clientX:n,clientY:i})}}class qY extends nm{constructor(s,n,i){super(s,n);Qt(this,"links");Qt(this,"isDrawingMode",!1);Qt(this,"simplificationTolerance",5);Qt(this,"handleMouseDown",s=>{!this.isActive()||this.dragging||!this.hoveredHandle||(s.preventDefault(),s.stopPropagation(),this.dragStartPoint=this.clientToCanvas(s),this.onDragStart(s),this.dispatchEvent(new Event(tx)),this.disablePanning())});this.links=i}startDrawing(s,n,i){this.annotation=s,this.isDrawingMode=!0;const r=this.store.getState();r.startLiveUpdate([s]),r.setDrawingPoints([]);const o=this.ogma.view.graphToScreenCoordinates({x:n,y:i});return this.dragStartPoint=o,this.disablePanning(),this.onDragStart({clientX:o.x,clientY:o.y}),this}cancelDrawing(){this.isDrawingMode&&(this.isDrawingMode=!1,this.annotation&&(this.store.getState().removeFeature(this.annotation),this.annotation=null)),this.restorePanning()}detectHandle(s,n=1){const i=this.getAnnotation();if(!i)return;const r=this.clientToCanvas(s),o=EM/n,a=i.geometry.coordinates[0];for(let l=0;l<a.length-1;l++){const[u,h]=a[l];if(Math.sqrt(Math.pow(r.x-u,2)+Math.pow(r.y-h,2))<o*2){this.grabHandle("vertex",u,h,l);return}}NM(i,r,o)?(this.setCursor(sn.grab),this.hoveredHandle={type:"body",point:r},this.store.setState({hoveredHandle:-1})):(this.store.setState({hoveredHandle:-1}),this.hoveredHandle=void 0)}grabHandle(s,n,i,r){this.setCursor(s==="vertex"?sn.pointer:sn.grab),this.hoveredHandle={type:s,point:{x:n,y:i},vertexIndex:r},this.store.setState({hoveredHandle:r??0})}onDragStart(s){if(this.isDrawingMode){const n=this.clientToCanvas(s);this.dragging=!0;const i=this.getAnnotation();if(i){const r=[[n.x,n.y],[n.x,n.y]],o=this.store.getState();o.setDrawingPoints(r),o.applyLiveUpdate(i.id,{...i,geometry:{type:"Polygon",coordinates:[r],bbox:[n.x,n.y,n.x,n.y]}})}return this.dragStartPoint=n,!0}return this.hoveredHandle?(this.dragging=!0,this.setCursor(sn.grabbing),this.store.getState().startLiveUpdate([this.annotation]),!0):!1}onDrag(s){if(this.isDrawingMode&&this.dragging){const a=this.clientToCanvas(s),l=this.store.getState(),u=this.getAnnotation();if(!u)return;const h=l.liveUpdates[this.annotation],g=h?{...u,...h}:u,f=l.drawingPoints.slice(0,-1),m=[...f,[a.x,a.y],f[0]];l.setDrawingPoints(m);const y=KA(m,this.simplificationTolerance,!1),p=[...y,y[0]];l.applyLiveUpdate(this.annotation,{...g,geometry:{type:"Polygon",coordinates:[p]}});return}if(!this.dragging||!this.dragStartPoint||!this.hoveredHandle)return;const n=this.clientToCanvas(s),i=n.x-this.dragStartPoint.x,r=n.y-this.dragStartPoint.y,o=this.getAnnotation();if(o){if(this.hoveredHandle.type==="body"){const a=DY(o,i,r);this.store.getState().applyLiveUpdate(o.id,a),this.links.updateLinkedArrowsDuringDrag(o.id,{x:i,y:r})}else if(this.hoveredHandle.type==="vertex"&&this.hoveredHandle.vertexIndex!==void 0){const a=o.geometry.coordinates[0].map((u,h)=>h===this.hoveredHandle.vertexIndex?[this.hoveredHandle.point.x+i,this.hoveredHandle.point.y+r]:h===o.geometry.coordinates[0].length-1&&this.hoveredHandle.vertexIndex===0?[this.hoveredHandle.point.x+i,this.hoveredHandle.point.y+r]:u),l={...o,geometry:{...o.geometry,coordinates:[a]}};OY(l),this.store.getState().applyLiveUpdate(o.id,l)}this.dispatchEvent(new Event(tm))}}onDragEnd(){if(this.isDrawingMode&&this.dragging){const s=this.store.getState(),n=this.getAnnotation();if(n){const i=s.drawingPoints;if(i.length<3)this.cancelDrawing();else{const r=KA(i.slice(1,-1),this.simplificationTolerance,!0),o={...n,geometry:{type:"Polygon",coordinates:[r]}};em(o),this.store.getState().applyLiveUpdate(n.id,o),this.store.setState({drawingFeature:null}),this.commitChange(),this.isDrawingMode=!1,this.dragging=!1,this.restorePanning(),this.dispatchEvent(new CustomEvent(Af,{detail:o}))}}return!0}return!this.dragging||(this.dragging=!1,this.dragStartPoint=void 0,!this.getAnnotation())?!1:(this.commitChange(),this.setCursor(sn.grab),!0)}getAnnotation(){if(this.annotation)return this.store.getState().getFeature(this.annotation)}}const tw=[{x:-.5,y:-.5},{x:0,y:-.5},{x:.5,y:-.5},{x:-.5,y:0},{x:.5,y:0},{x:-.5,y:.5},{x:0,y:.5},{x:.5,y:.5}],YY=[[-.5,-.5,.5,-.5],[.5,-.5,.5,.5],[.5,.5,-.5,.5],[-.5,.5,-.5,-.5]];function ew(t,e,s,n,i,r,o,a,l){const u=t*i,h=e*r;return l?{x:s+(u*o-h*a),y:n+(u*a+h*o)}:{x:s+u,y:n+h}}class WY extends EventTarget{constructor(s,n,i,r){super();Qt(this,"ogma");Qt(this,"options");Qt(this,"spatialIndex");Qt(this,"hoveredNode",null);Qt(this,"store");this.ogma=s,this.options=n,this.spatialIndex=i,this.store=r}snap(s){return this.findMagnet(s)||null}findMagnet(s){const n=this.options.detectMargin,i={minX:s.x-n,minY:s.y-n,maxX:s.x+n,maxY:s.y+n},r=this.spatialIndex.search(i),o=r.filter(f=>mn(f)||Ti(f)),a=r.filter(f=>za(f)),l=this.ogma.view.getElementsInside(i.minX,i.minY,i.maxX,i.maxY).nodes,u=this.snapToNodes(s,l);if(u)return u;const h=this.snapToText(s,o);return h||this.snapToPolygon(s,a)||null}snapToText(s,n){const{zoom:i}=this.store.getState();for(const r of n){const o=this.snapToMagnetPoints(s,r,i)||this.snapToEdge(s,r,i);if(o)return o}return null}snapToPolygon(s,n){const i=this.options.magnetRadius,r=.5;for(const o of n){const a=o.geometry.coordinates[0].slice(0,-1);if(a.length<3)return this.snapToPolygonStraightEdges(s,o,i);for(let g=0;g<a.length;g++){const[f,m]=a[g];if(Er(Gn({x:f,y:m},s))<i)return{point:{x:f,y:m},magnet:{x:f,y:m},type:fn.POLYGON,id:o.id}}const l=this.isPointInsidePolygon(s,a);let u=null,h=l?1/0:i;for(let g=0;g<a.length;g++){const f=a[(g-1+a.length)%a.length],m=a[g],y=a[(g+1)%a.length],p=a[(g+2)%a.length],x=m[0]+(y[0]-f[0])/6*r,v=m[1]+(y[1]-f[1])/6*r,b=y[0]-(p[0]-m[0])/6*r,S=y[1]-(p[1]-m[1])/6*r,A=this.findClosestPointOnBezierCurve(s,{x:m[0],y:m[1]},{x,y:v},{x:b,y:S},{x:y[0],y:y[1]});if(A){const w=A.distance;if(l)w<h&&(h=w,u=A.point);else if(w<i)return{point:A.point,magnet:A.point,type:fn.POLYGON,id:o.id}}}if(l&&u)return{point:u,magnet:u,type:fn.POLYGON,id:o.id}}return null}isPointInsidePolygon(s,n){let i=!1;for(let r=0,o=n.length-1;r<n.length;o=r++){const a=n[r][0],l=n[r][1],u=n[o][0],h=n[o][1];l>s.y!=h>s.y&&s.x<(u-a)*(s.y-l)/(h-l)+a&&(i=!i)}return i}snapToPolygonStraightEdges(s,n,i){const r=n.geometry.coordinates[0];for(let o=0;o<r.length-1;o++){const[a,l]=r[o];if(Er(Gn({x:a,y:l},s))<i)return{point:{x:a,y:l},magnet:{x:a,y:l},type:fn.POLYGON,id:n.id}}for(let o=0;o<r.length-1;o++){const[a,l]=r[o],[u,h]=r[o+1],g={x:a,y:l},f=Gn({x:u,y:h},g),m=Er(f),y={x:f.x/m,y:f.y/m},p={x:-y.y,y:y.x},x=Gn(s,g),v=Math.abs(Zl(p,x)),b=Zl(y,x);if(b>=0&&b<=m&&v<i){const S={x:g.x+y.x*b,y:g.y+y.y*b};return{point:S,magnet:S,type:fn.POLYGON,id:n.id}}}return null}findClosestPointOnBezierCurve(s,n,i,r,o){let a=1/0,l=null;const u=20;for(let h=0;h<=u;h++){const g=h/u,f=this.bezierPoint(g,n,i,r,o),m=Er(Gn(f,s));m<a&&(a=m,l=f)}return l?{point:l,distance:a}:null}bezierPoint(s,n,i,r,o){const a=s*s,l=a*s,u=1-s,h=u*u,g=h*u;return{x:g*n.x+3*h*s*i.x+3*u*a*r.x+l*o.x,y:g*n.y+3*h*s*i.y+3*u*a*r.y+l*o.y}}snapToMagnetPoints(s,n,i){var h;const r=Ei(n);let{width:o,height:a}=qn(n);const{sin:l,cos:u}=this.store.getState();(h=n.properties.style)!=null&&h.fixedSize&&(o/=i,a/=i);for(const g of tw){let f=g.x*o,m=g.y*a;if(!Ti(n)){const p=f*u-m*l,x=f*l+m*u;f=p,m=x}const y={x:r.x+f,y:r.y+m};if(!(Er(Gn(y,s))>=this.options.magnetRadius))return{point:{x:y.x,y:y.y},type:fn.TEXT,magnet:g,id:n.id}}return null}snapToEdge(s,n,i){var p;const{x:r,y:o}=Ei(n);let{width:a,height:l}=qn(n);const u=this.options.magnetRadius;(p=n.properties.style)!=null&&p.fixedSize&&(a/=i,l/=i);const{sin:h,cos:g}=this.store.getState(),f=!Ti(n);let m=null,y=1/0;for(let x=0;x<4;x++){const[v,b,S,A]=YY[x],w=ew(v,b,r,o,a,l,g,h,f),L=ew(S,A,r,o,a,l,g,h,f),k=Gn(L,w),F=Er(k),O={x:k.x/F,y:k.y/F},j={x:-O.y,y:O.x},V=Gn(s,w),Z=Zl(j,V),at=Zl(O,V);if(at>=0&&at<=F){const mt=Math.abs(Z);if(mt<u||mt<y){const K=at/F,ut={point:{x:w.x+O.x*at,y:w.y+O.y*at},magnet:{x:v+(S-v)*K,y:b+(A-b)*K},type:fn.TEXT,id:n.id};if(mt<u)return ut;mt<y&&(y=mt,m=ut)}}}return m&&y<Math.max(a,l)?m:null}snapToNodes(s,n){const i=n.getAttributes(["x","y","radius"]);for(let r=0;r<i.length;r++){const o=i[r],a=Gn({x:o.x,y:o.y},s),l=Er(a);if(l>=Number(o.radius)+Number(this.options.detectMargin))continue;const u=Ma(a,1/l),h=l<Number(o.radius)/2,g=h?{x:o.x,y:o.y}:oh({x:o.x,y:o.y},Ma(u,-Number(o.radius))),f=h?{x:0,y:0}:u;return{point:g,id:n.get(r).getId(),magnet:f,type:fn.NODE}}return null}getHoveredNode(){return this.hoveredNode}clearHoveredNode(){var s;(s=this.hoveredNode)==null||s.setSelected(!1),this.hoveredNode=null}getMagnets(){return tw}}class XY{constructor(e,s,n,i=()=>{}){Qt(this,"layer");Qt(this,"textarea");Qt(this,"sendButton",null);Qt(this,"isFocused");Qt(this,"unsubscribe");Qt(this,"onFocus",()=>{this.isFocused=!0});Qt(this,"onBlur",()=>{this.getAnnotation()&&this.updateContent(),this.isFocused=!1});Qt(this,"onKeyup",e=>{e.key==="Escape"&&this.textarea.blur(),e.stopPropagation()});Qt(this,"onKeydown",e=>{e.stopPropagation()});Qt(this,"onInput",()=>{this.updateContent(),this.updateStyle(),this.updatePosition(),this.layer.setSize(this.getSize()),this.updateSendButtonState()});Qt(this,"onSendClick",e=>{e.preventDefault(),e.stopPropagation(),!(!this.sendButton||this.sendButton.disabled)&&(this.updateContent(),this.textarea.blur(),this.onSendHandler())});Qt(this,"update",()=>{this.updateStyle(),this.updatePosition(),this.layer.setSize(this.getSize())});var f,m,y;this.ogma=e,this.store=s,this.annotation=n,this.onSendHandler=i;const r=this.getPosition(),o=this.getSize(),a=this.getAnnotation(),l=this.store.getState(),u=((f=l.options)==null?void 0:f.showSendButton)??!0,h=((m=l.options)==null?void 0:m.sendButtonIcon)||"",g=((y=l.options)==null?void 0:y.textPlaceholder)||"Enter text";this.layer=this.ogma.layers.addOverlay({element:`<div class="ogma-annotation-text-editor">
          <textarea wrap="on" name="annotation-text--input" spellcheck="false" placeholder="${g}"></textarea>
          ${u?`<button class="ogma-send-button" type="button" title="Send">
            <span class="ogma-send-button-icon">${h}</span>
          </button>`:""}
        </div>`,position:r,size:o},E0.EDITOR),this.textarea=this.layer.element.querySelector("textarea"),this.textarea.setAttribute("wrap","on"),this.textarea.setAttribute("spellcheck","false"),this.textarea.value=a.properties.content||"",u&&(this.sendButton=this.layer.element.querySelector(".ogma-send-button"),this.sendButton.addEventListener("click",this.onSendClick),this.updateSendButtonState()),this.isFocused=!1,this.textarea.addEventListener("focus",this.onFocus),this.textarea.addEventListener("blur",this.onBlur),this.textarea.addEventListener("input",this.onInput),this.textarea.addEventListener("keyup",this.onKeyup),this.textarea.addEventListener("keydown",this.onKeydown),this.updateStyle(),this.updatePosition(),this.textarea.focus(),this.unsubscribe=this.store.subscribe(p=>({rotation:p.rotation,zoom:p.zoom,annotation:p.features[this.annotation]}),this.update,{equalityFn:(p,x)=>p.rotation===x.rotation&&p.zoom===x.zoom&&p.annotation===x.annotation})}getAnnotation(){const e=this.store.getState();return e.liveUpdates[this.annotation]?e.liveUpdates[this.annotation]:(e.startLiveUpdate([this.annotation]),this.store.getState().getFeature(this.annotation))}getPosition(){var i;const e=this.getAnnotation(),s=tu(e,(i=e.properties.style)==null?void 0:i.fixedSize,this.store.getState().zoom),n=E_(e);return{x:s.x+n,y:s.y+n}}getSize(){var a;const e=this.getAnnotation(),s=qn(e),n=E_(e),i=((a=e.properties.style)==null?void 0:a.fixedSize)||!1,r=this.store.getState().zoom,o=i?1/r:1;return{width:(s.width-n*2)*o,height:(s.height-n*2)*o}}updateStyle(){const e=this.getAnnotation();if(!e)return;const{font:s,fontSize:n=jn.fontSize,borderRadius:i,color:r,background:o,padding:a=0,fixedSize:l=jn.fixedSize}=e.properties.style||jn,u=this.textarea,h=this.store.getState().zoom,g=l?1/h:1,f=parseFloat(n.toString())*g,m=a*g,y=u.style;if(y.font=`${f} ${s}`,y.fontFamily=s||"sans-serif",y.fontSize=`${f}px`,y.padding=`${m}px`,y.lineHeight=`${f*AM}px`,y.boxSizing="border-box",y.color=r||"black",y.background=o||"transparent",y.borderRadius=`${i}px`,l&&(y.overflow="hidden",y.resize="none"),y.transformOrigin="center",y.transform=`rotate(${this.store.getState().rotation}rad)`,this.sendButton){const p=l?1/h:1;this.sendButton.style.transform=`scale(${p})`,this.sendButton.style.transformOrigin="bottom right"}}updatePosition(){this.layer.setPosition(this.getPosition())}updateContent(){var o,a;const e=this.getAnnotation();let s=e.properties.height,n=e.geometry.coordinates;const i=(o=e.properties.style)==null?void 0:o.fixedSize;if(i){const l=this.textarea.scrollHeight,u=E_(e),h=this.store.getState().zoom,g=(l+u*2/h)*h,f=((a=e.properties.style)==null?void 0:a.minHeight)||50;s=Math.max(f,g);const m=s-e.properties.height;if(Math.abs(m)>1){const[y,p]=e.geometry.coordinates;n=[y,p+m]}}const r={...e,properties:{...e.properties,content:this.textarea.value,height:s},geometry:{...e.geometry,coordinates:n}};i&&Math.abs(e.properties.height-s)>1&&(this.layer.setSize(this.getSize()),this.layer.setPosition(this.getPosition())),this.store.getState().applyLiveUpdate(this.annotation,r)}updateSendButtonState(){if(!this.sendButton)return;const e=this.textarea.value.trim().length===0;this.sendButton.disabled=e}destroy(){this.store.getState().commitLiveUpdates(new Set([this.annotation])),this.unsubscribe(),this.sendButton&&this.sendButton.removeEventListener("click",this.onSendClick),this.layer.destroy()}}function E_(t){var e;return((e=t.properties.style)==null?void 0:e.strokeWidth)||0}const sw={x:1,y:0},nw={x:0,y:1},ZY=[["top",nw,-.5,-.5,.5,-.5],["right",sw,.5,-.5,.5,.5],["bottom",nw,-.5,.5,.5,.5],["left",sw,-.5,-.5,-.5,.5]],KY={top:[0,1],right:[1,2],bottom:[2,3],left:[3,0]},iw=[[-.5,-.5],[.5,-.5],[.5,.5],[-.5,.5]],QY=[sn.nwResize,sn.neResize,sn.seResize,sn.swResize];class S_ extends nm{constructor(s,n,i){super(s,n);Qt(this,"links");Qt(this,"textEditor",null);Qt(this,"stopEditingText",()=>{this.textEditor&&(this.store.getState().drawingFeature===this.annotation&&this.store.setState({drawingFeature:null}),this.textEditor.destroy()),this.textEditor=null});this.links=i}detectHandle(s,n){var A;const i=this.getAnnotation(),{x:r,y:o}=this.clientToCanvas(s);let{width:a,height:l}=qn(i);const u=5/n,h=Ei(i),g=this.store.getState();let{revSin:f,revCos:m}=g;(Ti(i)||kn(i))&&(f=0,m=1),this.hoveredHandle=void 0;const y=AY*(1/n),p=r-h.x,x=o-h.y,v=p*m-x*f,b=p*f+x*m,S=((A=i.properties.style)==null?void 0:A.fixedSize)===!0||kn(i);if(S&&(a/=n,l/=n),!S){for(let w=0;w<iw.length;w++){const[L,k]=iw[w],F=a*L,O=l*k;if(v>=F-y-u&&v<=F+y+u&&b>=O-y-u&&b<=O+y+u){this.hoveredHandle={type:"corner",corner:w},this.store.setState({hoveredHandle:w}),this.setCursor(this.getCornerCursor(w));return}}for(const[w,L,k,F,O,j]of ZY){const V=a*k,Z=l*F,at=a*O,mt=l*j,K=Zl(L,{x:v-V,y:b-Z});if(Math.abs(K)<u&&v>=V-u&&v<=at+u&&b>=Z-u&&b<=mt+u){this.hoveredHandle={type:"edge",edge:w,corner:-1},this.store.setState({hoveredHandle:KY[w][0]+4}),this.setCursor(this.getEdgeCursor(w));return}}}if(v>=-a/2-u&&v<=a/2+u&&b>=-l/2-u&&b<=l/2+u){this.store.setState({hoveredHandle:8}),this.hoveredHandle={type:"body",corner:-1},this.setCursor(sn.grab);return}this.store.setState({hoveredHandle:-1}),this.setCursor(sn.default)}onDrag(s){if(!this.dragStartPoint||!this.hoveredHandle||!this.isActive())return;s.stopPropagation(),s.stopImmediatePropagation();const n=this.getAnnotation(),i=this.clientToCanvas(s),r={x:i.x-this.dragStartPoint.x,y:i.y-this.dragStartPoint.y},o=this.hoveredHandle,a=this.getAnnotation();let l=null;if(o.type==="corner"?l=this.dragCorner(a,r,o.corner):o.type==="edge"&&o.edge?l=this.dragEdge(a,r,o):o.type==="body"&&(l=this.dragBody(a,r)),l){const u=l;this.store.getState().applyLiveUpdate(n.id,u);const h=Gn(Ei(u),Ei(a));this.links.updateLinkedArrowsDuringDrag(n.id,h),this.textEditor&&this.textEditor.update()}this.dispatchEvent(new CustomEvent(tm,{detail:{point:i,annotation:this.annotation,handle:o}}))}dragBody(s,n){const i=Ei(s);return{...s,geometry:{type:s.geometry.type,coordinates:[i.x+n.x,i.y+n.y]}}}dragCorner(s,n,i){const r=i===0||i===1,o=i===0||i===3,a=i===1||i===2,l=i===2||i===3,{width:u,height:h}=qn(s),g=this.store.getState();let{revSin:f,revCos:m}=g;(Ti(s)||kn(s))&&(f=0,m=1);const y=n.x*m-n.y*f,p=n.x*f+n.y*m;let x=0,v=0;o?x=-y:a&&(x=y),r?v=-p:l&&(v=p);const b=Math.max(0,u+x),S=Math.max(0,h+v),A=Ei(s),w=A.x+n.x/2,L=A.y+n.y/2;return{...s,properties:{...s.properties,width:b,height:S},geometry:{type:s.geometry.type,coordinates:[w,L]}}}dragEdge(s,n,i){const{width:r,height:o}=qn(s),a=Ei(s),l=this.store.getState();let{revSin:u,revCos:h}=l;(Ti(s)||kn(s))&&(u=0,h=1);const g=n.x*h-n.y*u,f=n.x*u+n.y*h;let m=r,y=o,p=0,x=0;switch(i.edge){case"top":y=Math.max(0,o-f),x=f/2;break;case"bottom":y=Math.max(0,o+f),x=f/2;break;case"left":m=Math.max(0,r-g),p=g/2;break;case"right":m=Math.max(0,r+g),p=g/2;break}const v=p*h+x*u,b=-p*u+x*h;return{...s,properties:{...s.properties,width:m,height:y},geometry:{type:s.geometry.type,coordinates:[a.x+v,a.y+b]}}}onDragStart(s){return super.onDragStart(s)?(this.stopEditingText(),this.store.getState().startLiveUpdate([this.annotation]),!0):!1}onClick(s){this.startEditingText()}startEditingText(){this.textEditor===null&&(this.textEditor=new XY(this.ogma,this.store,this.annotation,this.stopEditingText))}onDragEnd(s){var o,a;if(!super.onDragEnd(s))return!1;this.store.getState().drawingFeature===this.annotation&&this.store.setState({drawingFeature:null});const n=this.clientToCanvas(s),i=n.x-(((o=this.dragStartPoint)==null?void 0:o.x)||0),r=n.y-(((a=this.dragStartPoint)==null?void 0:a.y)||0);return Math.abs(i)<1&&Math.abs(r)<1?(this.clearDragState(),this.onClick({clientX:s.clientX,clientY:s.clientY})):this.commitChange(),this.hoveredHandle=void 0,this.dragStartPoint=void 0,this.dragging=!1,!0}getCornerCursor(s){return QY[s]}getEdgeCursor(s){switch(s){case"top":case"bottom":return sn.nsResize;case"left":case"right":return sn.ewResize;default:return sn.default}}stopEditing(){super.stopEditing(),this.commitChange(),this.stopEditingText()}startDrawing(s,n,i){this.annotation=s,this.hoveredHandle={type:"corner",corner:2},this.store.setState({hoveredHandle:2}),this.dragging=!0;const r=this.ogma.view.graphToScreenCoordinates({x:n,y:i});this.dragStartPoint=r,this.disablePanning(),this.onDragStart({clientX:r.x,clientY:r.y})}setAnnotation(s){super.setAnnotation(s),s&&kn(s)&&s.properties.mode===rh&&this.store.getState().updateFeature(s.id,{properties:{...s.properties,mode:SM}})}}class JY extends EventTarget{constructor(s,n,i,r,o){super();Qt(this,"handlers",new Map);Qt(this,"activeHandler");Qt(this,"interaction");Qt(this,"ogma");Qt(this,"snapping");Qt(this,"store");this.ogma=s,this.store=n,this.interaction=o,this.snapping=new WY(s,{detectMargin:10,magnetRadius:10},i,n),this.handlers.set("box",new S_(this.ogma,this.store,r)),this.handlers.set("text",new S_(this.ogma,this.store,r)),this.handlers.set("comment",new S_(this.ogma,this.store,r)),this.handlers.set("arrow",new $Y(this.ogma,this.store,this.snapping,r)),this.handlers.set("polygon",new qY(this.ogma,this.store,r)),this.handlers.forEach(a=>{a.addEventListener("dragstart",()=>{this.dispatchEvent(new Event("dragstart")),this.store.setState({isDragging:!0}),this.interaction.setMode("edit")}),a.addEventListener("dragend",()=>{this.dispatchEvent(new Event("dragend")),this.store.setState({isDragging:!1}),this.interaction.suppressClicksTemporarily()})}),this.store.subscribe(a=>a.selectedFeatures,(a,l)=>{const u=Array.from(a.keys()).filter(g=>!l.has(g)),h=Array.from(l.keys()).filter(g=>!a.has(g));!u.length&&!h.length||(h.forEach(g=>this.stopEditingFeature(g)),u.forEach(g=>this.editFeature(g)))})}stopEditingFeature(s){const n=this.store.getState().features[s];if(!n)return;const i=n.properties.type,r=this.handlers.get(i);r&&r.stopEditing()}editFeature(s){var i;const n=this.store.getState().features[s];n&&(this.setActiveHandler(n.properties.type),(i=this.activeHandler)==null||i.setAnnotation(n))}getSnapping(){return this.snapping}getArrowHandler(){return this.handlers.get("arrow")}getActiveHandler(){return this.activeHandler}setActiveHandler(s){const n=this.handlers.get(s);if(!n)throw new Error(`Handler for type ${s} not found`);return this.activeHandler=n,this}destroy(){}}class tW extends nm{constructor(s,n,i,r,o,a,l){super(s,n);Qt(this,"links");Qt(this,"snapping");Qt(this,"arrowHandler");Qt(this,"arrowStyle");Qt(this,"offsetX");Qt(this,"offsetY");Qt(this,"comment");Qt(this,"startX",0);Qt(this,"startY",0);Qt(this,"onArrowComplete",()=>{var v;this.arrowHandler.removeEventListener("dragend",this.onArrowComplete);const s=this.store.getState(),n=Array.from(s.selectedFeatures);if(n.length===0)return;const i=s.getFeature(n[0]);if(!i||!wi(i))return;const r=i.geometry.coordinates[0],o=i.geometry.coordinates[1],a=o[0]-this.startX,l=o[1]-this.startY,u=Math.sqrt(a*a+l*l);let h,g;u<5?(h=this.startX+this.offsetX,g=this.startY+this.offsetY):(h=o[0],g=o[1]);const f=this.comment;f.geometry.coordinates=[h,g],s.addFeature(f),this.store.setState({drawingFeature:f.id});const m=f.properties.height,y=h,p=g+m*.5;this.snapArrowStart(i,r[0],r[1]);const x=(v=i.properties.link)==null?void 0:v.start;s.updateFeature(i.id,{...i,geometry:{...i.geometry,coordinates:[[y,p],r]},properties:{...i.properties,link:{start:{side:Ui,id:f.id,type:fn.COMMENT,magnet:{x:0,y:.5}},end:x?{side:ba,id:x.id,type:x.type,magnet:x.magnet}:void 0}}}),this.links.add(i,Ui,f.id,fn.COMMENT,{x:0,y:.5}),x&&x.magnet&&this.links.add(i,ba,x.id,x.type,x.magnet),s.setSelectedFeatures([f.id]),this.store.setState({drawingFeature:null})});this.links=i,this.arrowHandler=o,this.snapping=r,this.offsetX=(l==null?void 0:l.offsetX)??100,this.offsetY=(l==null?void 0:l.offsetY)??-50,this.arrowStyle=l==null?void 0:l.arrowStyle,this.comment=a}detectHandle(s,n){}startDrawing(s,n,i){var a;this.startX=n,this.startY=i;const r=nx(n,i,n,i,{...ah,head:"arrow",...(a=this.arrowStyle)==null?void 0:a.style});this.store.getState().addFeature(r),this.store.setState({drawingFeature:r.id}),this.arrowHandler.addEventListener("dragend",this.onArrowComplete),this.store.getState().setSelectedFeatures([r.id]);const o=this.ogma.view.graphToScreenCoordinates({x:n,y:i});this.arrowHandler.startDrawing(r.id,o.x,o.y)}snapArrowStart(s,n,i){const r=this.snapping.snap({x:n,y:i});r&&(s.geometry.coordinates[0]=[r.point.x,r.point.y],s.properties.link={start:{side:Ui,id:r.id,type:r.type,magnet:r.magnet}},this.links.add(s,Ui,r.id,r.type,r.magnet))}}const eW=["x","y","radius"],sW=100;class nW{constructor(e,s,n){Qt(this,"links",new Map);Qt(this,"nodeToLink",new Map);Qt(this,"annotationToLink",new Map);Qt(this,"linksByArrowId",new Map);Qt(this,"store");Qt(this,"ogma");Qt(this,"updatedItems",new Set);Qt(this,"onLinkCreated");Qt(this,"onSetMultipleAttributes",({elements:e,updatedAttributes:s})=>{const n=new Set(s);!e.isNode||!n.has("x")&&!n.has("y")&&!n.has("radius")||this.requestUpdateFromNodePositions(e.toList())});Qt(this,"refresh",()=>{const e=this.store.getState(),s=new Map;this.annotationToLink.forEach((n,i)=>{var o;const r=e.getFeature(i);r&&(mn(r)&&((o=r.properties.style)!=null&&o.fixedSize)||kn(r))&&n.forEach(a=>{const l=this.links.get(a);if(!l)return;const u=l.arrow;s.set(u,this.linksByArrowId.get(u))})}),s.size>0&&this.update(s)});Qt(this,"debouncedCommit",(()=>{let e;return()=>{clearTimeout(e),e=setTimeout(()=>{this.store.getState().batchUpdate(()=>{this.store.getState().commitLiveUpdates(this.updatedItems)}),this.updatedItems.clear()},sW)}})());Qt(this,"onAddArrow",(e,s)=>{const n=this.store.getState(),i=new Set(Object.keys(s)),r=Object.keys(e).filter(a=>!i.has(a)),o=Object.keys(s).filter(a=>!e[a]);r.forEach(a=>{var h,g;const l=n.getFeature(a);if(!l||!wi(l))return;const u=l;if((h=u.properties.link)!=null&&h.start){const f=u.properties.link.start;f.type==="node"?this.add(u,Ui,f.id,f.type,f.magnet):this.add(u,Ui,f.id,f.type,f.magnet)}if((g=u.properties.link)!=null&&g.end){const f=u.properties.link.end;f.type==="node"?this.add(u,ba,f.id,f.type,f.magnet):this.add(u,ba,f.id,f.type,f.magnet)}}),o.forEach(a=>{const l=s[a];if(wi(l)){const u=l;this.remove(u,Ui),this.remove(u,ba)}else{const u=this.annotationToLink.get(a);if(u)for(const h of u){const g=this.links.get(h);if(!g)continue;const f=n.getFeature(g.arrow);f&&this.remove(f,g.side),this.linksByArrowId.delete(g.arrow),this.links.delete(h)}}})});this.ogma=e,this.store=s,this.onLinkCreated=n,this.store.subscribe(i=>i.features,this.onAddArrow),this.store.subscribe(i=>({zoom:i.zoom,rotation:i.rotation}),this.refresh,{equalityFn:(i,r)=>i.zoom===r.zoom&&i.rotation===r.rotation}),this.ogma.events.on("setMultipleAttributes",this.onSetMultipleAttributes).on("viewChanged",this.refresh)}updateLinkedArrowsDuringDrag(e,s){const n=this.store.getState();if(!n.getFeature(e))return;const i=this.annotationToLink.get(e);if(i)for(const r of i){const o=this.links.get(r);if(!o)continue;const a=n.getFeature(o.arrow),l=b_(a,o.side),u=oh(l,s),h={...a.geometry,coordinates:a.geometry.coordinates.map((g,f)=>o.side===Ui&&f===0||o.side===ba&&f===1?[u.x,u.y]:[...g])};n.applyLiveUpdate(a.id,{geometry:h}),this.updatedItems.add(a.id)}}add(e,s,n,i,r){const o=Ya(),a=e.id;let l=r;if(i===fn.POLYGON){const g=this.store.getState().getFeature(n);if(g&&za(g)){const f=QA(g),m=f[2]-f[0],y=f[3]-f[1],p=r.x-f[0],x=r.y-f[1],v=m>0?p/m:.5,b=y>0?x/y:.5;l={x:v,y:b}}}const u={id:o,arrow:a,target:n,targetType:i,magnet:l,side:s};if(i===fn.NODE&&!this.ogma.getNode(n))return;this.remove(e,s),this.links.set(o,u);const h=i===fn.NODE?this.nodeToLink:this.annotationToLink;return h.has(n)||h.set(n,new Set),h.get(n).add(o),this.linksByArrowId.has(a)||this.linksByArrowId.set(a,{}),this.linksByArrowId.get(a)[s]=o,e.properties.link=e.properties.link||{},e.properties.link[s]={id:n,side:s,type:i,magnet:l},this.onLinkCreated&&this.onLinkCreated(e,u),this}remove(e,s){var o,a,l,u;const n=e.id,i=(o=this.linksByArrowId.get(n))==null?void 0:o[s];if((a=e.properties.link)==null||delete a[s],!i)return this;const r=this.links.get(i);return r?(this.links.delete(i),(l=this.nodeToLink.get(r.target))==null||l.delete(i),(u=this.annotationToLink.get(r.target))==null||u.delete(i),this.linksByArrowId.has(n)&&(this.linksByArrowId.get(n)[s]=void 0),this):this}requestUpdateFromNodePositions(e){setTimeout(()=>this.updateFromNodePositions(e),1)}updateFromNodePositions(e){const s=e.getId(),n=new Map;s.forEach(o=>{const a=this.nodeToLink.get(o);a&&a.forEach(l=>{const u=this.links.get(l);if(!u)return;const h=u.arrow;n.set(h,this.linksByArrowId.get(h))})});const i=e.getAttributes(eW),r=this.store.getState();for(let o=0;o<s.length;o++){const a=s[o],l=this.nodeToLink.get(a);if(l)for(const u of l){const h=this.links.get(u);if(!h)continue;const g=h.arrow,f=this.store.getState().getFeature(g),m=f.geometry.coordinates.slice(),y=b_(f,ba),p=b_(f,Ui),x=i[o],v=this._getNodeSnapPoint(x,Ma(Gn(y,p),-1),this._isLinkedToCenter(h));m[h.side===Ui?0:1]=v,r.applyLiveUpdate(g,{...f,geometry:{coordinates:m}}),this.updatedItems.add(g),h.magnet={x:v[0]-x.x,y:v[1]-x.y},em(f)}}this.debouncedCommit()}update(e=this.linksByArrowId){const s=this.store.getState(),n=Array.from(this.nodeToLink.keys()),i=new Map;n.forEach((o,a)=>i.set(o,a));const r=this.ogma.getNodes(n).getAttributes(["x","y","radius"]);e.forEach((o,a)=>{const l=this.links.get(o.start),u=this.links.get(o.end),h=s.getFeature(a);let g=h.geometry.coordinates[0],f=h.geometry.coordinates[1];const m=l?l.targetType===fn.NODE?r[i.get(l.target)]:this._getAnnotationCenter(s.getFeature(l.target)):{x:g[0],y:g[1]},y=u?u.targetType===fn.NODE?r[i.get(u.target)]:this._getAnnotationCenter(s.getFeature(u.target)):{x:f[0],y:f[1]},p=Gn(y,m);if(l)if(l.targetType===fn.NODE)g=this._getNodeSnapPoint(m,p,this._isLinkedToCenter(l));else{const x=s.getFeature(l.target);g=this._getAnnotationSnapPoint(x,y,l,s.zoom)}if(u)if(u.targetType===fn.NODE)f=this._getNodeSnapPoint(y,Ma(p,-1),this._isLinkedToCenter(u));else{const x=s.getFeature(u.target);f=this._getAnnotationSnapPoint(x,m,u,s.zoom)}s.applyLiveUpdate(h.id,{geometry:{coordinates:[g,f]}}),this.updatedItems.add(h.id)}),this.debouncedCommit()}_isLinkedToCenter(e){return e.magnet.x===0&&e.magnet.y===0}_getAnnotationCenter(e){return za(e)?zY(e):Ei(e)}_getAnnotationSnapPoint(e,s,n,i){if(za(e)){const r=QA(e),o=r[0]+n.magnet.x*(r[2]-r[0]),a=r[1]+n.magnet.y*(r[3]-r[1]);return[o,a]}return this._getBoxSnapPoint(e,s,n,i)}_getBoxSnapPoint(e,s,n,i){var h;const r=Ei(e);let{width:o,height:a}=qn(e);(mn(e)&&((h=e.properties.style)!=null&&h.fixedSize)||kn(e))&&(o/=i,a/=i);let l=n.magnet.x*o,u=n.magnet.y*a;if(mn(e)&&!Ti(e)){const{sin:g,cos:f}=this.store.getState(),m=l*f-u*g,y=l*g+u*f;l=m,u=y}else if(kn(e)){const g={...e.properties.style}.iconSize||32,f=g/16*.5;l=n.magnet.x*g*f,u=n.magnet.y*g*f}return[r.x+l,r.y+u]}_getNodeSnapPoint(e,s,n){if(n)return[e.x,e.y];const i=Math.sqrt(s.x*s.x+s.y*s.y),r=Ma(s,1/i),o=i<Number(e.radius)/2?{x:e.x,y:e.y}:oh({x:e.x,y:e.y},Ma(r,-Number(e.radius)));return[o.x,o.y]}destroy(){this.ogma.events.off(this.onSetMultipleAttributes)}}class iW{constructor(e,s,n){Qt(this,"query",{minX:1/0,minY:1/0,maxX:1/0,maxY:1/0});Qt(this,"suppressClickUntil",0);Qt(this,"mouseDownState",null);Qt(this,"DRAG_THRESHOLD",3);Qt(this,"onMouseMove",e=>{var l;const s=rx(e,this.ogma.getContainer()),n=this.store.getState();if(this.mouseDownState&&!n.isDragging){const u=e.clientX-this.mouseDownState.screenX,h=e.clientY-this.mouseDownState.screenY;Math.sqrt(u*u+h*h)>this.DRAG_THRESHOLD&&(this.mouseDownState.hasMoved=!0)}if(n.isDragging)return;const{x:i,y:r}=this.ogma.view.screenToGraphCoordinates(s),o=((l=this.detect(i,r))==null?void 0:l.id)??null,a=n.hoveredFeature;o!==a&&n.setHoveredFeature(o),this.setCursor(o===null?sn.default:sn.pointer)});Qt(this,"onMouseClick",()=>{Date.now()<this.suppressClickUntil});Qt(this,"onMouseDown",e=>{if(Date.now()<this.suppressClickUntil)return;const s=rx(e,this.ogma.getContainer()),{x:n,y:i}=this.ogma.view.screenToGraphCoordinates(s),r=this.detect(n,i);this.mouseDownState={annotation:r,screenX:e.clientX,screenY:e.clientY,hasMoved:!1};const o=this.store.getState();this.store.setState({mousePressed:!0,mousePressPoint:{x:n,y:i}}),r&&!o.selectedFeatures.has(r.id)&&(e.ctrlKey||e.metaKey?o.toggleSelection(r.id):o.setSelectedFeatures([r.id]))});Qt(this,"onMouseUp",e=>{const s=this.store.getState();if(this.store.setState({mousePressed:!1,mousePressPoint:null}),this.mouseDownState&&!this.mouseDownState.hasMoved&&!s.isDragging){const n=this.mouseDownState.annotation;n?e.ctrlKey||e.metaKey?s.toggleSelection(n.id):s.selectedFeatures.has(n.id)||s.setSelectedFeatures([n.id]):!e.ctrlKey&&!e.metaKey&&s.clearSelection()}this.mouseDownState=null});this.ogma=e,this.store=s,this.index=n;const i=this.ogma.getContainer();i&&(i.addEventListener("mousemove",this.onMouseMove,{passive:!0,capture:!0}),i.addEventListener("click",this.onMouseClick,{passive:!0,capture:!0}),i.addEventListener("mousedown",this.onMouseDown,{passive:!0,capture:!1}),i.addEventListener("mouseup",this.onMouseUp,{passive:!0,capture:!0}))}detect(e,s,n){let i=null;const r=this.store.getState(),o=n??r.options.detectMargin;this.query.minX=e-o,this.query.minY=s-o,this.query.maxX=e+o,this.query.maxY=s+o;const a=this.index.query(this.query);if(a.length===0)return null;for(const l of a){const u=r.getFeature(l.id);if(wi(u)){if(CM(u,{x:e,y:s},o)){i=u;break}}else if(Ti(u)){if(CY(u,{x:e,y:s},0,1,o)){i=u;break}}else if(za(u)){if(NM(u,{x:e,y:s},o)){i=u;break}}else if(kn(u)){if(NY(u,{x:e,y:s},o,r.sin,r.cos,r.zoom)){i=u;break}}else if(mn(u)&&LM(u,{x:e,y:s},o,r.revSin,r.revCos,r.zoom)){i=u;break}}return i}setCursor(e){var n;const s=(n=this.ogma.getContainer())==null?void 0:n.firstChild;s&&(s.style.cursor=e)}setMode(e){var s;e==="default"?this.setCursor(((s=this.ogma.getOptions().cursor)==null?void 0:s.default)||"default"):e==="add"||e==="link"?this.setCursor(sn.crosshair):e==="rotate"&&this.setCursor(sn.alias)}suppressClicksTemporarily(e=100){this.suppressClickUntil=Date.now()+e}destroy(){const e=this.ogma.getContainer();e&&(e.removeEventListener("mousemove",this.onMouseMove),e.removeEventListener("click",this.onMouseClick))}}function RM(t,e,s=0,n=t.length-1,i=rW){for(;n>s;){if(n-s>600){const l=n-s+1,u=e-s+1,h=Math.log(l),g=.5*Math.exp(2*h/3),f=.5*Math.sqrt(h*g*(l-g)/l)*(u-l/2<0?-1:1),m=Math.max(s,Math.floor(e-u*g/l+f)),y=Math.min(n,Math.floor(e+(l-u)*g/l+f));RM(t,e,m,y,i)}const r=t[e];let o=s,a=n;for(ad(t,s,e),i(t[n],r)>0&&ad(t,s,n);o<a;){for(ad(t,o,a),o++,a--;i(t[o],r)<0;)o++;for(;i(t[a],r)>0;)a--}i(t[s],r)===0?ad(t,s,a):(a++,ad(t,a,n)),a<=e&&(s=a+1),e<=a&&(n=a-1)}}function ad(t,e,s){const n=t[e];t[e]=t[s],t[s]=n}function rW(t,e){return t<e?-1:t>e?1:0}class oW{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let s=this.data;const n=[];if(!Lg(e,s))return n;const i=this.toBBox,r=[];for(;s;){for(let o=0;o<s.children.length;o++){const a=s.children[o],l=s.leaf?i(a):a;Lg(e,l)&&(s.leaf?n.push(a):w_(e,l)?this._all(a,n):r.push(a))}s=r.pop()}return n}collides(e){let s=this.data;if(!Lg(e,s))return!1;const n=[];for(;s;){for(let i=0;i<s.children.length;i++){const r=s.children[i],o=s.leaf?this.toBBox(r):r;if(Lg(e,o)){if(s.leaf||w_(e,o))return!0;n.push(r)}}s=n.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let n=0;n<e.length;n++)this.insert(e[n]);return this}let s=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=s;else if(this.data.height===s.height)this._splitRoot(this.data,s);else{if(this.data.height<s.height){const n=this.data;this.data=s,s=n}this._insert(s,this.data.height-s.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Dl([]),this}remove(e,s){if(!e)return this;let n=this.data;const i=this.toBBox(e),r=[],o=[];let a,l,u;for(;n||r.length;){if(n||(n=r.pop(),l=r[r.length-1],a=o.pop(),u=!0),n.leaf){const h=aW(e,n.children,s);if(h!==-1)return n.children.splice(h,1),r.push(n),this._condense(r),this}!u&&!n.leaf&&w_(n,i)?(r.push(n),o.push(a),a=0,l=n,n=n.children[0]):l?(a++,n=l.children[a],u=!1):n=null}return this}toBBox(e){return e}compareMinX(e,s){return e.minX-s.minX}compareMinY(e,s){return e.minY-s.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,s){const n=[];for(;e;)e.leaf?s.push(...e.children):n.push(...e.children),e=n.pop();return s}_build(e,s,n,i){const r=n-s+1;let o=this._maxEntries,a;if(r<=o)return a=Dl(e.slice(s,n+1)),Ml(a,this.toBBox),a;i||(i=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,i-1))),a=Dl([]),a.leaf=!1,a.height=i;const l=Math.ceil(r/o),u=l*Math.ceil(Math.sqrt(o));rw(e,s,n,u,this.compareMinX);for(let h=s;h<=n;h+=u){const g=Math.min(h+u-1,n);rw(e,h,g,l,this.compareMinY);for(let f=h;f<=g;f+=l){const m=Math.min(f+l-1,g);a.children.push(this._build(e,f,m,i-1))}}return Ml(a,this.toBBox),a}_chooseSubtree(e,s,n,i){for(;i.push(s),!(s.leaf||i.length-1===n);){let r=1/0,o=1/0,a;for(let l=0;l<s.children.length;l++){const u=s.children[l],h=A_(u),g=dW(e,u)-h;g<o?(o=g,r=h<r?h:r,a=u):g===o&&h<r&&(r=h,a=u)}s=a||s.children[0]}return s}_insert(e,s,n){const i=n?e:this.toBBox(e),r=[],o=this._chooseSubtree(i,this.data,s,r);for(o.children.push(e),wd(o,i);s>=0&&r[s].children.length>this._maxEntries;)this._split(r,s),s--;this._adjustParentBBoxes(i,r,s)}_split(e,s){const n=e[s],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);const o=this._chooseSplitIndex(n,r,i),a=Dl(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,Ml(n,this.toBBox),Ml(a,this.toBBox),s?e[s-1].children.push(a):this._splitRoot(n,a)}_splitRoot(e,s){this.data=Dl([e,s]),this.data.height=e.height+1,this.data.leaf=!1,Ml(this.data,this.toBBox)}_chooseSplitIndex(e,s,n){let i,r=1/0,o=1/0;for(let a=s;a<=n-s;a++){const l=Ad(e,0,a,this.toBBox),u=Ad(e,a,n,this.toBBox),h=hW(l,u),g=A_(l)+A_(u);h<r?(r=h,i=a,o=g<o?g:o):h===r&&g<o&&(o=g,i=a)}return i||n-s}_chooseSplitAxis(e,s,n){const i=e.leaf?this.compareMinX:lW,r=e.leaf?this.compareMinY:uW,o=this._allDistMargin(e,s,n,i),a=this._allDistMargin(e,s,n,r);o<a&&e.children.sort(i)}_allDistMargin(e,s,n,i){e.children.sort(i);const r=this.toBBox,o=Ad(e,0,s,r),a=Ad(e,n-s,n,r);let l=Cg(o)+Cg(a);for(let u=s;u<n-s;u++){const h=e.children[u];wd(o,e.leaf?r(h):h),l+=Cg(o)}for(let u=n-s-1;u>=s;u--){const h=e.children[u];wd(a,e.leaf?r(h):h),l+=Cg(a)}return l}_adjustParentBBoxes(e,s,n){for(let i=n;i>=0;i--)wd(s[i],e)}_condense(e){for(let s=e.length-1,n;s>=0;s--)e[s].children.length===0?s>0?(n=e[s-1].children,n.splice(n.indexOf(e[s]),1)):this.clear():Ml(e[s],this.toBBox)}}function aW(t,e,s){if(!s)return e.indexOf(t);for(let n=0;n<e.length;n++)if(s(t,e[n]))return n;return-1}function Ml(t,e){Ad(t,0,t.children.length,e,t)}function Ad(t,e,s,n,i){i||(i=Dl(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let r=e;r<s;r++){const o=t.children[r];wd(i,t.leaf?n(o):o)}return i}function wd(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function lW(t,e){return t.minX-e.minX}function uW(t,e){return t.minY-e.minY}function A_(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Cg(t){return t.maxX-t.minX+(t.maxY-t.minY)}function dW(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function hW(t,e){const s=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,i-s)*Math.max(0,r-n)}function w_(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Lg(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Dl(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function rw(t,e,s,n,i){const r=[e,s];for(;r.length;){if(s=r.pop(),e=r.pop(),s-e<=n)continue;const o=e+Math.ceil((s-e)/n/2)*n;RM(t,o,e,s,i),r.push(e,o,o,s)}}const ld={minX:0,minY:0,maxX:0,maxY:0},ow=(t,e)=>t.id===e.id;class cW extends oW{constructor(s){super();Qt(this,"store");Qt(this,"onRotationChange",()=>{const s=this.store.getState().getAllFeatures().filter(n=>mn(n)||kn(n));for(const n of s)this.updateRotatedText(n)});Qt(this,"onZoomChange",()=>{const s=this.store.getState().getAllFeatures().filter(n=>{var i;return(mn(n)||kn(n))&&((i=n.properties.style)==null?void 0:i.fixedSize)});for(const n of s)this.updateRotatedText(n)});this.store=s,this.store.subscribe(n=>n.features,n=>{this.clear(),Object.values(n).forEach(i=>{mn(i)||kn(i)?this.updateRotatedText(i):this.insert(i)})}),this.store.subscribe(n=>({features:n.features,isDragging:n.isDragging,lastChangedFeatures:n.lastChangedFeatures,rotation:n.rotation}),(n,i)=>{i&&i.isDragging&&!n.isDragging&&n.lastChangedFeatures.length>0&&n.lastChangedFeatures.forEach(r=>{const o=n.features[r];o&&(em(o),mn(o)||kn(o)?this.updateRotatedText(o):(this.remove(o,ow),this.insert(o)))})},{equalityFn:(n,i)=>n.isDragging===i.isDragging}),this.store.subscribe(n=>n.rotation,this.onRotationChange),this.store.subscribe(n=>n.zoom,this.onZoomChange)}updateRotatedText(s){var h;const n=this.store.getState();this.remove(s,ow);const i=Ei(s);let{width:r,height:o}=qn(s);if(((h=s.properties.style)==null?void 0:h.fixedSize)===!0){const g=n.invZoom;r*=g,o*=g}const a=r/2,l=o/2,u=n.getRotatedBBox(i.x-a,i.y-l,i.x+a,i.y+l);this.insert({...s,geometry:{...s.geometry,bbox:u.slice()}})}compareMinX(s,n){return qr(s)[0]-qr(n)[0]}compareMinY(s,n){return qr(s)[1]-qr(n)[1]}toBBox(s){const n=qr(s);return ld.minX=n[0],ld.minY=n[1],ld.maxX=n[2],ld.maxY=n[3],ld}query(s){return super.search(s)}}class FM{constructor(e,s){Qt(this,"layer");this.ogma=e,this.store=s}destroy(){}}function gW(t,e,s,n,i,r){const o=Math.min(n/2,i/2),a=Math.min(r,o);t.beginPath(),t.moveTo(e+a,s),t.lineTo(e+n-a,s),t.quadraticCurveTo(e+n,s,e+n,s+a),t.lineTo(e+n,s+i-a),t.quadraticCurveTo(e+n,s+i,e+n-a,s+i),t.lineTo(e+a,s+i),t.quadraticCurveTo(e,s+i,e,s+i-a),t.lineTo(e,s+a),t.quadraticCurveTo(e,s,e+a,s),t.closePath()}const aw=[[-.5,-.5],[.5,-.5],[.5,.5],[-.5,.5]];class fW extends FM{constructor(s,n){super(s,n);Qt(this,"handleFill","#fff");Qt(this,"handleStroke","#1A70E5");Qt(this,"handleStrokeWidth",1.5);Qt(this,"handleRadius",3);Qt(this,"handleMagnifier",1.5);Qt(this,"refresh",()=>{this.layer.refresh()});Qt(this,"render",s=>{const n=this.store.getState(),i=1/n.zoom,{hoveredHandle:r,rotation:o,liveUpdates:a,features:l}=n,u=this.handleRadius*i;s.fillStyle=this.handleFill,s.lineWidth=this.handleStrokeWidth*i,s.strokeStyle=this.handleStroke,Object.values(l).forEach(h=>{if(!n.isSelected(h.id))return;const g=a[h.id]?{...h,...a[h.id]}:h;if(wi(g))this.renderArrowHandles(g,s,u,r);else if(Ti(g)||mn(g)){const f=mn(g)?o:0;this.renderOutline(g,s,f,r,n.zoom),this.renderBoxHandles(g,s,u,r,f)}else za(g)&&this.renderPolygonHandles(g,s,u,r,n.drawingFeature===g.id)})});this.layer=s.layers.addCanvasLayer(this.render,void 0,E0.HANDLES),this.store.subscribe(i=>({selectedFeatures:i.selectedFeatures,liveUpdates:i.liveUpdates}),this.refresh),s.events.on("zoom",this.refresh)}renderOutline(s,n,i,r,o){var x,v;const a=mn(s)&&((x=s.properties.style)==null?void 0:x.fixedSize);let{width:l,height:u}=qn(s);a&&(l/=o,u/=o);const h=tu(s,a,o),g=l/2,f=u/2,m=h.x+g,y=h.y+f;n.save(),n.translate(m,y),n.rotate(i);const p=(v=s.properties.style)==null?void 0:v.borderRadius;if(p&&p>0?(gW(n,-g,-f,l,u,p),n.stroke()):n.strokeRect(-g,-f,l,u),r>=4&&r<8){let b,S,A,w;const L=p&&p>0?p:this.handleRadius/o;switch(r){case 4:b=-g+L,S=-f,A=g-L,w=-f;break;case 5:b=g,S=-f+L,A=g,w=f-L;break;case 6:b=g-L,S=f,A=-g+L,w=f;break;case 7:b=-g,S=f-L,A=-g,w=-f+L;break}n.lineWidth=this.handleStrokeWidth*this.handleMagnifier/o,n.beginPath(),n.moveTo(b,S),n.lineTo(A,w),n.stroke(),n.lineWidth=this.handleStrokeWidth}n.restore()}renderArrowHandles(s,n,i,r){const o=MM(s),a=IM(s),l=+(r===0),u=+(r===1),h=i*(1+(this.handleMagnifier-1)*l),g=i*(1+(this.handleMagnifier-1)*u);n.beginPath(),n.moveTo(o.x,o.y),n.lineTo(a.x,a.y),n.closePath(),n.stroke(),n.beginPath(),n.moveTo(o.x-h,o.y-h),n.rect(o.x-h,o.y-h,h*2,h*2),n.moveTo(a.x-g,a.y-g),n.rect(a.x-g,a.y-g,g*2,g*2),n.closePath(),n.fill(),n.stroke()}renderBoxHandles(s,n,i,r,o){var y;if(mn(s)&&((y=s.properties.style)!=null&&y.fixedSize))return;const{width:a,height:l}=qn(s),u=tu(s),h=a/2,g=l/2,f=u.x+h,m=u.y+g;n.save(),n.translate(f,m),n.rotate(o),n.beginPath();for(let p=0;p<aw.length;p++){const[x,v]=aw[p],b=a*x,S=l*v,A=r===p?i*this.handleMagnifier:i;n.rect(b-A,S-A,A*2,A*2)}n.closePath(),n.fill(),n.stroke(),n.restore()}renderPolygonHandles(s,n,i,r,o){const a=s.geometry.coordinates[0];if(!o){a.length>2&&(n.save(),n.strokeStyle=this.handleStroke,n.lineWidth=this.handleStrokeWidth/this.store.getState().zoom,this.drawSmoothPolygon(n,a,.5),n.stroke(),n.restore()),n.beginPath();for(let l=0;l<a.length-1;l++){const[u,h]=a[l],g=r===l?i*this.handleMagnifier:i;n.moveTo(u+g,h),n.arc(u,h,g,0,2*Math.PI)}n.closePath(),n.fill(),n.stroke()}}drawSmoothPolygon(s,n,i){const r=n.slice(0,-1);if(r.length<3)return;s.beginPath();const o=r.length;for(let a=0;a<o;a++){const l=r[(a-1+o)%o],u=r[a],h=r[(a+1)%o],g=r[(a+2)%o],f=u[0]+(h[0]-l[0])/6*i,m=u[1]+(h[1]-l[1])/6*i,y=h[0]-(g[0]-u[0])/6*i,p=h[1]-(g[1]-u[1])/6*i;a===0&&s.moveTo(u[0],u[1]),s.bezierCurveTo(f,m,y,p,h[0],h[1])}s.closePath()}renderCenterPoint(s,n){var r;const i=this.store.getState();if(mn(s)){const o=tu(s,(r=s.properties.style)==null?void 0:r.fixedSize,i.zoom),a=qn(s);n.moveTo(o.x+a.width/2+5,o.y+a.height/2),n.arc(o.x+a.width/2,o.y+a.height/2,5,0,Math.PI*2,!0)}}destroy(){this.layer.destroy(),super.destroy()}}const mW=.5;function pW(t,e,s,n){const{start:i,end:r}=S0(t),o=Gn(r,i);return Math.min(n,Math.max(2*e,Er(o)*.01,s))}function lw(t,e,s,n){const i=Ma(TM(sx(e)),n);if(!s||s!=="arrow"&&s!=="arrow-plain")return"";const r=oh(t,YA(i,Math.PI/6)),o=oh(t,YA(i,-Math.PI/6)),a=`${t.x} ${t.y}`;return`M ${r.x} ${r.y} L ${a} ${o.x} ${o.y} ${s==="arrow"?"":`${r.x} ${r.y}`}`}function _W(t,e){if(!t){t=As("g");const s=As("path");t.classList.add("annotation-arrow"),t.setAttribute("data-annotation",`${e}`),t.setAttribute("data-annotation-type","arrow"),t.appendChild(s);const n=As("g");n.classList.add("annotation-arrow-endpoints"),t.appendChild(n)}return t}function yW(t,e,s,n,i,r){const{start:o,end:a}=S0(e),l=e.properties.style||ah,{tail:u,strokeWidth:h=0,head:g,strokeColor:f,strokeType:m}=l,y=Gn(a,o),p=jY(e)?1/r.zoom:1,x=pW(e,h,s,n)*p,v=_W(i,e.id),b=v.firstChild,S=g==="arrow-plain"||u==="arrow",A=f||"none";b.setAttribute("stroke",A),b.setAttribute("stroke-width",`${p*h}`),b.setAttribute("fill",S?f||"":"none"),b.setAttribute("stroke-linecap","round"),b.setAttribute("stroke-linejoin","round");const w=lw(o,TM(y),u,x),L=lw(a,y,g,x),k=w+`M ${o.x} ${o.y} ${a.x} ${a.y}`+L;b.setAttribute("d",k);const F=v.children[1];return F.innerHTML="",m==="dashed"?b.setAttribute("stroke-dasharray","5,10"):b.removeAttribute("stroke-dasharray"),uw(F,o,A,u,h,p),uw(F,a,A,g,h,p),v.setAttribute("transform",`rotate(${-r.rotation*(180/Math.PI)})`),t.appendChild(v),v}function uw(t,e,s,n,i,r){n==="halo-dot"&&dw(t,e,xW(s),mW,i*r*4),(n==="dot"||n==="halo-dot")&&dw(t,e,s,1,i*r*2)}function xW(t){return t==="none"?"none":t}function dw(t,e,s,n,i){const r=As("circle");r.setAttribute("cx",`${e.x}`),r.setAttribute("cy",`${e.y}`),r.setAttribute("r",`${i}`),r.setAttribute("fill-opacity",`${n}`),r.setAttribute("fill",s),t.appendChild(r)}function vW(t,e,s="box"){if(!t){t=As("g"),t.setAttribute("data-annotation",`${e}`),t.setAttribute("data-annotation-type",s),t.classList.add(`annotation-${s}`);const n=As("rect");t.appendChild(n)}return t}function PM(t,e,s,n){const i=e.id,r=`class${i}`,o=qn(e),a=vW(s,i,e.properties.type),{strokeColor:l,strokeWidth:u,strokeType:h,background:g,borderRadius:f}=e.properties.style||lh;a.classList.add("annotation-box"),a.setAttribute("fill",`${g||"transparent"}`);const m=a.firstChild;f&&(m.setAttribute("rx",`${f}`),m.setAttribute("ry",`${f}`)),h&&h!=="none"&&(m.setAttribute("stroke",l||"black"),m.setAttribute("stroke-width",`${u}`),h==="dashed"&&m.setAttribute("stroke-dasharray","5,5")),g&&g.length&&(n.hoveredFeature===e.id?m.setAttribute("fill",sm(g)):m.setAttribute("fill",g));const y=tu(e);return m.setAttribute("width",`${o.width}`),m.setAttribute("height",`${o.height}`),m.setAttribute("x",`${y.x}`),m.setAttribute("y",`${y.y}`),a.appendChild(m),a.setAttribute("transform",n.getRotationTransform(0,0)),a.classList.add(r),a.setAttribute("data-annotation",`${e.id}`),a.setAttribute("data-annotation-type",e.properties.type),t.appendChild(a),a}const bW=/^((?:[a-z\d-]+\s+)*)([\d.]+(%|em|px)|(?:x+-)?large|(?:x+-)?small|medium)(?:\s*\/\s*(normal|[\d.]+(%|px|em)?))?(\s.+)?$/,EW=/\bsmall-caps\b/,SW=/\b(?:italic|oblique)\b/,AW=/\bbold(?:er)?\b/,zM=16,hw=13.3333333,wW=.01*zM,TW={"xx-small":9,"x-small":10,smaller:13.3333,small:13,medium:16,large:18,larger:19.2,"x-large":24,"xx-large":32},T_=new Map;function CW(t){if(T_.has(t))return T_.get(t);const e=bW.exec(t);if(!e)return;const s={};s.family=(e[6]||"").trim();let n=TW[e[2]]||parseFloat(e[2]);if(e[3]==="%"?n*=wW:e[3]==="em"?n*=zM:e[3]==="pt"&&(n*=hw),s.size=n,e[4]==="normal"||e[4]==="inherit"||!e[4]?s.height=Math.round(n*(7/6)):!e[5]||e[5]==="em"?s.height=parseFloat(e[4]||"")*n:e[5]==="pt"?s.height=parseFloat(e[4]||"")*hw:e[5]==="%"?s.height=n*.01:s.height=parseFloat(e[4]||""),s.variant=EW.test(e[1])?"small-caps":"normal",s.style=SW.test(e[1])?"italic":"normal",AW.test(e[1]))s.weight=700;else{const i=/\b(\d+)\b/.exec(e[1]),r=i?parseInt(i[1],10):400;r>=100&&r!==400?s.weight=r:s.weight=400}return T_.set(t,s),s}const LW="12px/14px sans-serif";class Si{constructor(e=LW){let s,n=14,i=12,r=400,o="normal",a="normal",l=0,u;if(typeof e=="string"){const h=CW(e);h&&(s=h.family,i=h.size,n=h.height||14,a=h.variant,o=h.style,r=h.weight)}else e instanceof Si&&(s=e.family,i=e.size,n=e.height,a=e.variant,r=e.weight,o=e.style,l=e.baseline,u=e.color);this.family=s||"sans-serif",this.size=i||i===0?i:12,this.height=n||n===0?n:this.size*(7/6),this.variant=a||"",this.style=o||"",this.weight=r||400,this.baseline=l||0,this.color=u||""}assign(e={}){const s=new Si(this);return e.bold&&(s.weight=700),e.weight&&(s.weight=e.weight),e.italic&&(s.style="italic"),e.family&&(s.family=e.family),e.style&&(s.style=e.style),e.color&&(s.color=e.color),typeof e.baseline=="number"&&(s.baseline=e.baseline),typeof e.size=="number"&&(s.size=e.size),s}toString(e){let s="";return this.style&&this.style!=="normal"&&(s+=this.style),this.variant&&this.variant!=="normal"&&(s+=(s?" ":"")+this.variant),this.weight&&this.weight!==400&&(s+=s?" ":"",this.weight===700?s+="bold":s+=this.weight),this.size&&(s+=(s?" ":"")+this.size+"px",this.height!==this.size&&(s+="/"+this.height+"px")),this.family&&(s+=(s?" ":"")+this.family),e&&(s+="::"+this.baseline),e&&(s+="::"+this.color),s}valueOf(){return this.toString(!0)}}const DM={"\n":.28,"\r":.28," ":.28,"":.28,"":.28,"":0,"":.5,"":1,"":.5,"":1,"":.33,"":.25,"":.16,"":.56,"":.28,"":.2,"":.15,"":0,"":.16,"":.22,"":1,"\uFEFF":0},NW=new Si,cw={trim:!0,collapse:!0},C_={};function ox(){return(t,e)=>{const s=new Si(e);let n=s.size;return/\bmonospace\b/.test(s.family)?n*=.6:(n*=.45,s.weight>400&&(n*=1.18)),t.length*n}}function ax(t){if(t&&t.getContext){const e=t.getContext("2d");if(e&&typeof e.measureText=="function")return(s,n)=>(e.font=String(n),e.measureText(s).width)}}function OM(){const t=typeof document<"u"?document:null;return typeof OffscreenCanvas<"u"&&new OffscreenCanvas(100,100)||t&&t.createElement&&t.createElement("canvas")||null}let Bd=ax(OM())||ox();function MW(t){if(t==null)Bd=ax(OM())||ox();else if(t)Bd=ax(t)||ox();else throw new Error("setMeasureCanvas argument is not a canvas or null")}function zo(t,e,s=cw){typeof e=="string"?e=new Si(e):e instanceof Si?e=NW.assign(e):e=new Si().assign(e);const n=Object.assign({},cw,s);let i=String(t);if(!i)return 0;if(i in DM){const o=e.valueOf()+"/"+i;return o in C_||(C_[o]=Bd(`_${i}_`,e)-Bd("__",e)),C_[o]}!n.trim||!n.collapse?i=i.replace(/\n/g," "):n.trim?i=i.replace(/\n/g," ").trim():n.collapse&&(i=i.replace(/\s+/g," "));const r=typeof t=="string"?0:t.tracking||0;return Bd(i,e)+e.size*r}class Qs{constructor(e=""){this.value=e,this.font=null,this.href="",this.sub=!1,this.sup=!1,this.width,this.line,this.tracking,this.whitespace}clone(){const e=new Qs(this.value);return Object.assign(e,this)}valueOf(){return this.value}toString(){return this.value}}class uh extends Qs{}class Ai extends Qs{}class Ia extends Qs{}const IW=/[\r\n\xA0]+/g,gw=.7;function kW(t,e){t.sup&&(t.baseline=.45,t.size=gw),t.sub&&(t.baseline=-.3,t.size=gw);let s=e;return(t.style||t.weight||t.baseline||t.color||t.size||t.family)&&(s=e.assign(t)),s}function fw(t,e,s){let n=t.width,i,r;for(;n+s.width>e&&t.length;)i=t[t.length-1],r=i.width,i.width>s.width?(i.value=i.value.slice(0,-1),i.width=zo(i,i.font),n+=i.width):t.pop(),n-=r;t[t.length-1]instanceof Ia&&t.pop(),i=t[t.length-1]||i||{},s.font=s.font.assign(i),s.href=t.length?i.href:null,s.rel=t.length?i.rel:null,s.target=t.length?i.target:null,t.push(s)}function mw(t){return Object.assign([],{height:0,font:t,width:0,hasOverflow:!1,hasLineOverflow:!1})}function RW(t,e,s){if(!t.length)return mw(s);const n=e.height(),i=e.width(),r=e.overflowLine(),o=e.overflowWrap(),a=s.assign({bold:!0}),l=isFinite(n())?Math.floor(n()/s.height):1/0;if(!n()&&!i(0)||!l)return mw(s);let u=0,h=0,g=0;const f=[];let m=[],y=!1;for(;u<t.length&&h<l;){const w=t[u],L=kW(w,s);if(w.width=zo(w,L),w.font=L,w.line=h,w.whitespace=w.value in DM,w.value&&(w.value=w.value.replace(IW," ")),!(!g&&w.whitespace||y&&w.whitespace))if(w instanceof Ai)g=0,m=[],f.push(u+1),h++;else if(w instanceof uh||w instanceof Ia)m.push({index:u,width:g});else if(w.whitespace||g+w.width<i(h))g+=w.width;else if(m.length){let k,F;do{F=!0,k=m.pop();const O=t[k.index];let j;O instanceof Ia&&(j=zo("-",O.font||s),k.width+j>i(h)&&(F=!m.length))}while(!F);f.push(k.index+1),g=0,h++,u=k.index,m=[]}else if(o==="break-word"){const k=i(h);if(g+w.width>k){const F=w.clone();do w.value=w.value.slice(0,-1),w.width=zo(w,w.font||s),g+=w.width;while(w.value&&w.width>k);F.value=F.value.slice(w.value.length),t.splice(u+1,0,new uh,F)}f.push(u+1),g=0,h++}else g+=w.width;u++,y=w.whitespace}u!==f[f.length-1]&&f.push(u);let p=0,x=0;const v=f.map(w=>{let L=p,k;for(;(k=t[L])&&(k.whitespace||!k.value);)L++;let F=w,O=null;for(;F>L&&(k=t[F-1])&&(k.whitespace||!(k.value||k instanceof Ia));)k instanceof Ai&&(O=k),F--;k instanceof Ia&&(k.value="-",k.width=zo("-",k.font||s)),p=w;const j=Object.assign(t.slice(L,F).filter(V=>V.value),{width:0});return O&&j.push(O),j.width=j.reduce((V,Z)=>V+Z.width,0),j.width>x&&(x=j.width),j});let b=!1;if(r){const w=r==="ellipsis"?"":r;v.forEach((L,k)=>{const F=i(k);if(L.width>F){const O=new Qs(w);O.font=s,O.width=zo(w,a),fw(L,F,O),b=!0}})}let S=!1;const A=e.overflow()==="ellipsis"?"":e.overflow();if(A&&u!==t.length){const w=i(v.length-1),L=v[v.length-1],k=new Qs(A);k.font=s,k.width=zo(A,a),fw(L,w,k),S=!0}else S=!1;return Object.assign(v,{height:v.length*s.height,font:s,width:x,hasOverflow:S,hasLineOverflow:b})}function Il(t){return Math.round(t*1e6)/1e6}const FW={center:"middle",right:"end"},PW={middle:.5,center:.5,bottom:1,end:1},L_=(t,e)=>!t&&!e||t===e;function zW(t,e){const s=[],n=e.font(),i=n.size,r=n.family,o=e.align(),a=e.createElement();if(t.length){const l=n.height,u=e.valign(),h=e.height()(),g=e.width()(0),f=!isFinite(g)&&t.length===1,m=f?null:e.x(),y=Il(l/i);let p=f?null:Il(l/(i*1.15+(l-i)/2));if(PW[u]&&isFinite(h)){const k=u==="bottom"?1:.5;p=(p||0)+(h*k-l*t.length*k)/i}const x=o==="justify";let v=0;o==="right"?v=g:o==="center"&&(v=g/2);let b=[],S="tspan",A=null,w="";const L=()=>{if(w){const k=a(S,A,w);b.push(k)}S="tspan",A=null,w=""};for(let k=0,F=t.length;k<F;k++){let O="",j="",V=0;const Z=t[k];if(!Z.length){s.push(a("tspan",{x:m(k),dy:Il(k?y:p)+"em"},""));continue}b=[];let at=0,mt=0,K;for(let ut=0,ht=Z.length;ut<ht;ut++){const nt=Z[ut],ot=nt.font;nt.whitespace&&at++,mt+=nt.width,ut&&!nt.tracking&&!V&&L_(ot.id,O)&&L_(nt.class,j)&&L_(K,nt.href)?w+=nt.value:(L(),w=nt.value,A={fontFamily:ot.family!==r?ot.family:null,fontSize:ot.size!==i?ot.size:null,fontWeight:ot.weight!==400&&ot.weight||null,fontStyle:ot.style!=="normal"&&ot.style||null,fontVariant:ot.variant!=="normal"&&ot.variant||null,fill:ot.color||null,baselineShift:ot.baseline?ot.baseline*100+"%":null,className:nt.class||null,dx:0,href:null,rel:null,target:null},V&&(A.dx=Il(V),V=0),nt.tracking&&(V=ot.size*nt.tracking),nt.href&&!K?(K=nt.href,S="a",A.href=K,A.rel=nt.rel,A.target=nt.target):K=null,O=ot.id,j=nt.class)}if(L(),f)s.push(...b);else{let ut=null;const ht=k===F-1||Z[Z.length-1]instanceof Ai;if(x&&Z.length>1&&!ht){const nt=g-mt;ut=Il(nt/at)}s.push(a("tspan",{wordSpacing:ut,x:m(k)+v,dy:Il(k?y:p)+"em"},...b))}}}return a("text",{fontFamily:r,fontSize:i,textAnchor:FW[o]||"start"},...s)}const DW={middle:.5,center:.5,bottom:1,end:1};function OW(t,e){return t.color?t.color:e.href?"#00C":"#000"}function BW(t,e,s){if(!t.length)return;s.textBaseline="middle";const n=e.font(),i=n.height,r=n.size,o=e.valign(),a=e.height()(),l=e.width()(0),u=e.align(),h=u==="justify";let g=i*.5;const f=DW[o];if(f&&isFinite(a)){const m=t.length*i;g+=a*f-m*f}t.forEach((m,y)=>{let p=e.x()(y);const x=y*i+g;let v=0,b=0;m.forEach(w=>{w.whitespace&&v++,b+=w.width});let S=0;const A=y===t.length-1||m[m.length-1]instanceof Ai;h&&m.length>1&&!A&&(S=(l-b)/v),m.forEach(w=>{s.font=w.font;const L=w.font,k=L.baseline?r*-L.baseline+r*.15:0;s.fillStyle=OW(L,w);let F=0;if(u==="right"?F+=l-b:u==="center"?F+=l/2-b/2:u==="justify"&&(w.whitespace||w instanceof Ai)&&(p+=S),s.fillText(w.value,p+F,x+k),w.href){s.beginPath(),s.strokeStyle=s.fillStyle;const O=Math.floor(x+r*.45)+.5;s.moveTo(p+F,O),s.lineTo(p+F+w.width,O),s.stroke()}p+=w.width})})}function BM(t){const e={};for(let s=0;s<t.length;s++){const n=t[s];typeof n=="number"||n==null||(typeof n=="string"?e.text=n:typeof n=="function"?e.fn=n:typeof n=="object"&&n._groups?e.d3=n:n&&n.nodeType&&n.getContext?e.ctx=n.getContext("2d"):n&&n.fillText&&n.beginPath?e.ctx=n:n&&(e.text=n))}return e}const UW=Object.prototype.hasOwnProperty,N_={};function GW(t){return N_[t]||(N_[t]=t.replace(/([a-z])([A-Z])/g,(e,s,n)=>s+"-"+n.toLowerCase())),N_[t]}function UM(t,e){if(Array.isArray(e))return e.forEach(s=>UM(t,s));typeof e=="string"&&(e=document.createTextNode(e)),t.appendChild(e)}function GM(t,e,...s){if(typeof document>"u")throw new Error("No document found, cannot create elements");const n=typeof t=="string"?document.createElementNS("http://www.w3.org/2000/svg",t):t;if(e&&n.setAttribute)for(const i in e)UW.call(e,i)&&e[i]!=null&&n.setAttribute(i==="className"?"class":GW(i),String(e[i]));return s!=null&&s.length&&s.forEach(i=>{UM(n,i)}),n}const pw=t=>typeof t=="function"?t:()=>t,VW={top:{vAnchor:-0},middle:{vAnchor:-.5},bottom:{vAnchor:-1},left:{hAnchor:-0},center:{hAnchor:-.5},right:{hAnchor:-1}},Tf=class Tf{constructor(e){if(this.props={width:()=>1/0,height:()=>1/0,rotation:0,vAnchor:0,hAnchor:0},e)for(const s in e)typeof this[s]=="function"&&this[s](e[s]);this.render=this.render.bind(this)}anchor(e){const{hAnchor:s,vAnchor:n,width:i,height:r}=this.props;if(!arguments.length)return[s*i(),n*r()];if(typeof e=="string"){const o=this.props;e.toLowerCase().trim().split(/\s+/).forEach(a=>Object.assign(o,VW[a]))}return this}width(e){return arguments.length?(this.props.width=pw(e),this):this.props.width}height(e){return arguments.length?(this.props.height=pw(e),this):this.props.height}rotate(e){return arguments.length?(this.props.rotation=e,this):this.props.rotation}createElement(e){return arguments.length?(this.props.createElement=e,this):this.props.createElement||Tf.createElement}canvas(e,s){const n=e.getContext?e.getContext("2d"):e;return n.save(),n.rotate(this.rotate()*Math.PI/180),n.translate(...this.anchor()),s(n),n.restore(),n}render(...e){const s=BM(e);if(s.d3)return s.d3.attr("transform",`rotate(${this.rotate()}) translate(${this.anchor()})`);if(s.ctx)return this.canvas(s.ctx,s.fn);if(s.text){const n=typeof s.text.render=="function"?s.text.render():s.text;return this.createElement()("g",{transform:`rotate(${this.rotate()}) translate(${this.anchor()})`},n)}}};Qt(Tf,"createElement",GM);let lx=Tf;const M_=/^[\n\r\t\x20\xA0\u2000-\u200B\u205F\u3000]/,jW=/^[^\n\r\t\u0020\u2000-\u200B\u205F\u3000]{2,}/,_w=/^[\xA0\u2011\u202F\u2060\uFEFF]/,HW=/^(?:[;\xAD%?]|,(?!\d))/,$W=/^[$\u2212]/,qW="'[<{(<".split(""),YW="',,!?]>})".split(""),yw=t=>{const e=t.charCodeAt(0);return e>=19968&&e<=40959};function wf(t,e){e!==!1&&(t=t.trim());const s=[];let n=t.charAt(0),i,r,o=0;for(let a=1,l=t.length;a<l;a++){i=t.charAt(a),r=t.charAt(a+1);const u=M_.test(n),h=M_.test(i);let g=h||u||yw(n)||yw(i),f;if(($W.test(i)&&!_w.test(n)||HW.test(n+r)&&!_w.test(i))&&(g=!0),g&&(YW.includes(i)||qW.includes(n))&&(g=!1),(n==="-"||n===""||n===""||n==="")&&(f=M_.test(t.charAt(a-2)),f&&!h&&(g=!1),!f&&jW.test(i+r)&&(g=!0)),g){const m=t.slice(o,a);/\u00AD$/.test(m)?(s.push(new Qs(m.slice(0,-1))),s.push(new Ia)):(s.push(new Qs(m)),s.push(new uh)),o=a}n=i}return s.push(new Qs(t.slice(o))),s}const xw={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:""},WW=/^[\n\r\x20\u2000-\u200B\u205F\u3000]/,XW=/^<\/([a-zA-Z0-9]+)([^>]*)>/,ZW=/^<([a-zA-Z0-9]+)((?:\s[^=\s/]+(?:\s*=\s*(?:"[^"]+"|'[^']+'|[^>\\s]+))?)+)?\s*(\/?)>(\n*)/,KW=/^<!--(.+?)-->/,QW=/&(?:#(\d\d{2,})|#x([\da-fA-F]{2,})|([a-zA-Z][a-zA-Z1-4]{1,8}));/g,vw={b:t=>t.weight=700,strong:t=>t.weight=700,i:t=>t.style="italic",em:t=>t.style="italic",dfn:t=>t.style="italic",cite:t=>t.style="italic",code:t=>t.family="monospace",kbd:t=>t.family="monospace",samp:t=>t.family="monospace",var:t=>t.family="monospace",tt:t=>t.family="monospace",sub:t=>t.sub=!0,sup:t=>t.sup=!0},JW={div:1,li:1,blockquote:2,h1:2,h2:2,h3:2,h4:2,h5:2,h6:2,ul:2,ol:2,hr:2,p:2};function VM(t){return t.replace(QW,function(e,s,n,i){if(s||n){const r=s?10:16;return String.fromCharCode(parseInt(s||n,r))}else if(i in xw)return xw[i];return e})}function tX(t){return t&&t.length>1&&(t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'")?t.slice(1,-1):t}const eX=/^\s*([^=\s&]+)(?:\s*=\s*("[^"]+"|'[^']+'|[^>\s]+))?/;function sX(t){let e;const s={};if(t){do if(e=eX.exec(t),e){const n=VM(tX(e[2]||"")).replace(/[ \r\n\t]+/g," ").trim();if(s[e[1]]=n,t=t.slice(e[0].length),t.length&&/^\S/.test(t[0]))throw new Error("Attribute error")}while(e&&t.length);if(/\S/.test(t))throw new Error("Attribute error")}return s}function nX(t){t=String(t||"").trim();let e={weight:null,style:null,sub:!1,sup:!1,href:null,color:null,rel:null,target:null};const s=[],n=[];let i,r;const o=function(g){for(const f in e)e[f]&&(g[f]=e[f]);s.push(g)},a=()=>{n.push(e),e=Object.create(e)},l=()=>{n.length&&(e=n.pop())},u=g=>{const f=s.length;let m=JW[g];if(f&&m){let y=f-1;for(;s[y]&&(s[y]instanceof uh||WW.test(s[y].value));)y--;for(;m&&s[y]&&s[y]instanceof Ai;)y--,m--;for(;m-- >0;)s.push(new Ai)}};for(;t.length;){if(i=/^[^<]+/.exec(t)){const g=VM(i[0]);wf(g,!1).forEach(o)}else if(!(i=KW.exec(t)))if(i=XW.exec(t))l(),u(i[1]);else if(i=ZW.exec(t)){const g=i[1];u(g),a(),vw[g]&&vw[g](e);const f=sX(i[2]);g==="a"&&(f.href&&(e.href=f.href),f.rel&&(e.rel=f.rel),f.target&&(e.target=f.target)),f.class&&(e.class=e.class?e.class+" "+f.class:f.class),f.style&&(r=/(?:^|\s|;)color\s*:\s*([^;\s"']+)/.exec(f.style),r&&r[1]&&(e.color=r[1])),g==="br"&&s.push(new Ai)}else i=[t.slice(0,1)],o(new Qs(i[0]));t=t.slice(i[0].length)}let h=s[s.length-1];for(;h instanceof Ai;)s.pop(),h=s[s.length-1];return s}const bw={copyright:"",textcopyright:"",dag:"",textdagger:"",ddag:"",textdaggerdbl:"",guillemotleft:"",guillemotright:"",guilsinglleft:"",guilsinglright:"",ldots:"",dots:"",textellipsis:"",lq:"",P:"",textparagraph:"",pounds:"",textsterling:"",quotedblbase:"",quotesinglbase:"",rq:"",S:"",sim:"~",textasciicircum:"^",textasciitilde:"",texttildelow:"~",textasteriskcentered:"*",textbackslash:"'",textbar:"|",textbardbl:"",textbigcircle:"",textbraceleft:"{",textbraceright:"}",textbullet:"",textdollar:"$",textemdash:"",textendash:"",texteuro:"",eurosym:"",euro:"",textexclamdown:"",textgreater:">",textless:"<",textordfeminine:"",textordmasculine:"",textperiodcentered:"",cdot:"",textquestiondown:"",textquotedblleft:"",textquotedblright:"",textquoteleft:"",textquoteright:"",textquotestraightbase:"",textquotestraightdblbase:"",textregistered:"",textthreequartersemdash:"-",texttrademark:"",texttwelveudash:"-",textunderscore:"_",textvisiblespace:"",gets:"",textleftarrow:"",to:"",textrightarrow:"",textdegree:"",infty:"",triangle:"",triangledown:"",blacktriangle:"",blacktriangledown:"",angle:"",sphericalangle:"",aleph:"",hbar:"",imath:"",jmath:"",ell:"",wp:"",Re:"",Im:"",mho:"",prime:"",emptyset:"",nabla:"",surd:"",partial:"",top:"",bot:"",vdash:"",dashv:"",forall:"",exists:"",nexists:"",neg:"",lnot:"",flat:"",natural:"",sharp:"",backslash:"\\",Box:"",Diamond:"",clubsuit:"",diamondsuit:"",heartsuit:"",spadesuit:"",Join:"",blacksquare:"",bigstar:"",diagdown:"",diagup:"",blacklozenge:"",rfloor:"",lfloor:"",rceil:"",lceil:"",rangle:"",langle:"",sum:"",int:"",oint:"",prod:"",coprod:"",bigcap:"",bigcup:"",bigsqcup:"",bigvee:"",bigwedge:"",bigodot:"",bigotimes:"",bigoplus:"",biguplus:"",alpha:"",beta:"",chi:"",delta:"",epsilon:"",eta:"",gamma:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",omega:"",phi:"",pi:"",psi:"",rho:"",sigma:"",tau:"",theta:"",upsilon:"",xi:"",zeta:"",Alpha:"",Beta:"",Chi:"",Delta:"",Epsilon:"",Eta:"",Gamma:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Omega:"",Phi:"",Pi:"",Psi:"",Rho:"",Sigma:"",Tau:"",Theta:"",Upsilon:"",Xi:"",Zeta:"",aa:"",AA:"",ae:"",AE:"",dh:"",DH:"",dj:"",DJ:"",ij:"",IJ:"",l:"",L:"",ng:"",NG:"",o:"",O:"",oe:"",OE:"",ss:"",SS:"SS",th:"",TH:""},iX=/^(\^|_|\\[^#$%&~_^\\{}()\s]+)(\{)?/,rX=/^%[^\n]+(?:\n|$)/,oX=/^[^#$%&~_^\\{}]+/,aX=/^\\([&{}$%#_])/,lX=/(?:\\[\\@,!:;-]|-{2,3}|[!?]`|``?|,,|''?|~|<<|>>)/g,uX={"---":"","--":"","!`":"","?`":"","``":"",",,":"","''":"","`":"","'":"","<<":"",">>":"","~":"","\\-":"","\\,":"","\\;":"","\\:":"","\\!":"","\\@":"\uFEFF","\\\\":"\\newline{}"},bn={bf:t=>t.weight="bold",it:t=>t.style="italic",sl:t=>t.style="italic",color:(t,e)=>t.color=e,href:(t,e)=>t.href=e,"^":t=>t.sup=!0,_:t=>t.sub=!0,par:function(t){this.tokens.push(new Ai,new Ai)},newline:function(t){this.tokens.push(new Ai)},url:function(t,e){t=this.open_context(),t.href=e,this.add_token(new Qs(e)),this.close_context()}};bn.textsuperscript=bn["^"];bn.textsubscript=bn._;bn.textsl=bn.sl;bn.mathbf=bn.bf;bn.mathit=bn.it;bn.textbf=bn.bf;bn.textit=bn.it;bn.textcolor=bn.color;function dX(t){t=String(t||"").trim();const e=[0];t=t.replace(/\\verb,(.*?),/,(h,g)=>(e.push(g),"\\verb,"+(e.length-1)+",")).replace(/\\\\\n/g,()=>"\\\\").replace(lX,(h,g,f)=>f.charAt(g-1)==="\\"?h:uX[h]).replace(/\n\s+/g,h=>/\n/.test(h.slice(1))?"\\par ":h).replace(/\\symbol\{(\d+)\}/,(h,g,f,m)=>m.charAt(f-1)==="\\"?h:String.fromCharCode(1*g)).replace(/(^|[^\\])(\^|_)(\d|[^{]\S*)/g,(h,g,f,m)=>g+f+"{"+m+"}").replace(/\\verb,(.*?),/,(h,g)=>`\\verb,${e[+g]},`);let s={weight:null,italic:null,variant:null,sub:!1,sup:!1,href:null};const n=[],i=[];let r;const o=function(h){for(const g in s)s[g]&&(h[g]=s[g]);return n.push(h),h},a=function(){i.push(s),s=Object.create(s)},l=function(){if(!i.length)throw new Error("Unexpected }");s=i.pop()},u={tokens:n,open_context:a,close_context:l,add_token:o};for(;t.length;){if(r=oX.exec(t))wf(r[0],!1).forEach(o);else if(r=aX.exec(t))o(new Qs(r[1]));else if(!(r=rX.exec(t))){if(r=/^\{/.exec(t))a();else if(r=/^\}/.exec(t))l();else if(!(r=/^\$/.exec(t)))if(r=/^\\verb,([^,]+),/.exec(t))o(new Qs(r[1]));else if(r=iX.exec(t)){const h=r[1].slice(1)||r[1];let g=!!r[2];if(/^(La)?TeX$/i.test(h)){a(),s.family="serif";let f;h==="LaTeX"&&(f=o(new Qs("L")),f.tracking=-.25,f=o(new Qs("A")),f.size=.7,f.baseline=.3,f.tracking=-.1),f=o(new Qs("T")),f.tracking=-.17,f=o(new Qs("E")),f.baseline=-.22,f.tracking=-.13,f=o(new Qs("X")),l()}else if(h in bw)o(new Qs(bw[h])),g&&a();else if(h in bn){const f=[];let m=bn[h].length-1,y;if(m){for(g=!1,t=t.slice(r[0].length-1);m--;)if(y=/^\{([^}]+)\}/.exec(t))f.push(y[1]),t=t.slice(y[0].length);else throw new Error(h+" is missing an argument");r[0]=/^\{/.exec(t)?"{":"",g=!!r[0]}g&&a(),bn[h].apply(u,[s,...f])}else o(new Qs(r[1])),g&&a()}else r=[t.slice(0,1)],o(new Qs(r[0]))}t=t.slice(r[0].length)}return n}const hX=new Si,I_=t=>typeof t=="function"?t:()=>t,Ew={left:"left",start:"left",center:"center",middle:"center",right:"right",end:"right",justify:"justify"},vn=class vn{constructor(e){this.props={overflow:"ellipsis",overflowWrap:null,overflowLine:"",align:"left",wordBreak:null,valign:"top",width:()=>1/0,height:()=>1/0,x:()=>0,font:hX,parser:vn.defaultparser},e&&(e.font&&this.font(e.font),e.overflow&&this.overflow(e.overflow),e.overflowLine&&this.overflowLine(e.overflowLine),e.overflowWrap&&this.overflowWrap(e.overflowWrap),e.valign&&this.valign(e.valign),e.align&&this.align(e.align),e.width&&this.width(e.width),e.height&&this.height(e.height),e.x&&this.x(e.x),e.parser&&this.parser(e.parser),e.createElement&&this.createElement(e.createElement))}linebreak(e){const s=this.props.parser(String(e)),n=RW(s,this,this.font()),i=r=>this.render(n,r);return Object.assign(n,{render:i,svg:i,draw:i})}font(e){return arguments.length?(this.props.font=new Si(e),this):this.props.font||new Si}overflow(e){return arguments.length?(this.props.overflow=String(e),this):this.props.overflow}overflowLine(e){return arguments.length?(this.props.overflowLine=String(e),this):this.props.overflowLine}valign(e){return arguments.length?(this.props.valign=e,this):this.props.valign}align(e){if(!arguments.length)return this.props.align;const s=String(e).toLowerCase();return s in Ew&&(this.props.align=Ew[s]),this}overflowWrap(e){if(!arguments.length)return this.props.overflowWrap||"normal";const s=String(e).toLowerCase();return s==="break-word"?this.props.overflowWrap="break-word":(s==="normal"||e==null)&&(this.props.overflowWrap=null),this}width(e){return arguments.length?(this.props.width=I_(e),this):this.props.width}height(e){return arguments.length?(this.props.height=I_(e),this):this.props.height}x(e){return arguments.length?(this.props.x=I_(e),this):this.props.x}parser(e){if(!arguments.length)return this.props.parser;if(typeof e=="string"){const s=vn[e]||vn[e+"parser"];typeof s=="function"&&(e=s)}if(typeof e!="function")throw new Error("Unknown parser: "+e);return this.props.parser=e,this}createElement(e){return arguments.length?(this.props.createElement=e,this):this.props.createElement||vn.createElement}render(e,s){const n=BM([e,s]);if(typeof n.text=="string"&&(n.text=this.linebreak(n.text)),n.ctx)BW(n.text,this,n.ctx);else return zW(n.text,this)}};Qt(vn,"createElement",GM),Qt(vn,"textparser",wf),Qt(vn,"defaultparser",wf),Qt(vn,"htmlparser",nX),Qt(vn,"latexparser",dX),Qt(vn,"Token",Qs),Qt(vn,"Break",uh),Qt(vn,"LineBreak",Ai),Qt(vn,"SoftHyphen",Ia),Qt(vn,"Rotator",lx),Qt(vn,"Font",Si),Qt(vn,"setMeasureCanvas",MW),Qt(vn,"measureText",function(e,s,n){return zo(e,new Si(s),n)});let Ud=vn;function jM(t,e,s,n){const{width:i,height:r}=qn(e),{color:o=jn.color,strokeColor:a=jn.strokeColor,strokeWidth:l=jn.strokeWidth,strokeType:u=jn.strokeType,background:h=jn.background,borderRadius:g=jn.borderRadius,fixedSize:f=jn.fixedSize}=e.properties.style||jn,m=PM(t,e,s,n);m.setAttribute("data-annotation-type",e.properties.type),m.classList.add("annotation-text"),m.setAttribute("fill",`${o}`);let y=m.firstChild;for(;y;){const S=y.nextSibling;y.nodeType===1&&y.tagName!=="rect"&&m.removeChild(y),y=S}let p=m.firstChild;p||(p=As("rect"),m.appendChild(p));const x=-i/2,v=-r/2;g&&(p.setAttribute("rx",`${g}`),p.setAttribute("ry",`${g}`)),u&&u!=="none"&&(p.setAttribute("stroke",a||"black"),p.setAttribute("stroke-width",`${l}`),u==="dashed"&&p.setAttribute("stroke-dasharray","5,5")),h&&h.length&&(n.hoveredFeature===e.id?p.setAttribute("fill",sm(h)):p.setAttribute("fill",h)),p.setAttribute("width",`${i}`),p.setAttribute("height",`${r}`);const b=Ei(e);return p.setAttribute("x",`${x}`),p.setAttribute("y",`${v}`),cX(e,m,x,v),m.setAttribute("transform",n.getScreenAlignedTransform(b.x,b.y,!f)),t.appendChild(m),m}const Sw=t=>t.replace(/$/,""),Aw=t=>t.children[0].innerHTML;function cX(t,e,s=0,n=0){const{width:i,height:r}=qn(t),{fontSize:o=jn.fontSize,font:a=jn.font,padding:l=0}=t.properties.style||{};if(i===r&&i===0)return;const u=parseFloat(o.toString())*AM,h=new Ud({font:`${o}px/${u}px ${a}`.replace(/(px)+/g,"px"),width:i-l*2,height:r-l,align:"left",valign:"top",x:0,overflow:"ellipsis",parser:Ud.htmlparser,createElement:Ud.createElement});h.overflowWrap("break-word");const g=t.properties.content||"";if(g.length===0)return;const f=h.linebreak(g.replaceAll(`
`,"<br>")).svg(),m=[...f.children],y=g.match(/(https?:\/\/.*)/gm);(y?y.map(p=>p.split(" ")[0]):[]).forEach(p=>{let x=p;const v=[];for(;x.length>0;){const b=m.find(A=>!!A.children[0]&&A.children[0].tagName==="tspan"&&x.startsWith(Sw(Aw(A))));if(!b)break;v.push(b);const S=Sw(b.children[0].innerHTML).length;if(!S)break;x=x.slice(S)}v.forEach(b=>{const S=document.createElementNS("http://www.w3.org/2000/svg","a");S.setAttribute("href",p),S.setAttribute("target","_blank"),S.innerHTML=Aw(b),b.children[0].innerHTML="",b.children[0].appendChild(S)})}),f.setAttribute("transform",`translate(${s+l}, ${n+l})`),e.appendChild(f)}function gX(t,e,s){const n={...Ea,...e.properties.style},i=n.iconSize,{iconColor:r=Ea.iconColor,iconSymbol:o=Ea.iconSymbol,iconBorderColor:a=Ea.iconBorderColor,iconBorderWidth:l=Ea.iconBorderWidth}=n;let u=t.querySelector("circle");u||(u=As("circle"),u.setAttribute("cx","0"),u.setAttribute("cy","0"),t.appendChild(u)),u.setAttribute("r",`${i/2}`),s.hoveredFeature===e.id?u.setAttribute("fill",sm(r)):u.setAttribute("fill",r),l&&l>0?(u.setAttribute("stroke",a||"#CCC"),u.setAttribute("stroke-width",`${l}`)):(u.removeAttribute("stroke"),u.removeAttribute("stroke-width"));let h=t.querySelector("text");h||(h=As("text"),h.setAttribute("x","0"),h.setAttribute("y","0"),h.setAttribute("text-anchor","middle"),h.setAttribute("dominant-baseline","central"),h.setAttribute("pointer-events","none"),t.appendChild(h)),h.setAttribute("font-size",`${i*.5}`),h.textContent=o}function fX(t,e,s){const n={...e,properties:{type:"text",content:e.properties.content,width:e.properties.width,height:e.properties.height,style:{...e.properties.style,fixedSize:!0}}},i=As("g"),r=jM(i,n,void 0,s);for(t.innerHTML="";r.firstChild;)t.appendChild(r.firstChild);t.setAttribute("filter","url(#softShadow)")}function mX(t,e,s,n){const i=e.properties.mode;let r=s;r||(r=As("g"),r.setAttribute("data-annotation",`${e.id}`),r.setAttribute("data-annotation-type","comment"));let o=r.querySelector(".comment-icon");o||(o=As("g"),o.classList.add("comment-icon"),r.appendChild(o));let a=r.querySelector(".comment-box");a||(a=As("g"),a.classList.add("comment-box"),r.appendChild(a)),gX(o,e,n),fX(a,e,n),i===rh&&!r.classList.contains("comment-collapsed")?(r.classList.add("comment-collapsed"),r.classList.remove("comment-expanded")):i!==rh&&r.classList.contains("comment-collapsed")&&(r.classList.add("comment-expanded"),r.classList.remove("comment-collapsed"));const l=Ei(e);return r.setAttribute("transform",n.getScreenAlignedTransform(l.x,l.y,!1)),(!r.parentNode||r.parentNode!==t)&&t.appendChild(r),r}function pX(t,e=.5,s=!1){if(t.length<2)return"";if(t.length<3)return t.map((o,a)=>`${a===0?"M":"L"}${o[0]},${o[1]}`).join(" ")+" Z";const n=t,i=n.length-1,r=[];for(let o=0;o<i;o++){const a=n[(o-1+i)%i],l=n[o],u=n[(o+1)%i],h=n[(o+2)%i],g=l[0]+(u[0]-a[0])/6*e,f=l[1]+(u[1]-a[1])/6*e,m=u[0]-(h[0]-l[0])/6*e,y=u[1]-(h[1]-l[1])/6*e;o===0&&r.push(`M${l[0]},${l[1]}`),s&&o===i-1?r.push(`L${u[0]},${u[1]}`):r.push(`C${g},${f} ${m},${y} ${u[0]},${u[1]}`)}return r.push("Z"),r.join(" ")}const _X=(t,e,s="box")=>(t||(t=As("g"),t.setAttribute("data-annotation",`${e}`),t.classList.add(`annotation-${s}`)),t);function yX(t,e,s,n){const i=_X(s,e.id.toString(),e.properties.type);i.setAttribute("data-annotation",String(e.id));let r=i.querySelector("path");r||(r=As("path"),i.appendChild(r));const{strokeColor:o=Sa.strokeColor,strokeWidth:a=Sa.strokeWidth,background:l=Sa.background,strokeType:u=Sa.strokeType}=e.properties.style||Sa;o&&r.setAttribute("stroke",o),a!==void 0&&r.setAttribute("stroke-width",String(a)),l&&(n.hoveredFeature===e.id?r.setAttribute("fill",sm(l)):r.setAttribute("fill",l)),u&&r.setAttribute("stroke-dasharray",u);const h=e.geometry.coordinates[0],g=pX(h,.5,n.drawingFeature===e.id);return r.setAttribute("d",g),i.setAttribute("transform",n.getRotationTransform(0,0)),t.appendChild(i),i}class xX extends FM{constructor(s,n){super(s,n);Qt(this,"features",new Map);Qt(this,"arrowsRoot",null);Qt(this,"shapesRoot",null);Qt(this,"commentsRoot",null);Qt(this,"annotationsRoot",null);Qt(this,"render",s=>{const{features:n,hoveredFeature:i,selectedFeatures:r,liveUpdates:o}=this.store.getState();(!this.annotationsRoot||!s.contains(this.annotationsRoot))&&(s.innerHTML="",s.appendChild(this.getDefs()),this.arrowsRoot=As("g"),this.commentsRoot=As("g"),this.annotationsRoot=As("g"),this.shapesRoot=As("g"),this.annotationsRoot.appendChild(this.arrowsRoot),this.annotationsRoot.appendChild(this.shapesRoot),this.annotationsRoot.appendChild(this.commentsRoot),s.appendChild(this.annotationsRoot));const a=this.arrowsRoot,l=this.annotationsRoot,u=this.commentsRoot,h=this.shapesRoot,g=this.store.getState(),f=this.getViewportBounds(),m=new Set(Object.keys(n));this.removeFeatures(m);for(let y of Object.values(n)){if(o[y.id]&&(y={...y,...o[y.id]}),!this.isFeatureVisible(y,f))continue;let p=this.features.get(y.id);Ti(y)?p=PM(h,y,p,g):mn(y)?p=jM(h,y,p,g):kn(y)?p=mX(u,y,p,g):za(y)?p=yX(h,y,p,g):wi(y)&&(p=yW(a,y,g.options.minArrowHeight,g.options.maxArrowHeight,p,g)),p&&this.features.set(y.id,p)}this.applyStateClasses(l,i,r)});Qt(this,"refresh",()=>{this.layer.refresh()});this.layer=this.ogma.layers.addSVGLayer({draw:this.render},E0.SHAPES),this.store.subscribe(i=>({features:i.features,liveUpdates:i.liveUpdates,hoveredFeature:i.hoveredFeature,selectedFeatures:i.selectedFeatures,rotation:i.rotation,zoom:i.zoom}),this.layer.refresh,{equalityFn:(i,r)=>i.features===r.features&&i.liveUpdates===r.liveUpdates&&i.hoveredFeature===r.hoveredFeature&&i.selectedFeatures===r.selectedFeatures&&i.rotation===r.rotation&&i.zoom===r.zoom})}getViewportBounds(){const s=this.ogma,{width:n,height:i}=s.view.getSize(),r=1.5,o=s.view.screenToGraphCoordinates({x:0,y:0}),a=s.view.screenToGraphCoordinates({x:n*r,y:0}),l=s.view.screenToGraphCoordinates({x:0,y:i*r}),u=s.view.screenToGraphCoordinates({x:n*r,y:i*r});return[Math.min(o.x,a.x,l.x,u.x),Math.min(o.y,a.y,l.y,u.y),Math.max(o.x,a.x,l.x,u.x),Math.max(o.y,a.y,l.y,u.y)]}isFeatureVisible(s,n){const i=s.geometry.bbox;if(!i)return!0;const[r,o,a,l]=i;return!(a<n[0]||r>n[2]||l<n[1]||o>n[3])}getDefs(){const s=As("defs"),n=As("filter");n.setAttribute("id","softShadow"),n.setAttribute("x","-50%"),n.setAttribute("y","-50%"),n.setAttribute("width","200%"),n.setAttribute("height","200%");const i=As("feGaussianBlur");i.setAttribute("in","SourceAlpha"),i.setAttribute("stdDeviation","2"),i.setAttribute("result","blur");const r=As("feOffset");r.setAttribute("in","blur"),r.setAttribute("dx","0"),r.setAttribute("dy","1"),r.setAttribute("result","offsetBlur");const o=As("feComponentTransfer");o.setAttribute("in","offsetBlur"),o.setAttribute("result","shadow");const a=As("feFuncA");a.setAttribute("type","linear"),a.setAttribute("slope","0.25"),o.appendChild(a);const l=As("feMerge"),u=As("feMergeNode");u.setAttribute("in","shadow");const h=As("feMergeNode");return h.setAttribute("in","SourceGraphic"),l.appendChild(u),l.appendChild(h),n.appendChild(i),n.appendChild(r),n.appendChild(o),n.appendChild(l),s.appendChild(n),s}removeFeatures(s){for(const n of this.features.keys())if(!s.has(n)){const i=this.features.get(n);i&&i.parentNode&&i.parentNode.removeChild(i),this.features.delete(n)}}applyStateClasses(s,n,i){if(n!==null){const r=s.querySelector(`[data-annotation="${n}"]`);r&&r.classList.add("annotation-hovered")}i.forEach(r=>{const o=s.querySelector(`[data-annotation="${r}"]`);o&&o.classList.add("annotation-selected")})}destroy(){this.features.clear(),this.layer.destroy(),super.destroy()}}const ww=t=>{let e;const s=new Set,n=(a,l)=>{const u=typeof a=="function"?a(e):a;if(!Object.is(u,e)){const h=e;e=l??(typeof u!="object"||u===null)?u:Object.assign({},e,u),s.forEach(g=>g(e,h))}},i=()=>e,r={setState:n,getState:i,getInitialState:()=>o,subscribe:a=>(s.add(a),()=>s.delete(a))},o=e=t(n,i,r);return r},HM=t=>t?ww(t):ww;var Tw=(t,e,s)=>(n,i)=>({pastStates:(s==null?void 0:s.pastStates)||[],futureStates:(s==null?void 0:s.futureStates)||[],undo:(r=1)=>{var o,a;if(i().pastStates.length){const l=((o=s==null?void 0:s.partialize)==null?void 0:o.call(s,e()))||e(),u=i().pastStates.splice(-r,r),h=u.shift();t(h),n({pastStates:i().pastStates,futureStates:i().futureStates.concat(((a=s==null?void 0:s.diff)==null?void 0:a.call(s,l,h))||l,u.reverse())})}},redo:(r=1)=>{var o,a;if(i().futureStates.length){const l=((o=s==null?void 0:s.partialize)==null?void 0:o.call(s,e()))||e(),u=i().futureStates.splice(-r,r),h=u.shift();t(h),n({pastStates:i().pastStates.concat(((a=s==null?void 0:s.diff)==null?void 0:a.call(s,l,h))||l,u.reverse()),futureStates:i().futureStates})}},clear:()=>n({pastStates:[],futureStates:[]}),isTracking:!0,pause:()=>n({isTracking:!1}),resume:()=>n({isTracking:!0}),setOnSave:r=>n({_onSave:r}),_onSave:s==null?void 0:s.onSave,_handleSet:(r,o,a,l)=>{var u,h;s!=null&&s.limit&&i().pastStates.length>=(s==null?void 0:s.limit)&&i().pastStates.shift(),(h=(u=i())._onSave)==null||h.call(u,r,a),n({pastStates:i().pastStates.concat(l||r),futureStates:[]})}}),vX=(t,e)=>(s,n,i)=>{var l,u;i.temporal=HM(((l=e==null?void 0:e.wrapTemporal)==null?void 0:l.call(e,Tw(s,n,e)))||Tw(s,n,e));const r=((u=e==null?void 0:e.handleSet)==null?void 0:u.call(e,i.temporal.getState()._handleSet))||i.temporal.getState()._handleSet,o=h=>{var m,y,p;if(!i.temporal.getState().isTracking)return;const g=((m=e==null?void 0:e.partialize)==null?void 0:m.call(e,n()))||n(),f=(y=e==null?void 0:e.diff)==null?void 0:y.call(e,h,g);f===null||(p=e==null?void 0:e.equality)!=null&&p.call(e,h,g)||r(h,void 0,g,f)},a=i.setState;return i.setState=(...h)=>{var f;const g=((f=e==null?void 0:e.partialize)==null?void 0:f.call(e,n()))||n();a(...h),o(g)},t((...h)=>{var f;const g=((f=e==null?void 0:e.partialize)==null?void 0:f.call(e,n()))||n();s(...h),o(g)},n,i)};const bX=t=>(e,s,n)=>{const i=n.subscribe;return n.subscribe=(r,o,a)=>{let l=r;if(o){const u=(a==null?void 0:a.equalityFn)||Object.is;let h=r(n.getState());l=g=>{const f=r(g);if(!u(h,f)){const m=h;o(h=f,m)}},a!=null&&a.fireImmediately&&o(h,h)}return i(l)},t(e,s,n)},EX=bX;function SX(t,e,s,n,i,r,o,a,l){const u=t-o,h=e-a,g=o+u*r-h*i,f=a+u*i+h*r,m=o+(u+s)*r-h*i,y=a+(u+s)*i+h*r,p=o+(u+s)*r-(h+n)*i,x=a+(u+s)*i+(h+n)*r,v=o+u*r-(h+n)*i,b=a+u*i+(h+n)*r;return l[0]=Math.min(g,m,p,v),l[1]=Math.min(f,y,x,b),l[2]=Math.max(g,m,p,v),l[3]=Math.max(f,y,x,b),l}const AX=[0,0,0,0];function wX(t,e){const s=Object.keys(t.features),n=Object.keys(e.features);if(s.length!==n.length)return!1;for(const i of s)if(!(i in e.features))return!1;for(const i of s){const r=t.features[i],o=e.features[i],a=r.geometry,l=o.geometry;if(a.coordinates!==l.coordinates||r.properties!==o.properties||r.properties.style!==o.properties.style||a!==l)return!1}return t.drawingFeature===e.drawingFeature}const TX=t=>{const e=HM()(EX(vX((s,n)=>({features:{},liveUpdates:{},isDragging:!1,hoveringHandle:!1,hoveredHandle:-1,hoveredFeature:null,selectedFeatures:new Set,lastChangedFeatures:[],drawingFeature:null,drawingPoints:null,mousePressed:!1,mousePressPoint:null,rotation:0,sin:0,cos:1,revRotation:0,revSin:0,revCos:1,zoom:1,invZoom:1,options:{showSendButton:(t==null?void 0:t.showSendButton)??!0,sendButtonIcon:(t==null?void 0:t.sendButtonIcon)??wM,minArrowHeight:(t==null?void 0:t.minArrowHeight)??20,maxArrowHeight:(t==null?void 0:t.maxArrowHeight)??30,detectMargin:(t==null?void 0:t.detectMargin)??2,magnetRadius:(t==null?void 0:t.magnetRadius)??10,magnetHandleRadius:(t==null?void 0:t.magnetHandleRadius)??5,textPlaceholder:(t==null?void 0:t.textPlaceholder)??"Type here"},setOptions:i=>s(r=>({options:{...r.options,...i}})),removeFeature:i=>s(r=>{var u,h,g,f;const o=r.features[i];if(!o)return r;if(kn(o)){const m=[];Object.values(r.features).forEach(p=>{var x,v,b,S;wi(p)&&(((v=(x=p.properties.link)==null?void 0:x.end)==null?void 0:v.id)===i||((S=(b=p.properties.link)==null?void 0:b.start)==null?void 0:S.id)===i)&&m.push(p.id)});const y={...r.features};return m.forEach(p=>{delete y[p]}),delete y[i],{features:y}}if(wi(o)){const m=((h=(u=o.properties.link)==null?void 0:u.end)==null?void 0:h.type)==="comment"?o.properties.link.end.id:((f=(g=o.properties.link)==null?void 0:g.start)==null?void 0:f.type)==="comment"?o.properties.link.start.id:null;if(m){let y=0;if(Object.values(r.features).forEach(p=>{var x,v,b,S;wi(p)&&p.id!==i&&(((v=(x=p.properties.link)==null?void 0:x.end)==null?void 0:v.id)===m||((S=(b=p.properties.link)==null?void 0:b.start)==null?void 0:S.id)===m)&&y++}),y===0)return console.error("Cannot delete last arrow attached to comment. Delete the comment instead."),r}}const{[i]:a,...l}=r.features;return{features:l}}),addFeature:i=>s(r=>({features:{...r.features,[i.id]:i}})),startLiveUpdate:i=>{s(r=>({liveUpdates:i.reduce((o,a)=>({...o,[a]:{...r.features[a]}}),{})}))},applyLiveUpdate:(i,r)=>{s(o=>({liveUpdates:{...o.liveUpdates,[i]:{...o.liveUpdates[i],...r}}}))},commitLiveUpdates:i=>{const{features:r,liveUpdates:o}=n(),a={...r},l=[],u=Object.keys(o);i||(i=new Set(u)),u.forEach(h=>{const g=o[h];a[h]&&Object.keys(g).length>0&&(a[h]={...a[h],...g},l.push(h))}),s({features:a,liveUpdates:{},isDragging:!1,lastChangedFeatures:l})},cancelLiveUpdates:()=>s({liveUpdates:{},isDragging:!1}),updateFeature:(i,r)=>s(o=>{const a={...o.features[i],...r},l={...o.liveUpdates};return delete l[i],{features:{...o.features,[i]:a},liveUpdates:l}}),updateFeatures:i=>s(r=>{const o={...r.features};return Object.entries(i).forEach(([a,l])=>{o[a]&&(o[a]={...o[a],...l})}),{features:o}}),batchUpdate:i=>{const r=e.temporal.getState();r.pause(),i(),r.resume()},getFeature:i=>n().features[i],getMergedFeature:i=>{const r=n().features[i],o=n().liveUpdates[i];if(r)return o?{...r,...o}:r},getAllFeatures:()=>{const{features:i,liveUpdates:r}=n();return Object.entries(i).map(([o,a])=>{const l=r[o];return l?{...a,...l}:a})},setHoveredFeature:i=>s({hoveredFeature:i}),setSelectedFeatures:i=>s({selectedFeatures:new Set(i)}),addToSelection:i=>{const{selectedFeatures:r}=n(),o=new Set(r);o.add(i),s({selectedFeatures:o})},removeFromSelection:i=>{const{selectedFeatures:r}=n(),o=new Set(r);o.delete(i),s({selectedFeatures:o})},toggleSelection:i=>{const{selectedFeatures:r}=n(),o=new Set(r);o.has(i)?o.delete(i):o.add(i),s({selectedFeatures:o})},clearSelection:()=>s({selectedFeatures:new Set}),isHovered:i=>n().hoveredFeature===i,isSelected:i=>n().selectedFeatures.has(i),setRotation:i=>{s({rotation:i,sin:Math.sin(i),cos:Math.cos(i),revRotation:-i,revSin:Math.sin(-i),revCos:Math.cos(-i)})},setZoom:i=>{s({zoom:i,invZoom:1/i})},getScreenAlignedTransform(i,r,o=!0){const a=this.revSin,l=this.revCos,u=i*l-r*a,h=i*a+r*l,g=o?1:this.invZoom;return`matrix(${g}, 0, 0, ${g}, ${u}, ${h})`},getRotationTransform(i,r){const o=this.revSin,a=this.revCos,l=i*a-r*o,u=i*o+r*a;return`matrix(${a}, ${o}, ${-o}, ${a}, ${-l}, ${-u})`},getRotatedBBox(i,r,o,a){return SX(i,r,o-i,a-r,this.sin,this.cos,i+(o-i)/2,r+(a-r)/2,AX)},setDrawingPoints:i=>s({drawingPoints:i})}),{limit:50,partialize:s=>({drawingFeature:s.drawingFeature,isDragging:s.isDragging,features:s.features,lastChangedFeatures:s.lastChangedFeatures}),equality:wX,handleSet:s=>n=>{n.drawingFeature===null&&s(n)}})));return e};function CX(t,e,s,n,i){const{width:r,height:o}=n.view.getSize(),a=8,l=16,u=a*l,h={width:150,height:50},g=h.width,f=h.height,m=Math.max(r,o),y=200,p={minX:0,minY:0,maxX:0,maxY:0},x=n.view.graphToScreenCoordinates({x:t,y:e});for(let v=0;v<u;v++){const b=v%a,S=Math.floor(v/a),A=2*Math.PI*(b/a),w=y+S/l*(m-y),L=Math.cos(A)*w,k=Math.sin(A)*w,F=x.x+L,O=x.y+k;if(p.minX=F,p.minY=O-f/2,p.maxX=F+g,p.maxY=O+f/2,L<0&&(p.minX-=g,p.maxX-=g),p.minX<0||p.maxX>r||p.minY<0||p.maxY>o)continue;const j=n.view.screenToGraphCoordinates({x:p.minX,y:p.minY}),V=n.view.screenToGraphCoordinates({x:p.maxX,y:p.maxY});if(p.minX=j.x,p.minY=j.y,p.maxX=V.x,p.maxY=V.y,!s.query(p).filter(Z=>Z.properties.type!=="arrow").length)return n.view.screenToGraphCoordinates({x:F,y:O})}return n.view.screenToGraphCoordinates({x:r/2,y:o/2})}const LX={detectMargin:2,magnetHandleRadius:5,magnetRadius:10,textPlaceholder:"Type here",showSendButton:!0,sendButtonIcon:wM,minArrowHeight:20,maxArrowHeight:30};class NX extends bY{constructor(s,n={}){super();Qt(this,"ogma");Qt(this,"store");Qt(this,"renderers",{});Qt(this,"interactions");Qt(this,"editor");Qt(this,"links");Qt(this,"index");Qt(this,"pendingDrawingListener",null);Qt(this,"onRotate",()=>this.store.getState().setRotation(this.ogma.view.getAngle()));Qt(this,"onZoom",()=>{const s=this.ogma.view.getZoom();this.store.getState().setZoom(s),this.updateCommentModesForZoom(s)});Qt(this,"onLayout",()=>{this.links.update()});this.ogma=s;const i={...LX,...n};this.store=TX(i),this.index=new cW(this.store),this.links=new nW(this.ogma,this.store,(r,o)=>{this.emit(SY,{arrow:r,link:o})}),this.interactions=new iW(this.ogma,this.store,this.index),this.editor=new JY(this.ogma,this.store,this.index,this.links,this.interactions),this.initializeRenderers(),this.setupEvents()}initializeRenderers(){this.renderers.shapes=new xX(this.ogma,this.store),this.renderers.handles=new fW(this.ogma,this.store)}setupEvents(){this.ogma.events.on("rotate",this.onRotate).on("zoom",this.onZoom).on("layoutEnd",this.onLayout),this.store.temporal.subscribe(s=>{this.emit(bM,{canUndo:s.pastStates.length>0,canRedo:s.futureStates.length>0})}),this.store.subscribe(s=>s.selectedFeatures,(s,n)=>{const i=Array.from(s).filter(r=>!(n!=null&&n.has(r)));if(i.length>0&&this.emit(_M,{ids:i}),n){const r=Array.from(n).filter(o=>!s.has(o));r.length>0&&this.emit(yM,{ids:r})}}),this.store.subscribe(s=>s.drawingFeature,(s,n)=>{s===null&&n!==null&&this.emit(Af,{id:n})}),this.store.subscribe(s=>s.features,(s,n)=>{if(n){for(const i of Object.keys(s))n[i]?n[i]!==s[i]&&this.emit(vM,s[i]):this.emit(Vg,{id:i});for(const i of Object.keys(n))s[i]||this.emit(xM,{id:i})}})}updateCommentModesForZoom(s){const n=this.store.getState(),i=n.features;Object.values(i).forEach(r=>{if(kn(r)){const o=r,a=this.getCommentZoomThreshold(o),l=s<a?rh:SM;o.properties.mode!==l&&n.applyLiveUpdate(o.id,{properties:{...o.properties,mode:l}})}})}getCommentZoomThreshold(s){const n={...s.properties.style};if(n.collapseZoomThreshold!==void 0)return n.collapseZoomThreshold;const i=80/s.properties.width;return Math.max(.1,Math.min(1,i))}setOptions(s={}){return this.store.getState().setOptions(s),this.store.getState().options}add(s){if(ZA(s))for(const n of s.features)this.add(n);else{const n=GY(s);this.store.getState().addFeature(n)}return this}remove(s){if(ZA(s))for(const n of s.features)this.remove(n);else this.store.getState().removeFeature(s.id);return this}undo(){return this.canUndo()?(this.store.temporal.getState().undo(),this.links.refresh(),!0):!1}redo(){return this.canRedo()?(this.store.temporal.getState().redo(),this.links.refresh(),!0):!1}canUndo(){return this.store.temporal.getState().pastStates.length>0}canRedo(){return this.store.temporal.getState().futureStates.length>0}clearHistory(){this.store.temporal.getState().clear()}getAnnotations(){const s=this.store.getState().features;return{type:"FeatureCollection",features:Object.values(s)}}select(s){const n=Array.isArray(s)?s:[s];return this.store.getState().setSelectedFeatures(n),this}unselect(s){const n=Array.isArray(s)?s:[s];if(s===void 0)this.store.getState().setSelectedFeatures([]);else{const i=new Set(n),r=Array.from(this.store.getState().selectedFeatures).filter(o=>!i.has(o));this.store.getState().setSelectedFeatures(r)}return this}cancelDrawing(){var s;return this.pendingDrawingListener&&(this.ogma.events.off(this.pendingDrawingListener),this.pendingDrawingListener=null),(s=this.editor.getActiveHandler())==null||s.cancelDrawing(),this.emit(ex),this}enableDrawingMode(s){this.unselect().cancelDrawing();const n=i=>{this.ogma.events.off(n),this.pendingDrawingListener=null;const{x:r,y:o}=this.ogma.view.screenToGraphCoordinates(i);s(r,o)};return this.pendingDrawingListener=n,this.ogma.events.once("mousedown",n),this}enableArrowDrawing(s){return this.enableDrawingMode((n,i)=>{const r=nx(n,i,n,i,s);this.startArrow(n,i,r)})}enableTextDrawing(s){return this.enableDrawingMode((n,i)=>{const r=XA(n,i,0,0,void 0,s);this.startText(n,i,r)})}enableBoxDrawing(s){return this.enableDrawingMode((n,i)=>{const r=WA(n,i,0,0,s);this.startBox(n,i,r)})}enablePolygonDrawing(s){return this.enableDrawingMode((n,i)=>{const r=IY([[[n,i]]],{style:s});this.startPolygon(n,i,r)})}enableCommentDrawing(s={}){return this.enableDrawingMode((n,i)=>{if(s.offsetX===void 0&&s.offsetY===void 0){const o=CX(n,i,this.index,this.ogma);s.offsetX=o.x,s.offsetY=o.y}const r=LY(n,i,"",s==null?void 0:s.commentStyle);this.startComment(n,i,r,s)})}startComment(s,n,i,r){this.editor.getActiveHandler()&&this.editor.getActiveHandler().stopEditing(),this.cancelDrawing(),this.store.setState({drawingFeature:i.id}),this.interactions.suppressClicksTemporarily(200);const o=new tW(this.ogma,this.store,this.links,this.editor.getSnapping(),this.editor.getArrowHandler(),i,r),a=l=>{var u;l.id===i.id&&(this.select(l.id),this.off(Vg,a),(u=this.editor.getActiveHandler())==null||u.startEditingText())};return this.on(Vg,a),o.startDrawing(i.id,s,n),this}startBox(s,n,i=WA(s,n)){return this.store.setState({drawingFeature:i.id}),this.add(i),this.interactions.suppressClicksTemporarily(200),this.select(i.id),this.editor.getActiveHandler().startDrawing(i.id,s,n)}startArrow(s,n,i=nx(s,n)){return this.editor.getActiveHandler()&&this.editor.getActiveHandler().stopEditing(),this.cancelDrawing(),this.store.setState({drawingFeature:i.id}),this.add(i),this.interactions.suppressClicksTemporarily(200),this.select(i.id),this.editor.getActiveHandler().startDrawing(i.id,s,n)}startText(s,n,i=XA(s,n)){return this.store.setState({drawingFeature:i.id}),this.add(i),this.interactions.suppressClicksTemporarily(200),this.select(i.id),this.editor.getActiveHandler().startDrawing(i.id,s,n)}startPolygon(s,n,i){return this.store.setState({drawingFeature:i.id}),this.add(i),this.interactions.suppressClicksTemporarily(200),this.select(i.id),this.editor.getActiveHandler().startDrawing(i.id,s,n),this}getSelectedAnnotations(){const s=this.store.getState();return{type:"FeatureCollection",features:Array.from(s.selectedFeatures).map(n=>s.features[n])}}getSelected(){const s=this.store.getState(),n=Array.from(s.selectedFeatures)[0];return n?s.features[n]:null}getAnnotation(s){return this.store.getState().getFeature(s)}setScale(s,n,i,r){const o=this.store.getState().getFeature(s);if(!o)return this;const a=this.store.getState();if(wi(o)){const l=o.geometry.coordinates.map(([u,h])=>{const g=u-i,f=h-r;return[i+g*n,r+f*n]});a.updateFeature(s,{geometry:{...o.geometry,coordinates:l}})}else if(mn(o)||Ti(o)){const[l,u]=o.geometry.coordinates,h=l-i,g=u-r,f=i+h*n,m=r+g*n,y=o.properties.width*n,p=o.properties.height*n;a.updateFeature(s,{properties:{...o.properties,width:y,height:p},geometry:{...o.geometry,coordinates:[f,m]}})}return this}toggleComment(s){const n=this.store.getState().getFeature(s);if(!n||!kn(n))return this;const i=n;return this.store.getState().updateFeature(s,{properties:{...i.properties,mode:i.properties.mode==="collapsed"?"expanded":"collapsed"}}),this}destroy(){this.ogma.events.off(this.onRotate).off(this.onZoom),this.links.destroy(),Object.values(this.renderers).forEach(s=>s.destroy()),this.interactions.destroy(),this.editor.destroy()}updateStyle(s,n){const i=this.store.getState().getFeature(s);return i?(this.store.getState().updateFeature(s,{id:s,properties:{...i.properties,style:{...i.properties.style,...n}}}),this):this}update(s){var r;const n=this.store.getState(),i=n.getFeature(s.id);return i?(n.updateFeature(s.id,{...i,...s,properties:{...i.properties,...s.properties,style:{...i.properties.style,...(r=s.properties)==null?void 0:r.style}},geometry:{...i.geometry,...s.geometry}}),this):this}}const ux=[8,10,12,14,16,24,32,48,64,72],Cw="none",$M="#333333",k_=["#FFFFFF","#F44E3B","#FE9200","#FCDC00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#1E88E5","#333333","#808080","#cccccc"],MX=["Roboto","Helvetica Neue","Helvetica","Arial","sans-serif","Georgia, serif","Menlo","Monaco","Consolas","Courier New","monospace"].sort((t,e)=>t.toLocaleLowerCase().localeCompare(e.toLocaleLowerCase())),qM={head:"arrow",strokeColor:$M,strokeWidth:5},IX=.25,YM={font:"Roboto",fontSize:ux[2],padding:ux[2]*IX,color:$M,strokeType:Cw,background:Cw};function kX(t){return t.reduce((e,s)=>e+s,0)/t.length}function Lw(t,e=0,s=1){return e+(s-e)*t}function Nw(t,e=0,s=1){return(t-e)/(s-e)}const WM=Yt.createContext(void 0),mu=()=>Yt.useContext(WM),RX=({children:t,annotations:e})=>{const s=rn(),[n,i]=Yt.useState(e||{type:"FeatureCollection",features:[]}),[r,o]=Yt.useState(null),[a,l]=Yt.useState(qM),[u,h]=Yt.useState(YM),[g,f]=Yt.useState(),[m,y]=Yt.useState(1),[p,x]=Yt.useState(1),[v,b]=Yt.useState(!1),[S,A]=Yt.useState(!1);return Yt.useEffect(()=>{if(!s)return;const w=new NX(s,{minArrowHeight:1}),L=kX(s.getNodes().getAttribute("radius"))/5,k=m;return l({...a,strokeWidth:(a.strokeWidth||1)*k}),y(k),x(L),w.on(_M,()=>{w.getSelectedAnnotations().features.forEach(F=>{F&&(wi(F)?l({...F.properties.style||{}}):mn(F)&&h({...F.properties.style||{}}),o(F))})}).on(yM,()=>{o(null)}).on(Vg,()=>{i(w.getAnnotations())}).on(xM,()=>{i(w.getAnnotations())}).on(vM,()=>{i(w.getAnnotations())}).on(bM,()=>{b(w.canUndo()),A(w.canRedo())}),f(w),e&&(w.add(e),w.clearHistory()),()=>{w.destroy()}},[s]),Yt.useEffect(()=>{g&&r&&(r==null?void 0:r.properties.type)==="arrow"&&g.updateStyle(r.id,a)},[g,a,r]),Yt.useEffect(()=>{g&&r&&(r==null?void 0:r.properties.type)==="text"&&g.updateStyle(r.id,u)},[g,u,r]),de.jsx(WM.Provider,{value:{annotations:n,currentAnnotation:r,setCurrentAnnotation:o,textStyle:u,setTextStyle:h,arrowStyle:a,setArrowStyle:l,arrowWidthFactor:m,setArrowWidthFactor:y,textSizeFactor:p,setTextSizeFactor:x,editor:g,setEditor:f,canUndo:v,canRedo:S,undo:()=>(g==null?void 0:g.undo())||!1,redo:()=>(g==null?void 0:g.redo())||!1,clearHistory:()=>g==null?void 0:g.clearHistory(),add:w=>g==null?void 0:g.add(w),remove:w=>g==null?void 0:g.remove(w),cancelDrawing:()=>g==null?void 0:g.cancelDrawing(),select:w=>g==null?void 0:g.select(w),enableBoxDrawing:w=>g==null?void 0:g.enableBoxDrawing(w),enablePolygonDrawing:w=>g==null?void 0:g.enablePolygonDrawing(w),enableCommentDrawing:w=>g==null?void 0:g.enableCommentDrawing(w)},children:t})};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FX=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),PX=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,n)=>n?n.toUpperCase():s.toLowerCase()),Mw=t=>{const e=PX(t);return e.charAt(0).toUpperCase()+e.slice(1)},XM=(...t)=>t.filter((e,s,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===s).join(" ").trim(),zX=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var DX={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OX=Yt.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:i="",children:r,iconNode:o,...a},l)=>Yt.createElement("svg",{ref:l,...DX,width:e,height:e,stroke:t,strokeWidth:n?Number(s)*24/Number(e):s,className:XM("lucide",i),...!r&&!zX(a)&&{"aria-hidden":"true"},...a},[...o.map(([u,h])=>Yt.createElement(u,h)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Li=(t,e)=>{const s=Yt.forwardRef(({className:n,...i},r)=>Yt.createElement(OX,{ref:r,iconNode:e,className:XM(`lucide-${FX(Mw(t))}`,`lucide-${t}`,n),...i}));return s.displayName=Mw(t),s};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BX=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],UX=Li("arrow-right",BX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GX=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],VX=Li("camera",GX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jX=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],HX=Li("download",jX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $X=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],qX=Li("message-square",$X);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YX=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],WX=Li("minimize",YX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XX=[["path",{d:"M10.83 2.38a2 2 0 0 1 2.34 0l8 5.74a2 2 0 0 1 .73 2.25l-3.04 9.26a2 2 0 0 1-1.9 1.37H7.04a2 2 0 0 1-1.9-1.37L2.1 10.37a2 2 0 0 1 .73-2.25z",key:"2hea0t"}]],ZX=Li("pentagon",XX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KX=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]],QX=Li("rectangle-horizontal",KX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JX=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],t8=Li("redo",JX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e8=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],s8=Li("rotate-ccw",e8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n8=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],i8=Li("rotate-cw",n8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r8=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],o8=Li("trash",r8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a8=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],l8=Li("type",a8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u8=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],d8=Li("undo",u8),h8=({onSvgExport:t})=>{const{editor:e,canUndo:s,canRedo:n,undo:i,redo:r,remove:o}=mu(),[a,l]=ds.useState(null);ds.useEffect(()=>{if(!e)return;const b=()=>{l(null)};return e.on(Af,b),e.on(ex,b),()=>{e.off(Af,b),e.off(ex,b)}},[e]);const u=ds.useCallback(()=>{e.enableArrowDrawing({strokeType:"plain",strokeColor:"#3A03CF",strokeWidth:2,head:"arrow"}),l("arrow")},[e]),h=ds.useCallback(()=>{e.enableTextDrawing({font:"IBM Plex Sans",fontSize:24,color:"#3A03CF",background:"#EDE6FF",borderRadius:8,padding:12}),l("text")},[e]),g=ds.useCallback(()=>{e.enableBoxDrawing({background:"#EDE6FF",borderRadius:8,padding:12}),l("box")},[e]),f=ds.useCallback(()=>{e.enablePolygonDrawing({strokeColor:"#3A03CF",strokeWidth:2,background:"rgba(58, 3, 207, 0.15)"}),l("polygon")},[e]),m=ds.useCallback(()=>{e.enableCommentDrawing({offsetX:200,offsetY:-150,commentStyle:{content:"",style:{color:"#3A03CF",background:"#EDE6FF",fontSize:16,font:"IBM Plex Sans"}},arrowStyle:{style:{strokeType:"plain",strokeColor:"#3A03CF",strokeWidth:2,head:"halo-dot"}}}),l("comment")},[e]),y=ds.useCallback(()=>{const b=e.getSelectedAnnotations();b.features.length>0&&o(b)},[e,o]);function p(){const b=document.createElement("a");b.href=URL.createObjectURL(new Blob([JSON.stringify(e.getAnnotations(),null,2)],{type:"text/plain"})),b.download="annotations.json",b.click()}const x=ds.useCallback(b=>{b.stopPropagation()},[]),v=16;return de.jsxs("div",{className:"add-menu",onClick:x,onMouseMove:x,children:[de.jsx("button",{"data-tooltip":"Add arrow",onClick:u,className:a==="arrow"?"active":"",children:de.jsx(UX,{width:v,height:v})}),de.jsx("button",{"data-tooltip":"Add comment",onClick:m,className:a==="comment"?"active":"",children:de.jsx(qX,{width:v,height:v})}),de.jsx("button",{"data-tooltip":"Add box",onClick:g,className:a==="box"?"active":"",children:de.jsx(QX,{width:v,height:v})}),de.jsx("button",{"data-tooltip":"Add text",onClick:h,className:a==="text"?"active":"",children:de.jsx(l8,{width:v,height:v})}),de.jsx("button",{"data-tooltip":"Add polygon (click points, Esc to finish)",onClick:f,className:a==="polygon"?"active":"",children:de.jsx(ZX,{width:v,height:v})}),de.jsx("span",{className:"separator"}),de.jsx("button",{"data-tooltip":"Undo",onClick:()=>i(),disabled:!s,children:de.jsx(d8,{width:v,height:v})}),de.jsx("button",{"data-tooltip":"Redo",onClick:()=>r(),disabled:!n,children:de.jsx(t8,{width:v,height:v})}),de.jsx("span",{className:"separator"}),de.jsx("button",{"data-tooltip":"Delete selected",onClick:y,children:de.jsx(o8,{width:v,height:v})}),de.jsx("span",{className:"separator"}),de.jsx("button",{"data-tooltip":"Export annotations",onClick:()=>p(),children:de.jsx(HX,{width:v,height:v})}),de.jsx("button",{"data-tooltip":"Export SVG",onClick:t,children:de.jsx(VX,{width:v,height:v})})]})},c8=({children:t})=>de.jsx("div",{className:"button-group",children:t}),g8=()=>de.jsx("svg",{width:"1.5em",height:"1.5em",strokeWidth:"1.5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"currentColor",fr:"",children:de.jsx("path",{d:"M6 12h12",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})}),f8=()=>de.jsx("svg",{width:"1.5em",height:"1.5em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"#000000",children:de.jsx("path",{d:"M9 12h13m0 0l-3-3m3 3l-3 3",transform:"translate(-3 0)",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),m8=()=>de.jsx("svg",{width:"1.5em",height:"1.5em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"#000000",children:de.jsx("path",{d:"M 9 12 h 12 m 2 0 l -3 -3 m 3 3 l -3 3 m -10 -6 l -3 3 m 0 0 l 3 3",transform:"translate(-3,0)",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),dx=({color:t,setColor:e,hasTransparent:s})=>{const[n,i]=ds.useState(k_);ds.useEffect(()=>{i(s?["none",...k_.slice(0,-1)]:[...k_])},[s]);const[r,o]=ds.useState(t);return de.jsx("span",{className:"colorpicker",children:n.map(a=>de.jsx("div",{className:a===r?"selected":"",style:{width:12,height:12,borderRadius:10,backgroundColor:a==="none"?"#fff":a,margin:5,cursor:"pointer"},onClick:()=>{o(a),e&&e(a)}},a))})},p8=({min:t,max:e,step:s=1,initialValue:n=t,onChange:i})=>{const[r,o]=Yt.useState(n),a=Yt.useRef(null),l=Yt.useRef(null),u=ds.useCallback(m=>{if(a.current&&l.current){const y=(m-t)/(e-t)*100;l.current.style.left=`calc(${y}% - ${l.current.offsetWidth/2}px)`}},[t,e]);Yt.useEffect(()=>{u(r)},[r,u]);const h=m=>{m.preventDefault(),document.addEventListener("mousemove",g),document.addEventListener("mouseup",f)},g=m=>{if(a.current){const y=a.current.getBoundingClientRect();let p=Math.min(Math.max(t,(m.clientX-y.left)/y.width*(e-t)+t),e);const x=p%s;x!==0&&(x<s/2?p-=x:p+=s-x),o(p),i(p)}},f=()=>{document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",f)};return de.jsxs("div",{className:"slider-container",ref:a,children:[de.jsx("div",{className:"slider-track"}),de.jsx("div",{className:"slider-knob",ref:l,onMouseDown:h,children:Math.round(r)})]})},_8=({minThickness:t,maxThickness:e})=>{const{arrowStyle:s,setArrowStyle:n}=mu();function i(a){const l={head:"none",tail:"none"};a==="one"&&(l.head="arrow"),a==="both"&&(l.head="arrow",l.tail="arrow"),n({...s,...l})}function r(a){const l=Lw(Nw(a,0,100),t,e);n({...s,strokeWidth:l})}function o(a){n({...s,strokeColor:a})}return de.jsxs("span",{className:"settings-panel",children:[de.jsx("h4",{children:"Shape"}),de.jsxs(c8,{children:[de.jsx("button",{"data-tooltip":"Undirected",onClick:()=>i("none"),children:de.jsx(g8,{})}),de.jsx("button",{"data-tooltip":"Arrow",onClick:()=>i("one"),children:de.jsx(f8,{})}),de.jsx("button",{"data-tooltip":"Bidirectional",onClick:()=>i("both"),children:de.jsx(m8,{})})]}),de.jsx("h4",{children:"Color"}),de.jsx(dx,{color:s.strokeColor,setColor:a=>o(a)}),de.jsx("h4",{children:"Thickness"}),de.jsx(p8,{min:0,max:100,onChange:a=>r(a),initialValue:Math.floor(Lw(Nw(s.strokeWidth||0,t,e),0,100))})]})},y8=MX.map(t=>({value:t,label:t})),x8=ux.map(t=>({value:`${t}`,label:t})),v8=()=>{var o;const{textStyle:t,setTextStyle:e}=mu();function s(a){e({...t,font:a})}function n(a){e({...t,fontSize:parseFloat(a)})}function i(a){e({...t,background:a})}function r(a){e({...t,color:a})}return de.jsxs("span",{className:"settings-panel",children:[de.jsx("h4",{children:"Font"}),de.jsx("select",{onChange:a=>s(a.target.value),value:t.font,children:y8.map(a=>de.jsx("option",{value:a.value,children:a.label},a.value))}),de.jsx("h4",{children:"Size"}),de.jsx("select",{onChange:a=>n(a.target.value),value:((o=t.fontSize)==null?void 0:o.toString())||"",children:x8.map(a=>de.jsx("option",{value:a.value,children:a.label},a.value))}),de.jsx("h4",{children:"Color"}),de.jsx(dx,{color:t.color,setColor:a=>r(a)}),de.jsx("h4",{children:"Background"}),de.jsx(dx,{hasTransparent:!0,color:t.background,setColor:a=>i(a)})]})},b8=()=>{const t=rn(),{annotations:e}=mu(),s=ds.useCallback(async()=>{const a=t.view.getGraphBoundingBox();await t.view.moveToBounds(a.extend(kM(e)),{duration:200})},[t,e]),n=ds.useCallback(async()=>{await t.view.rotate(-Math.PI/8,{duration:200})},[t]),i=ds.useCallback(async()=>{await t.view.rotate(Math.PI/8,{duration:200})},[t]),r=ds.useCallback(a=>{a.stopPropagation()},[]);ds.useEffect(()=>{setTimeout(()=>{},2500)},[t]);const o=16;return de.jsxs("div",{className:"view-controls",onMouseMove:r,onClick:r,children:[de.jsx("button",{"data-tooltip":"Center view",onClick:s,children:de.jsx(WX,{width:o,height:o})}),de.jsx("span",{className:"separator"}),de.jsx("button",{"data-tooltip":"Rotate clockwise",onClick:n,children:de.jsx(i8,{width:o,height:o})}),de.jsx("button",{"data-tooltip":"Rotate counter-clockwise",onClick:i,children:de.jsx(s8,{width:o,height:o})})]})},E8=({isOpen:t,svgContent:e,onClose:s,onDownload:n})=>{const[i,r]=ds.useState("");ds.useEffect(()=>{if(e){const a=new Blob([e],{type:"image/svg+xml"}),l=URL.createObjectURL(a);return r(l),()=>{URL.revokeObjectURL(l)}}},[e]);const o=ds.useCallback(a=>{a.target===a.currentTarget&&s()},[s]);return t?de.jsx("div",{className:"popup-backdrop",onClick:o,children:de.jsxs("div",{className:"popup-content",children:[de.jsxs("div",{className:"popup-header",children:[de.jsx("h2",{children:"SVG Export Preview"}),de.jsx("button",{className:"popup-close",onClick:s,children:""})]}),de.jsx("div",{className:"popup-body",children:de.jsx("div",{className:"svg-preview",children:i&&de.jsx("img",{src:i,alt:"Graph Export"})})}),de.jsx("div",{className:"popup-footer",children:de.jsx("button",{className:"popup-button",onClick:n,children:"Download SVG"})})]})}):null},R_=t=>{t.cancelable&&t.stopPropagation()},S8=t=>{const{cancelDrawing:e,remove:s,editor:n}=mu();ds.useEffect(()=>{const i=r=>{if(r.key==="Escape")e();else if(r.key==="Backspace"||r.key==="Delete"){const o=n==null?void 0:n.getSelectedAnnotations();o&&o.features.length>0&&s(o)}else r.key==="0"&&t()};return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}},[e,s,n,t])},A8=({minThickness:t,maxThickness:e,defaultArrowStyle:s={},defaultTextStyle:n={}})=>{const{currentAnnotation:i,annotations:r}=mu(),o=rn(),[a,l]=ds.useState(!1),[u,h]=ds.useState(""),g=ds.useCallback(async()=>{try{const v=await o.export.svg({clip:!0,download:!1});h(v),l(!0)}catch(v){console.error("Failed to export SVG:",v)}},[o]),f=ds.useCallback(()=>{l(!1),h("")},[]),m=ds.useCallback(()=>{if(u){const v=new Blob([u],{type:"image/svg+xml"}),b=URL.createObjectURL(v),S=document.createElement("a");document.body.appendChild(S),S.setAttribute("href",b),S.setAttribute("download","graph-with-annotations.svg"),S.click(),S.remove(),URL.revokeObjectURL(b),console.log("Downloaded SVG")}},[u]),y=ds.useCallback(async()=>{const v=o.view.getGraphBoundingBox();await o.view.moveToBounds(v.extend(kM(r)),{duration:200})},[o,r]);S8(y);const p=ds.useCallback(R_,[]),x=ds.useCallback(v=>(v&&v.element&&v.element.addEventListener("wheel",R_,{passive:!1}),()=>{v.element.removeEventListener("wheel",R_)}),[]);return ds.useEffect(()=>{Object.assign(qM,s),Object.assign(YM,n)},[s,n]),de.jsxs(de.Fragment,{children:[de.jsx(Tg,{className:"controls",ref:x,index:100,children:de.jsx("div",{className:"container",children:de.jsx(h8,{onSvgExport:g})})}),de.jsx(Tg,{className:"view-controls-layer",index:100,children:de.jsx("div",{className:"view-controls-container",children:de.jsx(b8,{})})}),i&&de.jsx(Tg,{className:"side-panel",index:100,children:de.jsxs("div",{className:"side-panel-container",onMouseDown:p,onClick:p,children:[wi(i)&&de.jsx(_8,{minThickness:t,maxThickness:e}),mn(i)&&de.jsx(v8,{})]})}),de.jsx(Tg,{className:"svg-popup-layer",index:1e3,children:de.jsx(E8,{isOpen:a,svgContent:u,onClose:f,onDownload:m})})]})};async function w8(){return await b0.parse.jsonFromUrl("./graph.json")}async function T8(){return(await fetch("annotations-test.json")).json()}function C8(){const[t,e]=ds.useState(null),[s,n]=ds.useState(null);return ds.useEffect(()=>{Promise.all([w8(),T8()]).then(([i,r])=>{e(i),n(r)})},[]),!t||!s?de.jsx("div",{children:"Loading graph..."}):de.jsx("div",{className:"App",children:de.jsxs(Uq,{graph:t,onReady:i=>{i.tools.brand.set(`<div class="brand">
              <a href="../react/">
                <code>ogma-annotations-react</code></a> | <a href="https://github.com/linkurious/ogma-annotations-control/tree/develop/packages/ogma-annotations-react/web/">code</a>
            </div>`,{position:"top-left",horizontalMargin:10,verticalMargin:10,className:"brand"})},children:[de.jsx(Hq,{attributes:{color:"#5B97F8"}}),de.jsx(Wq,{attributes:{color:"#C2D7FF"}}),de.jsx(RX,{annotations:s,children:de.jsx(A8,{minThickness:1,maxThickness:10,defaultArrowStyle:{strokeType:"plain",strokeColor:"#3A03CF",strokeWidth:2,head:"arrow"},defaultTextStyle:{font:"IBM Plex Sans",fontSize:24,color:"#3A03CF",background:"#EDE6FF",borderRadius:8,padding:12}})})]})})}dk.createRoot(document.getElementById("root")).render(de.jsx(C8,{}))});export default L8();
