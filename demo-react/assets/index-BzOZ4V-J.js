var QN=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var yq=QN((wq,ed)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function JN(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Op={exports:{}},Eu={},zp={exports:{}},$t={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dv;function eI(){if(Dv)return $t;Dv=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),c=Symbol.for("react.lazy"),g=Symbol.iterator;function f(Z){return Z===null||typeof Z!="object"?null:(Z=g&&Z[g]||Z["@@iterator"],typeof Z=="function"?Z:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,y={};function x(Z,_e,ze){this.props=Z,this.context=_e,this.refs=y,this.updater=ze||p}x.prototype.isReactComponent={},x.prototype.setState=function(Z,_e){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,_e,"setState")},x.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function E(){}E.prototype=x.prototype;function b(Z,_e,ze){this.props=Z,this.context=_e,this.refs=y,this.updater=ze||p}var S=b.prototype=new E;S.constructor=b,_(S,x.prototype),S.isPureReactComponent=!0;var A=Array.isArray,C=Object.prototype.hasOwnProperty,k={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function R(Z,_e,ze){var Re,We={},st=null,ft=null;if(_e!=null)for(Re in _e.ref!==void 0&&(ft=_e.ref),_e.key!==void 0&&(st=""+_e.key),_e)C.call(_e,Re)&&!M.hasOwnProperty(Re)&&(We[Re]=_e[Re]);var ut=arguments.length-2;if(ut===1)We.children=ze;else if(1<ut){for(var ce=Array(ut),be=0;be<ut;be++)ce[be]=arguments[be+2];We.children=ce}if(Z&&Z.defaultProps)for(Re in ut=Z.defaultProps,ut)We[Re]===void 0&&(We[Re]=ut[Re]);return{$$typeof:e,type:Z,key:st,ref:ft,props:We,_owner:k.current}}function O(Z,_e){return{$$typeof:e,type:Z.type,key:_e,ref:Z.ref,props:Z.props,_owner:Z._owner}}function j(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===e}function z(Z){var _e={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(ze){return _e[ze]})}var X=/\/+/g;function oe(Z,_e){return typeof Z=="object"&&Z!==null&&Z.key!=null?z(""+Z.key):_e.toString(36)}function re(Z,_e,ze,Re,We){var st=typeof Z;(st==="undefined"||st==="boolean")&&(Z=null);var ft=!1;if(Z===null)ft=!0;else switch(st){case"string":case"number":ft=!0;break;case"object":switch(Z.$$typeof){case e:case t:ft=!0}}if(ft)return ft=Z,We=We(ft),Z=Re===""?"."+oe(ft,0):Re,A(We)?(ze="",Z!=null&&(ze=Z.replace(X,"$&/")+"/"),re(We,_e,ze,"",function(be){return be})):We!=null&&(j(We)&&(We=O(We,ze+(!We.key||ft&&ft.key===We.key?"":(""+We.key).replace(X,"$&/")+"/")+Z)),_e.push(We)),1;if(ft=0,Re=Re===""?".":Re+":",A(Z))for(var ut=0;ut<Z.length;ut++){st=Z[ut];var ce=Re+oe(st,ut);ft+=re(st,_e,ze,ce,We)}else if(ce=f(Z),typeof ce=="function")for(Z=ce.call(Z),ut=0;!(st=Z.next()).done;)st=st.value,ce=Re+oe(st,ut++),ft+=re(st,_e,ze,ce,We);else if(st==="object")throw _e=String(Z),Error("Objects are not valid as a React child (found: "+(_e==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":_e)+"). If you meant to render a collection of children, use an array instead.");return ft}function Q(Z,_e,ze){if(Z==null)return Z;var Re=[],We=0;return re(Z,Re,"","",function(st){return _e.call(ze,st,We++)}),Re}function he(Z){if(Z._status===-1){var _e=Z._result;_e=_e(),_e.then(function(ze){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=ze)},function(ze){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=ze)}),Z._status===-1&&(Z._status=0,Z._result=_e)}if(Z._status===1)return Z._result.default;throw Z._result}var fe={current:null},ae={transition:null},me={ReactCurrentDispatcher:fe,ReactCurrentBatchConfig:ae,ReactCurrentOwner:k};function we(){throw Error("act(...) is not supported in production builds of React.")}return $t.Children={map:Q,forEach:function(Z,_e,ze){Q(Z,function(){_e.apply(this,arguments)},ze)},count:function(Z){var _e=0;return Q(Z,function(){_e++}),_e},toArray:function(Z){return Q(Z,function(_e){return _e})||[]},only:function(Z){if(!j(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}},$t.Component=x,$t.Fragment=n,$t.Profiler=r,$t.PureComponent=b,$t.StrictMode=s,$t.Suspense=u,$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=me,$t.act=we,$t.cloneElement=function(Z,_e,ze){if(Z==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Z+".");var Re=_({},Z.props),We=Z.key,st=Z.ref,ft=Z._owner;if(_e!=null){if(_e.ref!==void 0&&(st=_e.ref,ft=k.current),_e.key!==void 0&&(We=""+_e.key),Z.type&&Z.type.defaultProps)var ut=Z.type.defaultProps;for(ce in _e)C.call(_e,ce)&&!M.hasOwnProperty(ce)&&(Re[ce]=_e[ce]===void 0&&ut!==void 0?ut[ce]:_e[ce])}var ce=arguments.length-2;if(ce===1)Re.children=ze;else if(1<ce){ut=Array(ce);for(var be=0;be<ce;be++)ut[be]=arguments[be+2];Re.children=ut}return{$$typeof:e,type:Z.type,key:We,ref:st,props:Re,_owner:ft}},$t.createContext=function(Z){return Z={$$typeof:o,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Z.Provider={$$typeof:i,_context:Z},Z.Consumer=Z},$t.createElement=R,$t.createFactory=function(Z){var _e=R.bind(null,Z);return _e.type=Z,_e},$t.createRef=function(){return{current:null}},$t.forwardRef=function(Z){return{$$typeof:a,render:Z}},$t.isValidElement=j,$t.lazy=function(Z){return{$$typeof:c,_payload:{_status:-1,_result:Z},_init:he}},$t.memo=function(Z,_e){return{$$typeof:d,type:Z,compare:_e===void 0?null:_e}},$t.startTransition=function(Z){var _e=ae.transition;ae.transition={};try{Z()}finally{ae.transition=_e}},$t.unstable_act=we,$t.useCallback=function(Z,_e){return fe.current.useCallback(Z,_e)},$t.useContext=function(Z){return fe.current.useContext(Z)},$t.useDebugValue=function(){},$t.useDeferredValue=function(Z){return fe.current.useDeferredValue(Z)},$t.useEffect=function(Z,_e){return fe.current.useEffect(Z,_e)},$t.useId=function(){return fe.current.useId()},$t.useImperativeHandle=function(Z,_e,ze){return fe.current.useImperativeHandle(Z,_e,ze)},$t.useInsertionEffect=function(Z,_e){return fe.current.useInsertionEffect(Z,_e)},$t.useLayoutEffect=function(Z,_e){return fe.current.useLayoutEffect(Z,_e)},$t.useMemo=function(Z,_e){return fe.current.useMemo(Z,_e)},$t.useReducer=function(Z,_e,ze){return fe.current.useReducer(Z,_e,ze)},$t.useRef=function(Z){return fe.current.useRef(Z)},$t.useState=function(Z){return fe.current.useState(Z)},$t.useSyncExternalStore=function(Z,_e,ze){return fe.current.useSyncExternalStore(Z,_e,ze)},$t.useTransition=function(){return fe.current.useTransition()},$t.version="18.3.1",$t}var Ov;function Nd(){return Ov||(Ov=1,zp.exports=eI()),zp.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zv;function tI(){if(zv)return Eu;zv=1;var e=Nd(),t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(a,u,d){var c,g={},f=null,p=null;d!==void 0&&(f=""+d),u.key!==void 0&&(f=""+u.key),u.ref!==void 0&&(p=u.ref);for(c in u)s.call(u,c)&&!i.hasOwnProperty(c)&&(g[c]=u[c]);if(a&&a.defaultProps)for(c in u=a.defaultProps,u)g[c]===void 0&&(g[c]=u[c]);return{$$typeof:t,type:a,key:f,ref:p,props:g,_owner:r.current}}return Eu.Fragment=n,Eu.jsx=o,Eu.jsxs=o,Eu}var Bv;function nI(){return Bv||(Bv=1,Op.exports=tI()),Op.exports}var Ct=nI(),Hh={},Bp={exports:{}},nr={},Up={exports:{}},Gp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uv;function sI(){return Uv||(Uv=1,function(e){function t(ae,me){var we=ae.length;ae.push(me);e:for(;0<we;){var Z=we-1>>>1,_e=ae[Z];if(0<r(_e,me))ae[Z]=me,ae[we]=_e,we=Z;else break e}}function n(ae){return ae.length===0?null:ae[0]}function s(ae){if(ae.length===0)return null;var me=ae[0],we=ae.pop();if(we!==me){ae[0]=we;e:for(var Z=0,_e=ae.length,ze=_e>>>1;Z<ze;){var Re=2*(Z+1)-1,We=ae[Re],st=Re+1,ft=ae[st];if(0>r(We,we))st<_e&&0>r(ft,We)?(ae[Z]=ft,ae[st]=we,Z=st):(ae[Z]=We,ae[Re]=we,Z=Re);else if(st<_e&&0>r(ft,we))ae[Z]=ft,ae[st]=we,Z=st;else break e}}return me}function r(ae,me){var we=ae.sortIndex-me.sortIndex;return we!==0?we:ae.id-me.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var u=[],d=[],c=1,g=null,f=3,p=!1,_=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(ae){for(var me=n(d);me!==null;){if(me.callback===null)s(d);else if(me.startTime<=ae)s(d),me.sortIndex=me.expirationTime,t(u,me);else break;me=n(d)}}function A(ae){if(y=!1,S(ae),!_)if(n(u)!==null)_=!0,he(C);else{var me=n(d);me!==null&&fe(A,me.startTime-ae)}}function C(ae,me){_=!1,y&&(y=!1,E(R),R=-1),p=!0;var we=f;try{for(S(me),g=n(u);g!==null&&(!(g.expirationTime>me)||ae&&!z());){var Z=g.callback;if(typeof Z=="function"){g.callback=null,f=g.priorityLevel;var _e=Z(g.expirationTime<=me);me=e.unstable_now(),typeof _e=="function"?g.callback=_e:g===n(u)&&s(u),S(me)}else s(u);g=n(u)}if(g!==null)var ze=!0;else{var Re=n(d);Re!==null&&fe(A,Re.startTime-me),ze=!1}return ze}finally{g=null,f=we,p=!1}}var k=!1,M=null,R=-1,O=5,j=-1;function z(){return!(e.unstable_now()-j<O)}function X(){if(M!==null){var ae=e.unstable_now();j=ae;var me=!0;try{me=M(!0,ae)}finally{me?oe():(k=!1,M=null)}}else k=!1}var oe;if(typeof b=="function")oe=function(){b(X)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,Q=re.port2;re.port1.onmessage=X,oe=function(){Q.postMessage(null)}}else oe=function(){x(X,0)};function he(ae){M=ae,k||(k=!0,oe())}function fe(ae,me){R=x(function(){ae(e.unstable_now())},me)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ae){ae.callback=null},e.unstable_continueExecution=function(){_||p||(_=!0,he(C))},e.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<ae?Math.floor(1e3/ae):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(ae){switch(f){case 1:case 2:case 3:var me=3;break;default:me=f}var we=f;f=me;try{return ae()}finally{f=we}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ae,me){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var we=f;f=ae;try{return me()}finally{f=we}},e.unstable_scheduleCallback=function(ae,me,we){var Z=e.unstable_now();switch(typeof we=="object"&&we!==null?(we=we.delay,we=typeof we=="number"&&0<we?Z+we:Z):we=Z,ae){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=we+_e,ae={id:c++,callback:me,priorityLevel:ae,startTime:we,expirationTime:_e,sortIndex:-1},we>Z?(ae.sortIndex=we,t(d,ae),n(u)===null&&ae===n(d)&&(y?(E(R),R=-1):y=!0,fe(A,we-Z))):(ae.sortIndex=_e,t(u,ae),_||p||(_=!0,he(C))),ae},e.unstable_shouldYield=z,e.unstable_wrapCallback=function(ae){var me=f;return function(){var we=f;f=me;try{return ae.apply(this,arguments)}finally{f=we}}}}(Gp)),Gp}var Gv;function rI(){return Gv||(Gv=1,Up.exports=sI()),Up.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vv;function iI(){if(Vv)return nr;Vv=1;var e=Nd(),t=rI();function n(l){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+l,m=1;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+l+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,r={};function i(l,h){o(l,h),o(l+"Capture",h)}function o(l,h){for(r[l]=h,l=0;l<h.length;l++)s.add(h[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,c={},g={};function f(l){return u.call(g,l)?!0:u.call(c,l)?!1:d.test(l)?g[l]=!0:(c[l]=!0,!1)}function p(l,h,m,v){if(m!==null&&m.type===0)return!1;switch(typeof h){case"function":case"symbol":return!0;case"boolean":return v?!1:m!==null?!m.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function _(l,h,m,v){if(h===null||typeof h>"u"||p(l,h,m,v))return!0;if(v)return!1;if(m!==null)switch(m.type){case 3:return!h;case 4:return h===!1;case 5:return isNaN(h);case 6:return isNaN(h)||1>h}return!1}function y(l,h,m,v,T,N,D){this.acceptsBooleans=h===2||h===3||h===4,this.attributeName=v,this.attributeNamespace=T,this.mustUseProperty=m,this.propertyName=l,this.type=h,this.sanitizeURL=N,this.removeEmptyString=D}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){x[l]=new y(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var h=l[0];x[h]=new y(h,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){x[l]=new y(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){x[l]=new y(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){x[l]=new y(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){x[l]=new y(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){x[l]=new y(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){x[l]=new y(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){x[l]=new y(l,5,!1,l.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function b(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var h=l.replace(E,b);x[h]=new y(h,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var h=l.replace(E,b);x[h]=new y(h,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var h=l.replace(E,b);x[h]=new y(h,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){x[l]=new y(l,1,!1,l.toLowerCase(),null,!1,!1)}),x.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){x[l]=new y(l,1,!1,l.toLowerCase(),null,!0,!0)});function S(l,h,m,v){var T=x.hasOwnProperty(h)?x[h]:null;(T!==null?T.type!==0:v||!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(_(h,m,T,v)&&(m=null),v||T===null?f(h)&&(m===null?l.removeAttribute(h):l.setAttribute(h,""+m)):T.mustUseProperty?l[T.propertyName]=m===null?T.type===3?!1:"":m:(h=T.attributeName,v=T.attributeNamespace,m===null?l.removeAttribute(h):(T=T.type,m=T===3||T===4&&m===!0?"":""+m,v?l.setAttributeNS(v,h,m):l.setAttribute(h,m))))}var A=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=Symbol.for("react.element"),k=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),z=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),oe=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),Q=Symbol.for("react.memo"),he=Symbol.for("react.lazy"),fe=Symbol.for("react.offscreen"),ae=Symbol.iterator;function me(l){return l===null||typeof l!="object"?null:(l=ae&&l[ae]||l["@@iterator"],typeof l=="function"?l:null)}var we=Object.assign,Z;function _e(l){if(Z===void 0)try{throw Error()}catch(m){var h=m.stack.trim().match(/\n( *(at )?)/);Z=h&&h[1]||""}return`
`+Z+l}var ze=!1;function Re(l,h){if(!l||ze)return"";ze=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(ke){var v=ke}Reflect.construct(l,[],h)}else{try{h.call()}catch(ke){v=ke}l.call(h.prototype)}else{try{throw Error()}catch(ke){v=ke}l()}}catch(ke){if(ke&&v&&typeof ke.stack=="string"){for(var T=ke.stack.split(`
`),N=v.stack.split(`
`),D=T.length-1,J=N.length-1;1<=D&&0<=J&&T[D]!==N[J];)J--;for(;1<=D&&0<=J;D--,J--)if(T[D]!==N[J]){if(D!==1||J!==1)do if(D--,J--,0>J||T[D]!==N[J]){var de=`
`+T[D].replace(" at new "," at ");return l.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",l.displayName)),de}while(1<=D&&0<=J);break}}}finally{ze=!1,Error.prepareStackTrace=m}return(l=l?l.displayName||l.name:"")?_e(l):""}function We(l){switch(l.tag){case 5:return _e(l.type);case 16:return _e("Lazy");case 13:return _e("Suspense");case 19:return _e("SuspenseList");case 0:case 2:case 15:return l=Re(l.type,!1),l;case 11:return l=Re(l.type.render,!1),l;case 1:return l=Re(l.type,!0),l;default:return""}}function st(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case M:return"Fragment";case k:return"Portal";case O:return"Profiler";case R:return"StrictMode";case oe:return"Suspense";case re:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case z:return(l.displayName||"Context")+".Consumer";case j:return(l._context.displayName||"Context")+".Provider";case X:var h=l.render;return l=l.displayName,l||(l=h.displayName||h.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case Q:return h=l.displayName||null,h!==null?h:st(l.type)||"Memo";case he:h=l._payload,l=l._init;try{return st(l(h))}catch{}}return null}function ft(l){var h=l.type;switch(l.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=h.render,l=l.displayName||l.name||"",h.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return st(h);case 8:return h===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function ut(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function ce(l){var h=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function be(l){var h=ce(l)?"checked":"value",m=Object.getOwnPropertyDescriptor(l.constructor.prototype,h),v=""+l[h];if(!l.hasOwnProperty(h)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var T=m.get,N=m.set;return Object.defineProperty(l,h,{configurable:!0,get:function(){return T.call(this)},set:function(D){v=""+D,N.call(this,D)}}),Object.defineProperty(l,h,{enumerable:m.enumerable}),{getValue:function(){return v},setValue:function(D){v=""+D},stopTracking:function(){l._valueTracker=null,delete l[h]}}}}function qe(l){l._valueTracker||(l._valueTracker=be(l))}function Ue(l){if(!l)return!1;var h=l._valueTracker;if(!h)return!0;var m=h.getValue(),v="";return l&&(v=ce(l)?l.checked?"true":"false":l.value),l=v,l!==m?(h.setValue(l),!0):!1}function Ie(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function Fe(l,h){var m=h.checked;return we({},h,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??l._wrapperState.initialChecked})}function Oe(l,h){var m=h.defaultValue==null?"":h.defaultValue,v=h.checked!=null?h.checked:h.defaultChecked;m=ut(h.value!=null?h.value:m),l._wrapperState={initialChecked:v,initialValue:m,controlled:h.type==="checkbox"||h.type==="radio"?h.checked!=null:h.value!=null}}function Xe(l,h){h=h.checked,h!=null&&S(l,"checked",h,!1)}function dt(l,h){Xe(l,h);var m=ut(h.value),v=h.type;if(m!=null)v==="number"?(m===0&&l.value===""||l.value!=m)&&(l.value=""+m):l.value!==""+m&&(l.value=""+m);else if(v==="submit"||v==="reset"){l.removeAttribute("value");return}h.hasOwnProperty("value")?ht(l,h.type,m):h.hasOwnProperty("defaultValue")&&ht(l,h.type,ut(h.defaultValue)),h.checked==null&&h.defaultChecked!=null&&(l.defaultChecked=!!h.defaultChecked)}function mt(l,h,m){if(h.hasOwnProperty("value")||h.hasOwnProperty("defaultValue")){var v=h.type;if(!(v!=="submit"&&v!=="reset"||h.value!==void 0&&h.value!==null))return;h=""+l._wrapperState.initialValue,m||h===l.value||(l.value=h),l.defaultValue=h}m=l.name,m!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,m!==""&&(l.name=m)}function ht(l,h,m){(h!=="number"||Ie(l.ownerDocument)!==l)&&(m==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+m&&(l.defaultValue=""+m))}var wt=Array.isArray;function Lt(l,h,m,v){if(l=l.options,h){h={};for(var T=0;T<m.length;T++)h["$"+m[T]]=!0;for(m=0;m<l.length;m++)T=h.hasOwnProperty("$"+l[m].value),l[m].selected!==T&&(l[m].selected=T),T&&v&&(l[m].defaultSelected=!0)}else{for(m=""+ut(m),h=null,T=0;T<l.length;T++){if(l[T].value===m){l[T].selected=!0,v&&(l[T].defaultSelected=!0);return}h!==null||l[T].disabled||(h=l[T])}h!==null&&(h.selected=!0)}}function Tt(l,h){if(h.dangerouslySetInnerHTML!=null)throw Error(n(91));return we({},h,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function ot(l,h){var m=h.value;if(m==null){if(m=h.children,h=h.defaultValue,m!=null){if(h!=null)throw Error(n(92));if(wt(m)){if(1<m.length)throw Error(n(93));m=m[0]}h=m}h==null&&(h=""),m=h}l._wrapperState={initialValue:ut(m)}}function jt(l,h){var m=ut(h.value),v=ut(h.defaultValue);m!=null&&(m=""+m,m!==l.value&&(l.value=m),h.defaultValue==null&&l.defaultValue!==m&&(l.defaultValue=m)),v!=null&&(l.defaultValue=""+v)}function Nt(l){var h=l.textContent;h===l._wrapperState.initialValue&&h!==""&&h!==null&&(l.value=h)}function Gt(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wt(l,h){return l==null||l==="http://www.w3.org/1999/xhtml"?Gt(h):l==="http://www.w3.org/2000/svg"&&h==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var hn,Sn=function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(h,m,v,T){MSApp.execUnsafeLocalFunction(function(){return l(h,m,v,T)})}:l}(function(l,h){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=h;else{for(hn=hn||document.createElement("div"),hn.innerHTML="<svg>"+h.valueOf().toString()+"</svg>",h=hn.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;h.firstChild;)l.appendChild(h.firstChild)}});function Jn(l,h){if(h){var m=l.firstChild;if(m&&m===l.lastChild&&m.nodeType===3){m.nodeValue=h;return}}l.textContent=h}var Wn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Un=["Webkit","ms","Moz","O"];Object.keys(Wn).forEach(function(l){Un.forEach(function(h){h=h+l.charAt(0).toUpperCase()+l.substring(1),Wn[h]=Wn[l]})});function Xn(l,h,m){return h==null||typeof h=="boolean"||h===""?"":m||typeof h!="number"||h===0||Wn.hasOwnProperty(l)&&Wn[l]?(""+h).trim():h+"px"}function Gn(l,h){l=l.style;for(var m in h)if(h.hasOwnProperty(m)){var v=m.indexOf("--")===0,T=Xn(m,h[m],v);m==="float"&&(m="cssFloat"),v?l.setProperty(m,T):l[m]=T}}var is=we({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vn(l,h){if(h){if(is[l]&&(h.children!=null||h.dangerouslySetInnerHTML!=null))throw Error(n(137,l));if(h.dangerouslySetInnerHTML!=null){if(h.children!=null)throw Error(n(60));if(typeof h.dangerouslySetInnerHTML!="object"||!("__html"in h.dangerouslySetInnerHTML))throw Error(n(61))}if(h.style!=null&&typeof h.style!="object")throw Error(n(62))}}function An(l,h){if(l.indexOf("-")===-1)return typeof h.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yn=null;function xn(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var fn=null,Ht=null,vt=null;function Pn(l){if(l=au(l)){if(typeof fn!="function")throw Error(n(280));var h=l.stateNode;h&&(h=ih(h),fn(l.stateNode,l.type,h))}}function Zn(l){Ht?vt?vt.push(l):vt=[l]:Ht=l}function qt(){if(Ht){var l=Ht,h=vt;if(vt=Ht=null,Pn(l),h)for(l=0;l<h.length;l++)Pn(h[l])}}function cn(l,h){return l(h)}function on(){}var vn=!1;function wn(l,h,m){if(vn)return l(h,m);vn=!0;try{return cn(l,h,m)}finally{vn=!1,(Ht!==null||vt!==null)&&(on(),qt())}}function Rn(l,h){var m=l.stateNode;if(m===null)return null;var v=ih(m);if(v===null)return null;m=v[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(l=l.type,v=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!v;break e;default:l=!1}if(l)return null;if(m&&typeof m!="function")throw Error(n(231,h,typeof m));return m}var jn=!1;if(a)try{var Bt={};Object.defineProperty(Bt,"passive",{get:function(){jn=!0}}),window.addEventListener("test",Bt,Bt),window.removeEventListener("test",Bt,Bt)}catch{jn=!1}function os(l,h,m,v,T,N,D,J,de){var ke=Array.prototype.slice.call(arguments,3);try{h.apply(m,ke)}catch(Ke){this.onError(Ke)}}var q=!1,Y=null,ne=!1,K=null,Me={onError:function(l){q=!0,Y=l}};function Qe(l,h,m,v,T,N,D,J,de){q=!1,Y=null,os.apply(Me,arguments)}function at(l,h,m,v,T,N,D,J,de){if(Qe.apply(this,arguments),q){if(q){var ke=Y;q=!1,Y=null}else throw Error(n(198));ne||(ne=!0,K=ke)}}function tt(l){var h=l,m=l;if(l.alternate)for(;h.return;)h=h.return;else{l=h;do h=l,(h.flags&4098)!==0&&(m=h.return),l=h.return;while(l)}return h.tag===3?m:null}function ct(l){if(l.tag===13){var h=l.memoizedState;if(h===null&&(l=l.alternate,l!==null&&(h=l.memoizedState)),h!==null)return h.dehydrated}return null}function yt(l){if(tt(l)!==l)throw Error(n(188))}function Mt(l){var h=l.alternate;if(!h){if(h=tt(l),h===null)throw Error(n(188));return h!==l?null:l}for(var m=l,v=h;;){var T=m.return;if(T===null)break;var N=T.alternate;if(N===null){if(v=T.return,v!==null){m=v;continue}break}if(T.child===N.child){for(N=T.child;N;){if(N===m)return yt(T),l;if(N===v)return yt(T),h;N=N.sibling}throw Error(n(188))}if(m.return!==v.return)m=T,v=N;else{for(var D=!1,J=T.child;J;){if(J===m){D=!0,m=T,v=N;break}if(J===v){D=!0,v=T,m=N;break}J=J.sibling}if(!D){for(J=N.child;J;){if(J===m){D=!0,m=N,v=T;break}if(J===v){D=!0,v=N,m=T;break}J=J.sibling}if(!D)throw Error(n(189))}}if(m.alternate!==v)throw Error(n(190))}if(m.tag!==3)throw Error(n(188));return m.stateNode.current===m?l:h}function Pt(l){return l=Mt(l),l!==null?At(l):null}function At(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var h=At(l);if(h!==null)return h;l=l.sibling}return null}var Ft=t.unstable_scheduleCallback,Zt=t.unstable_cancelCallback,nn=t.unstable_shouldYield,H=t.unstable_requestPaint,U=t.unstable_now,G=t.unstable_getCurrentPriorityLevel,$=t.unstable_ImmediatePriority,ie=t.unstable_UserBlockingPriority,ue=t.unstable_NormalPriority,te=t.unstable_LowPriority,se=t.unstable_IdlePriority,ge=null,Ee=null;function xe(l){if(Ee&&typeof Ee.onCommitFiberRoot=="function")try{Ee.onCommitFiberRoot(ge,l,void 0,(l.current.flags&128)===128)}catch{}}var Se=Math.clz32?Math.clz32:ve,Ne=Math.log,De=Math.LN2;function ve(l){return l>>>=0,l===0?32:31-(Ne(l)/De|0)|0}var Be=64,$e=4194304;function je(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Ye(l,h){var m=l.pendingLanes;if(m===0)return 0;var v=0,T=l.suspendedLanes,N=l.pingedLanes,D=m&268435455;if(D!==0){var J=D&~T;J!==0?v=je(J):(N&=D,N!==0&&(v=je(N)))}else D=m&~T,D!==0?v=je(D):N!==0&&(v=je(N));if(v===0)return 0;if(h!==0&&h!==v&&(h&T)===0&&(T=v&-v,N=h&-h,T>=N||T===16&&(N&4194240)!==0))return h;if((v&4)!==0&&(v|=m&16),h=l.entangledLanes,h!==0)for(l=l.entanglements,h&=v;0<h;)m=31-Se(h),T=1<<m,v|=l[m],h&=~T;return v}function w(l,h){switch(l){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function I(l,h){for(var m=l.suspendedLanes,v=l.pingedLanes,T=l.expirationTimes,N=l.pendingLanes;0<N;){var D=31-Se(N),J=1<<D,de=T[D];de===-1?((J&m)===0||(J&v)!==0)&&(T[D]=w(J,h)):de<=h&&(l.expiredLanes|=J),N&=~J}}function F(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function B(){var l=Be;return Be<<=1,(Be&4194240)===0&&(Be=64),l}function le(l){for(var h=[],m=0;31>m;m++)h.push(l);return h}function ee(l,h,m){l.pendingLanes|=h,h!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,h=31-Se(h),l[h]=m}function ye(l,h){var m=l.pendingLanes&~h;l.pendingLanes=h,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=h,l.mutableReadLanes&=h,l.entangledLanes&=h,h=l.entanglements;var v=l.eventTimes;for(l=l.expirationTimes;0<m;){var T=31-Se(m),N=1<<T;h[T]=0,v[T]=-1,l[T]=-1,m&=~N}}function Pe(l,h){var m=l.entangledLanes|=h;for(l=l.entanglements;m;){var v=31-Se(m),T=1<<v;T&h|l[v]&h&&(l[v]|=h),m&=~T}}var Ve=0;function rt(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var it,St,Jt,Kt,Xt,an=!1,Qt=[],gn=null,Yt=null,as=null,gs=new Map,pn=new Map,es=[],mr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ss(l,h){switch(l){case"focusin":case"focusout":gn=null;break;case"dragenter":case"dragleave":Yt=null;break;case"mouseover":case"mouseout":as=null;break;case"pointerover":case"pointerout":gs.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":pn.delete(h.pointerId)}}function mn(l,h,m,v,T,N){return l===null||l.nativeEvent!==N?(l={blockedOn:h,domEventName:m,eventSystemFlags:v,nativeEvent:N,targetContainers:[T]},h!==null&&(h=au(h),h!==null&&St(h)),l):(l.eventSystemFlags|=v,h=l.targetContainers,T!==null&&h.indexOf(T)===-1&&h.push(T),l)}function Fn(l,h,m,v,T){switch(h){case"focusin":return gn=mn(gn,l,h,m,v,T),!0;case"dragenter":return Yt=mn(Yt,l,h,m,v,T),!0;case"mouseover":return as=mn(as,l,h,m,v,T),!0;case"pointerover":var N=T.pointerId;return gs.set(N,mn(gs.get(N)||null,l,h,m,v,T)),!0;case"gotpointercapture":return N=T.pointerId,pn.set(N,mn(pn.get(N)||null,l,h,m,v,T)),!0}return!1}function Hn(l){var h=qo(l.target);if(h!==null){var m=tt(h);if(m!==null){if(h=m.tag,h===13){if(h=ct(m),h!==null){l.blockedOn=h,Xt(l.priority,function(){Jt(m)});return}}else if(h===3&&m.stateNode.current.memoizedState.isDehydrated){l.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}l.blockedOn=null}function As(l){if(l.blockedOn!==null)return!1;for(var h=l.targetContainers;0<h.length;){var m=Bo(l.domEventName,l.eventSystemFlags,h[0],l.nativeEvent);if(m===null){m=l.nativeEvent;var v=new m.constructor(m.type,m);Yn=v,m.target.dispatchEvent(v),Yn=null}else return h=au(m),h!==null&&St(h),l.blockedOn=m,!1;h.shift()}return!0}function _r(l,h,m){As(l)&&m.delete(h)}function ln(){an=!1,gn!==null&&As(gn)&&(gn=null),Yt!==null&&As(Yt)&&(Yt=null),as!==null&&As(as)&&(as=null),gs.forEach(_r),pn.forEach(_r)}function Xs(l,h){l.blockedOn===h&&(l.blockedOn=null,an||(an=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,ln)))}function ar(l){function h(T){return Xs(T,l)}if(0<Qt.length){Xs(Qt[0],l);for(var m=1;m<Qt.length;m++){var v=Qt[m];v.blockedOn===l&&(v.blockedOn=null)}}for(gn!==null&&Xs(gn,l),Yt!==null&&Xs(Yt,l),as!==null&&Xs(as,l),gs.forEach(h),pn.forEach(h),m=0;m<es.length;m++)v=es[m],v.blockedOn===l&&(v.blockedOn=null);for(;0<es.length&&(m=es[0],m.blockedOn===null);)Hn(m),m.blockedOn===null&&es.shift()}var yr=A.ReactCurrentBatchConfig,lr=!0;function Ia(l,h,m,v){var T=Ve,N=yr.transition;yr.transition=null;try{Ve=1,ka(l,h,m,v)}finally{Ve=T,yr.transition=N}}function mi(l,h,m,v){var T=Ve,N=yr.transition;yr.transition=null;try{Ve=4,ka(l,h,m,v)}finally{Ve=T,yr.transition=N}}function ka(l,h,m,v){if(lr){var T=Bo(l,h,m,v);if(T===null)Cf(l,h,v,eo,m),Ss(l,v);else if(Fn(T,l,h,m,v))v.stopPropagation();else if(Ss(l,v),h&4&&-1<mr.indexOf(l)){for(;T!==null;){var N=au(T);if(N!==null&&it(N),N=Bo(l,h,m,v),N===null&&Cf(l,h,v,eo,m),N===T)break;T=N}T!==null&&v.stopPropagation()}else Cf(l,h,v,null,m)}}var eo=null;function Bo(l,h,m,v){if(eo=null,l=xn(v),l=qo(l),l!==null)if(h=tt(l),h===null)l=null;else if(m=h.tag,m===13){if(l=ct(h),l!==null)return l;l=null}else if(m===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;l=null}else h!==l&&(l=null);return eo=l,null}function ql(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(G()){case $:return 1;case ie:return 4;case ue:case te:return 16;case se:return 536870912;default:return 16}default:return 16}}var Rr=null,Ma=null,Pa=null;function qd(){if(Pa)return Pa;var l,h=Ma,m=h.length,v,T="value"in Rr?Rr.value:Rr.textContent,N=T.length;for(l=0;l<m&&h[l]===T[l];l++);var D=m-l;for(v=1;v<=D&&h[m-v]===T[N-v];v++);return Pa=T.slice(l,1<v?1-v:void 0)}function _i(l){var h=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&h===13&&(l=13)):l=h,l===10&&(l=13),32<=l||l===13?l:0}function Uo(){return!0}function Go(){return!1}function _s(l){function h(m,v,T,N,D){this._reactName=m,this._targetInst=T,this.type=v,this.nativeEvent=N,this.target=D,this.currentTarget=null;for(var J in l)l.hasOwnProperty(J)&&(m=l[J],this[J]=m?m(N):N[J]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?Uo:Go,this.isPropagationStopped=Go,this}return we(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Uo)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Uo)},persist:function(){},isPersistent:Uo}),h}var to={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yi=_s(to),Vo=we({},to,{view:0,detail:0}),$l=_s(Vo),no,xi,Jr,jo=we({},Vo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:za,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Jr&&(Jr&&l.type==="mousemove"?(no=l.screenX-Jr.screenX,xi=l.screenY-Jr.screenY):xi=no=0,Jr=l),no)},movementY:function(l){return"movementY"in l?l.movementY:xi}}),Wl=_s(jo),$d=we({},jo,{dataTransfer:0}),Xl=_s($d),Bs=we({},Vo,{relatedTarget:0}),Ra=_s(Bs),Yl=we({},to,{animationName:0,elapsedTime:0,pseudoElement:0}),_f=_s(Yl),Wd=we({},to,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),Fa=_s(Wd),Xd=we({},to,{data:0}),Zl=_s(Xd),Da={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Oa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zd(l){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(l):(l=Yd[l])?!!h[l]:!1}function za(){return Zd}var Kl=we({},Vo,{key:function(l){if(l.key){var h=Da[l.key]||l.key;if(h!=="Unidentified")return h}return l.type==="keypress"?(l=_i(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?Oa[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:za,charCode:function(l){return l.type==="keypress"?_i(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?_i(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Kd=_s(Kl),L=we({},jo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),P=_s(L),V=we({},Vo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:za}),W=_s(V),Le=we({},to,{propertyName:0,elapsedTime:0,pseudoElement:0}),Te=_s(Le),He=we({},jo,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),et=_s(He),Rt=[9,13,27,32],Ut=a&&"CompositionEvent"in window,Dt=null;a&&"documentMode"in document&&(Dt=document.documentMode);var _n=a&&"TextEvent"in window&&!Dt,ws=a&&(!Ut||Dt&&8<Dt&&11>=Dt),Ys=" ",Zs=!1;function Ho(l,h){switch(l){case"keyup":return Rt.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ql(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var ei=!1;function YL(l,h){switch(l){case"compositionend":return Ql(h);case"keypress":return h.which!==32?null:(Zs=!0,Ys);case"textInput":return l=h.data,l===Ys&&Zs?null:l;default:return null}}function ZL(l,h){if(ei)return l==="compositionend"||!Ut&&Ho(l,h)?(l=qd(),Pa=Ma=Rr=null,ei=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return ws&&h.locale!=="ko"?null:h.data;default:return null}}var KL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Px(l){var h=l&&l.nodeName&&l.nodeName.toLowerCase();return h==="input"?!!KL[l.type]:h==="textarea"}function Rx(l,h,m,v){Zn(v),h=nh(h,"onChange"),0<h.length&&(m=new yi("onChange","change",null,m,v),l.push({event:m,listeners:h}))}var Jl=null,eu=null;function QL(l){Qx(l,0)}function Qd(l){var h=ja(l);if(Ue(h))return l}function JL(l,h){if(l==="change")return h}var Fx=!1;if(a){var yf;if(a){var xf="oninput"in document;if(!xf){var Dx=document.createElement("div");Dx.setAttribute("oninput","return;"),xf=typeof Dx.oninput=="function"}yf=xf}else yf=!1;Fx=yf&&(!document.documentMode||9<document.documentMode)}function Ox(){Jl&&(Jl.detachEvent("onpropertychange",zx),eu=Jl=null)}function zx(l){if(l.propertyName==="value"&&Qd(eu)){var h=[];Rx(h,eu,l,xn(l)),wn(QL,h)}}function eN(l,h,m){l==="focusin"?(Ox(),Jl=h,eu=m,Jl.attachEvent("onpropertychange",zx)):l==="focusout"&&Ox()}function tN(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Qd(eu)}function nN(l,h){if(l==="click")return Qd(h)}function sN(l,h){if(l==="input"||l==="change")return Qd(h)}function rN(l,h){return l===h&&(l!==0||1/l===1/h)||l!==l&&h!==h}var Fr=typeof Object.is=="function"?Object.is:rN;function tu(l,h){if(Fr(l,h))return!0;if(typeof l!="object"||l===null||typeof h!="object"||h===null)return!1;var m=Object.keys(l),v=Object.keys(h);if(m.length!==v.length)return!1;for(v=0;v<m.length;v++){var T=m[v];if(!u.call(h,T)||!Fr(l[T],h[T]))return!1}return!0}function Bx(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function Ux(l,h){var m=Bx(l);l=0;for(var v;m;){if(m.nodeType===3){if(v=l+m.textContent.length,l<=h&&v>=h)return{node:m,offset:h-l};l=v}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=Bx(m)}}function Gx(l,h){return l&&h?l===h?!0:l&&l.nodeType===3?!1:h&&h.nodeType===3?Gx(l,h.parentNode):"contains"in l?l.contains(h):l.compareDocumentPosition?!!(l.compareDocumentPosition(h)&16):!1:!1}function Vx(){for(var l=window,h=Ie();h instanceof l.HTMLIFrameElement;){try{var m=typeof h.contentWindow.location.href=="string"}catch{m=!1}if(m)l=h.contentWindow;else break;h=Ie(l.document)}return h}function vf(l){var h=l&&l.nodeName&&l.nodeName.toLowerCase();return h&&(h==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||h==="textarea"||l.contentEditable==="true")}function iN(l){var h=Vx(),m=l.focusedElem,v=l.selectionRange;if(h!==m&&m&&m.ownerDocument&&Gx(m.ownerDocument.documentElement,m)){if(v!==null&&vf(m)){if(h=v.start,l=v.end,l===void 0&&(l=h),"selectionStart"in m)m.selectionStart=h,m.selectionEnd=Math.min(l,m.value.length);else if(l=(h=m.ownerDocument||document)&&h.defaultView||window,l.getSelection){l=l.getSelection();var T=m.textContent.length,N=Math.min(v.start,T);v=v.end===void 0?N:Math.min(v.end,T),!l.extend&&N>v&&(T=v,v=N,N=T),T=Ux(m,N);var D=Ux(m,v);T&&D&&(l.rangeCount!==1||l.anchorNode!==T.node||l.anchorOffset!==T.offset||l.focusNode!==D.node||l.focusOffset!==D.offset)&&(h=h.createRange(),h.setStart(T.node,T.offset),l.removeAllRanges(),N>v?(l.addRange(h),l.extend(D.node,D.offset)):(h.setEnd(D.node,D.offset),l.addRange(h)))}}for(h=[],l=m;l=l.parentNode;)l.nodeType===1&&h.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<h.length;m++)l=h[m],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var oN=a&&"documentMode"in document&&11>=document.documentMode,Ba=null,bf=null,nu=null,Ef=!1;function jx(l,h,m){var v=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;Ef||Ba==null||Ba!==Ie(v)||(v=Ba,"selectionStart"in v&&vf(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),nu&&tu(nu,v)||(nu=v,v=nh(bf,"onSelect"),0<v.length&&(h=new yi("onSelect","select",null,h,m),l.push({event:h,listeners:v}),h.target=Ba)))}function Jd(l,h){var m={};return m[l.toLowerCase()]=h.toLowerCase(),m["Webkit"+l]="webkit"+h,m["Moz"+l]="moz"+h,m}var Ua={animationend:Jd("Animation","AnimationEnd"),animationiteration:Jd("Animation","AnimationIteration"),animationstart:Jd("Animation","AnimationStart"),transitionend:Jd("Transition","TransitionEnd")},Sf={},Hx={};a&&(Hx=document.createElement("div").style,"AnimationEvent"in window||(delete Ua.animationend.animation,delete Ua.animationiteration.animation,delete Ua.animationstart.animation),"TransitionEvent"in window||delete Ua.transitionend.transition);function eh(l){if(Sf[l])return Sf[l];if(!Ua[l])return l;var h=Ua[l],m;for(m in h)if(h.hasOwnProperty(m)&&m in Hx)return Sf[l]=h[m];return l}var qx=eh("animationend"),$x=eh("animationiteration"),Wx=eh("animationstart"),Xx=eh("transitionend"),Yx=new Map,Zx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function so(l,h){Yx.set(l,h),i(h,[l])}for(var Af=0;Af<Zx.length;Af++){var wf=Zx[Af],aN=wf.toLowerCase(),lN=wf[0].toUpperCase()+wf.slice(1);so(aN,"on"+lN)}so(qx,"onAnimationEnd"),so($x,"onAnimationIteration"),so(Wx,"onAnimationStart"),so("dblclick","onDoubleClick"),so("focusin","onFocus"),so("focusout","onBlur"),so(Xx,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var su="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uN=new Set("cancel close invalid load scroll toggle".split(" ").concat(su));function Kx(l,h,m){var v=l.type||"unknown-event";l.currentTarget=m,at(v,h,void 0,l),l.currentTarget=null}function Qx(l,h){h=(h&4)!==0;for(var m=0;m<l.length;m++){var v=l[m],T=v.event;v=v.listeners;e:{var N=void 0;if(h)for(var D=v.length-1;0<=D;D--){var J=v[D],de=J.instance,ke=J.currentTarget;if(J=J.listener,de!==N&&T.isPropagationStopped())break e;Kx(T,J,ke),N=de}else for(D=0;D<v.length;D++){if(J=v[D],de=J.instance,ke=J.currentTarget,J=J.listener,de!==N&&T.isPropagationStopped())break e;Kx(T,J,ke),N=de}}}if(ne)throw l=K,ne=!1,K=null,l}function Tn(l,h){var m=h[Pf];m===void 0&&(m=h[Pf]=new Set);var v=l+"__bubble";m.has(v)||(Jx(h,l,2,!1),m.add(v))}function Tf(l,h,m){var v=0;h&&(v|=4),Jx(m,l,v,h)}var th="_reactListening"+Math.random().toString(36).slice(2);function ru(l){if(!l[th]){l[th]=!0,s.forEach(function(m){m!=="selectionchange"&&(uN.has(m)||Tf(m,!1,l),Tf(m,!0,l))});var h=l.nodeType===9?l:l.ownerDocument;h===null||h[th]||(h[th]=!0,Tf("selectionchange",!1,h))}}function Jx(l,h,m,v){switch(ql(h)){case 1:var T=Ia;break;case 4:T=mi;break;default:T=ka}m=T.bind(null,h,m,l),T=void 0,!jn||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(T=!0),v?T!==void 0?l.addEventListener(h,m,{capture:!0,passive:T}):l.addEventListener(h,m,!0):T!==void 0?l.addEventListener(h,m,{passive:T}):l.addEventListener(h,m,!1)}function Cf(l,h,m,v,T){var N=v;if((h&1)===0&&(h&2)===0&&v!==null)e:for(;;){if(v===null)return;var D=v.tag;if(D===3||D===4){var J=v.stateNode.containerInfo;if(J===T||J.nodeType===8&&J.parentNode===T)break;if(D===4)for(D=v.return;D!==null;){var de=D.tag;if((de===3||de===4)&&(de=D.stateNode.containerInfo,de===T||de.nodeType===8&&de.parentNode===T))return;D=D.return}for(;J!==null;){if(D=qo(J),D===null)return;if(de=D.tag,de===5||de===6){v=N=D;continue e}J=J.parentNode}}v=v.return}wn(function(){var ke=N,Ke=xn(m),Je=[];e:{var Ze=Yx.get(l);if(Ze!==void 0){var gt=yi,xt=l;switch(l){case"keypress":if(_i(m)===0)break e;case"keydown":case"keyup":gt=Kd;break;case"focusin":xt="focus",gt=Ra;break;case"focusout":xt="blur",gt=Ra;break;case"beforeblur":case"afterblur":gt=Ra;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":gt=Wl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":gt=Xl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":gt=W;break;case qx:case $x:case Wx:gt=_f;break;case Xx:gt=Te;break;case"scroll":gt=$l;break;case"wheel":gt=et;break;case"copy":case"cut":case"paste":gt=Fa;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":gt=P}var bt=(h&4)!==0,ts=!bt&&l==="scroll",Ae=bt?Ze!==null?Ze+"Capture":null:Ze;bt=[];for(var pe=ke,Ce;pe!==null;){Ce=pe;var nt=Ce.stateNode;if(Ce.tag===5&&nt!==null&&(Ce=nt,Ae!==null&&(nt=Rn(pe,Ae),nt!=null&&bt.push(iu(pe,nt,Ce)))),ts)break;pe=pe.return}0<bt.length&&(Ze=new gt(Ze,xt,null,m,Ke),Je.push({event:Ze,listeners:bt}))}}if((h&7)===0){e:{if(Ze=l==="mouseover"||l==="pointerover",gt=l==="mouseout"||l==="pointerout",Ze&&m!==Yn&&(xt=m.relatedTarget||m.fromElement)&&(qo(xt)||xt[vi]))break e;if((gt||Ze)&&(Ze=Ke.window===Ke?Ke:(Ze=Ke.ownerDocument)?Ze.defaultView||Ze.parentWindow:window,gt?(xt=m.relatedTarget||m.toElement,gt=ke,xt=xt?qo(xt):null,xt!==null&&(ts=tt(xt),xt!==ts||xt.tag!==5&&xt.tag!==6)&&(xt=null)):(gt=null,xt=ke),gt!==xt)){if(bt=Wl,nt="onMouseLeave",Ae="onMouseEnter",pe="mouse",(l==="pointerout"||l==="pointerover")&&(bt=P,nt="onPointerLeave",Ae="onPointerEnter",pe="pointer"),ts=gt==null?Ze:ja(gt),Ce=xt==null?Ze:ja(xt),Ze=new bt(nt,pe+"leave",gt,m,Ke),Ze.target=ts,Ze.relatedTarget=Ce,nt=null,qo(Ke)===ke&&(bt=new bt(Ae,pe+"enter",xt,m,Ke),bt.target=Ce,bt.relatedTarget=ts,nt=bt),ts=nt,gt&&xt)t:{for(bt=gt,Ae=xt,pe=0,Ce=bt;Ce;Ce=Ga(Ce))pe++;for(Ce=0,nt=Ae;nt;nt=Ga(nt))Ce++;for(;0<pe-Ce;)bt=Ga(bt),pe--;for(;0<Ce-pe;)Ae=Ga(Ae),Ce--;for(;pe--;){if(bt===Ae||Ae!==null&&bt===Ae.alternate)break t;bt=Ga(bt),Ae=Ga(Ae)}bt=null}else bt=null;gt!==null&&e0(Je,Ze,gt,bt,!1),xt!==null&&ts!==null&&e0(Je,ts,xt,bt,!0)}}e:{if(Ze=ke?ja(ke):window,gt=Ze.nodeName&&Ze.nodeName.toLowerCase(),gt==="select"||gt==="input"&&Ze.type==="file")var Et=JL;else if(Px(Ze))if(Fx)Et=sN;else{Et=tN;var It=eN}else(gt=Ze.nodeName)&&gt.toLowerCase()==="input"&&(Ze.type==="checkbox"||Ze.type==="radio")&&(Et=nN);if(Et&&(Et=Et(l,ke))){Rx(Je,Et,m,Ke);break e}It&&It(l,Ze,ke),l==="focusout"&&(It=Ze._wrapperState)&&It.controlled&&Ze.type==="number"&&ht(Ze,"number",Ze.value)}switch(It=ke?ja(ke):window,l){case"focusin":(Px(It)||It.contentEditable==="true")&&(Ba=It,bf=ke,nu=null);break;case"focusout":nu=bf=Ba=null;break;case"mousedown":Ef=!0;break;case"contextmenu":case"mouseup":case"dragend":Ef=!1,jx(Je,m,Ke);break;case"selectionchange":if(oN)break;case"keydown":case"keyup":jx(Je,m,Ke)}var kt;if(Ut)e:{switch(l){case"compositionstart":var Ot="onCompositionStart";break e;case"compositionend":Ot="onCompositionEnd";break e;case"compositionupdate":Ot="onCompositionUpdate";break e}Ot=void 0}else ei?Ho(l,m)&&(Ot="onCompositionEnd"):l==="keydown"&&m.keyCode===229&&(Ot="onCompositionStart");Ot&&(ws&&m.locale!=="ko"&&(ei||Ot!=="onCompositionStart"?Ot==="onCompositionEnd"&&ei&&(kt=qd()):(Rr=Ke,Ma="value"in Rr?Rr.value:Rr.textContent,ei=!0)),It=nh(ke,Ot),0<It.length&&(Ot=new Zl(Ot,l,null,m,Ke),Je.push({event:Ot,listeners:It}),kt?Ot.data=kt:(kt=Ql(m),kt!==null&&(Ot.data=kt)))),(kt=_n?YL(l,m):ZL(l,m))&&(ke=nh(ke,"onBeforeInput"),0<ke.length&&(Ke=new Zl("onBeforeInput","beforeinput",null,m,Ke),Je.push({event:Ke,listeners:ke}),Ke.data=kt))}Qx(Je,h)})}function iu(l,h,m){return{instance:l,listener:h,currentTarget:m}}function nh(l,h){for(var m=h+"Capture",v=[];l!==null;){var T=l,N=T.stateNode;T.tag===5&&N!==null&&(T=N,N=Rn(l,m),N!=null&&v.unshift(iu(l,N,T)),N=Rn(l,h),N!=null&&v.push(iu(l,N,T))),l=l.return}return v}function Ga(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function e0(l,h,m,v,T){for(var N=h._reactName,D=[];m!==null&&m!==v;){var J=m,de=J.alternate,ke=J.stateNode;if(de!==null&&de===v)break;J.tag===5&&ke!==null&&(J=ke,T?(de=Rn(m,N),de!=null&&D.unshift(iu(m,de,J))):T||(de=Rn(m,N),de!=null&&D.push(iu(m,de,J)))),m=m.return}D.length!==0&&l.push({event:h,listeners:D})}var dN=/\r\n?/g,hN=/\u0000|\uFFFD/g;function t0(l){return(typeof l=="string"?l:""+l).replace(dN,`
`).replace(hN,"")}function sh(l,h,m){if(h=t0(h),t0(l)!==h&&m)throw Error(n(425))}function rh(){}var Lf=null,Nf=null;function If(l,h){return l==="textarea"||l==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var kf=typeof setTimeout=="function"?setTimeout:void 0,cN=typeof clearTimeout=="function"?clearTimeout:void 0,n0=typeof Promise=="function"?Promise:void 0,gN=typeof queueMicrotask=="function"?queueMicrotask:typeof n0<"u"?function(l){return n0.resolve(null).then(l).catch(fN)}:kf;function fN(l){setTimeout(function(){throw l})}function Mf(l,h){var m=h,v=0;do{var T=m.nextSibling;if(l.removeChild(m),T&&T.nodeType===8)if(m=T.data,m==="/$"){if(v===0){l.removeChild(T),ar(h);return}v--}else m!=="$"&&m!=="$?"&&m!=="$!"||v++;m=T}while(m);ar(h)}function ro(l){for(;l!=null;l=l.nextSibling){var h=l.nodeType;if(h===1||h===3)break;if(h===8){if(h=l.data,h==="$"||h==="$!"||h==="$?")break;if(h==="/$")return null}}return l}function s0(l){l=l.previousSibling;for(var h=0;l;){if(l.nodeType===8){var m=l.data;if(m==="$"||m==="$!"||m==="$?"){if(h===0)return l;h--}else m==="/$"&&h++}l=l.previousSibling}return null}var Va=Math.random().toString(36).slice(2),ti="__reactFiber$"+Va,ou="__reactProps$"+Va,vi="__reactContainer$"+Va,Pf="__reactEvents$"+Va,pN="__reactListeners$"+Va,mN="__reactHandles$"+Va;function qo(l){var h=l[ti];if(h)return h;for(var m=l.parentNode;m;){if(h=m[vi]||m[ti]){if(m=h.alternate,h.child!==null||m!==null&&m.child!==null)for(l=s0(l);l!==null;){if(m=l[ti])return m;l=s0(l)}return h}l=m,m=l.parentNode}return null}function au(l){return l=l[ti]||l[vi],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function ja(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(n(33))}function ih(l){return l[ou]||null}var Rf=[],Ha=-1;function io(l){return{current:l}}function Cn(l){0>Ha||(l.current=Rf[Ha],Rf[Ha]=null,Ha--)}function bn(l,h){Ha++,Rf[Ha]=l.current,l.current=h}var oo={},Ts=io(oo),Ks=io(!1),$o=oo;function qa(l,h){var m=l.type.contextTypes;if(!m)return oo;var v=l.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===h)return v.__reactInternalMemoizedMaskedChildContext;var T={},N;for(N in m)T[N]=h[N];return v&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=h,l.__reactInternalMemoizedMaskedChildContext=T),T}function Qs(l){return l=l.childContextTypes,l!=null}function oh(){Cn(Ks),Cn(Ts)}function r0(l,h,m){if(Ts.current!==oo)throw Error(n(168));bn(Ts,h),bn(Ks,m)}function i0(l,h,m){var v=l.stateNode;if(h=h.childContextTypes,typeof v.getChildContext!="function")return m;v=v.getChildContext();for(var T in v)if(!(T in h))throw Error(n(108,ft(l)||"Unknown",T));return we({},m,v)}function ah(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||oo,$o=Ts.current,bn(Ts,l),bn(Ks,Ks.current),!0}function o0(l,h,m){var v=l.stateNode;if(!v)throw Error(n(169));m?(l=i0(l,h,$o),v.__reactInternalMemoizedMergedChildContext=l,Cn(Ks),Cn(Ts),bn(Ts,l)):Cn(Ks),bn(Ks,m)}var bi=null,lh=!1,Ff=!1;function a0(l){bi===null?bi=[l]:bi.push(l)}function _N(l){lh=!0,a0(l)}function ao(){if(!Ff&&bi!==null){Ff=!0;var l=0,h=Ve;try{var m=bi;for(Ve=1;l<m.length;l++){var v=m[l];do v=v(!0);while(v!==null)}bi=null,lh=!1}catch(T){throw bi!==null&&(bi=bi.slice(l+1)),Ft($,ao),T}finally{Ve=h,Ff=!1}}return null}var $a=[],Wa=0,uh=null,dh=0,xr=[],vr=0,Wo=null,Ei=1,Si="";function Xo(l,h){$a[Wa++]=dh,$a[Wa++]=uh,uh=l,dh=h}function l0(l,h,m){xr[vr++]=Ei,xr[vr++]=Si,xr[vr++]=Wo,Wo=l;var v=Ei;l=Si;var T=32-Se(v)-1;v&=~(1<<T),m+=1;var N=32-Se(h)+T;if(30<N){var D=T-T%5;N=(v&(1<<D)-1).toString(32),v>>=D,T-=D,Ei=1<<32-Se(h)+T|m<<T|v,Si=N+l}else Ei=1<<N|m<<T|v,Si=l}function Df(l){l.return!==null&&(Xo(l,1),l0(l,1,0))}function Of(l){for(;l===uh;)uh=$a[--Wa],$a[Wa]=null,dh=$a[--Wa],$a[Wa]=null;for(;l===Wo;)Wo=xr[--vr],xr[vr]=null,Si=xr[--vr],xr[vr]=null,Ei=xr[--vr],xr[vr]=null}var ur=null,dr=null,Dn=!1,Dr=null;function u0(l,h){var m=Ar(5,null,null,0);m.elementType="DELETED",m.stateNode=h,m.return=l,h=l.deletions,h===null?(l.deletions=[m],l.flags|=16):h.push(m)}function d0(l,h){switch(l.tag){case 5:var m=l.type;return h=h.nodeType!==1||m.toLowerCase()!==h.nodeName.toLowerCase()?null:h,h!==null?(l.stateNode=h,ur=l,dr=ro(h.firstChild),!0):!1;case 6:return h=l.pendingProps===""||h.nodeType!==3?null:h,h!==null?(l.stateNode=h,ur=l,dr=null,!0):!1;case 13:return h=h.nodeType!==8?null:h,h!==null?(m=Wo!==null?{id:Ei,overflow:Si}:null,l.memoizedState={dehydrated:h,treeContext:m,retryLane:1073741824},m=Ar(18,null,null,0),m.stateNode=h,m.return=l,l.child=m,ur=l,dr=null,!0):!1;default:return!1}}function zf(l){return(l.mode&1)!==0&&(l.flags&128)===0}function Bf(l){if(Dn){var h=dr;if(h){var m=h;if(!d0(l,h)){if(zf(l))throw Error(n(418));h=ro(m.nextSibling);var v=ur;h&&d0(l,h)?u0(v,m):(l.flags=l.flags&-4097|2,Dn=!1,ur=l)}}else{if(zf(l))throw Error(n(418));l.flags=l.flags&-4097|2,Dn=!1,ur=l}}}function h0(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;ur=l}function hh(l){if(l!==ur)return!1;if(!Dn)return h0(l),Dn=!0,!1;var h;if((h=l.tag!==3)&&!(h=l.tag!==5)&&(h=l.type,h=h!=="head"&&h!=="body"&&!If(l.type,l.memoizedProps)),h&&(h=dr)){if(zf(l))throw c0(),Error(n(418));for(;h;)u0(l,h),h=ro(h.nextSibling)}if(h0(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));e:{for(l=l.nextSibling,h=0;l;){if(l.nodeType===8){var m=l.data;if(m==="/$"){if(h===0){dr=ro(l.nextSibling);break e}h--}else m!=="$"&&m!=="$!"&&m!=="$?"||h++}l=l.nextSibling}dr=null}}else dr=ur?ro(l.stateNode.nextSibling):null;return!0}function c0(){for(var l=dr;l;)l=ro(l.nextSibling)}function Xa(){dr=ur=null,Dn=!1}function Uf(l){Dr===null?Dr=[l]:Dr.push(l)}var yN=A.ReactCurrentBatchConfig;function lu(l,h,m){if(l=m.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(n(309));var v=m.stateNode}if(!v)throw Error(n(147,l));var T=v,N=""+l;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===N?h.ref:(h=function(D){var J=T.refs;D===null?delete J[N]:J[N]=D},h._stringRef=N,h)}if(typeof l!="string")throw Error(n(284));if(!m._owner)throw Error(n(290,l))}return l}function ch(l,h){throw l=Object.prototype.toString.call(h),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":l))}function g0(l){var h=l._init;return h(l._payload)}function f0(l){function h(Ae,pe){if(l){var Ce=Ae.deletions;Ce===null?(Ae.deletions=[pe],Ae.flags|=16):Ce.push(pe)}}function m(Ae,pe){if(!l)return null;for(;pe!==null;)h(Ae,pe),pe=pe.sibling;return null}function v(Ae,pe){for(Ae=new Map;pe!==null;)pe.key!==null?Ae.set(pe.key,pe):Ae.set(pe.index,pe),pe=pe.sibling;return Ae}function T(Ae,pe){return Ae=mo(Ae,pe),Ae.index=0,Ae.sibling=null,Ae}function N(Ae,pe,Ce){return Ae.index=Ce,l?(Ce=Ae.alternate,Ce!==null?(Ce=Ce.index,Ce<pe?(Ae.flags|=2,pe):Ce):(Ae.flags|=2,pe)):(Ae.flags|=1048576,pe)}function D(Ae){return l&&Ae.alternate===null&&(Ae.flags|=2),Ae}function J(Ae,pe,Ce,nt){return pe===null||pe.tag!==6?(pe=kp(Ce,Ae.mode,nt),pe.return=Ae,pe):(pe=T(pe,Ce),pe.return=Ae,pe)}function de(Ae,pe,Ce,nt){var Et=Ce.type;return Et===M?Ke(Ae,pe,Ce.props.children,nt,Ce.key):pe!==null&&(pe.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===he&&g0(Et)===pe.type)?(nt=T(pe,Ce.props),nt.ref=lu(Ae,pe,Ce),nt.return=Ae,nt):(nt=Dh(Ce.type,Ce.key,Ce.props,null,Ae.mode,nt),nt.ref=lu(Ae,pe,Ce),nt.return=Ae,nt)}function ke(Ae,pe,Ce,nt){return pe===null||pe.tag!==4||pe.stateNode.containerInfo!==Ce.containerInfo||pe.stateNode.implementation!==Ce.implementation?(pe=Mp(Ce,Ae.mode,nt),pe.return=Ae,pe):(pe=T(pe,Ce.children||[]),pe.return=Ae,pe)}function Ke(Ae,pe,Ce,nt,Et){return pe===null||pe.tag!==7?(pe=na(Ce,Ae.mode,nt,Et),pe.return=Ae,pe):(pe=T(pe,Ce),pe.return=Ae,pe)}function Je(Ae,pe,Ce){if(typeof pe=="string"&&pe!==""||typeof pe=="number")return pe=kp(""+pe,Ae.mode,Ce),pe.return=Ae,pe;if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case C:return Ce=Dh(pe.type,pe.key,pe.props,null,Ae.mode,Ce),Ce.ref=lu(Ae,null,pe),Ce.return=Ae,Ce;case k:return pe=Mp(pe,Ae.mode,Ce),pe.return=Ae,pe;case he:var nt=pe._init;return Je(Ae,nt(pe._payload),Ce)}if(wt(pe)||me(pe))return pe=na(pe,Ae.mode,Ce,null),pe.return=Ae,pe;ch(Ae,pe)}return null}function Ze(Ae,pe,Ce,nt){var Et=pe!==null?pe.key:null;if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number")return Et!==null?null:J(Ae,pe,""+Ce,nt);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case C:return Ce.key===Et?de(Ae,pe,Ce,nt):null;case k:return Ce.key===Et?ke(Ae,pe,Ce,nt):null;case he:return Et=Ce._init,Ze(Ae,pe,Et(Ce._payload),nt)}if(wt(Ce)||me(Ce))return Et!==null?null:Ke(Ae,pe,Ce,nt,null);ch(Ae,Ce)}return null}function gt(Ae,pe,Ce,nt,Et){if(typeof nt=="string"&&nt!==""||typeof nt=="number")return Ae=Ae.get(Ce)||null,J(pe,Ae,""+nt,Et);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case C:return Ae=Ae.get(nt.key===null?Ce:nt.key)||null,de(pe,Ae,nt,Et);case k:return Ae=Ae.get(nt.key===null?Ce:nt.key)||null,ke(pe,Ae,nt,Et);case he:var It=nt._init;return gt(Ae,pe,Ce,It(nt._payload),Et)}if(wt(nt)||me(nt))return Ae=Ae.get(Ce)||null,Ke(pe,Ae,nt,Et,null);ch(pe,nt)}return null}function xt(Ae,pe,Ce,nt){for(var Et=null,It=null,kt=pe,Ot=pe=0,ms=null;kt!==null&&Ot<Ce.length;Ot++){kt.index>Ot?(ms=kt,kt=null):ms=kt.sibling;var sn=Ze(Ae,kt,Ce[Ot],nt);if(sn===null){kt===null&&(kt=ms);break}l&&kt&&sn.alternate===null&&h(Ae,kt),pe=N(sn,pe,Ot),It===null?Et=sn:It.sibling=sn,It=sn,kt=ms}if(Ot===Ce.length)return m(Ae,kt),Dn&&Xo(Ae,Ot),Et;if(kt===null){for(;Ot<Ce.length;Ot++)kt=Je(Ae,Ce[Ot],nt),kt!==null&&(pe=N(kt,pe,Ot),It===null?Et=kt:It.sibling=kt,It=kt);return Dn&&Xo(Ae,Ot),Et}for(kt=v(Ae,kt);Ot<Ce.length;Ot++)ms=gt(kt,Ae,Ot,Ce[Ot],nt),ms!==null&&(l&&ms.alternate!==null&&kt.delete(ms.key===null?Ot:ms.key),pe=N(ms,pe,Ot),It===null?Et=ms:It.sibling=ms,It=ms);return l&&kt.forEach(function(_o){return h(Ae,_o)}),Dn&&Xo(Ae,Ot),Et}function bt(Ae,pe,Ce,nt){var Et=me(Ce);if(typeof Et!="function")throw Error(n(150));if(Ce=Et.call(Ce),Ce==null)throw Error(n(151));for(var It=Et=null,kt=pe,Ot=pe=0,ms=null,sn=Ce.next();kt!==null&&!sn.done;Ot++,sn=Ce.next()){kt.index>Ot?(ms=kt,kt=null):ms=kt.sibling;var _o=Ze(Ae,kt,sn.value,nt);if(_o===null){kt===null&&(kt=ms);break}l&&kt&&_o.alternate===null&&h(Ae,kt),pe=N(_o,pe,Ot),It===null?Et=_o:It.sibling=_o,It=_o,kt=ms}if(sn.done)return m(Ae,kt),Dn&&Xo(Ae,Ot),Et;if(kt===null){for(;!sn.done;Ot++,sn=Ce.next())sn=Je(Ae,sn.value,nt),sn!==null&&(pe=N(sn,pe,Ot),It===null?Et=sn:It.sibling=sn,It=sn);return Dn&&Xo(Ae,Ot),Et}for(kt=v(Ae,kt);!sn.done;Ot++,sn=Ce.next())sn=gt(kt,Ae,Ot,sn.value,nt),sn!==null&&(l&&sn.alternate!==null&&kt.delete(sn.key===null?Ot:sn.key),pe=N(sn,pe,Ot),It===null?Et=sn:It.sibling=sn,It=sn);return l&&kt.forEach(function(KN){return h(Ae,KN)}),Dn&&Xo(Ae,Ot),Et}function ts(Ae,pe,Ce,nt){if(typeof Ce=="object"&&Ce!==null&&Ce.type===M&&Ce.key===null&&(Ce=Ce.props.children),typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case C:e:{for(var Et=Ce.key,It=pe;It!==null;){if(It.key===Et){if(Et=Ce.type,Et===M){if(It.tag===7){m(Ae,It.sibling),pe=T(It,Ce.props.children),pe.return=Ae,Ae=pe;break e}}else if(It.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===he&&g0(Et)===It.type){m(Ae,It.sibling),pe=T(It,Ce.props),pe.ref=lu(Ae,It,Ce),pe.return=Ae,Ae=pe;break e}m(Ae,It);break}else h(Ae,It);It=It.sibling}Ce.type===M?(pe=na(Ce.props.children,Ae.mode,nt,Ce.key),pe.return=Ae,Ae=pe):(nt=Dh(Ce.type,Ce.key,Ce.props,null,Ae.mode,nt),nt.ref=lu(Ae,pe,Ce),nt.return=Ae,Ae=nt)}return D(Ae);case k:e:{for(It=Ce.key;pe!==null;){if(pe.key===It)if(pe.tag===4&&pe.stateNode.containerInfo===Ce.containerInfo&&pe.stateNode.implementation===Ce.implementation){m(Ae,pe.sibling),pe=T(pe,Ce.children||[]),pe.return=Ae,Ae=pe;break e}else{m(Ae,pe);break}else h(Ae,pe);pe=pe.sibling}pe=Mp(Ce,Ae.mode,nt),pe.return=Ae,Ae=pe}return D(Ae);case he:return It=Ce._init,ts(Ae,pe,It(Ce._payload),nt)}if(wt(Ce))return xt(Ae,pe,Ce,nt);if(me(Ce))return bt(Ae,pe,Ce,nt);ch(Ae,Ce)}return typeof Ce=="string"&&Ce!==""||typeof Ce=="number"?(Ce=""+Ce,pe!==null&&pe.tag===6?(m(Ae,pe.sibling),pe=T(pe,Ce),pe.return=Ae,Ae=pe):(m(Ae,pe),pe=kp(Ce,Ae.mode,nt),pe.return=Ae,Ae=pe),D(Ae)):m(Ae,pe)}return ts}var Ya=f0(!0),p0=f0(!1),gh=io(null),fh=null,Za=null,Gf=null;function Vf(){Gf=Za=fh=null}function jf(l){var h=gh.current;Cn(gh),l._currentValue=h}function Hf(l,h,m){for(;l!==null;){var v=l.alternate;if((l.childLanes&h)!==h?(l.childLanes|=h,v!==null&&(v.childLanes|=h)):v!==null&&(v.childLanes&h)!==h&&(v.childLanes|=h),l===m)break;l=l.return}}function Ka(l,h){fh=l,Gf=Za=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&h)!==0&&(Js=!0),l.firstContext=null)}function br(l){var h=l._currentValue;if(Gf!==l)if(l={context:l,memoizedValue:h,next:null},Za===null){if(fh===null)throw Error(n(308));Za=l,fh.dependencies={lanes:0,firstContext:l}}else Za=Za.next=l;return h}var Yo=null;function qf(l){Yo===null?Yo=[l]:Yo.push(l)}function m0(l,h,m,v){var T=h.interleaved;return T===null?(m.next=m,qf(h)):(m.next=T.next,T.next=m),h.interleaved=m,Ai(l,v)}function Ai(l,h){l.lanes|=h;var m=l.alternate;for(m!==null&&(m.lanes|=h),m=l,l=l.return;l!==null;)l.childLanes|=h,m=l.alternate,m!==null&&(m.childLanes|=h),m=l,l=l.return;return m.tag===3?m.stateNode:null}var lo=!1;function $f(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _0(l,h){l=l.updateQueue,h.updateQueue===l&&(h.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function wi(l,h){return{eventTime:l,lane:h,tag:0,payload:null,callback:null,next:null}}function uo(l,h,m){var v=l.updateQueue;if(v===null)return null;if(v=v.shared,(en&2)!==0){var T=v.pending;return T===null?h.next=h:(h.next=T.next,T.next=h),v.pending=h,Ai(l,m)}return T=v.interleaved,T===null?(h.next=h,qf(v)):(h.next=T.next,T.next=h),v.interleaved=h,Ai(l,m)}function ph(l,h,m){if(h=h.updateQueue,h!==null&&(h=h.shared,(m&4194240)!==0)){var v=h.lanes;v&=l.pendingLanes,m|=v,h.lanes=m,Pe(l,m)}}function y0(l,h){var m=l.updateQueue,v=l.alternate;if(v!==null&&(v=v.updateQueue,m===v)){var T=null,N=null;if(m=m.firstBaseUpdate,m!==null){do{var D={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};N===null?T=N=D:N=N.next=D,m=m.next}while(m!==null);N===null?T=N=h:N=N.next=h}else T=N=h;m={baseState:v.baseState,firstBaseUpdate:T,lastBaseUpdate:N,shared:v.shared,effects:v.effects},l.updateQueue=m;return}l=m.lastBaseUpdate,l===null?m.firstBaseUpdate=h:l.next=h,m.lastBaseUpdate=h}function mh(l,h,m,v){var T=l.updateQueue;lo=!1;var N=T.firstBaseUpdate,D=T.lastBaseUpdate,J=T.shared.pending;if(J!==null){T.shared.pending=null;var de=J,ke=de.next;de.next=null,D===null?N=ke:D.next=ke,D=de;var Ke=l.alternate;Ke!==null&&(Ke=Ke.updateQueue,J=Ke.lastBaseUpdate,J!==D&&(J===null?Ke.firstBaseUpdate=ke:J.next=ke,Ke.lastBaseUpdate=de))}if(N!==null){var Je=T.baseState;D=0,Ke=ke=de=null,J=N;do{var Ze=J.lane,gt=J.eventTime;if((v&Ze)===Ze){Ke!==null&&(Ke=Ke.next={eventTime:gt,lane:0,tag:J.tag,payload:J.payload,callback:J.callback,next:null});e:{var xt=l,bt=J;switch(Ze=h,gt=m,bt.tag){case 1:if(xt=bt.payload,typeof xt=="function"){Je=xt.call(gt,Je,Ze);break e}Je=xt;break e;case 3:xt.flags=xt.flags&-65537|128;case 0:if(xt=bt.payload,Ze=typeof xt=="function"?xt.call(gt,Je,Ze):xt,Ze==null)break e;Je=we({},Je,Ze);break e;case 2:lo=!0}}J.callback!==null&&J.lane!==0&&(l.flags|=64,Ze=T.effects,Ze===null?T.effects=[J]:Ze.push(J))}else gt={eventTime:gt,lane:Ze,tag:J.tag,payload:J.payload,callback:J.callback,next:null},Ke===null?(ke=Ke=gt,de=Je):Ke=Ke.next=gt,D|=Ze;if(J=J.next,J===null){if(J=T.shared.pending,J===null)break;Ze=J,J=Ze.next,Ze.next=null,T.lastBaseUpdate=Ze,T.shared.pending=null}}while(!0);if(Ke===null&&(de=Je),T.baseState=de,T.firstBaseUpdate=ke,T.lastBaseUpdate=Ke,h=T.shared.interleaved,h!==null){T=h;do D|=T.lane,T=T.next;while(T!==h)}else N===null&&(T.shared.lanes=0);Qo|=D,l.lanes=D,l.memoizedState=Je}}function x0(l,h,m){if(l=h.effects,h.effects=null,l!==null)for(h=0;h<l.length;h++){var v=l[h],T=v.callback;if(T!==null){if(v.callback=null,v=m,typeof T!="function")throw Error(n(191,T));T.call(v)}}}var uu={},ni=io(uu),du=io(uu),hu=io(uu);function Zo(l){if(l===uu)throw Error(n(174));return l}function Wf(l,h){switch(bn(hu,h),bn(du,l),bn(ni,uu),l=h.nodeType,l){case 9:case 11:h=(h=h.documentElement)?h.namespaceURI:Wt(null,"");break;default:l=l===8?h.parentNode:h,h=l.namespaceURI||null,l=l.tagName,h=Wt(h,l)}Cn(ni),bn(ni,h)}function Qa(){Cn(ni),Cn(du),Cn(hu)}function v0(l){Zo(hu.current);var h=Zo(ni.current),m=Wt(h,l.type);h!==m&&(bn(du,l),bn(ni,m))}function Xf(l){du.current===l&&(Cn(ni),Cn(du))}var qn=io(0);function _h(l){for(var h=l;h!==null;){if(h.tag===13){var m=h.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var Yf=[];function Zf(){for(var l=0;l<Yf.length;l++)Yf[l]._workInProgressVersionPrimary=null;Yf.length=0}var yh=A.ReactCurrentDispatcher,Kf=A.ReactCurrentBatchConfig,Ko=0,$n=null,hs=null,fs=null,xh=!1,cu=!1,gu=0,xN=0;function Cs(){throw Error(n(321))}function Qf(l,h){if(h===null)return!1;for(var m=0;m<h.length&&m<l.length;m++)if(!Fr(l[m],h[m]))return!1;return!0}function Jf(l,h,m,v,T,N){if(Ko=N,$n=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,yh.current=l===null||l.memoizedState===null?SN:AN,l=m(v,T),cu){N=0;do{if(cu=!1,gu=0,25<=N)throw Error(n(301));N+=1,fs=hs=null,h.updateQueue=null,yh.current=wN,l=m(v,T)}while(cu)}if(yh.current=Eh,h=hs!==null&&hs.next!==null,Ko=0,fs=hs=$n=null,xh=!1,h)throw Error(n(300));return l}function ep(){var l=gu!==0;return gu=0,l}function si(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fs===null?$n.memoizedState=fs=l:fs=fs.next=l,fs}function Er(){if(hs===null){var l=$n.alternate;l=l!==null?l.memoizedState:null}else l=hs.next;var h=fs===null?$n.memoizedState:fs.next;if(h!==null)fs=h,hs=l;else{if(l===null)throw Error(n(310));hs=l,l={memoizedState:hs.memoizedState,baseState:hs.baseState,baseQueue:hs.baseQueue,queue:hs.queue,next:null},fs===null?$n.memoizedState=fs=l:fs=fs.next=l}return fs}function fu(l,h){return typeof h=="function"?h(l):h}function tp(l){var h=Er(),m=h.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=l;var v=hs,T=v.baseQueue,N=m.pending;if(N!==null){if(T!==null){var D=T.next;T.next=N.next,N.next=D}v.baseQueue=T=N,m.pending=null}if(T!==null){N=T.next,v=v.baseState;var J=D=null,de=null,ke=N;do{var Ke=ke.lane;if((Ko&Ke)===Ke)de!==null&&(de=de.next={lane:0,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null}),v=ke.hasEagerState?ke.eagerState:l(v,ke.action);else{var Je={lane:Ke,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null};de===null?(J=de=Je,D=v):de=de.next=Je,$n.lanes|=Ke,Qo|=Ke}ke=ke.next}while(ke!==null&&ke!==N);de===null?D=v:de.next=J,Fr(v,h.memoizedState)||(Js=!0),h.memoizedState=v,h.baseState=D,h.baseQueue=de,m.lastRenderedState=v}if(l=m.interleaved,l!==null){T=l;do N=T.lane,$n.lanes|=N,Qo|=N,T=T.next;while(T!==l)}else T===null&&(m.lanes=0);return[h.memoizedState,m.dispatch]}function np(l){var h=Er(),m=h.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=l;var v=m.dispatch,T=m.pending,N=h.memoizedState;if(T!==null){m.pending=null;var D=T=T.next;do N=l(N,D.action),D=D.next;while(D!==T);Fr(N,h.memoizedState)||(Js=!0),h.memoizedState=N,h.baseQueue===null&&(h.baseState=N),m.lastRenderedState=N}return[N,v]}function b0(){}function E0(l,h){var m=$n,v=Er(),T=h(),N=!Fr(v.memoizedState,T);if(N&&(v.memoizedState=T,Js=!0),v=v.queue,sp(w0.bind(null,m,v,l),[l]),v.getSnapshot!==h||N||fs!==null&&fs.memoizedState.tag&1){if(m.flags|=2048,pu(9,A0.bind(null,m,v,T,h),void 0,null),ps===null)throw Error(n(349));(Ko&30)!==0||S0(m,h,T)}return T}function S0(l,h,m){l.flags|=16384,l={getSnapshot:h,value:m},h=$n.updateQueue,h===null?(h={lastEffect:null,stores:null},$n.updateQueue=h,h.stores=[l]):(m=h.stores,m===null?h.stores=[l]:m.push(l))}function A0(l,h,m,v){h.value=m,h.getSnapshot=v,T0(h)&&C0(l)}function w0(l,h,m){return m(function(){T0(h)&&C0(l)})}function T0(l){var h=l.getSnapshot;l=l.value;try{var m=h();return!Fr(l,m)}catch{return!0}}function C0(l){var h=Ai(l,1);h!==null&&Ur(h,l,1,-1)}function L0(l){var h=si();return typeof l=="function"&&(l=l()),h.memoizedState=h.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fu,lastRenderedState:l},h.queue=l,l=l.dispatch=EN.bind(null,$n,l),[h.memoizedState,l]}function pu(l,h,m,v){return l={tag:l,create:h,destroy:m,deps:v,next:null},h=$n.updateQueue,h===null?(h={lastEffect:null,stores:null},$n.updateQueue=h,h.lastEffect=l.next=l):(m=h.lastEffect,m===null?h.lastEffect=l.next=l:(v=m.next,m.next=l,l.next=v,h.lastEffect=l)),l}function N0(){return Er().memoizedState}function vh(l,h,m,v){var T=si();$n.flags|=l,T.memoizedState=pu(1|h,m,void 0,v===void 0?null:v)}function bh(l,h,m,v){var T=Er();v=v===void 0?null:v;var N=void 0;if(hs!==null){var D=hs.memoizedState;if(N=D.destroy,v!==null&&Qf(v,D.deps)){T.memoizedState=pu(h,m,N,v);return}}$n.flags|=l,T.memoizedState=pu(1|h,m,N,v)}function I0(l,h){return vh(8390656,8,l,h)}function sp(l,h){return bh(2048,8,l,h)}function k0(l,h){return bh(4,2,l,h)}function M0(l,h){return bh(4,4,l,h)}function P0(l,h){if(typeof h=="function")return l=l(),h(l),function(){h(null)};if(h!=null)return l=l(),h.current=l,function(){h.current=null}}function R0(l,h,m){return m=m!=null?m.concat([l]):null,bh(4,4,P0.bind(null,h,l),m)}function rp(){}function F0(l,h){var m=Er();h=h===void 0?null:h;var v=m.memoizedState;return v!==null&&h!==null&&Qf(h,v[1])?v[0]:(m.memoizedState=[l,h],l)}function D0(l,h){var m=Er();h=h===void 0?null:h;var v=m.memoizedState;return v!==null&&h!==null&&Qf(h,v[1])?v[0]:(l=l(),m.memoizedState=[l,h],l)}function O0(l,h,m){return(Ko&21)===0?(l.baseState&&(l.baseState=!1,Js=!0),l.memoizedState=m):(Fr(m,h)||(m=B(),$n.lanes|=m,Qo|=m,l.baseState=!0),h)}function vN(l,h){var m=Ve;Ve=m!==0&&4>m?m:4,l(!0);var v=Kf.transition;Kf.transition={};try{l(!1),h()}finally{Ve=m,Kf.transition=v}}function z0(){return Er().memoizedState}function bN(l,h,m){var v=fo(l);if(m={lane:v,action:m,hasEagerState:!1,eagerState:null,next:null},B0(l))U0(h,m);else if(m=m0(l,h,m,v),m!==null){var T=Gs();Ur(m,l,v,T),G0(m,h,v)}}function EN(l,h,m){var v=fo(l),T={lane:v,action:m,hasEagerState:!1,eagerState:null,next:null};if(B0(l))U0(h,T);else{var N=l.alternate;if(l.lanes===0&&(N===null||N.lanes===0)&&(N=h.lastRenderedReducer,N!==null))try{var D=h.lastRenderedState,J=N(D,m);if(T.hasEagerState=!0,T.eagerState=J,Fr(J,D)){var de=h.interleaved;de===null?(T.next=T,qf(h)):(T.next=de.next,de.next=T),h.interleaved=T;return}}catch{}finally{}m=m0(l,h,T,v),m!==null&&(T=Gs(),Ur(m,l,v,T),G0(m,h,v))}}function B0(l){var h=l.alternate;return l===$n||h!==null&&h===$n}function U0(l,h){cu=xh=!0;var m=l.pending;m===null?h.next=h:(h.next=m.next,m.next=h),l.pending=h}function G0(l,h,m){if((m&4194240)!==0){var v=h.lanes;v&=l.pendingLanes,m|=v,h.lanes=m,Pe(l,m)}}var Eh={readContext:br,useCallback:Cs,useContext:Cs,useEffect:Cs,useImperativeHandle:Cs,useInsertionEffect:Cs,useLayoutEffect:Cs,useMemo:Cs,useReducer:Cs,useRef:Cs,useState:Cs,useDebugValue:Cs,useDeferredValue:Cs,useTransition:Cs,useMutableSource:Cs,useSyncExternalStore:Cs,useId:Cs,unstable_isNewReconciler:!1},SN={readContext:br,useCallback:function(l,h){return si().memoizedState=[l,h===void 0?null:h],l},useContext:br,useEffect:I0,useImperativeHandle:function(l,h,m){return m=m!=null?m.concat([l]):null,vh(4194308,4,P0.bind(null,h,l),m)},useLayoutEffect:function(l,h){return vh(4194308,4,l,h)},useInsertionEffect:function(l,h){return vh(4,2,l,h)},useMemo:function(l,h){var m=si();return h=h===void 0?null:h,l=l(),m.memoizedState=[l,h],l},useReducer:function(l,h,m){var v=si();return h=m!==void 0?m(h):h,v.memoizedState=v.baseState=h,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:h},v.queue=l,l=l.dispatch=bN.bind(null,$n,l),[v.memoizedState,l]},useRef:function(l){var h=si();return l={current:l},h.memoizedState=l},useState:L0,useDebugValue:rp,useDeferredValue:function(l){return si().memoizedState=l},useTransition:function(){var l=L0(!1),h=l[0];return l=vN.bind(null,l[1]),si().memoizedState=l,[h,l]},useMutableSource:function(){},useSyncExternalStore:function(l,h,m){var v=$n,T=si();if(Dn){if(m===void 0)throw Error(n(407));m=m()}else{if(m=h(),ps===null)throw Error(n(349));(Ko&30)!==0||S0(v,h,m)}T.memoizedState=m;var N={value:m,getSnapshot:h};return T.queue=N,I0(w0.bind(null,v,N,l),[l]),v.flags|=2048,pu(9,A0.bind(null,v,N,m,h),void 0,null),m},useId:function(){var l=si(),h=ps.identifierPrefix;if(Dn){var m=Si,v=Ei;m=(v&~(1<<32-Se(v)-1)).toString(32)+m,h=":"+h+"R"+m,m=gu++,0<m&&(h+="H"+m.toString(32)),h+=":"}else m=xN++,h=":"+h+"r"+m.toString(32)+":";return l.memoizedState=h},unstable_isNewReconciler:!1},AN={readContext:br,useCallback:F0,useContext:br,useEffect:sp,useImperativeHandle:R0,useInsertionEffect:k0,useLayoutEffect:M0,useMemo:D0,useReducer:tp,useRef:N0,useState:function(){return tp(fu)},useDebugValue:rp,useDeferredValue:function(l){var h=Er();return O0(h,hs.memoizedState,l)},useTransition:function(){var l=tp(fu)[0],h=Er().memoizedState;return[l,h]},useMutableSource:b0,useSyncExternalStore:E0,useId:z0,unstable_isNewReconciler:!1},wN={readContext:br,useCallback:F0,useContext:br,useEffect:sp,useImperativeHandle:R0,useInsertionEffect:k0,useLayoutEffect:M0,useMemo:D0,useReducer:np,useRef:N0,useState:function(){return np(fu)},useDebugValue:rp,useDeferredValue:function(l){var h=Er();return hs===null?h.memoizedState=l:O0(h,hs.memoizedState,l)},useTransition:function(){var l=np(fu)[0],h=Er().memoizedState;return[l,h]},useMutableSource:b0,useSyncExternalStore:E0,useId:z0,unstable_isNewReconciler:!1};function Or(l,h){if(l&&l.defaultProps){h=we({},h),l=l.defaultProps;for(var m in l)h[m]===void 0&&(h[m]=l[m]);return h}return h}function ip(l,h,m,v){h=l.memoizedState,m=m(v,h),m=m==null?h:we({},h,m),l.memoizedState=m,l.lanes===0&&(l.updateQueue.baseState=m)}var Sh={isMounted:function(l){return(l=l._reactInternals)?tt(l)===l:!1},enqueueSetState:function(l,h,m){l=l._reactInternals;var v=Gs(),T=fo(l),N=wi(v,T);N.payload=h,m!=null&&(N.callback=m),h=uo(l,N,T),h!==null&&(Ur(h,l,T,v),ph(h,l,T))},enqueueReplaceState:function(l,h,m){l=l._reactInternals;var v=Gs(),T=fo(l),N=wi(v,T);N.tag=1,N.payload=h,m!=null&&(N.callback=m),h=uo(l,N,T),h!==null&&(Ur(h,l,T,v),ph(h,l,T))},enqueueForceUpdate:function(l,h){l=l._reactInternals;var m=Gs(),v=fo(l),T=wi(m,v);T.tag=2,h!=null&&(T.callback=h),h=uo(l,T,v),h!==null&&(Ur(h,l,v,m),ph(h,l,v))}};function V0(l,h,m,v,T,N,D){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(v,N,D):h.prototype&&h.prototype.isPureReactComponent?!tu(m,v)||!tu(T,N):!0}function j0(l,h,m){var v=!1,T=oo,N=h.contextType;return typeof N=="object"&&N!==null?N=br(N):(T=Qs(h)?$o:Ts.current,v=h.contextTypes,N=(v=v!=null)?qa(l,T):oo),h=new h(m,N),l.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Sh,l.stateNode=h,h._reactInternals=l,v&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=T,l.__reactInternalMemoizedMaskedChildContext=N),h}function H0(l,h,m,v){l=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(m,v),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(m,v),h.state!==l&&Sh.enqueueReplaceState(h,h.state,null)}function op(l,h,m,v){var T=l.stateNode;T.props=m,T.state=l.memoizedState,T.refs={},$f(l);var N=h.contextType;typeof N=="object"&&N!==null?T.context=br(N):(N=Qs(h)?$o:Ts.current,T.context=qa(l,N)),T.state=l.memoizedState,N=h.getDerivedStateFromProps,typeof N=="function"&&(ip(l,h,N,m),T.state=l.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(h=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),h!==T.state&&Sh.enqueueReplaceState(T,T.state,null),mh(l,m,T,v),T.state=l.memoizedState),typeof T.componentDidMount=="function"&&(l.flags|=4194308)}function Ja(l,h){try{var m="",v=h;do m+=We(v),v=v.return;while(v);var T=m}catch(N){T=`
Error generating stack: `+N.message+`
`+N.stack}return{value:l,source:h,stack:T,digest:null}}function ap(l,h,m){return{value:l,source:null,stack:m??null,digest:h??null}}function lp(l,h){try{console.error(h.value)}catch(m){setTimeout(function(){throw m})}}var TN=typeof WeakMap=="function"?WeakMap:Map;function q0(l,h,m){m=wi(-1,m),m.tag=3,m.payload={element:null};var v=h.value;return m.callback=function(){Ih||(Ih=!0,Sp=v),lp(l,h)},m}function $0(l,h,m){m=wi(-1,m),m.tag=3;var v=l.type.getDerivedStateFromError;if(typeof v=="function"){var T=h.value;m.payload=function(){return v(T)},m.callback=function(){lp(l,h)}}var N=l.stateNode;return N!==null&&typeof N.componentDidCatch=="function"&&(m.callback=function(){lp(l,h),typeof v!="function"&&(co===null?co=new Set([this]):co.add(this));var D=h.stack;this.componentDidCatch(h.value,{componentStack:D!==null?D:""})}),m}function W0(l,h,m){var v=l.pingCache;if(v===null){v=l.pingCache=new TN;var T=new Set;v.set(h,T)}else T=v.get(h),T===void 0&&(T=new Set,v.set(h,T));T.has(m)||(T.add(m),l=UN.bind(null,l,h,m),h.then(l,l))}function X0(l){do{var h;if((h=l.tag===13)&&(h=l.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return l;l=l.return}while(l!==null);return null}function Y0(l,h,m,v,T){return(l.mode&1)===0?(l===h?l.flags|=65536:(l.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(h=wi(-1,1),h.tag=2,uo(m,h,1))),m.lanes|=1),l):(l.flags|=65536,l.lanes=T,l)}var CN=A.ReactCurrentOwner,Js=!1;function Us(l,h,m,v){h.child=l===null?p0(h,null,m,v):Ya(h,l.child,m,v)}function Z0(l,h,m,v,T){m=m.render;var N=h.ref;return Ka(h,T),v=Jf(l,h,m,v,N,T),m=ep(),l!==null&&!Js?(h.updateQueue=l.updateQueue,h.flags&=-2053,l.lanes&=~T,Ti(l,h,T)):(Dn&&m&&Df(h),h.flags|=1,Us(l,h,v,T),h.child)}function K0(l,h,m,v,T){if(l===null){var N=m.type;return typeof N=="function"&&!Ip(N)&&N.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(h.tag=15,h.type=N,Q0(l,h,N,v,T)):(l=Dh(m.type,null,v,h,h.mode,T),l.ref=h.ref,l.return=h,h.child=l)}if(N=l.child,(l.lanes&T)===0){var D=N.memoizedProps;if(m=m.compare,m=m!==null?m:tu,m(D,v)&&l.ref===h.ref)return Ti(l,h,T)}return h.flags|=1,l=mo(N,v),l.ref=h.ref,l.return=h,h.child=l}function Q0(l,h,m,v,T){if(l!==null){var N=l.memoizedProps;if(tu(N,v)&&l.ref===h.ref)if(Js=!1,h.pendingProps=v=N,(l.lanes&T)!==0)(l.flags&131072)!==0&&(Js=!0);else return h.lanes=l.lanes,Ti(l,h,T)}return up(l,h,m,v,T)}function J0(l,h,m){var v=h.pendingProps,T=v.children,N=l!==null?l.memoizedState:null;if(v.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null,transitions:null},bn(tl,hr),hr|=m;else{if((m&1073741824)===0)return l=N!==null?N.baseLanes|m:m,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:l,cachePool:null,transitions:null},h.updateQueue=null,bn(tl,hr),hr|=l,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=N!==null?N.baseLanes:m,bn(tl,hr),hr|=v}else N!==null?(v=N.baseLanes|m,h.memoizedState=null):v=m,bn(tl,hr),hr|=v;return Us(l,h,T,m),h.child}function ev(l,h){var m=h.ref;(l===null&&m!==null||l!==null&&l.ref!==m)&&(h.flags|=512,h.flags|=2097152)}function up(l,h,m,v,T){var N=Qs(m)?$o:Ts.current;return N=qa(h,N),Ka(h,T),m=Jf(l,h,m,v,N,T),v=ep(),l!==null&&!Js?(h.updateQueue=l.updateQueue,h.flags&=-2053,l.lanes&=~T,Ti(l,h,T)):(Dn&&v&&Df(h),h.flags|=1,Us(l,h,m,T),h.child)}function tv(l,h,m,v,T){if(Qs(m)){var N=!0;ah(h)}else N=!1;if(Ka(h,T),h.stateNode===null)wh(l,h),j0(h,m,v),op(h,m,v,T),v=!0;else if(l===null){var D=h.stateNode,J=h.memoizedProps;D.props=J;var de=D.context,ke=m.contextType;typeof ke=="object"&&ke!==null?ke=br(ke):(ke=Qs(m)?$o:Ts.current,ke=qa(h,ke));var Ke=m.getDerivedStateFromProps,Je=typeof Ke=="function"||typeof D.getSnapshotBeforeUpdate=="function";Je||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(J!==v||de!==ke)&&H0(h,D,v,ke),lo=!1;var Ze=h.memoizedState;D.state=Ze,mh(h,v,D,T),de=h.memoizedState,J!==v||Ze!==de||Ks.current||lo?(typeof Ke=="function"&&(ip(h,m,Ke,v),de=h.memoizedState),(J=lo||V0(h,m,J,v,Ze,de,ke))?(Je||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(h.flags|=4194308)):(typeof D.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=v,h.memoizedState=de),D.props=v,D.state=de,D.context=ke,v=J):(typeof D.componentDidMount=="function"&&(h.flags|=4194308),v=!1)}else{D=h.stateNode,_0(l,h),J=h.memoizedProps,ke=h.type===h.elementType?J:Or(h.type,J),D.props=ke,Je=h.pendingProps,Ze=D.context,de=m.contextType,typeof de=="object"&&de!==null?de=br(de):(de=Qs(m)?$o:Ts.current,de=qa(h,de));var gt=m.getDerivedStateFromProps;(Ke=typeof gt=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(J!==Je||Ze!==de)&&H0(h,D,v,de),lo=!1,Ze=h.memoizedState,D.state=Ze,mh(h,v,D,T);var xt=h.memoizedState;J!==Je||Ze!==xt||Ks.current||lo?(typeof gt=="function"&&(ip(h,m,gt,v),xt=h.memoizedState),(ke=lo||V0(h,m,ke,v,Ze,xt,de)||!1)?(Ke||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(v,xt,de),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(v,xt,de)),typeof D.componentDidUpdate=="function"&&(h.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof D.componentDidUpdate!="function"||J===l.memoizedProps&&Ze===l.memoizedState||(h.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||J===l.memoizedProps&&Ze===l.memoizedState||(h.flags|=1024),h.memoizedProps=v,h.memoizedState=xt),D.props=v,D.state=xt,D.context=de,v=ke):(typeof D.componentDidUpdate!="function"||J===l.memoizedProps&&Ze===l.memoizedState||(h.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||J===l.memoizedProps&&Ze===l.memoizedState||(h.flags|=1024),v=!1)}return dp(l,h,m,v,N,T)}function dp(l,h,m,v,T,N){ev(l,h);var D=(h.flags&128)!==0;if(!v&&!D)return T&&o0(h,m,!1),Ti(l,h,N);v=h.stateNode,CN.current=h;var J=D&&typeof m.getDerivedStateFromError!="function"?null:v.render();return h.flags|=1,l!==null&&D?(h.child=Ya(h,l.child,null,N),h.child=Ya(h,null,J,N)):Us(l,h,J,N),h.memoizedState=v.state,T&&o0(h,m,!0),h.child}function nv(l){var h=l.stateNode;h.pendingContext?r0(l,h.pendingContext,h.pendingContext!==h.context):h.context&&r0(l,h.context,!1),Wf(l,h.containerInfo)}function sv(l,h,m,v,T){return Xa(),Uf(T),h.flags|=256,Us(l,h,m,v),h.child}var hp={dehydrated:null,treeContext:null,retryLane:0};function cp(l){return{baseLanes:l,cachePool:null,transitions:null}}function rv(l,h,m){var v=h.pendingProps,T=qn.current,N=!1,D=(h.flags&128)!==0,J;if((J=D)||(J=l!==null&&l.memoizedState===null?!1:(T&2)!==0),J?(N=!0,h.flags&=-129):(l===null||l.memoizedState!==null)&&(T|=1),bn(qn,T&1),l===null)return Bf(h),l=h.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((h.mode&1)===0?h.lanes=1:l.data==="$!"?h.lanes=8:h.lanes=1073741824,null):(D=v.children,l=v.fallback,N?(v=h.mode,N=h.child,D={mode:"hidden",children:D},(v&1)===0&&N!==null?(N.childLanes=0,N.pendingProps=D):N=Oh(D,v,0,null),l=na(l,v,m,null),N.return=h,l.return=h,N.sibling=l,h.child=N,h.child.memoizedState=cp(m),h.memoizedState=hp,l):gp(h,D));if(T=l.memoizedState,T!==null&&(J=T.dehydrated,J!==null))return LN(l,h,D,v,J,T,m);if(N){N=v.fallback,D=h.mode,T=l.child,J=T.sibling;var de={mode:"hidden",children:v.children};return(D&1)===0&&h.child!==T?(v=h.child,v.childLanes=0,v.pendingProps=de,h.deletions=null):(v=mo(T,de),v.subtreeFlags=T.subtreeFlags&14680064),J!==null?N=mo(J,N):(N=na(N,D,m,null),N.flags|=2),N.return=h,v.return=h,v.sibling=N,h.child=v,v=N,N=h.child,D=l.child.memoizedState,D=D===null?cp(m):{baseLanes:D.baseLanes|m,cachePool:null,transitions:D.transitions},N.memoizedState=D,N.childLanes=l.childLanes&~m,h.memoizedState=hp,v}return N=l.child,l=N.sibling,v=mo(N,{mode:"visible",children:v.children}),(h.mode&1)===0&&(v.lanes=m),v.return=h,v.sibling=null,l!==null&&(m=h.deletions,m===null?(h.deletions=[l],h.flags|=16):m.push(l)),h.child=v,h.memoizedState=null,v}function gp(l,h){return h=Oh({mode:"visible",children:h},l.mode,0,null),h.return=l,l.child=h}function Ah(l,h,m,v){return v!==null&&Uf(v),Ya(h,l.child,null,m),l=gp(h,h.pendingProps.children),l.flags|=2,h.memoizedState=null,l}function LN(l,h,m,v,T,N,D){if(m)return h.flags&256?(h.flags&=-257,v=ap(Error(n(422))),Ah(l,h,D,v)):h.memoizedState!==null?(h.child=l.child,h.flags|=128,null):(N=v.fallback,T=h.mode,v=Oh({mode:"visible",children:v.children},T,0,null),N=na(N,T,D,null),N.flags|=2,v.return=h,N.return=h,v.sibling=N,h.child=v,(h.mode&1)!==0&&Ya(h,l.child,null,D),h.child.memoizedState=cp(D),h.memoizedState=hp,N);if((h.mode&1)===0)return Ah(l,h,D,null);if(T.data==="$!"){if(v=T.nextSibling&&T.nextSibling.dataset,v)var J=v.dgst;return v=J,N=Error(n(419)),v=ap(N,v,void 0),Ah(l,h,D,v)}if(J=(D&l.childLanes)!==0,Js||J){if(v=ps,v!==null){switch(D&-D){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=(T&(v.suspendedLanes|D))!==0?0:T,T!==0&&T!==N.retryLane&&(N.retryLane=T,Ai(l,T),Ur(v,l,T,-1))}return Np(),v=ap(Error(n(421))),Ah(l,h,D,v)}return T.data==="$?"?(h.flags|=128,h.child=l.child,h=GN.bind(null,l),T._reactRetry=h,null):(l=N.treeContext,dr=ro(T.nextSibling),ur=h,Dn=!0,Dr=null,l!==null&&(xr[vr++]=Ei,xr[vr++]=Si,xr[vr++]=Wo,Ei=l.id,Si=l.overflow,Wo=h),h=gp(h,v.children),h.flags|=4096,h)}function iv(l,h,m){l.lanes|=h;var v=l.alternate;v!==null&&(v.lanes|=h),Hf(l.return,h,m)}function fp(l,h,m,v,T){var N=l.memoizedState;N===null?l.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:v,tail:m,tailMode:T}:(N.isBackwards=h,N.rendering=null,N.renderingStartTime=0,N.last=v,N.tail=m,N.tailMode=T)}function ov(l,h,m){var v=h.pendingProps,T=v.revealOrder,N=v.tail;if(Us(l,h,v.children,m),v=qn.current,(v&2)!==0)v=v&1|2,h.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=h.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&iv(l,m,h);else if(l.tag===19)iv(l,m,h);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===h)break e;for(;l.sibling===null;){if(l.return===null||l.return===h)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}v&=1}if(bn(qn,v),(h.mode&1)===0)h.memoizedState=null;else switch(T){case"forwards":for(m=h.child,T=null;m!==null;)l=m.alternate,l!==null&&_h(l)===null&&(T=m),m=m.sibling;m=T,m===null?(T=h.child,h.child=null):(T=m.sibling,m.sibling=null),fp(h,!1,T,m,N);break;case"backwards":for(m=null,T=h.child,h.child=null;T!==null;){if(l=T.alternate,l!==null&&_h(l)===null){h.child=T;break}l=T.sibling,T.sibling=m,m=T,T=l}fp(h,!0,m,null,N);break;case"together":fp(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function wh(l,h){(h.mode&1)===0&&l!==null&&(l.alternate=null,h.alternate=null,h.flags|=2)}function Ti(l,h,m){if(l!==null&&(h.dependencies=l.dependencies),Qo|=h.lanes,(m&h.childLanes)===0)return null;if(l!==null&&h.child!==l.child)throw Error(n(153));if(h.child!==null){for(l=h.child,m=mo(l,l.pendingProps),h.child=m,m.return=h;l.sibling!==null;)l=l.sibling,m=m.sibling=mo(l,l.pendingProps),m.return=h;m.sibling=null}return h.child}function NN(l,h,m){switch(h.tag){case 3:nv(h),Xa();break;case 5:v0(h);break;case 1:Qs(h.type)&&ah(h);break;case 4:Wf(h,h.stateNode.containerInfo);break;case 10:var v=h.type._context,T=h.memoizedProps.value;bn(gh,v._currentValue),v._currentValue=T;break;case 13:if(v=h.memoizedState,v!==null)return v.dehydrated!==null?(bn(qn,qn.current&1),h.flags|=128,null):(m&h.child.childLanes)!==0?rv(l,h,m):(bn(qn,qn.current&1),l=Ti(l,h,m),l!==null?l.sibling:null);bn(qn,qn.current&1);break;case 19:if(v=(m&h.childLanes)!==0,(l.flags&128)!==0){if(v)return ov(l,h,m);h.flags|=128}if(T=h.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),bn(qn,qn.current),v)break;return null;case 22:case 23:return h.lanes=0,J0(l,h,m)}return Ti(l,h,m)}var av,pp,lv,uv;av=function(l,h){for(var m=h.child;m!==null;){if(m.tag===5||m.tag===6)l.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===h)break;for(;m.sibling===null;){if(m.return===null||m.return===h)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},pp=function(){},lv=function(l,h,m,v){var T=l.memoizedProps;if(T!==v){l=h.stateNode,Zo(ni.current);var N=null;switch(m){case"input":T=Fe(l,T),v=Fe(l,v),N=[];break;case"select":T=we({},T,{value:void 0}),v=we({},v,{value:void 0}),N=[];break;case"textarea":T=Tt(l,T),v=Tt(l,v),N=[];break;default:typeof T.onClick!="function"&&typeof v.onClick=="function"&&(l.onclick=rh)}Vn(m,v);var D;m=null;for(ke in T)if(!v.hasOwnProperty(ke)&&T.hasOwnProperty(ke)&&T[ke]!=null)if(ke==="style"){var J=T[ke];for(D in J)J.hasOwnProperty(D)&&(m||(m={}),m[D]="")}else ke!=="dangerouslySetInnerHTML"&&ke!=="children"&&ke!=="suppressContentEditableWarning"&&ke!=="suppressHydrationWarning"&&ke!=="autoFocus"&&(r.hasOwnProperty(ke)?N||(N=[]):(N=N||[]).push(ke,null));for(ke in v){var de=v[ke];if(J=T!=null?T[ke]:void 0,v.hasOwnProperty(ke)&&de!==J&&(de!=null||J!=null))if(ke==="style")if(J){for(D in J)!J.hasOwnProperty(D)||de&&de.hasOwnProperty(D)||(m||(m={}),m[D]="");for(D in de)de.hasOwnProperty(D)&&J[D]!==de[D]&&(m||(m={}),m[D]=de[D])}else m||(N||(N=[]),N.push(ke,m)),m=de;else ke==="dangerouslySetInnerHTML"?(de=de?de.__html:void 0,J=J?J.__html:void 0,de!=null&&J!==de&&(N=N||[]).push(ke,de)):ke==="children"?typeof de!="string"&&typeof de!="number"||(N=N||[]).push(ke,""+de):ke!=="suppressContentEditableWarning"&&ke!=="suppressHydrationWarning"&&(r.hasOwnProperty(ke)?(de!=null&&ke==="onScroll"&&Tn("scroll",l),N||J===de||(N=[])):(N=N||[]).push(ke,de))}m&&(N=N||[]).push("style",m);var ke=N;(h.updateQueue=ke)&&(h.flags|=4)}},uv=function(l,h,m,v){m!==v&&(h.flags|=4)};function mu(l,h){if(!Dn)switch(l.tailMode){case"hidden":h=l.tail;for(var m=null;h!==null;)h.alternate!==null&&(m=h),h=h.sibling;m===null?l.tail=null:m.sibling=null;break;case"collapsed":m=l.tail;for(var v=null;m!==null;)m.alternate!==null&&(v=m),m=m.sibling;v===null?h||l.tail===null?l.tail=null:l.tail.sibling=null:v.sibling=null}}function Ls(l){var h=l.alternate!==null&&l.alternate.child===l.child,m=0,v=0;if(h)for(var T=l.child;T!==null;)m|=T.lanes|T.childLanes,v|=T.subtreeFlags&14680064,v|=T.flags&14680064,T.return=l,T=T.sibling;else for(T=l.child;T!==null;)m|=T.lanes|T.childLanes,v|=T.subtreeFlags,v|=T.flags,T.return=l,T=T.sibling;return l.subtreeFlags|=v,l.childLanes=m,h}function IN(l,h,m){var v=h.pendingProps;switch(Of(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ls(h),null;case 1:return Qs(h.type)&&oh(),Ls(h),null;case 3:return v=h.stateNode,Qa(),Cn(Ks),Cn(Ts),Zf(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(l===null||l.child===null)&&(hh(h)?h.flags|=4:l===null||l.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Dr!==null&&(Tp(Dr),Dr=null))),pp(l,h),Ls(h),null;case 5:Xf(h);var T=Zo(hu.current);if(m=h.type,l!==null&&h.stateNode!=null)lv(l,h,m,v,T),l.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!v){if(h.stateNode===null)throw Error(n(166));return Ls(h),null}if(l=Zo(ni.current),hh(h)){v=h.stateNode,m=h.type;var N=h.memoizedProps;switch(v[ti]=h,v[ou]=N,l=(h.mode&1)!==0,m){case"dialog":Tn("cancel",v),Tn("close",v);break;case"iframe":case"object":case"embed":Tn("load",v);break;case"video":case"audio":for(T=0;T<su.length;T++)Tn(su[T],v);break;case"source":Tn("error",v);break;case"img":case"image":case"link":Tn("error",v),Tn("load",v);break;case"details":Tn("toggle",v);break;case"input":Oe(v,N),Tn("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!N.multiple},Tn("invalid",v);break;case"textarea":ot(v,N),Tn("invalid",v)}Vn(m,N),T=null;for(var D in N)if(N.hasOwnProperty(D)){var J=N[D];D==="children"?typeof J=="string"?v.textContent!==J&&(N.suppressHydrationWarning!==!0&&sh(v.textContent,J,l),T=["children",J]):typeof J=="number"&&v.textContent!==""+J&&(N.suppressHydrationWarning!==!0&&sh(v.textContent,J,l),T=["children",""+J]):r.hasOwnProperty(D)&&J!=null&&D==="onScroll"&&Tn("scroll",v)}switch(m){case"input":qe(v),mt(v,N,!0);break;case"textarea":qe(v),Nt(v);break;case"select":case"option":break;default:typeof N.onClick=="function"&&(v.onclick=rh)}v=T,h.updateQueue=v,v!==null&&(h.flags|=4)}else{D=T.nodeType===9?T:T.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=Gt(m)),l==="http://www.w3.org/1999/xhtml"?m==="script"?(l=D.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof v.is=="string"?l=D.createElement(m,{is:v.is}):(l=D.createElement(m),m==="select"&&(D=l,v.multiple?D.multiple=!0:v.size&&(D.size=v.size))):l=D.createElementNS(l,m),l[ti]=h,l[ou]=v,av(l,h,!1,!1),h.stateNode=l;e:{switch(D=An(m,v),m){case"dialog":Tn("cancel",l),Tn("close",l),T=v;break;case"iframe":case"object":case"embed":Tn("load",l),T=v;break;case"video":case"audio":for(T=0;T<su.length;T++)Tn(su[T],l);T=v;break;case"source":Tn("error",l),T=v;break;case"img":case"image":case"link":Tn("error",l),Tn("load",l),T=v;break;case"details":Tn("toggle",l),T=v;break;case"input":Oe(l,v),T=Fe(l,v),Tn("invalid",l);break;case"option":T=v;break;case"select":l._wrapperState={wasMultiple:!!v.multiple},T=we({},v,{value:void 0}),Tn("invalid",l);break;case"textarea":ot(l,v),T=Tt(l,v),Tn("invalid",l);break;default:T=v}Vn(m,T),J=T;for(N in J)if(J.hasOwnProperty(N)){var de=J[N];N==="style"?Gn(l,de):N==="dangerouslySetInnerHTML"?(de=de?de.__html:void 0,de!=null&&Sn(l,de)):N==="children"?typeof de=="string"?(m!=="textarea"||de!=="")&&Jn(l,de):typeof de=="number"&&Jn(l,""+de):N!=="suppressContentEditableWarning"&&N!=="suppressHydrationWarning"&&N!=="autoFocus"&&(r.hasOwnProperty(N)?de!=null&&N==="onScroll"&&Tn("scroll",l):de!=null&&S(l,N,de,D))}switch(m){case"input":qe(l),mt(l,v,!1);break;case"textarea":qe(l),Nt(l);break;case"option":v.value!=null&&l.setAttribute("value",""+ut(v.value));break;case"select":l.multiple=!!v.multiple,N=v.value,N!=null?Lt(l,!!v.multiple,N,!1):v.defaultValue!=null&&Lt(l,!!v.multiple,v.defaultValue,!0);break;default:typeof T.onClick=="function"&&(l.onclick=rh)}switch(m){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(h.flags|=4)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return Ls(h),null;case 6:if(l&&h.stateNode!=null)uv(l,h,l.memoizedProps,v);else{if(typeof v!="string"&&h.stateNode===null)throw Error(n(166));if(m=Zo(hu.current),Zo(ni.current),hh(h)){if(v=h.stateNode,m=h.memoizedProps,v[ti]=h,(N=v.nodeValue!==m)&&(l=ur,l!==null))switch(l.tag){case 3:sh(v.nodeValue,m,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&sh(v.nodeValue,m,(l.mode&1)!==0)}N&&(h.flags|=4)}else v=(m.nodeType===9?m:m.ownerDocument).createTextNode(v),v[ti]=h,h.stateNode=v}return Ls(h),null;case 13:if(Cn(qn),v=h.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Dn&&dr!==null&&(h.mode&1)!==0&&(h.flags&128)===0)c0(),Xa(),h.flags|=98560,N=!1;else if(N=hh(h),v!==null&&v.dehydrated!==null){if(l===null){if(!N)throw Error(n(318));if(N=h.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(n(317));N[ti]=h}else Xa(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Ls(h),N=!1}else Dr!==null&&(Tp(Dr),Dr=null),N=!0;if(!N)return h.flags&65536?h:null}return(h.flags&128)!==0?(h.lanes=m,h):(v=v!==null,v!==(l!==null&&l.memoizedState!==null)&&v&&(h.child.flags|=8192,(h.mode&1)!==0&&(l===null||(qn.current&1)!==0?cs===0&&(cs=3):Np())),h.updateQueue!==null&&(h.flags|=4),Ls(h),null);case 4:return Qa(),pp(l,h),l===null&&ru(h.stateNode.containerInfo),Ls(h),null;case 10:return jf(h.type._context),Ls(h),null;case 17:return Qs(h.type)&&oh(),Ls(h),null;case 19:if(Cn(qn),N=h.memoizedState,N===null)return Ls(h),null;if(v=(h.flags&128)!==0,D=N.rendering,D===null)if(v)mu(N,!1);else{if(cs!==0||l!==null&&(l.flags&128)!==0)for(l=h.child;l!==null;){if(D=_h(l),D!==null){for(h.flags|=128,mu(N,!1),v=D.updateQueue,v!==null&&(h.updateQueue=v,h.flags|=4),h.subtreeFlags=0,v=m,m=h.child;m!==null;)N=m,l=v,N.flags&=14680066,D=N.alternate,D===null?(N.childLanes=0,N.lanes=l,N.child=null,N.subtreeFlags=0,N.memoizedProps=null,N.memoizedState=null,N.updateQueue=null,N.dependencies=null,N.stateNode=null):(N.childLanes=D.childLanes,N.lanes=D.lanes,N.child=D.child,N.subtreeFlags=0,N.deletions=null,N.memoizedProps=D.memoizedProps,N.memoizedState=D.memoizedState,N.updateQueue=D.updateQueue,N.type=D.type,l=D.dependencies,N.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),m=m.sibling;return bn(qn,qn.current&1|2),h.child}l=l.sibling}N.tail!==null&&U()>nl&&(h.flags|=128,v=!0,mu(N,!1),h.lanes=4194304)}else{if(!v)if(l=_h(D),l!==null){if(h.flags|=128,v=!0,m=l.updateQueue,m!==null&&(h.updateQueue=m,h.flags|=4),mu(N,!0),N.tail===null&&N.tailMode==="hidden"&&!D.alternate&&!Dn)return Ls(h),null}else 2*U()-N.renderingStartTime>nl&&m!==1073741824&&(h.flags|=128,v=!0,mu(N,!1),h.lanes=4194304);N.isBackwards?(D.sibling=h.child,h.child=D):(m=N.last,m!==null?m.sibling=D:h.child=D,N.last=D)}return N.tail!==null?(h=N.tail,N.rendering=h,N.tail=h.sibling,N.renderingStartTime=U(),h.sibling=null,m=qn.current,bn(qn,v?m&1|2:m&1),h):(Ls(h),null);case 22:case 23:return Lp(),v=h.memoizedState!==null,l!==null&&l.memoizedState!==null!==v&&(h.flags|=8192),v&&(h.mode&1)!==0?(hr&1073741824)!==0&&(Ls(h),h.subtreeFlags&6&&(h.flags|=8192)):Ls(h),null;case 24:return null;case 25:return null}throw Error(n(156,h.tag))}function kN(l,h){switch(Of(h),h.tag){case 1:return Qs(h.type)&&oh(),l=h.flags,l&65536?(h.flags=l&-65537|128,h):null;case 3:return Qa(),Cn(Ks),Cn(Ts),Zf(),l=h.flags,(l&65536)!==0&&(l&128)===0?(h.flags=l&-65537|128,h):null;case 5:return Xf(h),null;case 13:if(Cn(qn),l=h.memoizedState,l!==null&&l.dehydrated!==null){if(h.alternate===null)throw Error(n(340));Xa()}return l=h.flags,l&65536?(h.flags=l&-65537|128,h):null;case 19:return Cn(qn),null;case 4:return Qa(),null;case 10:return jf(h.type._context),null;case 22:case 23:return Lp(),null;case 24:return null;default:return null}}var Th=!1,Ns=!1,MN=typeof WeakSet=="function"?WeakSet:Set,_t=null;function el(l,h){var m=l.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(v){Kn(l,h,v)}else m.current=null}function mp(l,h,m){try{m()}catch(v){Kn(l,h,v)}}var dv=!1;function PN(l,h){if(Lf=lr,l=Vx(),vf(l)){if("selectionStart"in l)var m={start:l.selectionStart,end:l.selectionEnd};else e:{m=(m=l.ownerDocument)&&m.defaultView||window;var v=m.getSelection&&m.getSelection();if(v&&v.rangeCount!==0){m=v.anchorNode;var T=v.anchorOffset,N=v.focusNode;v=v.focusOffset;try{m.nodeType,N.nodeType}catch{m=null;break e}var D=0,J=-1,de=-1,ke=0,Ke=0,Je=l,Ze=null;t:for(;;){for(var gt;Je!==m||T!==0&&Je.nodeType!==3||(J=D+T),Je!==N||v!==0&&Je.nodeType!==3||(de=D+v),Je.nodeType===3&&(D+=Je.nodeValue.length),(gt=Je.firstChild)!==null;)Ze=Je,Je=gt;for(;;){if(Je===l)break t;if(Ze===m&&++ke===T&&(J=D),Ze===N&&++Ke===v&&(de=D),(gt=Je.nextSibling)!==null)break;Je=Ze,Ze=Je.parentNode}Je=gt}m=J===-1||de===-1?null:{start:J,end:de}}else m=null}m=m||{start:0,end:0}}else m=null;for(Nf={focusedElem:l,selectionRange:m},lr=!1,_t=h;_t!==null;)if(h=_t,l=h.child,(h.subtreeFlags&1028)!==0&&l!==null)l.return=h,_t=l;else for(;_t!==null;){h=_t;try{var xt=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(xt!==null){var bt=xt.memoizedProps,ts=xt.memoizedState,Ae=h.stateNode,pe=Ae.getSnapshotBeforeUpdate(h.elementType===h.type?bt:Or(h.type,bt),ts);Ae.__reactInternalSnapshotBeforeUpdate=pe}break;case 3:var Ce=h.stateNode.containerInfo;Ce.nodeType===1?Ce.textContent="":Ce.nodeType===9&&Ce.documentElement&&Ce.removeChild(Ce.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(nt){Kn(h,h.return,nt)}if(l=h.sibling,l!==null){l.return=h.return,_t=l;break}_t=h.return}return xt=dv,dv=!1,xt}function _u(l,h,m){var v=h.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var T=v=v.next;do{if((T.tag&l)===l){var N=T.destroy;T.destroy=void 0,N!==void 0&&mp(h,m,N)}T=T.next}while(T!==v)}}function Ch(l,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var m=h=h.next;do{if((m.tag&l)===l){var v=m.create;m.destroy=v()}m=m.next}while(m!==h)}}function _p(l){var h=l.ref;if(h!==null){var m=l.stateNode;switch(l.tag){case 5:l=m;break;default:l=m}typeof h=="function"?h(l):h.current=l}}function hv(l){var h=l.alternate;h!==null&&(l.alternate=null,hv(h)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(h=l.stateNode,h!==null&&(delete h[ti],delete h[ou],delete h[Pf],delete h[pN],delete h[mN])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function cv(l){return l.tag===5||l.tag===3||l.tag===4}function gv(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||cv(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function yp(l,h,m){var v=l.tag;if(v===5||v===6)l=l.stateNode,h?m.nodeType===8?m.parentNode.insertBefore(l,h):m.insertBefore(l,h):(m.nodeType===8?(h=m.parentNode,h.insertBefore(l,m)):(h=m,h.appendChild(l)),m=m._reactRootContainer,m!=null||h.onclick!==null||(h.onclick=rh));else if(v!==4&&(l=l.child,l!==null))for(yp(l,h,m),l=l.sibling;l!==null;)yp(l,h,m),l=l.sibling}function xp(l,h,m){var v=l.tag;if(v===5||v===6)l=l.stateNode,h?m.insertBefore(l,h):m.appendChild(l);else if(v!==4&&(l=l.child,l!==null))for(xp(l,h,m),l=l.sibling;l!==null;)xp(l,h,m),l=l.sibling}var ys=null,zr=!1;function ho(l,h,m){for(m=m.child;m!==null;)fv(l,h,m),m=m.sibling}function fv(l,h,m){if(Ee&&typeof Ee.onCommitFiberUnmount=="function")try{Ee.onCommitFiberUnmount(ge,m)}catch{}switch(m.tag){case 5:Ns||el(m,h);case 6:var v=ys,T=zr;ys=null,ho(l,h,m),ys=v,zr=T,ys!==null&&(zr?(l=ys,m=m.stateNode,l.nodeType===8?l.parentNode.removeChild(m):l.removeChild(m)):ys.removeChild(m.stateNode));break;case 18:ys!==null&&(zr?(l=ys,m=m.stateNode,l.nodeType===8?Mf(l.parentNode,m):l.nodeType===1&&Mf(l,m),ar(l)):Mf(ys,m.stateNode));break;case 4:v=ys,T=zr,ys=m.stateNode.containerInfo,zr=!0,ho(l,h,m),ys=v,zr=T;break;case 0:case 11:case 14:case 15:if(!Ns&&(v=m.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){T=v=v.next;do{var N=T,D=N.destroy;N=N.tag,D!==void 0&&((N&2)!==0||(N&4)!==0)&&mp(m,h,D),T=T.next}while(T!==v)}ho(l,h,m);break;case 1:if(!Ns&&(el(m,h),v=m.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=m.memoizedProps,v.state=m.memoizedState,v.componentWillUnmount()}catch(J){Kn(m,h,J)}ho(l,h,m);break;case 21:ho(l,h,m);break;case 22:m.mode&1?(Ns=(v=Ns)||m.memoizedState!==null,ho(l,h,m),Ns=v):ho(l,h,m);break;default:ho(l,h,m)}}function pv(l){var h=l.updateQueue;if(h!==null){l.updateQueue=null;var m=l.stateNode;m===null&&(m=l.stateNode=new MN),h.forEach(function(v){var T=VN.bind(null,l,v);m.has(v)||(m.add(v),v.then(T,T))})}}function Br(l,h){var m=h.deletions;if(m!==null)for(var v=0;v<m.length;v++){var T=m[v];try{var N=l,D=h,J=D;e:for(;J!==null;){switch(J.tag){case 5:ys=J.stateNode,zr=!1;break e;case 3:ys=J.stateNode.containerInfo,zr=!0;break e;case 4:ys=J.stateNode.containerInfo,zr=!0;break e}J=J.return}if(ys===null)throw Error(n(160));fv(N,D,T),ys=null,zr=!1;var de=T.alternate;de!==null&&(de.return=null),T.return=null}catch(ke){Kn(T,h,ke)}}if(h.subtreeFlags&12854)for(h=h.child;h!==null;)mv(h,l),h=h.sibling}function mv(l,h){var m=l.alternate,v=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Br(h,l),ri(l),v&4){try{_u(3,l,l.return),Ch(3,l)}catch(bt){Kn(l,l.return,bt)}try{_u(5,l,l.return)}catch(bt){Kn(l,l.return,bt)}}break;case 1:Br(h,l),ri(l),v&512&&m!==null&&el(m,m.return);break;case 5:if(Br(h,l),ri(l),v&512&&m!==null&&el(m,m.return),l.flags&32){var T=l.stateNode;try{Jn(T,"")}catch(bt){Kn(l,l.return,bt)}}if(v&4&&(T=l.stateNode,T!=null)){var N=l.memoizedProps,D=m!==null?m.memoizedProps:N,J=l.type,de=l.updateQueue;if(l.updateQueue=null,de!==null)try{J==="input"&&N.type==="radio"&&N.name!=null&&Xe(T,N),An(J,D);var ke=An(J,N);for(D=0;D<de.length;D+=2){var Ke=de[D],Je=de[D+1];Ke==="style"?Gn(T,Je):Ke==="dangerouslySetInnerHTML"?Sn(T,Je):Ke==="children"?Jn(T,Je):S(T,Ke,Je,ke)}switch(J){case"input":dt(T,N);break;case"textarea":jt(T,N);break;case"select":var Ze=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!N.multiple;var gt=N.value;gt!=null?Lt(T,!!N.multiple,gt,!1):Ze!==!!N.multiple&&(N.defaultValue!=null?Lt(T,!!N.multiple,N.defaultValue,!0):Lt(T,!!N.multiple,N.multiple?[]:"",!1))}T[ou]=N}catch(bt){Kn(l,l.return,bt)}}break;case 6:if(Br(h,l),ri(l),v&4){if(l.stateNode===null)throw Error(n(162));T=l.stateNode,N=l.memoizedProps;try{T.nodeValue=N}catch(bt){Kn(l,l.return,bt)}}break;case 3:if(Br(h,l),ri(l),v&4&&m!==null&&m.memoizedState.isDehydrated)try{ar(h.containerInfo)}catch(bt){Kn(l,l.return,bt)}break;case 4:Br(h,l),ri(l);break;case 13:Br(h,l),ri(l),T=l.child,T.flags&8192&&(N=T.memoizedState!==null,T.stateNode.isHidden=N,!N||T.alternate!==null&&T.alternate.memoizedState!==null||(Ep=U())),v&4&&pv(l);break;case 22:if(Ke=m!==null&&m.memoizedState!==null,l.mode&1?(Ns=(ke=Ns)||Ke,Br(h,l),Ns=ke):Br(h,l),ri(l),v&8192){if(ke=l.memoizedState!==null,(l.stateNode.isHidden=ke)&&!Ke&&(l.mode&1)!==0)for(_t=l,Ke=l.child;Ke!==null;){for(Je=_t=Ke;_t!==null;){switch(Ze=_t,gt=Ze.child,Ze.tag){case 0:case 11:case 14:case 15:_u(4,Ze,Ze.return);break;case 1:el(Ze,Ze.return);var xt=Ze.stateNode;if(typeof xt.componentWillUnmount=="function"){v=Ze,m=Ze.return;try{h=v,xt.props=h.memoizedProps,xt.state=h.memoizedState,xt.componentWillUnmount()}catch(bt){Kn(v,m,bt)}}break;case 5:el(Ze,Ze.return);break;case 22:if(Ze.memoizedState!==null){xv(Je);continue}}gt!==null?(gt.return=Ze,_t=gt):xv(Je)}Ke=Ke.sibling}e:for(Ke=null,Je=l;;){if(Je.tag===5){if(Ke===null){Ke=Je;try{T=Je.stateNode,ke?(N=T.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none"):(J=Je.stateNode,de=Je.memoizedProps.style,D=de!=null&&de.hasOwnProperty("display")?de.display:null,J.style.display=Xn("display",D))}catch(bt){Kn(l,l.return,bt)}}}else if(Je.tag===6){if(Ke===null)try{Je.stateNode.nodeValue=ke?"":Je.memoizedProps}catch(bt){Kn(l,l.return,bt)}}else if((Je.tag!==22&&Je.tag!==23||Je.memoizedState===null||Je===l)&&Je.child!==null){Je.child.return=Je,Je=Je.child;continue}if(Je===l)break e;for(;Je.sibling===null;){if(Je.return===null||Je.return===l)break e;Ke===Je&&(Ke=null),Je=Je.return}Ke===Je&&(Ke=null),Je.sibling.return=Je.return,Je=Je.sibling}}break;case 19:Br(h,l),ri(l),v&4&&pv(l);break;case 21:break;default:Br(h,l),ri(l)}}function ri(l){var h=l.flags;if(h&2){try{e:{for(var m=l.return;m!==null;){if(cv(m)){var v=m;break e}m=m.return}throw Error(n(160))}switch(v.tag){case 5:var T=v.stateNode;v.flags&32&&(Jn(T,""),v.flags&=-33);var N=gv(l);xp(l,N,T);break;case 3:case 4:var D=v.stateNode.containerInfo,J=gv(l);yp(l,J,D);break;default:throw Error(n(161))}}catch(de){Kn(l,l.return,de)}l.flags&=-3}h&4096&&(l.flags&=-4097)}function RN(l,h,m){_t=l,_v(l)}function _v(l,h,m){for(var v=(l.mode&1)!==0;_t!==null;){var T=_t,N=T.child;if(T.tag===22&&v){var D=T.memoizedState!==null||Th;if(!D){var J=T.alternate,de=J!==null&&J.memoizedState!==null||Ns;J=Th;var ke=Ns;if(Th=D,(Ns=de)&&!ke)for(_t=T;_t!==null;)D=_t,de=D.child,D.tag===22&&D.memoizedState!==null?vv(T):de!==null?(de.return=D,_t=de):vv(T);for(;N!==null;)_t=N,_v(N),N=N.sibling;_t=T,Th=J,Ns=ke}yv(l)}else(T.subtreeFlags&8772)!==0&&N!==null?(N.return=T,_t=N):yv(l)}}function yv(l){for(;_t!==null;){var h=_t;if((h.flags&8772)!==0){var m=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:Ns||Ch(5,h);break;case 1:var v=h.stateNode;if(h.flags&4&&!Ns)if(m===null)v.componentDidMount();else{var T=h.elementType===h.type?m.memoizedProps:Or(h.type,m.memoizedProps);v.componentDidUpdate(T,m.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var N=h.updateQueue;N!==null&&x0(h,N,v);break;case 3:var D=h.updateQueue;if(D!==null){if(m=null,h.child!==null)switch(h.child.tag){case 5:m=h.child.stateNode;break;case 1:m=h.child.stateNode}x0(h,D,m)}break;case 5:var J=h.stateNode;if(m===null&&h.flags&4){m=J;var de=h.memoizedProps;switch(h.type){case"button":case"input":case"select":case"textarea":de.autoFocus&&m.focus();break;case"img":de.src&&(m.src=de.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(h.memoizedState===null){var ke=h.alternate;if(ke!==null){var Ke=ke.memoizedState;if(Ke!==null){var Je=Ke.dehydrated;Je!==null&&ar(Je)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Ns||h.flags&512&&_p(h)}catch(Ze){Kn(h,h.return,Ze)}}if(h===l){_t=null;break}if(m=h.sibling,m!==null){m.return=h.return,_t=m;break}_t=h.return}}function xv(l){for(;_t!==null;){var h=_t;if(h===l){_t=null;break}var m=h.sibling;if(m!==null){m.return=h.return,_t=m;break}_t=h.return}}function vv(l){for(;_t!==null;){var h=_t;try{switch(h.tag){case 0:case 11:case 15:var m=h.return;try{Ch(4,h)}catch(de){Kn(h,m,de)}break;case 1:var v=h.stateNode;if(typeof v.componentDidMount=="function"){var T=h.return;try{v.componentDidMount()}catch(de){Kn(h,T,de)}}var N=h.return;try{_p(h)}catch(de){Kn(h,N,de)}break;case 5:var D=h.return;try{_p(h)}catch(de){Kn(h,D,de)}}}catch(de){Kn(h,h.return,de)}if(h===l){_t=null;break}var J=h.sibling;if(J!==null){J.return=h.return,_t=J;break}_t=h.return}}var FN=Math.ceil,Lh=A.ReactCurrentDispatcher,vp=A.ReactCurrentOwner,Sr=A.ReactCurrentBatchConfig,en=0,ps=null,ls=null,xs=0,hr=0,tl=io(0),cs=0,yu=null,Qo=0,Nh=0,bp=0,xu=null,er=null,Ep=0,nl=1/0,Ci=null,Ih=!1,Sp=null,co=null,kh=!1,go=null,Mh=0,vu=0,Ap=null,Ph=-1,Rh=0;function Gs(){return(en&6)!==0?U():Ph!==-1?Ph:Ph=U()}function fo(l){return(l.mode&1)===0?1:(en&2)!==0&&xs!==0?xs&-xs:yN.transition!==null?(Rh===0&&(Rh=B()),Rh):(l=Ve,l!==0||(l=window.event,l=l===void 0?16:ql(l.type)),l)}function Ur(l,h,m,v){if(50<vu)throw vu=0,Ap=null,Error(n(185));ee(l,m,v),((en&2)===0||l!==ps)&&(l===ps&&((en&2)===0&&(Nh|=m),cs===4&&po(l,xs)),tr(l,v),m===1&&en===0&&(h.mode&1)===0&&(nl=U()+500,lh&&ao()))}function tr(l,h){var m=l.callbackNode;I(l,h);var v=Ye(l,l===ps?xs:0);if(v===0)m!==null&&Zt(m),l.callbackNode=null,l.callbackPriority=0;else if(h=v&-v,l.callbackPriority!==h){if(m!=null&&Zt(m),h===1)l.tag===0?_N(Ev.bind(null,l)):a0(Ev.bind(null,l)),gN(function(){(en&6)===0&&ao()}),m=null;else{switch(rt(v)){case 1:m=$;break;case 4:m=ie;break;case 16:m=ue;break;case 536870912:m=se;break;default:m=ue}m=Iv(m,bv.bind(null,l))}l.callbackPriority=h,l.callbackNode=m}}function bv(l,h){if(Ph=-1,Rh=0,(en&6)!==0)throw Error(n(327));var m=l.callbackNode;if(sl()&&l.callbackNode!==m)return null;var v=Ye(l,l===ps?xs:0);if(v===0)return null;if((v&30)!==0||(v&l.expiredLanes)!==0||h)h=Fh(l,v);else{h=v;var T=en;en|=2;var N=Av();(ps!==l||xs!==h)&&(Ci=null,nl=U()+500,ea(l,h));do try{zN();break}catch(J){Sv(l,J)}while(!0);Vf(),Lh.current=N,en=T,ls!==null?h=0:(ps=null,xs=0,h=cs)}if(h!==0){if(h===2&&(T=F(l),T!==0&&(v=T,h=wp(l,T))),h===1)throw m=yu,ea(l,0),po(l,v),tr(l,U()),m;if(h===6)po(l,v);else{if(T=l.current.alternate,(v&30)===0&&!DN(T)&&(h=Fh(l,v),h===2&&(N=F(l),N!==0&&(v=N,h=wp(l,N))),h===1))throw m=yu,ea(l,0),po(l,v),tr(l,U()),m;switch(l.finishedWork=T,l.finishedLanes=v,h){case 0:case 1:throw Error(n(345));case 2:ta(l,er,Ci);break;case 3:if(po(l,v),(v&130023424)===v&&(h=Ep+500-U(),10<h)){if(Ye(l,0)!==0)break;if(T=l.suspendedLanes,(T&v)!==v){Gs(),l.pingedLanes|=l.suspendedLanes&T;break}l.timeoutHandle=kf(ta.bind(null,l,er,Ci),h);break}ta(l,er,Ci);break;case 4:if(po(l,v),(v&4194240)===v)break;for(h=l.eventTimes,T=-1;0<v;){var D=31-Se(v);N=1<<D,D=h[D],D>T&&(T=D),v&=~N}if(v=T,v=U()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*FN(v/1960))-v,10<v){l.timeoutHandle=kf(ta.bind(null,l,er,Ci),v);break}ta(l,er,Ci);break;case 5:ta(l,er,Ci);break;default:throw Error(n(329))}}}return tr(l,U()),l.callbackNode===m?bv.bind(null,l):null}function wp(l,h){var m=xu;return l.current.memoizedState.isDehydrated&&(ea(l,h).flags|=256),l=Fh(l,h),l!==2&&(h=er,er=m,h!==null&&Tp(h)),l}function Tp(l){er===null?er=l:er.push.apply(er,l)}function DN(l){for(var h=l;;){if(h.flags&16384){var m=h.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var v=0;v<m.length;v++){var T=m[v],N=T.getSnapshot;T=T.value;try{if(!Fr(N(),T))return!1}catch{return!1}}}if(m=h.child,h.subtreeFlags&16384&&m!==null)m.return=h,h=m;else{if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function po(l,h){for(h&=~bp,h&=~Nh,l.suspendedLanes|=h,l.pingedLanes&=~h,l=l.expirationTimes;0<h;){var m=31-Se(h),v=1<<m;l[m]=-1,h&=~v}}function Ev(l){if((en&6)!==0)throw Error(n(327));sl();var h=Ye(l,0);if((h&1)===0)return tr(l,U()),null;var m=Fh(l,h);if(l.tag!==0&&m===2){var v=F(l);v!==0&&(h=v,m=wp(l,v))}if(m===1)throw m=yu,ea(l,0),po(l,h),tr(l,U()),m;if(m===6)throw Error(n(345));return l.finishedWork=l.current.alternate,l.finishedLanes=h,ta(l,er,Ci),tr(l,U()),null}function Cp(l,h){var m=en;en|=1;try{return l(h)}finally{en=m,en===0&&(nl=U()+500,lh&&ao())}}function Jo(l){go!==null&&go.tag===0&&(en&6)===0&&sl();var h=en;en|=1;var m=Sr.transition,v=Ve;try{if(Sr.transition=null,Ve=1,l)return l()}finally{Ve=v,Sr.transition=m,en=h,(en&6)===0&&ao()}}function Lp(){hr=tl.current,Cn(tl)}function ea(l,h){l.finishedWork=null,l.finishedLanes=0;var m=l.timeoutHandle;if(m!==-1&&(l.timeoutHandle=-1,cN(m)),ls!==null)for(m=ls.return;m!==null;){var v=m;switch(Of(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&oh();break;case 3:Qa(),Cn(Ks),Cn(Ts),Zf();break;case 5:Xf(v);break;case 4:Qa();break;case 13:Cn(qn);break;case 19:Cn(qn);break;case 10:jf(v.type._context);break;case 22:case 23:Lp()}m=m.return}if(ps=l,ls=l=mo(l.current,null),xs=hr=h,cs=0,yu=null,bp=Nh=Qo=0,er=xu=null,Yo!==null){for(h=0;h<Yo.length;h++)if(m=Yo[h],v=m.interleaved,v!==null){m.interleaved=null;var T=v.next,N=m.pending;if(N!==null){var D=N.next;N.next=T,v.next=D}m.pending=v}Yo=null}return l}function Sv(l,h){do{var m=ls;try{if(Vf(),yh.current=Eh,xh){for(var v=$n.memoizedState;v!==null;){var T=v.queue;T!==null&&(T.pending=null),v=v.next}xh=!1}if(Ko=0,fs=hs=$n=null,cu=!1,gu=0,vp.current=null,m===null||m.return===null){cs=1,yu=h,ls=null;break}e:{var N=l,D=m.return,J=m,de=h;if(h=xs,J.flags|=32768,de!==null&&typeof de=="object"&&typeof de.then=="function"){var ke=de,Ke=J,Je=Ke.tag;if((Ke.mode&1)===0&&(Je===0||Je===11||Je===15)){var Ze=Ke.alternate;Ze?(Ke.updateQueue=Ze.updateQueue,Ke.memoizedState=Ze.memoizedState,Ke.lanes=Ze.lanes):(Ke.updateQueue=null,Ke.memoizedState=null)}var gt=X0(D);if(gt!==null){gt.flags&=-257,Y0(gt,D,J,N,h),gt.mode&1&&W0(N,ke,h),h=gt,de=ke;var xt=h.updateQueue;if(xt===null){var bt=new Set;bt.add(de),h.updateQueue=bt}else xt.add(de);break e}else{if((h&1)===0){W0(N,ke,h),Np();break e}de=Error(n(426))}}else if(Dn&&J.mode&1){var ts=X0(D);if(ts!==null){(ts.flags&65536)===0&&(ts.flags|=256),Y0(ts,D,J,N,h),Uf(Ja(de,J));break e}}N=de=Ja(de,J),cs!==4&&(cs=2),xu===null?xu=[N]:xu.push(N),N=D;do{switch(N.tag){case 3:N.flags|=65536,h&=-h,N.lanes|=h;var Ae=q0(N,de,h);y0(N,Ae);break e;case 1:J=de;var pe=N.type,Ce=N.stateNode;if((N.flags&128)===0&&(typeof pe.getDerivedStateFromError=="function"||Ce!==null&&typeof Ce.componentDidCatch=="function"&&(co===null||!co.has(Ce)))){N.flags|=65536,h&=-h,N.lanes|=h;var nt=$0(N,J,h);y0(N,nt);break e}}N=N.return}while(N!==null)}Tv(m)}catch(Et){h=Et,ls===m&&m!==null&&(ls=m=m.return);continue}break}while(!0)}function Av(){var l=Lh.current;return Lh.current=Eh,l===null?Eh:l}function Np(){(cs===0||cs===3||cs===2)&&(cs=4),ps===null||(Qo&268435455)===0&&(Nh&268435455)===0||po(ps,xs)}function Fh(l,h){var m=en;en|=2;var v=Av();(ps!==l||xs!==h)&&(Ci=null,ea(l,h));do try{ON();break}catch(T){Sv(l,T)}while(!0);if(Vf(),en=m,Lh.current=v,ls!==null)throw Error(n(261));return ps=null,xs=0,cs}function ON(){for(;ls!==null;)wv(ls)}function zN(){for(;ls!==null&&!nn();)wv(ls)}function wv(l){var h=Nv(l.alternate,l,hr);l.memoizedProps=l.pendingProps,h===null?Tv(l):ls=h,vp.current=null}function Tv(l){var h=l;do{var m=h.alternate;if(l=h.return,(h.flags&32768)===0){if(m=IN(m,h,hr),m!==null){ls=m;return}}else{if(m=kN(m,h),m!==null){m.flags&=32767,ls=m;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{cs=6,ls=null;return}}if(h=h.sibling,h!==null){ls=h;return}ls=h=l}while(h!==null);cs===0&&(cs=5)}function ta(l,h,m){var v=Ve,T=Sr.transition;try{Sr.transition=null,Ve=1,BN(l,h,m,v)}finally{Sr.transition=T,Ve=v}return null}function BN(l,h,m,v){do sl();while(go!==null);if((en&6)!==0)throw Error(n(327));m=l.finishedWork;var T=l.finishedLanes;if(m===null)return null;if(l.finishedWork=null,l.finishedLanes=0,m===l.current)throw Error(n(177));l.callbackNode=null,l.callbackPriority=0;var N=m.lanes|m.childLanes;if(ye(l,N),l===ps&&(ls=ps=null,xs=0),(m.subtreeFlags&2064)===0&&(m.flags&2064)===0||kh||(kh=!0,Iv(ue,function(){return sl(),null})),N=(m.flags&15990)!==0,(m.subtreeFlags&15990)!==0||N){N=Sr.transition,Sr.transition=null;var D=Ve;Ve=1;var J=en;en|=4,vp.current=null,PN(l,m),mv(m,l),iN(Nf),lr=!!Lf,Nf=Lf=null,l.current=m,RN(m),H(),en=J,Ve=D,Sr.transition=N}else l.current=m;if(kh&&(kh=!1,go=l,Mh=T),N=l.pendingLanes,N===0&&(co=null),xe(m.stateNode),tr(l,U()),h!==null)for(v=l.onRecoverableError,m=0;m<h.length;m++)T=h[m],v(T.value,{componentStack:T.stack,digest:T.digest});if(Ih)throw Ih=!1,l=Sp,Sp=null,l;return(Mh&1)!==0&&l.tag!==0&&sl(),N=l.pendingLanes,(N&1)!==0?l===Ap?vu++:(vu=0,Ap=l):vu=0,ao(),null}function sl(){if(go!==null){var l=rt(Mh),h=Sr.transition,m=Ve;try{if(Sr.transition=null,Ve=16>l?16:l,go===null)var v=!1;else{if(l=go,go=null,Mh=0,(en&6)!==0)throw Error(n(331));var T=en;for(en|=4,_t=l.current;_t!==null;){var N=_t,D=N.child;if((_t.flags&16)!==0){var J=N.deletions;if(J!==null){for(var de=0;de<J.length;de++){var ke=J[de];for(_t=ke;_t!==null;){var Ke=_t;switch(Ke.tag){case 0:case 11:case 15:_u(8,Ke,N)}var Je=Ke.child;if(Je!==null)Je.return=Ke,_t=Je;else for(;_t!==null;){Ke=_t;var Ze=Ke.sibling,gt=Ke.return;if(hv(Ke),Ke===ke){_t=null;break}if(Ze!==null){Ze.return=gt,_t=Ze;break}_t=gt}}}var xt=N.alternate;if(xt!==null){var bt=xt.child;if(bt!==null){xt.child=null;do{var ts=bt.sibling;bt.sibling=null,bt=ts}while(bt!==null)}}_t=N}}if((N.subtreeFlags&2064)!==0&&D!==null)D.return=N,_t=D;else e:for(;_t!==null;){if(N=_t,(N.flags&2048)!==0)switch(N.tag){case 0:case 11:case 15:_u(9,N,N.return)}var Ae=N.sibling;if(Ae!==null){Ae.return=N.return,_t=Ae;break e}_t=N.return}}var pe=l.current;for(_t=pe;_t!==null;){D=_t;var Ce=D.child;if((D.subtreeFlags&2064)!==0&&Ce!==null)Ce.return=D,_t=Ce;else e:for(D=pe;_t!==null;){if(J=_t,(J.flags&2048)!==0)try{switch(J.tag){case 0:case 11:case 15:Ch(9,J)}}catch(Et){Kn(J,J.return,Et)}if(J===D){_t=null;break e}var nt=J.sibling;if(nt!==null){nt.return=J.return,_t=nt;break e}_t=J.return}}if(en=T,ao(),Ee&&typeof Ee.onPostCommitFiberRoot=="function")try{Ee.onPostCommitFiberRoot(ge,l)}catch{}v=!0}return v}finally{Ve=m,Sr.transition=h}}return!1}function Cv(l,h,m){h=Ja(m,h),h=q0(l,h,1),l=uo(l,h,1),h=Gs(),l!==null&&(ee(l,1,h),tr(l,h))}function Kn(l,h,m){if(l.tag===3)Cv(l,l,m);else for(;h!==null;){if(h.tag===3){Cv(h,l,m);break}else if(h.tag===1){var v=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(co===null||!co.has(v))){l=Ja(m,l),l=$0(h,l,1),h=uo(h,l,1),l=Gs(),h!==null&&(ee(h,1,l),tr(h,l));break}}h=h.return}}function UN(l,h,m){var v=l.pingCache;v!==null&&v.delete(h),h=Gs(),l.pingedLanes|=l.suspendedLanes&m,ps===l&&(xs&m)===m&&(cs===4||cs===3&&(xs&130023424)===xs&&500>U()-Ep?ea(l,0):bp|=m),tr(l,h)}function Lv(l,h){h===0&&((l.mode&1)===0?h=1:(h=$e,$e<<=1,($e&130023424)===0&&($e=4194304)));var m=Gs();l=Ai(l,h),l!==null&&(ee(l,h,m),tr(l,m))}function GN(l){var h=l.memoizedState,m=0;h!==null&&(m=h.retryLane),Lv(l,m)}function VN(l,h){var m=0;switch(l.tag){case 13:var v=l.stateNode,T=l.memoizedState;T!==null&&(m=T.retryLane);break;case 19:v=l.stateNode;break;default:throw Error(n(314))}v!==null&&v.delete(h),Lv(l,m)}var Nv;Nv=function(l,h,m){if(l!==null)if(l.memoizedProps!==h.pendingProps||Ks.current)Js=!0;else{if((l.lanes&m)===0&&(h.flags&128)===0)return Js=!1,NN(l,h,m);Js=(l.flags&131072)!==0}else Js=!1,Dn&&(h.flags&1048576)!==0&&l0(h,dh,h.index);switch(h.lanes=0,h.tag){case 2:var v=h.type;wh(l,h),l=h.pendingProps;var T=qa(h,Ts.current);Ka(h,m),T=Jf(null,h,v,l,T,m);var N=ep();return h.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,Qs(v)?(N=!0,ah(h)):N=!1,h.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,$f(h),T.updater=Sh,h.stateNode=T,T._reactInternals=h,op(h,v,l,m),h=dp(null,h,v,!0,N,m)):(h.tag=0,Dn&&N&&Df(h),Us(null,h,T,m),h=h.child),h;case 16:v=h.elementType;e:{switch(wh(l,h),l=h.pendingProps,T=v._init,v=T(v._payload),h.type=v,T=h.tag=HN(v),l=Or(v,l),T){case 0:h=up(null,h,v,l,m);break e;case 1:h=tv(null,h,v,l,m);break e;case 11:h=Z0(null,h,v,l,m);break e;case 14:h=K0(null,h,v,Or(v.type,l),m);break e}throw Error(n(306,v,""))}return h;case 0:return v=h.type,T=h.pendingProps,T=h.elementType===v?T:Or(v,T),up(l,h,v,T,m);case 1:return v=h.type,T=h.pendingProps,T=h.elementType===v?T:Or(v,T),tv(l,h,v,T,m);case 3:e:{if(nv(h),l===null)throw Error(n(387));v=h.pendingProps,N=h.memoizedState,T=N.element,_0(l,h),mh(h,v,null,m);var D=h.memoizedState;if(v=D.element,N.isDehydrated)if(N={element:v,isDehydrated:!1,cache:D.cache,pendingSuspenseBoundaries:D.pendingSuspenseBoundaries,transitions:D.transitions},h.updateQueue.baseState=N,h.memoizedState=N,h.flags&256){T=Ja(Error(n(423)),h),h=sv(l,h,v,m,T);break e}else if(v!==T){T=Ja(Error(n(424)),h),h=sv(l,h,v,m,T);break e}else for(dr=ro(h.stateNode.containerInfo.firstChild),ur=h,Dn=!0,Dr=null,m=p0(h,null,v,m),h.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(Xa(),v===T){h=Ti(l,h,m);break e}Us(l,h,v,m)}h=h.child}return h;case 5:return v0(h),l===null&&Bf(h),v=h.type,T=h.pendingProps,N=l!==null?l.memoizedProps:null,D=T.children,If(v,T)?D=null:N!==null&&If(v,N)&&(h.flags|=32),ev(l,h),Us(l,h,D,m),h.child;case 6:return l===null&&Bf(h),null;case 13:return rv(l,h,m);case 4:return Wf(h,h.stateNode.containerInfo),v=h.pendingProps,l===null?h.child=Ya(h,null,v,m):Us(l,h,v,m),h.child;case 11:return v=h.type,T=h.pendingProps,T=h.elementType===v?T:Or(v,T),Z0(l,h,v,T,m);case 7:return Us(l,h,h.pendingProps,m),h.child;case 8:return Us(l,h,h.pendingProps.children,m),h.child;case 12:return Us(l,h,h.pendingProps.children,m),h.child;case 10:e:{if(v=h.type._context,T=h.pendingProps,N=h.memoizedProps,D=T.value,bn(gh,v._currentValue),v._currentValue=D,N!==null)if(Fr(N.value,D)){if(N.children===T.children&&!Ks.current){h=Ti(l,h,m);break e}}else for(N=h.child,N!==null&&(N.return=h);N!==null;){var J=N.dependencies;if(J!==null){D=N.child;for(var de=J.firstContext;de!==null;){if(de.context===v){if(N.tag===1){de=wi(-1,m&-m),de.tag=2;var ke=N.updateQueue;if(ke!==null){ke=ke.shared;var Ke=ke.pending;Ke===null?de.next=de:(de.next=Ke.next,Ke.next=de),ke.pending=de}}N.lanes|=m,de=N.alternate,de!==null&&(de.lanes|=m),Hf(N.return,m,h),J.lanes|=m;break}de=de.next}}else if(N.tag===10)D=N.type===h.type?null:N.child;else if(N.tag===18){if(D=N.return,D===null)throw Error(n(341));D.lanes|=m,J=D.alternate,J!==null&&(J.lanes|=m),Hf(D,m,h),D=N.sibling}else D=N.child;if(D!==null)D.return=N;else for(D=N;D!==null;){if(D===h){D=null;break}if(N=D.sibling,N!==null){N.return=D.return,D=N;break}D=D.return}N=D}Us(l,h,T.children,m),h=h.child}return h;case 9:return T=h.type,v=h.pendingProps.children,Ka(h,m),T=br(T),v=v(T),h.flags|=1,Us(l,h,v,m),h.child;case 14:return v=h.type,T=Or(v,h.pendingProps),T=Or(v.type,T),K0(l,h,v,T,m);case 15:return Q0(l,h,h.type,h.pendingProps,m);case 17:return v=h.type,T=h.pendingProps,T=h.elementType===v?T:Or(v,T),wh(l,h),h.tag=1,Qs(v)?(l=!0,ah(h)):l=!1,Ka(h,m),j0(h,v,T),op(h,v,T,m),dp(null,h,v,!0,l,m);case 19:return ov(l,h,m);case 22:return J0(l,h,m)}throw Error(n(156,h.tag))};function Iv(l,h){return Ft(l,h)}function jN(l,h,m,v){this.tag=l,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ar(l,h,m,v){return new jN(l,h,m,v)}function Ip(l){return l=l.prototype,!(!l||!l.isReactComponent)}function HN(l){if(typeof l=="function")return Ip(l)?1:0;if(l!=null){if(l=l.$$typeof,l===X)return 11;if(l===Q)return 14}return 2}function mo(l,h){var m=l.alternate;return m===null?(m=Ar(l.tag,h,l.key,l.mode),m.elementType=l.elementType,m.type=l.type,m.stateNode=l.stateNode,m.alternate=l,l.alternate=m):(m.pendingProps=h,m.type=l.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=l.flags&14680064,m.childLanes=l.childLanes,m.lanes=l.lanes,m.child=l.child,m.memoizedProps=l.memoizedProps,m.memoizedState=l.memoizedState,m.updateQueue=l.updateQueue,h=l.dependencies,m.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},m.sibling=l.sibling,m.index=l.index,m.ref=l.ref,m}function Dh(l,h,m,v,T,N){var D=2;if(v=l,typeof l=="function")Ip(l)&&(D=1);else if(typeof l=="string")D=5;else e:switch(l){case M:return na(m.children,T,N,h);case R:D=8,T|=8;break;case O:return l=Ar(12,m,h,T|2),l.elementType=O,l.lanes=N,l;case oe:return l=Ar(13,m,h,T),l.elementType=oe,l.lanes=N,l;case re:return l=Ar(19,m,h,T),l.elementType=re,l.lanes=N,l;case fe:return Oh(m,T,N,h);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case j:D=10;break e;case z:D=9;break e;case X:D=11;break e;case Q:D=14;break e;case he:D=16,v=null;break e}throw Error(n(130,l==null?l:typeof l,""))}return h=Ar(D,m,h,T),h.elementType=l,h.type=v,h.lanes=N,h}function na(l,h,m,v){return l=Ar(7,l,v,h),l.lanes=m,l}function Oh(l,h,m,v){return l=Ar(22,l,v,h),l.elementType=fe,l.lanes=m,l.stateNode={isHidden:!1},l}function kp(l,h,m){return l=Ar(6,l,null,h),l.lanes=m,l}function Mp(l,h,m){return h=Ar(4,l.children!==null?l.children:[],l.key,h),h.lanes=m,h.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},h}function qN(l,h,m,v,T){this.tag=h,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=le(0),this.expirationTimes=le(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=le(0),this.identifierPrefix=v,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function Pp(l,h,m,v,T,N,D,J,de){return l=new qN(l,h,m,J,de),h===1?(h=1,N===!0&&(h|=8)):h=0,N=Ar(3,null,null,h),l.current=N,N.stateNode=l,N.memoizedState={element:v,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},$f(N),l}function $N(l,h,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:k,key:v==null?null:""+v,children:l,containerInfo:h,implementation:m}}function kv(l){if(!l)return oo;l=l._reactInternals;e:{if(tt(l)!==l||l.tag!==1)throw Error(n(170));var h=l;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(Qs(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(n(171))}if(l.tag===1){var m=l.type;if(Qs(m))return i0(l,m,h)}return h}function Mv(l,h,m,v,T,N,D,J,de){return l=Pp(m,v,!0,l,T,N,D,J,de),l.context=kv(null),m=l.current,v=Gs(),T=fo(m),N=wi(v,T),N.callback=h??null,uo(m,N,T),l.current.lanes=T,ee(l,T,v),tr(l,v),l}function zh(l,h,m,v){var T=h.current,N=Gs(),D=fo(T);return m=kv(m),h.context===null?h.context=m:h.pendingContext=m,h=wi(N,D),h.payload={element:l},v=v===void 0?null:v,v!==null&&(h.callback=v),l=uo(T,h,D),l!==null&&(Ur(l,T,D,N),ph(l,T,D)),D}function Bh(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function Pv(l,h){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var m=l.retryLane;l.retryLane=m!==0&&m<h?m:h}}function Rp(l,h){Pv(l,h),(l=l.alternate)&&Pv(l,h)}function WN(){return null}var Rv=typeof reportError=="function"?reportError:function(l){console.error(l)};function Fp(l){this._internalRoot=l}Uh.prototype.render=Fp.prototype.render=function(l){var h=this._internalRoot;if(h===null)throw Error(n(409));zh(l,h,null,null)},Uh.prototype.unmount=Fp.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var h=l.containerInfo;Jo(function(){zh(null,l,null,null)}),h[vi]=null}};function Uh(l){this._internalRoot=l}Uh.prototype.unstable_scheduleHydration=function(l){if(l){var h=Kt();l={blockedOn:null,target:l,priority:h};for(var m=0;m<es.length&&h!==0&&h<es[m].priority;m++);es.splice(m,0,l),m===0&&Hn(l)}};function Dp(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function Gh(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function Fv(){}function XN(l,h,m,v,T){if(T){if(typeof v=="function"){var N=v;v=function(){var ke=Bh(D);N.call(ke)}}var D=Mv(h,v,l,0,null,!1,!1,"",Fv);return l._reactRootContainer=D,l[vi]=D.current,ru(l.nodeType===8?l.parentNode:l),Jo(),D}for(;T=l.lastChild;)l.removeChild(T);if(typeof v=="function"){var J=v;v=function(){var ke=Bh(de);J.call(ke)}}var de=Pp(l,0,!1,null,null,!1,!1,"",Fv);return l._reactRootContainer=de,l[vi]=de.current,ru(l.nodeType===8?l.parentNode:l),Jo(function(){zh(h,de,m,v)}),de}function Vh(l,h,m,v,T){var N=m._reactRootContainer;if(N){var D=N;if(typeof T=="function"){var J=T;T=function(){var de=Bh(D);J.call(de)}}zh(h,D,l,T)}else D=XN(m,h,l,T,v);return Bh(D)}it=function(l){switch(l.tag){case 3:var h=l.stateNode;if(h.current.memoizedState.isDehydrated){var m=je(h.pendingLanes);m!==0&&(Pe(h,m|1),tr(h,U()),(en&6)===0&&(nl=U()+500,ao()))}break;case 13:Jo(function(){var v=Ai(l,1);if(v!==null){var T=Gs();Ur(v,l,1,T)}}),Rp(l,1)}},St=function(l){if(l.tag===13){var h=Ai(l,134217728);if(h!==null){var m=Gs();Ur(h,l,134217728,m)}Rp(l,134217728)}},Jt=function(l){if(l.tag===13){var h=fo(l),m=Ai(l,h);if(m!==null){var v=Gs();Ur(m,l,h,v)}Rp(l,h)}},Kt=function(){return Ve},Xt=function(l,h){var m=Ve;try{return Ve=l,h()}finally{Ve=m}},fn=function(l,h,m){switch(h){case"input":if(dt(l,m),h=m.name,m.type==="radio"&&h!=null){for(m=l;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+h)+'][type="radio"]'),h=0;h<m.length;h++){var v=m[h];if(v!==l&&v.form===l.form){var T=ih(v);if(!T)throw Error(n(90));Ue(v),dt(v,T)}}}break;case"textarea":jt(l,m);break;case"select":h=m.value,h!=null&&Lt(l,!!m.multiple,h,!1)}},cn=Cp,on=Jo;var YN={usingClientEntryPoint:!1,Events:[au,ja,ih,Zn,qt,Cp]},bu={findFiberByHostInstance:qo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ZN={bundleType:bu.bundleType,version:bu.version,rendererPackageName:bu.rendererPackageName,rendererConfig:bu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=Pt(l),l===null?null:l.stateNode},findFiberByHostInstance:bu.findFiberByHostInstance||WN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jh.isDisabled&&jh.supportsFiber)try{ge=jh.inject(ZN),Ee=jh}catch{}}return nr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YN,nr.createPortal=function(l,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dp(h))throw Error(n(200));return $N(l,h,null,m)},nr.createRoot=function(l,h){if(!Dp(l))throw Error(n(299));var m=!1,v="",T=Rv;return h!=null&&(h.unstable_strictMode===!0&&(m=!0),h.identifierPrefix!==void 0&&(v=h.identifierPrefix),h.onRecoverableError!==void 0&&(T=h.onRecoverableError)),h=Pp(l,1,!1,null,null,m,!1,v,T),l[vi]=h.current,ru(l.nodeType===8?l.parentNode:l),new Fp(h)},nr.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var h=l._reactInternals;if(h===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=Pt(h),l=l===null?null:l.stateNode,l},nr.flushSync=function(l){return Jo(l)},nr.hydrate=function(l,h,m){if(!Gh(h))throw Error(n(200));return Vh(null,l,h,!0,m)},nr.hydrateRoot=function(l,h,m){if(!Dp(l))throw Error(n(405));var v=m!=null&&m.hydratedSources||null,T=!1,N="",D=Rv;if(m!=null&&(m.unstable_strictMode===!0&&(T=!0),m.identifierPrefix!==void 0&&(N=m.identifierPrefix),m.onRecoverableError!==void 0&&(D=m.onRecoverableError)),h=Mv(h,null,l,1,m??null,T,!1,N,D),l[vi]=h.current,ru(l),v)for(l=0;l<v.length;l++)m=v[l],T=m._getVersion,T=T(m._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[m,T]:h.mutableSourceEagerHydrationData.push(m,T);return new Uh(h)},nr.render=function(l,h,m){if(!Gh(h))throw Error(n(200));return Vh(null,l,h,!1,m)},nr.unmountComponentAtNode=function(l){if(!Gh(l))throw Error(n(40));return l._reactRootContainer?(Jo(function(){Vh(null,null,l,!1,function(){l._reactRootContainer=null,l[vi]=null})}),!0):!1},nr.unstable_batchedUpdates=Cp,nr.unstable_renderSubtreeIntoContainer=function(l,h,m,v){if(!Gh(m))throw Error(n(200));if(l==null||l._reactInternals===void 0)throw Error(n(38));return Vh(l,h,m,!1,v)},nr.version="18.3.1-next-f1338f8080-20240426",nr}var jv;function uw(){if(jv)return Bp.exports;jv=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Bp.exports=iI(),Bp.exports}var Hv;function oI(){if(Hv)return Hh;Hv=1;var e=uw();return Hh.createRoot=e.createRoot,Hh.hydrateRoot=e.hydrateRoot,Hh}var aI=oI(),Ge=Nd();const Bi=JN(Ge);var lI=Object.create,gy=Object.defineProperty,uI=Object.getOwnPropertyDescriptor,dw=Object.getOwnPropertyNames,dI=Object.getPrototypeOf,hI=Object.prototype.hasOwnProperty,hw=(e,t)=>function(){return t||(0,e[dw(e)[0]])((t={exports:{}}).exports,t),t.exports},Id=(e,t)=>{for(var n in t)gy(e,n,{get:t[n],enumerable:!0})},cI=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of dw(t))hI.call(e,r)||r===n||gy(e,r,{get:()=>t[r],enumerable:!(s=uI(t,r))||s.enumerable});return e},fy=(e,t,n)=>(n=e!=null?lI(dI(e)):{},cI(e&&e.__esModule?n:gy(n,"default",{value:e,enumerable:!0}),e)),cw=hw({"node_modules/@linkurious/ogma-parsers/dist/ogma-parsers.umd.js"(e,t){var n,s;n=e,s=function(r){/**
* Ogma Parsers
* @description Parsers for Ogma
* @version 0.0.24 (built on Mon Feb 03 2025 16:36:16 GMT+0000 (Coordinated Universal Time))
* @author Alexander Milevski - Leo Nicolle - Sylvain Milan - Marco Liberati
* @license (c) Linkurious 2025. All rights reserved.
* @preserve
*/function i(ce,be,qe){qe=qe||be,be in ce&&(ce.attributes[qe]=ce[be])}function o(ce,be,qe){if(ce&&typeof ce=="object"){if(Array.isArray(ce))return ce.forEach(Ue=>o(Ue,be,qe));if(function(Ie){return Ie.type==="vertex"||Ie._type==="vertex"||Ie.inE||Ie.outE||Ie._inE||Ie._outE}(ce)){const Ue={};ce.properties&&Object.keys(ce.properties).forEach(Fe=>{Ue[Fe]=ce.properties[Fe][0].value});const Ie=u(ce);be.push({id:Ie,data:{id:ce.id+"",categories:[ce.label],properties:Ue}});for(const Fe in ce)Fe!=="properties"&&o(ce[Fe],be,qe);return}if(function(Ie){return Ie.type==="edge"||Ie._type==="edge"||Ie.inV||Ie.outV||Ie._outV||Ie._inV}(ce)){const Ue=u(ce);qe.push({id:Ue,source:a(ce,["inV","_inV"]),target:a(ce,["outV","_outV"]),data:{id:Ue,type:ce.label,properties:ce.properties||{}}});for(const Ie in ce)Ie!=="properties"&&o(ce[Ie],be,qe);return}Object.keys(ce).forEach(Ue=>o(ce[Ue],be,qe))}}function a(ce,be){for(const qe of be)if(ce[qe])return u(ce[qe])}function u(ce){if(typeof ce=="string"||isFinite(ce))return String(ce);const be=ce;return String(be.id||be._id)}const d=ce=>ce.charCodeAt(0),c=d(" "),g=d("<"),f=d(">"),p=d('"'),_=d(`
`),y=d("\r"),x=d("/"),E=d("\\"),b=d("a"),S=d("z"),A=d("A"),C=d("Z"),k=d("0"),M=d("9"),R=d(":");function O(ce,be,qe,Ue){const Ie=Ue.length;if(qe-be!==Ie)return!1;for(let Fe=0;Fe<Ie;++Fe)if(ce[be+Fe]!==Ue[Fe])return!1;return!0}function j(ce,be,qe,Ue){return z(ce.tags,be,qe,Ue)}function z(ce,be,qe,Ue){const Ie=ce.length;for(let Fe=0;Fe<Ie;++Fe)if(O(be,qe,Ue,ce[Fe]))return Fe;return ce.push(be.slice(qe,Ue)),Ie}function X(ce,be,qe){let Ue=re(be,qe),Ie=be[Ue];if(Ie===f||Ie===x)return Ue;let Fe=Ue;Ue=he(be,Ue);const Oe=function(dt,mt,ht,wt){return z(dt.attributes,mt,ht,wt)}(ce,be,Fe,Ue);for(;be[Ue]!==p;)++Ue;for(++Ue,Fe=Ue;(Ie=be[Ue])!==p;)Ie===E&&++Ue,++Ue;return ce.tokens.push(-3,Oe,Fe,Ue),Ue+1}function oe(ce){return ce===c||ce===_||ce===y}function re(ce,be){for(;oe(ce[be]);)++be;return be}function Q(ce){return ce>=b&&ce<=S||ce>=A&&ce<=C||ce===R||ce>=k&&ce<=M}function he(ce,be){for(;Q(ce[be]);)++be;return be}function fe(ce,be){const qe=Object.keys(be);let Ue;if(qe.length>0){Ue={};for(let Ie=0;Ie<qe.length;++Ie){const Fe=be[qe[Ie]],Oe=Fe.title;Ue[Oe]=Fe.default!==void 0?JSON.stringify(Fe.default):void 0}}return ce?()=>({id:void 0,attributes:{text:void 0,color:void 0,radius:void 0,x:void 0,y:void 0},data:Ue}):()=>({id:void 0,source:void 0,target:void 0,attributes:{color:void 0,text:void 0,width:void 0},data:Ue})}function ae(ce){return ce.indexOf("\\")===-1||(ce=ce.replace(/\\"/g,'"')),ce}function me(ce,be){let qe=0;for(let Ue=0;Ue<20;++Ue){const Ie=qe+ce[Ue]+be[Ue];qe=+(Ie>=10),ce[Ue]=Ie%10}}const we=new class{constructor(){this._decimalPowerOfTwo=new Uint8Array(20),this._binaryNumber=new Uint8Array(64),this._decimalNumber=new Uint8Array(20)}int64ToString({low:be,high:qe}){if(be===0&&qe===0)return"0";(function(Xe,dt,mt){for(let ht=0;ht<32;++ht)mt[ht]=+!!(Xe&1<<ht);for(let ht=0;ht<32;++ht)mt[ht+32]=+!!(dt&1<<ht);return mt})(be,qe,this._binaryNumber),this._decimalNumber.fill(0),this._decimalPowerOfTwo.fill(0),this._decimalPowerOfTwo[0]=1;const Ue=this._binaryNumber[63]===1;Ue&&function(Xe){for(let dt=0;dt<64;++dt)Xe[dt]^=1;for(let dt=0;dt<64&&!(Xe[dt]^=1);++dt);}(this._binaryNumber);for(let Oe=0;Oe<64;++Oe)this._binaryNumber[Oe]&&me(this._decimalNumber,this._decimalPowerOfTwo),me(this._decimalPowerOfTwo,this._decimalPowerOfTwo);const Ie=[];let Fe=this._decimalNumber.length-1;for(Ue&&Ie.push("-");!this._decimalNumber[Fe];)Fe-=1;for(let Oe=Fe;Oe>=0;--Oe)Ie.push(String(this._decimalNumber[Oe]));return Ie.join("")}};function Z(ce){return we.int64ToString(ce)}function _e(ce){return typeof ce=="object"&&"high"in ce&&"low"in ce}function ze(ce,be,qe,Ue){if(be)if(Array.isArray(be))be.forEach(Ie=>ze(ce,Ie,qe,Ue));else if((Ie=>"segments"in Ie)(be))(function(Fe,Oe,Xe,dt){Oe.segments.forEach(mt=>{ze(Fe,mt.start,Xe,dt),ze(Fe,mt.end,Xe,dt),ze(Fe,mt.relationship,Xe,dt)})})(ce,be,qe,Ue);else if(function(Fe){if(typeof Fe!="object"||Fe===null)throw new Error("Ogma can only retrieve nodes and relationships from Neo4j. Please make sure that your Cypher query returns nodes and edges, not values.");const Oe=Object.keys(Fe.properties);for(const Xe of Oe){const dt=Fe.properties[Xe];_e(dt)&&(Fe.properties[Xe]=Z(dt))}if(Fe.identity!==void 0){if(_e(Fe.identity)&&(Fe.identity=Z(Fe.identity)),function(dt){return"start"in dt&&"end"in dt}(Fe)){const Xe=Fe.start.identity||Fe.start,dt=Fe.end.identity||Fe.end;_e(Xe)&&(Fe.start=Z(Xe)),_e(dt)&&(Fe.end=Z(dt))}}else Fe.id&&(Fe.identity=Fe.id)}(be),(Ie=>"start"in Ie&&"end"in Ie&&"type"in Ie)(be))Ue.has(be.identity)||(Ue.add(be.identity),ce.edges.push({id:be.identity,source:be.start,target:be.end,data:{neo4jType:be.type,neo4jProperties:be.properties}}));else{const Ie=be;qe.has(Ie.identity)||(qe.add(Ie.identity),ce.nodes.push({id:Ie.identity,attributes:{},data:{neo4jLabels:Ie.labels,neo4jProperties:Ie.properties}}))}}const Re={boolean:ce=>ce.toLowerCase()==="true",int:parseFloat,long:parseFloat,float:parseFloat,double:parseFloat,string:ce=>ce};function We(ce,be,qe){const Ue=ce.getElementsByTagName("data"),Ie={};for(let Fe=0;Fe<Ue.length;Fe++){const Oe=Ue[Fe],Xe=Oe.getAttribute("key");if(Xe===null)continue;const dt=be[Xe];typeof dt>"u"?Ie[Xe]=Oe.textContent:Oe.textContent&&Oe.textContent.length!==0&&(Ie[dt.name]=dt.parse(Oe.textContent))}for(const Fe in qe)Fe in Ie||(Ie[Fe]=qe[Fe]);return Ie}function st(ce){return ce.color?ce.color:ce.r&&ce.g&&ce.b?`rgb(${ce.r}, ${ce.g}, ${ce.b})`:void 0}const ft=new Set(["x","y","size","color","r","g","b","label"]);function ut(ce){const be={};for(const qe in ce)ft.has(qe)||ce[qe]===void 0||(be[qe]=ce[qe]);return be}r.gexf=function(be){if(be.indexOf("<gexf")===-1)throw new Error("not a GEXF file");const qe=function(U){const G=new Int32Array(U.length);for(let $=0,ie=U.length;$<ie;++$)G[$]=U.charCodeAt($);return G}(be),Ue=function(U,G){let $,ie;const ue={tags:[],attributes:[],tokens:[]},te=ue.tokens;let se=re(U,G);for(;se<U.length;){let ge=U[se];if(ge===g){if(se=re(U,++se),U[se]===x)for(te.push(-2);U[++se]!==f;);else{$=se,se=he(U,$);const Ee=j(ue,U,$,se);for(te.push(-1,Ee),ge=U[se];ge!==f&&ge!==x;)se=X(ue,U,se),ge=U[se];if(ge===x)for(te.push(-2);U[++se]!==f;);}se+=1}else{for($=se;U[++se]!==g;);for(ie=se-1;oe(U[ie]);)--ie;te.push(-4,$,ie+1)}se=re(U,se)}return ue}(qe,be.indexOf("<gexf ")),Ie={},Fe={};Ue.tags.forEach((H,U)=>{const G=String.fromCharCode.apply(null,H);Ie[G]=U}),Ue.attributes.forEach((H,U)=>{const G=String.fromCharCode.apply(null,H);Fe[G]=U});const Oe=Ie.attributes,Xe=Ie.attribute,dt=Ie.node,mt=Ie.edge,ht=Ie.default,wt=Ie["viz:position"],Lt=Ie["viz:size"],Tt=Ie["viz:color"],ot=Ie.attvalue,jt=Fe.class,Nt=Fe.id,Gt=Fe.type,Wt=Fe.title,hn=Fe.label,Sn=Fe.source,Jn=Fe.target,Wn=Fe.x,Un=Fe.y,Xn=Fe.r,Gn=Fe.g,is=Fe.b,Vn=Fe.a,An=Fe.value,Yn=Fe.for,xn=Fe.weight,fn={float:1,double:1,integer:2,boolean:3,string:4,"list-string":5};let Ht=0;const vt=Ue.tokens,Pn=vt.length,Zn=new Array(16);let qt=0,cn=0,on=0,vn=!0;const wn={},Rn={};let jn,Bt,os="",q="",Y="",ne={attributes:{}},K=0,Me=0,Qe=0,at=1,tt="",ct=!1,yt=!0,Mt=null,Pt=null;const At=[],Ft=[];let Zt=0,nn={};for(;Ht<Pn;){const H=vt[Ht];if(H===-1)cn=qt,qt=vt[Ht+1],Zn[on]=qt,on+=1,qt===dt?(Mt||(Mt=fe(!0,wn)),ne=Mt(),yt=!0,nn=wn):qt===mt&&(Pt||(Pt=fe(!1,Rn)),ne=Pt(),yt=!1,nn=Rn),Ht+=2;else if(H===-2){if(os&&qt===Xe){nn=vn?wn:Rn;const U=fn[q];let G=jn;G&&(U===1?G=+G:U===2?G=0|+G:U===3?G=G==="true":U===5&&(G=G.split(" ").filter($=>$))),nn[os]={title:Y||os,default:G,type:U},os="",Y="",q="",jn=void 0}else if(qt===dt&&on===4)ct&&ne.attributes&&(ne.attributes.color=`rgba(${K}, ${Me}, ${Qe}, ${at})`,K=0,Me=0,Qe=0,at=1,ct=!1),ne.id||(ne.id=++Zt),At.push(ne);else if(qt===mt&&on===4)ne.id||(ne.id=++Zt),Ft.push(ne);else if(qt===ot&&on===6&&tt){const U=(yt?wn:Rn)[tt];if(U){if(Bt===void 0)Bt=U.default;else{const G=U.type;G&&(G===1?Bt=+Bt:G===2?Bt=0|+Bt:G===3?Bt=Bt==="true":G===5?Bt=Bt.split(" ").filter($=>$).map($=>ae($)):typeof qe=="string"&&(Bt=ae(Bt)))}ne.data[nn[tt].title]=Bt}tt="",Bt=null}on-=1,qt=cn,cn=Zn[on-2],Ht+=1}else if(H===-3){const U=vt[Ht+1],G=be.substring(vt[Ht+2],vt[Ht+3]);if(qt===Oe)U===jt&&(vn=G!=="edge"&&G!=="edges");else if(qt===Xe)U===Nt?os=G:U===Gt?q=G:U===Wt&&(Y=G);else if(qt!==dt&&qt!==mt||on!==4)if(qt===wt&&on===5){if(U===Wn)ne.attributes.x=parseFloat(G);else if(U===Un){const $=parseFloat(G);ne.attributes.y=$===0?$:-$}}else qt===Tt&&on===5?(ct=!0,U===Xn?K=parseInt(G):U===Gn?Me=parseInt(G):U===is?Qe=parseInt(G):U===Vn&&(at=parseFloat(G))):qt===Lt&&on===5?U===An&&(yt?ne.attributes.radius=+G:ne.attributes.width=+G):qt===ot&&on===6&&(U===Yn||U===Nt?tt=G:U===An&&(Bt=G));else U===Nt?ne.id=G:U===hn?ne.attributes.text=G:U===Sn?ne.source=G:U===Jn?ne.target=G:U===xn&&(ne.attributes.width=+G);Ht+=4}else{if(H!==-4)throw new Error(`at index ${Ht}: token ${H}`);{const U=be.substring(vt[Ht+1],vt[Ht+2]);qt===ht&&(jn=U),Ht+=3}}}return{nodes:At,edges:Ft}},r.graphml=function(be,qe){if(!qe){if(typeof DOMParser>"u")throw new Error("DOMParser is not available. You need to provide a DOMParser instance as second argument, if you are not in the browser environment");qe=new DOMParser}const Ue=qe.parseFromString(be,"application/xml"),Ie=Ue.getElementsByTagName("key"),Fe=Ue.getElementsByTagName("node"),Oe=Ue.getElementsByTagName("edge"),{definitions:Xe,defaults:dt}=function(Tt){const ot={graph:{},node:{},edge:{}},jt={graph:{},node:{},edge:{}};for(let Nt=0;Nt<Tt.length;Nt++){const Gt=Tt[Nt],Wt=Gt.getAttribute("for")||"node",hn=Gt.getAttribute("id"),Sn=Gt.getAttribute("attr.name"),Jn=Gt.getAttribute("attr.type")||"string",Wn=Gt.getElementsByTagName("default"),Un=Wn.length!==0?Wn[0].textContent:void 0;ot[Wt][hn]={name:Sn,parse:Re[Jn]},typeof Un<"u"&&(jt[Wt][Sn]=Un)}return{definitions:ot,defaults:jt}}(Ie),mt=[],ht=new Set;for(let Lt=0;Lt<Fe.length;Lt++){const Tt=Fe[Lt],ot=Tt.getAttribute("id"),jt=Tt.getAttribute("href")||void 0,Nt=We(Tt,Xe.node,dt.node);ht.add(ot);const Gt={id:ot,attributes:{x:Nt.x,y:Nt.y,radius:Nt.size,color:st(Nt),text:Nt.label},data:ut(Nt)};Nt.x!==void 0&&(Gt.attributes.x=Nt.x),Nt.y!==void 0&&(Gt.attributes.y=Nt.y),Nt.size!==void 0&&(Gt.attributes.radius=Nt.size),Nt.label!==void 0&&(Gt.attributes.text=Nt.label);const Wt=st(Nt);Wt!==void 0&&(Gt.attributes.color=Wt),jt!==void 0&&(Gt.data.href=jt),mt.push(Gt)}const wt=[];for(let Lt=0;Lt<Oe.length;Lt++){const Tt=Oe[Lt],ot=Tt.getAttribute("id")||Lt,jt=Tt.getAttribute("source"),Nt=Tt.getAttribute("target"),Gt=Tt.getAttribute("xlink:href")||void 0;if(!ht.has(jt)||!ht.has(Nt))throw new Error(`Invalid edge: ${jt} -> ${Nt}`);const Wt=We(Tt,Xe.edge,dt.edge),hn={id:ot,source:jt,target:Nt,attributes:{},data:ut(Wt)},Sn=st(Wt);Sn!==void 0&&(hn.attributes.color=Sn),Gt!==void 0&&(hn.data.href=Gt),wt.push(hn)}return{nodes:mt,edges:wt}},r.janus=function(be){const qe=[],Ue=[];return o(typeof be=="string"?JSON.parse(be):be,qe,Ue),{nodes:qe,edges:Ue}},r.json=function(be,qe=Ue=>Ue){const Ue=qe(JSON.parse(be)),Ie=Ue.nodes||[],Fe=Ue.edges||[];for(let Oe=0;Oe<Ie.length;Oe++){const Xe=Ie[Oe];Xe.attributes||(Xe.attributes={}),typeof Xe.size=="string"&&(Xe.size=+Xe.size),typeof Xe.x=="string"&&(Xe.x=+Xe.x),typeof Xe.y=="string"&&(Xe.y=+Xe.y),i(Xe,"x"),i(Xe,"y"),i(Xe,"size","radius"),i(Xe,"color"),i(Xe,"text")}for(let Oe=0;Oe<Fe.length;Oe++){const Xe=Fe[Oe];Xe.attributes||(Xe.attributes={}),typeof Xe.size=="string"&&(Xe.size=+Xe.size),i(Xe,"size","width"),i(Xe,"color"),i(Xe,"text")}return{nodes:Ie,edges:Fe}},r.mtx=ce=>{const be=ce.split(`
`).filter(Ie=>!Ie.startsWith("%")),[qe]=be[0].split(" ").map(Number),Ue=be.slice(1).map(Ie=>Ie.split(" ").slice(0,2).map(Number)).filter(Ie=>Ie.length===2);return{nodes:Array.from({length:Number(qe)},(Ie,Fe)=>({id:Fe})),edges:Ue.map(([Ie,Fe])=>({source:Ie%qe,target:Fe%qe}))}},r.neo4j=function(be){let qe=typeof be=="string"?JSON.parse(be):be;const Ue={nodes:[],edges:[]},Ie=new Set,Fe=new Set;return(Oe=>"queryKeys"in Oe&&"values"in Oe)(qe)&&(qe=function(Xe){const dt=[];return Xe.values.forEach(mt=>{const{nodes:ht=[],relationships:wt=[],segments:Lt=[]}=mt.adapted,Tt=[{segments:Lt,properties:{}}];dt.push({_fields:[...ht,...wt,...Tt]})}),{records:dt}}(qe)),qe.records.forEach(({_fields:Oe})=>Oe.forEach(Xe=>ze(Ue,Xe,Ie,Fe))),Ue},Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})},typeof e=="object"&&typeof t<"u"?s(e):typeof define=="function"&&define.amd?define(["exports"],s):s((n=typeof globalThis<"u"?globalThis:n||self).ogmaParsers={})}}),gI=hw({"node_modules/@linkurious/ogma-generators/dist/ogma-generators.umd.js"(e,t){var n,s;n=e,s=function(r){/**
* Ogma Generators
* @description Graphs Generators for Ogma
* @version 0.0.13 (built on Tue Nov 14 2023 10:49:46 GMT+0000 (Coordinated Universal Time))
* @author Alexander Milevski - Leo Nicolle - Sylvain Milan - Marco Liberati
* @license (c) Linkurious 2023. All rights reserved.
* @preserve
*/const i=Object.freeze(Object.defineProperty({__proto__:null,configure:({nodes:E=10,edges:b=10,texts:S=!1,scale:A=100}={})=>({nodes:E,edges:b,texts:S,scale:A}),generate:function({nodes:b,scale:S,texts:A,edges:C}){const k=[],M=[];for(let R=0;R<b;R++)k.push({id:R,attributes:{x:Math.random()*S,y:Math.random()*S,text:A?`Node ${R}`:void 0}});for(let R=0;R<C;R++)M.push({id:R,source:Math.random()*b|0,target:Math.random()*b|0,attributes:{text:A?`Edge ${R}`:void 0}});return{nodes:k,edges:M}}},Symbol.toStringTag,{value:"Module"})),o=Object.freeze(Object.defineProperty({__proto__:null,configure:({rows:E=4,columns:b=4,columnDistance:S=20,rowDistance:A=20,xmin:C=0,ymin:k=0}={})=>({rows:E,columns:b,columnDistance:S,rowDistance:A,xmin:C,ymin:k}),generate:function({rows:b,columns:S,columnDistance:A,rowDistance:C,xmin:k,ymin:M}){const R={nodes:[],edges:[]};let O=0;for(let j=0;j<b;++j)for(let z=0;z<S;++z){const X=j*S+z;R.nodes.push({id:X,attributes:{x:k+z*A,y:M+j*C}}),z!==S-1&&(R.edges.push({id:O,source:X,target:j*S+z+1}),O++),j!==b-1&&(R.edges.push({id:O,source:X,target:(j+1)*S+z}),O++)}return R}},Symbol.toStringTag,{value:"Module"})),a=Object.freeze(Object.defineProperty({__proto__:null,configure:({length:E=5,scale:b=100}={})=>({length:E,scale:b}),generate:function({length:b,scale:S}){const A={nodes:[],edges:[]};if(b<=0)return A;A.nodes.push({id:0,attributes:{x:Math.random()*S,y:Math.random()*S}});for(let C=1;C<b;++C)A.nodes.push({id:C,attributes:{x:Math.random()*S,y:Math.random()*S}}),A.edges.push({id:C-1,source:C-1,target:C});return A}},Symbol.toStringTag,{value:"Module"}));function u(E){return typeof E=="number"&&isFinite(E)?E:void 0}const d=Object.freeze(Object.defineProperty({__proto__:null,configure:function({children:b=2,height:S=3}={}){if(!function(C){return typeof C=="number"&&isFinite(C)&&C>0?C:void 0}(b))throw new TypeError('Invalid argument: "children" is not a positive number, was '+b);if(!function(C){return typeof C=="number"&&isFinite(C)&&C>=0?C:void 0}(S))throw new TypeError('Invalid argument: "height" is not a positive number, was '+S);return{children:b,height:S}},generate:function({children:b,height:S}){S+=1;const A=Math.pow(b,S),C=[],k=[];let M=1,R=0,O=0;for(let j=0;j<S;++j){const z=A/(M+1)/1.5;for(let X=0;X<M;++X){const oe=R++;if(C.push({id:oe,attributes:{x:(X+1)*z*10,y:20*j}}),j!==S-1)for(let re=0;re<b;++re)k.push({id:O,source:oe,target:oe*b+re+1}),O+=1}M*=b}return{nodes:C,edges:k}}},Symbol.toStringTag,{value:"Module"})),c=Object.freeze(Object.defineProperty({__proto__:null,configure:function({nodes:b=20,edges:S,p:A,scale:C=100}={}){if(!u(b)||b<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+b);if(S!==void 0&&A!==void 0)throw new TypeError("Invalid argument: choose between options.edges and options.p");return S===void 0&&A===void 0&&(A=.1),A===void 0&&(A=-1),S===void 0&&(S=-1),{nodes:b,p:A,edges:S,scale:C}},generate:function(b){const S={nodes:[],edges:[]},A=b.nodes,C=b.p,k=b.scale;if(C>=0){let M=0;for(let R=0;R<A;R++){S.nodes.push({id:R,attributes:{x:Math.random()*k,y:Math.random()*k}});for(let O=0;O<R;O++)Math.random()<C&&S.edges.push({id:M++,source:R,target:O})}}else{const M=[],R=b.edges;for(let j=0;j<A;j++){S.nodes.push({id:j,attributes:{x:100*Math.random(),y:100*Math.random()}});for(let z=j+1;z<A;z++)M.push({source:j,target:z})}let O=M.length-1;for(let j=0;j<R;j++){const z=M.splice(Math.floor(Math.random()*O),1)[0];z.id=j,S.edges.push(z),O--}}return S}},Symbol.toStringTag,{value:"Module"})),g=Object.freeze(Object.defineProperty({__proto__:null,configure:function({nodes:b=40,m0:S=5,m:A=1,scale:C=100}={}){if(!u(b)||b<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+b);if(!u(S)||S>=b)throw new TypeError(`Invalid argument: options.m0 is not a number < ${b}, was ${S}`);if(!u(S)||A>=S)throw new TypeError(`Invalid argument: options.m is not a number <= ${S}, was ${A}`);if(!u(C)||C<0)throw new TypeError("Invalid argument: options.scale is not a number or is less than 0");return{nodes:b,m0:S,m:A,scale:C}},generate:function({scale:b,nodes:S,m0:A,m:C}){const k={nodes:[],edges:[]},M={},R=[],O=b/10;let j=0;for(let z=0;z<A;z++)k.nodes.push({id:z,attributes:{x:Math.random()*O,y:Math.random()*O}}),R[z]=0;for(let z=0;z<A;z++)for(let X=z+1;X<A;X++){const oe={id:j++,source:z,target:X};M[oe.source+"-"+oe.target]=oe,k.edges.push(oe),R[z]++,R[X]++}for(let z=A;z<S;z++){k.nodes.push({id:z,attributes:{x:Math.random()*b,y:Math.random()*b}}),R[z]=0;let X=0;for(let re=0;re<z;re++)X+=R[re];let oe=0;for(let re=0;re<C;re++){const Q=Math.random();let he=0;for(let fe=0;fe<z;fe++)if(!M[`${z}-${fe}`]&&!M[`${fe}-${z}`]&&(he=z===1?1:he+R[fe]/X+oe/(z-re),Q<=he)){oe+=R[fe]/X;const ae={id:j++,source:z,target:fe};M[`${ae.source}-${ae.target}`]=ae,k.edges.push(ae),R[z]++,R[fe]++;break}}}return k}},Symbol.toStringTag,{value:"Module"})),f=Object.freeze(Object.defineProperty({__proto__:null,configure:function({nodes:b=50,width:S=100,height:A=100,x:C=0,y:k=0}={}){if(!isFinite(b)||b<1)throw new RangeError("Tree generator: number of nodes must be a positive integer");return{nodes:b,width:S,height:A,x:C,y:k}},generate:function({nodes:b,x:S,y:A,width:C,height:k}){const M=S-C/2,R=A-k/2;return{nodes:new Array(b).fill(0).map((O,j)=>({id:j,attributes:{x:M+Math.random()*C,y:R+Math.random()*k}})),edges:new Array(b-1).fill(0).map((O,j)=>({id:j,source:Math.floor(Math.sqrt(j)),target:j+1}))}}},Symbol.toStringTag,{value:"Module"}));function p(E){return 10*Math.pow(2.7,E)}function _(E){return 5+p(E)/10}function y(E,b,S,A,C){if(S===0)return C;const k=p(S),M=_(S),R=.2*M;let O=-Math.PI;const j=2*Math.PI/b,z=A.attributes.x||0,X=A.attributes.y||0;for(let oe=0;oe<b;++oe){const re={id:C,attributes:{x:z+k*Math.cos(O),y:X+k*Math.sin(O),radius:M}},Q={id:C,source:A.id,target:C,attributes:{width:R}};E.nodes.push(re),E.edges.push(Q),C=y(E,b,S-1,re,C+1),O+=j}return C}const x=Object.freeze(Object.defineProperty({__proto__:null,configure:function({depth:b=3,breadth:S=3,nodes:A}){return A!==void 0?(S=5,b=Math.ceil(Math.log(A)/Math.log(5))):A=-1,{depth:b,breadth:S,nodes:A}},generate:function({depth:b,breadth:S,nodes:A}){const C={id:0,attributes:{x:0,y:0,radius:_(b+1)}},k={nodes:[C],edges:[]};return y(k,S,b,C,1),A!==void 0&&A>=0&&(k.nodes=k.nodes.slice(0,A),k.edges=k.edges.slice(0,Math.max(A-1,0))),k}},Symbol.toStringTag,{value:"Module"}));r.balancedTree=d,r.barabasiAlbert=g,r.erdosRenyi=c,r.flower=x,r.grid=o,r.path=a,r.random=i,r.randomTree=f,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})},typeof e=="object"&&typeof t<"u"?s(e):typeof define=="function"&&define.amd?define(["exports"],s):s((n=typeof globalThis<"u"?globalThis:n||self).ogmaGenerators={})}}),En=class{constructor(e){this._ogma=e}};function Gu(e,t){for(let n=1,s=e.length;n<s;n++){const r=e[n];let i=n;for(;i>0&&t.get(e[i-1])>t.get(r);)e[i]=e[i-1],--i;e[i]=r}return e}function fI(e,t){for(let n=1,s=e.length;n<s;n++){const r=e[n];let i=n;for(;i>0&&t.get(e[i-1])<t.get(r);)e[i]=e[i-1],--i;e[i]=r}return e}function bs(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function jm(e){return Array.isArray(e)?e:[e]}function gw(e){const t=[];for(let n=0;n<e.length;++n){const s=e[n];if(Array.isArray(s))for(let r=0;r<s.length;++r)t.push(s[r]);else t.push(s)}return t}function pI(...e){if(e.length===0)return[];const t=e[0].constructor;let n=0;for(const i of e)n+=i.length;const s=new t(n);let r=0;for(const i of e){for(let o=0;o<i.length;o++)s[r+o]=i[o];r+=i.length}return s}function mI(e,t){const n=e.indexOf(t);return n!==-1&&(e.splice(n,1),!0)}function fw(e,t){let n,s,r=0,i=e.length-1;for(;r<=i;)if(n=(r+i)/2|0,s=e[n],s<t)r=n+1;else{if(!(s>t))return n;i=n-1}return-1}var hd=(e,t)=>{const n=new Array(e.length);for(let s=0;s<e.length;s++)n[s]=t[e[s]];return n};function _I(e){return typeof e=="number"&&e%1==0}function Hm(e){return Array.isArray(e)?e.join("."):e}function ba(e){if(!e)return[];if(typeof e=="string")return e.split(".");if(Array.isArray(e)){for(let t=0;t<e.length;++t)if(typeof e[t]!="string")throw new TypeError(`${e[t]} is not a string`);return e.slice()}throw new TypeError(`invalid property path "${e}": expected string or array of strings`)}function Ug(e,t,n){let s,r,i;if(t===0)return function(){e.apply(n,arguments)};const o=function(){s=!1,r&&(i.apply(n,r),r=null)};return i=function(){let a;return s?r=arguments:(a=e.apply(n,arguments),setTimeout(o,t),s=!0),a},i}function yI(e,t,n){let s,r,i,o,a;const u=t===0||t===void 0?100:t;function d(){const g=Date.now()-o;g<u&&g>=0?s=setTimeout(d,u-g):(s=null,n||(a=e.apply(i,r),i=r=null))}const c=function(){i=this,r=arguments,o=Date.now();const g=n&&!s;return s||(s=setTimeout(d,t)),g&&(a=e.apply(i,r),i=r=null),a};return c.clear=function(){s&&(clearTimeout(s),s=null)},c.flush=function(){s&&(a=e.apply(i,r),i=r=null,clearTimeout(s),s=null)},c}function pw(e,t,n,s,r){n(e[t],t,e,s,r).then(i=>{t===e.length-1?s(i):pw(e,t+1,n,s,r)}).catch(r)}function xI(e,t){return new Promise((n,s)=>pw(e,0,t,n,s))}function Gg(){return new Uint8Array(new Uint32Array([305419896]).buffer)[0]===120}function mw(e){return e.reduce((t,n)=>t.then(n),Promise.resolve())}function qm(e,t,n,s,r,i,o,a){return e+r+256*(t+i)+65536*(n+o)+16777216*(s+a)}function vI(e,t){return e<t?e*t+Math.pow(t-e-1,2)/4:e*t+Math.pow(e-t-1,2)/4}function Ea(e){return!(e===null||typeof e!="object"||bs(e)||e instanceof RegExp||typeof HTMLElement<"u"&&e instanceof HTMLElement)}function td(e){const t=Object.keys(e),n=new Array(t.length);for(let s=0;s<t.length;++s)n[s]=e[t[s]];return n}function ci(e,t,n){if(Array.isArray(e))return e.forEach(t,n);if(!Ea(e))throw new Error("forEach: invalid argument "+JSON.stringify(e));const s=Object.keys(e);if(n!==void 0)for(let r=0;r<s.length;++r){const i=s[r];t.call(n,e[i],i)}else for(let r=0;r<s.length;++r){const i=s[r];t(e[i],i)}}function Bn(e){if(Array.isArray(e)){const s=new Array(e.length);for(let r=0;r<e.length;++r)s[r]=Bn(e[r]);return s}if(!rs(e))return e;const t={},n=Object.keys(e);for(const s of n)t[s]=Bn(e[s]);return t}function bI(e,t){t.forEach(n=>{e.indexOf(n)===-1&&e.push(n)})}function Ui(e,t,n){const s=typeof t=="string"?t.split("."):t;for(let r=0;r<s.length-1;++r){const i=s[r];let o=e[i];o||(o={},e[i]=o),e=o}e[s[s.length-1]]=n}function On(e,t){const n=ba(t);if(!n.length)return e;if(e){for(let s=0;s<n.length-1;++s){const r=e[n[s]];if(!r)return;e=r}return e[n[n.length-1]]}}function cd(e,t,n="."){t||(t=i=>!Ea(i));const s={},r=Object.keys(e);for(let i=0;i<r.length;++i){const o=r[i],a=e[o];if(t(a))s[o]=a;else{const u=cd(a,t),d=Object.keys(u);for(let c=0;c<d.length;c++){const g=d[c];s[`${o}${n}${g}`]=u[g]}}}return s}function $m(e){const t={},n=Object.keys(e);for(let s=0;s<n.length;++s){const r=n[s];Ui(t,r,e[r])}return t}function Sa(e,t,n=[]){const s=Object.keys(e);for(let r=0;r<s.length;++r){const i=s[r],o=e[i],a=t?t+i:i;rs(o)?Sa(o,a+".",n):n.push(a)}return n}var _w=Object.prototype.hasOwnProperty;function yw(e,t){const n=[e];let s;for(;n.length>0;)if(s=n.pop(),s)if(rs(s))for(const r in s)_w.call(s,r)&&n.push(s[r]);else t(s)}function EI(e){const t={};return yw(e,n=>t[n.getName()]=n),t}function Vg(e,t=[]){if(rs(e)){const n=Object.keys(e);for(const s of n)Vg(e[s],t)}else t.push(e);return t}function jg(e){for(const t in e)typeof e[t]=="function"&&delete e[t];return e}function pr(e,t){if(e===void 0)return Bn(t);if(!Ea(e))return e;const n={},s=Object.keys(t);for(const r of s){const i=t[r],o=e[r];Ea(i)?n[r]=pr(o,i):n[r]=o===void 0?Bn(i):o}return n}function rs(e){return e&&(e.constructor===Object||!e.constructor)}function tg(e,t){if(!rs(t)||!rs(e))return t;const n=Object.assign({},e),s=Object.keys(t);for(const r of s)n[r]=tg(n[r],t[r]);return n}function Wm(e,t){return t==null?e:t.reduce((n,s)=>(n[s]=e[s],n),{})}var fl=(...e)=>{const t={};for(let n=0;n<e.length;n++){const s=e[n];for(const r in s)_w.call(s,r)&&(Array.isArray(t[r])&&Array.isArray(s[r])?t[r]=Array.from(new Set(t[r].concat(s[r]))):rs(t[r])&&rs(s[r])?t[r]=fl(t[r],s[r]):t[r]=s[r])}return t},SI=typeof global=="object"&&global!==null&&global.it!==void 0,qi=typeof document<"u",ko=typeof window<"u",Hg=ko&&!window.__OGMA_HEADLESS,qg=Hg&&qi,AI=typeof navigator<"u"&&navigator.userAgent!==void 0?navigator.userAgent.toLowerCase():"",wI=ko&&/mac/.test(AI),xw=typeof performance<"u"&&performance.now?()=>0|performance.now():()=>Date.now(),TI=xw();function Rs(){return xw()-TI}function vw(){const e=new Date,t=e.getDate(),n=e.getMonth()+1;return`${e.getFullYear()}-${n<10?"0"+n:n}-${t<10?"0"+t:t}`}function bw(){const e=new Date;return`[${qh((e.getUTCHours()-(e.getTimezoneOffset()/60|0))%24)}:${qh(e.getUTCMinutes())}:${qh(e.getUTCSeconds())}:${qh(e.getUTCMilliseconds(),3)}]`}function qh(e,t=2){let n=Math.pow(10,t-1),s=String(e);for(;n>1;)e<n&&(s="0"+s),n/=10;return s}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var kd={};function $g(e){if(e!==kd)throw new Error("Bad secret")}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function CI(e,t){if(!NI(e)||t+1!==e.length)throw new TypeError(`
    ############################## ERROR ##############################

    It looks like you are trying to call a template tag function (fn\`...\`)
    using the normal function syntax (fn(...)), which is not supported.

    The functions in the safevalues library are not designed to be called
    like normal functions, and doing so invalidates the security guarantees
    that safevalues provides.

    If you are stuck and not sure how to proceed, please reach out to us
    instead through:
     - https://github.com/google/safevalues/issues

    ############################## ERROR ##############################`)}function Vu(e){return Object.isFrozen(e)&&Object.isFrozen(e.raw)}function $h(e){return e.toString().indexOf("`")===-1}var qv=$h(e=>e``)||$h(e=>e`\0`)||$h(e=>e`\n`)||$h(e=>e`\u0000`),LI=Vu``&&Vu`\0`&&Vu`\n`&&Vu`\u0000`;function NI(e){return!(!Array.isArray(e)||!Array.isArray(e.raw))&&e.length===e.raw.length&&!(!qv&&e===e.raw)&&!!(qv&&!LI||Vu(e))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Vp,II="google#safe",kI=II,MI=globalThis.trustedTypes,$v=MI;function PI(){let e=null;if(!$v)return e;try{const t=n=>n;e=$v.createPolicy(kI,{createHTML:t,createScript:t,createScriptURL:t})}catch(t){throw t}return e}function py(){return Vp===void 0&&(Vp=PI()),Vp}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wh(e){return{valueOf:e}.valueOf()}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ew=class{constructor(e,t){$g(e),this.privateDoNotAccessOrElseWrappedHtml=t}toString(){return this.privateDoNotAccessOrElseWrappedHtml+""}},RI=Ew;function FI(e){return new RI(kd,e)}function Sw(e){const t=e,n=py();return FI(n?n.createHTML(t):t)}function DI(e){return e instanceof Ew}function my(e){if(DI(e))return e.privateDoNotAccessOrElseWrappedHtml;{let t="";throw t="Unexpected type when unwrapping SafeHtml",new Error(t)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Aw=class{constructor(e,t){$g(e),this.privateDoNotAccessOrElseWrappedResourceUrl=t}toString(){return this.privateDoNotAccessOrElseWrappedResourceUrl+""}},OI=Aw;function zI(e){return new OI(kd,e)}function BI(e){const t=e,n=py();return zI(n?n.createScriptURL(t):t)}function UI(e){return e instanceof Aw}function jl(e){if(UI(e))return e.privateDoNotAccessOrElseWrappedResourceUrl;{let t="";throw t="Unexpected type when unwrapping TrustedResourceUrl",new Error(t)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ng,Wv,ww=class{constructor(e,t){$g(e),this.privateDoNotAccessOrElseWrappedScript=t}toString(){return this.privateDoNotAccessOrElseWrappedScript+""}},GI=ww;function VI(e){return new GI(kd,e)}function _y(e){const t=e,n=py();return VI(n?n.createScript(t):t)}function jI(e){return e instanceof ww}function Tw(e){if(jI(e))return e.privateDoNotAccessOrElseWrappedScript;{let t="";throw t="Unexpected type when unwrapping SafeScript",new Error(t)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HI(e,t){t.appendChild(e);let n=new XMLSerializer().serializeToString(t);return n=n.slice(n.indexOf(">")+1,n.lastIndexOf("</")),Sw(n)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Xv(e){try{return new URL(e,window.document.baseURI)}catch{return new URL("about:invalid")}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qI(e){let t;try{t=new URL(e)}catch{return"https:"}return t.protocol}(function(e){e[e.STYLE_ELEMENT=0]="STYLE_ELEMENT",e[e.STYLE_ATTRIBUTE=1]="STYLE_ATTRIBUTE",e[e.HTML_ATTRIBUTE=2]="HTML_ATTRIBUTE"})(ng||(ng={})),function(e){e[e.AT_KEYWORD=0]="AT_KEYWORD",e[e.CDC=1]="CDC",e[e.CDO=2]="CDO",e[e.CLOSE_CURLY=3]="CLOSE_CURLY",e[e.CLOSE_PAREN=4]="CLOSE_PAREN",e[e.CLOSE_SQUARE=5]="CLOSE_SQUARE",e[e.COLON=6]="COLON",e[e.COMMA=7]="COMMA",e[e.DELIM=8]="DELIM",e[e.DIMENSION=9]="DIMENSION",e[e.EOF=10]="EOF",e[e.FUNCTION=11]="FUNCTION",e[e.HASH=12]="HASH",e[e.IDENT=13]="IDENT",e[e.NUMBER=14]="NUMBER",e[e.OPEN_CURLY=15]="OPEN_CURLY",e[e.OPEN_PAREN=16]="OPEN_PAREN",e[e.OPEN_SQUARE=17]="OPEN_SQUARE",e[e.PERCENTAGE=18]="PERCENTAGE",e[e.SEMICOLON=19]="SEMICOLON",e[e.STRING=20]="STRING",e[e.WHITESPACE=21]="WHITESPACE"}(Wv||(Wv={}));var $I=["data:","http:","https:","mailto:","ftp:"],WI=/^\s*(?!javascript:)(?:[\w+.-]+:|[^:/?#]*(?:[/?#]|$))/i;function XI(e){const t=!WI.test(e);return t&&console.error(`A URL with content '${e}' was sanitized away.`),t}function YI(e){if(!XI(e))return e}function Md(e){return YI(e)}function ZI(e){const t=qI(e);return t!==void 0&&$I.indexOf(t.toLowerCase())!==-1?e:"about:invalid#zClosurez"}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var KI="display:inline-block;clip-path:inset(0);overflow:hidden;vertical-align:top;text-decoration:inherit",QI=`:host{${KI}}`;/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JI(e,t){return e.createContextualFragment(my(t))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ek(e,t){if(t.defaultView)throw new Error("createInertFragment called with non-inert document");const n=t.createRange();return n.selectNode(t.body),JI(n,Sw(e))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Yv(e){const t=e.nodeName;return typeof t=="string"?t:"FORM"}function Zv(e){return e.nodeType===3}function Kv(e){const t=e.nodeType;return t===1||typeof t!="number"}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var yn,ai=class{constructor(e,t,n,s,r){this.allowedElements=e,this.elementPolicies=t,this.allowedGlobalAttributes=n,this.globalAttributePolicies=s,this.globallyAllowedAttributePrefixes=r}isAllowedElement(e){return e!=="FORM"&&(this.allowedElements.has(e)||this.elementPolicies.has(e))}getAttributePolicy(e,t){const n=this.elementPolicies.get(t);return n!=null&&n.has(e)?n.get(e):this.allowedGlobalAttributes.has(e)?{policyAction:yn.KEEP}:this.globalAttributePolicies.get(e)||(this.globallyAllowedAttributePrefixes&&[...this.globallyAllowedAttributePrefixes].some(r=>e.indexOf(r)===0)?{policyAction:yn.KEEP}:{policyAction:yn.DROP})}};(function(e){e[e.DROP=0]="DROP",e[e.KEEP=1]="KEEP",e[e.KEEP_AND_SANITIZE_URL=2]="KEEP_AND_SANITIZE_URL",e[e.KEEP_AND_NORMALIZE=3]="KEEP_AND_NORMALIZE",e[e.KEEP_AND_SANITIZE_STYLE=4]="KEEP_AND_SANITIZE_STYLE",e[e.KEEP_AND_USE_RESOURCE_URL_POLICY=5]="KEEP_AND_USE_RESOURCE_URL_POLICY",e[e.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET=6]="KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET"})(yn||(yn={}));var tk=new Set(["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"]);function nk(e){return!tk.has(e.toUpperCase())&&/^[a-z][-_.a-z0-9]*-[-_.a-z0-9]*$/i.test(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var sk=["ARTICLE","SECTION","NAV","ASIDE","H1","H2","H3","H4","H5","H6","HEADER","FOOTER","ADDRESS","P","HR","PRE","BLOCKQUOTE","OL","UL","LH","LI","DL","DT","DD","FIGURE","FIGCAPTION","MAIN","DIV","EM","STRONG","SMALL","S","CITE","Q","DFN","ABBR","RUBY","RB","RT","RTC","RP","DATA","TIME","CODE","VAR","SAMP","KBD","SUB","SUP","I","B","U","MARK","BDI","BDO","SPAN","BR","WBR","NOBR","INS","DEL","PICTURE","PARAM","TRACK","MAP","TABLE","CAPTION","COLGROUP","COL","TBODY","THEAD","TFOOT","TR","TD","TH","SELECT","DATALIST","OPTGROUP","OPTION","OUTPUT","PROGRESS","METER","FIELDSET","LEGEND","DETAILS","SUMMARY","MENU","DIALOG","SLOT","CANVAS","FONT","CENTER","ACRONYM","BASEFONT","BIG","DIR","HGROUP","STRIKE","TT"],rk=[["A",new Map([["href",{policyAction:yn.KEEP_AND_SANITIZE_URL}]])],["AREA",new Map([["href",{policyAction:yn.KEEP_AND_SANITIZE_URL}]])],["LINK",new Map([["href",{policyAction:yn.KEEP_AND_USE_RESOURCE_URL_POLICY,conditions:new Map([["rel",new Set(["alternate","author","bookmark","canonical","cite","help","icon","license","next","prefetch","dns-prefetch","prerender","preconnect","preload","prev","search","subresource"])]])}]])],["SOURCE",new Map([["src",{policyAction:yn.KEEP_AND_USE_RESOURCE_URL_POLICY}],["srcset",{policyAction:yn.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET}]])],["IMG",new Map([["src",{policyAction:yn.KEEP_AND_USE_RESOURCE_URL_POLICY}],["srcset",{policyAction:yn.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET}]])],["VIDEO",new Map([["src",{policyAction:yn.KEEP_AND_USE_RESOURCE_URL_POLICY}]])],["AUDIO",new Map([["src",{policyAction:yn.KEEP_AND_USE_RESOURCE_URL_POLICY}]])]],ik=["title","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-current","aria-disabled","aria-dropeffect","aria-expanded","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","alt","align","autocapitalize","autocomplete","autocorrect","autofocus","autoplay","bgcolor","border","cellpadding","cellspacing","checked","cite","color","cols","colspan","controls","controlslist","datetime","disabled","download","draggable","enctype","face","formenctype","frameborder","height","hreflang","hidden","ismap","label","lang","loop","max","maxlength","media","minlength","min","multiple","muted","nonce","open","placeholder","poster","preload","rel","required","reversed","role","rows","rowspan","selected","shape","size","sizes","slot","span","spellcheck","start","step","summary","translate","type","valign","value","width","wrap","itemscope","itemtype","itemid","itemprop","itemref"],ok=[["dir",{policyAction:yn.KEEP_AND_NORMALIZE,conditions:Wh(()=>new Map([["dir",new Set(["auto","ltr","rtl"])]]))}],["async",{policyAction:yn.KEEP_AND_NORMALIZE,conditions:Wh(()=>new Map([["async",new Set(["async"])]]))}],["loading",{policyAction:yn.KEEP_AND_NORMALIZE,conditions:Wh(()=>new Map([["loading",new Set(["eager","lazy"])]]))}],["target",{policyAction:yn.KEEP_AND_NORMALIZE,conditions:Wh(()=>new Map([["target",new Set(["_self","_blank"])]]))}]],ak=new ai(new Set(sk),new Map(rk),new Set(ik),new Map(ok),void 0),lk=class{constructor(e,t,n,s,r,i){this.sanitizerTable=e,this.styleElementSanitizer=n,this.styleAttributeSanitizer=s,this.resourceUrlPolicy=r,this.openShadow=i,this.changes=[],$g(t)}sanitizeAssertUnchanged(e){this.changes=[];const t=this.sanitize(e);if(this.changes.length!==0)throw new Error(`Unexpected change to HTML value as a result of sanitization. Input: "${e}", sanitized output: "${t}"
List of changes:${this.changes.join(`
`)}`);return t}sanitize(e){const t=document.implementation.createHTMLDocument("");return HI(this.sanitizeToFragmentInternal(e,t),t.body)}sanitizeToFragment(e){const t=document.implementation.createHTMLDocument("");return this.styleElementSanitizer&&this.styleAttributeSanitizer?this.sanitizeWithCssToFragment(e,t):this.sanitizeToFragmentInternal(e,t)}sanitizeWithCssToFragment(e,t){const n=document.createElement("safevalues-with-css"),s=this.openShadow?"open":"closed",r=n.attachShadow({mode:s}),i=this.sanitizeToFragmentInternal(e,t),o=document.createElement("style");o.textContent=QI,o.id="safevalues-internal-style",r.appendChild(o),r.appendChild(i);const a=t.createDocumentFragment();return a.appendChild(n),a}sanitizeToFragmentInternal(e,t){const n=ek(e,t),s=document.createTreeWalker(n,5,a=>this.nodeFilter(a));let r=s.nextNode();const i=t.createDocumentFragment();let o=i;for(;r!==null;){let a;if(Zv(r))if(this.styleElementSanitizer&&o.nodeName==="STYLE"){const u=this.styleElementSanitizer(r.data);a=this.createTextNode(u)}else a=this.sanitizeTextNode(r);else{if(!Kv(r)){let u="";throw u="Node is not of type text or element",new Error(u)}a=this.sanitizeElementNode(r,t)}if(o.appendChild(a),r=s.firstChild(),r)o=a;else for(;!(r=s.nextSibling())&&(r=s.parentNode());)o=o.parentNode}return i}createTextNode(e){return document.createTextNode(e)}sanitizeTextNode(e){return this.createTextNode(e.data)}sanitizeElementNode(e,t){const n=Yv(e),s=t.createElement(n),r=e.attributes;for(const{name:i,value:o}of r){const a=this.sanitizerTable.getAttributePolicy(i,n);if(this.satisfiesAllConditions(a.conditions,r))switch(a.policyAction){case yn.KEEP:Li(s,i,o);break;case yn.KEEP_AND_SANITIZE_URL:const u=ZI(o);u!==o&&this.recordChange(`Url in attribute ${i} was modified during sanitization. Original url:"${o}" was sanitized to: "${u}"`),Li(s,i,u);break;case yn.KEEP_AND_NORMALIZE:Li(s,i,o.toLowerCase());break;case yn.KEEP_AND_SANITIZE_STYLE:this.styleAttributeSanitizer?Li(s,i,this.styleAttributeSanitizer(o)):Li(s,i,o);break;case yn.KEEP_AND_USE_RESOURCE_URL_POLICY:if(this.resourceUrlPolicy){const d={type:ng.HTML_ATTRIBUTE,attributeName:i,elementName:n},c=Xv(o),g=this.resourceUrlPolicy(c,d);g&&Li(s,i,g.toString())}else Li(s,i,o);break;case yn.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET:if(this.resourceUrlPolicy){const d={type:ng.HTML_ATTRIBUTE,attributeName:i,elementName:n},c=uk(o),g={parts:[]};for(const f of c.parts){const p=Xv(f.url),_=this.resourceUrlPolicy(p,d);_&&g.parts.push({url:_.toString(),descriptor:f.descriptor})}Li(s,i,dk(g))}else Li(s,i,o);break;case yn.DROP:this.recordChange(`Attribute: ${i} was dropped`);break;default:hk(a.policyAction,"Unhandled AttributePolicyAction case")}else this.recordChange(`Not all conditions satisfied for attribute: ${i}.`)}return s}nodeFilter(e){if(Zv(e))return 1;if(!Kv(e))return 2;const t=Yv(e);return t===null?(this.recordChange(`Node name was null for node: ${e}`),2):this.sanitizerTable.isAllowedElement(t)?1:(this.recordChange(`Element: ${t} was dropped`),2)}recordChange(e){this.changes.push(e)}satisfiesAllConditions(e,t){var n;if(!e)return!0;for(const[s,r]of e){const i=(n=t.getNamedItem(s))===null||n===void 0?void 0:n.value;if(i&&!r.has(i))return!1}return!0}};function Li(e,t,n){e.setAttribute(t,n)}function uk(e){const t=[];for(const n of e.split(",")){const[s,r]=n.trim().split(/\s+/,2);t.push({url:s,descriptor:r})}return{parts:t}}function dk(e){return e.parts.map(t=>{const{url:n,descriptor:s}=t;return`${n}${s?` ${s}`:""}`}).join(" , ")}function hk(e,t=`unexpected value ${e}!`){throw new Error(t)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ck=class{constructor(){this.calledBuild=!1,this.sanitizerTable=ak}onlyAllowElements(e){const t=new Set,n=new Map;for(let s of e){if(s=s.toUpperCase(),!this.sanitizerTable.isAllowedElement(s))throw new Error(`Element: ${s}, is not allowed by html5_contract.textpb`);const r=this.sanitizerTable.elementPolicies.get(s);r!==void 0?n.set(s,r):t.add(s)}return this.sanitizerTable=new ai(t,n,this.sanitizerTable.allowedGlobalAttributes,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowCustomElement(e,t){const n=new Set(this.sanitizerTable.allowedElements),s=new Map(this.sanitizerTable.elementPolicies);if(!nk(e=e.toUpperCase()))throw new Error(`Element: ${e} is not a custom element`);if(t){const r=new Map;for(const i of t)r.set(i.toLowerCase(),{policyAction:yn.KEEP});s.set(e,r)}else n.add(e);return this.sanitizerTable=new ai(n,s,this.sanitizerTable.allowedGlobalAttributes,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}onlyAllowAttributes(e){const t=new Set,n=new Map,s=new Map;for(const r of e)this.sanitizerTable.allowedGlobalAttributes.has(r)&&t.add(r),this.sanitizerTable.globalAttributePolicies.has(r)&&n.set(r,this.sanitizerTable.globalAttributePolicies.get(r));for(const[r,i]of this.sanitizerTable.elementPolicies.entries()){const o=new Map;for(const[a,u]of i.entries())e.has(a)&&o.set(a,u);s.set(r,o)}return this.sanitizerTable=new ai(this.sanitizerTable.allowedElements,s,t,n,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowDataAttributes(e){if(e===void 0){const n=new Set(this.sanitizerTable.globallyAllowedAttributePrefixes);return n.add("data-"),this.sanitizerTable=new ai(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,this.sanitizerTable.allowedGlobalAttributes,this.sanitizerTable.globalAttributePolicies,n),this}const t=new Set(this.sanitizerTable.allowedGlobalAttributes);for(const n of e){if(n.indexOf("data-")!==0)throw new Error(`data attribute: ${n} does not begin with the prefix "data-"`);t.add(n)}return this.sanitizerTable=new ai(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,t,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowStyleAttributes(){const e=new Map(this.sanitizerTable.globalAttributePolicies);return e.set("style",{policyAction:yn.KEEP_AND_SANITIZE_STYLE}),this.sanitizerTable=new ai(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,this.sanitizerTable.allowedGlobalAttributes,e,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowClassAttributes(){const e=new Set(this.sanitizerTable.allowedGlobalAttributes);return e.add("class"),this.sanitizerTable=new ai(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,e,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowIdAttributes(){const e=new Set(this.sanitizerTable.allowedGlobalAttributes);return e.add("id"),this.sanitizerTable=new ai(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,e,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}allowIdReferenceAttributes(){const e=new Set(this.sanitizerTable.allowedGlobalAttributes);return e.add("aria-activedescendant").add("aria-controls").add("aria-labelledby").add("aria-owns").add("for").add("list"),this.sanitizerTable=new ai(this.sanitizerTable.allowedElements,this.sanitizerTable.elementPolicies,e,this.sanitizerTable.globalAttributePolicies,this.sanitizerTable.globallyAllowedAttributePrefixes),this}withResourceUrlPolicy(e){return this.resourceUrlPolicy=e,this}},gk=class extends ck{build(){if(this.calledBuild)throw new Error("this sanitizer has already called build");return this.calledBuild=!0,new lk(this.sanitizerTable,kd,void 0,void 0,this.resourceUrlPolicy)}};/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fk(e){const t=Tw(e).toString(),n=new Blob([t],{type:"text/javascript"});return BI(URL.createObjectURL(n))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Su(e,...t){if(t.some(n=>n!==""))throw new Error("safeScript only allows empty string expressions to enable inline comments.");return CI(e,t.length),_y(e.join(""))}function pk(e){return _y(e.map(Tw).join(""))}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Cw(e,t){const n=Md(t);n!==void 0&&(e.href=n)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mk(e,t){const n=Md(t);n!==void 0&&(e.href=n)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _k(e,t){e.href=jl(t)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yk(e,t){const n=Md(t);n!==void 0&&(e.formAction=n)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xk(e,t){e.src=jl(t)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vk(e,t){const n=Md(t);n!==void 0&&(e.action=n)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bk(e,t){e.src=jl(t).toString()}function Ek(e,t){e.srcdoc=my(t)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Sk(e,t){const n=Md(t);n!==void 0&&(e.formAction=n)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ak(e,t){e.data=jl(t)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wk(e){return Tk("script",e)}function Tk(e,t=document){var n;const s=(n=t.querySelector)===null||n===void 0?void 0:n.call(t,`${e}[nonce]`);return s==null?"":s.nonce||s.getAttribute("nonce")||""}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ck(e){const t=wk(e.ownerDocument);t&&e.setAttribute("nonce",t)}function Lk(e,t,n){e.src=jl(t),Ck(e)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Lw(e,t){Ik(e)&&Nk(e),e.innerHTML=my(t)}function Nk(e){let t="";const n=e.tagName;if(/^(script|style)$/i.test(n))throw t=n.toLowerCase()==="script"?"Use setScriptTextContent with a SafeScript.":"Use setStyleTextContent with a SafeStyleSheet.",new Error(t)}function Ik(e){return e.nodeType===1}function kk(e,t,n){if(e.namespaceURI!=="http://www.w3.org/1999/xhtml")throw new Error(`Cannot set attribute '${t}' on '${e.tagName}'.Element is not in the HTML namespace`);switch(t=t.toLowerCase(),`${e.tagName} ${t}`){case"A href":return void Cw(e,n);case"AREA href":return void mk(e,n);case"BASE href":return void _k(e,n);case"BUTTON formaction":return void yk(e,n);case"EMBED src":return void xk(e,n);case"FORM action":return void vk(e,n);case"IFRAME src":return void bk(e,n);case"IFRAME srcdoc":return void Ek(e,n);case"IFRAME sandbox":throw new Error("Can't set 'sandbox' on iframe tags. Use setIframeSrcWithIntent or setIframeSrcdocWithIntent instead");case"INPUT formaction":return void Sk(e,n);case"LINK href":throw new Error("Can't set 'href' attribute on link tags. Use setLinkHrefAndRel instead");case"LINK rel":throw new Error("Can't set 'rel' attribute on link tags. Use setLinkHrefAndRel instead");case"OBJECT data":return void Ak(e,n);case"SCRIPT src":return void Lk(e,n);default:if(/^on./.test(t))throw new Error(`Attribute "${t}" looks like an event handler attribute. Please use a safe alternative like addEventListener instead.`);e.setAttribute(t,n)}}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Mk(e,t){return new Worker(jl(e),t)}/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gi(e){!SI&&console.warn(bw()+" "+e)}function Pk(e,t){t.forEach(n=>{Object.getOwnPropertyNames(n.prototype).forEach(s=>{Object.defineProperty(e.prototype,s,Object.getOwnPropertyDescriptor(n.prototype,s)||Object.create(null))})})}var Vt=()=>{},sg=()=>!1,yy=()=>!0,rg=()=>null,Yr=e=>e;function Nw(e,t,n){const s=e.getObjectList(t.isNode);for(let r=0;r<t._indexes.length;++r){const i=t._indexes[r];n(s.get(i),r,t)}}function Iw(e,t,n){const s=new Array(t.size),r=e.getObjectList(t.isNode);for(let i=0;i<t._indexes.length;++i){const o=t._indexes[i],a=r.get(o);s[i]=n(a,i,t)}return s}function kw(e,t,n){n=n||yy;const s=t.isNode,r=e.acquireIndexList(s),i=e.getObjectList(s),o=e.getListFactory(s);for(let a=0;a<t._indexes.length;++a){const u=t._indexes[a],d=i.get(u);d&&n(d,a,t)&&r.push(u)}return o(r.sliceAndReset())}function Mw(e,t,n){const s=e.getObjectList(t.isNode);for(let r=0;r<t._indexes.length;++r){const i=t._indexes[r];if(!n(s.get(i),r,t))return!1}return!0}function Pw(e,t,n){const s=e.getObjectList(t.isNode);for(let r=0;r<t._indexes.length;++r){const i=t._indexes[r];if(n(s.get(i),r,t))return!0}return!1}function Rw(e,t,n){const s=e.getObjectList(t.isNode);for(let r=0;r<t._indexes.length;++r){const i=t._indexes[r],o=s.get(i);if(n(o,r,t))return o}}function Fw(e,t,n,s){const r=e.getListFactory(t.isNode);if(!n)return{valid:t,invalid:r()};const i=e.acquireIndexList(t.isNode),o=e.acquireIndexList(t.isNode),a=e.getObjectList(t.isNode);for(let u=0;u<t._indexes.length;u++){const d=t._indexes[u],c=a.get(d);c!==void 0&&(n(c,s)?i:o).pushUnchecked(d)}return{valid:r(i.sliceAndReset()),invalid:r(o.sliceAndReset())}}function Dw(e,t,n,s){const r=e.getObjectList(t.isNode);let i=s;for(let o=0;o<t._indexes.length;++o){const a=t._indexes[o];i=n(i,r.get(a),o)}return i}function Ow(e,t){const n=t.isNode,s=e.topology.getDeduper(n),r=e.acquireIndexList(n),i=e.getListFactory(n);for(let o=0;o<t._indexes.length;o++){const a=t._indexes[o];s.get(a)===0&&(s.set(a,1),r.push(a))}return i(r.sliceAndReset())}function zw(e,t,n){const s=t.isNode,r=n.topology.getDeduper(s),i=n.acquireIndexList(s),o=n.getListFactory(s);for(let a=0;a<t._indexes.length;a++){const u=t._indexes[a];r.set(u,1)}for(let a=0;a<e._indexes.length;a++){const u=e._indexes[a];r.get(u)===0&&i.push(u)}return o(i.sliceAndReset())}function Bw(e,t){const n=t.isNode,s=e.storage.fetch(n),r=s.getFlexArray("excluded"),i=s.getMaxIndex(),o=e.topology.getDeduper(n),a=e.acquireIndexList(n),u=e.getListFactory(n);for(let d=0;d<t._indexes.length;d++)o.set(t._indexes[d],1);for(let d=1;d<=i;++d)o.get(d)===0&&r.get(d)===0&&a.push(d);return u(a.sliceAndReset())}function Uw(e,t,n){const s=e.getListFactory(t.isNode),r=new Uint32Array(t._indexes.length+n._indexes.length);return r.set(t._indexes),r.set(n._indexes,t._indexes.length),s(r)}function Gw(e,t){return e.getObjectList(t.isNode).getMultiple(t._indexes)}function Wg(e,t){const n=e.getStorage(t.isNode);if(t.isList){const s=new Array(t.size);for(let r=0;r<t._indexes.length;++r)s[r]=n.getId(t._indexes[r]);return s}return n.getId(t._index)}function Vw(e,t){return e.topology.getExtremity(!0,t)}function jw(e,t){return e.topology.getExtremity(!1,t)}function Hw(e,t,n){return e.getObjectList(t.isNode).get(t._indexes[n])}function qw(e,t,n){const s=e.getListFactory(t.isNode),r=e.getObjectList(t.isNode),i=t._indexes.slice();return i.sort((o,a)=>{const u=r.get(o),d=r.get(a);return n(u,d)}),s(i)}var Rk=[];function $w(e){typeof e=="object"&&e!==null||(e={});const t=typeof e.data=="function"?e.data:Yr;return{attributes:Array.isArray(e.attributes)?e.attributes:e.attributes||Rk,data:t}}function Xg(e,t){for(const n of e){const s=t;Object.keys(s).forEach(r=>{const i=s[r];n.prototype[r]=function(o,a){return Gi(`Deprecated method "${r}"; please use "${i}" instead.`),this[i](o,a)}})}}function Qv(e){const t=e.getFlexArray("removed"),n=e.getFlexArray("excluded"),s=e.getFlexArray("virtual");return{all:r=>t.get(r)===0,visible:r=>n.get(r)===0,excluded:r=>n.get(r)===1,raw:r=>s.get(r)===0&&t.get(r)===0,_all:r=>!0}}function Jv(e,t,n){return{all:Xh(n.all,e,t),visible:Xh(n.visible,e,t),raw:Xh(n.raw,e,t),_all:Xh(n._all,e,t)}}function Xh(e,t,n){let s=null;return{getList(){if(!s){const r=t(),i=n();i.reset();for(let o=1;o<=r;++o)e(o)&&i.push(o);s=i.sliceAndReset()}return s},invalidList(){s=null}}}function Fk(e){if(e===void 0)return Math.round(Math.random()*Number.MAX_SAFE_INTEGER);if(typeof e!="string"&&(typeof e!="number"||!isFinite(e)))throw new Error(`${e} is not a valid id, expected string or number`);return e}var eb=new Uint32Array(1),Mo=class{constructor(e,t){this.size=1,this.isNode=!1,this.isList=!1,this._index=e,this._ogma=t}get _indexes(){return eb[0]=this._index,eb}setAttributes(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)}setAttribute(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)}getAttributes(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)[0]}getAttribute(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)[0]}resetAttributes(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)}replaceOriginalAttributes(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)}getPreviousAttributes(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)[0]}isInView(e){return this._ogma.modules.locate.isElementInView(this,e)}hasParallelEdges(){return this._ogma.modules.graph.hasParallelEdges(this)}getParallelEdges(e){return this._ogma.modules.graph.getParallelEdges(this,e)}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)}getAdjacentElements(){const{nodes:e,edges:t}=this.fastGetAdjacentElements();return{nodes:e.dedupe(),edges:t.filter(n=>n!==this).dedupe()}}isVisible(){return!this.isExcluded()}isExcluded(){return this._ogma.modules.graph.isExcluded(this)[0]}setExcluded(e){return this._ogma.modules.graph.setExcluded(this,e)}setVisible(e){return this.setExcluded(!e)}toList(){return this._ogma.modules.graph.edgeList(new Uint32Array([this._index]))}getId(){return Wg(this._ogma.modules.graph,this)}getSource(){return Vw(this._ogma.modules.graph,this)}getTarget(){return jw(this._ogma.modules.graph,this)}getExtremities(){return this._ogma.modules.graph.nodeList(new Uint32Array([this.getSource()._index,this.getTarget()._index]))}setSource(e){this._ogma.modules.graph.setSource(this,e)}setTarget(e){this._ogma.modules.graph.setTarget(this,e)}slice(){return this.toList()}toJSON(e={}){const{attributes:t,data:n}=$w(e);return{id:this.getId(),source:this.getSource().getId(),target:this.getTarget().getId(),attributes:this.getAttributes(t),data:n(Bn(this.getData()))}}get(e){return e===0?this:void 0}setSelected(e){this._ogma.modules.selection.setActive(this,e)}isSelected(){return this._ogma.modules.selection.areActive(this)}locate(e){return this._ogma.modules.locate.locateElements(this,e)}getBoundingBox({includeTexts:e=!1,ignoreCurvature:t=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,e,e,t)}setData(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t),this}getData(e){return this._ogma.modules.data.getProperty(this,e||null)[0]}addClass(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)}addClasses(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)}removeClass(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)}removeClasses(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)}hasClass(e){return this._ogma.modules.classes.hasSingleElementClass(e,this)}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)[0]}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]}isVirtual(){return this._ogma.modules.transformations.isElementVirtual(this)}getTransformation(){return this._ogma.modules.transformations.getElementTransformation(this)}getMetaEdge(){return this._ogma.modules.transformations.getMetaEdge(this)}getSubEdges(){return this._ogma.modules.transformations.getSubEdges(this)}pulse(e){return this._ogma.modules.pulses.pulse(this,e)}};Xg([Mo],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var Ta=class{constructor(e,t){this.isList=!0,this.isNode=!1,this._indexes=e,this._ogma=t}get size(){return this._indexes.length}setAttributes(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)}setAttribute(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)}getAttributes(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)}getAttribute(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)}resetAttributes(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)}replaceOriginalAttributes(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)}getPreviousAttributes(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)}getPreviousAttribute(e){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,e)}getParallelEdges(e){return this._ogma.modules.graph.getParallelEdges(this,e)}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)}getAdjacentElements(){const{nodes:e,edges:t}=this.fastGetAdjacentElements();return{nodes:e.dedupe(),edges:t.subtract(this).dedupe()}}isVisible(){return this.isExcluded().map(e=>!e)}isExcluded(){return this._ogma.modules.graph.isExcluded(this)}isVirtual(){return this.map(e=>this._ogma.modules.transformations.isElementVirtual(e))}setExcluded(e){return this._ogma.modules.graph.setExcluded(this,e)}setVisible(e){return this.setExcluded(!e)}toList(){return this}toArray(){return Gw(this._ogma.modules.graph,this)}clone(){return this._ogma.modules.graph.edgeList(this._indexes.slice())}getId(){return Wg(this._ogma.modules.graph,this)}getSource(){return Vw(this._ogma.modules.graph,this)}getTarget(){return jw(this._ogma.modules.graph,this)}getExtremities(){return this.getSource().concat(this.getTarget())}get(e){return Hw(this._ogma.modules.graph,this,e)}forEach(e){Nw(this._ogma.modules.graph,this,e)}map(e){return Iw(this._ogma.modules.graph,this,e)}find(e){return Rw(this._ogma.modules.graph,this,e)}some(e){return Pw(this._ogma.modules.graph,this,e)}every(e){return Mw(this._ogma.modules.graph,this,e)}[Symbol.iterator](){let e=-1;return{next:()=>({value:this.get(++e),done:e>=this.size})}}filter(e){return kw(this._ogma.modules.graph,this,e)}reduce(e,t){return Dw(this._ogma.modules.graph,this,e,t)}concat(e){return Uw(this._ogma.modules.graph,this,e)}dedupe(){return Ow(this._ogma.modules.graph,this)}subtract(e){return zw(this,e,this._ogma.modules.graph)}slice(e,t){return this._ogma.modules.graph.edgeList(this._indexes.slice(e,t))}indexOf(e){return e instanceof Mo?this._indexes.indexOf(e._index):-1}includes(e){return this.indexOf(e)!==-1}sort(e){return qw(this._ogma.modules.graph,this,e)}inverse(){return Bw(this._ogma.modules.graph,this)}toJSON(e={}){return this.map(t=>t.toJSON(e))}setSelected(e){this._ogma.modules.selection.setActive(this,e)}isSelected(){return this._ogma.modules.selection.areActive(this)}locate(e){return this._ogma.modules.locate.locateElements(this,e)}getBoundingBox({includeTexts:e=!1,ignoreCurvature:t=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,e,e,t)}setData(e,t){if(arguments.length<2&&(t=e,e=null),typeof t!="function"&&!bs(t))throw new Error(`invalid argument ${t}; expected array or function`);return this._ogma.modules.data.setProperty(this,e,t,{dispatch:!0}),this}fillData(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t,{dispatch:!1}),this}getData(e){return this._ogma.modules.data.getProperty(this,e||null)}addClass(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)}addClasses(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)}removeClass(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)}removeClasses(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)}hasClass(e){return this.map(t=>this._ogma.modules.classes.hasSingleElementClass(e,t))}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)}getMetaEdge(){return this._ogma.modules.transformations.getMetaEdges(this)}getSubEdges(){return this.map(this._ogma.modules.transformations.getSubEdges)}pulse(e){return this._ogma.modules.pulses.pulse(this,e)}};Xg([Ta],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var ui="geo.latitude",di="geo.longitude",tb="geo.prevLat",jp="geo.prevLng",Ww=85.0511287798,Dk=6378137,ig=1,Ok='Map data &copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap contributors</a>',aa={latitudePath:"latitude",longitudePath:"longitude",maxZoomLevel:22,minZoomLevel:0,wrapCoordinates:!0,tileUrlTemplate:"https://{s}.tile.osm.org/{z}/{x}/{y}.png",tileUrlSubdomains:"abc",attribution:null,attributionOptions:void 0,backgroundColor:"silver",opacity:1,duration:0,disableNodeDragging:!0,tileBuffer:1,sizeRatio:1,tiles:{url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png",subdomains:"abc",tms:!1,wms:!1},crs:void 0},zk={maxBoundsViscosity:1,worldCopyJump:!0,zoomControl:!1,attributionControl:!1},Bk=(()=>{let e=0;return typeof requestAnimationFrame<"u"?requestAnimationFrame:function(t){const n=Date.now(),s=Math.min(16,Math.max(0,16-(n-e))),r=e=n+s;return setTimeout(()=>t(r),s)}})(),Xw=50,Uk=typeof cancelAnimationFrame<"u"?cancelAnimationFrame:function(e){return clearTimeout(e)};function xy(e,t){return Bk(n=>{e.call(t,n)})}function Yw(e){e&&Uk(e)}var Hp,Aa,vy,Zw,Gk={},Kw=Gk,Hc={},Qw={},Xm=e=>null;if(typeof global=="object"&&(Hc=global),typeof window=="object"&&(Qw=window),typeof ed=="object"&&typeof ed.require=="function"){const e=ed.require.bind(ed);Xm=t=>{try{return e(t)}catch{return null}}}else typeof Hc.require=="function"&&(Xm=e=>{const t=Hc.require;try{return t(e)}catch{return null}});function kr(e,{throwOnError:t}={}){let n=null;if(!n&&e&&(n=Kw[e]),!n&&e&&(n=Xm(e)),!n&&e&&(n=Qw[e]),!n&&e&&(n=Hc[e]),!n&&t){const s=[`unable to find module "${e}"; make sure one of these statements is true:`,`- Ogma.libraries['${e}'] is set to the right library`,`- require('${e}') returns the right library`,`- window['${e}'] is set to the right library`].join(`
`);throw new Error(s)}return n}var qr,Jw=(qr=class{constructor(){this.method=null,this.url=null,this.status=0,this.readyState=0,this.headers={},this.responseText=null,this.response=null,qr.onCreate&&qr.onCreate(this)}open(t,n){this.method=t,this.url=n,qr.onSend&&qr.onSend(this)}respond(t,n,s){this.readyState=4,this.status=t,this.headers=n,this.responseText=s,this.response=s,this.onreadystatechange()}send(){this.readyState=4}},qr.onCreate=Vt,qr.onSend=Vt,qr),$r,e1=($r=class{constructor(){this.onload=Vt,$r.onCreate&&$r.onCreate(this)}readAsDataURL(t){this._blob=t,$r.onRead&&$r.onRead(this)}load(t){this.result=typeof t=="function"?t(this._blob):t,this.onload&&this.onload()}},$r.onCreate=Vt,$r.onRead=Vt,$r);function $i(){return Aa||{createElementNS:()=>null,createElement:()=>null,implementation:{createDocument(){throw new Error('unable to create XML document; if you use Node JS install the "xmldom" package')}}}}Hp=kr("@xmldom/xmldom"),Aa=qi?document:Hp?new Hp.DOMImplementation().createDocument():null,vy=typeof XMLHttpRequest<"u"?XMLHttpRequest:Jw,Zw=typeof FileReader<"u"?FileReader:e1;var Vk=class{observe(){}unobserve(){}disconnect(){}},jk=typeof ResizeObserver>"u"?Vk:ResizeObserver,t1=e=>new jk(e);function n1(e,t){if(document&&document.defaultView){let n=e.style[t];if((!n||n==="auto")&&$i().defaultView){const s=document.defaultView.getComputedStyle(e,null);n=s?s[t]:null}return n==="auto"?null:n?n.toString():null}return null}var s1=class{constructor(){this.onmousewheel=Vt,this.__dummy=!0,this.style={},this.clientWidth=0,this.clientHeight=0,this.childNodes=[],this.style={width:"0px",height:"0px",top:void 0,left:void 0,position:"",backgroundColor:void 0}}get offsetWidth(){return parseFloat(this.style.width||"0")}get offsetHeight(){return parseFloat(this.style.height||"0")}get firstChild(){return null}get parentNode(){return null}get classList(){return{length:0,value:"",add(){},remove(){},contains:e=>!1,item:null}}get innerHTML(){return""}set innerHTML(e){}appendChild(e){return this.childNodes.push(e),e}removeChild(){}addEventListener(){}removeEventListener(){}insertBefore(){}contains(e){return!1}};function og(){return new s1}var or=ko?()=>window.devicePixelRatio:()=>1;function r1(e){const t=";base64,";let n,s,r;if(e.indexOf(t)===-1)return n=e.split(","),s=n[0].split(":")[1],r=decodeURIComponent(n[1]),gd(r,s);n=e.split(t),s=n[0].split(":")[1],r=window.atob(n[1]);const i=r.length,o=new Uint8Array(i);for(let a=0;a<i;++a)o[a]=r.charCodeAt(a);return gd([o],s)}var i1=class{constructor(e,t){this.data=e,this.type=t}};function gd(e,t){return typeof Blob<"u"?new Blob(e,{type:t}):new i1(e,t)}function Hk(e){return typeof Blob<"u"&&e instanceof Blob||e instanceof i1}function qk(e,t,n="text/plain"){return t==="blob"?e:t==="dataURL"?r1(e):gd([e],n||"text/xml")}function Oo(e,t,n="text",s="text/plain"){if(!Hg)return e;let r=null,i=null,o=null;window.Blob?(r=qk(e,n,s),i=URL.createObjectURL(r)):o="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(e);const a=document.createElement("a");return Cw(a,i||o||""),a.setAttribute("download",t),document.body.appendChild(a),a.click(),document.body.removeChild(a),i&&setTimeout(()=>window.URL.revokeObjectURL(i),0),e}function ag(e,t,n,s=or()){if(wa(e,t+"px",n+"px"),e.tagName==="IMG"||e.tagName==="CANVAS"){const r=e;r.width=t*s,r.height=n*s}}function by(e,t){ci(t,(n,s)=>{n!==void 0&&e.setAttribute(s,n)})}var Ey="http://www.w3.org/2000/svg",Ym="http://www.w3.org/2000/xmlns/",o1="http://www.w3.org/1999/xlink",$k=1;function rn(e,t){const n=Aa.createElementNS(Ey,e);return n.style||(n.style={}),t&&by(n,t),n}function Zm(e){const t=Aa.createElement("div");if(t.innerHTML=e.trim().replace(/\s+/g," "),!t.firstChild||t.firstChild.nodeType!==$k)throw new Error(`Failed to create element from: "${e}". Expected an HTML string`);return t.firstChild}function Sy(e){if(Aa)return Aa.createTextNode(e)}function a1(e){return typeof Image>"u"?Promise.resolve(null):new Promise(t=>{const n=new Image;n.src=e,n.onload=()=>t(n),n.onerror=()=>t(null)})}function l1(e){if(e.indexOf("http://")===0||e.indexOf("https://")===0)return e;const t=window.location.origin;if(window.location.protocol==="blob:")return e;const n=window.location.pathname,s=n.lastIndexOf("/");return s===-1?t+"/"+e:t+n.substring(0,s)+"/"+e}function Hl(e){return new Promise((t,n)=>{const s=new vy;s.open("GET",l1(e),!0),s.onreadystatechange=function(){if(s.readyState===4){const r=s.status;r===200?t(s.responseText):n(r!==0?new Error(`cannot retrieve file at url "${e}"; the server responded with status code ${r}.`):new Error(`cannot send XMLHttpRequest to url "${e}"; if you're using the local file protocol this is most likely the cause.`))}},s.onerror=function(){n(new Error(`cannot retrieve file at url "${e}"; the XMLHttpRequest failed.`))},s.send()})}function u1(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function lg(e,t){e.style.cursor=t,e.style.cursor!==t&&(e.style.cursor=`-webkit-${t}`)}function d1(e){return new Promise((t,n)=>{const s=new vy;s.responseType="blob",s.open("GET",l1(e),!0),s.onreadystatechange=()=>{if(s.readyState===4){if(s.status===200)return t(s.response);n(s.status)}},s.onerror=r=>n(r),s.send()})}function h1(e){return d1(e).then(t=>new Promise((n,s)=>{const r=new Zw;r.onerror=s,r.onload=()=>n(r.result),r.readAsDataURL(t)}))}function pl(e,t=!0){const n=t?"&#13;":`
`;return(""+e).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,n).replace(/[\r\n]/g,n)}var Ay={0:"left",1:"middle",2:"right"};function c1(e){if(e.baseURI)return e.baseURI;const t=e.getElementsByTagName("base");return t.length>0?t[0].href:e.URL||(e.location?e.location.href:"")}function g1(e,t,n,s){return new Promise(r=>{let i=t;const o=Date.now(),a=(n-t)*Math.min(1,1/(s/16));(function u(){Date.now()-o<s?(i=Math.min(1,Math.max(0,i+a)),e.style.opacity=i.toString(),xy(u)):r()})()})}function wa(e,t,n){e.style.width=t,e.style.height=n}var wy=new gk().allowClassAttributes().allowDataAttributes().allowIdAttributes().allowStyleAttributes().build();function Co(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function Mr(e,t,n){return Math.max(t,Math.min(n,e))}function Km(e,t,n){return e+(t-e)*n}function un(e,t,n){return e*(1-n)+t*n}function ml(e){if(!e.length)return-1/0;let t=e[0];for(let n=1,s=e.length;n<s;++n){const r=e[n];r>t&&(t=r)}return t}function Fi(e){if(!e.length)return 1/0;let t=e[0];for(let n=1,s=e.length;n<s;++n){const r=e[n];r<t&&(t=r)}return t}var f1=(e,t)=>Math.log(e)/Math.log(t),ug=e=>e<-Math.PI?e+2*Math.PI:e>Math.PI?e-2*Math.PI:e,Wk=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let s=0;s<this._n&&s<32;s++){const r=t[s],i=e+r,o=Math.abs(e)<Math.abs(r)?e-(i-r):r-(i-e);o&&(t[n++]=o),e=i}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,s,r=this._n,i=0;if(r>0){for(i=e[--r];r>0&&(t=i,n=e[--r],i=t+n,s=n-(i-t),!s););r>0&&(s<0&&e[r-1]<0||s>0&&e[r-1]>0)&&(n=2*s,t=i+n,n==t-i&&(i=t))}return i}};function*Xk(e){for(const t of e)yield*t}function p1(e){return Array.from(Xk(e))}var Mn=1e-6,tn=Math.PI,Nr=tn/2,nb=tn/4,Zr=2*tn,Ni=180/tn,cr=tn/180,Qn=Math.abs,Yk=Math.atan,Il=Math.atan2,zn=Math.cos,kn=Math.sin,Zk=Math.sign||function(e){return e>0?1:e<0?-1:0},Pd=Math.sqrt;function m1(e){return e>1?0:e<-1?tn:Math.acos(e)}function kl(e){return e>1?Nr:e<-1?-Nr:Math.asin(e)}function ju(){}function dg(e,t){e&&rb.hasOwnProperty(e.type)&&rb[e.type](e,t)}var sb={Feature:function(e,t){dg(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,s=-1,r=n.length;++s<r;)dg(n[s].geometry,t)}},rb={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,s=-1,r=n.length;++s<r;)e=n[s],t.point(e[0],e[1],e[2])},LineString:function(e,t){Qm(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,s=-1,r=n.length;++s<r;)Qm(n[s],t,0)},Polygon:function(e,t){ib(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,s=-1,r=n.length;++s<r;)ib(n[s],t)},GeometryCollection:function(e,t){for(var n=e.geometries,s=-1,r=n.length;++s<r;)dg(n[s],t)}};function Qm(e,t,n){var s,r=-1,i=e.length-n;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function ib(e,t){var n=-1,s=e.length;for(t.polygonStart();++n<s;)Qm(e[n],t,1);t.polygonEnd()}function Kk(e,t){e&&sb.hasOwnProperty(e.type)?sb[e.type](e,t):dg(e,t)}function Jm(e){return[Il(e[1],e[0]),kl(e[2])]}function Ml(e){var t=e[0],n=e[1],s=zn(n);return[s*zn(t),s*kn(t),kn(n)]}function Yh(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function hg(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function qp(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Zh(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function e_(e){var t=Pd(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function t_(e,t){function n(s,r){return s=e(s,r),t(s[0],s[1])}return e.invert&&t.invert&&(n.invert=function(s,r){return(s=t.invert(s,r))&&e.invert(s[0],s[1])}),n}function n_(e,t){return Qn(e)>tn&&(e-=Math.round(e/Zr)*Zr),[e,t]}function Qk(e,t,n){return(e%=Zr)?t||n?t_(ab(e),lb(t,n)):ab(e):t||n?lb(t,n):n_}function ob(e){return function(t,n){return Qn(t+=e)>tn&&(t-=Math.round(t/Zr)*Zr),[t,n]}}function ab(e){var t=ob(e);return t.invert=ob(-e),t}function lb(e,t){var n=zn(e),s=kn(e),r=zn(t),i=kn(t);function o(a,u){var d=zn(u),c=zn(a)*d,g=kn(a)*d,f=kn(u),p=f*n+c*s;return[Il(g*r-p*i,c*n-f*s),kl(p*r+g*i)]}return o.invert=function(a,u){var d=zn(u),c=zn(a)*d,g=kn(a)*d,f=kn(u),p=f*r-g*i;return[Il(g*r+f*i,c*n+p*s),kl(p*n-c*s)]},o}function Jk(e,t,n,s,r,i){if(n){var o=zn(t),a=kn(t),u=s*n;r==null?(r=t+s*Zr,i=t-u/2):(r=ub(o,r),i=ub(o,i),(s>0?r<i:r>i)&&(r+=s*Zr));for(var d,c=r;s>0?c>i:c<i;c-=u)d=Jm([o,-a*zn(c),-a*kn(c)]),e.point(d[0],d[1])}}function ub(e,t){(t=Ml(t))[0]-=e,e_(t);var n=m1(-t[1]);return((-t[2]<0?-n:n)+Zr-Mn)%Zr}function _1(){var e,t=[];return{point:function(n,s,r){e.push([n,s,r])},lineStart:function(){t.push(e=[])},lineEnd:ju,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function qc(e,t){return Qn(e[0]-t[0])<Mn&&Qn(e[1]-t[1])<Mn}function Kh(e,t,n,s){this.x=e,this.z=t,this.o=n,this.e=s,this.v=!1,this.n=this.p=null}function y1(e,t,n,s,r){var i,o,a=[],u=[];if(e.forEach(function(_){if(!((y=_.length-1)<=0)){var y,x,E=_[0],b=_[y];if(qc(E,b)){if(!E[2]&&!b[2]){for(r.lineStart(),i=0;i<y;++i)r.point((E=_[i])[0],E[1]);return void r.lineEnd()}b[0]+=2*Mn}a.push(x=new Kh(E,_,null,!0)),u.push(x.o=new Kh(E,null,x,!1)),a.push(x=new Kh(b,_,null,!1)),u.push(x.o=new Kh(b,null,x,!0))}}),a.length){for(u.sort(t),db(a),db(u),i=0,o=u.length;i<o;++i)u[i].e=n=!n;for(var d,c,g=a[0];;){for(var f=g,p=!0;f.v;)if((f=f.n)===g)return;d=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(p)for(i=0,o=d.length;i<o;++i)r.point((c=d[i])[0],c[1]);else s(f.x,f.n.x,1,r);f=f.n}else{if(p)for(d=f.p.z,i=d.length-1;i>=0;--i)r.point((c=d[i])[0],c[1]);else s(f.x,f.p.x,-1,r);f=f.p}d=(f=f.o).z,p=!p}while(!f.v);r.lineEnd()}}}function db(e){if(t=e.length){for(var t,n,s=0,r=e[0];++s<t;)r.n=n=e[s],n.p=r,r=n;r.n=n=e[0],n.p=r}}function $p(e){return Qn(e[0])<=tn?e[0]:Zk(e[0])*((Qn(e[0])+tn)%Zr-tn)}function eM(e,t){var n=$p(t),s=t[1],r=kn(s),i=[kn(n),-zn(n),0],o=0,a=0,u=new Wk;r===1?s=Nr+Mn:r===-1&&(s=-Nr-Mn);for(var d=0,c=e.length;d<c;++d)if(f=(g=e[d]).length)for(var g,f,p=g[f-1],_=$p(p),y=p[1]/2+nb,x=kn(y),E=zn(y),b=0;b<f;++b,_=A,x=k,E=M,p=S){var S=g[b],A=$p(S),C=S[1]/2+nb,k=kn(C),M=zn(C),R=A-_,O=R>=0?1:-1,j=O*R,z=j>tn,X=x*k;if(u.add(Il(X*O*kn(j),E*M+X*zn(j))),o+=z?R+O*Zr:R,z^_>=n^A>=n){var oe=hg(Ml(p),Ml(S));e_(oe);var re=hg(i,oe);e_(re);var Q=(z^R>=0?-1:1)*kl(re[2]);(s>Q||s===Q&&(oe[0]||oe[1]))&&(a+=z^R>=0?1:-1)}}return(o<-1e-6||o<Mn&&u<-1e-12)^1&a}function x1(e,t,n,s){return function(r){var i,o,a,u=t(r),d=_1(),c=t(d),g=!1,f={point:p,lineStart:y,lineEnd:x,polygonStart:function(){f.point=E,f.lineStart=b,f.lineEnd=S,o=[],i=[]},polygonEnd:function(){f.point=p,f.lineStart=y,f.lineEnd=x,o=p1(o);var A=eM(i,s);o.length?(g||(r.polygonStart(),g=!0),y1(o,nM,A,n,r)):A&&(g||(r.polygonStart(),g=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),g&&(r.polygonEnd(),g=!1),o=i=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(A,C){e(A,C)&&r.point(A,C)}function _(A,C){u.point(A,C)}function y(){f.point=_,u.lineStart()}function x(){f.point=p,u.lineEnd()}function E(A,C){a.push([A,C]),c.point(A,C)}function b(){c.lineStart(),a=[]}function S(){E(a[0][0],a[0][1]),c.lineEnd();var A,C,k,M,R=c.clean(),O=d.result(),j=O.length;if(a.pop(),i.push(a),a=null,j)if(1&R){if((C=(k=O[0]).length-1)>0){for(g||(r.polygonStart(),g=!0),r.lineStart(),A=0;A<C;++A)r.point((M=k[A])[0],M[1]);r.lineEnd()}}else j>1&&2&R&&O.push(O.pop().concat(O.shift())),o.push(O.filter(tM))}return f}}function tM(e){return e.length>1}function nM(e,t){return((e=e.x)[0]<0?e[1]-Nr-Mn:Nr-e[1])-((t=t.x)[0]<0?t[1]-Nr-Mn:Nr-t[1])}n_.invert=n_;var hb=x1(function(){return!0},sM,iM,[-tn,-Nr]);function sM(e){var t,n=NaN,s=NaN,r=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(i,o){var a=i>0?tn:-tn,u=Qn(i-n);Qn(u-tn)<Mn?(e.point(n,s=(s+o)/2>0?Nr:-Nr),e.point(r,s),e.lineEnd(),e.lineStart(),e.point(a,s),e.point(i,s),t=0):r!==a&&u>=tn&&(Qn(n-r)<Mn&&(n-=r*Mn),Qn(i-a)<Mn&&(i-=a*Mn),s=rM(n,s,i,o),e.point(r,s),e.lineEnd(),e.lineStart(),e.point(a,s),t=0),e.point(n=i,s=o),r=a},lineEnd:function(){e.lineEnd(),n=s=NaN},clean:function(){return 2-t}}}function rM(e,t,n,s){var r,i,o=kn(e-n);return Qn(o)>Mn?Yk((kn(t)*(i=zn(s))*kn(n)-kn(s)*(r=zn(t))*kn(e))/(r*i*o)):(t+s)/2}function iM(e,t,n,s){var r;if(e==null)r=n*Nr,s.point(-tn,r),s.point(0,r),s.point(tn,r),s.point(tn,0),s.point(tn,-r),s.point(0,-r),s.point(-tn,-r),s.point(-tn,0),s.point(-tn,r);else if(Qn(e[0]-t[0])>Mn){var i=e[0]<t[0]?tn:-tn;r=n*i/2,s.point(-i,r),s.point(0,r),s.point(i,r)}else s.point(t[0],t[1])}function oM(e){var t=zn(e),n=2*cr,s=t>0,r=Qn(t)>Mn;function i(u,d){return zn(u)*zn(d)>t}function o(u,d,c){var g=[1,0,0],f=hg(Ml(u),Ml(d)),p=Yh(f,f),_=f[0],y=p-_*_;if(!y)return!c&&u;var x=t*p/y,E=-t*_/y,b=hg(g,f),S=Zh(g,x);qp(S,Zh(f,E));var A=b,C=Yh(S,A),k=Yh(A,A),M=C*C-k*(Yh(S,S)-1);if(!(M<0)){var R=Pd(M),O=Zh(A,(-C-R)/k);if(qp(O,S),O=Jm(O),!c)return O;var j,z=u[0],X=d[0],oe=u[1],re=d[1];X<z&&(j=z,z=X,X=j);var Q=X-z,he=Qn(Q-tn)<Mn;if(!he&&re<oe&&(j=oe,oe=re,re=j),he||Q<Mn?he?oe+re>0^O[1]<(Qn(O[0]-z)<Mn?oe:re):oe<=O[1]&&O[1]<=re:Q>tn^(z<=O[0]&&O[0]<=X)){var fe=Zh(A,(-C+R)/k);return qp(fe,S),[O,Jm(fe)]}}}function a(u,d){var c=s?e:tn-e,g=0;return u<-c?g|=1:u>c&&(g|=2),d<-c?g|=4:d>c&&(g|=8),g}return x1(i,function(d){var c,g,f,p,_;return{lineStart:function(){p=f=!1,_=1},point:function(y,x){var E,b=[y,x],S=i(y,x),A=s?S?0:a(y,x):S?a(y+(y<0?tn:-tn),x):0;if(!c&&(p=f=S)&&d.lineStart(),S!==f&&(!(E=o(c,b))||qc(c,E)||qc(b,E))&&(b[2]=1),S!==f)_=0,S?(d.lineStart(),E=o(b,c),d.point(E[0],E[1])):(E=o(c,b),d.point(E[0],E[1],2),d.lineEnd()),c=E;else if(r&&c&&s^S){var C;A&g||!(C=o(b,c,!0))||(_=0,s?(d.lineStart(),d.point(C[0][0],C[0][1]),d.point(C[1][0],C[1][1]),d.lineEnd()):(d.point(C[1][0],C[1][1]),d.lineEnd(),d.lineStart(),d.point(C[0][0],C[0][1],3)))}!S||c&&qc(c,b)||d.point(b[0],b[1]),c=b,f=S,g=A},lineEnd:function(){f&&d.lineEnd(),c=null},clean:function(){return _|(p&&f)<<1}}},function(d,c,g,f){Jk(f,e,n,g,d,c)},s?[0,-e]:[-tn,e-tn])}function aM(e,t,n,s,r,i){var o,a=e[0],u=e[1],d=0,c=1,g=t[0]-a,f=t[1]-u;if(o=n-a,g||!(o>0)){if(o/=g,g<0){if(o<d)return;o<c&&(c=o)}else if(g>0){if(o>c)return;o>d&&(d=o)}if(o=r-a,g||!(o<0)){if(o/=g,g<0){if(o>c)return;o>d&&(d=o)}else if(g>0){if(o<d)return;o<c&&(c=o)}if(o=s-u,f||!(o>0)){if(o/=f,f<0){if(o<d)return;o<c&&(c=o)}else if(f>0){if(o>c)return;o>d&&(d=o)}if(o=i-u,f||!(o<0)){if(o/=f,f<0){if(o>c)return;o>d&&(d=o)}else if(f>0){if(o<d)return;o<c&&(c=o)}return d>0&&(e[0]=a+d*g,e[1]=u+d*f),c<1&&(t[0]=a+c*g,t[1]=u+c*f),!0}}}}}var Qh=1e9,Jh=-1e9;function lM(e,t,n,s){function r(d,c){return e<=d&&d<=n&&t<=c&&c<=s}function i(d,c,g,f){var p=0,_=0;if(d==null||(p=o(d,g))!==(_=o(c,g))||u(d,c)<0^g>0)do f.point(p===0||p===3?e:n,p>1?s:t);while((p=(p+g+4)%4)!==_);else f.point(c[0],c[1])}function o(d,c){return Qn(d[0]-e)<Mn?c>0?0:3:Qn(d[0]-n)<Mn?c>0?2:1:Qn(d[1]-t)<Mn?c>0?1:0:c>0?3:2}function a(d,c){return u(d.x,c.x)}function u(d,c){var g=o(d,1),f=o(c,1);return g!==f?g-f:g===0?c[1]-d[1]:g===1?d[0]-c[0]:g===2?d[1]-c[1]:c[0]-d[0]}return function(d){var c,g,f,p,_,y,x,E,b,S,A,C=d,k=_1(),M={point:R,lineStart:function(){M.point=O,g&&g.push(f=[]),S=!0,b=!1,x=E=NaN},lineEnd:function(){c&&(O(p,_),y&&b&&k.rejoin(),c.push(k.result())),M.point=R,b&&C.lineEnd()},polygonStart:function(){C=k,c=[],g=[],A=!0},polygonEnd:function(){var z=function(){for(var Q=0,he=0,fe=g.length;he<fe;++he)for(var ae,me,we=g[he],Z=1,_e=we.length,ze=we[0],Re=ze[0],We=ze[1];Z<_e;++Z)ae=Re,me=We,Re=(ze=we[Z])[0],We=ze[1],me<=s?We>s&&(Re-ae)*(s-me)>(We-me)*(e-ae)&&++Q:We<=s&&(Re-ae)*(s-me)<(We-me)*(e-ae)&&--Q;return Q}(),X=A&&z,oe=(c=p1(c)).length;(X||oe)&&(d.polygonStart(),X&&(d.lineStart(),i(null,null,1,d),d.lineEnd()),oe&&y1(c,a,z,i,d),d.polygonEnd()),C=d,c=g=f=null}};function R(j,z){r(j,z)&&C.point(j,z)}function O(j,z){var X=r(j,z);if(g&&f.push([j,z]),S)p=j,_=z,y=X,S=!1,X&&(C.lineStart(),C.point(j,z));else if(X&&b)C.point(j,z);else{var oe=[x=Math.max(Jh,Math.min(Qh,x)),E=Math.max(Jh,Math.min(Qh,E))],re=[j=Math.max(Jh,Math.min(Qh,j)),z=Math.max(Jh,Math.min(Qh,z))];aM(oe,re,e,t,n,s)?(b||(C.lineStart(),C.point(oe[0],oe[1])),C.point(re[0],re[1]),X||C.lineEnd(),A=!1):X&&(C.lineStart(),C.point(j,z),A=!1)}x=j,E=z,b=X}return M}}var cb=e=>e,Pl=1/0,cg=Pl,fd=-Pl,gg=fd,uM={point:dM,lineStart:ju,lineEnd:ju,polygonStart:ju,polygonEnd:ju,result:function(){var e=[[Pl,cg],[fd,gg]];return fd=gg=-(cg=Pl=1/0),e}};function dM(e,t){e<Pl&&(Pl=e),e>fd&&(fd=e),t<cg&&(cg=t),t>gg&&(gg=t)}var gb=uM;function Ty(e){return function(t){var n=new s_;for(var s in e)n[s]=e[s];return n.stream=t,n}}function s_(){}function Cy(e,t,n){var s=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),s!=null&&e.clipExtent(null),Kk(n,e.stream(gb)),t(gb.result()),s!=null&&e.clipExtent(s),e}function v1(e,t,n){return Cy(e,function(s){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=Math.min(r/(s[1][0]-s[0][0]),i/(s[1][1]-s[0][1])),a=+t[0][0]+(r-o*(s[1][0]+s[0][0]))/2,u=+t[0][1]+(i-o*(s[1][1]+s[0][1]))/2;e.scale(150*o).translate([a,u])},n)}function hM(e,t,n){return v1(e,[[0,0],t],n)}function cM(e,t,n){return Cy(e,function(s){var r=+t,i=r/(s[1][0]-s[0][0]),o=(r-i*(s[1][0]+s[0][0]))/2,a=-i*s[0][1];e.scale(150*i).translate([o,a])},n)}function gM(e,t,n){return Cy(e,function(s){var r=+t,i=r/(s[1][1]-s[0][1]),o=-i*s[0][0],a=(r-i*(s[1][1]+s[0][1]))/2;e.scale(150*i).translate([o,a])},n)}s_.prototype={constructor:s_,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var fb=16,fM=zn(30*cr);function pb(e,t){return+t?mM(e,t):pM(e)}function pM(e){return Ty({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function mM(e,t){function n(s,r,i,o,a,u,d,c,g,f,p,_,y,x){var E=d-s,b=c-r,S=E*E+b*b;if(S>4*t&&y--){var A=o+f,C=a+p,k=u+_,M=Pd(A*A+C*C+k*k),R=kl(k/=M),O=Qn(Qn(k)-1)<Mn||Qn(i-g)<Mn?(i+g)/2:Il(C,A),j=e(O,R),z=j[0],X=j[1],oe=z-s,re=X-r,Q=b*oe-E*re;(Q*Q/S>t||Qn((E*oe+b*re)/S-.5)>.3||o*f+a*p+u*_<fM)&&(n(s,r,i,o,a,u,z,X,O,A/=M,C/=M,k,y,x),x.point(z,X),n(z,X,O,A,C,k,d,c,g,f,p,_,y,x))}}return function(s){var r,i,o,a,u,d,c,g,f,p,_,y,x={point:E,lineStart:b,lineEnd:A,polygonStart:function(){s.polygonStart(),x.lineStart=C},polygonEnd:function(){s.polygonEnd(),x.lineStart=b}};function E(R,O){R=e(R,O),s.point(R[0],R[1])}function b(){g=NaN,x.point=S,s.lineStart()}function S(R,O){var j=Ml([R,O]),z=e(R,O);n(g,f,c,p,_,y,g=z[0],f=z[1],c=R,p=j[0],_=j[1],y=j[2],fb,s),s.point(g,f)}function A(){x.point=E,s.lineEnd()}function C(){b(),x.point=k,x.lineEnd=M}function k(R,O){S(r=R,O),i=g,o=f,a=p,u=_,d=y,x.point=S}function M(){n(g,f,c,p,_,y,i,o,r,a,u,d,fb,s),x.lineEnd=A,A()}return x}}var _M=Ty({point:function(e,t){this.stream.point(e*cr,t*cr)}});function yM(e){return Ty({point:function(t,n){var s=e(t,n);return this.stream.point(s[0],s[1])}})}function xM(e,t,n,s,r){function i(o,a){return[t+e*(o*=s),n-e*(a*=r)]}return i.invert=function(o,a){return[(o-t)/e*s,(n-a)/e*r]},i}function mb(e,t,n,s,r,i){if(!i)return xM(e,t,n,s,r);var o=zn(i),a=kn(i),u=o*e,d=a*e,c=o/e,g=a/e,f=(a*n-o*t)/e,p=(a*t+o*n)/e;function _(y,x){return[u*(y*=s)-d*(x*=r)+t,n-d*y-u*x]}return _.invert=function(y,x){return[s*(c*y-g*x+f),r*(p-g*y-c*x)]},_}function vM(e){return bM(function(){return e})()}function bM(e){var t,n,s,r,i,o,a,u,d,c,g=150,f=480,p=250,_=0,y=0,x=0,E=0,b=0,S=0,A=1,C=1,k=null,M=hb,R=null,O=cb,j=.5;function z(Q){return u(Q[0]*cr,Q[1]*cr)}function X(Q){return(Q=u.invert(Q[0],Q[1]))&&[Q[0]*Ni,Q[1]*Ni]}function oe(){var Q=mb(g,0,0,A,C,S).apply(null,t(_,y)),he=mb(g,f-Q[0],p-Q[1],A,C,S);return n=Qk(x,E,b),a=t_(t,he),u=t_(n,a),o=pb(a,j),re()}function re(){return d=c=null,z}return z.stream=function(Q){return d&&c===Q?d:d=_M(yM(n)(M(o(O(c=Q)))))},z.preclip=function(Q){return arguments.length?(M=Q,k=void 0,re()):M},z.postclip=function(Q){return arguments.length?(O=Q,R=s=r=i=null,re()):O},z.clipAngle=function(Q){return arguments.length?(M=+Q?oM(k=Q*cr):(k=null,hb),re()):k*Ni},z.clipExtent=function(Q){return arguments.length?(O=Q==null?(R=s=r=i=null,cb):lM(R=+Q[0][0],s=+Q[0][1],r=+Q[1][0],i=+Q[1][1]),re()):R==null?null:[[R,s],[r,i]]},z.scale=function(Q){return arguments.length?(g=+Q,oe()):g},z.translate=function(Q){return arguments.length?(f=+Q[0],p=+Q[1],oe()):[f,p]},z.center=function(Q){return arguments.length?(_=Q[0]%360*cr,y=Q[1]%360*cr,oe()):[_*Ni,y*Ni]},z.rotate=function(Q){return arguments.length?(x=Q[0]%360*cr,E=Q[1]%360*cr,b=Q.length>2?Q[2]%360*cr:0,oe()):[x*Ni,E*Ni,b*Ni]},z.angle=function(Q){return arguments.length?(S=Q%360*cr,oe()):S*Ni},z.reflectX=function(Q){return arguments.length?(A=Q?-1:1,oe()):A<0},z.reflectY=function(Q){return arguments.length?(C=Q?-1:1,oe()):C<0},z.precision=function(Q){return arguments.length?(o=pb(a,j=Q*Q),re()):Pd(j)},z.fitExtent=function(Q,he){return v1(z,Q,he)},z.fitSize=function(Q,he){return hM(z,Q,he)},z.fitWidth=function(Q,he){return cM(z,Q,he)},z.fitHeight=function(Q,he){return gM(z,Q,he)},function(){return t=e.apply(this,arguments),z.invert=t.invert&&X,oe()}}function EM(e){return function(t,n){var s=zn(t),r=zn(n),i=e(s*r);return i===1/0?[2,0]:[i*r*kn(t),i*kn(n)]}}function SM(e){return function(t,n){var s=Pd(t*t+n*n),r=e(s),i=kn(r),o=zn(r);return[Il(t*i,s*o),kl(s&&n*i/s)]}}var b1=EM(function(e){return(e=m1(e))&&e/kn(e)});function AM(){return vM(b1).scale(79.4188).clipAngle(179.999)}function _b(e,t){e&&t!==void 0&&isFinite(t)&&e.setOpacity&&e.setOpacity(t)}function yb(){return ko||typeof global<"u"&&!global.process}function Wp(e){return Math.log2(e)+ig}function wM(e){return 2**(e-ig)}function xb(e){return e!=null&&!isNaN(e)}function E1(e,t){return A1(e,t,"longitude")}function S1(e,t){return A1(e,t,"latitude")}function A1(e,t,n){if(isNaN(t))throw new TypeError(`node ${e}: ${t} is not a valid ${n}`)}b1.invert=SM(function(e){return e});var TM=e=>Math.pow(2,Math.ceil(Math.log2(e)));function CM(e,t){return t==null&&e.url===aa.tiles.url?Ok:null}function LM(e={},t){const{tileUrlSubdomains:n,tileUrlTemplate:s,attribution:r,attributionOptions:i,latitudePath:o,longitudePath:a,sizeRatio:u,tiles:d}=e;if(s!=null&&typeof s!="string")throw new TypeError("Geo mode: tileUrlTemplate must be a URL string");if(n!=null&&typeof n!="string")throw new TypeError("Geo mode: tileUrlTemplate must be a string");if(d!=null){if(!(rs(d)||d instanceof t.Layer))throw new TypeError("Geo mode: tiles must be a object or L.Layer instance");const c=d;if(c.url!=null&&typeof c.url!="string")throw new TypeError("Geo mode: tiles.url must be a string");if(c.subdomains!=null&&typeof c.subdomains!="string")throw new TypeError("Geo mode: tiles.subdomains must be a string");if(c.tms&&typeof c.tms!="boolean")throw new TypeError("Geo mode: tiles.tms must be a boolean");if(c.wms&&typeof c.wms!="boolean")throw new TypeError("Geo mode: tiles.wms must be a boolean")}if(r!=null&&typeof r!="string")throw new TypeError("Geo mode: Map attribution must be a string");if(i!=null&&!rs(i))throw new TypeError("Geo mode: attributionOptions must to be a BrandOptions object");if(o!=null&&typeof o!="string"&&!Array.isArray(o))throw new TypeError("Geo mode: Latitude path must be a valid property path: a string or an array of strings.");if(a!=null&&typeof a!="string"&&!Array.isArray(a))throw new TypeError("Geo mode: Longitude path must be a valid property path: a string or an array of strings.");if(u!=null&&(!isFinite(u)||u<=0))throw new TypeError("Geo mode: sizeRatio must be a positive number.")}function NM(e,t={}){if(t.tiles===void 0||t.tileUrlTemplate||t.tileUrlSubdomains){const n=aa.tiles;return{...t.tiles||{},...aa.tiles,url:t.tileUrlTemplate||n.url,subdomains:t.tileUrlSubdomains||n.subdomains}}return rs(t.tiles)?{...e.tiles,...t.tiles}:t.tiles}function IM(e,t){return e.attribution!==t.attribution||e.tiles!==t.tiles}var kM=$i().createElement("div");function MM(e){const t=$i().createElement("div");t.className="ogma-geo-container",wa(t,"100%","100%");const n=e||kM;return n.insertBefore(t,n.firstChild),t}function PM(e){const t=[[1/0,1/0],[-1/0,-1/0]];return e.getGeoCoordinates().reduce((n,{latitude:s,longitude:r})=>{const[i,o]=n;return i[0]=Math.min(i[0],s),i[1]=Math.min(i[1],r),o[0]=Math.max(o[0],s),o[1]=Math.max(o[1],r),n},t)}function RM(e,t,n,s){const r=t._indexes;e.getNodeAttribute(ui).setMultiple(r,n),e.getNodeAttribute(di).setMultiple(r,s)}function FM(e,t,n){const{longitudePath:s,latitudePath:r,wrapCoordinates:i}=n,[o,a]=e.getAttributes(!0,[ui,di]),u=t._indexes,d=t.getId(),c=u.length,g=t.getData(r),f=t.getData(s);for(let p=0;p<c;p++){let _=f[p],y=g[p];const x=u[p],E=d[p];y!=null&&_!=null&&(E1(E,_),S1(E,y),i&&(_%=180,y=Mr(+y,-85.0511287798,Ww)),a.set(x,_),o.set(x,y))}}function DM(e,{longitudePath:t,latitudePath:n,wrapCoordinates:s},r){const i=e.getData(t),o=e.getData(n);return i!=null&&o!=null&&(!(!s&&!r)||Math.abs(o)<=Ww&&Math.abs(i)<=180)}function ec(e,t,n,s){OM(e,!0,t,n,s)}function OM(e,t,n,s,r){const i=e.getAttribute(t,s),o=e.getAttribute(t,r),a=n._indexes;o.setMultiple(a,i.getMultiple(a))}function zM(e){return e.reduce((t,{nodes:n,newValues:s})=>{if(!n)return t;const r=n.filter((i,o)=>s[o]!=null);return t?t.concat(r):r},null)}function BM(e,t){return e.getAttributes(["text.minVisibleSize","text.size","text.scale","radius"]).forEach(({text:n,radius:s},r)=>{t[e.get(r).getId()]={"text.minVisibleSize":n.minVisibleSize,"text.size":n.size,"text.scale":n.scale,minVisibleSize:n.minVisibleSize,size:Math.max(1,Number(s))}}),t}function vb(e,t){return e.getAttributes(["text.minVisibleSize","text.size","text.scale","minVisibleSize","width"]).forEach(({text:n,minVisibleSize:s,width:r},i)=>{t[e.get(i).getId()]={"text.minVisibleSize":n.minVisibleSize,"text.size":n.size,"text.scale":n.scale,minVisibleSize:s,size:Math.max(1,Number(r))}}),t}function UM(e,t,n){if(!t||!Object.keys(t).length)return Promise.resolve();const s=e.getId().filter(r=>t[r]).map(r=>{if(!t[r])return 0;const i=Number(t[r]["text.minVisibleSize"]),o=Number(t[r].minVisibleSize),a=Number(t[r]["text.size"]),u=Number(t[r]["text.scale"]),d=Number(t[r].size)*u*n;return d<=o||d<=i?0:a});return e.setAttribute("text.size",s)}function GM(e,t){const n=e.getId().map(s=>{const r=t[s]||{};return Number(r["text.size"])});return e.setAttribute("text.size",n)}var VM=e=>AM().rotate([-e.longitude,-e.latitude]).scale(Dk),bb=new Uint32Array(1),Xr=class{constructor(e,t){this.size=1,this.isNode=!0,this.isList=!1,this._index=e,this._ogma=t}get _indexes(){return bb[0]=this._index,bb}setAttributes(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)}setAttribute(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)}resetAttributes(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)}getAttributes(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)[0]}getAttribute(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)[0]}getPosition(){return this.getAttributes(["x","y"])}getPositionOnScreen(){return this._ogma.modules.camera.graphToScreenCoordinates(this.getPosition())}isInScreen(){const e=this.getPositionOnScreen(),t=this._ogma.modules.camera;return e.x>=0&&e.x<=t.width&&e.y>=0&&e.y<=t.height}replaceOriginalAttributes(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)}getPreviousAttributes(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)[0]}getPreviousAttribute(e){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,e)}isInView(e){return this._ogma.modules.locate.isElementInView(this,e)}getAdjacentNodes(e){return this._ogma.modules.graph.getAdjacentNodes(this,e)}getAdjacentEdges(e){return this._ogma.modules.graph.getAdjacentEdges(this,e)}getAdjacentElements(e){return{nodes:this._ogma.modules.graph.getAdjacentNodes(this,e).dedupe(),edges:this._ogma.modules.graph.getAdjacentEdges(this,e).dedupe()}}getDegree(e){return this._ogma.modules.graph.getDegree(this,e)[0]}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)}getConnectedComponent(e){return this._ogma.modules.graph.getConnectedComponentByNode(this,e)[0]}isVisible(){return!this.isExcluded()}isExcluded(){return this._ogma.modules.graph.isExcluded(this)[0]}setExcluded(e){return this._ogma.modules.graph.setExcluded(this,e)}setVisible(e){return this.setExcluded(!e)}toList(){return this._ogma.nodeList(new Uint32Array([+this._index]))}getId(){return Wg(this._ogma.modules.graph,this)}slice(){return this.toList()}toJSON(e={}){const{attributes:t,data:n}=$w(e),s=this.getAttributes(t);return{id:this.getId(),attributes:s,data:n(Bn(this.getData()))}}get(e){return e===0?this:void 0}setSelected(e){this._ogma.modules.selection.setActive(this,e)}isSelected(){return this._ogma.modules.selection.areActive(this)}locate(e){return this._ogma.modules.locate.locateElements(this,e)}getBoundingBox({includeTexts:e=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,e,e)}setData(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t),this}getData(e){return this._ogma.modules.data.getProperty(this,e||null)[0]}addClass(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)}addClasses(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)}removeClass(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)}removeClasses(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)}hasClass(e){return this._ogma.modules.classes.hasSingleElementClass(e,this)}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)[0]}getGeoCoordinates(){const e=this._ogma.modules.graph,t=e.getNodeAttribute(ui).get(this._index),n=e.getNodeAttribute(di).get(this._index);return{latitude:xb(t)?t:void 0,longitude:xb(n)?n:void 0}}setGeoCoordinates(e){return this.toList().setGeoCoordinates([e]).then(()=>this)}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]}isVirtual(){return this._ogma.modules.transformations.isElementVirtual(this)}getTransformation(){return this._ogma.modules.transformations.getElementTransformation(this)}getMetaNode(){return this._ogma.modules.transformations.getMetaNode(this)}getSubNodes(){return this._ogma.modules.transformations.getSubNodes(this)}pulse(e){return this._ogma.modules.pulses.pulse(this,e)}};Xg([Xr],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var Ki=class{constructor(e,t){this.isList=!0,this.isNode=!0,this._indexes=e,this._ogma=t}get size(){return this._indexes.length}setAttributes(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)}setAttribute(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)}getAttributes(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)}getAttribute(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)}resetAttributes(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)}getPosition(){return this.getAttributes(["x","y"])}getPositionOnScreen(){return this.getPosition().map(e=>this._ogma.modules.camera.graphToScreenCoordinates(e))}replaceOriginalAttributes(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)}getPreviousAttributes(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)}getPreviousAttribute(e){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,e)}getAdjacentNodes(e){return this._ogma.modules.graph.getAdjacentNodes(this,e)}getAdjacentEdges(e){return this._ogma.modules.graph.getAdjacentEdges(this,e)}getAdjacentElements(e){return{nodes:this._ogma.modules.graph.getAdjacentNodes(this,e).dedupe(),edges:this._ogma.modules.graph.getAdjacentEdges(this,e).dedupe()}}getDegree(e){return this._ogma.modules.graph.getDegree(this,e)}getConnectedComponents(e){return this._ogma.modules.graph.getConnectedComponents(this,e)}fastGetAdjacentElements(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)}isVisible(){return this.isExcluded().map(e=>!e)}isExcluded(){return this._ogma.modules.graph.isExcluded(this)}isVirtual(){return this.map(e=>this._ogma.modules.transformations.isElementVirtual(e))}setExcluded(e){return this._ogma.modules.graph.setExcluded(this,e)}setVisible(e){return this.setExcluded(!e)}toList(){return this}toArray(){return Gw(this._ogma.modules.graph,this)}clone(){return this._ogma.modules.graph.nodeList(this._indexes.slice())}getId(){return Wg(this._ogma.modules.graph,this)}get(e){return Hw(this._ogma.modules.graph,this,e)}forEach(e){Nw(this._ogma.modules.graph,this,e)}find(e){return Rw(this._ogma.modules.graph,this,e)}some(e){return Pw(this._ogma.modules.graph,this,e)}every(e){return Mw(this._ogma.modules.graph,this,e)}map(e){return Iw(this._ogma.modules.graph,this,e)}[Symbol.iterator](){let e=-1;return{next:()=>({value:this.get(++e),done:e>=this.size})}}filter(e){return kw(this._ogma.modules.graph,this,e)}reduce(e,t){return Dw(this._ogma.modules.graph,this,e,t)}concat(e){return Uw(this._ogma.modules.graph,this,e)}dedupe(){return Ow(this._ogma.modules.graph,this)}subtract(e){return zw(this,e,this._ogma.modules.graph)}slice(e,t){return this._ogma.modules.graph.nodeList(this._indexes.slice(e,t))}indexOf(e){return e instanceof Xr?this._indexes.indexOf(e._index):-1}includes(e){return this.indexOf(e)!==-1}inverse(){return Bw(this._ogma.modules.graph,this)}sort(e){return qw(this._ogma.modules.graph,this,e)}toJSON(e={}){return this.map(t=>t.toJSON(e))}setSelected(e){this._ogma.modules.selection.setActive(this,e)}isSelected(){return this._ogma.modules.selection.areActive(this)}locate(e){return this._ogma.modules.locate.locateElements(this,e)}getBoundingBox({includeTexts:e=!1}={}){return this._ogma.modules.locate.getBoundingBox(this,e,e)}setData(e,t){if(arguments.length<2&&(t=e,e=null),typeof t!="function"&&!bs(t))throw new Error(`invalid argument ${t}; expected array or function`);return this._ogma.modules.data.setProperty(this,e,t,{dispatch:!0}),this}fillData(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t,{dispatch:!1}),this}getData(e){return this._ogma.modules.data.getProperty(this,e||null)}addClass(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)}addClasses(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)}removeClass(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)}removeClasses(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)}hasClass(e){return this.map(t=>this._ogma.modules.classes.hasSingleElementClass(e,t))}getClassList(){return this._ogma.modules.classes.getElementsClassList(this)}getGeoCoordinates(){const e=this._ogma.modules.graph,t=new Array(this._indexes.length),n=e.getNodeAttribute(ui).getMultiple(this._indexes),s=e.getNodeAttribute(di).getMultiple(this._indexes);for(let r=0,i=this._indexes.length;r<i;r++)t[r]={latitude:n[r],longitude:s[r]};return t}setGeoCoordinates(e){const t=this._ogma.modules.geo,n=this.getId(),s=this._indexes,r=new Array(s.length),i=new Array(s.length);if(e===null&&(e=new Array(s.length).fill(null)),e.length!==s.length)throw new RangeError("You must provide coordinates for each node in the NodeList");for(let u=0,d=s.length;u<d;u++){let{latitude:c,longitude:g}=e[u]||{latitude:void 0,longitude:void 0};const f=n[u];c==null&&g==null?c=g=void 0:(S1(f,c),E1(f,g)),r[u]=c,i[u]=g}this.setData(t.latitudePath,r),this.setData(t.longitudePath,i);const{dom:o,graph:a}=this._ogma.modules;return RM(a,this,r,i),this._ogma.modules.geo.isEnabled()?o.afterNextFrame().then(()=>o.afterNextFrame()).then(()=>this):o.afterNextFrame().then(()=>this)}getAnimationInformation(){return this._ogma.modules.graphics.getAnimationInformation(this)}getMetaNode(){return this._ogma.modules.transformations.getMetaNodes(this)}getSubNodes(){return this.map(this._ogma.modules.transformations.getSubNodes)}pulse(e){return this._ogma.modules.pulses.pulse(this,e)}};Xg([Ki],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var yo=()=>(e,t)=>e[t],xo=()=>(e,t,n)=>{e[t]=n},Eb={1:Xp(1),2:Xp(2),4:Xp(4),8:yo(),16:yo(),32:yo(),int8:yo(),int16:yo(),int32:yo(),float:yo(),any:yo()},Sb={1:Yp(1),2:Yp(2),4:Yp(4),8:xo(),16:xo(),32:xo(),int8:xo(),int16:xo(),int32:xo(),float:xo(),any:xo()};function Xp(e){const t=8/e,n=(1<<e)-1;return(s,r)=>s[r/t|0]>>r%t*e&n}function Yp(e){const t=8/e,n=Math.pow(2,e)-1;return(s,r,i)=>{const o=r%t*e,a=r/t|0,u=i<<o,d=255-(n-i<<o);s[a]=s[a]&d|u}}function jM(e,t){return e===void 0&&t!=="any"&&t!=="resource"?0:e}var HM={get(e){return this._getArrayElt(this._buffer,e)},set(e,t){this._setArrayElt(this._buffer,e,t)}},qM={get(e){return this._byIndex[this._getArrayElt(this._buffer,e)]},set(e,t){let n=this._byName[t];n===void 0&&(n=this._nextIndex++,this._byIndex.push(t),this._getElementBitSize()>this._elementSize&&this.increaseElementSize(),this._byName[t]=n),this._setArrayElt(this._buffer,e,n)}},$M=0,fg=class{constructor(e){this._id=$M++,this._initialized=!1;const t=e.name,n=e.storage,s=e.size||0,r=jM(e.default,n),i=Math.max(8,Ab(s+1)),o=n==="resource"?1:n;this._name=t,this._storage=n,this._getArrayElt=Eb[o],this._setArrayElt=Sb[o],this._elementSize=o,this._nbElements=i,this._fallback=null,this._byName=void 0,this._byIndex=void 0,this._nextIndex=void 0,this._defaultValue=r,this._BASE_VALUE=n==="any"?void 0:0,this._methods=HM,this._initialized=!1,this._buffer=null,n==="resource"&&(this._methods=qM,this._byName=Object.create(null),this._byIndex=[],this._nextIndex=1,this._byName[r]=0,this._byIndex.push(r))}getValues(){return Object.keys(this._byName||{})}getName(){return this._name||""}setDefaultValue(e){this._defaultValue=e,this._storage==="resource"&&(this._byName[e]=0,this._byIndex[0]=e)}get(e){return this._get(e)}set(e,t){this._set(e,t)}_get(e){return this._defaultValue}_set(e,t){t!==this._defaultValue&&(this._initialize(),this._set(e,t))}setFallback(e){this._fallback=e,this.get=this._getWithFallback}_getWithFallback(e){const t=this._get(e);return t===void 0&&this._fallback?this._fallback.get(e):t}_initialize(){this._initialized=!0,this._buffer=Zp(this._nbElements,this._elementSize),this._get=this._methods.get,this._set=this._methods.set,this._storage!=="resource"&&this._defaultValue!==this._BASE_VALUE&&this._reset(0)}grow(e){const t=Ab(e+1);if(!(t<=this._nbElements)){if(this._initialized)if(this._elementSize==="any")for(let n=this._nbElements;n<t;++n)this._buffer.push(this._defaultValue);else{const n=Zp(t,this._elementSize);n.set(this._buffer),this._buffer=n,this._storage!=="resource"&&this._defaultValue!==this._BASE_VALUE&&this._reset(this._nbElements)}this._nbElements=t}}increaseElementSize(){const e=this._elementSize;if(typeof e!="number"||e===32)throw new Error("FlexArray: cannot increase element size");const t=2*e,n=Eb[t],s=Sb[t];if(this._initialized){const r=this._nbElements,i=this._getArrayElt,o=this._buffer,a=Zp(r,t);if(e>=8)a.set(o);else for(let u=0;u<r;++u)s(a,u,i(o,u));this._buffer=a}this._elementSize=t,this._getArrayElt=n,this._setArrayElt=s}buffer(){if(!this._buffer)throw new Error("FlexArray: buffer not instantiated");return this._buffer}elementBitSize(){return this._elementSize}capacity(){return this._nbElements}byteSize(){return this._nbElements*this._elementSize/8}isInitialized(){return this._initialized||this._fallback&&this._fallback.isInitialized()}getMultiple(e,t){const n=e.length;t===void 0&&(t=new Array(n));for(let s=0,r=n;s<r;++s)t[s]=this.get(e[s]);return t}fill(e,t){for(let n=0,s=e.length;n<s;++n)this.set(e[n],t)}setMultiple(e,t,n){if(n||!Array.isArray(t)&&!ArrayBuffer.isView(t))for(let s=0,r=e.length;s<r;++s)this.set(e[s],t);else for(let s=0,r=e.length;s<r;++s)this.set(e[s],t[s])}reset(){return this._initialized&&this._reset(0),this}_reset(e){const t=this._storage==="resource"?0:this._defaultValue;if(this._buffer)if(typeof this._elementSize!="number"||this._elementSize>=8)this._buffer.fill(t,e);else{const n=8/this._elementSize;let s=0;for(let r=0;r<n;++r)s<<=this._elementSize,s+=t;if(e===void 0)this._buffer.fill(s);else{const r=e+(8-e%8);for(let i=e;i<r;++i)this._setArrayElt(this._buffer,i,t);this._buffer.fill(s,r/8)}}}_getElementBitSize(){if(this._nextIndex)return Math.pow(2,Math.ceil(Math.log2(Math.log2(this._nextIndex))))}};function Ab(e){let t=2;for(;t<e;)t*=2;return t}function Zp(e,t){return t==="any"?new Array(e):t==="float"?new Float32Array(e):t==="int8"?new Int8Array(e):t==="int16"?new Int16Array(e):t==="int32"?new Int32Array(e):t===32?new Uint32Array(e):t===16?new Uint16Array(e):new Uint8Array(Math.ceil(e/8*t))}var wb=4,w1=class{constructor(){this._buffer=new Uint32Array(wb),this._capacity=wb,this._size=0,this._busy=!1}isBusy(){return this._busy}markBusy(){return this._busy=!0,this}sliceAndReset(){this._busy=!1;const e=this.slice(0,this._size);return this.reset(),e}reset(){return this._size=0,this}reserve(e){return e>this._capacity&&this._setCapacity(Co(e)),this}_setCapacity(e){const t=new Uint32Array(e);t.set(this._buffer),this._buffer=t,this._capacity=e}push(e){return this._size===this._capacity&&this._setCapacity(2*this._capacity),this._buffer[this._size++]=e,this}pushUnchecked(e){return this._buffer[this._size++]=e,this}slice(e=0,t=this._size){return this._buffer.slice(e,t)}getBuffer(){return this._buffer}getLength(){return this._size}getCapacity(){return this._capacity}setLength(e){return this._size=e,this}isEmpty(){return this._size===0}},Tb=class{constructor(e){this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._flexArrays=[],this._defaultValues=[],this._flexArraysByName={},this._indexLists=[],this._name=e?"node":"edge",this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._idFlexArray=new fg({storage:"int32"}),this._idFlexArray.get=t=>this._indexToId[t],this._idFlexArray.getMultiple=t=>{const n=new Array(t.length);for(let s=0;s<t.length;++s)n[s]=this._indexToId[t[s]];return n},this._flexArraysByName.id=this._idFlexArray}addElements(e){const t=[];for(let n=0,s=e.length;n<s;++n){const r=e[n];let i=this._idToIndex[r];i===void 0&&(i=this._getNextIndex(),this._idToIndex[r]=i,this._indexToId[i]=r),t.push(i)}for(const n of this._flexArrays)n.grow(this._nextIndex);for(const n of this._indexLists)n.reserve(this._nextIndex);return new Uint32Array(t)}removeElements(e){for(let t=0,n=e.length;t<n;++t){const s=e[t],r=this._indexToId[s];r!==void 0&&(delete this._idToIndex[r],this._removeIndex(s))}}clear(){this._idToIndex=Object.create(null),this._indexToId=[void 0],this._nextIndex=1,this._freeIndexes=[];for(const e of this._flexArrays)e.reset();for(const e of this._indexLists)e.reset()}has(e){return this._indexToId[e]!==void 0}getIndex(e,t=!1){const n=this._idToIndex[e];if(n===void 0&&t)throw new Error(`${this._name} id "${e}" not found`);return n}createFlexArray(e,t){const{name:n}=e;if(n&&t&&this._flexArraysByName[n])throw new Error(`${this._name} flexArray "${n}" already exists`);let s=e.default;s===void 0&&e.storage!=="any"&&e.storage!=="resource"&&(s=0);const r=this._nextIndex,i={storage:e.storage,size:r,name:n,default:s};let o;return o=(s===void 0&&e.storage!=="any"&&e.storage,new fg(i)),this._flexArrays.push(o),this._defaultValues.push(e.default),n&&t&&(this._flexArraysByName[n]=o),o}getFlexArray(e){return this._flexArraysByName[e]}getAllFlexArrays(){return this._flexArraysByName}createIndexList(){const e=new w1;return e.reserve(this._nextIndex),this._indexLists.push(e),e}getId(e){return this._indexToId[e]}getMaxIndex(){return this._nextIndex-1}_removeIndex(e){this._indexesToBeFreed.push(e)}_getNextIndex(){let e=this._freeIndexes.pop();return e===void 0&&(e=this._nextIndex++),e}freeIndexes(){for(const e of this._indexesToBeFreed)this._indexToId[e]=void 0,this._freeIndexes.push(e);for(let e=0;e<this._flexArrays.length;++e){const t=this._flexArrays[e],n=this._defaultValues[e];for(const s of this._indexesToBeFreed)t.set(s,n)}this._indexesToBeFreed=[]}},Cb=(e,t)=>(e+t)*(e+t+1)/2+t;function Au(e,t){const n=e<t?e:t;return 67108864*n+(e+t-n)}var WM=8,r_=class{constructor(){this._BIG_LIST=255,this._MAX_LIST_SIZE=8,this._capacity=WM,this._buffer=new Uint32Array(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._constList=new Array(this._MAX_LIST_SIZE)}addEntry(e){return e===void 0&&(e=this._nextIndex++),e>=this._capacity&&this._reserve(e+1),this._sizes[e]=0,e}get(e){const t=this._sizes[e],n=this._MAX_LIST_SIZE*e;if(t<=this._MAX_LIST_SIZE){this._constList.length=t;for(let s=0,r=t;s<r;++s)this._constList[s]=this._buffer[n+s];return this._constList}if(t===this._BIG_LIST){const s=this._buffer[n];return this._bigLists[s]}throw new Error(`Table: ${e} out of bounds (${t})`)}size(e){const t=this._sizes[e];return t<=this._MAX_LIST_SIZE?t:this._bigLists[this._buffer[e*this._MAX_LIST_SIZE]].length}sizes(e){const t=this._sizes,n=this._bigLists,s=this._buffer,r=this._MAX_LIST_SIZE,i=e.length,o=new Array(i);for(let a=0;a<i;a++){const u=e[a],d=t[u];o[a]=d<=r?d:n[s[u*r]].length}return o}addTo(e,t){const n=this._sizes[e],s=e*this._MAX_LIST_SIZE;if(n<this._MAX_LIST_SIZE)this._buffer[s+n]=t,this._sizes[e]=n+1;else if(n===this._BIG_LIST){const r=this._buffer[s];this._bigLists[r].push(t)}else{const r=new Array(this._MAX_LIST_SIZE);for(let i=0;i<this._MAX_LIST_SIZE;++i)r[i]=this._buffer[s+i];r.push(t),this._bigLists.push(r),this._sizes[e]=this._BIG_LIST,this._buffer[s]=this._bigLists.length-1}return this}removeFrom(e,t){return this.removeFromAndGetSize(e,t),this}removeFromAndGetSize(e,t){const n=this._MAX_LIST_SIZE*e;let s=this._sizes[e];if(s<=this._MAX_LIST_SIZE){for(let r=n,i=n+s;r<i;++r)if(this._buffer[r]===t)return s-=1,this._buffer[r]=this._buffer[i-1],this._sizes[e]=s,s}else if(s===this._BIG_LIST){const r=this._buffer[n],i=this._bigLists[r],o=i.indexOf(t);if(o!==-1)return i.splice(o,1),i.length}throw new Error('topology: Table: "removeFrom" failed, should not happen')}reserve(e){return this._capacity<e&&this._reserve(e),this}_reserve(e){this._capacity=Math.pow(2,Math.ceil(Math.log2(e))),this._buffer=Lb(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=Lb(this._sizes,this._capacity)}};function Lb(e,t){const n=new e.constructor(t);return n.set(e),n}var XM=1,YM=2,ZM=3,KM=4,QM=5,JM=6,i_="_visible",o_="_data",nd="_hovered",a_="_hoverExtremityHighlighted",Nn="_selected",l_="_selectionExtremityHighlighted",$c="_dragged",T1="_rewirable",la="_export",C1="_faded",L1="_transparent",eP="_visual_groups",Rd=-1,tc="in",nc="out",Kp="both",Nb=[Nn,$c,l_,nd,a_,T1,la,C1,L1,eP],N1=2,I1=3,tP=3,nP=4,k1=-1,sP=["hover","zoom","panning","rotation","gesture","drag","selection","tooltip","user","interactions","resizing","rewiring","connectNodes","lasso"],rP=15,rl=void 0,iP=class{constructor(e){this._neighborTable=new r_,this._parallelTable=new r_,this._parallelEdgesIndex=[],this._hasParallelEdges=new Set,this._fakeDeduper={get:()=>0,set:Vt,reset(){return this}},this._fakeInvertedDeduper={get:()=>1,set:Vt,reset(){return this}},this._graph=e,this.nodeDeduper=e.createNodeAttribute({storage:1},!1),this.edgeDeduper=e.createEdgeAttribute({storage:1},!1),this._sourceList=e.getEdgeAttribute("source"),this._targetList=e.getEdgeAttribute("target")}getAdjacentDirections(e){return this._neighborTable.get(e)}getEdgeIndexesInDirection(e){return this._parallelTable.get(e)}allocateNodes(e){this._neighborTable.reserve(e.length);for(let t=0;t<e.length;++t)this._neighborTable.addEntry(e[t])}allocateEdges(e,t,n){this._parallelTable.reserve(Math.floor(e.length/2));for(let s=0;s<e.length;s++){const r=e[s],i=t[s],o=n[s];this._sourceList.set(r,i),this._targetList.set(r,o),this.addToAdjacencyList(r)}}getExtremity(e,t){const n=e?this._sourceList:this._targetList;if(t.isList){const s=this._graph.acquireIndexList(!0);for(let r=0;r<t._indexes.length;r++)s.push(n.get(t._indexes[r]));return this._graph.nodeList(s.sliceAndReset())}return this._graph.getObjectList(!0).get(n.get(t._index))}setExtremities(e,t,n){for(let s=0;s<e.length;++s)this.removeFromAdjacencyList(e[s]);t!==null&&this._sourceList.setMultiple(e,t),n!==null&&this._targetList.setMultiple(e,n);for(let s=0;s<e.length;++s)this.addToAdjacencyList(e[s])}addToAdjacencyList(e){const t=this._sourceList.get(e),n=this._targetList.get(e),s=Au(t,n);let r=this._parallelEdgesIndex[s];if(r===rl)r=this._parallelTable.addEntry(),this._parallelEdgesIndex[s]=r,this._neighborTable.addTo(t,r),t!==n&&this._neighborTable.addTo(n,r);else{this._hasParallelEdges.add(e);const i=this._parallelTable.get(+r);if(i)for(const o of i)this._hasParallelEdges.add(o)}this._parallelTable.addTo(r,e)}hasParallelEdges(e){return this._hasParallelEdges.has(e)}removeFromAdjacencyList(e){const t=this._sourceList.get(e),n=this._targetList.get(e),s=Au(t,n),r=this._parallelEdgesIndex[s];r!==rl&&this._parallelTable.removeFromAndGetSize(r,e)===0&&(this._neighborTable.removeFrom(t,r),t!==n&&this._neighborTable.removeFrom(n,r),this._parallelEdgesIndex[s]=rl,this._hasParallelEdges.delete(e))}getParallelEdges(e,t={}){const n=t.filter||"visible",s=this._graph.acquireIndexList(!1),r=this._graph.getFilter(!1,n);for(let i=0;i<e._indexes.length;i++){const o=e._indexes[i],a=Au(this._sourceList.get(o),this._targetList.get(o)),u=this._parallelEdgesIndex[a];if(u!==rl){const d=this._parallelTable.get(+u);if(d)for(const c of d)r(c)&&s.push(c)}}return this._graph.edgeList(s.sliceAndReset())}fastGetNodesAdjacentElements(e){const t=this._graph.acquireIndexList(!0),n=this._graph.acquireIndexList(!1),s=this._sourceList,r=this._targetList;for(let i=0;i<e.length;i++){const o=e[i],a=this._neighborTable.get(o);for(const u of a){const d=this._parallelTable.get(u),c=d[0],g=s.get(c),f=r.get(c);if(g!==0&&f!==0){t.push(g+f-o);for(const p of d)n.push(p)}}}return{nodes:this._graph.nodeList(t.sliceAndReset()),edges:this._graph.edgeList(n.sliceAndReset())}}fastGetEdgesAdjacentElements(e){const t=this._graph.acquireIndexList(!0),n=this._graph.acquireIndexList(!1),s=this._sourceList,r=this._targetList;for(let i=0;i<e.length;i++){const o=e[i],a=s.get(o),u=r.get(o),d=Au(a,u),c=this._parallelEdgesIndex[d];if(c!==rl){const g=this._parallelTable.get(+c);if(g)for(const f of g)n.push(f)}t.push(a),t.push(u)}return{nodes:this._graph.nodeList(t.sliceAndReset()),edges:this._graph.edgeList(n.sliceAndReset())}}getDeduper(e){return(e?this.nodeDeduper:this.edgeDeduper).reset()}collectAdjacentEdges(e,t,n,s=!1,r=!1){const i=t===tc,o=!(t===nc||i||r),a=this._graph.acquireIndexList(!1),u=this._graph.getFilter(!1,n),d=s?this.getDeduper(!1):this._fakeDeduper;let c=this._fakeInvertedDeduper;const g=this._sourceList,f=this._targetList;if(r){c=this.getDeduper(!0);for(let p=0;p<e.length;p++)c.set(e[p],1)}for(let p=0;p<e.length;p++){const _=e[p],y=this._neighborTable.get(_);for(const x of y){const E=this._parallelTable.get(x);if(o)for(const b of E)u(b)&&d.get(b)===0&&(a.push(b),d.set(b,1));else for(const b of E){const S=g.get(b),A=f.get(b),C=S+A-_;i!==(A===_)&&S!==A||!u(b)||d.get(b)!==0||c.get(C)!==1||(a.push(b),d.set(b,1))}}}return a.sliceAndReset()}collectAdjacentNodes(e,t,n,s=!1,r,i){const o=t!==tc,a=t!==nc,u=this._graph.acquireIndexList(!0),d=this._graph.getFilter(!1,n),c=s?this.getDeduper(!0):this._fakeDeduper,g=this._sourceList,f=this._targetList;if(r)for(let p=0;p<r.length;p++){const _=r[p];u.push(_),c.set(_,1)}if(i)for(let p=0;p<i.length;p++){const _=i[p];c.set(_,1)}for(let p=0;p<e.length;p++){const _=e[p],y=this._neighborTable.get(_);for(const x of y){const E=this._parallelTable.get(x);for(const b of E)if(d(b)){const S=g.get(b),A=f.get(b),C=S+A-_;if((a&&_===A||o&&_===S)&&c.get(C)===0){u.push(C),c.set(C,1);break}}}}return u.sliceAndReset()}getAdjacentElements(e,t,n={}){const s=n.direction||Kp,r=n.filter||"visible",i=n.policy||"union",o=!!n.bothExtremities;if(e){const a=i==="include-sources"?t:null,u=i==="exclude-sources"?t:null;return this.collectAdjacentNodes(t,s,r,!0,a,u)}return this.collectAdjacentEdges(t,s,r,!0,o)}getEdgesBetweenTwoNodes(e,t){const n=Au(e,t),s=this._parallelEdgesIndex[n];if(s===rl)return new Uint32Array;const r=this._parallelTable.get(+s);return new Uint32Array(r)}getConnectedComponents(e,{filter:t="visible",returnIds:n=!1,internalIndexes:s=!1}={}){const r=this._graph,i=[],o={},a=r.acquireIndexList(!0);let u;typeof t=="string"?u=r.getFilter(!0,t):(u=t,t="visible");for(let g=0;g<e.length;g++){const f=e[g];u(f)&&a.push(f)}const d=a.sliceAndReset(),c={filter:t};for(let g=0;g<d.length;g++){const f=d[g];if(!o[f]){const p=[f],_=[];for(;p.length!==0;){const y=p.pop();!o[y]&&u(y)&&(p.push.apply(p,this.getAdjacentElements(!0,new Uint32Array([y]),c)),o[y]=!0,_.push(y))}_.length>0&&i.push(_)}}if(n){const g=r.getNodeAttribute("id");for(let f=0;f<i.length;f++)i[f]=g.getMultiple(i[f])}else if(!s)for(let g=0;g<i.length;g++)i[g]=r.nodeList(new Uint32Array(i[g]));return i}getAdjacencyList({directed:e,ids:t,weight:n,nodes:s}){const r=e?nc:Kp,i=new Array(s.length),o=this._graph;for(let _=0;_<s.length;++_)i[_]=this.collectAdjacentEdges(new Uint32Array([s[_]]),r,"all");const a=o.getEdgeAttribute("source"),u=o.getEdgeAttribute("target"),d=o.getEdgeAttribute("width"),c=o.getNodeAttribute("id"),g=[],f=typeof n=="number",p=typeof n!="function"&&!f&&!!n;for(let _=0;_<i.length;_++){const y=i[_],x=s[_],E=y.length,b=t?new Array(E):new Uint32Array(E),S=new Array(E);for(let C=0;C<E;C++){const k=y[C],M=a.get(k),R=u.get(k);let O=e||x===M?R:M;if(t&&(O=c.get(O)),b[C]=O,n){if(f&&(S[C]=n),typeof n=="function"){const j=o.getNode(M),z=o.getNode(R);S[C]=n(j,z)}p&&(S[C]=d.get(k)||1)}}const A={nodes:b,id:t?c.get(x):x,...n&&{weights:S}};g.push(A)}return g}degrees(e,t){if(t!==tc&&t!==nc)return this._neighborTable.sizes(e);const n=new Array(e.length),s=t===tc;for(let r=0,i=e.length;r<i;r++)n[r]=this._degree(e[r],s);return n}_degree(e,t){const n=this._neighborTable.get(e),s=this._sourceList,r=this._targetList;let i=0;for(let o=0;o<n.length;++o){const a=this._parallelTable.get(n[o]);for(let u=0;u<a.length;++u){const d=a[u],c=s.get(d),g=r.get(d);if(t&&g===e||!t&&c===e){i+=1;break}}}return i}getDegree(e,t){const{direction:n,filter:s}=this._getDegreeOptions(t),r=new Array(e.length),i=new Uint32Array(1);for(let o=0;o<e.length;++o)i[0]=e[o],r[o]=this.collectAdjacentNodes(i,n,s).length;return r}_getDegreeOptions(e){const t={direction:Kp,filter:"visible"};return typeof e=="string"?t.direction=e:e&&(typeof e.direction=="string"&&(t.direction=e.direction),typeof e.filter=="string"&&(t.filter=e.filter)),t}},zt=class{constructor(e){this._ogma=e}_setModules(e){this._modules=e}onMounted(){}onReady(e){}destroy(e){}},oP=class extends zt{constructor(){super(...arguments),this.storage={nodes:new Tb(!0),edges:new Tb(!1),fetch(e){return e?this.nodes:this.edges}},this._promisesToResolve=[],this._nodeIndexLists=[],this._edgeIndexLists=[],this._onNewFrame=()=>{this.storage.nodes.freeIndexes(),this.storage.edges.freeIndexes()}}onMounted(){this._modules.events.register(["preAddElements","addNodes","addEdges","preAddGraph","postAddGraph","addGraph","excludedStateChange","clearGraph","afterRemoveNodes","beforeRemoveNodes","requestElementsToDelete","removeNodes","beforeRemoveEdges","afterRemoveEdges","removeEdges"]),[{name:"excluded",storage:1,default:1},{name:"removed",storage:1,default:1},{name:"virtual",storage:1,default:0}].forEach(e=>{this.createNodeAttribute(e,!0),this.createEdgeAttribute(e,!0)}),this.node=this._ogma.node,this.edge=this._ogma.edge,this.nodeList=this._ogma.nodeList,this.edgeList=this._ogma.edgeList,this._nodes=this.createAttribute(!0,{name:"object",storage:"any"},!0),this._edges=this.createAttribute(!1,{name:"object",storage:"any"},!0),this.createAttribute(!1,{name:"source",storage:32},!0),this.createAttribute(!1,{name:"target",storage:32},!0),this._nodeFilters=Qv(this.storage.nodes),this._edgeFilters=Qv(this.storage.edges),this._initialize(),this._modules.events.on("frame",this._onNewFrame)}onReady(e){if(e.graph){const{nodes:t,edges:n}=e.graph;t&&this.addNodes(t),n&&this.addEdges(n)}}createIndexList(e){return this.storage.fetch(e).createIndexList()}getDom(){return this._modules.dom}acquireIndexList(e){const t=e?this._nodeIndexLists:this._edgeIndexLists;let n=t.find(s=>!s.isBusy());return n||(n=this.createIndexList(e),t.push(n)),n.markBusy(),n}getObjectList(e){return e?this._nodes:this._edges}getListFactory(e){return e?this.nodeList:this.edgeList}getStorage(e){return e?this.storage.nodes:this.storage.edges}getFilter(e,t){const n=e?this._nodeFilters:this._edgeFilters;return n[t]||n.visible}fireEvent(e,t){this._modules.events.fire(e,t)}getCacheLists(e){return e?this._nodeCacheLists:this._edgeCacheLists}_resolvePromises(){const e=this._promisesToResolve;this._promisesToResolve=[],e.forEach(t=>t())}_initialize(){this._nodeCacheLists=Jv(()=>this.getNodeMaxIndex(),()=>this.acquireIndexList(!0),this._nodeFilters),this._edgeCacheLists=Jv(()=>this.getEdgeMaxIndex(),()=>this.acquireIndexList(!1),this._edgeFilters),this.topology=new iP(this),this._resolvePromises()}getNodeMaxIndex(){return this.storage.nodes.getMaxIndex()}getEdgeMaxIndex(){return this.storage.edges.getMaxIndex()}isExcluded(e){return this.storage.fetch(e.isNode).getFlexArray("excluded").getMultiple(e._indexes)}setExcluded(e,t){const n=t?1:0,s=e.isNode,r=this.storage.fetch(s),i=r.getFlexArray("excluded"),o=r.getFlexArray("removed"),a=this.acquireIndexList(s),u=this.getListFactory(s);for(let c=0;c<e._indexes.length;c++){const g=e._indexes[c],f=i.get(g),p=o.get(g);n!==f&&p===0&&a.push(g)}const d=a.sliceAndReset();if(d.length){this.getCacheLists(e.isNode).visible.invalidList();const c=u(d);i.setMultiple(d,n),this._modules.events.fire("excludedStateChange",{elements:c,value:t})}}addNode(e,t){return pg(this,!0,e,t)}addEdge(e,t){return pg(this,!1,e,t)}addNodes(e,t){return Rl(this,!0,e,t)}addEdges(e,t){return Rl(this,!1,e,t)}getExtremityIndex(e,t,n,s){if(t instanceof Xr)return t._index;{const r=this.storage.nodes.getIndex(t);if(!r&&!s)throw new Error(`addEdge(s): invalid ${n===0?"source":"target"} for edge "${e}"; node "${t}" does not exist`);return r}}getNodes(e){return this.getElements(!0,e)}getEdges(e){return this.getElements(!1,e)}getElements(e,t){const n=e?this.nodeList:this.edgeList,s=e?Ki:Ta,r=e?Xr:Mo;if(t&&typeof t!="string"){const i=this.acquireIndexList(e),o=this.storage.fetch(e);if(t instanceof r)i.push(t._index);else if(bs(t)){const a=t;for(const u of a)if(u instanceof r)i.push(u._index);else{const d=o.getIndex(u);d&&i.push(d)}}else if(t instanceof s){const a=this.getFilter(e,"all"),u=t;for(let d=0;d<u._indexes.length;d++){const c=u._indexes[d];a(c)&&i.push(c)}}return n(i.sliceAndReset())}{const i=t||"visible",o=this.getCacheLists(e)[i];if(!o)throw new Error(`getNodes/getEdges: unexpected argument "${i}"`);return n(o.getList())}}getNode(e){return this._getElement(!0,e)}getEdge(e){return this._getElement(!1,e)}_getElement(e,t){if(t instanceof(e?Xr:Mo))return t;const n=this.getStorage(e),s=this.getObjectList(e),r=n.getIndex(t);return r?s.get(r):void 0}clear(){this._modules.events.fire("clearGraph",{nodes:this.getNodes("all"),edges:this.getEdges("all")}),this.storage.nodes.clear(),this.storage.edges.clear(),this._initialize()}createAttribute(e,t,n=!1){return this.storage.fetch(e).createFlexArray(t,n)}createNodeAttribute(e,t){return this.createAttribute(!0,e,t)}createEdgeAttribute(e,t){return this.createAttribute(!1,e,t)}getAttribute(e,t){return this.storage.fetch(e).getFlexArray(t)}getAttributes(e,t){return t.map(n=>this.getAttribute(e,n))}getNodeAttribute(e){return this.storage.nodes.getFlexArray(e)}getNodeAttributes(e){return this.getAttributes(!0,e)}getEdgeAttribute(e){return this.storage.edges.getFlexArray(e)}getEdgeAttributes(e){return this.getAttributes(!1,e)}getAllNodeAttributes(){return this.storage.nodes.getAllFlexArrays()}getAllEdgeAttributes(){return this.storage.edges.getAllFlexArrays()}setSource(e,t){const n=this.getNode(t);n&&this.topology.setExtremities(e._indexes,n._indexes,null)}setTarget(e,t){const n=this.getNode(t);n&&this.topology.setExtremities(e._indexes,null,n._indexes)}getParallelEdges(e,t={}){return this.topology.getParallelEdges(e,t)}hasParallelEdges(e){return this.topology.hasParallelEdges(e._index)}getEdgesBetweenTwoNodes(e,t){return this.edgeList(this.topology.getEdgesBetweenTwoNodes(e._index,t._index))}getAdjacentDirections(e){return this.topology.getAdjacentDirections(e)}getEdgeIndexesInDirection(e){return this.topology.getEdgeIndexesInDirection(e)}fastGetNodesAdjacentElements(e){const t=this._ogma.getNodes();let n=!1;if(t.size===e.size){const s=new Set(e._indexes);for(let r=0;r<t.size;r++)s.delete(t._indexes[r]);n=s.size===0}return n?{nodes:t,edges:this._ogma.getEdges()}:this.topology.fastGetNodesAdjacentElements(e._indexes)}fastGetEdgesAdjacentElements(e){const t=this._ogma.getEdges();let n=!1;if(t.size===e.size){const s=new Set(e._indexes);for(let r=0;r<t.size;r++)s.delete(t._indexes[r]);n=s.size===0}return n?{nodes:this._ogma.getNodes(),edges:t}:this.topology.fastGetEdgesAdjacentElements(e._indexes)}getAdjacentNodes(e,t){return this.nodeList(this.topology.getAdjacentElements(!0,e._indexes,t))}getAdjacentEdges(e,t){return this.edgeList(this.topology.getAdjacentElements(!1,e._indexes,t))}getDegree(e,t){return this.topology.getDegree(e._indexes,t)}degrees(e,t){return this.topology.degrees(e,t)}getAdjacencyList({directed:e=!1,internalIndexes:t=!1,weight:n=1,nodes:s,indexes:r}={}){return this.topology.getAdjacencyList({directed:e,weight:n,ids:!t,nodes:r||this.getNodes(s)._indexes})}getConnectedComponents(e,t){return this.topology.getConnectedComponents(e._indexes,t)}getConnectedComponentByNode(e,t){return this.topology.getConnectedComponents(e._indexes,t)}};function pg(e,t,n={},s={}){return pd(e,t,[n],s).get(0)}function aP(e,{nodes:t=[],edges:n=[]},s={}){if(e.fireEvent("preAddGraph",{name:"preAddGraph"}),!s.batchSize)return Promise.all([pd(e,!0,t,s),pd(e,!1,n,s)]).then(([i,o])=>(e.fireEvent("postAddGraph",{name:"postAddGraph"}),e.fireEvent("addGraph",{nodes:i,edges:o}),{nodes:i,edges:o}));let r;return Rl(e,!0,t,s).then(i=>(r=i,Rl(e,!1,n,s))).then(i=>({nodes:r,edges:i})).then(i=>(e.fireEvent("postAddGraph",{name:"postAddGraph"}),e.fireEvent("addGraph",{name:"addGraph"}),i))}function Rl(e,t,n,s={}){if(s.batchSize){const r=[];for(let a=0;a<n.length;a+=s.batchSize)r.push(n.slice(a,a+s.batchSize));const i=(a,u)=>{let d;return a.then(c=>(d=c,e.getDom().afterNextFrame())).then(()=>pd(e,t,u,s)).then(c=>d.concat(c))},o=t?e.nodeList():e.edgeList();return r.reduce(i,Promise.resolve(o))}return Promise.resolve(pd(e,t,n,s))}function pd(e,t,n,s){const{virtual:r=!1}=s;e.fireEvent("preAddElements",{name:"preAddElements",objects:n,virtual:r,isNode:t});const i=!!s.ignoreInvalid,o=e.storage.fetch(t),a=[],u=[],d=[],c=[],g=new Set;for(const C of n){if(typeof C!="object"||C===null||Array.isArray(C)){if(i)continue;throw new Error(`${C} is not a valid ${t?"node":"edge"}`)}const k=Fk(C.id);if(!o.getIndex(k,!1)&&!g.has(k)){if(!t){const M=C,R=e.getExtremityIndex(k,M.source,0,i),O=e.getExtremityIndex(k,M.target,1,i);if(i&&(!R||!O))continue;d.push(R),c.push(O)}u.push(k),a.push(C),g.add(k)}}const f=o.addElements(u);t?e.topology.allocateNodes(f):e.topology.allocateEdges(f,d,c);const p=o.getFlexArray("object"),_=o.getFlexArray("excluded"),y=o.getFlexArray("removed"),x=o.getFlexArray("virtual"),E=t?e.node:e.edge,b=t?e.nodeList:e.edgeList,S=e.getCacheLists(t),A=b(f);for(let C=0;C<f.length;C++){const k=f[C];p.set(k,E(k))}return _.setMultiple(f,0),y.setMultiple(f,0),x.setMultiple(f,r?1:0),S.visible.invalidList(),S.all.invalidList(),S._all.invalidList(),r||S.raw.invalidList(),A.size!==0&&(t?e.fireEvent("addNodes",{virtual:r,objects:a,nodes:A}):e.fireEvent("addEdges",{virtual:r,objects:a,edges:A})),A}function lP(e,t,n){return Fd(e,!0,[t],n)}function uP(e,t,n){return Fd(e,!1,[t],n)}function dP(e,t,n){return Fd(e,!0,t,n)}function hP(e,t,n){return Fd(e,!1,t,n)}function Fd(e,t,n,s={}){Array.isArray(n)||n instanceof(t?Ki:Ta)||(n=[n]);const{virtual:r=!1}=s,i={elementsToRemove:e.getElements(t,n)};e.fireEvent("requestElementsToDelete",i);let{elementsToRemove:o}=i;if(!o.size)return Promise.resolve();o=o.dedupe();const a=e.storage.fetch(t),u=a.getFlexArray("removed");o=o.filter(f=>u.get(f._index)===0),t&&Fd(e,!1,o.getAdjacentEdges({filter:"all"}),s);const d=o._indexes,c=e.getCacheLists(t),g={virtual:r,[t?"nodes":"edges"]:o};if(e.fireEvent(t?"beforeRemoveNodes":"beforeRemoveEdges",g),c.visible.invalidList(),c.all.invalidList(),c.raw.invalidList(),e.setExcluded(o,!0),u.setMultiple(d,1),!t)for(let f=0;f<d.length;++f)e.topology.removeFromAdjacencyList(d[f]);return a.removeElements(d),e.fireEvent(t?"removeNodes":"removeEdges",g),e.fireEvent(t?"afterRemoveNodes":"afterRemoveEdges",g),Promise.resolve()}var cP=class{addNodes(e,t){return Rl(this.modules.graph,!0,e,t)}addEdges(e,t){return Rl(this.modules.graph,!1,e,t)}addNode(e,t){return pg(this.modules.graph,!0,e,t)}addEdge(e,t){return pg(this.modules.graph,!1,e,t)}removeNodes(e,t){return dP(this.modules.graph,e,t)}removeEdges(e,t){return hP(this.modules.graph,e,t)}removeNode(e,t){return lP(this.modules.graph,e,t)}removeEdge(e,t){return uP(this.modules.graph,e,t)}getNodes(e){return this.modules.graph.getNodes(e)}getEdges(e){return this.modules.graph.getEdges(e)}getNode(e){return this.modules.graph.getNode(e)}getEdge(e){return this.modules.graph.getEdge(e)}clearGraph(){this.modules.graph.clear()}setGraph(e,t){return this.modules.graph.clear(),this.addGraph(e,t)}addGraph(e,t){const n=this.modules.graph.getNodes().size===0,s=aP(this.modules.graph,e,t);return n?this.modules.locate.locateGraph({padding:30,ignoreZoomLimits:!0,duration:0}).then(()=>s):s}createNodeList(){return this.getNodes([])}createEdgeList(){return this.getEdges([])}getConnectedComponents(e={}){return this.modules.graph.getConnectedComponents(this.getNodes(e.filter),e)}getConnectedComponentByNode(e,t){const n=this.modules.graph.getNode(e);if(n===void 0)throw new Error(`getComponentByNode: cannot find node ${e}`);return this.modules.graph.getConnectedComponentByNode(n,t)[0]}},Ly={};function M1(e,t,n,s,r,i){let o=0;for(let a=0;a<s;a++)for(let u=0;u<s;u++){const d=i[a],c=i[u];if(d!==c){const g=e[d][c]*r,f=1/(g*g);if(f){const p=t[d]-t[c],_=n[d]-n[c];o+=f*Math.pow(g-Math.sqrt(p*p+_*_),2)}}}return o}function P1(e,t,n,s,r,i,o){let a=0;if(r===-1)return 0;for(let u=0;u<s;u++)for(let d=0;d<s;d++){const c=o[u],g=o[d];if(c!==g&&(c===r||g===r)){const f=e[c][g]*i,p=1/(f*f);if(p){const _=t[c]-t[g],y=n[c]-n[g];a+=p*Math.pow(f-Math.sqrt(_*_+y*y),2)}}}return a}function u_(e,t,n,s,r,i,o,a){o=o||0;let u=0,d=0;for(let c=0;c<s;c++)for(let g=0;g<s;g++){const f=a[c],p=a[g];if(f!==p){const _=e[f][p]*i,y=1/(_*_);if(y){const x=t[f]-t[p],E=n[f]-n[p],b=y*Math.pow(_-Math.sqrt(x*x+E*E),2);u+=b,f!==r&&p!==r||(d+=b)}}}return(1-o)*u+o*d}function d_(e,t,n,s,r,i,o,a,u){o=o||0;const d=t,c=n;(r=r===void 0?-1:r)===-1&&(o=0);const g=t[r],f=n[r];for(let p=0;p<s;p++){const _=a[p],y=u(e[r][p]),x=o/(y*y);if(y===0)continue;let E=0,b=0,S=0;const A=t[_],C=n[_];for(let M=0;M<s;M++){const R=a[M];if(R!==_){const O=e[_][R]*i,j=1/(O*O),z=t[R],X=n[R];if(j!==0){const oe=A-z,re=C-X,Q=oe*oe+re*re,he=Q<1e-12?0:1/Math.sqrt(Q);b+=(1-o)*j*(z+O*(A-z)*he),S+=(1-o)*j*(X+O*(C-X)*he)}E+=j}}const k=(1-o)*E+x;if(k!==0){const M=A-g,R=C-f;let O=M*M+R*R;O=O<1e-12?0:1/Math.sqrt(O);const j=y===0?0:x*(y*O);d[_]=(b+j*t[_])/k,c[_]=(S+j*n[_])/k}}return{x:d,y:c}}function gP(e,t,n,s,r,i,o,a){o=o||0;const u=t,d=n;let c;(r=r===void 0?-1:r)===-1&&(o=0);for(let g=0;g<s;g++){const f=a[g];let p=0,_=0,y=0;const x=t[f],E=n[f];for(let b=0;b<s;b++){const S=a[b];let A=0;if(S!==f){let C=0;const k=e[f][S]*i,M=1/(k*k);f!==r&&S!==r||(C=M);const R=(1-o)*M+o*C;if(p+=R,M!==0){const O=t[S],j=n[S],z=x-O,X=E-j,oe=z*z+X*X;oe>1e-6&&(A=1/Math.sqrt(oe)),_+=R*(O+k*(x-O)*A),y+=R*(j+k*(E-j)*A)}}}c=p,c!==0&&(u[f]=_/c,d[f]=y/c)}return{x:u,y:d}}function Yg(e=(r,i)=>r-i,t=[],n={},s=r=>r){let r=t.length;function i(a){for(;;){const u=2*a+1,d=u+1;let c=a;if(u<r&&e(t[u],t[c])<0&&(c=u),d<r&&e(t[d],t[c])<0&&(c=d),c===a)return a;const g=t[c];t[c]=t[a],t[a]=g,n[s(t[c])]=c,n[s(g)]=a,a=c}}return{get keys(){return n},get size(){return r},heapify:i,pop(){if(r<=0)return;if(r===1)return r--,t[0];const a=t[0];return t[0]=t[r-1],r--,i(0),a},decreaseKey(a,u){for(u!==void 0&&(t[a]=u,n[s(u)]=a);a>0;){const d=a-1>>1;if(!(e(t[d],t[a])>0))break;{const c=t[a];t[a]=t[d],t[d]=c,n[s(t[a])]=a,n[s(c)]=d,a=d}}return a},min:()=>t[0],remove(a){return this.decreaseKey(a,Number.NEGATIVE_INFINITY),this.pop()},push(a){r++;let u=r-1;for(t[u]=a;u>0;){const d=u-1>>1;if(!(e(t[d],t[u])>0))break;{const c=t[u];t[u]=t[d],t[d]=c,n[s(t[u])]=u,n[s(c)]=d,u=d}}return u},empty:()=>r<=0,toArray:()=>t.slice(0,r)}}function Ny({sources:e,targets:t,weights:n,source:s,target:r,undirected:i=!1,indexes:o,N:a}){if(!(a=o?o.length:a)||!isFinite(a)||a===0)throw new Error("Invalid number of nodes "+a);const u=new Float32Array(a),d=new Int32Array(a),c={},g=Number.POSITIVE_INFINITY;if(!n){n=[];for(let y=0;y<a;y++)n[y]=1}if(!o){o=new Uint32Array(a);for(let y=0;y<a;y++)o[y]=y+1}for(let y=0;y<a;y++)u[y]=g,d[y]=-1,c[o[y]]=y;u[c[s]]=0;let f=!1;for(let y=1;y<=a;y++){for(let x=0;x<n.length;x++){const E=e[x],b=t[x],S=c[E],A=c[b];if(S!==void 0&&A!==void 0){const C=n[x];let k=u[S]+C;u[S]!==g&&k<u[A]&&(u[A]=k,d[A]=E,f=!0),i&&(k=u[A]+C,u[A]!==g&&k<u[S]&&(u[S]=k,d[S]=b,f=!0))}}if(!f)break}if(f)for(let y=0;y<n.length;y++){const x=e[y],E=t[y],b=c[x],S=c[E];if(b!==void 0&&S!==void 0){const A=n[y];if(u[b]+A<u[S])return null}}let p=null,_=null;if(r!==void 0){const y=c[r];if(y!==void 0&&u[y]!==g){p=[];for(let x=r;x!==-1;x=d[c[x]])p.push(x);p=p.reverse(),_=u[y]}}return{distances:u,path:p,pathLength:_}}function Iy(e,t,n,s,r,i,o){s=s||e.map((x,E)=>E+1);const a=s.length,u=new Float32Array(a),d=new Int32Array(a),c=new Uint32Array(a),g=Number.POSITIVE_INFINITY,f={};if(a===0)return{distances:u,path:null,pathLength:null};if(!r){r={};for(let x=0;x<a;x++)r[s[x]]=x}for(let x=0;x<a;x++)u[x]=g,d[x]=-1,c[x]=f[x]=x;const p=Yg((x,E)=>u[x]-u[E],c,f);for(u[r[t]]=0,p.decreaseKey(f[r[t]]);p.size!==0;){const x=p.pop(),E=u[x],b=e[x];if(E===g)break;for(let S=0,A=b.nodes.length;S<A;S++){const C=b.nodes[S],k=i?1:o?o(s[x],C):b.weights?b.weights[S]:1,M=r[C];if(M===void 0)continue;const R=E+k;R<u[M]&&(u[M]=R,d[M]=x,p.decreaseKey(f[M]))}}let _=null,y=null;if(n!==void 0){const x=r[n];if(u[x]!==g){_=[];for(let E=x;E!==-1;E=d[E])_.push(s[E]);_.reverse(),y=u[n]}}return{distances:u,path:_,pathLength:y}}function h_({sources:e,targets:t,weights:n,indexes:s,adjacency:r,undirected:i,ignoreWeights:o}){const a=Number.POSITIVE_INFINITY,u=s?s.length:r.length;if(!s){s=new Uint32Array(u);for(let y=0;y<u;y++)s[y]=y+1}const d=new Array(u),c={};for(let y=0;y<u;y++){d[y]=new Float32Array(u);for(let x=0;x<u;x++)d[y][x]=y===x?0:a;c[s[y]]=y}const g=u,f=n.length;e=e.slice(),t=t.slice(),n=n.slice();for(let y=0;y<u;y++)e[f+y]=g,t[f+y]=s[y],n[f+y]=0,o&&(n[y]=1);const p=Ny({sources:e,targets:t,weights:n,undirected:i,N:u+1,source:g});if(p===null)throw new Error("Graph has negative weight loops");const _=p.distances;for(let y=0;y<n.length;y++){const x=c[e[y]],E=c[t[y]];x!==void 0&&E!==void 0&&(n[y]=n[y]+_[x]-_[E])}e=e.slice(0,f),t=t.slice(0,f),n=n.slice(0,f);for(let y=0;y<u;y++){const x=s[y],{distances:E}=Iy(r,x,void 0,s,c,!!o);for(let b=0;b<u;b++)d[y][b]=y===b?0:E[b]}return d}Id(Ly,{CyclesFinder:()=>Q1,Quadtree:()=>$1,bellmanFord:()=>Ny,betweenness:()=>eT,circlePack:()=>U1,circleSpread:()=>DP,constrainedStress:()=>u_,convexhull:()=>RP,detectCyclesDirected:()=>Z1,detectCyclesUndirected:()=>CR,detectCyclesUndirectedDFS:()=>LR,dijkstra:()=>Iy,distanceStress:()=>P1,fisheye:()=>G1,johnson:()=>h_,kruskal:()=>J1,largestEmptyCircle:()=>F1,minDisk:()=>Od,minHeap:()=>Yg,removeRadialOverlap:()=>g_,stressMinimizationStep:()=>d_,stressMinimizationStepGeneral:()=>gP,weightedStress:()=>M1});var Vi=11102230246251565e-32,Is=134217729,fP=(3+8*Vi)*Vi;function Qp(e,t,n,s,r){let i,o,a,u,d=t[0],c=s[0],g=0,f=0;c>d==c>-d?(i=d,d=t[++g]):(i=c,c=s[++f]);let p=0;if(g<e&&f<n)for(c>d==c>-d?(o=d+i,a=i-(o-d),d=t[++g]):(o=c+i,a=i-(o-c),c=s[++f]),i=o,a!==0&&(r[p++]=a);g<e&&f<n;)c>d==c>-d?(o=i+d,u=o-i,a=i-(o-u)+(d-u),d=t[++g]):(o=i+c,u=o-i,a=i-(o-u)+(c-u),c=s[++f]),i=o,a!==0&&(r[p++]=a);for(;g<e;)o=i+d,u=o-i,a=i-(o-u)+(d-u),d=t[++g],i=o,a!==0&&(r[p++]=a);for(;f<n;)o=i+c,u=o-i,a=i-(o-u)+(c-u),c=s[++f],i=o,a!==0&&(r[p++]=a);return i===0&&p!==0||(r[p++]=i),p}function pP(e,t){let n=t[0];for(let s=1;s<e;s++)n+=t[s];return n}function Dd(e){return new Float64Array(e)}var mP=(3+16*Vi)*Vi,_P=(2+12*Vi)*Vi,yP=(9+64*Vi)*Vi*Vi,il=Dd(4),Ib=Dd(8),kb=Dd(12),Mb=Dd(16),Vs=Dd(4);function xP(e,t,n,s,r,i,o){let a,u,d,c,g,f,p,_,y,x,E,b,S,A,C,k,M,R;const O=e-r,j=n-r,z=t-i,X=s-i;A=O*X,f=Is*O,p=f-(f-O),_=O-p,f=Is*X,y=f-(f-X),x=X-y,C=_*x-(A-p*y-_*y-p*x),k=z*j,f=Is*z,p=f-(f-z),_=z-p,f=Is*j,y=f-(f-j),x=j-y,M=_*x-(k-p*y-_*y-p*x),E=C-M,g=C-E,il[0]=C-(E+g)+(g-M),b=A+E,g=b-A,S=A-(b-g)+(E-g),E=S-k,g=S-E,il[1]=S-(E+g)+(g-k),R=b+E,g=R-b,il[2]=b-(R-g)+(E-g),il[3]=R;let oe=pP(4,il),re=_P*o;if(oe>=re||-oe>=re||(g=e-O,a=e-(O+g)+(g-r),g=n-j,d=n-(j+g)+(g-r),g=t-z,u=t-(z+g)+(g-i),g=s-X,c=s-(X+g)+(g-i),a===0&&u===0&&d===0&&c===0)||(re=yP*o+fP*Math.abs(oe),oe+=O*c+X*a-(z*d+j*u),oe>=re||-oe>=re))return oe;A=a*X,f=Is*a,p=f-(f-a),_=a-p,f=Is*X,y=f-(f-X),x=X-y,C=_*x-(A-p*y-_*y-p*x),k=u*j,f=Is*u,p=f-(f-u),_=u-p,f=Is*j,y=f-(f-j),x=j-y,M=_*x-(k-p*y-_*y-p*x),E=C-M,g=C-E,Vs[0]=C-(E+g)+(g-M),b=A+E,g=b-A,S=A-(b-g)+(E-g),E=S-k,g=S-E,Vs[1]=S-(E+g)+(g-k),R=b+E,g=R-b,Vs[2]=b-(R-g)+(E-g),Vs[3]=R;const Q=Qp(4,il,4,Vs,Ib);A=O*c,f=Is*O,p=f-(f-O),_=O-p,f=Is*c,y=f-(f-c),x=c-y,C=_*x-(A-p*y-_*y-p*x),k=z*d,f=Is*z,p=f-(f-z),_=z-p,f=Is*d,y=f-(f-d),x=d-y,M=_*x-(k-p*y-_*y-p*x),E=C-M,g=C-E,Vs[0]=C-(E+g)+(g-M),b=A+E,g=b-A,S=A-(b-g)+(E-g),E=S-k,g=S-E,Vs[1]=S-(E+g)+(g-k),R=b+E,g=R-b,Vs[2]=b-(R-g)+(E-g),Vs[3]=R;const he=Qp(Q,Ib,4,Vs,kb);A=a*c,f=Is*a,p=f-(f-a),_=a-p,f=Is*c,y=f-(f-c),x=c-y,C=_*x-(A-p*y-_*y-p*x),k=u*d,f=Is*u,p=f-(f-u),_=u-p,f=Is*d,y=f-(f-d),x=d-y,M=_*x-(k-p*y-_*y-p*x),E=C-M,g=C-E,Vs[0]=C-(E+g)+(g-M),b=A+E,g=b-A,S=A-(b-g)+(E-g),E=S-k,g=S-E,Vs[1]=S-(E+g)+(g-k),R=b+E,g=R-b,Vs[2]=b-(R-g)+(E-g),Vs[3]=R;const fe=Qp(he,kb,4,Vs,Mb);return Mb[fe-1]}function sc(e,t,n,s,r,i){const o=(t-i)*(n-r),a=(e-r)*(s-i),u=o-a,d=Math.abs(o+a);return Math.abs(u)>=mP*d?u:-xP(e,t,n,s,r,i,d)}var Pb=Math.pow(2,-52),rc=new Uint32Array(512),ky=class R1{static from(t,n=AP,s=wP){const r=t.length,i=new Float64Array(2*r);for(let o=0;o<r;o++){const a=t[o];i[2*o]=n(a),i[2*o+1]=s(a)}return new R1(i)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const s=Math.max(2*n-5,0);this._triangles=new Uint32Array(3*s),this._halfedges=new Int32Array(3*s),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:s,_hullTri:r,_hullHash:i}=this,o=t.length>>1;let a=1/0,u=1/0,d=-1/0,c=-1/0;for(let O=0;O<o;O++){const j=t[2*O],z=t[2*O+1];j<a&&(a=j),z<u&&(u=z),j>d&&(d=j),z>c&&(c=z),this._ids[O]=O}const g=(a+d)/2,f=(u+c)/2;let p,_,y;for(let O=0,j=1/0;O<o;O++){const z=Jp(g,f,t[2*O],t[2*O+1]);z<j&&(p=O,j=z)}const x=t[2*p],E=t[2*p+1];for(let O=0,j=1/0;O<o;O++){if(O===p)continue;const z=Jp(x,E,t[2*O],t[2*O+1]);z<j&&z>0&&(_=O,j=z)}let b=t[2*_],S=t[2*_+1],A=1/0;for(let O=0;O<o;O++){if(O===p||O===_)continue;const j=EP(x,E,b,S,t[2*O],t[2*O+1]);j<A&&(y=O,A=j)}let C=t[2*y],k=t[2*y+1];if(A===1/0){for(let z=0;z<o;z++)this._dists[z]=t[2*z]-t[0]||t[2*z+1]-t[1];_l(this._ids,this._dists,0,o-1);const O=new Uint32Array(o);let j=0;for(let z=0,X=-1/0;z<o;z++){const oe=this._ids[z],re=this._dists[oe];re>X&&(O[j++]=oe,X=re)}return this.hull=O.subarray(0,j),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(sc(x,E,b,S,C,k)<0){const O=_,j=b,z=S;_=y,b=C,S=k,y=O,C=j,k=z}const M=SP(x,E,b,S,C,k);this._cx=M.x,this._cy=M.y;for(let O=0;O<o;O++)this._dists[O]=Jp(t[2*O],t[2*O+1],M.x,M.y);_l(this._ids,this._dists,0,o-1),this._hullStart=p;let R=3;s[p]=n[y]=_,s[_]=n[p]=y,s[y]=n[_]=p,r[p]=0,r[_]=1,r[y]=2,i.fill(-1),i[this._hashKey(x,E)]=p,i[this._hashKey(b,S)]=_,i[this._hashKey(C,k)]=y,this.trianglesLen=0,this._addTriangle(p,_,y,-1,-1,-1);for(let O,j,z=0;z<this._ids.length;z++){const X=this._ids[z],oe=t[2*X],re=t[2*X+1];if(z>0&&Math.abs(oe-O)<=Pb&&Math.abs(re-j)<=Pb||(O=oe,j=re,X===p||X===_||X===y))continue;let Q=0;for(let we=0,Z=this._hashKey(oe,re);we<this._hashSize&&(Q=i[(Z+we)%this._hashSize],Q===-1||Q===s[Q]);we++);Q=n[Q];let he,fe=Q;for(;he=s[fe],sc(oe,re,t[2*fe],t[2*fe+1],t[2*he],t[2*he+1])>=0;)if(fe=he,fe===Q){fe=-1;break}if(fe===-1)continue;let ae=this._addTriangle(fe,X,s[fe],-1,-1,r[fe]);r[X]=this._legalize(ae+2),r[fe]=ae,R++;let me=s[fe];for(;he=s[me],sc(oe,re,t[2*me],t[2*me+1],t[2*he],t[2*he+1])<0;)ae=this._addTriangle(me,X,he,r[X],-1,r[me]),r[X]=this._legalize(ae+2),s[me]=me,R--,me=he;if(fe===Q)for(;he=n[fe],sc(oe,re,t[2*he],t[2*he+1],t[2*fe],t[2*fe+1])<0;)ae=this._addTriangle(he,X,fe,-1,r[fe],r[he]),this._legalize(ae+2),r[he]=ae,s[fe]=fe,R--,fe=he;this._hullStart=n[X]=fe,s[fe]=n[me]=X,s[X]=me,i[this._hashKey(oe,re)]=X,i[this._hashKey(t[2*fe],t[2*fe+1])]=fe}this.hull=new Uint32Array(R);for(let O=0,j=this._hullStart;O<R;O++)this.hull[O]=j,j=s[j];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(vP(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:s,coords:r}=this;let i=0,o=0;for(;;){const a=s[t],u=t-t%3;if(o=u+(t+2)%3,a===-1){if(i===0)break;t=rc[--i];continue}const d=a-a%3,c=u+(t+1)%3,g=d+(a+2)%3,f=n[o],p=n[t],_=n[c],y=n[g];if(bP(r[2*f],r[2*f+1],r[2*p],r[2*p+1],r[2*_],r[2*_+1],r[2*y],r[2*y+1])){n[t]=y,n[a]=f;const x=s[g];if(x===-1){let b=this._hullStart;do{if(this._hullTri[b]===g){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,x),this._link(a,s[o]),this._link(o,g);const E=d+(a+1)%3;i<rc.length&&(rc[i++]=E)}else{if(i===0)break;t=rc[--i]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,s,r,i,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=s,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}};function vP(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function Jp(e,t,n,s){const r=e-n,i=t-s;return r*r+i*i}function bP(e,t,n,s,r,i,o,a){const u=e-o,d=t-a,c=n-o,g=s-a,f=r-o,p=i-a,_=c*c+g*g,y=f*f+p*p;return u*(g*y-_*p)-d*(c*y-_*f)+(u*u+d*d)*(c*p-g*f)<0}function EP(e,t,n,s,r,i){const o=n-e,a=s-t,u=r-e,d=i-t,c=o*o+a*a,g=u*u+d*d,f=.5/(o*d-a*u),p=(d*c-a*g)*f,_=(o*g-u*c)*f;return p*p+_*_}function SP(e,t,n,s,r,i){const o=n-e,a=s-t,u=r-e,d=i-t,c=o*o+a*a,g=u*u+d*d,f=.5/(o*d-a*u);return{x:e+(d*c-a*g)*f,y:t+(o*g-u*c)*f}}function _l(e,t,n,s){if(s-n<=20)for(let r=n+1;r<=s;r++){const i=e[r],o=t[i];let a=r-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=i}else{let r=n+1,i=s;wu(e,n+s>>1,r),t[e[n]]>t[e[s]]&&wu(e,n,s),t[e[r]]>t[e[s]]&&wu(e,r,s),t[e[n]]>t[e[r]]&&wu(e,n,r);const o=e[r],a=t[o];for(;;){do r++;while(t[e[r]]<a);do i--;while(t[e[i]]>a);if(i<r)break;wu(e,r,i)}e[n+1]=e[i],e[i]=o,s-r+1>=i-n?(_l(e,t,r,s),_l(e,t,n,i-1)):(_l(e,t,n,i-1),_l(e,t,r,s))}}function wu(e,t,n){const s=e[t];e[t]=e[n],e[n]=s}function AP(e){return e[0]}function wP(e){return e[1]}function F1(e,t=1,n=0,s,r){if(!s||!r){const g=e.map(p=>[p.x,p.y]),f=ky.from(g,p=>p[0],p=>p[1]);s=hd(f.triangles,g),r=hd(f.hull,g)}if(!r)return[];const i=n*n,o=[],a={};for(let g=0;g<s.length;g+=3)if(TP(r,My(s[g],s[g+1],s[g+2]))){const f=LP(s[g],s[g+1],s[g+2]);f>i&&(o.push(g),a[g]=f)}if(o.length===0)return[];o.sort((g,f)=>a[g]-a[f]);let u=o[0],d=a[u];const c=[];for(let g=0;g<o.length;g++){const f=o[g],p=a[f];p>d&&p>i&&(u=f,d=p,c.push(u),c.length>t&&c.shift())}return c.map(g=>CP(s[g],s[g+1],s[g+2]))}function TP(e,t){const n=e.length,s=e[n-1],[r,i]=t;let[o,a]=s,u=!1;for(let d=0;d<n;d++){const c=e[d],[g,f]=c;f>i!=a>i&&r<(o-g)*(i-f)/(a-f)+g&&(u=!u),o=g,a=f}return u}function CP(e,t,n){const s=My(e,t,n);let r=0;for(let i=0;i<3;i++){const o=arguments[i],a=o[0]-s[0],u=o[1]-s[1],d=Math.sqrt(a*a+u*u);d>r&&(r=d)}return[s[0],s[1],r]}function LP(e,t,n){const[s,r]=My(e,t,n),[i,o]=e,a=s-i,u=r-o;return a*a+u*u}function My(e,t,n){const s=[(e[0]+t[0])/2,(e[1]+t[1])/2],r=[(t[0]+n[0])/2,(t[1]+n[1])/2],i=-1/((t[1]-e[1])/(t[0]-e[0])),o=-1/((n[1]-t[1])/(n[0]-t[0])),a=s[1]-i*s[0],u=(a-(r[1]-o*r[0]))/(o-i);return[u,i*u+a]}function Od(e,t,n,s){let r;if(s)r=s;else{r=new Uint32Array(e.length);for(let S=0,A=e.length;S<A;S++)r[S]=S}let i=e[r[0]],o=i,a=t[r[0]],u=a;for(let S=1;S<r.length;S++){const A=r[S],C=e[A],k=t[A];C<i&&(i=C),C>o&&(o=C),k<a&&(a=k),k>u&&(u=k)}const d=(i+o)/2,c=(a+u)/2;for(let S=0;S<r.length;S++){const A=r[S];e[A]-=d,t[A]-=c}function g(S,A,C,k,M,R){const O=C-R+1e-9*Math.max(C,R,1),j=k-S,z=M-A;return O>0&&O*O>j*j+z*z}function f(S,A,C,k,M,R,O){for(let j=0;j<k.length;++j){const z=k[j];if(!g(S,A,C,M[z],R[z],O[z]))return!1}return!0}function p(S,A,C,k,M,R){const O=k-S,j=M-A,z=R-C,X=Math.sqrt(O*O+j*j);return[(S+k+O/X*z)/2,(A+M+j/X*z)/2,(X+C+R)/2]}function _(S,A,C,k,M,R,O,j,z){const X=(S+k+O)/3,oe=(A+M+j)/3,re=S-X,Q=A-oe,he=k-X,fe=M-oe,ae=O-X,me=j-oe,we=re-he,Z=re-ae,_e=Q-fe,ze=Q-me,Re=R-C,We=z-C,st=re*re+Q*Q-C*C,ft=st-he*he-fe*fe+R*R,ut=st-ae*ae-me*me+z*z,ce=Z*_e-we*ze,be=(_e*ut-ze*ft)/(2*ce)-re,qe=(ze*Re-_e*We)/ce,Ue=(Z*ft-we*ut)/(2*ce)-Q,Ie=(we*We-Z*Re)/ce,Fe=qe*qe+Ie*Ie-1,Oe=2*(C+be*qe+Ue*Ie),Xe=be*be+Ue*Ue-C*C,dt=-(Math.abs(Fe)>1e-6?(Oe+Math.sqrt(Oe*Oe-4*Fe*Xe))/(2*Fe):Xe/Oe);return[X+re+be+qe*dt,oe+Q+Ue+Ie*dt,dt]}function y(S,A,C,k){switch(S.length){case 1:const M=S[0];return function(re,Q,he){return[re,Q,he]}(A[M],C[M],k[M]);case 2:const[R,O]=S;return p(A[R],C[R],k[R],A[O],C[O],k[O]);case 3:const[j,z,X]=S;return _(A[j],C[j],k[j],A[z],C[z],k[z],A[X],C[X],k[X]);default:return null}}function x(S,A,C,k,M,R){const O=C-R,j=k-S,z=M-A;return O<0||O*O<j*j+z*z}function E(S,A,C,k,M){const R=C[A],O=k[A],j=M[A];if(f(R,O,j,S,C,k,M))return[A];for(let z=0;z<S.length;++z){const X=S[z],oe=C[X],re=k[X],Q=M[X];if(x(R,O,j,oe,re,Q)){const[he,fe,ae]=p(oe,re,Q,R,O,j);if(f(he,fe,ae,S,C,k,M))return[S[z],A]}}for(let z=0;z<S.length-1;++z)for(let X=z+1;X<S.length;++X){const oe=S[z],re=S[X],Q=C[oe],he=k[oe],fe=M[oe],ae=C[re],me=k[re],we=M[re],Z=p(Q,he,fe,ae,me,we);if(x(Z[0],Z[1],Z[2],R,O,j)){const _e=p(Q,he,fe,R,O,j);if(x(_e[0],_e[1],_e[2],ae,me,we)){const ze=p(ae,me,we,R,O,j);if(x(ze[0],ze[1],ze[2],Q,he,fe)){const Re=_(Q,he,fe,ae,me,we,R,O,j);if(f(Re[0],Re[1],Re[2],S,C,k,M))return[oe,re,A]}}}}throw new Error}r=function(A){for(let C=A.length-1;C>=0;C--){let k=Math.floor(Math.random()*(C+1));k=Math.max(Math.min(k,C),0);const M=A[C];A[C]=A[k],A[k]=M}return A}(r),n=n||new Array(e.length).fill(0);const b=function(A,C,k,M,R){let O=null,j=[],z=0;for(;z<C;){const X=A[z];O&&g(O[0],O[1],O[2],k[X],M[X],R[X])?z++:(j=E(j,X,k,M,R),O=y(j,k,M,R),z=0)}return O}(r,r.length,e,t,n);b[0]+=d,b[1]+=c;for(let S=0;S<r.length;S++){const A=r[S];e[A]+=d,t[A]+=c}return b}var D1=[1/0,1/0,-1/0,-1/0];function mg(e,t,n,s,r,i={x:0,y:0}){const o=Math.cos(r),a=Math.sin(r),u=e-n,d=t-s;return i.x=o*u-a*d+n,i.y=a*u+o*d+s,i}function NP(e,t,n=0,s={x:0,y:0}){return s.x=e.x+n*Math.sin(t),s.y=e.y+n*Math.cos(t),s}var ss=(e,t,n,s)=>Math.hypot(e-n,t-s);function Wc(e,t,n,s){const r=e-n,i=t-s;return r*r+i*i}function O1(e){const t=Math.sqrt(e.x*e.x+e.y*e.y);return e.x/=t,e.y/=t,e}function c_(e){return 180*e/Math.PI}function IP(e){return e*Math.PI/180}function z1(e,t){return e.minX-=t,e.minY-=t,e.maxX+=t,e.maxY+=t,e.width===void 0&&(e.width=e.maxX-e.minX),e.height===void 0&&(e.height=e.maxY-e.minY),e.width+=2*t,e.height+=2*t,e}function Py(e,t,n,s,r,i){const o=s-e,a=r-t,u=Math.sqrt(o*o+a*a);if(u>n+i||u<Math.abs(n-i))return null;const d=(n*n-i*i+u*u)/(2*u),c=e+o*d/u,g=t+a*d/u,f=Math.sqrt(n*n-d*d),p=f/u*-a,_=o*(f/u);return[[c+p,g+_],[c-p,g-_]]}function Ry(e,t,n,s,r,i){if(e-r>=0&&n-r<0)return 1;if(e-r<0&&n-r>=0)return-1;if(e-r==0&&n-r==0)return t-s>=0||s-i>=0?t-s:s-t;const o=(e-r)*(s-i)-(n-r)*(t-i);return o<0?1:o>0?-1:(e-r)*(e-r)+(t-i)*(t-i)-((n-r)*(n-r)+(s-i)*(s-i))}function kP([e,t,n],s,r){const i=Math.abs(e-s),o=Math.abs(t-r);return i+o<=n||!(i>n||o>n)&&Math.sqrt(i*i+o*o)<n+1e-12}function MP(e,t,n,s){const r=e[0]-t,i=e[1]-n,o=e[2]-s;return r*r+i*i<o*o+1e-6}function Fy(e,t,n,s,r,i,o){const a=e-Math.max(s,Math.min(i,e)),u=t-Math.max(r,Math.min(o,t));return a*a+u*u<n*n}function B1(e,t,n,s,r,i,o,a={x:0,y:0}){const u=a||{x:0,y:0};let d,c,g,f;if(n===e){const E=e-r,b=o*o-E*E;if(b<0)return null;const S=Math.sqrt(b);d=e,g=e,c=i+S,f=i-S}else{const E=(s-t)/(n-e),b=t-E*e,S=b-i,A=E*E+1,C=2*(E*S-r),k=C*C-4*A*(r*r+S*S-o*o);if(k<0)return null;const M=-C,R=Math.sqrt(k),O=2*A;d=(M+R)/O,g=(M-R)/O,c=E*d+b,f=E*g+b}const p=e-d,_=t-c,y=e-g,x=t-f;return p*p+_*_<y*y+x*x?(u.x=d,u.y=c):(u.x=g,u.y=f),u}function g_({X:e,Y:t,sizes:n,indexes:s,R:r,center:i,gap:o=0,epsilon:a=.001,maxLoops:u=5,inPlace:d=!0}){const c=s.length,g=i[0],f=i[1];let p=c;d||(e=e.slice(),t=t.slice());const _=Py,y=Ry,x=s.slice().sort((j,z)=>y(e[j],t[j],e[z],t[z],g,f)),E=x[c-1],b=e[E],S=t[E];let A=!1;for(let j=0;j<p-1;j++){let z=j%c,X=(j+1)%c;j===-1&&(z=c-1,X=0),z=x[z],X=x[X];const oe=e[z],re=t[z];let Q=e[X],he=t[X];const fe=n[z]+n[X]+o;let ae=y(oe,re,Q,he,g,f);if(ae===-1&&A&&(ae=1),!(fe>r)){if(ae===1||fe-ss(oe,re,Q,he)>a){const me=_(g,f,r,oe,re,fe);if(me){const we=me[0];A=Q>g&&we[0]<g,Q=e[X]=we[0],he=t[X]=we[1]}}else A=!1;if(j%c==c-2){const me=x[c-1],we=x[0];if(t[me]>f&&t[we]>f&&e[me]-n[me]<e[we]+n[me]){let Z=0;for(p=Math.min(c*u,p+c);t[x[me]]>f&&t[x[0]]>f&&e[x[me]]<e[x[0]]&&++Z<c;){const _e=x.pop();_e&&x.unshift(_e)}}}}}const C=b-g,k=S-f,M=e[E]-g,R=t[E]-f,O=C===M?0:Math.abs(Math.acos((C*M+k*R)/(Math.sqrt(C*C+k*k)*Math.sqrt(M*M+R*R))));if(O!==0){const j=Math.sin(-O),z=Math.cos(-O);let X;for(let oe=0;oe<c;oe++){X=x[oe];const re=e[X]-g,Q=t[X]-f;e[X]=re*z-Q*j+g,t[X]=re*j+Q*z+f}}return{X:e,Y:t}}function Rb(e,t,n,s,r,i){const o={},a=n[e];let u=a,d=0;const c=a*r;for(const g in t){const f=t[g];let p=0,_=0;for(let b=0,S=f.length;b<S;b++){const A=n[f[b]];_=Math.max(_,A),p+=2*A+s}const y=p/(2*Math.PI),x=_+u,E=i?d+Math.max(i,x):d*r;d=Math.max(x,d,y,c,E),o[g]=d,u=_}return o[0]=0,o[Number.POSITIVE_INFINITY]=d,o}function PP(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(t[1]-e[1])*(n[0]-e[0])}function Fb(e){const t=e.length,n=[0,1];let s=2;for(let r=2;r<t;r++){for(;s>1&&PP(e[n[s-2]],e[n[s-1]],e[r])<=0;)--s;n[s++]=r}return n.slice(0,s)}function RP(e){const t=e.length;if(t<3)return null;const n=new Array(t),s=new Array(t);for(let g=0;g<t;g++)n[g]=[+e[g][0],+e[g][1],g];n.sort((g,f)=>g[0]-f[0]||g[1]-f[1]);for(let g=0;g<t;g++)s[g]=[n[g][0],-n[g][1]];const r=Fb(n),i=Fb(s),o=i[i.length-1],a=r[r.length-1],u=i[0]===r[0],d=o===a?1:0,c=[];for(let g=r.length-1;g>=0;--g)c.push(e[n[r[g]][2]]);for(let g=+u;g<i.length-d;g++)c.push(e[n[i[g]][2]]);return c}var Db=e=>--e*e*e+1,Ob=(e,t,n)=>{const s=e-n[0],r=t-n[1];return s*s+r*r},FP=(e,t)=>{let n=1/0,s=-1/0;for(let r=0;r<e.length;r++){const i=e[r],o=t?t[i]:i;n=Math.min(o,n),s=Math.max(o,s)}return{min:n,max:s}};function DP({X:e,Y:t,R:n,center:s,maxSteps:r=1e3,padding:i=5,epsilon:o=1e-9,damping:a=2,pinned:u=-1,indexes:d,onUpdate:c,pushSmallerOut:g=!0}){const f=d?d.length:e.length;let p=d;if(p===void 0){p=new Uint32Array(f);for(let A=0;A<f;A++)p[A]=A}else p=d;if(u!==-1)s=[e[u],t[u]];else if(!s){let A=0,C=0;for(let k=0;k<f;k++)A+=e[p[k]],C+=t[p[k]];s=[A/f,C/f]}const{min:_,max:y}=FP(p,n);function x(A,C){let k=0;for(let j=0;j<f-1;j++)for(let z=j+1;z<f;z++){if(j===z)continue;const X=p[j],oe=p[z],re=e[X],Q=t[X],he=n[X],fe=e[oe],ae=t[oe],me=n[oe],we=fe-re,Z=ae-Q,_e=he+me+i,ze=we*we+Z*Z;if(ze<_e*_e-A){const Re=(_e-Math.sqrt(ze))*C,We=1/ze,st=we*We*Re,ft=Z*We*Re,ut=st*st+ft*ft;if(oe!==u){const ce=he/_;k+=ut*ce,e[oe]+=st*ce,t[oe]+=ft*ce}if(X!==u){const ce=me/_;k+=ut*ce,e[X]-=st*ce,t[X]-=ft*ce}}}const M=A*a*(1-C),R=s[0],O=s[1];for(let j=0;j<f;j++){const z=p[j];if(z!==u){const X=e[z],oe=t[z],re=n[z],Q=g?M*(re/y):M,he=(X-R)*Q,fe=(oe-O)*Q;k+=he*he+fe*fe,e[z]-=he,t[z]-=fe}}return k}p.sort((A,C)=>n[C]*Ob(e[C],t[C],s)-n[A]*Ob(e[A],t[A],s));let E=0,b=0;const S=Db(1/f);for(let A=0;A<r&&(E=x(S,Db((A+1)/r)),c&&setTimeout(()=>c(e,t)),!(Math.abs(E-b)<o));A++)b=E;return{X:e,Y:t}}var ic=e=>({data:e,next:null,prev:null});function U1(e,t=0,n=0){const s=e.length;if(s===0)return e;const r=e[0];if(r.x=t,r.y=n,s===1)return e;const i=e[1];if(r.x=t-i.radius,i.x=t+r.radius,i.y=n,s===2)return e;const o=e[2];zb(i,r,o);let a=ic(r),u=ic(i),d=ic(o);a.next=d.prev=u,u.next=a.prev=d,d.next=u.prev=a;e:for(let c=3;c<s;c++){d=ic(e[c]),zb(a.data,u.data,e[c]);let g=u.next,f=a.prev,p=u.data.radius,_=a.data.radius;do if(p<=_){if(Bb(g.data,d.data)){u=g,a.next=u,u.prev=a,--c;continue e}p+=g.data.radius,g=g.next}else{if(Bb(f.data,d.data)){a=f,a.next=u,u.prev=a,--c;continue e}_+=f.data.radius,f=f.prev}while(g!==f.next);d.prev=a,d.next=u,a.next=u.prev=u=d;let y=Ub(a);for(;(d=d.next)!==u;){const x=Ub(d);x<y&&(a=d,y=x)}u=a.next}return e}function zb(e,t,n){const s=e.x-t.x;let r,i;const o=e.y-t.y,a=s*s+o*o;let u,d;a?(i=t.radius+n.radius,i*=i,d=e.radius+n.radius,d*=d,i>d?(r=(a+d-i)/(2*a),u=Math.sqrt(Math.max(0,d/a-r*r)),n.x=e.x-r*s-u*o,n.y=e.y-r*o+u*s):(r=(a+i-d)/(2*a),u=Math.sqrt(Math.max(0,i/a-r*r)),n.x=t.x+r*s-u*o,n.y=t.y+r*o+u*s)):(n.x=t.x+n.radius,n.y=t.y)}var OP=1e-6;function Bb(e,t){const n=e.radius+t.radius-OP,s=t.x-e.x,r=t.y-e.y;return n>0&&n*n>s*s+r*r}function Ub(e){const t=e.data,n=e.next.data,s=t.radius+n.radius,r=(t.x*n.radius+n.x*t.radius)/s,i=(t.y*n.radius+n.y*t.radius)/s;return r*r+i*i}function zP(e,t,n,s,r,i){const o=e.get(t),a=e.get(n),u=o.getAttributes(["x","y","radius"]),d=a.getAttributes(["x","y","radius"]),c=Number(d.radius),g=Number(u.radius),f=ss(u.x,u.y,d.x,d.y),p=f;return s.push({source:t,target:n,weight:p}),f<=g+c+20?1:0}function BP(e){return e%3==2?e-2:e+1}function UP(e,t,n,s){const r=[],{triangles:i,halfedges:o}=e;for(let a=0;a<i.length;a++)a>o[a]&&zP(t,i[a],i[BP(a)],r);return r}var GP=(e,t)=>e.weight-t.weight;function VP(e,t){const n=new Set,s=new Array(e.length),r=[];for(const o of t)s[o.source]||(s[o.source]=[]),s[o.source].push(o),s[o.target]||(s[o.target]=[]),s[o.target].push(o);n.add(0);const i=Yg(GP,s[0]);for(;i.size!==0;){const o=i.pop(),a=n.has(o.source)?n.has(o.target)?null:o.target:o.source;if(a){const u=o.source===a?o.target:o.source,d=a;r.push({source:u,target:d,weight:o.weight}),n.add(a);for(const c of s[a])i.push(c)}}return r}function Gb(e,t,n){let s=e.x-t.x,r=e.y-t.y;const i=Math.sqrt(s*s+r*r);s/=i,r/=i;const o=n*s,a=n*r;e.x+=o,e.y+=a}function jP(e,t,n,s){const r=n.getAttributes(["x","y","radius"]),i=new Set;let o={x:0,y:0},a=-1;const u=r.map((d,c)=>(e===n.get(c)&&(a=c,o={index:c,...d}),{x:d.x,y:d.y,r:d.radius,index:c}));for(const d of s){const c=u[d.target],g=u[d.source],f=1;g.index===a||i.has(d.source)||(Gb(g,o,f*t),i.add(d.source)),c.index===a||i.has(d.target)||(Gb(c,o,f*t),i.add(d.target))}return u.map(d=>({x:d.x,y:d.y}))}function G1(e,t,n){const s=UP(ky.from(e.getPosition(),i=>i.x,i=>i.y),e),r=VP(e.toArray(),s);return jP(t,n,e,r)}var HP=16,qP=class{constructor(e=Int32Array,t=HP,n=8){this._BIG_LIST=new Uint8Array([-1])[0],this._ArrayType=e,this._capacity=t,this._MAX_LIST_SIZE=n,this._freeIndex=-1,this.clear()}clear(){this._buffer=new this._ArrayType(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._idToIndex={},this._constList=new Array(this._MAX_LIST_SIZE)}addEntry(e){let t;return this._freeIndex===-1?t=this._nextIndex++:(t=this._freeIndex,this._freeIndex=-1),this._idToIndex[e]=t,t>=this._capacity&&this._expand(t+1),this._sizes[t]=0,t}getItems(e){const t=this._idToIndex[e];if(t===void 0)return;const n=this._sizes[t],s=this._MAX_LIST_SIZE*t;if(n<=this._MAX_LIST_SIZE){this._constList.length=n;for(let r=0,i=n;r<i;++r)this._constList[r]=this._buffer[s+r];return this._constList}if(n===this._BIG_LIST){let r=this._buffer[s];return this._bigLists[r]}}removeEntry(e){const t=this._idToIndex[e];if(this._sizes[t]===this._BIG_LIST){const n=this._MAX_LIST_SIZE*t,s=this._buffer[n];this._bigLists[s].length=0}this._sizes[t]=0,this._freeIndex=t}size(e){const t=this._idToIndex[e];let n=this._sizes[t];return n<=this._MAX_LIST_SIZE?n:this._bigLists[this._buffer[t*this._MAX_LIST_SIZE]].length}sizes(e){const t=this._sizes,n=this._bigLists,s=this._buffer,r=this._MAX_LIST_SIZE,i=e.length,o=new Array(i);for(let a=0;a<i;a++){const u=this._idToIndex[e[a]],d=t[u];o[a]=d<=r?d:n[s[u*r]].length}return o}addTo(e,t){const n=this._idToIndex[e],s=this._sizes[n],r=n*this._MAX_LIST_SIZE;if(s<this._MAX_LIST_SIZE)this._buffer[r+s]=t,this._sizes[n]=s+1;else if(s===this._BIG_LIST){let i=this._buffer[r];this._bigLists[i].push(t)}else{let i=new Array(this._MAX_LIST_SIZE);for(let o=0;o<this._MAX_LIST_SIZE;++o)i[o]=this._buffer[r+o];i.push(t),this._bigLists.push(i),this._sizes[n]=this._BIG_LIST,this._buffer[r]=this._bigLists.length-1}}removeFrom(e,t){this.removeFromAndGetSize(e,t)}removeFromAndGetSize(e,t){const n=this._idToIndex[e];let s=this._sizes[n],r=this._MAX_LIST_SIZE*n;if(s<=this._MAX_LIST_SIZE){for(let i=r,o=r+s;i<o;++i)if(this._buffer[i]===t)return s-=1,this._buffer[i]=this._buffer[o-1],this._sizes[n]=s,s}else if(s===this._BIG_LIST){let i=this._buffer[r],o=this._bigLists[i],a=o.indexOf(t);if(a!==-1)return o.splice(a,1),o.length}}reserve(e){this._capacity<e&&this._expand(e)}_expand(e){this._capacity=Math.pow(2,Math.ceil(Math.log2(e))),this._buffer=Vb(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=Vb(this._sizes,this._capacity)}has(e){const t=this._idToIndex[e];return!(t===void 0||t>=this._capacity)&&this._sizes[t]!==0}get averageSize(){let e=0;for(let t=0;t<this._capacity;t++)e+=this._sizes[t];return e/this._capacity}};function Vb(e,t){let n=new e.constructor(t);return n.set(e),n}var Tu,jb,Cu,ol,Lu,ua=[0,1],Xc=[0,2];for(Cu=4;Cu<65535;Cu<<=2)for(Tu=0,jb=ua.length;Tu<jb;Tu++)ua.push(ua[Tu]|Cu),Xc.push((ua[Tu]|Cu)<<1);function Hr(e,t){return(Xc[255&t]|ua[255&e])+65536*(Xc[t>>8&255]|ua[e>>8&255])+4294967296*(Xc[t>>16&255]|ua[e>>16&255])}function Hb(e,t=[0,0]){if(e>0xffffffffffff)throw"Only morton codes up to 48 bits are supported.";if(!ol){ol={},Lu={};for(var n=0;n<256;n++)ol[Hr(n,0)]=n,Lu[Hr(0,n)]=n}var s=ol[21845&e],r=Lu[43690&e];return e>65535&&(s|=ol[21845&(e/=65536)]<<8,r|=Lu[43690&e]<<8,e>65535&&(s|=ol[21845&(e/=65536)]<<16,r|=Lu[43690&e]<<16)),t[0]=s,t[1]=r,t}Hr.code=function(t,n,s){if(t>24)throw"Morton codes are only supported up to Z=24";var r=1<<24-t;return Hr(n*r,s*r)},Hr.range=function(t,n,s){if(t>24)throw"Morton ranges are only supported up to Z=24";var r=1<<24-t,i=Hr(n*r,s*r);return[i,i+r*r-1]},Hr.reverse=Hb,Hr.decode=function(t,n){var s=Hb(n),r=1<<24-t;return[s[0]/r,s[1]/r]},Hr.min=function(t,n){var s=1431655765&t,r=1431655765&n,i=2863311530&t,o=2863311530&n;return Math.min(s,r)+Math.min(i,o)};var $P=1e-6,WP=1e-12;function V1(){for(var e=arguments,t=e.length-1,n=t,s=[],r=0;r<=t&&Math.abs(e[r])<=WP;r++)t--;switch(t){case 1:XP(e[n],e[n-1],s);break;case 2:YP(e[n],e[n-1],e[n-2],s);break;case 3:ZP(e[n],e[n-1],e[n-2],e[n-3],s)}return s}function XP(e,t,n=[]){return t!==0&&n.push(-e/t),n}function YP(e,t,n,s=[]){var r=t/n,i=r*r-4*(e/n);if(i>0){var o=Math.sqrt(i);s.push(.5*(-r+o)),s.push(.5*(-r-o))}else i===0&&s.push(.5*-r);return s}function ZP(e,t,n,s,r=[]){var i,o,a=n/s,u=t/s,d=(3*u-a*a)/3,c=(2*a*a*a-9*u*a+27*(e/s))/27,g=a/3,f=c*c/4+d*d*d/27,p=c/2;if(Math.abs(f)<=$P&&(f=0),f>0){var _=Math.sqrt(f);o=(i=-p+_)>=0?Math.pow(i,1/3):-Math.pow(-i,1/3),(i=-p-_)>=0?o+=Math.pow(i,1/3):o-=Math.pow(-i,1/3),r.push(o-g)}else if(f<0){var y=Math.sqrt(-d/3),x=Math.atan2(Math.sqrt(-f),-p)/3,E=Math.cos(x),b=Math.sin(x),S=Math.sqrt(3);r.push(2*y*E-g),r.push(-y*(E+S*b)-g),r.push(-y*(E-S*b)-g)}else i=p>=0?-Math.pow(p,1/3):Math.pow(-p,1/3),r.push(2*i-g),r.push(-i-g);return r}function vo(e,t,n,s,r,i,o,a,u,d,c){for(var g,f,p=Math.min(o,u),_=Math.min(a,d),y=Math.max(o,u),x=Math.max(a,d),E=V1((g=a-d)*(e+-2*n+r)+(f=u-o)*(t+-2*s+i),g*(-2*e+2*n)+f*(-2*t+2*s),g*e+f*t+(o*d-u*a)),b=0;b<E.length;b++){var S=E[b];if(0<=S&&S<=1){var A=e+(n-e)*S,C=t+(s-t)*S,k=A+(n+(r-n)*S-A)*S,M=C+(s+(i-s)*S-C)*S;if(o===u){if(_<=M&&M<=x){if(!c)return 1;c.push(k,M)}}else if(a===d){if(p<=k&&k<=y){if(!c)return 1;c.push(k,M)}}else if(k>=p&&M>=_&&k<=y&&M<=x){if(!c)return 1;c.push(k,M)}}}return c?c.length/2:0}function j1(e,t,n,s,r,i,o,a,u,d,c){return c?(vo(e,t,n,s,r,i,o,a,u,a,c),vo(e,t,n,s,r,i,u,a,u,d,c),vo(e,t,n,s,r,i,o,d,u,d,c),vo(e,t,n,s,r,i,o,a,o,d,c),c.length/2):o<=e&&u>=e&&a<=t&&d>=t||o<=r&&u>=r&&a<=i&&d>=i||vo(e,t,n,s,r,i,o,a,u,a)||vo(e,t,n,s,r,i,u,a,u,d)||vo(e,t,n,s,r,i,o,d,u,d)||vo(e,t,n,s,r,i,o,a,o,d)?1:0}function bo(e,t,n,s,r,i,o,a,u,d,c,g,f){for(var p,_,y=Math.min(u,c),x=Math.min(d,g),E=Math.max(u,c),b=Math.max(d,g),S=V1((p=d-g)*(-1*e+3*n+-3*r+o)+(_=c-u)*(-1*t+3*s+-3*i+a),p*(3*e+-6*n+3*r)+_*(3*t+-6*s+3*i),p*(-3*e+3*n)+_*(-3*t+3*s),p*e+_*t+(u*g-c*d)),A=0;A<S.length;A++){var C=S[A];if(0<=C&&C<=1){var k=e+(n-e)*C,M=t+(s-t)*C,R=n+(r-n)*C,O=s+(i-s)*C,j=k+(R-k)*C,z=M+(O-M)*C,X=j+(R+(r+(o-r)*C-R)*C-j)*C,oe=z+(O+(i+(a-i)*C-O)*C-z)*C;if(u===c){if(x<=oe&&oe<=b){if(!f)return 1;f.push(X,oe)}}else if(d===g){if(y<=X&&X<=E){if(!f)return 1;f.push(X,oe)}}else if(X>=y&&oe>=x&&X<=E&&oe<=b){if(!f)return 1;f.push(X,oe)}}}return f?f.length/2:0}function f_(e,t,n,s,r,i,o,a,u,d,c,g,f){return f?(bo(e,t,n,s,r,i,o,a,u,d,c,d,f),bo(e,t,n,s,r,i,o,a,c,d,c,g,f),bo(e,t,n,s,r,i,o,a,u,g,c,g,f),bo(e,t,n,s,r,i,o,a,u,d,u,g,f),f.length/2):u<=e&&c>=e&&d<=t&&g>=t||u<=o&&c>=o&&d<=a&&g>=a||bo(e,t,n,s,r,i,o,a,u,d,c,d)||bo(e,t,n,s,r,i,o,a,c,d,c,g)||bo(e,t,n,s,r,i,o,a,u,g,c,g)||bo(e,t,n,s,r,i,o,a,u,d,u,g)?1:0}var qb=typeof Map>"u"?class{constructor(){this._values={},this._size=0}get size(){return this._size}has(t){return!!this._values[t]}set(t,n){t in this._values||this._size++,this._values[t]=n}get(t){return this._values[t]}delete(t){t in this._values&&(delete this._values[t],this._size--)}keys(){return Object.keys(this._values)}clear(){this._values={},this._size=0}}:Map,KP=typeof Set>"u"?class{constructor(){this._values={},this._size=0}get size(){return this._size}has(t){return!!this._values[t]}add(t){t in this._values||this._size++,this._values[t]=!0}delete(t){t in this._values&&(delete this._values[t],this._size--)}keys(){return Object.keys(this._values)}clear(){this._values={},this._size=0}}:Set,H1=class{constructor(){this._intersects=null,this._getBounds=null}setBoundsGetter(e){return this._getBounds=e,this}setIntersector(e){return this._intersects=e,this}},QP=65536,JP=16,eR=16,tR=class extends H1{constructor(e,t,n=eR,s=QP,r=Int32Array,i=JP){super(),this._occupied=0,this._idToCode=new qb,this._codeCache=[0,0,0],this.code=(o,a,u)=>u|Hr(o,a)<<this._bitsForZoom,this.decode=(o,a)=>(Hr.reverse(o>>this._bitsForZoom,a),a[2]=o&this._zoomMask,a),this._intersects=e,this._getBounds=t,this._cells=new qP(r),this._offset=s,this._maxLevels=i,this._mortonMax=(1<<this._maxLevels)-1,this._bitsForZoom=Math.log2(this._maxLevels),this._zoomMask=(1<<this._bitsForZoom)-1,this._objectsAtLevel=new Array(this._maxLevels).fill(0),this._min=-s,this._max=s,this._resolution=this._mortonMax/(this._max-this._min),this._minCellSize=n*this._resolution,this._bounds=new Array(4*this._maxLevels);for(let o=0;o<this._maxLevels;o++)this._bounds[4*o]=1/0,this._bounds[4*o+1]=1/0,this._bounds[4*o+2]=-1/0,this._bounds[4*o+3]=-1/0}setMinCellSize(e){return this._minCellSize=e,this}setOffset(e){return this._offset=e,this._min=-e,this._max=e,this._resolution=this._mortonMax/(this._max-this._min),this}insert(e,t,n,s,r){t===void 0&&([t,n,s,r]=this._getBounds(e));const i=Math.max(s-t,r-n);let o,a=this._minCellSize;for(o=0;a<i&&o<this._maxLevels-1;o++)a*=2;const u=this._resolution,d=this._min,c=u*(.5*(s+t)-d)/a|0,g=u*(.5*(r+n)-d)/a|0,f=this.code(c,g,o);this._cells.has(f)||this._cells.addEntry(f),this._cells.addTo(f,e),this._objectsAtLevel[o]++,this._occupied|=1<<o;const p=4*o,_=this._bounds;return c<_[p]&&(_[p]=c),g<_[p+1]&&(_[p+1]=g),c>_[p+2]&&(_[p+2]=c),g>_[p+3]&&(_[p+3]=g),this._idToCode.set(e,f),f}has(e){return this._idToCode.has(e)}update(e,t,n,s,r){return this.remove(e),this.insert(e,t,n,s,r)}remove(e){const t=this._idToCode.get(e);this.decode(t,this._codeCache);const n=this._codeCache[2];return--this._objectsAtLevel[n]==0&&(this._occupied&=~(1<<n),this._bounds[4*n]=1/0,this._bounds[4*n+1]=1/0,this._bounds[4*n+2]=-1/0,this._bounds[4*n+3]=-1/0),this._cells.removeFrom(t,e),this._idToCode.delete(e),this}query(e,t,n,s){const r=this._cells,i=this._bounds,o=this._intersects,a=this._min,u=this._resolution;let d=this._minCellSize,c=this._occupied;const g=[];for(let f=0;f<this._maxLevels&&c!==0;d*=2,c>>=1,f++){if(!(1&c))continue;const p=1/d,_=4*f,y=Math.max(i[_],u*(e-a)*p-1|0),x=Math.max(i[_+1],u*(t-a)*p-1|0),E=Math.min(i[_+2],u*(n-a)*p+1|0),b=Math.min(i[_+3],u*(s-a)*p+1|0);for(let S=y;S<=E;S++)for(let A=x;A<=b;A++){const C=this.code(S,A,f),k=r.getItems(C);if(k!==void 0)for(let M=0;M<k.length;M++){const R=k[M];o(R,e,t,n,s)&&g.push(R)}}}return g}traverse(e,t,n,s,r){const i=this._cells,o=this._bounds,a=this._intersects,u=this._min,d=this._resolution;let c=this._minCellSize,g=this._occupied;const f=[];for(let p=0;p<this._maxLevels&&g!==0;c*=2,g>>=1,p++){if(!(1&g))continue;const _=1/c,y=4*p,x=Math.max(o[y],d*(e-u)*_-1|0),E=Math.max(o[y+1],d*(t-u)*_-1|0),b=Math.min(o[y+2],d*(n-u)*_+1|0),S=Math.min(o[y+3],d*(s-u)*_+1|0);for(let A=x;A<=b;A++)for(let C=E;C<=S;C++){const k=this.code(A,C,p),M=i.getItems(k);if(M!==void 0)for(let R=0;R<M.length;R++){const O=M[R];if(a(O,e,t,n,s)&&(f.push(O),r(O)))return f}}}return f}collisions(e,t=this._getBounds){if(typeof t!="function")throw new Error("getBounds function is required to get the object bounds");const n=Array.from(this._idToCode.keys()),s=this._min,r=this._resolution,i=this._cells,o=new qb,a=[];for(let u=0;u<n.length;u++){let d=0,c=this._minCellSize,g=this._occupied;const f=n[u];let[p,_,y,x]=t(f);const E=Math.max(y-p,x-_);for(d=0;c<E;d++)c*=2,g>>=1;p=r*(p-s),_=r*(_-s),y=r*(y-s),x=r*(x-s);for(let b=d;b<this._maxLevels&&g!==0;c*=2,g>>=1,b++){if(!(1&g))continue;const S=1/c,A=_*S-1|0,C=y*S+1|0,k=x*S+1|0;for(let M=p*S-1|0;M<=C;M++)for(let R=A;R<=k;R++){const O=this.code(M,R,b);if(o.get(O)===u)continue;o.set(O,u);const j=i.getItems(O);if(j!==void 0)for(let z=0;z<j.length;z++){const X=j[z],[oe,re,Q,he]=this._getBounds(X);X!==f&&e(f,oe,re,Q,he)&&a.push(f,X)}}}}return nR(a)}clear(){this._occupied=0,this._cells.clear(),this._idToCode.clear(),this._objectsAtLevel=new Array(this._maxLevels).fill(0),this._bounds=new Array(4*this._maxLevels);for(let e=0;e<this._maxLevels;e++)this._bounds[4*e]=1/0,this._bounds[4*e+1]=1/0,this._bounds[4*e+2]=-1/0,this._bounds[4*e+3]=-1/0;return this}keyToBBox(e){const[t,n,s]=this.decode(e,[0,0,0]),r=this._minCellSize*(1<<s),i=this._min,o=this._resolution;return[t*r/o+i,n*r/o+i,(t+1)*r/o+i,(n+1)*r/o+i]}keys(){return Object.keys(this._cells._idToIndex)}get averageCellOccupancy(){return this._cells.averageSize}get size(){return this._idToCode.size}getBoxes(){return Array.from(this._idToCode.keys()).map(e=>this._getBounds(e))}};function nR(e){const t=new KP,n=[];for(let s=0;s<e.length;s+=2){const r=e[s],i=e[s+1],o=r<i?r*i+(i-r-1)*(i-r-1)/4:r*i+(r-i-1)*(r-i-1)/4;t.has(o)||(t.add(o),n.push(r,i))}return n}function sR(e,t,n,s,r,i,o,a){return e>r&&e<o&&t>i&&t<a||n>r&&n<o&&s>i&&s<a}function Mi(e,t,n,s,r,i,o,a){return s>=i&&t<=a&&n>=r&&e<=o}var Ii=(e,t,n,s,r,i)=>({minX:e,minY:t,maxX:n,maxY:s,leaf:!0,level:i,parent:r,objects:[],final:!1,children:null});function q1(e){const{minX:t,minY:n,maxX:s,maxY:r}=e;return[t,n,s,r]}function Hu(e,t,n,s,r,i,o,a){return e>=r&&n<=o&&t>=i&&s<=a}var rR=0,iR=1,oR=2,aR=3;function oc(e,t,n,s,r,i,o,a){const u=(i+a)/2,d=(t+s)/2;return(e+n)/2<=(r+o)/2?d<=u?rR:iR:d<=u?aR:oR}var lR=e=>e,hl=class extends H1{constructor(e=lR,t=10,n,s=0){super(),this._nodeCapacity=10,this._root=null,this._objects={},this._size=0,this._rootLevel=0,this._maxLevel=30,this._idToCell={},this._nodeCapacity=t,this._root=null,this._getBounds=e,this._rootLevel=s,this._maxLevel=s+30,this._idToCell={},n&&(this._root=Ii(n[0],n[1],n[2],n[3],null,s))}get size(){return this._size}get root(){return this._root}clear(){return this._root=null,this._objects={},this._size=0,this._idToCell={},this._rootLevel=0,this._maxLevel=this._rootLevel+30,this}insert(e,t,n,s,r,i=this._root){if(t||([t,n,s,r]=this._getBounds(e)),this._objects[e])return;if(this._objects[e]=!0,this._size++,!this._root){const p=Math.max(Math.abs(s-t),Math.abs(r-n));return this._root=Ii(t,n,t+p,n+p,null,this._rootLevel),this._idToCell[e]=[this._root],this._root.objects=[e],e}let o,a=[i],u=!1;const d=this._nodeCapacity,c=this._idToCell,g=this._maxLevel;let f;for(;f=a.pop();){o=f;const{minX:p,minY:_,maxX:y,maxY:x}=o;Mi(t,n,s,r,p,_,y,x)&&(o.leaf?o.objects&&(o.objects.length<d||o.final)?(o.objects.push(e),c[e]?c[e].push(o):c[e]=[o],u=!0,(o.level>=g||Math.abs(y-p)<=Math.abs(s-t)||Math.abs(x-_)<=Math.abs(r-n))&&(o.final=!0)):(this.splitNode(o),a.push(o)):a.push.apply(a,o.children))}if(!Hu(t,n,s,r,(i=this._root).minX,i.minY,i.maxX,i.maxY)){let p=this._rootLevel;for(;!Hu(t,n,s,r,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){i=this._root;const{minX:_,minY:y,maxX:x,maxY:E}=i;let b=_,S=y,A=x,C=E;const k=Math.abs(x-_),M=Math.abs(E-y);if(M===0&&k===0)break;const R=Math.max(k,M);t<_?(b-=R,n<y?S-=R:C+=R):(A+=R,n<y?S-=R:C+=R);const O=Ii(b,S,A,C,null,--p);this.splitNode(O),O.children[oc(_,y,x,E,b,S,A,C)]=i,this._root=i.parent=O}for(a=[this._root],this._root.level=this._rootLevel;f=a.shift();)if(o=f,!o.leaf)for(let _=0;_<4;_++){const y=o.children[_];y.level=o.level+1,a.push(y)}i=this._root;for(let _=0;_<4;_++){const y=i.children[_];y&&y.leaf&&y.objects&&(y.objects.push(e),c[e]?c[e].push(y):c[e]=[y])}}return u?e:void 0}removeById(e){if(!this._objects[e])return e;this._size--;const t=this._idToCell[e];for(let n=0;n<t.length;n++){const s=t[n].objects||[];for(let r=0,i=s.length;r<i;r++)if(s[r]===e){s.splice(r,1);break}}return delete this._objects[e],delete this._idToCell[e],e}remove(e){const[t,n,s,r]=this._getBounds(e),i=[this._root];let o,a;const u=[];for(;o=i.pop();)if(Mi(t,n,s,r,o.minX,o.minY,o.maxX,o.maxY))if(o.leaf){const d=o.objects||[];for(let c=0,g=d.length;c<g;c++)if(d[c]===e){d.splice(c,1),g===1&&u.push(o);break}}else i.push.apply(i,o.children);if(delete this._idToCell[e],delete this._objects[e],this._size--,u.length)for(;a=u.pop();){let d=a.parent,c=!0;for(;d&&c;){if(!d.leaf){for(let g=0;g<4;g++)if(o=d.children[g],!o.leaf||o.objects&&o.objects.length!==0){c=!1;break}c&&(d.leaf=!0,d.children=[],d.objects=[])}d=d.parent}}return e}splitNode(e){const{minX:t,minY:n,maxX:s,maxY:r}=e,i=(t+s)/2,o=(n+r)/2,a=e.level+1,u=this._idToCell,d=this._maxLevel,c=[Ii(t,n,i,o,e,a),Ii(t,o,i,r,e,a),Ii(i,o,s,r,e,a),Ii(i,n,s,o,e,a)];if(e.objects!==null){const g=e.objects,f=this._getBounds;for(let p=0,_=g.length;p<_;p++){const y=g[p],x=f(y);let E=u[y];for(let b=0;b<4;b++){const S=c[b],{minX:A,minY:C,maxX:k,maxY:M}=S;Mi(x[0],x[1],x[2],x[3],A,C,k,M)&&(S.objects&&S.objects.push(y),(S.level>=d||Math.abs(k-A)<=Math.abs(x[2]-x[0])||Math.abs(M-C)<=Math.abs(x[3]-x[1]))&&(S.final=!0),E?E.push(S):E=[S])}E&&E.splice(E.indexOf(e),1)}}e.children=c,e.objects=null,e.leaf=!1}point(e,t,n){let s=[];const r=[this._root];let i,o,a;const u=this._getBounds;for(;i=r.pop();)if(e>=i.minX&&e<=i.maxX&&t>=i.minY&&t<=i.maxY){if(i.leaf){n&&i.objects&&(s=i.objects);const d=i.objects||[];for(let c=0,g=d.length;c<g;c++)a=d[c],o=u(a),e>=o[0]&&e<=o[2]&&t>=o[1]&&t<=o[3]&&s.push(a);break}r.push.apply(r,i.children)}return s.length?s:null}neigbours(e,t){let n,s=[];const r=[this._root];for(;n=r.pop();)if(e>=n.minX&&e<=n.maxX&&t>=n.minY&&t<=n.maxY){if(n.leaf){s=n.objects;break}r.push.apply(r,n.children)}return s}query(e,t,n,s){const r=[],i=[this._root];let o,a,u;const d=this._getBounds,c={},g=this._intersects;let f;for(;o=i.pop();)if(Mi(e,t,n,s,o.minX,o.minY,o.maxX,o.maxY))if(o.leaf){const p=o.objects||[];for(let _=0,y=p.length;_<y;_++)u=p[_],c[u]||(a=d(u),Mi(e,t,n,s,a[0],a[1],a[2],a[3])&&(g&&!g(u,e,t,n,s)||r.push(u)),c[u]=!0)}else f=oc(e,t,n,s,o.minX,o.minY,o.maxX,o.maxY),i.push(o.children[(f+3)%4],o.children[(f+2)%4],o.children[(f+1)%4],o.children[f]);return r}traverse(e,t,n,s,r){const i=[],o=[this._root];let a,u,d;const c=this._getBounds,g={},f=this._intersects;let p;for(;a=o.pop();)if(Mi(e,t,n,s,a.minX,a.minY,a.maxX,a.maxY))if(a.leaf){const _=a.objects||[];for(let y=0,x=_.length;y<x;y++)if(d=_[y],!g[d]){if(u=c(d),Mi(e,t,n,s,u[0],u[1],u[2],u[3])&&(!f||f(d,e,t,n,s))&&(i.push(d),r(d)))return i;g[d]=!0}}else p=oc(e,t,n,s,a.minX,a.minY,a.maxX,a.maxY),o.push(a.children[(p+3)%4],a.children[(p+2)%4],a.children[(p+1)%4],a.children[p]);return i}getOverlaps(){const e=[this._root];let t,n,s;const r=[],i=this._getBounds,o={};for(;t=e.pop();)if(t.leaf){const a=t.objects||[],u=a.length;for(let d=0;d<u;d++)for(let c=0;c<u;c++)if(n=a[d],s=a[c],d!==c&&!o[n+":"+s]&&!o[s+":"+n]){o[n+":"+s]=!0;const g=i(n),f=i(s);Mi(g[0],g[1],g[2],g[3],f[0],f[1],f[2],f[3])&&r.push(n,s)}}else e.push.apply(e,t.children);return r}cover(e,t,n,s){if(this._root===null)return this._root=Ii(e,t,n,s,null,0),this;let r=this._root;if(!Hu(e,t,n,s,r.minX,r.minY,r.maxX,r.maxY)){let i=this._rootLevel;for(;!Hu(e,t,n,s,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){r=this._root;const{minX:d,minY:c,maxX:g,maxY:f}=r;let p=d,_=c,y=g,x=f;const E=Math.abs(g-d),b=Math.abs(f-c);if(b===0&&E===0)break;const S=Math.max(E,b);e<d?(p-=S,t<c?_-=S:x+=S):(y+=S,t<c?_-=S:x+=S);const A=Ii(p,_,y,x,null,--i);this.splitNode(A),A.children[oc(d,c,g,f,p,_,y,x)]=r,this._root=r.parent=A}const o=[this._root];let a,u;for(this._root.level=this._rootLevel;a=o.shift();)if(u=a,!u.leaf)for(let d=0;d<4;d++){const c=u.children[d];c.level=u.level+1,o.push(c)}}return this}getAll(){return Object.keys(this._objects).map(e=>Number(e))}forEach(e,t){const n=[this._root];let s;for(;s=n.pop();)if(s.leaf&&s.objects)for(let r=0,i=s.objects.length;r<i;r++)e.call(t,s.objects[r]);else n.push.apply(n,s.children);return this}getLeafs(){const e=[this._root],t=[];let n;for(;n=e.pop();)n.leaf?t.push(n):e.push.apply(e,n.children);return t}traverseFromRoot(e,t){const n=[this._root];let s;for(;s=n.pop();)e.call(t,s,s.objects)||s.leaf||n.push.apply(n,s.children);return this}update(e,t,n,s,r){return this.remove(e),this.insert(e,t,n,s,r),this}getNodeBounds(e){return q1(e)}};hl.flatAccessor=(e,t)=>n=>{const s=t*n;return e.slice(s,s+t)},hl.inside=Hu,hl.intersects=sR,hl.overlaps=Mi,hl.getNodeBBox=q1;var $1=hl;function uR(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return W1(this.cover(t,n),t,n,e)}function W1(e,t,n,s){if(isNaN(t)||isNaN(n))return e;var r,i,o,a,u,d,c,g,f,p=e._root,_={data:s},y=e._x0,x=e._y0,E=e._x1,b=e._y1;if(!p)return e._root=_,e;for(;p.length;)if((d=t>=(i=(y+E)/2))?y=i:E=i,(c=n>=(o=(x+b)/2))?x=o:b=o,r=p,!(p=p[g=c<<1|d]))return r[g]=_,e;if(a=+e._x.call(null,p.data),u=+e._y.call(null,p.data),t===a&&n===u)return _.next=p,r?r[g]=_:e._root=_,e;do r=r?r[g]=new Array(4):e._root=new Array(4),(d=t>=(i=(y+E)/2))?y=i:E=i,(c=n>=(o=(x+b)/2))?x=o:b=o;while((g=c<<1|d)==(f=(u>=o)<<1|a>=i));return r[f]=p,r[g]=_,e}function dR(e){var t,n,s,r,i=e.length,o=new Array(i),a=new Array(i),u=1/0,d=1/0,c=-1/0,g=-1/0;for(n=0;n<i;++n)isNaN(s=+this._x.call(null,t=e[n]))||isNaN(r=+this._y.call(null,t))||(o[n]=s,a[n]=r,s<u&&(u=s),s>c&&(c=s),r<d&&(d=r),r>g&&(g=r));if(u>c||d>g)return this;for(this.cover(u,d).cover(c,g),n=0;n<i;++n)W1(this,o[n],a[n],e[n]);return this}function hR(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,s=this._y0,r=this._x1,i=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,i=(s=Math.floor(t))+1;else{for(var o,a,u=r-n||1,d=this._root;n>e||e>=r||s>t||t>=i;)switch(a=(t<s)<<1|e<n,(o=new Array(4))[a]=d,d=o,u*=2,a){case 0:r=n+u,i=s+u;break;case 1:n=r-u,i=s+u;break;case 2:r=n+u,s=i-u;break;case 3:n=r-u,s=i-u}this._root&&this._root.length&&(this._root=d)}return this._x0=n,this._y0=s,this._x1=r,this._y1=i,this}function cR(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function gR(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function $s(e,t,n,s,r){this.node=e,this.x0=t,this.y0=n,this.x1=s,this.y1=r}function fR(e,t,n){var s,r,i,o,a,u,d,c=this._x0,g=this._y0,f=this._x1,p=this._y1,_=[],y=this._root;for(y&&_.push(new $s(y,c,g,f,p)),n==null?n=1/0:(c=e-n,g=t-n,f=e+n,p=t+n,n*=n);u=_.pop();)if(!(!(y=u.node)||(r=u.x0)>f||(i=u.y0)>p||(o=u.x1)<c||(a=u.y1)<g))if(y.length){var x=(r+o)/2,E=(i+a)/2;_.push(new $s(y[3],x,E,o,a),new $s(y[2],r,E,x,a),new $s(y[1],x,i,o,E),new $s(y[0],r,i,x,E)),(d=(t>=E)<<1|e>=x)&&(u=_[_.length-1],_[_.length-1]=_[_.length-1-d],_[_.length-1-d]=u)}else{var b=e-+this._x.call(null,y.data),S=t-+this._y.call(null,y.data),A=b*b+S*S;if(A<n){var C=Math.sqrt(n=A);c=e-C,g=t-C,f=e+C,p=t+C,s=y.data}}return s}function pR(e){if(isNaN(i=+this._x.call(null,e))||isNaN(o=+this._y.call(null,e)))return this;var t,n,s,r,i,o,a,u,d,c,g,f,p=this._root,_=this._x0,y=this._y0,x=this._x1,E=this._y1;if(!p)return this;if(p.length)for(;;){if((d=i>=(a=(_+x)/2))?_=a:x=a,(c=o>=(u=(y+E)/2))?y=u:E=u,t=p,!(p=p[g=c<<1|d]))return this;if(!p.length)break;(t[g+1&3]||t[g+2&3]||t[g+3&3])&&(n=t,f=g)}for(;p.data!==e;)if(s=p,!(p=p.next))return this;return(r=p.next)&&delete p.next,s?(r?s.next=r:delete s.next,this):t?(r?t[g]=r:delete t[g],(p=t[0]||t[1]||t[2]||t[3])&&p===(t[3]||t[2]||t[1]||t[0])&&!p.length&&(n?n[f]=p:this._root=p),this):(this._root=r,this)}function mR(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function _R(){return this._root}function yR(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function xR(e){var t,n,s,r,i,o,a=[],u=this._root;for(u&&a.push(new $s(u,this._x0,this._y0,this._x1,this._y1));t=a.pop();)if(!e(u=t.node,s=t.x0,r=t.y0,i=t.x1,o=t.y1)&&u.length){var d=(s+i)/2,c=(r+o)/2;(n=u[3])&&a.push(new $s(n,d,c,i,o)),(n=u[2])&&a.push(new $s(n,s,c,d,o)),(n=u[1])&&a.push(new $s(n,d,r,i,c)),(n=u[0])&&a.push(new $s(n,s,r,d,c))}return this}function vR(e){var t,n=[],s=[];for(this._root&&n.push(new $s(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var r=t.node;if(r.length){var i,o=t.x0,a=t.y0,u=t.x1,d=t.y1,c=(o+u)/2,g=(a+d)/2;(i=r[0])&&n.push(new $s(i,o,a,c,g)),(i=r[1])&&n.push(new $s(i,c,a,u,g)),(i=r[2])&&n.push(new $s(i,o,g,c,d)),(i=r[3])&&n.push(new $s(i,c,g,u,d))}s.push(t)}for(;t=s.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this}function bR(e){return e[0]}function ER(e){return arguments.length?(this._x=e,this):this._x}function SR(e){return e[1]}function AR(e){return arguments.length?(this._y=e,this):this._y}function X1(e,t,n){var s=new Dy(t??bR,n??SR,NaN,NaN,NaN,NaN);return e==null?s:s.addAll(e)}function Dy(e,t,n,s,r,i){this._x=e,this._y=t,this._x0=n,this._y0=s,this._x1=r,this._y1=i,this._root=void 0}function $b(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var js=X1.prototype=Dy.prototype;js.copy=function(){var e,t,n=new Dy(this._x,this._y,this._x0,this._y0,this._x1,this._y1),s=this._root;if(!s)return n;if(!s.length)return n._root=$b(s),n;for(e=[{source:s,target:n._root=new Array(4)}];s=e.pop();)for(var r=0;r<4;++r)(t=s.source[r])&&(t.length?e.push({source:t,target:s.target[r]=new Array(4)}):s.target[r]=$b(t));return n},js.add=uR,js.addAll=dR,js.cover=hR,js.data=cR,js.extent=gR,js.find=fR,js.remove=pR,js.removeAll=mR,js.root=_R,js.size=yR,js.visit=xR,js.visitAfter=vR,js.x=ER,js.y=AR;var Nu=function(e,t,n,s,r){this.node=e,this.x0=t,this.y0=n,this.x1=s,this.y1=r},wR=function(e){const t=[];let n,s,r,i,o,a,u,d=this._root;for(d&&t.push(new Nu(d,this._x0,this._y0,this._x1,this._y1));(n=t.pop())&&(u=e(d=n.node,r=n.x0,i=n.y0,o=n.x1,a=n.y1),u!=="break");)if(!u&&d.length){const c=(r+o)/2,g=(i+a)/2;(s=d[3])&&t.push(new Nu(s,c,g,o,a)),(s=d[2])&&t.push(new Nu(s,r,g,c,a)),(s=d[1])&&t.push(new Nu(s,c,i,o,g)),(s=d[0])&&t.push(new Nu(s,r,i,c,g))}return this};function Oy(e,t,n,s,r){const i=new Array(e.length);for(let o=0;o<t.length;o++){const a=s[t[o]],u=s[n[o]];i[a]=i[a]||[],i[a].push(u),r&&(i[u]=i[u]||[],i[u].push(a))}return i}function md(e,t){return e[t]===-1?t:md(e,e[t])}function TR(e,t,n){const s=md(e,t),r=md(e,n);e[s]=r}function CR(e,t,n,s=!1){const r=new Int32Array(e.length),i={};for(let o=0;o<e.length;o++)r[o]=-1,i[e[o]]=o;for(let o=0;o<t.length;o++){const a=i[t[o]],u=i[n[o]];if(s&&a===u)return!0;const d=md(r,a),c=md(r,u);if(d===c)return!0;TR(r,d,c)}return!1}function Y1(e,t,n,s,r,i,o,a){if(s[e]=r,n[e])return!0;if(t[e])return!1;t[e]=1,n[e]=1;const u=i[e];if(u){for(const d of u)if(Y1(d,t,n,s,e,i,o,a))return o.push(a[d]),!0}return n[e]=0,!1}function Z1(e,t,n){const s=e.length,r=new Uint8Array(s),i=new Uint8Array(s),o=new Int32Array(s),a={};for(let d=0;d<s;d++)a[e[d]]=d;const u=Oy(e,t,n,a,!1);for(let d=0;d<s;d++){const c=[];if(Y1(d,r,i,o,-1,u,c,e)&&c.length>1){const g=c[0];for(let f=1;f<c.length;f++)if(c[f]===g){c.length=f;break}return c.push(g),c.reverse()}}return!1}function K1(e,t,n,s,r,i,o){t[e]=1,s[e]=n;const a=r[e];if(a){for(const u of a)if(t[u]){if(u!==n)return s[u]=e,i.push(o[u]),!0}else if(K1(u,t,e,s,r,i,o))return i.push(o[u]),!0}return!1}function LR(e,t,n){const s=e.length,r=new Uint8Array(s),i=new Int32Array(s),o={};for(let u=0;u<s;u++)o[e[u]]=u,i[u]=-1;const a=Oy(e,t,n,o,!0);for(let u=0;u<t.length;u++){const d=o[t[u]],c=o[n[u]];a[d]=a[d]||[],a[d].push(c)}for(let u=0;u<s;u++){const d=u,c=[];if(!r[d]&&K1(d,r,-1,i,a,c,e))return!0}return!1}X1.prototype.visit2=wR;var Q1=class{constructor(e,t,n){this.cycles=[],this.visitedLength=0,this.visitedStack=[],this.stack=[],this.idToIndex={},this.removed={},this.nodes=e,this.visited=new Uint8Array(this.nodes.length);for(let s=0;s<e.length;s++)this.idToIndex[e[s]]=s;this.adjacency=Oy(e,t,n,this.idToIndex)}getCycles(){this.visited=new Uint8Array(this.nodes.length),this.visitedStack=[];for(let e=0;e<this.nodes.length;e++)for(this.backtrack(e,e);this.visitedLength!==0;){const t=this.visitedStack.pop();t!==void 0&&this.visited[t]&&(this.visited[t]=0,this.visitedLength--)}return this.cycles}backtrack(e,t){let n=!1;this.stack.push(t),this.visited[t]||(this.visited[t]=1,this.visitedLength++),this.visitedStack.push(t);const s=this.adjacency[t]||[];for(const r of s)if(this.removed[t]=this.removed[t]||{},!this.removed[t][r]){if(r<e)this.removed[t][r]=!0;else if(r===e){n=!0;const i=[];for(let o=0,a=!1;o<this.stack.length;o++){const u=this.stack[o];e===u&&(a=!0),a&&i.push(this.nodes[u])}this.cycles.push(i)}else if(!this.visited[r]){const i=this.backtrack(e,r);n=n||i}}if(n){let r;do r=this.visitedStack.pop(),this.visited[r]&&(this.visited[r]=0,this.visitedLength--);while(r!==t)}return this.stack.pop(),n}};function NR(){return{index:{},parent:[],count:0}}function IR(e,t){e.index[t]===void 0&&(e.count+=1,e.index[t]=e.parent.push(-e.count))}function Wb(e,t){let n=e.index[t];if(n===void 0)return-1;for(;n>=0;)t=n,n=e.parent[n];return t}function kR(e,t,n){e.parent[n]=t,e.count-=1}function MR(e){return e.count<=1}function J1(e,t,n,s,r){r&&t.sort((a,u)=>r(a)-r(u));const i=[],o=NR();e.forEach(a=>IR(o,a));for(let a=0;a<t.length&&!MR(o);a++){const u=Wb(o,n(t[a])),d=Wb(o,s(t[a]));u!==d&&u>0&&d>0&&(kR(o,u,d),i.push(t[a]))}return i}function eT({adjacency:e,directed:t=!1,normalized:n=!0}){const s=[],r=[],i={},o={},a={},u={};let d;const c=new Array(e.length),g={},f={},p={};for(let b=0;b<e.length;b++){const S=e[b];p[S.id]=S.adj,g[S.id]=!0,f[S.id]=b,t||S.adj.forEach(A=>{g[A]=!0})}const _=Object.keys(g).map(b=>+b);for(let b=0;b<_.length;b++)c[b]=0;for(let b=0;b<_.length;b++)d=_[b],E(d),x();const y=n?_.length>2?1/((_.length-1)*(_.length-2)):0:t?0:.5;if(y)for(let b=0;b<c.length;b++)c[b]*=y;return c;function x(){for(let b=0;b<_.length;b++)u[_[b]]=0;for(;r.length;){const b=r.pop(),S=(1+u[b])/a[b],A=i[b];for(let C=0;C<A.length;++C){const k=A[C];u[k]+=a[k]*S}b!==d&&(c[f[b]]+=u[b])}}function E(b){for(let S=0;S<_.length;S++){const A=_[S];i[A]=[],o[A]=-1,a[A]=0}for(o[b]=0,a[b]=1,s.push(b);s.length;){const S=s.shift();r.push(S),p[S].forEach(A=>{o[A]===-1&&(o[A]=o[S]+1,s.push(A)),o[A]===o[S]+1&&(a[A]+=a[S],i[A].push(S))})}}}var tT=class{constructor(e){this._heap=[],this._size=0,this._keyToValue=e,this._keyToIndex=new Int32Array(e.length),this._keyToIndex.fill(-1)}add(e){let t=this._keyToIndex[e];t===-1&&(t=this._size++,this._heap[t]=e),this._keyToIndex[e]=this._bubble(t)}removeMin(){if(this._size===0)return NaN;const e=this._heap[0];return this._heap[0]=this._heap[--this._size],this._bubble(0),e}isEmpty(){return this._size===0}has(e){return this._keyToIndex[e]!==-1}_bubble(e){const t=this._indexToValue(e),n=this._getParentIndex(e),s=this._indexToValue(n);let r=e;if(e!==0&&s>t)r=this._swap(e,n);else{const i=this._getLeftChildIndex(e),o=this._getRightChildIndex(e),a=this._indexToValue(i),u=this._indexToValue(o),d=Math.min(t,a,u);d===t||(r=d===a?this._swap(e,i):this._swap(e,o))}return r===e?e:this._bubble(r)}_indexToValue(e){return e>=this._size?1/0:this._keyToValue[this._heap[e]]}_getParentIndex(e){return(e-1)/2|0}_getLeftChildIndex(e){return 2*e+1}_getRightChildIndex(e){return 2*e+2}_swap(e,t){const n=this._heap[e],s=this._heap[t];return this._heap[e]=s,this._heap[t]=n,this._keyToIndex[n]=t,this._keyToIndex[s]=e,t}},nT=ko&&!!window.PointerEvent,Zg="pointerdown",Kg="pointermove",Qg="pointerup",zd="pointercancel",Fl={},_g=0,sT=e=>e.pointerType==="mouse",rT=e=>e.pointerType!=="mouse";function PR(){if(qi&&_g===0&&nT){const e=document.documentElement;e.addEventListener(Zg,iT,!0),e.addEventListener(Kg,oT,!0),e.addEventListener(Qg,yg,!0),e.addEventListener(zd,yg,!0)}_g++}function RR(){if(_g--,qi&&_g===0){const e=document.documentElement;e.removeEventListener(Zg,iT,!0),e.removeEventListener(Kg,oT,!0),e.removeEventListener(Qg,yg,!0),e.removeEventListener(zd,yg,!0)}}function iT(e){Fl[e.pointerId]=e}function oT(e){Fl[e.pointerId]&&(Fl[e.pointerId]=e)}function yg(e){delete Fl[e.pointerId]}function Jg(e,t){e.touches=[];for(const n in Fl)e.touches.push(Fl[n]);e.changedTouches=[e],t(e)}function FR(e,t,n){const s=r=>{sT(r)||(rT(r)&&r.preventDefault(),Jg(r,n))};return e(t,Zg,s,!1),s}function DR(e,t,n){const s=r=>{rT(r)&&r.preventDefault(),Jg(r,n)};return e(t,zd,s,!1),s}function OR(e,t,n){const s=r=>{sT(r)&&r.buttons===0||Jg(r,n)};return e(t,Kg,s,!1),s}function zR(e,t,n){const s=r=>Jg(r,n);return e(t,Qg,s,!1),e(t,zd,s,!1),s}function Xb(e,t,n,s){return n==="touchstart"?e(t,Zg,s,!1):n==="touchmove"?e(t,Kg,s,!1):n==="touchend"?(e(t,Qg,s,!1),e(t,zd,s,!1)):void 0}var BR=["graphics","legend","brand"],em=300,tm=300,UR=200,GR=class extends zt{constructor(){super(...arguments),this._width=em,this._height=tm,this._resizeObserver=t1(()=>this._resize()),this._layers={},this._focus=!1,this._container=null,this._isFullScreen=!1,this._beforeNextFramePromises=[],this._afterNextFramePromises=[],this._refreshUntil=0,this._currentTime=Rs(),this._timeouts=[],this._isDestroyed=!1,this._onDetachDom=[],this._isRealBrowser=Hg,this._isDocumentReady=qg,this._inFrame=!1,this._mustRefresh=!1,this._nextFrame=null,this._onWindowFocus=()=>this.refresh(),this._onFullscreenChange=()=>{this._isFullScreen=sd()},this._resize=e=>{if(!this._container&&!e)return;const t=this._width,n=this._height;let s=0,r=0;if(this._container){const i=this._modules.settings.get("minimumWidth"),o=this._modules.settings.get("minimumHeight"),a=this._container.clientWidth||1,u=this._container.clientHeight||1;s=Math.max(i,e?e.width:a),r=Math.max(o,e?e.height:u)}else e&&(s=e.width,r=e.height);s===t&&r===n||(this._width=s,this._height=r,ci(this._layers,({element:i,automaticResize:o})=>{o&&ag(i,s,r)}),this._modules.events.fire("resize",{prevWidth:t,prevHeight:n,width:s,height:r,difWidth:s-t,difHeight:r-n}))}}onMounted(){this._modules.settings.register("minimumWidth",em,()=>this._resize(),!1),this._modules.settings.register("minimumHeight",tm,()=>this._resize(),!1),this._modules.events.register(["beforeNewFrame","frame","afterNewFrame","setContainer","resize"]),this._onDetachDom=[],PR(),this.addWindowEventListener("focus",this._onWindowFocus)}onReady(e){var t,n;e.container&&this.setContainer(e.container),(t=e.options)!=null&&t.width||(n=e.options)!=null&&n.height?this._resize({width:e.options.width||em,height:e.options.height||tm}):this._resize()}addWindowEventListener(e,t,n){return this._isRealBrowser&&this.addElementEventListener(window,e,t,n),this}addDirectWindowEventListener(e,t,n){this._isRealBrowser&&window.addEventListener(e,t,n)}removeDirectWindowEventListener(e,t){this._isRealBrowser&&window.removeEventListener(e,t)}addDocumentEventListener(e,t,n){return this._isDocumentReady&&this.addElementEventListener(document.documentElement,e,t,n),t}removeDocumentEventListener(e,t){this._isDocumentReady&&document.documentElement.removeEventListener(e,t)}addMediaListener(e,t){if(this._isDocumentReady&&typeof window.matchMedia=="function"){const n=window.matchMedia(e);n.addListener(t),this._onDetachDom.push(()=>n.removeListener(t))}}addElementEventListener(e,t,n,s){return this._isDestroyed||(e.addEventListener(t,n,s),this._onDetachDom.push(()=>e.removeEventListener(t,n,s))),n}detachFromDom(){this._onDetachDom.forEach(e=>e()),this._onDetachDom=[],this._emptyContainer()}setTimeout(e,t=0){const n=setTimeout(()=>{this._timeouts.splice(this._timeouts.indexOf(n),1),e()},t);return this._timeouts.push(n),n}clearTimeout(e){return e&&(clearTimeout(e),this._timeouts.splice(this._timeouts.indexOf(e),1)),null}clearAllTimeouts(){this._timeouts.forEach(clearTimeout),this._timeouts=[]}stopFrames(){this._isDestroyed=!0,this._nextFrame&&(Yw(this._nextFrame),this._nextFrame=null)}isDestroyed(){return this._isDestroyed}getDimensions(){return{width:this._width,height:this._height}}setDimensions(e){this._resize(e)}setLayer(e,t,{automaticResize:n=!1}={}){t?(t._ogmaLayer=e,n&&(t.style.position="absolute",t.style.top="0px",t.style.left="0px",ag(t,this._width,this._height,or())),this._layers[e]={element:t,automaticResize:n}):t===null&&delete this._layers[e],this._updateContainerContent()}setContainer(e){let t;if(typeof e=="string"){if(t=document.getElementById(e),!t)throw new Error(`unable to find DOM element with id "${e}"`)}else t=e;if(t===this._container)return;t===null&&this._emptyContainer();const n=this._container;this._isFullScreen=!1,this._container&&this._resizeObserver.unobserve(this._container),this._container=t,this._container&&(["fullscreenchange","webkitfullscreenchange"].forEach(s=>{this.addElementEventListener(this._container,s,this._onFullscreenChange)}),this._resizeObserver.observe(this._container)),this._resize(),this._updateContainerContent(),this._modules.events.fire("setContainer",{element:t,prevElement:n})}getContainer(){return this._container}appendElement(e){this._container!==null&&this._container.appendChild(e)}focus(){this._focus=!0}blur(){this._focus=!1}hasFocus(){return this._focus}forceResize(){this._resize()}_beforeOrAfterNextFrame(e){const t=e?this._afterNextFramePromises:this._beforeNextFramePromises,n=new Promise(s=>{t.push(()=>(s(void 0),n))});return this._refresh(),n}beforeNextFrame(){return this._beforeOrAfterNextFrame(!1)}afterNextFrame(){return this._beforeOrAfterNextFrame(!0)}refresh(e){e&&(this._refreshUntil=Math.max(this._refreshUntil,e)),this._refresh()}_emptyContainer(){if(this._container){const e=[];for(let t=0;t<this._container.childNodes.length;++t){const n=this._container.childNodes[t];n._ogmaLayer&&e.push(n)}for(let t=0;t<e.length;++t)this._container.removeChild(e[t])}}_fillContainer(){if(this._container){const e=n1(this._container,"position");e!=="absolute"&&e!=="relative"&&e!=="fixed"&&(this._container.style.position="relative");const t=this._container.firstChild;BR.forEach(n=>{const s=this._layers[n];s&&s.element&&this._container&&this._container.insertBefore(s.element,t)})}}_updateContainerContent(){this._emptyContainer(),this._fillContainer()}_refresh(){this._inFrame?this._mustRefresh=!0:this._nextFrame||this._isDestroyed||(this._nextFrame=xy(()=>this._playFrame()))}_playFrame(){const e=Rs(),t=e-this._currentTime,n=gw([this._beforeNextFramePromises,()=>this._modules.events.fire("beforeNewFrame",{elapsed:t}),()=>this._modules.events.fire("frame",{elapsed:t}),()=>this._modules.events.fire("afterNewFrame",{elapsed:t}),this._afterNextFramePromises,()=>{this._inFrame=!1,(this._mustRefresh||e<this._refreshUntil+17)&&(this._mustRefresh=!1,this._refresh())}]);this._inFrame=!0,this._nextFrame=null,this._mustRefresh=!1,this._currentTime=e,this._beforeNextFramePromises=[],this._afterNextFramePromises=[],n.reduce((s,r)=>s.then(()=>{if(!this._isDestroyed)return r()}),Promise.resolve())}isPlayingFrame(){return this._inFrame||!!this._nextFrame}setFullScreen(e){let t=Promise.resolve();return e!==this._isFullScreen?(this._container&&(t=e?VR(this._container):jR()),t.then(()=>new Promise(n=>{this.setTimeout(()=>{this._isFullScreen=sd(),n(void 0)},UR)}))):t}isFullScreen(){return sd()}debounceBeforeFrame(e){let t=!1,n=[];const s=()=>{const r=n;t=!1,n=[],e(),r.forEach(i=>i())};return()=>new Promise(r=>{n.push(r),t||(t=!0,this.beforeNextFrame().then(s))})}destroy(){this._resizeObserver.disconnect(),RR(),this.detachFromDom(),this.clearAllTimeouts(),this.stopFrames()}};function sd(){return typeof document<"u"&&!!(document.fullscreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)}function VR(e){return sd()?Promise.resolve():e.requestFullscreen?e.requestFullscreen():e.requestFullScreen?e.requestFullScreen():e.webkitRequestFullScreen?Promise.resolve(e.webkitRequestFullScreen()):e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():Promise.resolve()}function jR(){return sd()?typeof document>"u"?Promise.resolve():document.exitFullscreen?document.exitFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.webkitCancelFullScreen?Promise.resolve(document.webkitCancelFullScreen()):document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():Promise.resolve():Promise.resolve()}var HR=class extends zt{constructor(){super(...arguments),this._nodeChanges=[],this._edgeChanges=[],this._shouldTriggerEvents=!1}onMounted(){this._nodeDataList=this._modules.graph.createAttribute(!0,{name:"data",storage:"any"},!1),this._edgeDataList=this._modules.graph.createAttribute(!1,{name:"data",storage:"any"},!1),this._nodeList=this._modules.graph.getNodeAttribute("object"),this._edgeList=this._modules.graph.getEdgeAttribute("object"),this._modules.events.register(["setData","updateNodeData","updateEdgeData"]),this._modules.events.on("addNodes",({nodes:e,objects:t})=>this._onAddElements(e,t)).on("addEdges",({edges:e,objects:t})=>this._onAddElements(e,t)).on("beforeNewFrame",()=>{this._shouldTriggerEvents&&(this._shouldTriggerEvents=!1,this._triggerEvents())})}_onAddElements(e,t){const{isNode:n,size:s,_indexes:r}=e,i=this[n?"_nodeDataList":"_edgeDataList"];for(let o=0;o<s;++o)i.set(r[o],t[o].data)}setProperty(e,t,n,{dispatch:s=!1,virtual:r=!1}={}){this._setDataProperty(e.isNode,e._indexes,t,n,s,r),this._modules.events.fire("setData",{elements:e,virtual:r})}getProperty(e,t){return this._getDataProperty(e.isNode,e._indexes,t)}_setDataProperty(e,t,n,s,r,i){r&&typeof s=="function"&&(r=!1);const o=Yb(n),a=typeof s=="function",u=e?this._nodeList:this._edgeList,d=e?this._nodeDataList:this._edgeDataList,c=qR(e?this._nodeChanges:this._edgeChanges,o);for(let g=0;g<t.length;++g){const f=t[g];let p=d.get(f);const _=u.get(f),y=r?s[g]:s;let x,E;if(o===null)x=p,E=a?y(_):y,d.set(f,E);else{p==null&&(p={},d.set(f,p));const b=o.length;for(let S=0;S<b;S++){const A=o[S];let C=p[A];S<b-1?(C==null&&(C={},p[A]=C),p=C):(x=C,E=a?y(_):y,p[A]=E)}}c.indexes.push(f),c.previousValues.push(x),c.newValues.push(E),c.virtual=i}this._scheduleEvents()}_getDataProperty(e,t,n,s){const r=Yb(n);s||(s=new Array(t.length));const i=e?this._nodeDataList:this._edgeDataList;for(let o=0;o<t.length;++o){const a=t[o];let u,d=i.get(a);if(r!==null&&r.length)if(d==null)u=void 0;else{const c=r.length;for(let g=0;g<c&&d;++g)u=d=d[r[g]]}else u=d;s[o]=u}return s}_scheduleEvents(){this._shouldTriggerEvents=!0,this._modules.dom.refresh()}_triggerEvents(){const e=this._prepareEvtPayload(!0),t=this._prepareEvtPayload(!1);this._modules.events.fire("updateNodeData",e),this._modules.events.fire("updateEdgeData",t)}_prepareEvtPayload(e){const t=e?this._modules.graph.nodeList:this._modules.graph.edgeList,n=e?"_nodeChanges":"_edgeChanges";let s=[];const r=this[n];this[n]=[];const i=[];for(let o=0;o<r.length;++o){const{indexes:a,property:u,newValues:d,previousValues:c,virtual:g}=r[o];s=s.concat(a||[]),e?i.push({property:u,newValues:d,previousValues:c,virtual:g,nodes:t(a)}):i.push({property:u,newValues:d,previousValues:c,virtual:g,edges:t(a)})}return e?{nodes:t(s).dedupe(),isNode:e,changes:i}:{edges:t(s).dedupe(),isNode:e,changes:i}}};function qR(e,t){for(let s=0;s<e.length;++s){const r=e[s],i=r.property;if(t===null&&i===null)return r;if(t&&i&&i.length===t.length){let o=!0;for(let a=0;a<i.length;++a)if(i[a]!==t[a]){o=!1;break}if(o)return r}}const n={property:t&&t.slice(),indexes:[],previousValues:[],newValues:[],nodes:null,virtual:!1,edges:null};return e.push(n),n}function Yb(e){return typeof e=="string"?e.split("."):bs(e)?e:null}var zy=512,By=128,aT=Math.round(Math.log2(zy)),Uy=Math.round(Math.log2(By)),$R=aT+Uy,yl=255,WR=32767,lT=65535,ac=16384,p_=15,xl=3,xg=15,Yc=32,wo=128,m_=8,__=1/16,y_=Math.round(Math.sqrt(xg+1)),x_=wo*y_,Ps=16,Po=1,Gr=256,XR=128,YR=128,vg=1.5,uT=1,Dl=56,ZR=16,KR=2*Dl+ZR,Zc=6,dT=3,hT=3,rr=41,ef=5,bg=5,cT=.9721,_d=24,QR=1.4142,JR=/^rgba?\((\d+),?\s*(\d+),?\s*(\d+),?\s*((\d+)?\.?\d+)*\)$/;function Gy(e,t=[0,0,0,0]){const n=JR.exec(e);return n?(t[0]=parseInt(n[1])/255,t[1]=parseInt(n[2])/255,t[2]=parseInt(n[3])/255,t[3]=n[4]===void 0?1:parseFloat(n[4]),t):null}function Kc(e){return e<16?"0"+e.toString(16):e.toString(16)}function gT([e,t,n,s=1]){return`rgba(${256*e|0},${256*t|0},${256*n|0},${s})`}function Vy(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(n,s,r,i)=>s+s+r+r+i+i);const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255,1]:null}var nm=["AliceBlue","#F0F8FF","AntiqueWhite","#FAEBD7","Aqua","#00FFFF","Aquamarine","#7FFFD4","Azure","#F0FFFF","Beige","#F5F5DC","Bisque","#FFE4C4","Black","#000000","BlanchedAlmond","#FFEBCD","Blue","#0000FF","BlueViolet","#8A2BE2","Brown","#A52A2A","BurlyWood","#DEB887","CadetBlue","#5F9EA0","Chartreuse","#7FFF00","Chocolate","#D2691E","Coral","#FF7F50","CornflowerBlue","#6495ED","Cornsilk","#FFF8DC","Crimson","#DC143C","Cyan","#00FFFF","DarkBlue","#00008B","DarkCyan","#008B8B","DarkGoldenRod","#B8860B","DarkGray","#A9A9A9","DarkGrey","#A9A9A9","DarkGreen","#006400","DarkKhaki","#BDB76B","DarkMagenta","#8B008B","DarkOliveGreen","#556B2F","DarkOrange","#FF8C00","DarkOrchid","#9932CC","DarkRed","#8B0000","DarkSalmon","#E9967A","DarkSeaGreen","#8FBC8F","DarkSlateBlue","#483D8B","DarkSlateGray","#2F4F4F","DarkSlateGrey","#2F4F4F","DarkTurquoise","#00CED1","DarkViolet","#9400D3","DeepPink","#FF1493","DeepSkyBlue","#00BFFF","DimGray","#696969","DimGrey","#696969","DodgerBlue","#1E90FF","FireBrick","#B22222","FloralWhite","#FFFAF0","ForestGreen","#228B22","Fuchsia","#FF00FF","Gainsboro","#DCDCDC","GhostWhite","#F8F8FF","Gold","#FFD700","GoldenRod","#DAA520","Gray","#808080","Grey","#808080","Green","#008000","GreenYellow","#ADFF2F","HoneyDew","#F0FFF0","HotPink","#FF69B4","IndianRed","#CD5C5C","Indigo","#4B0082","Ivory","#FFFFF0","Khaki","#F0E68C","Lavender","#E6E6FA","LavenderBlush","#FFF0F5","LawnGreen","#7CFC00","LemonChiffon","#FFFACD","LightBlue","#ADD8E6","LightCoral","#F08080","LightCyan","#E0FFFF","LightGoldenRodYellow","#FAFAD2","LightGray","#D3D3D3","LightGrey","#D3D3D3","LightGreen","#90EE90","LightPink","#FFB6C1","LightSalmon","#FFA07A","LightSeaGreen","#20B2AA","LightSkyBlue","#87CEFA","LightSlateGray","#778899","LightSlateGrey","#778899","LightSteelBlue","#B0C4DE","LightYellow","#FFFFE0","Lime","#00FF00","LimeGreen","#32CD32","Linen","#FAF0E6","Magenta","#FF00FF","Maroon","#800000","MediumAquaMarine","#66CDAA","MediumBlue","#0000CD","MediumOrchid","#BA55D3","MediumPurple","#9370DB","MediumSeaGreen","#3CB371","MediumSlateBlue","#7B68EE","MediumSpringGreen","#00FA9A","MediumTurquoise","#48D1CC","MediumVioletRed","#C71585","MidnightBlue","#191970","MintCream","#F5FFFA","MistyRose","#FFE4E1","Moccasin","#FFE4B5","NavajoWhite","#FFDEAD","Navy","#000080","OldLace","#FDF5E6","Olive","#808000","OliveDrab","#6B8E23","Orange","#FFA500","OrangeRed","#FF4500","Orchid","#DA70D6","PaleGoldenRod","#EEE8AA","PaleGreen","#98FB98","PaleTurquoise","#AFEEEE","PaleVioletRed","#DB7093","PapayaWhip","#FFEFD5","PeachPuff","#FFDAB9","Peru","#CD853F","Pink","#FFC0CB","Plum","#DDA0DD","PowderBlue","#B0E0E6","Purple","#800080","RebeccaPurple","#663399","Red","#FF0000","RosyBrown","#BC8F8F","RoyalBlue","#4169E1","SaddleBrown","#8B4513","Salmon","#FA8072","SandyBrown","#F4A460","SeaGreen","#2E8B57","SeaShell","#FFF5EE","Sienna","#A0522D","Silver","#C0C0C0","SkyBlue","#87CEEB","SlateBlue","#6A5ACD","SlateGray","#708090","SlateGrey","#708090","Snow","#FFFAFA","SpringGreen","#00FF7F","SteelBlue","#4682B4","Tan","#D2B48C","Teal","#008080","Thistle","#D8BFD8","Tomato","#FF6347","Turquoise","#40E0D0","Violet","#EE82EE","Wheat","#F5DEB3","White","#FFFFFF","WhiteSmoke","#F5F5F5","Yellow","#FFFF00","YellowGreen","#9ACD32"],Iu=[0,0,0,0],yd=new Map;yd.set(null,[0,0,0,0]),yd.set("transparent",[0,0,0,0]);for(let e=0;e<nm.length;e+=2){const t=nm[e].toLowerCase(),n=nm[e+1];yd.set(t,Vy(n))}var Fs=e=>{let t=yd.get(e);if(t===void 0){const n=e+"",s=n.charAt(0)==="#"?Vy(n):Gy(n);yd.set(e,s),t=s}return t},v_=e=>{const t=Fs(e);if(!t)return null;const[n,s,r]=t;return`#${Kc(255*n)}${Kc(255*s)}${Kc(255*r)}`},cl=e=>{let t=1,n=e;return n&&Gy(e,Iu)&&(n=`rgb(${255*+Iu[0]},${255*+Iu[1]},${255*+Iu[2]})`,t=parseFloat(Iu[3].toString())),{color:n,opacity:t}},Bd=class{on(e,t){if(typeof e!="string")throw new TypeError("Event name must be string");if(typeof t!="function")throw new TypeError("Event handler must be function");const n=this._events=this._events||{};return(n[e]=n[e]||[]).push(t),this}off(e,t){if(typeof e!="string")throw new TypeError("Event name must be string");const n=this._events=this._events||{},s=n[e];if(bs(s))if(typeof t!="function")n[e]=null;else{const r=s.indexOf(t);r!==-1&&s.splice(r,1),s.length===0&&(n[e]=null)}return this}fire(e,...t){if(typeof e!="string")throw new TypeError("Event name must be string");const n=(this._events=this._events||{})[e];if(bs(n)){const s=t;for(let r=0;r<n.length;r++){const i=n[r];i&&i.apply(this,s)}}return this}once(e,t){const n=this,s=function(...r){t.apply(n,r),n.off(e,s)};return s.handler=t,this.on(e,s)}hasListener(e,t){if(!e||!t)return!1;const n=(this._events=this._events||{})[e];if(bs(n))for(let s=0,r=n.length;s<r;s++){const i=n[s];if(i===t||i.handler===t)return!0}return!1}clearEvents(){this._events={}}getListeners(e){return(this._events=this._events||{})[e]}};function fT(e){if(e.keys)return Array.from(e.keys());const t=[];return e.forEach((n,s)=>t.push(s)),t}function pT(e){if(e.values)return Array.from(e.values());const t=[];return e.forEach(n=>t.push(n)),t}var mT=class{constructor(){this._map=new Map}reset(){this._map.clear()}set(e,t,n){this._map.set(Cb(e,t),n)}get(e,t){return this._map.get(Cb(e,t))}},eF=class{constructor({elementSize:e,sideElementSize:t,nbSideElementsPerMainElement:n,id:s,depth:r,elementType:i,animated:o,stencilUsage:a}){this._nbCellsAllocated=0,this._nbCellsFreed=0,this._isFullyAllocated=!1,this._isFullyFreed=!1,this._mustUpdate=!0,this._capacity=zy,this.version=0,this._id=s,this.depth=r,this.type=i,this.animated=o,this.stencilUsage=a,this.elementSize=e,this._nbSideElementsPerMainElement=n,this._totalSideElementsSize=n*t,this._byteCapacity=this._capacity*this.elementSize,this._byteArray=new Uint8Array(this._byteCapacity),this._dataView=new DataView(this._byteArray.buffer),this._sideByteCapacity=this._capacity*this._totalSideElementsSize,this._sideByteArray=new Uint8Array(this._sideByteCapacity),this._sideDataView=new DataView(this._sideByteArray.buffer)}update(){this._mustUpdate&&(this.version+=1,this._mustUpdate=!1,this._isFullyAllocated&&this._nbCellsFreed===this._nbCellsAllocated&&(this._isFullyFreed=!0))}allocate(e){let t=-1;return!this._isFullyAllocated&&this._nbCellsAllocated+e<=this._capacity?(t=this._nbCellsAllocated,this._nbCellsAllocated+=e,this._mustUpdate=!0):this._isFullyAllocated=!0,t}free(e,t){for(let n=0;n<t;n++){const s=(e+n)*this.elementSize;this._dataView.setUint16(s,0)}this._mustUpdate=!0,this._nbCellsFreed+=t}triggerUpdate(){this._mustUpdate=!0}isEmpty(){return this._nbCellsFreed===this._nbCellsAllocated}isFullyFreed(){return this._isFullyFreed}getId(){return this._id}getDataView(){return this._dataView}getByteArray(){return this._byteArray}getSize(){return this._nbCellsAllocated}getNbSideElementsPerMainElement(){return this._nbSideElementsPerMainElement}hasSideData(){return this._nbSideElementsPerMainElement>0}getSideDataView(){return this._sideDataView}getSideByteArray(){return this._sideByteArray}getTotalSideElementsSize(){return this._totalSideElementsSize}},Zb=8,tF=class{constructor(){this.version=0,this.version=0,this._blockInfo={buffer:null,offset:0,size:0,address:0},this._init_()}reset(){this._init_()}_init_(){this._buffersByDepth=new Array(100),this._buffersById=[],this._buffersByAscendingDepth=[],this._buffersByDescendingDepth=[],this._mustUpdate=!0}_fillBlockInfo(e,t,n,s){return this._blockInfo.buffer=e,this._blockInfo.offset=t,this._blockInfo.size=n,this._blockInfo.address=s,this._blockInfo}_createBuffer(e,t,n,s,r){const i=t?KR:Dl,o=this._buffersById.length,a=new eF({elementSize:i,sideElementSize:Zc,nbSideElementsPerMainElement:s,id:o,depth:n,elementType:e,animated:t,stencilUsage:r});return this._buffersById.push(a),a}getBlockInfo(e){return this._fillBlockInfo(this._buffersById[e>>$R],(e>>Uy)%zy,e%By,e)}allocateBlock(e,t,n,s,r,i,o){const a=sF(i,Zb);this._mustUpdate=!0;let u=null,d=-1;if(e){const g=this.getBlockInfo(e),f=g.buffer,p=g.offset,_=g.size,y=g.size===r,x=f.depth===s,E=f.type===t,b=f.animated===n,S=f.getNbSideElementsPerMainElement()===a,A=f.stencilUsage===o;y&&x&&E&&b&&S&&A?(f.triggerUpdate(),u=f,d=p):f.free(p,_)}if(d===-1){const g=+n,f=a/Zb,p=this._buffersByDepth[s]||Array(2);this._buffersByDepth[s]=p;const _=p[g]||[];p[g]=_;const y=_[t]||Array(16);_[t]=y;const x=y[f]||Array(4);y[f]=x;const E=x[o]||[];x[o]=E;const b=E[E.length-1];b&&(u=b,d=b.allocate(r)),d===-1&&(u=this._createBuffer(t,n,s,a,o),d=u.allocate(r),E.push(u))}const c=nF(u.getId(),d,r);return this._fillBlockInfo(u,d,r,c)}freeBlock(e){if(e){this._mustUpdate=!0;const t=this.getBlockInfo(e);t.buffer.free(t.offset,t.size)}return 0}_sortBuffersByDepth(){const e=[];for(let t=0;t<this._buffersByDepth.length;t++){const n=this._buffersByDepth[t];if(n)for(let s=0;s<n.length;s++){const r=n[s];if(r)for(let i=0;i<r.length;i++){const o=r[i];if(o)for(let a=0;a<o.length;a++){const u=o[a];if(u)for(let d=0;d<u.length;d++){const c=u[d];if(c)for(let g=0;g<c.length;g++){const f=c[g];f.update(),f.isFullyFreed()?(this._buffersById[f.getId()]=void 0,c.splice(g,1),g-=1):e.push(f)}}}}}}this._buffersByAscendingDepth=e,this._buffersByDescendingDepth=e.slice().reverse()}update(){this._mustUpdate&&(this._sortBuffersByDepth(),this.version+=1,this._mustUpdate=!1)}getBuffers(){return this._buffersById}getBuffersByAscendingDepth(){return this._buffersByAscendingDepth}getBuffersByDescendingDepth(){return this._buffersByDescendingDepth}};function nF(e,t,n){return((e<<aT)+t<<Uy)+n}function sF(e,t){let n=0;for(;n<e;)n+=t;return n}var Wr=1,pa=2,Eg=3,Ds=1,Io=2,da=3,Ud=4,ma=5,_a=6,Ro=7,Pr=1,tf=2,jy=3,Hy=4,ia=5,ha=6,wl=1,_T=2,yT=3;function Kb(){return{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:Ds,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,isBadge:!1,bentEnable:!1,bentVertical:!1}}function Qb(e={}){return e.pieceId=0,e.shape="",e.x1=0,e.y1=0,e.x2=0,e.y2=0,e.rectWidthOrSourceRadiusScaled=0,e.rectWidthOrSourceRadiusFixed=0,e.rectHeightOrTargetRadiusScaled=0,e.rectHeightOrTargetRadiusFixed=0,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.pattern=e.pattern||{type:Ds,attributes:{}},e.pattern.type=Ds,e.opacity=1,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=0,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=0,e.patternScale=0,e.symbolicSize=0,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isBodyTriangle=!1,e.isSelfLoop=!1,e.isText=!1,e.adjustTextAngle=!1,e.isBadge=!1,e.bentEnable=!1,e.bentVertical=!1,e}function rF(e={}){return e.duration=0,e.beginTime=-1,e.easing="linear",e}function qy(){return{valid:!1,id:void 0,end:Kb(),start:Kb(),animation:{duration:0,beginTime:-1,easing:"linear"}}}function xT(e,t,n,s){e.width=t*s,e.height=n*s,wa(e,`${t}px`,`${n}px`)}function iF(e){return 1/(1+Math.exp(-e))}var oF=class{constructor(){this._capacity=By,this._id=0,this.size=0,this.depth=0,this.animated=!1,this.stencilUsage=wl,this.type=Wr,this._list=Array(this._capacity);for(let e=0;e<this._capacity;++e)this._list[e]=qy()}reset(e,t,n,s){return this.type=e,this.animated=t,this.depth=n,s!==void 0&&(this._id=s),this.stencilUsage=wl,this.size=0,this}next(){if(this.size>=this._capacity)throw new Error("internal error: block.next() was called on a full block");return this._list[this.size++]}nextAndReset(){const e=this.next();return e.end=Qb(e.end),e.start=Qb(e.start),e.animation=rF(e.animation),e}forEach(e){this._list.forEach(e)}getElement(e){return this._list[e]}getCurrentElement(){return this._list[this.size-1]}getElements(){return this._list}getId(){return this._id}setGlobalAnimation(e,t,n){for(let s=0;s<this.size;++s){const r=this._list[s].animation;r.duration=e,r.beginTime=t,r.easing=n}}},aF=class{constructor(){this._version=0,this._initialize()}reset(){this._initialize()}_initialize(){this._mustUpdate=!0,this.maxCoord=0,this.maxScaledSize=0,this.maxMinVisibleSize=0,this.maxSymbolicSize=0,this.maxDashLength=0,this.maxGapLength=0,this.maxPatternScale=0}set({maxCoord:e,maxScaledSize:t,maxMinVisibleSize:n,maxSymbolicSize:s,maxDashLength:r,maxGapLength:i,maxPatternScale:o}){const a=this.maxCoord<e||this.maxScaledSize<t||this.maxMinVisibleSize<n||this.maxSymbolicSize<s||this.maxDashLength<r||this.maxGapLength<i||this.maxPatternScale<o;return a&&(this.maxCoord=e,this.maxScaledSize=t,this.maxMinVisibleSize=n,this.maxSymbolicSize=s,this.maxDashLength=r,this.maxGapLength=i,this.maxPatternScale=o,this._mustUpdate=!0),a}update(){return this._mustUpdate&&(this._version+=1,this._mustUpdate=!1),this}getVersion(){return this._version}},lF={linear:[0,1,0,0],quadraticIn:[0,0,1,0,0,0,0,0],quadraticOut:[0,2,-1,0,0,0,0,0],quadraticInOut:[0,0,2,0,-1,4,-2,0],cubicIn:[0,0,0,1],cubicOut:[0,3,-3,1],cubicInOut:[0,0,0,4,-3,12,-12,4]},uF=class{constructor(){this._linearEasing=[0,1,0,0,0,1,0,0],this._nameToPolygon={},this._polygonToName={},this.add(lF)}add(e){Object.keys(e).forEach(t=>{const n=e[t].slice();n.length<8&&(n[4]=n[0],n[5]=n[1],n[6]=n[2],n[7]=n[3]);const s=qm(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);this._nameToPolygon[t]=n,this._polygonToName[s]=t})}getCoefficients(e){return this._nameToPolygon[e]||this._linearEasing}getName(e,t,n,s,r,i,o,a){const u=qm(e,t,n,s,r,i,o,a);return this._polygonToName[u]||"linear"}},$y=new uF;function nf(e){return typeof e=="number"&&isFinite(e)}var dF=e=>{if(e===0)return 0;if(isNaN(e))return 32256;if(!isFinite(e))return e>0?31744:64512;const t=e<0?32768:0;if((e=Math.abs(e))<6103515625e-14)return t|Math.round(4096*e);if(e>65504)return 31744|t;let n=Math.floor(Math.log2(e)),s=Math.round(1024*(e/Math.pow(2,n)-1));return s===1024&&(s=0,n++),t|n+15<<10|s},Jb=e=>{const t=32768&e?-1:1,n=e>>10&31,s=1023&e;return n===0?s===0?0*t:t*Math.pow(2,-14)*(s/1024):n===31?s?NaN:t*(1/0):t*Math.pow(2,n-15)*(1+s/1024)},hF=0,cF=1,gF=2,fF=3,pF=4,mF=5,_F=6,yF=7,xF=8,vF=9,sf=10,bF=0,vT=1,bT=2,Wy=30,ET=0,EF=1,SF=2,Xy=3,AF=4,wF=5,Yy=6,ST=1e-6,Ir=Math.PI,rd=2*Math.PI,AT=Ir*(5/4),wT=Ir*(7/4),TT=Ir*(3/4),CT=Ir*(1/4),eE=1.1,tE=.07,TF=1,nE=1,sE=.17,CF=1,LF=-Ir/2,NF=Ir/2,IF={plain:{dash:0,gap:0},dashed:{dash:3,gap:1},dotted:{dash:1,gap:3}},kF={right:0,top:-Math.PI/2,left:Math.PI,bottom:Math.PI/2,center:0},MF={right:Math.PI,top:-Math.PI/2,left:0,bottom:Math.PI/2,center:0},PF=class{constructor(e,t,n,s,r){this._littleEndian=Gg(),this._maxScaledSize=0,this._maxMinVisibleSize=0,this._maxSymbolicSize=0,this._maxDashLength=0,this._maxGapLength=0,this._maxPatternScale=0,this._actualScaledSizeToBytes=WR,this._actualMinVisibleSizeToBytes=p_,this._actualSymbolicSizeToBytes=yl,this._actualDashLengthToBytes=xl,this._actualGapLengthToBytes=xl,this._actualPatternScaleToBytes=yl,this._genericObject=qy(),this._shapeManager=t,this._patternManager=e,this._textManager=n,this._bufferOffsetToId=s,this._colorParser=r}resizeBoundaries(e,t,n,s,r,i){this._maxScaledSize=e,this._maxMinVisibleSize=t,this._maxSymbolicSize=n,this._maxDashLength=s,this._maxGapLength=r,this._maxPatternScale=i,this._actualScaledSizeToBytes=lT/e,this._actualMinVisibleSizeToBytes=p_/t,this._actualSymbolicSizeToBytes=yl/n,this._actualDashLengthToBytes=xl/s,this._actualGapLengthToBytes=xl/r,this._actualPatternScaleToBytes=yl/i}storeGenericObject(e,t,n){const s=this._shapeManager.getIdFromName(n.shape),r=n.pieceId,i=this._dashLengthToBytes(n.dashLength),o=this._gapLengthToBytes(n.gapLength),a=+n.hasHead,u=+n.hasTail,d=+n.isBodyTriangle,c=+n.isSelfLoop,g=this._patternScaleToBytes(n.patternScale),f=this._offsetAngleToBytes(n.offsetAngle),p=+n.isText,_=+n.adjustTextAngle,y=+n.isBadge,x=+n.bentEnable,E=+n.bentVertical,b=this._opacityToBytes(n.opacity),S=this._minVisibleSizeToBytes(n.globalMinVisibleSize),A=this._minVisibleSizeToBytes(n.strokeMinVisibleSize),C=this._minVisibleSizeToBytes(n.patternMinVisibleSize),k=this._symbolicSizeToBytes(n.symbolicSize),M=this._curvatureToBytes(n.curvature),R=n.pattern.attributes.colors;R&&(n.pattern.attributes.colors=R.split(";").map(Ie=>lc(this._colorToBytes(Ie.trim()))).join(";"));const O=this._patternManager.getIdFromDefinition(n.pattern),j=this._colorToBytes(n.fillColor),z=this._colorToBytes(n.strokeColor),X=this._colorToBytes(n.patternColor),{x1:oe,y1:re,x2:Q,y2:he}=n,fe=this._fixedSizeToBytes(n.rectWidthOrSourceRadiusFixed),ae=this._fixedSizeToBytes(n.rectHeightOrTargetRadiusFixed),me=this._scaledSizeToBytes(n.thicknessOrFontSizeScaled),we=this._fixedSizeToBytes(n.thicknessOrFontSizeFixed),Z=this._scaledSizeToBytes(n.strokeWidthScaled),_e=this._fixedSizeToBytes(n.strokeWidthFixed),ze=this._scaledSizeToBytes(n.offsetScaled),Re=this._fixedSizeToBytes(n.offsetFixed),We=this._fixedSizeToBytes(n.pattern.attributes.paddingTop||0),st=this._fixedSizeToBytes(n.pattern.attributes.paddingLeft||0),ft=s+(r<<4)+(i<<8)+(o<<10)+(a<<12)+(u<<13)+(d<<14)+(c<<15),ut=g+(f<<8)+(p<<11)+(_<<12)+(y<<13)+(x<<14)+(E<<15),ce=b+(S<<4)+(A<<8)+(C<<12),be=k+(M<<8),qe=n.rectWidthOrSourceRadiusScaled/this._maxScaledSize*ac,Ue=n.rectHeightOrTargetRadiusScaled/this._maxScaledSize*ac;this._setUint16(e,t+0,ft),this._setUint16(e,t+2,ut),this._setUint16(e,t+4,ce),this._setUint16(e,t+6,be),this._setUint16(e,t+8,O),this._setUint16(e,t+10,j),this._setUint16(e,t+12,z),this._setUint16(e,t+14,X),this._setFloat32(e,t+16,oe),this._setFloat32(e,t+20,re),this._setFloat32(e,t+24,Q),this._setFloat32(e,t+28,he),this._setFloat16(e,t+32,qe),this._setUint16(e,t+34,fe),this._setFloat16(e,t+36,Ue),this._setUint16(e,t+38,ae),this._setUint16(e,t+40,me),this._setUint16(e,t+42,we),this._setUint16(e,t+44,Z),this._setUint16(e,t+46,_e),this._setUint16(e,t+48,ze),this._setInt16(e,t+50,Re),this._setInt16(e,t+52,We),this._setInt16(e,t+54,st)}_setUint16(e,t,n){e.setUint16(t,n,this._littleEndian)}_setFloat16(e,t,n){e.setUint16(t,dF(n),this._littleEndian)}_setInt16(e,t,n){e.setUint16(t,this._signedToUnsignedInt16(n),this._littleEndian)}_setFloat32(e,t,n){e.setFloat32(t,n,this._littleEndian)}_colorToBytes(e){const t=this._colorParser(e);return Math.round(15*t[0])+(Math.round(15*t[1])<<4)+(Math.round(15*t[2])<<8)+(Math.round(15*t[3])<<12)}_scaledSizeToBytes(e){return Math.ceil(Math.min(e,this._maxScaledSize)*this._actualScaledSizeToBytes)}_fixedSizeToBytes(e){return e}_minVisibleSizeToBytes(e){return Math.round(Math.min(e,this._maxMinVisibleSize)*this._actualMinVisibleSizeToBytes)}_symbolicSizeToBytes(e){return Math.round(Math.min(e,this._maxSymbolicSize)*this._actualSymbolicSizeToBytes)}_dashLengthToBytes(e){return Math.round(Math.min(e,this._maxDashLength)*this._actualDashLengthToBytes)}_gapLengthToBytes(e){return Math.round(Math.min(e,this._maxGapLength)*this._actualGapLengthToBytes)}_patternScaleToBytes(e){return Math.round(Math.min(e,this._maxPatternScale)*this._actualPatternScaleToBytes)}_offsetAngleToBytes(e){return Math.round((e+rd)%rd*(8/rd))}_opacityToBytes(e){return Math.round(15*Math.min(e,1))}_curvatureToBytes(e){return this._signedToUnsignedByte(e)}_signedToUnsignedByte(e){return Mr(e,-128,127)+128}_signedToUnsignedInt16(e){return Mr(e,-32768,32767)+32768}storeAnimationInformation(e,t,{beginTime:n,duration:s},r){this._setAnimationBeginTime(e,t,n),this._setAnimationDuration(e,t,s),this._setAnimationEasing(e,t,r)}_setAnimationBeginTime(e,t,n){this._setFloat32(e,t,n)}_setAnimationDuration(e,t,n){this._setFloat32(e,t+4,n)}_setAnimationEasing(e,t,n){this._setUint16(e,t+8,(n[0]+128<<8)+(n[4]+128)),this._setUint16(e,t+10,(n[1]+128<<8)+(n[5]+128)),this._setUint16(e,t+12,(n[2]+128<<8)+(n[6]+128)),this._setUint16(e,t+14,(n[3]+128<<8)+(n[7]+128))}extractGenericElement(e,t,n){const s=e.type,r=e.animated,i=e.getDataView(),o=t*e.elementSize,a=this._genericObject;if(a.valid=!1,i.getUint16(o)&&(a.valid=!0,this._extractGenericObject(a.end,i,o,n),r&&(this._extractGenericObject(a.start,i,o+Dl,n),this._extractAnimationInformation(a.animation,i,o+2*Dl)),a.id=this._bufferOffsetToId.get(e.getId(),t),s===pa)){const u=e.getSideDataView(),d=t*e.getTotalSideElementsSize(),c=d+e.getTotalSideElementsSize();a.end.pattern=this._textManager.extractTextFromDataView(u,d,c)}return a}_extractGenericObject(e,t,n,{bytesToActualCoord:s,bytesToActualScaledSize:r,bytesToActualMinVisibleSize:i,bytesToActualPatternScale:o,bytesToActualSymbolicSize:a,bytesToActualDashLength:u,bytesToActualGapLength:d}){const c=t,g=n,f=this._littleEndian,p=c.getUint16(g,f),_=Ln(p,0,4),y=Ln(p,4,8),x=Ln(p,8,10),E=Ln(p,10,12),b=Ln(p,12,13),S=Ln(p,13,14),A=Ln(p,14,15),C=Ln(p,15,16),k=c.getUint16(g+2,f),M=Ln(k,0,8),R=Ln(k,8,11),O=Ln(k,11,12),j=Ln(k,12,13),z=Ln(k,13,14),X=Ln(k,14,15),oe=Ln(k,15,16),re=c.getUint16(g+4,f),Q=Ln(re,0,4),he=Ln(re,4,8),fe=Ln(re,8,12),ae=Ln(re,12,16),me=c.getUint16(g+6,f),we=Ln(me,0,8),Z=Ln(me,8,16),_e=c.getUint16(g+8,f),ze=c.getUint16(g+10,f),Re=c.getUint16(g+12,f),We=c.getUint16(g+14,f),st=c.getFloat32(g+16,f),ft=c.getFloat32(g+20,f),ut=c.getFloat32(g+24,f),ce=c.getFloat32(g+28,f),be=c.getUint16(g+32,f),qe=c.getUint16(g+34,f),Ue=c.getUint16(g+36,f),Ie=c.getUint16(g+38,f),Fe=c.getUint16(g+40,f),Oe=c.getUint16(g+42,f),Xe=c.getUint16(g+44,f),dt=c.getUint16(g+46,f),mt=c.getUint16(g+48,f),ht=sm(c.getUint16(g+50,f)),wt=sm(c.getUint16(g+52,f)),Lt=sm(c.getUint16(g+54,f));e.pieceId=y,e.shape=this._shapeManager.getNameFromId(_),e.x1=ii(st,s),e.y1=ii(ft,s),e.x2=ii(ut,s),e.y2=ii(ce,s),e.rectWidthOrSourceRadiusScaled=Jb(be)*this._maxScaledSize/ac,e.rectWidthOrSourceRadiusFixed=qe,e.rectHeightOrTargetRadiusScaled=Jb(Ue)*this._maxScaledSize/ac,e.rectHeightOrTargetRadiusFixed=Ie,e.thicknessOrFontSizeScaled=ii(Fe,r),e.thicknessOrFontSizeFixed=Oe,e.strokeWidthScaled=ii(Xe,r),e.strokeWidthFixed=dt,e.offsetScaled=ii(mt,r),e.offsetFixed=ht,e.pattern=this._patternManager.getDefinitionFromId(_e),e.pattern.attributes.paddingTop=wt,e.pattern.attributes.paddingLeft=Lt,e.opacity=Q/15,e.fillColor=lc(ze),e.strokeColor=lc(Re),e.patternColor=lc(We),e.globalMinVisibleSize=ii(he,i),e.strokeMinVisibleSize=ii(fe,i),e.patternMinVisibleSize=ii(ae,i),e.offsetAngle=R*(2*Math.PI/8),e.patternScale=M*o,e.symbolicSize=we*a,e.curvature=RF(Z),e.dashLength=x*u,e.gapLength=E*d,e.hasHead=!!b,e.hasTail=!!S,e.isBodyTriangle=!!A,e.isSelfLoop=!!C,e.isText=!!O,e.adjustTextAngle=!!j,e.isBadge=!!z,e.bentEnable=!!X,e.bentVertical=!!oe}_extractAnimationInformation(e,t,n){const s=this._littleEndian,r=t.getFloat32(n,s),i=t.getFloat32(n+4,s),o=t.getUint16(n+8,s),a=t.getUint16(n+10,s),u=t.getUint16(n+12,s),d=t.getUint16(n+14,s),c=(o>>8)-128,g=(a>>8)-128,f=(u>>8)-128,p=(d>>8)-128,_=o%256-128,y=a%256-128,x=u%256-128,E=d%256-128;e.beginTime=r,e.duration=i,e.easing=$y.getName(c,g,f,p,_,y,x,E)}};function Ln(e,t,n){return e%(1<<n)>>t}function RF(e){return e-128}function sm(e){return e-32768}function ii(e,t){return e*t}var rE=new Array(65535);function lc(e){let t=rE[e];if(!t){const n=Ln(e,0,4)/15,s=Ln(e,4,8)/15,r=Ln(e,8,12)/15,i=Ln(e,12,16)/15;t=`rgba(${255*n|0}, ${255*s|0}, ${255*r|0}, ${i})`,n+s+r+i===0&&(t=null),rE[e]=t}return t}var FF={[Io]:"image",[Ud]:"piechart",[da]:"text",[ma]:"icon",[_a]:"badge"},DF=class{constructor(){this._pixelRatio=1,this._nextPatternId=1,this._version=0,this._init_()}reset(){this._init_()}_init_(){this._mustUpdate=!0,this._nextPatternId=1,this._patterns=[null],this._patternsByHash={},this._pixelRatio=1,this._nullPattern={id:-1,type:Ds,attributes:{}}}_increaseNextId(){let e=this._nextPatternId++;for(e%256==255&&(e=this._nextPatternId++);this._patterns.length<=e;)this._patterns.push(void 0);return e}_createPattern({type:e,attributes:t}){const n={id:this._increaseNextId(),type:e,attributes:this._getAttributes(e,t)};return this._patterns[n.id]=n,this._mustUpdate=!0,n}_getAttributes(e,t){return e===Io?{image:t.image,scaled:t.scaled,duplicated:t.duplicated}:e===da||e===ma||e===_a?{font:t.font,size:t.size,style:t.style,text:t.text,paddingLeft:t.paddingLeft,paddingTop:t.paddingTop,align:t.align||"center",offset:t.offset||0}:e===Ud&&t.colors?{colors:t.colors,colorArray:t.colors.split(";").map(n=>n.trim())}:{}}getPatternList(){return this._patterns.filter(e=>e)}update(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)}setPixelRatio(e){e!==this._pixelRatio&&(this._pixelRatio=e,this._mustUpdate=!0)}getPixelRatio(){return this._pixelRatio}notifyUpdate(){this._mustUpdate=!0}getIdFromDefinition(e){const{type:t,attributes:n}=e,s=t===da||t===ma||t===_a;let r=0;return t&&t!==Ds&&t!==Ro&&(t!==Io||n.image)&&(!s||n.text&&n.font)&&(r=this._addPattern(e),t===da&&n.style==="normal"&&(n.style="bold",this._addPattern(e))),r}_addPattern(e){const t=this._getPatternHash(e);let n=this._patternsByHash[t];return n||(this._nextPatternId>65500?Gi("maximum number of pattern exceeded"):(n=this._createPattern(e).id,this._patternsByHash[t]=n)),n}_getPatternHash({type:e,attributes:t}){const n=[FF[e]];return e===Io?n.push(t.scaled?"scaled":"non-scaled",t.duplicated?"duplicated":"non-duplicated",t.image.src||t.image.toDataURL()):e===da?n.push(t.text,t.font,t.style,t.size,t.align||"center",t.offset||0):e===ma||e===_a?n.push(t.text,t.font,t.style,t.size,t.paddingLeft,t.paddingTop):n.push(t.colors),n.join("+")}getDefinitionFromId(e){if(e&&this._patterns[e]){const t=this._patterns[e];if(t)return t}return this._nullPattern}getVersion(){return this._version}};function iE(e){return e.map(({x:t,y:n,r:s=0})=>({x:t,y:n,r:s}))}var OF=class{constructor(){this._version=0,this._mustUpdate=!0,this._byName={},this._byId=new Array(xg+1)}register(e,{getDistanceFromStrokeVertically:t,getDistanceFromStrokeHorizontally:n,points:s,hole:r,isSimple:i}){if(this._byName[e])return;let o=i?1:m_;const a=i?m_-1:xg;for(;this._byId[o];)o+=1;if(o>a)throw new Error("max number of shape exceeded");const u={id:o,name:e,getDistanceFromStrokeVertically:t,getDistanceFromStrokeHorizontally:n,points:iE(s.slice()),hole:r?iE(r.slice()):null,isSimple:!!i};return this._mustUpdate=!0,this._byId[o]=u,this._byName[e]=u,u}getIdFromName(e){return this._byName[e].id}getNameFromId(e){const t=this._byId[e];return t?t.name:""}getDefinitionFromName(e){return this._byName[e]}update(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)}getVersion(){return this._version}getShapeList(){return this._byId.filter(e=>e)}},b_=300,E_=150,LT=class{constructor(){this.style={},this.width=b_,this.height=E_,this.__context=new NT,this.style={},this.width=b_,this.height=E_}get __dummy(){return!0}get parentNode(){return null}getContext(e){return e==="2d"?this.__context:null}toDataURL(e="png"){return`data:image/${e};base64,`}addEventListener(){}removeEventListener(){}getBoundingClientRect(){return{left:0,top:0,bottom:0,right:0,width:this.width,height:this.height}}},NT=class{constructor(){this._fontSize=10}set font(e){const t=e.match(/\d+/);t&&(this._fontSize=parseFloat(t[0]))}set fillStyle(e){}set textBaseline(e){}set textAlign(e){}set strokeStyle(e){}set lineWidth(e){}fill(){}stroke(){}clearRect(){}fillRect(){}strokeRect(){}beginPath(){}closePath(){}moveTo(){}lineTo(){}rect(){}arc(){}save(){}restore(){}clip(){}translate(){}rotate(){}fillText(){}setLineDash(){}quadraticCurveTo(){}bezierCurveTo(){}drawImage(){}measureText(e){return{width:e.length*Math.ceil(.625*this._fontSize)}}getImageData(){return{width:0,height:0,data:new Uint8ClampedArray(0)}}},uc=kr("canvas")||kr("canvas-prebuilt");function Es(e=b_,t=E_){if(qi){const s=document.createElement("canvas");return s.width=e,s.height=t,s}if(uc){let s=null;return s="createCanvas"in uc?uc.createCanvas(e,t):new uc(e,t),s.style={},s}const n=new LT;return n.width=e,n.height=t,n}function S_(e,t,n=e.width,s=e.height){t.clearRect(0,0,n,s)}function Fo(e,t,n,s=""){e.font=`${s} ${n}px ${t}`}function IT(){return Zy(Es(),{},"webgl")!==null}var kT=e=>{const{canvas:t,width:n,height:s}={canvas:document.createElement("canvas"),width:window.innerWidth*devicePixelRatio,height:window.innerHeight*devicePixelRatio,...e};t.width=Math.ceil(n),t.height=Math.ceil(s),t.style.width=Math.ceil(n/devicePixelRatio)+"px",t.style.height=Math.ceil(s/devicePixelRatio)+"px";const r=t.getContext("webgl2",{antialias:!0});if(!r)throw new Error("WebGL 2.0 not supported");return r},MT=(e,t,n)=>{const s=kT();return s.canvas.addEventListener("webglcontextlost",n),{context:s,cleanUp:()=>{var r;s.canvas.removeEventListener("webglcontextlost",n),(r=s.getExtension("WEBGL_lose_context"))==null||r.loseContext()}}};function Zy(e,t,n){let s=e.getContext(n,t);return s||(s=e.getContext("experimental-webgl",t)),s||null}function Ky(e,t){if(t<2)return e;const n=e.split(`
`),s=[];for(let r=0;r<n.length;++r){const i=n[r];if(i.length<t)s.push(i);else{const o=PT(n[r],t);for(let a=0;a<o.length;++a)s.push(o[a])}}return s.join(`
`)}function PT(e,t){const n=[""],s=e.split(" ");for(let r=0;r<s.length;r++){const i=n[n.length-1],o=s[r];i.length+1+o.length<=t&&i.length?n[n.length-1]+=(i.length>0?" ":"")+o:n.push(o)}return n}function RT(e,t){if(e===null)return null;const n=(e=e.toString()).split(`
`),s=[];let r=0;for(let i=0;i<n.length;i++){let o=n[i];if(!t||t<=1||o.length<t)s.push(o),r=Math.max(r,o.length);else{const a=PT(n[i],t);for(let u=0;u<a.length;u++)o=a[u],s.push(o),r=Math.max(r,o.length)}}return{data:s,maxLength:r,lines:s.length}}function FT(){const e=kr("@mapbox/mapbox-gl-rtl-text")||kr("mapbox-gl-rtl-text"),t=e?e.processBidirectionalText:ko?window.processBidirectionalText:null,n=e?e.applyArabicShaping:ko?window.applyArabicShaping:null;return{processBidirectionalText:t?r=>{if(r===null||r==null)return"";const i=[];let o=0,a="";const u=r.split(`
`);for(let d=0;d<u.length;d++){const c=u[d],g=u[d].length+o;g>0&&d<u.length-1&&i.push(g),a+=d>0?""+c:c,o+=c.length}return t(a,i).join(`
`)}:r=>r,applyArabicShaping:n?r=>r==null?null:typeof r=="number"?r.toString():n(r):r=>r==null?null:r.toString()}}var rm=Gg(),dc=10,zF=1<<17,BF=65536,UF=256,oE=128,GF=25,DT=1e3,A_=2,VF=class{constructor(e){this._patternManager=e,this._canvas=Es(),this._ctx=this._canvas.getContext("2d",{willReadFrequently:!0}),this._processBidirectionalText=FT().processBidirectionalText,this._cornerRadius=0,this._version=0,this._textPattern={id:0,type:Ro,attributes:{text:"",font:"",size:0,style:"normal",align:"center"},dimensions:{width:0,height:0}},this._textDimensions={width:0,height:0},this._lineWidthList=new Array(64),this._init()}_init(){this._mustClear=!1,this._clear()}reset(){this._init()}clear(){this._mustClear=!0}_measureChar(e,t,n){return Fo(this._ctx,t,_d,n),this._ctx.measureText(e).width/_d}_getAtlas(e,t,n,s){const r=n===Rd?0:n,i=this._byFont[e]||(this._byFont[e]={none:void 0,bold:void 0,italic:void 0,normal:void 0}),o=i[s]||(i[s]={}),a=o[t]||(o[t]=new Array(50));return a[r]||(a[r]=new Array(256))}_getMeasurementAtlas(e,t){const n=this._widthAtlases[t];return n[e]||(n[e]=new Array(256))}measureText(e,t,n,s=1){if(!t||e===null)return this._textDimensions.width=0,this._textDimensions.height=0,this._textDimensions;const r=this._getMeasurementAtlas(t,n);let i=0,o=0,a=1;for(let u=0;u<e.length;++u){const d=e.charCodeAt(u);if(d===dc)o>i&&(i=o),o=0,a+=1;else{let c=r[d];c===void 0&&(c=this._measureChar(e[u],t,n),r[d]=c),o+=c}}return o>i&&(i=o),this._textDimensions.width=i*s,this._textDimensions.height=a*s,this._textDimensions}_getCharInfo(e,t,n,s,r,i){let o=e[t];if(!o){const a=String.fromCharCode(t);o={ratio:this._measureChar(a,n,s),patternId:0},o.patternId=this._patternManager.getIdFromDefinition({id:0,type:da,attributes:{text:a,font:n,style:s,size:r,align:i}}),e[t]=o}return o}storeTextInDataView(e,t,n,s){let r=t;if(s&&s.type===Ro){const{font:i,style:o,size:a,align:u}=s.attributes,d=u==="center",c=this._getAtlas(i,o,a,u);let g=0,f=1,p=0,_=0;const y=this._lineWidthList,x=this._processBidirectionalText(s.attributes.text);for(let A=0;A<x.length;++A){const C=x.charCodeAt(A);C===dc?(p>g&&(g=p),y[_]=p,_++,p=0,f++):p+=this._getCharInfo(c,C,i,o,a,u).ratio}y[_]=p,p>g&&(g=p),_=0;let E=-(d?y[_]:g)/2,b=(1-f)/2,S=0;for(let A=0;A<x.length;++A){const C=x.charCodeAt(A),k=c[C];if(C===dc)_+=1,E=-(d?y[_]:g)/2,b+=A===0?.5:1,S=0;else{const M=k.ratio,R=k.patternId;E+=(M+S)/2,S=M;const O=(Mr(E*DT+BF,0,zF-1)<<8)+Mr(b*A_+oE,0,UF-1);e.setUint16(r,R,rm),e.setUint32(r+2,O,rm),r+=Zc}}}this._fillWithZeros(e,r,n)}extractTextFromDataView(e,t,n){const s=e,r=rm,i=s.getUint16(t,r),o=this._textPattern,a=this._patternManager.getDefinitionFromId(i),{font:u,style:d,size:c,align:g}=a.attributes,f=this._getAtlas(u,d,c,g),p=[];let _=0,y=0,x=0,E=null;for(let S=t;S<n;S+=Zc){const A=s.getUint16(S,r);if(!A)break;const C=(s.getUint8(S+2)-oE)/A_,k=this._patternManager.getDefinitionFromId(A);if(!k||!k.attributes||!k.attributes.text)break;const M=k.attributes.text.charCodeAt(0),R=f[M];E===null?E=C:C>E&&(_>y&&(y=_),_=0,x+=1,p.push(dc),E=C),p.push(M),R&&(_+=R.ratio)}_>y&&(y=_);const b=String.fromCharCode.apply(null,p);return o.attributes.style=d,o.attributes.font=u,o.attributes.size=c,o.attributes.align=g,o.attributes.text=this._processBidirectionalText(b),o.dimensions&&(o.dimensions.width=y,o.dimensions.height=x),o}_fillWithZeros(e,t,n){for(let s=t;s<n;s+=Zc)e.setUint16(s,0)}_clear(){this._byFont={},this._widthAtlases={normal:{},bold:{},italic:{}}}update(){this._mustClear&&(this._clear(),this._mustClear=!1)}getVersion(){return this._version}getCornerRadius(){return this._cornerRadius}setCornerRadius(e){e!==this._cornerRadius&&(this._cornerRadius=e,this._version++)}},Qy=()=>({minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),Ws=class Qc{constructor(t={}){const{xValues:n=[],yValues:s=[],scaledSizeValues:r=[],fixedSizeValues:i=[]}=t;this.minX=Fi(n),this.minY=Fi(s),this.maxX=ml(n),this.maxY=ml(s),this.minScaledSize=Fi(r),this.maxScaledSize=ml(r),this.minFixedSize=Fi(i),this.maxFixedSize=ml(i),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY}reset(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.minScaledSize=1/0,this.maxScaledSize=-1/0,this.minFixedSize=1/0,this.maxFixedSize=-1/0,this.width=0,this.height=0,this.cx=0,this.cy=0,this}addPoint(t,n,s,r){return this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n),s!==void 0&&r!==void 0&&(r==="scaled"?(this.minScaledSize=Math.min(this.minScaledSize,s),this.maxScaledSize=Math.max(this.maxScaledSize,s)):(this.minFixedSize=Math.min(this.minFixedSize,s),this.maxFixedSize=Math.max(this.maxFixedSize,s))),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY,this}computeForZoom(t){const n=Math.max(this.maxScaledSize,this.maxFixedSize/t);return Qc.from({minX:this.minX-n/2,minY:this.minY-n/2,maxX:this.maxX+n/2,maxY:this.maxY+n/2,width:this.width+n,height:this.height+n})}static from({minX:t,minY:n,maxX:s,maxY:r,width:i,height:o}={}){const a=new Qc;return t!=null&&(a.minX=t),n!=null&&(a.minY=n),s!=null&&(a.maxX=s),r!=null&&(a.maxY=r),s!=null&&t!=null&&(a.width=i||(s-t)/2,a.cx=(t+s)/2),r!=null&&n!=null&&(a.height=o||(r-n)/2,a.cy=(n+r)/2),a}static fromValues(t,n,s){let r=1/0,i=1/0,o=-1/0,a=-1/0,u=-1/0;for(let c=0;c<t.length;c++){const g=t[c],f=n[c],p=s[c];g-p<r&&(r=g-p),f-p<i&&(i=f-p),g+p>o&&(o=g+p),f+p>a&&(a=f+p),p>u&&(u=p)}const d=Qc.from({minX:r,minY:i,maxX:o,maxY:a});return d.maxScaledSize=u,d}pad(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,this.width+=2*t,this.height+=2*t,this}isValid(){return isFinite(this.width)&&isFinite(this.height)}extend(t){return t.isValid()?(this.addPoint(t.minX,t.minY),this.addPoint(t.maxX,t.maxY),this):this}bottomLeft(){return{x:this.minX,y:this.minY}}topRight(){return{x:this.maxX,y:this.maxY}}};function aE(e,t,n,s,r){const i=1-r;return i*i*i*e+3*r*i*i*t+3*r*r*i*n+r*r*r*s}function vl(e,t,n,s){const r=1-s;return r*r*e+2*r*s*t+s*s*n}var jF=(e,t)=>2/(1+Math.exp(-Math.abs(e*t))),HF=5,lE=5;function rf(e,t,n,s,r,i){const o=i||{x1:0,y1:0,x2:0,y2:0},a=(s+s/lE*n)*lE,u=-r+Math.PI,d=-r+Math.PI/2;return o.x1=e+Math.cos(u)*a,o.y1=t+Math.sin(u)*a,o.x2=e+Math.cos(d)*a,o.y2=t+Math.sin(d)*a,o}function of(e,t,n,s,r,i,o,a){const u=a||{x1:0,y1:0,x2:0,y2:0};if(i){const d=iF(r);if(o){const c=d*t+(1-d)*s;u.x1=e,u.y1=c,u.x2=n,u.y2=c}else{const c=d*e+(1-d)*n;u.x1=c,u.y1=t,u.x2=c,u.y2=s}}else u.x1=e,u.y1=t,u.x2=n,u.y2=s;return u}function Ca(e,t,n,s,r,i){const o=i||{x:0,y:0},a=(e+n)/2,u=(t+s)/2,d=e-n,c=t-s,g=Math.sqrt(d*d+c*c);if(g===0)return o.x=a,o.y=u,o;const f=c/g,p=-d/g,_=-g*r/HF;return o.x=a+f*_,o.y=u+p*_,o}function af(e,t,n,s,r,i,o,a={x:0,y:0}){return a.x=(1-e)*(1-e)*t+2*(1-e)*e*i+e*e*s,a.y=(1-e)*(1-e)*n+2*(1-e)*e*o+e*e*r,a}function Jy(e,t,n,s,r,i,o,a={x:0,y:0}){return a.x=(2*e-2)*t+(2*s-4*i)*e+2*i,a.y=(2*e-2)*n+(2*r-4*o)*e+2*o,O1(a)}function OT(e,t,n,s,r,i,o,a={x:0,y:0}){return Jy(e,t,n,s,r,i,n,a),mg(a.x,a.y,0,0,Math.PI/2,a),a}function zT(e,t,n,s,r,i,o,a,u,d=0,c=!1){const g=n-2*o+r,f=s-2*a+i,p=-((n-e)*f-(s-t)*g)/((2*o-2*n)*f-(2*a-2*s)*g);if(p<0||p>1)return!1;let _=u/2;c&&(_*=1-p),_+=d;const y=vl(n,o,r,p),x=vl(s,a,i,p);return ss(y,x,e,t)<=_}function qF(e,t){const n=e.getAttribute("curvature"),[s,r]=e.getExtremities().getAttributes(["x","y"]),i=Ca(s.x,s.y,r.x,r.y,n);return af(t,s.x,s.y,r.x,r.y,i.x,i.y)}function $F(e,t){const n=e.getAttribute("curvature"),[s,r]=e.getExtremities().getAttributes(["x","y"]),i=Ca(s.x,s.y,r.x,r.y,n);return OT(t,s.x,s.y,r.x,r.y,i.x,i.y)}function WF(e,t){const n=e.getAttribute("curvature"),[s,r]=e.getExtremities().getAttributes(["x","y"]),i=Ca(s.x,s.y,r.x,r.y,n);return Jy(t,s.x,s.y,r.x,r.y,i.x,i.y)}function xd(e,t,n,s,r,i,o,a,u,d={x:0,y:0}){const c=(1-e)*(1-e)*(1-e),g=3*e*(1-e)*(1-e),f=3*e*e*(1-e),p=e*e*e;return d.x=c*t+g*i+f*a+p*s,d.y=c*n+g*o+f*u+p*r,d}function w_(e,t,n,s,r,i,o,a,u,d,c,g){let f=.5,p=ss(e,t,n,s)<ss(e,t,r,i)?-.01:.01,_=100;const y=xd(f,n,s,r,i,o,a,u,d);let x,E=ss(e,t,y.x,y.y);const b=c/2+g;for(;_-- >0&&f>=0&&f<=1&&E>b&&(p>.001||p<-.001);)x=E,xd(f,n,s,r,i,o,a,u,d,y),E=ss(e,t,y.x,y.y),E>x?(p=-p/2,f+=p):f+p<0||f+p>1?(p/=2,E=x):f+=p;return E<b}function ex(e,t,n,s,r,i,o=Qy()){const a=e+.6666666666666666*(n-e),u=t+2/3*(s-t);return lf(e,t,a,u,a+1/3*(r-e),u+1/3*(i-t),r,i,o)}function lf(e,t,n,s,r,i,o,a,u=Qy()){const{min:d,max:c,sqrt:g}=Math;let f,p,_,y,x;u.minX=d(e,o),u.maxX=c(e,o),u.minY=d(t,a),u.maxY=c(t,a);for(let E,b,S,A,C,k,M,R=0;R<2;++R)if(R===0?(p=e,_=n,y=r,x=o):(p=t,_=s,y=i,x=a),b=6*p-12*_+6*y,E=-3*p+9*_-9*y+3*x,S=3*_-3*p,b|=0,E|=0,S|=0,E!==0)C=b*b-4*S*E,C<0||(k=(-b+g(C))/(2*E),k>0&&k<1&&(f=im(k,p,_,y,x),R===0?(u.minX=d(u.minX,f),u.maxX=c(u.maxX,f)):(u.minY=d(u.minY,f),u.maxY=c(u.maxY,f))),M=(-b-g(C))/(2*E),M>0&&M<1&&(f=im(M,p,_,y,x),R===0?(u.minX=d(u.minX,f),u.maxX=c(u.maxX,f)):(u.minY=d(u.minY,f),u.maxY=c(u.maxY,f))));else{if(b===0)continue;A=-S/b,A>0&&A<1&&(f=im(A,p,_,y,x),R===0?(u.minX=d(u.minX,f),u.maxX=c(u.maxX,f)):(u.minY=d(u.minY,f),u.maxY=c(u.maxY,f)))}return u}function im(e,t,n,s,r){return Math.pow(1-e,3)*t+3*Math.pow(1-e,2)*e*n+3*(1-e)*Math.pow(e,2)*s+Math.pow(e,3)*r}function XF(e,t,n,s,r,i){const o=e-2*n+r,a=t-2*s+i,u=2*n-2*e,d=2*s-2*t,c=4*(o*o+a*a),g=4*(o*u+a*d),f=u*u+d*d,p=2*Math.sqrt(c+g+f),_=Math.sqrt(c),y=2*c*_,x=2*Math.sqrt(f),E=g/_;return(y*p+_*g*(p-x)+(4*f*c-g*g)*Math.log((2*_+E+p)/(E+x)))/(4*y)}var zi,ji=(zi=class extends Bd{constructor({bufferList:t,patternManager:n,boundariesManager:s,shapeManager:r,textManager:i,memoryManager:o}){super(),this._firstFrame=!0,this._width=0,this._height=0,this._pixelRatio=0,this._viewX=0,this._viewY=0,this._viewZoom=0,this._viewAngle=0,this._viewAngleCos=0,this._viewAngleSin=0,this._currentTime=0,this._scales={bytesToActualCoord:0,bytesToActualScaledSize:0,bytesToActualMinVisibleSize:0,bytesToActualSymbolicSize:0,bytesToActualDashLength:0,bytesToActualGapLength:0,bytesToActualPatternScale:0},this._shapesVersion=0,this._patternsVersion=0,this._boundariesVersion=0,this._textsVersion=0,this._backgroundRgba=[1,1,1,0],this._renderBackground=!1,this._hideImages=!1,this._genericObject=qy(),this._littleEndian=Gg(),this._bufferList=t,this._shapeManager=r,this._patternManager=n,this._boundariesManager=s,this._textManager=i,this._memoryManager=o}static createInitData(){return null}static getName(){return null}static isAvailable(){return!0}static setEdgeArrowSizeRatio(t){zi.edgeArrowSizeRatio=t}static setMinEdgeTipSize(t){zi.minEdgeTipSize=t}getDomElement(){return null}_initCanvas(t){t.style.touchAction="none"}export(t){return Promise.resolve()}extractElement(t,n){return this._memoryManager.extractGenericElement(t,n,this._scales)}_compareDimensions(t,n,s){return(t!==this._width||n!==this._height||s!==this._pixelRatio)&&(this._width=t,this._height=n,this._pixelRatio=s,!0)}_compareView(t,n,s,r){return(t!==this._viewX||n!==this._viewY||s!==this._viewZoom||r!==this._viewAngle)&&(this._viewX=t,this._viewY=n,this._viewZoom=s,this._viewAngle=r,this._viewAngleCos=Math.cos(r),this._viewAngleSin=Math.sin(r),!0)}_compareCurrentTime(t){return t!==this._currentTime&&(this._currentTime=t,!0)}_compareBackgroundColor(t,n){return(t!==this._backgroundColor||n!==this._renderBackground)&&(this._renderBackground=n,this._backgroundColor=t,this._backgroundRgba=Fs(this._backgroundColor),!0)}_compareShapes(){return this._shapesVersion!==this._shapeManager.getVersion()&&(this._shapesVersion=this._shapeManager.getVersion(),!0)}_comparePatterns(){return this._patternsVersion!==this._patternManager.getVersion()&&(this._patternsVersion=this._patternManager.getVersion(),!0)}_compareBoundaries(){return this._boundariesVersion!==this._boundariesManager.getVersion()&&(this._boundariesVersion=this._boundariesManager.getVersion(),!0)}_compareTexts(){return this._textsVersion!==this._textManager.getVersion()&&(this._textsVersion=this._textManager.getVersion(),!0)}_compareIsDisplayableBuffer(t){return this._isBufferDisplayable!==t&&(this._isBufferDisplayable=t,!0)}_compareHideImages(t){return this._hideImages!==t&&(this._hideImages=t,!0)}renderFrame({x:t,y:n,zoom:s,angle:r,width:i,height:o,pixelRatio:a,backgroundColor:u,currentTime:d,isBufferDisplayable:c,hideImages:g,renderBackground:f}){const p=this._compareShapes(),_=this._comparePatterns(),y=this._compareBoundaries(),x=this._compareTexts(),E=this._compareDimensions(i,o,a),b=this._compareView(t,n,s,r),S=this._compareCurrentTime(d),A=this._compareBackgroundColor(u,f),C=this._compareIsDisplayableBuffer(c),k=this._compareHideImages(g);if(y){const M=this._boundariesManager,R=this._scales;R.bytesToActualCoord=1,R.bytesToActualScaledSize=M.maxScaledSize/lT,R.bytesToActualMinVisibleSize=M.maxMinVisibleSize/p_,R.bytesToActualSymbolicSize=M.maxSymbolicSize/yl,R.bytesToActualDashLength=M.maxDashLength/xl,R.bytesToActualGapLength=M.maxGapLength/xl,R.bytesToActualPatternScale=M.maxPatternScale/yl}this._firstFrame&&this._beforeFirstFrame(),this._render({shapesChanged:p,patternsChanged:_,boundariesChanged:y,textsChanged:x,dimensionsChanged:E,viewChanged:b,currentTimeChanged:S,backgroundColorChanged:A,isBufferDisplayableChanged:C,isHideImagesChanged:k}),this._firstFrame&&(this._afterFirstFrame(),this._firstFrame=!1)}_render(t){}_beforeFirstFrame(){}_afterFirstFrame(){}destroy(){}ensureAnimationsReady(){}getImageData(){return null}setViewportClipping(t){}},zi.edgeArrowSizeRatio=dT,zi.minEdgeTipSize=hT,zi);function BT(e,t,n,s,r,i,o,a=0,u=!1){const d=ss(n,s,r,i),c=(o/2*(u?ss(e,t,r,i)/d:1)+a)/d,g=(r-n)*c,f=(i-s)*c,p=n+f,_=s-g,y=e-p,x=t-_,E=n-f-p,b=s+g-_,S=r+f-p,A=i-g-_,C=y*E+x*b,k=y*S+x*A;return C>0&&C<E*E+b*b&&k>0&&k<S*S+A*A}function YF(e,t,n,s,r=!1){if(r&&(hc(e,n)||hc(e,s)||hc(t,n)||hc(t,s)))return!1;let i=(e.y-n.y)*(s.x-n.x)-(e.x-n.x)*(s.y-n.y);const o=(t.x-e.x)*(s.y-n.y)-(t.y-e.y)*(s.x-n.x);if(o===0)return!1;const a=i/o;i=(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y);const u=i/o;return!(a<=0||a>=1||u<=0||u>=1)}function hc(e,t){return e.x===t.x&&e.y===t.y}function Ol(e,t,n,s){return Math.atan2(s-t,n-e)}function ZF(e,t,n){const s=Ol(e.x,e.y,t.x,t.y)-Ol(n.x,n.y,t.x,t.y);return s<0?s+2*Math.PI:s}function KF(e,t,n,s,r,i,o,a){const u=(a-i)*(n-e)-(o-r)*(s-t);if(u===0)return null;let d=t-i;return d=((o-r)*d-(a-i)*(e-r))/u,{x:e+d*(n-e),y:t+d*(s-t)}}function qu(e,t,n,s,r,i,o,a){const u=e-n,d=t-s,c=r-o,g=i-a,f=u*g-c*d,p=(d*(e-r)-u*(t-i))/f;if(p<0||p>1)return null;const _=(c*(i-t)+g*(e-r))/f;return _>=0&&_<=1?{x:e-_*u,y:t-_*d}:null}function UT(e,t,n,s,r,i,o,a){let u;const d=[];return u=qu(e,t,n,s,r,i,r,a),u&&d.push(u),u=qu(e,t,n,s,r,a,o,a),u&&d.push(u),u=qu(e,t,n,s,o,a,o,i),u&&d.push(u),u=qu(e,t,n,s,o,i,r,i),u&&d.push(u),d}function bl(e,t,n,s,r,i,o,a){const u=((o-r)*(t-i)-(a-i)*(e-r))/((a-i)*(n-e)-(o-r)*(s-t)),d=((n-e)*(t-i)-(s-t)*(e-r))/((a-i)*(n-e)-(o-r)*(s-t));return u>=0&&u<=1&&d>=0&&d<=1}function tx(e,t,n,s,r,i,o,a){return e>=r&&t>=i&&e<=o&&t<=a||n>=r&&s>=i&&n<=o&&s<=a||!!bl(e,t,n,s,r,i,r,a)||!!bl(e,t,n,s,o,i,o,a)||!!bl(e,t,n,s,r,i,o,i)||!!bl(e,t,n,s,r,a,o,a)}function GT(e,t,n){return Math.sqrt(nx(e.x,e.y,t.x,t.y,n.x,n.y))}function nx(e,t,n,s,r,i){const o=Wc(n,s,r,i);if(o===0)return Wc(e,t,n,s);let a=((e-n)*(r-n)+(t-s)*(i-s))/o;return a=Math.max(0,Math.min(1,a)),Wc(e,t,n+a*(r-n),s+a*(i-s))}function VT(e,t,n,s,r,i){const o=r-n,a=i-s;if(o===0&&a===0)return{x:n,y:s};const u=((e-n)*o+(t-s)*a)/(o*o+a*a);return u<0?{x:n,y:s}:u>1?{x:r,y:i}:{x:n+u*o,y:s+u*a}}function QF(e,t,n,s,r,i){const o=r-n,a=i-s,u=((e-n)*o+(t-s)*a)/(o*o+a*a);return{x:n+o*u,y:s+a*u}}function uf(e,t,n,s,r,i){const o=i||{x:0,y:0},a=(e+n)/2,u=(t+s)/2,d=e-n,c=t-s,g=Math.sqrt(d*d+c*c);if(g===0)return o.x=a,o.y=u,o;const f=c/g,p=-d/g,_=-g*r/ef;return o.x=a+f*_,o.y=u+p*_,o}function sx(e,t,n,s,r,i){const o=i||{x1:0,y1:0,x2:0,y2:0},a=(s+s/bg*n)*bg,u=-r+Ir,d=Ir/2-r;return o.x1=e+Math.cos(u)*a,o.y1=t+Math.sin(u)*a,o.x2=e+Math.cos(d)*a,o.y2=t+Math.sin(d)*a,o}function JF(e,t,n,s){const r=Math.abs(e.x-t.x-n.x+s.x)+Math.abs(e.y-t.y-n.y+s.y)<.01,i=9*(t.x-e.x)**2,o=(-243*e.x+189*t.x+51*n.x+3*s.x)**2/1e4,a=(-48*e.x+24*t.x+21*n.x+3*s.x)**2/625,u=(-147*e.x+21*t.x+99*n.x+27*s.x)**2/1e4,d=(-27*e.x-9*t.x+24*n.x+12*s.x)**2/625,c=9/16*(n.x+s.x-e.x-t.x)**2,g=9*(t.y-e.y)**2,f=(-243*e.y+189*t.y+51*n.y+3*s.y)**2/1e4,p=(-48*e.y+24*t.y+21*n.y+3*s.y)**2/625,_=(-147*e.y+21*t.y+99*n.y+27*s.y)**2/1e4,y=(-27*e.y-9*t.y+24*n.y+12*s.y)**2/625,x=9/16*(n.y+s.y-e.y-t.y)**2,E=Math.sqrt(i+g),b=Math.sqrt(o+f),S=Math.sqrt(a+p),A=Math.sqrt(u+_),C=Math.sqrt(d+y),k=Math.sqrt(c+x);if(r)return 5/2993760*(32134*E+212600*b-97050*S+544800*A-521100*C+427368*k);const M=(-12*e.x-24*t.x+9*n.x+27*s.x)**2/625,R=(-27*e.x-99*t.x-21*n.x+147*s.x)**2/1e4,O=(-3*e.x-21*t.x-24*n.x+48*s.x)**2/625,j=(-3*e.x-51*t.x-189*n.x+243*s.x)**2/1e4,z=9*(s.x-n.x)**2,X=(-12*e.y-24*t.y+9*n.y+27*s.y)**2/625,oe=(-27*e.y-99*t.y-21*n.y+147*s.y)**2/1e4,re=(-3*e.y-21*t.y-24*n.y+48*s.y)**2/625,Q=(-3*e.y-51*t.y-189*n.y+243*s.y)**2/1e4,he=9*(s.y-n.y)**2,fe=Math.sqrt(M+X),ae=Math.sqrt(R+oe),me=Math.sqrt(O+re),we=Math.sqrt(j+Q);return 5/2993760*(16067*(E+Math.sqrt(z+he))+106300*(b+we)-48525*(S+me)+272400*(A+ae)-260550*(C+fe)+427368*k)}var eD={left:{x:-1,y:0},right:{x:1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},center:{x:0,y:0}},tD=[{name:"topLeft",dx:-1,dy:-1,cornerIndex:2},{name:"topRight",dx:1,dy:-1,cornerIndex:3},{name:"bottomLeft",dx:-1,dy:1,cornerIndex:1},{name:"bottomRight",dx:1,dy:1,cornerIndex:0}],Pi={x:0,y:0};function nD(e,t,n,s,r,i,o,a,u,d,c,g){i=i||o.getNodes()._indexes;const f=u.getZoom(),p=o.getObjectList(!0),_=a.getFlexArrays().nodes.current;let y=1/0,x=0,E=-1/0;a.update();for(let b=0;b<i.length;++b){const S=i[b];if(_.excluded.get(S)||!_.detectable.get(S)||c.has(S))continue;const A=_.x.get(S),C=_.y.get(S),k=_.layer.get(S);if(k<E)continue;Pi.x=A,Pi.y=C;const M=u.graphToScreenCoordinates(Pi),R=M.x,O=M.y,j=_.shape.get(S),z=_.scalingMethod.get(S)==="scaled",X=_.radius.get(S)*(z?f:1),oe=X+r,re=(e-R)/oe,Q=(t-O)/oe;if(Pi.x=e,Pi.y=t,!(s&&jT(Pi,S,a,u,d)))if(d.checkShapeHit(j,re,Q)){const he=o.getAttribute(!0,"virtual").get(S)!==0;if(oe>y&&he)continue;y=oe}else{if(!n)continue;{const he=g(_.text.content.get(S)||null),fe=_.textHidden.get(S),ae=_.text.minVisibleSize.get(S);if(fe||!he||(z?2*X:1/0)<ae)continue;const me=Ky(he,_.text.maxLineLength.get(S)),we=_.innerStroke.width.get(S),Z=_.text.margin.get(S),_e=_.text.padding.get(S),ze=_.text.size.get(S),Re=_.text.scale.get(S),We=_.text.scaling.get(S),st=_.text.font.get(S),ft=_.text.style.get(S),ut=_.text.position.get(S),ce=d.measureText(me,st,ft,1),be=We?Re*X*2:ze,qe=ce.width*be/2+_e,Ue=ce.height*be/2+_e,Ie=eD[ut],Fe=we+Z+X,Oe=R+(Fe+qe)*Ie.x,Xe=O+(Fe+Ue)*Ie.y;if(e<=Oe-qe||e>=Oe+qe||t<=Xe-Ue||t>=Xe+Ue)continue}}x=S,E=k}return p.get(x)||null}function jT(e,t,n,s,r){const i=n.getFlexArrays().nodes.current,o=s.getZoom(),a=i.scalingMethod.get(t)==="scaled",u=i.radius.get(t)*(a?o:1),d=i.x.get(t),c=i.y.get(t),g=i.radius.get(t);for(let f=0;f<4;f++){const{name:p,cornerIndex:_}=tD[f],y=i.badges[p].stroke.width.get(t),x=i.badges[p].stroke.scalingMethod.get(t)==="scaled",E=i.badges[p].scale.get(t)*u+(x?o:1)*y,b=i.badges[p].minVisibleSize.get(t)/2,S=i.badges[p].positionScale.get(t);if(!i.badges[p].text.content.get(t)&&!i.badges[p].image.url.get(t)||E<b)continue;const A=s.graphToScreenCoordinates({x:d+g*S*s.getCornerCos(_),y:c+g*S*s.getCornerSin(_)}),{x:C,y:k}=A,M=(e.x-C)/E,R=(e.y-k)/E;if(r.checkShapeHit("circle",M,R))return p}}function sD(e,t,n,s,r,i,o,a,u,d,c){r=r||i.getEdges()._indexes;const g=i.getObjectList(!1),f=u.getFlexArrays(),p=f.edges.current,_=f.nodes.current,y=o.getZoom(),x=o.getAngle(),E=Math.cos(x),b=Math.sin(x),S=s/y;Pi.x=e,Pi.y=t;const A=o.screenToGraphCoordinates(Pi),C=A.x,k=A.y;let M=0;u.update();for(let R=0;R<r.length;++R){const O=r[R],j=p.source.get(O),z=p.target.get(O),X=p.excluded.get(O),oe=p.detectable.get(O),re=a.has(j),Q=a.has(z);if(X||!oe||re||Q)continue;const he=j===z,fe=p.curvature.get(O),ae=p.shape.body.get(O)==="triangle",me=p.scalingMethod.get(O)==="scaled",we=p.width.get(O)/(me?1:y),Z=_.x.get(j),_e=_.y.get(j),ze=_.x.get(z),Re=_.y.get(z);if(he){const We=_.scalingMethod.get(j)==="scaled",st=sx(Z,_e,fe,_.radius.get(j)/(We?1:y),0);if(!w_(C,k,Z,_e,Z,_e,st.x1,st.y1,st.x2,st.y2,we,S))continue}else if(d){const We=of(Z*E-_e*b,_e*E+Z*b,ze*E-Re*b,Re*E+ze*b,fe,d,c);if(!w_(C,k,Z,_e,ze,Re,We.x1*E+We.y1*b,We.y1*E-We.x1*b,We.x2*E+We.y2*b,We.y2*E-We.x2*b,we,S))continue}else if(fe!==0){const We=uf(Z,_e,ze,Re,fe);if(!zT(C,k,Z,_e,ze,Re,We.x,We.y,we,S,ae))continue}else if(!BT(C,k,Z,_e,ze,Re,we,S,ae))continue;M=O}return g.get(M)||null}function rD(e){const t=e.getNodeAttribute("radius"),n=e.getEdgeAttribute("width"),s=e.getNodes(),r=e.getEdges();let i=0,o=0;for(let a=0;a<s._indexes.length;a++){const u=s._indexes[a],d=t.get(u);d>i&&(i=d)}for(let a=0;a<r._indexes.length;a++){const u=r._indexes[a],d=n.get(u);d>o&&(o=d)}return Math.max(2*i,o)}function iD(e){return e===null?"none":e==="webgl"?"WebGL":e==="svg"?"SVG":e==="canvas"?"Canvas":e}function HT(e,t,n,s){const r=(e-t)/n,i=r*r,o=i*r,a=$y.getCoefficients(s),u=r<.5?0:4;return Mr(a[u]+a[u+1]*r+a[u+2]*i+a[u+3]*o,0,1)}function $u(e,t,n,s){if(e===t)return e;const[r,i,o,a]=Fs(e),[u,d,c,g]=Fs(t);return`rgba(${Math.round(255*un(r,u,n))},${Math.round(255*un(i,d,n))},${Math.round(255*un(o,c,n))},${un(a,g,s)})`}function oD(e,t){const[n,s,r,i]=Fs(e);return`rgba(${255*n},${255*s},${255*r},${i*t})`}var uE=1/rr,qT=class extends ji{constructor(e){super(e),this._cachePoints=[],this._nextCachePoint=0,this._tmp={x1:0,y1:0,x2:0,y2:0},this._ccp={x1:0,y1:0,x2:0,y2:0},this._pointCopies=Array(128),this._clipViewport=!0}_resetCachePoints(){this._nextCachePoint=0}_point(e,t){let n=this._cachePoints[this._nextCachePoint++];return n||(n={x:0,y:0},this._cachePoints.push(n)),n.x=e,n.y=t,n}setViewportClipping(e){this._clipViewport=e}_displayBuffer(e){const t=e.getSize(),n=e.animated;for(let s=0;s<t;++s){const r=this.extractElement(e,s);r.valid&&this._displayElement(r,n)}}_mixAttributes(e,t,n){const s=HT(this._currentTime,n.beginTime,n.duration,n.easing);return e.dashLength=un(t.dashLength,e.dashLength,s),e.gapLength=un(t.gapLength,e.gapLength,s),e.offsetAngle=un(t.offsetAngle,e.offsetAngle,s),e.opacity=un(t.opacity,e.opacity,s),e.globalMinVisibleSize=un(t.globalMinVisibleSize,e.globalMinVisibleSize,s),e.strokeMinVisibleSize=un(t.strokeMinVisibleSize,e.strokeMinVisibleSize,s),e.patternMinVisibleSize=un(t.patternMinVisibleSize,e.patternMinVisibleSize,s),e.symbolicSize=un(t.symbolicSize,e.symbolicSize,s),e.curvature=un(t.curvature,e.curvature,s),e.fillColor=$u(t.fillColor,e.fillColor,s,s),e.strokeColor=$u(t.strokeColor,e.strokeColor,s,s),e.patternColor=$u(t.patternColor,e.patternColor,s,s),e.x1=un(t.x1,e.x1,s),e.y1=un(t.y1,e.y1,s),e.x2=un(t.x2,e.x2,s),e.y2=un(t.y2,e.y2,s),e.rectWidthOrSourceRadiusScaled=un(t.rectWidthOrSourceRadiusScaled,e.rectWidthOrSourceRadiusScaled,s),e.rectWidthOrSourceRadiusFixed=un(t.rectWidthOrSourceRadiusFixed,e.rectWidthOrSourceRadiusFixed,s),e.rectHeightOrTargetRadiusScaled=un(t.rectHeightOrTargetRadiusScaled,e.rectHeightOrTargetRadiusScaled,s),e.rectHeightOrTargetRadiusFixed=un(t.rectHeightOrTargetRadiusFixed,e.rectHeightOrTargetRadiusFixed,s),e.thicknessOrFontSizeScaled=un(t.thicknessOrFontSizeScaled,e.thicknessOrFontSizeScaled,s),e.thicknessOrFontSizeFixed=un(t.thicknessOrFontSizeFixed,e.thicknessOrFontSizeFixed,s),e.strokeWidthScaled=un(t.strokeWidthScaled,e.strokeWidthScaled,s),e.strokeWidthFixed=un(t.strokeWidthFixed,e.strokeWidthFixed,s),e.offsetScaled=un(t.offsetScaled,e.offsetScaled,s),e.offsetFixed=un(t.offsetFixed,e.offsetFixed,s),e}_computeRenderInfo(e){const t=this._viewZoom,n=this._point(e.x1,e.y1),s=this._point(e.x2,e.y2);return{shape:this._shapeManager.getDefinitionFromName(e.shape),pieceId:e.pieceId,dashLength:e.dashLength,gapLength:e.gapLength,hasHead:e.hasHead,hasTail:e.hasTail,isBodyTriangle:e.isBodyTriangle,isSelfLoop:e.isSelfLoop,patternScale:e.patternScale,offsetAngle:ug(e.offsetAngle),isText:e.isText,adjustTextAngle:e.adjustTextAngle,isBadge:e.isBadge,bentEnable:e.bentEnable,bentVertical:e.bentVertical,opacity:e.opacity,globalMinVisibleSize:e.globalMinVisibleSize,strokeMinVisibleSize:e.strokeMinVisibleSize,patternMinVisibleSize:e.patternMinVisibleSize,symbolicSize:e.symbolicSize===0?1/0:e.symbolicSize*t,curvature:e.curvature,pattern:e.pattern,fillColor:e.fillColor,strokeColor:e.strokeColor,patternColor:e.patternColor,pos1OnGraph:n,pos2OnGraph:s,pos1:this._graphToScreenCoordinates(n),pos2:this._graphToScreenCoordinates(s),rectWidthOrSourceRadius:e.rectWidthOrSourceRadiusScaled*t+e.rectWidthOrSourceRadiusFixed,rectHeightOrTargetRadius:e.rectHeightOrTargetRadiusScaled*t+e.rectHeightOrTargetRadiusFixed,thicknessOrFontSize:e.thicknessOrFontSizeScaled*t+e.thicknessOrFontSizeFixed,strokeWidth:e.strokeWidthScaled*t+e.strokeWidthFixed,offset:e.offsetScaled*t+e.offsetFixed}}_applyBackgroundBlending(e){e.opacity!==1&&(e.fillColor=this._blendColor(e.fillColor,e.opacity),e.strokeColor=this._blendColor(e.strokeColor,e.opacity),e.textColor=this._blendColor(e.textColor,e.opacity))}_pointArray(e){let t=this._pointCopies[e];if(!t){t=new Array(e),this._pointCopies[e]=t;for(let n=0;n<e;++n)t[n]={x:0,y:0,r:0}}return t}_scalePoints(e,t,n,s){const r=e.shape.points.length,i=this._pointArray(r);for(let u=0;u<r;++u){const d=e.shape.points[u],c=i[u];c.x=t.x+d.x*n,c.y=t.y+d.y*s,c.r=d.r*n}const o=e.pos2OnGraph.x-e.pos1OnGraph.x,a=e.pos2OnGraph.y-e.pos1OnGraph.y;if(o!==0||a!==0){const u=Math.sqrt(o*o+a*a),d=o/u,c=a/u;for(const g of i){const f=g.x-t.x,p=g.y-t.y;g.x=t.x+d*f+c*p,g.y=t.y-c*f+d*p}}return i}_drawPoints(e,t=!1){e.length===1?this._drawCircle(e[0],e[0].r):this._drawPolygon(e,t)}_computeCenter(e){const t=Math.cos(e.offsetAngle),n=Math.sin(e.offsetAngle),s=(e.pos1.x+e.pos2.x)/2+t*e.offset,r=(e.pos1.y+e.pos2.y)/2+n*e.offset;return this._point(s,r)}_displayTextBox(e,t,n,s){const r=this._computeCenter(e),i=e.rectWidthOrSourceRadius/2,o=e.rectHeightOrTargetRadius/2;(t||s)&&this._drawRoundedRectangle(r,i,o,0,e.fillColor)}_displayNodeComponent(e,t,n,s){const r=this._computeCenter(e);if(e.pattern.type!==Ro){const i=e.rectWidthOrSourceRadius/2,o=e.rectHeightOrTargetRadius/2,a=this._scalePoints(e,r,i,o);if((t||s)&&this._drawPoints(a,!0),t&&this._fill(e.fillColor),s){if(this._startClip(),e.pattern.type===Ud){let u=e.pattern.attributes.colorArray;e.opacity!==1&&(u=u.map(d=>this._blendColor(d,e.opacity))),this._displayPieChart(r,i,u)}else if(e.pattern.type===ma||e.pattern.type===_a){const d=Math.round(e.rectHeightOrTargetRadius*e.patternScale),c=e.pattern.attributes.text,g=this._blendColor(e.patternColor,e.opacity),f=e.pattern.attributes.font,p=e.pattern.attributes.style,_=e.pattern.attributes.align,y=e.rectWidthOrSourceRadius,x=e.pattern.attributes.paddingTop,E=e.pattern.attributes.paddingLeft;this._displayText(r,0,c,g,f,d,p,_,y,E,x,!0)}else if(e.pattern.type===Io){const u=e.pattern.attributes.image;if(u.isDummy||u.width&&u.height){const d=e.pattern.attributes.duplicated,c=d?1:e.patternScale,g=e.rectWidthOrSourceRadius*c,f=e.rectHeightOrTargetRadius*c,p=e.pattern.attributes.scaled,_=e.opacity;this._displayImage(r,g,f,u,p,d,_)}}this._endClip()}if(n){const u=e.strokeWidth/2,d=this._scalePoints(e,r,i+u,o+u);this._drawPoints(d),this._stroke(e.strokeColor,e.strokeWidth)}}else if(s){const o=e.thicknessOrFontSize,a=e.pattern.attributes.text,u=this._blendColor(e.patternColor,e.opacity),d=e.pattern.attributes.font,c=e.pattern.attributes.style,g=e.pattern.attributes.align,f=e.rectWidthOrSourceRadius;this._displayText(r,0,a,u,d,o,c,g,f,0,0,!1)}}_displayElement(e,t){if(!e.end||!e.end.shape||!e.end.pieceId||t&&(!e.start||!e.animation))return;this._resetCachePoints();const n=t?this._mixAttributes(e.end,e.start,e.animation):e.end,s=this._computeRenderInfo(n);if(s.symbolicSize<s.globalMinVisibleSize||s.opacity===0)return;this._applyBackgroundBlending(s);const r=!!(s.strokeColor&&s.strokeWidth>0&&s.symbolicSize>=s.strokeMinVisibleSize),i=s.pattern.type!==Ds&&s.symbolicSize>=s.patternMinVisibleSize,o=!!s.fillColor;if(s.pieceId===Pr)return this._displayNodeComponent(s,o,r,i);if(s.pieceId===ha)return this._displayTextBox(s,o,r,i);const a=s.pos2.x-s.pos1.x,u=s.pos2.y-s.pos1.y,d=Math.sqrt(a*a+u*u);let c,g=null,f=null;if(s.bentEnable&&!s.isSelfLoop)this._tmp.x1=s.pos1.x,this._tmp.y1=s.pos1.y,this._tmp.x2=s.pos2.x,this._tmp.y2=s.pos2.y,s.pos1.x=this._tmp.x1*this._viewAngleCos-this._tmp.y1*this._viewAngleSin,s.pos1.y=this._tmp.y1*this._viewAngleCos+this._tmp.x1*this._viewAngleSin,s.pos2.x=this._tmp.x2*this._viewAngleCos-this._tmp.y2*this._viewAngleSin,s.pos2.y=this._tmp.y2*this._viewAngleCos+this._tmp.x2*this._viewAngleSin,of(s.pos1.x,s.pos1.y,s.pos2.x,s.pos2.y,s.curvature,s.bentEnable,s.bentVertical,this._ccp),s.pos1.x=this._tmp.x1,s.pos1.y=this._tmp.y1,s.pos2.x=this._tmp.x2,s.pos2.y=this._tmp.y2,this._tmp.x1=this._ccp.x1,this._tmp.y1=this._ccp.y1,this._tmp.x2=this._ccp.x2,this._tmp.y2=this._ccp.y2,this._ccp.x1=this._tmp.x1*this._viewAngleCos+this._tmp.y1*this._viewAngleSin,this._ccp.y1=this._tmp.y1*this._viewAngleCos-this._tmp.x1*this._viewAngleSin,this._ccp.x2=this._tmp.x2*this._viewAngleCos+this._tmp.y2*this._viewAngleSin,this._ccp.y2=this._tmp.y2*this._viewAngleCos-this._tmp.x2*this._viewAngleSin,g=this._point(this._ccp.x1,this._ccp.y1),f=this._point(this._ccp.x2,this._ccp.y2),c=JF(s.pos1,g,f,s.pos2);else if(s.isSelfLoop){const p=s.pieceId===ia||s.pieceId===ia+ha?s.strokeWidth/2:s.rectWidthOrSourceRadius,{x1:_,y1:y,x2:x,y2:E}=this._getSelfLoopControlPoints(s.pos1,s.curvature,p);g=this._point(_,y),f=this._point(x,E),c=lD(s.pos1,g,f,s.pos2,1)}else s.curvature?(g=this._getQuadraticCurveControlPoint(s),c=aD(s.curvature,d,1)):c=d;if(s.pieceId===ia||s.pieceId===ia+ha){const p=s.strokeWidth,_=this._getPointOnLine(s.pos1,g,f,s.pos2,.5),y=this._getTangentOnLine(s.pos1,g,f,s.pos2,.5);if(s.rectWidthOrSourceRadius>=c-p&&!s.isSelfLoop){if(!s.adjustTextAngle)return;y.x=1,y.y=0}let x=-Math.atan2(y.y,y.x);const E=ug(s.offsetAngle-x);(!s.isSelfLoop&&E<0||s.isSelfLoop&&s.offsetAngle<0)&&(y.x*=-1,y.y*=-1),(x>Math.PI/2||x<-Math.PI/2)&&(x+=Math.PI);const b=this._getOrthogonal(y),S=_.x+b.x*s.offset,A=_.y+b.y*s.offset;if(s.pieceId===ia+ha){if(!s.fillColor)return;const C=s.rectWidthOrSourceRadius/2,k=s.rectHeightOrTargetRadius/2;this._drawRoundedRectangle(this._point(S,A),C,k,E+Math.PI/2,s.fillColor)}else{const C=this._point(S,A),k=x,M=s.thicknessOrFontSize,R=s.pattern.attributes.text,O=this._blendColor(s.patternColor,s.opacity),j=s.pattern.attributes.font,z=s.pattern.attributes.style,X=s.pattern.attributes.align,oe=s.rectWidthOrSourceRadius;this._displayText(C,k,R,O,j,M,z,X,oe,0,0,!1)}}else{const p=s.pieceId===jy,_=s.pieceId===Hy,y=Math.cos(s.offsetAngle),x=Math.sin(s.offsetAngle);s.pos1.x+=y*s.offset,s.pos1.y+=x*s.offset,s.pos2.x+=y*s.offset,s.pos2.y+=x*s.offset;const E=s.shape.name==="line",b=s.thicknessOrFontSize,S=s.rectWidthOrSourceRadius,A=s.rectHeightOrTargetRadius,C=+s.hasHead,k=+s.hasTail,M=Math.max(ji.minEdgeTipSize,b*ji.edgeArrowSizeRatio),R=C*Math.min(5*S,M),O=k*Math.min(5*A,M),j=s.isSelfLoop?1/0:d-S-A,z=Math.min(0,j-R-O)/2,X=b/2;let oe=S>X?S-Math.sqrt(S*S-X*X):X;const re=Math.max(S+O+k*z,0)-(1-C)*oe;oe=S>X?A-Math.sqrt(A*A-X*X):X;const Q=Math.max(A+R+C*z,0)-(1-k)*oe;if(p||_){const he=_?-1:1,fe=(p?c-Q:re)-he;let ae=null,me=null;if((s.bentEnable||s.isSelfLoop)&&g&&f){const we=this._getTFromLengthOnCubicCurve(s.pos1,g,f,s.pos2,(p?Q:re)+1+s.strokeWidth/2,_);ae=this._getPointOnCubicCurve(s.pos1,g,f,s.pos2,we),me=this._getTangentOnCubicCurve(s.pos1,g,f,s.pos2,we)}else if(s.curvature&&g){const we=this._getTFromLengthOnQuadraticCurve(s.pos1,g,s.pos2,fe-s.strokeWidth/2*he);ae=this._getPointOnQuadraticCurve(s.pos1,g,s.pos2,we),me=this._getTangentOnQuadraticCurve(s.pos1,g,s.pos2,we)}else{const we=fe/c;ae=this._mixPoints(s.pos1,s.pos2,we),me=this._point(a/d,u/d)}if(me.x*=he,me.y*=he,o){if(s.shape.hole){const Z=this._makeEdgeExtremityPoints(ae,me,M,s.shape.hole);this._drawPoints(Z),this._startReverseClip()}const we=this._makeEdgeExtremityPoints(ae,me,M,s.shape.points);this._drawPoints(we),this._fill(s.fillColor),s.shape.hole&&this._endReverseClip()}if(r){if(s.shape.hole){const _e=this._makeEdgeExtremityPoints(ae,me,M,s.shape.hole);this._drawPoints(_e),this._stroke(s.strokeColor,s.strokeWidth)}const we=M+s.strokeWidth/2,Z=this._makeEdgeExtremityPoints(ae,me,we,s.shape.points);this._drawPoints(Z),this._stroke(s.strokeColor,s.strokeWidth)}}else{if(c-re-Q<=0)return;if(E){const he=uD(c,b,re,Q,s.dashLength,s.gapLength);r&&(this._drawLine(s.pos1,g,f,s.pos2),this._stroke(s.strokeColor,b+2*s.strokeWidth,he)),o&&(this._drawLine(s.pos1,g,f,s.pos2),this._stroke(s.fillColor,b,he))}else{const he=re,fe=c-Q;if(r){const ae=this._makeTriangleEdgeBody(s.pos1,g,f,s.pos2,he,fe,b+s.strokeWidth/2,s.strokeWidth/2,c);this._drawPoints(ae),this._stroke(s.strokeColor,s.strokeWidth)}if(o){const ae=this._makeTriangleEdgeBody(s.pos1,g,f,s.pos2,he,fe,b,0,c);this._drawPoints(ae),this._fill(s.fillColor)}}}}}_makeTriangleEdgeBody(e,t,n,s,r,i,o,a,u){return t?n?this._makeSelfLoopTriangleEdge(e,t,n,s,r,i,o,a,u):this._makeCurveTriangleEdge(e,t,s,r,i,o,a):this._makeStraightTriangleEdge(e,s,r,i,o,a)}_makeCurveTriangleEdge(e,t,n,s,r,i,o){const a=2*rr+2,u=this._pointArray(a),d=this._getTFromLengthOnQuadraticCurve(e,t,n,s),c=(this._getTFromLengthOnQuadraticCurve(e,t,n,r)-d)/rr,g=(o-i)/rr/2;let f=i/2,p=d;for(let _=0;_<=rr;++_){const y=this._getPointOnQuadraticCurve(e,t,n,p),x=this._getTangentOnQuadraticCurve(e,t,n,p),E=this._getOrthogonal(x),b=E.x*f,S=E.y*f,A=u[_],C=u[a-1-_];A.x=y.x+b,A.y=y.y+S,C.x=y.x-b,C.y=y.y-S,p+=c,f+=g}return u}_makeSelfLoopTriangleEdge(e,t,n,s,r,i,o,a,u){const d=2*rr+2,c=this._pointArray(d),g=this._getTFromLengthOnCubicCurve(e,t,n,s,r),f=(this._getTFromLengthOnCubicCurve(e,t,n,s,u-i,!1)-g)/rr,p=(a-o)/rr/2;let _=o/2,y=g;for(let x=0;x<=rr;++x){const E=this._getPointOnCubicCurve(e,t,n,s,y),b=this._getTangentOnCubicCurve(e,t,n,s,y),S=this._getOrthogonal(b),A=S.x*_,C=S.y*_,k=c[x],M=c[d-1-x];k.x=E.x+A,k.y=E.y+C,M.x=E.x-A,M.y=E.y-C,y+=f,_+=p}return c}_makeStraightTriangleEdge(e,t,n,s,r,i){const o=t.x-e.x,a=t.y-e.y,u=Math.sqrt(o*o+a*a),d=this._point(o/u,a/u),c=this._getOrthogonal(d),g=r/2,f=i/2,p=this._pointArray(4),_=p[0],y=p[1],x=p[2],E=p[3],b=e.x+d.x*n,S=e.y+d.y*n,A=e.x+d.x*s,C=e.y+d.y*s,k=c.x*g,M=c.y*g,R=c.x*f,O=c.y*f;return _.x=b+k,_.y=S+M,y.x=b-k,y.y=S-M,x.x=A-R,x.y=C-O,E.x=A+R,E.y=C+O,p}_makeEdgeExtremityPoints(e,t,n,s){const r=this._pointArray(s.length),i=n/2,o=e.x+t.x*i,a=e.y+t.y*i,u=t.x,d=t.y;for(let c=0;c<s.length;++c){const g=s[c],f=r[c],p=(u*g.x-d*g.y)*i,_=(d*g.x+u*g.y)*i;f.x=o+p,f.y=a+_,f.r=g.r*i}return r}_drawLine(e,t,n,s){t?n?this._drawCubicCurve(e,t,n,s):this._drawQuadraticCurve(e,t,s):this._drawStraightLine(e,s)}_getSelfLoopControlPoints(e,t,n){return sx(e.x,e.y,t,n,this._viewAngle,this._tmp)}_getQuadraticCurveControlPoint(e){return uf(e.pos1.x,e.pos1.y,e.pos2.x,e.pos2.y,e.curvature,this._point(0,0))}_graphToScreenCoordinates(e){const t=this._width/2,n=this._height/2,s=(e.x-this._viewX)*this._viewZoom,r=(e.y-this._viewY)*this._viewZoom,i=this._viewAngleCos,o=this._viewAngleSin,a=i*s+o*r+t,u=-o*s+i*r+n;return this._point(a,u)}_blendColor(e,t){return e&&this._backgroundColor?$u(this._backgroundColor,e,t,1):e?oD(e,t):null}_getTangentOnLine(e,t,n,s,r){return t?n?this._getTangentOnCubicCurve(e,t,n,s,r):this._getTangentOnQuadraticCurve(e,t,s,r):this._getTangentOnStraightLine(e,s)}_getTangentOnStraightLine(e,t){const n=t.x-e.x,s=t.y-e.y,r=Math.sqrt(n*n+s*s);return this._point(n/r,s/r)}_getTangentOnQuadraticCurve(e,t,n,s){const r=1-s,i=r*t.x+s*n.x-(r*e.x+s*t.x),o=r*t.y+s*n.y-(r*e.y+s*t.y),a=Math.sqrt(i*i+o*o);return this._point(i/a,o/a)}_getTangentOnCubicCurve(e,t,n,s,r){const i=1-r,o=i*i,a=r*r,u=o*(t.x-e.x)+2*i*r*(n.x-t.x)+a*(s.x-n.x),d=o*(t.y-e.y)+2*i*r*(n.y-t.y)+a*(s.y-n.y),c=Math.sqrt(u*u+d*d);return this._point(u/c,d/c)}_mixPoints(e,t,n){const s=un(e.x,t.x,n),r=un(e.y,t.y,n);return this._point(s,r)}_getOrthogonal(e){return this._point(-e.y,e.x)}_getPointOnLine(e,t,n,s,r){return t?n?this._getPointOnCubicCurve(e,t,n,s,r):this._getPointOnQuadraticCurve(e,t,s,r):this._mixPoints(e,s,r)}_getPointOnQuadraticCurve(e,t,n,s){const r=vl(e.x,t.x,n.x,s),i=vl(e.y,t.y,n.y,s);return this._point(r,i)}_getPointOnCubicCurve(e,t,n,s,r){const i=aE(e.x,t.x,n.x,s.x,r),o=aE(e.y,t.y,n.y,s.y,r);return this._point(i,o)}_getTFromLengthOnCubicCurve(e,t,n,s,r,i=!0){if(!i)return 1-this._getTFromLengthOnCubicCurve(s,n,t,e,r,!0);let o=0,a=1,u=0;for(let d=0;d<10;d++){const c=(o+a)/2,g=c,f=this._getPointOnCubicCurve(e,t,n,s,g),p=Math.hypot(e.x-f.x,e.y-f.y);if(Math.abs(p-r)<.01)return c;p<r?(o=c,u=c):a=c}return u}_getTFromLengthOnQuadraticCurve(e,t,n,s){let r=e.x,i=e.y,o=0,a=0;for(let u=0;u<rr;++u){o+=uE;const d=vl(e.x,t.x,n.x,o),c=vl(e.y,t.y,n.y,o),g=d-r,f=c-i,p=Math.sqrt(g*g+f*f),_=a+p;if(_>s)return o-uE*((_-s)/p);a=_,r=d,i=c}return 1}};function aD(e,t,n){const s=Math.abs(e)/ef+ST,r=s*s,i=n-.5,o=i*i,a=1/(16*r),u=Math.sqrt(o+a),d=.5/s*Math.sqrt(r+.25);return Math.abs(2*s)*(i*u+.5*d+a*Math.log(Math.abs((i+u)/(-.5+d))))*t}function lD(e,t,n,s,r){const i=(e.x+t.x+n.x)/3,o=(e.y+t.y+n.y)/3,a=i-t.x,u=o-t.y,d=t.x-n.x,c=t.y-n.y,g=a*a+u*u,f=(d*d+c*c)/4,p=Math.sqrt(g-f);return 2*cT*p*3.14159265359*r}function uD(e,t,n,s,r,i){const o=[];if(n&&o.push(0,n),r&&i){const a=r*t,u=i*t,d=a+u,c=e-s-n-d;let g=0;for(;g<c;)o.push(a,u),g+=d;const f=e-s-n-g,p=Math.min(a,f),_=Math.max(f-p,0);o.push(p,_)}else o.push(e-s-n,0);return s&&o.push(0,s),o}var El=0,id=1,od=2,oa=3,dE=4,rx=0,T_=1,dD={[El]:{min:"NEAREST",mag:"NEAREST",mipmap:!1},[id]:{min:"LINEAR",mag:"LINEAR",mipmap:!1},[od]:{min:"LINEAR",mag:"LINEAR",mipmap:!1},[oa]:{min:"LINEAR_MIPMAP_LINEAR",mag:"LINEAR",mipmap:!0}},hD={[rx]:"ALPHA",[T_]:"RGBA"};function zl(e){return Math.ceil((e+2*Po)/Ps)*Ps}function cD(e,t,n,s,r){for(let i=0,o=e.length;i<o;++i){const a=e[i],u=a.x,d=a.y,c=u+s,g=d+r;let f=c<n&&g<n;if(f){for(let p=u;p<c;++p)if(t[p+d*n]===1){f=!1;break}}if(f){for(let p=d;p<g;++p)if(t[u+p*n]===1){f=!1;break}}if(f){for(let p=u;p<c;++p)for(let _=d;_<g;++_)t[p+_*n]=1;return e.splice(i,1),e.push({x:u,y:g},{x:c,y:d}),a}}return null}function hE(e,t,n,s,r,i,o){const a=4*e,u=t>>1<<7,d=t%2<<7;o[a]=n/Ps,o[a+1]=s/Ps,o[a+2]=u+r/Ps,o[a+3]=d+i/Ps}function gD(e,t,n,s,r,i,o){s|=0,r|=0,i|=0,o|=0,t|=0;for(let a=0;a<i;++a)for(let u=0;u<o;++u){const d=4*(s+a+(r+u)*t),c=4*(a+u*i);e[d]=n[c],e[d+1]=n[c+1],e[d+2]=n[c+2],e[d+3]=n[c+3]}}function fD(e,t){let n=0,s=4;for(let i=0;i<e.length;++i){const{width:o,height:a}=e[i],u=zl(o),d=zl(a);n+=u*d,s=Math.max(s,Math.max(u,d))}const r=Co(Math.max(s,Math.sqrt(n)));return Math.min(r,t)}function cE(e,t){return Math.floor((t-e)/2)}function gE(e,t,n,s,r,i,o){const{min:a,mag:u,mipmap:d}=dD[i],c=e[hD[o]];if(o===rx){const g=new Uint8Array(r*r);for(let f=0;f<g.length;++f)g[f]=s[4*f+3];s=g}e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,c,r,r,0,c,e.UNSIGNED_BYTE,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[u]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[a]),d&&e.generateMipmap(e.TEXTURE_2D)}function $T(e,t,n,s,r){const i=new Uint8Array(n*n*4),o=Math.ceil(n/Ps),a=new Uint8Array(o*o),u=[{x:0,y:0}];for(let d=0;d<t.length;++d){const c=t[d],g=c.id,f=zl(c.width)/Ps,p=zl(c.height)/Ps,_=cD(u,a,o,f,p);if(_){const y=c.width,x=c.height,E=c.pixels,b=f*Ps,S=p*Ps,A=_.x*Ps+cE(y,b),C=_.y*Ps+cE(x,S);gD(i,n,E,A,C,y,x),hE(g,e,A,C,b,S,r)}else{if(n<s)return $T(e,t,2*n,s,r);Gi(`exceeded max WebGL texture size of ${s}; some texts/icons/images won't be displayed`),hE(g,e,0,0,0,0,r)}}return{texture:i,size:n}}function pD(e,t,n,s){const{getDistanceFromStrokeVertically:r,getDistanceFromStrokeHorizontally:i}=e,o=t*(1-n)/2,a=(t-1)/2;for(let u=0;u<t;++u)for(let d=0;d<t;++d){const c=4*(d*t+u),g=(u-a)/o,f=(d-a)/o,p=Mr(r(g,f),-1,1),_=Mr(i(g,f),-1,1);mD(s,c,fE(p),fE(_))}}function fE(e){const t=(e+1)/2;return Math.floor(32768*t)}function mD(e,t,n,s){e[t]=n>>8,e[t+1]=n%256,e[t+2]=s>>8,e[t+3]=s%256}function WT(e,t){let n=-Math.PI/2;const s=2*Math.PI/e.length;for(const r of e){const i=n+s;t(r,n,i),n=i}}function XT(e,t,n,s,r){WT(t,(i,o,a)=>{e.beginPath(),e.moveTo(n,s),e.arc(n,s,r,o,a),e.fillStyle=i,e.fill()})}var _D=!Es().__dummy,yD=class extends qT{constructor(e){super(e),this._canvas=Es(),this._imgCanvas=Es(),this._initCanvas(this._canvas),this._ctx=this._canvas.getContext("2d"),this._imgCtx=this._imgCanvas.getContext("2d")}static getName(){return"Canvas"}static isAvailable(){return _D}getDomElement(){return this._canvas}_render({dimensionsChanged:e}){e&&xT(this._canvas,this._width,this._height,this._pixelRatio);const t=this._ctx,n=this._width*this._pixelRatio,s=this._height*this._pixelRatio;t.clearRect(0,0,n,s),this._backgroundColor&&this._renderBackground&&(t.fillStyle=this._backgroundColor,t.fillRect(0,0,n,s));const r=this._bufferList.getBuffersByAscendingDepth();for(const i of r)this._isBufferDisplayable(i)&&this._displayBuffer(i)}_drawRoundedRectangle(e,t,n,s,r){const i=this._ctx,o=this._pixelRatio,a=e.x*o,u=e.y*o;t*=o,n*=o;const d=this._textManager.getCornerRadius(),c=Math.min(d*o,n);t+=c/2,i.save(),i.translate(a,u),i.rotate(s),i.beginPath(),i.arc(t-c,n-c,c,0,Math.PI/2),i.arc(-t+c,n-c,c,Math.PI/2,Math.PI),i.arc(-t+c,-n+c,c,Math.PI,3*Math.PI/2),i.arc(t-c,-n+c,c,3*Math.PI/2,0),r&&(i.fillStyle=r,i.fill()),i.restore()}_drawCircle(e,t){const n=this._ctx,s=this._pixelRatio,r=e.x*s,i=e.y*s,o=t*s;n.beginPath(),n.arc(r,i,o,0,2*Math.PI)}_drawPolygon(e){const t=this._ctx,n=this._pixelRatio;t.beginPath();const s=e[0];t.moveTo(s.x*n,s.y*n);for(let r=1;r<e.length;++r){const i=e[r];t.lineTo(i.x*n,i.y*n)}t.closePath()}_drawStraightLine(e,t){const n=this._ctx,s=this._pixelRatio;n.beginPath(),n.moveTo(e.x*s,e.y*s),n.lineTo(t.x*s,t.y*s)}_drawQuadraticCurve(e,t,n){const s=this._ctx,r=this._pixelRatio;s.beginPath(),s.moveTo(e.x*r,e.y*r),s.quadraticCurveTo(t.x*r,t.y*r,n.x*r,n.y*r)}_drawCubicCurve(e,t,n,s){const r=this._ctx,i=this._pixelRatio;r.beginPath(),r.moveTo(e.x*i,e.y*i),r.bezierCurveTo(t.x*i,t.y*i,n.x*i,n.y*i,s.x*i,s.y*i)}_fill(e){const t=this._ctx;t.fillStyle=e,t.fill()}_stroke(e,t,n=[]){if(t===0)return;const s=this._ctx,r=this._pixelRatio;s.setLineDash(n.map(i=>i*this._pixelRatio)),s.lineWidth=t*r,s.strokeStyle=e,s.stroke()}_startClip(){this._ctx.save(),this._ctx.clip()}_endClip(){this._ctx.restore()}_startReverseClip(){this._ctx.save(),this._ctx.rect(0,0,this._canvas.width,this._canvas.height),this._ctx.clip("evenodd")}_endReverseClip(){this._ctx.restore()}_displayText(e,t,n,s,r,i,o,a,u,d,c){const g=this._ctx,f=this._pixelRatio,p=e.x*f,_=e.y*f,y=i*f,x=a==="center"?0:-u/2;if(c=c*this._viewZoom*f,d=d*this._viewZoom*f,g.save(),g.translate(p,_+f),g.rotate(-t),g.textBaseline="middle",g.textAlign=a,Fo(g,r,y,o),g.fillStyle=s,n.indexOf(`
`)!==-1){const E=n.split(`
`),b=E.length;let S=(1-b)/2*y;for(let A=0;A<b;++A)g.fillText(E[A],d+x,c+S),S+=y}else g.fillText(n,d+x,c);g.restore()}_displayImage(e,t,n,s,r,i,o){if(this._hideImages||"isDummy"in s)return;let a=s;o!==1&&(a=this._blendImageOnBackground(s,o));const u=this._ctx,d=this._pixelRatio,c=e.x*d,g=e.y*d,f=t*d,p=n*d,_=a.width*d,y=a.height*d;if(r)u.drawImage(a,c-f/2,g-p/2,f,p);else if(i){const x=c-f/2,E=g-p/2,b=c+f/2,S=g+p/2;let A=c-_/2,C=g-y/2;for(;A>x;)A-=_;for(;C>E;)C-=y;const k=C;for(;A<b;){for(;C<S;)u.drawImage(a,A,C,_,y),C+=y;A+=_,C=k}}else u.drawImage(a,c-_/2,g-y/2,_,y)}_displayPieChart(e,t,n){const s=this._ctx,r=this._pixelRatio,i=e.x*r,o=e.y*r,a=t*r*2,u=2*a;n.length===1&&(s.fillStyle=n[0],s.fillRect(i-a,o-a,u,u)),n.length>1&&XT(s,n,i,o,a)}_blendImageOnBackground(e,t){const n=this._backgroundRgba,s=`rgb(${Math.round(255*n[0])},${Math.round(255*n[1])},${Math.round(255*n[2])})`;return this._imgCanvas.width=e.width,this._imgCanvas.height=e.height,this._imgCtx.clearRect(0,0,e.width,e.height),this._imgCtx.globalAlpha=1,this._imgCtx.fillStyle=s,this._imgCtx.fillRect(0,0,e.width,e.height),this._imgCtx.globalAlpha=t,this._imgCtx.drawImage(e,0,0),this._imgCanvas}getImageData(){return this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)}},YT=!1;try{YT=!!rn("svg")}catch{}var ku="none",xD={left:"start",center:"middle",right:"end"},Lr="data-element-id",pE="data-text-component",vD="node-text",bD="edge-text",ED="badge-text";function ca(e){return Math.round(1e3*e)/1e3}function mE(e,t,n,s,r,i){const o=rn("image");return o.setAttribute("width",ca(s)),o.setAttribute("height",ca(r)),o.setAttribute("x",ca(t)),o.setAttribute("y",ca(n)),o.setAttribute("href",e),i&&i.appendChild(o),o}function SD(e,t,n,s,r,i=1,o){const a=rn("rect");return a.setAttribute("x",e),a.setAttribute("y",t),a.setAttribute("width",n),a.setAttribute("height",s),a.setAttribute("fill",r),a.setAttribute("fill-opacity",i),o&&o.appendChild(a),a}var AD=class extends qT{constructor(e){super(e),this._svg=rn("svg"),this._defs=rn("defs"),this._styles=rn("g",{class:"styles"}),this._background=rn("rect",{width:"100%",height:"100%",fill:"none",class:"ogma-svg-background"}),this._currentElementId="0",this._currentClipPathId=null,this._clipPathCounter=0,this._defs.appendChild(this._styles),this._svg.setAttribute("pointer-events","none"),this._svg.style.userSelect="none",this._svg.appendChild(this._defs),this._svg.appendChild(this._background),this._clear()}static getName(){return"SVG"}static isAvailable(){return YT}getDomElement(){return this._svg}_render({dimensionsChanged:e}){if(e&&by(this._svg,{width:this._width,height:this._height}),this._backgroundColor&&this._renderBackground){const n=cl(this._backgroundColor);this._background.setAttribute("fill",n.color),this._background.setAttribute("fill-opacity",n.opacity)}const t=this._bufferList.getBuffersByAscendingDepth();this._clear(),this._svg.removeChild(this._container);for(let n=0;n<t.length;++n){const s=t[n];this._isBufferDisplayable(s)&&this._displayBuffer(s)}this._svg.appendChild(this._container)}_clear(){this._container&&this._svg.removeChild(this._container),this._container=rn("g"),this._svg.appendChild(this._container),this._clipPaths&&this._defs.removeChild(this._clipPaths),this._clipPaths=rn("g"),this._defs.appendChild(this._clipPaths),this._clipPaths.setAttribute("class","clip-paths"),this._filters&&this._defs.removeChild(this._filters),this._filters=rn("g"),this._defs.appendChild(this._filters)}_displayElement(e,t){this._currentElementId=e.id>=0?`n${e.id}`:"e"+-e.id,super._displayElement(e,t)}_addBackgroundBlendingFilter(e){const t=Fs(this._backgroundColor),n=e,s=1-e,r=[n,0,0,0,t[0]*s,0,n,0,0,t[1]*s,0,0,n,0,t[2]*s,0,0,0,1,0].join(" "),i=`filter-${this._currentElementId}`,o=rn("filter",{id:i}),a=rn("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:r});return o.appendChild(a),this._filters.appendChild(o),i}_drawRoundedRectangle(e,t,n,s,r){const i=e.x,o=e.y,a=Math.min(this._textManager.getCornerRadius(),n);t+=a/2;const u=rn("path"),d=`M ${i+t-a} ${o+n}     A ${a} ${a} 0 0 0 ${i+t} ${o+n-a}     L ${i+t} ${o-n+a}     A ${a} ${a} 0 0 0 ${i+t-a} ${o-n}     L ${i-t+a} ${o-n}     A ${a} ${a} 0 0 0 ${i-t} ${o-n+a}     L ${i-t} ${o+n-a}     A ${a} ${a} 0 0 0 ${i-t+a} ${o+n}     L ${i+t-a} ${o+n}`;u.setAttribute("d",d),u.setAttribute("fill",ku),u.setAttribute("transform",`rotate(${c_(s)} ${e.x} ${e.y})`),u.setAttribute(Lr,this._currentElementId),this._container.appendChild(u),this._element=u,r&&this._fill(r)}_drawCircle(e,t){const{x:n,y:s}=e,r=`M ${n-t}, ${s} a ${t},${t} 0 1,0 ${2*t},0 a ${t},${t} 0 1,0 -${2*t},0`,i=rn("path");i.setAttribute("d",r),i.setAttribute("fill",ku),i.setAttribute(Lr,this._currentElementId),this._container.appendChild(i),this._element=i}_drawPolygon(e,t){const n=rn("path");let s="";for(let r=0;r<e.length;r++){const{x:i,y:o}=e[r];s+=`${r===0?"M":"L"}${i},${o} `}s+="Z",n.setAttribute("d",s),n.setAttribute(Lr,this._currentElementId),n.setAttribute("fill",ku),t&&n.setAttribute(pE,!0),this._container.appendChild(n),this._element=n}_drawStraightLine(e,t){const n=rn("path"),s=`M ${e.x},${e.y} L${t.x},${t.y}`;n.setAttribute("d",s),n.setAttribute(Lr,this._currentElementId),this._container.appendChild(n),this._element=n}_drawQuadraticCurve(e,t,n){const s=rn("path"),r=`M ${e.x},${e.y} Q${t.x},${t.y} ${n.x},${n.y}`;s.setAttribute("d",r),s.setAttribute("fill",ku),s.setAttribute(Lr,this._currentElementId),this._container.appendChild(s),this._element=s}_drawCubicCurve(e,t,n,s){const r=rn("path"),i=`M ${e.x},${e.y} C${t.x},${t.y} ${n.x},${n.y} ${s.x},${s.y}`;r.setAttribute("d",i),r.setAttribute("fill",ku),r.setAttribute(Lr,this._currentElementId),this._container.appendChild(r),this._element=r}_fill(e){const t=cl(e);this._element.setAttribute("fill",t.color),this._element.setAttribute("fill-opacity",t.opacity),this._currentClipPathId&&this._element.setAttribute("clip-path",`url(#${this._currentClipPathId})`)}_stroke(e,t,n=[]){if(t===0)return;const s=this._element;s.setAttribute("stroke-width",t);const r=cl(e);s.setAttribute("stroke",r.color),s.setAttribute("stroke-opacity",r.opacity),n.length>0&&s.setAttribute("stroke-dasharray",n.map(ca).toString())}_startClip(){const e=rn("clipPath"),t=this._element.cloneNode(!1);this._currentClipPathId="clip-path-"+ ++this._clipPathCounter,e.appendChild(t),this._clipPaths.appendChild(e),e.setAttribute("id",this._currentClipPathId)}_endClip(){this._currentClipPathId=null}_startReverseClip(){const e=rn("clipPath"),t=this._element.cloneNode(!1),n=t.getAttribute("d");t.setAttribute("clip-rule","evenodd"),t.setAttribute("d",`${n} M 0 0 L ${this._width} 0 L ${this._width} ${this._height} L 0 ${this._height}`),this._currentClipPathId="clip-path-"+ ++this._clipPathCounter,e.appendChild(t),this._clipPaths.appendChild(e),e.setAttribute("id",this._currentClipPathId)}_endReverseClip(){this._currentClipPathId=null}_displayText(e,t,n,s,r,i,o="normal",a,u,d,c,g){const f=rn("g");f.setAttribute(Lr,this._currentElementId),f.setAttribute(pE,!0);let p=this._currentElementId[0]==="n"?vD:bD;g&&(p+=" "+ED),f.setAttribute("class",p);const _=cl(s),y=_.opacity,x=cl(_.color),E=e.x+d*this._viewZoom,b=e.y+1+c*this._viewZoom,S=ca(E);f.setAttribute("font-family",r),f.setAttribute("font-size",i),o==="bold"?f.setAttribute("font-weight",o):f.setAttribute("font-style",o),f.setAttribute("fill",x.color),f.setAttribute("fill-opacity",y),t&&f.setAttribute("transform",`rotate(${c_(-t)} ${E}, ${b})`),f.setAttribute("text-anchor",xD[a]||"middle"),f.setAttribute("dominant-baseline","middle");const A=n.split(`
`),C=A.length,k=ca(b-(C+1)/2*i),M=a==="center"?0:-u/2;for(let R=0;R<C;R++){const O=rn("text");O.appendChild(Sy(A[R])),O.setAttribute("x",S+M),O.setAttribute("y",k+(R+1)*i),f.appendChild(O)}this._currentClipPathId&&f.setAttribute("clip-path",`url(#${this._currentClipPathId})`),this._container.appendChild(f)}_displayImage(e,t,n,s,r,i,o){const a=e.x,u=e.y;if(this._hideImages||!("isDummy"in s)&&(!s.width||!s.height))return;const d=t,c=n;let g,f=s.width,p=s.height;if(r&&(f=d,p=c),i){const _=a-d/2,y=u-c/2,x=a+d/2,E=u+c/2;let b=a-f/2,S=u-p/2;for(g=rn("g"),g.setAttribute(Lr,this._currentElementId);b>_;)b-=f;for(;S>y;)S-=p;const A=S;for(;b<x;){for(;S<E;)mE(s.src,b,S,f,p,g),S+=p;S=A,b+=f}}else g=mE(s.src,a-f/2,u-p/2,f,p),g.setAttribute(Lr,this._currentElementId);if(this._currentClipPathId&&g.setAttribute("clip-path",`url(#${this._currentClipPathId})`),o!==1){const _=this._addBackgroundBlendingFilter(o);g.setAttribute("filter",`url(#${_})`)}this._container.appendChild(g)}_displayPieChart(e,t,n){const s=2*t,r=2*s,i=e.x,o=e.y;let a;const u=rn("g");u.setAttribute(Lr,this._currentElementId),n.length===1&&(a=SD(i-s,o-s,r,r,n[0],1,u)),n.length>1&&WT(n,(d,c,g)=>{const f=i+t*Math.cos(g),p=o+t*Math.sin(g),_=i+t*Math.cos(c),y=o+t*Math.sin(c),x=g-c<=Math.PI?0:1,E=`M ${f},${p} A ${t},${t} 0 ${x} 0 ${_},${y} L ${i},${o} L ${f},${p}`;a=rn("path"),a.setAttribute("d",E),a.setAttribute("fill",d),a.setAttribute("stroke-width",0),u.appendChild(a)}),this._currentClipPathId&&u.setAttribute("clip-path",`url(#${this._currentClipPathId})`),this._container.appendChild(u)}},wD=6,TD=class{constructor({gl:e,ext:t,staticProgram:n,animationProgram:s}){this._version=0,this._used=!1,this._dataBufferChanged=!1,this._gl=e,this._ext=t,this._staticProgram=n,this._animationProgram=s,this._glBuffer=this._gl.createBuffer()}setDataBuffer(e){this._dataBuffer!==e&&(this._program=e.animated?this._animationProgram:this._staticProgram,this._dataBuffer=e,this._dataBufferChanged=!0,e.hasSideData()&&!this._sideGlBuffer?this._sideGlBuffer=this._gl.createBuffer():!e.hasSideData()&&this._sideGlBuffer&&(this._gl.deleteBuffer(this._sideGlBuffer),delete this._sideGlBuffer))}setPrograms(e,t){this._staticProgram=e,this._animationProgram=t}markAsUnused(){return this._used=!1,this}getProgram(){return this._program}markAsUsed(){return this._used=!0,this}isUsed(){return this._used}draw(){const e=this._gl,t=this._dataBuffer.type,n=t===pa,s=n?this._dataBuffer.getNbSideElementsPerMainElement():1,r=t===Eg?rr:1,i=this._dataBuffer.getSize(),o=this._dataBuffer.stencilUsage,a=this._dataBuffer.version,u=this._version!==a||this._dataBufferChanged;this._program.setupBaseAttributes({glBuffer:this._glBuffer,dataBuffer:u?this._dataBuffer.getByteArray():null,divisor:s}),this._program.setupTextAttributes({glBuffer:this._sideGlBuffer,dataBuffer:u&&n?this._dataBuffer.getSideByteArray():null,divisor:1}),this._program.setupStencil(o),u&&(this._version=a,this._dataBufferChanged=!1),this._ext.drawArraysInstancedANGLE(e.TRIANGLES,0,wD*r,i*s)}destroy(){this._gl.deleteBuffer(this._glBuffer),this._sideGlBuffer&&this._gl.deleteBuffer(this._sideGlBuffer)}},CD={byte:1,ubyte:1,short:2,ushort:2,ulong:4,float:4},LD={byte:"BYTE",ubyte:"UNSIGNED_BYTE",short:"SHORT",ushort:"UNSIGNED_SHORT",ulong:"UNSIGNED_LONG",float:"FLOAT"},_E=class{constructor({gl:e,ext:t,specialGlBuffers:n,metaData:s,programWrapper:r}){this._stencilUsage=wl,this._gl=e,this._ext=t,this._specialGlBuffers=n,this._metaData=Bn(s),this._programWrapper=r}_finishInit(){const e=this._gl,t=this._ext,n=this._programWrapper.getError();if(n)throw new Error(`WebGL compilation at step "${n.step}:
${n.message}"`);const s=this._programWrapper.getProgram();this._program=s,e.useProgram(s),this._metaData.attributes.forEach(o=>{o.location=e.getAttribLocation(this._program,o.name),o.byteSize=o.size*CD[o.type],o.glType=LD[o.type]}),this._specialAttributes=this._createSpecialAttributesFunctions();const r=[],i=[];for(const o of this._metaData.attributes)o.location!==-1&&(o.name.startsWith("a_text")?i.push(o):r.push(o));this._baseAttributes=om(r,e,t),this._textAttributes=om(i,e,t),this._setupUniforms=ID(this._metaData.uniforms,e,s)}_createSpecialAttributesFunctions(){return om([{location:this._gl.getAttribLocation(this._program,this._metaData.vertexInfoAttribute),size:3,glType:"BYTE",byteSize:3,type:"byte",name:"special"}],this._gl,this._ext)}startPass(e){this._program||this._finishInit(),this._gl.useProgram(this._program),this._resetStencil(),this._setupUniforms(this._gl,e),this._specialAttributes.enable(this._gl),this._specialAttributes.setup(this._specialGlBuffers.vertexInfo,null,0)}_setupAttributes(e,{glBuffer:t,dataBuffer:n,divisor:s}){e.enabled&&!t?e.disable(this._gl):!e.enabled&&t&&e.enable(this._gl),t&&e.setup(t,n,s)}setupBaseAttributes(e){this._setupAttributes(this._baseAttributes,e)}setupTextAttributes(e){this._setupAttributes(this._textAttributes,e)}_resetStencil(){const e=this._gl;this._stencilUsage=wl,e.disable(e.STENCIL_TEST)}setupStencil(e){if(e!==this._stencilUsage){const t=this._gl;e!==wl?(t.enable(t.STENCIL_TEST),e===_T?(t.stencilOp(t.KEEP,t.KEEP,t.REPLACE),t.stencilFunc(t.ALWAYS,1,1)):e===yT&&(t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.stencilFunc(t.EQUAL,0,1))):t.disable(t.STENCIL_TEST),this._stencilUsage=e}}endPass(){const e=this._gl;this._specialAttributes.disable(e),this._baseAttributes.disable(e),this._textAttributes.disable(e)}};function ND(e,t,n){return(s,r,i)=>{let o=0,a=0;for(let u=0;u<e.length;u++)a+=e[u].byteSize;t.bindBuffer(t.ARRAY_BUFFER,s),r&&t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW);for(let u=0;u<e.length;u++){const{location:d,size:c,glType:g,byteSize:f}=e[u];t.vertexAttribPointer(d,c,t[g],!1,a,o),o+=f,n.vertexAttribDivisorANGLE(d,i)}}}function ID(e,t,n){const s={};for(let r=0;r<e.length;++r){const{id:i,name:o}=e[r],a=t.getUniformLocation(n,o);a&&(s[i]=a)}return(r,i)=>{for(let o=0;o<e.length;++o){const{id:a,type:u}=e[o],d=s[a],c=i[a];if(d)switch(u){case"int":case"sampler2D":r.uniform1i(d,c);break;case"float":r.uniform1f(d,c);break;case"vec2":r.uniform2f(d,c[0],c[1]);break;case"vec3":r.uniform3f(d,c[0],c[1],c[2]);break;case"vec4":r.uniform4f(d,c[0],c[1],c[2],c[3])}}}}function kD(e){return t=>{for(let n=0;n<e.length;n++){const s=e[n].location;t.enableVertexAttribArray(s)}}}function MD(e){return t=>{for(let n=0;n<e.length;++n){const s=e[n].location;t.disableVertexAttribArray(s)}}}function om(e,t,n){const s=kD(e),r=MD(e);return{enable(i){s(i),this.enabled=!0},disable(i){r(i),this.enabled=!1},setup:ND(e,t,n),enabled:!1}}var am=`#define D3D9_FIX 0
precision highp float;
precision mediump int;
uniform vec3 u_backgroundColor;
uniform sampler2D u_patternNearestTexture;
uniform sampler2D u_patternLinearTexture;
uniform sampler2D u_patternLinearSdfTexture;
uniform sampler2D u_patternMipmapTexture;
uniform sampler2D u_shapeTexture;
varying vec4 a;
varying vec4 b;
varying vec4 c;
varying vec2 d;
varying vec2 e;
varying vec4 f;
varying float g;
#if D3D9_FIX
#else
varying float l;
varying vec2 m;
varying vec2 n;
varying vec2 o;
varying float p;
varying float q;
varying vec2 r;
varying vec2 s;
varying float t;
varying float u;
#endif
const float FILTER_NEAREST = 0.0;
const float FILTER_LINEAR = 0.0;
const float FILTER_LINEAR_SDF = 0.0;
const float FILTER_MIPMAP = 0.0;
const float SDF_GAMMA = 0.0;
const float EPSILON = 0.000000001;
const float SDF_BUFFER = (256.0 - 64.0) / 256.0; 
vec4 af(in vec4 ag, in vec4 ah) {
float ai = ah.a;
float aj = ag.a + EPSILON;
float ak = min(ai + aj, 1.0);
float r = ai / ak;
return vec4(mix(ag.rgb, ah.rgb, r), ak);
}
float al(in float am, in float an) {
float ao = (am * 256.0 + an) * 256.0;
float ap = ao / 32768.0;
return ap * 2.0 - 1.0;
}
bool aq(float ar, float as) {
return abs(ar - as) < EPSILON;
}
float at(float au) {
float bh = 2.;
vec2 bi = abs(c.rg) - c.ba - vec2(bh) + vec2(au);
float bj = min(max(bi.x, bi.y), 0.0) + length(max(bi, 0.0)) - au;
return smoothstep(0.1, .5, (1. - bj) / 10.);
}
void main() {
#if D3D9_FIX
#else
float br = o.x;
float bs = o.y;
float bt = r.x;
float bu = r.y;
#endif
vec4 bx = texture2D(u_shapeTexture, d);
float by = al(bx.b, bx.a) * s.x;
float bz = al(bx.r, bx.g) * s.y;
float ch = float(f.z > EPSILON);
float ci = float(f.w > EPSILON);
float cj = 1. - smoothstep(
0.01,
0.25760,
distance(f.xy * f.z - vec2(0.0586), d * f.z)
);
cj = cj * 2.5 - 1.5;
cj *= 0.5;
cj *= s.x;
float ck = at(g) ;
vec4 cl = a;
vec4 cm = b;
if (u > -EPSILON) {
vec2 cq = e;
float dd =
step(m.x, cq.x) *
step(cq.x, n.x) *
step(m.y, cq.y) *
step(cq.y, n.y);
float de = dd;
vec4 dh;
if (aq(u, FILTER_NEAREST)) {
dh = texture2D(u_patternNearestTexture, cq);
} else if (aq(u, FILTER_LINEAR)) { 
dh = texture2D(u_patternLinearTexture, cq);
} else if (aq(u, FILTER_LINEAR_SDF)) { 
dh = texture2D(u_patternLinearSdfTexture, cq);
dh.a = smoothstep(SDF_BUFFER - t, SDF_BUFFER + t, dh.a);
} else if (aq(u, FILTER_MIPMAP)) { 
dh = texture2D(u_patternMipmapTexture, cq);
}
dh.rgb += c.rgb;
dh.a *= de;
cl = af(cl, dh);
}
float dw = (1. - ch) * min(by, bz)
+ ch * cj;
dw = (1. - ci) * dw + ci * ck;
float ek = clamp(dw, 0.0, 1.0);
float en = clamp(dw - l, 0.0, 1.0);
float eo = ek - en;
eo = 1.0 - clamp(dw - l, 0.0, 1.0);
cl.a *= en;
cm.a *= eo * step(EPSILON, l);
vec4 ew = af(cl, cm);
float ex = ek;
ew.rgb = mix(u_backgroundColor, ew.rgb, br);
if (q > EPSILON) {
float fk = fract(bu) * q;
float fl = clamp(min(fk, bt - fk), 0.0, 1.0);
ex *= fl;
}
if (p < 0.0 || p > 1.0 || ex < EPSILON) {
discard;
}
ew.a *= ex;
ew.rgb *= ew.a;
gl_FragColor = ew;
}
`,lm=`#define D3D9_FIX 0
#define ANIMATED 0
precision highp float;
precision mediump int;
attribute /*ushort*/ vec4 a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;
attribute /*ushort*/ vec4 a_final_patternId_fillRGBA_strokeRGBA_patternRGBA;
attribute /*float*/ vec4 a_final_x1_y1_x2_y2;
attribute /*ushort*/ vec4 a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;
attribute /*ushort*/ vec4 a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;
attribute /*ushort*/ vec4 a_final_offsetScaled_offsetFixed_paddingTop_paddingLeft;
attribute /*ushort*/ vec4 a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;
attribute /*ushort*/ vec4 a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA;
attribute /*float*/ vec4 a_prev_x1_y1_x2_y2;
attribute /*ushort*/ vec4 a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;
attribute /*ushort*/ vec4 a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;
attribute /*ushort*/ vec4 a_prev_offsetScaled_offsetFixed_paddingTop_paddingLeft;
attribute /*float*/ vec2 a_animationBeginTime_animationDuration; 
attribute /*ushort*/ vec4 a_animationEasing; 
attribute /*ushort*/ vec3 a_text_charId_charOffsetXY; 
attribute vec3 a_vertexInfo;
uniform float u_viewWidth;
uniform float u_viewHeight;
uniform float u_viewX;
uniform float u_viewY;
uniform float u_viewAngle;
uniform float u_viewZoom;
uniform float u_currentTime;
uniform float u_pixelRatio;
uniform sampler2D u_patternInfoTexture;
varying vec4 a;
varying vec4 b;
varying vec4 c;
varying vec2 d;
varying vec2 e;
varying float g;
#if D3D9_FIX
#else
varying float l;
varying vec2 m;
varying vec2 n;
varying vec2 o;
varying float p;
varying float q;
varying vec2 r;
varying vec2 s;
varying float t;
varying float u;
#endif
varying vec4 f;
const float EPSILON = 0.000001;
const float INFINITY = 10000000.0;
const float PI = 3.14159265359;
const float P2_17 = 131072.0;
const float P2_16 = 65536.0;
const float P2_14 = 32768.0;
const float P2_12 = 4096.0;
const float P2_8 = 256.0;
const float P2_7 = 128.0;
const float P2_6 = 64.0;
const float P2_5 = 32.0;
const float P2_4 = 16.0;
const float P2_3 = 8.0;
const float P2_2 = 4.0;
const float P2_1 = 2.0;
const float MAX_FLOAT16_OFFSET = 16384.0;
const float MAX_FLOAT16 = 65535.0;
const float MAX_PROGRESS = 1.0;
uniform float BYTES_TO_COORD;
uniform float BYTES_TO_SCALED_SIZE;
uniform float BYTES_TO_MIN_VISIBLE_SIZE;
uniform float BYTES_TO_SYMBOLIC_SIZE;
uniform float BYTES_TO_CURVATURE;
uniform float BYTES_TO_DASH_LENGTH;
uniform float BYTES_TO_GAP_LENGTH;
uniform float BYTES_TO_PATTERN_SCALE;
uniform float PATTERN_POSITION_UNIT_SIZE;
uniform float PATTERN_INFO_TEXTURE_SIZE;
uniform float PATTERN_NEAREST_TEXTURE_SIZE;
uniform float PATTERN_LINEAR_TEXTURE_SIZE;
uniform float PATTERN_LINEAR_SDF_TEXTURE_SIZE;
uniform float PATTERN_MIPMAP_TEXTURE_SIZE;
uniform float ROUNDED_BOX_RADIUS;
const float BYTES_TO_OFFSET_ANGLE = 0.0;
const float BYTES_TO_COLOR = 0.0;
const float SDF_FONT_SIZE = 0.0;
const float SDF_GAMMA = 0.0;
const float CURVATURE_RATIO = 0.0;
const float PATTERN_PADDING = 0.0;
const float TEXT_WIDTH_MULTIPLIER = 0.0;
const float TEXT_HEIGHT_MULTIPLIER = 0.0;
const float SELF_LOOP_CURVATURE_RATIO = 0.0;
const float EDGE_ARROW_SIZE_RATIO = 0.0;
const float EDGE_MIN_TIP_SIZE = 0.0;
const float CURVE_SUBDIVISIONS = 0.0;
const float PIECE_NODE_COMPONENT = 0.0;
const float PIECE_TEXT_BOX = 0.0;
const float PIECE_EDGE_BODY = 0.0;
const float PIECE_EDGE_HEAD = 0.0;
const float PIECE_EDGE_TAIL = 0.0;
const float PIECE_EDGE_TEXT = 0.0;
const float MAX_TEXT_SIZE = 0.0;
const float BYTES_TO_TEXT_OFFSET_X = 0.0;
const float BYTES_TO_TEXT_OFFSET_Y = 0.0;
const float FILTER_NEAREST = 0.0;
const float FILTER_LINEAR = 0.0;
const float FILTER_LINEAR_SDF = 0.0;
const float FILTER_MIPMAP = 0.0;
const float SHAPE_TEXTURE_SIZE = 0.0;
const float SIMPLE_SHAPE_SAMPLING_SIZE = 0.0;
const float COMPLEX_SHAPE_SAMPLING_SIZE = 0.0;
const float SHAPE_SAMPLING_BUFFER_RATIO = 0.0;
const float MAX_SHAPES = 0.0;
const float FIRST_COMPLEX_SHAPE_ID = 0.0;
const float SELF_LOOP_TO_CIRCLE_APPROX = 0.0;
const float NB_SHAPES_BY_SIDE = SHAPE_TEXTURE_SIZE / COMPLEX_SHAPE_SAMPLING_SIZE;
const float SHAPE_FILL_PERCENT = 1.0 - SHAPE_SAMPLING_BUFFER_RATIO;
const float T_STEP_PER_CURVE_PIECE = 1.0 / CURVE_SUBDIVISIONS;
const float HEAD_TAIL_PX_ADJUST = 1.5;
const float SDF_SMOOTH_FACTOR = 2.0;
struct pv {
float pw;
float px;
float py;
float pz;
float qa;
float qb;
float qc;
float qd;
};
struct qe {
float qf;
float qg;
float qh;
float qi;
float qj;
float qk;
float ql;
};
struct qm {
float pw;
float px;
float py;
float pz;
float qa;
float qb;
float qc;
float qd;
float qf;
float qg;
float qh;
float qi;
float qj;
float qk;
float ql;
float dc;
float qn;
float qo;
float qp;
float qq;
float qr;
float qs;
vec4 cl;
vec4 cm;
vec4 dh;
float qt;
float qu;
float qv;
float qw;
float qx;
float qy;
float qz;
float ra;
float rb;
float rc;
float rd;
float re;
float rf;
float rg;
float rh;
float ri;
float rj;
float rk;
float rl;
};
struct rm {
float eu;
vec2 rn;
vec4 cl;
vec4 cm;
float dc;
float ro;
float rp;
float py;
float rq;
vec2 rr;
float rs;
vec2 cq;
vec2 rt;
vec2 ru;
float rv;
float rw;
vec4 dh;
vec2 bd;
float rx;
float or;
vec2 ry;
vec2 rz;
vec2 sa;
};
float sb(float nq, float sc, float sd) {
float se = mod(nq, pow(2.0, sd));
return floor(se / pow(2.0, sc));
}
pv sf(float nq) {
pv sg;
sg.pw = sb(nq, 0.0, 4.0);
sg.px = sb(nq, 4.0, 8.0);
sg.py = sb(nq, 8.0, 10.0);
sg.pz = sb(nq, 10.0, 12.0);
sg.qa = sb(nq, 12.0, 13.0);
sg.qb = sb(nq, 13.0, 14.0);
sg.qc = sb(nq, 14.0, 15.0);
sg.qd = sb(nq, 15.0, 16.0);
return sg;
}
qe sh(float nq) {
qe sg;
sg.qf = sb(nq, 0.0, 8.0);
sg.qg = sb(nq, 8.0, 11.0);
sg.qh = sb(nq, 11.0, 12.0);
sg.qi = sb(nq, 12.0, 13.0);
sg.qj = sb(nq, 13.0, 14.0);
sg.qk = sb(nq, 14.0, 15.0);
sg.ql = sb(nq, 15.0, 16.0);
return sg;
}
float si(float ll) {
float sj = mod(floor(ll / 32768.0), 2.0) == 1.0 ? -1.0 : 1.0; 
float sl = mod(floor(ll / 1024.0), 32.0); 
float sn = mod(ll, 1024.0); 
float sq = float(sl == 0.0 || sl == 31.0);
return (1. - sq)
* sj * pow(2.0, sl - 15.0) * (1.0 + sn / 1024.0);
}
vec4 sr(in float nq) {
return vec4(
sb(nq, 0.0, 4.0),
sb(nq, 4.0, 8.0),
sb(nq, 8.0, 12.0),
sb(nq, 12.0, 16.0)
);
}
vec2 ss(in float nq) {
return vec2(mod(nq, 256.0), floor(nq / 256.0));
}
vec2 st(in float nq) {
float su = floor(nq / P2_6);
float sv = nq - (su * P2_6);
return vec2(su, sv);
}
vec2 sw(in float nq) {
float sx = floor(nq / P2_7);
float sy = nq - (sx * P2_7);
return vec2(sx, sy);
}
vec2 sz(in vec2 ta, in float tb) {
float tc = cos(tb);
float td = sin(tb);
return vec2(tc * ta.x + td * ta.y, -td * ta.x + tc * ta.y);
}
vec4 te(in vec4 tf) {
return floor(tf / 256.0) - 128.0;
}
vec4 tg(in vec4 tf) {
return mod(tf, 256.0) - 128.0;
}
float th(float nq) {
return nq - 128.0;
}
vec2 th(vec2 nq) {
return nq - 128.0;
}
vec2 ti(vec2 tj) {
return vec2(-tj.y, tj.x);
}
vec2 tk(vec2 tl, vec2 ih, vec2 tm, float t) {
float tn = 1.0 - t;
return (tn * tn * tl) + (2.0 * tn * t * ih) + (t * t * tm);
}
vec2 to(vec2 tl, vec2 tp, vec2 tq, vec2 tm, float t) {
float tn = 1.0 - t;
float tr = tn * tn;
float ts = tr * tn;
float tt = t * t;
float tu = tt * t;
return (ts * tl) + (3.0 * tr * t * tp) + (3.0 * tn * tt * tq) + (tu * tm);
}
vec2 tv(vec2 tl, vec2 ih, vec2 tm, float t) {
float tn = (1.0 - t);
vec2 ta = (tn * ih + t * tm) - (tn * tl + t * ih);
return normalize(ta);
}
vec2 tw(vec2 tl, vec2 ih, vec2 tm, float t) {
return ti(tv(tl, ih, tm, t));
}
vec2 tx(vec2 tl, vec2 tp, vec2 tq, vec2 tm, float t) {
float tn = 1.0 - t;
float tr = tn * tn;
float tt = t * t;
vec2 ta = tr * (tp - tl) + 2.0 * tn * t * (tq - tp) + tt * (tm - tq);
return normalize(ta);
}
vec2 ty(vec2 tl, vec2 tp, vec2 tq, vec2 tm, float t) {
return ti(tx(tl, tp, tq, tm, t));
}
float uj(float qr, float uk, float t) {
float y = abs(qr) / CURVATURE_RATIO + EPSILON;
float qw = y * y;
float tn = t - 0.5;
float tr = tn * tn;
float ul = 1.0 / (16.0 * qw);
float um = sqrt(tr + ul);
float un = (0.5 / y) * sqrt(qw + 0.25);
float uo = (abs(2.0 * y)) * ((tn * um) + (0.5 * un) + (ul * log(abs((tn + um) / (-0.5 + un)))));
return uo * uk;
}
float uz(vec2 va, vec2 vb, vec2 vc, vec2 vd) {
bool vk = abs(va.x - vb.x - vc.x + vd.x) + abs(va.y - vb.y - vc.y + vd.y) < EPSILON;
float vl = 9.0 * pow(vb.x - va.x, 2.0); 
float vo = pow(-243.0 * va.x + 189.0 * vb.x + 51.0 * vc.x + 3.0 * vd.x, 2.0) / 10000.0; 
float vp = pow(-48.0 * va.x + 24.0 * vb.x + 21.0 * vc.x + 3.0 * vd.x, 2.0) / 625.0; 
float vq = pow(-147.0 * va.x + 21.0 * vb.x + 99.0 * vc.x + 27.0 * vd.x, 2.0) / 10000.0; 
float vr = pow(-27.0 * va.x - 9.0 * vb.x + 24.0 * vc.x + 12.0 * vd.x, 2.0) / 625.0; 
float vs = (9.0 / 16.0) * pow(vc.x + vd.x - va.x - vb.x, 2.0); 
float vt = 9.0 * pow(vb.y - va.y, 2.0); 
float vv = pow(-243.0 * va.y + 189.0 * vb.y + 51.0 * vc.y + 3.0 * vd.y, 2.0) / 10000.0; 
float vw = pow(-48.0 * va.y + 24.0 * vb.y + 21.0 * vc.y + 3.0 * vd.y, 2.0) / 625.0; 
float vx = pow(-147.0 * va.y + 21.0 * vb.y + 99.0 * vc.y + 27.0 * vd.y, 2.0) / 10000.0; 
float vy = pow(-27.0 * va.y - 9.0 * vb.y + 24.0 * vc.y + 12.0 * vd.y, 2.0) / 625.0; 
float vz = (9.0 / 16.0) * pow(vc.y + vd.y - va.y - vb.y, 2.0); 
float wa = sqrt(vl + vt); 
float wc = sqrt(vo + vv); 
float wd = sqrt(vp + vw); 
float we = sqrt(vq + vx); 
float wf = sqrt(vr + vy); 
float wg = sqrt(vs + vz); 
if(vk)
return (5.0 / 2993760.0) * 
(32134.0 * wa + 
212600.0 * wc - 
97050.0 * wd + 
544800.0 * we - 
521100.0 * wf + 
427368.0 * wg);
float wh = pow(-12.0 * va.x - 24.0 * vb.x + 9.0 * vc.x + 27.0 * vd.x, 2.0) / 625.0; 
float wi = pow(-27.0 * va.x - 99.0 * vb.x - 21.0 * vc.x + 147.0 * vd.x, 2.0) / 10000.0; 
float wj = pow(-3.0 * va.x - 21.0 * vb.x - 24.0 * vc.x + 48.0 * vd.x, 2.0) / 625.0; 
float wk = pow(-3.0 * va.x - 51.0 * vb.x - 189.0 * vc.x + 243.0 * vd.x, 2.0) / 10000.0; 
float wl = 9.0 * pow(vd.x - vc.x, 2.0); 
float wm = pow(-12.0 * va.y - 24.0 * vb.y + 9.0 * vc.y + 27.0 * vd.y, 2.0) / 625.0; 
float wn = pow(-27.0 * va.y - 99.0 * vb.y - 21.0 * vc.y + 147.0 * vd.y, 2.0) / 10000.0; 
float wo = pow(-3.0 * va.y - 21.0 * vb.y - 24.0 * vc.y + 48.0 * vd.y, 2.0) / 625.0; 
float wp = pow(-3.0 * va.y - 51.0 * vb.y - 189.0 * vc.y + 243.0 * vd.y, 2.0) / 10000.0; 
float wq = 9.0 * pow(vd.y - vc.y, 2.0); 
float wr = sqrt(wh + wm); 
float ws = sqrt(wi + wn); 
float wt = sqrt(wj + wo); 
float wu = sqrt(wk + wp); 
float wv = sqrt(wl + wq); 
return (5.0 / 2993760.0) * 
(16067.0 * (wa + wv) + 
106300.0 * (wc + wu) - 
48525.0 * (wd + wt) + 
272400.0 * (we + ws) - 
260550.0 * (wf + wr) + 
427368.0 * wg);
}
float ww(float nq) {
return nq - 32.0;
}
float wx(float nq) {
return nq - 512.0;
}
float wy(float nq) {
return nq - P2_14;
}
void wz() {
gl_Position = vec4(-10.0, -10.0, 1.0, 1.0);
}
vec4 xa(vec2 xb) {
return vec4(((vec2(xb.x, u_viewHeight - xb.y) / vec2(u_viewWidth, u_viewHeight)) * 2.0 - 1.0), 0.5, 1.0);
}
float xf(float ar, float as) {
return step(ar - EPSILON, as) * step(as, ar + EPSILON);
}
bool aq(float ar, float as) {
return abs(ar - as) < EPSILON;
}
bool xg(float nq) {
return nq > 0.5;
}
vec2 xh(vec2 xi) {
return sz((xi - vec2(u_viewX, u_viewY)) * u_viewZoom, u_viewAngle) + vec2(u_viewWidth, u_viewHeight) / 2.0;
}
float xj(float or) {
return max(EDGE_MIN_TIP_SIZE, or * EDGE_ARROW_SIZE_RATIO);
}
float xk(float xl, float xm) {
return xl * BYTES_TO_SCALED_SIZE * u_viewZoom + xm;
}
float xn(float xl, float xm) {
return xl * BYTES_TO_SCALED_SIZE * MAX_FLOAT16 / MAX_FLOAT16_OFFSET * u_viewZoom + xm;
}
float xt(float ro, float xr, float xs) {
float xu = xs - xr;
float a = 1.0 / xu;
float b = -xr / xu;
return ro * a + b;
}
struct xv {
vec2 vb;
vec2 vc;
};
xv xw(vec2 xx, float au, float qr) {
xv ns;
float xy = (au + au / SELF_LOOP_CURVATURE_RATIO * qr) * SELF_LOOP_CURVATURE_RATIO;
float xz = -u_viewAngle + PI;
float ya = -u_viewAngle + PI / 2.0;
ns.vb = xx + vec2(cos(xz), sin(xz)) * xy;
ns.vc = xx + vec2(cos(ya), sin(ya)) * xy;
return ns;
}
float yb(vec2 yc, vec2 yd, vec2 ye, vec2 yf, float yg) {
const int MAX_ITERATIONS = 10; 
const float EPSILON = 0.01; 
float yn = 0.0;
float cf = 1.0;
float yo = 0.0;
for (int yp = 0; yp < MAX_ITERATIONS; yp++) {
float yq = (yn + cf) * 0.5;
vec2 yr = to(yc, yd, ye, yf, yq);
float ys = distance(yc, yr);
if (abs(ys - yg) < EPSILON) {
return yq;
}
if (ys < yg) {
yn = yq;
yo = yq;
} else {
cf = yq;
}
}
return yo;
}
float yz(vec2 yc, vec2 yd, vec2 ye, vec2 yf, float yg, bool za) {
if (!za) {
return 1.0 - yb(yf, ye, yd, yc, yg);
}
return yb(yc, yd, ye, yf, yg);
}
qm zd(
vec4 ze,
vec4 zf,
vec4 zg,
vec4 zh,
vec4 zi,
vec4 zj,
vec3 zk
) {
qm a;
pv bx = sf(ze.x);
qe zl = sh(ze.y);
vec4 zm = sr(ze.z);
vec2 zn = ss(ze.w);
a.pw = bx.pw;
a.px = bx.px;
a.py = bx.py;
a.pz = bx.pz;
a.qa = bx.qa;
a.qb = bx.qb;
a.qc = bx.qc;
a.qd = bx.qd;
a.qf = zl.qf;
a.qg = zl.qg;
a.qh = zl.qh;
a.qi = zl.qi;
a.qj = zl.qj;
a.qk = zl.qk;
a.ql = zl.ql;
a.dc = zm.x;
a.qn = zm.y;
a.qo = zm.z;
a.qp = zm.w;
a.qq = zn.x;
a.qr = zn.y;
a.qs = zf.x;
a.cl = sr(zf.y);
a.cm = sr(zf.z);
a.dh = sr(zf.w);
a.qt = zg.x;
a.qu = zg.y;
a.qv = zg.z;
a.qw = zg.w;
a.qx = si(zh.x);
a.qy = zh.y;
a.qz = si(zh.z);
a.ra = zh.w;
a.rb = zi.x;
a.rc = zi.y;
a.rd = zi.z;
a.re = zi.w;
a.rf = zj.x;
a.rg = wy(zj.y);
a.rk = wy(zj.z);
a.rl = wy(zj.w);
a.rh = zk.x;
float x = zk.y;
float y = mod(x, P2_8);
if (zk.z > 0.0) x += zk.z * P2_16;
a.ri = ((x - y) / P2_8) - P2_16;
a.rj = (y - P2_7) * BYTES_TO_TEXT_OFFSET_Y;
return a;
}
bool aaq(const in qm a, out rm ns) {
float pw = a.pw;
float px = a.px;
float py = a.py * BYTES_TO_DASH_LENGTH;
float pz = a.pz * BYTES_TO_GAP_LENGTH;
float qa = a.qa;
float qb = a.qb;
float qc = a.qc;
float qd = a.qd;
float qf = a.qf * BYTES_TO_PATTERN_SCALE;
float qg = a.qg * BYTES_TO_OFFSET_ANGLE;
float qh = a.qh;
float qi = a.qi;
float qj = a.qj;
float qk = a.qk;
float ql = a.ql;
float dc = a.dc * BYTES_TO_COLOR;
float qn = a.qn * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;
float qo = a.qo * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;
float qp = a.qp * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;
float qq = a.qq * BYTES_TO_SYMBOLIC_SIZE * u_viewZoom + step(a.qq, EPSILON) * INFINITY;
float qr = th(a.qr);
float qs = a.qs;
vec4 cl = a.cl * BYTES_TO_COLOR;
vec4 cm = a.cm * BYTES_TO_COLOR;
vec4 dh = a.dh * BYTES_TO_COLOR;
vec2 aar = vec2(a.qt, a.qu) * BYTES_TO_COORD;
vec2 aas = vec2(a.qv, a.qw) * BYTES_TO_COORD;
vec2 yc = xh(aar);
vec2 yf = xh(aas);
float aat = xn(a.qx,a.qy);
float aau = xn(a.qz, a.ra);
float aav = xk(a.rb, a.rc);
float eu = xk(a.rd, a.re);
float zs = xk(a.rf, a.rg);
vec2 aaw = a_vertexInfo.xy;
vec2 aax = vec2(0.0, 0.0);
float aay = aat;
float aaz = aau;
float aba = aau * qf;
if (qh > EPSILON || dc< EPSILON) {
if (a.rh < EPSILON || dc< EPSILON) return false;
aba = aav;
qs = a.rh;
aat = aba * TEXT_WIDTH_MULTIPLIER * u_pixelRatio;
aau = aba * TEXT_HEIGHT_MULTIPLIER * u_pixelRatio;
}
bool abu = abs(qr) > EPSILON && xf(px, PIECE_EDGE_BODY) < EPSILON;
bool abv = abu && a_vertexInfo.z > EPSILON;
if (pw < EPSILON || px < EPSILON || qq < qn || abv) {
return false;
}
eu *= step(qo, qq);
float aci = 0.0;
float acj = 1.0;
float acf = 0.0;
float ach = 1.0;
float ack = 0.0;
float acu = 1.0;
float acw = 1.0;
float adg = 0.0;
float adh = 0.0;
vec2 bd;
vec2 ry;
vec2 rz;
vec2 sa;
float or;
float rx;
float ady = 0.0;
float adz = 1.0;
bool ci = xf(px, PIECE_TEXT_BOX) > EPSILON;
if (xf(px, PIECE_NODE_COMPONENT) > EPSILON || ci) {
bd = ceil((yc + yf) / 2.0);
if(length(aas - aar) > EPSILON){
ry = normalize(aas - aar) * vec2(1.,-1.);
}else{
ry = vec2(1.0, 0.0);
}
rz = ti(ry);
sa = rz;
or = aat;
rx = aau;
} else {
acw = 0.0;
float aep = distance(yc, yf);
vec2 aeq = normalize(yf - yc);
vec2 aer = (yc + yf) / 2.0;
vec2 aes = ti(aeq);
vec2 yd;
vec2 ye;
if (qk > EPSILON) {
vec2 aey = sz(yc, -u_viewAngle);
vec2 aez = sz(yf, -u_viewAngle);
float afc = 1. / (1. + exp(-qr));
if (ql > EPSILON) {
float afd = afc * aey.y + (1. - afc) * aez.y;
yd = vec2(aey.x, afd);
ye = vec2(aez.x, afd);
} else {
float afe = afc * aey.x + (1. - afc) * aez.x;
yd = vec2(afe, aey.y);
ye = vec2(afe, aez.y);
}
yd = sz(yd, u_viewAngle);
ye = sz(ye, u_viewAngle);
}
vec2 aff = aer + (aes * aep * -qr / CURVATURE_RATIO);
if (xf(px, PIECE_EDGE_TEXT) > 0.0
|| xf(px, PIECE_EDGE_TEXT + PIECE_TEXT_BOX) > 0.0
) {
ci = xf(px, PIECE_EDGE_TEXT + PIECE_TEXT_BOX) > 0.0;
float afg;
float afh = eu;
eu = 0.0;
if (qd > EPSILON) {
xv ih = xw(yc, afh / 2.0, qr);
bd = to(yc, ih.vb, ih.vc, yf, 0.5);
ry = tx(yc, ih.vb, ih.vc, yf, 0.5);
rz = ti(ry);
sa = rz;
afg = .5 * uz(yc, ih.vb, ih.vc, yf);
} else if (qk > EPSILON) {
bd = to(yc, yd, ye, yf, 0.5);
ry = tx(yc, yd, ye, yf, 0.5);
rz = ti(ry);
sa = rz;
afg = uz(yc, yd, ye, yf);
} else if (abs(qr) > EPSILON) {
bd = tk(yc, aff, yf, 0.5);
ry = tv(yc, aff, yf, 0.5);
rz = ti(ry);
sa = rz;
afg = uj(qr, aep, 1.0);
} else {
bd = aer;
ry = aeq;
rz = aes;
sa = aes;
afg = aep;
}
or = aat;
rx = aau;
if(aay > afg - afh && qd < EPSILON){
if(qi > EPSILON){
ry = vec2(1.0, 0.0);
rz = vec2(0.0, 1.0);
sa = vec2(0.0, 1.0);
} else {
ry = vec2(0,0);
rz = vec2(0.0, 0.0);
sa = vec2(0.0, 0.0);
}
} else {
float tb = -atan(ry.y, ry.x);
ady = tb;
qg -= tb;
if ((tb > PI / 2.0 || tb < -PI / 2.0)) {
qg += (1.0 - qd) * PI;
adz = -1.0;
ry *= -1.0;
rz *= -1.0;
sa *= -1.0;
}
}
} else {
float afo = aat;
float afp = aau;
float afq = xj(aav);
float afr = qa
* min(5. * afo, afq);
float afs = qb
* min(5. * afp, afq);
float aft = xf(px, PIECE_EDGE_HEAD);
float afu = xf(px, PIECE_EDGE_TAIL);
float afv = INFINITY * qd + aep - afo - afp;
float age = min(0., afv - afr - afs)/2.;
float agj = aav / 2.;
float agk =
afo > agj
? afo - sqrt(afo * afo - agj * agj)
: agj;
float agl = max( afo +
afs
+ qb * age,
0.) - (1. - qa) * agk;
agk =
afp > agj
? afp - sqrt(afp * afp - agj * agj)
: agj;
float agm = max( afp +
afr
+ qa * age
, 0.) - (1. - qb) * agk;
if(qk > EPSILON && qd < EPSILON) {
agl = afo + afs / 2.;
agm = afp + afr / 2.;
}
if (aft > EPSILON || afu > EPSILON) {
vec2 agr = aft * yf + afu * yc;
float zs = aft * agm + afu * agl + (HEAD_TAIL_PX_ADJUST - 0.5);
float ags = aft * afr + afu * afs;
vec2 agt;
if (qk > EPSILON && qd < EPSILON) {
float yg = aft > EPSILON ? agm : agl;
float t = yz(yc, yd, ye, yf, yg, afu > EPSILON);
agt = to(yc, yd, ye, yf, t);
ry = normalize(agt - to(yc, yd, ye, yf, t - 0.01));
if(afu > EPSILON) ry *= -1.;
bd = agt;
} else {
if (qd > EPSILON) {
xv ih = xw(yc, afo, qr);
float yg = aft * agm + afu * agl;
float t = yz(yc, ih.vb, ih.vc, yf, yg, afu > EPSILON);
agt = to(yc, ih.vb, ih.vc, yf, t);
} else {
float afg = uj(qr, aep, 1.0);
float t = (aft * (afg - agm) + afu * agl) / afg;
agt = tk(yc, aff, yf, t);
}
ry = normalize(agr - agt);
bd = agr - ry * (zs - ags / 2.0);
}
rz = ti(ry);
sa = rz;
or = ags;
rx = ags;
py = 0.0;
pz = 0.0;
} else {
float agx;
float agy;
float agz;
if(qk > EPSILON && qd < EPSILON) {
float aha = yz(yc, yd, ye, yf, agl, true);
float ahb = yz(yc, yd, ye, yf, agm, false);
float ahc = ahb - aha;
float ahd = a_vertexInfo.z;
float ahe = (aha + ahc * ahd * T_STEP_PER_CURVE_PIECE);
float tt = (aha + ahc * (ahd + 1.) * T_STEP_PER_CURVE_PIECE);
vec2 ahf = to(yc, yd, ye, yf, ahe);
vec2 ahg = to(yc, yd, ye, yf, tt);
bd = (ahf + ahg) / 2.0;
ry = normalize(ahg - ahf);
rz = ty(yc, yd, ye, yf, ahe);
sa = ty(yc, yd, ye, yf, tt);
or = distance(ahf, ahg);
agx = uz(yc, yd, ye, yf);
agy = agx * ahe;
agz = agx * tt;
} else {
if (abs(qr) < EPSILON) {
bd = aer;
ry = aeq;
rz = aes;
sa = rz;
or = aep;
agx = aep;
agy = 0.0;
agz = aep;
} else {
float ahd = a_vertexInfo.z;
float ahe = ahd * T_STEP_PER_CURVE_PIECE;
float tt = ahe + T_STEP_PER_CURVE_PIECE;
if (qd < EPSILON) {
vec2 ahf = tk(yc, aff, yf, ahe);
vec2 ahg = tk(yc, aff, yf, tt);
bd = (ahf + ahg) / 2.0;
ry = normalize(ahg - ahf);
rz = tw(yc, aff, yf, ahe);
sa = tw(yc, aff, yf, tt);
or = distance(ahf, ahg);
agx = uj(qr, aep, 1.0);
agy = uj(qr, aep, ahe);
agz = uj(qr, aep, tt);
} else {
xv ih = xw(yc, afo, qr);
vec2 yd = ih.vb;
vec2 ye = ih.vc;
vec2 ahf = to(yc, yd, ye, yf, ahe);
vec2 ahg = to(yc, yd, ye, yf, tt);
bd = (ahf + ahg) / 2.0;
ry = normalize(ahg - ahf);
rz = ty(yc, yd, ye, yf, ahe);
sa = ty(yc, yd, ye, yf, tt);
or = distance(ahf, ahg);
agx = uz(yc, yd, ye, yf);
agy = ahe * agx;
agz = tt * agx;
}
}
}
rx = aav;
if(qd > EPSILON) {
xv ih = xw(yc, afo, qr);
float ahk = yz(yc, ih.vb, ih.vc, yf, agl, true);
float ahb = yz(yc, ih.vb, ih.vc, yf, agm, false);
acf = ahk;
ach = ahb;
} else if(qk < EPSILON) {
acf = (agl - 1.0) / agx;
ach = MAX_PROGRESS - (agm - HEAD_TAIL_PX_ADJUST) / agx;
}
aci = agy / agx;
acj = agz / agx;
ack = agx;
if (aav < EPSILON)
cl.a = 0.; 
if (qc > 0.0 && afv > 5.0) {
float aho = (agx * rx) / (agx - agl);
float ahp = agx;
float qt = agl;
float qv = agx - agm;
float a = -aho / ahp;
float b = aho;
float qu = a * qt + b;
float qw = a * qv + b;
float ahq = qu / (qt - qv);
float bi = -ahq * qv;
rx = min(min(bi, afo), afp);;
adh = ahq * ahp + bi + 1.0;
}
}
}
}
vec2 cq = vec2(0.0, 0.0);
vec2 rt = vec2(EPSILON, EPSILON);
vec2 ru = vec2(-EPSILON, -EPSILON);
float rv = -1.0;
float rw = 0.0;
bool ahs = false;
vec2 aht = vec2(0,0);
vec2 ahu = vec2(0,0);
vec2 ahv = vec2(0,0);
if (qs > EPSILON && qq > qp) {
float ahy = floor(qs / PATTERN_INFO_TEXTURE_SIZE);
float ahz = qs - (ahy * PATTERN_INFO_TEXTURE_SIZE);
vec4 aia = texture2D(u_patternInfoTexture, vec2(ahz, ahy) / 255.0) * 255.0;
vec2 aib = sw(aia.z);
vec2 aic = sw(aia.w);
rv = aib.x * 2.0 + aic.x;
float aid = 0.0;
if (aq(rv, FILTER_NEAREST)) { 
aid = PATTERN_NEAREST_TEXTURE_SIZE;
} else if (aq(rv, FILTER_LINEAR)) { 
aid = PATTERN_LINEAR_TEXTURE_SIZE;
} else if (aq(rv, FILTER_LINEAR_SDF)) { 
aid = PATTERN_LINEAR_SDF_TEXTURE_SIZE;
ahs = true;
} else if (aq(rv, FILTER_MIPMAP)) { 
aid = PATTERN_MIPMAP_TEXTURE_SIZE;
}
float aig = 1.0 / aid;
vec2 aih = (vec2(aib.y, aic.y) * PATTERN_POSITION_UNIT_SIZE) * aig / 2.0;
ahu += (aia.xy * PATTERN_POSITION_UNIT_SIZE * aig) + aih;
aih -= PATTERN_PADDING * aig * 2.0;
vec2 aii = vec2(or / 2.0, rx / 2.0) * aig;
vec2 aij = vec2(eu, eu) * aig;
float ail = 1.0 * u_pixelRatio;
float aim = SDF_SMOOTH_FACTOR;
if (qf > EPSILON) {
if (ahs) { 
if (a.qj > EPSILON) {
aim = SDF_SMOOTH_FACTOR * u_pixelRatio / SDF_GAMMA;
aht = vec2(-a.rl,-a.rk);
}
rw = aim * SDF_GAMMA / aba / u_pixelRatio;
ail = SDF_FONT_SIZE / aba;
} else { 
ail = (aih.y / aii.y) / qf;
}
}
ahv = (aii + aij) * ail;
aih += PATTERN_PADDING * aig;
rt = ahu - aih;
ru = ahu + aih;
}
if (qh > EPSILON) {
aax.y = (a.rj) * aba;
acu = 0.0;
acw = 0.0;
aax.x = a.ri * aba * BYTES_TO_TEXT_OFFSET_X;
aax = sz(aax, ady);
aax *= adz;
}
vec2 air = vec2(cos(qg), sin(qg)) * zs;
vec2 ais = bd + air + aax;
float ait = eu * 2.0;
float aiu = or + acw * (ait + 1.0);
float aiv = rx + acu * (ait + 1.0);
vec2 aiw = ry * aiu / 2.0;
vec2 aix = rz * aiv / 2.0;
vec2 aiy = sa * aiv / 2.0;
float aiz = (acj - aci);
float aja = aaw.x / 2.0 + 0.5;
float ro = aci + aiz * aja;
float rs = adg + (adh - adg) * ro / 2.0;
float ajb = step(pw, FIRST_COMPLEX_SHAPE_ID - EPSILON);
float ajc = ajb * SIMPLE_SHAPE_SAMPLING_SIZE + (1.0 - ajb) * COMPLEX_SHAPE_SAMPLING_SIZE;
float ajd = ajc / COMPLEX_SHAPE_SAMPLING_SIZE;
float aje = ajd * SHAPE_SAMPLING_BUFFER_RATIO / 2.0;
float ajf = ajd * (1.0 - SHAPE_SAMPLING_BUFFER_RATIO);
vec2 ajm = vec2(
mod(pw, NB_SHAPES_BY_SIDE),
floor(pw / NB_SHAPES_BY_SIDE)
);
vec2 ajn = ajm + vec2(aje) +
vec2(aci * ajf, 0.0);
vec2 ajq = vec2(aiz, 1.0) * ajf;
vec2 rn = (ajn + ajq * (aaw / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE;
vec2 rr = vec2(aiu / aiz, aiv) / 2.0;
float ajw = py * aav;
float ajx = pz * aav;
float rp = ajw + ajx;
float rq = (ro * ack) / rp;
cq = ahu
+ ahv
* (aaw + aht / rr * u_viewZoom);
ns.rn = rn;
float ch = float(pw == 1.);
f = vec4(
(ajn + ajq * (vec2(0.5,0.5) / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE,
NB_SHAPES_BY_SIDE * (1. - qh) * ch,
float(ci)
);
ns.rr = rr;
ns.eu = eu;
ns.cl = cl;
ns.cm = cm;
ns.dc = dc;
ns.ro = xt(ro, acf, ach);
ns.rp = rp;
ns.py = ajw;
ns.rq = rq;
ns.rs = rs;
ns.cq = cq;
ns.rt = rt;
ns.ru = ru;
ns.rv = rv;
ns.rw = rw;
ns.dh = dh;
ns.bd = ais;
ns.or = aiu + ch;
ns.rx = aiv + ch;
ns.ry = ry;
ns.rz = rz;
ns.sa = sa;
return true;
}
float akc(float akd, float ake, vec4 akf) {
float akg = clamp(((u_currentTime - akd) / ake), 0.0, 1.0);
float r = akg;
float akh = r * r;
float aki = akh * r;
vec4 akj = akg < 0.5 ? te(akf) : tg(akf);
float akk = akj.x;
float akl = akj.y;
float akm = akj.z;
float akn = akj.w;
float ako = akk + akl * r + akm * akh + akn * aki;
return ako;
}
void main() {
qm a_final = zd(
a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,
a_final_patternId_fillRGBA_strokeRGBA_patternRGBA,
a_final_x1_y1_x2_y2,
a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,
a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,
a_final_offsetScaled_offsetFixed_paddingTop_paddingLeft,
a_text_charId_charOffsetXY
);
#if ANIMATED
float akd = a_animationBeginTime_animationDuration.x;
float ake = a_animationBeginTime_animationDuration.y;
vec4 akf = a_animationEasing;
float aap = akc(akd, ake, akf);
qm a_prev = zd(
a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,
a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA,
a_prev_x1_y1_x2_y2,
a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,
a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,
a_prev_offsetScaled_offsetFixed_paddingTop_paddingLeft,
a_text_charId_charOffsetXY
);
const float ONE = 1.0;
a_final.pw = mix(a_prev.pw, a_final.pw, ONE);
a_final.py = mix(a_prev.py, a_final.py, aap);
a_final.pz = mix(a_prev.pz, a_final.pz, aap);
a_final.qa = mix(a_prev.qa, a_final.qa, ONE);
a_final.qb = mix(a_prev.qb, a_final.qb, ONE);
a_final.px = mix(a_prev.px, a_final.px, ONE);
a_final.qf = mix(a_prev.qf, a_final.qf, ONE);
a_final.qh = mix(a_prev.qh, a_final.qh, ONE);
a_final.qi = mix(a_prev.qi, a_final.qi, ONE);
a_final.qj = mix(a_prev.qj, a_final.qj, ONE);
a_final.qk = mix(a_prev.qk, a_final.qk, ONE);
a_final.qd = mix(a_prev.qd, a_final.qd, ONE);
a_final.qg = mix(a_prev.qg, a_final.qg, aap);
a_final.dc = mix(a_prev.dc, a_final.dc, aap);
a_final.qn = mix(a_prev.qn, a_final.qn, aap);
a_final.qo = mix(a_prev.qo, a_final.qo, aap);
a_final.qp = mix(a_prev.qp, a_final.qp, aap);
a_final.qq =mix(a_prev.qq, a_final.qq, aap);
a_final.qr = mix(a_prev.qr, a_final.qr, aap);
a_final.qs = mix(a_prev.qs, a_final.qs, ONE);
a_final.cl = mix(a_prev.cl, a_final.cl, aap);
a_final.cm = mix(a_prev.cm, a_final.cm, aap);
a_final.dh = mix(a_prev.dh, a_final.dh, aap);
a_final.qt = mix(a_prev.qt, a_final.qt, aap);
a_final.qu = mix(a_prev.qu, a_final.qu, aap);
a_final.qv = mix(a_prev.qv, a_final.qv, aap);
a_final.qw = mix(a_prev.qw, a_final.qw, aap);
a_final.qx = mix(a_prev.qx, a_final.qx, aap);
a_final.qy = mix(a_prev.qy, a_final.qy, aap);
a_final.qz = mix(a_prev.qz, a_final.qz, aap);
a_final.ra = mix(a_prev.ra, a_final.ra, aap);
a_final.rb = mix(a_prev.rb, a_final.rb, aap);
a_final.rc = mix(a_prev.rc, a_final.rc, aap);
a_final.rd = mix(a_prev.rd, a_final.rd, aap);
a_final.re = mix(a_prev.re, a_final.re, aap);
a_final.rf = mix(a_prev.rf, a_final.rf, aap);
a_final.rg = mix(a_prev.rg, a_final.rg, aap);
a_final.rh = mix(a_prev.rh, a_final.rh, ONE);
a_final.ri = mix(a_prev.ri, a_final.ri, ONE);
a_final.rj = mix(a_prev.rj, a_final.rj, ONE);
#endif
rm ns;
bool aks = aaq(a_final, ns);
if (!aks) {
wz();
return;
}
vec2 aaw = a_vertexInfo.xy;
a = ns.cl;
b = ns.cm;
c = ns.dh;
d = ns.rn;
e = ns.cq;
#if D3D9_FIX
#else
l = ns.eu;
m = ns.rt;
n = ns.ru;
o = vec2(ns.dc, ns.rs);
p = ns.ro;
q = ns.rp;
r = vec2(ns.py, ns.rq);
s = ns.rr;
t = ns.rw;
u = ns.rv;
#endif
float akv = step(aaw.x, 0.0);
float akw = 1.0 - akv;
g = min(ns.rx, ROUNDED_BOX_RADIUS * 2.) * u_pixelRatio;
vec2 xb = ns.bd
+ ns.ry * (ns.or / 2.0) * aaw.x
+ (akv * ns.rz + akw * ns.sa) * ns.rx / 2.0 * aaw.y;
c = c * (1. - f.w)
+ vec4(
aaw.x * ns.or,
aaw.y * ns.rx,
ns.or,
ns.rx
) * u_pixelRatio * f.w;
gl_Position = xa(xb);
}
`,yE=1e20,PD=class{constructor({fontSize:e=24,buffer:t=8,radius:n=6,cutoff:s=.25}={}){this._maxDimension=1,this._gridSize=1,this._fontSize=e,this._buffer=t,this._radius=n,this._cutoff=s,this._height=Math.ceil(this._fontSize+2*this._buffer*vg),this._canvas=Es(),this._canvas.height=this._height,this._canvas.width=1;const r=this._canvas.getContext("2d",{willReadFrequently:!0});this._ctx=r,r.textBaseline="middle",r.textAlign="center",r.fillStyle="black"}setOptions({fontSize:e=24,buffer:t=8,cutoff:n=.25,radius:s=6}){this._fontSize=e,this._buffer=t,this._cutoff=n,this._radius=s,this._height=Math.ceil(this._fontSize+2*this._buffer*vg)}draw(e,t,n){Fo(this._ctx,t,this._fontSize,n);const s=RD(this._ctx.measureText(e).width+2*this._buffer)-2*Po,r=this._height,i=s*r,o=Math.max(s,r);this._canvas.width<s&&(this._canvas.width=s,Fo(this._ctx,t,this._fontSize,n),this._ctx.textAlign="center",this._ctx.textBaseline="middle",this._ctx.fillStyle="black"),i>this._gridSize&&(this._gridOuter=new Float64Array(i),this._gridInner=new Float64Array(i),this._gridSize=i),o>this._maxDimension&&(this._f=new Float64Array(o),this._d=new Float64Array(o),this._z=new Float64Array(o+1),this._v=new Int16Array(o),this._maxDimension=o),this._ctx.clearRect(0,0,s,r),this._ctx.fillText(e,s/2,r/2);const a=this._ctx.getImageData(0,0,s,r),u=new Uint8ClampedArray(i);for(let d=0;d<i;d++){const c=a.data[4*d+3]/255;this._gridOuter[d]=c===1?0:c===0?yE:Math.pow(Math.max(0,.5-c),2),this._gridInner[d]=c===1?yE:c===0?0:Math.pow(Math.max(0,c-.5),2)}xE(this._gridOuter,s,r,this._f,this._d,this._v,this._z),xE(this._gridInner,s,r,this._f,this._d,this._v,this._z);for(let d=0;d<i;d++){const c=this._gridOuter[d]-this._gridInner[d];u[d]=Math.max(0,Math.min(255,Math.round(255-255*(c/this._radius+this._cutoff))))}return{height:r,width:s,distance:u}}};function xE(e,t,n,s,r,i,o){for(let a=0;a<t;a++){for(let u=0;u<n;u++)s[u]=e[u*t+a];vE(s,r,i,o,n);for(let u=0;u<n;u++)e[u*t+a]=r[u]}for(let a=0;a<n;a++){for(let u=0;u<t;u++)s[u]=e[a*t+u];vE(s,r,i,o,t);for(let u=0;u<t;u++)e[a*t+u]=Math.sqrt(r[u])}}function vE(e,t,n,s,r){n[0]=0,s[0]=-1e20,s[1]=1e20;for(let i=1,o=0;i<r;i++){let a=(e[i]+i*i-(e[n[o]]+n[o]*n[o]))/(2*i-2*n[o]);for(;a<=s[o];)o--,a=(e[i]+i*i-(e[n[o]]+n[o]*n[o]))/(2*i-2*n[o]);o++,n[o]=i,s[o]=a,s[o+1]=1e20}for(let i=0,o=0;i<r;i++){for(;s[o+1]<i;)o++;t[i]=(i-n[o])*(i-n[o])+e[n[o]]}}function RD(e){return Math.ceil((e+2*Po)/Ps)*Ps}var cc=256,FD=.275,DD=.25,OD=6,zD=YR-2*Po,BD=XR-2*Po,bE={fontSize:_d,cutoff:FD,radius:OD},UD={fontSize:_d,cutoff:DD,radius:8},GD=class{constructor(e,t){this._patternIdToInfoTexture=new Uint8Array(cc*cc*4),this._glTextures=[],this._textureSizes=[],this._pixelRatio=1,this._gl=e,this._glUnit=t;const n=Es(Gr,Gr),s=n.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("Pattern: could not get 2d context");this._imageCanvasContext=s,this._imageCanvas=n,this._canvasForDuplicatedImage,this._sdfGenerator=new PD(bE),this._maxTextureSize=Math.min(4096,e.getParameter(e.MAX_TEXTURE_SIZE))}refresh(e){this._pixelRatio=e.getPixelRatio();const t=this._gl,n=this._getPatternsByFilter(e.getPatternList());for(let i=0;i<n.length;++i){const o=i,a=n[i],u=fD(a,this._maxTextureSize),{texture:d,size:c}=$T(o,a,u,this._maxTextureSize,this._patternIdToInfoTexture),g=this._glTextures[o]||(this._glTextures[o]=t.createTexture()),f=o===El?rx:T_;gE(t,g,this._glUnit+1+o,d,c,o,f),this._textureSizes[o]=c}const s=this._glTextureInfo||(this._glTextureInfo=t.createTexture()),r=this._patternIdToInfoTexture;gE(t,s,this._glUnit,r,cc,El,T_)}bindMetaDataTexture(){const e=this._gl;e.activeTexture(e.TEXTURE0+this._glUnit),e.bindTexture(e.TEXTURE_2D,this._glTextureInfo)}getInfoTextureUnit(){return this._glUnit}getNearestTextureUnit(){return this._glUnit+1+El}getLinearTextureUnit(){return this._glUnit+1+id}getLinearSdfTextureUnit(){return this._glUnit+1+od}getMipmapTextureUnit(){return this._glUnit+1+oa}getInfoTextureSize(){return cc}getNearestTextureSize(){return this._textureSizes[El]}getLinearTextureSize(){return this._textureSizes[id]}getLinearSdfTextureSize(){return this._textureSizes[od]}getMipmapTextureSize(){return this._textureSizes[oa]}_getPatternsByFilter(e){const t=new Array(dE);for(let n=0;n<dE;++n)t[n]=[];for(let n=0;n<e.length;++n){const s=this._getPatternPixels(e[n]);t[s.filter].push(s)}return t}_getPatternPixels({id:e,type:t,attributes:n}){let s;const{text:r,font:i,style:o,image:a,scaled:u,duplicated:d,colorArray:c}=n;switch(t){case Io:s=d?this._getDuplicatedImagePixels(a):u?this._getScaledImagePixels(a):this._getNonScaledImagePixels(a);break;case da:s=this._getSdfTextPixels(r,i,o);break;case ma:s=this._getIconPixels(r,i,o);break;case _a:s=this._getBadgeIconPixels(r,i,o);break;case Ud:s=this._getPieChartPixels(c);break;default:throw new Error(`pattern type "${t}" does not exist`)}return s.id=e,s}_getScaledImagePixels(e){let t=e.width,n=e.height;if(t>0){const s=Gr/Math.max(e.width,e.height);t*=s,n*=s}return t&&n&&(t=zl(t),n=zl(n)),t-=2*Po,n-=2*Po,this._getImagePixels(e,t,n)}_getNonScaledImagePixels(e){return this._getImagePixels(e,e.width,e.height)}_getDuplicatedImagePixels(e){if(e.width===0||e.height===0)return this._getImagePixels(e,0,0);this._canvasForDuplicatedImage||(this._canvasForDuplicatedImage=Es(Gr,Gr));const t=this._canvasForDuplicatedImage,n=t.getContext("2d"),s=e.width,r=e.height;let i=(Gr-s)/2,o=(Gr-r)/2;for(;i>0;)i-=s;for(;o>0;)o-=r;for(let a=i;a<Gr;a+=s)for(let u=o;u<Gr;u+=r)n.drawImage(e,a,u);return this._getImagePixels(t,Gr,Gr)}_getImagePixels(e,t,n){let s;if(t===0||n===0)s=new Uint8Array(0);else{(this._imageCanvas.width<t||this._imageCanvas.height<n)&&(this._imageCanvas.width=t,this._imageCanvas.height=n);const r=this._imageCanvasContext;S_(this._imageCanvas,r,t,n);try{r.drawImage(e,0,0,t,n)}catch{}s=r.getImageData(0,0,t,n).data}return{width:t,height:n,pixels:s,filter:oa}}_getPieChartPixels(e){const t=BD,n=this._imageCanvasContext,s=t/2,r=t/2;return S_(this._imageCanvas,n,t,t),n.save(),n.rect(0,0,t,t),n.clip(),XT(n,e,s,r,t),n.restore(),{width:t,height:t,pixels:n.getImageData(0,0,t,t).data,filter:id}}_getTextPixels(e,t,n,s,r,i){const o=this._imageCanvasContext,a=r*this._pixelRatio;Fo(o,n,a,s);let u=Math.ceil(o.measureText(t).width);u===0&&(u=a);let d=0,c=0;e===oa||(d=2*Math.ceil(a*vg/2),c=2*Math.ceil(u*uT/2));const g=Math.ceil(u+c),f=Math.ceil(a+d),p=this._imageCanvas.height<f||this._imageCanvas.width<g;return this._imageCanvas.height<f&&(this._imageCanvas.height=f),this._imageCanvas.width<g&&(this._imageCanvas.width=g),p&&Fo(o,n,a,s),o.clearRect(0,0,g,f),o.fillStyle="black",o.textBaseline="middle",o.textAlign="left",o.fillText(t,i+c/2,f/2),{width:g,height:f,pixels:o.getImageData(0,0,g,f).data,filter:e}}_getIconPixels(e,t,n){return this._getTextPixels(oa,e,t,n,zD,0)}_getBadgeIconPixels(e,t,n){return this._sdfGenerator.setOptions(UD),this._getSdfPixels(e,t,n)}_getSdfTextPixels(e,t,n){return this._sdfGenerator.setOptions(bE),this._getSdfPixels(e,t,n)}_getSdfPixels(e,t,n){const{width:s,height:r,distance:i}=this._sdfGenerator.draw(e,t,n),o=new Uint8Array(s*r*4);for(let a=0;a<i.length;++a)o[4*a+3]=i[a];return{width:s,height:r,pixels:o,filter:od}}},VD=class{constructor(e,t){this._gl=e,this._glTextureUnit=t,this._simpleShapePixels=new Uint8Array(Yc*Yc*4),this._complexShapePixels=new Uint8Array(wo*wo*4),this._shapesWritten=[]}refresh(e){const t=e.getShapeList();for(const n of t)if(!this._shapesWritten.includes(n.id)){const s=n.isSimple?Yc:wo,r=n.isSimple?this._simpleShapePixels:this._complexShapePixels;pD(n,s,__,r),this._loadShapeInGpu(n.id,s,r),this._shapesWritten.push(n.id)}}_loadShapeInGpu(e,t,n){const s=this._gl,r=x_,i=e%y_*wo,o=Math.floor(e/y_)*wo;if(this._texture)s.bindTexture(s.TEXTURE_2D,this._texture);else{const a=new Uint8Array(r*r*4);this._texture=s.createTexture(),s.activeTexture(s.TEXTURE0+this._glTextureUnit),s.bindTexture(s.TEXTURE_2D,this._texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,r,r,0,s.RGBA,s.UNSIGNED_BYTE,a)}s.texSubImage2D(s.TEXTURE_2D,0,i,o,t,t,s.RGBA,s.UNSIGNED_BYTE,n)}getTextureSize(){return x_}getSamplingSize(){return wo}getBufferRatio(){return __}getTextureUnit(){return this._glTextureUnit}},EE=class{constructor(e,{vertex:t,fragment:n,constants:s,macros:r}){this._state=0,this._gl=e,this._vertexSource=t,this._fragmentSource=n,this._constants=Bn(s||{}),this._macros=Bn(r||{})}setConstant(e,t){this._constants[e]=t}setMacro(e,t){this._macros[e]=t}getState(){return this._state}getProgram(){return this._program}compile(){const e=this._gl,t=SE(this._vertexSource,this._macros,this._constants),n=SE(this._fragmentSource,this._macros,this._constants);this._program&&(e.deleteProgram(this._program),e.deleteShader(this._vertexShader),e.deleteShader(this._fragmentShader));const s=e.createProgram(),r=e.createShader(e.VERTEX_SHADER),i=e.createShader(e.FRAGMENT_SHADER);if(!(s&&r&&i))throw new Error("Error instantiating WebGL program");this._program=s,this._vertexShader=r,this._fragmentShader=i,e.shaderSource(this._vertexShader,t),e.compileShader(this._vertexShader),e.attachShader(this._program,this._vertexShader),e.shaderSource(this._fragmentShader,n),e.compileShader(this._fragmentShader),e.attachShader(this._program,this._fragmentShader),e.linkProgram(this._program),this._state=1}getError(){const e=this._gl;if(!e.getShaderParameter(this._vertexShader,e.COMPILE_STATUS)){const t=e.getShaderInfoLog(this._vertexShader)||"";let n=t;const s=t.match(/ERROR: (\d+):(\d+):(.*)\n/g);if(s&&s.length){const r=this._vertexSource.split(`
`);n=s.map(i=>{const o=i.match(/ERROR: (\d+):(\d+):(.*)\n/);if(!o)return i;const[a,u]=o.slice(2);return`${r[+a]}
${r[+a+1]}
~~~~~~~~~~~
${r[+a+2]}
 -> ${u}`}).join(`
`)}return{step:"vertex",message:n}}return e.getShaderParameter(this._fragmentShader,e.COMPILE_STATUS)?e.getProgramParameter(this._program,e.LINK_STATUS)?(this._state=2,null):{step:"link",message:e.getProgramInfoLog(this._program)||""}:{step:"fragment",message:e.getShaderInfoLog(this._fragmentShader)||""}}};function SE(e,t,n){const s=Object.keys(t),r=Object.keys(n);for(let i=0;i<s.length;++i){const o=s[i],a=t[o];e=e.replace(`#define ${o} 0`,`#define ${o} ${a}`)}for(let i=0;i<r.length;++i){const o=r[i],a=n[o],u=a+(a%1==0?".0":"");e=e.replace(`const float ${o} = 0.0;`,`const float ${o} = ${u};`)}return e}function jD(){return typeof window<"u"&&!!window.FORCE_WEBGL}/** @preserve instance id */var AE=IT(),HD={stencil:!0,antialias:!1,alpha:!0,premultipliedAlpha:!0,failIfMajorPerformanceCaveat:!jD()},qD=0,$D=1,WD={NO_WEBGL:'Unable to create a WebGL context: `canvas.getContext("webgl")` and `canvas.getContext("experimental-webgl")` returned `null`',NO_ANGLE_INSTANCED_ARRAYS:'WebGL extension "ANGLE_instanced_arrays" unavailable: `gl.getExtension("ANGLE_instanced_arrays")` returned `null`'},ZT=class extends Error{};function um(e,t){if(!e&&t){const n=new ZT(WD[t]);throw n.code=t,n}}var XD=class KT extends ji{constructor(t){super(t),this._2dcanvas=Es(),this._ctx=this._2dcanvas.getContext("2d"),this._bufferDrawers=[],this._mustResize=!1,this._error=null,this._onContextLost=u=>{u.preventDefault(),this._error=new ZT("WebGL context lost"),this.fire("error",this._error)};const n=KT.createInitData(),{canvas:s,gl:r,ext:i,staticProgramWrapper:o,animationProgramWrapper:a}=n;um(r,"NO_WEBGL"),um(i,"NO_ANGLE_INSTANCED_ARRAYS"),this._glCanvas=s,this._gl=r,this._ext=i,this._staticProgramWrapper=o,this._animationProgramWrapper=a,this._shapeTexture=new VD(this._gl,qD),this._patternTexture=new GD(this._gl,$D),this._initCanvas(this._glCanvas),this._computeShaderInfo(),this._initSpecialGlBuffers(),this._initGlPrograms(),this._initGl()}_initCanvas(t){super._initCanvas(t),t.addEventListener("webglcontextlost",this._onContextLost,!1)}static isAvailable(){return AE||um(null,"NO_WEBGL"),AE}static createInitData(){const t=Es(),n=Zy(t,HD,"webgl"),s=n&&typeof n.getExtension=="function"?n.getExtension("ANGLE_instanced_arrays"):null,r=KD(),i=new EE(n,{vertex:lm,fragment:am,constants:r,macros:{ANIMATED:0}}),o=new EE(n,{vertex:lm,fragment:am,constants:r,macros:{ANIMATED:1}});return n&&s&&(i.compile(),n.flush()),{canvas:t,gl:n,ext:s,staticProgramWrapper:i,animationProgramWrapper:o}}static getName(){return"WebGL"}_beforeFirstFrame(){this._animationProgramWrapper.getState()===0&&this._animationProgramWrapper.compile()}ensureAnimationsReady(){const t=this._animationProgramWrapper.getState();t!==2&&(t===0&&this._animationProgramWrapper.compile(),this._animationProgramWrapper.getError())}getDomElement(){return this._glCanvas}_initGl(){const t=this._gl;t.clearColor(0,0,0,0),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)}_computeShaderInfo(){this._shaderMetadata=YD(lm,am)}_initGlPrograms(){this._staticProgram=new _E({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._staticProgramWrapper}),this._animationProgram=new _E({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._animationProgramWrapper})}_initSpecialGlBuffers(){const t=this._gl,n=t.createBuffer(),s=new Int8Array(18*rr);for(let r=0;r<rr;++r){const i=[-1,-1,r,1,-1,r,1,1,r,-1,-1,r,-1,1,r,1,1,r],o=r*i.length;for(let a=0;a<i.length;a++)s[a+o]=i[a]}t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,s,t.STATIC_DRAW),this._specialGlBuffers={vertexInfo:n}}_computeUniforms(){return{viewWidth:this._width,viewHeight:this._height,viewX:this._viewX,viewY:this._viewY,viewZoom:this._viewZoom,viewAngle:this._viewAngle,currentTime:this._currentTime,pixelRatio:this._pixelRatio,backgroundColor:this._backgroundRgba,patternInfoTexture:this._patternTexture.getInfoTextureUnit(),patternNearestTexture:this._patternTexture.getNearestTextureUnit(),patternLinearTexture:this._patternTexture.getLinearTextureUnit(),patternLinearSdfTexture:this._patternTexture.getLinearSdfTextureUnit(),patternMipmapTexture:this._patternTexture.getMipmapTextureUnit(),shapeTexture:this._shapeTexture.getTextureUnit(),BYTES_TO_COORD:this._scales.bytesToActualCoord,BYTES_TO_SCALED_SIZE:this._scales.bytesToActualScaledSize,BYTES_TO_MIN_VISIBLE_SIZE:this._scales.bytesToActualMinVisibleSize,BYTES_TO_SYMBOLIC_SIZE:this._scales.bytesToActualSymbolicSize,BYTES_TO_DASH_LENGTH:this._scales.bytesToActualDashLength,BYTES_TO_GAP_LENGTH:this._scales.bytesToActualGapLength,BYTES_TO_PATTERN_SCALE:this._scales.bytesToActualPatternScale,PATTERN_INFO_TEXTURE_SIZE:this._patternTexture.getInfoTextureSize(),PATTERN_NEAREST_TEXTURE_SIZE:this._patternTexture.getNearestTextureSize(),PATTERN_LINEAR_TEXTURE_SIZE:this._patternTexture.getLinearTextureSize(),PATTERN_LINEAR_SDF_TEXTURE_SIZE:this._patternTexture.getLinearSdfTextureSize(),PATTERN_MIPMAP_TEXTURE_SIZE:this._patternTexture.getMipmapTextureSize(),PATTERN_POSITION_UNIT_SIZE:Ps,ROUNDED_BOX_RADIUS:this._textManager.getCornerRadius(),SHAPE_TEXTURE_SIZE:this._shapeTexture.getTextureSize(),SHAPE_SAMPLING_SIZE:this._shapeTexture.getSamplingSize(),SHAPE_SAMPLING_BUFFER_RATIO:this._shapeTexture.getBufferRatio(),NB_SHAPES_BY_SIDE:this._shapeTexture.getTextureSize()/this._shapeTexture.getSamplingSize(),SHAPE_DIMENSIONS:this._shapeTexture.getSamplingSize()/this._shapeTexture.getTextureSize(),SHAPE_ACTUAL_RATIO:1-this._shapeTexture.getBufferRatio()}}_render({shapesChanged:t,patternsChanged:n,dimensionsChanged:s,backgroundColorChanged:r}){const i=this._gl;if(this._error)throw this._error;if(t&&(this._shapeTexture.refresh(this._shapeManager),this._patternTexture.bindMetaDataTexture()),n&&this._patternTexture.refresh(this._patternManager),s&&(this._mustResize=!0),r){const[u,d,c,g]=this._renderBackground?this._backgroundRgba:[0,0,0,0];i.clearColor(u*g,d*g,c*g,g)}const o=this._computeUniforms(),a=this._getSortedBufferList();this._mustResize&&a.length&&(ag(this._glCanvas,this._width,this._height,this._pixelRatio),i.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),this._mustResize=!1),i.clear(i.COLOR_BUFFER_BIT|i.STENCIL_BUFFER_BIT);for(let u=0;u<a.length;++u)this._displayBuffer(a[u],o);this._endFrame()}_displayBuffer(t,n){const s=t.getProgram();s!==this._currentProgram&&(this._currentProgram&&this._currentProgram.endPass(),this._currentProgram=s,this._currentProgram.startPass(n)),t.markAsUsed(),t.draw()}_getSortedBufferList(){const t=this._bufferList.getBuffersByAscendingDepth(),n=[];for(let s=0;s<this._bufferDrawers.length;++s){const r=this._bufferDrawers[s];r&&r.markAsUnused()}for(let s=0;s<t.length;++s){const r=t[s],i=this._getBufferDrawer(r);i.markAsUsed(),!r.isEmpty()&&this._isBufferDisplayable(r)&&n.push(i)}for(let s=0;s<this._bufferDrawers.length;++s){const r=this._bufferDrawers[s];r&&!r.isUsed()&&(r.destroy(),this._bufferDrawers[s]=void 0)}return n}_endFrame(){this._currentProgram&&(this._currentProgram.endPass(),this._currentProgram=null)}_getBufferDrawer(t){const n=t.getId();let s=this._bufferDrawers[n];if(!s){for(;this._bufferDrawers.length<=n;)this._bufferDrawers.push(void 0);s=new TD({gl:this._gl,ext:this._ext,staticProgram:this._staticProgram,animationProgram:this._animationProgram}),this._bufferDrawers[n]=s}return s.setDataBuffer(t),s}destroy(){this._glCanvas&&this._glCanvas.removeEventListener("webglcontextlost",this._onContextLost);const t=this._gl.getExtension("WEBGL_lose_context");t&&t.loseContext()}getImageData(){const t=this._glCanvas.width,n=this._glCanvas.height;return(this._2dcanvas.width<t||this._2dcanvas.height<n)&&(this._2dcanvas.width=t,this._2dcanvas.height=n),this._ctx.clearRect(0,0,t,n),this._ctx.drawImage(this._glCanvas,0,0),this._ctx.getImageData(0,0,t,n)}_getImageDataFlippedYAxis(){const t=this._gl,n=this._glCanvas.width,s=this._glCanvas.height,r=this._ctx.createImageData(n,s),i=new Uint8Array(r.data.buffer);return t.readPixels(0,0,n,s,t.RGBA,t.UNSIGNED_BYTE,i),r}setConstant(t,n){this._staticProgramWrapper.setConstant(t,n),this._animationProgramWrapper.setConstant(t,n),this._staticProgramWrapper.compile(),this._animationProgramWrapper.compile(),this._initGlPrograms(),this._bufferDrawers.forEach(s=>{s==null||s.destroy()}),this._bufferDrawers=[]}};function YD(e,t){const n={vertexInfoAttribute:"a_vertexInfo",attributes:[],uniforms:[]};return wE(n,e),wE(n,t),n}var ZD={float:1,vec2:2,vec3:3,vec4:4};function wE(e,t){const n=/(?:attribute\s+\/\*\s*(byte|ubyte|short|ushort|float)\s*\*\/\s*(float|vec2|vec3|vec4)\s+(\w+)\s*;)|(?:#if\s*(\w+))|(?:#endif)/g,s=/uniform\s+(float|vec2|vec3|vec4|sampler2D|int)\s+(\w+)\s*;/g,r=[];let i=n.exec(t);for(;i;){const o=i[0];o==="#endif"?r.pop():o.startsWith("#if")?r.push(i[4]):e.attributes.push({name:i[3],size:ZD[i[2]],type:i[1],tags:r.slice(),location:null,byteSize:0,glType:null}),i=n.exec(t)}for(i=s.exec(t);i;){if(!e.uniforms.some(({id:o})=>o===i[1])){const o=i[1],a=i[2],u=a.replace("u_","");e.uniforms.push({id:u,name:a,type:o})}i=s.exec(t)}}function KD(){return{BYTES_TO_OFFSET_ANGLE:2*Math.PI/8,BYTES_TO_COLOR:1/15,SDF_FONT_SIZE:_d,CURVATURE_RATIO:ef,PATTERN_PADDING:Po,TEXT_WIDTH_MULTIPLIER:uT,TEXT_HEIGHT_MULTIPLIER:vg,SELF_LOOP_CURVATURE_RATIO:bg,EDGE_ARROW_SIZE_RATIO:ji.edgeArrowSizeRatio,EDGE_MIN_TIP_SIZE:ji.minEdgeTipSize,CURVE_SUBDIVISIONS:rr,PIECE_NODE_COMPONENT:Pr,PIECE_TEXT_BOX:ha,PIECE_EDGE_BODY:tf,PIECE_EDGE_HEAD:jy,PIECE_EDGE_TAIL:Hy,PIECE_EDGE_TEXT:ia,MAX_TEXT_SIZE:GF,BYTES_TO_TEXT_OFFSET_X:1/DT,BYTES_TO_TEXT_OFFSET_Y:1/A_,FILTER_NEAREST:El,FILTER_LINEAR:id,FILTER_LINEAR_SDF:od,FILTER_MIPMAP:oa,SHAPE_TEXTURE_SIZE:x_,SIMPLE_SHAPE_SAMPLING_SIZE:Yc,COMPLEX_SHAPE_SAMPLING_SIZE:wo,SHAPE_SAMPLING_BUFFER_RATIO:__,MAX_SHAPES:xg.toString(),FIRST_COMPLEX_SHAPE_ID:m_,SELF_LOOP_TO_CIRCLE_APPROX:cT,SDF_GAMMA:QR}}var QD={x:0,y:0,zoom:1,angle:0,width:80,height:60,pixelRatio:1,backgroundColor:null,currentTime:0,isBufferDisplayable:yy,hideImages:!1,renderBackground:!1,bentEnable:!1,bentVertical:!1},gc={webgl:XD,canvas:yD,svg:AD},TE=[0,0,0,0],dm={webgl:null,svg:null,canvas:null},hm=class extends Bd{constructor(e){super(),this._view=Bn(QD),this._domWrapper=qi?document.createElement("div"):og(),this._domElement=this._domWrapper.appendChild(qi?document.createElement("div"):og()),this._currentElementSize=0,this._currentBlockOffset=0,this._currentByteOffset=0,this._blockIdToAddress=new Uint32Array(0),this._renderersByType={},this._switchMainRenderer=!0,this._refreshTexts=!1,this._backgroundColor=null,this._initData=e||{},this._patternManager=new DF,this._shapeManager=new OF,this._boundariesManager=new aF,this._textManager=new VF(this._patternManager),this._bufferOffsetToId=new mT,this._memoryManager=new PF(this._patternManager,this._shapeManager,this._textManager,this._bufferOffsetToId,t=>this.parseColor(t)||TE),this._bufferList=new tF}static createInitData(){const e={};for(const t in gc)e[t]=gc[t].createInitData();return e}static cacheInitData(e){dm=e}static getCachedInitData(){return dm}static clearCachedInitData(){dm={webgl:null,svg:null,canvas:null}}freeBlock(e){this._checkBlockId(e);const t=this._blockIdToAddress[e],n=this._bufferList.freeBlock(t);return this._blockIdToAddress[e]=n,n}_ensureDomElementsFitParent(){const e=this._domElement.parentNode;!e||e.offsetWidth===this._view.width&&e.offsetHeight===this._view.height||wa(e,`${this._view.width}px`,`${this._view.height}px`)}_ensureCorrectBackgroundColor(){const e=this._domElement.parentNode;this._backgroundColor!==this._view.backgroundColor&&e&&(e.style.backgroundColor=this._view.backgroundColor||"",this._backgroundColor=this._view.backgroundColor)}createGroup(){return new oF}parseColor(e){return Fs(e)}clear(){this._blockIdToAddress.fill(0),this._patternManager.reset(),this._boundariesManager.reset(),this._textManager.reset(),this._bufferList.reset(),this._bufferOffsetToId.reset()}notifyFontsReloaded(){this._patternManager.notifyUpdate(),this._textManager.clear(),this._refreshTexts=!0}notifyPatternUpdate(){this._patternManager.notifyUpdate()}getShapePoints(e){return this._shapeManager.getDefinitionFromName(e).points}checkShapeHit(e,t,n){const{getDistanceFromStrokeVertically:s,getDistanceFromStrokeHorizontally:r}=this._shapeManager.getDefinitionFromName(e);return Math.min(s(t,n),r(t,n))>=0}setGlobalBoundaries(e){const{maxBlockId:t=0,maxScaledSize:n,maxMinVisibleSize:s,maxSymbolicSize:r,maxDashLength:i,maxGapLength:o,maxPatternScale:a}=e;return t>this._blockIdToAddress.length&&this._resizeBlockArray(t),!!this._boundariesManager.set(e)&&(this._memoryManager.resizeBoundaries(n,s,r,i,o,a),!0)}_resizeBlockArray(e){const t=new Uint32Array(e);t.set(this._blockIdToAddress),this._blockIdToAddress=t}registerShape(e,t){this._shapeManager.register(e,t)}_bindBlock(e,t,n,s,r,i,o){this._checkBlockId(e);const a=this._blockIdToAddress[e],u=this._bufferList.allocateBlock(a,t,n,s,r,i,o);return this._blockIdToAddress[e]=u.address,this._currentDataView=u.buffer.getDataView(),this._currentElementSize=u.buffer.elementSize,this._currentBlockOffset=u.offset,this._currentByteOffset=this._currentBlockOffset*this._currentElementSize,this._currentSideDataView=u.buffer.getSideDataView(),this._currentSideElementSize=u.buffer.getTotalSideElementsSize(),this._currentSideByteOffset=this._currentBlockOffset*this._currentSideElementSize,u}_setItemIndex(e){const t=this._currentBlockOffset+e;this._currentByteOffset=t*this._currentElementSize,this._currentSideByteOffset=t*this._currentSideElementSize}_checkBlockId(e){e>=this._blockIdToAddress.length&&this._resizeBlockArray(Co(e+1))}_setTextCharacters(e){this._textManager.storeTextInDataView(this._currentSideDataView,this._currentSideByteOffset,this._currentSideByteOffset+this._currentSideElementSize,e)}_storeElement(e,t){this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset,e.end),t&&(this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset+Dl,e.start),this._memoryManager.storeAnimationInformation(this._currentDataView,this._currentByteOffset+2*Dl,e.animation,$y.getCoefficients(e.animation.easing)))}storeGroup(e,t){if(!t||t.size===0)return this.freeBlock(e);const n=t.type,s=t.depth,r=t.size,i=t.getElements(),o=t.animated,a=t.stencilUsage,u=t.getId();let d=0;if(n===pa)for(let g=0;g<r;++g){const f=i[g],{start:p,end:_}=f;if(_.pattern.type===Ro){const y=_.pattern.attributes.text;d=Math.max(d,y.length)}if(o&&p.pattern.type===Ro){const y=p.pattern.attributes.text;d=Math.max(d,y.length)}}const c=this._bindBlock(e,n,o,s,r,d,a);for(let g=0;g<r;++g){const f=i[g];this._setItemIndex(g),this._storeElement(f,o),this._bufferOffsetToId.set(c.buffer.getId(),c.offset+g,u)}if(n===pa)for(let g=0;g<r;++g){const f=i[g];this._setItemIndex(g),this._setTextCharacters(f.end.pattern)}return c.address}_refreshTextElements(){const e=this._bufferList.getBuffers();for(const t of e)if(t&&t.type===pa){const n=t.getSideDataView(),s=t.getTotalSideElementsSize(),r=t.getSize();let i=0,o=s;for(let a=0;a<r;++a){const u=this._textManager.extractTextFromDataView(n,i,o);this._textManager.storeTextInDataView(n,i,o,u),i=o,o+=s}t.triggerUpdate()}}extractElement(e,t=0){if(!e)return null;const n=this._bufferList.getBlockInfo(e);return this._renderer.extractElement(n.buffer,n.offset+t)}getDomElement(){return this._domElement}getDomWrapper(){return this._domWrapper}measureText(e,t,n,s=1){return this._textManager.measureText(e,t,n,s)}setRenderType(e){this._renderType!==e&&(this._renderType=e,this._switchMainRenderer=!0)}setEdgeArrowSizeRatio(e){ji.setEdgeArrowSizeRatio(e),this._renderersByType.webgl&&this._renderersByType.webgl.setConstant("EDGE_ARROW_SIZE_RATIO",e)}setEdgeMinTipSize(e){ji.setMinEdgeTipSize(e),this._renderersByType.webgl&&this._renderersByType.webgl.setConstant("EDGE_MIN_TIP_SIZE",e)}setBentEdges(e,t){this._view.bentEnable=e,this._view.bentVertical=t}getBentEdges(){return{bentEnable:this._view.bentEnable,bentVertical:this._view.bentVertical}}_ensureMainRendererReady(){if(this._switchMainRenderer){this._renderType===null&&(this._renderType="canvas");const e=gc[this._renderType];e&&e.isAvailable()||(this._renderType="canvas"),this._renderer=this._renderersByType[this._renderType],this._renderer||(this._renderer=this._instanciateRenderer(this._renderType),this._renderer.on("error",t=>this.fire("error",t)),this._renderersByType[this._renderType]=this._renderer),this._updateDomElement()}}_updateDomElement(){const e=this._renderer&&this._renderer.getDomElement(),t=this._domElement;for(;t&&t.firstChild;)t.removeChild(t.firstChild);e&&this._appendDomChild(e)}_appendDomChild(e){e.style.position="absolute",e.style.left="0",e.style.top="0",this._domElement.appendChild(e)}_instanciateRenderer(e){return new(e===null?ji:gc[e])({initData:e===null?null:this._initData[e],bufferList:this._bufferList,shapeManager:this._shapeManager,patternManager:this._patternManager,boundariesManager:this._boundariesManager,textManager:this._textManager,memoryManager:this._memoryManager})}setView(e){this._view={...this._view,...e}}getTextManager(){return this._textManager}_updateManagers(){this._patternManager.setPixelRatio(this._view.pixelRatio),this._shapeManager.update(),this._patternManager.update(),this._textManager.update(),this._boundariesManager.update(),this._bufferList.update(),this._refreshTexts&&(this._refreshTexts=!1,this._refreshTextElements())}_resizeCanvas(e){xT(e,this._view.width,this._view.height,this._view.pixelRatio)}render(){this._ensureMainRendererReady(),this._ensureDomElementsFitParent(),this._ensureCorrectBackgroundColor(),this._updateManagers(),this._renderer.renderFrame(this._view)}ensureAnimationsReady(){this._ensureMainRendererReady(),this._renderer.ensureAnimationsReady()}export(e,t,n){const s=this._instanciateRenderer(e),r={...this._view,...t};return"setViewportClipping"in s&&s.setViewportClipping(!1),this._updateManagers(),s.renderFrame(r),s.export(n).then(()=>s.getDomElement())}getCurrentTime(){return Rs()}getImageData(){return this._renderer&&this._renderer.getImageData()}destroy(){for(const e of Object.keys(this._renderersByType)){const t=this._renderersByType[e];t&&t.destroy()}}transparentify(e){const t=this.parseColor(e)||TE;return`rgba(${Math.round(255*t[0])},${Math.round(255*t[1])},${Math.round(255*t[2])},0)`}initDebugRenderingLoop({triggerKey:e="r",start:t=!0}={}){let n=t;document.addEventListener("keydown",({key:r})=>{r===e&&(n=!n)});const s=r=>{(n||r)&&(this.setView({currentTime:Rs()}),this.render()),window.requestAnimationFrame(()=>{s()})};window.requestAnimationFrame(()=>{document.body.appendChild(this.getDomElement()),s(!0)})}},JD=qg&&document.fonts,eO=200,cm="/qwerty/ [HELLO] ",CE="serif",tO=16,nO=class{constructor(){this._fontFaceSet=JD?document.fonts:null,this._canvas=Es(),this._ctx=this._canvas.getContext("2d")}_measureText(e,t){return this._ctx.font=`12px ${t}`,this._ctx.measureText(e).width}check(e){if(e===CE)return!0;const t=this._measureText(cm,CE);return this._measureText(cm,e)!==t}load(e){return this._fontFaceSet&&this._fontFaceSet.load?this._fontFaceSet.load(`12px ${e}`):(this._ctx.font=`12px ${e}`,this._ctx.fillText(cm,10,50),Promise.resolve())}},sO=class{constructor(e,t){this._fontLoaderCounter=0,this._loaded=!1,this._value=null,this._timeout=0,this._fontFaceSet=e,this._fontName=t,this._loaded=!1,this._value=null,this._timeout=0,qg&&!this._fontFaceSet.check(this._fontName)||this._setLoaded()}_setLoaded(){this._loaded=!0,this._value=this._fontName}getValue(){return this._value}isLoaded(){return this._loaded}destroy(){clearTimeout(this._timeout)}load(){return this._tryLoad(eO).then(()=>this._setLoaded())}_tryLoad(e){return this._fontFaceSet.load(this._fontName).then(()=>{if(!this._fontFaceSet.check(this._fontName)&&this._fontLoaderCounter<tO)return new Promise(t=>{e<6e4&&(this._timeout=setTimeout(t,e))}).then(()=>(this._fontLoaderCounter++,this._tryLoad(1.5*e)))})}},rO=class{constructor(){this._fontFaceSet=new nO,this._fonts={},this._onFontLoaded=[],this._hideUntilFontsLoaded=!0}setHideUntilFontsLoaded(e){this._hideUntilFontsLoaded=e}getFont(e){let t=this._fonts[e];return t||(t=new sO(this._fontFaceSet,e),this._fonts[e]=t,t.isLoaded()||t.load().then(()=>this._triggerFontLoaded(e))),!this._hideUntilFontsLoaded&&e||t.getValue()}onFontLoaded(e){this._onFontLoaded.push(e)}destroy(){this._onFontLoaded=[],Object.keys(this._fonts).forEach(e=>this._fonts[e].destroy())}_triggerFontLoaded(e){this._onFontLoaded.forEach(t=>t(e))}};function iO(e,t,n,s){ix(e,t,n,s),e.thicknessOrFontSizeScaled=t.widthScaled,e.thicknessOrFontSizeFixed=t.widthFixed,e.strokeWidthScaled=t.stroke.widthScaled,e.strokeWidthFixed=t.stroke.widthFixed,e.offsetScaled=0,e.offsetFixed=0,e.fillColor=t.color,e.strokeColor=t.stroke.color,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=t.stroke.minVisibleSize,e.offsetAngle=0,e.symbolicSize=t.widthScaled,e.dashLength=t.shape.dashLength,e.gapLength=t.shape.gapLength,e.hasHead=!!t.shape.head,e.hasTail=!!t.shape.tail,e.isBodyTriangle=t.shape.isBodyTriangle}function ix(e,t,n,s){e.pieceId=n,e.shape=s,e.x1=t.sourceX,e.y1=t.sourceY,e.x2=t.targetX,e.y2=t.targetY,e.rectWidthOrSourceRadiusScaled=t.sourceRadiusScaled,e.rectWidthOrSourceRadiusFixed=t.sourceRadiusFixed,e.rectHeightOrTargetRadiusScaled=t.targetRadiusScaled,e.rectHeightOrTargetRadiusFixed=t.targetRadiusFixed,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.pattern.type=Ds,e.opacity=t.opacity,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=0,e.patternScale=0,e.symbolicSize=t.widthScaled,e.curvature=t.curvature,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=t.isSelfLoop,e.isText=!1}function oO(e,t,n){const s=t.widthScaled+2*t.halo.widthScaled,r=t.widthFixed+2*t.halo.widthFixed;ix(e,t,n,"line"),e.thicknessOrFontSizeScaled=s,e.thicknessOrFontSizeFixed=r,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.fillColor=t.halo.color,e.strokeColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=0,e.offsetAngle=0,e.symbolicSize=t.widthScaled,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isBodyTriangle=!1}function aO(e,t,n,s){ix(e,t,n,s);const r=t.widthFixed*sE+CF;e.thicknessOrFontSizeScaled=t.widthScaled*nE,e.thicknessOrFontSizeFixed=t.widthFixed*nE,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=t.widthScaled*sE,e.offsetFixed=r,e.fillColor=t.outline.color,e.strokeColor=null,e.globalMinVisibleSize=Math.max(t.minVisibleSize,t.outline.minVisibleSize),e.strokeMinVisibleSize=0,e.offsetAngle=Math.PI/2,e.symbolicSize=t.widthScaled,e.dashLength=t.shape.dashLength,e.gapLength=t.shape.gapLength,e.hasHead=!!t.shape.head,e.hasTail=!!t.shape.tail,e.isBodyTriangle=t.shape.isBodyTriangle}function lO(e,t,n){QT(e,t,n),e.pattern.type=Ro,e.pattern.attributes.text=t.content,e.pattern.attributes.size=Rd,e.pattern.attributes.font=t.font,e.pattern.attributes.style=t.style,e.pattern.attributes.align=t.align,e.patternColor=t.color,e.patternScale=1,e.thicknessOrFontSizeScaled=t.sizeScaled,e.thicknessOrFontSizeFixed=t.sizeFixed,e.isText=!0}function uO(e,t,n){QT(e,t,n),e.pieceId+=ha,e.fillColor=t.backgroundColor,e.shape="square"}function QT(e,t,n){const s=t.position==="centered"?0:(n.widthScaled+t.heightScaled)/2+n.stroke.widthScaled,r=t.position==="centered"?0:(n.widthFixed+t.heightFixed)/2+n.stroke.widthFixed+t.padding+t.margin;if(e.pieceId=ia,e.shape="square",e.x1=n.sourceX,e.y1=n.sourceY,e.x2=n.targetX,e.y2=n.targetY,!n.isSelfLoop&&n.curvature===0){const i=Math.atan2(e.y2-e.y1,e.x2-e.x1),o=n.sourceRadiusScaled-n.targetRadiusScaled,a=Math.cos(i),u=Math.sin(i);e.x1+=a*o,e.y1+=u*o}e.rectWidthOrSourceRadiusScaled=t.widthScaled,e.rectWidthOrSourceRadiusFixed=t.widthFixed+2*t.padding+1,e.rectHeightOrTargetRadiusScaled=t.heightScaled,e.rectHeightOrTargetRadiusFixed=t.heightFixed+2*t.padding,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=n.sourceRadiusScaled+n.targetRadiusScaled,e.strokeWidthFixed=n.sourceRadiusFixed+n.targetRadiusFixed,e.offsetScaled=s,e.offsetFixed=r,e.pattern.type=Ds,e.opacity=n.opacity,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=Math.max(t.minVisibleSize,n.minVisibleSize),e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=t.offsetAngle,e.patternScale=0,e.symbolicSize=n.widthScaled,e.curvature=n.curvature,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=n.isSelfLoop,e.isText=!1,e.adjustTextAngle=t.adjustAngle}var dO=e=>!!e||e===0;function Kr(e,t,n=0){return e==="inherit"?Array.isArray(t)?t[((n/(2*Math.PI)*t.length|0)+1)%t.length]:t:e}function hO(e,t,n){return e==="source"?Array.isArray(t)?t[0]:t:e==="target"?Array.isArray(n)?n[0]:n:e}function cO(e){const t=e.depth;return t===bT||t===vT||(t-Wy)%Yy>=Xy}function JT(e){const t=(e.depth-Wy)%Yy;return t>=0&&t!==ET&&t!==Xy}var Gd="shifted",gO="centered";fy(cw());function LE(e,t,n,s,r,i){fO(e,t,n,s,r,i),NE(e,t,n,s.text,r.texts.primary,i.texts.primary,i),NE(e,t,n,s.text.secondary,r.texts.secondary,i.texts.secondary,i)}function fO(e,t,n,s,r,i){if(gm(r.body,i,iO),r.halo.body){const o=s.halo.width.get(n),a=+(s.halo.scalingMethod.get(n)==="scaled");i.halo.widthScaled=o*a,i.halo.widthFixed=o*(1-a),gm(r.halo,i,oO)}r.outline.body&&(i.outline.color=s.outline.color.get(n),i.outline.minVisibleSize=s.outline.minVisibleSize.get(n),gm(r.outline,i,aO))}function gm(e,t,n){n(e.body,t,tf,t.shape.body),e.head&&n(e.head,t,jy,t.shape.head),e.tail&&n(e.tail,t,Hy,t.shape.tail)}function NE(e,t,n,s,r,i,o){if(r.text&&i.content){const a=s,u=a.scaling.get(n);if(i.font=t.fontManager.getFont(a.font.get(n)),i.color=Kr(a.color.get(n),o.color),i.position=a.position?a.position.get(n):Gd,i.style=a.style.get(n),i.minVisibleSize=a.minVisibleSize.get(n),i.margin=a.margin.get(n),i.padding=a.padding.get(n),i.maxLineLength=a.maxLineLength.get(n),i.content=Ky(i.content,i.maxLineLength),i.adjustAngle=a.adjustAngle.get(n),i.align=a.align.get(n),u){const c=a.scale.get(n);i.sizeScaled=o.widthScaled*c,i.sizeFixed=o.widthFixed*c}else i.sizeFixed=a.size.get(n),i.sizeScaled=0;const d=e.measureText(i.content,i.font,i.style);i.widthScaled=d.width*i.sizeScaled,i.widthFixed=d.width*i.sizeFixed,i.heightScaled=d.height*i.sizeScaled,i.heightFixed=d.height*i.sizeFixed,i.offsetAngle=i===o.texts.primary?LF:NF,lO(r.text,i,o),r.background&&uO(r.background,i,o)}}function IE(e,t){fm(e.body,t,!0,!0),fm(e.outline,t,t.outline.enabled,!0),fm(e.halo,t,!!t.halo.color,!1),kE(e.texts.primary,t.texts.primary),kE(e.texts.secondary,t.texts.secondary)}function fm(e,t,n,s){e.body=n,e.head=n&&s&&!!t.shape.head,e.tail=n&&s&&!!t.shape.tail}function kE(e,t){e.text=!t.hidden&&!!t.content,e.background=e.text&&!!t.backgroundColor}function ME(e,t,n,s,r,i){pO(e,t,n,s,r,i),PE(e,t.texts.primary,n.text,s,t),PE(e,t.texts.secondary,n.text.secondary,s,t)}function pO(e,t,n,s,r,i){const o=r.source,a=r.target,u=n.source.get(s),d=n.target.get(s),c=o.x.get(u),g=o.y.get(u),f=o.radius.get(u),p=o.innerStroke.width.get(u),_=+(o.innerStroke.color.get(u)!==null),y=+(o.innerStroke.scalingMethod.get(u)==="scaled"),x=o.outerStroke.width.get(u),E=+(o.outerStroke.color.get(u)!==null),b=+(o.outerStroke.scalingMethod.get(u)==="scaled"),S=o.color.get(u),A=+(o.scalingMethod.get(u)==="scaled"),C=a.x.get(d),k=a.y.get(d),M=a.radius.get(d),R=a.innerStroke.width.get(d),O=+(a.innerStroke.color.get(d)!==null),j=+(a.innerStroke.scalingMethod.get(d)==="scaled"),z=a.outerStroke.width.get(d),X=+(a.outerStroke.color.get(d)!==null),oe=+(a.outerStroke.scalingMethod.get(d)==="scaled"),re=a.color.get(d),Q=+(a.scalingMethod.get(d)==="scaled"),he=hO(n.color.get(s),S,re),fe=n.width.get(s),ae=n.scalingMethod.get(s)==="scaled"?1:0,me=n.stroke.width.get(s),we=n.stroke.scalingMethod.get(s)==="scaled"?1:0,Z=IF[n.shape.style.get(s)],_e=n.adjustAnchors.get(s);if(t.source=u,t.target=d,t.sourceX=c,t.sourceY=g,t.targetX=C,t.targetY=k,t.sourceRadiusScaled=p*_*y+x*E*b+f*A,t.sourceRadiusFixed=p*_*(1-y)+x*E*(1-b)+f*(1-A),t.targetRadiusScaled=R*O*j+z*X*oe+M*Q,t.targetRadiusFixed=R*O*(1-j)+z*X*(1-oe)+M*(1-Q),t.widthScaled=fe*ae,t.widthFixed=fe*(1-ae),t.curvature=n.curvature.get(s),t.isSelfLoop=u===d,t.color=he,t.opacity=n.opacity.get(s),t.minVisibleSize=n.minVisibleSize.get(s),t.shape.body=n.shape.body.get(s),t.shape.head=n.shape.head.get(s),t.shape.tail=n.shape.tail.get(s),t.shape.dashLength=Z.dash,t.shape.gapLength=Z.gap,t.shape.isBodyTriangle=t.shape.body==="triangle",t.stroke.color=Kr(n.stroke.color.get(s),he),t.stroke.widthScaled=me*we,t.stroke.widthFixed=me*(1-we),t.stroke.minVisibleSize=n.stroke.minVisibleSize.get(s),t.halo.color=n.halo.color.get(s),t.outline.enabled=n.outline.enabled.get(s),t.textHidden=n.textHidden.get(s)===1,_e&&(t.shape.head||t.shape.tail||t.shape.body==="triangle")){const ze=t,Re=ze.curvature,We=ze.sourceX,st=ze.sourceY,ft=ze.targetX,ut=ze.targetY;let ce=1,be=1;if(Re){if(!ze.isSelfLoop){const qe=uf(We,st,ft,ut,Re/2);ce=fc(ze,i,o,u,We,st,qe.x,qe.y),be=fc(ze,i,a,d,ft,ut,qe.x,qe.y)}}else ce=fc(ze,i,o,u,We,st,ft,ut),be=fc(ze,i,a,d,ft,ut,We,st);t.sourceRadiusScaled*=ce,t.sourceRadiusFixed*=ce,t.targetRadiusScaled*=be,t.targetRadiusFixed*=be}}function PE(e,t,n,s,r){t.hidden=r.textHidden,t.content=e.formatText(n.content.get(s)),t.backgroundColor=Kr(n.backgroundColor.get(s),r.color)}function fc(e,t,n,s,r,i,o,a){const u=t.angle||0;let d,c=Math.atan2(a-i,o-r)-u,g=1,f=0;c<-Ir?c+=rd:c>Ir&&(c-=rd),c<-Ir/2?(f=AT,d=n.badges.topLeft):c<0?(f=wT,d=n.badges.topRight):c<Ir/2?(f=CT,d=n.badges.bottomRight):(f=TT,d=n.badges.bottomLeft),f+=u;const p=d.text.content&&d.text.content.get(s),_=d.image.url&&d.image.url.get(s);if(dO(p)||_){const y=d.positionScale.get(s),x=d.scale.get(s),E=B1(o,a,r,i,r+Math.cos(f)*y,i+Math.sin(f)*y,x);if(E){const b=E.x-r,S=E.y-i,A=Math.sqrt(b*b+S*S);g=Math.max(g,A)}}if(n.shape.get(s)==="square"){const y=Math.abs(Math.cos(c)),x=Math.abs(Math.sin(c)),E=1/Math.max(y,x);g=Math.max(g,E)}return g}function RE(){return{source:0,target:0,sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:!1,color:"",opacity:0,minVisibleSize:0,shape:{body:"line",head:null,tail:null,dashLength:0,gapLength:0,isBodyTriangle:!1},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:!1,color:"",minVisibleSize:0},textHidden:!1,texts:{primary:FE(),secondary:FE()}}}function FE(){return{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,position:Gd,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0}}function mO(e){return e===null?e:void 0}function vs(e){return typeof e=="boolean"||e===0||e===1?e:void 0}function ya(e){return typeof e=="number"&&isFinite(e)?e:void 0}function In(e){return typeof e=="number"&&isFinite(e)&&e>=0?e:void 0}var e2=-100,_O=400,t2=e=>typeof e=="number"&&isFinite(e)&&e>=e2&&e<=_O?e:void 0;function Di(e){return e===null||typeof e=="string"||typeof e=="number"?e:void 0}function Lo(e){return e==="fixed"||e==="scaled"?e:void 0}function No(e){return Fs(e)?e:void 0}function yO(e){return e===gO||e===Gd?e:void 0}function Ms(e){return e==="inherit"||Fs(e)?e:void 0}function xO(e){return e==="source"||e==="target"||Fs(e)?e:void 0}function Tl(e){return e===null?null:typeof e=="string"?e.split(",").map(t=>{const n=t.trim(),s=n.indexOf(" ")!==-1,r=n[0];return s&&r!=='"'&&r!=="'"?`"${n}"`:n}).join(","):void 0}function Cl(e){return e==="none"?"normal":e==="normal"||e==="italic"||e==="bold"||e==="italic bold"||e==="bold italic"?e:void 0}function Sg(e){return e==="left"||e==="center"?e:void 0}function vO(e){return e==="equilateral"?"pentagon":e==="circle"||e==="square"||e==="cross"||e==="diamond"||e==="pentagon"||e==="star"?e:void 0}function bO(e){return["line","tapered","arrow","dashed","dotted"].includes(e)?e:void 0}function EO(e){return e==="line"||e==="triangle"?e:void 0}function DE(e){return[null,"arrow","circle-hole-arrow","triangle-hole-arrow","short-arrow","sharp-arrow","circle","square"].includes(e)?e:void 0}function SO(e){return e==="plain"||e==="dashed"||e==="dotted"?e:void 0}function AO(e){return e==="top"||e==="bottom"||e==="left"||e==="right"||e==="center"?e:void 0}function wO(e){if(Fs(e))return e;if(Array.isArray(e)){if(e.length<1)return;for(let t=0;t<e.length;++t)if(!Fs(e[t]))return;return e}}function dn(e){return function(t){if(typeof t=="number")return isFinite(t)&&t>=0?t:void 0;if(typeof t!="string"||t.charAt(t.length-1)!=="%")return;const n=parseFloat(t);return isNaN(n)?void 0:e*n/100}}function ox(){return{edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0}}function vd(e,t=ox()){const n=(e-e2)*Yy+Wy;return t.edgeHalo=bF,t.nodeHaloStroke=vT,t.nodeHalo=bT,t.edgeBody=n+ET,t.edgeTextBackground=n+EF,t.edgeText=n+SF,t.nodeBody=n+Xy,t.nodeTextBackground=n+AF,t.nodeText=n+wF,t}var TO=(e,t)=>{t.halo.body=t.halo.body||e.halo.body,t.halo.head=t.halo.head||e.halo.head,t.halo.tail=t.halo.tail||e.halo.tail,t.outline.body=t.outline.body||e.outline.body,t.outline.head=t.outline.head||e.outline.head,t.outline.tail=t.outline.tail||e.outline.tail,t.body.body=t.body.body||e.body.body,t.body.head=t.body.head||e.body.head,t.body.tail=t.body.tail||e.body.tail;const n=t.texts,s=e.texts;n.primary.text=n.primary.text||s.primary.text,n.primary.background=n.primary.background||s.primary.background,n.secondary.text=n.secondary.text||s.secondary.text,n.secondary.background=n.secondary.background||s.secondary.background},n2=e=>(t,n)=>{n.halo.body=t.halo.body[e],n.halo.head=t.halo.head[e],n.halo.tail=t.halo.tail[e],n.outline.body=t.outline.body[e],n.outline.head=t.outline.head[e],n.outline.tail=t.outline.tail[e],n.body.body=t.body.body[e],n.body.head=t.body.head[e],n.body.tail=t.body.tail[e],n.texts.primary.text=t.texts.primary.text[e],n.texts.primary.background=t.texts.primary.background[e],n.texts.secondary.text=t.texts.secondary.text[e],n.texts.secondary.background=t.texts.secondary.background[e]},CO=n2("start"),LO=n2("end"),NO=class{constructor({engine:e,imageManager:t,fontManager:n,formatText:s,view:r,attributes:i,attributesPrev:o,nodeAttributes:a,nodeAttributesPrev:u}){this._fullComponents=Mu(),this._startComponents=Mu(),this._endComponents=Mu(),this._startFlags=Mu(),this._endFlags=Mu(),this._startInput=RE(),this._endInput=RE(),this._depthInfo=ox(),this._nullElt={id:-1,valid:!0},this._engine=e,this._view=r,this._helper={imageManager:t,fontManager:n,formatText:s},this._attributes=i,this._attributesPrev=o,this._nodeAttributes=a,this._nodeAttributesPrev=u,this._layers=OE(()=>e.createGroup()),this._blockIds=OE(()=>0)}drawEdge(e){if(this._computeBlockIds(e),this._attributes.excluded.get(e))return this._freeBlocks();const t=this._engine,n=this._helper,s=-e,r=this._attributes,{bentEnable:i,bentVertical:o}=t.getBentEdges(),a=vd(r.layer.get(e)-(r.detectable.get(e)?0:.5),this._depthInfo),u=r.source.get(e),d=r.target.get(e),c=r.curvature.get(e),g=this._attributesPrev.curvature.get(e),f=r.animationDuration.get(e),p=r.animationStart.get(e),_=r.animationEasing.get(e),y=f>0,x=c!==0||y&&g!==0||this._engine.getBentEdges().bentEnable;this._prepareBlocks(y,a,s,x);const E=this._extremitiesAttributes={source:this._nodeAttributes,target:this._nodeAttributes};if(ME(n,this._endInput,r,e,E,this._view),IE(this._endFlags,this._endInput),y){const b=this._nodeAttributes.animationDuration.get(u)>0,S=this._nodeAttributes.animationDuration.get(d)>0;E.source=b?this._nodeAttributesPrev:this._nodeAttributes,E.target=S?this._nodeAttributesPrev:this._nodeAttributes,ME(n,this._startInput,this._attributesPrev,e,E,this._view),IE(this._startFlags,this._startInput),TO(this._endFlags,this._startFlags)}this._initComponents(this._fullComponents,this._endFlags,this._layers),LO(this._fullComponents,this._endComponents),this._endComponents.body.body.bentEnable=i,this._endComponents.body.body.bentVertical=o,this._endComponents.body.head&&(this._endComponents.body.head.bentEnable=i,this._endComponents.body.head.bentVertical=o),this._endComponents.body.tail&&(this._endComponents.body.tail.bentEnable=i,this._endComponents.body.tail.bentVertical=o),LE(t,n,e,this._attributes,this._endComponents,this._endInput),this._endComponents.texts.primary.text&&(this._endComponents.texts.primary.background.bentEnable=i,this._endComponents.texts.primary.background.bentVertical=o,this._endComponents.texts.primary.text.bentEnable=i,this._endComponents.texts.primary.text.bentVertical=o),this._endComponents.texts.secondary.text&&(this._endComponents.texts.secondary.background.bentEnable=i,this._endComponents.texts.secondary.background.bentVertical=o,this._endComponents.texts.secondary.text.bentEnable=i,this._endComponents.texts.secondary.text.bentVertical=o),y&&(CO(this._fullComponents,this._startComponents),LE(t,n,e,this._attributesPrev,this._startComponents,this._startInput),this._setBlocksAnimation(f,p,_)),this._setupHaloMasking(u,d),this._storeBlocks()}_setupHaloMasking(e,t){const n=this._nodeAttributes.halo,s=this._layers,r=n.color.get(e)&&n.hideNonAdjacentEdges.get(e),i=n.color.get(t)&&n.hideNonAdjacentEdges.get(t),o=!r&&!i?yT:wl;s.body.stencilUsage=s.text.stencilUsage=s.textBg.stencilUsage=o}_computeBlockIds(e){const t=e*sf,n=this._blockIds;n.body=t+mF,n.halo=t+xF,n.text=t+_F,n.textBg=t+yF}_prepareBlocks(e,t,n,s){const r=this._layers;r.body.reset(s?Eg:Wr,e,t.edgeBody,n),r.halo.reset(s?Eg:Wr,e,t.edgeHalo,n),r.text.reset(pa,e,t.edgeText,n),r.textBg.reset(Wr,e,t.edgeTextBackground,n)}_storeBlocks(){const e=this._engine,t=this._layers,n=this._blockIds;e.storeGroup(n.body,t.body),e.storeGroup(n.halo,t.halo),e.storeGroup(n.text,t.text),e.storeGroup(n.textBg,t.textBg)}_freeBlocks(){const e=this._engine,t=this._blockIds;e.freeBlock(t.body),e.freeBlock(t.halo),e.freeBlock(t.text),e.freeBlock(t.textBg)}_setBlocksAnimation(e,t,n){const s=this._layers;s.body.setGlobalAnimation(e,t,n),s.halo.setGlobalAnimation(e,t,n),s.text.setGlobalAnimation(e,t,n),s.textBg.setGlobalAnimation(e,t,n)}_initComponents(e,t,n){this._initEdgeComponents(e.halo,t.halo,n.halo),this._initEdgeComponents(e.outline,t.outline,n.body),this._initEdgeComponents(e.body,t.body,n.body),this._initTextComponents(e.texts.primary,t.texts.primary,n),this._initTextComponents(e.texts.secondary,t.texts.secondary,n)}_initEdgeComponents(e,t,n){e.head=this._nextElement(t.head,n),e.tail=this._nextElement(t.tail,n),e.body=this._nextElement(t.body,n)}_initTextComponents(e,t,n){e.background=this._nextElement(t.background,n.textBg),e.text=this._nextElement(t.text,n.text)}_nextElement(e,t){return e?t.next():this._nullElt}};function OE(e){return{body:e(),halo:e(),text:e(),textBg:e()}}function Mu(){return{halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}}}function IO(e,t,n){s2(e,t,n),t.imageContent!==null?(e.pattern.type=Io,e.pattern.attributes.image=t.imageContent,e.pattern.attributes.scaled=!0,e.pattern.attributes.duplicated=!1,e.patternScale=t.imageScale,e.patternMinVisibleSize=0,e.patternColor=null):(e.fillColor=null,e.strokeColor=null)}function kO(e,t,n){s2(e,t,n),t.textContent&&(e.pattern.type=_a,e.pattern.attributes.text=t.textContent,e.pattern.attributes.font=t.textFont,e.pattern.attributes.style=t.textStyle,e.pattern.attributes.paddingLeft=t.scale*t.textPaddingLeft*2,e.pattern.attributes.paddingTop=t.scale*t.textPaddingTop*2,e.pattern.attributes.size=Rd,e.patternMinVisibleSize=0,e.patternColor=t.textColor,e.patternScale=t.textScale,e.isBadge=!0),!t.imageUrl&&t.textContent||(e.fillColor=null,e.strokeColor=null)}function s2(e,t,n){const s=n.diameterScaled*t.scale,r=n.diameterFixed*t.scale,i=n.diameterScaled*t.positionScale/2,o=n.diameterFixed*t.positionScale/2;e.pieceId=Pr,e.shape="circle",e.x1=n.x,e.y1=n.y,e.x2=n.x,e.y2=n.y,e.rectWidthOrSourceRadiusScaled=s,e.rectWidthOrSourceRadiusFixed=r,e.rectHeightOrTargetRadiusScaled=s,e.rectHeightOrTargetRadiusFixed=r,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=t.strokeWidthScaled,e.strokeWidthFixed=t.strokeWidthFixed,e.offsetScaled=i,e.offsetFixed=o,e.pattern.type=Ds,e.opacity=n.opacity,e.fillColor=t.color,e.strokeColor=t.strokeColor,e.patternColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=t.angle,e.patternScale=0,e.symbolicSize=n.diameterScaled,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function MO(e,t,n){df(e,t),e.fillColor=Array.isArray(t.color)?null:t.color,e.strokeColor=t.innerStroke.color,e.strokeMinVisibleSize=t.innerStroke.minVisibleSize,e.strokeWidthScaled=t.innerStroke.widthScaled,e.strokeWidthFixed=t.innerStroke.widthFixed,n&&(e.pattern.type=Ds)}function df(e,t){e.pieceId=Pr,e.x1=t.x,e.y1=t.y,e.x2=t.x,e.y2=t.y,e.rectWidthOrSourceRadiusScaled=t.diameterScaled,e.rectWidthOrSourceRadiusFixed=t.diameterFixed,e.rectHeightOrTargetRadiusScaled=t.diameterScaled,e.rectHeightOrTargetRadiusFixed=t.diameterFixed,e.shape=t.shape,e.opacity=t.opacity,e.symbolicSize=t.diameterScaled,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.fillColor=null,e.strokeColor=null,e.globalMinVisibleSize=0,e.strokeMinVisibleSize=0,e.offsetAngle=0,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function PO(e,t){const n=t.diameterScaled+2*t.halo.widthScaled,s=t.diameterFixed+2*t.halo.widthFixed;e.pieceId=Pr,e.shape="circle",e.x1=t.x,e.y1=t.y,e.x2=t.x,e.y2=t.y,e.rectWidthOrSourceRadiusScaled=n,e.rectWidthOrSourceRadiusFixed=s,e.rectHeightOrTargetRadiusScaled=n,e.rectHeightOrTargetRadiusFixed=s,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.pattern.type=Ds,e.opacity=t.opacity,e.fillColor=t.halo.color,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=0,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=0,e.patternScale=0,e.symbolicSize=t.diameterScaled,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function RO(e,t){const n=t.diameterScaled+2*t.halo.widthScaled,s=t.diameterFixed+2*t.halo.widthFixed;e.pieceId=Pr,e.shape="circle",e.x1=t.x,e.y1=t.y,e.x2=t.x,e.y2=t.y,e.rectWidthOrSourceRadiusScaled=n,e.rectWidthOrSourceRadiusFixed=s,e.rectHeightOrTargetRadiusScaled=n,e.rectHeightOrTargetRadiusFixed=s,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=t.halo.strokeWidthScaled,e.strokeWidthFixed=t.halo.strokeWidthFixed,e.offsetScaled=0,e.offsetFixed=0,e.pattern.type=Ds,e.opacity=t.opacity,e.fillColor=null,e.strokeColor=t.halo.strokeColor,e.patternColor=null,e.globalMinVisibleSize=0,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=0,e.patternScale=0,e.symbolicSize=t.diameterScaled,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function FO(e,t){df(e,t),e.pattern.type=ma,e.pattern.attributes.text=t.icon.content,e.pattern.attributes.font=t.icon.font,e.pattern.attributes.style=t.icon.style,e.pattern.attributes.size=Rd,e.patternMinVisibleSize=t.icon.minVisibleSize,e.patternColor=t.icon.color,e.patternScale=t.icon.scale}function DO(e,t){const n=t.image.fit&&!t.image.tile;df(e,t),e.pattern.type=Io,e.pattern.attributes.image=t.image.content,e.pattern.attributes.scaled=n,e.pattern.attributes.duplicated=t.image.tile,e.patternScale=n?t.image.scale:0,e.patternMinVisibleSize=t.image.minVisibleSize,e.patternColor=null}function OO(e,t){const n=t.diameterScaled+2*t.innerStroke.widthScaled,s=t.diameterFixed+2*t.innerStroke.widthFixed;e.pieceId=Pr,e.shape=t.shape,e.x1=t.x,e.y1=t.y,e.x2=t.x,e.y2=t.y,e.rectWidthOrSourceRadiusScaled=n,e.rectWidthOrSourceRadiusFixed=s,e.rectHeightOrTargetRadiusScaled=n,e.rectHeightOrTargetRadiusFixed=s,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=t.outerStroke.widthScaled,e.strokeWidthFixed=t.outerStroke.widthFixed,e.offsetScaled=0,e.offsetFixed=0,e.pattern.type=Ds,e.opacity=t.opacity,e.fillColor=null,e.strokeColor=t.outerStroke.color,e.patternColor=null,e.globalMinVisibleSize=t.outerStroke.minVisibleSize,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=0,e.patternScale=0,e.symbolicSize=t.diameterScaled,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function zO(e,t){const n=t.diameterScaled*eE,s=t.diameterFixed*eE;let r=t.diameterScaled*tE,i=t.diameterFixed*tE+TF;t.outerStroke.color&&(r+=t.outerStroke.widthScaled/2,i+=t.outerStroke.widthFixed/2),e.pieceId=Pr,e.shape=t.shape,e.x1=t.x,e.y1=t.y,e.x2=t.x,e.y2=t.y,e.rectWidthOrSourceRadiusScaled=n,e.rectWidthOrSourceRadiusFixed=s,e.rectHeightOrTargetRadiusScaled=n,e.rectHeightOrTargetRadiusFixed=s,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=r,e.offsetFixed=i,e.pattern.type=Ds,e.opacity=t.opacity,e.fillColor=t.outline.color,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=t.outline.minVisibleSize,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=1.5707963267948966,e.patternScale=0,e.symbolicSize=t.diameterScaled,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function BO(e,t){df(e,t),Array.isArray(t.color)&&(e.pattern.type=Ud,e.pattern.attributes.colors=t.color.join(";"),e.patternScale=1,e.patternMinVisibleSize=0,e.patternColor=null)}function UO(e,t,n){r2(e,t,n),e.pattern.type=Ro,e.pattern.attributes.text=t.content,e.pattern.attributes.font=t.font,e.pattern.attributes.style=t.style,e.pattern.attributes.align=t.align,e.patternMinVisibleSize=0,e.patternColor=t.color,e.thicknessOrFontSizeScaled=t.sizeScaled,e.thicknessOrFontSizeFixed=t.sizeFixed,e.isText=!0}function GO(e,t,n){r2(e,t,n),e.fillColor=t.backgroundColor,e.pieceId=ha,e.shape="square"}function VO(e,t,n){const s=Math.ceil(t.margin/2),r=n.diameterScaled/2,i=n.diameterFixed/2+s,o=MF[t.position],a=Math.cos(o),u=Math.sin(o),d=t.margin<12?1:t.margin<30?1-(t.margin-12)/18*.7:.25;e.pieceId=Pr,e.shape="triangle",e.x1=n.x-a,e.y1=n.y-u,e.x2=n.x+a,e.y2=n.y+u,e.rectWidthOrSourceRadiusScaled=0,e.rectWidthOrSourceRadiusFixed=t.margin,e.rectHeightOrTargetRadiusScaled=0,e.rectHeightOrTargetRadiusFixed=t.margin*d,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=r,e.offsetFixed=i,e.pattern.type=Ds,e.opacity=n.opacity,e.fillColor=t.backgroundColor,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=t.positionAngle,e.patternScale=0,e.symbolicSize=n.diameterScaled,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1}function r2(e,t,n){let s=0,r=0;if(t.isPositionCenter||(s+=n.diameterScaled/2,r+=n.diameterFixed/2+t.margin+t.padding),t.isPositionVertical){if(s+=t.heightScaled/2,r+=t.heightFixed/2,t===n.texts.secondary&&n.texts.primary.position==="bottom"){const o=n.texts.primary;s+=o.heightScaled,r+=o.heightFixed+o.margin+2*o.padding}}else t.isPositionHorizontal&&(s+=t.widthScaled/2,r+=t.widthFixed/2);const i=Rd;e.pieceId=Pr,e.shape="square",e.x1=n.x,e.y1=n.y,e.x2=n.x,e.y2=n.y,e.rectWidthOrSourceRadiusScaled=t.widthScaled,e.rectWidthOrSourceRadiusFixed=t.widthFixed+2*t.padding,e.rectHeightOrTargetRadiusScaled=t.heightScaled,e.rectHeightOrTargetRadiusFixed=t.heightFixed+2*t.padding,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=s,e.offsetFixed=r,e.pattern.type=Ds,e.pattern.attributes.size=i,e.opacity=n.opacity,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=t.positionAngle,e.patternScale=1,e.symbolicSize=n.diameterScaled,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function zE(e,t,n,s,r,i){const o=r.badges,a=s.badges,u=i.badges;jO(e,t,n,s,r,i),BE(e,t,n,s.text,r.texts.primary,i.texts.primary,i),BE(e,t,n,s.text.secondary,r.texts.secondary,i.texts.secondary,i),pc(e,t,n,a.topLeft,o.topLeft,u.topLeft,i),pc(e,t,n,a.topRight,o.topRight,u.topRight,i),pc(e,t,n,a.bottomLeft,o.bottomLeft,u.bottomLeft,i),pc(e,t,n,a.bottomRight,o.bottomRight,u.bottomRight,i)}function jO(e,t,n,s,r,i){if(r.halo){const o=s.halo.width.get(n),a=+(s.halo.scalingMethod.get(n)==="scaled");i.halo.widthScaled=o*a,i.halo.widthFixed=o*(1-a),PO(r.halo,i),r.haloStroke&&(i.halo.strokeWidthScaled=0,i.halo.strokeWidthFixed=s.halo.strokeWidth.get(n),RO(r.haloStroke,i))}if(r.outline&&(i.outline.color=s.outline.color.get(n),i.outline.minVisibleSize=s.outline.minVisibleSize.get(n),zO(r.outline,i)),r.outerStroke&&(i.outerStroke.minVisibleSize=s.outerStroke.minVisibleSize.get(n),OO(r.outerStroke,i)),r.pieChart&&BO(r.pieChart,i),r.image&&(i.image.content=t.imageManager.getImage(i.image.url),i.image.fit=s.image.fit.get(n),i.image.tile=s.image.tile.get(n),i.image.scale=s.image.scale.get(n),i.image.minVisibleSize=s.image.minVisibleSize.get(n),DO(r.image,i)),r.icon&&(i.icon.font=t.fontManager.getFont(s.icon.font.get(n)),i.icon.style=s.icon.style.get(n),i.icon.color=s.icon.color.get(n),i.icon.scale=s.icon.scale.get(n),i.icon.minVisibleSize=s.icon.minVisibleSize.get(n),FO(r.icon,i)),r.body){const o=!r.pieChart&&!r.image&&!r.icon;MO(r.body,i,o)}}function pc(e,t,n,s,r,i,o){if(r.image||r.text){const a=s.stroke.width.get(n),u=+(s.stroke.scalingMethod.get(n)==="scaled");i.color=Kr(s.color.get(n),o.color,i.angle),i.strokeColor=s.stroke.color.get(n),i.strokeWidthScaled=a*u,i.strokeWidthFixed=a*(1-u),i.minVisibleSize=s.minVisibleSize.get(n),i.positionScale=s.positionScale.get(n),i.scale=s.scale.get(n)}if(r.image&&(i.imageContent=t.imageManager.getImage(i.imageUrl),i.imageScale=s.image.scale.get(n),IO(r.image,i,o)),r.text){if(i.textFont=t.fontManager.getFont(s.text.font.get(n)),i.textStyle=s.text.style.get(n),i.textColor=Kr(s.text.color.get(n),o.color),i.textScale=s.text.scale.get(n),i.textPaddingTop=s.text.paddingTop.get(n),i.textPaddingLeft=s.text.paddingLeft.get(n),e.measureText(i.textContent,i.textFont,i.textStyle,i.textScale).width>1){let a=0,u=0;for(;u<i.textContent.length&&a<1;)a+=e.measureText(i.textContent[u],i.textFont,i.textStyle,i.textScale).width,u+=1;u!==i.textContent.length&&(i.textContent=i.textContent.substring(0,u-1)+"")}kO(r.text,i,o)}}function BE(e,t,n,s,r,i,o){if(r.text&&i.content){const a=s,u=a.scaling.get(n);if(i.font=t.fontManager.getFont(a.font.get(n)),i.color=Kr(a.color.get(n),o.color),i.style=a.style.get(n),i.align=a.align.get(n),i.minVisibleSize=a.minVisibleSize.get(n),i.margin=a.margin.get(n),i.padding=a.padding.get(n),i.maxLineLength=a.maxLineLength.get(n),i.content=Ky(i.content,i.maxLineLength),u){const c=a.scale.get(n);i.sizeScaled=o.diameterScaled*c,i.sizeFixed=o.diameterFixed*c}else i.sizeFixed=a.size.get(n),i.sizeScaled=0;const d=e.measureText(i.content,i.font,i.style);i.widthScaled=d.width*i.sizeScaled,i.widthFixed=d.width*i.sizeFixed,i.heightScaled=d.height*i.sizeScaled,i.heightFixed=d.height*i.sizeFixed,i.positionAngle=kF[i.position],i.isPositionCenter=i.position==="center",i.isPositionVertical=i.position==="top"||i.position==="bottom",i.isPositionHorizontal=i.position==="left"||i.position==="right",UO(r.text,i,o),r.background&&(GO(r.background,i,o),r.tip&&VO(r.tip,i,o))}}function UE(e,t){HO(e,t),GE(e.texts.primary,t.texts.primary),GE(e.texts.secondary,t.texts.secondary),mc(e.badges.topLeft,t.badges.topLeft),mc(e.badges.topRight,t.badges.topRight),mc(e.badges.bottomLeft,t.badges.bottomLeft),mc(e.badges.bottomRight,t.badges.bottomRight)}function HO(e,t){e.body=!0,e.icon=!!t.icon.content,e.image=!!t.image.url,e.pieChart=Array.isArray(t.color),e.outerStroke=!!t.outerStroke.color,e.outline=!!t.outline.enabled,e.halo=!!t.halo.color,e.haloStroke=e.halo&&!!t.halo.strokeColor}function GE(e,t){e.text=!t.hidden&&!!t.content,e.background=e.text&&!!t.backgroundColor,e.tip=e.background&&t.tip&&t.position!=="center"}function mc(e,t){e.text=!!t.textContent,e.image=!!t.imageUrl}function VE(e,t,n,s){qO(e,t,n,s),jE(e,t.texts.primary,n.text,s,t),jE(e,t.texts.secondary,n.text.secondary,s,t),_c(e,t.badges.topLeft,n.badges.topLeft,s),_c(e,t.badges.topRight,n.badges.topRight,s),_c(e,t.badges.bottomLeft,n.badges.bottomLeft,s),_c(e,t.badges.bottomRight,n.badges.bottomRight,s)}function qO(e,t,n,s){const r=+(n.scalingMethod.get(s)==="scaled"),i=2*n.radius.get(s),o=n.innerStroke.width.get(s),a=+(n.innerStroke.scalingMethod.get(s)==="scaled"),u=n.outerStroke.width.get(s),d=+(n.outerStroke.scalingMethod.get(s)==="scaled");t.x=n.x.get(s),t.y=n.y.get(s),t.shape=n.shape.get(s),t.color=n.color.get(s),t.opacity=n.opacity.get(s),t.diameterScaled=i*r,t.diameterFixed=i*(1-r),t.innerStroke.color=Kr(n.innerStroke.color.get(s),t.color),t.innerStroke.widthScaled=o*a,t.innerStroke.widthFixed=o*(1-a),t.innerStroke.minVisibleSize=n.innerStroke.minVisibleSize.get(s),t.outerStroke.color=Kr(n.outerStroke.color.get(s),t.color),t.outerStroke.widthScaled=u*d,t.outerStroke.widthFixed=u*(1-d),t.halo.color=n.halo.color.get(s),t.halo.strokeColor=n.halo.strokeColor.get(s),t.icon.content=e.formatText(n.icon.content.get(s)),t.image.url=n.image.url.get(s),t.outline.enabled=n.outline.enabled.get(s),t.textHidden=n.textHidden.get(s)===1}function jE(e,t,n,s,r){if(t.hidden=r.textHidden,t.content=e.formatText(n.content.get(s)),t.backgroundColor=Kr(n.backgroundColor.get(s),r.color),t===r.texts.primary){const i=n;t.tip=i.tip.get(s),t.position=i.position.get(s)}else t.position="bottom"}function _c(e,t,n,s){const r=n.text.content.get(s);t.textContent=e.formatText(r),t.imageUrl=n.image.url.get(s)}var yc=e=>({angle:e,color:"",scale:0,positionScale:0,minVisibleSize:0,strokeColor:"",strokeWidthScaled:0,strokeWidthFixed:0,textContent:"",textFont:"",textColor:"",textScale:0,textStyle:"none",imageUrl:"",imageContent:null,imageScale:0,textPaddingLeft:0,textPaddingTop:0}),HE=()=>({hidden:!1,content:"",position:"",backgroundColor:"",tip:!1,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",align:"left",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:!1,isPositionVertical:!1,isPositionHorizontal:!1}),qE=()=>({x:0,y:0,shape:"",color:"",opacity:0,diameterScaled:0,diameterFixed:0,innerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},outerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},icon:{content:"",font:"",color:"",scale:0,size:0,style:"none",minVisibleSize:0},image:{url:"",content:null,scale:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,color:"",strokeColor:""},outline:{enabled:!1,color:"",minVisibleSize:0},badges:{topLeft:yc(AT),topRight:yc(wT),bottomLeft:yc(TT),bottomRight:yc(CT)},textHidden:!1,texts:{primary:HE(),secondary:HE()}}),$O=(e,t)=>{t.haloStroke=t.haloStroke||e.haloStroke,t.halo=t.halo||e.halo,t.outline=t.outline||e.outline,t.outerStroke=t.outerStroke||e.outerStroke,t.body=t.body||e.body,t.pieChart=t.pieChart||e.pieChart,t.image=t.image||e.image,t.icon=t.icon||e.icon;const n=e.badges,s=t.badges;s.topLeft.text=s.topLeft.text||n.topLeft.text,s.topLeft.image=s.topLeft.image||n.topLeft.image,s.topRight.text=s.topRight.text||n.topRight.text,s.topRight.image=s.topRight.image||n.topRight.image,s.bottomLeft.text=s.bottomLeft.text||n.bottomLeft.text,s.bottomLeft.image=s.bottomLeft.image||n.bottomLeft.image,s.bottomRight.text=s.bottomRight.text||n.bottomRight.text,s.bottomRight.image=s.bottomRight.image||n.bottomRight.image;const r=e.texts,i=t.texts;i.primary.text=i.primary.text||r.primary.text,i.primary.background=i.primary.background||r.primary.background,i.primary.tip=i.primary.tip||r.primary.tip,i.secondary.text=i.secondary.text||r.secondary.text,i.secondary.background=i.secondary.background||r.secondary.background,i.secondary.tip=i.secondary.tip||r.secondary.tip},i2=e=>(t,n)=>{n.haloStroke=t.haloStroke[e],n.halo=t.halo[e],n.outline=t.outline[e],n.outerStroke=t.outerStroke[e],n.body=t.body[e],n.pieChart=t.pieChart[e],n.image=t.image[e],n.icon=t.icon[e];const s=t.badges,r=n.badges;r.topLeft.text=s.topLeft.text[e],r.topLeft.image=s.topLeft.image[e],r.topRight.text=s.topRight.text[e],r.topRight.image=s.topRight.image[e],r.bottomLeft.text=s.bottomLeft.text[e],r.bottomLeft.image=s.bottomLeft.image[e],r.bottomRight.text=s.bottomRight.text[e],r.bottomRight.image=s.bottomRight.image[e];const i=t.texts,o=n.texts;o.primary.text=i.primary.text[e],o.primary.background=i.primary.background[e],o.primary.tip=i.primary.tip[e],o.secondary.text=i.secondary.text[e],o.secondary.background=i.secondary.background[e],o.secondary.tip=i.secondary.tip[e]},WO=i2("start"),XO=i2("end"),YO=class{constructor({engine:e,imageManager:t,fontManager:n,formatText:s,attributes:r,attributesPrev:i}){this._fullComponents=Pu(),this._startComponents=Pu(),this._endComponents=Pu(),this._startFlags=Pu(),this._endFlags=Pu(),this._startInput=qE(),this._endInput=qE(),this._depthInfo=ox(),this._nodePatternAssigned=!1,this._nullElt={id:-1,valid:!0},this._engine=e,this._attributes=r,this._attributesPrev=i,this._helper={imageManager:t,fontManager:n,formatText:s},this._layers=$E(()=>e.createGroup()),this._blockIds=$E(()=>0)}drawNode(e){if(this._computeBlockIds(e),this._attributes.excluded.get(e))return this._freeBlocks();const t=this._engine,n=this._helper,s=e,r=this._attributes,i=vd(r.layer.get(e)-(r.detectable.get(e)?0:.5),this._depthInfo),o=r.animationDuration.get(e),a=o>0;if(this._prepareBlocks(a,i,s),VE(n,this._endInput,r,e),UE(this._endFlags,this._endInput),a&&(VE(n,this._startInput,this._attributesPrev,e),UE(this._startFlags,this._startInput),$O(this._endFlags,this._startFlags)),this._initComponents(this._fullComponents,this._endFlags,this._layers),XO(this._fullComponents,this._endComponents),zE(t,n,e,r,this._endComponents,this._endInput),a&&(WO(this._fullComponents,this._startComponents),zE(t,n,e,this._attributesPrev,this._startComponents,this._startInput)),a){const u=this._attributes.animationStart.get(e),d=this._attributes.animationEasing.get(e);this._setBlocksAnimation(o,u,d)}this._endFlags.halo&&this._attributes.halo.hideNonAdjacentEdges.get(e)&&(this._layers.halo.stencilUsage=this._layers.haloStroke.stencilUsage=_T),this._storeBlocks()}_computeBlockIds(e){const t=e*sf,n=this._blockIds;n.body=t+hF,n.text=t+cF,n.textBg=t+gF,n.halo=t+fF,n.haloStroke=t+pF}_prepareBlocks(e,t,n){const s=this._layers;s.body.reset(Wr,e,t.nodeBody,n),s.text.reset(pa,e,t.nodeText,n),s.textBg.reset(Wr,e,t.nodeTextBackground,n),s.halo.reset(Wr,e,t.nodeHalo,n),s.haloStroke.reset(Wr,e,t.nodeHaloStroke,n)}_storeBlocks(){const e=this._engine,t=this._layers,n=this._blockIds;e.storeGroup(n.body,t.body),e.storeGroup(n.text,t.text),e.storeGroup(n.textBg,t.textBg),e.storeGroup(n.halo,t.halo),e.storeGroup(n.haloStroke,t.haloStroke)}_freeBlocks(){const e=this._engine,t=this._blockIds;e.freeBlock(t.body),e.freeBlock(t.text),e.freeBlock(t.textBg),e.freeBlock(t.halo),e.freeBlock(t.haloStroke)}_setBlocksAnimation(e,t,n){const s=this._layers;s.body.setGlobalAnimation(e,t,n),s.text.setGlobalAnimation(e,t,n),s.textBg.setGlobalAnimation(e,t,n),s.halo.setGlobalAnimation(e,t,n),s.haloStroke.setGlobalAnimation(e,t,n)}_initComponents(e,t,n){this._nodePatternAssigned=!1,this._initBaseComponents(e,t,n),this._initBadgeComponents(e.badges.topLeft,t.badges.topLeft,n),this._initBadgeComponents(e.badges.topRight,t.badges.topRight,n),this._initBadgeComponents(e.badges.bottomLeft,t.badges.bottomLeft,n),this._initBadgeComponents(e.badges.bottomRight,t.badges.bottomRight,n),this._initTextComponents(e.texts.primary,t.texts.primary,n),this._initTextComponents(e.texts.secondary,t.texts.secondary,n)}_initBaseComponents(e,t,n){e.haloStroke=this._nextElement(t.haloStroke,n.haloStroke),e.halo=this._nextElement(t.halo,n.halo),e.outline=this._nextElement(t.outline,n.body),e.outerStroke=this._nextElement(t.outerStroke,n.body),e.body=this._nextElement(t.body,n.body),e.pieChart=this._getNodePatternElement(t.pieChart,n),e.image=this._getNodePatternElement(t.image,n),e.icon=this._getNodePatternElement(t.icon,n)}_initBadgeComponents(e,t,n){e.image=this._nextElement(t.image,n.body),e.text=this._nextElement(t.text,n.body)}_initTextComponents(e,t,n){e.background=this._nextElement(t.background,n.textBg),e.tip=this._nextElement(t.tip,n.textBg),e.text=this._nextElement(t.text,n.text)}_nextElement(e,t){return e?t.next():this._nullElt}_getNodePatternElement(e,t){return e?this._nodePatternAssigned?t.body.next():(this._nodePatternAssigned=!0,t.body.getCurrentElement()):this._nullElt}};function $E(e){return{body:e(),text:e(),textBg:e(),halo:e(),haloStroke:e()}}function Pu(){return{haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}}}function ZO({graph:e,elements:t,engine:n,imageManager:s,fontManager:r,view:i,attributes:o,boundaries:a,formatText:u}){const{nodeAttributes:d,nodeAttributesPrev:c,edgeAttributes:g,edgeAttributesPrev:f}=KO(o),{nodes:p,edges:_}=t,{maxSize:y,maxMinVisibleSize:x}=a;if(!p.size&&!_.size)return;const E=(Math.max(e.getNodeMaxIndex(),e.getEdgeMaxIndex())+1)*sf,b=y<1024?8*y:2*y,S=n.setGlobalBoundaries({maxBlockId:Co(E),maxScaledSize:Co(b),maxMinVisibleSize:Co(x),maxSymbolicSize:Co(y),maxDashLength:3,maxGapLength:1,maxPatternScale:2,maxCoord:-1/0}),A=(S?e.getNodes("_all"):p)._indexes,C=(S?e.getEdges("_all"):_)._indexes;if(A.length){const k=new YO({engine:n,imageManager:s,fontManager:r,formatText:u,attributes:d,attributesPrev:c});for(let M=0;M<A.length;++M)k.drawNode(A[M])}if(C.length){const k=new NO({engine:n,imageManager:s,fontManager:r,formatText:u,view:i,attributes:g,attributesPrev:f,nodeAttributes:d,nodeAttributesPrev:c});for(let M=0;M<C.length;++M)k.drawEdge(C[M])}}function KO(e){const t=fl(e.nodes.current,{text:{secondary:{scaling:e.nodes.current.text.scaling,maxLineLength:e.nodes.current.text.maxLineLength}}});return{nodeAttributes:t,nodeAttributesPrev:fl(e.nodes.previous,{textHidden:t.textHidden,text:{secondary:{scaling:e.nodes.previous.text.scaling,maxLineLength:e.nodes.previous.text.maxLineLength}}}),edgeAttributes:fl(e.edges.current,{text:{secondary:{scaling:e.edges.current.text.scaling,maxLineLength:e.edges.current.text.maxLineLength,adjustAngle:e.edges.current.text.adjustAngle}}}),edgeAttributesPrev:fl(e.edges.previous,{source:e.edges.current.source,target:e.edges.current.target,textHidden:e.edges.current.textHidden,text:{secondary:{scaling:e.edges.previous.text.scaling,maxLineLength:e.edges.previous.text.maxLineLength,adjustAngle:e.edges.previous.text.adjustAngle}}})}}function bd(e,t,n){const s=n.length;let r=s-1,i=!1;for(let o=0;o<s;++o)(n[o].y<t&&n[r].y>=t||n[r].y<t&&n[o].y>=t)&&(n[o].x<=e||n[r].x<=e)&&(i=i!==n[o].x+(t-n[o].y)/(n[r].y-n[o].y)*(n[r].x-n[o].x)<e),r=o;return i}function xc(e){const t=e.x*e.x+e.y*e.y;return{x:e.x/t,y:e.y/t}}function WE(e,t){let n=1/0,s=-1/0;for(let r=0,i=e.length;r<i;r++){const o=e[r],a=o.x*t.x+o.y*t.y;a<n&&(n=a),a>s&&(s=a)}return{x:n,y:s}}function QO(e,t){let n=e[1],s=e[0],r=xc({x:n.x-s.x,y:n.y-s.y}),i=r.x;r.x=-r.y,r.y=i;const o=r;n=e[2],s=e[1],r=xc({x:n.x-s.x,y:n.y-s.y}),i=r.x,r.x=-r.y,r.y=i;const a=r;n=t[1],s=t[0],r=xc({x:n.x-s.x,y:n.y-s.y}),i=r.x,r.x=-r.y,r.y=i;const u=r;return n=t[2],s=t[1],r=xc({x:n.x-s.x,y:n.y-s.y}),i=r.x,r.x=-r.y,r.y=i,[o,a,u,r]}function o2(e,t){const n=QO(e,t);for(let s=0,r=n.length;s<r;s++){const i=n[s],o=WE(e,i),a=WE(t,i);if((o.x<=a.y&&o.y>=a.x?Math.min(o.y,a.y)-Math.max(o.x,a.x):0)===0)return!1}return!0}function JO(e){let t=0,n=0;const s=e.length;if(s===0)throw new Error("Compute centroid: at least one point is required");for(let r=0;r<s;++r){const i=e[r];t+=i.x,n+=i.y}return t/=s,n/=s,{x:t,y:n}}var ez=ax(4),tz=ax(5),nz=ax(10,.4),Ag=1/3,sz=[{x:-1,y:-.3333333333333333},{x:0,y:-.3333333333333333},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:0,y:Ag},{x:-1,y:Ag}],rz=[{x:-1,y:-.3333333333333333},{x:-.55,y:-.3333333333333333},{x:-1,y:-1},{x:1,y:0},{x:-1,y:1},{x:-.55,y:Ag},{x:-1,y:Ag}],XE=[{x:-.6,y:-.3},{x:.1,y:0},{x:-.6,y:.3}],iz={circle:{getDistanceFromStrokeVertically:(e,t)=>1,getDistanceFromStrokeHorizontally:(e,t)=>1-Math.sqrt(e*e+t*t),points:[{x:0,y:0,r:1}],isSimple:!0},square:{getDistanceFromStrokeVertically:(e,t)=>.996-Math.abs(t),getDistanceFromStrokeHorizontally:(e,t)=>.996-Math.abs(e),points:[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],isSimple:!0},line:{getDistanceFromStrokeVertically:(e,t)=>1-Math.abs(t),getDistanceFromStrokeHorizontally:(e,t)=>1,points:[{x:-1,y:0},{x:1,y:0}],isSimple:!0},triangle:{getDistanceFromStrokeVertically:(e,t)=>(1-e)/2-Math.abs(t),getDistanceFromStrokeHorizontally:(e,t)=>1-Math.abs(e),points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},arrow:{getDistanceFromStrokeVertically:(e,t)=>(1-e)/2-Math.abs(t),getDistanceFromStrokeHorizontally:(e,t)=>1-Math.abs(e),points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},"circle-hole-arrow":{getDistanceFromStrokeVertically:(e,t)=>Math.min(Math.sqrt((e+.4)*(e+.4)+t*t)-.27,(1-e)/2-Math.abs(t)),getDistanceFromStrokeHorizontally:(e,t)=>1-Math.abs(e),points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:[{x:-.4,y:0,r:.3}],isSimple:!0},"triangle-hole-arrow":{getDistanceFromStrokeVertically:(e,t)=>{const n=Math.min((1-e)/2-Math.abs(t),1-Math.abs(e)),s=-a2(e,t,XE);return Math.min(n,s)},getDistanceFromStrokeHorizontally:(e,t)=>1,points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:XE,isSimple:!0},"short-arrow":Ru(sz,!1),"sharp-arrow":Ru(rz,!1),cross:{getDistanceFromStrokeVertically:(e,t)=>1,getDistanceFromStrokeHorizontally:(e,t)=>{const n=Math.abs(e),s=Math.abs(t),r=.31-Math.min(n,s),i=1-Math.max(n,s);return Math.min(r,i)},points:[{x:-1,y:.31},{x:-1,y:-.31},{x:-.31,y:-.31},{x:-.31,y:-1},{x:.31,y:-1},{x:.31,y:-.31},{x:1,y:-.31},{x:1,y:.31},{x:.31,y:.31},{x:.31,y:1},{x:-.31,y:1},{x:-.31,y:.31}],isSimple:!1},diamond:Ru(ez),pentagon:Ru(tz),star:Ru(nz)},oz=["circle","square","triangle","line"],az=["cross","diamond","pentagon","star"],lz=["arrow","triangle-hole-arrow","circle-hole-arrow","short-arrow","sharp-arrow"];function YE(e,t){for(const i of oz)pm(e,i);const n=t.nodes.current.shape.getValues(),s=t.edges.current.shape.head.getValues(),r=t.edges.current.shape.tail.getValues();for(const i of az)n.includes(i)&&pm(e,i);for(const i of lz)i&&(s.includes(i)||r.includes(i))&&pm(e,i)}function pm(e,t){e.registerShape(t,iz[t])}function a2(e,t,n){let s=1/0;const r={x:e,y:t};for(let i=0;i<n.length;++i){const o=n[i],a=n[(i+1)%n.length];s=Math.min(s,GT(r,o,a))}return s*(bd(e,t,n)?1:-1)}function ax(e,t=1){const n=-Math.PI/2+ST,s=[],r=2*Math.PI/e;let i=n;for(let o=0;o<e;++o){const a=o%2==1?t:1;s.push({x:Math.cos(i)*a,y:Math.sin(i)*a}),i+=r}return s}function Ru(e,t=!1){return{getDistanceFromStrokeVertically:()=>1,getDistanceFromStrokeHorizontally:(n,s)=>a2(n,s,e),points:e,isSimple:t}}var uz=class extends Bd{constructor(e,t){super(),this.isDummy=!0,this.width=0,this.height=0,this.namespaceURI="http://www.w3.org/1999/xhtml"}setAttribute(e,t){e==="src"&&(this.src=t),e==="crossOrigin"&&(this.crossOrigin=t)}set src(e){e&&(this._src=e,setTimeout(()=>{this.onload&&this.onload.call(this),this.width=1,this.height=1,this.fire("load")},10))}get src(){return this._src}addEventListener(e,t){this.on(e,t)}};function dz(e,t){return new(typeof Image<"u"?Image:uz)(e,t)}var hz=class{constructor(){this._images={},this._crossOrigin="anonymous",this._whenReady=[],this._onFetch=[],this._nbLoaded=0,this._nbToLoad=0}setImgCrossOrigin(e){this._crossOrigin=e}clear(){this._images={},this._nbLoaded=0,this._nbToLoad=0}getImage(e){let t=this._images[e];return t===void 0&&(this._nbToLoad+=1,t=dz(),t.crossOrigin=this._crossOrigin,t.addEventListener("load",()=>this._onImgLoad(e)),t.addEventListener("error",()=>{this._onImgLoad(e),this._images[e]=null}),kk(t,"src",e),this._images[e]=t),t}_onImgLoad(e){this._nbLoaded+=1,this._onFetch.forEach(t=>t(e)),this._nbLoaded===this._nbToLoad&&(this._whenReady.forEach(t=>t()),this._whenReady=[])}onFetch(e){this._onFetch.push(e)}whenReady(){return this._nbLoaded===this._nbToLoad?Promise.resolve():new Promise(e=>this._whenReady.push(e))}destroy(){this._whenReady=[],this._onFetch=[]}},lx={};function cz(e){let t="";for(let n=0;n<e.length;n++)t+=e[n].cssText+`
`;return t}function l2(){const e=$i(),t=e.styleSheets||[],n=c1(e),s=[],r=[];for(let o=0;o<t.length;o++){const a=t[o];a.href==null?s.push({href:n,content:cz(a.cssRules)}):r.push(a.href)}const i=/@font-face\s*\{[^}]+\}/g;return Promise.all(r.map(o=>Hl(o).then(a=>({href:o,content:a})).catch(rg))).then(o=>o.concat(s)).then(o=>{const a=[];for(let u=0;u<o.length;u++){const d=o[u];if(d!==null){const{href:c,content:g}=d,f=g.match(i);if(f){const p=fz(f,c);a.push.apply(a,p)}}}return a})}function u2(e,t){return Promise.all(e.map(({formats:n,originalRule:s})=>Promise.all(n.map(({format:r,url:i})=>t?h1(i).then(o=>({format:r,src:o})).catch(rg):{format:r,src:i})).then(r=>{const i=[];for(const o of r)o!==null&&i.push(`url('${o.src}') format('${o.format}')`);if(i.length!==0){const o=`src: ${i.join(",")}`;return s.replace(/@font-face\s*{([^}]*);?}/,`@font-face{$1;${o}}`).replace(/\s+/," ").replace(/;+/,";")}return s})))}Id(lx,{BUTTON_MAPPING:()=>Ay,BoundingBox:()=>Ws,DummyCanvas:()=>LT,DummyCanvasRenderingContext2D:()=>NT,DummyDomElement:()=>s1,DummyFileReader:()=>e1,DummyTextNode:()=>m2,DummyXHR:()=>Jw,ElementSet:()=>Vd,EventTarget:()=>Bd,FlexArray:()=>fg,IndexList:()=>w1,MOUSE_WHEEL_THROTTLE:()=>Xw,Map2:()=>mT,PathMap:()=>h2,PrioritySet:()=>tT,SVG_NS:()=>Ey,Table:()=>r_,XLINK:()=>o1,XML_NS:()=>Ym,applyCursorStyle:()=>lg,baseURI:()=>c1,binaryIndexOf:()=>fw,cancelAnimFrame:()=>Yw,clamp:()=>Mr,clearCanvas:()=>S_,componentsToRGBA:()=>gT,computeMax:()=>ml,computeMin:()=>Fi,concatenateArrays:()=>pI,createBlob:()=>gd,createCanvas:()=>Es,createDummyDomElement:()=>og,createDummyXmlDocument:()=>y2,createElement:()=>Zm,createSvgElement:()=>rn,createTextNode:()=>Sy,createWebGL2Context:()=>kT,createWorker:()=>f2,createXmlDocument:()=>x2,dataUrlToBlob:()=>r1,debounce:()=>yI,deepCopy:()=>Bn,displayPixelsOnScreen:()=>Sz,ensureTransferable:()=>jg,escapeDOMAttribute:()=>pl,extendList:()=>bI,fadeElement:()=>g1,fetch:()=>Hl,fetchBinary:()=>d1,fetchBinaryAsBase64:()=>h1,flatten:()=>cd,flattenArray:()=>gw,forEach:()=>ci,formatAngle:()=>ug,formatHex:()=>Kc,formatWorkerMessage:()=>g2,getBaseLog:()=>f1,getCurrentTime:()=>Rs,getDate:()=>vw,getDocument:()=>$i,getDocumentFontRules:()=>l2,getEmbeddedFontRules:()=>u2,getFlattenedKeys:()=>Sa,getGlContext:()=>MT,getImage:()=>a1,getLeafValues:()=>Vg,getOptions:()=>pr,getPixelRatio:()=>or,getProperty:()=>On,getResizeObserver:()=>t1,getStyle:()=>n1,getTime:()=>bw,getValues:()=>td,getWebglContext:()=>Zy,hash8:()=>qm,htmlSanitizer:()=>wy,indexArrayToArray:()=>hd,indexByName:()=>EI,insertSortAsc:()=>Gu,insertSortDesc:()=>fI,isArray:()=>bs,isBlob:()=>Hk,isHTMLElement:()=>u1,isInteger:()=>_I,isLittleEndian:()=>Gg,isObject:()=>rs,isRawObject:()=>Ea,isWebGLSupported:()=>IT,lerp:()=>un,mapKeys:()=>fT,mapValues:()=>pT,merge:()=>fl,mergeValues:()=>tg,mix:()=>Km,nextPowerOfTwo:()=>Co,objToValueList:()=>hf,parseColor:()=>Fs,parseColorHex:()=>Vy,parseColorRgba:()=>Gy,pick:()=>Wm,processQueue:()=>xI,promiseQueue:()=>mw,promptDownload:()=>Oo,propertyPathToString:()=>Hm,removeFromArray:()=>mI,requestAnimFrame:()=>xy,resizeElement:()=>ag,resolvePath:()=>d2,rgbaToRgb:()=>cl,serializeXMLDocument:()=>ux,setAttributes:()=>by,setCtxFont:()=>Fo,setElementSize:()=>wa,setKeys:()=>yz,setProperty:()=>Ui,setValues:()=>Wu,smartRequire:()=>kr,throttle:()=>Ug,toArray:()=>jm,toHexa:()=>v_,toPropertyPath:()=>ba,traverse:()=>yw,unflatten:()=>$m,unorderedHash:()=>vI,workerIsAvailable:()=>c2});var gz={"embedded-opentype":!0,svg:!0};function fz(e,t){const n=/url\(['"]?([^'")]+)['"]?\)\s+format\(['"]?([^'")]+)['"]?\)/g,s=/font-family\s*:\s*['"]?([^;'"]+)['"]?;/,r=[];for(let i=0;i<e.length;i++){const o=e[i],a=o.match(s);if(a){const u=a[1],d=[];let c;for(;c=n.exec(o);){const g=c[1],f=c[2];gz[f.toLowerCase()]||d.push({format:f,url:d2(g,t)})}r.push({name:u,formats:d,originalRule:o})}}return r}function d2(e,t){if(/^http(s)?:/.test(e))return e;if(e[0]==="/"){const r=t.match(/((\w+:\/\/)([^/]+))/);return r?r[1]+e:e}const n=e.split("/"),s=t.split("/");for(t[t.length-1]!=="/"&&s.pop();n[0]==="..";)n.shift(),s.pop();return s.concat(n).join("/").replace(/[\w](\/{2,})/g,r=>r[0]+"/")}function pz(e){return e instanceof RegExp||e instanceof Date}var mz=typeof HTMLElement>"u"?e=>!1:e=>e instanceof HTMLElement,_z=function(e){return typeof e!="object"||e===null||bs(e)||pz(e)};function hf(e,t=[],n=[]){if(!mz(e)){if(_z(e))t.push({path:n.slice(),value:e});else{const s=Object.keys(e);for(let r=0;r<s.length;++r){const i=s[r],o=n.slice();o.push(i),hf(e[i],t,o)}}return t}}var h2=class{constructor(){this._keys=[],this._values=[],this._size=0,this._cachedPath=[],this._cachedIndex=-1}get size(){return this._size}set(e,t){const n=this._getIndex(e);n!==-1?this._values[n]=t:(mm(this._cachedPath,e)&&(this._cachedIndex=this._keys.length),this._keys.push(e),this._values.push(t),this._size+=1)}get(e){const t=this._getIndex(e);if(t!==-1)return this._values[t]}has(e){return this._getIndex(e)!==-1}keys(){return this._keys.slice()}_getIndex(e){if(mm(e,this._cachedPath))return this._cachedIndex;this._cachedPath=e.slice();const t=this._keys;for(let n=0;n<t.length;++n)if(mm(t[n],e))return this._cachedIndex=n,n;return this._cachedIndex=-1,-1}};function mm(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}var C_,yz=function(t){return Array.from(t.keys())},Wu=function(t){return Array.from(t.values())},Ed=kr("web-worker"),c2=!!Ed||typeof Worker<"u"&&typeof Blob<"u";function g2(e){return Ed?L_(e):e}function L_(e){if(ArrayBuffer.isView(e))return Array.from(e);if(Array.isArray(e)){for(let t=0;t<e.length;t++)e[t]=L_(e[t]);return e}if(rs(e)){const t=Object.keys(e);for(const n of t)e[n]=L_(e[n]);return e}return e}function f2(e){return Ed?vz(e.toString()):xz(e)}function xz(e){return Mk(fk(e))}function vz(e){if(Ed)return new Ed("data:application/javascript,"+e.replace(/\n/g,""))}var ZE=kr("@xmldom/xmldom");C_=typeof XMLSerializer<"u"?XMLSerializer:ZE?ZE.XMLSerializer:null;var bz=class p2{constructor(t){this._attributes={},this._children=[],this._name=t}setAttribute(t,n){this._attributes[t]=n}appendChild(t){this._children.push(t)}get tagName(){return this._name}get children(){return this._children}get childNodes(){return this._children}get firstChild(){return this._children[0]||null}serialize(){const t=this._name,n=this._attributes,s=this._children,r=Object.keys(n).filter(o=>n[o]!==void 0).map(o=>` ${o}="${""+n[o]}"`).join(""),i=s.map(o=>o.serialize()).join("");return i.length?`<${t}${r}>${i}</${t}>`:`<${t}${r}/>`}cloneNode(t){const n=new p2(this._name),s=Object.keys(this._attributes);for(const r of s)n.setAttribute(r,this._attributes[r]);if(t)for(let r=0;r<this._children.length;r++)n.appendChild(this._children[r].cloneNode(t));return n}},m2=class _2{constructor(t){this._text=t}serialize(){return this._text}cloneNode(){return new _2(this._text)}},Ez=class{constructor(){this._children=[],this._meta=[],this._children=[],this._meta=[]}appendChild(e){this._children.push(e)}serialize(){return this._meta.concat(this._children.map(e=>e.serialize())).join("")}createElement(e){return new bz(e)}createTextNode(e){return new m2(e)}},y2=()=>new Ez;function ux(e){if(C_)return new C_().serializeToString(e)}var x2=()=>$i().implementation.createDocument("","",null),Vd=class{constructor(e,t){this._graph=e,this._nodes={elementList:e.nodeList,flexArray:e.createNodeAttribute({storage:1,name:t},!!t),indexList:e.createIndexList(!0)},this._edges={elementList:e.edgeList,flexArray:e.createEdgeAttribute({storage:1,name:t},!!t),indexList:e.createIndexList(!1)}}_get(e){return e.isNode?this._nodes:this._edges}addOrRemoveElements(e,t){return t?this.addElements(e):this.removeElements(e)}addElements(e){const{elementList:t,flexArray:n,indexList:s}=this._get(e),r=s.getLength();for(let i=0;i<e._indexes.length;i++){const o=e._indexes[i];n.get(o)!==1&&(n.set(o,1),s.pushUnchecked(o))}return t(s.slice(r))}removeElements(e){const{elementList:t,flexArray:n,indexList:s}=this._get(e),r=s.getLength(),i=s.getBuffer();if(r>i.length)return this.clear(),this.addElements(e),e;let o=0;for(let a=0;a<e._indexes.length;a++){const u=e._indexes[a];n.get(u)!==0&&(n.set(u,0),o+=1)}if(o===r)return t(s.sliceAndReset());if(o===0)return t();{const a=this._graph.acquireIndexList(e.isNode);let u=0;for(let d=0;d<r;++d){const c=i[d];n.get(c)===0?(u+=1,a.pushUnchecked(c)):i[d-u]=c}return s.setLength(r-o),t(a.sliceAndReset())}}hasElement(e){return!!this._get(e).flexArray.get(e._index)}clear(){this._nodes.indexList.isEmpty()||(this._nodes.indexList.reset(),this._nodes.flexArray.reset()),this._edges.indexList.isEmpty()||(this._edges.indexList.reset(),this._edges.flexArray.reset())}isEmpty(){return this._nodes.indexList.isEmpty()&&this._edges.indexList.isEmpty()}getElements(){return{nodes:this._nodes.elementList(this._nodes.indexList.slice()),edges:this._edges.elementList(this._edges.indexList.slice())}}};function Sz(e,t,n,s=0){t===void 0&&(t=n=Math.sqrt(e.length/4)),n===void 0&&(n=t);const r=document.createElement("canvas"),i=r.getContext("2d");if(i){const o=i.createImageData(t,n);r.style.imageRendering="pixelated",r.style.border="1px solid black",r.style.margin="2px",r.style.position="absolute",r.style.top=r.style.left="0px",r.width=t,r.height=n,o.data.set(e),i.putImageData(o,0,0);const a=document.getElementById("graph-container");a&&(a.style.position="static"),setTimeout(()=>document.body.appendChild(r),s)}}var Az=class{constructor(e,t){this._attributesManager=e,this._id=t}getDefinition(){return this._attributesManager.getAttributeLayerDefinition(this._id)}update(e){this._attributesManager.updateAttributeLayer(this._id,e)}destroy(){this._attributesManager.destroyAttributeLayer(this._id)}updateElements(e){this._attributesManager.updateElementsForAttributeLayer(this._id,e)}updateAll(){this._attributesManager.updateAllForAttributeLayer(this._id)}setAttributeValues(e,t,n){this._attributesManager.setAttributeLayerValues(this._id,e,t,n)}getUsedAttributeNames(e){return this._attributesManager.getUsedAttributeLayerAttributes(this._id,e)}getFlexArrays(){return this._attributesManager.getAttributeLayerFlexArrays(this._id)}},dx={};Id(dx,{cubicIn:()=>Lz,cubicInOut:()=>Iz,cubicOut:()=>Nz,linear:()=>wg,quadraticIn:()=>wz,quadraticInOut:()=>Cz,quadraticOut:()=>Tz});var wg=e=>e,wz=e=>e*e,Tz=e=>e*(2-e),Cz=e=>(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1),Lz=e=>e*e*e,Nz=e=>--e*e*e+1,Iz=e=>(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2),kz={name:"animationStart",storage:32,default:0},Mz={name:"animationDuration",storage:16,default:0},Pz={name:"animationEasing",storage:"resource",default:"linear"},Rz={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentNodes:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:void 0,allEdges:void 0},Fz={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},extremities:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},parallelEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:void 0,allEdges:void 0},Dz={x:1,y:1,radius:1,"halo.hideNonAdjacentEdges":1};function ad(e){return typeof e=="string"}var qs="Arial",Do="black",Tg="rgba(255,255,255,0)",Bl=12,Sd=3,hx=7,Oz=!0,cx=10,zz=5,v2=.08,b2="rgba(255,255,255,0)",E2="normal",S2="center",A2=!1,w2=0,N_="red",T2="rgb(220, 220, 220)",C2="red",L2="rgb(220, 220, 220)",I_=1,N2="scaled",I2="grey",k2=1,M2=0,P2=0,R2=!0,F2=0,D2=!0,O2="line",z2=null,B2=null,U2="plain",G2="inherit",k_=0,V2="fixed",j2=0,H2=null,M_=10,q2="fixed",$2=1e3,W2=800,X2="rgba(0, 0, 0, 0.6)",Y2="rgba(0, 0, 0, 0)",Z2=10,K2=1,Q2=2,J2="rgba(0, 0, 0, 0.36)",eC=0,Bz=1,tC="normal",nC="center",sC=2,P_=2,rC=Gd,iC=4,oC=!0,aC=4,R_=2,F_=12,lC=2;function Uz(e,t,n){let s,r,i,o;n==="line"?(s="line",r="plain",i=null,o=null):n==="arrow"?(s="line",r="plain",i="arrow",o=null):n==="tapered"?(s="triangle",r="plain",i=null,o=null):n==="dashed"?(s="line",r="dashed",i=null,o=null):n==="dotted"&&(s="line",r="dotted",i=null,o=null),e.shape.body.set(t,s),e.shape.style.set(t,r),e.shape.head.set(t,i),e.shape.tail.set(t,o)}var uC={width:{_flexArray:I_,_check:dn(I_)},scalingMethod:{_flexArray:N2,_check:Lo},color:{_flexArray:I2,_check:xO},opacity:{_flexArray:k2,_check:In},minVisibleSize:{_flexArray:M2,_check:In},layer:{_flexArray:P2,_check:t2},detectable:{_flexArray:R2,_check:vs},curvature:{_flexArray:F2,_check:ya},adjustAnchors:{_flexArray:D2,_check:vs},shape:{_check:bO,_set:Uz,type:"shape.head",body:{_flexArray:O2,_check:EO},head:{_flexArray:z2,_check:DE},tail:{_flexArray:B2,_check:DE},style:{_flexArray:U2,_check:SO}},stroke:{color:{_flexArray:G2,_check:Ms},width:{_flexArray:k_,_check:dn(k_)},scalingMethod:{_flexArray:V2,_check:Lo},minVisibleSize:{_flexArray:j2,_check:In}},strokeWidth:"stroke.width",halo:{_alias:"halo.color",color:{_flexArray:H2,_check:No},width:{_flexArray:M_,_check:dn(M_)},scalingMethod:{_flexArray:q2,_check:Lo},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:vs},duration:{_flexArray:$2,_check:In},interval:{_flexArray:W2,_check:In},startColor:{_flexArray:X2,_check:Ms},endColor:{_flexArray:Y2,_check:Ms},width:{_flexArray:Z2,_check:In},startRatio:{_flexArray:K2,_check:In},endRatio:{_flexArray:Q2,_check:In}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:vs},color:{_flexArray:J2,_check:No},minVisibleSize:{_flexArray:eC,_check:In}},text:{_alias:"text.content",content:{_flexArray:null,_check:Di},font:{_flexArray:qs,_check:Tl},color:{_flexArray:Do,_check:No},size:{_flexArray:Bl,_check:dn(Bl)},scale:{_flexArray:1,_check:In},style:{_flexArray:tC,_check:Cl},align:{_flexArray:nC,_check:Sg},margin:{_flexArray:sC,_check:ya},padding:{_flexArray:P_,_check:dn(P_)},backgroundColor:{_flexArray:Tg,_check:Ms},minVisibleSize:{_flexArray:iC,_check:In},position:{_flexArray:rC,_check:yO},adjustAngle:{_flexArray:oC,_check:vs},scaling:{_flexArray:A2,_check:vs},maxLineLength:{_flexArray:w2,_check:In},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Di},font:{_flexArray:qs,_check:Tl},color:{_flexArray:Do,_check:No},size:{_flexArray:F_,_check:dn(F_)},scale:{_flexArray:v2,_check:In},style:{_flexArray:E2,_check:Cl},align:{_flexArray:S2,_check:Sg},margin:{_flexArray:lC,_check:ya},padding:{_flexArray:R_,_check:dn(R_)},backgroundColor:{_flexArray:b2,_check:Ms},minVisibleSize:{_flexArray:aC,_check:In}}}},dC="grey",hC="white",gx=2,cC=null,fx=5,D_=0,gC="rgba(0, 0, 0, 0.36)",Gz=1,Vz="circle",O_=12,Xu="white",vc=12,Yu="black",Sl=2,Zu="black",px=40,fC=null,pC=null,mx=1,mC="black",_C=1e3,yC=800,xC=1,vC=2,bC="rgba(0, 0, 0, 0.0)",EC="rgba(0, 0, 0, 0.6)",SC=50,jz=.1,To=12,bc=24,Ad=1,KE=Ad/2,QE=.45,JE=.7,Hz=10,AC=Hz/2,wC=5,qz=dn(wC),$z=dn(Bl),Wz=dn(cx),Xz=dn(gx),Yz=dn(fx),Zz=dn(hx),eS=dn(Sd),Kz=dn(AC),Qz=dn(px),Jz=dn(mx);function Ec(e){return{_check:Di,_set:(t,n,s)=>{t.badges[e].text.content.set(n,s),s==null&&t.badges[e].image.url.set(n,s)},_get:(t,n)=>t.badges[e].text.content.get(n),color:{_flexArray:Xu,_check:Ms},scale:{_flexArray:QE,_check:dn(QE)},positionScale:{_flexArray:1,_check:In},minVisibleSize:{_flexArray:To,_check:dn(To)},image:{_alias:`badges.${e}.image.url`,url:{_flexArray:null,_check:Di},scale:{_flexArray:Ad,_check:dn(Ad)}},stroke:{color:{_flexArray:Yu,_check:Ms},width:{_flexArray:Sl,_check:dn(Sl)},scalingMethod:{_flexArray:"fixed",_check:Lo}},text:{_alias:`badges.${e}.text.content`,content:{_flexArray:null,_check:Di},color:{_flexArray:Zu,_check:Ms},font:{_flexArray:qs,_check:Tl},style:{_flexArray:"normal",_check:Cl},scale:{_flexArray:KE,_check:dn(KE)},paddingLeft:{_flexArray:0,_check:ya},paddingTop:{_flexArray:0,_check:ya}}}}var TC={x:{_flexArray:0,_check:ya,_disableMemoryOptimization:!0},y:{_flexArray:0,_check:ya,_disableMemoryOptimization:!0},radius:{_flexArray:wC,_check:qz},scalingMethod:{_flexArray:"scaled",_check:Lo},color:{_flexArray:dC,_check:wO},opacity:{_flexArray:1,_check:In},shape:{_flexArray:"circle",_check:vO},layer:{_flexArray:0,_check:t2},detectable:{_flexArray:!0,_check:vs},draggable:{_flexArray:!0,_check:vs},layoutable:{_flexArray:!0,_check:vs},innerStroke:{_alias:"innerStroke.color",width:{_flexArray:gx,_check:Xz},scalingMethod:{_flexArray:"fixed",_check:Lo},color:{_flexArray:hC,_check:Ms},minVisibleSize:{_flexArray:O_,_check:dn(O_)}},outerStroke:{_alias:"outerStroke.color",width:{_flexArray:fx,_check:Yz},scalingMethod:{_flexArray:"fixed",_check:Lo},color:{_flexArray:cC,_check:Ms},minVisibleSize:{_flexArray:D_,_check:dn(D_)}},badges:{_check:mO,_set(e,t,n){e.badges.topLeft.text.content.set(t,n),e.badges.topLeft.image.url.set(t,n),e.badges.topRight.text.content.set(t,n),e.badges.topRight.image.url.set(t,n),e.badges.bottomLeft.text.content.set(t,n),e.badges.bottomLeft.image.url.set(t,n),e.badges.bottomRight.text.content.set(t,n),e.badges.bottomRight.image.url.set(t,n)},topLeft:Ec("topLeft"),topRight:Ec("topRight"),bottomLeft:Ec("bottomLeft"),bottomRight:Ec("bottomRight")},halo:{_alias:"halo.color",color:{_flexArray:fC,_check:No},width:{_flexArray:px,_check:Qz},scalingMethod:{_flexArray:"fixed",_check:Lo},strokeColor:{_flexArray:pC,_check:No},strokeWidth:{_flexArray:mx,_check:Jz},clustering:{_flexArray:!1,_check:vs},hideNonAdjacentEdges:{_flexArray:!1,_check:vs}},pulse:{enabled:{_flexArray:!1,_check:vs},duration:{_flexArray:_C,_check:In},interval:{_flexArray:yC,_check:In},startColor:{_flexArray:EC,_check:Ms},endColor:{_flexArray:bC,_check:Ms},width:{_flexArray:SC,_check:In},startRatio:{_flexArray:xC,_check:In},endRatio:{_flexArray:vC,_check:In}},icon:{_alias:"icon.content",content:{_flexArray:null,_check:Di},font:{_flexArray:qs,_check:Tl},color:{_flexArray:mC,_check:No},scale:{_flexArray:JE,_check:dn(JE)},style:{_flexArray:"normal",_check:Cl},minVisibleSize:{_flexArray:To,_check:dn(To)}},image:{_alias:"image.url",url:{_flexArray:null,_check:Di},scale:{_flexArray:Ad,_check:dn(Ad)},fit:{_flexArray:!0,_check:vs},tile:{_flexArray:!1,_check:vs},minVisibleSize:{_flexArray:To,_check:dn(To)}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:vs},color:{_flexArray:gC,_check:No},minVisibleSize:{_flexArray:To,_check:dn(To)}},text:{_alias:"text.content",content:{_flexArray:null,_check:Di},font:{_flexArray:qs,_check:Tl},color:{_flexArray:Do,_check:Ms},size:{_flexArray:Bl,_check:$z},scale:{_flexArray:jz,_check:In},style:{_flexArray:"normal",_check:Cl},align:{_flexArray:"center",_check:Sg},margin:{_flexArray:hx,_check:Zz},padding:{_flexArray:Sd,_check:eS},backgroundColor:{_flexArray:null,_check:Ms},tip:{_flexArray:!0,_check:vs},minVisibleSize:{_flexArray:bc,_check:dn(bc)},scaling:{_flexArray:!1,_check:vs},position:{_flexArray:"bottom",_check:AO},maxLineLength:{_flexArray:0,_check:In},truncateLength:{_flexArray:0,_check:In},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Di},font:{_flexArray:qs,_check:Tl},color:{_flexArray:Do,_check:Ms},size:{_flexArray:cx,_check:Wz},scale:{_flexArray:.08,_check:In},style:{_flexArray:"normal",_check:Cl},align:{_flexArray:"center",_check:Sg},margin:{_flexArray:AC,_check:Kz},padding:{_flexArray:Sd,_check:eS},backgroundColor:{_flexArray:null,_check:Ms},minVisibleSize:{_flexArray:bc,_check:dn(bc)}}}},eB=e=>(t,n)=>t[e].get(n),tB=(e,t)=>(n,s)=>n[e][t].get(s),nB=(e,t,n)=>(s,r)=>s[e][t][n].get(r),sB=(e,t,n,s)=>(r,i)=>r[e][t][n][s].get(i),rB=e=>(t,n,s)=>t[e].set(n,s),iB=(e,t)=>(n,s,r)=>n[e][t].set(s,r),oB=(e,t,n)=>(s,r,i)=>s[e][t][n].set(r,i),aB=(e,t,n,s)=>(r,i,o)=>r[e][t][n][s].set(i,o),lB=[eB,tB,nB,sB],uB=[rB,iB,oB,aB];function tS(e,t){if(!e._check)throw new Error(`error somewhere for ${t}`);const n=t.split("."),s=n.length-1,r=lB[s].apply(null,n),i=uB[s].apply(null,n);return{check:e._check,set:i,get:r,nested:{}}}function Cg(e,t){const n=t?TC:uC,s=typeof e=="string"?[e]:Sa(e,"",[]);let r=!1;const i=[];for(let o=0;o<s.length;o++){const a=s[o].split(".");let u=n[a[0]];for(let c=1;c<a.length;c++)u=u[a[c]];u.type&&(s[o]=u.type),u._alias&&(s[o]=u._alias),s[o]==="badges"&&(s[o]="badges.topLeft.text.content",r=!0);const d=a[a.length-1];d!=="topLeft"&&d!=="topRight"&&d!=="bottomLeft"&&d!=="bottomRight"||(s[o]=`badges.${d}.text.content`,i.push(`badges.${d}.image.url`)),s[o]==="strokeWidth"&&(s[o]="stroke.width")}return r&&(s.push("badges.topLeft.image.url"),s.push("badges.topRight.text.content"),s.push("badges.topRight.image.url"),s.push("badges.bottomLeft.text.content"),s.push("badges.bottomLeft.image.url"),s.push("badges.bottomRight.text.content"),s.push("badges.bottomRight.image.url")),s.push(...i),s}var Sc=e=>(t,n)=>({url:t.badges[e].image.url.get(n),scale:t.badges[e].image.scale.get(n)}),Ac=e=>(t,n)=>({color:t.badges[e].stroke.color.get(n),width:t.badges[e].stroke.width.get(n),scalingMethod:t.badges[e].stroke.scalingMethod.get(n)}),wc=e=>(t,n)=>({content:t.badges[e].text.content.get(n),color:t.badges[e].text.color.get(n),font:t.badges[e].text.font.get(n),style:t.badges[e].text.style.get(n),scale:t.badges[e].text.scale.get(n),paddingLeft:t.badges[e].text.paddingLeft.get(n),paddingTop:t.badges[e].text.paddingTop.get(n)}),Tc=e=>(t,n)=>({color:t.badges[e].color.get(n),scale:t.badges[e].scale.get(n),positionScale:t.badges[e].positionScale.get(n),minVisibleSize:t.badges[e].minVisibleSize.get(n),image:{url:t.badges[e].image.url.get(n),scale:t.badges[e].image.scale.get(n)},stroke:{color:t.badges[e].stroke.color.get(n),width:t.badges[e].stroke.width.get(n),scalingMethod:t.badges[e].stroke.scalingMethod.get(n)},text:{content:t.badges[e].text.content.get(n),color:t.badges[e].text.color.get(n),font:t.badges[e].text.font.get(n),style:t.badges[e].text.style.get(n),scale:t.badges[e].text.scale.get(n),paddingLeft:t.badges[e].text.paddingLeft.get(n),paddingTop:t.badges[e].text.paddingTop.get(n)}}),Eo={topLeft:Tc("topLeft"),topRight:Tc("topRight"),bottomLeft:Tc("bottomLeft"),bottomRight:Tc("bottomRight")},Vr={stroke:(e,t)=>({color:e.stroke.color.get(t),width:e.stroke.width.get(t),scalingMethod:e.stroke.scalingMethod.get(t),minVisibleSize:e.stroke.minVisibleSize.get(t)}),innerStroke:(e,t)=>({width:e.innerStroke.width.get(t),scalingMethod:e.innerStroke.scalingMethod.get(t),color:e.innerStroke.color.get(t),minVisibleSize:e.innerStroke.minVisibleSize.get(t)}),outerStroke:(e,t)=>({width:e.outerStroke.width.get(t),scalingMethod:e.outerStroke.scalingMethod.get(t),color:e.outerStroke.color.get(t),minVisibleSize:e.outerStroke.minVisibleSize.get(t)}),pulse:(e,t)=>({enabled:e.pulse.enabled.get(t),duration:e.pulse.duration.get(t),interval:e.pulse.interval.get(t),startColor:e.pulse.startColor.get(t),endColor:e.pulse.endColor.get(t),width:e.pulse.width.get(t),startRatio:e.pulse.startRatio.get(t),endRatio:e.pulse.endRatio.get(t)}),outline:(e,t)=>({enabled:e.outline.enabled.get(t),color:e.outline.color.get(t),minVisibleSize:e.outline.minVisibleSize.get(t)}),halo:(e,t)=>({color:e.halo.color.get(t),width:e.halo.width.get(t),scalingMethod:e.halo.scalingMethod.get(t),strokeColor:e.halo.strokeColor.get(t),strokeWidth:e.halo.strokeWidth.get(t),clustering:e.halo.clustering.get(t),hideNonAdjacentEdges:e.halo.hideNonAdjacentEdges.get(t)}),"text.secondary":(e,t)=>({content:e.text.secondary.content.get(t),font:e.text.secondary.font.get(t),color:e.text.secondary.color.get(t),size:e.text.secondary.size.get(t),scale:e.text.secondary.scale.get(t),style:e.text.secondary.style.get(t),align:e.text.secondary.align.get(t),margin:e.text.secondary.margin.get(t),padding:e.text.secondary.padding.get(t),backgroundColor:e.text.secondary.backgroundColor.get(t),minVisibleSize:e.text.secondary.minVisibleSize.get(t)}),text:(e,t)=>({content:e.text.content.get(t),font:e.text.font.get(t),color:e.text.color.get(t),size:e.text.size.get(t),scale:e.text.scale.get(t),style:e.text.style.get(t),align:e.text.align.get(t),margin:e.text.margin.get(t),padding:e.text.padding.get(t),backgroundColor:e.text.backgroundColor.get(t),tip:e.text.tip.get(t),minVisibleSize:e.text.minVisibleSize.get(t),scaling:e.text.scaling.get(t),position:e.text.position.get(t),maxLineLength:e.text.maxLineLength.get(t),truncateLength:e.text.truncateLength.get(t),secondary:Vr["text.secondary"](e,t)}),image:(e,t)=>({url:e.image.url.get(t),scale:e.image.scale.get(t),fit:e.image.fit.get(t),tile:e.image.tile.get(t),minVisibleSize:e.image.minVisibleSize.get(t)}),icon:(e,t)=>({content:e.icon.content.get(t),font:e.icon.font.get(t),color:e.icon.color.get(t),scale:e.icon.scale.get(t),style:e.icon.style.get(t),minVisibleSize:e.icon.minVisibleSize.get(t)}),badges:(e,t)=>({topLeft:Eo.topLeft(e,t),topRight:Eo.topRight(e,t),bottomLeft:Eo.bottomLeft(e,t),bottomRight:Eo.bottomRight(e,t)}),"badges.topLeft":Eo.topLeft,"badges.topRight":Eo.topRight,"badges.bottomLeft":Eo.bottomLeft,"badges.bottomRight":Eo.bottomRight,"badges.topLeft.image":Sc("topLeft"),"badges.topLeft.stroke":Ac("topLeft"),"badges.topLeft.text":wc("topLeft"),"badges.topRight.image":Sc("topRight"),"badges.topRight.stroke":Ac("topRight"),"badges.topRight.text":wc("topRight"),"badges.bottomLeft.image":Sc("bottomLeft"),"badges.bottomLeft.stroke":Ac("bottomLeft"),"badges.bottomLeft.text":wc("bottomLeft"),"badges.bottomRight.image":Sc("bottomRight"),"badges.bottomRight.stroke":Ac("bottomRight"),"badges.bottomRight.text":wc("bottomRight"),all:(e,t)=>({x:e.x.get(t),y:e.y.get(t),radius:e.radius.get(t),scalingMethod:e.scalingMethod.get(t),color:e.color.get(t),opacity:e.opacity.get(t),shape:e.shape.get(t),layer:e.layer.get(t),detectable:e.detectable.get(t),draggable:e.draggable.get(t),layoutable:e.layoutable.get(t),innerStroke:Vr.innerStroke(e,t),outerStroke:Vr.outerStroke(e,t),badges:Vr.badges(e,t),halo:Vr.halo(e,t),pulse:Vr.pulse(e,t),icon:Vr.icon(e,t),image:Vr.image(e,t),outline:Vr.outline(e,t),text:Vr.text(e,t)})},Ao={shape:(e,t)=>({body:e.shape.body.get(t),head:e.shape.head.get(t),tail:e.shape.tail.get(t),style:e.shape.style.get(t)}),"text.secondary":(e,t)=>({content:e.text.secondary.content.get(t),font:e.text.secondary.font.get(t),color:e.text.secondary.color.get(t),size:e.text.secondary.size.get(t),scale:e.text.secondary.scale.get(t),style:e.text.secondary.style.get(t),align:e.text.secondary.align.get(t),margin:e.text.secondary.margin.get(t),padding:e.text.secondary.padding.get(t),backgroundColor:e.text.secondary.backgroundColor.get(t),minVisibleSize:e.text.secondary.minVisibleSize.get(t)}),text:(e,t)=>({content:e.text.content.get(t),font:e.text.font.get(t),color:e.text.color.get(t),size:e.text.size.get(t),scale:e.text.scale.get(t),style:e.text.style.get(t),align:e.text.align.get(t),margin:e.text.margin.get(t),padding:e.text.padding.get(t),position:e.text.position.get(t),backgroundColor:e.text.backgroundColor.get(t),minVisibleSize:e.text.minVisibleSize.get(t),adjustAngle:e.text.adjustAngle.get(t),scaling:e.text.scaling.get(t),maxLineLength:e.text.maxLineLength.get(t),secondary:Ao["text.secondary"](e,t)}),outline:(e,t)=>({enabled:e.outline.enabled.get(t),color:e.outline.color.get(t),minVisibleSize:e.outline.minVisibleSize.get(t)}),pulse:(e,t)=>({enabled:e.pulse.enabled.get(t),duration:e.pulse.duration.get(t),interval:e.pulse.interval.get(t),startColor:e.pulse.startColor.get(t),endColor:e.pulse.endColor.get(t),width:e.pulse.width.get(t),startRatio:e.pulse.startRatio.get(t),endRatio:e.pulse.endRatio.get(t)}),stroke:(e,t)=>({color:e.stroke.color.get(t),width:e.stroke.width.get(t),scalingMethod:e.stroke.scalingMethod.get(t),minVisibleSize:e.stroke.minVisibleSize.get(t)}),halo:(e,t)=>({color:e.halo.color.get(t),width:e.halo.width.get(t),scalingMethod:e.halo.scalingMethod.get(t)}),all:(e,t)=>({width:e.width.get(t),scalingMethod:e.scalingMethod.get(t),color:e.color.get(t),opacity:e.opacity.get(t),minVisibleSize:e.minVisibleSize.get(t),layer:e.layer.get(t),detectable:e.detectable.get(t),curvature:e.curvature.get(t),adjustAnchors:e.adjustAnchors.get(t),shape:Ao.shape(e,t),stroke:Ao.stroke(e,t),halo:Ao.halo(e,t),pulse:Ao.pulse(e,t),outline:Ao.outline(e,t),text:Ao.text(e,t)})};function _x(e,t,n,s=!0){if((t=t||e)._flexArray!==void 0)return tS(t,n);let r={check:Yr,get:Vt,set:Vt,nested:{}};if(ad(t)||t._alias){const i=ad(t)?t:t._alias;r=tS(On(e,i),i)}else{if(t._set?(r.set=t._set,r.check=t._check):(r.set=Vt,r.check=Vt),t._get)r.get=t._get;else{const i=s?Vr:Ao;r.get=i[n||"all"]}r.nested={}}if(!ad(t)){const i=Object.keys(t);for(const o of i){const a=t[o];o.startsWith("_")||(r.nested[o]=_x(e,a,n?n+"."+o:o,s))}}return r}var dB=_x(TC,void 0,void 0,!0),hB=_x(uC,void 0,void 0,!1),cB=[];function nS(e){let t=cB;return e.output===void 0?(typeof e.attributes=="function"&&(t="all"),rs(e.attributes)&&(t=Sa(e.attributes))):e.output&&(t=e.output.attributes),yx(t,e.allAttributePaths)}function gB(e,t,n,s){if(s>n){for(const r of t.attributes)for(const i of e.attributes)if(i===r)return!0}for(const r of t.tags)for(const i of e.tags)if(r===i)return!0;return!1}function oi(e,t,n,s,r,i){gB(n,s,r,i)&&e.push(t)}function fB(e){let t=e.dependencies;t===void 0?t=Rz:rs(t)||(t={});const n=Vg(e.attributes).some(o=>typeof o=="function"),s=e.selector&&!e.standaloneSelector,r=!(!n&&!s);let i=t.adjacentEdges;return!i&&t.adjacentNodes&&(i=!0),{self:hi(t.self,r,e.allAttributePaths),adjacentNodes:hi(t.adjacentNodes,r,e.allAttributePaths),adjacentEdges:hi(i,r,e.allAttributePaths),allNodes:hi(t.allNodes,r,e.allAttributePaths),allEdges:hi(t.allEdges,r,e.allAttributePaths)}}function pB(e){let t=e.dependencies;t===void 0?t=Fz:rs(t)||(t={});const n=Vg(e.attributes).some(i=>typeof i=="function"),s=e.selector&&!e.standaloneSelector,r=!(!n&&!s);return{self:hi(t.self,r,e.allAttributePaths),extremities:hi(t.extremities,r,e.allAttributePaths),parallelEdges:hi(t.parallelEdges,r,e.allAttributePaths),allNodes:hi(t.allNodes,r,e.allAttributePaths),allEdges:hi(t.allEdges,r,e.allAttributePaths)}}function hi(e,t,n){if(!t)return{attributes:[],tags:[]};if(e===!0)return{attributes:[],tags:[i_]};const s={attributes:yx((e=e||{}).attributes,n),tags:yB(e.tags)};return e.data&&s.tags.push(o_),e.selection&&s.tags.push(Nn),e.hover&&s.tags.push(nd),s}function mB(e){return Array.isArray(e)?e.join("."):e}function _B(e){return e.map(mB).filter(ad)}function yx(e,t){if(e==="all")return t.slice();if(!Array.isArray(e))return[];const n=_B(e);return t?t.filter(s=>n.some(r=>s.startsWith(r))):n}function yB(e){return Array.isArray(e)?e.filter(ad):[]}var sS={storage:1,default:0},Lg=class{constructor({graph:e,isNode:t,includeRemovedElements:n}){this._all=!1,this._isNode=t,this._graph=e,this._includeRemovedElements=n,this._eltList=t?this._graph.nodeList:this._graph.edgeList,this._flexArray=t?e.createNodeAttribute(sS,!1):e.createEdgeAttribute(sS,!1),this._all=!1,this._indexList=e.createIndexList(t)}_getAllIndexes(){const e=this._isNode?this._graph.getNodeMaxIndex():this._graph.getEdgeMaxIndex(),t=new Uint32Array(e);for(let n=1;n<=e;++n)t[n-1]=n;return t}addAll(){this._all=!0}add(e){if(!this._all)for(let t=0;t<e._indexes.length;t++){const n=e._indexes[t];this.addIndex(n)}}addIndex(e){this._flexArray.get(e)===0&&(this._flexArray.set(e,1),this._indexList.push(e))}isEmpty(){return!this._all&&this._indexList.isEmpty()}isFull(){return this._all}getListAndClear(){const e=this.getList();return this.clear(),e}getList(){let e;if(this._all&&!this._includeRemovedElements)e=this._isNode?this._graph.getNodes("all"):this._graph.getEdges("all");else{const t=this._all?this._getAllIndexes():this._indexList.slice();e=this._eltList(t)}return e}clear(){this._all=!1,this._indexList.isEmpty()||(this._indexList.reset(),this._flexArray.reset())}addSet(e){if(e._all)this.addAll();else{const t=e._indexList.getBuffer(),n=e._indexList.getLength();for(let s=0;s<n;++s)this.addIndex(t[s])}}};function CC(e,t=[],n=""){return e.constructor===fg?e.isInitialized()&&t.push(n):e.constructor===Object&&Object.keys(e).forEach(s=>{CC(e[s],t,n?n+"."+s:s)}),t}var rS=class{constructor(e,t,n){this._updatedAttributes=new Set,this._updatedAttributesTmp=new Set,this._allUsedAttributes=new Set,this._graph=e,this._eltName=t?"node":"edge",this._accessors=t?dB:hB,this._createFlexArrays=n;const s=this._createFlexArrays(e,{original:!0,useDefaultValues:!0});this._finalFlexArrays=s;const r=this._createFlexArrays(e,{original:!1,useDefaultValues:!0});this._prevFlexArrays=r;const i=this._createFlexArrays(e,{original:!1,useDefaultValues:!0});this._defaultFlexArrays=i,this._currentFlexArrays=this._defaultFlexArrays,this.setLastFlexArrays(this._defaultFlexArrays),this._elementsToRedraw=new Lg({graph:e,isNode:t,includeRemovedElements:!0}),this._elementsUpdated=new Lg({graph:e,isNode:t,includeRemovedElements:!1}),this._finalFlexArraysWrapped={...this._finalFlexArrays,excluded:e.getAttribute(t,"excluded"),textHidden:e.getAttribute(t,"textHidden"),animationStart:e.createAttribute(t,kz),animationDuration:e.createAttribute(t,Mz),animationEasing:e.createAttribute(t,Pz),id:this._graph.getAttribute(t,"id"),...!t&&{source:e.getEdgeAttribute("source"),target:e.getEdgeAttribute("target")}}}clear(){this._elementsToRedraw.clear(),this._elementsUpdated.clear(),this._updatedAttributes.clear(),this._updatedAttributesTmp.clear()}getAttributeFlexArrays(){return this._finalFlexArraysWrapped}getPrevAttributeFlexArrays(){return this._prevFlexArrays}getAnimationInformation(e){const t=e._indexes,n=Array(t.length),s=this._finalFlexArraysWrapped;for(let r=0;r<t.length;r++){const i=t[r];n[r]={duration:s.animationDuration.get(i),start:s.animationStart.get(i),easing:s.animationEasing.get(i)}}return n}setDefaultAttributes(e){Sa(e).forEach(t=>{const n=On(this._currentFlexArrays,t),s=On(this._prevFlexArrays,t),r=On(this._defaultFlexArrays,t),i=On(this._finalFlexArrays,t);if(!n)return;const o=On(e,t);n.setDefaultValue(o),r.setDefaultValue(o),s.setDefaultValue(o),i.setDefaultValue(o)}),this.redrawAll()}startUpdate(){}prepareFlexArraysUpdate(e){this._currentFlexArrays=e.inputFlexArrays}setLastFlexArrays(e){this._lastFlexArrays=e}updateFlexArrays(e){const{attributes:t,selector:n,context:s,outputFlexArrays:r,toUpdate:i,formattedOutput:o}=e;this._elementsUpdated.addSet(i),this._elementsToRedraw.addSet(i);const a=i.getListAndClear();if(t&&a.size){const{valid:u,invalid:d}=Fw(this._graph,a,n,s);for(const c of o.attributes){const g=On(r,c);for(let f=0;f<d._indexes.length;f++){const p=d._indexes[f];g.set(p,void 0)}}this._assignAttributesToFlexArrays(this._accessors,r,u,t,s),this._addUpdatedAttributes(e)}}endUpdate(){const e=this._elementsUpdated.getList(),t=Wu(this._updatedAttributesTmp);for(const n of t){const s=On(this._lastFlexArrays,n),r=On(this._finalFlexArrays,n);for(let i=0;i<e._indexes.length;i++){const o=e._indexes[i];r.set(o,s.get(o))}}this._updatedAttributesTmp.clear(),this._currentFlexArrays=this._finalFlexArrays}setAttributeValues(e,t,n,s,r){const i=e.outputFlexArrays,o=this._accessors;this._assignAttributesToFlexArrays(o,i,t,n,null),this._addUpdatedAttributes(e,s),this._elementsUpdated.add(t),this._elementsToRedraw.add(t)}notifyLayerDestroyed(e){this._addUpdatedAttributes(e)}_addUpdatedAttributes(e,t){const{outputFlexArrays:n,formattedOutput:s}=e,r=Array.isArray(t)?yx(t):s.attributes;for(const i of r)On(n,i).isInitialized()&&(this._updatedAttributes.add(i),this._updatedAttributesTmp.add(i),this._allUsedAttributes.add(i))}addUpdatedAttribute(e){this._updatedAttributes.add(e),this._updatedAttributesTmp.add(e),this._allUsedAttributes.add(e)}getUsedAttributeNames(e){return CC(e.outputFlexArrays)}redrawElements(e){this._elementsToRedraw.add(e)}redrawAll(){this._elementsToRedraw.addAll()}getAndResetElementsToRedraw(){return this._elementsToRedraw.getListAndClear()}getAndResetElementsUpdated(){return this._elementsUpdated.getListAndClear()}getAndResetAttributesUpdated(){const e=Wu(this._updatedAttributes);return this._updatedAttributes.clear(),e}getUpdatedAttributes(){return this._updatedAttributes}getUpdatedElementsList(){return this._elementsUpdated.getList()}getUpdatedAttributesSet(){return new Set(this._updatedAttributes)}createFlexArrays(){return this._createFlexArrays(this._graph,{original:!1,useDefaultValues:!1})}getAttributeValues(e,t,n,s){const r=s?this._prevFlexArrays:this._currentFlexArrays;return n?this._getMultipleAttributeValues(e,t,r):this._getSingleAttributeValues(e,t,r)}_getAccessor(e=""){let t=this._accessors;const n=ba(e);for(const s of n)if(t=t.nested[s],!t)throw new Error(`${this._eltName} attribute "${n.join("")}" does not exist`);return t}_getSingleAttributeValues(e,t,n){const s=this._getAccessor(t),r=e._indexes,i=Array(r.length);for(let o=0;o<r.length;o++)i[o]=s.get(n,r[o]);return i}_getMultipleAttributeValues(e,t,n){if(!t||t==="all")return this._getSingleAttributeValues(e,"",n);const s=Array(e.size);for(let r=0;r<s.length;++r)s[r]={};for(let r=0;r<t.length;r++){const i=t[r],o=this._getSingleAttributeValues(e,i,n);for(let a=0;a<s.length;++a)Ui(s[a],i,o[a])}return s}setAnimationAttributes(e,{duration:t,startTime:n,easing:s}){const r=e._indexes,i=this._finalFlexArraysWrapped,o=i.animationDuration,a=i.animationStart,u=i.animationEasing,d=Wu(this._allUsedAttributes);if(t){let c=!1;for(const g of d){if(g==="x"||g==="y"){c=!0;continue}const f=On(this._finalFlexArrays,g),p=On(this._prevFlexArrays,g);for(let _=0;_<r.length;_++){const y=r[_];p.set(y,f.get(y))}}if(c){const g=Rs(),f=this._finalFlexArrays.x,p=this._finalFlexArrays.y,_=this._prevFlexArrays.x,y=this._prevFlexArrays.y;for(let x=0;x<r.length;x++){const E=r[x],b=o.get(E);if(b){const S=a.get(E),A=u.get(E),C=(dx[A]||wg)(Math.min((g-S)/b,1)),k=Km(_.get(E),f.get(E),C),M=Km(y.get(E),p.get(E),C);_.set(E,k),y.set(E,M)}else _.set(E,f.get(E)),y.set(E,p.get(E))}}}o.fill(r,t),a.fill(r,n),u.fill(r,s)}resetAnimationAttributes(e){this._finalFlexArraysWrapped.animationDuration.fill(e._indexes,0)}getUsedAttributes(){return Wu(this._allUsedAttributes)}getDefaultFlexArrays(){return this._defaultFlexArrays}_assignAttributesToFlexArrays(e,t,n,s,r,i=[]){if(typeof s=="function"){const o=i.join(".");for(let a=0;a<n.size;++a){const u=n.get(a);if(u){const d=s(u,r,o);this._assignSingleValueToFlexArray(t,u,e,d,i)}}}else if(rs(s)){const o=Object.keys(s);for(let a=0;a<o.length;++a){const u=o[a];i.push(u);const d=this._getNestedAccessor(e,u,i),c=s[u];this._assignAttributesToFlexArrays(d,t,n,c,r,i),i.pop()}}else if((Array.isArray(s)||ArrayBuffer.isView(s))&&i[0]!=="color")if(i.length===0)for(let o=0;o<n.size;++o)this._assignSingleValueToFlexArray(t,n.get(o),e,s[o],i);else for(let o=0;o<n.size;++o){const a=n._indexes[o],u=e.check(s[o]);e.set(t,a,u)}else{const o=e.check(s);for(let a=0;a<n.size;++a){const u=n.get(a);e.set(t,u._index,o)}}}_getNestedAccessor(e,t,n){const s=e.nested[t];if(!s)throw new Error(`${this._eltName} attribute "${n.join(".")}" does not exist`);return s}_assignSingleValueToFlexArray(e,t,n,s,r){if(rs(s)){const i=Object.keys(s);for(const o of i){r.push(o);const a=s[o],u=this._getNestedAccessor(n,o,r);this._assignSingleValueToFlexArray(e,t,u,a,r),r.pop()}}else{const i=n.check(s);n.set(e,t._index,i)}}};function xB(e,{original:t,useDefaultValues:n}){const s="resource";return{width:e.createAttribute(!1,{storage:s,default:n?I_:void 0,name:"width"},t),scalingMethod:e.createAttribute(!1,{storage:s,default:n?N2:void 0,name:"scalingMethod"},t),color:e.createAttribute(!1,{storage:s,default:n?I2:void 0,name:"color"},t),opacity:e.createAttribute(!1,{storage:s,default:n?k2:void 0,name:"opacity"},t),minVisibleSize:e.createAttribute(!1,{storage:s,default:n?M2:void 0,name:"minVisibleSize"},t),layer:e.createAttribute(!1,{storage:s,default:n?P2:void 0,name:"layer"},t),detectable:e.createAttribute(!1,{storage:s,default:n?R2:void 0,name:"detectable"},t),curvature:e.createAttribute(!1,{storage:s,default:n?F2:void 0,name:"curvature"},t),adjustAnchors:e.createAttribute(!1,{storage:s,default:n?D2:void 0,name:"adjustAnchors"},t),shape:{body:e.createAttribute(!1,{storage:s,default:n?O2:void 0,name:"shape.body"},t),head:e.createAttribute(!1,{storage:s,default:n?z2:void 0,name:"shape.head"},t),tail:e.createAttribute(!1,{storage:s,default:n?B2:void 0,name:"shape.tail"},t),style:e.createAttribute(!1,{storage:s,default:n?U2:void 0,name:"shape.style"},t)},stroke:{color:e.createAttribute(!1,{storage:s,default:n?G2:void 0,name:"stroke.color"},t),width:e.createAttribute(!1,{storage:s,default:n?k_:void 0,name:"stroke.width"},t),scalingMethod:e.createAttribute(!1,{storage:s,default:n?V2:void 0,name:"stroke.scalingMethod"},t),minVisibleSize:e.createAttribute(!1,{storage:s,default:n?j2:void 0,name:"stroke.minVisibleSize"},t)},halo:{color:e.createAttribute(!1,{storage:s,default:n?H2:void 0,name:"halo.color"},t),width:e.createAttribute(!1,{storage:s,default:n?M_:void 0,name:"halo.width"},t),scalingMethod:e.createAttribute(!1,{storage:s,default:n?q2:void 0,name:"halo.scalingMethod"},t)},pulse:{enabled:e.createAttribute(!1,{storage:s,default:!n&&void 0,name:"pulse.enabled"},t),duration:e.createAttribute(!1,{storage:s,default:n?$2:void 0,name:"pulse.duration"},t),interval:e.createAttribute(!1,{storage:s,default:n?W2:void 0,name:"pulse.interval"},t),startColor:e.createAttribute(!1,{storage:s,default:n?X2:void 0,name:"pulse.startColor"},t),endColor:e.createAttribute(!1,{storage:s,default:n?Y2:void 0,name:"pulse.endColor"},t),width:e.createAttribute(!1,{storage:s,default:n?Z2:void 0,name:"pulse.width"},t),startRatio:e.createAttribute(!1,{storage:s,default:n?K2:void 0,name:"pulse.startRatio"},t),endRatio:e.createAttribute(!1,{storage:s,default:n?Q2:void 0,name:"pulse.endRatio"},t)},outline:{enabled:e.createAttribute(!1,{storage:s,default:!n&&void 0,name:"outline.enabled"},t),color:e.createAttribute(!1,{storage:s,default:n?J2:void 0,name:"outline.color"},t),minVisibleSize:e.createAttribute(!1,{storage:s,default:n?eC:void 0,name:"outline.minVisibleSize"},t)},text:{content:e.createAttribute(!1,{storage:s,default:n?null:void 0,name:"text.content"},t),font:e.createAttribute(!1,{storage:s,default:n?qs:void 0,name:"text.font"},t),color:e.createAttribute(!1,{storage:s,default:n?Do:void 0,name:"text.color"},t),size:e.createAttribute(!1,{storage:s,default:n?Bl:void 0,name:"text.size"},t),scale:e.createAttribute(!1,{storage:s,default:n?Bz:void 0,name:"text.scale"},t),style:e.createAttribute(!1,{storage:s,default:n?tC:void 0,name:"text.style"},t),align:e.createAttribute(!1,{storage:s,default:n?nC:void 0,name:"text.align"},t),margin:e.createAttribute(!1,{storage:s,default:n?sC:void 0,name:"text.margin"},t),padding:e.createAttribute(!1,{storage:s,default:n?P_:void 0,name:"text.padding"},t),position:e.createAttribute(!1,{storage:s,default:n?rC:void 0,name:"text.position"},t),backgroundColor:e.createAttribute(!1,{storage:s,default:n?Tg:void 0,name:"text.backgroundColor"},t),minVisibleSize:e.createAttribute(!1,{storage:s,default:n?iC:void 0,name:"text.minVisibleSize"},t),adjustAngle:e.createAttribute(!1,{storage:s,default:n?oC:void 0,name:"text.adjustAngle"},t),scaling:e.createAttribute(!1,{storage:s,default:n?A2:void 0,name:"text.scaling"},t),maxLineLength:e.createAttribute(!1,{storage:s,default:n?w2:void 0,name:"text.maxLineLength"},t),secondary:{content:e.createAttribute(!1,{storage:s,default:n?null:void 0,name:"text.secondary.content"},t),font:e.createAttribute(!1,{storage:s,default:n?qs:void 0,name:"text.secondary.font"},t),color:e.createAttribute(!1,{storage:s,default:n?Do:void 0,name:"text.secondary.color"},t),size:e.createAttribute(!1,{storage:s,default:n?F_:void 0,name:"text.secondary.size"},t),scale:e.createAttribute(!1,{storage:s,default:n?v2:void 0,name:"text.secondary.scale"},t),style:e.createAttribute(!1,{storage:s,default:n?E2:void 0,name:"text.secondary.style"},t),align:e.createAttribute(!1,{storage:s,default:n?S2:void 0,name:"text.secondary.align"},t),margin:e.createAttribute(!1,{storage:s,default:n?lC:void 0,name:"text.secondary.margin"},t),padding:e.createAttribute(!1,{storage:s,default:n?R_:void 0,name:"text.secondary.padding"},t),backgroundColor:e.createAttribute(!1,{storage:s,default:n?b2:void 0,name:"text.secondary.backgroundColor"},t),minVisibleSize:e.createAttribute(!1,{storage:s,default:n?aC:void 0,name:"text.secondary.minVisibleSize"},t)}}}}function vB(e,{original:t,useDefaultValues:n}){const s="resource";return{x:e.createAttribute(!0,{storage:"any",default:n?0:void 0,name:"x"},t),y:e.createAttribute(!0,{storage:"any",default:n?0:void 0,name:"y"},t),radius:e.createAttribute(!0,{storage:s,default:n?5:void 0,name:"radius"},t),scalingMethod:e.createAttribute(!0,{storage:s,default:n?"scaled":void 0,name:"scalingMethod"},t),color:e.createAttribute(!0,{storage:s,default:n?dC:void 0,name:"color"},t),opacity:e.createAttribute(!0,{storage:s,default:n?Gz:void 0,name:"opacity"},t),shape:e.createAttribute(!0,{storage:s,default:n?Vz:void 0,name:"shape"},t),layer:e.createAttribute(!0,{storage:s,default:n?0:void 0,name:"layer"},t),detectable:e.createAttribute(!0,{storage:s,default:!!n||void 0,name:"detectable"},t),draggable:e.createAttribute(!0,{storage:s,default:!!n||void 0,name:"draggable"},t),layoutable:e.createAttribute(!0,{storage:s,default:!!n||void 0,name:"layoutable"},t),innerStroke:{width:e.createAttribute(!0,{storage:s,default:n?gx:void 0,name:"innerStroke.width"},t),scalingMethod:e.createAttribute(!0,{storage:s,default:n?"fixed":void 0,name:"innerStroke.scalingMethod"},t),color:e.createAttribute(!0,{storage:s,default:n?hC:void 0,name:"innerStroke.color"},t),minVisibleSize:e.createAttribute(!0,{storage:s,default:n?O_:void 0,name:"innerStroke.minVisibleSize"},t)},outerStroke:{width:e.createAttribute(!0,{storage:s,default:n?fx:void 0,name:"outerStroke.width"},t),scalingMethod:e.createAttribute(!0,{storage:s,default:n?"fixed":void 0,name:"outerStroke.scalingMethod"},t),color:e.createAttribute(!0,{storage:s,default:n?cC:void 0,name:"outerStroke.color"},t),minVisibleSize:e.createAttribute(!0,{storage:s,default:n?D_:void 0,name:"outerStroke.minVisibleSize"},t)},badges:{topLeft:{color:e.createAttribute(!0,{storage:s,default:n?Xu:void 0,name:"badges.topLeft.color"},t),scale:e.createAttribute(!0,{storage:s,default:n?.45:void 0,name:"badges.topLeft.scale"},t),positionScale:e.createAttribute(!0,{storage:s,default:n?1:void 0,name:"badges.topLeft.positionScale"},t),minVisibleSize:e.createAttribute(!0,{storage:s,default:n?vc:void 0,name:"badges.topLeft.minVisibleSize"},t),image:{url:e.createAttribute(!0,{storage:s,default:n?null:void 0,name:"badges.topLeft.image.url"},t),scale:e.createAttribute(!0,{storage:s,default:n?1:void 0,name:"badges.topLeft.image.scale"},t)},stroke:{color:e.createAttribute(!0,{storage:s,default:n?Yu:void 0,name:"badges.topLeft.stroke.color"},t),width:e.createAttribute(!0,{storage:s,default:n?Sl:void 0,name:"badges.topLeft.stroke.width"},t),scalingMethod:e.createAttribute(!0,{storage:s,default:n?"fixed":void 0,name:"badges.topLeft.stroke.scalingMethod"},t)},text:{content:e.createAttribute(!0,{storage:s,default:n?null:void 0,name:"badges.topLeft.text.content"},t),color:e.createAttribute(!0,{storage:s,default:n?Zu:void 0,name:"badges.topLeft.text.color"},t),font:e.createAttribute(!0,{storage:s,default:n?qs:void 0,name:"badges.topLeft.text.font"},t),style:e.createAttribute(!0,{storage:s,default:n?"normal":void 0,name:"badges.topLeft.text.style"},t),scale:e.createAttribute(!0,{storage:s,default:n?.5:void 0,name:"badges.topLeft.text.scale"},t),paddingLeft:e.createAttribute(!0,{storage:s,default:n?0:void 0,name:"badges.topLeft.text.paddging.left"},t),paddingTop:e.createAttribute(!0,{storage:s,default:n?0:void 0,name:"badges.topLeft.text.paddging.top"},t)}},topRight:{color:e.createAttribute(!0,{storage:s,default:n?Xu:void 0,name:"badges.topRight.color"},t),scale:e.createAttribute(!0,{storage:s,default:n?.45:void 0,name:"badges.topRight.scale"},t),positionScale:e.createAttribute(!0,{storage:s,default:n?1:void 0,name:"badges.topRight.positionScale"},t),minVisibleSize:e.createAttribute(!0,{storage:s,default:n?vc:void 0,name:"badges.topRight.minVisibleSize"},t),image:{url:e.createAttribute(!0,{storage:s,default:n?null:void 0,name:"badges.topRight.image.url"},t),scale:e.createAttribute(!0,{storage:s,default:n?1:void 0,name:"badges.topRight.image.scale"},t)},stroke:{color:e.createAttribute(!0,{storage:s,default:n?Yu:void 0,name:"badges.topRight.stroke.color"},t),width:e.createAttribute(!0,{storage:s,default:n?Sl:void 0,name:"badges.topRight.stroke.width"},t),scalingMethod:e.createAttribute(!0,{storage:s,default:n?"fixed":void 0,name:"badges.topRight.stroke.scalingMethod"},t)},text:{content:e.createAttribute(!0,{storage:s,default:n?null:void 0,name:"badges.topRight.text.content"},t),color:e.createAttribute(!0,{storage:s,default:n?Zu:void 0,name:"badges.topRight.text.color"},t),font:e.createAttribute(!0,{storage:s,default:n?qs:void 0,name:"badges.topRight.text.font"},t),style:e.createAttribute(!0,{storage:s,default:n?"normal":void 0,name:"badges.topRight.text.style"},t),scale:e.createAttribute(!0,{storage:s,default:n?.5:void 0,name:"badges.topRight.text.scale"},t),paddingTop:e.createAttribute(!0,{storage:s,default:n?0:void 0,name:"badges.topRight.text.paddging.left"},t),paddingLeft:e.createAttribute(!0,{storage:s,default:n?0:void 0,name:"badges.topRight.text.paddging.top"},t)}},bottomLeft:{color:e.createAttribute(!0,{storage:s,default:n?Xu:void 0,name:"badges.bottomLeft.color"},t),scale:e.createAttribute(!0,{storage:s,default:n?.45:void 0,name:"badges.bottomLeft.scale"},t),positionScale:e.createAttribute(!0,{storage:s,default:n?1:void 0,name:"badges.bottomLeft.positionScale"},t),minVisibleSize:e.createAttribute(!0,{storage:s,default:n?vc:void 0,name:"badges.bottomLeft.minVisibleSize"},t),image:{url:e.createAttribute(!0,{storage:s,default:n?null:void 0,name:"badges.bottomLeft.image.url"},t),scale:e.createAttribute(!0,{storage:s,default:n?1:void 0,name:"badges.bottomLeft.image.scale"},t)},stroke:{color:e.createAttribute(!0,{storage:s,default:n?Yu:void 0,name:"badges.bottomLeft.stroke.color"},t),width:e.createAttribute(!0,{storage:s,default:n?Sl:void 0,name:"badges.bottomLeft.stroke.width"},t),scalingMethod:e.createAttribute(!0,{storage:s,default:n?"fixed":void 0,name:t?"badges.bottomLeft.stroke.scalingMethod":void 0})},text:{content:e.createAttribute(!0,{storage:s,default:n?null:void 0,name:"badges.bottomLeft.text.content"},t),color:e.createAttribute(!0,{storage:s,default:n?Zu:void 0,name:"badges.bottomLeft.text.color"},t),font:e.createAttribute(!0,{storage:s,default:n?qs:void 0,name:"badges.bottomLeft.text.font"},t),style:e.createAttribute(!0,{storage:s,default:n?"normal":void 0,name:"badges.bottomLeft.text.style"},t),scale:e.createAttribute(!0,{storage:s,default:n?.5:void 0,name:"badges.bottomLeft.text.scale"},t),paddingLeft:e.createAttribute(!0,{storage:s,default:n?0:void 0,name:"badges.bottomLeft.text.paddging.left"},t),paddingTop:e.createAttribute(!0,{storage:s,default:n?0:void 0,name:"badges.bottomLeft.text.paddging.top"},t)}},bottomRight:{color:e.createAttribute(!0,{storage:s,default:n?Xu:void 0,name:"badges.bottomRight.color"},t),scale:e.createAttribute(!0,{storage:s,default:n?.45:void 0,name:"badges.bottomRight.scale"},t),positionScale:e.createAttribute(!0,{storage:s,default:n?1:void 0,name:"badges.bottomRight.positionScale"},t),minVisibleSize:e.createAttribute(!0,{storage:s,default:n?vc:void 0,name:"badges.bottomRight.minVisibleSize"},t),image:{url:e.createAttribute(!0,{storage:s,default:n?null:void 0,name:"badges.bottomRight.image.url"},t),scale:e.createAttribute(!0,{storage:s,default:n?1:void 0,name:"badges.bottomRight.image.scale"},t)},stroke:{color:e.createAttribute(!0,{storage:s,default:n?Yu:void 0,name:"badges.bottomRight.stroke.color"},t),width:e.createAttribute(!0,{storage:s,default:n?Sl:void 0,name:"badges.bottomRight.stroke.width"},t),scalingMethod:e.createAttribute(!0,{storage:s,default:n?"fixed":void 0,name:t?"badges.bottomRight.stroke.scalingMethod":void 0})},text:{content:e.createAttribute(!0,{storage:s,default:n?null:void 0,name:"badges.bottomRight.text.content"},t),color:e.createAttribute(!0,{storage:s,default:n?Zu:void 0,name:"badges.bottomRight.text.color"},t),font:e.createAttribute(!0,{storage:s,default:n?qs:void 0,name:"badges.bottomRight.text.font"},t),style:e.createAttribute(!0,{storage:s,default:n?"normal":void 0,name:"badges.bottomRight.text.style"},t),scale:e.createAttribute(!0,{storage:s,default:n?.5:void 0,name:"badges.bottomRight.text.scale"},t),paddingLeft:e.createAttribute(!0,{storage:s,default:n?0:void 0,name:"badges.bottomRight.text.paddging.left"},t),paddingTop:e.createAttribute(!0,{storage:s,default:n?0:void 0,name:"badges.bottomRight.text.paddging.top"},t)}}},halo:{color:e.createAttribute(!0,{storage:s,default:n?fC:void 0,name:"halo.color"},t),width:e.createAttribute(!0,{storage:s,default:n?px:void 0,name:"halo.width"},t),scalingMethod:e.createAttribute(!0,{storage:s,default:n?"fixed":void 0,name:"halo.scalingMethod"},t),strokeColor:e.createAttribute(!0,{storage:s,default:n?pC:void 0,name:"halo.strokeColor"},t),strokeWidth:e.createAttribute(!0,{storage:s,default:n?mx:void 0,name:"halo.strokeWidth"},t),clustering:e.createAttribute(!0,{storage:s,default:!n&&void 0,name:"halo.clustering"},t),hideNonAdjacentEdges:e.createAttribute(!0,{storage:s,default:!n&&void 0,name:"halo.hideNonAdjacentEdges"},t)},pulse:{enabled:e.createAttribute(!0,{storage:s,default:!n&&void 0,name:"pulse.enabled"},t),duration:e.createAttribute(!0,{storage:s,default:n?_C:void 0,name:"pulse.duration"},t),interval:e.createAttribute(!0,{storage:s,default:n?yC:void 0,name:"pulse.interval"},t),startColor:e.createAttribute(!0,{storage:s,default:n?EC:void 0,name:"pulse.startColor"},t),endColor:e.createAttribute(!0,{storage:s,default:n?bC:void 0,name:"pulse.endColor"},t),width:e.createAttribute(!0,{storage:s,default:n?SC:void 0,name:"pulse.width"},t),startRatio:e.createAttribute(!0,{storage:s,default:n?xC:void 0,name:"pulse.startRatio"},t),endRatio:e.createAttribute(!0,{storage:s,default:n?vC:void 0,name:"pulse.endRatio"},t)},icon:{content:e.createAttribute(!0,{storage:s,default:n?null:void 0,name:"icon.content"},t),font:e.createAttribute(!0,{storage:s,default:n?qs:void 0,name:"icon.font"},t),color:e.createAttribute(!0,{storage:s,default:n?mC:void 0,name:"icon.color"},t),scale:e.createAttribute(!0,{storage:s,default:n?.7:void 0,name:"icon.scale"},t),style:e.createAttribute(!0,{storage:s,default:n?"normal":void 0,name:"icon.style"},t),minVisibleSize:e.createAttribute(!0,{storage:s,default:n?12:void 0,name:"icon.minVisibleSize"},t)},image:{url:e.createAttribute(!0,{storage:s,default:n?null:void 0,name:"image.url"},t),scale:e.createAttribute(!0,{storage:s,default:n?1:void 0,name:"image.scale"},t),fit:e.createAttribute(!0,{storage:s,default:!!n||void 0,name:"image.fit"},t),tile:e.createAttribute(!0,{storage:s,default:!n&&void 0,name:"image.tile"},t),minVisibleSize:e.createAttribute(!0,{storage:s,default:n?12:void 0,name:"image.minVisibleSize"},t)},outline:{enabled:e.createAttribute(!0,{storage:s,default:!n&&void 0,name:"outline.enabled"},t),color:e.createAttribute(!0,{storage:s,default:n?gC:void 0,name:"outline.color"},t),minVisibleSize:e.createAttribute(!0,{storage:s,default:n?12:void 0,name:"outline.minVisibleSize"},t)},text:{content:e.createAttribute(!0,{storage:s,default:n?null:void 0,name:"text.content"},t),font:e.createAttribute(!0,{storage:s,default:n?qs:void 0,name:"text.font"},t),color:e.createAttribute(!0,{storage:s,default:n?Do:void 0,name:"text.color"},t),size:e.createAttribute(!0,{storage:s,default:n?Bl:void 0,name:"text.size"},t),scale:e.createAttribute(!0,{storage:s,default:n?.1:void 0,name:"text.scale"},t),style:e.createAttribute(!0,{storage:s,default:n?"normal":void 0,name:"text.style"},t),align:e.createAttribute(!0,{storage:s,default:n?"center":void 0,name:"text.align"},t),margin:e.createAttribute(!0,{storage:s,default:n?hx:void 0,name:"text.margin"},t),padding:e.createAttribute(!0,{storage:s,default:n?Sd:void 0,name:"text.padding"},t),backgroundColor:e.createAttribute(!0,{storage:s,default:n?Tg:void 0,name:"text.backgroundColor"},t),tip:e.createAttribute(!0,{storage:s,default:n?Oz:void 0,name:"text.tip"},t),minVisibleSize:e.createAttribute(!0,{storage:s,default:n?24:void 0,name:"text.minVisibleSize"},t),scaling:e.createAttribute(!0,{storage:s,default:!n&&void 0,name:"text.scaling"},t),position:e.createAttribute(!0,{storage:s,default:n?"bottom":void 0,name:"text.position"},t),maxLineLength:e.createAttribute(!0,{storage:s,default:n?0:void 0,name:"text.maxLineLength"},t),truncateLength:e.createAttribute(!0,{storage:s,default:n?0:void 0,name:"text.truncateLength"},t),secondary:{content:e.createAttribute(!0,{storage:s,default:n?null:void 0,name:"text.secondary.content"},t),font:e.createAttribute(!0,{storage:s,default:n?qs:void 0,name:"text.secondary.font"},t),color:e.createAttribute(!0,{storage:s,default:n?Do:void 0,name:"text.secondary.color"},t),size:e.createAttribute(!0,{storage:s,default:n?cx:void 0,name:"text.secondary.size"},t),scale:e.createAttribute(!0,{storage:s,default:n?.08:void 0,name:"text.secondary.scale"},t),style:e.createAttribute(!0,{storage:s,default:n?"normal":void 0,name:"text.secondary.style"},t),align:e.createAttribute(!0,{storage:s,default:n?"center":void 0,name:"text.secondary.align"},t),margin:e.createAttribute(!0,{storage:s,default:n?zz:void 0,name:"text.secondary.margin"},t),padding:e.createAttribute(!0,{storage:s,default:n?Sd:void 0,name:"text.secondary.padding"},t),backgroundColor:e.createAttribute(!0,{storage:s,default:n?Tg:void 0,name:"text.secondary.backgroundColor"},t),minVisibleSize:e.createAttribute(!0,{storage:s,default:n?24:void 0,name:"text.secondary.minVisibleSize"},t)}}}}var bB=class{constructor(e){this.nodes=new rS(e,!0,vB),this.edges=new rS(e,!1,xB)}setNodeDefaultAttributes(e){this.nodes.setDefaultAttributes(e)}setEdgeDefaultAttributes(e){this.edges.setDefaultAttributes(e)}getFlexArrays(){return{nodes:{current:this.nodes.getAttributeFlexArrays(),previous:this.nodes.getPrevAttributeFlexArrays()},edges:{current:this.edges.getAttributeFlexArrays(),previous:this.edges.getPrevAttributeFlexArrays()}}}redrawAll(){this.nodes.redrawAll(),this.edges.redrawAll()}clear(){this.nodes.clear(),this.edges.clear()}redrawElements(e){this._fetch(e).redrawElements(e)}getAnimationInformation(e){return this._fetch(e).getAnimationInformation(e)}redrawNodes(e){this.nodes.redrawElements(e)}getUsedAttributes(e,t){return this._fetch(t).getUsedAttributeNames(t.isNode?e.nodes:e.edges)}startUpdate(){this.nodes.startUpdate(),this.edges.startUpdate()}notifyDestroyed(e){this.nodes.notifyLayerDestroyed(e.nodes),this.edges.notifyLayerDestroyed(e.edges)}prepareUpdate(e){this.nodes.prepareFlexArraysUpdate(e.nodes),this.edges.prepareFlexArraysUpdate(e.edges)}onUpdate(e){this.nodes.updateFlexArrays(e.nodes),this.edges.updateFlexArrays(e.edges)}afterLayersUpdate(){this.nodes.endUpdate(),this.edges.endUpdate()}getAndResetElementsToRedraw(){return{nodes:this.nodes.getAndResetElementsToRedraw(),edges:this.edges.getAndResetElementsToRedraw()}}getAndResetElementsUpdated(){const e=this.nodes,t=this.edges;return{nodes:e.getAndResetElementsUpdated(),edges:t.getAndResetElementsUpdated(),nodeAttributesSet:e.getUpdatedAttributesSet(),nodeAttributes:e.getAndResetAttributesUpdated(),edgeAttributes:t.getAndResetAttributesUpdated()}}setAnimationAttributes({nodes:e,edges:t},n){this.nodes.setAnimationAttributes(e,n),this.edges.setAnimationAttributes(t,n)}resetAnimationAttributes({nodes:e,edges:t}){this.nodes.resetAnimationAttributes(e),this.edges.resetAnimationAttributes(t)}setLastOutput(e,t){this.nodes.setLastFlexArrays(e),this.edges.setLastFlexArrays(t)}getCurrentInput(){const e=Bn(this.nodes.getDefaultFlexArrays()),t=Bn(this.edges.getDefaultFlexArrays());return{currentNodeFlexArrays:e,currentEdgeFlexArrays:t,allNodeAttributePaths:Sa(e),allEdgeAttributePaths:Sa(t)}}initializeLayer(e,t,n){e.nodes.allAttributePaths=t,e.edges.allAttributePaths=n,e.nodes.formattedDependencies=fB(e.nodes),e.edges.formattedDependencies=pB(e.edges),e.nodes.formattedOutput={attributes:nS(e.nodes),tags:e.tag?[e.tag]:[]},e.edges.formattedOutput={attributes:nS(e.edges),tags:e.tag?[e.tag]:[]},e.nodes.redrawAdjacentEdges=e.nodes.formattedOutput.attributes.some(s=>Dz[s]),e.initialized=!0}connectLayerInputOutput(e,t,n){const s=e.nodes.formattedOutput,r=e.edges.formattedOutput;for(const i of s.attributes){const o=On(t,i),a=On(e.nodes.outputFlexArrays,i);a.setFallback(o),Ui(t,i,a)}for(const i of r.attributes){const o=On(n,i),a=On(e.edges.outputFlexArrays,i);a.setFallback(o),Ui(n,i,a)}}setupLayerDependencies(e,t){if(e===t)return;const n=e.priority,s=t.priority,r=e.nodes.formattedOutput,i=e.edges.formattedOutput,o=t.nodes.formattedDependencies,a=t.edges.formattedDependencies;oi(e.depsNodeSelf,t,r,o.self,n,s),oi(e.depsNodeAdjacentNodes,t,r,o.adjacentNodes,n,s),oi(e.depsNodeAdjacentEdges,t,i,a.extremities,n,s),oi(e.depsNodeAllNodes,t,r,o.allNodes,n,s),oi(e.depsNodeAllEdges,t,i,a.allNodes,n,s),oi(e.depsEdgeSelf,t,i,a.self,n,s),oi(e.depsEdgeExtremities,t,r,o.adjacentEdges,n,s),oi(e.depsEdgeParallelEdges,t,i,a.parallelEdges,n,s),oi(e.depsEdgeAllNodes,t,r,o.allEdges,n,s),oi(e.depsEdgeAllEdges,t,i,a.allEdges,n,s)}createAttributeLayerData(e,t,n,{tag:s,onBeforeUpdate:r,standaloneSelectors:i}){const o=!!i;return{index:-1,id:t,name:e,tag:s||null,priority:0,depsNodeSelf:[],depsNodeAdjacentNodes:[],depsNodeAdjacentEdges:[],depsNodeAllNodes:[],depsNodeAllEdges:[],depsEdgeSelf:[],depsEdgeExtremities:[],depsEdgeParallelEdges:[],depsEdgeAllNodes:[],depsEdgeAllEdges:[],initialized:!1,onBeforeUpdate:r,nodes:{type:"node",name:e,standaloneSelector:o,toUpdate:new Lg({graph:n,isNode:!0,includeRemovedElements:!1}),outputFlexArrays:this.nodes.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null},edges:{type:"edge",name:e,standaloneSelector:o,toUpdate:new Lg({graph:n,isNode:!1,includeRemovedElements:!1}),outputFlexArrays:this.edges.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null}}}setAttributeValues(e,t,n,s,r){this._fetch(t).setAttributeValues(e,t,n,s,r)}getAttributeValues(e,t,n,s){return this._fetch(e).getAttributeValues(e,t,n,s)}_fetch(e){return e.isNode?this.nodes:this.edges}},EB=(e,t)=>new Az(e,t),SB=class{constructor(e,{graph:t,dom:n}){this._layerIdCounter=0,this._layers=[],this._destroyedLayers=[],this._layersNeedUpdate=!1,this._updateOngoing=!1,this._needUpdate=!1,this._ogma=e,this._graph=t,this._dom=n,this._emptySubgraph={nodes:e.nodeList(),edges:e.edgeList()},this._textHiddenSet=new Vd(this._graph,"textHidden"),this._layerController=new bB(this._graph)}_getLayerById(e){for(let t=0;t<this._layers.length;++t){const n=this._layers[t];if(n.id===e)return n.index=t,n}throw new Error("usage of a destroyed style rule or class")}setDefaultAttributes(e,t){this._layerController.setNodeDefaultAttributes(e),this._layerController.setEdgeDefaultAttributes(t)}getFlexArrays(){return this._layerController.getFlexArrays()}clear(){this._updateOngoing=!1,this._needUpdate=!1,this._destroyedLayers=[],this._layerController.clear(),this.updateAllForAllAttributeLayers()}redrawElements(e){e.size&&(this._layerController.redrawElements(e),this._dom.refresh())}redrawAll(){this._layerController.redrawAll(),this._dom.refresh()}_triggerUpdate(){this._needUpdate=!0,this._dom.refresh()}_reconstructAttributeLayersIfNecessary(){return!!this._layersNeedUpdate&&(this._reconstructAttributeLayers(),this._layersNeedUpdate=!1,this._dom.refresh(),!0)}getAnimationInformation(e){return this._layerController.getAnimationInformation(e)}update(){if(!this._needUpdate||this._updateOngoing||!this._ogma._token)return!1;this._reconstructAttributeLayersIfNecessary(),this._updateOngoing=!0,this._layerController.startUpdate();for(const e of this._destroyedLayers)e.initialized&&this._layerController.notifyDestroyed(e);for(const e of this._layers)this._layerController.prepareUpdate(e),typeof e.onBeforeUpdate=="function"&&e.onBeforeUpdate(e,this,this._layerController),this._layerController.onUpdate(e);return this._layerController.afterLayersUpdate(),this._updateOngoing=!1,this._needUpdate=!1,!0}setAttributeLayerValues(e,t,n,s){const r=this._getLayerById(e),i=t.isNode?r.nodes:r.edges;this._reconstructAttributeLayersIfNecessary(),this._layerController.setAttributeValues(i,t,n,s,r),this._updateElementsForAttributeLayers([r],t)}getAttributeLayerFlexArrays(e){const t=this._getLayerById(e);return{nodes:t.nodes.outputFlexArrays,edges:t.edges.outputFlexArrays}}getUsedAttributeLayerAttributes(e,t){const n=this._getLayerById(e);return this._layerController.getUsedAttributes(n,t)}getUpdatedElements(){return{elementsToRedraw:this._layerController.getAndResetElementsToRedraw(),elementsUpdated:this._layerController.getAndResetElementsUpdated()}}addAttributeLayer(e){const{name:t,layerFactory:n=EB}=e;if(!t)throw new Error("Attribute layer must have a name");if(t&&this._layers.find(r=>r.name===t))throw new Error(`attribute layer with name "${e.name}" already exists`);const s=this._layerController.createAttributeLayerData(t,++this._layerIdCounter,this._graph,e);return this._layers.push(s),this._updateLayer(s,e),n(this,this._layerIdCounter)}_reconstructAttributeLayers(){this._layers.sort((r,i)=>r.priority-i.priority);const{currentNodeFlexArrays:e,currentEdgeFlexArrays:t,allNodeAttributePaths:n,allEdgeAttributePaths:s}=this._layerController.getCurrentInput();for(const r of this._layers)this._layerController.initializeLayer(r,n,s);for(const r of this._layers){r.nodes.inputFlexArrays=Bn(e),r.edges.inputFlexArrays=Bn(t),r.depsNodeSelf=[],r.depsNodeAdjacentNodes=[],r.depsNodeAdjacentEdges=[],r.depsNodeAllNodes=[],r.depsNodeAllEdges=[],r.depsEdgeSelf=[],r.depsEdgeExtremities=[],r.depsEdgeParallelEdges=[],r.depsEdgeAllNodes=[],r.depsEdgeAllEdges=[],r.nodes.toUpdate.addAll(),r.edges.toUpdate.addAll(),this._layerController.connectLayerInputOutput(r,e,t);for(const i of this._layers)this._layerController.setupLayerDependencies(r,i)}this._layerController.setLastOutput(e,t);for(const r of this._layers)r.nodes.needAdjacentElements=r.nodes.redrawAdjacentEdges||r.depsNodeAdjacentNodes.length>0||r.depsNodeAdjacentEdges.length>0,r.edges.needAdjacentElements=r.depsEdgeExtremities.length>0||r.depsEdgeParallelEdges.length>0}_updateLayer(e,{priority:t,fullOverwrite:n,nodeAttributes:s,nodeSelector:r,nodeContext:i,nodeDependencies:o,nodeOutput:a,edgeAttributes:u,edgeSelector:d,edgeContext:c,edgeDependencies:g,edgeOutput:f}={}){s!==void 0&&(e.nodes.attributes=n?s:tg(e.nodes.attributes,s)),r!==void 0&&(e.nodes.selector=r),i!==void 0&&(e.nodes.context=i),o!==void 0&&(e.nodes.dependencies=o),a!==void 0&&(e.nodes.output=a),u!==void 0&&(e.edges.attributes=n?u:tg(e.edges.attributes,u)),d!==void 0&&(e.edges.selector=d),c!==void 0&&(e.edges.context=c),g!==void 0&&(e.edges.dependencies=g),f!==void 0&&(e.edges.output=f),t!==void 0&&(e.priority=t),this._triggerLayerUpdate()}_triggerLayerUpdate(){this._layersNeedUpdate=!0,this._triggerUpdate()}updateAllForAttributeLayer(e){const t=this._getLayerById(e);this._updateAllForAttributeLayer(t)}updateAllForAllAttributeLayers(){for(const e of this._layers)this._updateAllForAttributeLayer(e)}_updateAllForAttributeLayer(e,t=!0,n=!0){if(t&&!e.nodes.toUpdate.isFull()){e.nodes.toUpdate.addAll();for(const s of e.depsNodeSelf)this._updateAllForAttributeLayer(s,!0,!1);for(const s of e.depsNodeAdjacentNodes)this._updateAllForAttributeLayer(s,!0,!1);for(const s of e.depsNodeAdjacentEdges)this._updateAllForAttributeLayer(s,!1,!0);for(const s of e.depsNodeAllNodes)this._updateAllForAttributeLayer(s,!0,!1);for(const s of e.depsNodeAllEdges)this._updateAllForAttributeLayer(s,!1,!0)}if(n&&!e.edges.toUpdate.isFull()){e.edges.toUpdate.addAll();for(const s of e.depsEdgeSelf)this._updateAllForAttributeLayer(s,!1,!0);for(const s of e.depsEdgeExtremities)this._updateAllForAttributeLayer(s,!0,!1);for(const s of e.depsEdgeParallelEdges)this._updateAllForAttributeLayer(s,!1,!0);for(const s of e.depsEdgeAllNodes)this._updateAllForAttributeLayer(s,!0,!1);for(const s of e.depsEdgeAllEdges)this._updateAllForAttributeLayer(s,!1,!0)}this._triggerUpdate()}updateElementsForAttributeLayer(e,t){const n=this._getLayerById(e);this._updateElementsForAttributeLayers([n],t)}updateForAllAttributeLayers(e){this._updateElementsForAttributeLayers(this._layers,e)}_updateElementsForAttributeLayers(e,t){let n=this._emptySubgraph;if(t.isNode){for(const s of e)if(!s.nodes.toUpdate.isFull()){s.nodes.needAdjacentElements&&(n=n===this._emptySubgraph?t.fastGetAdjacentElements():n),s.nodes.toUpdate.add(t);for(const r of s.depsNodeSelf)r.nodes.toUpdate.add(t);for(const r of s.depsNodeAdjacentNodes)r.nodes.toUpdate.add(n.nodes);for(const r of s.depsNodeAdjacentEdges)r.edges.toUpdate.add(n.edges);for(const r of s.depsNodeAllNodes)this._updateAllForAttributeLayer(r,!0,!1);for(const r of s.depsNodeAllEdges)this._updateAllForAttributeLayer(r,!1,!0);s.nodes.redrawAdjacentEdges&&this._layerController.redrawElements(n.edges)}}else for(const s of e)if(!s.edges.toUpdate.isFull()){s.edges.needAdjacentElements&&(n=n===this._emptySubgraph?t.fastGetAdjacentElements():n),s.edges.toUpdate.add(t);for(const r of s.depsEdgeSelf)r.edges.toUpdate.add(t);for(const r of s.depsEdgeExtremities)r.nodes.toUpdate.add(n.nodes);for(const r of s.depsEdgeParallelEdges)r.edges.toUpdate.add(n.edges);for(const r of s.depsEdgeAllNodes)this._updateAllForAttributeLayer(r,!0,!1);for(const r of s.depsEdgeAllEdges)this._updateAllForAttributeLayer(r,!1,!0)}this._triggerUpdate()}destroyAttributeLayer(e){const t=this._getLayerById(e);this._destroyedLayers.push(t),this._layers.splice(t.index,1),this._triggerLayerUpdate()}updateAttributeLayer(e,t){const n=this._getLayerById(e);this._updateLayer(n,t)}getAttributeLayerDefinition(e){const t=this._getLayerById(e),{priority:n,nodes:s,edges:r}=t;return{priority:n,nodeAttributes:s.attributes,nodeSelector:s.selector,nodeContext:s.context,nodeDependencies:s.dependencies,nodeOutput:s.output,edgeAttributes:r.attributes,edgeSelector:r.selector,edgeContext:r.context,edgeDependencies:r.dependencies,edgeOutput:r.output}}getAttributeValues(e,t,n,s){return this.update(),this._layerController.getAttributeValues(e,t,n,s)}setAnimationAttributes(e,t){return this._layerController.setAnimationAttributes(e,t)}resetAnimationAttributes(e){return this._layerController.resetAnimationAttributes(e)}setTextHidden(e,t){const n=this._textHiddenSet.addOrRemoveElements(e,t);this.redrawElements(n)}resetTextHidden(){const{nodes:e,edges:t}=this._textHiddenSet.getElements();this._textHiddenSet.clear(),this._layerController.redrawElements(e),this._layerController.redrawElements(t)}getUsedNodeAttributes(){return this._layerController.nodes.getUsedAttributes()}getUsedEdgeAttributes(){return this._layerController.edges.getUsedAttributes()}interpolateAttributes(e){const t=Rs(),n=this._ogma.modules.graphics.getAttributesManager(),s=this._layerController,r=e.isNode?n.getUsedNodeAttributes():n.getUsedEdgeAttributes(),{animationDuration:i,animationEasing:o,animationStart:a}=s.getFlexArrays().nodes.current,u=i.getMultiple(e._indexes),d=o.getMultiple(e._indexes),c=a.getMultiple(e._indexes),g=[];for(let f=0;f<e.size;f++){const p={};r.forEach(_=>{const y=typeof _=="string"?_:_.join("."),x=On(s.getFlexArrays().nodes.previous,_),E=On(s.getFlexArrays().nodes.current,_);if(!E)return;const b=HT(t,c[f],u[f],d[f]);isNaN(b)?p[y]=E.get(e._indexes[f]):y.match(/color/gi)?p[y]=$u(x.get(e._indexes[f]),E.get(e._indexes[f]),b,b):p[y]=un(x.get(e._indexes[f]),E.get(e._indexes[f]),b)}),g.push(p)}return g}},AB=1e-12;function iS(e){return((e=Math.exp(e))+1/e)/2}function wB(e){return((e=Math.exp(e))-1/e)/2}function TB(e){return((e=Math.exp(2*e))-1)/(e+1)}var CB=function e(t,n,s){function r(i,o){var a,u,d=i[0],c=i[1],g=i[2],f=o[0],p=o[1],_=o[2],y=f-d,x=p-c,E=y*y+x*x;if(E<AB)u=Math.log(_/g)/t,a=function(M){return[d+M*y,c+M*x,g*Math.exp(t*M*u)]};else{var b=Math.sqrt(E),S=(_*_-g*g+s*E)/(2*g*n*b),A=(_*_-g*g-s*E)/(2*_*n*b),C=Math.log(Math.sqrt(S*S+1)-S),k=Math.log(Math.sqrt(A*A+1)-A);u=(k-C)/t,a=function(M){var R=M*u,O=iS(C),j=g/(n*b)*(O*TB(t*R+C)-wB(C));return[d+j*y,c+j*x,g*O/iS(t*R+C)]}}return a.duration=1e3*u*t/Math.SQRT2,a}return r.rho=function(i){var o=Math.max(.001,+i),a=o*o;return e(o,a,a*a)},r}(Math.SQRT2,2,4),LB="cubicOut",NB=({graphWidth:e,graphHeight:t,viewWidth:n,viewHeight:s})=>.2*Math.min(n/e,s/t),IB=({smallestNodeSize:e,viewWidth:t,viewHeight:n})=>e===1/0?1/0:Math.min(t,n)/e*.5;function kB(e,t,n){return t===void 0?MB(e):t==="alt"?e.altKey:t==="shift"?e.shiftKey:t==="space"?n.isPressed("space"):void 0}function MB(e){return!e.altKey&&(wI?e.metaKey:e.ctrlKey)&&!e.shiftKey}var z_=Math.SQRT2,oS=.15,PB=class extends zt{constructor(e,t){super(e),this._zooming=!1,this.debug=!1,this._smoothZoom=Ug((n,s,r)=>{const i=this._modules.settings,o=i.get("interactions.zoom.duration"),a=i.get("interactions.zoom.easing"),u=this._modules.camera.getZoom(),d={duration:o,easing:a};this._zooming||(this._zooming=!0,this._updateVisibility("zoom",!0));const c=i.get("interactions.zoom.speed")||oS;let g=jF(n,c);n<0&&g!==0&&(g=1/g);const f=u*g;this._modules.camera.setZoom(f,d,{x:s,y:r}).then(()=>{this._zooming&&(this._zooming=!1,this._updateVisibility("zoom",!1))})},Xw),this.debug=t}onMounted(){const e=this._modules.settings;e.register("interactions.zoom.enabled",!0),e.register("interactions.zoom.onDoubleClick",!1),e.register("interactions.zoom.duration",150),e.register("interactions.zoom.modifier",z_),e.register("interactions.zoom.speed",oS),e.register("interactions.zoom.easing",LB),e.register("interactions.zoom.minValue",this.debug?null:NB),e.register("interactions.zoom.maxValue",this.debug?null:IB),e.register("interactions.zoom.hideNodes",!1),e.register("interactions.zoom.hideEdges",!1),e.register("interactions.zoom.hideNodeTexts",!1),e.register("interactions.zoom.hideEdgeTexts",!1),e.register("interactions.zoom.scrollToPan",!1),e.register("interactions.zoom.metaKey",void 0),e.register("interactions.pan.enabled",!0),e.register("interactions.pan.hideNodes",!1),e.register("interactions.pan.hideEdges",!1),e.register("interactions.pan.hideNodeTexts",!1),e.register("interactions.pan.hideEdgeTexts",!1),e.register("interactions.rotation.enabled",!0),e.register("interactions.rotation.hideNodes",!1),e.register("interactions.rotation.hideEdges",!1),e.register("interactions.rotation.hideNodeTexts",!1),e.register("interactions.rotation.hideEdgeTexts",!1),e.register("interactions.gesture.enabled",!0),e.register("interactions.gesture.hideNodes",!1),e.register("interactions.gesture.hideEdges",!1),e.register("interactions.gesture.hideNodeTexts",!1),e.register("interactions.gesture.hideEdgeTexts",!1),this._setupInteractions()}_setupInteractions(){this._modules.interactions.onMouseWheel({priority:"zoom",check:()=>!!this._modules.settings.get("interactions.zoom.enabled"),handler:({x:e,y:t,delta:n,dx:s,dy:r,domEvent:i})=>{const o=s%1!=0||r%1!=0,a=this._modules.settings;!a.get("interactions.zoom.scrollToPan")||kB(i,a.get("interactions.zoom.metaKey"),this._modules.keyboard)||o?this._smoothZoom(n,e,t):this._modules.camera.move({x:s,y:r})}}),this._modules.interactions.onDoubleClick({priority:"zoom",check:()=>{const e=this._modules.settings.get("interactions.zoom.enabled"),t=this._modules.settings.get("interactions.zoom.onDoubleClick");return!(!e||!t)},handler:({x:e,y:t})=>this._smoothZoom(1,e,t)}),this._modules.interactions.onDrag({priority:"panning",disableDetection:!0,check:({button:e})=>{const t=!!this._modules.settings.get("interactions.pan.enabled");return e==="left"&&t},onStart:()=>this._updateVisibility("pan",!0),onProgress:({dx:e,dy:t})=>this._modules.camera.move({x:-e,y:-t}),onStop:()=>this._updateVisibility("pan",!1)}),this._modules.interactions.onDrag({priority:"rotation",disableDetection:!0,check:({button:e,domEvent:t})=>(e==="right"||t&&t.buttons===2)&&!!this._modules.settings.get("interactions.rotation.enabled"),onStart:({x:e,y:t})=>{this._rotationStart={x:e,y:t},this._updateVisibility("rotation",!0)},onProgress:({x:e,y:t})=>this._rotate({x:e,y:t}),onStop:()=>this._updateVisibility("rotation",!1)}),this._modules.interactions.onGesture({priority:"gesture",disableDetection:!0,check:()=>!!this._modules.settings.get("interactions.gesture.enabled"),onStart:()=>this._updateVisibility("gesture",!0),onProgress:({dx:e,dy:t,rotation:n,scale:s,x:r,y:i})=>{this._modules.settings.get("interactions.rotation.enabled")&&this._modules.camera.rotate(-n),this._modules.camera.zoomIn({modifier:s},{x:r,y:i}),this._modules.camera.move({x:-e,y:-t})},onStop:()=>this._updateVisibility("gesture",!0)})}_rotate({x:e,y:t}){const{width:n,height:s}=this._modules.camera.getSize(),r=n/2,i=s/2,o=this._rotationStart.x-r,a=this._rotationStart.y-i,u=e-r,d=t-i,c=Math.atan2(a,o)-Math.atan2(d,u);this._rotationStart.x=e,this._rotationStart.y=t,this._modules.camera.rotate(c)}_updateVisibility(e,t){const n=!t,s=this._modules.settings,r=s.get(`interactions.${e}.hideNodes`),i=s.get(`interactions.${e}.hideEdges`),o=s.get(`interactions.${e}.hideNodeTexts`),a=s.get(`interactions.${e}.hideEdgeTexts`);r&&this._modules.graphics.setNodesVisibility(n),o&&this._modules.graphics.setNodeTextsVisibility(n),i&&this._modules.graphics.setEdgesVisibility(n),a&&this._modules.graphics.setEdgeTextsVisibility(n)}},aS=1e-8,lS=1e8,_m={duration:0,startAfter:0,ignoreZoomLimits:!1,callback:Vt,easing:"quadraticOut"};function Cc(e){return Math.abs(e)<1e-9}var RB=80,FB=class LC extends zt{constructor(){super(...arguments),this._minZoom=aS,this._maxZoom=lS,this._timeout=0,this._cornerCosSin=new Float32Array([0,0,0,0,0,0,0,0])}onMounted(){this._reset(),this._modules.settings.register("minZoom",aS,t=>{this._minZoom=t,this._zoom<t&&(this._zoom=t,this._modules.events.fire("move"))}),this._modules.settings.register("maxZoom",lS,t=>{this._maxZoom=t,this._zoom>t&&(this._zoom=t,this._modules.events.fire("move"))}),this._modules.events.on("setContainer",()=>{this._reset(),this._modules.events.fire("move")}).on("resize",()=>{this._reloadDimensions(),this._modules.events.fire("move")})}get x(){return this._x}get y(){return this._y}get zoom(){return this._zoom}get angle(){return this._angle}get width(){return this._dimensions.width}get height(){return this._dimensions.height}moveEnd(t){this._modules.dom.clearTimeout(this._timeout),this._timeout=this._modules.dom.setTimeout(()=>{this._modules.events.fire("viewChanged",{type:t})},RB)}getSize(){return{width:this._dimensions.width,height:this._dimensions.height}}getCenter(){return{x:this._x,y:this._y}}setCenter({x:t,y:n},s){const r=this._x,i=this._y,o=t-this._x,a=n-this._y;return Cc(o)&&Cc(a)?Promise.resolve():new Promise(u=>{this._moveAnimation&&this._modules.animations.cancel(this._moveAnimation);const d=this._modules.animations.play(c=>{this._x=r+o*c,this._y=i+a*c,this._modules.events.fire("move").fire("pan")},{..._m,...s,callback:()=>this.moveEnd("pan"),resolve:u});d&&(this._moveAnimation=d)})}move({x:t,y:n},s){const r=uS({x:t,y:n},this._zoom,this._sinAngle,this._cosAngle);return this.setCenter({x:this._x+r.x,y:this._y+r.y},s)}getZoom(){return this._zoom}setZoom(t,n,s={x:void 0,y:void 0}){const{x:r,y:i}=s;let o=Mr(t,this._minZoom,this._maxZoom);return n&&n.ignoreZoomLimits||(o=this._applyZoomLimits(o)),Cc(this._zoom-o)?Promise.resolve():new Promise(a=>{const u={..._m,...n,callback:()=>this.moveEnd("zoom"),resolve:a},d=this._dimensions.width/2,c=this._dimensions.height/2,g=this._zoom,f=d/g-d/o;if(r!==void 0&&i!==void 0){const _=(r-d)/g-(r-d)/o,y=(i-c)/g-(i-c)/o,x=this._cosAngle,E=this._sinAngle,b=x*_-E*y,S=E*_+x*y;this.setCenter({x:this._x+b,y:this._y+S},n)}this._zoomAnimation&&this._modules.animations.cancel(this._zoomAnimation),this._modules.dom.afterNextFrame().then(()=>{this._modules.events.fire("zoomStart",{duration:u.duration,easing:u.easing,startZoom:g,endZoom:o})});const p=this._modules.animations.play(_=>{this._zoom=d/(d/g-f*_),this._modules.events.fire("move").fire("zoom")},u);p&&(this._zoomAnimation=p)})}_applyZoomLimits(t){const n=this._modules.settings.get("interactions.zoom.minValue"),s=this._modules.settings.get("interactions.zoom.maxValue"),{minScaledSize:r,maxScaledSize:i,width:o,height:a,cx:u}=this._modules.locate.getGraphBoundingBox(),d=this._zoom,c=this.getSize();let g=t;if(!isNaN(u)){const f={smallestNodeSize:r,biggestNodeSize:i,graphWidth:o+i,graphHeight:a+i,viewWidth:c.width,viewHeight:c.height},p=n&&n(f),_=s&&s(f);dS(p)&&g<p?g<d&&(g=Math.min(d,p)):dS(_)&&g>_&&g>d&&(g=Math.max(d,_))}return g}zoomIn(t,n={x:void 0,y:void 0}){let s=1;return t===void 0&&(t={}),typeof t=="number"&&(t={modifier:t}),s=typeof t.modifier!="number"?this._modules.settings.get("interactions.zoom.modifier")||z_:t.modifier,this.setZoom(this._zoom*s,t,n)}moveToBounds(t,n={}){const s=this._modules.locate.computeConfigForBounds(t,{ignoreZoomLimits:!0});return this.moveTo(s,n)}moveTo(t,n={}){const s=this.getZoom(),r=this.getCenter(),i=t.zoom||this._zoom;return n.duration===0?this.setView(t):new Promise(o=>{const a=Math.min(this.width,this.height),u=CB([r.x,r.y,a/s],[t.x,t.y,a/i]),d=u.duration,c=n.duration||d;this._moveAnimation&&this._modules.animations.cancel(this._moveAnimation);const g=this._modules.animations.play(f=>{const[p,_,y]=u(f);this._x=p,this._y=_,this._zoom=a/y,this._modules.events.fire("move"),this._modules.events.fire("pan")},{duration:c,easing:n.easing,callback:()=>this.moveEnd("pan"),resolve:o});g&&(this._moveAnimation=g)})}zoomOut(t,n={x:void 0,y:void 0}){let s=1;return t===void 0&&(t={}),typeof t=="number"&&(t={modifier:t}),s=typeof t.modifier!="number"?this._modules.settings.get("interactions.zoom.modifier")||z_:t.modifier,this.setZoom(this._zoom/s,t,n)}getAngle(){return this._angle}setAngle(t,n){const s=this._angle,r=t-s;return Cc(r)?Promise.resolve():new Promise(i=>{this._rotateAnimation&&this._modules.animations.cancel(this._rotateAnimation);const o=this._modules.animations.play(a=>{for(this._angle=s+r*a,this.calculateBoxCornerAngles();this._angle>Math.PI;)this._angle-=2*Math.PI;for(;this._angle<-Math.PI;)this._angle+=2*Math.PI;this._sinAngle=Math.sin(this._angle),this._cosAngle=Math.cos(this._angle),this._modules.events.fire("move").fire("rotate")},{..._m,...n,callback:()=>this.moveEnd("rotate"),resolve:i});o&&(this._rotateAnimation=o)})}rotate(t,n){return this.setAngle(this._angle+t,n)}getScreenCenter(){return{x:this._dimensions.width/2,y:this._dimensions.height/2}}graphToScreenCoordinates({x:t,y:n},s={x:0,y:0}){const r=this._dimensions.width/2,i=this._dimensions.height/2;return mg((t-this._x)*this._zoom+r,(n-this._y)*this._zoom+i,r,i,-this._angle,s)}screenToGraphCoordinates({x:t,y:n},s={x:0,y:0}){return mg(this._x+(t-this._dimensions.width/2)/this._zoom,this._y+(n-this._dimensions.height/2)/this._zoom,this._x,this._y,this._angle,s)}projectBounds(t,n=t){const s=t[0],r=t[1],i=t[2],o=t[3],a=this._x,u=this._y,d=this._dimensions.width/2,c=this._dimensions.height/2,g=this._sinAngle,f=this._cosAngle,p=1/this._zoom;let _=1/0,y=1/0,x=-1/0,E=-1/0;const b=[s,r,s,o,i,o,i,r];for(let S=0;S<b.length;S+=2){let A=b[S],C=b[S+1];A=a+(A-d)*p,C=u+(C-c)*p;const k=A-a,M=C-u;A=f*k-g*M+a,C=g*k+f*M+u,A<_&&(_=A),A>x&&(x=A),C<y&&(y=C),C>E&&(E=C)}return n[0]=_,n[1]=y,n[2]=x,n[3]=E,n}screenToGraphVector({x:t,y:n}){return uS({x:t,y:n},this._zoom,this._sinAngle,this._cosAngle)}getView(){return{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,width:this._dimensions.width,height:this._dimensions.height}}setView(t,n){const{x:s,y:r,zoom:i,angle:o}={x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,...t};return Promise.all([this.setCenter({x:s,y:r},n),this.setZoom(i,n),this.setAngle(o,n)]).then(Vt)}_reloadDimensions(){this._dimensions=this._modules.dom.getDimensions()}animationInProgress(){const t=this._moveAnimation,n=this._zoomAnimation,s=this._rotateAnimation;return!!(t&&!t.done||n&&!n.done||s&&!s.done)}getProjectedScreenBounds(t=0){const{width:n,height:s}=this._dimensions,r=Math.max(n,s)*t;return this.projectBounds([0-r,0-r,n+r,s+r])}calculateBoxCornerAngles(){const t=this._angle;this._cornerCosSin[0]=Math.cos(t+Math.PI/4),this._cornerCosSin[1]=Math.sin(t+Math.PI/4),this._cornerCosSin[2]=Math.cos(t+3*Math.PI/4),this._cornerCosSin[3]=Math.sin(t+3*Math.PI/4),this._cornerCosSin[4]=Math.cos(t-3*Math.PI/4),this._cornerCosSin[5]=Math.sin(t-3*Math.PI/4),this._cornerCosSin[6]=Math.cos(t-Math.PI/4),this._cornerCosSin[7]=Math.sin(t-Math.PI/4)}getCornerCos(t){return this._cornerCosSin[2*t]}getCornerSin(t){return this._cornerCosSin[2*t+1]}_reset(){this._zoom=1,this._x=0,this._y=0,this._angle=0,this.calculateBoxCornerAngles(),this._sinAngle=0,this._cosAngle=1,this._dimensions=this._modules.dom.getDimensions()}clone(t){const n=new LC(this._ogma);return n._zoom=t.zoom||this._zoom,n._x=t.x||this._x,n._y=t.y||this._y,n._angle=t.angle||this._angle,n._sinAngle=Math.sin(n._angle),n._cosAngle=Math.cos(n._angle),n.calculateBoxCornerAngles(),n._dimensions={width:t.width||this._dimensions.width,height:t.height||this._dimensions.height},n}};function uS({x:e,y:t},n,s,r){return{x:r*(e/=n)-s*(t/=n),y:s*e+r*t}}function dS(e){return typeof e=="number"&&isFinite(e)}function DB(e){const t=e.filter(n=>isFinite(n)&&n>0);return t.length?Fi(t):1}var OB="anonymous",zB="white",BB="default",UB={maxBlockId:1024,maxCoord:-1/0,maxScaledSize:16,maxPixelSize:255,maxMinVisibleSize:64,maxDashOffset:4,maxDashLength:3,maxGapLength:1,maxSymbolicSize:0,maxPatternScale:0},GB=Hg?"webgl":null,hS=5,VB=class extends zt{constructor(){super(...arguments),this._debug=!1,this._initDone=!1,this._boundaries={maxSize:10,maxMinVisibleSize:64},this._visibility={nodes:0,edges:0,nodeTexts:0,edgeTexts:0},this._nextAnimationId=1,this._animations=[],this._rendererState={type:null,code:null,state:"ok",message:""},this._cursorStyle=[],this._fontsNewlyLoaded=[],this._nextGeIndex=1,this._availableGeIndexes=[],this._renderOnNewFrame=!0,this._isBufferDisplayable=e=>{const t=cO(e),n=JT(e),s=t?this._visibility.nodes:this._visibility.edges,r=t?this._visibility.nodeTexts:this._visibility.edgeTexts;return s===0&&(!n||r===0)},this._onRendererChange=e=>{this._updateRendererState({type:e,state:"requested",code:null,message:void 0}),this._engine.setRenderType(e),this._modules.dom.refresh()},this._onNewFrame=()=>{this._processAnimations(),this._loadGraphInGraphicsEngine(),this._renderOnNewFrame&&this._render()},this._applyCursorStyle=()=>{const e=this._cursorStyle[this._cursorStyle.length-1]||this._modules.settings.get("cursor.default");lg(this._domWrapper,e)},this._updateImageCrossOrigin=()=>{this._imageManager.setImgCrossOrigin(this._modules.settings.get("imgCrossOrigin")||null)}}onMounted(){this._debug=this._ogma.isDebug(),this._renderOnNewFrame=!0,this._formatText=FT().applyArabicShaping,this._attributesManager=new SB(this._ogma,this._modules),this._imageManager=new hz,this._fontManager=new rO,this._engine=new hm(hm.getCachedInitData()),this._domWrapper=this._engine.getDomWrapper(),this._engine.on("error",this._onNewFrame),this._nodeAnimationMap=new Map,this._edgeAnimationMap=new Map,this._movingNodes=new Set,this._movingEdges=new Set,this._modules.events.register(["reloadFonts","rendererStateChange","beforeUpdateAttributes","updateAttributes","animate","move","pan","zoom","rotate","viewExportStart","viewExportEnd","afterImageExport","viewChanged","zoomStart"]),this._modules.settings.register("renderer",GB,this._onRendererChange),this._modules.settings.register("edgeTipRatio",dT,e=>{this._engine.setEdgeArrowSizeRatio(e),this._modules.dom.refresh()}),this._modules.settings.register("edgeMinTipSize",hT,e=>{this._engine.setEdgeMinTipSize(e),this._modules.dom.refresh()}),this._modules.settings.register("backgroundColor",zB,e=>{this._engine.parseColor(e)?this._modules.dom.refresh():(Gi(`Invalid background color "${e}" specified; will default to black.`),this._modules.settings.set("backgroundColor","black"))}),this._modules.settings.register("texts.hideUntilFontsLoaded",!0,e=>{this._fontManager.setHideUntilFontsLoaded(!!e)}),this._modules.settings.register("texts.cornerRadius",hS,e=>{this._engine.getTextManager().setCornerRadius(typeof e=="number"?e:hS),this._modules.dom.refresh()}),this._modules.settings.register("imgCrossOrigin",OB,this._updateImageCrossOrigin),this._modules.settings.register("cursor.default",BB,this._applyCursorStyle),this._modules.dom.setLayer("graphics",this._domWrapper),this._engine.setGlobalBoundaries(UB),this._modules.dom.beforeNextFrame().then(()=>{this._initDone=!0,this._fireRendererStateChangeEvent()}),this._imageManager.onFetch(()=>{this._engine.notifyPatternUpdate(),this._modules.dom.refresh()}),this._fontManager.onFontLoaded(e=>{this._fontsNewlyLoaded.push(e),this._engine.notifyPatternUpdate(),this._engine.notifyFontsReloaded(),this._modules.dom.refresh()}),this._modules.dom.addMediaListener("(min-resolution: 2dppx)",()=>this._modules.dom.refresh()),this._visibleAttributeLayer=this._attributesManager.addAttributeLayer({priority:0,name:`internal(${i_})`,tag:i_,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),this._dataAttributeLayer=this._attributesManager.addAttributeLayer({priority:0,name:`internal(${o_})`,tag:o_,nodeDependencies:void 0,edgeDependencies:void 0}),YE(this._engine,this._attributesManager.getFlexArrays()),this._modules.events.on("move",()=>this._modules.dom.refresh()).on("frame",this._onNewFrame).on("viewExportStart",()=>{this._renderOnNewFrame=!1}).on("viewExportEnd",()=>{this._renderOnNewFrame=!0}).on("clearGraph",()=>{this._nextGeIndex=1,this._availableGeIndexes=[],this._engine.clear(),this._attributesManager.clear(),this._modules.dom.refresh(),this._animations=[],this._nodeAnimationMap.clear(),this._edgeAnimationMap.clear()}).on("viewChanged",({type:e})=>{if(e==="rotate"){const t=this._modules.graph.getEdges().filter(n=>n.getAttribute("adjustAnchors"));this._attributesManager.redrawElements(t)}}).on("addNodes",e=>{this._attributesManager.updateForAllAttributeLayers(e.nodes)}).on("addEdges",e=>{this._attributesManager.updateForAllAttributeLayers(e.edges)}).on("excludedStateChange",e=>{this._visibleAttributeLayer.updateElements(e.elements)}).on("setData",e=>{this._dataAttributeLayer.updateElements(e.elements)}),hm.clearCachedInitData(),this._modules.dom.addWindowEventListener("unload",()=>this.destroy())}onReady(e){e.renderer!==void 0&&this._ogma.setOptions({renderer:e.renderer}),e.imgCrossOrigin!==void 0&&this._ogma.setOptions({imgCrossOrigin:e.imgCrossOrigin})}getTransparentBackgroundColor(){const e=this._modules.settings.get("backgroundColor");return e?this._engine.transparentify(e):null}_render(){const e=this._modules.dom.getDimensions(),t=this._modules.camera.getView(),n=or(),s=Rs(),r=this._modules.settings.get("backgroundColor"),i=this._isBufferDisplayable;this._engine.setView({x:t.x,y:t.y,zoom:t.zoom,angle:t.angle,width:e.width,height:e.height,pixelRatio:n,currentTime:s,backgroundColor:r,isBufferDisplayable:i});try{this._engine.render(),this._rendererState.state==="requested"&&this._updateRendererState({state:"ok"})}catch(o){if(this._debug)throw o;const{message:a,code:u="OTHER"}=o,d=this._rendererState.type,c=iD(d);let g=this._rendererState.state==="requested"?`Error while initializing the ${c} renderer`:`The ${c} renderer encountered an unexpected runtime error`,f=null;d==="webgl"&&(g+="; fallbacking on canvas renderer",f="canvas"),Gi(a||""),Gi(g),this._updateRendererState({state:"error",code:u,message:a}),this._modules.settings.set("renderer",f)}}_fireRendererStateChangeEvent(){const e=this._rendererState;this._modules.events.fire("rendererStateChange",{type:e.type,state:e.state,code:e.code,message:e.message})}_updateRendererState({type:e,state:t,code:n,message:s}){let r=!1;e!==void 0&&this._rendererState.type!==e&&(this._rendererState.type=e,r=!0),t!==void 0&&this._rendererState.state!==t&&(this._rendererState.state=t,r=!0),n!==void 0&&this._rendererState.code!==n&&(this._rendererState.code=n,r=!0),s!==void 0&&this._rendererState.message!==s&&(this._rendererState.message=s,r=!0),r&&this._initDone&&this._fireRendererStateChangeEvent()}getImageData(){return this._modules.dom.afterNextFrame().then(()=>this._engine.getImageData())}getNodeAttributes(){return this._attributesManager.getFlexArrays().nodes.current}getEdgeAttributes(){return this._attributesManager.getFlexArrays().edges.current}getGraphicsEngine(){return this._engine}getImageManager(){return this._imageManager}getFontManager(){return this._fontManager}allocateGraphicsEngineBlockId(){return this._availableGeIndexes.length?this._availableGeIndexes.pop():this._nextGeIndex++*sf+vF}releaseGraphicsEngineBlockId(e){this._engine.freeBlock(e),this._availableGeIndexes.push(e),this._modules.dom.refresh()}addCursorStyle(e){e&&(this._cursorStyle.push(e),this._applyCursorStyle())}removeCursorStyle(e){if(!e)return;const t=this._cursorStyle.lastIndexOf(e);t!==-1&&(this._cursorStyle.splice(t,1),this._applyCursorStyle())}reloadFonts(){this._modules.events.fire("reloadFonts"),this._engine.notifyFontsReloaded(),this._modules.dom.refresh()}getDomElement(){return this._domWrapper}setTextHidden(e,t){this._attributesManager.setTextHidden(e,t)}resetTextHidden(){this._attributesManager.resetTextHidden(),this._modules.dom.refresh()}getAttributesManager(){return this._attributesManager}_checkFontsNewlyLoaded(){return!!this._fontsNewlyLoaded.length&&(this._fontsNewlyLoaded=[],!0)}_loadGraphInGraphicsEngine(){this._attributesManager.update(),this._checkFontsNewlyLoaded()&&this._attributesManager.redrawAll(),this._modules.events.fire("beforeUpdateAttributes");const{elementsToRedraw:e,elementsUpdated:t}=this._attributesManager.getUpdatedElements(),n=t.nodes.size>0||t.edges.size>0;(t.nodeAttributesSet.has("radius")||t.edgeAttributes.includes("width"))&&(this._boundaries.maxSize=rD(this._modules.graph)),(t.nodeAttributesSet.has("shape")||t.edgeAttributes.includes("shape.head")||t.edgeAttributes.includes("shape.tail"))&&YE(this._engine,this._attributesManager.getFlexArrays()),ZO({graph:this._modules.graph,elements:e,engine:this._engine,imageManager:this._imageManager,fontManager:this._fontManager,view:this._modules.camera.getView(),attributes:this._attributesManager.getFlexArrays(),boundaries:this._boundaries,formatText:this._formatText}),n&&this._modules.events.fire("updateAttributes",t)}_forceCompleteGraphRefresh(){this._attributesManager.redrawAll(),this._loadGraphInGraphicsEngine()}export(e,t,n,s){let r;return Promise.all([this._modules.graph.getNodes().addClass(la),this._modules.graph.getEdges().addClass(la)]).then(()=>this.resolveAtNextFrame()).then(()=>this._imageManager.whenReady()).then(()=>{n==="all"?(r=qB(this._modules.graph),this._forceCompleteGraphRefresh()):this._loadGraphInGraphicsEngine();const i=this._modules.camera.clone({...t});return this._modules.events.fire("viewExportStart",{preventOverlap:s.preventOverlap,camera:i,view:i.getView()}),this._ogma.view.afterNextFrame().then(()=>this._engine.export(e,t,s))}).then(i=>Promise.all([this._modules.graph.getNodes().removeClass(la),this._modules.graph.getEdges().removeClass(la)]).then(()=>i)).then(i=>(n==="all"&&($B(r),this._forceCompleteGraphRefresh()),this._modules.events.fire("viewExportEnd"),i))}addAttributeLayer(e){return this._attributesManager.addAttributeLayer(e)}getAttributeValues(e,t,n,s){return this._attributesManager.getAttributeValues(e,t,n,s)}forceAttributesComputation(){this._attributesManager.update()}resolveAtNextFrame(e){return this._modules.dom.afterNextFrame().then(()=>e)}isMoving(e){return(e.isNode?this._movingNodes:this._movingEdges).has(e._index)}animate(e,t,n,s){const r=jB(s);return r.duration&&this._engine.ensureAnimationsReady(),this._animate(e,t,n,r)}isAnimating(){return this._animations.length>0}getAnimationInformation(e){return this._attributesManager.getAnimationInformation(e)}_toSubGraph(e){if(e instanceof Ki||e instanceof Xr)return{nodes:e.toList(),edges:e.getAdjacentEdges()};if(e instanceof Ta||e instanceof Mo)return{nodes:this._modules.graph.nodeList(),edges:e.toList()};const t=e,n={nodes:t.nodes||this._modules.graph.nodeList(),edges:t.edges||this._modules.graph.edgeList()};return n.nodes.size&&(n.edges.size?n.edges=n.edges.concat(n.nodes.getAdjacentEdges()).dedupe():n.edges=n.nodes.getAdjacentEdges()),n}_animate(e,t,n,{duration:s,easing:r}){if((!this._animations.length||n)&&!s)return t(e),Promise.resolve(e);const i=this._toSubGraph(e),o=i.nodes,a=i.edges;if(o.size===0&&a.size===0)return t(e),Promise.resolve(e);if(o.size){if(n)for(let f=0;f<o._indexes.length;f++)this._movingNodes.add(o._indexes[f]);this._modules.events.fire("animate",{elements:o,duration:s,updatesPositions:n,easing:r})}if(a.size){if(n)for(let f=0;f<a._indexes.length;f++)this._movingEdges.add(a._indexes[f]);this._modules.events.fire("animate",{elements:a,duration:s,updatesPositions:n,easing:r})}const u={id:this._nextAnimationId++,startTime:Rs(),finished:!1,func:()=>t(e),duration:s,easing:r,nodes:o,edges:a,started:!1,updatesPositions:n,resolve:Vt};let d=u;const c=new Set;if(d=this._getLongestAnimation(d,u.nodes,c),d=this._getLongestAnimation(d,u.edges,c),d.updatesPositions){for(let f=0;f<o._indexes.length;f++)this._nodeAnimationMap.set(o._indexes[f],d);for(let f=0;f<a._indexes.length;f++)this._edgeAnimationMap.set(a._indexes[f],d);u.duration=d.duration,u.startTime=d.startTime}if(u.duration===0&&d.id===u.id)return t(e),Promise.resolve(e);const g=new Promise(f=>u.resolve=()=>f(e));return this._animations.push(u),this._modules.dom.refresh(),s||this._processAnimations(),g}_removeFinishedAnimations(){this._animations=this._animations.filter(e=>!e.finished)}_getAnimationElements(e){return{nodes:e.nodes,edges:e.edges}}_resetAnimationAttributes({nodes:e,edges:t}){this._attributesManager.resetAnimationAttributes({nodes:e,edges:t});for(let n=0;n<e._indexes.length;n++)this._nodeAnimationMap.delete(e._indexes[n]),this._movingNodes.delete(e._indexes[n]);for(let n=0;n<t._indexes.length;n++)this._edgeAnimationMap.delete(t._indexes[n]),this._movingEdges.delete(e._indexes[n])}_getLongestAnimation(e,t,n){const s=t.isNode?this._nodeAnimationMap:this._edgeAnimationMap;for(let r=0;r<t._indexes.length;r++){const i=s.get(t._indexes[r]);i&&!n.has(i.id)&&(n.add(i.id),(e.updatesPositions||!i.updatesPositions)&&i.duration+i.startTime<e.duration+e.startTime||(e=i))}return e}_processAnimations(){if(!this._animations.length)return;const e=Rs(),t=[];this._attributesManager.update();for(const n of this._animations)n.started||(n.started=!0,t.push(n.func),this._attributesManager.setAnimationAttributes(this._getAnimationElements(n),n));for(const n of t)n();for(const n of this._animations)e>=n.startTime+n.duration&&(this._resetAnimationAttributes(this._getAnimationElements(n)),n.resolve(n.elements),n.finished=!0);this._removeFinishedAnimations(),this._animations.length&&this._modules.dom.refresh()}hideTexts(){this.setNodeTextsVisibility(!1),this.setEdgeTextsVisibility(!1)}showTexts(){this.setNodeTextsVisibility(!0),this.setEdgeTextsVisibility(!0)}setNodesVisibility(e){return this._updateVisibilityCounter("nodes",e)}setNodeTextsVisibility(e){return this._updateVisibilityCounter("nodeTexts",e)}setEdgesVisibility(e){return this._updateVisibilityCounter("edges",e)}setEdgeTextsVisibility(e){return this._updateVisibilityCounter("edgeTexts",e)}_updateVisibilityCounter(e,t){this._visibility[e]+=t?-1:1,this._modules.dom.refresh()}detectNode(e,t,n,s,r,i){return nD(e,t,n,s,r,i,this._modules.graph,this._attributesManager,this._modules.camera,this._engine,this._movingNodes,this._formatText)}detectEdge(e,t,n,s,r){const{bentEnable:i,bentVertical:o}=this._modules.graphics.getGraphicsEngine().getBentEdges();return sD(e,t,n,s,r,this._modules.graph,this._modules.camera,this._movingNodes,this._attributesManager,i,o)}getVisibilityCounters(){return this._visibility}destroy(){this.getGraphicsEngine().destroy(),this.getImageManager().destroy(),this.getFontManager().destroy()}};function jB(e){return typeof e=="number"?e={duration:e}:typeof e=="object"&&e!==null||(e={duration:0}),{duration:HB(e.duration),easing:e.easing||"linear",chain:!!e.chain}}function HB(e){return typeof e!="number"||!isFinite(e)||e<0?0:e}function cS(e,t){const n=t?e.getNodeAttribute("excluded"):e.getEdgeAttribute("excluded"),s=(t?e.getNodes("all"):e.getEdges("all"))._indexes,r=n.getMultiple(s);return n.fill(s,0),{excludedList:n,indexes:s,values:r}}function gS({excludedList:e,indexes:t,values:n}){e.setMultiple(t,n)}function qB(e){return{nodes:cS(e,!0),edges:cS(e,!1)}}function $B({nodes:e,edges:t}){gS(e),gS(t)}var WB=250,XB=50,YB=class extends zt{constructor(){super(...arguments),this._onAnyEvents=[],this._registeredEvents={},this.onIdle=Ug(()=>this.fire("idle"),XB)}onMounted(){this._registeredEvents={},this.register(["idle"]),this._ogma.onReady(()=>{this.on(["viewChanged","layoutEnd","addNodes","addEdges","removeNodes","removeEdges","animate","setMultipleAttributes","transformationRefresh"],()=>{this._modules.dom.clearTimeout(this._idleTimeout),this._idleTimeout=this._modules.dom.setTimeout(this.onIdle,WB)})})}isRegistered(e){return!!this._registeredEvents[e]}register(e,t=[]){e.forEach(n=>{if(this._registeredEvents[n])throw new Error(`event "${n}" already exists`);this._registeredEvents[n]=new ZB(!1,n)})}onAnyEvent(e){this._onAnyEvents.push(e)}on(e,t){return Array.isArray(e)?(e.forEach(n=>this.on(n,t)),this):this._registeredEvents[e]?(this._registeredEvents[e].on(t),this):this}off(e){return Object.values(this._registeredEvents).forEach(t=>{t.off(e)}),this}fire(e,t=null){const n=this._getEvent(e);return this._onAnyEvents.forEach(s=>s(t,e)),n.trigger(t),this}once(e,t){const n=this,s=function(){t.apply(null,arguments),n.off(s)};return this.on(e,s)}_getEvent(e){if(!(e in this._registeredEvents))throw new Error(`Event ${e} does not exist`);return this._registeredEvents[e]}destroy(){Object.values(this._registeredEvents).forEach(e=>{e.destroy()})}},ZB=class{constructor(e,t){this._subscribers=[],this._handlers=[],this._reverseOrder=e,this._name=t}trigger(e){for(const t of this._handlers)t(e,this._name);return this}on(e){if(typeof e!="function")throw new Error("handler is not a function");const t=this._reverseOrder?0:this._subscribers.length;return this._handlers.splice(t,0,e),this._subscribers.splice(t,0,e),this}off(e){let t;for(;(t=this._subscribers.indexOf(e))!==-1;)this._subscribers.splice(t,1),this._handlers.splice(t,1);return this}destroy(){this._subscribers=[],this._handlers=[]}},KB=class extends zt{onMounted(){this._graphics=this._modules.graphics,this._modules.events.register(["setMultipleAttributes"]),this._modules.events.on(["addNodes","addEdges"],({nodes:e,edges:t,objects:n})=>{this._onAddElements(e||t,n)}),this._originalAttributesLayer=this._graphics.addAttributeLayer({name:"original-attributes",priority:XM,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),this._individualAttributesLayer=this._graphics.addAttributeLayer({name:"individual-attributes",priority:KM,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0})}_onAddElements(e,t){const n=t.map(s=>s.attributes);this._originalAttributesLayer.setAttributeValues(e,n)}getOriginalAttributes(){return this._originalAttributesLayer.getFlexArrays()}getIndividualAttributes(){return this._individualAttributesLayer.getFlexArrays()}setMultipleAttributes(e,t,n){const s=Array.isArray(t)?t.length&&t[0]?Cg(t[0],e.isNode):[]:Cg(t,e.isNode),r=s.includes("x")||s.includes("y"),i=[];return this._modules.events.fire("setMultipleAttributes",{elements:e,values:t,updatedAttributes:s,options:n,promises:i}),this._graphics.animate(e,()=>{this._individualAttributesLayer.setAttributeValues(e,t)},r,n).then(o=>Promise.all(i).then(()=>o))}setSingleAttribute(e,t,n,s){const r={};return Ui(r,t,n),this.setMultipleAttributes(e,r,s)}resetMultipleAttributes(e,t,n){const s=t||this._individualAttributesLayer.getUsedAttributeNames(e),r=s&&(s.includes("x")||s.includes("y")),i={};for(const o of s)Ui(i,o,void 0);return this._graphics.animate(e,()=>{this._individualAttributesLayer.setAttributeValues(e,i)},r,n)}getMultipleAttributes(e,t){return this._graphics.getAttributeValues(e,t,!0,!1)}getSingleAttribute(e,t){return this._graphics.getAttributeValues(e,t,!1,!1)}replaceOriginalAttributes(e,t,n=[]){const s={},r=this._originalAttributesLayer.getUsedAttributeNames(e).filter(i=>!n.includes(i));for(let i=0;i<r.length;++i)Ui(s,r[i],void 0);this._originalAttributesLayer.setAttributeValues(e,s),this._originalAttributesLayer.setAttributeValues(e,t)}getSinglePreviousAttribute(e,t){return this._graphics.getAttributeValues(e,t,!1,!0)}getMultiplePreviousAttributes(e,t){return this._graphics.getAttributeValues(e,t,!0,!0)}},QB=class extends zt{constructor(){super(...arguments),this._currentValue={},this._onChange={},this._defaultValues={},this._keys=[]}onReady(e){e.renderer&&this.update({renderer:e.renderer}),e.options&&this.update(e.options)}register(e,t,n,s){return s===void 0&&(s=!0),this._keys.push(e),this._currentValue[e]=t,this._defaultValues[e]=t,this._onChange[e]=n||Vt,n&&s&&n(t),this}update(e){e=cd(e);const t=this._keys,n={},s=this._currentValue;for(let i=0;i<t.length;++i){const o=t[i];if(o in e){let a=e[o];a===void 0&&(a=this._defaultValues[o]),n[o]=s[o],s[o]=a}}const r=Object.keys(n);for(let i=0;i<r.length;++i){const o=r[i],a=this._currentValue[o],u=n[o];a!==u&&this._onChange[o](a,u)}return $m(n)}get(e){return arguments.length===0?$m(this._currentValue):this._currentValue[e]}set(e,t){const n=this._currentValue[e],s=this._onChange[e];this._currentValue[e]=t,s&&s(t,n)}},JB=class{constructor(e,t){this._classes=e,this._name=t}getName(){return this._name}getIndex(){return this._classes.getIndex(this._name)}setIndex(e){return this._classes.setIndex(this._name,e)}update(e){return this._classes.update(this._name,e),this}getDefinition(){return this._classes.getDefinition(this._name)}getNodes(e){return this._classes.getElementsByClass(this._name,e).nodes}getEdges(e){return this._classes.getElementsByClass(this._name,e).edges}clearNodes(e){this.getNodes(e).removeClass(this._name)}clearEdges(e){this.getEdges(e).removeClass(this._name)}add(e){e.addClass(this._name)}remove(e){e.removeClass(this._name)}destroy(){const e=this._classes.getElementsByClass(this._name);return Promise.all([e.nodes.removeClass(this._name),e.edges.removeClass(this._name)]).then(()=>this._classes.removeClass(this._name))}},e3=1e3,t3=.5/e3,n3=class extends zt{constructor(){super(...arguments),this._builtinClasses=[],this._userClasses=[],this._classesByName={},this._onExcludedStateChange=({elements:e,value:t})=>{if(t){const n=this._builtinClasses.map(s=>s.name);this._addOrRemoveClassesToElements(n,e,!1)}},this._onClearGraph=()=>{this._builtinClasses.concat(this._userClasses).forEach(e=>e.elementSet.clear())},this._onRemoveElements=({nodes:e,edges:t})=>{const n=e||t;this._builtinClasses.concat(this._userClasses).forEach(s=>s.elementSet.removeElements(n))}}onMounted(){this._modules.events.on("excludedStateChange",this._onExcludedStateChange).on("clearGraph",this._onClearGraph).on("removeEdges",this._onRemoveElements).on("removeNodes",this._onRemoveElements)}_getClassList(e){return e?this._builtinClasses:this._userClasses}createClass({name:e,isBuiltin:t=!1,after:n,nodeAttributes:s,nodeDependencies:r,nodeOutput:i,edgeAttributes:o,edgeDependencies:a,edgeOutput:u}={}){if(typeof e!="string")throw new Error('the "name" argument should be a string');const d=this._getClassList(t),c=n?s3(d,n)+1:d.length;if(c===-1)throw new Error(`createClass: class specified as \`after\` parameter "${n}" does not exist`);if(t&&!e.startsWith("_"))throw new Error(`invalid builtin class name "${e}": builtin classes should start with '_'`);const g=new Vd(this._modules.graph),f=new JB(this,e),p={name:e,elementSet:g,attributeLayer:this._modules.graphics.addAttributeLayer({name:`class(${e})`,tag:e,standaloneSelectors:!0,nodeAttributes:s||void 0,edgeAttributes:o||void 0,nodeSelector:(_,y)=>y.hasElement(_),edgeSelector:(_,y)=>y.hasElement(_),nodeContext:g,edgeContext:g,nodeOutput:i,edgeOutput:u,nodeDependencies:r,edgeDependencies:a}),isBuiltin:t,wrapper:f};return d.splice(c,0,p),t&&d.sort((_,y)=>Nb.indexOf(_.name)-Nb.indexOf(y.name)),this._updatePriorities(t),this._classesByName[e]=p,this._modules.events.register([al(e,!0,!0),al(e,!0,!1),al(e,!1,!0),al(e,!1,!1)]),f}removeClass(e){const t=this._get(e),n=this._getClassList(t.isBuiltin),s=n.indexOf(t);if(s===-1)throw new Error(`class "${e}" does not exist`);return n.splice(s,1),t.attributeLayer.destroy(),delete this._classesByName[e],this._updatePriorities(t.isBuiltin),Promise.resolve(void 0)}_updatePriorities(e){const t=this._getClassList(e),n=QM+(e?.5:0);for(let s=0;s<t.length;++s){const r=t[s],i=n+t3*s;r.attributeLayer.update({priority:i})}}_get(e){const t=this._classesByName[e];if(!t)throw new Error(`class "${e}" does not exist`);return t}getIndex(e){const t=this._get(e);return this._getClassList(t.isBuiltin).indexOf(t)}setIndex(e,t){const n=this._get(e),s=this._getClassList(n.isBuiltin),r=s.indexOf(n),i=Mr(t,0,s.length-1);s.splice(r,1),s.splice(i,0,n),this._updatePriorities(n.isBuiltin)}update(e,{nodeAttributes:t,edgeAttributes:n,nodeDependencies:s,edgeDependencies:r,nodeOutput:i,edgeOutput:o,fullOverwrite:a}={}){this._get(e).attributeLayer.update({nodeAttributes:t,edgeAttributes:n,nodeDependencies:s,edgeDependencies:r,nodeOutput:i,edgeOutput:o,fullOverwrite:a})}getDefinition(e){const t=this._get(e),{nodeAttributes:n,nodeDependencies:s,nodeOutput:r,edgeAttributes:i,edgeDependencies:o,edgeOutput:a}=t.attributeLayer.getDefinition();return{nodeAttributes:n||void 0,edgeAttributes:i||void 0,nodeDependencies:s,edgeDependencies:o,nodeOutput:r,edgeOutput:a}}_addOrRemoveClassesToElements(e,t,n){const s=t.isNode;for(let r=0;r<e.length;++r){const i=e[r],{elementSet:o,attributeLayer:a}=this._get(i),u=o.addOrRemoveElements(t,n),d=al(i,s,n);u.size&&(a.updateElements(u),this._modules.events.fire(d,s?{nodes:u}:{edges:u}))}}_animatedAttributesUpdatePositions(e,t){for(let n=0;n<e.length;++n){const s=e[n],r=this.getDefinition(s);if(t.isNode&&r.nodeAttributes&&(r.nodeAttributes.x||r.nodeAttributes.y))return!0}return!1}_getAnimatedAtrributes(e,t){return e.reduce((n,s)=>{const r=this.getDefinition(s);return t.isNode&&r.nodeAttributes&&n.push(...Cg(r.nodeAttributes,!0)),!t.isNode&&r.edgeAttributes&&n.push(...Cg(r.edgeAttributes,!1)),n},[])}addClassesToElements(e,t,n){const s=t.toList(),r=this._animatedAttributesUpdatePositions(e,s);return this._modules.graphics.animate(t,()=>{this._addOrRemoveClassesToElements(e,s,!0)},r,n)}removeClassesFromElements(e,t,n){const s=t.toList(),r=this._animatedAttributesUpdatePositions(e,s);return this._modules.graphics.animate(t,()=>{this._addOrRemoveClassesToElements(e,s,!1)},r,n)}hasSingleElementClass(e,t){return this._get(e).elementSet.hasElement(t)}getElementsClassList(e,t={}){const{includeBuiltinClasses:n=!1}=t,s=new Array(e.size);for(let r=0;r<s.length;++r)s[r]=[];return this._addClassNamesToList(s,e,this._userClasses),n&&this._addClassNamesToList(s,e,this._builtinClasses),s}_addClassNamesToList(e,t,n){const s=t.toList();for(let r=0;r<n.length;++r){const{name:i,elementSet:o}=n[r];for(let a=0;a<s.size;++a){const u=s.get(a);o.hasElement(u)&&e[a].push(i)}}}getClassByName(e,t=!1){const n=this._classesByName[e]||null;if(t&&!n)throw new Error(`class "${e}" does not exist`);return n&&n.wrapper}getClassList(){return this._userClasses.map(e=>e.wrapper)}getElementsByClass(e,t="visible"){const{elementSet:n}=this._get(e),s=n.getElements();let r=s.nodes,i=s.edges;return t==="visible"?(r=r.filter(o=>o.isVisible()),i=i.filter(o=>o.isVisible())):t==="raw"&&(r=r.filter(o=>!o.isVirtual()),i=i.filter(o=>!o.isVirtual())),{nodes:r,edges:i}}_onClassEvent(e,t,n,s){const r=al(e,n,s);this._modules.events.on(r,t)}onNodeClassAdded(e,t){this._onClassEvent(e,t,!0,!0)}onNodeClassRemoved(e,t){this._onClassEvent(e,t,!0,!1)}onEdgeClassAdded(e,t){this._onClassEvent(e,t,!1,!0)}onEdgeClassRemoved(e,t){this._onClassEvent(e,t,!1,!1)}};function al(e,t,n){return`${t?"node":"edge"}Class${n?"Added":"Removed"}_${e}`}function s3(e,t){for(let n=0;n<e.length;++n)if(e[n].name===t)return n;return-1}var NC=()=>({x:0,y:0,x1:0,y1:0,x2:0,y2:0});function fS(e,t,n,{cells:s=!0,boxes:r=!0,query:i=!0}={}){const o=t.keys().map(u=>t.keyToBBox(Number(u))),a=t.getBoxes();if(s&&(e.beginPath(),e.lineWidth=1,e.strokeStyle="#707070",o.forEach(u=>{e.rect(u[0],u[1],u[2]-u[0],u[3]-u[1])}),e.stroke()),r&&(e.beginPath(),e.lineWidth=1,e.strokeStyle="#ff7070",a.forEach(u=>{e.rect(u[0],u[1],u[2]-u[0],u[3]-u[1])}),e.closePath(),e.stroke()),i&&n){const u=n;e.beginPath(),e.lineWidth=2,e.strokeStyle="#3030ff",e.rect(u[0],u[1],u[2]-u[0],u[3]-u[1]),e.closePath(),e.stroke()}}function r3(e){const[t,n,s]=e.getNodeAttributes(["x","y","radius"]),[r,i,o]=e.getEdgeAttributes(["source","target","curvature"]),a=NC(),u=Qy();return d=>{if(d<0){d=-d;const c=r.get(d),g=i.get(d),f=o.get(d),p=t.get(c),_=n.get(c),y=t.get(g),x=n.get(g);c===g?(rf(p,_,f,s.get(c),0,a),lf(p,_,a.x1,a.y1,a.x2,a.y2,y,x,u)):f===0?(u.minX=Math.min(p,y),u.minY=Math.min(_,x),u.maxX=Math.max(p,y),u.maxY=Math.max(_,x)):(Ca(p,_,y,x,f,a),ex(p,_,a.x,a.y,y,x,u))}else{const c=t.get(d),g=n.get(d),f=s.get(d);u.minX=c-f,u.minY=g-f,u.maxX=c+f,u.maxY=g+f}return[u.minX,u.minY,u.maxX,u.maxY]}}var i3=["x","y","radius"],o3=["width","curvature"],a3=.5,l3=class extends zt{constructor(){super(...arguments),this._minCellSize=8,this._clear=()=>{this._index.clear(),this._elementsToUpdate.clear()},this._onGraphUpdate=e=>{if(e.nodes&&(!e.nodeAttributes||e.nodeAttributes.some(t=>i3.includes(t)))){const t=e.nodes.fastGetAdjacentElements().edges;this._elementsToUpdate.addElements(e.nodes),this._elementsToUpdate.addElements(t)}e.edges&&(e.edgeAttributes&&!e.edgeAttributes.some(t=>o3.includes(t))||this._elementsToUpdate.addElements(e.edges))}}onMounted(){this._index=new tR(this._getIntersector(),r3(this._modules.graph),this._minCellSize,1e6),this._elementsToUpdate=new Vd(this._modules.graph),this._removedNodes=this._modules.graph.getNodeAttribute("removed"),this._removedEdges=this._modules.graph.getEdgeAttribute("removed"),this._excludedNodes=this._modules.graph.getNodeAttribute("excluded"),this._excludedEdges=this._modules.graph.getEdgeAttribute("excluded"),this._queryResult={edges:[],nodes:[]},this._queryBounds=[0,0,0,0],this._modules.events.on(["addNodes","addEdges","removeNodes","removeEdges","updateAttributes"],this._onGraphUpdate).on("excludedStateChange",({elements:e})=>{this._elementsToUpdate.addElements(e)}).on("clearGraph",this._clear)}_getIntersector(){const e=this._modules.graph,[t,n,s]=e.getNodeAttributes(["x","y","radius"]),[r,i,o,a]=e.getEdgeAttributes(["source","target","width","curvature"]),u=NC(),d=this._modules.camera.getAngle(),c=Math.cos(d),g=Math.sin(d);return(f,p,_,y,x)=>{const{bentEnable:E,bentVertical:b}=this._modules.graphics.getGraphicsEngine().getBentEdges();if(f<0){f=-f;const S=r.get(f),A=i.get(f),C=a.get(f),k=o.get(f)/2,M=t.get(S),R=n.get(S),O=t.get(A),j=n.get(A);return E?(of(M*c-R*g,R*c+M*g,O*c-j*g,j*c+O*g,C,E,b,u),f_(M,R,u.x1*c+u.y1*g,u.y1*c-u.x1*g,u.x2*c+u.y2*g,u.y2*c-u.x2*g,O,j,p-k,_-k,y+k,x+k)):S===A?(rf(M,R,C,s.get(S),0,u),f_(M,R,u.x1,u.y1,u.x2,u.y2,O,j,p-k,_-k,y+k,x+k)):C===0?tx(M,R,O,j,p-k,_-k,y+k,x+k):(Ca(M,R,O,j,C,u),j1(M,R,u.x,u.y,O,j,p-k,_-k,y+k,x+k))}return Fy(t.get(f),n.get(f),s.get(f),p,_,y,x)}}reindex(){this._modules.graphics.forceAttributesComputation(),this._index.clear(),this._elementsToUpdate.clear(),this._updateItems(this._modules.graph.getNodes("all")._indexes,this._modules.graph.getEdges("all")._indexes)}getSize(){return this._index.size}_updateIndex(){if(!this._elementsToUpdate.isEmpty()){const{nodes:e,edges:t}=this._elementsToUpdate.getElements();if(e._indexes.length/this._modules.graph.getNodes("all").size>a3)return void this.reindex();this._updateItems(e._indexes,t._indexes),this._elementsToUpdate.clear()}}_updateItems(e,t){const n=this._index,s=this._removedNodes,r=this._removedEdges,i=this._excludedNodes,o=this._excludedEdges,a=[],u=[];if(s&&i)for(let d=0;d<e.length;d++){const c=e[d];s.get(c)!==0||i.get(c)!==0?a.push(c):(n.has(c)&&a.push(c),u.push(c))}if(r&&o)for(let d=0;d<t.length;d++){const c=-t[d];r.get(-c)!==0||o.get(-c)!==0?a.push(c):(n.has(c)&&a.push(c),u.push(c))}for(const d of a)n.remove(d);for(const d of u)n.insert(d)}getNodesInScreenByDistance(e){const{x:t,y:n}=e.getPositionOnScreen();return this._modules.graph.getNodes().filter(s=>s.isInScreen()&&s!==e).sort((s,r)=>{const i=s.getPositionOnScreen(),o=r.getPositionOnScreen();return ss(i.x,i.y,t,n)-ss(o.x,o.y,t,n)})}getNearestNodesForNode(e,t=240,n){const{x:s,y:r}=e.getPosition();return this.getNearestNodes(s,r,t,n,e)}getNearestNodes(e,t,n,s,r){if(this._updateIndex(),s){const i=this._modules.camera.screenToGraphVector({x:n,y:n});n=ss(0,0,i.x,i.y)}return this._getNearestNodes(e,t,n,r)}_getNearestNodes(e,t,n,s){const r=[],i=n*n,o=s?s._index:0,a=this._modules.graph.getNodes()._indexes,[u,d]=this._modules.graph.getNodeAttributes(["x","y"]);for(let c=0,g=a.length;c<g;c++){const f=a[c];if(f===o)continue;const p=e-u.get(f),_=t-d.get(f);p*p+_*_<=i&&r.push(f)}return this._modules.graph.nodeList(new Uint32Array(r))}queryRaw(e,t,n,s){this._updateIndex();const r=this._queryBounds;r[0]=e,r[1]=t,r[2]=n,r[3]=s;const i=this._index.query(e,t,n,s),{nodes:o,edges:a}=this._queryResult;o.length=a.length=0;for(let u=0;u<i.length;u++){const d=i[u];d<0?a.push(-d):o.push(d)}return this._queryResult}queryRawProjected(e,t,n,s){const r=this._queryBounds;return r[0]=e,r[1]=t,r[2]=n,r[3]=s,this._modules.camera.projectBounds(r),this.queryRaw(r[0],r[1],r[2],r[3])}query(e,t,n,s){const r=this._modules.graph,{nodes:i,edges:o}=this.queryRaw(e,t,n,s);return{nodes:r.nodeList(new Uint32Array(i.slice())),edges:r.edgeList(new Uint32Array(o.slice()))}}queryProjected(e,t,n,s){const r=this._modules.graph,{nodes:i,edges:o}=this.queryRawProjected(e,t,n,s);return{nodes:r.nodeList(new Uint32Array(i)),edges:r.edgeList(new Uint32Array(o))}}getNodesByBoundingBox(e,t,n,s,r){if(this._updateIndex(),r){let g;g=this._modules.camera.screenToGraphVector({x:e,y:t}),e=g.x,t=g.y,g=this._modules.camera.screenToGraphVector({x:n,y:s}),n=g.x,s=g.y}const i=this._modules.graph,o=i.getNodes()._indexes,a=[],u=i.getNodeAttribute("excluded"),[d,c]=i.getNodeAttributes(["x","y"]);for(let g=0,f=o.length;g<f;g++){const p=o[g];if(u&&u.get(p))continue;const _=d&&d.get(p),y=c&&c.get(p);_>=e&&_<=n&&y>=t&&y<=s&&a.push(p)}return i.nodeList(new Uint32Array(a))}toggleDebug(e){e?(this._layer=this._modules.layers.addCanvasLayer(t=>{fS(t,this._index,this._queryBounds)},{isStatic:!1,noClear:!1}),this._layer.moveToTop()):this._layer&&(this._layer.destroy(),this._layer=null)}renderDebug(e){if(!this._layer)return this.toggleDebug(!0);this._layer.refresh(t=>{fS(t,this._index,this._queryBounds,e)})}},IC={};function cf(e,t,n,s,r=0,i=Math.sin(r),o=Math.cos(r),a=[0,0,0,0]){const u=n/2,d=s/2,c=e+u,g=t+d;if(r===0)return a[0]=e,a[1]=t,a[2]=e+n,a[3]=t+s,a;let f,p,_,y,x,E,b,S;return _=-u,y=-d,f=c+_*o-y*i,p=g+_*i+y*o,x=b=f,E=S=p,_=-u,y=d,f=c+_*o-y*i,p=g+_*i+y*o,f<x?x=f:f>b&&(b=f),p<E?E=p:p>S&&(S=p),_=u,y=d,f=c+_*o-y*i,p=g+_*i+y*o,f<x?x=f:f>b&&(b=f),p<E?E=p:p>S&&(S=p),_=u,y=-d,f=c+_*o-y*i,p=g+_*i+y*o,f<x?x=f:f>b&&(b=f),p<E?E=p:p>S&&(S=p),a[0]=x,a[1]=E,a[2]=b,a[3]=S,a}function jd(e,t,n,s,r=0){const i=n/2,o=s/2,a=e+i,u=t+o;if(r===0)return[{x:e,y:t},{x:e+n,y:t},{x:e+n,y:t+s},{x:e,y:t+s}];const d=Math.sin(r),c=Math.cos(r);let g,f,p,_;p=-i,_=-o,g=a+p*c-_*d,f=u+p*d+_*c;const y={x:g,y:f};p=-i,_=o,g=a+p*c-_*d,f=u+p*d+_*c;const x={x:g,y:f};p=i,_=o,g=a+p*c-_*d,f=u+p*d+_*c;const E={x:g,y:f};return p=i,_=-o,g=a+p*c-_*d,f=u+p*d+_*c,[y,x,E,{x:g,y:f}]}function B_(e,t=0,n=1,s=D1.slice()){const r=n*Math.sin(t),i=n*Math.cos(t);return s[0]=e[0]+r,s[1]=e[1]+i,s[2]=e[2]+r,s[3]=e[3]+i,s}function u3(e,t){return z1(e,t)}function d3(e,t){return kC(e[0],e[1],e[2],e[3],t[0],t[1],t[2],t[3])}function h3(e,t,n,s,r,i,o,a){return e>r&&e<o&&t>i&&t<a||n>r&&n<o&&s>i&&s<a}function kC(e,t,n,s,r,i,o,a){return s>=i&&t<=a&&n>=r&&e<=o}Id(IC,{angle:()=>ZF,circleCircleIntersection:()=>Py,circleContainsCircle:()=>MP,circleContainsPoint:()=>kP,circleIntersectsBox:()=>Fy,circleLineIntersection:()=>B1,circleSortCompare:()=>Ry,computeCentroid:()=>JO,cubicBezierAABB:()=>f_,defaultAABB:()=>D1,degreesToRadians:()=>IP,distToSegmentSquared:()=>nx,distance:()=>ss,distancePointSegment:()=>GT,extendBounds:()=>z1,getAABB:()=>cf,getBentEdgesControlPoints:()=>of,getBezierCurveBoundingBox:()=>lf,getClosestPointOnLine:()=>QF,getClosestPointOnSegment:()=>VT,getNormalOnEdge:()=>$F,getNormalOnQuadraticCurve:()=>OT,getOBBPoints:()=>jd,getPointOnBezierCurve:()=>xd,getPointOnEdge:()=>qF,getPointOnQuadraticCurve:()=>af,getQuadraticBezierCurveLength:()=>XF,getQuadraticCurveBoundingBox:()=>ex,getQuadraticCurveControlPoint:()=>Ca,getSelfLoopControlPoints:()=>rf,getTangentOnEdge:()=>WF,getTangentOnQuadraticCurve:()=>Jy,intersects:()=>h3,isPointInLine:()=>BT,isPointInPolygon:()=>bd,isPointOnBezierCurve:()=>w_,isPointOnQuadraticCurve:()=>zT,lineAABB:()=>tx,lineAngle:()=>Ol,lineIntersection:()=>KF,lineLine:()=>bl,minDisk:()=>Od,move:()=>NP,moveAABB:()=>B_,normalize:()=>O1,overlaps:()=>kC,overlapsAABB:()=>d3,padBounds:()=>u3,polygonsIntersect:()=>o2,quadBezierAABB:()=>j1,radiansToDegrees:()=>c_,rotate:()=>mg,segmentIntersection:()=>qu,segmentRectangleIntersection:()=>UT,squaredDistance:()=>Wc,twoSegmentsIntersect:()=>YF});var Lc=40;function MC(e,t){const n=e.getAttribute("curvature"),s=e.getSource(),r=e.getTarget(),i=s.getPositionOnScreen();if(s===r){const y=(n+s.getAttribute("radius"))*bg*t,x=i.x,E=i.y,b=x-y,S=E,A=x,C=E+y;return[i,...[.2,.4,.6,.8].map(k=>xd(k,x,E,x,E,b,S,A,C)),i]}const o=r.getPositionOnScreen();if(n===0)return[i,o];const a=o.x-i.x,u=o.y-i.y,d=Math.sqrt(a*a+u*u),c=(i.x+o.x)/2,g=(i.y+o.y)/2,f=n*(d/ef)*2,p=c+u/d*f,_=g+-a/d*f;return[i,...[.25,.5,.75].map(y=>af(y,i.x,i.y,o.x,o.y,p,_)),o]}function c3(e,t,n){const s=e.getSource(),r=e.getTarget(),i=s.getPositionOnScreen(),o=r.getPositionOnScreen();if(bd(i.x,i.y,t)||bd(o.x,o.y,t))return!0;const a=MC(e,n);for(let u=0;u<a.length-1;++u){const d=a[u],c=a[u+1];for(let g=0;g<t.length-1;++g){const f=t[g],p=t[g+1];if(bl(d.x,d.y,c.x,c.y,f.x,f.y,p.x,p.y))return!0}}return!1}function g3(e,t,n){const s=e.getPositionOnScreen(),r=Number(e.getAttribute("radius"))*n;return PC(s.x,s.y,r,t)}function PC(e,t,n,s){const r=e-n,i=t-n,o=t+n;return e+n>=s.minX&&r<=s.maxX&&o>=s.minY&&i<=s.maxY}function f3(e,t,n){const s=MC(e,n);for(let r=0;r<s.length-1;++r){const i=s[r],o=s[r+1];if(tx(i.x,i.y,o.x,o.y,t.minX,t.minY,t.maxX,t.maxY))return!0}return!1}function pS(e,t,n,s){typeof n=="number"&&(n={left:n,right:n,top:n,bottom:n});const r=n.left===void 0?Lc:n.left,i=n.right===void 0?Lc:n.right,o=n.top===void 0?Lc:n.top,a=n.bottom===void 0?Lc:n.bottom,u=r+i,d=o+a,c=e.width===0?e.maxFixedSize:e.width,g=e.height===0?e.maxFixedSize:e.height,f=DB([(t.width-u)/(c+e.maxScaledSize),(t.height-d)/(g+e.maxScaledSize),(t.width-u-e.maxFixedSize)/c,(t.height-d-e.maxFixedSize)/g,s/e.maxScaledSize||NaN]);return{x:e.cx+(i-r)/(2*f),y:e.cy+(a-o)/(2*f),zoom:f}}var p3="cubicOut",mS=200,m3=class extends zt{constructor(){super(...arguments),this._isLocating=!1,this._cacheValid=!0,this._cachedGraphBoundingBox=new Ws,this._onLocateStart=()=>{this._isLocating=!0},this._onLocated=()=>{this._isLocating=!1,this._modules.events.fire("locate")},this._invalidCache=()=>{this._cacheValid=!1}}onMounted(){this._modules.events.register(["locate"]),this._modules.events.on(["addNodes","removeNodes","addEdges","removeEdges","excludedStateChange","clearGraph","updateAttributes"],this._invalidCache)}onReady(){this.locateGraph({},!0)}locateGraph(e,t=!1){return this._onLocateStart(),t?this._locateGraph(e):this._modules.transformations.whenApplied().then(()=>this._locateGraph(e))}_locateGraph(e){return this._locateBoundingBox(this.getGraphBoundingBox(),e).then(this._onLocated)}locateElements(e,t){return this._modules.transformations.whenApplied().then(()=>this._locateBoundingBox(this.getBoundingBox(e),t)).then(this._onLocated)}locateRawGraph(e,t){return this._onLocateStart(),this._locateBoundingBox(this.getRawGraphBoundingBox(e),t).then(this._onLocated)}isLocating(){return this._isLocating}getGraphBoundingBox(e=!1){if(e){const t=this.getBoundingBox(this._ogma.getNodes(),!0,e),n=this.getBoundingBox(this._ogma.getEdges(),!1,e);return t.extend(n)}return this._cacheValid||this._updateCache(),Object.assign({},this._cachedGraphBoundingBox)}forceInvalidCache(){this._invalidCache()}_updateCache(){this._cacheValid=!0,this._cachedGraphBoundingBox=this.getBoundingBox(this._modules.graph.getNodes()).extend(this.getBoundingBox(this._modules.graph.getEdges()))}getBoundingBox(e,t=!1,n=!1,s){let r;if(r=e.isNode?this._getNodesBoundingBox(e.toList(),t):this._getEdgesBoundingBox(e.toList(),s),n){const i=this._ogma.modules.labels.getTextsBoundingBox(e.isNode?e.toList():null,e.isNode?null:e.toList());r=r.extend(i)}return r}_getNodesBoundingBox(e,t=!1){this._modules.graphics.forceAttributesComputation();const n=this._modules.graphics.getNodeAttributes(),s=[],r=[],i=[],o=[];for(let a=0;a<e.size;++a){const u=e._indexes[a];if(n.excluded.get(u)===0){const d=n.x.get(u),c=n.y.get(u),g=n.radius.get(u),f=2*g;n.scalingMethod.get(u)==="scaled"?i.push(f):o.push(f),t?(s.push(d-g,d+g),r.push(c-g,c+g)):(s.push(d),r.push(c))}}return new Ws({xValues:s,yValues:r,scaledSizeValues:i,fixedSizeValues:o})}_getEdgesBoundingBox(e,t=!1){return this._getEdgesBoundingBoxInternal(e._indexes,t)}_getEdgesBoundingBoxInternal(e,t=!1,n,s){this._modules.graphics.forceAttributesComputation();const r=this._modules.graphics.getEdgeAttributes(),i=this._modules.graphics.getNodeAttributes(),o={x1:0,y1:0,x2:0,y2:0},a={x:0,y:0},u={minX:0,minY:0,maxX:0,maxY:0},d=[],c=[],g=[],f=[],p=n||i.x,_=s||i.y;for(let y=0;y<e.length;++y){const x=e[y],E=r.source.get(x),b=r.target.get(x),S=r.curvature.get(x),A=p.get(E),C=_.get(E),k=i.scalingMethod.get(E)==="scaled",M=2*i.radius.get(E),R=p.get(b),O=_.get(b),j=i.scalingMethod.get(b)==="scaled",z=2*i.radius.get(b);k?g.push(M):f.push(M),j?g.push(z):f.push(z),t||S===0?(d.push(A,R),c.push(C,O)):E===b?(sx(A,C,S,M/2,0,o),lf(A,C,o.x1,o.y1,o.x2,o.y2,R,O,u),d.push(u.minX,u.maxX),c.push(u.minY,u.maxY)):(uf(A,C,R,O,S,a),ex(A,C,a.x,a.y,R,O,u),d.push(u.minX,u.maxX),c.push(u.minY,u.maxY))}return new Ws({xValues:d,yValues:c,scaledSizeValues:g,fixedSizeValues:f})}getRawGraphBoundingBox(e){const t=e.nodes.length,n=new Array(t),s=new Array(t),r=new Array(t);for(let i=0;i<t;i++){const o=e.nodes[i].attributes||{};n[i]=o.x||0,s[i]=o.y||0,r[i]=o.radius||5}return new Ws({xValues:n,yValues:s,scaledSizeValues:r})}_locateBoundingBox(e,t={}){if(isNaN(e.cx))return Promise.resolve();const{padding:n={},easing:s=p3,duration:r=0,maxNodeSizeOnScreen:i=mS,ignoreZoomLimits:o=!1}=t,a=pS(e,this._modules.dom.getDimensions(),n,i),u=a.x,d=a.y,c=a.zoom,g=c/this._modules.camera.getZoom();return this._moveCamera(u,d,c,r,s,g,o)}_moveCamera(e,t,n,s,r,i,o){const a={duration:s,easing:r,ignoreZoomLimits:o},u=this._modules.camera.setCenter({x:e,y:t},a);return i>1.01||i<.99?this._modules.camera.setZoom(n,a):u}computeConfigForBounds(e,t={}){const{padding:n={},maxNodeSizeOnScreen:s=mS}=t;return pS(e,this._modules.dom.getDimensions(),n,s)}layoutDataBoundingBox({x:e,y:t,indexes:n}){const s=this._modules.graphics.getNodeAttributes(),r=[],i=[],o=[],a=[],u=new Map,d=new Map;for(let f=0;f<n.length;++f){const p=n[f],_=e[f],y=t[f];u.set(p,_),d.set(p,y);const x=2*s.radius.get(p),E=s.scalingMethod.get(p)==="scaled";r.push(_),i.push(y),E?o.push(x):a.push(x)}const c=this._modules.graph.topology.getAdjacentElements(!1,n,{bothExtremities:!0}),g=this._getEdgesBoundingBoxInternal(c,!1,u,d);return new Ws({xValues:r,yValues:i,scaledSizeValues:o,fixedSizeValues:a}).extend(g)}isEdgeInPolygon(e,t){return c3(e,t,this._modules.camera.getZoom())}isElementInView(e,{margin:t=0}={}){const{width:n,height:s}=this._modules.camera.getSize(),r={minX:-t,minY:-t,maxX:n+t,maxY:s+t};return e.isNode?this.isNodeInRectangle(e,r):this.isEdgeInRectangle(e,r)}isNodeInRectangle(e,t){if(this._modules.geo.isEnabled()){const n=this._modules.geo.getContainerCoord(e);return PC(n.x,n.y,Number(e.getAttribute("radius")),t)}return g3(e,t,this._modules.camera.getZoom())}isNodeInPolygon(e,t){const n=e.getPositionOnScreen();return bd(n.x,n.y,t)}isEdgeInRectangle(e,t){return f3(e,t,this._modules.camera.getZoom())}},_3=ko&&typeof navigator<"u"&&"msLaunchUri"in navigator&&qi&&!("documentMode"in document);function y3(e){return _3?e.wheelDeltaY/2:e.deltaY&&e.deltaMode===0?-e.deltaY/or():e.deltaY&&e.deltaMode===1?20*-e.deltaY:e.deltaY&&e.deltaMode===2?60*-e.deltaY:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?20*-e.detail:e.detail?e.detail/-32765*60:0}var x3=6,v3=class extends zt{constructor(){super(...arguments),this._px=0,this._py=0,this._pressX=0,this._pressY=0,this._left=!1,this._middle=!1,this._right=!1,this._clickCounter={left:0,middle:0,right:0},this._buttons={left:!1,middle:!1,right:!1},this._skipNextMove=!1,this._onMouseWheel=e=>{this._isEnabled()&&this._isWheelEnabled()&&(!this._disableWheelUntilMouseDown()||this._modules.dom.hasFocus())&&(e.preventDefault(),e.stopPropagation(),this._applyMouseWheelZoom(e))},this._onMouseMove=e=>{if(!this._isEnabled()||!this._setXY(e))return;const t=this._modules.position.x,n=this._modules.position.y,s=t-this._px,r=n-this._py;s===0&&r===0||(this._skipNextMove?this._skipNextMove=!1:ss(t,n,this._pressX,this._pressY)>=x3&&(this._resetClickCounter(),this._modules.events.fire("mousemoveInternal",{x:t,y:n,dx:s,dy:r,domEvent:this._evt})))},this._onDocumentMouseMove=e=>{if(!this._isEnabled()||!this._setXY(e))return;const t=this._modules.position.x,n=this._modules.position.y,s=this._bounds,r=t-this._px,i=n-this._py;(t<0||t>s.width||n<0||n>s.height)&&this._modules.events.fire("documentMouseMove",{x:t,y:n,dx:r,dy:i,domEvent:this._evt})},this._onMouseUp=e=>{if(!this._isEnabled()||!this._setXY(e))return;const t=this._modules.position.x,n=this._modules.position.y,s=this._button,r=this._evt;this._buttons[s]=!1,this._clickCounter[this._button]===1?this._modules.events.fire("clickInternal",{button:s,x:t,y:n,domEvent:r}):this._clickCounter[s]>1&&(this._modules.events.fire("doubleclickInternal",{button:s,x:t,y:n,domEvent:r}),this._resetClickCounter(s)),this._modules.events.fire("mouseupInternal",{button:s,x:t,y:n,domEvent:r})},this._onDocumentMouseup=e=>{if(!this._isEnabled()||!this._setXY(e))return;const t=this._modules.position.x,n=this._modules.position.y,s=this._button;this._buttons[s]=!1;const r=this._modules.dom;this._modules.events.fire("documentMouseUp",{button:s,x:t,y:n,domEvent:this._evt}),r.removeDirectWindowEventListener("mousemove",this._onDocumentMouseMove),r.removeDirectWindowEventListener("mouseup",this._onDocumentMouseup)},this._onMouseDown=e=>{if(!this._isEnabled()||!this._setXY(e))return;const t=this._modules.position.x,n=this._modules.position.y,s=this._button,r=this._modules.dom;this._skipNextMove=!0,this._pressX=t,this._pressY=n,this._lastMouseDownTarget=e.target,r.focus(),this._buttons[s]=!0,this._clickCounter[s]+=1;const i=s;this._dbclickTimer=r.setTimeout(()=>{this._resetClickCounter(i,0)},this._getDoubleClickTimer()),this._modules.events.fire("mousedownInternal",{button:s,x:t,y:n,domEvent:this._evt}),r.addDirectWindowEventListener("mousemove",this._onDocumentMouseMove),r.addDirectWindowEventListener("mouseup",this._onDocumentMouseup)},this._onDrop=e=>{if(!this._isEnabled()||!this._setXY(e))return;e.preventDefault();const{x:t,y:n}=this._modules.camera.screenToGraphCoordinates(this._modules.position);this._modules.events.fire("drop",{domEvent:this._evt,x:t,y:n})}}onMounted(){this._domElt=this._modules.graphics.getDomElement(),this._modules.settings.register("mouse.enabled",!0),this._modules.settings.register("mouse.wheelEnabled",!0),this._modules.settings.register("mouse.disableWheelUntilMouseDown",!1),this._modules.settings.register("mouse.doubleClickTimer",500),this._modules.events.register(["mousedownInternal","mouseupInternal","mousemoveInternal","mousewheelInternal","clickInternal","doubleclickInternal","mouseoverInternal","mouseoutInternal","documentMouseUp","documentMouseMove","drop"]),this._modules.dom.afterNextFrame().then(()=>this._initializeListeners())}get x(){return this._modules.position.x}get y(){return this._modules.position.y}get left(){return this._left}get right(){return this._right}get middle(){return this._middle}_isEnabled(){return this._modules.settings.get("mouse.enabled")}_isWheelEnabled(){return this._modules.settings.get("mouse.wheelEnabled")}_disableWheelUntilMouseDown(){return this._modules.settings.get("mouse.disableWheelUntilMouseDown")}_getDoubleClickTimer(){return this._modules.settings.get("mouse.doubleClickTimer")}_resetClickCounter(e,t=0){e?this._clickCounter[e]=t:(this._clickCounter.left=t,this._clickCounter.middle=t,this._clickCounter.right=t),this._modules.dom.clearTimeout(this._dbclickTimer),this._lastMouseDownTarget=null}_setXY(e){const t=this._domElt.getBoundingClientRect();return this._bounds=t,!!t&&(this._evt=e,this._button=Ay[e.button],this._px=this._modules.position.x,this._py=this._modules.position.y,this._modules.position.x=e.clientX-t.left,this._modules.position.y=e.clientY-t.top,this._left=this._buttons.left,this._right=this._buttons.right,this._middle=this._buttons.middle,!0)}_applyMouseWheelZoom(e){this._setXY(e)&&this._modules.events.fire("mousewheelInternal",{delta:y3(e),dx:e.deltaX,dy:e.deltaY,x:this._modules.position.x,y:this._modules.position.y,domEvent:this._evt})}_initializeListeners(){const e=this._domElt,t=this._modules.dom;qg&&this._modules.dom.addElementEventListener(document,"contextmenu",s=>{this._lastMouseDownTarget&&s.target!==this._lastMouseDownTarget&&s.preventDefault()}),t.addElementEventListener(e,"contextmenu",s=>{this._setXY(s),this._modules.dom.hasFocus()&&this._modules.settings.get("mouse.enabled")&&s.preventDefault()},!1);const n="onwheel"in e?"wheel":e.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll";t.addElementEventListener(e,n,this._onMouseWheel,{passive:!1}),t.addElementEventListener(e,"mousemove",this._onMouseMove),t.addElementEventListener(e,"mouseleave",s=>{if(!this._isEnabled())return;this._modules.dom.blur();const r=e.getBoundingClientRect();s.clientX>=r.left+1&&s.clientX<=r.right-1&&s.clientY>=r.top+1&&s.clientY<=r.bottom-1||this._modules.events.fire("mouseout",{domEvent:this._evt})}),t.addElementEventListener(e,"mousedown",this._onMouseDown),t.addElementEventListener(e,"mouseup",this._onMouseUp),t.addElementEventListener(e,"dragover",s=>{s.preventDefault()}),t.addElementEventListener(e,"drop",this._onDrop)}},b3={doubleTapTimer:500},E3=class extends zt{constructor(){super(...arguments),this._pressed=!1,this._addEvent=(e,t,n,s)=>{this._modules.dom.addElementEventListener(e,t,n,s)},this._addWinEvent=(e,t,n,s)=>{this._modules.dom.addDirectWindowEventListener(t,n,s)},this._removeWinEvent=(e,t,n)=>{this._modules.dom.removeDirectWindowEventListener(t,n)}}onMounted(){this._domElt=this._modules.graphics.getDomElement(),this._modules.settings.register("touch.enabled",!0),this._modules.events.register(["touchDown","touchUp","touchTap","touchDoubleTap","touchMove","touchStartGesture","touchProgressGesture","touchEndGesture","documentTouchMove","documentTouchUp"]),this._modules.dom.afterNextFrame().then(()=>{this._initialize(this)})}get x(){return this._modules.position.x}get y(){return this._modules.position.y}get pressed(){return this._pressed}_listen(e,t,n){if(nT){if(t==="touchstart")return FR(this._addEvent,e,n);if(t==="touchmove")return OR(this._addWinEvent,e,n);if(t==="touchend")return zR(this._addWinEvent,e,n);if(t==="touchcancel")return DR(this._addWinEvent,e,n)}return this._modules.dom.addElementEventListener(e,t,n)}_initialize(e){let t=0,n=0,s=0,r=0,i=!1,o="left",a=0,u=!1,d=!1,c=0,g=1,f=null,p=null;const _=()=>{this._modules.position.x=t,this._modules.position.y=n,this._pressed=i},y=(C,k)=>{const M=this._domElt.getBoundingClientRect();if(!M||C.touches==null)return null;const[R,O]=C.touches,j=R.clientX-M.left,z=R.clientY-M.top,X=O.clientX-M.left,oe=O.clientY-M.top,re=(j+X)/2,Q=(z+oe)/2,he=re-t,fe=Q-n,ae=ss(j,z,X,oe),me=ae/g,we=Ol(j,z,X,oe),Z={dx:he,dy:fe,rotation:we-c,scale:me};return((_e,ze,Re,We)=>{g=_e,c=ze,t=Re,n=We,_()})(ae,we,re,Q),Z},x=C=>{if(C.touches&&C.touches.length===2&&d){const k=y(C);if(k){const{dx:M,dy:R,rotation:O,scale:j}=k;this._modules.events.fire("touchProgressGesture",{dx:M,dy:R,rotation:O,scale:j,x:t,y:n,domEvent:f,button:o})}}},E=C=>{if(o=Ay[C.button],!C.touches)return!1;if(C.touches.length!==1)return i=!1,C.touches.length>1&&this._modules.events.fire("touchUp",{x:t,y:n,domEvent:f,button:o}),!1;const k=this._domElt.getBoundingClientRect();return k&&(s=t,r=n,t=C.touches[0].clientX-k.left|0,n=C.touches[0].clientY-k.top|0,i=!0,f=C,_()),!0},b=()=>{a=0,this._modules.dom.clearTimeout(p)},S=C=>{if(C.preventDefault(),!C.touches)return;if(C.touches.length!==2&&d&&(d=!1,this._modules.events.fire("touchEndGesture",{domEvent:f})),E(C),C.touches.length===0){const M={x:t,y:n,domEvent:f,button:o};a===1&&this._modules.events.fire("touchTap",M),a>1&&(this._modules.events.fire("touchDoubleTap",M),b()),this._modules.events.fire("touchUp",M)}const k=$i().documentElement;Xb(this._removeWinEvent,k,"touchmove",this._onMove),Xb(this._removeWinEvent,k,"touchend",this._onEnd)},A=C=>{x(C),u?u=!1:(b(),E(C)&&this._modules.events.fire("touchMove",{x:t,y:n,dx:t-s,dy:n-r,domEvent:f,button:o}))};this._listen(this._domElt,"touchstart",C=>{if(!C.touches)return;C.touches.length!==2||d||(g=1,y(C)&&(d=!0,this._modules.events.fire("touchStartGesture",{domEvent:f}))),E(C)&&(this._modules.dom.focus(),this._modules.events.fire("touchDown",{x:t,y:n,domEvent:f,button:o}),a+=1,p=this._modules.dom.setTimeout(b,b3.doubleTapTimer),u=!0);const k=$i().documentElement;this._onMove=this._listen(k,"touchmove",A),this._onEnd=this._listen(k,"touchend",S)})}},S3=class{getHoveredElement(){return this.modules.captor.getPointedElement()}getPointerInformation(){return this.modules.captor.getCursorInformation()}},A3=class{getNodesByClassName(e,t){return this.modules.classes.getClassByName(e,!0).getNodes(t)}getEdgesByClassName(e,t){return this.modules.classes.getClassByName(e,!0).getEdges(t)}},xx={};Id(xx,{gexf:()=>RC,gexfFromUrl:()=>vx,graphml:()=>zC,graphmlFromUrl:()=>BC,janus:()=>FC,json:()=>DC,jsonFromUrl:()=>bx,mtx:()=>w3,mtxFromUrl:()=>T3,neo4j:()=>OC});var pi=fy(cw()),RC=e=>Promise.resolve(pi.gexf(e)),vx=e=>Hl(e).then(t=>pi.gexf(t)),FC=e=>Promise.resolve(pi.janus(e)),DC=(e,t)=>Promise.resolve(pi.json(e,t)),bx=(e,t)=>Hl(e).then(n=>pi.json(n,t)),OC=e=>Promise.resolve(pi.neo4j(e)),zC=(e,t)=>Promise.resolve(pi.graphml(e,t)),BC=(e,t)=>Hl(e).then(n=>pi.graphml(n,t)),w3=e=>Promise.resolve(pi.mtx(e)),T3=e=>Hl(e).then(t=>pi.mtx(t)),C3=class extends En{constructor(){super(...arguments),this.wait=e=>new Promise(t=>setTimeout(t,e)),this.initRandomGraph=e=>this._ogma.generate.random(e).then(this._ogma.setGraph).then(()=>this._ogma.view.locateGraph()).then(()=>this._ogma.view.afterNextFrame()),this.initGrid=e=>{const t=Math.ceil(Math.sqrt(e));return this._ogma.generate.grid({rows:t,columns:t}).then(n=>this._ogma.setGraph(n)).then(()=>this._ogma.view.locateGraph())},this.initLine=e=>(this._ogma.setGraph({nodes:[{id:0,attributes:{x:0,y:0}},{id:1,attributes:e?{x:0,y:50}:{x:50,y:0}}],edges:[{id:0,source:1,target:0}]}),this._ogma.view.locateGraph()),this.initSingleNode=()=>(this._ogma.setGraph({nodes:[{id:0,attributes:{x:0,y:0}}],edges:[]}),this._ogma.view.locateGraph()),this.initContinuousRenderLoop=({triggerKey:e="r",start:t=!0}={})=>{let n=t;const s=()=>{n&&this._ogma.modules.dom.beforeNextFrame().then(s)};document.addEventListener("keydown",({key:r})=>{r===e&&(n=!n,s())}),s()},this.appendToBody=()=>{const e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.bottom="0",e.style.right="0",document.body.appendChild(e),this._ogma.setContainer(e)},this.loadFile=e=>(e.endsWith(".gexf")?vx(e):bx(e)).then(t=>this._ogma.setGraph(t)).then(()=>this._ogma.view.locateGraph()).then(()=>this._ogma.view.afterNextFrame()),this.enableLasso=e=>{this._ogma.events.on("dragStart",()=>{this._ogma.keyboard.isKeyPressed("ctrl")&&this._ogma.tools.lasso.enable(e)})},this.randomizeGraph=({minX:e=0,minY:t=0,maxX:n=500,maxY:s=500}={})=>this._ogma.getNodes().setAttributes(this._ogma.getNodes().map(()=>({x:e+Math.random()*(n-e),y:t+Math.random()*(s-t)})))}},L3=class{setContainer(e){this.modules.dom.setContainer(e)}getContainer(){return this.modules.dom.getContainer()}},N3=class extends En{constructor(){super(...arguments),this.once=(e,t)=>(this._ogma.modules.events.once(e,t),this),this.removeListener=e=>{this._ogma.modules.events.off(e)},this.onNodesAdded=e=>(this._ogma.events.on("addNodes",e),this._ogma),this.onBeforeNodesRemoved=e=>(this._ogma.events.on("beforeRemoveNodes",e),this._ogma),this.onNodesRemoved=e=>(this._ogma.events.on("removeNodes",e),this._ogma),this.onEdgesAdded=e=>(this._ogma.events.on("addEdges",e),this._ogma),this.onBeforeEdgesRemoved=e=>(this._ogma.events.on("beforeRemoveEdges",e),this._ogma),this.onEdgesRemoved=e=>(this._ogma.events.on("removeEdges",e),this._ogma),this.onGraphCleared=e=>(this._ogma.events.on("clearGraph",e),this._ogma),this.onNodesClassAdded=(e,t)=>(this._ogma.modules.classes.onNodeClassAdded(e,t),this._ogma),this.onNodesClassRemoved=(e,t)=>(this._ogma.modules.classes.onNodeClassRemoved(e,t),this._ogma),this.onEdgesClassAdded=(e,t)=>(this._ogma.modules.classes.onEdgeClassAdded(e,t),this._ogma),this.onEdgesClassRemoved=(e,t)=>(this._ogma.modules.classes.onEdgeClassRemoved(e,t),this._ogma),this.onNodeDragStart=e=>(this._ogma.events.on("nodesDragStart",e),this._ogma),this.onNodeDragProgress=e=>(this._ogma.events.on("nodesDragProgress",e),this._ogma),this.onNodeDragEnd=e=>(this._ogma.events.on("nodesDragEnd",e),this._ogma),this.onDrop=e=>(this._ogma.events.on("drop",e),this._ogma),this.onNodesSelected=e=>this.onNodesClassAdded(Nn,e),this.onNodesUnselected=e=>this.onNodesClassRemoved(Nn,e),this.onEdgesSelected=e=>this.onEdgesClassAdded(Nn,e),this.onEdgesUnselected=e=>this.onEdgesClassRemoved(Nn,e),this.onNodeDataChange=e=>(this._ogma.events.on("updateNodeData",e),this._ogma),this.onEdgeDataChange=e=>(this._ogma.events.on("updateEdgeData",e),this._ogma),this.onAnimate=e=>(this._ogma.events.on("animate",e),this._ogma),this.onMouseMove=e=>(this._ogma.events.on("mousemove",e),this._ogma),this.onMouseButtonDown=e=>(this._ogma.events.on("mousedown",e),this._ogma),this.onMouseButtonUp=e=>(this._ogma.events.on("mouseup",e),this._ogma),this.onClick=e=>(this._ogma.events.on("click",e),this._ogma),this.onDoubleClick=e=>(this._ogma.events.on("doubleclick",e),this._ogma),this.onMouseWheel=e=>(this._ogma.events.on("mousewheel",e),this._ogma),this.onHover=e=>(this._ogma.events.on("mouseover",e),this._ogma),this.onUnhover=e=>(this._ogma.events.on("mouseout",e),this._ogma),this.onDragStart=e=>(this._ogma.events.on("dragStart",e),this._ogma),this.onDragProgress=e=>(this._ogma.events.on("dragProgress",e),this._ogma),this.onDragEnd=e=>(this._ogma.events.on("dragEnd",e),this._ogma),this.onGestureStart=e=>(this._ogma.events.on("gestureStart",e),this._ogma),this.onGestureProgress=e=>(this._ogma.events.on("gestureProgress",e),this._ogma),this.onGestureEnd=e=>(this._ogma.events.on("gestureEnd",e),this._ogma),this.onRendererStateChange=e=>(this._ogma.events.on("rendererStateChange",e),this._ogma),this.onZoomProgress=e=>(this._ogma.events.on("zoom",e),this._ogma),this.onViewChanged=e=>(this._ogma.events.on("viewChanged",e),this._ogma),this.onNodesConnected=e=>(this._ogma.events.on("connectNodes",e),this._ogma),this.onGeoModeEnabled=e=>(this._ogma.events.on("geoEnabled",e),this._ogma),this.onGeoModeDisabled=e=>(this._ogma.events.on("geoDisabled",e),this._ogma),this.onGeoModeLoaded=e=>(this._ogma.events.on("geoLoaded",e),this._ogma),this.onLayoutStart=e=>(this._ogma.events.on("layoutStart",e),this._ogma),this.onLayoutComplete=e=>(this._ogma.events.on("layoutEnd",e),this._ogma),this.onLayoutComputed=e=>(this._ogma.events.on("layoutComputed",e),this._ogma),this.onTooltipShown=e=>(this._ogma.events.on("tooltipShow",e),this._ogma),this.onTooltipHidden=e=>(this._ogma.events.on("tooltipHide",e),this._ogma),this.onTransformationEnabled=e=>(this._ogma.events.on("transformationEnabled",e),this._ogma),this.onTransformationDisabled=e=>(this._ogma.events.on("transformationDisabled",e),this._ogma),this.onTransformationSetIndex=e=>(this._ogma.events.on("transformationSetIndex",e),this._ogma),this.onTransformationDestroyed=e=>(this._ogma.modules.events.on("transformationDestroyed",e),this._ogma),this.onTransformationRefreshed=e=>(this._ogma.events.on("transformationRefresh",e),this._ogma)}on(e,t){return this._ogma.modules.events.on(e,t),this}off(e){return this._ogma.modules.events.off(e),this}onKeyPress(e,t){return this._ogma.modules.keyboard.onKeyPress(e,t),this._ogma}};function Ng(e,t,n){if(e!=null)return Array.isArray(e)?e[0]:e}function U_(e){return e==null?null:typeof e=="string"||typeof e=="number"?`${e}`:e&&U_(e.content)}function I3(e){if(e!=null)return typeof e=="string"?e:e.style||"line"}var k3=["color","radius","shape","text.content","x","y"],M3=["color","width","shape.body","text.content"];function P3(e){return e!=="all"?{nodes:["x","y"],edges:[]}:{nodes:k3,edges:M3}}function R3(e,{nodes:t,edges:n}){const s=e.getOriginalAttributes();return{nodes:t.reduce((r,i)=>(r[i.getId()]={x:s.nodes.x.get(i._index),y:s.nodes.y.get(i._index),color:Ng(s.nodes.color.get(i._index)),radius:s.nodes.radius.get(i._index),shape:s.nodes.shape.get(i._index),text:{content:s.nodes.text.content.get(i._index)}},r),{}),edges:n.reduce((r,i)=>(r[i.getId()]={color:Ng(s.edges.color.get(i._index)),width:s.edges.width.get(i._index),shape:{type:s.edges.shape.body.get(i._index)},text:{content:s.edges.text&&s.edges.text.content&&s.edges.text.content.get(i._index)}},r),{})}}function F3(e){return{nodes:e.nodes.map(({id:t,attributes:n={},data:s})=>{const{color:r,radius:i,shape:o,text:a,x:u,y:d}=n;return{id:t,x:u,y:d,color:Ng(r),size:i,shape:o,text:U_(a),data:s}}),edges:e.edges.map(({id:t,source:n,target:s,attributes:r={},data:i})=>{const{color:o,width:a,text:u,shape:d}=r;return{id:t,source:n,target:s,color:Ng(o),size:a,shape:I3(d),text:U_(u),data:i}})}}function _S(e){return e instanceof Xr?e.getId():e}function yS(e){return e instanceof Mo?e.getId():e}function xS(e){return e instanceof Ki?e.getId():e instanceof Xr?[e.getId()]:bs(e)?e.map(_S):[_S(e)]}function vS(e){return e instanceof Ta?e.getId():e instanceof Mo?[e.getId()]:bs(e)?e.map(yS):[yS(e)]}var Ex="visible";function D3(e,t){return e?xS(e):typeof t=="object"?xS(t.nodes):t||Ex}function O3(e,t){return e?vS(e):typeof t=="object"?vS(t.edges):t||Ex}function UC(e,t,n,s){const r=D3(t,s),i=O3(n,s);return{nodes:e.getNodes(r),edges:e.getEdges(i)}}function GC(e,{nodeAttributes:t,edgeAttributes:n,nodes:s,edges:r,filter:i,nodeData:o,edgeData:a}){const u=UC(e,s,r,i);return{nodes:u.nodes.toJSON({attributes:t,data:o}),edges:u.edges.toJSON({attributes:n,data:a})}}function gf(e,t,{styles:n,nodes:s,edges:r,filter:i,nodeData:o,edgeData:a}){const{nodes:u,edges:d}=P3(n),c=GC(e,{nodeAttributes:u,edgeAttributes:d,nodes:s,edges:r,filter:i,nodeData:o,edgeData:a});if(n==="original"){const g=R3(t,UC(e,s,r,i));for(const f of c.nodes)f.id!=null&&(f.attributes=g[f.id]);for(const f of c.edges)f.id!=null&&(f.attributes=g[f.id])}return n==="all"&&c.edges.forEach(({source:g,target:f,attributes:p})=>{if(p){const _=e.getNode(g);if(p.color==="source"&&_){const x=_.getAttribute("color");p.color=Array.isArray(x)?x[0]:x}const y=e.getNode(f);if(p.color==="target"&&y){const x=y.getAttribute("color");p.color=Array.isArray(x)?x[0]:x}}}),F3(c)}function z3(e,t){for(let n=0;n<t.length;++n){if(e==null)return;e=e[t[n]]}return e}function B3(e,t,n){for(let s=0;s<t.length-1;++s){const r=t[s];let i=e[r];i===void 0&&(i={},e[r]=i),e=i}e[t[t.length-1]]=n}function U3(e){const t={...e[0]};for(const n of e)for(const s of Object.keys(n))s in t||(t[s]=void 0);return Object.keys(t)}function bS(e,t){return e==null||Array.isArray(e)&&!e.length?t:e}function G3(e){return typeof e=="string"}function V3(e,t,n,s,r){const i=t==="edges",o={};return e.forEach((a,u)=>{const d=r.get(u),c=jm(bS(n(d),t));if(!c.every(G3))throw Error(`The tab ${t} function returned an invalid value.`);const g=jm(s(a.data,c));c.forEach((f,p)=>{const _=bS(g[p],{}),y=hf({internal___id:a.id,...i?{internal___source:a.source,internal___target:a.target}:{},..._}).reduce((x,{path:E,value:b})=>(x[E.join(".")]=b,x),{});o[f]=o[f]||[],o[f].push(y)})}),o}function j3(e){if(!e.length)return[];const t=U3(e),n=[t];for(const s of e)n.push(t.map(r=>s[r]));return n[0]=n[0].map(s=>s.replace("internal___","")),n}function H3(e,t,n){const s=new h2;let r=t?1:3;const i=[];for(let a=0;a<e.length;++a){const u=e[a],d=new Array(r);let c=u.data;if(n){const f={};n.forEach(p=>{const _=ba(p),y=z3(c,_);B3(f,_,y)}),c=f}const g=hf(c);d[0]=u.id,t||(d[1]=u.source,d[2]=u.target);for(let f=0;f<g.length;++f){const{path:p,value:_}=g[f];p.length&&(s.has(p)?d[s.get(p)]=_:(s.set(p,r),d[r]=_,r++))}i.push(d)}const o=[];return o.push("id"),t||(o.push("source"),o.push("target")),s.keys().forEach(a=>o.push(a[a.length-1])),i.unshift(o),i.forEach(a=>a.length=r),i}var q3=/[=+\-@|%]/,$3=e=>e.length>0&&q3.test(e[0])?`'${e=e.replace("|","|")}`:e;function VC(e){return e===void 0?"":e instanceof Date?e.toISOString():$3(""+e)}var W3={what:void 0,dataProperties:void 0,separator:",",textSeparator:'"',download:!0,filename:"graph.csv",filter:"visible",nodes:void 0,edges:void 0,nodeData:Yr,edgeData:Yr,styles:"none"};function X3(e,t){const{what:n,dataProperties:s,nodes:r,edges:i,separator:o,textSeparator:a,download:u,nodeData:d,edgeData:c,filename:g,filter:f}=pr(typeof t=="string"?{what:t}:t,W3),p=gf(e.modules.graph,e.modules.individualAttributes,{styles:"none",nodes:r,edges:i,filter:f,nodeData:d,edgeData:c});try{const _=Y3(p,{what:n,separator:o,textSeparator:a,dataProperties:s});return u&&Oo(_,g,"text","text/csv"),Promise.resolve(_)}catch(_){return Promise.reject(_)}}function Y3(e,{what:t,separator:n,textSeparator:s,dataProperties:r}){const i=new RegExp(s,"g");if(s&&s!=='"'&&s!=="'")throw new TypeError(`Invalid argument :"textSeparator" is not single-quote or double-quote, was ${s}`);if(t!=="nodes"&&t!=="edges")throw new TypeError('missing argument: "what": should have value "nodes" or "edges"');const o=t==="nodes";return H3(o?e.nodes:e.edges,o,r).map(a=>a.map(u=>function(c){return s+VC(c).replace(i,`${s}${s}`).replace(/\n/g,"\\n").replace(/\r/g,"")+s}(u))).map(a=>a.join(n)).join(`
`)}var ll=e=>Math.round(255*e);function ES(e,t){if(t==="integer"&&typeof e=="number"){if(e%1!=0)return"float"}else if(typeof e!="number")return typeof e=="boolean"?"boolean":"string";return t}var G_=e=>typeof e=="object"&&e!==null&&e.constructor===Object;function V_(e,t={}){return ci(e,(n,s)=>{G_(n)?V_(n,t):t[s]=n}),t}var Z3={creator:void 0,description:void 0,styles:"all",download:!0,filename:"graph.gexf",nodes:void 0,edges:void 0,nodeData:e=>e,edgeData:e=>e,filter:"visible"};function K3(e,t={}){const{styles:n,nodes:s,edges:r,download:i,filename:o,creator:a,description:u,filter:d,nodeData:c,edgeData:g}=pr(t,Z3),f=Q3(gf(e.modules.graph,e.modules.individualAttributes,{styles:n,nodes:s,edges:r,filter:d,nodeData:c,edgeData:g}),{creator:a,description:u});return i&&Oo(f,o,"text","text/xml"),Promise.resolve(f)}function Q3(e,t){const n=y2(),s={},r={};let i,o=0,a=0;const u=n.createElement("gexf");u.setAttribute("xmlns","http://www.gexf.net/1.2draft"),u.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz"),u.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),u.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd"),u.setAttribute("version","1.2");const d=n.createElement("meta");if(d.setAttribute("lastmodifieddate",vw()),t.creator){const y=n.createElement("creator");i=n.createTextNode(""+t.creator),y.appendChild(i),d.appendChild(y)}if(t.description){const y=n.createElement("description");i=n.createTextNode(""+t.description),y.appendChild(i),d.appendChild(y)}const c=n.createElement("graph");c.setAttribute("mode","static");const g=n.createElement("nodes");e.nodes.forEach(y=>{const x=n.createElement("node");if(x.setAttribute("id",String(y.id)),y.text&&x.setAttribute("label",pl(y.text)),G_(y.data)){const b=V_(y.data),S=n.createElement("attvalues");Object.keys(b).forEach(A=>{A in s||(s[A]={id:o,type:"integer"},o++);const C=b[A];s[A].type=ES(C,s[A].type);const k=n.createElement("attvalue");k.setAttribute("for",s[A].id),k.setAttribute("value",pl(C)),S.appendChild(k)}),x.appendChild(S)}if(y.color){const b=Fs(y.color);if(b){const S=n.createElement("viz:color");S.setAttribute("r",ll(b[0])),S.setAttribute("g",ll(b[1])),S.setAttribute("b",ll(b[2])),S.setAttribute("a",b[3]),x.appendChild(S)}}const E=n.createElement("viz:position");if(E.setAttribute("x",y.x),E.setAttribute("y",-y.y),x.appendChild(E),y.size){const b=n.createElement("viz:size");b.setAttribute("value",y.size),x.appendChild(b)}g.appendChild(x)});const f=n.createElement("attributes");f.setAttribute("class","node"),Object.keys(s).forEach(y=>{const x=n.createElement("attribute");x.setAttribute("id",s[y].id),x.setAttribute("title",y),x.setAttribute("type",s[y].type),f.appendChild(x)});const p=n.createElement("edges");e.edges.forEach(y=>{const x=n.createElement("edge");if(x.setAttribute("id",y.id.toString()),x.setAttribute("source",y.source),x.setAttribute("target",y.target),y.size&&x.setAttribute("weight",y.size),y.text&&x.setAttribute("label",pl(y.text)),G_(y.data)){const E=V_(y.data),b=n.createElement("attvalues");Object.keys(E).forEach(S=>{S in r||(r[S]={id:a,type:"integer"},a++);const A=E[S];r[S].type=ES(A,r[S].type);const C=n.createElement("attvalue");C.setAttribute("for",r[S].id),C.setAttribute("value",pl(A)),b.appendChild(C)}),x.appendChild(b)}if(y.color){const E=Fs(y.color);if(E){const b=n.createElement("viz:color");b.setAttribute("r",ll(E[0])),b.setAttribute("g",ll(E[1])),b.setAttribute("b",ll(E[2])),b.setAttribute("a",E[3]),x.appendChild(b)}}if(y.size){const E=n.createElement("viz:size");E.setAttribute("value",y.size),x.appendChild(E)}p.appendChild(x)});const _=n.createElement("attributes");return _.setAttribute("class","edge"),Object.keys(r).forEach(y=>{const x=n.createElement("attribute");x.setAttribute("id",r[y].id),x.setAttribute("title",y),x.setAttribute("type",r[y].type),_.appendChild(x)}),c.appendChild(f),c.appendChild(_),c.appendChild(g),c.appendChild(p),u.appendChild(d),u.appendChild(c),n.appendChild(u),`<?xml version="1.0" encoding="UTF-8"?>${n.serialize()}`}var J3={graphId:"G",directedEdges:!0,styles:"all",download:!0,filename:"graph.graphml",nodes:void 0,edges:void 0,nodeData:e=>e,edgeData:e=>e,filter:"visible"};function eU(e,t){const{styles:n,nodes:s,edges:r,download:i,filename:o,graphId:a,directedEdges:u,filter:d,nodeData:c,edgeData:g}=pr(t,J3),f=tU(gf(e.modules.graph,e.modules.individualAttributes,{styles:n,nodes:s,edges:r,filter:d,nodeData:c,edgeData:g}),{graphId:a,directedEdges:u,noStyles:n==="none"});return i&&Oo(f,o,"text","text/xml"),Promise.resolve(f)}function tU(e,t){const n=x2();function s(f,p,_,y,x){_=_||{};const E=n.createElement(p);for(const b in _){if(!Object.prototype.hasOwnProperty.call(_,b))continue;const S=_[b];S!==void 0&&E.setAttribute(b,S)}return(y!==void 0||x)&&(Object.prototype.toString.call(y)==="[object Object]"&&(y=JSON.stringify(y)),E.appendChild(n.createTextNode(y))),f.appendChild(E),E}const r=["id","source","target"],i=["size","x","y","shape","text","color"],o={size:{for:"all",type:"double"},x:{for:"node",type:"double"},y:{for:"node",type:"double"},shape:{for:"all",type:"string"},color:{for:"all",type:"string"},r:{for:"all",type:"int"},g:{for:"all",type:"int"},b:{for:"all",type:"int"},a:{for:"all",type:"double"},text:{for:"all",type:"string"}};t.noStyles&&(delete o.color,delete o.r,delete o.g,delete o.b,delete o.a,delete o.shape,i.pop());const a=[],u=[];function d(f,p){const _={id:f.id};i.forEach(y=>{let x=f[y];y==="y"&&x&&(x=-parseFloat(x)),x!==void 0&&(_[(p==="edge"?"edge_":"")+y]=x,y==="color"&&function(b,S){const A=Fs(S);A&&(b.r=A[0],b.g=A[1],b.b=A[2])}(_,x))}),ci(f.data||{},(y,x)=>{i.indexOf(x)===-1&&r.indexOf(x)===-1&&(o[x]?o[x].for!==p&&(o[x].for="all"):o[x]={for:p,type:"string"},_[x]=y)}),p==="edge"?(_.source=f.source,_.target=f.target,u.push(_)):a.push(_)}e.nodes.forEach(f=>d(f,"node")),e.edges.forEach(f=>d(f,"edge"));const c=s(n,"graphml",{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml","xmlns:java":"http://www.yworks.com/xml/yfiles-common/1.0/java","xmlns:sys":"http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0","xmlns:x":"http://ww.yworks.com/xml/yfiles-common/markup/2.0"});ci(o,(f,p)=>{f.for!=="node"&&f.for!=="all"||s(c,"key",{"attr.name":p,"attr.type":f.type,for:"node",id:p}),f.for!=="edge"&&f.for!=="all"||s(c,"key",{"attr.name":p,"attr.type":f.type,for:"edge",id:"edge_"+p})}),s(c,"key",{id:"nodegraphics",for:"node","yfiles.type":"nodegraphics","attr.type":"string"}),s(c,"key",{id:"edgegraphics",for:"edge","yfiles.type":"edgegraphics","attr.type":"string"});const g=s(c,"graph",{edgedefault:t.directedEdges||t.directedEdges===void 0?"directed":"undirected",id:t.graphId?t.graphId:"G","parse.nodes":e.nodes.length,"parse.edges":e.edges.length,"parse.order":"nodesfirst"});return a.forEach(f=>{const p=s(g,"node",{id:f.id});(function(y,x){const E=s(y,"data",{key:"nodegraphics"}),b=s(E,"y:ShapeNode");s(b,"y:Geometry",{x:x.x,y:x.y,width:x.size,height:x.size}),t.noStyles||s(b,"y:Fill",{color:v_(x.color),transparent:!1}),s(b,"y:NodeLabel",null,x.text||""),s(b,"y:Shape",{type:x.shape})})(p,f),ci(f,(_,y)=>{r.indexOf(y)===-1&&s(p,"data",{key:y},_,!0)})}),u.forEach(f=>{const p=s(g,"edge",{id:f.id,source:f.source,target:f.target});(function(y,x){const E=s(y,"data",{key:"edgegraphics"}),b=s(E,"y:PolyLineEdge");s(b,"y:LineStyle",{type:x.edge_type,color:t.noStyles?void 0:v_(x.edge_color),width:x.edge_size}),s(b,"y:EdgeLabel",null,x.edge_label)})(p,f),ci(f,(_,y)=>{r.indexOf(y)===-1&&s(p,"data",{key:y},_,!0)})}),`<?xml version="1.0" encoding="UTF-8"?>
${ux(n)}`}var nU={nodeAttributes:["x","y","color","radius","shape","text"],edgeAttributes:["color","width","text"],nodeData:Yr,edgeData:Yr,filter:"visible",pretty:!1,download:!0,filename:"graph.json",anonymize:!1};function sU(e,t={}){t.anonymize&&(t={nodeAttributes:"all",edgeAttributes:"all",nodeData:rg,edgeData:rg,filter:t.filter||"all",download:t.download,pretty:t.pretty,filename:t.filename});const{nodeAttributes:n,edgeAttributes:s,nodeData:r,edgeData:i,filter:o,pretty:a,download:u,filename:d}=pr(t,nU),c=GC(e.modules.graph,{nodeAttributes:n,edgeAttributes:s,filter:o,nodeData:r,edgeData:i}),g=a?JSON.stringify(c,null," "):JSON.stringify(c);return u&&Oo(g,d,"text","application/json"),Promise.resolve(c)}function rU(e,t){return e.getBoundingBox().computeForZoom(t).extend(Ws.fromValues(e.getAttribute("x"),e.getAttribute("y"),e.map(n=>n.getAttribute("radius")+n.getAttribute("innerStroke.width")+n.getAttribute("outerStroke.width"))))}function iU(e,t,n){const s=t.view.graphToScreenCoordinates(n.bottomLeft()),r=t.view.graphToScreenCoordinates(n.topRight()),i=Math.abs(r.x-s.x),o=Math.abs(r.y-s.y),a=Math.min(e.width/i,e.height/o);e.width=i*a,e.height=o*a}function jC(e,t={}){const n=e.view.get(),s=typeof t.margin=="number"?t.margin:0,r={pixelRatio:t.pixelRatio||or(),angle:0,backgroundColor:null,zoom:0,x:0,y:0,width:0,height:0,hideImages:!1,renderBackground:!0,isBufferDisplayable:sg};if(t.width&&t.height?(r.width=t.width,r.height=t.height):(r.width=n.width,r.height=n.height),t.clip)r.zoom=n.zoom,r.x=n.x,r.y=n.y;else{const i=rU(e.getNodes(t.filter),n.zoom);if(t.texts){const o=e.modules.labels.getTextsBoundingBox();o.isValid()&&i.extend(o)}t.width!=null&&isFinite(t.width)&&t.height!=null&&isFinite(t.height)||iU(r,e,i),r.width=Math.max(r.width,2*s),r.height=Math.max(r.height,2*s),r.x=i.cx,r.y=i.cy,r.zoom=Math.min((r.width-2*s)/i.width,(r.height-2*s)/i.height)}return e.modules.geo.isEnabled()?r.backgroundColor=null:t.background!==void 0&&(r.backgroundColor=t.background),r}function j_(e,t,n,s,r=!1){const i={...n,hideImages:r,angle:n.angle||0,currentTime:Rs(),isBufferDisplayable:u=>t.texts||!JT(u),bentEnable:!1,bentVertical:!1},o={};if(t.badges===!1){const u={text:null,image:null};o.badges={topLeft:u,topRight:u,bottomRight:u,bottomLeft:u}}const a=e.styles.getClass(la);return a&&a.update({nodeAttributes:o}),e.modules.graphics.export(s,i,t.filter||Ex,t)}var Nc=e=>({download:!0,filter:"visible",filename:`graph.${e}`,clip:!1,margin:10,width:void 0,height:void 0,background:null,badges:!0,legend:void 0,texts:!0,preventOverlap:!0,images:!0,textWatermark:{content:"",fontFamily:"Arial",fontSize:48,fontStyle:void 0,fontColor:"red",repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageWatermark:{url:void 0,width:void 0,height:void 0,repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageCrossOrigin:void 0,layers:!0,pixelRatio:void 0}),oU={png:Nc("png"),jpg:Nc("jpg"),tiff:Nc("tiff"),gif:Nc("gif")};function aU(e){const{canvas:t,parameters:n}=e;return n.textWatermark.content&&SS(t,n.textWatermark,pU,mU),n.imageWatermark.url?a1(n.imageWatermark.url).then(s=>(s&&(n.imageWatermark.content=s,SS(t,n.imageWatermark,yU,_U)),e)):e}function lU(e){const{ogma:t,canvas:n,parameters:s}=e,r=t.modules.legend;let i=null;return s.legend===void 0&&(i=!!r.enabled()&&r.getCurrentOptions()),s.legend===!0&&(i={}),i&&r.exportOnCanvas(n,i,e.parameters.pixelRatio),e}function uU(e){const{canvas:t,parameters:n,view:s}=e;if(!s.renderBackground)return e;s.renderBackground=!1;const r=t.getContext("2d");return r.fillStyle=n.background,r.fillRect(0,0,t.width,t.height),e}function dU(e){const{ogma:t,view:n}=e;return t.modules.geo.isEnabled()?t.modules.geo.exportBackground(n).then(s=>{const r=n.width*n.pixelRatio,i=n.height*n.pixelRatio,o=Es(r,i),a=o.getContext("2d");return a.drawImage(s,(r-s.width)/2,(i-s.height)/2),a.drawImage(e.canvas,0,0),e.canvas=o,e}):e}function hU(e){const{ogma:t,view:n,canvas:s,parameters:r}=e;return r.layers?t.modules.layers.export({view:n,canvas:s,below:!0}).then(()=>e):e}function cU(e){const{ogma:t,view:n,canvas:s,parameters:r}=e;return r.layers?t.modules.layers.export({view:n,below:!1,canvas:s}).then(()=>e):e}function gU(e){const{ogma:t,parameters:n,canvas:s,view:r}=e,i=s.getContext("2d");return j_(t,n,r,"canvas",!n.images).then(o=>{try{const a=o.getContext("2d");if(!a)throw new Error("Failed to render graph");return a.getImageData(0,0,1,1),i.drawImage(o,0,0,s.width,s.height),e}catch(a){return Gi(a),j_(t,n,r,"canvas",!0).then(u=>(i.drawImage(u,0,0,s.width,s.height),e))}})}function fU({canvas:e,parameters:t,type:n}){const s=e.toDataURL("image/"+n);return t.download&&Oo(s,t.filename,"dataURL","image/"+n),s}function Ic(e,t,n){const s=pr(t,oU[n]);s.filename.endsWith(n)||(s.filename+="."+n),s.background===null&&(s.background=e.modules.graphics.getTransparentBackgroundColor());const r=jC(e,s);s.pixelRatio=r.pixelRatio;const i=Es(r.width*r.pixelRatio,r.height*r.pixelRatio),o={ogma:e,parameters:s,canvas:i,view:r,type:n};return Promise.resolve().then(()=>o).then(uU).then(dU).then(hU).then(gU).then(cU).then(aU).then(lU).then(fU).then(a=>(e.modules.events.fire("afterImageExport"),a))}function pU(e,t,n,s){e.textAlign="center",e.textBaseline="middle",e.fillText(t,n,s)}function mU(e,t,n){return{width:e.measureText(t).width,height:n}}function _U(e,t,n,s,r){return{width:s===void 0?t.width:s,height:r===void 0?t.height:r}}function yU(e,t,n,s,r,i){e.drawImage(t,n-r/2,s-i/2,r,i)}function SS(e,t,n,s){if(!t)return;if(typeof t!="object")t={content:t};else if(!t.content)return;const{fontFamily:r,fontSize:i,fontStyle:o,fontColor:a,repeat:u,alpha:d,space:c,content:g}=t;let f=t.angle;const p=e.getContext("2d"),_=e.width,y=e.height,x=t.x===void 0?_/2:t.x,E=t.y===void 0?y/2:t.y,b=t.height,S=t.width;f=f/180*Math.PI,Fo(p,r,i,o),p.fillStyle=a,p.globalAlpha=d;const A=s(p,g,i,S,b);if(u){const C=A.width+c,k=A.height+c,M=Math.sqrt(_*_+y*y);p.save(),p.translate(0,0),p.rotate(f);for(let R=0;R<M;R+=C)for(let O=0;O<M;O+=k)n(p,g,R,O,A.width,A.height),O!==0&&n(p,g,R,-O,A.width,A.height);p.restore()}else p.save(),p.translate(x,E),p.rotate(f),n(p,g,0,0,A.width,A.height),p.restore()}var xU={download:!0,filename:"graph.svg",width:void 0,height:void 0,background:null,texts:!0,preventOverlap:!0,groupSemantically:!0,images:!0,badges:!0,embedFonts:!1,layers:!0,clip:!1,margin:10,prefix:"ogma"};function vU(e,t){const n=pr(t,xU),{background:s,filename:r,download:i,layers:o}=n,a=e.modules.graphics;s===null&&(n.background=a.getTransparentBackgroundColor());const u=jC(e,n);return j_(e,n,u,"svg",!n.images).then(d=>(d.removeAttribute("pointer-events"),d.setAttribute("version","1.1"),d.setAttributeNS(Ym,"xmlns",Ey),d.setAttributeNS(Ym,"xmlns:xlink",o1),d)).then(d=>n.groupSemantically?EU(e,d,n):d).then(d=>AU(d,n)).then(d=>bU(e,u,d)).then(d=>AS(e,u,d,o,!0)).then(d=>AS(e,u,d,o,!1)).then(d=>(e.modules.events.fire("afterImageExport"),d)).then(d=>{const c=`<?xml version="1.0" encoding="utf-8"?>${ux(d)}`;return i&&Oo(c,r,"text","image/svg+xml"),c})}function bU(e,t,n){return e.modules.geo.isEnabled()?e.modules.geo.exportBackground({...t,pixelRatio:1}).then(s=>{const r=rn("image",{width:s.width,height:s.height,x:0,y:0,href:s.toDataURL()});return n.insertBefore(r,n.children[0]),n}):Promise.resolve(n)}function AS(e,t,n,s,r=!1){return s?e.modules.layers.export({view:t,svg:n,below:r}).then(()=>n):Promise.resolve(n)}function EU(e,t,n){const s=t.childNodes[2],r=s.childNodes,i={},o=n.prefix;for(let p=0;p<r.length;p++){const _=r[p],y=_.getAttribute(Lr);y!=null&&(i[y]=i[y]||[],i[y].push(_))}const a=Object.keys(i),u=e.modules.graph,d=u.getNodeAttribute("id"),c=u.getEdgeAttribute("id"),g=rn("g",{class:`${o}-edges`}),f=rn("g",{class:`${o}-nodes`});for(let p=0;p<a.length;p++){const _=a[p],y=_.charAt(0)==="n",x=parseInt(_.substring(1)),E=i[_],b=pl((y?d:c).get(x).toString()),S=rn("g");S.setAttribute(`data-${y?"node":"edge"}-id`,b),S.setAttribute("class",`${o}-${y?"node":"edge"}`);for(let A=0;A<E.length;A++){const C=E[A];S.appendChild(C),C.removeAttribute(Lr)}(y?f:g).appendChild(S)}return s.appendChild(g),s.appendChild(f),t}function SU(e){const t=[].concat(Array.prototype.slice.call(e.getElementsByTagName("text")||[])),n=[],s={};for(let r=0;r<t.length;r++){const i=t[r].parentNode.getAttribute("font-family");if(typeof i=="string"){const o=i.split(",");for(let a=0;a<o.length;a++){const u=o[a].replace(/['"]/g,"");u===""||s[u]||(s[u]=!0,n.push(u))}}}return{list:n,map:s}}function AU(e,t){const n=SU(e).map;return l2().then(s=>s.filter(r=>n[r.name])).then(s=>u2(s,!!t.embedFonts)).then(s=>{if(s.length!==0){const r=rn("style");for(let i=0;i<s.length;i++)r.appendChild(Sy(s[i]));e.childNodes[0].appendChild(r)}return e})}var wU={what:void 0,dataProperties:void 0,filter:"visible",nodes:void 0,edges:void 0,download:!0,filename:"graph.xlsx",tab:void 0,nodeData:void 0,edgeData:void 0};function TU(e,t={}){typeof t=="string"&&(t={what:t});const{what:n,nodes:s,edges:r,tab:i={nodes:()=>"nodes",edges:()=>"edges"},download:o,filename:a,dataProperties:u,filter:d,nodeData:c,edgeData:g}=pr(t,wU);i.nodes||(i.nodes=()=>"nodes"),i.edges||(i.edges=()=>"edges");const f=gf(e.modules.graph,e.modules.individualAttributes,{styles:"none",nodes:s,edges:r,filter:d,nodeData:_=>_,edgeData:_=>_}),p=CU(f,{what:n,tabFunctions:i,tabContentFunctions:{nodes:c||(_=>Wm(cd(_||{}),u)),edges:g||(_=>Wm(cd(_||{}),u))}},{nodes:e.modules.graph.getNodes(f.nodes.map(({id:_})=>_)),edges:e.modules.graph.getEdges(f.edges.map(({id:_})=>_))});return o&&Oo(p,a,"blob","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),Promise.resolve(p)}function CU(e,{what:t,tabFunctions:n,tabContentFunctions:s},r){const i=kr("XLSX")||kr("xlsx",{throwOnError:!0});if(!i)throw Error('The xlsx exports requires the "xlsx" peer dependency to be associated');const o=new NU;if(t){if(t!=="nodes"&&t!=="edges")throw new TypeError(`Invalid argument: "what" is not "nodes" or "edges", was ${t}`);t==="nodes"&&(e.edges=[]),t==="edges"&&(e.nodes=[])}const a={};for(const u of["nodes","edges"]){const d=V3(e[u],u,n[u],s[u],r[u]);for(const c of Object.keys(d))a[c]=[...a[c]||[],...d[c]]}for(const u of Object.keys(a))o.SheetNames.push(u),o.Sheets[u]=LU(i,j3(a[u]));return o.SheetNames.length===0&&(o.SheetNames=["nodes","edges"],o.Sheets.nodes={},o.Sheets.edges={}),gd([IU(i.write(o,{bookType:"xlsx",bookSST:!1,type:"binary"}))],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")}function LU(e,t){const n={},s={s:{c:1e7,r:1e7},e:{c:0,r:0}};for(let r=0;r!==t.length;++r){const i=t[r];for(let o=0;o!==i.length;++o){const a=i[o];s.s.r>r&&(s.s.r=r),s.s.c>o&&(s.s.c=o),s.e.r<r&&(s.e.r=r),s.e.c<o&&(s.e.c=o);const u={v:VC(a)};n[e.utils.encode_cell({c:o,r})]=u}}return s.s.c<1e7&&(n["!ref"]=e.utils.encode_range(s)),n}var NU=class{constructor(){this.SheetNames=[],this.Sheets={}}};function IU(e){const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let s=0;s!==e.length;++s)n[s]=255&e.charCodeAt(s);return t}var kU=class extends En{constructor(e){super(e),this.csv=t=>X3(this._ogma,t),this.xlsx=t=>(t&&t.dataProperties&&void 0,TU(this._ogma,t)),this.gexf=t=>K3(this._ogma,t),this.graphml=(t={})=>eU(this._ogma,t),this.json=(t={})=>sU(this._ogma,t),this.svg=(t={})=>vU(this._ogma,t),this.png=(t={})=>Ic(this._ogma,t,"png"),this.jpg=(t={})=>Ic(this._ogma,t,"jpg"),this.tiff=(t={})=>Ic(this._ogma,t,"tiff"),this.gif=(t={})=>Ic(this._ogma,t,"gif"),e.styles.createClass({name:la,isBuiltin:!0})}},ks=fy(gI()),MU=class extends En{constructor(){super(...arguments),this.balancedTree=e=>Promise.resolve(ks.balancedTree.generate(ks.balancedTree.configure(e))),this.barabasiAlbert=e=>Promise.resolve(ks.barabasiAlbert.generate(ks.barabasiAlbert.configure(e))),this.erdosRenyi=e=>Promise.resolve(ks.erdosRenyi.generate(ks.erdosRenyi.configure(e))),this.flower=e=>Promise.resolve(ks.flower.generate(ks.flower.configure(e))),this.grid=e=>Promise.resolve(ks.grid.generate(ks.grid.configure(e))),this.path=e=>Promise.resolve(ks.path.generate(ks.path.configure(e))),this.random=e=>Promise.resolve(ks.random.generate(ks.random.configure(e))),this.randomTree=e=>Promise.resolve(ks.randomTree.generate(ks.randomTree.configure(e)))}},PU=class extends En{constructor(){super(...arguments),this.enable=e=>this._ogma.modules.geo.enable(e),this.disable=e=>this._ogma.modules.geo.disable(e),this.setOptions=e=>this._ogma.modules.geo.setOptions(e),this.getOptions=()=>this._ogma.modules.geo.getOptions(),this.getMap=()=>this._ogma.modules.geo.getMap(),this.enabled=()=>this._ogma.modules.geo.isEnabled(),this.getCenter=()=>this._ogma.modules.geo.getCenter(),this.getView=()=>this._ogma.modules.geo.getView(),this.getZoom=()=>this._ogma.modules.geo.getZoom(),this.setZoom=e=>this._ogma.modules.geo.setZoom(e),this.setView=(e,t,n)=>this._ogma.modules.geo.setView(e,t,n),this.setCenter=(e,t)=>this._ogma.modules.geo.setCenter(e,t),this.toggle=e=>this._ogma.modules.geo.toggle(e),this.resetCoordinates=()=>this._ogma.modules.geo.resetCoordinates(),this.getUnprojectedCoordinates=e=>this._ogma.modules.geo.getUnprojectedCoordinates(this._ogma.getNodes(e)),this.runLayout=async({type:e,nodes:t,latitudePath:n=ui,longitudePath:s=di,options:r,center:i})=>{if(e===void 0||r===void 0)throw new Error("Ogma.geo.runLayout: Both layout type and options are required");if(t=this._ogma.getNodes(t),i===void 0){let o=0;if(i=t.reduce((a,u)=>{const d=u.getData(n),c=u.getData(s);return isNaN(d)||isNaN(c)||(a.latitude+=d,a.longitude+=c,o++),a},{latitude:0,longitude:0}),isNaN(i.latitude)||isNaN(i.longitude))throw new Error("Ogma.geo.runLayout: No valid center coordinates found");i.latitude/=o,i.longitude/=o}return this._ogma.modules.geo.runLayout({center:i,nodes:t,type:e,options:r,latitudePath:n,longitudePath:s})}}},RU=class{reloadFonts(){this.modules.graphics.reloadFonts()}},FU=class extends En{constructor(){super(...arguments),this.gexf=e=>RC(e),this.gexfFromUrl=e=>vx(e),this.janus=e=>FC(e),this.json=(e,t)=>DC(e,t),this.jsonFromUrl=(e,t)=>bx(e,t),this.neo4j=e=>OC(e),this.graphml=(e,t)=>zC(e,t),this.graphmlFromUrl=(e,t)=>BC(e,t)}},DU=class extends En{constructor(){super(...arguments),this.isKeyPressed=e=>this._ogma.modules.keyboard.isPressed(e),this.resetKeys=()=>{this._ogma.modules.keyboard.resetKeys()}}},OU=class extends En{addLayer(e,t){return this._ogma.modules.layers.addLayer(e,"layer",t)}addCanvasLayer(e,t,n){return this._ogma.modules.layers.addCanvasLayer(e,t,n)}addOverlay(e,t){if(!e.position)throw new Error("options.position argument is required");return this._ogma.modules.layers.addOverlay(e,t)}addSVGLayer(e,t){return e.element||(e.element=document.createElementNS("http://www.w3.org/2000/svg","svg")),e.draw||(e.draw=()=>{}),this._ogma.modules.layers.addSVGLayer(e,t)}},wS={name:"concentric",configure:function(e,{graph:t,data:n}){if(e.centralNode===void 0)throw new Error('concentric layout: missing parameter "centralNode"');const s={...e,centralNode:function(A,C){return C instanceof Xr?C:A.getNode(C)}(t,e.centralNode)},{centralNode:r,nodes:i}=s,o=t.getNode(r);if(o===void 0)throw new Error('concentric layout: "centralNode" parameter is not valid');const a=o._index,{x:u,y:d}=o.getPosition(),c=i.getAttribute("layoutable"),g=t.getNodes(i)._indexes,f=Array.from(g.filter((S,A)=>c[A]));f.indexOf(a)===-1&&f.push(a);const p=t.getNodeAttribute("radius").getMultiple(g),_=function(A,C,k,M){if(C)return C==="random"?"random":C==="radius"?M.slice():C==="degree"?k.getDegree():A.getProperty(k,C)}(n,s.sortBy,i,p),y=f.reduce((S,A,C)=>(S[A]=C,S),{}),x=f.map((S,A)=>A),E=new Set(e.edges.getExtremities()._indexes),b=f.map(S=>t.topology.getAdjacentElements(!0,new Uint32Array([S])).filter(A=>E.has(A)).map(A=>y[A]));return{sourceNodeIndex:f.indexOf(a),centerX:typeof s.centerX=="number"?s.centerX:u,centerY:typeof s.centerY=="number"?s.centerY:d,list:f,indexes:x,size:f.length,totalSize:f.length,attributes:{adjacentNodes:b,size:p},sortAttr:_,clockwise:s.clockwise===void 0||s.clockwise,circleHopRatio:s.circleHopRatio||5,allowOverlap:!!s.allowOverlap}},context:function(){return{dijkstra:function(e,t,n,s,r){const i=Math.pow(2,31)-1,o=new Int32Array(s),a=new Int32Array(s),u=new Int8Array(s);o.fill(i),a.fill(-1);for(let c=0;c<s;++c){const g=t[c];g!==void 0&&(o[g]=i,a[g]=-1)}o[r]=0;let d=0;for(;d!==-1;){let c=i;d=-1;for(let g=0;g<n;++g){const f=t[g],p=o[f];!u[f]&&p<c&&(c=p,d=f,u[f]=1)}if(d>-1){const g=e[d],f=c+1;g.forEach(p=>{const _=o[p];f<_&&(o[p]=f,a[p]=d)})}}return o},determinePropertyType:function(e,t,n){return t.some(s=>e[s]!=="number")?"string":"number"}}},update:function(e,t){const{attributes:n,indexes:s,size:r}=e,{sourceNodeIndex:i,centerX:o,centerY:a,sortAttr:u}=e,d=n.adjacentNodes,c=n.size,g=new Array(e.totalSize),f=new Array(e.totalSize),p=t.dijkstra(d,s,e.size,e.totalSize,i);let _=0;const y={};for(let k=0;k<r;k++){const M=c[s[k]];M>_&&(_=M)}const x=_*e.circleHopRatio;let E=0,b=0;const S=Math.PI/9;for(let k=0;k<r;k++){const M=s[k],R=p[M];let O=y[R];O||(O=[],y[R]=O),O.push(M)}const A=function(M,R,O){if(M==="random")return function(){return Math.random()-.5};if(M)return O.determinePropertyType(M,R,R.length)==="number"?function(j,z){return M[j]-M[z]}:function(j,z){return M[j]<M[z]?-1:1}}(u,s,t),C=u==="random"||u;return Object.keys(y).sort((k,M)=>parseInt(k)-parseInt(M)).forEach((k,M)=>{const R=y[k],O=R.length;let j=0,z=b;const X=2*Math.PI/O;if(M!==0&&!e.allowOverlap){const oe=2*Math.PI*E;let re=0;j+=R.reduce((Q,he)=>Q+c[he],0),re=2*j*Math.SQRT2,re>oe&&(E+=re/(2*Math.PI)-E)}C&&(R.sort(A),e.clockwise||R.reverse());for(let oe=0;oe<O;oe++){const re=R[oe];g[re]=Math.cos(z)*E+o,f[re]=Math.sin(z)*E+a;const Q=c[re];z+=X*(e.allowOverlap?1:Q/j*O)}E+=x,b+=S}),{x:g,y:f,indexes:e.list}},isRunning:function(){return!1},onSync:function({indexes:e,x:t,y:n}){return{indexes:e,x:t,y:n}}},zU=e=>(e.modules.layouts.register(wS),t=>e.modules.layouts.start(wS.name,t)),BU=Object.defineProperty,pt=(e,t)=>BU(e,"name",{value:t,configurable:!0}),UU=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),GU=pt(()=>({[WebGL2RenderingContext.FLOAT]:"uniform1f",[WebGL2RenderingContext.FLOAT_VEC2]:"uniform2fv",[WebGL2RenderingContext.FLOAT_VEC3]:"uniform3fv",[WebGL2RenderingContext.FLOAT_VEC4]:"uniform4fv",[WebGL2RenderingContext.INT]:"uniform1i",[WebGL2RenderingContext.INT_VEC2]:"uniform2iv",[WebGL2RenderingContext.INT_VEC3]:"uniform3iv",[WebGL2RenderingContext.INT_VEC4]:"uniform4iv",[WebGL2RenderingContext.UNSIGNED_INT]:"uniform1ui",[WebGL2RenderingContext.UNSIGNED_INT_VEC2]:"uniform2uiv",[WebGL2RenderingContext.UNSIGNED_INT_VEC3]:"uniform2uiv",[WebGL2RenderingContext.UNSIGNED_INT_VEC4]:"uniform2uiv",[WebGL2RenderingContext.FLOAT_MAT2]:"uniformMatrix2fv",[WebGL2RenderingContext.FLOAT_MAT3]:"uniformMatrix3fv",[WebGL2RenderingContext.FLOAT_MAT4]:"uniformMatrix4fv",[WebGL2RenderingContext.SAMPLER_2D]:"uniform1i",[WebGL2RenderingContext.INT_SAMPLER_2D]:"uniform1i",[WebGL2RenderingContext.UNSIGNED_INT_SAMPLER_2D]:"uniform1i",[WebGL2RenderingContext.SAMPLER_CUBE]:"uniform1i"}),"ne"),ga=new Map,ym=new Map,VU=pt((e,t,n,s)=>{ga.has(e)||ga.set(e,ga.size);const r=`${ga.get(e)}:${t}:${n}`;return ym.has(r)||ym.set(r,s()),ym.get(r)},"ie"),xm=new Map,jU=pt((e,t)=>(ga.has(e)||ga.set(e,ga.size),xm.has(e)||xm.set(e,t()),xm.get(e)),"ae"),gi=pt((e,t)=>()=>([e,t]=[t,e],e),"A"),HU=pt(e=>{const t=e.createBuffer();if(!t)throw new Error("Could not create buffer");return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,UU,e.STATIC_DRAW),t},"ce"),Wi=pt((e,t)=>jU(e,()=>{const n=e.getAttribLocation(t,"position");return e.enableVertexAttribArray(n),e.vertexAttribPointer(n,2,e.FLOAT,!1,0,0),n}),"b"),TS=pt((e,t,n)=>{const s=e.createShader(t);if(s===null)throw new Error("Cannot create WebGL shader.");return e.shaderSource(s,n),e.compileShader(s),s},"J"),Xi=pt((e,t,n)=>VU(e,t,n,()=>{const s=e.createProgram();if(s===null)throw new Error("Cannot create WebGL program.");if(e.attachShader(s,TS(e,e.VERTEX_SHADER,t)),e.attachShader(s,TS(e,e.FRAGMENT_SHADER,n)),e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS)){const r=e.getProgramInfoLog(s);throw e.deleteProgram(s),new Error(`Could not link WebGL program: 
${r}`)}return s}),"M"),Qr=pt((e,{size:t,data:n,type:s,internalFormat:r=e.RGBA32F,format:i=e.RGBA})=>{const o=e.createTexture();if(!o)throw new Error("Cannot create WebGL texture.");const[a,u]=t.map(d=>Math.max(1,d));return n instanceof Float32Array&&n.byteLength===0?n=new Float32Array(a*u*4):n instanceof Uint32Array&&n.byteLength===0&&(n=new Uint32Array(a*u*4)),e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,r,a,u,0,i,s,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),{size:t,data:n,type:s,format:i,handle:o}},"R"),ir=pt((e,t)=>{const n=e.createFramebuffer();if(!n)throw new Error("Cannot create WebGL frame buffer.");e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0);const s=e.checkFramebufferStatus(e.FRAMEBUFFER);if(s!==e.FRAMEBUFFER_COMPLETE)switch(s){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw new Error("Framebuffer: Attachment is NOT complete.");case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw new Error("Framebuffer: No valid attachment.");case e.FRAMEBUFFER_UNSUPPORTED:throw new Error("Framebuffer: Attachment types are not supported.");default:throw new Error(`Framebuffer: Unknown reason (status: ${s}).`)}return n},"T"),Yi=pt((e,t,n)=>{e.useProgram(t);const s={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;i++){const o=e.getActiveUniform(t,i);if(!o)throw new Error(`Cannot get GL active uniform ${i}.`);const{name:a,size:u,type:d}=o,c=e.getUniformLocation(t,a);if(!c)throw new Error(`Cannot get GL uniform location ${a}.`);s[a]={size:u,data:n[a],type:d,location:c}}return s},"S");function fi(e,t,n={}){let s=0;const r=GU();return Object.entries(t).forEach(([i,{location:o,type:a,data:u}])=>{let d=n[i]!==void 0?n[i]:u;(a===e.SAMPLER_2D||a===e.INT_SAMPLER_2D||a===e.UNSIGNED_INT_SAMPLER_2D)&&(e.activeTexture(e.TEXTURE0+s),e.bindTexture(e.TEXTURE_2D,d),d=s,s++),e[r[a]](o,d)})}pt(fi,"C");var ff=pt(e=>Math.ceil(Math.sqrt(e)),"k"),Sx=pt(e=>Math.ceil(Math.sqrt(2*e)),"X"),qU=pt((e,t,n,s)=>{const r=ff(t),i=new Float32Array(4*r**2);for(let o=0;o<t;o++){const a=4*o;i[a]=n[o],i[a+1]=s[o]}return Qr(e,{size:[r,r],data:i,type:e.FLOAT,format:e.RGBA,internalFormat:e.RGBA32F})},"se"),$U=pt((e,t,n,s)=>{const r=ff(t),i=Sx(n),o=new Uint32Array(3*r**2);let a=0;for(let u=0;u<t;u++){const d=3*u,c=a,g=Math.floor(c/i),f=c%i;o[d]=f,o[d+1]=g,o[d+2]=s[u],a+=s[u]}return Qr(e,{size:[r,r],data:o,type:e.UNSIGNED_INT,format:e.RGB_INTEGER,internalFormat:e.RGB32UI})},"fe"),WU=pt((e,t,n,s)=>{const r=ff(t),i=Sx(n),o=new Uint32Array(2*i**2);let a=0;for(let u=0;u<t;u++)for(const d of s[u]){const c=Math.floor(d/r),g=d%r;o[a]=g,o[a+1]=c,a+=2}return Qr(e,{size:[i,i],data:o,type:e.UNSIGNED_INT,format:e.RG_INTEGER,internalFormat:e.RG32UI})},"_e"),XU=pt((e,t,n,s=new Float32Array(t),r=new Uint8Array(t))=>{const i=ff(t),o=new Float32Array(4*i**2);for(let a=0;a<t;a++){const u=4*a;o[u]=n[a],o[u+1]=s[a],o[u+2]=r[a],o[u+3]=0}return Qr(e,{size:[i,i],data:o,type:e.FLOAT,format:e.RGBA,internalFormat:e.RGBA32F})},"xe"),YU=pt((e,t,n,s)=>{const r=Sx(n),i=new Float32Array(r**2);let o=0;for(let a=0;a<t;a++)for(const u of s[a])i[o]=u,o++;return Qr(e,{size:[r,r],data:i,type:e.FLOAT,format:e.RED,internalFormat:e.R32F})},"ve"),CS=pt((e,t)=>Array.from({length:e},(n,s)=>t(s)),"Q"),HC=pt(e=>{const t=new Map,n={nodes:[],edges:[]};return e.nodes.forEach((s,r)=>{t.has(s.id)&&console.warn(`Duplicated ID ${s.id}@${r}`),n.nodes.push({...s,id:r}),t.set(s.id,r)}),e.edges.forEach(s=>{const r=t.get(s.source),i=t.get(s.target);return r===void 0||i===void 0?console.warn(`Missing source ${s.source}`):void n.edges.push({...s,source:Math.min(r,i),target:Math.max(r,i)})}),n.edges.sort((s,r)=>s.source-r.source||s.target-r.target),n},"je"),qC=pt(({nodes:e,edges:t},[n,s]=[0,0])=>{const r=Math.PI*(3-Math.sqrt(5)),i=e.map(a=>(a.x=(a.x||0)-n,a.y=(a.y||0)-s,a)).map(a=>({n:a,key:a.pinned?0:1+1e6*a.y+a.x})).sort((a,u)=>a.key-u.key);let o=0;return i.forEach(({n:a,key:u},d)=>{if(u*d==0||u!==i[d-1].key)return o=d;const c=Math.sqrt(d-o);a.x=i[o].n.x+c*Math.cos(r*(d-o)),a.y=i[o].n.y+c*Math.sin(r*(d-o))}),{nodes:e,edges:t}},"He"),LS=pt((e,t)=>{const{nodes:n,edges:s}=t,r=n.length,i=s.length,o=new Uint32Array(i),a=new Uint32Array(i),u=new Uint32Array(r);for(let x=0;x<i;x++){const{source:E,target:b}=s[x];o[x]=E,a[x]=b,u[E]++,u[b]++}const d=CS(r,()=>[]);o.forEach((x,E)=>{d[x].push(a[E]),d[a[E]].push(x)});const c=CS(r,()=>[]);o.forEach((x,E)=>{if(s[E].stiffness!==void 0)c[x].push(s[E].stiffness),c[a[E]].push(s[E].stiffness);else{const b=u[x],S=u[a[E]],A=b*S/(Math.min(b,S)*(b+S));c[x].push(A),c[a[E]].push(A)}});const g=new Float32Array(n.map(({x})=>x||0)),f=new Float32Array(n.map(({y:x})=>x||0)),p=new Float32Array(n.map(({r:x})=>isNaN(x)?1:x)),_=new Float32Array(n.map(({mass:x},E)=>x||u[E]+1)),y=new Uint8Array(n.map(({pinned:x})=>x?1:0));return{N:r,E:i,bodyTexture:qU(e,r,g,f),nodeTexture:$U(e,r,i,u),topologyTexture:WU(e,r,i,d),propertyTexture:XU(e,r,_,p,y),edgePropertyTexture:YU(e,r,i,c)}},"Ke"),NS=pt((e,t)=>{e.deleteTexture(t.bodyTexture.handle),e.deleteTexture(t.nodeTexture.handle),e.deleteTexture(t.topologyTexture.handle),e.deleteTexture(t.propertyTexture.handle),e.deleteTexture(t.edgePropertyTexture.handle)},"Ye"),Zi=`#version 300 es

in vec2 position;

void main() {
  gl_Position = vec4(position, 0.0f, 1.0f);
}`,ZU=`#version 300 es
precision highp float;uniform int u_0;uniform lowp sampler2D u_1,u_2;uniform int u_3,u_4;out vec4 outColor;void main(){ivec2 o=ivec2(gl_FragCoord.xy);if(outColor=vec4(1e9,1e9,-1e9,-1e9),u_3>0)for(int e;e<4;e++){ivec2 u=(o<<1)+ivec2(e&1,e>>1);vec4 t=texelFetch(u_2,u,0);outColor=vec4(min(outColor.xy,t.xy),max(outColor.zw,t.zw));}else if(textureSize(u_1,0).x*o.y+o.x<u_0)outColor.xy=outColor.zw=texelFetch(u_1,o,0).xy;if(u_3==u_4){vec2 o=outColor.zw-outColor.xy;o=vec2(max(o.x,o.y),max(o.x,o.y)),outColor=vec4(outColor.xy-vec2(1),o+vec2(2));}}`,KU=pt(e=>1<<Math.ceil(Math.log2(Math.sqrt(e))),"me"),IS=pt((e,t,n)=>{const s=KU(t),r=new Float32Array(4*s**2);return n&&n.forEach((i,o)=>r[o]=i),Qr(e,{size:[s,s],data:r,type:e.FLOAT,format:e.RGBA,internalFormat:e.RGBA32F})},"Z"),QU=pt(e=>Math.ceil(Math.log2(Math.sqrt(e)))+1,"he"),JU=pt((e,t,n)=>{const s=Xi(e,Zi,ZU);Wi(e,s);const r=IS(e,t),i=IS(e,t),o=gi(r,i),a=ir(e,i.handle),u=ir(e,r.handle),d=gi(a,u),c=Yi(e,s,{u_0:t,u_1:n().handle,u_2:r.handle,u_3:0,u_4:0});let g=r;return{step:(f=QU(t))=>{e.viewport(0,0,r.size[0],r.size[1]),e.useProgram(s);for(let p=0;p<f;p++){e.bindFramebuffer(e.FRAMEBUFFER,d()),e.viewport(0,0,r.size[0]>>p,r.size[1]>>p);const _=o();g=_===r?i:r,fi(e,c,{u_2:_.handle,u_1:n().handle,u_4:f-1,u_3:p}),e.drawArrays(e.TRIANGLES,0,6)}},texture:()=>g,destroy:()=>{e.deleteFramebuffer(a),e.deleteFramebuffer(u),e.deleteTexture(i.handle),e.deleteTexture(r.handle)}}},"pe"),eG=`#version 300 es
precision lowp float;vec2 i(vec2 i,vec2 e){return vec2(i.x*e.x-i.y*e.y,i.x*e.y+i.y*e.x);}vec2 i(vec2 i){return i.y=-i.y,i;}vec2 i(vec2 u[8],vec2 r,vec2 c){vec2 t,o=r-c,e=vec2(1,0);for(int r;r<8;++r)t+=i(u[r],e),e=i(e,o);return t;}vec2 i(vec2 e,vec4 i){return(e-i.xy)/i.zw;}uniform float u_8,u_9,u_a,u_b,u_c,u_d,u_5,u_6,u_7;uniform int u_0;uniform lowp sampler2D u_1;uniform lowp usampler2D u_e,u_f;uniform lowp sampler2D u_g,u_h;uniform int u_i,u_j;uniform lowp sampler2D u_2;uniform lowp usampler2D u_k,u_l;uniform lowp sampler2D u_m;out vec4 outColor;void main(){uint c=uint(textureSize(u_1,0).x);int h=textureSize(u_f,0).x;ivec2 r=ivec2(gl_FragCoord.xy);if(int(c)*r.y+r.x>=u_0)return;vec3 o=texelFetch(u_g,r,0).xyz;if(o.z>0.)return;vec4 n=texelFetch(u_1,r,0);vec2 u=n.xy,e=n.zw;ivec4 t=ivec4(texelFetch(u_e,r,0));vec4 v=texelFetch(u_2,ivec2(0),0);uint a=uint(textureSize(u_k,0).x);float x=float(1<<u_j-1);ivec2 d=ivec2(u_i,1),l=ivec2(x*i(u,v));vec2 g=(vec2(l)+.5)/x;ivec2 m=l-ivec2(1);for(int i;i<9;++i){ivec2 t=m+ivec2(i%3,i/3);if(t>>u_j-1!=ivec2(0))continue;uvec2 r=texelFetch(u_l,t,0).xy;for(uint i=r.x;i<r.y;i++){uint n=texelFetch(u_k,ivec2(i%a,i/a),0).x;ivec2 v=ivec2(n%c,n/c);vec2 t=texelFetch(u_1,v,0).xy-u;float l=dot(t,t)+1e-4;if(u_c>0.&&u_5<.5){float u=texelFetch(u_g,v,0).y,i=max(o.y+u+u_d,.01);if(l<i*i){float r=sqrt(l);e-=(i-r)*u_c*u/i*t/r;}}float x=texelFetch(u_g,v,0).x;e-=u_5*u_8*x*t/l;}}vec2 y[8];for(int i;i<8;i++)y[i]=i<u_i?texelFetch(u_m,d*l+ivec2(i,0),0).xy:vec2(0);vec2 s=i(i(y,g,i(u,v))/v.z);e-=u_5*u_8*s;ivec2 p;for(int r;r<t.z;r++){p=ivec2(texelFetch(u_f,t.xy,0).xy);float c=texelFetch(u_h,t.xy,0).x;vec2 i=texelFetch(u_1,p,0).xy-u;if(i*=1.-u_b/(length(i)+1e-4),e+=u_5*u_a*c*i/o.x,t.x+=1,t.x>=h)t.x=0,t.y+=1;}e=u_6*(e-u_5*u_9*u);float f=dot(e,e);if(f>u_7)e*=sqrt(u_7/f);outColor=vec4(u+e,e);}`,tG=pt((e,t,n,s,r,{handle:i},{handle:o},{N:a,bodyTexture:u,nodeTexture:d,topologyTexture:c,propertyTexture:g,edgePropertyTexture:f},{charge:p,gravity:_,inertia:y,edgeStrength:x,edgeLength:E,elasticity:b,margin:S,maxDisplacement:A})=>{const C=Xi(e,Zi,eG);Wi(e,C);const k=Qr(e,{type:e.FLOAT,size:u.size,data:new Float32Array(u.data.buffer.slice(0)),format:e.RGBA,internalFormat:e.RGBA32F}),M=gi(u,k),R=ir(e,k.handle),O=ir(e,u.handle),j=gi(R,O),z=Yi(e,C,{u_5:1,u_6:y,u_7:A**2,u_8:p,u_9:_,u_a:x,u_b:E,u_c:b,u_d:S,u_0:a,u_1:u.handle,u_e:d.handle,u_f:c.handle,u_g:g.handle,u_h:f.handle,u_i:n,u_j:t,u_2:s().handle,u_k:r().handle,u_l:i,u_m:o});let X=u;return{step:oe=>{e.viewport(0,0,u.size[0],u.size[1]),e.useProgram(C),e.bindFramebuffer(e.FRAMEBUFFER,j());const re=M();X=re===u?k:u,fi(e,z,{u_5:oe,u_1:re.handle,u_2:s().handle,u_k:r().handle}),e.drawArrays(e.TRIANGLES,0,6)},texture:()=>X,destroy:()=>{e.deleteFramebuffer(R),e.deleteFramebuffer(O),e.deleteTexture(k.handle)}}},"le"),nG=pt((e,t)=>e.map(n=>t*n),"Fe"),sG=pt((e,t)=>nG([t,1],1<<e),"Te"),$C=pt((e,t,n,s)=>{const r=sG(t,n),i=new Float32Array(2*r[0]*r[1]);return s&&s.forEach((o,a)=>i[a]=o),Qr(e,{size:r,data:i,type:e.FLOAT,format:e.RG,internalFormat:e.RG32F})},"ee"),rG=`#version 300 es
precision lowp float;vec2 c(vec2 c,vec2 u){return vec2(c.x*u.x-c.y*u.y,c.x*u.y+c.y*u.x);}vec2 u(vec2 u,vec2 c){return vec2(dot(u,c),u.y*c.x-u.x*c.y)/dot(c,c);}vec2 c(vec2 c){return u(vec2(1,0),c);}const float n[64]=float[64](1.,1.,1.,1.,1.,1.,1.,1.,1.,2.,3.,4.,5.,6.,7.,8.,1.,3.,6.,10.,15.,21.,28.,36.,1.,4.,10.,20.,35.,56.,84.,120.,1.,5.,15.,35.,70.,126.,210.,330.,1.,6.,21.,56.,126.,252.,462.,792.,1.,7.,28.,84.,210.,462.,924.,1716.,1.,8.,36.,120.,330.,792.,1716.,3432.);uniform int u_i,u_n;uniform lowp sampler2D u_p,u_q;out vec2 outColor;void main(){float f=float(1<<u_n);ivec2 i=ivec2(u_i,1),v=ivec2(gl_FragCoord.xy)/i;vec2 x=(vec2(v)+.5)/f;uint o=uint(gl_FragCoord.x)%uint(u_i);if(u_n>2){ivec2 m=v>>1;vec2 e=(vec2(v&65534)+1.)/f-x,u=vec2(1,0);for(uint v;v<uint(u_i-int(o));++v)outColor+=n[v+(o<<3)]*c(texelFetch(u_p,i*m+ivec2(v+o,0),0).xy,u),u=c(u,e);}ivec2 m=(v&65534)-2;for(int r;r<36;r++){ivec2 t=m+ivec2(r%6,r/6);vec2 d=texelFetch(u_q,i*t,0).xy;if(d.x==0.)continue;vec2 a=vec2(t-v);if(dot(a,a)<=2.||t>>u_n!=ivec2(0))continue;vec2 l=(vec2(t)+.5)/f-x,e=vec2(1,0);for(uint u;u<o;++u)e=c(e,-l);if(dot(e,e)<1e-20)continue;vec2 p=c(l),y=n[o<<3]*u(d,e);e=c(e,l);for(uint v=1u;v<uint(u_i);++v){if(dot(e,e)<1e-20)break;y+=n[v+(o<<3)]*u(texelFetch(u_q,i*t+ivec2(v,0),0).xy,e),e=c(e,l);}outColor+=c(y,p);}}`,iG=pt((e,t,n,s)=>{const r=Xi(e,Zi,rG);Wi(e,r);const i=Array.from({length:t},(u,d)=>$C(e,d,n)),o=i.map(({handle:u})=>ir(e,u)),a=Yi(e,r,{u_i:n,u_n:t-1,u_p:null,u_q:null});return{step:()=>{e.useProgram(r);for(let u=2;u<t;u++){const{handle:d}=i[u-1],c=s(u);e.viewport(0,0,c.size[0],c.size[1]),e.bindFramebuffer(e.FRAMEBUFFER,o[u]),fi(e,a,{u_n:u,u_p:d,u_q:c.handle}),e.drawArrays(e.TRIANGLES,0,6)}},texture:u=>i[u],destroy:()=>{o.forEach(u=>e.deleteFramebuffer(u)),i.forEach(({handle:u})=>e.deleteTexture(u))}}},"we"),oG=`#version 300 es
precision lowp float;vec2 e(vec2 e,vec2 t){return vec2(e.x*t.x-e.y*t.y,e.x*t.y+e.y*t.x);}vec2 n(vec2 t,vec2 e){return vec2(dot(t,e),t.y*e.x-t.x*e.y)/dot(e,e);}const vec2 t[8]=vec2[8](vec2(1,0),vec2(-1,0),vec2(2,0),vec2(-6,0),vec2(24,0),vec2(-120,0),vec2(720,0),vec2(-5040,0));const float x[16]=float[16](1.,1.,2.,6.,24.,120.,720.,5040.,40320.,362880.,3628800.,39916800.,479001600.,6.227021e9,8.717829e1,1.3076744e12);vec2 e(vec2 t,vec4 e){return(t-e.xy)/e.zw;}uniform int u_i,u_j,u_n;uniform lowp sampler2D u_o,u_2;uniform lowp usampler2D u_k;uniform lowp sampler2D u_g,u_1;uniform lowp usampler2D u_l;out vec2 outColor;void main(){float i=float(1<<u_n);ivec2 v=ivec2(u_i,1),u=ivec2(gl_FragCoord.xy)/v;vec2 l=(vec2(u)+.5)/i;uint c=uint(gl_FragCoord.x)%uint(u_i);if(u_n==u_j-1){uint t=uint(textureSize(u_1,0).x),n=uint(textureSize(u_k,0).x);vec4 i=texelFetch(u_2,ivec2(0),0);uvec2 x=texelFetch(u_l,u,0).xy;for(uint u=x.x;u<x.y;u++){uint o=texelFetch(u_k,ivec2(u%n,u/n),0).x;ivec2 r=ivec2(o%t,o/t);vec2 d=l-e(texelFetch(u_1,r,0).xy,i),v=vec2(1,0);for(uint t;t<c;++t)v=e(v,d);outColor+=texelFetch(u_g,r,0).x*v;}}else for(int o;o<4;++o){ivec2 d=2*u+ivec2(o&1,o>>1);vec2 f=(vec2(d)+.5)/i/2.-l,r=vec2(1,0),y;for(uint u;u<=c;++u)y+=n(e(texelFetch(u_o,v*d+ivec2(c-u,0),0).xy,r),t[c-u]*x[u]),r=e(r,f);outColor+=e(y,t[c]);}}`,aG=pt((e,t,n,s,r,{handle:i},o,{handle:a})=>{const u=Xi(e,Zi,oG);Wi(e,u);const d=Array.from({length:t},(f,p)=>$C(e,p,n)),c=d.map(({handle:f})=>ir(e,f)),g=Yi(e,u,{u_i:n,u_j:t,u_n:t-1,u_o:d[0].handle,u_2:s().handle,u_k:r().handle,u_g:i,u_1:o().handle,u_l:a});return{step:()=>{e.useProgram(u);for(let f=t-1;f>=2;f--){const{handle:p}=d[(f+1)%t],_=d[f];e.viewport(0,0,_.size[0],_.size[1]),e.bindFramebuffer(e.FRAMEBUFFER,c[f]),fi(e,g,{u_2:s().handle,u_k:r().handle,u_1:o().handle,u_n:f,u_o:p}),e.drawArrays(e.TRIANGLES,0,6)}},texture:f=>d[f],destroy:()=>{c.forEach(f=>e.deleteFramebuffer(f)),d.forEach(({handle:f})=>e.deleteTexture(f))}}},"Re"),lG=`#version 300 es
uint u(uint u){return u&=65535u,u=(u|u<<8)&16711935u,u=(u|u<<4)&252645135u,u=(u|u<<2)&858993459u,u=(u|u<<1)&1431655765u,u;}uint u(uvec2 r){return u(r.y)<<1|u(r.x);}uniform uint u_0;uniform lowp usampler2D u_k;out uvec2 outColor;uint u(uint n,uint i){uint u,r=u_0;for(;u<r;){uint t=u+r>>1,e=texelFetch(u_k,ivec2(t%i,t/i),0).y;e<n?u=t+1u:r=t;}return u;}void main(){uint r=uint(textureSize(u_k,0).x),i=u(uvec2(gl_FragCoord.xy));outColor=uvec2(u(i,r),u(i+1u,r));}`,uG=pt(e=>1<<e-1,"Me"),dG=pt((e,t,n)=>{const s=uG(t);return Qr(e,{size:[s,s],data:n||new Uint32Array(2*s**2),type:e.UNSIGNED_INT,format:e.RG_INTEGER,internalFormat:e.RG32UI})},"Se"),hG=pt((e,t,n,s)=>{const r=Xi(e,Zi,lG);Wi(e,r);const i=dG(e,n),o=ir(e,i.handle),a=Yi(e,r,{u_0:t,u_k:s()});return{step:()=>{e.viewport(0,0,i.size[0],i.size[1]),e.useProgram(r),e.bindFramebuffer(e.FRAMEBUFFER,o),fi(e,a,{u_k:s().handle}),e.drawArrays(e.TRIANGLES,0,6)},texture:()=>i,destroy:()=>{e.deleteFramebuffer(o),e.deleteTexture(i.handle)}}},"Ce"),cG=`#version 300 es
precision lowp float;uint u(uint u){return u&=65535u,u=(u|u<<8)&16711935u,u=(u|u<<4)&252645135u,u=(u|u<<2)&858993459u,u=(u|u<<1)&1431655765u,u;}uint u(uvec2 e){return u(e.y)<<1|u(e.x);}vec2 u(vec2 e,vec4 u){return(e-u.xy)/u.zw;}uniform int u_0,u_j;uniform ivec2 u_r;uniform lowp sampler2D u_2,u_1;out uvec2 outColor;void main(){ivec2 o=ivec2(gl_FragCoord.xy);int e=u_r.x*o.y+o.x;if(e>=u_0){outColor=uvec2(uint(e),4294967295u);return;}int t=textureSize(u_1,0).x;o=ivec2(e%t,e/t);vec4 i=texelFetch(u_2,ivec2(0),0);vec2 n=u(texelFetch(u_1,o,0).xy,i);outColor=uvec2(uint(e),u(uvec2(float(1<<u_j-1)*n)));}`,gG=pt(e=>{for(let t=0;t<e.length/2;t++)e[2*t]=t,e[2*t+1]=4294967295;return e},"Ge"),Ax=pt(e=>1<<Math.ceil(Math.log2(e)),"q"),wx=pt(e=>{const t=32-Math.clz32(e-1);return[1<<(t>>>1)+(1&t),1<<(t>>>1)]},"j"),Tx=pt((e,t,n)=>{const[s,r]=wx(Ax(t)),i=gG(new Uint32Array(2*s*r));return n&&n.forEach((o,a)=>i[a]=o),Qr(e,{size:[s,r],data:i,type:e.UNSIGNED_INT,format:e.RG_INTEGER,internalFormat:e.RG32UI})},"V"),kS=pt((e,t)=>{const[n,s]=wx(Ax(t)),r=new Uint32Array(4*n*s);return Qr(e,{size:[n,s],data:r,type:e.UNSIGNED_INT,format:e.RGBA_INTEGER,internalFormat:e.RGBA32UI})},"g"),fG=pt((e,t,n,s,r)=>{const i=Xi(e,Zi,cG);Wi(e,i);const o=Tx(e,t),a=ir(e,o.handle),u=Yi(e,i,{u_0:t,u_j:n,u_r:o.size,u_2:s().handle,u_1:r().handle});return{step:()=>{e.viewport(0,0,o.size[0],o.size[1]),e.useProgram(i),e.bindFramebuffer(e.FRAMEBUFFER,a),fi(e,u,{u_2:s().handle,u_1:r().handle}),e.drawArrays(e.TRIANGLES,0,6)},texture:()=>o,destroy:()=>{e.deleteFramebuffer(a),e.deleteTexture(o.handle)}}},"Le"),pG=`#version 300 es
precision highp int;uniform uint u_s,u_t;uniform highp usampler2D u_u;out uvec2 outColor;uvec2 u(uvec2 u,uvec2 e,bool n,uint i){uvec2 t=u.x<4294967295u?texelFetch(u_u,ivec2(u.x%i,u.x/i),0).xy:u,c=e.x<4294967295u?texelFetch(u_u,ivec2(e.x%i,e.x/i),0).xy:e;if(n)return t.y<c.y?t:c;return t.y>c.y?t:c;}void main(){uint e=uint(textureSize(u_u,0).x);uvec2 t=uvec2(gl_FragCoord.xy);uint i=uint(t.x+e*t.y),x=texelFetch(u_u,ivec2(t),0).x,c=i^1u<<u_s-u_t,o=texelFetch(u_u,ivec2(c%e,c/e),0).x;bool n=(i>>u_s-u_t&1u)==0u;(i>>u_s&2u)==2u&&(n=!n),outColor=u(uvec2(i,x),uvec2(c,o),n,e);}`,mG=pt(e=>Math.max(0,Math.ceil(Math.log2(e))),"Pe"),_G=pt(e=>e*(e+1)/2,"Ne"),yG=pt((e,t,n)=>{const s=Xi(e,Zi,pG);Wi(e,s);const r=Tx(e,t),i=n,o=gi(r,i),a=ir(e,i.handle),u=ir(e,r.handle),d=gi(a,u),c=Yi(e,s,{u_s:0,u_t:0,u_u:i.handle}),g=mG(t);let f=0,p=0,_=i;return{step:(y=_G(g))=>{e.useProgram(s),e.viewport(0,0,r.size[0],r.size[1]),_!==n&&(d(),o(),_=n);for(let x=0;x<y;x++){e.bindFramebuffer(e.FRAMEBUFFER,d());const E=o();_=E===r?i:r,fi(e,c,{u_s:f,u_t:p,u_u:E.handle}),e.drawArrays(e.TRIANGLES,0,6),p=(p+1)%(f+1),p===0&&(f=(f+1)%g)}},texture:()=>_,destroy:()=>{e.deleteFramebuffer(a),e.deleteFramebuffer(u),e.deleteTexture(r.handle)}}},"Be"),xG=`#version 300 es
precision highp int;uniform uint u_s,u_t;uniform highp usampler2D u_u,u_v;out uvec4 outColor;uint v(uint v,uint t,uint u,uint n,uint e){uint i=v<u?t+v:n-u+v;uvec2 c=texelFetch(u_u,ivec2(i%e,i/e),0).xy;return c.y;}void main(){ivec2 x=ivec2(gl_FragCoord.xy);uint o=u_s-u_t;uvec2 n=uvec2(textureSize(u_u,0)),t=n.x==n.y?uvec2(0u,1u):uvec2(1u,0u);t=(o&1u)==1u?1u-t:t;uvec2 s=n>>uvec2(o+t.y>>1u,o+t.x>>1u);uint y=s.x*uint(x.y)+uint(x.x);uvec4 u;if(u_t==0u)u=uvec4(y&4294967294u,1u,(y&4294967294u)+1u,1u)<<u_s;else{uint v=y>>1u,e=s.x>>t.x;u=texelFetch(u_v,ivec2(v%e,v/e),0);}uint e=u.y+u.w>>1u,c=u.y<e?0u:u.y-e,r=u.y<e?u.y:e;for(;c<r;){uint i=c+(r-c>>1u);v(i,u.x,u.y,u.z,uint(n.x))<v(i+e,u.x,u.y,u.z,uint(n.x))?c=i+1u:r=i;}uint i=e-c;if((x.x&1)==0)outColor=uvec4(u.x,e-i,u.z+u.w-i,i);else outColor.zw=uvec2(u.z,u.w-i),outColor.xy=u.y<u.w?uvec2(u.x+e-i,u.y-e+i):uvec2(u.x+u.y-e+u.w-i,e-u.w+i);}`,vG=`#version 300 es
precision highp int;uniform uint u_s;uniform highp usampler2D u_u,u_v;out uvec2 outColor;void main(){uvec2 t=uvec2(gl_FragCoord.xy);uint u=uint(textureSize(u_v,0).x),e=t.y*u+t.x;bool o=(e>>u_s+1u&1u)==1u;if(o){uint u=1u<<u_s+1u;e+=u-2u*(e%u)-1u;}uvec4 i=texelFetch(u_v,ivec2(e%u,e/u),0);uint n=i.y>0u?i.x:i.z;outColor=texelFetch(u_u,ivec2(n%u,n/u),0).xy;}`,bG=pt(e=>Math.max(0,Math.ceil(Math.log2(e))),"We"),EG=pt(e=>e*(e+1)/2,"$e"),SG=pt((e,t,n)=>{t=Ax(t);const s=Xi(e,Zi,xG),r=Xi(e,Zi,vG);Wi(e,s),Wi(e,r);const i=Tx(e,t),o=n,a=gi(i,o),u=ir(e,o.handle),d=ir(e,i.handle),c=gi(u,d),g=kS(e,t),f=kS(e,t),p=gi(g,f),_=ir(e,f.handle),y=ir(e,g.handle),x=gi(_,y),E=Yi(e,s,{u_s:0,u_t:0,u_u:o.handle,u_v:f.handle}),b=Yi(e,r,{u_s:0,u_u:o.handle,u_v:f.handle}),S=bG(t);let A=0,C=0,k=o;return{step:(M=EG(S))=>{k!==n&&(c(),a(),k=n);for(let R=0;R<M;R++){if(R*C==0&&e.useProgram(s),e.bindFramebuffer(e.FRAMEBUFFER,x()),e.viewport(0,0,...wx(t>>>A-C)),fi(e,E,{u_s:A,u_t:C,u_v:p().handle,u_u:k.handle}),e.drawArrays(e.TRIANGLES,0,6),C===A){e.useProgram(r),e.bindFramebuffer(e.FRAMEBUFFER,c());const O=a();k=O===i?o:i,e.viewport(0,0,O.size[0],O.size[1]),x(),fi(e,b,{u_s:A,u_u:O.handle,u_v:p().handle}),e.drawArrays(e.TRIANGLES,0,6)}C=(C+1)%(A+1),C===0&&(A=(A+1)%S)}},texture:()=>k,destroy:()=>{e.deleteFramebuffer(u),e.deleteFramebuffer(d),e.deleteTexture(i.handle),e.deleteFramebuffer(_),e.deleteFramebuffer(y),e.deleteTexture(f.handle),e.deleteTexture(g.handle)}}},"Xe"),AG=pt(e=>{let t;return()=>t||e().finally(()=>t=void 0)},"qe"),wG=pt((e,t)=>Math.max(.1,1-(e/Math.max(1,t-20))**7.39),"te"),TG=pt((e,t=25,n=24e3)=>{const s=(n-t)/(t-1);return Math.ceil(t*s*4/(s+e))},"re"),MS={charge:10,edgeStrength:.5,edgeLength:30,elasticity:.9,margin:1,gravity:.01,inertia:.9,maxDisplacement:1e3,steps:200},CG=pt((e,t,n)=>{let[s,r]=[0,0];const i=HU(e),o=pt(()=>{e.bindBuffer(e.ARRAY_BUFFER,i),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0);for(let u=0;u<t;u++,s++)if(!n(s))return!0},"a"),a=pt(u=>{o()?u(s):r=requestAnimationFrame(()=>a(u))},"i");return{start:AG(()=>new Promise(u=>(s=0)||a(u))),step:o,stop:()=>cancelAnimationFrame(r)}},"ue"),vm=pt((e,t,n)=>{let{bodyTexture:s}=t;const{N:r,propertyTexture:i}=t,{steps:o,batch:a,sortingMethod:u}=n,d=n.order??4;if(d<2||d>8)throw new Error("Order must be between 2 and 8");const c=Math.max(1,n.depth??Math.ceil(Math.log2(r)/2)),{step:g,texture:f,destroy:p}=JU(e,r,()=>s),{step:_,texture:y,destroy:x}=fG(e,r,c,f,()=>s),E=u==="ibr"?SG:yG,{step:b,texture:S,destroy:A}=E(e,r,y()),{step:C,texture:k,destroy:M}=hG(e,r,c,S),{step:R,texture:O,destroy:j}=aG(e,c,d,f,S,i,()=>s,k()),{step:z,texture:X,destroy:oe}=iG(e,c,d,O),{step:re,texture:Q,destroy:he}=tG(e,c,d,f,S,k(),X(c-1),t,n);return{...CG(e,a??TG(r),fe=>(s=Q(),g(),_(),b(),C(),R(),z(),re(wG(fe,o)),fe<o)),destroy:()=>{p(),x(),A(),M(),j(),oe(),he()}}},"Ze"),LG=pt(({nodes:e,edges:t})=>{const n=e.length,s=t.length,r=new Uint32Array(n);for(let i=0;i<s;i++){const{source:o,target:a}=t[i];r[o]++,r[a]++}return r},"degrees"),NG=pt((e,t)=>({nodes:e.nodes.map((n,s)=>{const r=n.mass||1;return{...n,mass:r*(t[s]+1)}}),edges:e.edges.map(n=>{const s=n.weight||1,r=t[n.target]+1,i=t[n.source]+1,o=s*(r*i)/Math.min(r,i)/(r+i);return{...n,stiffness:o}})}),"defaultSettings"),IG=pt((e,t)=>{const n=qC(HC(e),t);return NG(n,LG(n))},"cleanGraph"),PS=0,WC=typeof window>"u",kG=typeof performance<"u"&&performance.now?performance:Date,MG=WC?e=>{const t=kG.now(),n=Math.max(0,16-(t-PS)),s=setTimeout(()=>e(t+n),n);return PS=t+n,s}:window.requestAnimationFrame,PG=WC?e=>clearTimeout(e):window.cancelAnimationFrame;function XC(e,t,n){for(let s=0;s<e.length;s++){const r=e[s];r.x=t[s],r.y=n[s]}}pt(XC,"defaultUpdate");var RG=pt(()=>{},"noop"),bm={movementRatio:7e-8,surfaceRatio:.0025},H_=class{constructor(e={}){this.onUpdate=pt(t=>{},"onUpdate"),this.update=XC,this.nextTick=MG,this.cancelTick=PG,this.onEnd=RG,this.charge=10,this.maxIterations=200,this.minMovement=.1,this.edgeLength=30,this.edgeStrength=3,this.friction=.1,this.elasticity=.9,this.margin=1,this.cx=void 0,this.cy=void 0,this.gravity=.01,this.theta=.34,this.batch=void 0,this.inertia=.9,this.integrator=0,this.multilevel=!1,this.placement="none",this.placementOffset=10,this.alignSiblings=!1,this.bucketSize=void 0,this.maxDisplacement=1e3,this.siblingsMinAngle=0,this.siblingsOffset=.15,this.steps=200,this.scaling=1,this.defaultRadius=1,this.autoStop=bm,this.gpuAcceleration=!0,this.barnesHutOptimization=!0,"autoStop"in e?e.autoStop&&(typeof e.autoStop=="boolean"?e.autoStop=bm:e.autoStop={...e.autoStop,...bm}):e.steps;for(const t in e)e[t]===void 0&&t!=="order"&&t!=="depth"||(this[t]=e[t])}};pt(H_,"Settings");var RS=class{constructor(e){this.promise=new Promise(e)}then(e){return this.promise.then(e)}stop(){return this.simulation.stop(),this}get iterations(){return this.simulation.iterations()}};function Jc(e,t,n={}){var _;let s,r;t.getExtension("OES_texture_float_linear")&&t.getExtension("EXT_color_buffer_float")||((_=t.getExtension("WEBGL_lose_context"))==null||_.loseContext());let i=new H_({...MS,...n});const o=e.nodes.length,a=n.cx||e.nodes.reduce((y,x)=>y+(x.x||0),0)/o,u=n.cy||e.nodes.reduce((y,x)=>y+(x.y||0),0)/o,d=[a,u],c=pt(y=>{if(!s)throw new Error("No graph has been set");const{size:x}=s.bodyTexture;if(x[0]*x[1]<=1)return{X:[0],Y:[0]};const E=new Float32Array(4*x[0]*x[1]);t.readPixels(0,0,x[0],x[1],t.RGBA,t.FLOAT,E),y&&(g(),f());const b=E.filter((A,C)=>C%4==0).map(A=>A+a),S=E.filter((A,C)=>C%4==1).map(A=>A+u);return{X:b,Y:S}},"readLayoutData"),g=pt(()=>{r&&(r.stop(),r.destroy(),r=void 0)},"simulationCleanup"),f=pt(()=>{s&&(NS(t,s),s=void 0)},"graphLayoutCleanup"),p={setOptions:(y={})=>(i=new H_({...MS,...y}),s&&(g(),r=vm(t,s,i)),p),setGraph:(y={nodes:[],edges:[]})=>(s&&NS(t,s),s=LS(t,qC(HC(y),d)),i&&(g(),r=vm(t,s,i)),p),start:()=>{if(!r)throw new Error("No graph has been set");return r.start().finally(()=>{var y;return(y=n.onEnd)==null?void 0:y.call(n,1)}),p},stop:()=>(r&&r.stop(),p),step:()=>{if(!r)throw new Error("No graph has been set");return r.step(),p},data:y=>c(y),iterations:()=>1};return s=LS(t,IG(e,d)),r=vm(t,s,i),p}/**
* @preserve
* @linkurious/force-layout@0.7.3
* Ogma general-purpose force-directed layout
*/function FS(){var e=(()=>{var t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,r=Object.prototype.hasOwnProperty,i=(H,U)=>t(H,"name",{value:U,configurable:!0}),o={};((H,U)=>{for(var G in U)t(H,G,{get:U[G],enumerable:!0})})(o,{IntegratorType:()=>q,default:()=>nn});var a=class{constructor(H){let U=u();this.c=1,this.s0=U(" "),this.s1=U(" "),this.s2=U(" "),this.s0-=U(String(H)),this.s0<0&&(this.s0+=1),this.s1-=U(String(H)),this.s1<0&&(this.s1+=1),this.s2-=U(H),this.s2<0&&(this.s2+=1),U=null}next(){return()=>{const H=2091639*this.s0+23283064365386963e-26*this.c;return this.s0=this.s1,this.s1=this.s2,this.s2=H-(this.c=0|H)}}nextDouble(){const H=this.next();return()=>H()+11102230246251565e-32*(2097152*H()|0)}nextInt32(){const H=this.next();return()=>4294967296*H()|0}};function u(){let H=4022871197;return U=>{U=U.toString();for(let G=0;G<U.length;G++){H+=U.charCodeAt(G);let $=.02519603282416938*H;H=$>>>0,$-=H,$*=H,H=$>>>0,$-=H,H+=4294967296*$}return 23283064365386963e-26*(H>>>0)}}function d(H){return new a(H.toString()).next()}i(a,"Alea"),i(u,"Mash"),i(d,"impl");var c=d(42);function g(H){c=d(H)}function f(){return 1e-6*(c()-.5)}function p(H,U,{sources:G,targets:$,X:ie,Y:ue,R:te,fx:se,fy:ge,degrees:Ee,masses:xe,weights:Se},{edgeStrength:Ne,edgeLength:De}){for(let ve=0;ve<U.length;ve++){const Be=U[ve],$e=G[Be],je=$[Be],Ye=1,w=Ee[$e]+Ye,I=Ee[je]+Ye,F=Ne*Se[Be];let B=ie[je]+se[je]-ie[$e]-se[$e]||f(),le=ue[je]+ge[je]-ue[$e]-ge[$e]||f();const ee=B*B+le*le,ye=Math.sqrt(ee),Pe=De+te[$e]+te[je];if(ye<=Pe)continue;const Ve=Pe-ye,rt=Ve*(I*w/Math.min(I,w)/(I+w)),it=Math.min(1,H*F*Ve/ee*(rt*(I+w)/(I*w))),St=I*w/(I+w);B*=it,le*=it,se[$e]+=B*St/xe[$e],ge[$e]+=le*St/xe[$e],se[je]-=B*St/xe[je],ge[je]-=le*St/xe[je]}}i(g,"setSeed"),i(f,"randomize"),i(p,"attraction");var _=i((H,{edgeIds:U,sources:G,targets:$,degrees:ie,weights:ue})=>{for(let te=0;te<H.length;te++){const{source:se,target:ge,weight:Ee=1}=H[te];G[te]=se,$[te]=ge,ue[te]=Ee,ie[se]++,ie[ge]++,U[te]=te,ue[te]=Ee===void 0?1:Ee}},"initialize");function y(H,U,{X:G,Y:$,fx:ie,fy:ue},{gravity:te,cx:se,cy:ge}){const Ee=U.length;for(let xe=0;xe<Ee;xe++){const Se=U[xe],Ne=se-G[Se]||f(),De=ge-$[Se]||f(),ve=te*H;ie[Se]+=Ne*ve,ue[Se]+=De*ve}}p.initialize=_,i(y,"center");var x=i((H,U,G)=>{const{X:$,Y:ie}=U;let ue=G.cx,te=G.cy;const se=H.length;if(ue===void 0||te===void 0){ue=te=0;for(let ge=0;ge<se;ge++)ue+=$[ge],te+=ie[ge];ue/=se,te/=se}G.cx=ue,G.cy=te},"initialize");y.initialize=x;var E=class{constructor(H,U,G,$){this.left=null,this.right=null,this.data=null,this.code=H,this.data=U,this.left=G,this.right=$}};function b(H,U,G,$,ie){const ue=new E(null,null,null,null),te=[ue],se=[$,ie];for(;te.length!==0;){const ge=se.pop(),Ee=se.pop(),xe=te.pop();if(ge-Ee==0)xe.code=G[Ee],xe.data=H[U[Ee]];else{const Se=C(U,G,Ee,ge);xe.code=Se,Ee<=Se&&(xe.left=new E(null,null,null,null),te.push(xe.left),se.push(Ee,Se)),ge>Se&&(xe.right=new E(null,null,null,null),te.push(xe.right),se.push(Se+1,ge))}}return ue}function S(H,U,G,$,ie,ue){const te=new E(null,null,null,null),se=[te],ge=[$,ie];for(;se.length!==0;){const Ee=ge.pop(),xe=ge.pop(),Se=se.pop();if(Ee-xe<ue){const Ne=new Array(Ee-xe+1);for(let De=xe,ve=0;De<=Ee;De++,ve++)Ne[ve]=H[U[De]];Se.code=G[xe],Se.data=Ne}else{const Ne=C(U,G,xe,Ee);Se.code=Ne,xe<=Ne&&(Se.left=new E(null,null,null,null),se.push(Se.left),ge.push(xe,Ne)),Ee>Ne&&(Se.right=new E(null,null,null,null),se.push(Se.right),ge.push(Ne+1,Ee))}}return te}i(E,"Node"),i(b,"buildIterative"),i(S,"buildIterativeBuckets");var A=Math.clz32||i(function(U){let G=-2147483648;for(let $=0;$<31;$+=1){if(G&U)return $;G>>>=1}return 32},"clz");function C(H,U,G,$){const ie=U[H[G]],ue=U[H[$]];if(ie===ue)return G;const te=A(ie^ue);let se,ge,Ee,xe=G,Se=$-G;do Se=Se+1>>1,se=xe+Se,se<$&&(ge=U[H[se]],Ee=A(ie^ge),Ee>te&&(xe=se));while(Se>1);return xe}function k(H,U){let G=H^U,$=65535^G,ie=65535^(H|U),ue=H&(65535^U),te=G|$>>1,se=G>>1^G,ge=ie>>1^$&ue>>1^ie,Ee=G&ie>>1^ue>>1^ue;G=te,$=se,ie=ge,ue=Ee,te=G&G>>2^$&$>>2,se=G&$>>2^$&(G^$)>>2,ge^=G&ie>>2^$&ue>>2,Ee^=$&ie>>2^(G^$)&ue>>2,G=te,$=se,ie=ge,ue=Ee,te=G&G>>4^$&$>>4,se=G&$>>4^$&(G^$)>>4,ge^=G&ie>>4^$&ue>>4,Ee^=$&ie>>4^(G^$)&ue>>4,G=te,$=se,ie=ge,ue=Ee,ge^=G&ie>>8^$&ue>>8,Ee^=$&ie>>8^(G^$)&ue>>8,G=ge^ge>>1,$=Ee^Ee>>1;let xe=H^U,Se=$|65535^(xe|G);return xe=16711935&(xe|xe<<8),xe=252645135&(xe|xe<<4),xe=858993459&(xe|xe<<2),xe=1431655765&(xe|xe<<1),Se=16711935&(Se|Se<<8),Se=252645135&(Se|Se<<4),Se=858993459&(Se|Se<<2),Se=1431655765&(Se|Se<<1),(Se<<1|xe)>>>0}i(C,"findSplit"),i(k,"hilbert");var M=[0,1],R=[0,2];for(let H=4;H<65535;H<<=2)for(let U=0,G=M.length;U<G;U++)M.push(M[U]|H),R.push((M[U]|H)<<1);function O(H,U){return(R[255&U]|M[255&H])+65536*(R[U>>8&255]|M[H>>8&255])+4294967296*(R[U>>16&255]|M[H>>16&255])}i(O,"morton");var j=new Uint32Array(1024);function z(H,U){const G=new Uint32Array(U.length);for(let ie=0;ie<1024;ie++)j[ie]=0;const $=255;for(let ie=0;ie<U.length;ie++){const ue=U[ie];j[ue&$]++,j[256+(ue>>8&$)]++,j[512+(ue>>16&$)]++,j[768+(ue>>24&$)]++}for(let ie=0;ie<4;ie++){let ue=0,te=0;const se=256*ie;for(let ge=0;ge<256;ge++)ue=j[ge+se],j[ge+se]=te,te+=ue}for(let ie=0;ie<U.length;ie++){const ue=U[ie];G[j[ue&$]++]=ie}for(let ie=0;ie<U.length;ie++){const ue=G[ie],te=U[ue];H[j[256+(te>>8&$)]++]=ue}for(let ie=0;ie<U.length;ie++){const ue=H[ie],te=U[ue];G[j[512+(te>>16&$)]++]=ue}for(let ie=0;ie<U.length;ie++){const ue=G[ie],te=U[ue];H[j[768+(te>>24&$)]++]=ue}}i(z,"radixSort");var X=class{constructor(H,{getX:U,getY:G,bucketSize:$=0,sfc:ie=1}={}){this.bucketSize=0,this._root=null;const ue=H.length,te=new Uint32Array(ue);let se=1/0,ge=1/0,Ee=-1/0,xe=-1/0;this._x=U,this._y=G;const Se=ie===1?k:O;this._project=Se;const Ne=new Uint32Array(ue);for(let Be=0;Be<ue;Be++){const $e=H[Be],je=U($e),Ye=G($e);je<se&&(se=je),Ye<ge&&(ge=Ye),je>Ee&&(Ee=je),Ye>xe&&(xe=Ye),Ne[Be]=Be}this._minX=se,this._minY=ge,this._maxX=Ee,this._maxY=xe;const De=65535/Math.max(Ee-se,1),ve=65535/Math.max(xe-ge,1);this._hw=De,this._hh=ve;for(let Be=0;Be<ue;Be++){const $e=H[Be];te[Be]=Se(De*(U($e)-se),ve*(G($e)-ge))}z(Ne,te),this._root=$===0?b(H,Ne,te,0,ue-1):S(H,Ne,te,0,ue-1,$),this.bucketSize=$}get root(){return this._root}inOrder(H,U){let G=this._root;const $=[];let ie=!1;for(;!ie;)if(G)$.push(G),G=G.left;else if($.length!==0){if(G=$.pop(),H.call(U,G))break;G=G.right}else ie=!0;return this}preOrder(H,U){const G=[this._root];for(;G.length!==0;){const $=G.pop();H.call(U,$)||($.right&&G.push($.right),$.left&&G.push($.left))}return this}postOrder(H,U){const G=[];let $,ie=this._root;do{for(;ie;)ie.right&&G.push(ie.right),G.push(ie),ie=ie.left;ie=G.pop(),$=G.length-1,ie.right&&G[$]===ie.right?(G[$]=ie,ie=ie.right):(H.call(U,ie),ie=null)}while(G.length!==0);return this}map(H,U){const G=[];return this.inOrder($=>{G.push(H.call(U,$))}),G}height(){return oe(this._root)}toString(H=U=>U.code.toString()){const U=[];return re(this._root,"",!0,G=>U.push(G),H),U.join("")}size(){let H=0;return this.preOrder(()=>{H++}),H}destroy(){return this._root=null,this}};function oe(H){return H?1+Math.max(oe(H.left),oe(H.right)):0}function re(H,U,G,$,ie){if(H){$(U+(G?"^-- ":"|-- ")+ie(H)+`
`);const ue=U+(G?"    ":"|   ");H.left&&re(H.left,ue,!1,$,ie),H.right&&re(H.right,ue,!0,$,ie)}}function Q(H){for(let U=H.length-1;U>=0;U--){let G=Math.floor(Math.random()*(U+1));G=Math.max(Math.min(G,U),0);const $=H[U];H[U]=H[G],H[G]=$}return H}i(X,"BVH"),i(oe,"treeHeight"),i(re,"row"),i(Q,"shuffle");var he,fe,ae,me,we,Z,_e,ze,Re,We=i(H=>H.x,"getX"),st=i(H=>H.y,"getY"),ft=i(H=>H.r,"getR");function ut(H,U=We,G=st,$=ft){const ie=Q(H.slice()),ue=ie.length;let te,se=[],ge=0;for(;ge<ue;){const Ee=ie[ge];te&&qe(te,U(Ee),G(Ee),$(Ee))?ge++:(se=ce(se,Ee,U,G,$),te=Ie(se,U,G,$),ge=0)}return te}function ce(H,U,G,$,ie){const ue=G(U),te=$(U),se=ie(U),ge={x:ue,y:te,r:se};if(Ue(ge,H,G,$,ie))return[U];for(let Ee=0;Ee<H.length;++Ee){const xe=H[Ee],Se=G(xe),Ne=$(xe),De=ie(xe);if(!be(ge,Se,Ne,De)&&Ue(Oe(Se,Ne,De,ue,te,se),H,G,$,ie))return[H[Ee],U]}for(let Ee=0;Ee<H.length-1;Ee++)for(let xe=Ee+1;xe<H.length;xe++){const Se=H[Ee],Ne=H[xe],De=G(Se),ve=$(Se),Be=ie(Se),$e=G(Ne),je=$(Ne),Ye=ie(Ne);if(!be(Oe(De,ve,Be,$e,je,Ye),ue,te,se)&&!be(Oe(De,ve,Be,ue,te,se),$e,je,Ye)&&!be(Oe($e,je,Ye,ue,te,se),De,ve,Be)&&Ue(Xe(De,ve,Be,$e,je,Ye,ue,te,se),H,G,$,ie))return[H[Ee],H[xe],U]}throw new Error}function be(H,U,G,$){const ie=H.r-$,ue=U-H.x,te=G-H.y;return ie>=0&&ie*ie>ue*ue+te*te}function qe(H,U,G,$){const ie=H.r-$+1e-6,ue=U-H.x,te=G-H.y;return ie>0&&ie*ie>ue*ue+te*te}function Ue(H,U,G,$,ie){for(let ue=0;ue<U.length;++ue){const te=U[ue];if(!qe(H,G(te),$(te),ie(te)))return!1}return!0}function Ie(H,U,G,$){return H.length===1?Fe(U(H[0]),G(H[0]),$(H[0])):H.length===2?Oe(U(H[0]),G(H[0]),$(H[0]),U(H[1]),G(H[1]),$(H[1])):Xe(U(H[0]),G(H[0]),$(H[0]),U(H[1]),G(H[1]),$(H[1]),U(H[2]),G(H[2]),$(H[2]))}function Fe(H,U,G){return{x:H,y:U,r:G}}function Oe(H,U,G,$,ie,ue){const te=$-H,se=ie-U,ge=ue-G,Ee=Math.sqrt(te*te+se*se);return{x:(H+$+te/Ee*ge)/2,y:(U+ie+se/Ee*ge)/2,r:(Ee+G+ue)/2}}function Xe(H,U,G,$,ie,ue,te,se,ge){const Ee=(H+$+te)/3,xe=(U+ie+se)/3,Se=H-Ee,Ne=U-xe,De=$-Ee,ve=ie-xe,Be=te-Ee,$e=se-xe,je=Se-De,Ye=Se-Be,w=Ne-ve,I=Ne-$e,F=ue-G,B=ge-G,le=Se*Se+Ne*Ne-G*G,ee=le-De*De-ve*ve+ue*ue,ye=le-Be*Be-$e*$e+ge*ge,Pe=Ye*w-je*I,Ve=(w*ye-I*ee)/(2*Pe)-Se,rt=(I*F-w*B)/Pe,it=(Ye*ee-je*ye)/(2*Pe)-Ne,St=(je*B-Ye*F)/Pe,Jt=rt*rt+St*St-1,Kt=2*(G+Ve*rt+it*St),Xt=Ve*Ve+it*it-G*G,an=-(Math.abs(Jt)>1e-6?(Kt+Math.sqrt(Kt*Kt-4*Jt*Xt))/(2*Jt):Xt/Kt);return{x:Ee+Se+Ve+rt*an,y:xe+Ne+it+St*an,r:an}}function dt(H,U,G,{X:$,Y:ie,R:ue,fx:te,fy:se,bucketSize:ge},{elasticity:Ee}){if(Ee===0)return G;G||(G=new X(U,{getX:he,getY:fe,bucketSize:ge})).postOrder(me);for(let xe=0;xe<U.length;xe++)Z=U[xe],_e=$[Z]+te[Z],ze=ie[Z]+se[Z],Re=ue[Z],G.preOrder(we);return G}i(ut,"med"),i(ce,"extend"),i(be,"contains"),i(qe,"containsWeak"),i(Ue,"containsWeakAll"),i(Ie,"enclose"),i(Fe,"from1"),i(Oe,"from2"),i(Xe,"from3"),i(dt,"collisionForce");var mt,ht,wt,Lt,Tt,ot,jt,Nt,Gt,Wt,hn,Sn=i(({X:H,Y:U,R:G,bucketSize:$})=>ie=>{let ue,te,se,ge;const Ee=ie.data;if(Ee!==null)if($!==0){const xe=ut(Ee,he,fe,ae);ue=xe.x,te=xe.y,se=xe.r}else{const xe=Ee;ue=H[xe],te=U[xe],se=G[xe]}else if(ie.left&&ie.right){const xe=ie.left.cx,Se=ie.left.cy,Ne=ie.right.cx,De=ie.right.cy,ve=ie.left.r,Be=ie.right.r,$e=Ne-xe,je=De-Se,Ye=Be-ve,w=Math.sqrt($e*$e+je*je);ue=(xe+Ne+$e/w*Ye)/2,te=(Se+De+je/w*Ye)/2,se=(w+ve+Be)/2}else ge=ie.left||ie.right,ge&&(ue=ge.cx,te=ge.cy,se=ge.r);ie.cx=ue,ie.cy=te,ie.r=se},"getMeasureBodies"),Jn=i(({X:H,Y:U,R:G,fx:$,fy:ie,bucketSize:ue},{elasticity:te,margin:se})=>ge=>{const Ee=ge.data;if(Ee===null){const xe=ge.cx-_e,Se=ge.cy-ze,Ne=ge.r+Re;return xe*xe+Se*Se>Ne*Ne}if(ue!==0){const xe=Ee;for(let Se=0;Se<xe.length;Se++){const Ne=xe[Se];if(Ne>Z){const De=G[Ne];let ve=_e-H[Ne]-$[Ne],Be=ze-U[Ne]-ie[Ne];const $e=Re+De+se;let je=ve*ve+Be*Be;if(je<$e*$e){ve===0&&(ve=f(),je+=ve*ve),Be===0&&(Be=f(),je+=Be*Be);const Ye=Math.sqrt(je),w=($e-Ye)*te/Ye,I=De/$e;$[Z]+=ve*w*I,ie[Z]+=Be*w*I,$[Ne]-=ve*w*(1-I),ie[Ne]-=Be*w*(1-I)}}}}else{const xe=ge.data;if(xe>Z){const Se=G[xe];let Ne=_e-H[xe],De=ze-U[xe];const ve=Re+Se+se;let Be=Ne*Ne+De*De;if(Be<ve*ve){Ne===0&&(Ne=f(),Be+=Ne*Ne),De===0&&(De=f(),Be+=De*De);const $e=Math.sqrt(Be),je=(ve-$e)*te/$e,Ye=Se/ve;$[Z]+=Ne*je*Ye,ie[Z]+=De*je*Ye,$[xe]-=Ne*je*(1-Ye),ie[xe]-=De*je*(1-Ye)}}}},"getApplyForce"),Wn=i((H,U,G)=>{const{X:$,Y:ie,R:ue}=U;he=i(te=>$[te],"getX"),fe=i(te=>ie[te],"getY"),ae=i(te=>ue[te],"getR"),me=Sn(U),we=Jn(U,G)},"initialize");function Un(H,U,{masses:G,X:$,Y:ie,fx:ue,fy:te},{charge:se}){const ge=U.length;let Ee,xe,Se,Ne,De,ve,Be,$e,je;for(let Ye=0;Ye<ge;Ye++){Ee=U[Ye];for(let w=Ye+1;w<ge;w++)if(Ye!==w){if(xe=U[w],Ee===xe)continue;Se=$[Ee]-$[xe]||f(),Ne=ie[Ee]-ie[xe]||f(),De=Se*Se+Ne*Ne,De<1&&(De=Math.sqrt(1*De)),ve=se*G[xe],Be=H*ve/De,$e=se*G[Ee],je=H*$e/De,ue[Ee]+=Se*Be,te[Ee]+=Ne*Be,ue[xe]-=Se*je,te[xe]-=Ne*je}}}dt.initialize=Wn,i(Un,"repulsion"),Un.initialize=()=>{};var Xn=0;function Gn(H,U,G,{X:$,Y:ie,R:ue,masses:te,bucketSize:se}){Xn=H,G===null&&(G=new X(U,{getX:wt,getY:Lt,bucketSize:se})).postOrder(mt);const ge=U.length;for(let Ee=0;Ee<ge;Ee++)ot=U[Ee],jt=$[ot],Nt=ie[ot],Gt=ue[ot],Wt=te[ot],hn=Wt,G.preOrder(ht);return G}i(Gn,"repulsion");var is=i(({fx:H,fy:U,X:G,Y:$,R:ie,masses:ue,bucketSize:te},{charge:se,theta:ge})=>Ee=>{let xe=0,Se=0,Ne=jt-Ee.cx||f(),De=Nt-Ee.cy||f(),ve=Ne*Ne+De*De,Be=Gt+Ee.r;const $e=Ee.data;if($e!==null){if($e===ot)return!1;if(te!==0){const je=$e;for(let Ye=0;Ye<je.length;Ye++){const w=je[Ye];if(w===ot)continue;Ne=jt-G[w]||f(),De=Nt-$[w]||f(),ve=Ne*Ne+De*De,Be=Gt+ie[w],ve<1&&(ve=Math.sqrt(1*ve));const I=ue[w];xe=se*I*hn,Se=Xn*xe/ve,H[ot]+=Ne*Se/Wt,U[ot]+=De*Se/Wt}}else ve<1&&(ve=Math.sqrt(1*ve)),xe=se*Ee.mass*hn,Se=Xn*xe/ve,H[ot]+=Ne*Se/Wt,U[ot]+=De*Se/Wt}else{const je=Be/ge;if(ve>je*je)return ve<1&&(ve=Math.sqrt(1*ve)),xe=se*Ee.mass*hn,Se=Xn*xe/ve,H[ot]+=Ne*Se/Wt,U[ot]+=De*Se/Wt,!0}},"getApplyForce"),Vn=i(({X:H,Y:U,R:G,masses:$,bucketSize:ie})=>ue=>{let te,se,ge=0,Ee=0,xe=0,Se=0;const Ne=ue.data;if(Ne!==null)if(ie!==0){const De=Ne,ve=ut(De,wt,Lt,Tt);ge=ve.x,Ee=ve.y,xe=ve.r;for(let Be=0;Be<De.length;Be++)Se+=$[De[Be]]}else se=Ne,ge=H[se],Ee=U[se],xe=G[se],Se=$[se];else if(ue.left&&ue.right){const De=ue.left.cx,ve=ue.left.cy,Be=ue.right.cx,$e=ue.right.cy,je=ue.left.r,Ye=ue.right.r,w=Be-De,I=$e-ve,F=Ye-je,B=Math.sqrt(w*w+I*I);ge=(De+Be+w/B*F)/2,Ee=(ve+$e+I/B*F)/2,xe=(B+je+Ye)/2,Se=ue.left.mass+ue.right.mass}else te=ue.left||ue.right,ge=te.cx,Ee=te.cy,xe=te.r,Se=te.mass;ue.cx=ge,ue.cy=Ee,ue.r=xe,ue.mass=Se},"getAccumulateBodies"),An=i((H,U,G)=>{const $=H.length,{X:ie,Y:ue,R:te,degrees:se,pinned:ge,masses:Ee,nodeIds:xe}=U,{scaling:Se,defaultRadius:Ne,bucketSize:De}=G;U.bucketSize=De===void 0?Math.floor(Math.log($)):De;let ve=1/0,Be=1/0,$e=-1/0,je=-1/0;const Ye=Math.PI*(3-Math.sqrt(5));let w=0;for(let I=0;I<H.length;I++){const F=H[I];let{x:B,y:le,r:ee}=F;const{mass:ye=1}=F;if(isNaN(B)||isNaN(le)){const Pe=5*Math.sqrt(I),Ve=I*Ye;B=Pe*Math.cos(Ve),le=Pe*Math.sin(Ve)}ee=ee||Ne,ie[I]=B,ue[I]=le,te[I]=ee,ge[I]=F.pinned?1:0,Ee[I]=ye*(1+se[I])*Se,xe[I]=I,ee>w&&(w=ee),B<ve&&(ve=B),le<Be&&(Be=le),B>$e&&($e=B),le>je&&(je=le)}if(H.length>1&&($e-ve<2*w||je-Be<2*w)){const I=(ve+$e)/2,F=(Be+je)/2;for(let B=0;B<$;B++)if(!ge[B]){const le=5*Math.sqrt(B),ee=B*Ye,ye=I+le*Math.cos(ee),Pe=F+le*Math.sin(ee);ie[B]=ye,ue[B]=Pe,ye<ve&&(ve=ye),Pe<Be&&(Be=Pe),ye>$e&&($e=ye),Pe>je&&(je=Pe)}}wt=i(I=>ie[I],"getX"),Lt=i(I=>ue[I],"getY"),Tt=i(I=>te[I],"getR"),mt=Vn(U),ht=is(U,G)},"initialize");function Yn(H,U,{X:G,Y:$,fx:ie,fy:ue,vx:te,vy:se,masses:ge,pinned:Ee},xe){let Se=0,Ne=0;const De=H.length,ve=1/8;for(let Be=0;Be<De;Be++){const $e=H[Be],je=ge[$e],Ye=ie[$e]/je,w=ue[$e]/je;te[$e]+=Ye*ve,se[$e]+=w*ve;const I=.2*te[$e]*ve+.5*Ye*ve*ve,F=.2*se[$e]*ve+.5*w*ve*ve;ie[$e]=ue[$e]=0,Ee[$e]||(G[$e]+=I,$[$e]+=F,Se+=Math.abs(I)*je,Ne+=Math.abs(F)*je)}return(Se*Se+Ne*Ne)/De}function xn(H,U,{X:G,Y:$,fx:ie,fy:ue,vx:te,vy:se,pinned:ge,masses:Ee},xe){const Se=H.length;let Ne=0;for(let De=0;De<Se;De++){const ve=H[De],Be=Ee[ve],$e=ie[ve]/Be,je=ue[ve]/Be,Ye=te[ve]+1*$e,w=se[ve]+1*je;let I=1*Ye,F=1*w;I>1e4&&(I=.1),F>1e4&&(F=.1),te[ve]=U*(Ye+te[ve])/2,se[ve]=U*(w+se[ve])/2,ie[ve]=ue[ve]=0,ge[ve]||(G[ve]+=I,$[ve]+=F),Ne+=.5*(I*I+F*F)}return Ne}function fn(H,U,{X:G,Y:$,fx:ie,fy:ue,pinned:te,layer:se,layers:ge,surfaces:Ee,movements:xe},{maxDisplacement:Se}){xe.fill(0);let Ne=0;const De=H.length;let ve=1/0,Be=1/0,$e=-1/0,je=-1/0;const Ye=Se*Se;for(let F=0;F<De;F++){const B=H[F],le=ie[B]*=U,ee=ue[B]*=U,ye=se[B];let Pe=le,Ve=ee;const rt=G[B],it=$[B];if(Pe*Pe+Ve*Ve>Ye){const Jt=Math.sqrt(Pe*Pe+Ve*Ve)/Se;Ve/=Jt,Pe/=Jt}te[B]||(G[B]+=Pe,$[B]+=Ve);const St=Math.sqrt(Pe*Pe+Ve*Ve);te[B]||(rt<ve&&(ve=rt),it<Be&&(Be=it),rt>ve&&($e=rt),it>Be&&(je=it),xe[ye-1]+=St),Ne+=ye*St}const w=Math.max($e-ve,0),I=Math.max(je-Be,0);for(let F=0;F<ge.length;F++){const B=ge[F],le=B.length;let ee=1/0,ye=1/0,Pe=-1/0,Ve=-1/0,rt=0;for(let an=0;an<le;an++){const Qt=B[an];if(te[Qt])continue;const gn=G[Qt],Yt=$[Qt];gn<ee&&(ee=gn),Yt<ye&&(ye=Yt),gn>Pe&&(Pe=gn),Yt>Ve&&(Ve=Yt),rt++}const it=Pe-ee,St=Ve-ye,Jt=Math.max(1,Math.sqrt(it**2+St**2));Ee[F]=Jt;const Kt=rt===0?0:xe[F]/rt,Xt=w*I||1;xe[F]=Kt>rt?Kt/Xt:0}return Ne}function Ht(H,U,G){vt(H,U,G),Pn(G)}function vt(H,U,{sources:G,targets:$,degrees:ie,nodeIds:ue,edgeIds:te}){const se={};for(let ge=0;ge<H.length;ge++)se[ge]=ue[ge]=ge;for(let ge=0;ge<U.length;ge++){const{source:Ee,target:xe}=U[ge],Se=se[Ee],Ne=se[xe];te[ge]=ge,G[ge]=Se,$[ge]=Ne,ie[Se]++,ie[Ne]++}}function Pn({nodeIds:H,edgeIds:U,sources:G,targets:$,degrees:ie,layer:ue,layers:te,component:se,components:ge,cluster:Ee,parent:xe}){let Se=0,Ne=1;const De=new Uint32Array(H.length);for(let w=0;w<H.length;w++)De[w]=ie[w];const ve=new Array(H.length);for(let w=0;w<U.length;w++){const I=U[w],F=G[I],B=$[I];ve[F]=ve[F]||[],ve[B]=ve[B]||[],ve[F].push(B),ve[B].push(F)}const Be=new Uint8Array(H.length),$e=new Uint8Array(H.length);xe.fill(-1);let je=0;for(let w=0;w<H.length;w++)if(Be[w]===0){const I=[w];for(;I.length!==0;){const F=I.pop();if(Be[F]===0&&ve[F]!==void 0){const B=ve[F];for(let le=0;le<B.length;le++)I.push(B[le])}Be[F]=1,se[F]=je}je++}const Ye=new Array(H.length);for(let w=0;w<H.length;w++)ue[w]=0,Ye[w]=w;for(;Ye.length!==0;){const w=[],I=[];for(let F=0;F<Ye.length;F++)De[Ye[F]]<=Se&&(w.push(F),I.push(Ye[F]));for(let F=0;F<I.length;F++){const B=I[F];$e[B]=Se,ue[B]=Ne;const le=ve[B];if(le)for(let ee=0;ee<le.length;ee++)De[le[ee]]--}for(let F=0;F<I.length;F++){const B=I[F],le=ve[B];if(le)for(let ee=0;ee<le.length;ee++){const ye=le[ee],Pe=ue[ye];if(Pe===void 0||Pe>Ne){xe[B]=ye;break}}}w.reverse();for(let F=0;F<w.length;F++)Ye.splice(w[F],1);if(Ne+=1,Ye.length>0){let F=1/0;for(let B=0;B<Ye.length;B++){const le=De[Ye[B]];le<F&&(F=le)}F>=Se+1&&(Se=F,Ne=1)}}Be.fill(0);for(let w=0;w<H.length;w++){const I=H[w],F=ue[I];if(xe[I]===-1||ue[xe[I]]===F){const B=[I];for(Be.fill(0);B.length!==0;){const le=B.pop();if(Be[le])continue;if(ue[le]>F){xe[I]=le;break}const ee=ve[le];if(Be[le]=1,ee)for(let ye=0;ye<ee.length;ye++)B.push(ee[ye])}}}for(let w=0;w<H.length;w++){const I=H[w],F=se[I];ge[F]=ge[F]||[],ge[F].push(I);const B=ue[I]-1;te[B]=te[B]||[],te[B].push(I),Ee[I]=xe[I]}}Gn.initialize=An,i(Yn,"euler"),i(xn,"leapfrog"),i(fn,"velocityVerlet"),i(Ht,"default"),i(vt,"initTopology"),i(Pn,"decomposition");var Zn=class{constructor(H,U=!0){this.bucketSize=0;const G=H.nodes.length,$=H.edges.length;g(G+$),this.X=new Array(G),this.Y=new Array(G),this.R=new Array(G),this.fx=new Float32Array(G),this.fy=new Float32Array(G),this.vx=new Float32Array(G),this.vy=new Float32Array(G),this.pinned=new Uint8Array(G),this.masses=new Float32Array(G),this.weights=new Float32Array($),this.lengths=new Float32Array($),this.sources=new Uint32Array($),this.targets=new Uint32Array($),this.degrees=new Uint32Array(G),this.layer=new Uint32Array(G),this.parent=new Int32Array(G),this.cluster=new Int32Array(G),this.component=new Uint32Array(G),this.components=[],this.layers=[],this.nodeIds=new Array(G),this.edgeIds=new Array($),U&&Ht(H.nodes,H.edges,this),this.movements=new Array(this.layers.length).fill(0),this.surfaces=new Array(this.layers.length).fill(0),this.movementsPrev=new Array(this.layers.length).fill(0),this.surfacesPrev=new Array(this.layers.length).fill(0)}};function qt(H,U){return H<U?H*U+Math.pow(U-H-1,2)/4:H*U+Math.pow(H-U-1,2)/4}function cn(H,U){return(H+U)*(H+U+1)/2+U}function on({edgeIds:H,sources:U,targets:G,pinned:$,degrees:ie,X:ue,Y:te,R:se},ge=0,Ee=.5){const xe={},Se={};for(const Ne of H){const De=U[Ne],ve=G[Ne];De!==ve&&(xe[De]=xe[De]||{},xe[ve]=xe[ve]||{},xe[De][ve]=!0,xe[ve][De]=!0)}Object.keys(xe).forEach(Ne=>{const De=Number(Ne),ve=Object.keys(xe[Number(De)]);if(ve.length===2){const[Be,$e]=ve,je=qt(Number(Be),Number($e));je in Se||(Se[je]=[Number($e),Number(Be)]),$[De]||Se[je].push(De)}}),Object.keys(Se).forEach(Ne=>{const[De,ve,...Be]=Se[Number(Ne)];if(Be.length<3)return;const $e=ue[De],je=te[De],Ye=ue[ve],w=te[ve],I=ie[De],F=.25+.5*I/(I+ie[ve]);let B=$e+(Ye-$e)*F,le=je+(w-je)*F,ee=-(w-je),ye=Ye-$e;const Pe=Math.sqrt(Math.pow($e-Ye,2)+Math.pow(je-w,2));ee=-2*ee/Pe,ye=-2*ye/Pe;const Ve=Math.acos(ee/Math.sqrt(ee*ee+ye*ye));ge>0&&(Ve<ge||Ve>Math.PI-ge&&Ve<=Math.PI?(ee=2*Math.cos(Math.PI-ge),ye=2*Math.sin(Math.PI-ge)):(Ve>2*Math.PI-ge||Ve>=Math.PI&&Ve<Math.PI+ge)&&(ee=2*Math.cos(ge),ye=2*Math.sin(ge)));let rt=0,it=1;Be.sort((an,Qt)=>se[Qt]-se[an]);let St=0,Jt=0;const Kt=Math.max(se[Be[0]],se[Be[1]])/2;Be.length%2==1&&(rt=1,B-=ee*Kt,le-=ye*Kt);const Xt=1+Ee;for(let an=0;an<Be.length;an++){const Qt=(rt+an)%2,gn=Be[an],Yt=an>=2?se[gn]:Kt,as=(Qt?St:Jt)+Yt;ue[gn]=B+ee*it*as,te[gn]=le+ye*it*as,Qt?St+=Yt*Xt:Jt+=Yt*Xt,it=-it}})}function vn(H){let U=0,G=0;for(const te of H)U+=te.w*te.h,G=Math.max(G,te.w);H.sort((te,se)=>se.h-te.h);const $=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(U/.95)),G),h:1/0}];let ie=0,ue=0;for(const te of H)for(let se=$.length-1;se>=0;se--){const ge=$[se];if(!(te.w>ge.w||te.h>ge.h)){if(te.x=ge.x,te.y=ge.y,ue=Math.max(ue,te.y+te.h),ie=Math.max(ie,te.x+te.w),te.w===ge.w&&te.h===ge.h){const Ee=$.pop();se<$.length&&($[se]=Ee)}else te.h===ge.h?(ge.x+=te.w,ge.w-=te.w):te.w===ge.w?(ge.y+=te.h,ge.h-=te.h):($.push({x:ge.x+te.w,y:ge.y,w:ge.w-te.w,h:te.h}),ge.y+=te.h,ge.h-=te.h);break}}}function wn(H,U=1){return vn(H.map(G=>(G.w+=G.maxr+U,G.h+=G.maxr+U,G)).sort((G,$)=>G.w*G.h-$.w*$.h))}i(Zn,"LayoutData"),i(qt,"unorderedPair"),i(cn,"orderedPair"),i(on,"alignSiblings"),i(vn,"potpack"),i(wn,"boxpack");var Rn=class{constructor(){this.ids=[],this.xmin=1/0,this.ymin=1/0,this.xmax=-1/0,this.ymax=-1/0,this.x=0,this.y=0,this.w=0,this.h=0,this.cx=0,this.cy=0,this.radius=0,this.mx=0,this.my=0,this.m=0,this.maxr=0}add(H,U,G,$){this.ids.push(H),U-$<this.xmin&&(this.xmin=U-$),G-$<this.ymin&&(this.ymin=G-$),U+$>this.xmax&&(this.xmax=U+$),G+$>this.ymax&&(this.ymax=G+$),$>this.maxr&&(this.maxr=$),this.mx+=$*U,this.my+=$*G,this.m+=$}measure(H=0){return this.w=this.xmax-this.xmin+2*H,this.h=this.ymax-this.ymin+2*H,this.cx=this.mx/this.m,this.cy=this.my/this.m,this.x=this.xmin,this.y=this.ymin,this.radius=Math.sqrt(this.w*this.w+this.h*this.h)/2,this}};function jn(H,U=20,G,$,ie){for(const ve of H){const{x:Be,y:$e,r:je}=ut(ve.ids,Ye=>G[Ye],Ye=>$[Ye],Ye=>ie[Ye]);ve.cx=Be,ve.cy=$e,ve.radius=je+U}const ue=H.slice().sort((ve,Be)=>ve.radius-Be.radius),te=ue.map(ve=>({x:ve.cx,y:ve.cy,r:ve.radius})),se=ue.pop();let ge=3*Math.PI/2,Ee=se.radius;const xe=2*Math.PI,{cx:Se,cy:Ne}=se,De=[se];for(;ue.length!==0;){const ve=ue[ue.length-1],Be=Ee+ve.radius,$e=Se+Math.cos(ge)*Be,je=Ne+Math.sin(ge)*Be;De.some(Ye=>{const w=Ye.cx-$e,I=Ye.cy-je;return Math.sqrt(w*w+I*I)<Ye.radius+ve.radius})?Ee+=1:(ve.x=$e-ve.w/2,ve.y=je-ve.h/2,ve.cx=$e,ve.cy=je,te[ue.length-1].x=$e,te[ue.length-1].y=je,De.push(ue.pop()),ge+=(2*ve.radius+1)/Be*1%xe)}}function Bt(H,U,G,$){let ie=0;const ue=[];for(const te of $){const se=new Rn;for(const ge of te)se.add(ge,H[ge],U[ge],G[ge]);ue.push(se.measure()),te.length>ue[ie].ids.length&&(ie=ue.length-1)}return{boxes:ue,biggest:ie}}function os(H,U,{X:G,Y:$,R:ie,components:ue,pinned:te,degrees:se,sources:ge,targets:Ee,edgeIds:xe},{update:Se,onUpdate:Ne,placement:De,placementOffset:ve,alignSiblings:Be,siblingsMinAngle:$e,siblingsOffset:je}){if(Be&&(on({X:G,Y:$,R:ie,degrees:se,pinned:te,sources:ge,targets:Ee,edgeIds:xe},$e,je),Se(H,G,$)),De){const{boxes:Ye,biggest:w}=Bt(G,$,ie,ue);if(De==="spiral")jn(Ye,ve,G,$,ie);else{if(De!=="box")return;wn(Ye,ve)}const I=Ye[w].xmin-Ye[w].x,F=Ye[w].ymin-Ye[w].y;for(const B of Ye){const{xmin:le,ymin:ee,x:ye,y:Pe,ids:Ve}=B,rt=le-ye-I,it=ee-Pe-F;for(const St of Ve)G[St]-=rt,$[St]-=it}Se(H,G,$),Ne()}}i(Rn,"Component"),i(jn,"spiralpack"),i(Bt,"groupAndMeasure"),i(os,"postprocessing");var q=(H=>(H[H.verlet=0]="verlet",H[H.euler=1]="euler",H))(q||{}),Y=0,ne=typeof window>"u",K=typeof performance<"u"&&performance.now?performance:Date,Me=ne?H=>{const U=K.now(),G=Math.max(0,16-(U-Y)),$=setTimeout(()=>H(U+G),G);return Y=U+G,$}:window.requestAnimationFrame,Qe=ne?H=>clearTimeout(H):window.cancelAnimationFrame;function at(H,U,G){for(let $=0;$<H.length;$++){const ie=H[$];ie.x=U[$],ie.y=G[$]}}i(at,"defaultUpdate");var tt=i(()=>{},"noop"),ct={movementRatio:7e-8,surfaceRatio:.0025},yt=class{constructor(H={}){this.onUpdate=i(U=>{},"onUpdate"),this.update=at,this.nextTick=Me,this.cancelTick=Qe,this.onEnd=tt,this.charge=10,this.maxIterations=200,this.minMovement=.1,this.edgeLength=30,this.edgeStrength=3,this.friction=.1,this.elasticity=.9,this.margin=1,this.cx=void 0,this.cy=void 0,this.gravity=.01,this.theta=.34,this.batch=void 0,this.inertia=.9,this.integrator=0,this.multilevel=!1,this.placement="none",this.placementOffset=10,this.alignSiblings=!1,this.bucketSize=void 0,this.maxDisplacement=1e3,this.siblingsMinAngle=0,this.siblingsOffset=.15,this.steps=200,this.scaling=1,this.defaultRadius=1,this.autoStop=ct,this.gpuAcceleration=!0,this.barnesHutOptimization=!0,"autoStop"in H?H.autoStop&&(typeof H.autoStop=="boolean"?H.autoStop=ct:H.autoStop={...H.autoStop,...ct}):H.steps;for(const U in H)H[U]===void 0&&U!=="order"&&U!=="depth"||(this[U]=H[U])}};function Mt(H,U,{X:G,Y:$,R:ie,degrees:ue,nodeIds:te,edgeIds:se,layers:ge,layer:Ee,cluster:xe,masses:Se,weights:Ne,sources:De,targets:ve},{cx:Be,cy:$e,nextTick:je,cancelTick:Ye,update:w,onUpdate:I,batch:F,maxIterations:B,steps:le,minMovement:ee},ye,Pe){const Ve=ge.slice();F=F??1;let rt,it=0;function St(){Ye(rt),w(H,G,$),I(),Pe(it)}i(St,"stop");const Jt={};for(let pn=0;pn<U.length;pn++)Jt[Number(U[pn].id)||pn]=pn;const Kt=new Map;for(let pn=0;pn<se.length;pn++){const es=se[pn];Kt.set(cn(De[es],ve[es]),es)}for(let pn=0;pn<ge.length;pn++){const es=ge[pn],mr=pn;for(let Ss=0;Ss<es.length;Ss++){const mn=es[Ss],Fn=xe[mn];Fn!==-1&&(Se[Fn]+=Se[mn])}for(let Ss=0;Ss<U.length;Ss++){const mn=U[Ss],Fn=Number(mn.id)||Ss,Hn=mn.source,As=mn.target,_r=Ne[Jt[Fn]];if(Ee[Hn]===mr&&Ee[As]===mr){const ln=xe[Hn],Xs=xe[As];if(ln!==Xs){const ar=Kt.get(cn(ln,Xs));ar!==void 0&&(Ne[ar]+=_r)}}}}te.length=0,se.length=0,B=1/0;let Xt=1;const an=1-Math.pow(.1,1/le/2),Qt=(Xt-.1)/le;let gn,Yt,as=.5;function gs(){Xt+=(0-Xt)*an;const pn=ye(Xt,te,se);let es=Xt<=as||pn<ee;if(it===0||es){const mr=Ve.pop();if(mr){gn&&(Yt=gn.reduce((mn,Fn)=>Math.max(mn,Be-G[Fn],$e-$[Fn]),0)),te.push.apply(te,mr);for(let mn=0;mn<mr.length;mn++){const Fn=mr[mn],Hn=xe[Fn];if(Hn!==-1){const As=ue[Fn]>1?2:1,_r=ie[Hn]+ie[Fn];Se[Hn]-=Se[Fn],G[Fn]=G[Hn]+As*_r*(2*c()-1),$[Fn]=$[Hn]+As*_r*(2*c()-1)}else gn&&(G[Fn]=Be+2*Yt*(1-2*c()),$[Fn]=$e+2*Yt*(1-2*c()))}gn=mr;const Ss=te.reduce((mn,Fn)=>(mn[Fn]=!0,mn),{});se.length=0;for(let mn=0;mn<U.length;mn++){const{source:Fn,target:Hn,id:As}=U[mn];Ss[Fn]&&Ss[Hn]&&se.push(Jt[Number(As)])}es=!1,Ve.length===0?(Xt=.2,as=.1):(Xt=.1+2*Qt,as=.1)}}it%F==0&&(w(H,G,$),I()),++it>=B||es?St():rt=je(gs)}return i(gs,"simulationStep"),{done:!1,start(){return rt=setTimeout(gs),this},stop(){return St(),this},get iterations(){return it}}}i(yt,"Settings"),i(Mt,"multiLevel");var Pt=class{constructor(H){this.promise=new Promise(H)}then(H){return this.promise.then(H)}stop(){return this.simulation.stop(),this}get iterations(){return this.simulation.iterations()}};function At(H,U,{X:G,Y:$,nodeIds:ie,edgeIds:ue,layers:te,movements:se,movementsPrev:ge,surfaces:Ee,surfacesPrev:xe},Se,Ne,De){const{nextTick:ve,cancelTick:Be,steps:$e,minMovement:je,update:Ye,onUpdate:w,autoStop:I}=Se,F=Se.batch??1;let B=0,le=1,ee,ye=1-Math.pow(.05,1/$e),Pe=!1;const Ve=i(()=>{Pe=!0,Be(ee),w(),De(B)},"stop");let rt=!1;const it=i(()=>{le+=(.001-le)*ye;const St=Ne(le,ie,ue),Jt=te.length;let Kt=!1,Xt=!1;if(I){Kt=Xt=!0;const{movementRatio:Qt,surfaceRatio:gn}=I;for(let Yt=0;Yt<Jt;Yt++)Kt&&Math.abs(1-Ee[Yt]/xe[Yt])>gn&&(Kt=!1),Xt&&Math.abs(se[Yt]-ge[Yt])>Qt&&(Xt=!1)}Kt&&Xt&&!rt&&(ye=1-Math.pow(.001,1/Math.max(10,B)),rt=!0);const an=Pe||le<.05||St!==0&&St<=je;if(B%F==0&&(Ye(H,G,$),w()),++B>=$e||an)return Ve();for(let Qt=0;Qt<Jt;Qt++)ge[Qt]=se[Qt],xe[Qt]=Ee[Qt];ee=ve(it)},"simulationStep");return{done:!1,start(){return ee=setTimeout(it),this},stop(){return Ve(),this},get iterations(){return B}}}i(Pt,"SimulationPromise"),i(At,"singleLevel");var Ft,Zt={euler:Yn,verlet:fn,leapfrog:xn};function nn(H,U={}){let G,$;const ie=i((Ne={nodes:[],edges:[]})=>(G=Ne.nodes,$=Ne.edges,g(cn(G.length,$.length)),new Zn(Ne,!0)),"setGraph"),ue=i((Ne={})=>new yt(Ne),"setOptions");let te=ie(H),se=ue(U);_($,te),An(G,te,se),Wn(G,te,se),x(G,te,se);const ge=Zt[se.integrator]||fn;let Ee=null;const xe=i((Ne,De,ve)=>(Ee&&(Ee.destroy(),Ee=null),De.length<=1?0:(se.barnesHutOptimization?Ee=Gn(Ne,De,Ee,te):Un(Ne,De,te,se),p(Ne,ve,te,se),Ee&&se.elasticity!==0&&dt(0,De,Ee,te,se),y(Ne,De,te,se),ge(De,se.inertia,te,se))),"step");let Se;return{setOptions:(Ne={})=>(se=ue(Ne),this),setGraph:({nodes:Ne,edges:De})=>(te=ie(H),_(De,te),An(Ne,te,se),Wn(Ne,te,se),x(Ne,te,se),this),start(){return Se=(se.multilevel?Mt:At)(G,$,te,se,xe,Ne=>{Se.done||os(G,0,te,se),se.onEnd(Ne),Se.done=!0}).start(),this},iterations:()=>Se.iterations,data:()=>te,stop(){return Se&&Se.stop(),this},step(Ne=1){return xe(Ne,te.nodeIds,te.edgeIds),se.update(G,te.X,te.Y),this}}}return i(nn,"force"),nn.run=(H,U)=>{let G;const $=new Pt(ie=>{U.onEnd=ie,G=nn(H,U).start()});return $.simulation=G,$.stop=()=>(G.stop(),$),$},Ft=o,((H,U,G,$)=>{if(U&&typeof U=="object"||typeof U=="function")for(let ie of s(U))r.call(H,ie)||ie===G||t(H,ie,{get:()=>U[ie],enumerable:!($=n(U,ie))||$.enumerable});return H})(t({},"__esModule",{value:!0}),Ft)})();return e.default.apply(this,arguments)}pt(RS,"SimulationPromise"),pt(Jc,"gpuLayout"),Jc.run=(e,t,n)=>{let s;const r=new RS(i=>{n.onEnd=i,s=Jc(e,t,n).start()});return r.simulation=s,r.stop=()=>(s.stop(),r),r};var FG=2,DG=.001,OG=1.25,DS=e=>1,OS={name:"force",imports:{force:FS},configure(e,{graph:t,events:n}){const s=e.nodes._indexes,r=t.getNodeAttribute("x").getMultiple(s),i=t.getNodeAttribute("y").getMultiple(s),o=t.getNodeAttribute("radius").getMultiple(s),a=t.getNodeAttribute("layoutable").getMultiple(s),u=e.edges,d=[],c=[],g={},f=e.nodeMass||DS,p=e.edgeWeight||DS;e.edgeStrength===void 0&&(e.edgeStrength=.5),e.gpu&&(e.edgeStrength/=FG),e.gravity==null&&(e.gravity=.01),e.siblingsOffset==null&&(e.siblingsOffset=0),e.theta==null&&(e.theta=.62),e.autoStop=!!e.autoStop,e.alignSiblings=!!e.alignSiblings;const _=e.radiusRatio||OG;for(let x=0;x<e.nodes._indexes.length;x++){const E=e.nodes._indexes[x];g[E]=x,d.push({id:x,x:r[x],y:i[x],r:o[x]*_,mass:Math.max(DG,f(e.nodes.get(x))),pinned:!a[x]})}u.forEach(x=>{const E=g[x.getSource()._index],b=g[x.getTarget()._index];E!==b&&E!==void 0&&b!==void 0&&c.push({source:E,target:b,weight:p(x)})});const y=jg({...e});return delete y.nodes,delete y.edges,{graph:{nodes:d,edges:c},options:y,indexes:e.nodes._indexes,done:!1,x:r,y:i,chunkPeriod:250}},update:function(e,t){if(!t.simulation&&e){let n;t.done=!1,t.graph=e.graph,t.options=e.options,t.indexes=e.indexes;let s=!1;if(e.options.gpu){const u=MT("webgl2",{},()=>{Gi("GPU layout: WebGL context not available. Falling back on CPU."),t.simulation=void 0,t.options.gpu=!1,t.cleanUp&&t.cleanUp(),this._update(e,t)});u&&(n=u.context,t.cleanUp=u.cleanUp),s=!!n}let r=Date.now();s||(e.options.nextTick=u=>Date.now()-r<=t.chunkPeriod?u():(r=Date.now(),setTimeout(u,0))),e.options.update=(u,d,c)=>{t.x=d,t.y=c},e.options.onEnd=()=>{if(s&&n){const{X:u,Y:d}=t.simulation.data(!0);t.x=u,t.y=d}t.done=!0,t.simulation=void 0,t.cleanUp&&t.cleanUp()},e.options.bucketSize=0;const i=s&&n?Jc(e.graph,n,e.options).start():FS(e.graph,e.options).start();t.simulation=i;const{X:o,Y:a}=s&&n?{X:new Float32Array(e.graph.nodes.length),Y:new Float32Array(e.graph.nodes.length)}:i.data();t.x=o,t.y=a}return{graph:t.graph,indexes:t.indexes,x:t.x,y:t.y}},context:function(){return{done:!1,graph:{nodes:[],edges:[]},x:null,y:null,indexes:null,chunkPeriod:250}},stop:function(e){e.done=!0,e.simulation&&(e.simulation.stop(),delete e.simulation)},isRunning:function(e){return!e.done||(e.done=!1,!1)},onSync:function({indexes:e,x:t,y:n}){return{indexes:e,x:t,y:n}}};function zG(e,t,n,s=e.getNodes()){if(!t)return n?e.nodeList():s.filter(r=>r.getMetaNode()===null);if(!(t instanceof Ki)){if(Array.isArray(t)&&t.length>0)return e.getNodes(t);throw Error("[Layout]: 'nodes' must be a NodeList or an NodeId[]")}return t}function BG(e,t,n=e.getEdges()){if(!t)return n;if(!(t instanceof Ta)){if(Array.isArray(t)&&t.length>0)return e.getEdges(t);throw Error("[Layout]: 'edges' must be a EdgeList or a valid EdgeId[]")}return t}function UG(e){if(!e.size)return;const t=new Set(e.getId());return e.getAdjacentEdges().filter(n=>n.getExtremities().getId().every(s=>t.has(s)))}function YC(e,t={},n=!0){n||(t.edges=void 0);const s=zG(e,t.nodes,t.edges),r=BG(e,t.edges,UG(s));return{...t,nodes:s.concat(r.getExtremities()).dedupe(),edges:r}}function GG(e,t,n,s,r){return{x:e+r*(n-e),y:t+r*(s-t)}}var VG=10;function jG(e,t,n){let s,r,i=1/0;for(let o=0,a=t.length;o<a;o++){const u=t[o],d=t[(o+1)%a],c=nx(e[0],e[1],u[0],u[1],d[0],d[1]);c<i&&(i=c,s=u,r=d)}return HG(e[0],e[1],s[0],s[1],r[0],r[1],n)}function HG(e,t,n,s,r,i,o){const a=VT(e,t,n,s,r,i);let u=-(s-i),d=n-r;const c=Math.sqrt(u*u+d*d);return u/=c,d/=c,[a.x-o*u,a.y-o*d]}function qG(e,t,n,s){for(let r=0;r<e.length;r++){const[i,o]=e[r],a=Math.abs(i-t),u=Math.abs(o-n);if(a+u<=s||!(a>s||u>s)&&a*a+u*u<=s*s)return!0}return!1}function $G(e,t,n){const s=UT(n.cx,n.cy,e,t,n.minX,n.minY,n.maxX,n.maxY);let r,i=1/0,o={x:n.maxX,y:t};for(const a of s)r=ss(e,t,a.x,a.y),r<i&&(i=r,o=a);return o}function WG(e){const t=e.bottomLeft(),n=e.topRight();return[[t.x,t.y],[t.x,n.y],[n.x,n.y],[n.x,t.y]]}function XG(e,t,n,s){const r=[],i=[],o=[];return e.forEach((a,u)=>{s[u]&&(r.push(a),i.push(t[u]),o.push(n[u]))}),{ids:r,subgraphPositions:i,radii:o}}function YG(e,t,n){const{duration:s=0,margin:r=5,referenceNodes:i,nodes:o}=t,{ids:a,subgraphPositions:u,radii:d}=XG(o.getId(),n,o.getAttribute("radius"),o.getAttribute("layoutable")),c=e.getNodes(a);let g=i;!g||g instanceof Ki||(g=e.getNodes(g));const f=g||c.inverse(),p=f.getPosition().map(R=>[R.x,R.y]),_=c.getBoundingBox(),y=f.getBoundingBox();y.pad(y.maxScaledSize);const x={layoutName:"incremental",ids:c.getId(),positions:{before:u,current:u}};if(!c.size)return Promise.resolve(x);const E=Od(u.map(R=>R.x),u.map(R=>R.y),d),[b,S]=E,A=E[2]+y.maxScaledSize+r;let C,k=0,M=0;if(qG(p,b,S,A))if(f.size<=3){if(Fy(b,S,E[2],y.minX,y.minY,y.maxX,y.maxY)){const R=$G(b,S,y);C=ss(y.cx,y.cy,R.x,R.y);const O=GG(y.cx,y.cy,R.x,R.y,(C+A)/C);k=O.x-b,M=O.y-S}}else{const R=ky.from(p,oe=>oe[0],oe=>oe[1]),O=hd(R.triangles,p),j=p.length>3?hd(R.hull,p):WG(y),z=F1(f.getPosition(),VG,A,O,j);let X=jG([b,S],j,A);if(z.length>0){let oe=Math.pow(b-X[0],2)+Math.pow(S-X[1],2);for(const re of z)k=b-re[0],M=S-re[1],C=k*k+M*M,C<oe&&(oe=C,X=re.slice(0,2));k=X[0]-b,M=X[1]-S}else k=X[0]-_.cx,M=X[1]-_.cy}if(k||M){const R=u.map(O=>(O.x+=k,O.y+=M,O));if(t.locate){typeof t.locate=="boolean"&&(t.locate={});const O=e.modules.locate.layoutDataBoundingBox({x:[...p.map(z=>z[0]),...R.map(z=>z.x)],y:[...p.map(z=>z[1]),...R.map(z=>z.y)],indexes:e.getNodes()._indexes}),j=e.modules.locate.computeConfigForBounds(O,t.locate);e.modules.camera.setView(j,{duration:s,easing:t.locate.easing,ignoreZoomLimits:!0})}return x.positions.current=R,c.setAttributes(R,s).then(()=>x)}return c.setAttributes(u,s).then(()=>x)}function ZG(e,t,n){const s=Bn(t);return s.duration=0,s.dryRun=!0,s.locate=!1,delete s.incremental,n(s).then(r=>YG(e,t,r.positions.current))}function KG(e,t,n){const{nodes:s,duration:r,centralNode:i}=t,o=s,a=o.reduce((d,c)=>(d[c._index]=!0,d),{}),u=e.getNodes();if(t.focusOnGroupShape)return n({nodes:o,duration:0}).then(()=>{const d=o.concat(i),c=d.getAttribute("layoutable");return d.setAttributes({layoutable:!1}),n({nodes:e.getNodes(),duration:r}).then(()=>d.setAttributes(c))});{const d=Bn(t);return delete d.centralNode,d.incremental=!1,d.nodes=u,d.nodeMass=(c,g)=>(g+1)*(a[c._index]?1:2),n(d)}}function ZC(e,t,n){const s=YC(t.modules.graph,e);if(typeof s.incremental!="boolean"&&"margin"in s.incremental&&!isFinite(s.incremental.margin))throw new Error("Incremental layout: margin has to be a positive number");const r=Bn(s);return typeof s.incremental!="boolean"&&(r.margin=s.incremental.margin,r.referenceNodes=s.incremental.referenceNodes),r.centralNode&&!r.centralNode.getAttribute("layoutable")?KG(t,r,n):ZG(t,r,n)}var QG=e=>(e.modules.layouts.register(OS),(t={})=>{if(t.incremental)return ZC(t,e,e.layouts.force);if(t.edgeStrength!==void 0&&(!isFinite(t.edgeStrength)||t.edgeStrength<0))throw new Error("force layout: edgeStrength must be a positive number");if(t.steps!==void 0&&(!isFinite(t.steps)||t.steps<=0))throw new Error("force layout: 'steps' must be a positive integer");if(t.edgeLength!==void 0&&(!isFinite(t.edgeLength)||t.edgeLength<=0))throw new Error("force layout: 'edgeLength' must be positive");if(t.gravity!==void 0&&(!isFinite(t.gravity)||t.gravity<0||t.gravity>=1))throw new Error("force layout: 'gravity' must be between 0 and 1");if(t.charge!==void 0&&!isFinite(t.charge))throw new Error("force layout: 'charge' must be a number");if(t.radiusRatio!==void 0&&(!isFinite(t.radiusRatio)||t.radiusRatio<0))throw new Error("force layout: 'radiusRatio' must be a positive number");if(t.theta!==void 0&&(!isFinite(t.theta)||t.theta<0||t.theta>1))throw new Error("force layout: 'theta' must be between 0 and 1");if(!(t.cx===void 0&&t.cy===void 0||typeof t.cx=="number"&&typeof t.cy=="number"))throw new Error("force layout: both 'cx' and 'cy' must be numbers");if(t.siblingsOffset!==void 0&&!isFinite(t.siblingsOffset))throw new Error("force layout: 'siblingsOffset' must be a number");return t.gpu=!!t.gpu,t.gpu&&(t.useWebWorker=!1),e.modules.layouts.start(OS.name,t)}),zS={name:"forceLink",configure:function(e,{graph:t,camera:n,graphics:s}){const r=e.nodes._indexes,i=e.edges._indexes,o={},a={},u=r.length,d=i.length;let c;var g=t.getObjectList(!0),f=t.getObjectList(!1);(e.nodes||e.edges)&&(delete(e=Bn(e)).nodes,delete e.edges);const p=t.getNodeAttribute("innerStroke.width").getMultiple(r),_=t.getNodeAttribute("outerStroke.width").getMultiple(r),y=t.degrees(r),x=t.getNodeAttribute("x").getMultiple(r),E=t.getNodeAttribute("y").getMultiple(r),b=t.getNodeAttribute("radius").getMultiple(r),S=t.nodeList(r).getAttribute("layoutable"),A=typeof e.nodeMass=="function"?e.nodeMass:function(Q,he,fe){return he+1};delete e.nodeMass;const C=typeof e.edgeWeight=="function"?e.edgeWeight:function(Q){return 1};delete e.edgeWeight,isFinite(e.scalingRatio)||delete e.scalingRatio;const k=r.reduce((Q,he,fe)=>(S[fe]||(Q[he]=!0),Q),{});let M=0,R=0,O=0;const j=n.getZoom();for(c=0;c<r.length;++c){const Q=r[c],he=x[c],fe=E[c],ae=b[c]+(p[c]+_[c])/j;o[Q]={id:Q,x:he,y:fe,degree:y[c],size:ae,pinned:!!k[Q],mass:A(g.get(Q),y[c],c)},O=Math.max(ae,O)}if(u>1)for(c=0;c<u;c++){const Q=o[r[c]];M+=Q.x,R+=Q.y}M/=u,R/=u;const z={x:M,y:R},X=t.edgeList(i),oe=X.getSource()._indexes,re=X.getTarget()._indexes;for(c=0;c<d;c++){const Q=i[c],he=oe[c],fe=re[c];o[he]&&o[fe]&&(a[Q]={source:he,target:fe},a[Q].weight=C(f.get(Q)))}return{nodes:o,edges:a,maxSize:O,config:jg(e),barycentre:z}},context:function(){return{chunkPeriod:250}},update:function(e,t){let n;!t.W&&e?(n={ppn:10,ppe:3,ppr:9,MAX_SUBDIVISION_RETRIES:3,maxForce:10,iterations:0,converged:!1,settings:{linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:0,scalingRatio:100,strongGravityMode:!0,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5,startingIterations:10,iterationsPerRender:10,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:!0,alignNodeSiblings:!0,nodeSiblingsScale:5,nodeSiblingsAngleMin:0}},t.W=n,function(d,c){const g=function(p,_){let y,x,E,b=p.nodes,S=p.edges,A=p.maxSize,C=Object.keys(p.nodes),k=Object.keys(p.edges),M=C.length*n.ppn,R=k.length*n.ppe,O={};const j=Math.pow(10,Math.log(Math.max(A,1))-6),z=j/2,X=Math.random,oe=_.randomizeFactor||1;let re;re=_.randomize==="locally"?fe=>fe+X()*oe:_.randomize==="globally"?fe=>X()*oe:fe=>fe+X()*j-z;const Q=new Float32Array(M),he=new Float32Array(R);for(y=x=0,E=C.length;y<E;y++){const fe=C[y],ae=b[fe];let me=ae.x,we=ae.y;ae.pinned||(me=re(me),we=re(we)),O[fe]=x,Q[x]=me,Q[x+1]=we,Q[x+2]=0,Q[x+3]=0,Q[x+4]=0,Q[x+5]=0,Q[x+6]=ae.mass,Q[x+7]=1,Q[x+8]=ae.size,Q[x+9]=ae.pinned||0,x+=n.ppn}for(y=x=0,E=k.length;y<E;y++){const fe=S[k[y]];he[x]=O[fe.source],he[x+1]=O[fe.target],he[x+2]=fe.weight||0,x+=n.ppe}return{nodes:Q,edges:he}}(d,c);t.NodeMatrix=g.nodes,t.EdgeMatrix=g.edges,n.nodesLength=t.NodeMatrix.length,n.edgesLength=t.EdgeMatrix.length}(e,e.config),n.settings=function(d,c){for(const g in d)c[g]=d[g];return c}(e.config,n.settings),t.nodes=e.nodes,t.edges=e.edges,t.barycentre=e.barycentre):n=t.W;let s,r=t.NodeMatrix,i=t.EdgeMatrix;function o(){let u,d,c,g,f,p,_,y,x,E,b,S,A,C,k,M,R;for(c=0;c<n.nodesLength;c+=n.ppn)r[c+4]=r[c+2],r[c+5]=r[c+3],r[c+2]=0,r[c+3]=0;if(n.settings.outboundAttractionDistribution){for(x=0,c=0;c<n.nodesLength;c+=n.ppn)x+=r[c+6];x/=n.nodesLength}if(n.settings.barnesHutOptimize){let re,Q,he,fe,ae=1/0,me=-1/0,we=1/0,Z=-1/0;for(s=[],c=0;c<n.nodesLength;c+=n.ppn)ae=Math.min(ae,r[c+0]),me=Math.max(me,r[c+0]),we=Math.min(we,r[c+1]),Z=Math.max(Z,r[c+1]);const _e=me-ae,ze=Z-we;for(_e>ze?(we-=(_e-ze)/2,Z=we+_e):(ae-=(ze-_e)/2,me=ae+ze),s[0]=-1,s[1]=(ae+me)/2,s[2]=(we+Z)/2,s[3]=Math.max(me-ae,Z-we),s[4]=-1,s[5]=-1,s[6]=0,s[7]=0,s[8]=0,u=1,c=0;c<n.nodesLength;c+=n.ppn)for(d=0,he=n.MAX_SUBDIVISION_RETRIES;;){if(!(s[d+5]>=0)){if(s[d+0]<0){s[d+0]=c;break}if(s[d+5]=u*n.ppr,_=s[d+3]/2,y=s[d+5],s[y+0]=-1,s[y+1]=s[d+1]-_,s[y+2]=s[d+2]-_,s[y+3]=_,s[y+4]=y+n.ppr,s[y+5]=-1,s[y+6]=0,s[y+7]=0,s[y+8]=0,y+=n.ppr,s[y+0]=-1,s[y+1]=s[d+1]-_,s[y+2]=s[d+2]+_,s[y+3]=_,s[y+4]=y+n.ppr,s[y+5]=-1,s[y+6]=0,s[y+7]=0,s[y+8]=0,y+=n.ppr,s[y+0]=-1,s[y+1]=s[d+1]+_,s[y+2]=s[d+2]-_,s[y+3]=_,s[y+4]=y+n.ppr,s[y+5]=-1,s[y+6]=0,s[y+7]=0,s[y+8]=0,y+=n.ppr,s[y+0]=-1,s[y+1]=s[d+1]+_,s[y+2]=s[d+2]+_,s[y+3]=_,s[y+4]=s[d+4],s[y+5]=-1,s[y+6]=0,s[y+7]=0,s[y+8]=0,u+=4,fe=d+0,re=r[s[fe]+0]<s[d+1]?r[s[fe]+1]<s[d+2]?s[d+5]:s[d+5]+n.ppr:r[s[fe]+1]<s[d+2]?s[d+5]+2*n.ppr:s[d+5]+3*n.ppr,s[d+6]=r[s[fe]+6],s[d+7]=r[s[fe]+0],s[d+8]=r[s[fe]+1],s[re+0]=s[d+0],s[d+0]=-1,Q=r[c+0]<s[d+1]?r[c+1]<s[d+2]?s[d+5]:s[d+5]+n.ppr:r[c+1]<s[d+2]?s[d+5]+2*n.ppr:s[d+5]+3*n.ppr,re===Q){if(he--){d=re;continue}he=n.MAX_SUBDIVISION_RETRIES;break}s[Q+0]=c;break}re=r[c+0]<s[d+1]?r[c+1]<s[d+2]?s[d+5]:s[d+5]+n.ppr:r[c+1]<s[d+2]?s[d+5]+2*n.ppr:s[d+5]+3*n.ppr,s[d+7]=(s[d+7]*s[d+6]+r[c+0]*r[c+6])/(s[d+6]+r[c+6]),s[d+8]=(s[d+8]*s[d+6]+r[c+1]*r[c+6])/(s[d+6]+r[c+6]),s[d+6]+=r[c+6],d=re}}if(n.settings.barnesHutOptimize)for(E=n.settings.scalingRatio,c=0;c<n.nodesLength;c+=n.ppn)for(d=0;;)if(s[d+5]>=0){if(M=Math.sqrt((r[c+0]-s[d+7])*(r[c+0]-s[d+7])+(r[c+1]-s[d+8])*(r[c+1]-s[d+8])),2*s[d+3]/M<n.settings.barnesHutTheta){if(b=r[c+0]-s[d+7],S=r[c+1]-s[d+8],n.settings.adjustSizes?M>0?(R=E*r[c+6]*s[d+6]/M/M,r[c+2]+=b*R,r[c+3]+=S*R):M<0&&(R=-E*r[c+6]*s[d+6]/M,r[c+2]+=b*R,r[c+3]+=S*R):M>0&&(R=E*r[c+6]*s[d+6]/M/M,r[c+2]+=b*R,r[c+3]+=S*R),s[d+4]<0)break;d=s[d+4];continue}d=s[d+5]}else{if(s[d+0]>=0&&s[d+0]!==c&&(b=r[c+0]-r[s[d+0]+0],S=r[c+1]-r[s[d+0]+1],M=Math.sqrt(b*b+S*S),n.settings.adjustSizes?M>0?(R=E*r[c+6]*r[s[d+0]+6]/M/M,r[c+2]+=b*R,r[c+3]+=S*R):M<0&&(R=-E*r[c+6]*r[s[d+0]+6]/M,r[c+2]+=b*R,r[c+3]+=S*R):M>0&&(R=E*r[c+6]*r[s[d+0]+6]/M/M,r[c+2]+=b*R,r[c+3]+=S*R)),s[d+4]<0)break;d=s[d+4]}else for(E=n.settings.scalingRatio,g=0;g<n.nodesLength;g+=n.ppn)for(f=0;f<g;f+=n.ppn)b=r[g+0]-r[f+0],S=r[g+1]-r[f+1],n.settings.adjustSizes?(M=Math.sqrt(b*b+S*S)-r[g+8]-r[f+8],M>0?(R=E*r[g+6]*r[f+6]/M/M,r[g+2]+=b*R,r[g+3]+=S*R,r[f+2]+=b*R,r[f+3]+=S*R):M<0&&(R=100*E*r[g+6]*r[f+6],r[g+2]+=b*R,r[g+3]+=S*R,r[f+2]-=b*R,r[f+3]-=S*R)):(M=Math.sqrt(b*b+S*S),M>0&&(R=E*r[g+6]*r[f+6]/M/M,r[g+2]+=b*R,r[g+3]+=S*R,r[f+2]-=b*R,r[f+3]-=S*R));for(y=n.settings.gravity/n.settings.scalingRatio,E=n.settings.scalingRatio,c=0;c<n.nodesLength;c+=n.ppn)R=0,b=r[c+0],S=r[c+1],M=Math.sqrt(b*b+S*S),n.settings.strongGravityMode?M>0&&(R=E*r[c+6]*y):M>0&&(R=E*r[c+6]*y/M),r[c+2]-=b*R,r[c+3]-=S*R;for(E=1*(n.settings.outboundAttractionDistribution?x:1),p=0;p<n.edgesLength;p+=n.ppe)g=i[p+0],f=i[p+1],_=i[p+2],k=Math.pow(_,n.settings.edgeWeightInfluence),b=r[g+0]-r[f+0],S=r[g+1]-r[f+1],n.settings.adjustSizes?(M=Math.sqrt(b*b+S*S)-r[g+8]-r[f+8],n.settings.linLogMode?n.settings.outboundAttractionDistribution?M>0&&(R=-E*k*Math.log(1+M)/M/r[g+6]):M>0&&(R=-E*k*Math.log(1+M)/M):n.settings.outboundAttractionDistribution?M>0&&(R=-E*k/r[g+6]):M>0&&(R=-E*k)):(M=Math.sqrt(b*b+S*S),n.settings.linLogMode?n.settings.outboundAttractionDistribution?M>0&&(R=-E*k*Math.log(1+M)/M/r[g+6]):M>0&&(R=-E*k*Math.log(1+M)/M):n.settings.outboundAttractionDistribution?(M=1,R=-E*k/r[g+6]):(M=1,R=-E*k)),M>0&&(r[g+2]+=b*R,r[g+3]+=S*R,r[f+2]-=b*R,r[f+3]-=S*R);let O,j,z,X,oe=0;if(n.settings.adjustSizes)for(c=0;c<n.nodesLength;c+=n.ppn)r[c+9]||(O=Math.sqrt(r[c+2]*r[c+2]+r[c+3]*r[c+3]),O>n.maxForce&&(r[c+2]=r[c+2]*n.maxForce/O,r[c+3]=r[c+3]*n.maxForce/O),j=r[c+6]*Math.sqrt((r[c+4]-r[c+2])*(r[c+4]-r[c+2])+(r[c+5]-r[c+3])*(r[c+5]-r[c+3])),z=Math.sqrt((r[c+4]+r[c+2])*(r[c+4]+r[c+2])+(r[c+5]+r[c+3])*(r[c+5]+r[c+3]))/2,X=.1*Math.log(1+z)/(1+Math.sqrt(j)),A=r[c+0],C=r[c+1],r[c+0]=r[c+0]+r[c+2]*(X/n.settings.slowDown),r[c+1]=r[c+1]+r[c+3]*(X/n.settings.slowDown),b=r[c+0],S=r[c+1],M=Math.sqrt((b-A)*(b-A)+(S-C)*(S-C)),oe+=M);else for(c=0;c<n.nodesLength;c+=n.ppn)r[c+9]||(j=r[c+6]*Math.sqrt((r[c+4]-r[c+2])*(r[c+4]-r[c+2])+(r[c+5]-r[c+3])*(r[c+5]-r[c+3])),z=Math.sqrt((r[c+4]+r[c+2])*(r[c+4]+r[c+2])+(r[c+5]+r[c+3])*(r[c+5]+r[c+3]))/2,X=r[c+7]*Math.log(1+z)/(1+Math.sqrt(j)),r[c+7]=Math.min(1,Math.sqrt(X*(r[c+2]*r[c+2]+r[c+3]*r[c+3])/(1+Math.sqrt(j)))),A=r[c+0],C=r[c+1],r[c+0]=r[c+0]+r[c+2]*(X/n.settings.slowDown),r[c+1]=r[c+1]+r[c+3]*(X/n.settings.slowDown),b=r[c+0],S=r[c+1],M=Math.sqrt((b-A)*(b-A)+(S-C)*(S-C)),oe+=M);if(n.iterations++,n.settings.autoStop&&(n.converged=n.iterations>n.settings.maxIterations||oe/n.nodesLength<n.settings.avgDistanceThreshold,n.converged&&n.settings.alignNodeSiblings)){let re,Q,he={},fe={};for(p=0;p<n.edgesLength;p+=n.ppe)g=i[p+0],f=i[p+1],g!==f&&(he[g]=he[g]||{},he[f]=he[f]||{},he[g][f]=!0,he[f][g]=!0);Object.keys(he).forEach(Fe=>{var Oe=~~Fe;Q=Object.keys(he[Oe]),Q.length==2&&(re=Q[0]+";"+Q[1],re in fe||(re=Q[1]+";"+Q[0],fe[re]||(fe[re]=[~~Q[1],~~Q[0]])),fe[re].push(Oe))});let ae,me,we,Z,_e,ze,Re,We,st,ft,ut,ce,be,qe,Ue,Ie=n.settings.nodeSiblingsAngleMin;Object.keys(fe).forEach(Fe=>{if(me=fe[Fe].shift(),we=fe[Fe].shift(),ae=fe[Fe].filter(mt=>!r[mt+9]),ae.length==1)return;if(ze=r[me+0],Re=r[me+1],We=r[we+0],st=r[we+1],Z=Object.keys(he[me]).length,_e=Object.keys(he[we]).length,ft=function(ht,wt,Lt,Tt,ot){return(ot-Tt)*(ht-wt)/(Lt-wt)+Tt}(Z/(Z+_e),0,1,1/4,3/4),ce=function(ht,wt,Lt,Tt,ot){return{x:ht+(Lt-ht)*ot,y:wt+(Tt-wt)*ot}}(ze,Re,We,st,ft),be=function(ht,wt,Lt,Tt){return{xi:-(Tt-wt),yi:Lt-ht,xiPrime:Tt-wt,yiPrime:-(Lt-ht)}}(ze,Re,We,st),ut=function(ht,wt,Lt,Tt){const ot=Lt-ht,jt=Tt-wt;return Math.sqrt(ot*ot+jt*jt)}(ze,Re,We,st),qe=function(ht,wt){return{x:(ht.xiPrime-ht.xi)/wt,y:(ht.yiPrime-ht.yi)/wt}}(be,ut),Ue=function(ht){return Math.acos(ht.x/Math.sqrt(ht.x*ht.x+ht.y*ht.y))}(qe),2*Ie>Math.PI)throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.");Ie>0&&(Ue<Ie||Ue>Math.PI-Ie&&Ue<=Math.PI?qe={x:2*Math.cos(Math.PI-Ie),y:2*Math.sin(Math.PI-Ie)}:(Ue>2*Math.PI-Ie||Ue>=Math.PI&&Ue<Math.PI+Ie)&&(qe={x:2*Math.cos(Ie),y:2*Math.sin(Ie)}));let Oe=0,Xe=1,dt=1;ae.length%2==1&&(dt=0,Oe=1);for(let mt=0;mt<ae.length;mt++)r[ae[mt]+0]=ce.x+Xe*qe.x*dt*(Oe||mt>=2?n.settings.nodeSiblingsScale:2*n.settings.nodeSiblingsScale/3),r[ae[mt]+1]=ce.y+Xe*qe.y*dt*(Oe||mt>=2?n.settings.nodeSiblingsScale:2*n.settings.nodeSiblingsScale/3),Xe=-Xe,dt+=(mt+Oe)%2})}}function a(u){const d=Object.keys(u),c={};for(let g=0;g<r.length;g+=n.ppn){const f=d[g/n.ppn];c[f]={id:f,x:r[g+0],y:r[g+1],pinned:r[g+9]}}return c}return function(){if(n.settings.autoStop){const d=Date.now();for(;!(n.converged||Date.now()-d>=t.chunkPeriod);)o()}else{const d=n.iterations===0?n.settings.startingIterations:n.iterations+n.settings.iterationsPerRender;for(;n.iterations!==d;)o()}return{nodes:a(t.nodes),barycentre:t.barycentre}}()},isRunning:function(e){return!e.W.settings.autoStop||!e.W.converged||(e.W=void 0,!1)},stop:function(e){e.W&&(e.W.converged=!0)},onSync:function({nodes:e,barycentre:t},{graph:n}){const s=Object.keys(e),r=s.length;let i,o,a,u,d,c,g,f,p=0,_=0;const y=new Array(r),x=new Array(r),E=new Array(r),b=new Array(r),[S,A]=n.getAttributes(!0,["x","y"]);for(i=0;i<r;i++)o=s[i],a=e[o],f=parseInt(o),y[i]=f,b[i]=a.pinned,a.pinned?(u=S.get(f),d=A.get(f)):(u=a.x,d=a.y),x[i]=u,E[i]=d,p+=u,_+=d;for(c=p/r-t.x,g=_/r-t.y,i=0;i<r;i++)b[i]||(x[i]-=c,E[i]-=g);return{indexes:y,x,y:E}}},JG=e=>(e.modules.layouts.register(zS),(t={})=>t.incremental?ZC(t,e,e.layouts.forceLink):e.modules.layouts.start(zS.name,t)),BS={name:"grid",configure:function(e,{graph:t,camera:n}){function s(C){return C===void 0||typeof C=="number"&&isFinite(C)&&C>0}const r=e.sortBy,i=e,o=i.nodes,a=Array.from(o._indexes),u=a.length,{rows:d,cols:c,rowDistance:g,colDistance:f}=function(k,M,R,O,j){if(!s(M))throw new TypeError('"rows" should be a positive integer');if(!s(R))throw new TypeError('"cols" should be a positive integer');if(!s(O))throw new TypeError('"rowDistance" should be a positive number');if(!s(j))throw new TypeError('"colDistance" should be a positive number');if(M)return{rows:M,cols:Math.ceil(k/M),rowDistance:O,colDistance:j};if(R)return{cols:R,rows:Math.ceil(k/R),rowDistance:O,colDistance:j};const z=Math.ceil(Math.sqrt(k));return{cols:z,rows:Math.ceil(k/z),rowDistance:O,colDistance:j}}(u,i.rows,i.cols,i.colDistance,i.rowDistance),p=function(k,M,R,O,j){return typeof k!="string"?O.map((z,X)=>X):k==="radius"?M.getAttribute(!0,"radius").getMultiple(O):k==="degree"?R.getDegree():k==="random"?O.map(()=>Math.random()):R.getData(k).map(z=>z||j)}(r,t,o,a,e.sortFallbackValue),_=o.getAttribute("layoutable"),y=a.reduce((C,k,M)=>(_[M]&&C.push({id:k,attr:p[M]}),C),[]),x=o.getAttribute("x"),E=o.getAttribute("y"),b=o.getAttribute("radius");let S=1/0,A=1/0;for(let C=0;C<a.length;C++)S=Math.min(S,x[C]),A=Math.min(A,E[C]);return{sort:!!r,nodes:y,reverse:!!i.reverse,cols:c,rows:d,minX:S,minY:A,rs:b,rowDistance:g,colDistance:f}},update:function({sort:e,nodes:t,minX:n,rs:s,minY:r,reverse:i,cols:o,rowDistance:a,colDistance:u}){const d=t.map((E,b)=>b);e&&d.sort((E,b)=>t[E].attr-t[b].attr),i&&d.reverse();let c=0;for(let E=0;E<t.length;E++){const b=E>0&&(E+1)%o==0,S=E%o==0,A=b?0:s[d[E+1]]||0,C=S?0:s[d[E+o-1]]||0,k=s[d[E+o]]||0,M=b?0:s[d[E+o+1]]||0,R=s[d[E]]||0;c=Math.max(c,R+A,R+C,R+k,R+M)}let g=c+1,f=c+1;const p=n,_=r;isFinite(g)||(g=0),isFinite(f)||(f=0),a!==void 0&&isFinite(a)&&(g=c+a),u!==void 0&&isFinite(u)&&(f=c+u);let y=0,x=0;return d.forEach(E=>{const b=t[E];b.x=p+y*g,b.y=_+x*f,y+=1,y===o&&(x+=1,y=0)}),t},onSync:function(e){return{indexes:e.map(({id:t})=>t),x:e.map(({x:t})=>t),y:e.map(({y:t})=>t)}}},eV=e=>(e.modules.layouts.register(BS),(t={})=>e.modules.layouts.start(BS.name,t));function tV(e){let t=0,n=0;for(const o of e)t+=o.w*o.h,n=Math.max(n,o.w);e.sort((o,a)=>a.h-o.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let r=0,i=0;for(const o of e)for(let a=s.length-1;a>=0;a--){const u=s[a];if(!(o.w>u.w||o.h>u.h)){if(o.x=u.x,o.y=u.y,i=Math.max(i,o.y+o.h),r=Math.max(r,o.x+o.w),o.w===u.w&&o.h===u.h){const d=s.pop();a<s.length&&(s[a]=d)}else o.h===u.h?(u.x+=o.w,u.w-=o.w):o.w===u.w?(u.y+=o.h,u.h-=o.h):(s.push({x:u.x+o.w,y:u.y,w:u.w-o.w,h:o.h}),u.y+=o.h,u.h-=o.h);break}}return{w:r,h:i,fill:t/(r*i)||0}}var nV={down:()=>{},up:e=>e.y=-e.y,left:e=>{const t=e.x;e.x=-e.y,e.y=t},right:e=>{const t=e.x;e.x=e.y,e.y=-t}},Em=(e,t)=>isFinite(e)&&e>0?e:t;function sV(e){return{nodesSeparation:Em(e.nodesSeparation,0),componentsSeparation:Em(e.componentsSeparation,25),layerSeparation:Em(e.layerSeparation,50)}}function rV(e,{componentsSeparation:t,packing:n}){const s=[];for(let r=0;r<e.length;r++){const i=e[r],o=i.nodes;if(i.isFake&&i.w!==void 0&&i.h!==void 0){s.push({w:i.w,h:i.h,x:void 0,y:void 0,dag:i});continue}if(i.nodes.length===1){const f=2*o[0].data.radius;s.push({w:f+t/2,h:f+t/2,x:void 0,y:void 0,dag:i});continue}const{minX:a,maxX:u,minY:d,maxY:c}=o.reduce((f,{x:p,y:_,data:y})=>{const x=y.radius||0;return f.minX=Math.min(f.minX,p-x),f.maxX=Math.max(f.maxX,p+x),f.minY=Math.min(f.minY,_-x),f.maxY=Math.max(f.maxY,_+x),f},{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0}),g=(u+a)/2;o.forEach(f=>{f.x-=g}),s.push({w:Math.abs(u-a)+t/2,h:Math.abs(c-d)+t/2,minX:a,x:void 0,y:void 0,dag:i})}if(n!=="singleline")tV(s);else{let r=0;for(let i=0;i<s.length;i++){const o=s[i];o.x=r,o.y=0,r+=o.w}}return s}function iV(e,t={}){const{componentsSeparation:n}=sV(t);t.direction===void 0&&(t.direction="down");const s=rV(e,{componentsSeparation:n,packing:t.packing});for(let r=0;r<s.length;r++){const{x:i=0,y:o=0,dag:a}=s[r];for(const u of a.nodes)u.x+=i,u.y+=o,nV[t.direction](u)}}var Cx={id:"__SENTINEL__",layer:-1,sink:!1,fixed:!1,siblingIndex:-1,parentIds:[],children:[],radius:0,ref:null},Ku=e=>e.data===Cx||!1,q_=e=>!Ku(e),oV=[],aV=(e,t)=>({id:e,layer:t,data:Cx,children:oV,ref:void 0,x:0,y:0}),lV=(e,t)=>({id:e,layer:-1,data:t,children:[],x:0,y:0}),US=class{constructor(e,t,n){this.data=e,this.prev=t,this.next=n}toString(){return this.data}},KC=e=>e.reduce((t,n)=>(t[n]=!0,t),{});function uV(e,t){const n=[e],s=KC(n),r=[e];for(;n.length;){const i=n.shift();for(const o of t.get(i))s[o]||(s[o]=!0,r.push(o),n.push(o))}return r}function Lx(e){return e.reduce((t,{source:n,target:s})=>(t.set(n,t.get(n)||[]),t.set(s,t.get(s)||[]),t.get(n).push(s),t.get(s).push(n),t),new Map)}function dV(e){return e.reduce((t,{source:n,target:s})=>(t[n]=t[n]||[],t[n].push(s),t),{})}function hV(e,t,n){const s=n||Lx(t||[]);return e.filter(({id:r})=>!s.has(r))}function cV(e,t){const n=KC(t);return e.filter(s=>!(s in n))}function wr(e,t){e.forEach((n,s)=>{n.forEach((r,i,o)=>{t(r,i,o,s)})})}var GS=e=>{let t=Math.floor(e.length/2);return(e=[...e].sort((n,s)=>n-s)).length%2!=0?e[t]:(e[t-1]+e[t])/2};function gV(e,t,n){const s=Lx(t);let r=Array.from(s.keys());const i=[];for(;r.length;){const o=uV(r[0],s);i.push(o),r=cV(r,o)}return n.skipSingletons?i:i.concat(hV(e,t,s).map(({id:o})=>[o]))}var fV=e=>e.reduce((t,{radius:n})=>Math.max(t,2*n),0);function pV(e,t){return{nodes:e.map(n=>({...n,data:n})),isFake:!0,...t}}function mV(e,t,n){const s=Lx(t||[]),r=e.filter(({id:p})=>!s.has(p)).sort((p,_)=>_.radius-p.radius),i=Math.sqrt(r.length);let o=Math.floor(i),a=Math.ceil(i);o*a<r.length&&(o<a?o++:a++);const u=Math.max(1,fV(r)),d=Math.max(n.nodesGridSeparation||0,1),c=u*a+d*(a-1),g=u*o+d*Math.max(o-1,0),f=pV(r,{w:c,h:g});return f.nodes.forEach((p,_)=>{const y=_%a,x=Math.floor(_/a);p.x=c*y/a,p.y=g*x/o}),f}function VS(e,t,n){const s=t.reduce((o,a)=>(o.set(a.source,o.get(a.source)||[]),o.get(a.source).push(a),o),new Map),{result:r}=e.reduce(function o(a,u){const{visited:d,stack:c,result:g}=a;if(d.has(u.id))return a;c.add(u.id),d.add(u.id);const f=s.get(u.id)||[];for(const p of f)c.has(p.target)?g.push(p):o(a,n.get(p.target));return c.delete(u.id),a},{visited:new Set,stack:new Set,result:[]}),i=r.reduce((o,{source:a,target:u})=>(o.set(a,o.get(a)||new Set),o.get(a).add(u),o),new Map);return t.map(o=>{const{source:a,target:u,id:d}=o;return i.has(a)&&i.get(a).has(u)?{id:d,source:u,target:a}:o})}function _V(e){if(!e||!e.length)throw Error("Cannot stratify empty data");for(const r of e){if(!r)throw Error('Node data is "null"');if(r.id==null)throw Error('Node id contains a "null" value')}const t=e.map(r=>lV(r.id,r)),n=t.reduce((r,i)=>{if(r[i.id])throw Error(`The connected component contains id duplicates: ${i.id}`);return r[i.id]=i,r},{}),s=[];for(let r=0;r<t.length;r++){const i=t[r];for(let o=0;o<i.data.parentIds.length;o++){const a=i.data.parentIds[o],u=n[a];if(!u)throw Error(`The node ${i.id} has a missing parent id ${a}`);u.children.push(i)}i.data.parentIds.length||s.push(i)}return{isFake:!1,nodes:yV(s)}}function yV(e){const t={},n=[];for(;e.length;){const s=e.pop();t[s.id]||(n.push(s),t[s.id]=!0,e.push(...s.children))}return n}var xV=class{constructor(){this.byId={},this.byIndex={},this.length=0}append(e,t){let n;return this.head?(n=new US(e,this.tail),this.tail=this.tail.next=n):(n=new US(e),this.tail=this.head=n),this.byId[t]=n,this.byIndex[this.length++]=n,n}find(e){let t=this.head;do{if(t.data===e)return t;t=t.next}while(t)}forEach(e){let t=this.head,n=0;do e(t,n),n++;while(t=t.next)}},Tr=-1,us=1e-5,Sm=[],vV=class{constructor(t,n,s){this.edges=[],this.nodeMap={},this.nodeIndexTopDown={},this.nodeToLayer={},this.longEdges={},this.virt={},this.height={},this.breadth={},this.first=[],this.totalW={},this.mDist={},this.X={},this.block={},this.nodeList=new xV,this.nodeDistance=n,this.layerDistance=s,this.layers=t;const{breadth:r,virt:i,height:o,nodeToLayer:a,nodeIndexTopDown:u,nodeMap:d,longEdges:c,edges:g}=this;let f=0;wr(this.layers,(x,E,b,S)=>{if(u[x.id]=f++,d[x.id]=x,a[x.id]=S,this.nodeList.append(x,x.id),x.children.forEach(C=>{const k=Ku(C)||Ku(x);g.push({source:x.id,target:C.id,virtual:k,id:g.length})}),c[x.id])return;const A=[x.id];if(c[x.id]=A,!q_(x))for(let C=0;C<x.children.length;C++){const k=x.children[C];if(q_(k))continue;let M=k;for(;Ku(M);)A.push(M.id),c[M.id]=A,M=M.children[0]}});const p=this.adjacencyList=dV(g);this.N=t.reduce((x,E)=>x+E.length,0),this.Y=new Float32Array(t.length),this.first=t.map(x=>x[0]),t.forEach((x,E)=>o[E]=0),wr(this.layers,(x,E,b,S)=>{const A=p[x.id]?p[x.id].length:0;i[x.id]=Ku(x)&&A===1,this.nodeToLayer[x.id]=S,i[x.id]?r[x.id]=0:(r[x.id]=2*x.data.radius,o[S]=Math.max(o[S]||0,2*x.data.radius))});const _={},y={};g.forEach(x=>{const E=x.source,b=x.target;_[b]=_[b]||[],_[b].push(E),y[E]=y[E]||[],y[E].push(b)}),Object.values(_).forEach(x=>{x.sort((E,b)=>this.nodeIndexTopDown[E]-this.nodeIndexTopDown[b])}),Object.values(y).forEach(x=>{x.sort((E,b)=>this.nodeIndexTopDown[E]-this.nodeIndexTopDown[b])}),this.neighbours={prev:_,next:y}}computeMinNodeDistances(){const{layers:t,totalW:n}=this;wr(t,s=>{n[s.id]=0}),wr(t,s=>n[s.data.id]=0),this.layers.forEach(s=>{n[s[0].id]=0,s.slice(1).forEach((r,i)=>{const o=s[i],a=r.id;n[a]=n[o.id]+o.data.radius+r.data.radius+this.nodeDistance})})}decrossVirtualEdges(){this.layers.forEach(t=>{let n=-1;t.forEach(s=>{if(!this.virt[s.id])return;const r=this.neighbours.next[s.id][0];if(this.virt[r])if(n!==-1&&n>this.nodeIndexTopDown[r]){const i=this.longEdges[s.id];let o=0;for(o=0;o<i.length&&i[o]!==r;o++);const a=i.slice(o);a.forEach(d=>this.longEdges[d]=a);const u=i.slice(0,o);u.forEach(d=>this.longEdges[d]=u)}else n=this.nodeIndexTopDown[r]})})}placeLongEdges(){const{X:t,layers:n}=this;wr(n,s=>t[s.id]=0);for(let s=1;s>=-1;s-=2){const r={};let i=0;const o={};wr(n,c=>o[c.id]=0),o[Cx.id]=0;const a=s;n.forEach(c=>{let g=a===1?c[0]:c[c.length-1];o[g.id]||(this.longEdges[g.id].forEach(_=>{o[_]=i}),i++);let f=a===1?0:c.length-1,p=f+a;for(;p>=0&&p<c.length;)g=c[p],o[g.id]||this.longEdges[g.id].forEach(_=>{o[_]=o[c[f].id]}),f=p,p+=a});const u={};n.forEach(c=>{for(let g=a===1?0:c.length-1;a===1?g<c.length:g>=0;g+=a){const f=c[g],p=o[f.id];u[p]=u[p]||[],u[p].push(f.id)}});const d={};this.nodeList.forEach(c=>d[c.data.id]=0);for(let c=0;c<i;c++){const g={done:!1,dist:0},f=u[c];for(let p=0;p<f.length;p++){const _=f[p];this.sortLongEdges(_,s,d,g,o,r)}if(!g.done){const p=this.layers[this.nodeToLayer[u[c][0]]],_=[];p.forEach(y=>{for(const x of this.neighbours.prev[y.id]||Sm){const E=Math.abs(d[x]-d[y.id]);_.push(E)}}),_.length!==0&&(g.dist=GS(_))}for(let p=0;p<f.length;p++)d[f[p]]-=s*g.dist}wr(n,c=>t[c.id]+=d[c.id]/2)}}sortLongEdges(t,n,s,r,i,o){if(o[t])return!1;let a=!1,u=0;const{nodeToLayer:d,totalW:c}=this,g=this.longEdges[t];g.forEach(f=>o[f]=!0),g.forEach(f=>{const p=this.nodeList.byIndex[this.nodeIndexTopDown[f]-n];if(!p)return;const _=p.data.id,y=f,x=d[_]===d[y],E=i[_]===i[y];!x||!E||(this.sortLongEdges(_,n,s,r,i,o),(!a||n*(u-s[_])<n*(c[y]-c[_]))&&(a=!0,u=s[_]+c[y]-c[_]))}),g.forEach(f=>{s[f]=u;const p=this.nodeList.byId[f],_=n===1?p.next:p.prev;if(!_)return;const y=_.data.id,x=f,E=d[y]===d[x],b=i[y]!==i[x],S=n*(c[y]-c[x]-s[y]+s[x]);E&&b&&(!r.done||S>r.dist)&&(r.dist=S,r.done=!0)})}placeNonVirtualNodes(){const t={};wr(this.layers,d=>t[d.id]=-1);const{X:n,totalW:s,virt:r,nodeIndexTopDown:i,mDist:o,nodeList:a}=this,u={};wr(this.layers,(d,c,g,f)=>{if(!r[d.id])return void(u[d.id]=!1);let p=this.nodeList.byId[d.id].next;for(;p&&this.nodeToLayer[p.data.id]===f&&!r[p.data.id];)p=p.next;u[d.id]=this.nodeToLayer[p.data.id]===f&&n[p.data.id]-n[d.id]<s[p.data.id]-s[d.id]+us}),wr(this.layers,({id:d})=>{u[d]&&t[d]===-1&&this.longEdges[d].forEach(c=>{c!==d&&(t[c]=i[c]<i[d]?1:0)})}),wr(this.layers,({id:d})=>o[d]=s[d]);for(let d=0;d<2;d++)for(let c=d?this.layers.length-1:0;c>=0&&c<this.layers.length;d?c--:c++){let g=Tr;const f=this.layers[c];if(f.forEach(({id:p},_,y)=>{if(r[p]){if(g===Tr){this.placeSequence(Tr,p,y[0].id,a.byId[p].prev.data.id,d);for(let x=0;x<_;x++){const E=y[x].id;o[E]=o[p]-n[p]+n[E]}}else if(t[g]!==1-d){u[g]||this.placeSequence(g,p,a.byId[g].next.data.id,a.byId[p].prev.data.id,d);const x=d===1?this.neighbours.prev:this.neighbours.next,E=x[g][0],b=x[p][0];if(r[E]&&r[b])for(let S=i[E]+1;S<i[b];S++)t[a.byIndex[S].data.id]=d}g=p}}),g===Tr)this.placeSequence(Tr,Tr,f[0].id,f[f.length-1].id,d),f.forEach(({id:p})=>o[p]=n[p]);else{this.placeSequence(g,Tr,a.byId[g].next.data.id,f[f.length-1].id,d);for(let p=f.length-1;p>=0;p--){const _=f[p].id;if(_===g)break;o[_]=o[g]-n[g]+n[_]}}}}placeSequence(t,n,s,r,i,o=0){const a=this.nodeIndexTopDown[s],u=this.nodeIndexTopDown[r],{X:d,nodeIndexTopDown:c,mDist:g}=this;if(a===u)d[s]=this.placeNode(s,t,n,d[s],i);else if(a<u){const f=Math.floor((c[s]+c[r])/2),p=this.nodeList.byIndex[f],_=p.next.data.id,y=g[_]-g[p.data.id];this.placeSequence(t,n,s,p.data.id,i,o+1),this.placeSequence(t,n,_,r,i,o+1),this.combineSequences(t,n,s,r,_,p.data.id,i,y)}}calculateBends(t,n,s,r,i,o,a,u){let d=0;const c=[],{X:g,mDist:f,neighbours:p}=this,_=this.nodeIndexTopDown[s],y=this.nodeIndexTopDown[r];for(let x=this.nodeList.byId[o],E=this.nodeIndexTopDown[x.data.id];E>=_&&E<=y&&x;x=t===-1?x.prev:x.next,E=x&&this.nodeIndexTopDown[x.data.id]){const b=x.data.id,S=(n===0?p.prev[b]:p.next[b])||Sm;let A=0;for(let k=0;k<S.length;k++){const M=S[k];if(t*(g[M]-g[b])<us)A++;else{A--;const R=g[M]+f[o]-f[b];t*(g[o]-R)>-1e-5?d++:(u===Tr||t*(R-g[u]+f[u]-f[o])<us)&&t*(R-g[i])<a-us&&c.push({value:2,key:R})}}const C=g[b]+f[o]-f[b];t*(g[o]-C)>-1e-5?d+=A:(u===Tr||t*(C-g[u]+f[u]-f[o])<us)&&t*(C-g[i])<a-us&&c.push({value:A,key:C})}return u!==Tr&&c.push({value:this.edges.length,key:g[u]-f[u]+f[o]}),c.sort(({key:x},{key:E})=>x-E),{res:d,bends:c.reduce((x,E,b)=>{if(b<c.length-1){const S=c[b+1];Math.abs(E.key-S.key)>us?E.value>0&&x.push(E):E.value+=S.value}else E.value>0&&x.push(E);return x},[])}}combineSequences(t,n,s,r,i,o,a,u){const{X:d,mDist:c,nodeIndexTopDown:g}=this;let{res:f,bends:p}=this.calculateBends(-1,a,s,r,i,o,u,t),{res:_,bends:y}=this.calculateBends(1,a,s,r,o,i,u,n);for(p.length>0&&p.reverse();d[i]-d[o]<u-us;){let b=0,S=0;if(f<_){const A=p.length;if(A>0){const C=p.pop();b=C.value,d[o]=C.key}(A===0||d[i]-d[o]>u+us)&&(d[o]=d[i]-u)}else if(f>_){const A=y.length;if(A>0){const C=y.pop();S=C.value,d[i]=C.key}(A===0||d[i]-d[o]>u+us)&&(d[i]=d[o]+u)}else{let A=(u-d[i]+d[o])/2;const C=p.length===0?A+1:d[o]-p[p.length-1].key,k=y.length===0?A+1:y[y.length-1].key-d[i];C<A+us&&C<k+us&&(b=p.pop().value),k<A+us&&k<C+us&&(S=y.pop().value),A=Math.min(A,C,k),d[o]-=A,d[i]+=A}f+=b,_+=S}let x,E=this.nodeList.byId[o].prev;for(;E&&g[x=E.data.id]>=g[s]&&d[o]-d[x]<c[o]-c[x];)d[x]=d[o]-c[o]+c[x],E=E.prev;for(E=this.nodeList.byId[i].next;E&&g[x=E.data.id]<=g[r]&&d[i]-d[x]>c[i]-c[x];)d[x]=d[i]-c[i]+c[x],E=E.next}placeNode(t,n,s,r,i){const{X:o,neighbours:a,mDist:u}=this,d=((i===0?a.prev:a.next)[t]||Sm).map(c=>o[c]);return d.length===0?o[t]:(r=GS(d),n!==Tr&&(r=Math.max(r,o[n]+u[t]-u[n])),s!==Tr&&(r=Math.min(r,o[s]+u[t]-u[s])),r)}moveLongEdge(t,n,s){const{X:r,virt:i,totalW:o,nodeList:a}=this,{id:u}=t.data;if(s[u]||!i[u])return;const d=this.longEdges[u];if(!d)return;d.forEach(x=>s[x]=!0);const c=d[0],g=d[d.length-1],f=[];n<0?f.push(r[c]<r[g]?r[c]:r[g],r[c]<r[g]?r[g]:r[c]):n>0?f.push(r[c]<r[g]?r[g]:r[c],r[c]<r[g]?r[c]:r[g]):f.push(r[c],r[g]);const p=f[0];let _,y=!1;for(;!y&&f.length!==0;)_=f.pop(),y=!0,d.forEach(x=>{const E=this.layers[this.nodeToLayer[x]];if(x!==E[0].id){const b=a.byId[x].prev.data;_-r[b.data.id]<o[x]-o[b.data.id]&&this.moveLongEdge(b,-1,s),y=y&&_-r[b.data.id]>=o[x]-o[b.data.id]-us}if(x!==E[E.length-1].id){const b=a.byId[x].next.data;_-r[b.data.id]>o[x]-o[b.data.id]&&this.moveLongEdge(b,1,s),y=y&&_-r[b.data.id]<=o[x]-o[b.data.id]+us}});y||(_=p,d.forEach(x=>{const E=this.layers[this.nodeToLayer[x]];if(x!==E[0].id){const b=a.byId[x].prev.data;_=Math.max(_,r[b.data.id]+o[x]-o[b.data.id])}if(x!==E[E.length-1].id){const b=a.byId[x].next.data;_=Math.min(_,r[b.data.id]+o[x]-o[b.data.id])}})),d.forEach(x=>r[x]=_)}moveLongEdges(){const t={};this.layers.forEach(n=>{const s=Math.floor(n.length/2);for(let r=s;r<n.length;r++)this.moveLongEdge(n[r],0,t);for(let r=s-1;r>=0;r--)this.moveLongEdge(n[r],0,t)})}computeY(){const{Y:t,layers:n,height:s}=this;t[0]=0,n.slice(1).forEach((r,i)=>{t[i+1]=t[i]+(s[i]+s[i+1])/2+this.layerDistance})}straightenLongEdge(t,n){const{nodeList:s,longEdges:r,neighbours:i,X:o,Y:a,nodeToLayer:u,totalW:d}=this,c=r[t.id];if(n[t.id]||!i.prev[t.id]||i.prev[t.id].length!==1||!i.next[t.id]||i.next[t.id].length!==1||!(c&&c.length<2))return;n[t.id]=!0;const g=i.prev[t.id][0],f=i.next[t.id][0];if(u[f]===u[g])return;const p=o[g]+(o[f]-o[g])*(a[u[t.id]]-a[u[g]])/(a[u[f]]-a[u[g]]);if(t!==this.first[u[t.id]]){const y=s.byId[t.id].prev.data;if(p-o[y.id]<d[t.id]-d[y.id]-us&&this.straightenLongEdge(y,n),p-o[y.id]<d[t.id]-d[y.id]-us)return}const _=this.layers[u[t.id]];if(t!==_[_.length-1]){const y=s.byId[t.id].next.data;if(o[y.id]-p<d[y.id]-d[t.id]-us&&this.straightenLongEdge(y,n),o[y.id]-p<d[y.id]-d[t.id]-us)return}o[t.id]=p}straightenEdges(){const t={};this.layers.forEach(n=>{const s=Math.floor(n.length/2);for(let r=s;r<n.length;r++)this.straightenLongEdge(n[r],t);for(let r=s-1;r>=0;r--)this.straightenLongEdge(n[r],t)})}run(){this.computeMinNodeDistances(),this.decrossVirtualEdges(),this.placeLongEdges(),this.placeNonVirtualNodes(),this.moveLongEdges(),this.computeY(),this.straightenEdges(),wr(this.layers,(t,n,s,r)=>{t.x=this.X[t.id],t.y=this.Y[r]})}},bV=(e,t=20,n=50)=>new vV(e,t,n).run();function EV(e){if(e.sort((s,r)=>s-r),e.length===0)return 0;const t=Math.floor(e.length/2),n=Math.floor(e.length/2);return(e[t]+e[n])/2}function $_(e,t,n){const s={};return t.forEach((r,i)=>s[r.id]=i),e.map(r=>(n[r.id]||[]).map(i=>s[i]).sort()).reduce((r,i,o,a)=>{const u=i.length?i[i.length-1]:-1;for(let d=o+1;d<a.length;d++)r+=a[d].filter(c=>c<u).length;return r},0)}function SV(e,t,n,s,r){const i={};for(let o=0;o<e.length;o++)i[e[o].id]=EV((t[e[o].id]||[]).map(a=>n[a]))||0;r?e.sort((o,a)=>{const u=i[o.id]-i[a.id],d=s[o.id]===s[a.id],c=o.data.siblingIndex,g=a.data.siblingIndex;return d&&c>-1&&g>-1?c-g:u===0?n[a.id]-n[o.id]:u}):e.sort((o,a)=>{const u=i[o.id]-i[a.id];return u===0?n[a.id]-n[o.id]:u})}function jS({layers:e,topDown:t,topDownAdj:n,bottomUpAdj:s,idToIndex:r,crossings:i,sortSiblings:o}){const a=t?n:s;for(let u=t?0:e.length-1;t?u<e.length:u>=0;t?u++:u--){SV(e[u],a[u]||{},r,s[u],o);const d=u>0?$_(e[u-1],e[u],n[u-1]):0,c=u<e.length-1?$_(e[u],e[u+1],n[u]):0;c+d<(i[u]||0)+(i[u-1]||0)?(i[u]=c,u>0&&(i[u-1]=d),e[u].forEach((g,f)=>r[g.id]=f)):e[u].sort((g,f)=>r[g.id]-r[f.id])}}var AV=(e,t,n)=>{if(!n&&!t)return;const s={},r=e.map(()=>({})),i=e.map(()=>({}));e.forEach((c,g)=>{c.forEach((f,p)=>{s[f.id]=n?f.data.siblingIndex:p,f.children.forEach(_=>{const y=_.layer;y>g?(r[g][f.id]=r[g][f.id]||[],r[g][f.id].push(_.id),i[y][_.id]=i[y][_.id]||[],i[y][_.id].push(f.id)):(r[y][_.id]=r[y][_.id]||[],r[y][_.id].push(f.id),i[g][f.id]=i[g][f.id]||[],i[g][f.id].push(_.id))})})}),s[-1]=-1,n&&e.forEach(c=>c.sort((g,f)=>s[g.id]-s[f.id]));const o=e.slice(1).map((c,g)=>$_(e[g],c,r[g])),a=[[50,100],[100,10],[1e3,1],[5e3,0]],u=Math.max(...e.map(c=>c.length)),d=(a.find(([c])=>u<c)||a[a.length-1])[1];for(let c=0;c<d;c++)jS({layers:e,topDown:!0,topDownAdj:r,bottomUpAdj:i,idToIndex:s,crossings:o,sortSiblings:n}),jS({layers:e,topDown:!1,topDownAdj:r,bottomUpAdj:i,idToIndex:s,crossings:o,sortSiblings:n})};function wV(e){const t={},n={},s={};e.nodes.forEach(o=>{s[o.id]=o});const r=o=>{if(t[o.id])return n[o.id];t[o.id]=!0;let a=1/0;for(const u of o.children)a=Math.min(a,r(s[u.id])-1);return a===1/0&&(a=0),n[o.id]=a,a};e.nodes.forEach(o=>{o.data.parentIds.length===0&&r(o)});let i=1/0;e.nodes.forEach(o=>{i=Math.min(i,n[o.id])}),e.nodes.forEach(o=>{n[o.id]-=i,o.layer=n[o.id]})}function TV(e){const t=e.nodes.reduce((n,s)=>s.data.fixed&&(n===null||n.layer>s.layer)?s:n,null);return t&&e.nodes.forEach(n=>n.ref=t.id),e}function CV(e){if(e.nodes.every(t=>t.layer)){const t=e.nodes.reduce((n,s)=>Math.min(n,s.layer),1/0);e.nodes.forEach(n=>n.layer-=t)}}function LV(e){if(e.nodes.some(t=>t.data.sink)){const t=e.nodes.reduce((n,s)=>Math.max(n,s.layer),-1/0);e.nodes.forEach(n=>{n.data.sink&&(n.layer=t+1)})}}function NV(e){const t=[];e.nodes.forEach(s=>t[s.layer]=0);const n=Array.from(t).reduce((s,r,i)=>{if(i===0)return s.push(0),s;const o=s[i-1];return r!==void 0?(s.push(o),s):(s.push(o-1),s)},[]);e.nodes.forEach(s=>s.layer+=n[s.layer])}function IV(e){return wV(e),LV(e),CV(e),NV(e),e.nodes.forEach(t=>{const{below:n,above:s}=t.children.reduce((r,i)=>(t.layer>i.layer?r.above.push(i):r.below.push(i),r),{above:[],below:[]});s.forEach(r=>r.children.push(t)),t.children=n}),TV(e)}var kV=(e,{nodeDistance:t,layerDistance:n,nodeLookup:s,customSort:r,customLayering:i,sortSiblings:o,shouldDecross:a=!0})=>{IV(e),i&&i(e);const u=MV(e);return e.nodes.length>1?(AV(u,a,o),r&&u.forEach(d=>{d.sort((c,g)=>r(s.get(c.id),s.get(g.id)))}),bV(u,t,n)):(e.nodes[0].x=0,e.nodes[0].y=0),PV(e),e};function MV(e){return e.nodes.reduce((t,n)=>(t[n.layer]=t[n.layer]||[],t[n.layer].push(n),n.children=n.children.map(s=>{if(s.layer===n.layer+1)return s;let r=s;for(let i=s.layer-1;i>n.layer;i--){const o=aV(`${n.id}->${s.id}@${i}`,i);o.children=[r],t[i]=t[i]||[],t[i].push(o),r=o}return r}),t),[])}function PV(e){e.nodes.forEach(t=>{t.data&&(t.children=t.children.filter(q_))})}var Am=({id:e,layer:t,sink:n,siblingIndex:s,radius:r,layoutable:i})=>({id:e,layer:t!==void 0?t:void 0,sink:n,siblingIndex:s||0,radius:r||0,fixed:i===!1,parentIds:[],children:[],ref:null});function RV(e){const t={x:0,y:0};let n=0;for(let s=0;s<e.length;s++){const r=e[s];for(let i=0;i<r.nodes.length;i++){const o=r.nodes[i];t.x+=o.x||0,t.y+=o.y||0,n++}}return t.x/=n,t.y/=n,t}function FV(e){const t={x:0,y:0};let n=0;for(const[s,{x:r,y:i}]of e)t.x+=r||0,t.y+=i||0,n++;return t.x/=n,t.y/=n,t}function DV(e,t,n){const s=RV(n),r=e.x-s.x,i=e.y-s.y;for(let o=0;o<n.length;o++){const a=n[o];for(let u=0;u<a.nodes.length;u++){const d=a.nodes[u],c=t.get(d.id);!c||d.data&&d.data.fixed||(c.x=d.x+r,c.y=d.y+i)}}}var OV=e=>{var t,n,s;const r=[];if(e.nodes.forEach(p=>{if(p&&!isNaN(p.layer)&&p.layer!==null){if(p.layer<0)throw new Error("Layer must be greater than or equal to 0");r.push([p.id,p.layer])}}),r.length===0)return e.edges;r.sort((p,_)=>p[1]-_[1]);const i=new Set;for(let p=0;p<r.length;p++)r[p][1]!==0&&i.add(r[p][0]);const o=new Map;for(const p of e.nodes)o.set(p.id,[]);for(const p of e.edges)(t=o.get(p.source))==null||t.push(p.target),(n=o.get(p.target))==null||n.push(p.source);if(!r.map(([p,_])=>_).some(p=>p===0)){r.sort((x,E)=>x[1]-E[1]);const p=new Set,_=[r[0]];let y;for(;_.length>0;){const[x,E]=_.shift();if(E===0){y=x;break}p.add(x);const b=o.get(x)||[];for(const S of b)i.has(S)||p.has(S)||_.push([S,E-1])}if(y)r.push([y,0]);else{const x=r[0][1];for(let E=0;E<r.length;E++)r[E][1]-=x}}const a=r.filter(([p,_])=>_===0).map(([p])=>p),u=a.slice(),d=new Map,c=new Map,g=new Map;for(const p of a)d.set(p,0),c.set(p,[]);for(;u.length>0;){const p=u.shift(),_=d.get(p),y=o.get(p)||[];for(const x of y){const E=d.get(x);E===void 0?(d.set(x,_+1),c.set(x,[p]),u.push(x)):E===_+1&&((s=c.get(x))==null||s.push(p))}}for(const[p,_]of c.entries())for(const y of _)g.set(y,(g.get(y)||[]).concat(p));for(const[p,_]of r)if(d.get(p)!==_)if(_===0){const y=c.get(p)||[];c.set(p,[]),y.forEach(b=>{g.set(b,(g.get(b)||[]).filter(S=>S!==p))});const x=e.nodes.filter(b=>d.get(b.id)===0);d.clear(),x.forEach(b=>d.set(b.id,0));const E=x.map(b=>b.id);for(;E.length>0;){const b=E.shift(),S=d.get(b),A=g.get(b)||[];for(const C of A)d.get(C)===void 0&&(d.set(C,S+1),E.push(C))}}else{const y=e.nodes.find(S=>d.get(S.id)===_-1&&S.id!==p);if(!y)continue;const x=c.get(p)||[];c.set(p,[y.id]),x.forEach(S=>{g.set(S,(g.get(S)||[]).filter(A=>A!==p))}),g.set(y.id,(g.get(y.id)||[]).concat(p));const E=e.nodes.filter(S=>d.get(S.id)===0);d.clear(),E.forEach(S=>d.set(S.id,0));const b=E.map(S=>S.id);for(;b.length>0;){const S=b.shift(),A=d.get(S),C=g.get(S)||[];for(const k of C)d.get(k)===void 0&&(d.set(k,A+1),b.push(k))}}const f=[];for(const[p,_]of c.entries())if(_.length>0)for(const y of _)f.push({id:`${y}-${p}`,source:y,target:p});return f},zV=(e,t={})=>{const n=new Map,s=new Map;for(const d of e.nodes)n.set(d.id,d);const r=e.nodes.slice(),i=(e.edges||[]).filter(({source:d,target:c})=>d!==c),o=VS(r,i,n).filter(d=>{const c=s.get(d.source);if(!c){const g=new Map;return g.set(d.target,!0),s.set(d.source,g),!0}return!c.get(d.target)&&(c.set(d.target,!0),!0)}),a=gV(r,o,{skipSingletons:t.packing==="grid"}),u=a.map(d=>{const c=d.map(f=>n.get(f)),g=o.filter(f=>d.includes(f.source));return VS(c,OV({nodes:c,edges:g}),n)}).flat().reduce((d,c)=>(d.has(c.source)||d.set(c.source,Am(n.get(c.source))),d.has(c.target)||d.set(c.target,Am(n.get(c.target))),d.get(c.target).children.push(c.source),d.get(c.target).parentIds.push(c.source),d),new Map);return{components:a.map(d=>d.map(c=>u.get(c)||Am(n.get(c)))),lookup:n}};function BV(e,t,n){const s=[];for(const r of e){const i=_V(r);s.push(i),kV(i,{nodeDistance:n.nodesSeparation,layerDistance:n.layerSeparation,shouldDecross:n.shouldDecross,customSort:n.customSort,customLayering:n.customLayering,sortSiblings:!!n.sortSiblings,nodeLookup:t})}return s}var HS=(e,t={})=>{if(!e||!e.nodes)return e;const n={direction:"down",packing:"fit",nodesGridSeparation:1,...t,shouldDecross:t.shouldDecross!==!1},{components:s,lookup:r}=zV(e,n),i=FV(r),o=BV(s,r,n);if(n.packing==="grid"){const a=mV(e.nodes,e.edges,n);o.push(a)}return iV(o,n),DV(i,r,o),e},wm={direction:"TB",nodeDistance:5,levelDistance:50,componentDistance:50,gapWidth:1,arrangeComponents:"fit",gridDistance:50,layer:"layer",siblingIndex:""},W_={name:"hierarchical",imports:{sequential:HS},configure:function(e,{graph:t,data:n}){function s(b,S,A=b.getNodes()){return S?S instanceof Ki?S:b.getNodes(S):A}const r={...wm,...e,nodeList:e.nodes};r.direction=e.direction||wm.direction,r.layerSeparation=r.levelDistance,r.nodesSeparation=r.nodeDistance,r.componentsSeparation=r.componentDistance,r.gapDistance=r.gapWidth,r.packing=r.arrangeComponents;const i={...r},o=r.edges,a=r.nodeList;if(["TB","BT","LR","RL"].indexOf(r.direction)===-1)throw new Error('direction should be one of the "TB", "BT", "LR", "RL"');if(["fit","grid","singleLine"].indexOf(r.packing)===-1)throw new Error('arrangeComponents should be one of the "fit", "grid", "singleLine"');r.nodesGridSeparation=e.gridDistance||wm.gridDistance;const u=a.getId(),d=a.getAttribute("layoutable").reduce((b,S,A)=>(b[u[A]]=S,b),{}),c=a.getAttributes(["x","y"]).reduce((b,S,A)=>(b[u[A]]=S,b),{}),g=a.getAttribute("radius");if(typeof i.layer!="string")throw new Error("'layer' should be the valid data field name");if(i.siblingIndex===void 0&&(i.siblingIndex=""),typeof i.siblingIndex!="string")throw new Error("'siblingIndex' should be the valid data field name");const f=s(t,r.roots,t.nodeList()),p=n.getProperty(r.nodeList,i.layer),_=i.siblingIndex.length?n.getProperty(r.nodeList,i.siblingIndex):[],y=f.map(b=>{let S=-1;return r.nodeList.forEach((A,C)=>{A===b&&(S=C)}),S});for(const b of y)p[b]=0;const x=s(t,r.sinks,t.nodeList()).toArray().reduce((b,S)=>(b[S.getId()]=!0,b),{}),E=u.map(b=>x[b]);return{nodes:u,edges:o.map(b=>({id:b.getId(),source:b.getSource().getId(),target:b.getTarget().getId()})),options:jg(r),layoutable:d,radiuses:g,siblingIndexes:_,layers:p,sinks:E,coords:c}},context:Vt,update:function({nodes:e,edges:t,options:n,layoutable:s,radiuses:r,layers:i,siblingIndexes:o,sinks:a,coords:u}){const d=t.filter(({source:f,target:p})=>f in s&&p in s),c={nodes:e.map((f,p)=>({id:f,radius:r[p],layer:i[p],siblingIndex:o[p],sink:a[p],layoutable:s[f],x:u[f].x,y:u[f].y})),edges:d},{nodes:g}=HS(c,{packing:{fit:"fit",singleLine:"singleline",grid:"grid"}[n.arrangeComponents],direction:{TB:"down",BT:"up",RL:"left",LR:"right"}[n.direction],layerSeparation:n.layerSeparation,nodesSeparation:n.nodesSeparation,sortSiblings:o.length>0,componentsSeparation:n.componentsSeparation,nodesGridSeparation:n.nodesGridSeparation,evenDistribution:n.evenDistribution});return{positions:g}},isRunning:function(){return!1},onSync:function({positions:e},{graph:t}){return{indexes:e.map(({id:n})=>(t.getNode(n)||{_index:-1})._index),x:e.map(({x:n})=>n),y:e.map(({y:n})=>n)}}},UV=e=>(e.modules.layouts.register(W_),(t={})=>(t.useWebWorker=!1,e.modules.layouts.start(W_.name,t))),X_=(e,t)=>e-t,qS={name:"radial",imports:{minHeap:Yg,bellmanFord:Ny,dijkstra:Iy,johnson:h_,distance:ss,circleCircleIntersection:Py,circleSortCompare:Ry,weightedStress:M1,distanceStress:P1,constrainedStress:u_,stressMinimizationStep:d_,removeRadialOverlap:g_,linear:wg,calculateRadii:Rb},configure(e,{graph:t}){let n=e.nodes;const s=n.size;function r(k,M){return k!=null&&isFinite(k)?k:M}if(e.centralNode===void 0)throw new Error('radial layout: missing parameter "centralNode"');const i=t.getNode(e.centralNode);if(i===void 0)throw new Error('radial layout: parameter "centralNode" is not valid');e.radiusRatio=r(e.radiusRatio,Math.SQRT2),e.radiusDelta=r(e.radiusDelta,0),e.nodeGap=r(e.nodeGap,10),e.repulsion=s*r(e.repulsion,1);const o=i.getPosition(),a=r(e.centerX,o.x),u=r(e.centerY,o.y),d=i._index;n.includes(i)||(n=n.concat(i.toList()));let c=n._indexes;const g=n.getAttribute("layoutable");c=c.filter((k,M)=>g[M]||k===d),c.sort(X_);const f=c.length,p=GV(c,t.getConnectedComponents(n,{internalIndexes:!0}),d),_=t.degrees(c),y=new Float32Array(t.getNodeAttribute("x").getMultiple(c)),x=new Float32Array(t.getNodeAttribute("y").getMultiple(c)),E=t.getNodeAttribute("radius").getMultiple(c),b=t.getEdges()._indexes,S=t.getEdgeAttribute("source").getMultiple(b),A=t.getEdgeAttribute("target").getMultiple(b),C=t.getAdjacencyList({internalIndexes:!0,weight:1,indexes:c});return{centerIndex:d,centerIndexPos:0,cx:a,cy:u,D:null,indexes:c,components:p,normIndexes:null,radii:null,rings:null,x:y,y:x,degree:_,size:f,attributes:{size:E,adjacency:C,weights:A.map(()=>1),sources:S,targets:A},sortAttr:null,allowOverlap:!!e.allowOverlap,nodeGap:e.nodeGap,radiusRatio:e.radiusRatio,radiusDelta:e.radiusDelta,repulsion:e.repulsion,randomize:!("randomize"in e)||!!e.randomize,renderSteps:!!e.renderSteps,epsilon:r(e.epsilon,.001),maxSteps:r(e.maxIterations,100),iterationsPerRender:r(e.iterationsPerRender,20),step:-1,stress:Number.POSITIVE_INFINITY,prevStress:0,converged:!1,overlapRemoved:!1,done:!1}},context:()=>({data:null,gridPlacement(e,t,n=8){const s=e.length,r=new Float32Array(s),i=new Float32Array(s);let o=0;for(let f=0,p=e.length;f<p;f++){const _=t[e[f]];_>o&&(o=_)}const a=o*n,u=Math.ceil(Math.sqrt(s)),d=Math.ceil(s/u),c=-Math.floor((d-1)*a/2),g=-Math.floor((u-1)*a/2);for(let f=0;f<u;f++)for(let p=0;p<d;p++)r[f*d+p]=c+p*a,i[f*d+p]=g+f*a;return{x:r,y:i}},connectComponents(e,t,n,s,r,i){let o;function a(u,d){const c=new Uint32Array(u.length+1);return c.set(u),c[u.length]=d,c}for(let u=1;u<e.length;u++){const d=e[u];let c=0,g=0;d.forEach((_,y)=>{const x=r.get(_);x!=null&&x>c&&(g=y,c=x)}),o=d[g];const f=t[i.get(o)];f.weights=f.weights||[],f.nodes=a(f.nodes,n),f.weights.push(s);const p=t[i.get(n)];p.weights=p.weights||[],p.nodes=a(p.nodes,o),p.weights.push(s)}},correctSubgraphsDistances(e,t,n,s,r){const i=Array.prototype.reduce.call(e[n],(a,u,d)=>(d!==n&&u<s&&u>a&&(a=u),a),0),o=s-i-1;for(let a=1;a<t.length;a++){const u=t[a];for(let d=0,c=u.length;d<c;d++){const g=r.get(u[d]);g!=null&&(e[n][g]-=o,e[g][n]-=o)}}},initialize(e,t){e.data=t,t.step=0;const n=new Map,s=new Map;t.normIndexes=t.indexes.reduce((d,c,g)=>(d[g]=g,n.set(c,g),s.set(c,t.degree[g]),e.data&&c===t.centerIndex&&(e.data.centerIndexPos=g),d),new Uint32Array(t.indexes.length));const r=t.centerIndexPos,i=t.components[0].length;e.connectComponents(t.components,t.attributes.adjacency,t.centerIndex,i,s,n);const o=h_({sources:t.attributes.sources,targets:t.attributes.targets,weights:t.attributes.weights,indexes:t.indexes,adjacency:t.attributes.adjacency,undirected:!0});e.correctSubgraphsDistances(o,t.components,r,i,n),t.D=o;const a=o[r],u={};for(let d=0,c=t.normIndexes.length;d<c;d++)if(d!==r){const g=a[d];u[g]=u[g]||[],u[g].push(t.normIndexes[d])}t.rings=u,t.radii=Rb(r,t.rings,t.attributes.size,t.nodeGap,t.radiusRatio,t.radiusDelta)},removeOverlaps(e,t){if(!e.data)return;const n=e.data.centerIndexPos,s=t.attributes.size,{rings:r,radii:i}=t,o=t.x[n],a=t.y[n];for(const u in r){const d=r[u];for(let c=0;c<d.length;c++){const g=d[c],f=i[u];let p=t.x[g]-o,_=t.y[g]-a;p+_===0&&(p=Math.sin(g)*Math.random()*.001,_=Math.cos(g)*Math.random()*.001);const y=Math.sqrt(p*p+_*_);if(y-f<0){const x=f/y;t.x[g]=o+p*x,t.y[g]=a+_*x}}}for(const u in r){const d=r[u],c=ss(o,a,t.x[d[0]],t.y[d[0]]);g_({X:t.x,Y:t.y,sizes:s,indexes:d,center:[o,a],R:c,gap:t.nodeGap,inPlace:!0})}}}),update(e,t){e||(e=t.data);const n=e.indexes,s=e.centerIndex;let r;e.x=e.x||new Float32Array(e.size),e.y=e.y||new Float32Array(e.size),e.step===-1&&t.initialize(t,e);const i=e.repulsion,o=a=>e.radii&&e.radii[a]||1;if(e.step===0&&e.randomize&&(r=t.gridPlacement(e.indexes,e.attributes.size),e.x=r.x,e.y=r.y),!e.converged){const a=e.maxSteps,u=e.iterationsPerRender;let d=e.step;const c=Math.min(d+u,a),{D:g,x:f,y:p,size:_,centerIndexPos:y,normIndexes:x}=e;for(;d<=c&&!e.converged;){const E=wg(Math.min(d,a)/a);e.step=d++,r=d_(g,f,p,_,y,i,E,x,o),e.x=r.x,e.y=r.y,e.prevStress=e.stress,e.stress=u_(g,f,p,_,y,i,E,x),e.converged=e.converged||Math.abs(e.stress-e.prevStress)<=e.epsilon}}if(e.converged)if(e.overlapRemoved||e.allowOverlap){e.done=!0;const a=e.rings||{};e.rings=Object.keys(a).reduce((u,d)=>(u[d]=a[d].map(c=>n[c]),u),{})}else t.removeOverlaps(t,e,s),e.overlapRemoved=!0;return e},isRunning:({data:e})=>!(!e||e.converged&&(e.allowOverlap||e.done))||(e&&(e.step=-1),!1),onSync(e){if(e.renderSteps||e.done)return $S(e)},onEnd:e=>$S(e)};function $S(e){const t=e.x,n=e.y,s=e.indexes.length,r=t[e.centerIndexPos]-e.cx,i=n[e.centerIndexPos]-e.cy;for(let o=0;o<s;o++)t[o]-=r,n[o]-=i;return{indexes:e.indexes,x:t,y:n}}function GV(e,t,n){const s=e.slice().sort(X_),r=[];for(let i=0,o=t.length;i<o;i++){const a=[],u=t[i];let d=!1;for(let c=0,g=u.length;c<g;c++){const f=u[c];fw(s,f)!==-1&&(f===n&&(d=!0),a.push(f))}a.length!==0&&r[d?"unshift":"push"](a.sort(X_))}return r}var VV=e=>(e.modules.layouts.register(qS),t=>{if(t.centralNode===void 0)throw new Error('concentric layout: missing parameter "centralNode"');if(t.maxIterations=t.maxIterations&&isFinite(t.maxIterations)?Math.floor(t.maxIterations):100,t.maxIterations<1)throw new RangeError("maxIterations must be a positive integer");if(t.iterationsPerRender=t.iterationsPerRender&&isFinite(t.iterationsPerRender)?Math.floor(t.iterationsPerRender):20,t.iterationsPerRender<1)throw new RangeError("iterationsPerRender must be a positive integer");if(t.epsilon=t.epsilon&&isFinite(t.epsilon)?t.epsilon:.001,t.epsilon<=0)throw new RangeError("epsilon has to be a positive number");return e.modules.layouts.start(qS.name,t)}),WS={...W_,name:"sequential"},jV=e=>(e.modules.layouts.register(WS),(t={})=>{t.useWebWorker=!1;const n={...t,evenDistribution:!0};return e.modules.layouts.start(WS.name,n)}),HV=class extends En{constructor(e){super(e),this.stop=()=>this._ogma.modules.layouts.stop(),this.concentric=zU(e),this.radial=VV(e),this.force=QG(e),this.forceLink=JG(e),this.hierarchical=UV(e),this.sequential=jV(e),this.grid=eV(e)}},qV=class extends En{constructor(){super(...arguments),this.move=e=>this._ogma.modules.virtualMouse.move(e),this.down=e=>this._ogma.modules.virtualMouse.down(e),this.up=e=>this._ogma.modules.virtualMouse.up(e),this.click=e=>this._ogma.modules.virtualMouse.click(e),this.rightClick=e=>this._ogma.modules.virtualMouse.rightClick(e),this.doubleclick=e=>this._ogma.modules.virtualMouse.doubleclick(e),this.drag=(e,t)=>this._ogma.modules.virtualMouse.drag(e,t),this.wheel=e=>this._ogma.modules.virtualMouse.wheel(e)}},$V=class extends En{constructor(){super(...arguments),this.map=e=>this._ogma.modules.rules.createMapping(e),this.slices=e=>this._ogma.modules.rules.createSlices(e),this.template=e=>this._ogma.modules.rules.createTemplate(e)}},WV=class extends En{constructor(){super(...arguments),this.watchNodeObjectProperty=e=>this._ogma.modules.watcher.watchNodeObjectProperty(e),this.watchEdgeObjectProperty=e=>this._ogma.modules.watcher.watchEdgeObjectProperty(e),this.watchNodeNonObjectProperty=e=>this._ogma.modules.watcher.watchNodeNonObjectProperty(e),this.watchEdgeNonObjectProperty=e=>this._ogma.modules.watcher.watchEdgeNonObjectProperty(e)}},XV=class{clearSelection(){return this.modules.selection.clear()}getSelectedNodes(){return this.modules.selection.getSelectedNodes()}getNonSelectedNodes(){return this.modules.selection.getNonSelectedNodes()}getSelectedEdges(){return this.modules.selection.getSelectedEdges()}getNonSelectedEdges(){return this.modules.selection.getNonSelectedEdges()}},YV=class{setOptions(e){return this.modules.settings.update(e)}getOptions(){return this.modules.settings.get()}},ZV=class extends En{constructor(){super(...arguments),this.setNodesVisibility=e=>this._ogma.modules.graphics.setNodesVisibility(e),this.setEdgesVisibility=e=>this._ogma.modules.graphics.setEdgesVisibility(e),this.setNodeTextsVisibility=e=>this._ogma.modules.graphics.setNodeTextsVisibility(e),this.setEdgeTextsVisibility=e=>this._ogma.modules.graphics.setEdgeTextsVisibility(e),this.addRule=(e={})=>this._ogma.modules.styleRules.addRule(e),this.getRuleList=()=>this._ogma.modules.styleRules.getRuleList(),this.addNodeRule=(e,t)=>{let n,s;return t===void 0?(n=e,s=void 0):(n=t,s=e),this.addRule({nodeAttributes:n,nodeSelector:s})},this.addEdgeRule=(e,t)=>{let n,s;return t===void 0?(n=e,s=void 0):(n=t,s=e),this.addRule({edgeAttributes:n,edgeSelector:s})},this.getNodeRules=()=>this.getRuleList().filter(e=>e.getDefinition().edgeAttributes===void 0),this.getEdgeRules=()=>this.getRuleList().filter(e=>e.getDefinition().nodeAttributes===void 0),this.createClass=e=>this._ogma.modules.classes.createClass(e),this.getClass=e=>this._ogma.modules.classes.getClassByName(e),this.getClassList=()=>this._ogma.modules.classes.getClassList(),this.setHoveredNodeAttributes=(e,t)=>{this._ogma.modules.hover.updateNodeAttributes(e,t)},this.setHoveredEdgeAttributes=(e,t)=>{this._ogma.modules.hover.updateEdgeAttributes(e,t)},this.setSelectedNodeAttributes=(e,t)=>this._ogma.modules.selection.setNodeAttributes(e,!!t),this.setSelectedEdgeAttributes=(e,t)=>this._ogma.modules.selection.setEdgeAttributes(e,!!t),this.setTheme=({nodeAttributes:e,edgeAttributes:t,selectedNodeAttributes:n,selectedEdgeAttributes:s,hoveredNodeAttributes:r,hoveredEdgeAttributes:i})=>{this._ogma.modules.pulses.setTheme(e&&e.pulse||{},t&&t.pulse||{}),this._ogma.modules.graphics.getAttributesManager().setDefaultAttributes(e||{},t||{}),this.setSelectedNodeAttributes(n||{}),this.setSelectedEdgeAttributes(s||{}),this.setHoveredNodeAttributes(r||{}),this.setHoveredEdgeAttributes(i||{})}}},KV=class extends En{constructor(){super(...arguments),this.set=(e,t)=>this._ogma.modules.brand.set(e,t),this.remove=()=>{this._ogma.modules.brand.remove()}}},QV=class extends En{constructor(){super(...arguments),this.enable=e=>(this._ogma.modules.connectNodes.enable(e),this),this.disable=()=>(this._ogma.modules.connectNodes.disable(),this),this.enabled=()=>this._ogma.modules.connectNodes.enabled()}},XS={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:({nodes:e})=>e.setSelected(!0),bothExtremities:!1},QC=class extends zt{constructor(){super(...arguments),this._enabled=!1,this._points=[],this._bbox=new Ws,this._onStart=({x:e,y:t})=>{this._bbox.reset(),this.savePoint(e,t,!1)},this._onStop=()=>{const{minX:e,minY:t,maxX:n,maxY:s}=this._bbox,{nodes:r,edges:i}=this._modules.spatial.queryProjected(e,t,n,s),o={},a=r.filter(c=>{const g=c.isVisible(),f=c.getAttribute("detectable"),p=g&&f&&this._modules.locate.isNodeInPolygon(c,this._points);return o[c._index]=p,p});let u=i.filter(c=>{const g=c.isVisible(),f=c.getAttribute("detectable");return g&&f&&this._modules.locate.isEdgeInPolygon(c,this._points)});this._options.bothExtremities&&(u=this.filterByExtremities(u,o)),this._layer.clear();const d=this._points.slice();this._points=[],this.disable(),this._options.callback({nodes:a,edges:u,points:d})}}onMounted(){this._options=Bn(XS),this._cachedCursor="",this._modules.events.isRegistered("lassoEnabled")||this._modules.events.register(["lassoEnabled","lassoDisabled"]),this._interaction=this._modules.interactions.onDrag({priority:"lasso",check:()=>this._enabled,onStart:this._onStart,onProgress:({x:e,y:t})=>this.savePoint(e,t,!0),onStop:this._onStop})}enable(e={}){var t;return this._enabled||(this._enabled=!0,this._modules.captor.setDetectionEnabled(!1),this._options=pr(e,XS),this._layer=this._modules.layers.addCanvasLayer(Vt,{isStatic:!0,noClear:!1}),this._layer.moveToTop(),this._cachedCursor=((t=this._layer.element.parentElement)==null?void 0:t.style.cursor)||"",lg(this._layer.element.parentElement,this._options.cursorStyle),this._modules.captor.isLeftPressed()&&this._interaction.start(this._modules.captor.getCursorPosition()),this._modules.events.fire("lassoEnabled")),this}disable(){return this._enabled?(this._enabled=!1,this._modules.captor.setDetectionEnabled(!0),lg(this._layer.element.parentElement,this._cachedCursor),this._layer.destroy(),this._modules.events.fire("lassoDisabled"),this):this}enabled(){return this._enabled}savePoint(e,t,n){const s=or(),r=this._options,i=this._points;if(this._bbox.addPoint(e,t),i.push({x:e,y:t}),n){const o=i[0];this._layer.refresh(a=>{a.lineWidth=r.strokeWidth,a.lineJoin="bevel",a.strokeStyle=r.strokeColor,a.fillStyle=r.fillColor,a.beginPath(),a.moveTo(o.x*s,o.y*s);for(let u=1;u<i.length;++u){const d=i[u];a.lineTo(d.x*s,d.y*s)}a.stroke(),r.fillColor&&a.fill()})}}filterByExtremities(e,t){const n=this._modules.graph.getEdgeAttribute("source"),s=this._modules.graph.getEdgeAttribute("target");return e.filter(r=>{const i=r._index,o=n.get(i),a=s.get(i);return t[o]&&t[a]})}},JV=class extends En{constructor(){super(...arguments),this.enable=e=>(this._ogma.modules.lasso.enable(e),this),this.disable=()=>(this._ogma.modules.lasso.disable(),this),this.enabled=()=>this._ogma.modules.lasso.enabled()}},e4=class extends En{constructor(){super(...arguments),this.enable=e=>this._ogma.modules.legend.enable(e),this.disable=()=>this._ogma.modules.legend.disable(),this.enabled=()=>this._ogma.modules.legend.enabled(),this.getOptions=()=>this._ogma.modules.legend.getOptions(),this.export=e=>this._ogma.modules.legend.export(e)}},YS={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:({nodes:e,edges:t})=>{e.size?e.setSelected(!0):t.setSelected(!0)},bothExtremities:!1},t4=class extends QC{constructor(){super(...arguments),this._onStart=({x:e,y:t})=>{var n;this._rectangle.reset(),this._start={x:e,y:t},(n=this._layer)==null||n.refresh(s=>{s.fillStyle=this._options.fillColor,s.strokeStyle=this._options.strokeColor,s.lineWidth=this._options.strokeWidth})},this._onStop=()=>{var a;const e=this._modules.captor.getCursorPosition(),t=this._formatRectangle(e),{nodes:n,edges:s}=this._modules.spatial.queryProjected(t.minX,t.minY,t.maxX,t.maxY),r={},i=n.filter(u=>{const d=u.isVisible(),c=u.getAttribute("detectable"),g=d&&c&&this._modules.locate.isNodeInRectangle(u,t);return r[u._index]=g,g});let o=s.filter(u=>{const d=u.isVisible(),c=u.getAttribute("detectable");return d&&c&&this._modules.locate.isEdgeInRectangle(u,t)});this._options.bothExtremities&&(o=this.filterByExtremities(o,r)),(a=this._layer)==null||a.clear(),this.disable(),this._options.callback({nodes:i,edges:o,rectangle:{minX:t.minX,minY:t.minY,maxX:t.maxX,maxY:t.maxY,width:t.width,height:t.height,cx:t.cx,cy:t.cy}})}}onMounted(){this._options=Bn(YS),this._enabled=!1,this._rectangle=new Ws,this._interaction=this._modules.interactions.onDrag({priority:"lasso",disableDetection:!0,check:()=>this._enabled,onStart:this._onStart,onProgress:({x:e,y:t})=>this._refreshRectangle({x:e,y:t}),onStop:this._onStop})}enable(e){return super.enable(pr(e,YS))}_formatRectangle(e){const t=this._start.x,n=this._start.y,s=e.x,r=e.y,i=Math.abs(t-s),o=Math.abs(n-r),a=t<s?t:s,u=n<r?n:r;return this._rectangle.reset().addPoint(a,u).addPoint(a+i,u+o)}_refreshRectangle(e){var o;const{minX:t,minY:n,width:s,height:r}=this._formatRectangle(e),i=or();(o=this._layer)==null||o.refresh(a=>{a.strokeRect(t*i,n*i,s*i,r*i),this._options.fillColor&&a.fillRect(t*i,n*i,s*i,r*i)})}},n4=class extends En{constructor(){super(...arguments),this.enable=(e={})=>{this._ogma.modules.rectangleSelect.enable(e)},this.disable=()=>{this._ogma.modules.rectangleSelect.disable()},this.enabled=()=>this._ogma.modules.rectangleSelect.enabled()}},s4=class extends En{constructor(){super(...arguments),this.enable=e=>{this._ogma.modules.resizing.enable(e)},this.disable=()=>{this._ogma.modules.resizing.disable()},this.enabled=()=>this._ogma.modules.resizing.enabled()}},r4=class extends En{constructor(){super(...arguments),this.enable=(e={})=>{this._ogma.modules.rewiring.enable(e)},this.disable=()=>{this._ogma.modules.rewiring.disable()},this.enabled=()=>this._ogma.modules.rewiring.enabled()}},i4=class extends En{constructor(){super(...arguments),this.enable=(e={})=>{this._ogma.modules.snapping.enable(e)},this.disable=()=>{this._ogma.modules.snapping.disable()},this.enabled=()=>this._ogma.modules.snapping.enabled()}},o4=class extends En{constructor(){super(...arguments),this.onNodeHover=(e,t={})=>{this._ogma.modules.tooltip.setHandler("hover.node",e,t)},this.onNodeClick=(e,t={})=>{this._ogma.modules.tooltip.setHandler("click.left.node",e,t)},this.onNodeRightClick=(e,t={})=>{this._ogma.modules.tooltip.setHandler("click.right.node",e,t)},this.onNodeDoubleClick=(e,t={})=>{this._ogma.modules.tooltip.setHandler("doubleclick.left.node",e,t)},this.onEdgeHover=(e,t={})=>{this._ogma.modules.tooltip.setHandler("hover.edge",e,t)},this.onEdgeClick=(e,t={})=>{this._ogma.modules.tooltip.setHandler("click.left.edge",e,t)},this.onEdgeRightClick=(e,t={})=>{this._ogma.modules.tooltip.setHandler("click.right.edge",e,t)},this.onEdgeDoubleClick=(e,t={})=>{this._ogma.modules.tooltip.setHandler("doubleclick.left.edge",e,t)},this.onBackgroundClick=(e,t={})=>{this._ogma.modules.tooltip.setHandler("click.left.background",e,t)},this.onBackgroundRightClick=(e,t={})=>{this._ogma.modules.tooltip.setHandler("click.right.background",e,t)},this.onBackgroundDoubleClick=(e,t={})=>{this._ogma.modules.tooltip.setHandler("doubleclick.left.background",e,t)},this.refresh=()=>this._ogma.modules.tooltip.refresh(),this.isShown=()=>this._ogma.modules.tooltip.isShown(),this.hide=()=>{this._ogma.modules.tooltip.hide()},this.show=(e,t)=>this._ogma.modules.tooltip.show(e,t)}},a4=class extends En{constructor(e){super(e),this.lasso=new JV(e),this.connectNodes=new QV(e),this.legend=new e4(e),this.rectangleSelect=new n4(e),this.resize=new s4(e),this.rewire=new r4(e),this.snapping=new i4(e),this.tooltip=new o4(e),this.brand=new KV(e)}},l4=class extends En{constructor(e){super(e),this.getList=()=>this._ogma.modules.transformations.api.getList(),this.clear=()=>this._ogma.modules.transformations.api.clear().then(()=>{}),this.getById=t=>this._ogma.modules.transformations.api.getById(t),this.afterNextUpdate=()=>this._ogma.modules.transformations.afterNextUpdate(),this.onGroupsUpdated=t=>{this._ogma.modules.transformations.onGroupsUpdated(t)},this.layoutGroups=(t,n,s=!1)=>(Gi('Deprecated method "Ogma.transformations.layoutGroups"; please use "ogma.transformations.triggerGroupsUpdated" instead.'),this._ogma.modules.transformations.api.layoutGroups(t,n,s)),this.triggerGroupUpdated=t=>this._ogma.modules.transformations.triggerGroupUpdated(t),this.triggerGroupsUpdated=()=>this._ogma.modules.transformations.api.triggerGroupsUpdated()}addNodeGrouping(e){return this._ogma.modules.transformations.api.addNodeGrouping(e)}addNodeClustering(e){return this._ogma.modules.transformations.api.addNodeClustering(e)}addEdgeGrouping(e){return this._ogma.modules.transformations.api.addEdgeGrouping(e)}addDrillDown(e){return this._ogma.modules.transformations.api.addDrilldown(e)}addNodeFilter(e){return this._ogma.modules.transformations.api.addNodeFilter(e)}addEdgeFilter(e){return this._ogma.modules.transformations.api.addEdgeFilter(e)}getNodeFilters(){return this._ogma.modules.transformations.getNodeFilters()}getEdgeFilters(){return this._ogma.modules.transformations.getEdgeFilters()}addNeighborGeneration(e){return this._ogma.modules.transformations.api.addNeighborGeneration(e)}addNeighborMerging(e){return this._ogma.modules.transformations.api.addNeighborMerging(e)}addNodeCollapsing(e){return this._ogma.modules.transformations.api.addNodeCollapsing(e)}addGeoClustering(e){return this._ogma.modules.transformations.api.addGeoClustering(e)}addVirtualProperties(e){return this._ogma.modules.transformations.api.addVirtualProperties(e)}getXYR(e){return this._ogma.modules.transformations.getXYR(e)}expandGroup({node:e,computeSubNodesPosition:t,duration:n,easing:s,onExpand:r}){return this._ogma.modules.transformations.expandGroup(this._ogma,e,t,r,n,s)}collapseGroup({node:e,duration:t,easing:n,onCollapse:s}){return this._ogma.modules.transformations.collapseGroup(this._ogma,e,s,t,n)}},u4=class extends En{constructor(){super(...arguments),this.setZoom=(e,t)=>this._ogma.modules.camera.setZoom(e,t),this.zoomIn=e=>this._ogma.geo.enabled()?this._ogma.modules.geo.zoomIn():this._ogma.modules.camera.zoomIn(e),this.zoomOut=e=>this._ogma.geo.enabled()?this._ogma.modules.geo.zoomOut():this._ogma.modules.camera.zoomOut(e),this.getZoom=()=>this._ogma.modules.camera.getZoom(),this.setCenter=(e,t)=>this._ogma.modules.camera.setCenter(e,t),this.move=(e,t)=>this._ogma.modules.camera.move(e,t),this.moveToBounds=(e,t)=>{if(!(e&&e instanceof Ws)){if(!bs(e)||e.length!==4)throw new Error("ogma.view.zoomToBounds requires a BoundingBox as a parameter");{const[n,s,r,i]=e;e=Ws.from({minX:n,minY:s,maxX:r,maxY:i})}}return this._ogma.modules.camera.moveToBounds(e,t)},this.moveTo=(e,t)=>this._ogma.modules.camera.moveTo(e,t),this.getCenter=()=>this._ogma.modules.camera.getCenter(),this.setAngle=(e,t)=>this._ogma.modules.camera.setAngle(e,t),this.rotate=(e,t)=>this._ogma.modules.camera.rotate(e,t),this.getAngle=()=>this._ogma.modules.camera.getAngle(),this.set=(e,t)=>this._ogma.modules.camera.setView(e,t),this.get=()=>this._ogma.modules.camera.getView(),this.graphToScreenCoordinates=e=>this._ogma.modules.camera.graphToScreenCoordinates(e),this.screenToGraphCoordinates=e=>this._ogma.modules.camera.screenToGraphCoordinates(e),this.getImageData=()=>this._ogma.modules.graphics.getImageData(),this.getElementAt=e=>this._ogma.modules.captor.detectElementAt(e.x,e.y,!1,!0),this.getElementsInView=()=>{const{width:e,height:t}=this.get(),n=this.screenToGraphCoordinates({x:0,y:0}),s=this.screenToGraphCoordinates({x:e,y:t});return this._ogma.modules.spatial.query(n.x,n.y,s.x,s.y)},this.getBounds=()=>{const{width:e,height:t}=this.getSize(),n=this.screenToGraphCoordinates({x:0,y:0}),s=this.screenToGraphCoordinates({x:e,y:t});return{cx:(n.x+s.x)/2,cy:(n.y+s.y)/2,width:s.x-n.x,height:s.y-n.y,minX:n.x,minY:n.y,maxX:s.x,maxY:s.y}},this.getElementsInside=(e,t,n,s,r=!0)=>{const{spatial:i,camera:o}=this._ogma.modules;if(r){const a=o.graphToScreenCoordinates({x:e,y:t}),u=o.graphToScreenCoordinates({x:n,y:s});return i.queryProjected(a.x,a.y,u.x,u.y)}return i.queryProjected(e,t,n,s)},this.beforeNextFrame=()=>this._ogma.modules.dom.beforeNextFrame(),this.afterNextFrame=()=>this._ogma.modules.dom.afterNextFrame(),this.setFullScreen=e=>this._ogma.modules.dom.setFullScreen(e),this.isFullScreen=()=>this._ogma.modules.dom.isFullScreen(),this.forceResize=()=>this._ogma.modules.dom.forceResize(),this.getSize=()=>this._ogma.modules.dom.getDimensions(),this.setSize=e=>{if(!e||isNaN(e.width)||isNaN(e.height))throw new Error("Size must follow the format { width: number, height: number }");if(e.width<0)throw new Error("width must be positive");if(e.height<0)throw new Error("height must be positive");return this._ogma.modules.dom.setDimensions(e),Promise.resolve()},this.locateGraph=e=>this._ogma.modules.locate.locateGraph(e),this.locateRawGraph=(e,t)=>this._ogma.modules.locate.locateRawGraph(e,t),this.getGraphBoundingBox=({withTexts:e=!1}={})=>this._ogma.modules.locate.getGraphBoundingBox(e),this.animationInProgress=()=>this._ogma.modules.locate.isLocating()||this._ogma.modules.camera.animationInProgress(),this.getTextBoundingBox=e=>{if(!e)throw new Error("ogma.view.getTextBoundingBox: item must be a Node or an Edge");const t=e.getAttribute("text");return t==null||t===""?null:e.isList?this._ogma.modules.labels.getTextsBoundingBox(e):this._ogma.modules.labels.getTextsBoundingBox(e.toList())},this.getNodeBadgeAt=(e,t)=>{if(!e)throw new Error("ogma.view.getNodeBadgeAt: node is not defined");return jT(t,e._index,this._ogma.modules.graphics.getAttributesManager(),this._ogma.modules.camera,this._ogma.modules.graphics.getGraphicsEngine())}}},d4=class{constructor(e,t){this._ogma=e,this.settings=new QB(e),this.events=new YB(e),this.dom=new GR(e),this.animations=new o5(e),this.camera=new FB(e),this.graph=new oP(e),this.data=new HR(e),this.graphics=new VB(e),this.layers=new I6(e),this.individualAttributes=new KB(e),this.algorithms=new k6(e),this.position=new v6(e),this.touch=new E3(e),this.mouse=new v3(e),this.virtualMouse=new U5(e),this.spatial=new l3(e),this.captor=new vj(e),this.interactions=new cj(e),this.classes=new n3(e),this.cameraInteractions=new PB(e,!!t.debug),this.hover=new x6(e),this.keyboard=new Rj(e),this.selection=new Q4(e),this.styleRules=new q5(e),this.legend=new _6(e),this.sync=new J4(e),this.rules=new T6(e),this.transformations=new Z4(e),this.locate=new m3(e),this.drag=new bj(e),this.pulses=new s5(e),this.curvatureManager=new b5(e),this.workers=new L5(e),this.layouts=new I5(e),this.watcher=new F5(e),this.rectangleSelect=new t4(e),this.labels=new hj(e,t),this.brand=new x5(e),this.lasso=new QC(e),this.rewiring=new Sj(e),this.resizing=new Aj(e),this.snapping=new G5(e),this.connectNodes=new Tj(e),this.tooltip=new Mj(e),this.geo=new v5(e),Object.keys(this).forEach(n=>{const s=this[n];s instanceof zt&&(s._setModules(this),s.onMounted())}),e.onReady(()=>{Object.keys(this).forEach(n=>{const s=this[n];s instanceof zt&&s.onReady(t)})})}destroy(){Object.keys(this).forEach(e=>{const t=this[e];t instanceof zt&&t.destroy(this._ogma)})}},h4=1,c4=[A3,S3,L3,cP,RU,XV,YV],Y_={version:"5.2.2",commit:"de8dcac10",buildTime:"Wed Feb 19 2025 12:53:44 GMT+0000 (Coordinated Universal Time)"},gr,gl=(gr=class{constructor(t={}){this.node=n=>new Xr(n,this),this.edge=n=>new Mo(n,this),this.nodeList=n=>new Ki(n||new Uint32Array(0),this),this.edgeList=n=>new Ta(n||new Uint32Array(0),this),this._onReady=[],this.build=Y_,this._init(t)}_init(t){this._initParameters=t,this._debug=!!t.debug,this._token=h4++,this.modules=new d4(this,t),this.styles=new ZV(this),this.algorithms=new M6(this),this.export=new kU(this),this.keyboard=new DU(this),this.generate=new MU(this),this.layouts=new HV(this),this.parse=new FU(this),this.transformations=new l4(this),this.tools=new a4(this),this.view=new u4(this),this.mouse=new qV(this),this.events=new N3(this),this.schema=new WV(this),this.rules=new $V(this),this.geo=new PU(this),this.layers=new OU(this),this.debug=new C3(this),this._onReady.forEach(n=>n(this)),this.safelyBindToInstance(),this.modules.events.register(["destroy"]),this.build={version:"5.2.2",commit:"de8dcac10",buildTime:"Wed Feb 19 2025 12:53:44 GMT+0000 (Coordinated Universal Time)"}}safelyBindToInstance(){for(const t of Object.getOwnPropertyNames(gr.prototype))typeof gr.prototype[t]=="function"&&(this[t]=this[t].bind(this))}onReady(t){this._onReady.push(t)}_destroy(){if(!this._token)throw new Error('"destroy" called twice on the same instance of Ogma');this._onReady=[],this.modules.destroy(),this.modules=null}destroy(){this.modules.events.fire("destroy",{}),this._destroy()}isDestroyed(){return!this.modules}reset(){const t=this._initParameters;this._destroy(),this._init(t)}isDebug(){return this._debug}},gr.libraries=Kw,gr.geometry=IC,gr.parse=xx,gr.build=Y_,gr.algorithms=Ly,gr.utils=lx,gr);gl.algorithms=Ly,gl.utils=lx,gl.parse=xx,gl.build=Y_,Pk(gl,c4);var Nx=gl,Os=(e=>(e.NodeFilter="node-filter",e.EdgeFilter="edge-filter",e.NodeCollapsing="node-collapsing",e.VirtualProperties="virtual-properties",e.NeighborGeneration="neighbor-generation",e.NeighborMerging="neighbor-merging",e.NodeGrouping="node-grouping",e.EdgeGrouping="edge-grouping",e.NodeClustering="node-clustering",e.GeoClustering="geo-clustering",e.Unknown="unknown",e))(Os||{}),zo=class{constructor({id:e,duration:t,easing:n,ogma:s,module:r}){this.animation=n?{duration:t,easing:n}:t===void 0?0:t,this.destroyed=!1,this.id=e,this.ogma=s,this.context={},this.module=r,this.resetContext()}setOptions(e){var t;let n=typeof this.animation=="number"?this.animation:(t=this.animation)==null?void 0:t.duration,s=typeof this.animation=="object"?this.animation.easing:void 0;return typeof e.duration=="number"&&(n=e.duration),e.easing!==void 0&&(s=e.easing),this.animation=s?{duration:n,easing:s}:n===void 0?0:n,this.module.setOptions(this),this.module.afterNextUpdate()}enable(e){return this.animation=e===void 0?this.animation:e,this.module.enable(this)}disable(e){return this.animation=e===void 0?this.animation:e,this.module.disable(this)}isEnabled(){return this.module.isEnabled(this)}getId(){return this.id}whenApplied(){return this.module.afterNextUpdate().then(()=>this)}toggle(e){return this.animation=e===void 0?this.animation:e,this.isEnabled()?this.module.disable(this):this.module.enable(this)}run(e=!0){return Promise.resolve()}undo(e=!0){return Promise.resolve()}cleanup(){return this.resetContext(),Promise.resolve()}refresh(){return this.module.refreshTransformation(this),this.module.afterNextUpdate()}getIndex(){return this.module.getIndex(this)}setIndex(e){return this.module.setIndex(this,e),this.module.afterNextUpdate()}getAnimation(){return typeof this.animation=="number"?{duration:this.animation,easing:"linear"}:this.animation}getContext(){return this.context}setContent(e){this.context=e}resetContext(){this.context={}}getName(){return Os.Unknown}destroy(e){return e!==void 0&&(this.animation=e),this.module.remove(this)}},g4=class{constructor(e){this.xs=new Map,this.ys=new Map,this.rs=new Map,this.curvatures=new Map,this.hiddenNodes=new Set,this.hiddenEdges=new Set,this.animations=[],this.before=[],this.after=[],this.enabled=!1,this.applying=!1,this._onLayoutEnd=t=>{if(!this.enabled)return;const n=t.positions.current,s=t.ids;for(let r=0;r<s.length;r++){const i=this.ogma.getNode(s[r])._index,o=n[r];o&&(this.xs.set(i,o.x),this.ys.set(i,o.y))}},this._onLayoutPrepare=t=>{this.enabled&&(t.params.dryRun=!0)},this._onNodesRemoved=t=>{const n=t.nodes._indexes;for(const s of n)this.xs.delete(s),this.ys.delete(s),this.rs.delete(s)},this._onLayoutGetData=({name:t,data:n})=>{if(this.enabled){if(t==="force"){const s=n.graph.nodes,r=n.indexes;for(let i=0;i<r.length;i++)this.xs.has(r[i])&&(s[i].x=this.xs.get(r[i]),s[i].y=this.ys.get(r[i]),s[i].r=this.rs.get(r[i])!==void 0?1.25*this.rs.get(r[i]):s[i].r)}else if(t==="hierarchical"||t==="sequential"){const s=n.options.nodes._indexes;for(let r=0;r<s.length;r++)this.rs.has(s[r])&&(n.radiuses[r]=this.rs.get(s[r]))}else if(t==="concentric"){const s=n.list;for(let r=0;r<s.length;r++)this.rs.has(s[r])&&(n.attributes.size[r]=this.rs.get(s[r]))}else if(t==="forceLink")for(const s in n.nodes){const r=Number(s),i=n.nodes[r];this.xs.has(r)&&(i.x=this.xs.get(r),i.y=this.ys.get(r)),this.rs.has(r)&&(i.size=this.rs.get(r))}else if(t==="radial"){const s=n.indexes;for(let r=0;r<s.length;r++){const i=s[r];this.xs.has(i)&&(n.x[r]=this.xs.get(i),n.y[r]=this.ys.get(i)),this.rs.has(i)&&(n.attributes.size[r]=this.rs.get(i))}}else if(t!=="grid")throw new Error(`Ogma transformtaions: Unsupported layout: ${t}`)}},this.ogma=e,this.afterMod={nodesToHide:new Set,edgesToHide:new Set},this.layer=this.ogma.modules.graphics.addAttributeLayer({name:"ogma-transformations-animations",priority:5.99999,nodeOutput:{attributes:["radius"]},edgeOutput:{attributes:["curvature"]},nodeDependencies:void 0,edgeDependencies:void 0}),this.attributeLayerData=this.layer._attributesManager._getLayerById(this.layer._id),this.initEvents()}initEvents(){this.ogma.events.on("layoutPrepare",this._onLayoutPrepare).on("layoutEnd",this._onLayoutEnd).on("removeNodes",this._onNodesRemoved).on("layoutGetData",this._onLayoutGetData)}handleLayoutPromises(e){return Promise.all(e).then(t=>{t.forEach(n=>{if(!n)return;const{res:s,subNodes:r}=n;if(!Array.isArray(s))return;const i=r._indexes;for(let o=0;o<i.length;o++){const a=s[o];a.radius!==void 0?this.setXYR(i[o],a.x,a.y,a.radius):this.setXY(i[o],a.x,a.y)}})})}handleGlobalLayout(e,t){if(e)for(let n=0;n<t.length;n++)e[n].radius!==void 0?this.setXYR(t[n],e[n].x,e[n].y,e[n].radius):this.setXY(t[n],e[n].x,e[n].y)}apply(e){const t=Array.from(this.xs.values()),n=Array.from(this.ys.values()),s=Array.from(this.rs.values()).map(g=>({radius:g})),r=Array.from(this.curvatures.values()).map(g=>({curvature:g})),i=this.ogma.nodeList(Array.from(this.hiddenNodes)),o=this.ogma.edgeList(Array.from(this.hiddenEdges)),a=t.map((g,f)=>({x:g,y:n[f]})),u=this.ogma.nodeList(Array.from(this.xs.keys())),d=this.ogma.nodeList(Array.from(this.rs.keys())),c=this.ogma.edgeList(Array.from(this.curvatures.keys()));return this.xs.clear(),this.ys.clear(),this.rs.clear(),this.curvatures.clear(),this.hiddenNodes.clear(),this.hiddenEdges.clear(),this.before.forEach(g=>g()),this.initCurvature(c._indexes),this.applying=a.length>0||s.length>0||r.length>0,Promise.all([a.length?u.setAttributes(a,e):Promise.resolve(),s.length?this.ogma.modules.graphics.animate(d,()=>this.layer.setAttributeValues(d,s),!1,e):Promise.resolve(),r.length?this.ogma.modules.graphics.animate(c,()=>this.layer.setAttributeValues(c,r),!1,e):Promise.resolve(),...this.animations.map(g=>g())]).then(()=>(this.ogma.nodeList(Array.from(this.afterMod.nodesToHide)).setVisible(!1),this.ogma.edgeList(Array.from(this.afterMod.edgesToHide)).setVisible(!1),Promise.all(this.after.map(g=>g())))).then(()=>{this.deleteCurvatures(c._indexes),i.setVisible(!1),o.setVisible(!1),this.animations=[],this.before=[],this.after=[],this.afterMod.nodesToHide.clear(),this.afterMod.edgesToHide.clear(),this.applying=!1})}setXYR(e,t,n,s){if(typeof e=="number")this.xs.set(e,t),this.ys.set(e,n),s!==void 0&&this.rs.set(e,s);else for(const r of e)this.xs.set(r,t),this.ys.set(r,n),s!==void 0&&this.rs.set(r,s)}getOpenRadius(e){return this.attributeLayerData.nodes.outputFlexArrays.radius.get(e)}getInputFlexArrays(){return this.attributeLayerData.nodes.inputFlexArrays}getCloseRadius(e){return this.attributeLayerData.nodes.inputFlexArrays.radius.get(e)}deleteOpenRadius(e){this.layer.getFlexArrays().nodes.radius.set(e,void 0)}initCurvature(e){const t=this.attributeLayerData.edges.inputFlexArrays.curvature,n=this.attributeLayerData.edges.outputFlexArrays.curvature;for(let s=0;s<e.length;s++)n.set(e[s],t.get(e[s]))}deleteCurvatures(e){const t=this.layer.getFlexArrays().edges.curvature;for(let n=0;n<e.length;n++)t.set(e[n],void 0)}hideNode(e){this.hiddenNodes.add(e)}showNode(e){this.hiddenNodes.delete(e)}hideNodes(e){for(const t of e)this.hiddenNodes.add(t)}showNodes(e){for(const t of e)this.hiddenNodes.delete(t)}hideEdge(e){this.hiddenEdges.add(e)}showEdge(e){this.hiddenEdges.delete(e)}hideEdges(e){for(const t of e)this.hiddenEdges.add(t)}showEdges(e){for(const t of e)this.hiddenEdges.delete(t)}pushBefore(e){Array.isArray(e)?this.before.push(...e):this.before.push(e)}pushAfter(e){Array.isArray(e)?this.after.push(...e):this.after.push(e)}setXY(e,t,n){this.xs.set(e,t),this.ys.set(e,n)}setR(e,t){this.rs.set(e,t)}setRs(e,t){for(let n=0;n<e.length;n++)this.rs.set(e[n],t[n])}setCurvatures(e,t){for(let n=0;n<e.length;n++)this.curvatures.set(e[n],t[n])}setCurvature(e,t){this.curvatures.set(e,t)}hideNodesAfter(e){for(let t=0;t<e.length;t++)this.afterMod.nodesToHide.add(e[t])}hideEdgesAfter(e){for(let t=0;t<e.length;t++)this.afterMod.edgesToHide.add(e[t])}setOpenRadius(e,t){this.attributeLayerData.nodes.outputFlexArrays.radius.set(e,t)}push(e){Array.isArray(e)?this.animations.push(...e):this.animations.push(e)}enable(){this.enabled=!0}disable(){this.enabled=!1}getMaxAnimation(e,t){return(typeof e=="number"?e:e.duration)>(typeof t=="number"?t:t.duration)?e:t}isApplying(){return this.applying}},Z_=(...e)=>{const t={};for(let n=0;n<e.length;n++){const s=e[n];for(const r in s)s.hasOwnProperty(r)&&(Array.isArray(t[r])&&Array.isArray(s[r])?t[r]=Array.from(new Set(t[r].concat(s[r]))):ZS(t[r])&&ZS(s[r])?t[r]=Z_(t[r],s[r]):t[r]=s[r])}return t};function Qu(e,t,n){const s=typeof t=="string"?t.split("."):t;for(let r=0;r<s.length-1;++r){const i=s[r];let o=e[i];o||(o={},e[i]=o),e=o}e[s[s.length-1]]=n}function f4(e){let t=0,n=0;const s=e.length;if(s===0)throw new Error("Ogma transformations: Compute centroid: at least one point is required");for(let r=0;r<s;++r){const i=e[r];t+=i.x,n+=i.y}return t/=s,n/=s,{x:t,y:n}}function p4(e,t){const n=e.get(0);return{data:n.getData(),attributes:n.getAttributes(t)}}function Ig(e,t){return`gen_grp_${t}_${e}`}function ZS(e){return!(!e||e.constructor!==Object&&e.constructor)}function m4(e){return e.map(({id:t,source:n,target:s})=>({id:t,source:n,target:s}))}function _4(e,t,n,s){let r=t,i=n;return!s&&r.toString()>i.toString()&&(r=n,i=t),`${e}[${r}-${i}]`}function y4(e){if(e===void 0)return Math.round(Math.random()*Number.MAX_SAFE_INTEGER);if(typeof e!="string"&&(typeof e!="number"||!isFinite(e)))throw new Error(`Ogma transformation: ${e} is not a valid id, expected string or number`);return e}function kc(e){return`data.${e}`}var x4=class{constructor(e){this.groupsByDepth=new Map,this.treeMap=new Map,this.dataMap=new Map,this.invalidEdges=new Map,this.edges=new Map,this.ogma=e.ogma,this.module=e.module,this.enabled=e.enabled===void 0||e.enabled,this.onGetSubgraph=e.onGetSubgraph,this.duration=e.duration||0,this.easing=e.easing||"quadraticOut",this.parentPath=e.parentPath||"parent",this.depthPath=e.depthPath||"depth",this.padding=e.padding||0,this.nodeGenerator=e.nodeGenerator||(()=>({})),this.showContents=e.showContents===void 0||e.showContents,this.onGroupUpdate=e.onGroupUpdate||(()=>Promise.resolve()),this.copyData=e.copyData===void 0||e.copyData,this.context={virtualEdges:this.ogma.edgeList()}}createGrouping(e){var t;const{ogma:n,groupsByDepth:s}=this,r=n.transformations.addNodeGrouping({selector:o=>o.getData(this.depthPath)===e,groupIdFunction:o=>o.getData(this.parentPath),showContents:o=>typeof this.showContents=="boolean"?this.showContents:this.showContents(o,e),onBeforeAddMetaEdges:(o,a)=>this.addEdges(o,a),onGroupUpdate:(o,a,u)=>this.onGroupUpdate(o,a,u,e),padding:o=>typeof this.padding=="number"?this.padding:this.padding(o,e),duration:this.duration,enabled:this.enabled,nodeGenerator:(o,a)=>{const u=this.nodeGenerator(o,a,r);return this.copyData&&(u.data||(u.data={}),u.data={...u.data,...this.dataMap.get(a)}),Qu(u,kc(this.parentPath),this.treeMap.get(a)),Qu(u,kc(this.depthPath),e-1),u.id=a,u}});if(!s.size)return s.set(e,r);const i=Array.from(s.keys()).reduce((o,a)=>Math.max(o,a));s.set(e,r),r.setIndex((t=s.get(i))==null?void 0:t.getIndex())}async drill(e){if(this.treeMap.has(e.getId()))return;const{ogma:t,groupsByDepth:n}=this,s=e.getId(),r=this.getGroupId(s);this.treeMap.set(r,e.getData(this.parentPath)),this.dataMap.set(r,e.getData());const i=e.getData(this.depthPath)||0,o=e.getPosition(),a=await this.onGetSubgraph(e);this.edges.set(r,e.getAdjacentEdges().map(d=>{const c=d.getSource().getId(),g=d.getTarget().getId();return{source:c===s?r:c,target:g===s?r:g,data:{...d.getData()}}})),a.nodes.forEach(d=>{Qu(d,kc(this.parentPath),r),Qu(d,kc(this.depthPath),i+1),d.attributes||(d.attributes={}),d.attributes.x=o.x,d.attributes.y=o.y}),this.module.pause(),t.removeEdges(e.getAdjacentEdges()),t.removeNode(e),await t.view.afterNextFrame(),await t.addNodes(a.nodes);const u=a.edges.filter(d=>{const c=d.source,g=d.target;if(t.getNode(c)&&t.getNode(g))return!0;const f=t.getNode(c)?g:c;return this.invalidEdges.has(f)?this.invalidEdges.get(f).push(d):this.invalidEdges.set(f,[d]),!1});a.nodes.forEach(d=>{if(!this.invalidEdges.has(d.id))return;const{valid:c,invalid:g}=this.invalidEdges.get(d.id).reduce((f,p)=>(t.getNode(p.source)&&t.getNode(p.target)?f.valid.push(p):f.invalid.push(p),f),{valid:[],invalid:[]});t.addEdges(c),g.length?this.invalidEdges.set(d.id,g):this.invalidEdges.delete(d.id)}),await t.addEdges(u),n.has(i+1)||this.createGrouping(i+1),this.module.resume(),await this.module.afterNextUpdate()}async addEdges(e,t){t.forEach(n=>{const s=this.edges.get(n.getId());s&&this.ogma.addEdges(s,{virtual:!0}).then(r=>{this.context.virtualEdges=this.context.virtualEdges.concat(r)})})}getGroupId(e){return`ogma-group-${e}`}getMaxDepth(){return this.groupsByDepth.size}disable(e){return this.enabled=!1,this.duration=typeof e=="number"?e:this.duration,this.easing=typeof e=="object"?e.easing:this.easing,this.groupsByDepth.forEach(t=>t.disable(e)),this.module.animations.hideEdges(this.context.virtualEdges._indexes),this.context.virtualEdges.setSelected(!0),this.module.afterNextUpdate()}enable(e){return this.enabled=!0,this.duration=typeof e=="number"?e:this.duration,this.easing=typeof e=="object"?e.easing:this.easing,this.groupsByDepth.forEach(t=>t.enable(e)),this.module.animations.showEdges(this.context.virtualEdges._indexes),this.module.afterNextUpdate().then(()=>this.context.virtualEdges.setVisible(!0))}toggle(e){return this.enabled?this.disable(e):this.enable(e)}setOptions(e){this.onGetSubgraph=e.onGetSubgraph?e.onGetSubgraph:this.onGetSubgraph,this.duration=e.duration!==void 0?e.duration:this.duration,this.easing=e.easing||this.easing,this.parentPath=e.parentPath||this.parentPath,this.depthPath=e.depthPath||this.depthPath,this.padding=e.padding!==void 0?e.padding:this.padding,this.nodeGenerator=e.nodeGenerator||this.nodeGenerator,this.showContents=e.showContents!==void 0?e.showContents:this.showContents,this.onGroupUpdate=e.onGroupUpdate||this.onGroupUpdate,this.copyData=e.copyData!==void 0?e.copyData:this.copyData;const t=this.enabled;return this.enabled=e.enabled!==void 0?e.enabled:this.enabled,this.enabled!==t&&this.groupsByDepth.forEach(n=>this.enabled?n.enable({duration:this.duration,easing:this.easing}):n.disable({duration:this.duration,easing:this.easing})),this.groupsByDepth.forEach(n=>n.refresh()),this.module.afterNextUpdate()}onRemove(e){this.context.virtualEdges=this.context.virtualEdges.filter(t=>!e.has(t._index))}},v4=class{constructor(e){this.drilldowns=[],this.module=e}addDrilldown(e){this.drilldowns.push(e)}removeDrilldown(e){this.drilldowns=this.drilldowns.filter(t=>t!==e)}onRemove(e,t){t||this.drilldowns.forEach(n=>n.onRemove(e))}},b4=class{constructor(e,t){this.enabled=!1,this.relayouted=new Set,this.shouldRelayout=new Set,this.layoutPerGroup=new Map,this.ogma=e,this.module=t,this.ogma.events.on("layoutPrepare",n=>{if(!n.params.nodes)return;const s=n.params.nodes,r=Array.isArray(s)?this.ogma.getNode(s[0])._index:s._indexes[0],i=this.module.nodeToMeta.get(r);if(!i)return;const o={...n,params:{...n.params}};delete o.params.nodes,this.layoutPerGroup.set(i._index,o)})}getNodesToRecompute(e){const t=Array.from(e),n=new Set,s=[];for(;t.length>0;){const r=t.shift();if(n.has(r))continue;s.push(r),n.add(r);const i=this.module.nodeToMeta.get(r);i&&t.push(i._index)}return this.ogma.nodeList(s)}async layoutGroups(e,t,n=!1){this.module.animations.enable(),this.enable();const s=new Map,r=this.ogma.getNodes(e.map(({groupId:a})=>a));e.forEach(({groupId:a,layout:u,params:d},c)=>{s.set(a,()=>this.ogma.layouts[u]({...d,nodes:this.module.metaToNodes.get(r.get(c)._index)}))});const i=this.getNodesToRecompute(r._indexes),o=new Map;i.forEach(a=>o.set(a._index,this.module.nodeToTransformation.get(a._index).getIndex())),i.sort((a,u)=>o.get(a._index)-o.get(u._index));for(let a=0;a<i.size;a++){const u=o.get(i._indexes[a]);let d;for(d=a+1;d<i.size&&o.get(i._indexes[d])===u;d++);const c=i.slice(a,d);a=d-1,await Promise.all(c.map(g=>{this.relayouted.add(g._index);let f=Promise.resolve();if(s.has(g.getId()))f=s.get(g.getId())();else if(n&&this.layoutPerGroup.has(g._index)){const p=this.module.metaToNodes.get(g._index),_=this.layoutPerGroup.get(g._index);f=this.ogma.layouts[_.name]({..._.params,nodes:p})}return f.then(()=>{this.module.groupController.setGroupXYR(g)})}))}return await this.module.groupController.onAfterLayouts(),this.module.animations.apply(t||0).finally(()=>{this.disable(),this.module.animations.disable(),this.relayouted.clear()})}hasRelayouted(e){return this.relayouted.has(e)}enable(){this.enabled=!0}disable(){this.enabled=!1}clear(){this.relayouted.clear(),this.shouldRelayout.clear()}},Mc=14,E4=class{constructor(e,t){this.subNodeOffsetX=new Map,this.subNodeOffsetY=new Map,this.openRadius=new Map,this.isExpanding=new Set,this.alreadyGrouped=new Set,this.openGroups=new Set,this.closeGroups=new Set,this.destroyed=!1,this.nodeLayer=new Map,this.edgeLayer=new Map,this.padding=new Map,this.geoRadius=new Map,this.collapsedGroups=new Set,this.hasUpdated=new Set,this.onGroupsUpdate=()=>Promise.resolve(),this.shouldRunGroupUpdate=!1,this.runningLayouts=!1,this.onSetMultipleAttributes=({elements:s,values:r,options:i,updatedAttributes:o,promises:a})=>{if(this.module.isRefreshing()||this.destroyed||this.runningLayouts||this.module.animations.isApplying())return;const u=new Set(o),d=r;if(!s.isNode||!u.has("x")&&!u.has("y")&&!u.has("radius"))return Promise.resolve();const c=s.toList();if(!c.size)return Promise.resolve();const g=[],f=new Set,p=Array.from(c._indexes);for(;p.length;){const y=p.shift(),x=this.module.nodeToMeta.get(y);if(!x||f.has(x._index))continue;const E=this.getGroupXYR(x,this.module.getSubNodes(x),c,d);E.isGeo?g.push(x.setAttribute("radius",E.radius,i)):(delete E.isGeo,this.closeGroups.has(x._index)||this.collapsedGroups.has(x._index)?(this.openRadius.set(x._index,E.radius),this.module.animations.setXY(x._index,E.x,E.y)):this.module.animations.setXYR(x._index,E.x,E.y,E.radius),f.add(x._index)),p.push(x._index)}const _=c.map((y,x)=>{if(!this.openGroups.has(y._index))return null;const E=y.getPosition();return Array.isArray(d)&&d[x]?(d[x].x!==void 0&&(E.x=d[x].x),d[x].y!==void 0&&(E.y=d[x].y)):(d.x!==void 0&&(E.x=d.x),d.y!==void 0&&(E.y=d.y)),{group:y,position:E}}).filter(y=>y);_.length&&_.forEach(({group:y,position:x})=>this.animateChildren(y,x)),(f.size>0||_.length)&&g.push(this.module.animations.apply(i)),a.push(...g)},this.ogma=e,this.layoutController=new b4(e,t),this.groupLayer=this.ogma.modules.graphics.addAttributeLayer({name:"groups-layer",priority:5.50225,edgeAttributes:{layer:s=>this.edgeLayer.get(s._index)},nodeAttributes:{layer:s=>this.nodeLayer.get(s._index)},nodeDependencies:void 0,edgeDependencies:void 0});const n=e.styles.getClass("_group-fading_");this.fadingClass=n||this.ogma.styles.createClass({name:"_group-fading_",nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0}}),this.module=t,e.events.on("setMultipleAttributes",this.onSetMultipleAttributes).on("beforeGeoCameraMove",({zoom:s})=>{const r=this.ogma.nodeList(Array.from(this.geoRadius.keys())).filter(i=>i&&!this.collapsedGroups.has(i._index)&&this.openGroups.has(i._index));r.forEach(i=>{const o=this.geoRadius.get(i._index)*2**s;this.module.animations.setOpenRadius(i._index,o)}),this.ogma.modules.geo._projection&&this.ogma.modules.geo._projection.updateElements(r)}).on(["geoEnabled","beforeGeoDisabled"],()=>this._onToggleGeo()).on("geoNodesMoved",({nodes:s})=>{const r=s._indexes;for(let i=0;i<r.length;i++){const o=this.module.getMetaNode(s.get(i));!o||!this.openGroups.has(o._index)||this.layoutController.shouldRelayout.add(o._index)}}).on(["nodeClassRemoved__hovered","nodeClassAdded__hovered","nodeClassRemoved__selected","nodeClassAdded__selected","nodeClassAdded__hoverExtremityHighlighted","nodeClassRemoved__hoverExtremityHighlighted"],({nodes:s})=>{const r=s._indexes;for(let i=0;i<r.length;i++){const o=s.get(i);if(!this.isOpen(o))continue;const a=o.getAttribute("layer");this.setSubEltsLayer(o,a,!0)}})}setSubEltsLayer(e,t,n){const s=n?1:-1;if(!this.isOpen(e))return;const r=this.module.getSubNodes(e);r.forEach(o=>{this.nodeLayer.set(o._index,t+s),this.setSubEltsLayer(o,t+s,n)});const i=r.getAdjacentEdges({bothExtremities:!0});for(let o=0;o<i.size;o++)this.edgeLayer.set(i._indexes[o],t+s)}closeGroup(e,t,n,s,r=!1){const i=[t],o=this.closeGroups.has(e._index)||this.collapsedGroups.has(e._index);this.openGroups.delete(e._index),this.closeGroups.add(e._index),this.hasUpdated.add(e._index);const a=this.module.animations,u=r?0:a.getCloseRadius(e._index),d=a.getOpenRadius(e._index);if(d!==void 0&&!o&&this.openRadius.set(e._index,d),a.setXYR(e._index,n,s,u),r)return;for(;i.length;){const g=i.shift(),f=g._indexes,p=g.getAdjacentEdges({bothExtremities:!0}),_=new Set;for(let x=0;x<p._indexes.length;x++)_.add(p._indexes[x]);const y=g.getAdjacentEdges({bothExtremities:!1}).filter(x=>!_.has(x._index));a.setXYR(f,n,s,u),a.hideNodesAfter(f),a.hideEdgesAfter(p._indexes),a.hideEdgesAfter(y._indexes),a.pushAfter(()=>{const x=[];for(let E=0;E<f.length;E++){const b=this.closeGroups.has(f[E]);a.deleteOpenRadius(e._index),x.push(b?u:this.openRadius.get(f[E]))}this.module.animations.setRs(g._indexes,x)});for(let x=0;x<f.length;x++){if(!this.openGroups.has(f[x]))continue;const E=g.get(x);this.collapsedGroups.add(E._index);const b=this.module.getSubNodes(g.get(x));b.size&&i.push(b)}}const c=this.module.getMetaNode(e);c&&this.openGroups.has(c._index)&&this.layoutController.shouldRelayout.add(c._index)}setGroupXYR(e){const t=this.getGroupXYR(e,this.module.getSubNodes(e),void 0,void 0);t.isGeo?(this.setGeoLatLng(e,t.y,t.x),this.module.animations.setR(e._index,t.radius)):this.module.animations.setXYR(e._index,t.x,t.y,t.radius)}setGeoLatLng(e,t,n){this.ogma.modules.data.setProperty(e,this.ogma.modules.geo.latitudePath,t,{virtual:!0}),this.ogma.modules.data.setProperty(e,this.ogma.modules.geo.longitudePath,n,{virtual:!0})}expandGroup(e,t,n=!1){const s=this.module.animations,r=e.getPosition();n||(this.openGroups.add(e._index),this.closeGroups.delete(e._index),this.collapsedGroups.delete(e._index)),this.isExpanding.add(e._index),this.hasUpdated.add(e._index);const i=[{subNodes:t,offset:this.getOffset(e._index),isClosed:!1,wasCollapsed:!1}];for(;i.length;){const{subNodes:a,offset:u,isClosed:d,wasCollapsed:c}=i.shift();if((d||c)&&s.pushBefore(()=>a.setAttributes({x:r.x+u.x,y:r.y+u.y},0)),d)continue;const g=a._indexes,f=a.getAdjacentEdges({bothExtremities:!0,filter:"all"});a.setVisible(!0),f.setVisible(!0);for(let p=0;p<g.length;p++){const _=this.closeGroups.has(g[p]),y=this.collapsedGroups.has(g[p]);s.setXYR(g[p],r.x+u.x+this.subNodeOffsetX.get(g[p])||0,r.y+u.y+this.subNodeOffsetY.get(g[p])||0,_?this.module.animations.getCloseRadius(g[p]):this.openRadius.get(g[p])),this.collapsedGroups.delete(g[p]);const x=this.module.getSubNodes(a.get(p));x.size&&i.push({subNodes:x,isClosed:_,wasCollapsed:y,offset:{x:u.x+this.subNodeOffsetX.get(g[p])||0,y:u.y+this.subNodeOffsetY.get(g[p])||0}})}}const o=this.module.getMetaNode(e);o&&this.openGroups.has(o._index)&&this.layoutController.shouldRelayout.add(o._index),s.setXYR(e._index,r.x,r.y,n?0:this.openRadius.get(e._index))}getOffset(e){return this.collapsedGroups.has(e)&&this.subNodeOffsetX.has(e)?{x:this.subNodeOffsetX.get(e),y:this.subNodeOffsetY.get(e)}:{x:0,y:0}}restorePositions(e,t){const n=e.getPosition(),s=(t=t.filter(o=>!o.isVirtual()))._indexes,r=this.getOffset(e._index),i=[];for(let o=0;o<s.length;o++)i.push({x:r.x+n.x+this.subNodeOffsetX.get(s[o])||0,y:r.x+n.y+this.subNodeOffsetY.get(s[o])||0});t.setAttributes(i,0)}animateChildren(e,t){const n=[{parent:e,position:t}];for(;n.length;){const{parent:s,position:r}=n.shift();if(!s.isNode)continue;const i=this.module.getSubNodes(s);i.size&&i.forEach(o=>{const a=this.subNodeOffsetX.get(o._index)||0,u=this.subNodeOffsetY.get(o._index)||0,d={x:r.x+a,y:r.y+u};this.module.animations.setXY(o._index,d.x,d.y),n.push({parent:o,position:d})})}}addOpenGroup(e){this.openGroups.add(e._index),this.closeGroups.delete(e._index)}isOpen(e){return this.openGroups.has(e._index)}isClose(e){return this.closeGroups.has(e._index)}setPadding(e,t){const n=new Set,s=isNaN(+t),r=t;return e.forEach(i=>{const o=s?r(i):+t;this.padding.get(i._index)!==o&&n.add(i._index),this.padding.set(i._index,o)}),n}getGroupXYR(e,t,n,s){let r,i,o;const a=this.module.animations,u=this.ogma.geo.enabled();if(r=new Array(t.size).fill(0),i=new Array(t.size).fill(0),o=new Array(t.size).fill(0),u){const _=t.getData(this.ogma.modules.geo.latitudePath),y=t.getData(this.ogma.modules.geo.longitudePath);r=[],i=[],o=[];for(let x=0;x<_.length;x++){const{x:E,y:b}=this.ogma.geo.getMap().project({lat:_[x],lng:y[x]},Mc);r.push(E),i.push(b),o.push(2**Mc*this.geoRadius.get(t._indexes[x])||10)}}else{const _=this.ogma.modules.graphics.getAttributesManager()._layerController.nodes._currentFlexArrays,y=this.openGroups.has(e._index),x=this.isExpanding.has(e._index),E=y&&!x?_.radius:a.getInputFlexArrays().radius;for(let b=0;b<t.size;b++)r[b]=_.x.get(t._indexes[b]),i[b]=_.y.get(t._indexes[b]),o[b]=E.get(t._indexes[b])}if(n&&s&&n.isNode){const _=n._indexes,y=new Map,x=new Map,E=new Map;for(let S=0;S<_.length;S++){const A=Array.isArray(s)?s[S]:s;!isNaN(A.x)&&y.set(_[S],A.x),!isNaN(A.y)&&x.set(_[S],A.y),!isNaN(A.radius)&&E.set(_[S],A.radius)}const b=t._indexes;for(let S=0;S<b.length;S++)y.has(b[S])&&(r[S]=y.get(b[S])),x.has(b[S])&&(i[S]=x.get(b[S])),E.has(b[S])&&(o[S]=E.get(b[S]))}const d=t._indexes;for(let _=0;_<d.length;_++)this.openRadius.has(d[_])&&(o[_]=this.openRadius.get(d[_]));if(!u)for(let _=0;_<d.length;_++)a.xs.get(d[_])!==void 0&&(r[_]=a.xs.get(d[_])),a.ys.get(d[_])!==void 0&&(i[_]=a.ys.get(d[_])),a.rs.get(d[_])!==void 0&&(o[_]=a.rs.get(d[_]));let c=0,g=0,f=0;const p=Nx.algorithms.minDisk(r,i,o);if(c=p[0],g=p[1],f=p[2],f+=this.padding.get(e._index)||0,u){const{lat:_,lng:y}=this.ogma.geo.getMap().unproject({x:c,y:g},Mc);c=y,g=_,f/=2**Mc,this.geoRadius.set(e._index,f),f*=2**this.ogma.geo.getZoom()}else this.openRadius.set(e._index,f),t.forEach((_,y)=>{this.subNodeOffsetX.set(_._index,r[y]-c),this.subNodeOffsetY.set(_._index,i[y]-g)});return{x:c,y:g,radius:f,isGeo:u}}async onAfterLayouts(){const e=this.module.animations,t=this.module.getList().filter(i=>i.getName()===Os.NodeGrouping&&i.isEnabled()),n=[];let s=!1;for(let i=t.length-1;i>=0;i--)t[i].getContext().metaNodes.forEach(o=>{if(o.getMetaNode())return;s||(s=this.hasUpdated.has(o._index)||this.layoutController.relayouted.has(o._index)||this.layoutController.shouldRelayout.has(o._index));const a=!this.collapsedGroups.has(o._index)&&!this.closeGroups.has(o._index);n.push({group:o,collapsed:!a})});if(s||this.shouldRunGroupUpdate){this.shouldRunGroupUpdate=!1;const i=this.ogma.getNodes().filter(u=>!this.module.nodeToMeta.has(u._index)),o=new Array(i.size);for(let u=0;u<i.size;u++)o[u]=this.openRadius.get(i._indexes[u])||this.module.animations.getCloseRadius(i._indexes[u])||0;const a=await this.onGroupsUpdate(i,o);this.module.animations.handleGlobalLayout(a&&Array.isArray(a)?a:null,i._indexes)}const r=new Set;for(;n.length;){const{group:i,collapsed:o}=n.shift();if(r.has(i._index))continue;r.add(i._index);const a=this.module.getSubNodes(i),u=a._indexes,d=e.xs.get(i._index),c=e.ys.get(i._index);if(d!==void 0&&c!==void 0){if(o){e.deleteOpenRadius(i._index);for(let g=0;g<u.length;g++)e.setXY(u[g],d,c)}else for(let g=0;g<u.length;g++)e.setXY(u[g],d+this.subNodeOffsetX.get(u[g])||0,c+this.subNodeOffsetY.get(u[g])||0);for(let g=0;g<u.length;g++)this.module.isVirtual(u[g],!0)&&n.push({group:a.get(g),collapsed:this.collapsedGroups.has(u[g])||this.closeGroups.has(u[g])||o})}}this.hasUpdated.clear(),this.layoutController.clear(),this.isExpanding.clear()}cleanup(e,t,n){let s=e._indexes;for(let r=0;r<s.length;r++)this.padding.delete(s[r]),this.openGroups.delete(s[r]),this.closeGroups.delete(s[r]),this.nodeLayer.delete(s[r]);for(let r=0;r<t.size;r++)this.edgeLayer.delete(t._indexes[r]);if(n){s=n._indexes;for(let r=0;r<s.length;r++)this.subNodeOffsetX.delete(s[r]),this.subNodeOffsetY.delete(s[r])}}getPositions(e,t){const{x:n,y:s}=e.getPosition();return t.map(r=>({x:n+(this.subNodeOffsetX.get(r._index)||0),y:s+(this.subNodeOffsetY.get(r._index)||0)}))}hideSubNodes(e){const t=[e];for(;t.length;){const n=t.pop();n.setVisible(!1);for(let s=0;s<n._indexes.length;s++)this.collapsedGroups.add(n._indexes[s]),this.openGroups.has(n._indexes[s])&&t.push(this.module.getSubNodes(n.get(s)))}}onRemove(e,t){if(!t)return;const n=[],s=new Set;for(let r=0;r<e.length;r++){const i=this.module.nodeToMeta.get(e[r]);i&&this.openGroups.has(i._index)&&(this.layoutController.shouldRelayout.add(i._index),n.push(i._index))}for(;n.length;){const r=n.shift();if(s.has(r))continue;s.add(r);const i=this.module.nodeToMeta.get(r);i&&this.openGroups.has(i._index)&&(this.layoutController.shouldRelayout.add(i._index),n.push(i._index))}}triggerGroupsUpdate(){this.shouldRunGroupUpdate=!0}layoutGroups(e,t,n=!1){return this.runningLayouts=!0,this.layoutController.layoutGroups(e,t,n).finally(()=>{this.runningLayouts=!1})}_onToggleGeo(){this.geoRadius.clear();const e=this.module.getList().find(n=>n.getName()===Os.NodeGrouping);if(!e)return;const t=Array.from(this.openGroups.keys());for(let n=0;n<t.length;n++)this.layoutController.shouldRelayout.add(t[n]);e.refresh()}startRefresh(){this.alreadyGrouped.clear()}clear(){this.subNodeOffsetX.clear(),this.subNodeOffsetY.clear(),this.openRadius.clear(),this.isExpanding.clear(),this.layoutController.clear(),this.alreadyGrouped.clear(),this.openGroups.clear(),this.closeGroups.clear(),this.nodeLayer.clear(),this.edgeLayer.clear(),this.padding.clear(),this.geoRadius.clear(),this.collapsedGroups.clear(),this.hasUpdated.clear()}destroy(){this.destroyed||(this.destroyed=!0,this.ogma.events.off(this.onSetMultipleAttributes))}},S4=class{constructor(e){this.ogma=e}save(){this.selectedNodes=this.ogma.getSelectedNodes(),this.selectedEdges=this.ogma.getSelectedEdges(),this.ogma.modules.selection.disableEvents&&this.ogma.modules.selection.disableEvents()}restore(){const e=this.selectedNodes.filter(n=>!this.ogma.getNode(n.getId())||!n.isVisible()),t=this.selectedEdges.filter(n=>!this.ogma.getEdge(n.getId())||!n.isVisible());e.size&&this.ogma.modules.events.fire("nodesUnselected",{nodes:e}),t.size&&this.ogma.modules.events.fire("edgesUnselected",{edges:t}),this.selectedNodes.filter(n=>!!this.ogma.getNode(n.getId())&&!n.isSelected()).setSelected(!0),this.selectedEdges.filter(n=>this.ogma.getEdge(n.getId())&&!n.isSelected()).setSelected(!0),this.ogma.modules.selection.enableEvents&&this.ogma.modules.selection.enableEvents()}cleanup(){this.selectedNodes=void 0,this.selectedEdges=void 0,this.ogma.modules.selection.enableEvents&&this.ogma.modules.selection.enableEvents()}},A4={setData:!1,addElement:!0,removeElement:!0,setOptions:!1,refresh:!1},w4=class K_{constructor(){this.prev={},this.next={},this.prevorder=[],this.nextorder=[],this.shouldAnimate=!1,this.minRefreshIndex=0}addTransformation(t,n){this.next[t]=n,this.nextorder.push(t)}removeTransformation(t){delete this.next[t]}setIndex(t,n){const s=this.nextorder.indexOf(t);this.nextorder.splice(s,1),this.nextorder.splice(n,0,t),this.minRefreshIndex=Math.min(this.minRefreshIndex,s,n)}setEnabled(t,n){this.next[t]=n}isEnabled(t){return this.prev[t]||!1}static getDiff(t,n){const s=new Map;for(const r in t)n[r]!==void 0?n[r]!==t[r]&&s.set(+r,{shouldDo:n[r],shouldUndo:t[r]}):s.set(+r,{shouldDo:!1,shouldUndo:t[r],shouldCleanup:!0});for(const r in n)t[r]===void 0&&n[r]===!0&&s.set(+r,{shouldDo:!0,shouldUndo:!1});return s}getFirstChange(t){const{nextorder:n}=this;let s=n.length;for(let r=0;r<n.length;r++){const i=t.get(n[r]);if(i&&(i.shouldUndo||i.shouldDo)){s=r;break}}return s}refreshFrom(t,n){const{nextorder:s}=this;for(let r=n;r<this.nextorder.length;r++)t.set(s[r],{shouldUndo:this.prev[s[r]],shouldDo:this.prev[s[r]],...t.get(s[r])||{}});return t}isDirty(){const t=K_.getDiff(this.prev,this.next),n=Math.min(this.minRefreshIndex,this.getFirstChange(t));return(t.size>0||n<this.nextorder.length)&&{reason:t.size>0?"diff":"refresh",index:n}}invalidateFrom(t,n){this.shouldAnimate||(this.shouldAnimate=A4[n]),this.minRefreshIndex=Math.min(this.minRefreshIndex,t)}step(){const t=K_.getDiff(this.prev,this.next);this.prev={...this.next};const n=Math.min(this.minRefreshIndex,this.getFirstChange(t)),s=this.nextorder.reduce((o,a,u)=>o.set(a,u),new Map),r=this.prevorder.reduce((o,a,u)=>o.set(a,u),new Map);this.nextorder=this.nextorder.filter(o=>this.prev[o]!==void 0),this.prevorder=[...this.nextorder],this.minRefreshIndex=this.nextorder.length;const i=this.shouldAnimate;return this.shouldAnimate=!1,{diff:this.refreshFrom(t,n),nextorder:s,prevorder:r,shouldAnimate:i}}done(){}},T4=class{constructor(e){this.transformations=[],this.nodeToTransformation=new Map,this.edgeToTransformation=new Map,this.nodeVirtual=new Set,this.edgeVirtual=new Set,this.nodeToMeta=new Map,this.edgeToMeta=new Map,this.metaToNodes=new Map,this.metaToEdges=new Map,this._onDestroy=()=>{this.destroy(),this.ogma.events.off(this._onFrame)},this._onFrame=()=>this.refresh(),this._onAddElements=({nodes:t,edges:n,virtual:s})=>{if(s){if(t)for(let r=0;r<t.size;r++)this.nodeVirtual.add(t._indexes[r]);if(n)for(let r=0;r<n.size;r++)this.edgeVirtual.add(n._indexes[r])}else this.state.invalidateFrom(0,"addElement"),this.invalidate()},this._onSetData=({elements:t,virtual:n})=>{if(n)return;const{isNode:s,_indexes:r}=t;let i=1/0;for(const o of r){const a=this.getTransformation(o,s);if(!a){i=0;break}i=Math.min(i,a.getIndex())}return this.state.invalidateFrom(i,"setData"),this.invalidate(),i},this._onRequestElementsToDelete=t=>{const{elementsToRemove:n}=t,s=n.isNode,r=n._indexes,i=this.getLeafElements(r,s);t.elementsToRemove=s?this.ogma.nodeList(i):this.ogma.edgeList(i)},this._onAfterRemoveElements=({nodes:t,edges:n})=>{if(!this.ogma.isDestroyed()){if(t)for(let s=0;s<t.size;s++)this.nodeVirtual.delete(t._indexes[s]);if(n)for(let s=0;s<n.size;s++)this.edgeVirtual.delete(n._indexes[s])}},this._onRemoveElements=({nodes:t,edges:n,virtual:s})=>{s||this.ogma.isDestroyed()||this._refreshPromise.then(()=>{const r=!!t,i=r?t._indexes:n._indexes,o=new Set(i);this.transformations.forEach(a=>a.onRemove(o,r)),this.groupController.onRemove(i,r),this.drilldownController.onRemove(o,r),this.nodeToMeta.clear(),this.edgeToMeta.clear(),this.metaToNodes.clear(),this.metaToEdges.clear(),this.nodeToTransformation.clear(),this.edgeToTransformation.clear(),this.state.invalidateFrom(0,"removeElement"),this.invalidate()})},this._onClearGraph=()=>{this.transformations.forEach(t=>{t.cleanup()}),this.groupController.clear(),this.nodeToMeta.clear(),this.edgeToMeta.clear(),this.metaToNodes.clear(),this.metaToEdges.clear(),this.nodeToTransformation.clear(),this.edgeToTransformation.clear(),this.state.invalidateFrom(0,"removeElement"),this.invalidate()},this.ogma=e,this.state=new w4,this.animations=new g4(e),this._shouldRefresh=!1,this._refreshing=!1,this.isDestroyed=!1,this.isPaused=!1,this.selection=new S4(e),this._refreshPromise=Promise.resolve(),this.groupController=new E4(e,this),this.drilldownController=new v4(this),this.ogma.events.on("frame",this._onFrame).on("setData",this._onSetData).on(["addNodes","addEdges"],this._onAddElements).on(["removeNodes","removeEdges"],this._onRemoveElements).on("clearGraph",this._onClearGraph).on(["afterRemoveNodes","afterRemoveEdges"],this._onAfterRemoveElements).on("requestElementsToDelete",this._onRequestElementsToDelete).on("destroy",this._onDestroy)}addTransformation(e,t=!0){this.state.addTransformation(e.getId(),t),this.transformations.push(e),this.invalidate()}removeTransformation(e){const t=this.transformations.indexOf(e);t!==-1&&this.transformations.splice(t,1),this.invalidate()}async step(e=0,t={fireEnabled:[],fireDisabled:[],fireRefresh:[],fireDestroy:[],fireSetIndex:[]}){var n;if(e>5)throw new Error("Ogma transformations: Transformations refresh in loop");const{diff:s,prevorder:r,nextorder:i}=this.state.step(),{fireEnabled:o,fireDisabled:a,fireRefresh:u,fireDestroy:d,fireSetIndex:c}=t,g=[],f=[],p=[];this.groupController.startRefresh();for(const y of this.transformations){const x=y.getId();if(!s.has(x))continue;const{shouldDo:E,shouldUndo:b,shouldCleanup:S}=s.get(x);E&&!b?o.push(y):b&&!E?a.push(y):E&&b&&u.push(y),r.has(x)&&r.get(x)!==i.get(x)&&c.push(y),b&&g.push(y),E&&f.push(y),S&&(d.push(y),p.push(y))}let _=0;g.sort((y,x)=>r.get(x.getId())-r.get(y.getId())||0);for(const y of g){const x=!((n=s.get(y.getId()))!=null&&n.shouldDo);x&&(_=this.animations.getMaxAnimation(_,y.getAnimation())),await y.undo(x)}f.sort((y,x)=>i.get(y.getId())-i.get(x.getId())||0);for(let y=0;y<f.length;y++){const x=f[y],E=y===f.length-1;E&&(_=this.animations.getMaxAnimation(_,x.getAnimation())),await x.run(E)}for(const y of p)await y.cleanup();if(await this.groupController.onAfterLayouts(),await this.animations.apply(_),!this.isDestroyed)return this.state.isDirty()?this.step(e+1,t):t}refresh(){!this._shouldRefresh||this._refreshing||this.isDestroyed||this.isPaused||(this._shouldRefresh=!1,this._refreshing=!0,this._refreshPromise=this._refreshPromise.then(()=>(this.animations.enable(),this.selection.save(),this.step().then(e=>{this.animations.disable(),this._refreshing=!1;const{fireEnabled:t,fireDisabled:n,fireRefresh:s,fireDestroy:r,fireSetIndex:i}=e,o=this.ogma.modules.events;n.reverse().forEach(a=>o.fire("transformationDisabled",{target:a})),t.forEach(a=>o.fire("transformationEnabled",{target:a})),i.forEach(a=>o.fire("transformationSetIndex",{target:a})),s.forEach(a=>o.fire("transformationRefresh",{target:a})),r.forEach(a=>o.fire("transformationDestroyed",{target:a}))}).finally(()=>{this.selection.restore(),this.selection.cleanup(),this.animations.disable()}))).catch(e=>{const t=this.state.isDirty();if(!t)throw new Error(`Ogma transformations, refresh failed.
${e.stack}`);const n=t.reason==="diff"?"You are constantly adding/removing/changing index of a transformation":"You are constantly adding/removing/updating nodes or edges while transformations refresh";throw new Error(`Ogma transformations, refresh failed.
${n}`)}).catch(e=>{if(!this.onRefreshError)throw e;this.onRefreshError(e)}).finally(()=>{}))}enable(e){return this.state.setEnabled(e.getId(),!0),this.invalidate(),this.afterNextUpdate()}disable(e){return this.state.setEnabled(e.getId(),!1),this.invalidate(),this.afterNextUpdate()}remove(e){return this.disable(e),this.state.removeTransformation(e.getId()),this.afterNextUpdate().then(()=>{this.transformations.splice(this.getIndex(e),1)})}isEnabled(e){return this.state.isEnabled(e.getId())}getList(){return this.transformations.slice()}getIndex(e){for(let t=0;t<this.transformations.length;t++)if(this.transformations[t]===e)return t;return-1}setIndex(e,t){const n=this.getIndex(e);this.state.setIndex(e.getId(),t),this.transformations.splice(n,1),this.transformations.splice(t,0,e),this.invalidate()}setOptions(e){this.state.invalidateFrom(this.getIndex(e),"setOptions"),this.invalidate()}refreshTransformation(e){this.state.invalidateFrom(this.getIndex(e),"refresh"),this.invalidate()}clear(){return this.transformations.forEach(e=>e.destroy(0)),this.invalidate(),this.afterNextUpdate()}destroy(){this.transformations.forEach(e=>e.destroy(0)),this.groupController.destroy(),this._refreshPromise=Promise.resolve(),this.isDestroyed=!0}invalidate(){this._refreshing||this.ogma.isDestroyed()||(this._shouldRefresh=!0,this.ogma.modules.dom.refresh())}afterNextUpdate(){return this.ogma.view.afterNextFrame().then(()=>this._refreshPromise)}getTransformation(e,t){return t?this.nodeToTransformation.get(e):this.edgeToTransformation.get(e)}setTransformation(e,t,n){n?this.nodeToTransformation.set(e,t):this.edgeToTransformation.set(e,t)}deleteTransformation(e){const t=e.isNode?this.nodeToTransformation:this.edgeToTransformation,n=e._indexes;for(const s of n)t.delete(s)}setMetaNode(e,t){this.nodeToMeta.set(e,t)}setSubNodes(e,t){this.metaToNodes.set(e,t)}removeMetaNodes(e){const t=e._indexes;for(const n of t){const s=this.metaToNodes.get(n);s&&s.forEach(r=>this.nodeToMeta.delete(r._index)),this.nodeToTransformation.delete(n),this.metaToNodes.delete(n)}}removeMetaEdges(e){const t=e._indexes;for(const n of t){const s=this.metaToEdges.get(n);s&&s.forEach(r=>this.edgeToMeta.delete(r._index)),this.edgeToTransformation.delete(n),this.metaToEdges.delete(n)}}clearSubNodes(e){this.metaToNodes.delete(e)}clearMetaNode(e){this.nodeToMeta.delete(e)}setMetaEdge(e,t){this.edgeToMeta.set(e,t)}setSubEdges(e,t){this.metaToEdges.set(e,t)}clearSubEdges(e){this.metaToEdges.delete(e)}clearMetaEdge(e){this.edgeToMeta.delete(e)}getMetaNode(e){return this.nodeToMeta.get(e._index)||null}getMetaEdge(e){return this.edgeToMeta.get(e._index)||null}getLeafElements(e,t){const n=[e],s=t?this.metaToNodes:this.metaToEdges,r=[];for(;n.length;){const i=n.pop();for(let o=0;o<i.length;o++){r.push(i[o]);const a=s.get(i[o]);a&&n.push(a._indexes)}}return r}getSubElements(e){const t=e.isNode?this.metaToNodes:this.metaToEdges,n=e.toList()._indexes;let s=e.isNode?this.ogma.nodeList():this.ogma.edgeList();for(let r=0;r<n.length;r++){const i=t.get(n[r]);i&&(s=s.concat(i))}return s}getSubNodes(e){return this.getSubElements(e)}getSubEdges(e){return this.getSubElements(e)}getById(e){return this.transformations.find(t=>t.getId()===e)}isIntraEdge(e){const t=e.getSource()._index;return this.nodeToMeta.has(t)&&this.nodeToMeta.get(t)===this.nodeToMeta.get(e.getTarget()._index)}isVirtual(e,t){return t?this.nodeVirtual.has(e):this.edgeVirtual.has(e)}isRefreshing(){return this._refreshing}pause(){this.isPaused=!0}resume(){this.isPaused=!1,this.refresh()}},Hs="_transparent",Ul=e=>!0,C4=()=>{};function JC(e){if(e.keys)return Array.from(e.keys());const t=[];return e.forEach((n,s)=>t.push(s)),t}function kg(e){if(e.values)return Array.from(e.values());const t=[];return e.forEach(n=>t.push(n)),t}function KS(e){return!(!e||e.constructor!==Object&&e.constructor)}var fa=(...e)=>{const t={};for(let n=0;n<e.length;n++){const s=e[n];for(const r in s)s.hasOwnProperty(r)&&(Array.isArray(t[r])&&Array.isArray(s[r])?t[r]=Array.from(new Set(t[r].concat(s[r]))):KS(t[r])&&KS(s[r])?t[r]=fa(t[r],s[r]):t[r]=s[r])}return t};function L4(e){return Array.isArray(e)?e:[e]}var Q_=()=>!0,eL=()=>!1,N4=()=>null,I4=class extends zo{constructor(e){super(e),this.nodeSelector=e.criteria||Ul}setOptions(e){return this.nodeSelector=e.criteria||this.nodeSelector,super.setOptions(e)}getName(){return Os.NodeFilter}run(){const e=this.nodeSelector,t=this.ogma.getNodes().filter(a=>!e||!e(a)),n=t.getAdjacentEdges();this.module.animations.hideNodes(t._indexes),this.module.animations.hideEdges(n._indexes),t.setVisible(!1),n.setVisible(!1);const s=t.subtract(this.context.hiddenNodes),r=n.subtract(this.context.hiddenEdges),i=this.context.hiddenNodes.subtract(t),o=this.context.hiddenEdges.subtract(n);return this.module.animations.pushBefore(()=>{i.setVisible(!0),i.setVisible(!0),r.setVisible(!0),s.setVisible(!0),i.addClass(Hs),o.addClass(Hs)}),this.module.animations.push(()=>Promise.all([o.removeClass(Hs,this.animation),i.removeClass(Hs,this.animation),s.addClass(Hs,this.animation),r.addClass(Hs,this.animation)])),this.context={...this.context,hiddenNodes:t,hiddenEdges:n},Promise.resolve()}undo(e=!0){const{hiddenNodes:t,hiddenEdges:n}=this.context,s=e?this.animation:0;return t.setExcluded(!1),n.setExcluded(!1),e&&(t.addClass(Hs),n.addClass(Hs),this.module.animations.push(()=>Promise.all([t.removeClass(Hs,s),n.removeClass(Hs,s)])),this.context.hiddenNodes=this.ogma.nodeList(),this.context.hiddenEdges=this.ogma.edgeList()),Promise.resolve()}onRemove(e,t){t?this.context.hiddenNodes=this.context.hiddenNodes.filter(n=>!e.has(n._index)):this.context.hiddenEdges=this.context.hiddenEdges.filter(n=>!e.has(n._index))}resetContext(){this.context={...this.context,hiddenEdges:this.ogma.edgeList(),hiddenNodes:this.ogma.nodeList()}}},k4=class extends zo{constructor(e){super(e),this.edgeSelector=e.criteria||Ul}setOptions(e){return this.edgeSelector=e.criteria||this.edgeSelector,super.setOptions(e)}getName(){return Os.EdgeFilter}run(){const e=this.edgeSelector,t=this.ogma.getEdges().filter(i=>!e||!e(i)),n=this.module.animations;t.setVisible(!1);const s=t.subtract(this.context.hiddenEdges),r=this.context.hiddenEdges.subtract(t);return this.module.animations.pushBefore(()=>{s.setVisible(!0),r.setVisible(!0),r.addClass(Hs)}),n.hideEdges(t._indexes),n.push(()=>Promise.all([r.removeClass(Hs,this.animation),s.addClass(Hs,this.animation)])),this.context={...this.context,hiddenEdges:t},Promise.resolve()}undo(e=!0){super.undo(e);const{hiddenEdges:t}=this.context,n=e?this.animation:0;return t.setExcluded(!1),e&&(t.addClass(Hs),this.module.animations.push(()=>Promise.all([t.removeClass(Hs,n)])),this.context.hiddenEdges=this.ogma.edgeList()),Promise.resolve()}onRemove(e,t){t||(this.context.hiddenEdges=this.context.hiddenEdges.filter(n=>!e.has(n._index)))}resetContext(){this.context={...this.context,hiddenEdges:this.ogma.edgeList()}}},ns="_faded",M4=class extends zo{constructor(e){super(e),this.selector=e.selector||eL,this.dataFunction=e.dataFunction||C4}getName(){return Os.NeighborMerging}run(e=!0){const{ogma:t}=this,n=e?this.animation:0,s=t.getNodes().filter(this.selector),r=[],i=new Map;for(let f=0;f<s.size;++f){const p=s.get(f),_=p.getAdjacentEdges(),y=this.dataFunction(p);for(let x=0;x<_.size;++x){const E=_.get(x),b=E.getSource(),S=E.getTarget();if(b!==S&&y!==void 0){const A=b===p?S:b;let C=i.get(A);C||(C=[],i.set(A,C)),C.push(y)}r.push(E)}}const o=t.getEdges(r),a=t.getNodes(JC(i)),u=kg(i),d=a.getData(),c=new Array(a.size);for(let f=0;f<c.length;++f){const p=u[f];let _=d[f];for(let y=0;y<p.length;++y)_=fa(_,p[y]);c[f]=_}const g=this.module.animations;return g.hideNodes(s._indexes),g.hideEdges(o._indexes),g.push(()=>Promise.all([s.addClass(ns,n),o.addClass(ns,n)]).then(()=>{this.ogma.modules.data.setProperty(a,null,c,{dispatch:!0,virtual:!0})})),this.context={...this.context,hiddenNodes:s,hiddenEdges:o,nodesWithDataChange:a,oldDataList:d},Promise.resolve()}resetContext(){super.resetContext(),this.context={...this.context,hiddenNodes:this.ogma.nodeList(),hiddenEdges:this.ogma.edgeList(),nodesWithDataChange:this.ogma.nodeList(),oldDataList:[]}}undo(e=!0){const{hiddenNodes:t,hiddenEdges:n,nodesWithDataChange:s,oldDataList:r}=this.context,i=e?this.animation:0,o=this.module.animations;return this.context.hiddenEdges=this.ogma.edgeList(),this.context.hiddenNodes=this.ogma.nodeList(),this.context.nodesWithDataChange=this.ogma.nodeList(),this.context.oldDataList=[],t.setVisible(!0),n.setVisible(!0),o.pushBefore(()=>{t.addClass(ns),n.addClass(ns)}),o.push(()=>Promise.all([t.removeClass(ns,i),n.removeClass(ns,i)]).then(()=>{this.ogma.modules.data.setProperty(s,null,r,{dispatch:!0,virtual:!0})})),Promise.resolve()}onRemove(e,t){t&&(this.context.hiddenNodes=this.context.hiddenNodes.filter(n=>!e.has(n._index))),this.context.hiddenEdges=this.context.hiddenEdges.filter(n=>!e.has(n._index))}cleanup(){return Promise.resolve()}setOptions(e){return this.selector=e.selector||this.selector,this.dataFunction=e.dataFunction||this.dataFunction,super.setOptions(e)}};function P4(e){return e!=null}var R4=(e,t)=>({source:e.getId(),target:t.getId()}),F4=class extends zo{constructor(e){super(e);const{selector:t=Q_,neighborIdFunction:n=N4,nodeGenerator:s=()=>({}),edgeGenerator:r=R4}=e;this.neighborIdFunction=n,this.selector=t,this.generateIds=i=>this.selector(i)&&this.neighborIdFunction(i)||null,this.nodeGenerator=s,this.edgeGenerator=r}getName(){return Os.NeighborGeneration}run(e=!0){const{ogma:t,id:n}=this,s=e?this.animation:0,r=t.getNodes(),i=new Map;for(let f=0;f<r.size;++f){const p=r.get(f),_=(D4(this.generateIds(p))||[]).filter(P4);if(_)for(const y of _){let x=i.get(y);x||(x=[],i.set(y,x)),x.push(p)}}const o=new Array(i.size),a=[],u=JC(i),d=kg(i).map(f=>t.getNodes(f));for(let f=0;f<o.length;++f){const p=u[f],_=d[f],y=this.nodeGenerator(p,_);y.id=`_gen_${n}_${p}`;const x=f4(_.getPosition());y.attributes=y.attributes||{},y.attributes.x=x.x,y.attributes.y=x.y,o[f]=y}let c,g;return t.addNodes(o.map(f=>({id:f.id,attributes:f.attributes})),{virtual:!0}).then(()=>{c=t.getNodes(o.map(p=>p.id));const f=c._indexes;this.context.virtualNodes&&this.module.removeMetaNodes(this.context.virtualNodes);for(let p=0;p<c.size;p++)this.module.setTransformation(f[p],this,!0),this.module.setSubNodes(f[p],this.ogma.createNodeList());c.replaceOriginalAttributes(o.map(p=>p.attributes),["x","y"]),this.ogma.modules.data.setProperty(c,null,o.map(p=>p.data),{dispatch:!0,virtual:!0});for(let p=0;p<c.size;++p){const _=c.get(p),y=d[p];for(let x=0;x<y.size;++x){const E=y.get(x),b=this.edgeGenerator(E,_);!b.source&&!b.target&&(b.source=E.getId(),b.target=_.getId()),b.id||(b.id=`${b.source}-${b.target}`),a.push(b)}}return t.addEdges(a,{virtual:!0})}).then(()=>{g=t.getEdges(a.map(p=>p.id));const f=g._indexes;this.context.virtualEdges&&this.module.removeMetaEdges(this.context.virtualEdges);for(let p=0;p<g.size;p++)this.module.setTransformation(f[p],this,!1),this.module.setSubEdges(f[p],this.ogma.createEdgeList());this.context={virtualEdges:g,virtualNodes:c},t.removeNodes(this.context.virtualNodes.subtract(c),{virtual:!0}),t.removeEdges(this.context.virtualEdges.subtract(g),{virtual:!0}),c.setVisible(!0),g.setVisible(!0),this.module.animations.pushBefore(()=>{c.addClass(ns),g.addClass(ns)}),this.module.animations.push(()=>Promise.all([c.removeClass(ns,s),g.removeClass(ns,s)]))})}undo(e=!0){const{virtualNodes:t,virtualEdges:n}=this.context;if(!n||!t)return Promise.resolve(this.context);const s=e?this.animation:0,r=this.module.animations;e?(r.hideNodes(t._indexes),r.hideEdges(n._indexes),r.push(()=>Promise.all([t.addClass(ns,s),n.addClass(ns,s)]))):(t.setVisible(!1),n.setVisible(!1))}onRemove(){}cleanup(){const{virtualEdges:e,virtualNodes:t}=this.context;return e&&t&&(this.module.removeMetaNodes(t),this.module.removeMetaEdges(e),this.ogma.removeNodes(t,{virtual:!0}),this.ogma.removeEdges(e,{virtual:!0}),this.context.virtualEdges=this.ogma.edgeList(),this.context.virtualNodes=this.ogma.nodeList()),Promise.resolve()}setOptions(e){const{selector:t,neighborIdFunction:n,nodeGenerator:s,edgeGenerator:r}=e;return this.selector=t||this.selector,this.neighborIdFunction=n||this.neighborIdFunction,this.generateIds=i=>this.selector(i)&&this.neighborIdFunction(i)||null,this.nodeGenerator=s||this.nodeGenerator,this.edgeGenerator=r||this.edgeGenerator,super.setOptions(e)}resetContext(){super.resetContext(),this.context={...this.context,virtualNodes:this.ogma.nodeList(),virtualEdges:this.ogma.edgeList()}}};function D4(e){return Array.isArray(e)?e:e?[e]:null}function O4(e,t){return e.size===t.size&&e.filter(n=>t.includes(n)).size>0}var z4=class extends zo{constructor(e){super(e),this.selector=e.selector||eL,this.edgeGenerator=e.edgeGenerator||(()=>({}))}getName(){return Os.NodeCollapsing}resetContext(){this.context={hiddenNodes:this.ogma.nodeList(),hiddenEdges:this.ogma.edgeList(),virtualEdges:this.ogma.edgeList()}}run(e=!0){const{ogma:t}=this,n=e?this.animation:0,s=t.getNodes().filter(this.selector),r=s.getAdjacentEdges(),i=[],o=s.map(u=>u.getAdjacentNodes().filter(d=>!this.selector(d)));for(let u=0;u<s.size;u++)for(let d=u;d<s.size;d++){const c=s.get(u),g=s.get(d);if(this.ogma.modules.graph.getEdgesBetweenTwoNodes(c,g).size>0&&(o[u].size||o[d].size)&&!O4(o[u],o[d]))throw Error(`addNodeCollapsing: invalid connected nodes [${c.getId()}] and [${g.getId()}] to be collapsed. The addNodeCollapsing function supports only disconnected nodes.`)}const a=new Map;for(let u=0;u<s.size;++u){const d=s.get(u),c=o[u];for(let g=0;g<c.size-1;++g){const f=c.get(g),p=this.ogma.modules.graph.getEdgesBetweenTwoNodes(d,f);if(f!==d)for(let _=g+1;_<c.size;++_){const y=c.get(_),x=this.ogma.modules.graph.getEdgesBetweenTwoNodes(d,y),E=this.edgeGenerator(d,f,y,p,x);if(E){const b=L4(E);for(let S=0;S<b.length;++S)i.push(B4(t,b[S],S,d,f,y,p,x)),a.set(i[i.length-1].id,p.concat(x))}}}}return t.addEdges(i,{virtual:!0}).then(()=>{const u=this.ogma.getEdges(i.map(g=>g.id));this.context.virtualEdges&&this.module.removeMetaEdges(this.context.virtualEdges);const d=u._indexes;for(let g=0;g<u.size;g++){this.module.setTransformation(d[g],this,!1);const f=a.get(u.get(g).getId());this.module.setSubEdges(d[g],f);for(let p=0;p<f.size;p++)this.module.setMetaEdge(f._indexes[p],u.get(g))}t.removeEdges(this.context.virtualEdges.subtract(u),{virtual:!0});const c=this.module.animations;u.setVisible(!0),c.pushBefore(()=>u.addClass(ns)),c.push(()=>Promise.all([u.removeClass(ns,n),s.addClass(ns,n),r.addClass(ns,n)])),c.hideNodes(s._indexes),c.hideEdges(r._indexes),this.context={hiddenEdges:r,hiddenNodes:s,virtualEdges:u}})}undo(e=!0){const{hiddenNodes:t,hiddenEdges:n,virtualEdges:s}=this.context,r=e?this.animation:0,i=this.module.animations;return t.setVisible(!0),n.setVisible(!0),e?(i.hideEdges(s._indexes),i.pushBefore(()=>Promise.all([t.addClass(ns),n.addClass(ns)])),i.push(()=>Promise.all([s.addClass(ns,r),t.removeClass(ns,r),n.removeClass(ns,r)]))):s.setVisible(!1),Promise.resolve()}cleanup(){const e=this.context.virtualEdges||this.ogma.createEdgeList();return this.module.removeMetaEdges(e),this.ogma.removeEdges(e,{virtual:!0}).then(()=>{this.resetContext()})}onRemove(e,t){t&&(this.context.hiddenNodes=this.context.hiddenNodes.filter(n=>!e.has(n._index))),this.context.hiddenEdges=this.context.hiddenEdges.filter(n=>!e.has(n._index))}setOptions(e){return this.selector=e.selector||this.selector,this.edgeGenerator=e.edgeGenerator||this.edgeGenerator,super.setOptions(e)}};function B4(e,t,n,s,r,i,o,a){let u,d;if(t.source!==void 0&&(u=e.getNode(t.source),u!==r&&u!==i))throw new Error([`addNodeCollapsing: edge generator produced RawEdge with invalid source [${t.source}]`,`expected to be [${r.getId()}] or [${i.getId()}]`].join("; "));if(t.target!==void 0&&(d=e.getNode(t.target),d!==r&&d!==i))throw new Error([`addNodeCollapsing: edge generator produced RawEdge with invalid target [${t.target}]`,`expected to be [${r.getId()}] or [${i.getId()}]`].join("; "));if(u&&d&&u===d)throw new Error(`addNodeCollapsing: edge generator produced RawEdge with same source and target [${u.getId()}]`);if(u&&!d)d=u===r?i:r;else if(d&&!u)u=d===r?i:r;else if(!u&&!d){let c=!0;for(let g=0;g<o.size;++g)o.get(g).getSource()===r&&(c=!1);for(let g=0;g<a.size;++g)a.get(g).getTarget()===i&&(c=!1);c?(u=i,d=r):(u=r,d=i)}return u&&d?{...t,id:`_gen_${s.getId()}_${u.getId()}_${d.getId()}_${n}`,source:u.getId(),target:d.getId()}:{}}var U4=class extends zo{constructor(e){super(e),this.nodeSelector=e.nodeSelector||Q_,this.edgeSelector=e.edgeSelector||Q_,this.nodeDataFunction=e.nodeDataFunction||null,this.edgeDataFunction=e.edgeDataFunction||null}getName(){return Os.VirtualProperties}resetContext(){this.context={nodes:this.ogma.nodeList(),oldNodesData:[],edges:this.ogma.edgeList(),oldEdgesData:[]}}run(){const{ogma:e,context:t}=this;return this.nodeDataFunction&&(t.nodes=e.getNodes().filter(this.nodeSelector),t.oldNodesData=QS(t.nodes,this.nodeDataFunction,this.ogma)),this.edgeDataFunction&&(t.edges=e.getEdges().filter(this.edgeSelector),t.oldEdgesData=QS(t.edges,this.edgeDataFunction,this.ogma)),Promise.resolve()}undo(){const{nodes:e,oldNodesData:t,edges:n,oldEdgesData:s}=this.context,r=this.ogma.modules.data;return e&&r.setProperty(e,null,t,{dispatch:!0,virtual:!0}),n&&r.setProperty(n,null,s,{dispatch:!0,virtual:!0}),Promise.resolve()}onRemove(e,t){t&&(this.context.nodes=this.context.nodes.filter(n=>!e.has(n._index))),this.context.edges=this.context.edges.filter(n=>!e.has(n._index))}cleanup(){return this.resetContext(),Promise.resolve()}setOptions(e){return this.nodeSelector=e.nodeSelector||this.nodeSelector,this.edgeSelector=e.edgeSelector||this.edgeSelector,this.nodeDataFunction=e.nodeDataFunction||this.nodeDataFunction,this.edgeDataFunction=e.edgeDataFunction||this.edgeDataFunction,super.setOptions(e)}};function QS(e,t,n){const s=[],r=[];for(let i=0;i<e.size;++i){const o=e.get(i),a=o.getData(),u=t(o);r.push(fa(a,u)),s.push(a)}return n.modules.data.setProperty(e,null,r,{dispatch:!0,virtual:!0}),s}var Gl=()=>"";function wd(){return{}}var tL=class extends zo{constructor(e){super(e),this.nodeSelector=e.nodeSelector||Ul,this.nodeGroupIdFunction=e.nodeGroupIdFunction||Gl,this.nodeGenerator=e.nodeGenerator||wd,this.edgeSelector=e.edgeSelector||Ul,this.edgeGroupIdFunction=e.edgeGroupIdFunction||Gl,this.edgeGenerator=e.edgeGenerator||wd,this.separateEdgesByDirection=e.separateEdgesByDirection!==void 0&&e.separateEdgesByDirection,this.groupSelfLoopEdges=!!e.groupSelfLoopEdges,this.groupEdges=e.groupEdges===void 0||e.groupEdges,this.ogma.events.on("updateNodeData",({changes:t})=>this.checkChanges(t,!0)).on("updateEdgeData",({changes:t})=>this.checkChanges(t,!1))}computeNodeGroupId(e){if(this.nodeGroupIdFunction){if(!this.nodeSelector(e)||this.module.groupController.alreadyGrouped.has(e._index)||this.module.animations.hiddenNodes.has(e._index))return;const t=this.nodeGroupIdFunction(e);return t===void 0?void 0:t}}computeEdgeGroupId(e){if(this.edgeGroupIdFunction)return this.edgeSelector(e)&&!this.module.animations.hiddenEdges.has(e._index)?this.edgeGroupIdFunction(e):void 0}addMetaNodes(){const e=this.id,t=this.ogma,n=t.getNodes(),s=new Map;for(let d=0;d<n.size;++d){const c=n.get(d),g=this.computeNodeGroupId(c);if(g===void 0)continue;let f=s.get(g);f||(f={id:g,nodes:[]},s.set(g,f)),f.nodes.push(c)}const r=Array.from(s.values()),i=r.map(({nodes:d})=>t.getNodes(d)),o=[],a=[],{nodeDataUpdates:u}=this.context;for(let d=0;d<r.length;++d){const c=r[d].id,g=i[d],f=this.nodeGenerator(g,c,this);f?(f.id===void 0&&(f.id=Ig(c,e)),a.push(f.id),o.push(f)):(r.splice(d,1),i.splice(d,1),d--)}return t.addNodes(o.map(({id:d})=>({id:d})),{virtual:!0}).then(d=>{const c=t.getNodes(a);t.modules.individualAttributes.replaceOriginalAttributes(c,o.map(({attributes:p})=>p));const g=c.getData();for(let p=0;p<g.length;p++){const _=g[p],y=o[p];g[p]=fa(fa(_,y.data),u.get(c._indexes[p]))}t.modules.data.setProperty(c,null,g,{dispatch:!0,virtual:!0}),c.setVisible(!0);const f=c._indexes;this.context.metaNodes&&this.module.removeMetaNodes(this.context.metaNodes);for(let p=0;p<f.length;p++){const _=f[p],y=i[p];this.module.setSubNodes(_,y),this.module.setTransformation(_,this,!0);for(let x=0;x<y._indexes.length;x++)this.module.groupController.alreadyGrouped.add(y._indexes[x]),this.module.setMetaNode(y._indexes[x],c.get(p))}return{metaNodes:c,newNodes:d}})}addMetaEdges(e){const t=this.id,n=this.ogma;let s,r=!1;e?(s=this.module.getSubNodes(e).getAdjacentElements({bothExtremities:!1}).edges,r=!0):s=n.getEdges();const i=new Map,o=this.ogma.modules.graphics.getAttributesManager().getUsedEdgeAttributes().filter(p=>p!=="curvature"),a=new Map;for(let p=0;p<s.size;++p){const _=s.get(p),y=this.computeEdgeGroupId(_);if(y==null)continue;let x=_.getSource(),E=_.getTarget();if(r){let A=this.module.nodeToMeta.get(x._index);A&&A.getTransformation().getId()!==this.getId()&&(A=x);let C=this.module.nodeToMeta.get(E._index);if(C&&C.getTransformation().getId()!==this.getId()&&(C=E),x=A||x,E=C||E,x&&x===E){a.has(x._index)?a.get(x._index).push(_._index):a.set(x._index,[_._index]);continue}}const b=this.groupEdges?_4(y,x.getId(),E.getId(),this.separateEdgesByDirection):`${_.getId()}:${x.getId()}->${E.getId()}`;let S=i.get(b);S||(S={id:b,source:x,target:E,edges:[]},i.set(b,S)),S.edges.push(_)}const u=Array.from(i.values()),d=u.map(({edges:p})=>n.getEdges(p)),c=[],{edgeDataUpdates:g}=this.context,f=[];for(let p=0;p<u.length;++p){const _=u[p],y=_.id,x=d[p],E=this.groupEdges?this.edgeGenerator(x,y,this):p4(x,o);if(E){if(E.id===null)throw Error(`The id ${E.id} returned by the edgeGenerator function is not unique.`);E.id===void 0&&(E.id=Ig(y,t)),f.push(E.id),E.source=_.source.getId(),E.target=_.target.getId(),c.push(E)}}return n.addEdges(m4(c),{virtual:!0}).then(()=>{const p=n.getEdges(f);p.setVisible(!1),n.modules.individualAttributes.replaceOriginalAttributes(p,c.map(x=>x.attributes));const _=p.getData();for(let x=0;x<_.length;x++){const E=c[x],b=_[x];_[x]=fa(fa(b,E.data),g.get(p._indexes[x]))}n.modules.data.setProperty(p,null,_,{dispatch:!0,virtual:!0}),this.context.metaEdges&&this.module.removeMetaEdges(this.context.metaEdges);const y=p._indexes;for(let x=0;x<y.length;x++){const E=d[x]._indexes,b=y[x];for(let S=0;S<E.length;S++)this.module.setMetaEdge(E[S],p.get(x));this.module.setSubEdges(b,d[x]),this.module.setTransformation(b,this,!1)}return{intraEdges:a,metaEdges:p}})}removeMetaEdges(e){e.forEach(t=>{const n=this.module.getSubEdges(t);if(!n)return;const s=n._indexes;for(let i=0;i<s.length;i++)this.module.clearMetaEdge(s[i]);this.module.clearSubEdges(t._index);const r=this.module.getMetaEdge(t);if(r){for(let i=0;i<s.length;i++)this.module.setMetaEdge(s[i],r);this.module.setSubEdges(r._index,this.module.getSubEdges(r).filter(i=>i!==t).concat(n))}n.filter(i=>i.getTarget().isVisible()&&i.getSource().isVisible()).setVisible(!0)}),e.setVisible(!1)}removeMetaNodes(e){e.forEach(t=>{const n=this.module.getSubNodes(t);if(!n)return;const s=n._indexes;for(const r of s)this.module.clearMetaNode(r);this.module.clearSubNodes(t._index),n.setVisible(!0)}),e.setVisible(!1)}onRemove(e,t){}checkChanges(e,t){const n=t?this.context.nodeDataUpdates:this.context.edgeDataUpdates,s=this.module;for(let r=0;r<e.length;r++){const{property:i,newValues:o,virtual:a,nodes:u,edges:d}=e[r];if(a)continue;const c=t?u.filter(g=>s.getTransformation(g._index,t)===this):d.filter(g=>s.getTransformation(g._index,t)===this);if(c.size)for(let g=0;g<c._indexes.length;g++){let f=n.get(c._indexes[g])||{};const p=o[g];i?Qu(f,i,p):f=p,n.set(c._indexes[g],f)}}}setOptions(e){return this.nodeSelector=e.nodeSelector||this.nodeSelector,this.nodeGroupIdFunction=e.nodeGroupIdFunction||this.nodeGroupIdFunction,this.nodeGenerator=e.nodeGenerator||this.nodeGenerator,this.edgeSelector=e.edgeSelector||this.edgeSelector,this.edgeGroupIdFunction=e.edgeGroupIdFunction||this.edgeGroupIdFunction,this.edgeGenerator=e.edgeGenerator||this.edgeGenerator,this.separateEdgesByDirection=e.separateEdgesByDirection!==void 0?!!e.separateEdgesByDirection:this.separateEdgesByDirection,this.groupSelfLoopEdges=e.groupSelfLoopEdges!==void 0?!!e.groupSelfLoopEdges:this.groupSelfLoopEdges,this.groupEdges=e.groupEdges!==void 0?!!e.groupEdges:this.groupEdges,super.setOptions(e)}resetContext(){super.resetContext(),this.context={...this.context,nodeDataUpdates:new Map,edgeDataUpdates:new Map}}},nL=class extends tL{constructor({duration:t,easing:n,id:s,ogma:r,module:i,enabled:o,padding:a=2,onBeforeAddMetaEdges:u,selector:d=Ul,groupIdFunction:c=Gl,edgeGroupIdFunction:g=Gl,nodeGenerator:f=wd,edgeGenerator:p=wd,onGroupUpdate:_=()=>Promise.resolve(),separateEdgesByDirection:y=!1,groupSelfLoopEdges:x=!1,groupEdges:E=!0,restorePositions:b=!0,showContents:S=!1}){super({id:s,ogma:r,module:i,nodeSelector:d,nodeGroupIdFunction:c,edgeGroupIdFunction:g,nodeGenerator:f,edgeSelector:A=>!(!this.module.getMetaNode(A.getSource())&&!this.module.getMetaNode(A.getTarget())),edgeGenerator:p,separateEdgesByDirection:y,groupEdges:E,groupSelfLoopEdges:x,duration:t,easing:n,enabled:o}),this.onBeforeAddMetaEdges=u||(()=>Promise.resolve()),this.onGroupUpdate=_,this._padding=a,this._showContents=typeof S!="function"?()=>S:S,this._restorePositions=b}getName(){return Os.NodeGrouping}get padding(){return this._padding}set padding(t){this._padding=t,this.refresh()}resetContext(){super.resetContext(),this.context={...this.context,metaNodes:this.ogma.nodeList(),metaEdges:this.ogma.edgeList(),subNodes:this.ogma.nodeList(),intraEdges:this.ogma.edgeList(),subNodesPerMetaNode:new Map,subEdges:this.ogma.edgeList()}}run(){let t,n;const s=this.ogma,r=this.module.groupController,i=r.layoutController;let o=s.createNodeList(),a=s.createEdgeList();const u=[];let d=s.createEdgeList();const c=new Map,g=-(this.getIndex()+1),f=new Set,p=[];let _;const y=s.geo.enabled();return this.addMetaNodes().then(({metaNodes:x,newNodes:E})=>{_=r.setPadding(x,this._padding),t=x;for(let b=0;b<E.size;b++)f.add(E._indexes[b]);for(let b=0;b<t.size;b++)r.nodeLayer.set(t._indexes[b],g);return this.onBeforeAddMetaEdges(t,E).then(()=>this.addMetaEdges(t))}).then(({intraEdges:x,metaEdges:E})=>{n=E,a=this.module.getSubEdges(n),n.filter(A=>A.getExtremities().map(C=>C.isVisible()).every(C=>C)).setVisible(!0);for(let A=0;A<n.size;A++)r.edgeLayer.set(n._indexes[A],g);a.setVisible(!1);const b=this.context.metaNodes.subtract(t),S=this.context.metaEdges.subtract(n);return this.module.removeMetaNodes(b),this.module.removeMetaEdges(S),r.cleanup(b,S),s.removeNodes(b,{virtual:!0}).then(()=>s.removeEdges(S,{virtual:!0})).then(()=>({intraEdges:x,metaEdges:E}))}).then(({intraEdges:x})=>{const E=t._indexes,b=[],S=t.getPosition();for(let A=0;A<E.length;A++){const C=t.get(A),k=r.isClose(C),M=!k&&!r.isOpen(C),R=r.collapsedGroups.has(C._index),O=this._showContents(C),j=this.module.getSubNodes(C),z=S[A],X=j._indexes,oe=new Set;if(M){const{x:ae,y:me}=r.getGroupXYR(C,this.module.getSubNodes(C),void 0,void 0);y?r.setGeoLatLng(C,me,ae):(C.setAttributes({x:ae,y:me},0),z.x=ae,z.y=me)}c.set(E[A],oe);const re=x.has(C._index)&&s.edgeList(x.get(C._index));re&&(d=d.concat(re),re.setVisible(O&&!R)),o=o.concat(j);for(let ae=0;ae<X.length;ae++)oe.add(X[ae]);const Q=this.context.subNodesPerMetaNode.get(E[A]),he=_.has(C._index);let fe=!Q||i.shouldRelayout.has(C._index);if(!fe&&Q)for(const ae of Q.keys())fe||(fe=!oe.has(ae));if(!fe&&Q)for(let ae=0;ae<X.length;ae++)fe||(fe=!Q.has(X[ae]));if(fe&&(i.shouldRelayout.add(C._index),b.push(this.getLayoutPromise(C,j,O))),O){if(k?r.expandGroup(C,j):r.addOpenGroup(C),fe||he||k){p.push(C);const ae=this.module.getMetaNode(C);ae&&i.shouldRelayout.add(ae._index)}}else r.closeGroup(C,j,z.x,z.y)}return this.module.animations.handleLayoutPromises(b).then(()=>{p.forEach(A=>r.setGroupXYR(A)),y&&this.ogma.modules.geo._updateNodesCoordinates(t)})}).then(()=>(this.context={metaNodes:t,metaEdges:n,subNodesPerMetaNode:c,subNodes:o,intraEdges:d,nodeDataUpdates:this.context.nodeDataUpdates,edgeDataUpdates:this.context.edgeDataUpdates,subEdges:a},u))}undo(t=!0){super.undo(t);const{metaNodes:n,metaEdges:s,intraEdges:r,subNodes:i,subEdges:o}=this.context,a=this.module.animations,u=this.module.groupController,d=-(this.getIndex()+1);r.setVisible(!0),o.setVisible(!0),s.setVisible(!1),i.setVisible(!0),i.setAttribute("layer",d+1),n.setVisible(!1),t&&(a.pushBefore(()=>{n.setVisible(!0),s.setVisible(!0)}),a.pushAfter(()=>{n.setVisible(!1),s.setVisible(!1)}),n.forEach(c=>{const g=this.module.getSubNodes(c);if(u.isClose(c))u.expandGroup(c,g,!0);else{const f=c.getPosition();u.closeGroup(c,g,f.x,f.y,!0)}}))}onRemove(t,n){if(n){const s=this.context.metaNodes.size;this.context.metaNodes=this.context.metaNodes.filter(i=>!t.has(i._index));const r=this.context.subNodes.size;this.context.subNodes=this.context.subNodes.filter(i=>!t.has(i._index)),(this.context.subNodes.size!==s||this.context.metaNodes.size!==r)&&this.context.subNodesPerMetaNode.clear()}else this.context.subEdges=this.context.subEdges.filter(s=>!t.has(s._index)),this.context.metaEdges=this.context.metaEdges.filter(s=>!t.has(s._index))}cleanup(){const{ogma:t}=this,n=this.context,{metaNodes:s,metaEdges:r,subNodes:i}=n;return this.module.removeMetaNodes(s),this.module.removeMetaEdges(r),this.module.groupController.cleanup(s,r,i),super.cleanup(),Promise.all([t.removeEdges(r,{virtual:!0}),t.removeNodes(s,{virtual:!0})]).then(()=>Promise.resolve())}setOptions({duration:t,easing:n,enabled:s,padding:r,selector:i,groupIdFunction:o,nodeGenerator:a,edgeGroupIdFunction:u,edgeGenerator:d,separateEdgesByDirection:c,groupSelfLoopEdges:g,groupEdges:f,restorePositions:p,showContents:_}){return this._padding=r!==void 0?r:this.padding,this._showContents=_!==void 0?typeof _!="function"?()=>_:_:this._showContents,this._restorePositions=p===void 0?this._restorePositions:p,super.setOptions({nodeSelector:i,nodeGroupIdFunction:o,nodeGenerator:a,edgeSelector:y=>!(!this.module.getMetaNode(y.getSource())&&!this.module.getMetaNode(y.getTarget())),edgeGroupIdFunction:u,edgeGenerator:d,separateEdgesByDirection:c,groupEdges:f,groupSelfLoopEdges:g,duration:t,easing:n,enabled:s})}getLayoutPromise(t,n,s){return(this.onGroupUpdate(t,n,s)||Promise.resolve()).then(r=>r?{subNodes:n,res:r}:null)}},G4=class extends tL{constructor({duration:e,easing:t,id:n,ogma:s,module:r,enabled:i,selector:o=Ul,groupIdFunction:a=Gl,generator:u=wd,separateEdgesByDirection:d=!1}){super({id:n,ogma:s,module:r,nodeSelector:null,nodeGroupIdFunction:null,nodeGenerator:null,edgeSelector:o,edgeGroupIdFunction:a,edgeGenerator:u,separateEdgesByDirection:d,groupEdges:!0,groupSelfLoopEdges:!0,duration:e,easing:t,enabled:i})}resetContext(){super.resetContext(),this.context={...this.context,metaEdges:this.ogma.edgeList(),subEdges:this.ogma.edgeList()}}getName(){return Os.EdgeGrouping}run(){let e,t;const n=this.module.animations,s=new Set(this.context.metaEdges.getId());return this.addMetaEdges().then(({metaEdges:r})=>{e=r,t=this.module.getSubEdges(e),e.setVisible(!0),t.setVisible(!1),n.hideEdges(t._indexes);const i=e.concat(this.context.metaEdges).getParallelEdges().dedupe().filter(d=>!s.has(d.getId())),o=new Array(i.size),a=new Map;for(let d=0;d<i.size;d++)o[d]=this.ogma.modules.curvatureManager.computeCurvature(i.get(d),"visible"),a.set(i._indexes[d],o[d]);const u=this.module.getSubEdges(i);u.setVisible(!0),this.module.animations.setCurvatures(i._indexes,o);for(let d=0;d<u._indexes.length;d++)this.module.animations.setCurvature(t._indexes[d],a.get(this.module.getMetaEdge(t.get(d))._index)||0)}).then(()=>{this.context.metaEdges=e,this.context.subEdges=t})}undo(e=!0){super.undo(e);const{metaEdges:t,subEdges:n}=this.context;if(n.setVisible(!0),t.setVisible(!1),!e)return Promise.resolve();const s=n.getParallelEdges().dedupe(),r=new Array(s.size),i=new Map;for(let o=0;o<s.size;o++)r[o]=this.ogma.modules.curvatureManager.computeCurvature(s.get(o),"visible"),i.set(s._indexes[o],r[o]);return this.module.animations.setCurvatures(s._indexes,r),Promise.resolve()}onRemove(e,t){t||(this.context.subEdges=this.context.subEdges.filter(n=>!e.has(n._index)))}_getCurvatures(e){return e.map(t=>this.ogma.modules.curvatureManager.computeCurvature(t,"visible",()=>!0))}cleanup(){const{metaEdges:e}=this.context;return this.module.removeMetaEdges(e),this.ogma.removeEdges(e,{virtual:!0}).then(()=>(this.context.metaEdges=this.ogma.edgeList(),this.context.subEdges=this.ogma.edgeList(),Promise.resolve()))}setOptions({duration:e,easing:t,enabled:n,selector:s,groupIdFunction:r,generator:i,separateEdgesByDirection:o}){return super.setOptions({nodeSelector:void 0,nodeGroupIdFunction:void 0,nodeGenerator:void 0,edgeSelector:s,edgeGroupIdFunction:r,edgeGenerator:i,separateEdgesByDirection:o,groupEdges:!0,duration:e,easing:t,enabled:n})}},JS=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Tm=1,Fu=8,V4=class sL{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,s]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const r=s>>4;if(r!==Tm)throw new Error(`Got v${r} data when expected v${Tm}.`);const i=JS[15&s];if(!i)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(t,2,1),[a]=new Uint32Array(t,4,1);return new sL(a,o,i,t)}constructor(t,n=64,s=Float64Array,r){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=s,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const i=JS.indexOf(this.ArrayType),o=2*t*this.ArrayType.BYTES_PER_ELEMENT,a=t*this.IndexArrayType.BYTES_PER_ELEMENT,u=(8-a%8)%8;if(i<0)throw new Error(`Unexpected typed array class: ${s}.`);r&&r instanceof ArrayBuffer?(this.data=r,this.ids=new this.IndexArrayType(this.data,Fu,t),this.coords=new this.ArrayType(this.data,Fu+a+u,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(Fu+o+a+u),this.ids=new this.IndexArrayType(this.data,Fu,t),this.coords=new this.ArrayType(this.data,Fu+a+u,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(Tm<<4)+i]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=t,this.coords[this._pos++]=n,s}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return J_(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,s,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:o,nodeSize:a}=this,u=[0,i.length-1,0],d=[];for(;u.length;){const c=u.pop()||0,g=u.pop()||0,f=u.pop()||0;if(g-f<=a){for(let x=f;x<=g;x++){const E=o[2*x],b=o[2*x+1];E>=t&&E<=s&&b>=n&&b<=r&&d.push(i[x])}continue}const p=f+g>>1,_=o[2*p],y=o[2*p+1];_>=t&&_<=s&&y>=n&&y<=r&&d.push(i[p]),(c===0?t<=_:n<=y)&&(u.push(f),u.push(p-1),u.push(1-c)),(c===0?s>=_:r>=y)&&(u.push(p+1),u.push(g),u.push(1-c))}return d}within(t,n,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:i,nodeSize:o}=this,a=[0,r.length-1,0],u=[],d=s*s;for(;a.length;){const c=a.pop()||0,g=a.pop()||0,f=a.pop()||0;if(g-f<=o){for(let x=f;x<=g;x++)eA(i[2*x],i[2*x+1],t,n)<=d&&u.push(r[x]);continue}const p=f+g>>1,_=i[2*p],y=i[2*p+1];eA(_,y,t,n)<=d&&u.push(r[p]),(c===0?t-s<=_:n-s<=y)&&(a.push(f),a.push(p-1),a.push(1-c)),(c===0?t+s>=_:n+s>=y)&&(a.push(p+1),a.push(g),a.push(1-c))}return u}};function J_(e,t,n,s,r,i){if(r-s<=n)return;const o=s+r>>1;rL(e,t,o,s,r,i),J_(e,t,n,s,o-1,1-i),J_(e,t,n,o+1,r,1-i)}function rL(e,t,n,s,r,i){for(;r>s;){if(r-s>600){const d=r-s+1,c=n-s+1,g=Math.log(d),f=.5*Math.exp(2*g/3),p=.5*Math.sqrt(g*f*(d-f)/d)*(c-d/2<0?-1:1);rL(e,t,n,Math.max(s,Math.floor(n-c*f/d+p)),Math.min(r,Math.floor(n+(d-c)*f/d+p)),i)}const o=t[2*n+i];let a=s,u=r;for(Du(e,t,s,n),t[2*r+i]>o&&Du(e,t,s,r);a<u;){for(Du(e,t,a,u),a++,u--;t[2*a+i]<o;)a++;for(;t[2*u+i]>o;)u--}t[2*s+i]===o?Du(e,t,s,u):(u++,Du(e,t,u,r)),u<=n&&(s=u+1),n<=u&&(r=u-1)}}function Du(e,t,n,s){Cm(e,n,s),Cm(t,2*n,2*s),Cm(t,2*n+1,2*s+1)}function Cm(e,t,n){const s=e[t];e[t]=e[n],e[n]=s}function eA(e,t,n,s){const r=e-n,i=t-s;return r*r+i*i}var j4=e=>e/360+.5,H4=e=>{const t=Math.sin(e*Math.PI/180);return(e=.5-.25*Math.log((1+t)/(1-t))/Math.PI)<0?0:e>1?1:e},q4=[],$4=256,W4=class extends nL{constructor(e){super({...e,enabled:e.enabled&&e.ogma.geo.enabled(),showContents:!1,selector:t=>{const n=this.getPosition(t);return n&&!isNaN(n.x)&&!isNaN(n.y)&&(!e.selector||e.selector(t))},groupIdFunction:t=>{let n=e.groupIdFunction?e.groupIdFunction(t):"geo-cluster";return n||(n="geo-cluster"),`${n}-${this.getNodeId(t)}`},edgeGroupIdFunction:t=>{let n=e.edgeGroupIdFunction?e.edgeGroupIdFunction(t):"";return n||(n=""),`${n}-${this.getNodeId(t.getSource())}-${this.getNodeId(t.getTarget())}`},nodeGenerator:(t,n,s)=>{let r=e.nodeGenerator?e.nodeGenerator(t,n,s):{};r||(r={});const i=this.getCoords(t.get(0));return r.data?r.data=Z_(r.data,i):r.data=i,r}}),this._zoomLevels=e.zoomLevels?e.zoomLevels:[0,22],this._groupingRadius=e.radius===void 0?60:e.radius,this._generateIdFunction=e.groupIdFunction||(()=>""),this._shouldEnable=e.enabled,this._shouldRefreshClusters=!0,this.ogma.events.on("beforeGeoCameraMove",({zoom:t})=>{!this.isEnabled()||!this.ogma.geo.enabled()||this.getClosestZoomLevel(t).zoom===this._currentClusters.zoom||(this._shouldRefreshClusters=!1,this.refresh())}).on("geoDisabled",()=>{this.isEnabled()&&this.disable(0).then(()=>{this._shouldEnable=!0})}).on("geoEnabled",()=>{this._shouldEnable&&this.enable(0)})}getPosition(e){return{x:e.getData(this.ogma.modules.geo.latitudePath),y:e.getData(this.ogma.modules.geo.longitudePath)}}getMercatorPosition(e){return{x:j4(e.getData(this.ogma.modules.geo.longitudePath)),y:H4(e.getData(this.ogma.modules.geo.latitudePath))}}getNodeId(e){var t;return((t=this._currentClusters.idToCluster.get(e._index))==null?void 0:t.id)||""}getName(){return Os.GeoClustering}enable(e){return this.ogma&&!this.ogma.geo.enabled()?(this._shouldEnable=!0,Promise.resolve()):super.enable(e)}undo(e=!0){const{metaNodes:t,metaEdges:n,intraEdges:s,subNodes:r,subEdges:i}=this.context,o=-(this.getIndex()+1);return e?(s.setVisible(!0),i.setVisible(!0),n.setVisible(!1),r.setVisible(!0),r.setAttribute("layer",o+1),this.module.animations.push(()=>{n.filter(a=>a).setVisible(!1),t.filter(a=>a).setVisible(!1)}),Promise.resolve()):(t.setVisible(!1),n.setVisible(!1),r.setVisible(!0),i.setVisible(!0),s.setVisible(!0),Promise.resolve())}disable(e){return this._shouldEnable=!1,super.disable(e)}getCoords(e){var t;const n=((t=this._currentClusters.idToCluster.get(e._index))==null?void 0:t.center)||{x:0,y:0},s={};return this.setToPropertyPath(s,this.ogma.modules.geo.latitudePath,n.x),this.setToPropertyPath(s,this.ogma.modules.geo.longitudePath,n.y),s}setToPropertyPath(e,t,n){if(typeof t=="string")return this.setToPropertyPath(e,t.split("."),n);{let s=e;t.forEach((r,i)=>{i===t.length-1?s[r]=n:s[r]||(s[r]={}),s=s[r]})}}nodeToElement(e){return{nodeId:e._index,generatedId:this._generateIdFunction(e),nodes:this.ogma.nodeList(new Uint32Array([e._index])),radius:e.getAttribute("radius"),center:this.getPosition(e),mercatorCenter:this.getMercatorPosition(e),zoom:1/0}}getCluster(e){const t=e.reduce((r,i)=>({x:r.x+i.center.x/e.length,y:r.y+i.center.y/e.length}),{x:0,y:0}),n=e.reduce((r,i)=>({x:r.x+i.mercatorCenter.x/e.length,y:r.y+i.mercatorCenter.y/e.length}),{x:0,y:0}),s=e.reduce((r,i)=>{const o=t.x-i.center.x,a=t.y-i.center.y,u=i.radius+Math.sqrt(o*o+a*a);return Math.max(u,r)},0);return{nodes:this.ogma.nodeList(new Uint32Array(e.map(({nodeId:r})=>r))),generatedId:e[0].generatedId,center:t,mercatorCenter:n,radius:s}}onePassCluster(e){const t=e.map(i=>this.nodeToElement(i)),[n,s]=this._zoomLevels,r=[];for(let i=s;Math.abs(i-n)>.01;i-=1*(s-n)/19){const o=[],a=new V4(t.length);t.forEach(u=>{a.add(u.mercatorCenter.x,u.mercatorCenter.y)}),a.finish(),t.forEach(u=>{if(u.zoom<=i)return;const d=this._groupingRadius/($4*Math.pow(2,u.zoom-1));let c=a.within(u.mercatorCenter.x,u.mercatorCenter.y,d).map(g=>t[g]).filter(g=>g.zoom>i&&g&&g.generatedId===u.generatedId);c.length||(c=[u]),c.forEach(g=>g.zoom=i),o.push({...this.getCluster(c),zoom:i,id:`${i.toFixed(2)}-${o.length}`})}),r.push({zoom:i,clusters:o})}return r.map(({zoom:i,clusters:o})=>{const a=new Map;return o.forEach(u=>{u.nodes.forEach(({_index:d})=>a.set(d,u))}),{zoom:i,idToCluster:a}})}getClosestZoomLevel(e){return this._clustersByZoom.reduce((t,n)=>Math.abs(e-n.zoom)<Math.abs(e-t.zoom)?n:t)}run(){var e;this._shouldRefreshClusters&&(this._clustersByZoom=this.onePassCluster(this.ogma.getNodes().filter(g=>this.nodeSelector(g)))),this._shouldRefreshClusters=!0;const t=((e=this.ogma.geo.getMap())==null?void 0:e.getZoom())||0;let n,s;this._currentClusters=this.getClosestZoomLevel(t);const r=this.ogma,i=this.module.groupController;let o=r.createNodeList(),a=r.createEdgeList(),u=r.createEdgeList();const d=-(this.getIndex()+1),c=new Set;return this.addMetaNodes().then(({metaNodes:g,newNodes:f})=>{n=g;for(let p=0;p<f.size;p++)c.add(f._indexes[p]);for(let p=0;p<n.size;p++)i.nodeLayer.set(n._indexes[p],d);return this.addMetaEdges(n)}).then(({intraEdges:g,metaEdges:f})=>{s=f,a=this.module.getSubEdges(s),s.filter(y=>y.getExtremities().map(x=>x.isVisible()).every(x=>x)).setVisible(!0);for(let y=0;y<s.size;y++)i.edgeLayer.set(s._indexes[y],d);a.setVisible(!1);const p=this.context.metaNodes.subtract(n),_=this.context.metaEdges.subtract(s);return this.module.removeMetaNodes(p),this.module.removeMetaEdges(_),i.cleanup(p,_),r.removeNodes(p,{virtual:!0}).then(()=>r.removeEdges(_,{virtual:!0})).then(()=>({intraEdges:g,metaEdges:f}))}).then(({intraEdges:g})=>{const f=n._indexes;for(let p=0;p<f.length;p++){const _=n.get(p),y=this.module.getSubNodes(_),x=g.has(_._index)&&r.edgeList(g.get(_._index));x&&(u=u.concat(x),x.setVisible(!1)),o=o.concat(y),y.setVisible(!1)}return this.ogma.modules.geo._updateNodesCoordinates(n),this.ogma.modules.geo.updateProjection(),this.context={metaNodes:n,metaEdges:s,subNodes:o,intraEdges:u,subNodesPerMetaNode:new Map,nodeDataUpdates:this.context.nodeDataUpdates,edgeDataUpdates:this.context.edgeDataUpdates,subEdges:a},q4})}setOptions(e){const t=super.setOptions({...e,selector:n=>{const s=this.getPosition(n);return s&&!isNaN(s.x)&&!isNaN(s.y)&&(!e.selector||e.selector(n))},groupIdFunction:n=>{let s=e.groupIdFunction?e.groupIdFunction(n):"geo-cluster";return s||(s="geo-cluster"),`${s}-${this.getNodeId(n)}`},nodeGenerator:(n,s,r)=>{let i=e.nodeGenerator?e.nodeGenerator(n,s,r):{};i||(i={});const o=this.getCoords(n.get(0));return i.data?i.data=Z_(i.data,o):i.data=o,i},edgeGroupIdFunction:n=>{let s=e.edgeGroupIdFunction?e.edgeGroupIdFunction(n):"";return s||(s=""),`${s}-${this.getNodeId(n.getSource())}-${this.getNodeId(n.getTarget())}`}});return this._groupingRadius=e.radius===void 0?this._groupingRadius:e.radius,this._generateIdFunction=e.groupIdFunction||this._generateIdFunction,this._shouldRefreshClusters=!0,this._shouldEnable=e.enabled,t}},tA=()=>({}),X4=class extends zo{constructor(e){super(e),this._groupSelfLoopEdges=!1,this._isCleaningUp=!1,this._isRunning=!1,this.shouldDo=!0,this.enabled=!1,this._onBeforeAdd=t=>{if(this._isCleaningUp||!this.enabled||t.virtual)return;const{isNode:n,objects:s}=t;if(n){const r=s;nA(r,this._groupNodes(r))}else{const r=s;nA(r,this._groupEdges(r))}this._shouldSetVirtual=!0},this._onAfterAdd=t=>{this._shouldSetVirtual&&(this._shouldSetVirtual=!1,this._setVirtual(t.nodes||t.edges,!!t.nodes))},this._onRequestElementsToDelete=t=>{if(t.virtual)return;const{ogma:n,context:s}=this,r=t.elementsToRemove.isNode,i=r?n.getNodes:n.getEdges,o=r?s.metaNodesSet:s.metaEdgesSet,a=r?s.nodeGroups:s.edgeGroups,u=r?n.removeNodes:n.removeEdges,d=t.elementsToRemove.size,c=i(Array.from(o)),g=t.elementsToRemove.slice();if(t.elementsToRemove=t.elementsToRemove.subtract(c),t.elementsToRemove.size===d)return;const f=g.subtract(t.elementsToRemove);if(f.forEach(p=>{a.delete(p.getId())}),r){const p=f.getAdjacentEdges().filter(_=>_.isVirtual());n.removeEdges(p)}u(f,{virtual:!0})},this._nodeToGroupId=e.groupIdFunction||Gl,this._groupSelfLoopEdges=!!e.groupSelfLoopEdges,this._nodeGenerator=e.nodeGenerator||tA,this._edgeGenerator=e.edgeGenerator||tA,this._shouldSetVirtual=!1,this._selector=e.selector,this.shouldDo=e.enabled===void 0||!!e.enabled,this.ogma.events.on("preAddElements",this._onBeforeAdd).on("requestElementsToDelete",this._onRequestElementsToDelete).on(["postAddGraph","addNodes","addEdges"],this._onAfterAdd),this.shouldDo&&(this.enable(),this.shouldDo=!1)}getName(){return Os.NodeClustering}enable(){if(this.enabled)return Promise.resolve();this.enabled=!0,this.shouldDo=!0,this._isRunning=!0;const{ogma:e}=this;return e.getNodes().size?e.export.json({download:!1,edgeAttributes:"all",nodeAttributes:"all"}).then(t=>(e.clearGraph(),e.setGraph(t))).then(()=>(this._isRunning=!1,Promise.resolve())):(this._isRunning=!1,Promise.resolve())}disable(){return this.enabled?(this.enabled=!1,this.shouldDo=!1,super.disable()):Promise.resolve()}destroy(){return this.disable(),super.destroy()}run(){const{ogma:e}=this;return this.enabled||!this.shouldDo?Promise.resolve():e.export.json({download:!1,edgeAttributes:"all",nodeAttributes:"all"}).then(t=>(this._isCleaningUp=!0,e.clearGraph(),this._isCleaningUp=!1,e.setGraph(t)))}undo(){if(this._isRunning||this.enabled)return Promise.resolve();const{ogma:e,context:t}=this;this._isCleaningUp=!0;const n=e.getNodes(Array.from(t.metaNodesSet));this.module.removeMetaNodes(n);const s=e.getEdges(Array.from(t.metaEdgesSet));this.module.removeMetaEdges(s);const r=this._getSubNodes(),i=this._getSubEdges();return this.resetContext(),e.removeNodes(n,{virtual:!0}).then(()=>e.removeEdges(s,{virtual:!0})).then(()=>e.addNodes(r)).then(()=>e.addEdges(i)).then(()=>{this._isCleaningUp=!1,Promise.resolve()})}cleanup(){return this._isRunning||this.ogma.events.off(this._onBeforeAdd).off(this._onRequestElementsToDelete).off(this._onAfterAdd),Promise.resolve()}resetContext(){this._isRunning||(this.context={nodeGroups:new Map,edgeGroups:new Map,metaNodesSet:new Set,metaEdgesSet:new Set,virtualNodes:this.ogma.createNodeList(),virtualEdges:this.ogma.createEdgeList(),nodeToGroupId:new Map})}getSubNodes(e){const t=this.context.nodeGroups.get(e.getId());return t?t.nodes:[]}getSubEdges(e){const t=this.context.edgeGroups.get(e.getId());return t?t.edges:[]}_getSubNodes(){return Array.from(this.context.nodeGroups.values()).reduce((e,{nodes:t})=>(e.push(...t),e),[])}_getSubEdges(){return Array.from(this.context.edgeGroups.values()).reduce((e,{edges:t})=>(e.push(...t),e),[])}_setVirtual(e,t){if(!e)return;const{context:n}=this,s=t?n.metaNodesSet:n.metaEdgesSet,r=e.filter(i=>s.has(i.getId()));if(t)for(let i=0;i<r.size;i++)this.module.setTransformation(r._indexes[i],this,t),this.module.setSubNodes(r._indexes[i],null);else for(let i=0;i<r.size;i++)this.module.setTransformation(r._indexes[i],this,t),this.module.setSubEdges(r._indexes[i],null);t?n.virtualNodes=n.virtualNodes.concat(r):n.virtualEdges=n.virtualEdges.concat(r)}setContext(){}_computeEdgeGroupId(e,t){return e>t?`${t}:${e}`:`${e}:${t}`}_groupEdges(e){const{ogma:t,id:n,context:s}=this,r=n,i=new Map,o=s.nodeToGroupId;s.edgeGroups.forEach(c=>{c.newEdges=[],i.set(c.id,c)});const a=[];for(let c=0;c<e.length;++c){const g=e[c];let f=s.nodeToGroupId.get(g.source),p=s.nodeToGroupId.get(g.target);if(!f&&!p){a.push(g);continue}f=f||g.source,p=p||g.target;const _=this._computeEdgeGroupId(f,p);if(_!==void 0){const y=o.get(g.source)||g.source,x=o.get(g.target)||g.target;let E=i.get(_);E||(E={id:_,source:y,target:x,edges:[],newEdges:[]},i.set(_,E)),E.edges.push(g),E.newEdges.push(g)}}const u=kg(i),d=u.map(({edges:c})=>c);for(let c=0;c<u.length;++c){const g=u[c];if(!g.newEdges.length)continue;const f=g.id,p=d[c],_=this._edgeGenerator(p,f);_.id===void 0&&(_.id=Ig(f,r)),_.source=g.source,_.target=g.target,g.metaEdge=_,s.metaEdgesSet.add(_.id),s.edgeGroups.get(_.id)||s.edgeGroups.set(_.id,g),(this._groupSelfLoopEdges||_.source!==_.target)&&a.push(_)}return t.view.afterNextFrame().then(()=>{s.edgeGroups.forEach(({newEdges:c,metaEdge:g})=>{if(!(c.length&&g&&g.id&&g.attributes))return;const f=t.getEdge(g.id);f==null||f.setAttributes(g.attributes)})}),a}_groupNodes(e){const{id:t,context:n,ogma:s}=this,r=t,i=new Map;n.nodeGroups.forEach(g=>{g.newNodes=[],i.set(g.id,g)});const o=[];for(let g=0;g<e.length;g++){const f=e[g];if(this._selector&&!this._selector(f)){o.push(f);continue}f.id=y4(f.id);const p=this._nodeToGroupId(f);if(p!==void 0){let _=i.get(p);_||(_={id:p,nodes:[],newNodes:[]},i.set(p,_)),_.nodes.push(f),_.newNodes.push(f)}else n.nodeToGroupId.set(f.id,f.id)}const a=kg(i),u=a.map(({nodes:g})=>g),d=a.map(({newNodes:g})=>g),c=[];for(let g=0;g<a.length;++g){if(!a[g].newNodes.length)continue;const f=a[g].id,p=u[g],_=this._nodeGenerator(p,f);a[g].metaNode=_,_.id===void 0&&(_.id=Ig(f,r));for(const y of d[g])n.nodeToGroupId.set(y.id,_.id);n.metaNodesSet.add(_.id),n.nodeGroups.get(_.id)||n.nodeGroups.set(_.id,a[g]),c.push(_)}return c.push(...o),s.view.afterNextFrame().then(()=>{n.nodeGroups.forEach(({newNodes:g,metaNode:f})=>{if(!(g.length&&f&&f.id&&f.attributes))return;const p=s.getNode(f.id);p==null||p.setAttributes(f.attributes)})}),c}setOptions(e){return this._nodeToGroupId=e.groupIdFunction||this._nodeToGroupId,this._groupSelfLoopEdges=e.groupSelfLoopEdges!==void 0?!!e.groupSelfLoopEdges:this._groupSelfLoopEdges,this._nodeGenerator=e.nodeGenerator||this._nodeGenerator,this._edgeGenerator=e.edgeGenerator||this._edgeGenerator,this._selector=e.selector||this._selector,this.disable().then(()=>this.undo()).then(()=>this.ogma.view.afterNextFrame()).then(()=>this.enable())}onRemove(){}};function nA(e,t){const n=t.length;return e.length=n,e.splice(0,n,...t),e}function ki(e){return e.enabled!==!1}var Y4=class extends T4{_setOptions(e){const t=e;return t.ogma=this.ogma,t.module=this,t.id=this.transformations.length,t}addNodeGrouping(e={}){const t=new nL(this._setOptions(e));return this.addTransformation(t,ki(e)),t}addEdgeGrouping(e={}){const t=new G4(this._setOptions(e));return this.addTransformation(t,ki(e)),t}addGeoClustering(e={}){const t=new W4(this._setOptions(e));return this.addTransformation(t,e.enabled),t}addNodeFilter(e={}){let t={};t=typeof e=="function"?{criteria:e}:e;const n=new I4(this._setOptions(t));return this.addTransformation(n,ki(t)),n}addEdgeFilter(e={}){let t={};t=typeof e=="function"?{criteria:e}:e;const n=new k4(this._setOptions(t));return this.addTransformation(n,ki(t)),n}addNeighborMerging(e){const t=new M4(this._setOptions(e));return this.addTransformation(t,ki(e)),t}addNeighborGeneration(e){const t=new F4(this._setOptions(e));return this.addTransformation(t,ki(e)),t}addNodeCollapsing(e={}){const t=new z4(this._setOptions(e));return this.addTransformation(t,ki(e)),t}addVirtualProperties(e={}){const t=new U4(this._setOptions(e));return this.addTransformation(t,ki(e)),t}addNodeClustering(e={}){const t=new X4(this._setOptions(e));return this.addTransformation(t,ki(e)),t}addDrilldown(e={onGetSubgraph:()=>Promise.resolve({nodes:[],edges:[]})}){const t=new x4(this._setOptions(e));return this.drilldownController.addDrilldown(t),t}onGroupsUpdated(e){this.groupController.onGroupsUpdate=e}triggerGroupsUpdated(){this.groupController.triggerGroupsUpdate()}layoutGroups(e,t,n=!1){return this.groupController.layoutGroups(e,t,n)}getXYR(e){const t=this.animations.xs,n=this.animations.ys,s=this.animations.rs,r=e.getAttributes(["x","y","radius"]);for(let i=0;i<e.size;i++){const o=e._indexes[i];t.has(o)&&(r[i].x=t.get(o)),n.has(o)&&(r[i].y=n.get(o)),s.has(o)&&(r[i].radius=s.get(o))}return r}},Z4=class extends zt{constructor(e){super(e),this.getSubElements=t=>this.api.getSubElements(t),this.getSubNodes=t=>this.api.getSubNodes(t),this.getSubEdges=t=>this.api.getSubEdges(t),this.getXYR=t=>this.api.getXYR(t),this.onGroupsUpdated=t=>this.api.onGroupsUpdated(t)}onMounted(){this._modules.classes.createClass({name:C1,isBuiltin:!0,nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0}}),this._modules.classes.createClass({name:L1,isBuiltin:!0,nodeAttributes:{opacity:0},edgeAttributes:{opacity:0}}),this._modules.settings.register("transformations.updateOnDataChange",!0),this._modules.events.register(["transformationEnabled","transformationDisabled","transformationSetIndex","transformationDestroyed","transformationRefresh"])}onReady(e){this.api=new Y4(this._ogma)}destroy(){}isElementVirtual(e){return this.api.isVirtual(e._index,e.isNode)}getElementTransformation(e){return this.api.getTransformation(e._index,e.isNode)}getMetaElements(e){return e.map(t=>this.getMetaElement(t))}getMetaElement(e){var n;const t=e.isNode?this.api.getMetaNode(e):this.api.getMetaEdge(e);return t&&((n=this.api.getTransformation(t._index,t.isNode))!=null&&n.isEnabled())?t:null}getMetaEdge(e){return this.getMetaElement(e)}getMetaNode(e){return this.getMetaElement(e)}getMetaNodes(e){return this.getMetaElements(e)}getMetaEdges(e){return this.getMetaElements(e)}getNodeFilters(){return this.api.getList().filter(e=>e.getName()===Os.NodeFilter)}getEdgeFilters(){return this.api.getList().filter(e=>e.getName()===Os.EdgeFilter)}whenApplied(){return this.api.afterNextUpdate()}afterNextUpdate(){return this.api.afterNextUpdate()}triggerGroupUpdated(e){const t=e._indexes,n=this._ogma.modules.transformations.api.groupController.layoutController.shouldRelayout;for(let s=0;s<e.size;s++)n.add(t[s])}async expandGroup(e,t,n,s,r,i){if(!t.isVirtual())throw new Error("Focus node is not virtual.");const o=t.getSubNodes();let a=t.getAttribute("radius");await s(),await this.afterNextUpdate();const u=await n(o);await o.setAttributes(t.getPosition());const[,,d]=Nx.geometry.minDisk(u.map(_=>_.x),u.map(_=>_.y),o.getAttribute("radius"));a=d-a;const c=e.getNodes().filter(_=>_.isVirtual()),g=await e.algorithms.fishEyeExpand({nodes:c,focusNode:t,deltaRadius:a,dryRun:!0,duration:r,easing:i}),f=c.concat(o),p=g.concat(u);await f.setAttributes(p,{duration:r||0,easing:i})}async collapseGroup(e,t,n,s,r){if(!t.isVirtual())throw new Error("Focus node is not virtual.");const i=t.getSubNodes(),o=t.getPosition(),a=rP-t.getAttribute("radius"),u=Array.from({length:i.size},()=>o),d=e.getNodes().filter(p=>p.isVirtual()),c=await e.algorithms.fishEyeExpand({nodes:d,focusNode:t,deltaRadius:a,dryRun:!0,duration:s,easing:r}),g=d.concat(i),f=c.concat(u);await g.setAttributes(f,{duration:s||0,easing:r}),await n(),await this.afterNextUpdate()}},sA={layer:N1,outline:!0,outerStroke:{color:N_,width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:T2,minVisibleSize:0}},K4={layer:N1,color:N_,text:{backgroundColor:T2,minVisibleSize:0},stroke:{color:N_,width:0}},Q4=class extends zt{onMounted(){this.shouldTriggerEvents=!0,this._modules.events.register(["nodesSelected","nodesUnselected","edgesSelected","edgesUnselected"]),this._selectionExtremityHighlightedClass=this._modules.classes.createClass({name:l_,isBuiltin:!0,nodeAttributes:sA}),this._selectedClass=this._modules.classes.createClass({name:Nn,isBuiltin:!0,nodeAttributes:sA,edgeAttributes:K4}),this._modules.events.on(`nodeClassAdded_${Nn}`,t=>{this.shouldTriggerEvents&&this._modules.events.fire("nodesSelected",t)}),this._modules.events.on(`edgeClassAdded_${Nn}`,t=>{this.shouldTriggerEvents&&this._modules.events.fire("edgesSelected",t)}),this._modules.events.on(`nodeClassRemoved_${Nn}`,t=>{this.shouldTriggerEvents&&this._modules.events.fire("nodesUnselected",t)}),this._modules.events.on(`edgeClassRemoved_${Nn}`,t=>{this.shouldTriggerEvents&&this._modules.events.fire("edgesUnselected",t)}),this._modules.settings.register("interactions.selection.enabled",!0),this._modules.settings.register("interactions.selection.multiSelectionKey","ctrl"),this._modules.interactions.onClick({priority:"selection",check:({button:t})=>{const n=!!this._modules.settings.get("interactions.selection.enabled");return t==="left"&&n},handler:({target:t})=>{if(t){const n=this._modules.settings.get("interactions.selection.multiSelectionKey"),s=n&&this._modules.keyboard.isPressed(n);t.isNode?this._selectedClass.clearEdges():this._selectedClass.clearNodes(),s?t.hasClass(Nn)?t.removeClass(Nn):t.addClass(Nn):((t.isNode?this._selectedClass.getNodes():this._selectedClass.getEdges()).filter(r=>r!==t).removeClass(Nn),t.hasClass(Nn)||t.addClass(Nn))}else this._selectedClass.clearNodes(),this._selectedClass.clearEdges()}});const e=()=>{this._selectionExtremityHighlightedClass.clearNodes(),this._selectedClass.getEdges().getExtremities().addClass(l_)};this._modules.events.on("beforeRemoveEdges",({edges:t})=>t.setSelected(!1)).on("excludedStateChange",({elements:t,value:n})=>{n||t.setSelected(!1)}).on(`edgeClassAdded_${Nn}`,e).on(`edgeClassRemoved_${Nn}`,e)}setNodeAttributes(e,t){this._selectedClass.update({nodeAttributes:e,fullOverwrite:t}),this._selectionExtremityHighlightedClass.update({nodeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()}setEdgeAttributes(e,t){this._selectedClass.update({edgeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()}_updateExtremityHighlightLayer(){const e=this._selectedClass.getDefinition().edgeAttributes,t=e?e.layer:void 0;this._selectionExtremityHighlightedClass.update({nodeAttributes:{layer:t},fullOverwrite:!1})}setActive(e,t){if(bs(t)){const n=[],s=[];e.toList().forEach((r,i)=>{(t[i]?n:s).push(r.getId())}),n.length!==0&&this._modules.graph.getElements(e.isNode,n).addClass(Nn),s.length!==0&&this._modules.graph.getElements(e.isNode,s).removeClass(Nn)}else e.size&&e[t?"addClass":"removeClass"](Nn)}areActive(e){return e.hasClass(Nn)}getSelectedNodes(){return this._selectedClass.getNodes()}getSelectedEdges(){return this._selectedClass.getEdges()}getNonSelectedNodes(){return this._modules.graph.getNodes().filter(e=>!e.hasClass(Nn))}getNonSelectedEdges(){return this._modules.graph.getEdges().filter(e=>!e.hasClass(Nn))}disableEvents(){this.shouldTriggerEvents=!1}enableEvents(){this.shouldTriggerEvents=!0}clear(){this._selectedClass.clearNodes(),this._selectedClass.clearEdges()}},J4=class extends zt{onMounted(){this._delayedCalls=[],this._idIdle=()=>!this._modules.captor.isAnyButtonPressed()&&!this._modules.dom.isPlayingFrame(),this._modules.events.on(["mousedown","mouseup","beforeNewFrame","frame"],()=>{this._delayedCalls.forEach(e=>e.reset())})}_nextTimeIdle(e){const t=new e5(this._modules.dom,this._idIdle,e);return this._delayedCalls.push(t),t.whenDone().then(()=>{this._delayedCalls.splice(this._delayedCalls.indexOf(t),1)})}debounceIdle(e,t=0){let n=!1,s=[];const r=()=>{const i=s;n=!1,s=[],e(),i.forEach(o=>o())};return()=>new Promise(i=>{s.push(i),n||(n=!0,this._nextTimeIdle(t).then(r))})}},e5=class{constructor(e,t,n){this._timeout=null,this._done=!1,this._dom=e,this._promise=new Promise(s=>this._resolve=s),this._isIdle=t,this._delay=n,this._startTimeout()}_startTimeout(){this._timeout=this._dom.setTimeout(()=>{this._isIdle()?(this._done=!0,this._resolve()):this._startTimeout()},this._delay)}reset(){this._done||(this._dom.clearTimeout(this._timeout),this._startTimeout())}whenDone(){return this._promise}},Pc=-2,t5={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:50,startRatio:1,endRatio:2,enabled:!1},n5={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:10,startRatio:1,endRatio:2,enabled:!1},s5=class extends zt{constructor(){super(...arguments),this._nodePromiseMap=new Map,this._edgePromiseMap=new Map,this._onAttributeChange=({nodes:e,edges:t,nodeAttributes:n,edgeAttributes:s})=>{this._onElementsAttributeChange(e,n),this._onElementsAttributeChange(t,s,!1)},this._refreshPulses=()=>{const{nodes:e,edges:t}=this._hasPulses.getElements();if(e.size!==0||t.size!==0){const n=this._engine.getCurrentTime();this._refreshElementsPulses(e,n),this._refreshElementsPulses(t,n),this._modules.dom.refresh()}}}onMounted(){this._modules.events.on("updateAttributes",this._onAttributeChange).on("frame",this._refreshPulses).on("beforeRemoveEdges",({edges:e})=>{this._removePulses(e)}).on("beforeRemoveNodes",({nodes:e})=>{this._removePulses(e)}).on("excludedStateChange",({elements:e,value:t})=>{t&&(this._hasPulses.removeElements(e),this._removePulses(e))}).on("clearGraph",()=>this._hasPulses.clear()),this._engine=this._modules.graphics.getGraphicsEngine(),this._group=this._engine.createGroup(),this._nodePulses=this._modules.graph.createNodeAttribute({storage:"any"},!1),this._edgePulses=this._modules.graph.createEdgeAttribute({storage:"any"},!1),this._nodeNbPulsesRemaining=this._modules.graph.createNodeAttribute({storage:"int16",default:-1},!1),this._edgeNbPulsesRemaining=this._modules.graph.createEdgeAttribute({storage:"int16",default:-1},!1),this._nodeFlexArrays=this._modules.graphics.getNodeAttributes(),this._edgeFlexArrays=this._modules.graphics.getEdgeAttributes(),this._edgeSourceList=this._modules.graph.getEdgeAttribute("source"),this._edgeTargetList=this._modules.graph.getEdgeAttribute("target"),this._hasPulses=new Vd(this._modules.graph)}_onElementsAttributeChange(e,t,n=!0){if(!t.includes("pulse.enabled"))return;const{valid:s,invalid:r}=Fw(this._modules.graph,e,o=>o.getAttribute("pulse.enabled")&&o.isVisible());this._hasPulses.removeElements(r),this._hasPulses.addElements(s);const i=n?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining;for(let o=0;o<s.size;o++)i.get(s._indexes[o])>0||i.set(s._indexes[o],Pc);this._removePulses(r)}_removePulses(e){const t=e.isNode?this._nodePulses:this._edgePulses,n=e.isNode?this._nodePromiseMap:this._edgePromiseMap;for(let s=0;s<e._indexes.length;s++){const r=e._indexes[s],i=t.get(r);if(i){for(let a=0;a<i.length;a++){const u=i[a];this._modules.graphics.releaseGraphicsEngineBlockId(u.blockId)}t.set(r,null);const o=n.get(r);o&&(o.resolve(),n.delete(r))}}}_refreshElementsPulses(e,t){const n=e.isNode,s=n?this._nodePulses:this._edgePulses,r=n?this._nodeFlexArrays.pulse.duration:this._edgeFlexArrays.pulse.duration,i=n?"_createNodePulseBlock":"_createEdgePulseBlock",o=n?this._nodeFlexArrays.pulse.interval:this._edgeFlexArrays.pulse.interval,a=n?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining;for(let u=0;u<e._indexes.length;u++){const d=e._indexes[u];let c=s.get(d);c||(c=[],s.set(d,c));for(let y=0;y<c.length;y++){const{startTime:x,duration:E,blockId:b}=c[y];t>=x+E&&(this._modules.graphics.releaseGraphicsEngineBlockId(b),c.splice(y--,1))}const g=c[c.length-1];if(g&&t<g.startTime+o.get(d))continue;const f=r.get(d),p=a.get(d);if(p<1&&p!==Pc)continue;c.push({blockId:this[i](d,t,f),startTime:t,duration:f});const _=p===Pc?Pc:p-1;a.set(d,_)}}_createNodePulseBlock(e,t,n){const s=this._nodeFlexArrays,r=s.color.get(e),i=s.layer.get(e),o=s.x.get(e),a=s.y.get(e),u=s.radius.get(e),d=s.scalingMethod.get(e)==="scaled",c=s.pulse.startRatio.get(e),g=s.pulse.endRatio.get(e),f=s.pulse.width.get(e),p=2*u*c,_=2*u*g,y=vd(i).nodeBody,x=s.pulse.startColor.get(e),E=s.pulse.endColor.get(e),b=this._modules.graphics.allocateGraphicsEngineBlockId(),S=this._group.reset(Wr,!0,y),A=S.nextAndReset(),C=Kr(x,r),k=Kr(E,r);return A.end.shape="circle",A.end.pieceId=Pr,A.end.x1=o,A.end.y1=a,A.end.x2=o,A.end.y2=a,A.end.rectWidthOrSourceRadiusScaled=d?_:0,A.end.rectHeightOrTargetRadiusScaled=d?_:0,A.end.rectWidthOrSourceRadiusFixed=d?0:_,A.end.rectHeightOrTargetRadiusFixed=d?0:_,A.end.strokeWidthFixed=f,A.end.strokeColor=k,A.start.shape="circle",A.start.pieceId=Pr,A.start.x1=o,A.start.y1=a,A.start.x2=o,A.start.y2=a,A.start.rectWidthOrSourceRadiusScaled=d?p:0,A.start.rectHeightOrTargetRadiusScaled=d?p:0,A.start.rectWidthOrSourceRadiusFixed=d?0:p,A.start.rectHeightOrTargetRadiusFixed=d?0:p,A.start.strokeWidthFixed=f,A.start.strokeColor=C,A.animation.duration=n,A.animation.beginTime=t,this._engine.storeGroup(b,S),b}_createEdgePulseBlock(e,t,n){const s=this._edgeFlexArrays,r=this._nodeFlexArrays,i=s.pulse.startRatio.get(e),o=s.pulse.endRatio.get(e),a=s.pulse.startColor.get(e),u=s.pulse.endColor.get(e),d=vd(s.layer.get(e)).edgeBody,c=this._edgeSourceList.get(e),g=this._edgeTargetList.get(e),f=s.curvature.get(e),p=f!==0,_=this._modules.graphics.allocateGraphicsEngineBlockId(),y=this._group.reset(p?Eg:Wr,!0,d),x=y.nextAndReset(),E={isSelfLoop:c===g,curvature:f,sourceX:r.x.get(c),sourceY:r.y.get(c),targetX:r.x.get(g),targetY:r.y.get(g),sourceRadius:r.radius.get(c),targetRadius:r.radius.get(g),isSourceRadiusScaled:r.scalingMethod.get(c)==="scaled",isTargetRadiusScaled:r.scalingMethod.get(g)==="scaled",width:s.width.get(e),isWidthScaled:s.scalingMethod.get(e)==="scaled",strokeWidth:s.pulse.width.get(e)};return rA(x.start,E),rA(x.end,E),x.start.strokeColor=a,x.end.strokeColor=u,x.start.thicknessOrFontSizeScaled*=i,x.start.thicknessOrFontSizeFixed*=i,x.end.thicknessOrFontSizeScaled*=o,x.end.thicknessOrFontSizeFixed*=o,x.animation.duration=n,x.animation.beginTime=t,this._engine.storeGroup(_,y),_}pulse(e,t){const n=e.isNode,s={...n?t5:n5,...n?this._nodePulseTheme:this._edgePulseTheme,...t},r=s.number,i=s.interval,o=s.duration,a=n?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,u=(r-1)*i+o;let d;s.enabled=!0,delete s.number,e.setAttributes({pulse:s}),a.setMultiple(e._indexes,r),this._modules.dom.setTimeout(()=>{e.isList?e.filter(Yr).setAttribute("pulse.enabled",!1):e.setAttribute("pulse.enabled",!1),a.setMultiple(e._indexes,-1)},u);const c=new Promise(f=>{d=()=>f(e)}),g=e.isNode?this._nodePromiseMap:this._edgePromiseMap;return e.isList?e._indexes.forEach(f=>{this._setPromise(f,g,c,d)}):this._setPromise(e._index,g,c,d),c}_setPromise(e,t,n,s){t.has(e)&&t.get(e).resolve(),t.set(e,{promise:n,resolve:s})}setTheme(e,t){this._nodePulseTheme=e,this._edgePulseTheme=t}};function rA(e,{sourceX:t,sourceY:n,targetX:s,targetY:r,isSourceRadiusScaled:i,isTargetRadiusScaled:o,targetRadius:a,sourceRadius:u,isWidthScaled:d,width:c,strokeWidth:g,curvature:f,isSelfLoop:p}){e.pieceId=tf,e.shape="line",e.x1=t,e.y1=n,e.x2=s,e.y2=r,e.rectWidthOrSourceRadiusScaled=i?u:0,e.rectWidthOrSourceRadiusFixed=i?0:u,e.rectHeightOrTargetRadiusScaled=o?a:0,e.rectHeightOrTargetRadiusFixed=o?0:a,e.thicknessOrFontSizeScaled=d?c:0,e.thicknessOrFontSizeFixed=d?0:c,e.strokeWidthFixed=g,e.curvature=f,e.isSelfLoop=p}var r5={duration:0,easing:"linear",callback:Vt,resolve:Vt,startAfter:0},i5=0,o5=class extends zt{constructor(){super(...arguments),this._animationList=[],this._update=()=>{if(this._animationList.length===0)return;const e=Rs(),t=[];for(let n=0;n<this._animationList.length;++n){const s=this._animationList[n],r=(e-s.creationDate)/s.duration,i=s.startAfter;let o=s.easing(r);r>=1?(s.func(1),s.done=!0,s.resolve(void 0),this._animationList.splice(n,1),n-=1,t.push(s.callback)):o>=i&&(o=(o-i)*(1/(1-i)),s.func(o))}for(let n=0;n<t.length;n++)t[n](!1);this._modules.dom.refresh()}}onMounted(){this._modules.events.on("beforeNewFrame",this._update)}play(e,t){const{duration:n,easing:s,callback:r,startAfter:i,resolve:o}=pr(t,r5);if(n<=0)return e(1),r(),o(void 0),null;const a={func:e,easing:typeof s=="function"?s:dx[s],duration:n,callback:r,resolve:o,startAfter:i,creationDate:Rs(),done:!1,id:++i5};return this._animationList.push(a),this._modules.dom.refresh(),a}cancel(e){const t=this._animationList.indexOf(e);t!==-1&&(e.func(1),this._animationList.splice(t,1),e.done=!0,e.resolve(void 0))}},a5=(e,t,n,s)=>{const r=n._getMapPanePos(),i=e.getMapboxMap(),o=e.getCanvas(),a=e.getSize().round(),u=s.DomUtil.getPosition(e.getContainer()),d=u.x+r.x,c=u.y+r.y;return new Promise(g=>{function f(){t.drawImage(o,d,c,a.x,a.y),g()}if(i.loaded())return f();i.once("idle",f)})},l5=(e,t,n,s,r)=>{const i=n._getMapPanePos(),o=e.getContainer();if(!o)throw new Error(`Trying to access the container of ${e} but it does not exist.`);const a=s.DomUtil.getPosition(o);n.removeLayer(e),e.options.crossOrigin="anonymous";const u=[],d=[];return e.on("tileload",({tile:c})=>{const{x:g,y:f}=s.DomUtil.getPosition(c);u.push(c),d.push({x:g-a.x+i.x,y:f-a.y+i.y})}),n.addLayer(e),new Promise(c=>{e.once("load",()=>{const g=e.getTileSize();u.forEach((f,p)=>{const{x:_,y}=d[p];t.drawImage(f,_,y,g.x,g.y)}),c()})})},u5=(e,t,n,s,r,i)=>new Promise(o=>{const a=e.options.renderer;n.removeLayer(e),e.options.renderer=i,n.addLayer(e),i._updatePaths();const u=n._getMapPanePos(),d=i._container,c=s.DomUtil.getPosition(d);t.drawImage(i._container,c.x+u.x,c.y+u.y,d.width/r,d.height/r),n.removeLayer(e),e.options.renderer=a,n.addLayer(e),o()}),d5=(e,t,n,s,r)=>new Promise(i=>{const o=n.getPixelBounds().min,a=n.project(e.getLatLng(),n.getZoom()),u=/^data:/.test(e._icon.src),d=u?e._icon.src:iL(e._icon.src),c=new Image,g=e.options.icon;if(g){const f=g.options;let p=f.iconSize||[24,24];const _=a.subtract(o);let y=f.iconAnchor||[0,0];Array.isArray(p)||(p=[p.x,p.y]),Array.isArray(y)||(y=[y.x,y.y]);const x=Math.round(_.x-(p[0]-y[0])*r),E=Math.round(_.y-y[1]*r);c.crossOrigin="";const b=()=>{t.drawImage(c,x,E,p[0]*r,p[1]*r),i()};c.onload=b,c.src=d,u&&b()}}),h5=(e,t,n,s,r)=>new Promise(i=>{n.removeLayer(e),e.setUrl(iL(e.getUrl())),e.options.crossOrigin="anonymous",e.once("load",()=>{const o=e.getBounds(),a=n.latLngToContainerPoint(o.getNorthWest()),u=n.latLngToContainerPoint(o.getSouthEast()),d=u.x-a.x,c=u.y-a.y;t.drawImage(e._image,a.x,a.y,d,c),i()}),n.addLayer(e)});function iL(e){return e+(e.indexOf("?")===-1?"?":"&")+"noCache="+Date.now()}var c5={tileLayers:l5,imageOverlays:h5,vectorLayers:u5,markers:d5,vectorMap:a5};function g5(e,t){return e instanceof t.TileLayer?"tileLayers":e instanceof t.ImageOverlay?"imageOverlays":e instanceof t.Path?"vectorLayers":e instanceof t.Marker?"markers":"MapboxGL"in t&&e instanceof t.MapboxGL?"vectorMap":void 0}function f5(e,t,n,s,r,i){const o={vectorMap:[],tileLayers:[],vectorLayers:[],imageOverlays:[],markers:[]};return t.eachLayer(a=>{if(a!==e){const u=g5(a,s);if(u&&u in o){const d=c5[u];o[u].push(()=>d(a,n,t,s,r,i))}}}),o}function p5(e){e.TileLayer.prototype.getUrl=function(){return this._url},e.ImageOverlay.prototype.getUrl=function(){return this._url};const t="leaflet-zoom-animated";e.OgmaOverlay||(e.OgmaOverlay=e.Layer.extend({options:{pane:"overlayPane",padding:0,onUpdate:()=>{}},initialize:function(n){const{container:s}=n;e.Util.setOptions(this,n),this._container=s},setLocked:function(n){return this._locked=n,this},onAdd:function(n){this._map=n,this.getPane().appendChild(this._container),this._wgsOrigin=e.latLng([0,0]),this._wgsInitialShift=n.project(this._wgsOrigin,this._initialZoom),e.DomUtil.addClass(this._container,"leaflet-layer"),this._zoomAnimated&&(e.DomUtil.addClass(this._container,t),this._container.style.position="absolute",this._container.style.zIndex=9999),this._initialZoom=(this._map.getMaxZoom()+this._map.getMinZoom())/2,this._mapInitialZoom=this._map.getZoom(),this._updateBounds(),this._update({})},_updateBounds(){const n=this.options.padding,s=this._map.getSize(),r=this._map.containerPointToLayerPoint(s.multiplyBy(-n));this._bounds=new e.Bounds(r,r.add(s.multiplyBy(1+2*n))),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},_update(n){this._updateBounds(),this._redraw(this._bounds.min,n),this._positionTimer=e.Util.requestAnimFrame(()=>{this._container&&e.DomUtil.setPosition(this._container,this._bounds.min)})},_redraw(n,s){this.options.onUpdate()},_updateTransform(n,s){if(this._locked)return;const r=this._map.getZoomScale(s,this._zoom),i=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,s),a=i.multiplyBy(-r).add(o).subtract(this._map._getNewPixelOrigin(n,s));e.Browser.any3d?e.DomUtil.setTransform(this._container,a,r):e.DomUtil.setPosition(this._container,a)},_onZoom(n){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_onMoveEnd(n){this._update(n)},_onAnimZoom({center:n,zoom:s}){this._updateTransform(n,s)},bringToFront(){e.DomUtil.toFront(this._container)},getEvents(){return{zoom:this._onZoom,moveend:this._onMoveEnd,zoomanim:this._onAnimZoom,layeradd:this.bringToFront,zoomend:this.options.onUpdate}},onRemove:function(){e.DomUtil.removeClass(this._container,t);const n=this._container;["transform","webkitTransform","OTransform","MozTransform","msTransform","zIndex","position"].forEach(s=>n.style[s]=null),e.Util.cancelAnimFrame(this._positionTimer),this._container=null}}))}function m5(e,t,n,s){const r=e.filter(k=>k.isVisible()),i=r.size===0,{mapX:o,mapY:a}=r.reduce((k,M)=>{const{latitude:R,longitude:O}=M.getGeoCoordinates(),{x:j,y:z}=s(R,O);return k.mapX.push(j),k.mapY.push(z),k},{mapX:[],mapY:[]}),u=r.getAttribute("x"),d=r.getAttribute("y"),c=r.getAttribute("radius").map(Number),g=new Ws({xValues:u,yValues:d,scaledSizeValues:c}),f=new Ws({xValues:o,yValues:a});i&&(g.cx=g.cy=0,g.width=g.height=0),isFinite(f.width)&&isFinite(f.height)||(f.cx=f.cy=0,f.width=f.height=0);let p=f.cx-g.cx,_=f.cy-g.cy;const y=i?1:Math.max(f.width,f.height)/Math.max(g.width,g.height),[x,E]=c.reduce((k,M)=>(k[0]=Math.min(k[0],M*y),k[1]=Math.max(k[1],M*y),k),[1/0,0]);f.pad(E),f.minScaledSize=x,f.maxScaledSize=E;const b=n.computeConfigForBounds(f),S=t.zoom/TM(b.zoom);p+=(g.cx-t.x)*S,_+=(g.cy-t.y)*S;const A=g.cx+p,C=g.cy+_;return{offsetChanges:{name:"graph-to-geo",nodeAttributes:{radius:k=>Number(k.getAttribute("radius"))*S,x:k=>(k.getAttribute("x")+p-A)*S+A,y:k=>(k.getAttribute("y")+_-C)*S+C},edgeAttributes:{width:k=>Number(k.getAttribute("width"))*S}},camera:{zoom:t.zoom/S,x:(t.x+p-A)*S+A,y:(t.y+_-C)*S+C,angle:0,...t.getSize()}}}function _5(e,t,n,s){const r=e.getAttributes(["x","y","radius"]),i=e.getBoundingBox(),o=e.size===0,a=e.reduce((A,{_index:C},k)=>(A[C]=k,A),{});s();const u=e.getAttribute("x"),d=e.getAttribute("y"),c=e.getAttribute("radius"),g=new Ws({xValues:u,yValues:d,scaledSizeValues:c.map(A=>2*A)});o&&(i.reset(),g.reset());let f=g.cx-i.cx,p=g.cy-i.cy,_=0,y=0;const x=n.computeConfigForBounds(g),E=t.zoom/x.zoom;let b,S;return isNaN(i.cx)||isNaN(i.cy)?(i.cx=t.x,i.cy=t.y,b=x.x,S=x.y):(f+=(i.cx-t.x)*E,p+=(i.cy-t.y)*E,_=i.cx+f,y=i.cy+p,b=(t.x+f-_)*E+_,S=(t.y+p-y)*E+y),{offsetChanges:{name:"geo-to-graph",nodeAttributes:{x:A=>(r[a[A._index]].x+f-_)*E+_,y:A=>(r[a[A._index]].y+p-y)*E+y}},camera:{zoom:x.zoom,x:b,y:S,angle:0,...t.getSize()}}}var oL={"top-left":"left","bottom-left":"left","top-right":"right","bottom-right":"right"},y5={"top-left":"top","bottom-left":"bottom","top-right":"top","bottom-right":"bottom"},iA={position:"bottom-right",horizontalMargin:0,verticalMargin:0,className:void 0},x5=class extends zt{onMounted(){this._brand=null}set(e,t){let{position:n,horizontalMargin:s,verticalMargin:r,className:i}={...iA,...t};oL[n]||(n=iA.position),this.remove();const o=document.createElement("div");return Lw(o,wy.sanitize(e)),o.style.position="absolute",aL(o,n,s,r),o.style.zIndex="10",i&&o.setAttribute("class",i),this._brand=o,this._modules.dom.setLayer("brand",this._brand),o}remove(){this._modules.dom.setLayer("brand",null),this._brand=null}};function aL(e,t,n,s){const r=n===void 0?"":n+"px",i=s===void 0?"":s+"px";e.style[oL[t]]=r,e.style[y5[t]]=i}var oA={},v5=class extends zt{constructor(){super(...arguments),this._enabled=!1,this._settings={...aa},this._edgesOriginalTextStyle={},this._nodesOriginalTextStyle={},this._nodeDraggingSetting=!1,this._transition=!1,this._attribution=null,this._updating=!1,this._updateRate=50,this._x=0,this._y=0,this._onCameraUpdate=e=>{if(this.L&&this._enabled&&this._map&&this._map._loaded){const t=this._x-this._modules.camera.x,n=this._y-this._modules.camera.y;(t||n)&&this._syncMapWithCamera()}},this._syncMapWithCamera=()=>{if(!this._map)return;this._updating||(this._updating=!0,this._layer.setLocked(!0),this._map._moveStart(!0,!1));const e=this._fromPointToLatLng(this._modules.camera.x,this._modules.camera.y),t=Wp(this._modules.camera.zoom),n=this.L.latLng(e.latitude,e.longitude);this._map._move(n,t,{pinch:!0,round:!1}),clearTimeout(this._updateRequest),this._updateRequest=this._modules.dom.setTimeout(()=>{this._updating=!1,this._layer.setLocked(!1),this._map&&this._map._move(n,t,{pinch:!0})._moveEnd(!0)},this._updateRate)},this._onNodesDragStart=()=>{this._enabled&&(this._setMapDragging(!1),this._nodeDragOffsetX=this._nodeDragOffsetY=0)},this._onNodesDragged=({nodes:e,dx:t,dy:n})=>{if(this._enabled){const s=e.map(r=>{const{x:i,y:o}=r.getAttributes(["x","y"]);return this._fromPointToLatLng(i+t-this._nodeDragOffsetX,o+n-this._nodeDragOffsetY)});return this._nodeDragOffsetX=t,this._nodeDragOffsetY=n,e.setGeoCoordinates(s)}return Promise.resolve(this._modules.graph.nodeList())},this._onMapUpdate=()=>{if(!this._map)return Promise.resolve(void 0);const{lat:e,lng:t}=this._map.getCenter(),n=this._fromLatLngToPoint(e,t);this._x=n.x,this._y=n.y;const s=wM(this._map.getZoom());return this._modules.events.fire("beforeGeoCameraMove",{zoom:this._map.getZoom()}),this._modules.camera.setView({zoom:s,x:n.x,y:n.y},{ignoreZoomLimits:!0}).then(()=>this._adjustMinvisibleSizes())},this.runLayout=async({type:e,nodes:t,latitudePath:n=ui,longitudePath:s=di,options:r,center:i})=>{const o=VM(i),a=o([i.longitude,i.latitude]),u=t.getPosition(),d=[];return t.setAttributes(t.map(c=>{const g=c.getData(n),f=c.getData(s);if(isNaN(g)||isNaN(f))return{x:a[0],y:a[1]};const p=o([f,g]);return{x:p[0],y:p[1]}})).then(()=>this._ogma.layouts[e]({...r,nodes:t,dryRun:!0})).then(c=>{const g=c.positions.current,f=new Array(g.length),p=new Array(g.length),_=new Array(g.length).fill(10);g.forEach((b,S)=>{const A=o.invert([b.x,b.y]);f[S]=A[1],p[S]=A[0],d.push({latitude:A[1],longitude:A[0]})});const y=Od(p,f,_),x=y[0]-i.longitude,E=y[1]-i.latitude;for(let b=0;b<d.length;b++)f[b]-=E,p[b]-=x,d[b].latitude-=E,d[b].longitude-=x;return t.setData(n,f),t.setData(s,p),t.setAttributes(u)}).then(()=>this._ogma.modules.geo._updateNodesCoordinates(t)).then(()=>d)}}onMounted(){this._modules.events.register(["geoEnabled","beforeGeoDisabled","geoDisabled","geoNodesMoved","geoLoaded","geoReady"]),yb()&&(this.L=kr("L")||kr("leaflet"),this.L&&p5(this.L)),this._modules.graph.createNodeAttribute({name:"geo.prevLat",storage:"float"},!0),this._modules.graph.createNodeAttribute({name:jp,storage:"float"},!0),this._modules.graph.createNodeAttribute({name:ui,storage:"float"},!0),this._modules.graph.createNodeAttribute({name:di,storage:"float"},!0),this._modules.events.register(["beforeGeoCameraMove"]),this._modules.events.on("addNodes",e=>{e.virtual||this._refreshOrAddNodes(e.nodes,!0)}).on("updateNodeData",e=>{this._onDataChange(e.changes)}).on("nodesDragProgress",this._onNodesDragged).on(["nodesDragStart","lassoEnabled"],this._onNodesDragStart).on(["nodesDragEnd","lassoDisabled"],()=>this._setMapDragging(!0)).on("viewChanged",this._onCameraUpdate)}_onDataChange(e){const t=Hm(this.latitudePath),n=Hm(this.longitudePath),s=e.filter(({virtual:i,property:o,newValues:a})=>!(i||!a.length)&&(o&&typeof o!="string"?o.find(u=>t.startsWith(u)||n.startsWith(u)):o===null||t.startsWith(o)||n.startsWith(o)));if(!s.length)return;const r=zM(s);r&&(this._modules.events.fire("geoNodesMoved",{nodes:r}),this._refreshOrAddNodes(r,!1))}_refreshOrAddNodes(e,t){t&&this._updatePrevNodesCoordinates(e),this._updateNodesCoordinates(e),this._enabled&&(this._cacheOriginalTextStyles(e,null),this._filter.refresh())}_updatePrevNodesCoordinates(e){ec(this._modules.graph,e,ui,tb),ec(this._modules.graph,e,di,jp)}_restorePrevNodesCoordinates(e){ec(this._modules.graph,e,tb,ui),ec(this._modules.graph,e,jp,di)}_updateNodesCoordinates(e){FM(this._modules.graph,e,this._settings)}_createMapTileLayer(e,t){if(e&&!rs(e))return e;const n=e,s=n.wms?this.L.tileLayer.wms:this.L.tileLayer,r=CM(n,t)||"";return s(n.url,{attribution:r,...e})}_setupTileLayer(e,t,n){const s=this._createMapTileLayer(e,t);return s.once("load",()=>{this._modules.events.fire("geoLoaded")}),s.addTo(this._map),_b(s,n),s}_onSettingsChanged(e,t){const n=e.wrapCoordinates!==t.wrapCoordinates,s=e.latitudePath!==t.latitudePath||e.longitudePath!==t.longitudePath;if(n||s){let r=Promise.resolve();this._enabled&&this._filter&&(r=r.then(()=>this._filter.refresh())),r.then(()=>this._updateNodesCoordinates(this._modules.graph.getNodes("all")))}this._enabled&&(IM(e,t)&&this._map&&(this._map.removeLayer(this._tileLayer),this._tileLayer=this._setupTileLayer(t.tiles,t.attribution,t.opacity)),e.sizeRatio!==t.sizeRatio&&this._updateSizes(),e.maxZoomLevel!==t.maxZoomLevel&&this._modules.settings.update({minZoom:1,maxZoom:Math.pow(2,t.maxZoomLevel)}),e.disableNodeDragging!==t.disableNodeDragging&&this._setDragging(!t.disableNodeDragging),e.attributionOptions!==t.attributionOptions&&this._setAttributionOptions(t.attributionOptions,t.attribution),_b(this._tileLayer,t.opacity))}_setMapDragging(e){if(this._map){const t=e?"enable":"disable";this._map.dragging[t]()}}_fromLatLngToPoint(e,t){return this._map.options.crs.latLngToPoint(this.L.latLng(e,t),ig)}_fromPointToLatLng(e,t){const{lat:n,lng:s}=this._map.options.crs.pointToLatLng(this.L.point({x:e,y:t}),ig);return{latitude:n,longitude:s}}_updateSizes(){this._enabled&&this._projection&&this._projection.updateAll()}enable(e){return this.setEnabled(!0,e)}getMap(){return this._enabled?this._map:null}getOptions(){return this._enabled?{...this._settings,tiles:rs(this._settings.tiles)?{...this._settings.tiles}:this._settings.tiles}:{...aa}}setOptions(e){if(!this._enabled||this._transition)return;LM(e,this.L);const t=this._settings;this._settings={...aa,...t,...e,tiles:NM(aa,e)},this._onSettingsChanged(t,this._settings)}disable(e){return this.setEnabled(!1,e)}isEnabled(){return this._enabled}toggle(e={}){return this.setEnabled(!this._enabled,e)}getContainerCoords(e){return e.getGeoCoordinates().map(({latitude:t,longitude:n})=>this._map.latLngToContainerPoint([t,n]))}getContainerCoord(e){const{latitude:t,longitude:n}=e.getGeoCoordinates();return this._map.latLngToContainerPoint([t||0,n||0])}setEnabled(e,t){if(!yb())throw new Error("Ogma Geo cannot be used outside a browser");if(!this.L)throw new Error("You are trying to use Geo mode but Leaflet has not been found. Please follow our migration guide: https://bit.ly/2SYkF8A");if(this._transition||e===this._enabled)return Promise.resolve();const n=this._modules.settings;this._enabled||(this._prevSettings=n.get(),this._nodeDraggingSetting=!!n.get("interactions.drag.enabled")),this._enabled=e,this.setOptions(t),this._transition=!0;const s=this._settings;return e?this._show().then(()=>(this._registerTextStyle(this._modules.graph.getNodes(),this._modules.graph.getEdges()),this._setDragging(!s.disableNodeDragging),this._transition=!1,this._updating=!1,this._modules.events.fire("geoEnabled").fire("geoReady"),this._adjustMinvisibleSizes())):this._restoreTextStyle().then(()=>this._hide()).then(()=>{this._transition=!1,this._modules.events.fire("geoDisabled"),this._setDragging(this._nodeDraggingSetting,!0)}).then(()=>this._ogma.view.afterNextFrame())}destroy(){return this._enabled&&this._destroyMapSync(),Promise.resolve()}_cacheOriginalTextStyles(e,t){t&&(this._edgesOriginalTextStyle=vb(t,this._edgesOriginalTextStyle)),e&&(this._nodesOriginalTextStyle=BM(e,this._nodesOriginalTextStyle))}_registerTextStyle(e,t){this._cacheOriginalTextStyles(e,t);const{nodeAttributes:n,edgeAttributes:s}=this._modules.hover.getHoverClassDefinition();this._hoverEdgesOriginalTextStyle=s||null,this._hoverNodesOriginalTextStyle=n||null,this._modules.hover.updateEdgeAttributes({text:{size:r=>(this._edgesOriginalTextStyle[r.getId()]||oA)["text.size"]}}),this._modules.hover.updateNodeAttributes({text:{size:r=>(this._nodesOriginalTextStyle[r.getId()]||oA)["text.size"]}})}_restoreTextStyle(){return this._modules.hover.updateEdgeAttributes(this._hoverEdgesOriginalTextStyle,!0),this._modules.hover.updateNodeAttributes(this._hoverNodesOriginalTextStyle,!0),Promise.all([GM(this._modules.graph.getEdges(),this._edgesOriginalTextStyle)]).then(()=>(this._edgesOriginalTextStyle=vb(this._modules.graph.edgeList(),{}),this._nodesOriginalTextStyle={},this._edgesOriginalTextStyle={},Promise.resolve()))}_setDragging(e,t=!1){this._modules.settings.update({interactions:{drag:{enabled:e,applyResult:t}}})}_setAttributionOptions(e,t){if(this._map){if(this._attribution&&(this._attribution.remove(),this._attribution=null),this._attribution=this.L.control.attribution({prefix:!1}).addTo(this._map),rs(e)){this._attribution.setPrefix(""),e.position=e.position||"bottom-right";const n=e.position.replace("-","");this._attribution.setPosition(n);const s=this._attribution.getContainer();s&&(e.className&&this.L.DomUtil.addClass(s,e.className),aL(s,e.position||"bottom-right",e.horizontalMargin,e.verticalMargin))}t!=null&&this._attribution.addAttribution(t)}}_nodeIsVisible(e){return DM(e,this._settings,this._hasCustomProjection())}_updateSettingsForMap(){const e=this._modules.graphics.getGraphicsEngine().parseColor(this._settings.backgroundColor);e[3]=0,this._modules.settings.update({backgroundColor:gT(e),minZoom:1e-6,interactions:{rotation:{enabled:!1},drag:{enabled:!1},pan:{enabled:!1},zoom:{enabled:!1,onDoubleClick:!1}},mouse:{wheelEnabled:!1}})}getGraphPosition(e){const t=this.L.latLngBounds(PM(e));return{center:e.size>0?t.getCenter():this.L.latLng([0,0]),zoom:this._clampZoom(this._map.getBoundsZoom(t))}}_initMap(){this._updateSettingsForMap(),this._mapContainer=MM(this._modules.dom.getContainer());const e={...zk,minZoom:this._settings.minZoomLevel,maxZoom:this._settings.maxZoomLevel};this._hasCustomProjection()&&(e.crs=this._settings.crs,e.worldCopyJump=!1,e.maxBoundsViscosity=0),this._map=new this.L.Map(this._mapContainer,e),this._map.on("movestart zoomstart",()=>{this._updating=!0}).on("moveend zoomend",()=>{this._updating=!1}),this._setAttributionOptions(this._settings.attributionOptions,this._settings.attribution),this._setupLayers()}_clampZoom(e){let t=this._tileLayer.options.maxZoom;return t===void 0&&(t=1/0),Math.min(e,t)}_show(){let e;return this._initMap(),this._filter?e=this.filter.enable(0):(this._filter=this._modules.transformations.api.addNodeFilter({criteria:t=>this._nodeIsVisible(t)}),this._filter.setIndex(0),e=this._filter.whenApplied()),e.then(()=>{const t=this._map,n=this._modules.graph.getNodes(),s=this._modules.graph.getEdges(),{center:r,zoom:i}=this.getGraphPosition(n),{offset:o,newCameraView:a}=this._transformToGeo();return this._modules.camera.setView(a,{ignoreZoomLimits:!0}).then(()=>(this._updatePrevNodesCoordinates(n),t.setView(r,i,{animate:!1}),this._modules.graphics.animate({nodes:n,edges:s},()=>{this._projection=this._createFinalPositionLayer()},!0,this._settings.duration))).then(()=>o.destroy())})}updateProjection(){var e;(e=this._projection)==null||e.update()}_hasCustomProjection(){return this._settings.crs!=null}_setupLayers(){this._settings.tiles&&(this._tileLayer=this._setupTileLayer(this._settings.tiles,this._settings.attribution,this._settings.opacity)),this._layer=new this.L.OgmaOverlay({container:this._modules.graphics.getDomElement(),mapContainer:this._mapContainer,onUpdate:()=>this._onMapUpdate()}),this._layer.addTo(this._map)}_adjustMinvisibleSizes(){return Promise.all([UM(this._modules.graph.getEdges(),this._edgesOriginalTextStyle,this._map.getZoom())])}_hide(){if(!this._map)return Promise.resolve();this._modules.settings.update(this._prevSettings);const e=this._map;e.removeLayer(this._layer);const t=this._modules.dom.getContainer(),n=this._modules.graphics.getDomElement();t&&t.appendChild(n),e.getContainer().style.zIndex="0";const s=this._modules.graph.getNodes("all"),r=this._modules.graph.getEdges("all"),{offset:i,newCameraView:o}=this._transformToGraph();return this._modules.camera.setView(o||{}).then(()=>(this._modules.events.fire("beforeGeoDisabled"),Promise.all([g1(e.getContainer(),1,0,this._settings.duration/2).then(()=>this._destroyMapSync()),this._modules.graphics.animate({nodes:s,edges:r},()=>i&&i.destroy(),!0,this._settings.duration)]))).then(()=>(this._map=null,this._filter.disable(0).then(()=>{})))}_destroyMapSync(){if(this._map){this._layer&&this._layer._map&&this._map.removeLayer(this._layer),this._map.remove(),this._map._animatingZoom=!1,this._map=null;const e=this._mapContainer.parentNode;e&&e.removeChild(this._mapContainer)}}_transformToGeo(){const e=this._modules.graph.getNodes(),{offsetChanges:t,camera:n}=m5(e,this._modules.camera,this._modules.locate,(s,r)=>this._fromLatLngToPoint(s,r));return{offset:this._addGraphAttributesLayer(t),newCameraView:n}}_addGraphAttributesLayer(e){return this._modules.graphics.addAttributeLayer({priority:JM,nodeSelector:t=>t.isVisible(),edgeSelector:t=>t.isVisible(),...e})}_transformToGraph(){const e=this._modules.graph.getNodes("all"),{offsetChanges:t,camera:n}=_5(e,this._modules.camera,this._modules.locate,()=>{this._projection&&(this._projection.destroy(),this._projection=null)});return{offset:this._addGraphAttributesLayer(t),newCameraView:n}}getPointFromLatLng(e){const{latitude:t,longitude:n}=e.getGeoCoordinates();return t==null?e.getAttributes(["x","y"]):this._fromLatLngToPoint(t,n)}_createFinalPositionLayer(){return this._addGraphAttributesLayer({name:"graph-2-geo-animation",nodeAttributes:{scalingMethod:"fixed",radius:e=>Number(e.getAttribute("radius"))*this._settings.sizeRatio,x:e=>this.getPointFromLatLng(e).x,y:e=>this.getPointFromLatLng(e).y},edgeAttributes:{scalingMethod:"fixed",width:e=>Number(e.getAttribute("width"))*this._settings.sizeRatio}})}setCenter(e,t){return this._enabled?this.setView(e,t,Wp(this._modules.camera.getZoom())):Promise.resolve()}setZoom(e){return this._enabled&&this._map?(e=this._clampZoom(e),this._map.setZoom(e),new Promise(t=>{const n=this._map;if(n.getZoom()===e)return t(void 0);n.once("moveend zoomend",t)}).then(this._onMapUpdate)):Promise.resolve()}zoomIn(){return this.setZoom(this.getZoom()+1)}zoomOut(){return this.setZoom(this.getZoom()-1)}setView(e,t,n){if(!this._enabled||!this._map)return Promise.resolve();const s=this._map;n=this._clampZoom(n);const r=this.L.latLng([e,t]);return s.setView(r,n,{animate:!1,reset:!0}),new Promise(i=>{if(s.getZoom()===n&&s.getCenter().equals(r))return i(void 0);s.once("moveend zoomend",i)}).then(this._onMapUpdate)}getView(){if(!this._enabled||!this._map)return;const e=this._map.getCenter();return{zoom:this._map.getZoom(),latitude:e.lat,longitude:e.lng}}getCenter(){if(!this._enabled||!this._map)return;const e=this._map.getCenter();return{latitude:e.lat,longitude:e.lng}}getZoom(){if(this._enabled&&this._map)return this._map.getZoom()}resetCoordinates(){if(!this._enabled||!this._projection)return;const e=this._modules.graph.getNodes();this._restorePrevNodesCoordinates(this._modules.graph.getNodes());const t=this._modules.graph.getNodeAttribute(ui).getMultiple(e._indexes),n=this._modules.graph.getNodeAttribute(di).getMultiple(e._indexes);e.setData(this._settings.latitudePath,t),e.setData(this._settings.longitudePath,n),this._projection.update()}getUnprojectedCoordinates(e){this._projection&&this._projection.destroy();const t=e.getPosition();return this._projection=this._createFinalPositionLayer(),t}get latitudePath(){return this._settings.latitudePath}get longitudePath(){return this._settings.longitudePath}get filter(){return this._filter}exportBackground(e){if(!this._map)return Promise.reject("Map is not ready");const{pixelRatio:t,width:n,height:s,zoom:r,x:i,y:o}=e,a=n*t,u=s*t,d=Es(a,u),c=d.getContext("2d"),g=this._map;if(!c)throw new Error(`Unable to get 2d context from  ${d}`);const f=this.getView(),p={zoom:Math.round(Wp(r*t)),...this._fromPointToLatLng(i,o)},_=new this.L.Canvas;g.addLayer(_);const{vectorMap:y,tileLayers:x,vectorLayers:E,imageOverlays:b,markers:S}=f5(this._layer,g,c,this.L,t,_),A=g.options.zoomSnap;return Promise.resolve().then(()=>(wa(this._mapContainer,a+"px",u+"px"),g.invalidateSize({animate:!1}),this.setView(p.latitude,p.longitude,p.zoom))).then(()=>mw([...y,...x,...b,...E,...S])).then(()=>{wa(this._mapContainer,"100%","100%"),g.invalidateSize({animate:!1}),g.options.zoomSnap=A,this.setView(f.latitude,f.longitude,f.zoom)}).then(()=>new Promise(C=>this.L.Util.requestAnimFrame(C))).then(()=>g.removeLayer(_)).then(()=>d)}},b5=class extends zt{constructor(){super(...arguments),this._context={edgesAlwaysCurvy:!1,edgesRoutingStyle:"none",directedEdges:!1}}onMounted(){this._attributeLayer=this._addAttributeLayer(),this._modules.settings.register("edgesAlwaysCurvy",!1,e=>{this._context.edgesAlwaysCurvy=e,this._attributeLayer.updateAll()}),this._modules.settings.register("directedEdges",!1,e=>{this._context.directedEdges=e,this._attributeLayer.updateAll()}),this._modules.settings.register("edgesRoutingStyle","none",e=>{var r;const t=e&&e!=="none",n=e==="vertical",s=(r=this._ogma.modules)==null?void 0:r.graphics.getGraphicsEngine();s&&s.setBentEdges(t,n),this._attributeLayer.updateAll()})}computeCurvature(e,t="visible",n){const{edgesAlwaysCurvy:s,directedEdges:r}=this._context,i=e.getSource()===e.getTarget();if(!s&&e.hasParallelEdges()===!1&&!i)return 0;let o=e.getParallelEdges({filter:t});n&&(o=o.filter(d=>n(d)));const a=o.indexOf(e);if(a===-1)return 0;let u;if(i)u=(a+1)*Math.max(+e.getAttribute("width")||0,1);else{const d=e.getSource(),c=o.size;if(c===1&&!s)return 0;if(r){let g=0;for(let f=0;f<a;++f)o.get(f).getSource()===d&&(g+=1);u=g+1}else{const g=d!==o.get(0).getSource();u=c%2!=1||s?(1+(a/2|0))*(a%2==0?1:-1)*(g?-1:1):a===0?0:((a+1)/2|0)*(a%2==0?1:-1)*(g?-1:1)}}return u}_addAttributeLayer(){return this._modules.graphics.addAttributeLayer({name:"curvature",priority:YM,edgeDependencies:{parallelEdges:!0},edgeContext:this._context,edgeAttributes:{curvature:e=>this.computeCurvature(e)}})}};/**
 * @license
 * Copyright Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function E5(e){if(typeof e!="string"||e.trim()===""){let t="Calls to uncheckedconversion functions must go through security review.";throw t+=" A justification must be provided to capture what security assumptions are being made.",new Error(t)}}function Ou(e,t){return E5(t.justification),_y(e)}var lL="worker_start",uL="worker_configure",Ix="worker_update",Td="worker_stop",dL=class extends Bd{constructor(e,t){super(),this._complete=!1,this._destroyed=!1,this._data=null,this._onStart=Vt,this._onStop=Vt,this._setIdle=Vt,this._onPause=Vt,this.timer={start:0,steps:0},this._modules=t,this.configure(e)}configure({configure:e=Yr,update:t=Vt,context:n=Vt,stop:s=Vt,isRunning:r=sg,onStart:i=Vt,onStop:o=Vt,onPause:a=Vt,setIdle:u=Vt}){this._configure=e,this._update=t,this._createContext=n,this._isRunning=r,this._stop=s,this._onStart=i,this._onStop=o,this._setIdle=u,this._onPause=a}setData(e){this._data=e}getData(){return this._data}start(e){this._complete=!1,this._onStart(),this.fire(lL,{target:this});const t=this._configure(e,this._modules);return this.fire(uL,t),this.send(t),this}stop(e){return this._complete||(this._onStop(),this.send({type:Td}),this._complete=!0),this}pause(){this._onPause()}setIdle(e){this._setIdle(e)}isBusy(){return!this._complete}destroy(){this._destroyed||(this._destroyed=!0,this._modules&&(this.stop(),delete this._modules))}},hL=/^function\s*\(/,cL=/^\(|^\w+\s?=>/,S5="Layout control code for the worker",zu={justification:S5};function Rc(e){const t=e.toString();return t.indexOf("function")===0||cL.test(t)?t:`function ${t}`}var A5=class extends dL{constructor(e,t){super(e,t);const n=pk([Ou(w5(e.imports),zu),Su`\nconst __CONTEXT = (`,Ou(Rc(this._createContext),zu),Su`)();\nconst __UPDATE_FUNC = `,Ou(Rc(this._update),zu),Su`\nconst __IS_RUNNING_FUNC = `,Ou(Rc(this._isRunning),zu),Su`\nconst __STOP_FN = `,Ou(Rc(this._stop),zu),Su`\nlet result;
      self.addEventListener("message", function (evt) {
        if (evt.data && evt.data.type === 'worker_stop') {
          __STOP_FN(__CONTEXT);
          return self.postMessage({ result, isRunning: false });
        }
        result = __UPDATE_FUNC(evt.data, __CONTEXT);
        const isRunning = __IS_RUNNING_FUNC(__CONTEXT, evt.data);
        self.postMessage({ result, isRunning });
      });
    `]);this._worker=f2(n),this._worker.addEventListener("message",s=>{t.dom.isDestroyed()||this.onWorkerMessage(s)})}onWorkerMessage(e){const t=e.data.isRunning,n=e.data.result,s={data:void 0},r=Promise.resolve(n),i={worker:this,workerMessage:n,modules:this._modules,promise:r,data:s,isRunning:t};return this.fire(Ix,i),t?this.send(s.data):i.promise.then(()=>(this.fire(Td,{worker:this,result:n,modules:this._modules}),this.stop(n)))}destroy(){super.destroy(),this._worker.terminate()}send(e){return this._complete||this._worker.postMessage(g2(e)),this}};function w5(e={}){const t=Object.keys(e),n=[];for(let s=0,r=t.length;s<r;s++){const i=t[s],o=e[i];if(typeof o!="function")throw new Error(`Asynchronous worker: dependency "${i}" is not found`);{const a=T5(o);a?(n.push(aA(o,i)),a!==i&&n.push(`var ${i} = ${a};`)):n.push(`var ${i} = ${aA(o,i)};`)}}return n.join(`
`)}function aA(e,t){const n=e.toString();return hL.test(n)?`function ${e.name||t} ${n.substring(n.indexOf("("))}`:cL.test(n)?`const ${e.name||t} = ${n.toString()}`:n}function T5(e){const t=e.toString();return e.name?e.name:hL.test(t)?null:t.substring(9,t.indexOf("(")).trim()}var C5=class extends dL{constructor(e,t){super(e,t),this._context=this._createContext()}sync(e){if(e&&e.type===Td)return this._stop(this._context);const t=this._update(e,this._context),n=this._isRunning(this._context,e),s={data:void 0},r=Promise.resolve(),i={worker:this,workerMessage:t,modules:this._modules,data:s,promise:r,isRunning:n};return this.fire(Ix,i),n?this.send(s.data):i.promise.then(()=>(this.fire(Td,{worker:this,result:t,modules:this._modules}),this.stop(t)))}send(e){return this._complete||this._modules.dom.setTimeout(()=>this.sync(e),0),this}},L5=class extends zt{constructor(){super(...arguments),this._pool={}}create(e,t){const n=t&&c2,s=this._modules,r=`${e.name||"worker"}-${n?"async":"sync"}`;let i=this._pool[r];i||(i=this._pool[r]=[]);let o=i.find(a=>!a.isBusy());return o?o.configure(e):(o=n?new A5(e,s):new C5(e,s),this._pool[r].push(o)),o.on(Td,()=>{o.clearEvents(),this._pool[r].length<2||(o.destroy(),this._pool[r]=this._pool[r].filter(a=>a!==o))}),o}start(e,t){return e.start(t)}run(e,t,n){const s=this.create(e,n);return this.start(s,t)}destroy(){for(const e in this._pool)this._pool[e].forEach(t=>t.destroy()),delete this._pool[e]}},N5=16,lA="cubicOut",uA={duration:300,locate:!1},I5=class extends zt{constructor(){super(...arguments),this.resolves=new Map,this._running=[],this._textsHidden=!1,this.onInteractionStart=()=>{this.setWorkersIdle(!0)},this.onViewChanged=()=>{this.setWorkersIdle(!1)},this.onVisibilityChange=()=>{$i().hidden?this.setWorkersIdle(!0):this.setWorkersIdle(!1)},this._onWorkerUpdate=(e,t,n,s,r)=>{const{duration:i,onSync:o,onUpdate:a,dryRun:u,locate:d}=s,c=r.workerMessage,g=r.isRunning;if(o&&this._modules.dom.setTimeout(()=>o(c,this._modules,g),i),n){const f=n(c,this._modules,g);this._modules.events.fire("layoutComputed",{type:"layoutComputed",name:t,positions:f}),a&&a(c,f,g);const p=r.promise.then(()=>this._assignNodePositions(f,i,u,s.easing)).then(()=>{g||this._onWorkerComplete(e,f,c,this._layouts[t],s,e.getData())});g||d&&f&&this._animateCamera(f,d,s.duration),r.promise=p.then(()=>{})}else g||e.fire("taskComplete",c)},this._onWorkerComplete=(e,t,n,s,r,i)=>{for(let c=0;c<this._running.length;c++)if(this._running[c]===e){this._running.splice(c,1);break}s.onStop&&t&&s.onStop(r,t,this._modules);const o=this._modules.graph.nodeList(new Uint32Array(i.indexes)),a=r.dryRun&&t?t:this.collectNodesData(o),u=o.getId(),d={before:Lm(i),current:Lm(a)};this._modules.events.fire("layoutEnd",{type:"layoutEnd",name:s.name,positions:d,ids:u}),this._modules.dom.setTimeout(()=>{if(r.onEnd&&r.onEnd(n),r.skipTextDrawing&&this._textsHidden&&(this._modules.graphics.showTexts(),this._textsHidden=!1),!this.resolves.has(e))throw new Error("Worker not found");const c=this.resolves.get(e);this.resolves.delete(e),c({name:s.name,positions:d,ids:u})},10)},this._onWorkerStart=(e,t,n)=>{t.skipTextDrawing&&!this._textsHidden&&(this._modules.graphics.hideTexts(),this._textsHidden=!0);const s=this._modules.graph.getNodes(t.nodes),r=this.collectNodesData(s),i=r.ids;n.setData(r),this._modules.events.fire("layoutStart",{type:"layoutStart",name:e.name,ids:i,worker:n})}}onMounted(){this._layouts={},this.timers=new Map,this.resolves=new Map,this._modules.events.register(["layoutGetData","layoutPrepare","layoutStart","layoutEnd","layoutComputed"]),this._modules.events.on("clearGraph",()=>this.stop()).on(["dragStart","zoomStart"],this.onInteractionStart).on(["dragEnd","viewChanged"],this.onViewChanged),this._modules.dom.addDocumentEventListener("visibilitychange",this.onVisibilityChange)}setWorkersIdle(e){this._running.forEach(t=>t.setIdle(e))}register(e){if(this._layouts[e.name])throw new Error(`Layout ${e.name} already exists`);this._layouts[e.name]=e}getAvailableLayouts(){return Object.keys(this._layouts)}start(e,t={}){const n=this._layouts[e];this._modules.events.fire("layoutPrepare",{name:e,params:t});const s=YC(this._modules.graph,t,["radial","grid"].indexOf(e)===-1);return new Promise(r=>{if(!n)throw new Error(`layout ${e} does not exist`);s.duration=typeof s.duration=="number"?s.duration:uA.duration;const i=n.onSync;s.skipTextDrawing=s.skipTextDrawing===void 0?!0:!!s.skipTextDrawing;let o=s.locate||uA.locate;o&&typeof o=="boolean"&&(o={}),s.locate=o;const a={name:e,update:n.update,isRunning:n.isRunning,configure:n.configure,context:n.context,imports:n.imports,stop:n.stop,setIdle:n.setIdle};this._modules.graphics.forceAttributesComputation();const u=s.useWebWorker===void 0?!0:!!s.useWebWorker,d=this._modules.workers.create(a,u);this.resolves.set(d,r),d.on(lL,()=>{n.onStart&&n.onStart(t),this._onWorkerStart(n,s,d)}).on(uL,c=>{this._modules.events.fire("layoutGetData",{name:e,data:c})}).on(Ix,c=>{const g=c.workerMessage,f=g.lastUpdate||-1/0,p=c.isRunning,_=Rs();p&&(!s.continuous||_-f<N5)||(g.lastUpdate=_,this._onWorkerUpdate(d,e,i,s,c))}),this._modules.workers.start(d,s),this._running.push(d)})}_animateCamera(e,t,n){if(e.indexes.length===0)return Promise.resolve();const s=this._modules.locate.layoutDataBoundingBox(e),r=this._modules.locate.computeConfigForBounds(s,t);return this._modules.camera.setView(r,{duration:n,easing:t.easing||lA,ignoreZoomLimits:!0})}stop(){for(;this._running.length!==0;){const e=this._running.pop();e.stop(),e.fire("taskComplete",null)}return Promise.resolve()}isRunning(){return this._running.length!==0}_assignNodePositions(e,t,n,s=lA){if(!e||n){const d=e?new Uint32Array(e.indexes):void 0,c=this._modules.graph.nodeList(d);return Promise.resolve(c)}const{indexes:r,x:i,y:o}=e,a=this._modules.graph.nodeList(new Uint32Array(r)),u=Lm(e);for(let d=0;d<u.length;d++)u[d]={x:i[d],y:o[d]};return a.setAttributes(u,{duration:t,easing:s})}collectNodesData(e){const t=e._indexes,n=this._modules.graph.getNodeAttribute("x").getMultiple(t),s=this._modules.graph.getNodeAttribute("y").getMultiple(t);return{ids:e.getId(),indexes:t,x:n,y:s}}};function Lm({x:e,y:t,indexes:n}){const s=n.length,r=new Array(s);for(let i=0;i<s;i++)r[i]={x:e[i],y:t[i]};return r}function dA(e){return typeof e=="number"&&isNaN(e)}var hA=class{constructor(){this._keys=[],this._values=[]}set(e,t){const n=this._getIndex(e);return n===-1?(this._keys.push(e.slice()),this._values.push(t),!0):(this._values[n]=t,!1)}get(e){const t=this._getIndex(e);return t===-1?void 0:this._values[t]}has(e){return this._getIndex(e)!==-1}delete(e){const t=this._getIndex(e);return t!==-1&&(this._keys.splice(t,1),this._values.splice(t,1),!0)}keys(){return this._keys.map(e=>e.slice())}values(){return this._values.slice()}_getIndex(e){for(let t=0;t<this._keys.length;t++){const n=this._keys[t];if(n.length===e.length){let s=!0;for(let r=0;r<e.length;r++){const i=n[r],o=e[r];if(!(i===o||dA(i)&&dA(o))){s=!1;break}}if(s)return t}}return-1}get size(){return this._keys.length}},k5=class{constructor(){this._map=new Map,this._arrays=new hA}clear(){return this._arrays=new hA,this._map.clear()}delete(e){return bs(e)?this._arrays.delete(e):this._map.delete(e)}get(e){return bs(e)?this._arrays.get(e):this._map.get(e)}set(e,t){return bs(e)?this._arrays.set(e,t):this._map.set(e,t),this}keys(){return[...fT(this._map),...this._arrays.keys()]}values(){return[...pT(this._map),...this._arrays.values()]}get size(){return this._map.size+this._arrays.size}},M5=class{constructor(e,t,{path:n,filter:s,unwindArrays:r}){this._module=e,this._isNode=t,this._path=n||[],this._filter=s,this._unwindArrays=r,this._onUpdateHandlers=[],this._triggerUpdate=i=>{for(let o=0;o<this._onUpdateHandlers.length;++o)this._onUpdateHandlers[o](i)},this._info=e.watchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}onUpdate(e){this._onUpdateHandlers.push(e)}getPropertyInfo(){return this._info}getPath(){return this._path.slice()}destroy(){this._module.unwatchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}},P5=class{constructor(e,t,{path:n,filter:s,unwindArrays:r}){this._module=e,this._isNode=t,this._path=n,this._filter=s,this._unwindArrays=r,this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[]}get path(){return this._path}onPropertyAdded(e){return this._onAddHandlers.push(e),this}onPropertyRemoved(e){return this._onRemoveHandlers.push(e),this}onPropertyUpdated(e){return this._onUpdateHandlers.push(e),this}getPath(){return this._path.slice()}getProperties(){return this._propertyList.slice()}getPropertyInfo(e){const t=this._properties[e];return t?t.info:null}destroy(){ci(this._properties,({handler:t},n)=>{const s=this._path.concat([n]);this._module.unwatchPropertyInformation(this._isNode,s,t,this._filter,this._unwindArrays)}),this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[];const e=this._module._objectPropertyWatchers.indexOf(this);this._module._objectPropertyWatchers.splice(e,1)}updateSubPropertiesToWatch(e,t){if(e!==this._isNode)return;const n=t.getData(this._path);for(let s=0;s<n.length;s++){const r=n[s];if(Ea(r)){const i=Object.keys(r);for(let o=0;o<i.length;o++)this._addSubPropertyToWatch(i[o])}}}_addSubPropertyToWatch(e){if(!this._properties[e]){const t=this._path.concat([e]),n=()=>this._triggerPropertyUpdate(e),s=this._unwindArrays,r=this._isNode,i=this._filter,o=this._module.watchPropertyInformation(r,t,n,i,s);this._properties[e]={handler:n,info:o},this._triggerPropertyUpdate(e)}}_triggerPropertyUpdate(e){const{info:t}=this._properties[e],n=this._propertyList.indexOf(e),s=n!==-1,r=t.getType()!=="undefined";!s&&r?(this._propertyList.push(e),this._triggerHandlers("_onAddHandlers",e,t),this._triggerHandlers("_onUpdateHandlers",e,t)):s&&!r?(this._propertyList.splice(n,1),this._triggerHandlers("_onUpdateHandlers",e,t),this._triggerHandlers("_onRemoveHandlers",e,t)):s&&r&&this._triggerHandlers("_onUpdateHandlers",e,t)}_triggerHandlers(e,t,n){const s=this[e];for(let r=0,i=s.length;r<i;r++)s[r](t,n)}},R5=class{constructor(){}setWatcher(e){this._watcher=e}isNode(){return this._watcher.isNode}getPath(){return this._watcher.property.slice()}getBoundaries(){const e=this._watcher.boundaries;return e?{min:e.min,max:e.max}:null}getValues(){return this._watcher.values.keys()}getValueCount(e){return this._watcher.values.get(e)||0}getCount(){return this._watcher.total}getType(){return this._watcher.any>0?"any":this._watcher.numbers>0?"number":"undefined"}},F5=class extends zt{constructor(){super(...arguments),this._onExcludedStateChange=({elements:e,value:t})=>{const n=!t;for(let s=0,r=this._propertyWatchers.length;s<r;s++){const i=this._propertyWatchers[s];i.isNode===e.isNode&&i.filter==="visible"&&(n?Ju(i,e.getData(i.property)):eg(i,e.getData(i.property)),Fc(i))}},this._onDataChange=({isNode:e,changes:t})=>{for(let n=0;n<this._propertyWatchers.length;++n){const s=this._propertyWatchers[n],r=s.property,i=s.filter==="all";if(s.isNode===e)for(let o=0;o<t.length;++o){const a=t[o],u=z5(a.property||[],r);if(u){const d=a.nodes||a.edges,c=[],g=[];if(d)for(let f=0;f<d.size;++f){const p=d.get(f);(i||p.isVisible())&&(c.push(On(a.newValues[f],u)),g.push(On(a.previousValues[f],u)))}c.length&&(Ju(s,c),eg(s,g),Fc(s))}}}for(let n=0,s=this._objectPropertyWatchers.length;n<s;n++){const r=this._objectPropertyWatchers[n],i=r.path;for(let o=0;o<t.length;++o){const{property:a,nodes:u,edges:d}=t[o],c=u||d;if(c){const g=c.isNode;(!a||a.length<=i.length+1&&i.every((f,p)=>f===a[p]))&&r.updateSubPropertiesToWatch(g,c)}}}},this._onElementsAdded=e=>{const t=e.nodes||e.edges;for(let n=0;n<this._propertyWatchers.length;++n){const s=this._propertyWatchers[n];if(s.isNode===t.isNode){const r=t.getData(s.property);r.length&&(Ju(s,r),Fc(s))}}for(let n=0;n<this._objectPropertyWatchers.length;n++)this._objectPropertyWatchers[n].updateSubPropertiesToWatch(t.isNode,t)},this._onElementsRemoved=e=>{const t=e.nodes||e.edges;for(let n=0;n<this._propertyWatchers.length;++n){const s=this._propertyWatchers[n],r=s.filter==="all";if(s.isNode===t.isNode&&r){const i=t.getData(s.property);i.length&&(eg(s,i),Fc(s))}}},this._onGraphClear=()=>{this._propertyWatchers.forEach(e=>{e.numbers=0,e.any=0,e.total=0,e.boundaries=null,e.values.clear()})}}onMounted(){this._propertyWatchers=[],this._objectPropertyWatchers=[],this._modules.events.on("excludedStateChange",this._onExcludedStateChange).on(["updateNodeData","updateEdgeData"],this._onDataChange).on(["addNodes","addEdges"],this._onElementsAdded).on(["removeNodes","removeEdges"],this._onElementsRemoved).on("clearGraph",this._onGraphClear)}watchNodeObjectProperty(e){return this._watchObjectProperty(!0,Dc(e))}watchEdgeObjectProperty(e){return this._watchObjectProperty(!1,Dc(e))}watchNodeNonObjectProperty(e){return this._watchNonObjectProperty(!0,Dc(e))}watchEdgeNonObjectProperty(e){return this._watchNonObjectProperty(!1,Dc(e))}watchPropertyInformation(e,t,n,s,r){const i=this._findWatcher(e,t,s,r)||this._createWatcher(e,t,s,r);return n&&i.onChange.push(n),i.info}unwatchPropertyInformation(e,t,n,s,r){const i=this._findWatcher(e,t,s,r);if(!i)return;const o=i.onChange,a=o.indexOf(n);if(a!==-1&&(o.splice(a,1),o.length===0)){const u=this._propertyWatchers.indexOf(i);this._propertyWatchers.splice(u,1)}}_watchObjectProperty(e,t){const n=new P5(this,e,t);return this._objectPropertyWatchers.push(n),n.updateSubPropertiesToWatch(e,this._modules.graph[e?"getNodes":"getEdges"](t.filter)),n}_watchNonObjectProperty(e,t){return new M5(this,e,t)}_findWatcher(e,t,n,s){for(let r=0;r<this._propertyWatchers.length;++r){const i=this._propertyWatchers[r];if(i.isNode===e&&i.filter===n&&i.unwindArrays===s&&O5(i.property,t))return i}return null}_createWatcher(e,t,n,s){const r={isNode:e,property:t,numbers:0,any:0,total:0,values:new k5,boundaries:null,onChange:[],filter:n,unwindArrays:s,info:new R5};return r.info.setWatcher(r),Ju(r,this._modules.graph[e?"getNodes":"getEdges"](n).getData(t)),this._propertyWatchers.push(r),r}};function cA(e){return e==null?[]:ba(e)}function D5(e){return e==="all"?"all":"visible"}function Fc(e){for(let t=0;t<e.onChange.length;++t)e.onChange[t](e.info)}function O5(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}function z5(e,t){if(e.length>t.length)return null;let n=0;for(;n<e.length;++n)if(e[n]!==t[n])return null;return t.slice(n)}function Ju(e,t,n){const s=e.values,r=!n&&e.unwindArrays;for(let i=0;i<t.length;++i){const o=t[i];if(n||o===void 0||(e.total+=1),r&&Array.isArray(o))Ju(e,o,!0);else{const a=s.get(o);a?s.set(o,a+1):(s.set(o,1),nf(o)?(e.boundaries?o<e.boundaries.min?e.boundaries.min=o:o>e.boundaries.max&&(e.boundaries.max=o):e.boundaries={min:o,max:o},e.numbers+=1):o!==void 0&&(e.any+=1))}}}function eg(e,t,n){const s=e.values,r=!n&&e.unwindArrays,i=e.boundaries;let o=!1;for(let a=0;a<t.length;++a){const u=t[a];if(n||u===void 0||(e.total-=1),r&&Array.isArray(u))o=o||eg(e,u,!0);else{const d=s.get(u);d>1?s.set(u,d-1):(s.delete(u),nf(u)?(e.numbers-=1,!i||i.min!==u&&i.max!==u||(o=!0)):u!==void 0&&(e.any-=1))}}return!n&&o&&(e.boundaries=B5(s.keys())),o}function B5(e){let t=null,n=null;for(let s=0;s<e.length;++s){const r=e[s];nf(r)&&((t==null||r<t)&&(t=r),(n==null||r>n)&&(n=r))}return t==null||n==null?null:{min:t,max:n}}function Dc(e){return typeof e!="object"||e===null||Array.isArray(e)?{path:cA(e),filter:"visible",unwindArrays:!1}:{path:cA(e.path),filter:D5(e.filter||"visible"),unwindArrays:!!e.unwindArrays}}var U5=class extends zt{onMounted(){this._modules.events.register(["virtualDown","virtualUp","virtualMove","virtualClick","virtualDoubleClick","virtualWheel"])}get x(){return this._modules.position.x||0}get y(){return this._modules.position.y||0}_later(){return this._modules.dom.afterNextFrame()}move({x:e,y:t}){if(e!==void 0&&t!==void 0){const n=e-this.x,s=t-this.y;this._modules.events.fire("virtualMove",{x:e,y:t,dx:n,dy:s})}return Promise.resolve()}down({x:e,y:t,button:n="left"}={}){return this.move({x:e,y:t}).then(()=>{this._modules.events.fire("virtualDown",{x:this.x,y:this.y,button:n}),this._modules.events.fire("virtualMove",{x:this.x,y:this.y,dx:0,dy:0,button:n})})}up({x:e,y:t,button:n="left"}={}){return this.move({x:e,y:t}).then(()=>{this._modules.events.fire("virtualUp",{x:e,y:t,button:n})})}click({x:e,y:t,button:n="left"}={}){return this.move({x:e,y:t}).then(()=>{this._modules.events.fire("virtualClick",{x:e,y:t,button:n})})}rightClick({x:e,y:t,button:n="right"}={}){return this.move({x:e,y:t}).then(()=>{this._modules.events.fire("virtualClick",{x:e,y:t,button:n})})}doubleclick({x:e,y:t,button:n="left"}={}){return this.move({x:e,y:t}).then(()=>{this._modules.events.fire("virtualDoubleClick",{x:e,y:t,button:n})})}drag(e,t){return this.down(e).then(()=>this.move(t)).then(()=>this.up(t))}wheel({x:e,y:t,dx:n,dy:s,delta:r,metaKey:i,ctrlKey:o}){return this.move({x:e,y:t}).then(()=>(this._modules.events.fire("virtualWheel",{x:e,y:t,dx:n,dy:s,delta:r,domEvent:{metaKey:i,ctrlKey:o}}),this._later()))}};function Cr(e,t,n,s,r,i){const o=or(),a=i.graphToScreenCoordinates(e),u=i.graphToScreenCoordinates(t);r.beginPath(),r.moveTo(a.x*o,a.y*o),r.lineTo(u.x*o,u.y*o),r.strokeStyle=s,r.lineWidth=n,r.stroke()}function gA(e,t,n,s){let r,i,o,a=0,u=e.length-1;for(;a<u&&a>-1;)if(r=(a+u)/2|0,i=Math.abs(t[e[r]]-n),o=Math.abs(t[e[r+1]]-n),o<i)a=r+1;else if(o>i)u=r;else{const d=Math.abs(t[e[a]]-n),c=Math.abs(t[e[u]]-n);if(d<c)u=r;else{if(!(d>c))return u;a=r+1}}return s?u:e[u]}function fA(e,t,n,s,r,i,o){let a,u,d,c,g,f;for(let p=0,_=e.length;p<_;p++)for(let y=0;y<_;y++){if(p===y)continue;let x=e[p],E=e[y];y<p&&(c=E,E=x,x=c);const b=t[x],S=t[E],A=i.get(x),C=i.get(E);if(b+A<s-r&&S-C>s+r&&Math.abs(Math.abs(b+A-(s-r))-Math.abs(S-C-(s+r)))<=o)return a=x,u=n,d=E,f=b+A+Math.abs(S-C-(b+A))/2,g=[b+A,f-r,f+r,S-C],{a,b:u,c:d,current:n,target:f,points:g};if(b+A<s-r&&S+C<s-r&&Math.abs(Math.abs(b+A-(S-C))-Math.abs(Math.max(b+A,S+C)-(s-r)))<=o)return a=x,u=E,d=n,f=S+A+Math.abs(Math.abs(b+A-(S-C)))+r,g=[b+A,S-C,S+C,f-r],{a,b:u,c:d,current:n,target:f,points:g};if(b-A>s+r&&S-C>s+r&&Math.abs(Math.abs(b+A-(S-C))-Math.abs(Math.min(b-A,S-C)-(s+r)))<=o)return a=n,u=x,d=E,f=b-A-Math.abs(Math.abs(b+A-(S-C)))-r,g=[f+r,b-A,b+A,S-C],{a,b:u,c:d,current:n,target:f,points:g}}return null}var Nm={enabled:!1,tolerance:5,centerSnapDistance:240,sideSnapDistanceFactor:3,guidelineWidth:1,guidelineColor:"#ff0000",preferredDistance:{enabled:!0,ratio:1.13,tolerance:10,lineColor:"#00C3FF",lineWidth:1},neighbours:{enabled:!0,offset:5,tolerance:3,lineColor:"#00C3FF",lineWidth:1}},G5=class extends zt{constructor(){super(...arguments),this._options=Bn(Nm),this._enabled=!1,this._ysnap=0,this._xsnap=0,this._node=null,this._nodes=null,this._r=0,this._vguideline={start:{x:0,y:0},end:{x:0,y:0}},this._hguideline={start:{x:0,y:0},end:{x:0,y:0}},this._gridResolution=0,this._onNodeDragStart=({nodes:e})=>{e.size===1&&(this._node=e.get(0),this._cacheViewportData(),this._r=Number(this._node.getAttribute("radius")))},this._onNodeDragEnd=()=>{this._node=null,this._layer.refresh()}}onMounted(){this._options=Bn(Nm),this._enabled=!1}enable(e){this._enabled||(this._options=pr(e,Nm),this._enabled=!0,this._layer=this._modules.layers.addCanvasLayer(t=>{t.clearRect(0,0,t.canvas.width,t.canvas.height)},{isStatic:!0,noClear:!1}),this._layer.moveToTop(),this._modules.events.on("nodesDragStart",this._onNodeDragStart).on("nodesDragEnd",this._onNodeDragEnd),this._modules.settings.update({"interactions.drag.onBeforeDrag":(t,n,s,r)=>this._onBeforeDrag(n,s,r)}))}disable(){this._enabled&&(this._modules.events.off(this._onNodeDragStart).off(this._onNodeDragEnd),this._layer.destroy(),this._modules.settings.update({"interactions.drag.onBeforeDrag":null}),this._enabled=!1)}enabled(){return this._enabled}_onBeforeDrag(e,t,n){if(this._node){const s=n[0];this._layer.refresh(r=>{this._scan(r,s)}),this._node.setAttributes(s)}}_cacheViewportData(){const e=this._modules.camera,t=e.screenToGraphCoordinates({x:0,y:0}),n=e.screenToGraphCoordinates({x:e.width,y:e.height});if(this._nodes=this._modules.spatial.getNodesByBoundingBox(t.x,t.y,n.x,n.y),this._node==null)return;const s=this._node._index,r=Array.from(this._nodes._indexes);r.splice(r.indexOf(s),1);const i=this._modules.graph.getNodeAttribute("radius"),o=this._modules.graph.getNodeAttribute("x"),a=this._modules.graph.getNodeAttribute("y"),u=o.buffer(),d=a.buffer(),c=Gu(r.slice(),o),g=Gu(r.slice(),a),f={},p={};this._gridResolution=Number(this._node.getAttribute("radius"));const _=this._gridResolution;for(let y=0,x=r.length;y<x;y++){const E=c[y],b=g[y],S=u[E]/_|0,A=d[b]/_|0;f[S]||(f[S]=[]),p[A]||(p[A]=[]),f[S].push(E),p[A].push(b)}this._nodesByX=c,this._nodesByY=g,this._xGrid=f,this._yGrid=p,this._xList=o,this._yList=a,this._X=u,this._Y=d,this._R=i}_scan(e,t){if(this._node==null)return;const n=this._node._index,s=t.x,r=t.y,i=this._r,o=this._options,a=this._xList,u=this._yList,d=this._R,c=this._X,g=this._Y,f=this._modules.camera.zoom,p=Math.min(i,this._options.tolerance/f),_=2*i*o.sideSnapDistanceFactor,y=o.guidelineWidth,x=o.guidelineColor;let E,b,S,A,C,k,M,R,O=n,j=n,z=null,X=!1,oe=!1;if(O=gA(this._nodesByX,c,s),j=gA(this._nodesByY,g,r),Math.abs(c[O]-s)>o.centerSnapDistance&&(O=n),Math.abs(g[j]-r)>o.centerSnapDistance&&(j=n),this._xsnap=0,O!==n){E=this._vguideline.start,b=this._vguideline.end,R=O,S=c[R],A=g[R],z=d.get(R),M=Math.abs(s-S);const re=Math.abs(s-i-(S-z)),Q=Math.abs(s+i-(S+z));if(M<Math.max(i,z)){A<r?(E.y=A-z,b.y=r+i):(E.y=A+z,b.y=r-i);const he=Math.min(re,M,Q);he===M?(E.x=b.x=S,b.y=r,E.y=A,this._xsnap=1):Math.abs(r-A)<z+i+_&&(he===re?(E.x=b.x=S-z,this._xsnap=2):(E.x=b.x=S+z,this._xsnap=3)),he<p&&(X=!0)}this._xsnap!==0&&Cr(E,b,y,x,e,this._modules.camera)}if(this._ysnap=0,j!==n){E=this._hguideline.start,b=this._hguideline.end,R=j,S=c[R],A=g[R],z=d.get(R),M=Math.abs(r-A);const re=Math.abs(r-i-(A-z)),Q=Math.abs(r+i-(A+z));if(M<Math.max(i,z)){S<s?(E.x=S-z,b.x=s+i):(E.x=S+z,b.x=s-i);const he=Math.min(re,M,Q);he===M?(E.y=b.y=A,b.x=s,E.x=S,this._ysnap=1):Math.abs(s-S)<z+i+_&&(he===re?(E.y=b.y=A-z,this._ysnap=4):(E.y=b.y=A+z,this._ysnap=5)),he<p&&(oe=!0)}this._ysnap!==0&&Cr(E,b,y,x,e,this._modules.camera)}if(z!=null&&o.preferredDistance.enabled){const re=o.preferredDistance.ratio,Q=Math.min(o.preferredDistance.tolerance/f,i),he=Math.max(i,z);if(O===n||this._xsnap!==0&&X){if(j!==n&&(this._ysnap===0||!oe)&&(R=j,S=c[R],A=g[R],z=d.get(R),k=Math.abs(r-A)-(i+z)*(1+re),k<=Q&&k>=-Q)){const fe=r<A?-1:1;E=this._hguideline.start,b=this._hguideline.end,E.x=S-he,b.x=S+he,E.y=b.y=A,Cr(E,b,y,x,e,this._modules.camera),E.x=s-he,b.x=s+he,E.y=b.y=A+fe*(1+re)*(i+z),Cr(E,b,y,x,e,this._modules.camera),this._ysnap=1,oe=!0}}else if(R=O,S=c[R],A=g[R],z=d.get(R),C=Math.abs(s-S)-(i+z)*(1+re),C<=Q&&C>=-Q){const fe=s<S?-1:1;E=this._vguideline.start,b=this._vguideline.end,E.x=b.x=S+fe*(1+re)*(i+z),E.y=A-he,b.y=A+he,E.x=b.x=S,Cr(E,b,y,x,e,this._modules.camera),E.y=r-he,b.y=r+he,E.x=b.x=S+fe*(1+re)*(i+z),Cr(E,b,y,x,e,this._modules.camera),this._xsnap=1,X=!0}}if(o.neighbours.enabled){const re=this._gridResolution,Q=s/re|0,he=r/re|0,fe=this._xGrid,ae=this._yGrid,me=[],we=[].concat(ae[he-1]||me,ae[he]||me,ae[he+1]||me),Z=[].concat(fe[Q-1]||me,fe[Q]||me,fe[Q+1]||me);let _e;we.length>1&&(Gu(we,a),_e=fA(we,c,n,s,i,d,p),_e&&(this._drawNeighbourGuidelines(e,_e,t,!1),X=!1)),Z.length>1&&!_e&&(Gu(Z,u),_e=fA(Z,g,n,r,i,d,p),_e&&(this._drawNeighbourGuidelines(e,_e,t,!0),oe=!1))}(X||oe)&&this._snap(t,!X,!oe)}_drawNeighbourGuidelines(e,{a:t,b:n,c:s,points:r,target:i},o,a){const u={x:0,y:0},d={x:0,y:0},c=this._R,g=this._X,f=this._Y;let[p,_,y]=c.getMultiple([t,n,s]);const{offset:x,lineWidth:E,lineColor:b}=this._options.neighbours;let S,A;a?(o.y=i,p=-p,_=-_,y=-y,S=d.x=u.x=Math.min(g[t]+p,g[n]+_,g[s]+y)-x,A=g):(o.x=i,S=d.y=u.y=Math.max(f[t]+p,f[n]+_,f[s]+y)+x,A=f);const C=a?"y":"x",k=a?"x":"y";u[C]=r[0],d[C]=r[1],Cr(u,d,E,b,e,this._modules.camera),u[C]=r[2],d[C]=r[3],Cr(u,d,E,b,e,this._modules.camera),u[C]=r[0],u[k]=S-x/2,d[C]=r[0],u[k]=A[t]+p,Cr(u,d,E,b,e,this._modules.camera),u[C]=r[1],u[k]=S-x/2,d[C]=r[1],u[k]=A[n]+_,Cr(u,d,E,b,e,this._modules.camera),u[C]=r[2],u[k]=S-x/2,d[C]=r[2],u[k]=A[n]+_,Cr(u,d,E,b,e,this._modules.camera),u[C]=r[3],u[k]=S-x/2,d[C]=r[3],u[k]=A[s]+y,Cr(u,d,E,b,e,this._modules.camera)}_snap(e,t,n){const s=this._xsnap,r=this._ysnap;let i;t||s===0||(i=this._vguideline.end,e.x=s===2?i.x+this._r:s===3?i.x-this._r:i.x),n||r===0||(i=this._hguideline.end,e.y=r===4?i.y+this._r:r===5?i.y-this._r:i.y)}},V5=class{constructor(e,t,n){this._module=e,this._id=t,this._whenApplied=n.then(()=>this)}getId(){return this._id}whenApplied(){return this._whenApplied}refresh(){return this._module.refreshRule(this._id)}getIndex(){return this._module.getRuleIndex(this._id)}setIndex(e){return this._module.setRuleIndex(this._id,e)}update(e){return this._module.updateRule(this._id,e)}getDefinition(){return this._module.getRuleDefinition(this._id)}destroy(){return this._module.destroyRule(this._id)}},j5=1e3,H5=1/j5,q5=class extends zt{constructor(){super(...arguments),this._idCounter=1,this._rules=[]}onMounted(){this._rules=[],this._modules.events.register(["addStyleRule","removeStyleRule","updateStyleRule","refreshStyleRule"])}_get(e){for(let t=0;t<this._rules.length;++t){const n=this._rules[t];if(n.id===e)return n.index=t,n}throw new Error("calling a method on a destroyed style rule")}_updatePriorities(){for(let e=0;e<this._rules.length;++e){const t=this._rules[e],n=ZM+e*H5;t.attributeLayer.update({priority:n})}}addRule(e={}){const t=this._idCounter++,n=this._modules.graphics.addAttributeLayer({name:`rule(${t})`,...pA(e)}),s=this._modules.dom.afterNextFrame(),r=new V5(this,t,s),i={id:t,attributeLayer:n,wrapper:r};return this._rules.push(i),this._updatePriorities(),this._modules.events.fire("addStyleRule",{rule:i,options:e,id:i.id}),r}getRuleIndex(e){const t=this._get(e);return t.index==null?null:t.index}setRuleIndex(e,t){const n=this._get(e),s=Mr(t,0,this._rules.length-1);return this._rules.splice(n.index,1),this._rules.splice(s,0,n),this._updatePriorities(),this._modules.dom.afterNextFrame()}updateRule(e,t){const n=this._get(e),s=Object.assign({fullOverwrite:t.fullOverwrite},t);return n.attributeLayer.update(s),this._modules.events.fire("updateStyleRule",{rule:n,options:t}),this._modules.dom.afterNextFrame()}getRuleDefinition(e){return pA(this._get(e).attributeLayer.getDefinition())}destroyRule(e){const t=this._get(e);return this._modules.events.fire("removeStyleRule",{rule:t,id:t.id}),t.attributeLayer.destroy(),this._rules.splice(t.index,1),this._modules.dom.afterNextFrame()}refreshRule(e){const t=this._get(e);return t.attributeLayer.updateAll(),this._modules.events.fire("refreshStyleRule",{rule:t,id:e}),this._modules.dom.afterNextFrame()}refreshAllRules(){for(const e of this._rules)e.attributeLayer.updateAll(),this._modules.events.fire("refreshStyleRule",{rule:e,id:e.id});return this._modules.dom.afterNextFrame()}getRuleList(){return this._rules.map(e=>e.wrapper)}};function pA(e){return{nodeAttributes:e.nodeAttributes,edgeAttributes:e.edgeAttributes,nodeSelector:e.nodeSelector,edgeSelector:e.edgeSelector,nodeDependencies:e.nodeDependencies,edgeDependencies:e.edgeDependencies,nodeOutput:e.nodeOutput,edgeOutput:e.edgeOutput}}var ey,li=6,gL=5,ld=1,fL=0,pL=0,ty=-1;function mL(e,t,n,s){fL=e,ey=n,pL=t?1:0,ty=s}var mA=(e,t,n,s)=>r=>{const{rects:i,bboxes:o,intersects:a,indexToLayer:u,indexToRemoveNodeText:d,indexToRemoveEdgeText:c}=s;if(o[r*li+5]===fL&&o[r*li+4]===n)return!1;const g=r*gL,f=jd(i[g],i[g+1],i[g+2],i[g+3],i[g+4]);if(o2(ey,f)){if(s.realIntersection=!0,ty<=0&&a.push(ey,f),!(u[o[r*li+5]]<ty))return!0;e.remove(r),s.realIntersection=!1,o[r*li+4]===pL?d[o[r*li+5]]=!0:c[o[r*li+5]]=!0}return!1};function _A(e,t,n="#22ff00"){return ny([[e[0],e[1]],[e[2],e[1]],[e[2],e[3]],[e[0],e[3]]].map(s=>({x:s[0],y:s[1]})),t,n)}function ny(e,t,n="#ff0000"){t.strokeStyle=n,t.beginPath();for(let s=0,r=e.length;s<r;s++)s===0?t.moveTo(e[s].x,e[s].y):t.lineTo(e[s].x,e[s].y);t.closePath(),t.stroke()}function $5(e,t,n,s,r){for(let a=0,u=t.length;a<u;a+=li)_A(t.slice(a,a+4),e,"#aaaaaa");for(let a=0;a<n.length;a+=gL)ny(jd(n[a],n[a+1],n[a+2],n[a+3],n[a+4]),e,"green");const i=[r.root];let o=r.root;for(;o=i.pop();)o.leaf||i.push.apply(i,o.children),_A(r.getNodeBounds(o),e,"rgba(0,0,0,0.2)"),o=i.pop();s.forEach(a=>ny(a,e,"red"))}var Bu={x1:0,y1:0,x2:0,y2:0},Im={x:0,y:0},ul={x:0,y:0},W5=Math.PI/2,X5=0;function Y5(e,t,n,s,r,i,o,a,u,d,c){const g=a.remove.nodes,f=a.remove.edges,p=a.redraw.edges,_=n.angle,y=n.zoom,x=r.x,E=r.y,b=r.radius,S=Math.PI,{source:A,target:C,scalingMethod:k}=s,M=s.width,R=s.curvature,O=s.layer,j=s.text.content,z=s.text.scaling,X=s.text.size,oe=s.text.font,re=s.text.style,Q=s.text.scale,he=s.text.maxLineLength,fe=s.text.margin,ae=s.text.minVisibleSize,me=s.text.padding,we=s.animationDuration,Z=s.text.adjustAngle,_e=s.text.position;a.indexToLayer={},a.indexToQuadIndex={},a.indexToRemoveNodeText={},a.indexToRemoveEdgeText={},a.indexToRedrawEdgeText={},a.byLayer=[];const{byLayer:ze,indexToLayer:Re,indexToQuadIndex:We,indexToRedrawEdgeText:st,indexToRemoveNodeText:ft,indexToRemoveEdgeText:ut}=a;for(let Oe=0;Oe<e.length;Oe++){const Xe=e[Oe],dt=O.get(Xe)-k1;for(let mt=1;mt<=dt;mt++)(ze[mt]=ze[mt]||[]).push(Xe);Re[Xe]=dt}if(u!==null){const Oe=ze.length;for(let Xe=Re[u]+1;Xe<=Oe;Xe++)(ze[Xe]=ze[Xe]||[]).unshift(u);Re[u]=Oe}const ce=[0,0,0,0],be=[0,0,0,0,0],{bboxes:qe,rects:Ue}=a,Ie=(Oe,Xe=-1)=>{const dt=we.get(Oe);let mt=j?j.get(Oe):"";if(mt===null||mt===""||dt)return!1;const ht=A.get(Oe),wt=C.get(Oe);let Lt=M.get(Oe);const Tt=R.get(Oe),ot=ae.get(Oe);if(Lt*y<ot)return ut[Oe]=!0,!1;k.get(Oe)==="fixed"&&(Lt/=y);let jt=(x.get(ht)+x.get(wt))/2,Nt=(E.get(ht)+E.get(wt))/2;mt=mt?mt.toString():"";const Gt=!z.get(Oe),Wt=Q.get(Oe)*(Gt?1:y),hn=oe.get(Oe),Sn=(Gt?X.get(Oe):Wt*Lt)*ld,Jn=re.get(Oe),Wn=he.get(Oe),Un=_e.get(Oe)===Gd;let Xn=+Un*fe.get(Oe)+s.text.padding.get(Oe);const Gn=x.get(ht),is=E.get(ht),Vn=x.get(wt),An=E.get(wt),Yn=b.get(ht),xn=b.get(wt);if(Tt===0){const Bt=Ol(Gn,is,Vn,An)-_,os=Yn-xn;jt+=os*Math.cos(Bt)/2,Nt+=os*Math.sin(Bt)/2}let fn;const Ht=ht===wt;if(Ht)fn=S/4-_,rf(Gn,is,Tt,Yn,0,Bu),xd(.5,Gn,is,Vn,An,Bu.x1,Bu.y1,Bu.x2,Bu.y2,ul),jt=ul.x,Nt=ul.y,Xn/=-y;else{if(Gn===Vn&&is===An)return!1;fn=Ol(Gn,is,Vn,An)-_,Tt!==0&&(Ca(Gn,is,Vn,An,Tt,Im),af(.5,Gn,is,Vn,An,Im.x,Im.y,ul),jt=ul.x,Nt=ul.y)}const vt=Xn+X5,Pn=RT(mt,Wn);if(!Pn)return!1;const{lines:Zn,data:qt}=Pn;let cn=i(qt[0],hn,Jn,Sn).width*ld;for(let Bt=1;Bt<Zn;Bt++)cn=Math.max(cn,i(qt[Bt],hn,Jn,Sn).width*ld);const on=Zn*Sn,vn=cn/y/2,wn=on/y/2,Rn=Math.abs(ug(fn))<W5?1:-1;let jn=Un?Ht?on/y+Lt/2+Xn:Rn*(vt/y+Lt/2+wn):0;if(!Ht&&Tt===0&&Z.get(Oe)){const Bt=me.get(Oe);ss(Gn,is,Vn,An)*y-(Yn+xn)*(c?1:y)<cn+2*Bt+1&&(jn*=Rn,fn=0)}if(be[0]=jt-vn,be[1]=Nt-wn,be[2]=jt+vn,be[3]=Nt+wn,be[4]=fn+_,B_(be,-(fn+_),-jn,be),be[2]=be[2]-be[0],be[3]=be[3]-be[1],fn=S-fn-_,cf(jt-vn,Nt-wn,2*vn,2*wn,fn,void 0,void 0,ce),B_(ce,fn,jn,ce),a.realIntersection=!1,mL(Oe,!1,jd(be[0],be[1],be[2],be[3],be[4]),Xe),t.traverse(ce[0],ce[1],ce[2],ce[3],d),a.realIntersection&&!o)return ut[Oe]=!0,!1;if(st[Oe]=!0,ft[Oe]=!1,Xe<=0){const Bt=qe.length/li;We[Oe]=Bt,qe.push(ce[0],ce[1],ce[2],ce[3],0,Oe),t.insert(Bt,ce[0],ce[1],ce[2],ce[3]),Ue.push(be[0],be[1],be[2],be[3],be[4])}else t.insert(We[Oe],ce[0],ce[1],ce[2],ce[3])};for(const Oe of e)Ie(Oe);let Fe=!0;for(let Oe=0;Oe<ze.length;Oe++){const Xe=ze[Oe];if(Xe)if(Fe)Fe=!1;else for(const dt of Xe)Ie(dt,Oe)}for(let Oe=0;Oe<e.length;Oe++){const Xe=e[Oe];ft[Xe]?g.push(Xe):st[Xe]&&p.push(Xe),ut[Xe]&&f.push(Xe)}return a}var Z5={left:-1,right:1,top:0,bottom:0,center:0},K5={left:0,right:0,top:-1,bottom:1,center:0},Q5={left:-1,right:0,top:-.5,bottom:-.5,center:-.5},J5={left:-.5,right:-.5,top:-1,bottom:0,center:-.5},ej=(e,t,n)=>RT(t,n.get(e))||{lines:0,data:[" "],maxLength:1},tj=(e,t,n,s,r,i,o)=>{const{lines:a,data:u}=ej(e,t,s);let d=n(u[0],r,i,o).width;for(let c=1;c<a;c++)d=Math.max(d,n(u[c],r,i,o).width);return[d,a*o*ld]},nj=(e,t,n)=>{const s=t.text.content,r=t.radius,i=t.text.scaling,o=t.text.position,a=t.text.padding,u=t.text.scale,d=t.text.size,c=t.text.style,g=t.text.font,f=t.text.maxLineLength,p=t.text.margin,_=s.get(e),y=r.get(e),x=!i.get(e),E=o.get(e),b=a.get(e),S=u.get(e),A=(x?d.get(e):S*y*2)*ld,C=c.get(e),k=g.get(e),M=b+p.get(e),R=Z5[E],O=K5[E],[j,z]=tj(e,`${_}`,n,f,k,C,A),X=j/2,oe=z/2;return[Q5[E]*j,J5[E]*z,R*M,O*M,R*y,O*y,j,z,X,oe]};function sj(e,t,n,s,r,i,o,a,u){const d=o.remove.nodes,c=o.remove.edges,g=o.redraw.nodes,f=n.angle,p=n.zoom,_=n.sin,y=n.cos,x=s.x,E=s.y,b=s.radius,S=s.layer,A=s.scalingMethod,C=s.text.content,k=s.text.scaling,M=s.text.minVisibleSize,R=s.animationDuration,O=s.textHidden,j=s.excluded;o.indexToLayer={},o.indexToQuadIndex={},o.indexToRemoveNodeText={},o.indexToRemoveEdgeText={},o.indexToRedrawNodeText={},o.byLayer=[];const{indexToLayer:z,indexToRedrawNodeText:X,indexToRemoveNodeText:oe,indexToRemoveEdgeText:re,indexToQuadIndex:Q,byLayer:he}=o;for(let Re=0;Re<e.length;Re++){const We=e[Re],st=S.get(We)-k1;(he[st]=he[st]||[]).push(We),z[We]=st}if(a!==null){const Re=he.length;for(let We=z[a]+1;We<=Re;We++)(he[We]=he[We]||[]).unshift(a);z[a]=Re}let fe;const ae=[0,0,0,0],me=[0,0,0,0,0],{bboxes:we,rects:Z}=o,_e=(Re,We=-1)=>{const st=R.get(Re);let ft=C.get(Re);if(ft===null||ft===""||st!==0)return!1;let ut=b.get(Re);const ce=M.get(Re);if(j.get(Re)===1)return oe[Re]=!0,!1;if(2*ut*p<ce)return O.get(Re)===0&&(oe[Re]=!0),!1;A.get(Re)==="fixed"&&(ut/=p);const be=x.get(Re),qe=E.get(Re);typeof ft=="number"&&(ft=ft.toString());let[Ue,Ie,Fe,Oe,Xe,dt,mt,ht,wt,Lt]=r(Re);const Tt=!k.get(Re),ot=Tt?p:1,jt=A.get(Re)==="fixed"?p:1;Tt?(Fe+=wt,Oe+=Lt,wt/=p,Lt/=p,mt/=p,ht/=p):(Fe+=wt*p,Oe+=Lt*p),Ue=Ue/ot+Fe/p+Xe/jt,Ie=Ie/ot+Oe/p+dt/jt,cf(be-wt,qe-Lt,mt,ht,-f,_,-y,ae),me[0]=be-wt,me[1]=qe-Lt,me[2]=mt,me[3]=ht,me[4]=f;const Nt=y*Ue-_*Ie,Gt=_*Ue+y*Ie;if(ae[0]+=Nt,ae[1]+=Gt,ae[2]+=Nt,ae[3]+=Gt,me[0]+=Nt,me[1]+=Gt,o.realIntersection=!1,mL(Re,!0,jd(me[0],me[1],me[2],me[3],me[4]),We),t.traverse(ae[0],ae[1],ae[2],ae[3],u),o.realIntersection&&!i)return oe[Re]=!0,!1;X[Re]=!0,oe[Re]=!1,We<=0?(fe=we.length/li,Q[Re]=fe,we.push(ae[0],ae[1],ae[2],ae[3],1,Re),t.insert(fe,ae[0],ae[1],ae[2],ae[3]),Z.push(me[0],me[1],me[2],me[3],me[4])):t.insert(Q[Re],ae[0],ae[1],ae[2],ae[3])};for(const Re of e)_e(Re);let ze=!0;for(let Re=0;Re<he.length;Re++){const We=he[Re];if(We)if(ze)ze=!1;else for(const st of We)_e(st,Re)}for(let Re=0;Re<e.length;Re++){const We=e[Re];oe[We]?d.push(We):X[We]&&g.push(We),re[We]&&c.push(We)}return o}var rj=1,ij="topDown",oj="bottomUp",aj=.15,lj=200,uj=80,dj=["x","y","radius","width","layer","text.content","text.minVisibleSize","text.size","text.scale","text.scaling","text.padding","text.margin","text.position","text.style"].reduce((e,t)=>(e.add(t),e),new Set),hj=class extends zt{constructor(e,t){super(e),this._textBBoxes=[],this._rects=[],this._enabled=!1,this._geoEnabled=!1,this._intersects=[],this._textDisplacement={},this._textDisplacementUpdate={},this._skipFrames=!1,this._output={remove:{nodes:[],edges:[]},redraw:{nodes:[],edges:[]},rects:this._rects,bboxes:this._textBBoxes,intersects:this._intersects,realIntersection:!1,indexToLayer:{},byLayer:[],indexToRedrawEdgeText:{},indexToRemoveEdgeText:{},indexToRedrawNodeText:{},indexToRemoveNodeText:{},indexToQuadIndex:{}},this._onZoomStart=Ug(({startZoom:n,endZoom:s})=>{this._enabled&&s<n&&this._updateLabels(this._modules.camera.clone({zoom:s}))},uj),this._onAttributesChanged=n=>{if([...n.edgeAttributes,...n.nodeAttributes].some(s=>dj.has(s))){const s=n.nodes._indexes;for(let r=0;r<s.length;r++)this._textDisplacementUpdate[s[r]]=!0;this._update()}},this._onToggle=n=>(n?this._update():this._reset(),this),this._update=()=>{(this._enabled||this._forceEnabled)&&this._updateDebounced()},this._toggleDebug=n=>{n?this._modules.layers.whenReady(()=>{this._layer=this._modules.layers.addCanvasLayer(s=>{s.lineWidth=1/this._modules.camera.getZoom(),$5(s,this._textBBoxes,this._rects,this._intersects,this._quadtree)},{isStatic:!1,noClear:!1}),this._layer.moveToTop(),this._canvas=this._layer.element,this._ctx=this._canvas.getContext("2d"),this._update()}):this._canvas&&(this._layer.destroy(),this._canvas=this._ctx=null)},this._measureText=(n,s,r,i)=>this._engine.measureText(n,s,r,i),this._textDisplacement={},this._textDisplacementUpdate={},this._quadtree=new $1(n=>{const s=li,r=s*n;return this._textBBoxes.slice(r,r+s)},rj),t.forceEnableTextOverlapRemoval&&this.forceEnable()}onMounted(){this._engine=this._modules.graphics.getGraphicsEngine(),this._modules.events.register(["labelCollisionsRemoved"]),this.setRate(lj),this._modules.settings.register("texts.preventOverlap",!0,this._onToggle),this._modules.settings.register("texts.debug",!1,this._toggleDebug),this._modules.settings.register("texts.removalStrategy",ij);const e=this._output;this._nodeTraversal=mA(this._quadtree,!1,1,e),this._edgeTraversal=mA(this._quadtree,!1,0,e),this._modules.events.on(["layoutEnd","locate"],()=>this._updateLabels()).on(["viewChanged","mouseover","mouseout"],this._update).on("updateAttributes",this._onAttributesChanged).on("setContainer",({element:t})=>{if(t)return this._enable();this._disable()}).on("zoomStart",this._onZoomStart).on("viewExportStart",({preventOverlap:t,camera:n})=>{t&&this.forceUpdate(n)}).on("viewExportEnd",()=>{this.forceUpdate()}).on("geoEnabled",()=>this._geoEnabled=!0).on("geoDisabled",()=>this._geoEnabled=!1)}getTextsBoundingBox(e,t){if(this._skipFrames=!0,e||t?this._updateLabels(this._modules.camera,e?Array.from(e._indexes):[],t?Array.from(t._indexes):[]):this._updateLabels(),this._skipFrames=!1,this._rects===void 0)throw new Error("this._rects is undefined");const n=this._rects,s=new Ws;for(let r=0;r<n.length;r+=5){const i=n[r],o=n[r+1],a=n[r+2],u=n[r+3],d=n[r+4],[c,g,f,p]=cf(i,o,a,u,d);s.addPoint(c,g).addPoint(f,p)}return s}setRate(e){this._updateDebounced=this._modules.sync.debounceIdle(t=>this._updateLabels(t),e)}forceEnable(){this._forceEnabled=!0}update(){this._update()}forceUpdate(e=this._modules.camera){this._updateLabels(e)}_enable(){this._enabled=!0,this._update()}_disable(){this._textBBoxes=[],this._rects=[],this._intersects=[],this._enabled=!1}_onCameraMove(){this._update()}_updateLabels(e=this._modules.camera,t,n){if(!this._modules.settings.get("texts.preventOverlap"))return;const s=this._modules.graphics.getNodeAttributes(),r=this._modules.graphics.getEdgeAttributes();this._intersects=[],this._textBBoxes=[],this._rects=[];const i=e.getAngle(),o=e.getProjectedScreenBounds(aj),a=this._modules.settings.get("texts.removalStrategy")===oj,u={angle:i,zoom:e.zoom,sin:Math.sin(i),cos:Math.cos(i)};this._resetOutput();const d=this._output;if(!t||!n){const _=this._modules.spatial.queryRaw(o[0],o[1],o[2],o[3]);t=_.nodes,n=_.edges}const c=this._quadtree.clear().cover(o[0],o[1],o[2],o[3]);if(t.length+n.length===0)return;const g=this._modules.captor.getPointedElement();let f=null,p=null;g!==null&&(g.isNode?f=g._index:p=g._index);for(const _ of t)!this._textDisplacementUpdate[_]&&this._textDisplacement[_]||(this._textDisplacement[_]=nj(_,s,this._measureText),this._textDisplacementUpdate[_]=!1);sj(t,c,u,s,_=>this._textDisplacement[_],a,d,f,this._nodeTraversal),Y5(n,c,u,r,s,this._measureText,a,d,p,this._edgeTraversal,this._geoEnabled),this._skipFrames||this._clearOverlaps(this._output),this._modules.settings.get("texts.debug")&&this._layer.refresh()}_clearOverlaps(e){const t=this._modules.graph.nodeList,n=this._modules.graph.edgeList,s=this._modules.graphics,r=t(new Uint32Array(e.remove.nodes)),i=n(new Uint32Array(e.remove.edges)),o=t(new Uint32Array(e.redraw.nodes)),a=n(new Uint32Array(e.redraw.edges));s.setTextHidden(r,!0),s.setTextHidden(i,!0),s.setTextHidden(o,!1),s.setTextHidden(a,!1),this._modules.events.fire("labelCollisionsRemoved",e)}_resetOutput(){const e=this._output;e.remove.nodes=[],e.remove.edges=[],e.redraw.nodes=[],e.redraw.edges=[],e.rects=this._rects,e.bboxes=this._textBBoxes,e.intersects=this._intersects,e.realIntersection=!1,e.indexToLayer={},e.byLayer=[],e.indexToRedrawEdgeText={},e.indexToRemoveEdgeText={},e.indexToRedrawNodeText={},e.indexToRemoveNodeText={},e.indexToQuadIndex={}}_reset(){this._modules.graphics.resetTextHidden(),this._textDisplacement={},this._textDisplacementUpdate={}}},cj=class extends zt{constructor(){super(...arguments),this._onStartInteractionEvent=(e,t)=>{if(this._current)return;const n=this._interactionsByStartEvent[t];let s;for(const r of n)r.check(e)&&(!s||r.priority>=s.priority)&&(s=r);s&&this._startInteraction(s,e)},this._onProgressInteractionEvent=(e,t)=>{this._current&&this._current.progressEventName===t&&this._current.onProgress&&this._current.onProgress(e)},this._onStopInteractionEvent=(e,t)=>{this._current&&this._current.stopEventName===t&&this._stopCurrentInteraction(null)}}onMounted(){this._interactionsByStartEvent={},this._boundProgressEvents={},this._boundStopEvents={}}_startInteraction(e,t){e.onStart&&e.onStart(t),e.onStop&&(this._current=e,e.disableDetection&&this._modules.captor.setDetectionEnabled(!1))}_stopCurrentInteraction(e){this._current&&this._current.disableDetection&&this._modules.captor.setDetectionEnabled(!0),this._current&&this._current.onStop&&this._current.onStop(e),this._current=void 0}_forceStartInteraction(e,t){this._current&&this._stopCurrentInteraction(t),this._startInteraction(e,t)}_createWrapper(e){return{start:t=>this._forceStartInteraction(e,t)}}_addInteraction(e,t){const n=this._interactionsByStartEvent[e];return n?n.push(t):(this._interactionsByStartEvent[e]=[t],this._modules.events.on(e,this._onStartInteractionEvent)),this._createWrapper(t)}_createProgressiveInteraction(e,t,n,s){const r={priority:yA(s.priority),check:s.check||sg,onStart:s.onStart||Vt,onProgress:s.onProgress||Vt,onStop:s.onStop||Vt,disableDetection:!!s.disableDetection,progressEventName:t,stopEventName:n};return this._boundProgressEvents[t]||(this._boundProgressEvents[t]=!0,this._modules.events.on(t,this._onProgressInteractionEvent)),this._boundStopEvents[n]||(this._boundStopEvents[n]=!0,this._modules.events.on(n,this._onStopInteractionEvent)),this._addInteraction(e,r)}_createNonProgressiveInteraction(e,t){return this._addInteraction(e,{priority:yA(t.priority),check:t.check||sg,onStart:t.handler||Vt,onProgress:void 0,onStop:void 0,disableDetection:!1,progressEventName:void 0,stopEventName:void 0})}onDrag(e){return this._createProgressiveInteraction("dragStart","dragProgress","dragEnd",e)}onGesture(e){return this._createProgressiveInteraction("gestureStart","gestureProgress","gestureEnd",e)}onClick(e){return this._createNonProgressiveInteraction("click",e)}onDoubleClick(e){return this._createNonProgressiveInteraction("doubleclick",e)}onHover(e){return this._createNonProgressiveInteraction("mouseover",e)}onUnhover(e){return this._createNonProgressiveInteraction("mouseout",e)}onMouseWheel(e){return this._createNonProgressiveInteraction("mousewheel",e)}onMouseDown(e){return this._createNonProgressiveInteraction("mousedown",e)}onMouseUp(e){return this._createNonProgressiveInteraction("mouseup",e)}onMouseMove(e){return this._createNonProgressiveInteraction("mousemove",e)}};function yA(e){return typeof e=="string"?sP.indexOf(e):typeof e!="number"||isNaN(e)?0:e}var gj=["virtualUp","mouseupInternal","touchUp"],fj=["virtualDown","mousedownInternal","touchDown"],pj=["virtualMove","mousemoveInternal","touchMove"],mj=["virtualClick","clickInternal","touchTap"],_j=["virtualDoubleClick","doubleclickInternal","touchDoubleTap"],yj=["virtualWheel","mousewheelInternal"],xj=100,vj=class extends zt{constructor(){super(...arguments),this.spatialIndexMarginRatio=5,this._elt=null,this._hoveredElt=null,this._draggedElt=null,this._hover=!1,this._disabledCounter=0,this._accDx=0,this._accDy=0,this._prevX=0,this._prevY=0,this._buttons={left:{isPressed:!1,isDragging:!1},middle:{isPressed:!1,isDragging:!1},right:{isPressed:!1,isDragging:!1}},this._onGraphChanged=()=>{this._resetCurrent(this._modules.position.x,this._modules.position.y),this._onMove({x:this._modules.position.x,y:this._modules.position.y,source:null,domEvent:null})}}onMounted(){this._modules.events.register(["mousemove","mousedown","mouseup","click","doubleclick","mousewheel","mouseout","mouseover","dragStart","dragProgress","dragEnd","gestureStart","gestureProgress","gestureEnd"]),this._modules.settings.register("detect.nodes",!0).register("detect.edges",!0).register("detect.nodeTexts",!0).register("detect.nodeBadges",!0).register("detect.edgeTexts",!0).register("detect.nodeErrorMargin",5).register("detect.edgeErrorMargin",2).register("detect.enableSpatialIndex",!0),this._modules.events.on(["removeNodes","removeEdges","clearGraph"],this._onGraphChanged).on(pj,(e,t)=>{this._onMove({...e,source:sa(t)})}).on(fj,({domEvent:e,x:t,y:n,button:s="left"},r)=>{this._onDown({domEvent:e,x:t,y:n,button:s,source:sa(r)})}).on(gj,({domEvent:e,x:t,y:n,button:s="left"},r)=>{this._onUp({domEvent:e,x:t,y:n,button:s,source:sa(r)})}).on(mj,({domEvent:e,x:t,y:n,button:s="left"},r)=>{this._onClick({domEvent:e,x:t,y:n,button:s,source:sa(r)})}).on(_j,({domEvent:e,x:t,y:n,button:s="left"},r)=>{this._onDoubleClick({domEvent:e,x:t,y:n,button:s,source:sa(r)})}).on(yj,({domEvent:e,x:t,y:n,delta:s,dx:r,dy:i})=>this._onWheel({domEvent:e,x:t,y:n,delta:s,source:"mouse",dx:r,dy:i})).on("touchStartGesture",e=>this._modules.events.fire("gestureStart",e)).on("touchProgressGesture",e=>this._modules.events.fire("gestureProgress",e)).on("touchEndGesture",e=>this._modules.events.fire("gestureEnd",e)).on("documentMouseMove",({domEvent:e,x:t,y:n},s)=>{this._onDocumentMove({domEvent:e,x:t,y:n,source:sa(s)})}).on("documentMouseUp",({domEvent:e,x:t,y:n,button:s="left"},r)=>{this._onDocumentUp({domEvent:e,x:t,y:n,source:sa(r),button:s})})}triggerUnhover(){this._hover=!1,this._hoveredElt=null}triggerDetection(){this._detectElement(this._modules.position.x,this._modules.position.y,!1,!1),this._elt&&(this._hoveredElt=this._elt,this._hover=!0)}getPointedElement(){return this._hoveredElt}getDraggedElement(){return this._draggedElt}isAnyButtonPressed(){return this._buttons.left.isPressed||this._buttons.right.isPressed||this._buttons.middle.isPressed}isAnyButtonDragging(){return this._buttons.left.isDragging||this._buttons.right.isDragging||this._buttons.middle.isDragging}isButtonPressed(e){return this._buttons[e].isPressed}isLeftPressed(){return this.isButtonPressed("left")}getCursorPosition(){return{x:this._modules.position.x,y:this._modules.position.y}}getCursorInformation(){return{x:this._modules.position.x,y:this._modules.position.y,target:this._hoveredElt}}setDetectionEnabled(e){this._disabledCounter=Math.max(0,this._disabledCounter+(e?-1:1))}_resetCurrent(e,t){for(const n in this._buttons){const s=this._buttons[n];s.isDragging&&this._modules.events.fire("dragEnd",{domEvent:null,x:e,y:t,button:n,target:this._draggedElt}),s.isPressed=!1,s.isDragging=!1}this._hover&&this._hoveredElt&&this._modules.events.fire("mouseout",{domEvent:null,x:e,y:t,target:this._hoveredElt}),this._hover=!1,this._hoveredElt=null,this._draggedElt=null}_onMove({domEvent:e,x:t,y:n,source:s}){let{dx:r,dy:i}=this._setPointerPosition(t,n);this._modules.events.fire("mousemove",{domEvent:e,x:t,y:n,dx:r,dy:i,source:s});for(const o in this._buttons){const a=this._buttons[o];if(a.isPressed)if(a.isDragging){const u=this._getStoredDXY();r+=u.dx,i+=u.dy,this._modules.events.fire("dragProgress",{domEvent:e,x:t,y:n,dx:r,dy:i,button:o,source:s,target:this._draggedElt})}else a.isDragging=!0,this._hoveredElt&&this._hover&&(this._modules.events.fire("mouseout",{domEvent:e,x:t,y:n,source:s,target:this._hoveredElt}),this._hover=!1),this._draggedElt||(this._draggedElt=this._hoveredElt),this._storeDXY(r,i),this._modules.events.fire("dragStart",{domEvent:e,x:t,y:n,button:o,source:s,target:this._draggedElt})}e&&!this._modules.graphics.getDomElement().contains(e.target)||this._detectElement(t,n,!1,!1),this._elt!==this._hoveredElt&&(this._hoveredElt&&this._hover&&(this._hover=!0,this._modules.events.fire("mouseout",{domEvent:e,x:t,y:n,source:s,target:this._hoveredElt})),this._hoveredElt=this._elt,this._elt&&(this._hover=!0,this._modules.events.fire("mouseover",{domEvent:e,x:t,y:n,source:s,target:this._hoveredElt})))}_onDocumentMove({domEvent:e,x:t,y:n,source:s}){for(const r in this._buttons){const{isDragging:i}=this._buttons[r];if(i){const{dx:o,dy:a}=this._setPointerPosition(t,n);this._modules.events.fire("dragProgress",{domEvent:e,x:t,y:n,dx:o,dy:a,button:r,source:s,target:this._draggedElt})}}}_onDocumentUp({domEvent:e,x:t,y:n,source:s,button:r}){if(r!=null&&this._buttons[r].isDragging){this._modules.events.fire("dragEnd",{domEvent:e,x:t,y:n,button:r,source:s,target:this._draggedElt});const i=this._buttons[r];i.isDragging=!1,i.isPressed=!1,this.isAnyButtonDragging()||(this._draggedElt=null)}}_onDown({domEvent:e,x:t,y:n,button:s,source:r}){if(s==null)return;this._detectElement(t,n,!1,!1),this._elt!==this._hoveredElt&&this._resetCurrent(t,n);const i=this._buttons[s];this._hoveredElt=this._elt,i.isPressed=!0,this._elt&&e&&(e.stopPropagation(),e.preventDefault()),this._modules.events.fire("mousedown",{domEvent:e,x:t,y:n,button:s,source:r,target:this._hoveredElt})}_onDoubleClick({domEvent:e,x:t,y:n,button:s,source:r}){s!=null&&(vA(e,"doubleclick")||this._modules.events.fire("doubleclick",{domEvent:e,x:t,y:n,button:s,source:r,target:this._hoveredElt}))}_onUp({domEvent:e,x:t,y:n,button:s,source:r}){if(s==null)return;const i=this._buttons[s];i.isPressed&&(i.isDragging&&(this._modules.events.fire("dragEnd",{domEvent:e,x:t,y:n,button:s,source:r,target:this._draggedElt}),i.isDragging=!1,this.isAnyButtonDragging()||(this._draggedElt=null)),i.isPressed=!1,this._detectElement(t,n,!1,!1),this._modules.events.fire("mouseup",{domEvent:e,x:t,y:n,button:s,source:r,target:this._elt}),this.isAnyButtonPressed()||this._hover||r==="touch"||(this._hoveredElt=this._elt,this._hoveredElt&&(this._modules.events.fire("mouseover",{domEvent:e,x:t,y:n,source:r,target:this._hoveredElt}),this._hover=!0)))}_onClick({domEvent:e,x:t,y:n,button:s,source:r}){vA(e,"click")||this._modules.events.fire("click",{domEvent:e,x:t,y:n,button:s,source:r,target:this._hoveredElt})}_onWheel({domEvent:e,x:t,y:n,delta:s,source:r,dx:i,dy:o}){this._modules.position.x=t,this._modules.position.y=n,this._modules.events.fire("mousewheel",{domEvent:e,x:t,y:n,dx:i,dy:o,delta:s,source:r,target:this._hoveredElt})}_storeDXY(e,t){this._accDx=e,this._accDy=t}_getStoredDXY(){const e=this._accDx,t=this._accDy;return this._accDx=0,this._accDy=0,{dx:e,dy:t}}_setPointerPosition(e,t){const n=e-this._prevX,s=t-this._prevY;return this._modules.position.x=e,this._modules.position.y=t,this._prevX=e,this._prevY=t,this._accDx=0,this._accDy=0,{dx:n,dy:s}}_detectElement(e,t,n,s){this._elt=this.detectElementAt(e,t,n,s)}detectElementAt(e,t,n,s){if(this._disabledCounter!==0)return null;const r=this._modules.settings,i=r.get("detect.enableSpatialIndex"),o=r.get("detect.nodeErrorMargin")||0,a=r.get("detect.edgeErrorMargin")||0;let u=r.get("detect.nodes"),d=r.get("detect.edges");s&&(u=!0,d=!0);let c=null,g=[],f=[];if(!n&&i&&(u||d)){const y=this.spatialIndexMarginRatio,x=Math.max(o*y,a*y),E=this._modules.spatial.queryRawProjected(e-x,t-x,e+x,t+x);g=E.nodes,f=E.edges}let p=null,_=null;if(u&&(p=this._modules.graphics.detectNode(e,t,!!r.get("detect.nodeTexts"),!!r.get("detect.nodeBadges"),o,g)),d&&(f.length<xj||!p)&&(_=this._modules.graphics.detectEdge(e,t,!!r.get("detect.edgeTexts"),a,f)),p&&_){const y=this._modules.graphics.getAttributesManager().getFlexArrays();c=y.nodes.current.layer.get(p._index)>=y.edges.current.layer.get(_._index)?p:_}else p?c=p:_&&(c=_);return c}};function sa(e){return e.indexOf("touch")===0?"touch":"mouse"}var km=!1,xA={down:{trigger:"pointerdown",duplicate:"mousedown"},click:{trigger:"pointerdown",duplicate:"mouseup"},doubleclick:{trigger:"pointerdown",duplicate:"mouseup"}};function vA(e,t){if(e)return e.type===xA[t].trigger&&(km=!0),e.type===xA[t].duplicate&&km?(km=!1,!0):void 0}var bj=class extends zt{constructor(){super(...arguments),this._dragged=null,this._start=[],this._end=[],this._shouldDrag=({target:e,button:t})=>{const n=t==="left",s=this._modules.settings.get("interactions.drag.enabled"),r=e!==null&&e.isNode&&e.getAttribute("draggable")===!0;return!!(n&&s&&r)},this._onDragStart=({x:e,y:t,target:n})=>{n&&(n.isSelected()?this._dragged=this._modules.selection.getSelectedNodes().filter(s=>s.getAttribute("draggable")):this._dragged=n.toList()),this._dragged&&(this._start=this._dragged.getPosition(),this._end=Bn(this._start),this._onBeforeDrag=this._modules.settings.get("interactions.drag.onBeforeDrag"),this._startDrag=this._modules.camera.screenToGraphCoordinates({x:e,y:t}),this._dragged.addClass($c),this._modules.events.fire("nodesDragStart",{nodes:this._dragged}),this._modules.graphics.addCursorStyle(this._modules.settings.get("interactions.drag.cursor")))},this._onDrag=()=>{if(!this._dragged||!this._startDrag)return;const{x:e,y:t}=this._modules.captor.getCursorInformation(),n=this._dragged._indexes,s=this._modules.camera.screenToGraphCoordinates({x:e,y:t}),r=s.x-this._startDrag.x,i=s.y-this._startDrag.y;for(let o=0;o<n.length;++o){const a=this._start[o],u=this._end[o];u.x=a.x+r,u.y=a.y+i}this._onBeforeDrag&&this._onBeforeDrag(this._dragged,e,t,this._end),this._modules.settings.get("interactions.drag.applyResult")&&this._modules.individualAttributes.setMultipleAttributes(this._dragged,this._end),this._modules.events.fire("nodesDragProgress",{nodes:this._dragged,dx:r,dy:i})},this._onDragEnd=()=>{this._dragged&&(this._dragged.removeClass($c),this._modules.graphics.removeCursorStyle(this._modules.settings.get("interactions.drag.cursor")),this._modules.events.fire("nodesDragEnd",{nodes:this._dragged,start:this._start,end:this._end}),this._dragged=null,this._start=[],this._end=[])}}onMounted(){this._modules.classes.createClass({name:$c,isBuiltin:!0,nodeAttributes:{layer:tP}}),this._modules.events.register(["nodesDragStart","nodesDragProgress","nodesDragEnd"]),this._modules.settings.register("interactions.drag.enabled",!0).register("interactions.drag.cursor","move").register("interactions.drag.onBeforeDrag",void 0),this._modules.settings.register("interactions.drag.applyResult",!0),this._modules.interactions.onDrag({priority:"drag",disableDetection:!0,check:this._shouldDrag,onStart:this._onDragStart,onProgress:this._onDrag,onStop:this._onDragEnd})}},Ej={color:"#00C3FF",radius:4,cursorOnHover:"grab",cursorOnDrag:"grabbing"},Sj=class extends zt{constructor(){super(...arguments),this._hoverHandle=!1,this._grabHandle=!1,this._x=0,this._y=0,this._enabled=!1,this._onMouseUp=()=>this._grabHandle=!1,this._onMouseDown=()=>{this._hoverHandle&&(this._grabHandle=!0)},this._onDragProgress=()=>{this._grabHandle&&this._refreshCanvas()},this._onDragStart=()=>{if(!this._movedEdges)return;this._nodesToHighlight=this._nodesToHighlight.filter(t=>t!==this._startNode&&!t.isVirtual()),this._movedEdges.setExcluded(!0);const e=this._options.cursorOnDrag;this._prevSettings=this._modules.settings.update({edgeHover:!1,cursor:{default:e,node:e,edge:e}})},this._onDragEnd=()=>{if(!this._movedEdges)return;this._restoreSettings();const e=this._getPointedNode();e&&this._movedEdges.forEach(t=>{t.getTarget()===this._startNode?t.setTarget(e):t.setSource(e)}),this._movedEdges.setExcluded(!1),this._movedEdges.setSelected(!0),this._movedEdges=null,this._refreshHandles()},this._refreshHandles=()=>{if(!this._enabled||this._movedEdges)return;const e=this._modules.selection.getSelectedEdges();this._nodesToHighlight=e.getExtremities().dedupe().filter(t=>!t.isVirtual()),this._rewirableClass.clearEdges(),this._rewirableClass.add(e),this._refreshCanvas()},this._shouldInteractionStart=({target:e})=>{if(!this._enabled||!e||!e.isNode||!this._hoverHandle||e.isVirtual())return!1;const t=e.getAdjacentEdges().filter(n=>n.isSelected());return!!t.size&&(this._movedEdges=t,this._edgeColors=this._movedEdges.getAttribute("color"),this._startNode=e,!0)},this._refreshCanvas=()=>{this._enabled&&this._layer.refresh()},this._checkForHover=()=>{if(!this._enabled||!this._nodesToHighlight)return;const e=this._options.radius,t=this._nodesToHighlight.getPosition(),n=this._modules.camera.screenToGraphCoordinates(this._modules.captor.getCursorPosition());for(let s=0;s<t.length;s++){const{x:r,y:i}=t[s];if(ss(r,i,n.x,n.y)<e)return void this._enableCursorOnHover()}this._disableCursorOnHover()}}onMounted(){this._rewirableClass=this._modules.classes.createClass({name:T1,isBuiltin:!0,edgeAttributes:{layer:nP}})}enable(e){this._enabled||(this._modules.events.on("move",this._checkForHover).on("mousemove",this._checkForHover).on("dragProgress",this._onDragProgress).on("nodesDragProgress",this._refreshCanvas).on("mousedown",this._onMouseDown).on("mouseup",this._onMouseUp).on("edgesSelected",this._refreshHandles).on("edgesUnselected",this._refreshHandles),this._interaction=this._modules.interactions.onDrag({priority:"rewiring",check:this._shouldInteractionStart,onStart:this._onDragStart,onProgress:({x:t,y:n})=>{this._x=t,this._y=n},onStop:this._onDragEnd}),this._options={...Ej,...e},this._enabled=!0,this._layer=this._modules.layers.addCanvasLayer(t=>{if(!this._enabled||!this._nodesToHighlight)return;const n=this._modules.captor.getCursorPosition(),s=this._getPointedNode(),r=this._options.color,i=this._options.radius,o=2*i;if(this._displayMovedEdges(t),t.fillStyle=r,t.strokeStyle=r,this._nodesToHighlight.forEach(a=>{const{x:u,y:d}=a.getPosition();t.fillRect(u-i,d-i,o,o)}),this._movedEdges){const a=s?s.getPosition():n;t.fillRect(a.x-i,a.y-i,o,o)}},{isStatic:!1,noClear:!1}),this._layer.moveToTop(),this._refreshHandles())}disable(){this._enabled&&(this._interaction&&this._interaction.stop&&this._interaction.stop(),this._interaction=void 0,this._modules.graphics.removeCursorStyle(this._options.cursorOnDrag),this._disableCursorOnHover(),this._restoreSettings(),this._layer.destroy(),this._rewirableClass.clearEdges(),this._enabled=!1,[this._checkForHover,this._onDragProgress,this._refreshCanvas,this._onMouseDown,this._onMouseUp,this._refreshHandles].forEach(e=>this._ogma.events.off(e)))}enabled(){return this._enabled}_restoreSettings(){this._prevSettings&&(this._modules.settings.update(this._prevSettings),this._prevSettings=void 0)}_disableCursorOnHover(){this._hoverHandle&&!this._grabHandle&&(this._hoverHandle=!1,this._modules.graphics.removeCursorStyle(this._options.cursorOnHover))}_enableCursorOnHover(){this._hoverHandle||(this._hoverHandle=!0,this._modules.graphics.addCursorStyle(this._options.cursorOnHover))}_displayMovedEdges(e){if(!this._movedEdges)return;const t=this._x,n=this._y,s=this._modules.camera.screenToGraphCoordinates({x:t,y:n});this._movedEdges.forEach((r,i)=>{const o=this._edgeColors[i],a=r.getSource(),u=r.getTarget(),d=this._getPointedNode(),c=u===this._startNode?a:u,g=Number(r.getAttribute("width")),f=c.getPosition(),p=d?d.getPosition():s;e.beginPath(),e.moveTo(f.x,f.y),e.lineTo(p.x,p.y),e.strokeStyle=o,e.lineWidth=g,e.stroke()})}_getPointedNode(){const e=this._modules.captor.getPointedElement();return e&&e.isNode&&!e.isVirtual()?e:null}},bA={cursor:"nesw-resize",color:"#00C3FF",lineWidth:1,handleSize:6,detectionMargin:5,snappingRatio:1.25,nbNodesToSnapTo:5,previewColor:"rgba(0, 0, 0, 0.2)",sizeIndicatorColor:"black",sizeIndicatorOffset:5,sizeIndicatorWidth:3,sizeIndicatorThickness:1},Aj=class extends zt{constructor(){super(...arguments),this._enabled=!1,this._nodesToHighlight=null,this._cursorEnabled=!1,this._x=0,this._y=0,this._additionalRadiuses=[],this._onSelectionChange=()=>{this._enabled&&(this._nodesToHighlight=this._modules.selection.getSelectedNodes(),this._displayHandles())},this._displayHandlesHandler=()=>this._displayHandles(),this._moveHandler=({x:e,y:t})=>{this._modules.dom.setTimeout(()=>this._detectBoundingBoxes(e,t),0)}}onMounted(){this._engine=this._modules.graphics.getGraphicsEngine(),this._modules.interactions.onDrag({priority:"resizing",disableDetection:!0,check:()=>!(!this._enabled||!this._pointedNode),onStart:({x:e,y:t})=>{this._x=e,this._y=t,this._nodeBeingResized=this._pointedNode},onProgress:({x:e,y:t})=>{this._x=e,this._y=t,this._displayHandles()},onStop:()=>{if(this._nodesToHighlight){const e=this._modules.camera.zoom,t=this._nodesToHighlight.getAttributes(["x","y","radius"]).map(({x:n,y:s,radius:r},i)=>{const o=this._additionalRadiuses[i]/e;return{radius:+r+o,x:n+o,y:s-o}});this._nodesToHighlight.setAttributes(t)}this._pointedNode=null,this._nodeBeingResized=null,this._displayHandles()}})}onReady(){this._modules.events.on(["nodesSelected","nodesUnselected"],this._onSelectionChange)}_enableCursor(){this._cursorEnabled||(this._modules.graphics.addCursorStyle(this._options.cursor),this._cursorEnabled=!0)}_disableCursor(){this._cursorEnabled&&(this._modules.graphics.removeCursorStyle(this._options.cursor),this._cursorEnabled=!1)}_detectBoundingBoxes(e,t){if(!this._enabled||this._nodeBeingResized||!this._nodesToHighlight)return;const n=this._options.handleSize/2,s=this._options.detectionMargin;return this._pointedNode=null,this._forEachNodeToHighlight((r,i,o)=>{const a=i.x+o-n-s,u=i.x+o+n+s,d=i.y-o-n-s,c=i.y-o+n+s;e>=a&&e<=u&&t>=d&&t<=c&&(this._pointedNode=r)}),this._pointedNode?this._enableCursor():this._disableCursor()}_forEachNodeToHighlight(e){this._nodesToHighlight&&this._nodesToHighlight.forEach(t=>{const n=t.getPositionOnScreen(),s=this._getTotalRadius(t);e(t,n,s)})}_displayHandles(){this._enabled&&this._nodesToHighlight&&this._layer.refresh()}_displayNodePreview(e,t,n,s,r,i){if(r*=1/this._modules.camera.getZoom(),e.beginPath(),i.length===1)e.arc(n,s,r,0,2*Math.PI);else for(let o=0;o<i.length;++o){const a=i[o],u=n+a.x*r,d=s+a.y*r;o===0?e.moveTo(u,d):e.lineTo(u,d)}e.fillStyle=this._options.previewColor,e.fill()}_getTotalRadius(e,t=!0){return Number(e.getAttribute("radius"))*(this._modules.camera.zoom*(t?1:0))+Number(e.getAttribute("innerStroke.width"))+Number(e.getAttribute("outerStroke.width"))+this._options.lineWidth/2}_snap(e,t,n){const s=this._modules.spatial.getNodesInScreenByDistance(t).filter(g=>!g.isSelected()).slice(0,this._options.nbNodesToSnapTo),r=this._getTotalRadius(t),i=r+n,o=this._options.snappingRatio,a=i/r,u=Math.round(f1(a,o));let d=r*Math.pow(o,u),c=null;if(s.forEach(g=>{const f=this._getTotalRadius(g);Math.abs(f-i)<=Math.abs(d-i)&&(d=f,c=g)}),c){e.save(),e.strokeStyle=this._options.sizeIndicatorColor,e.lineWidth=this._options.sizeIndicatorThickness/this._modules.camera.getZoom();const g=c.getAttribute("radius");this._displaySizeIndicator(e,t,d),s.filter(f=>f.getAttribute("radius")===g).forEach(f=>this._displaySizeIndicator(e,f)),e.restore()}return d-r}_displaySizeIndicator(e,t,n){n=n||void 0;const s=this._modules.camera.getZoom(),r=t.getPosition(),i=this._getTotalRadius(t),o=(n||i)/s,a=(n?n-i:0)/s,u=a+(-this._options.sizeIndicatorOffset-(n?Number(t.getAttribute("innerStroke.width"))+Number(t.getAttribute("outerStroke.width")):0))/s,d=r.x-o+u|0,c=r.y-o-a|0,g=r.y+o-a|0,f=this._options.sizeIndicatorWidth/s;e.beginPath(),e.moveTo(d-f,c),e.lineTo(d+f,c),e.moveTo(d,c),e.lineTo(d,g),e.moveTo(d-f,g),e.lineTo(d+f,g),e.stroke()}enable(e={}){this._enabled||(this._options={...bA,...e},this._layer=this._modules.layers.addCanvasLayer(t=>{const n=or(),s=this._modules.camera.getZoom(),{color:r,lineWidth:i}=this._options;let o=this._options.handleSize,a=0;if(this._nodeBeingResized){const u=this._getTotalRadius(this._nodeBeingResized),d=this._nodeBeingResized.getPositionOnScreen();a=Math.max(this._x-(d.x+u),-(this._y-(d.y-u)))/2}this._additionalRadiuses=[],this._nodesToHighlight&&this._nodesToHighlight.forEach(u=>{const d=u.getPosition();let c=this._getTotalRadius(u),g=0;if(this._nodeBeingResized){g=a;const f=-c+Number(u.getAttribute("innerStroke.width"))+Number(u.getAttribute("outerStroke.width"))+i/2+1;g=g<f?f:this._snap(t,u,g),this._additionalRadiuses.push(g);const p=u.getAttribute("shape"),_=this._engine.getShapePoints(p),y=d.x+g/s,x=d.y-g/s,E=c+g;this._displayNodePreview(t,n,y,x,E,_)}t.strokeStyle=r,t.fillStyle=r,t.lineWidth=i/s,c/=s,g/=s,o/=s*n,t.strokeRect(d.x-c,d.y-c-2*g,2*(g+c),2*(g+c)),t.fillRect(d.x+c+2*g-o/2,d.y-c-2*g-o/2,o,o)})},{isStatic:!1,noClear:!1}),this._layer.moveToTop(),this._modules.events.on(["mousemove","mousedown"],this._moveHandler),this._enabled=!0)}disable(){this._enabled&&(this._modules.events.off(this._displayHandlesHandler).off(this._moveHandler),this._layer.destroy(),this._disableCursor(),this._reset())}_reset(){this._enabled=!1,this._nodesToHighlight=null,this._options={...bA},this._nodeBeingResized=null,this._pointedNode=null,this._cursorEnabled=!1,this._x=0,this._y=0,this._additionalRadiuses=[]}enabled(){return this._enabled}},wj={strokeColor:"black",strokeWidth:5,dashed:!0,cursorStyle:"cell",createNodes:!0,condition:yy,onNodeCreated:Vt,onEdgeCreated:Vt,createNode:Yr,createEdge:Yr,onComplete:Vt},Tj=class extends zt{constructor(){super(...arguments),this._enabled=!1,this._blockId=0,this._cursorEnabled=!1}onMounted(){this._engine=this._modules.graphics.getGraphicsEngine(),this._group=this._engine.createGroup(),this._depth=vd(0).edgeBody,this._modules.events.register(["connectNodes"]),this._interaction=this._modules.interactions.onDrag({priority:"connectNodes",check:({target:e,button:t="left"})=>this._enabled&&t==="left"&&e&&e.isNode&&!e.isVirtual(),onStart:({target:e})=>this._onStart(e),onProgress:({x:e,y:t})=>this._onMove(e,t),onStop:()=>this._onStop()}),this._modules.events.on("clearGraph",()=>this.disable())}_onStart(e){e&&(this._cursorEnabled=!0,this._startNode=e,this._startPos=e.getPosition(),this._modules.graphics.addCursorStyle(this._options.cursorStyle),this._blockId=this._modules.graphics.allocateGraphicsEngineBlockId())}_onMove(e,t){this._startNode!==null&&(this._endPos=this._modules.camera.screenToGraphCoordinates({x:e,y:t}),this._drawLine())}_onStop(){if(this._startNode===null)return;const{condition:e,onNodeCreated:t,onEdgeCreated:n,createEdge:s,createNode:r,onComplete:i,createNodes:o}=this._options;let a=this._modules.captor.getPointedElement(),u=null,d=null;if(this._modules.graphics.releaseGraphicsEngineBlockId(this._blockId),!a&&o){const c=r({attributes:{x:this._endPos.x,y:this._endPos.y}});a=this._modules.graph.addNode(c),d=a,t&&t(d)}if(a&&!a.isVirtual()&&(d||!e||e(this._startNode,a))){const c=s({source:this._startNode.getId(),target:a.getId()});u=this._modules.graph.addEdge(c),n&&n(u)}i&&(this._modules.events.fire("connectNodes",{source:this._startNode,target:a,edge:u}),i(this._startNode,a,u||void 0)),this.disable()}_drawLine(){this._group.reset(Wr,!1,this._depth);const e=this._group.nextAndReset().end;e.pieceId=tf,e.shape="line",e.x1=this._startPos.x,e.y1=this._startPos.y,e.x2=this._endPos.x,e.y2=this._endPos.y,e.fillColor=this._options.strokeColor,e.thicknessOrFontSizeFixed=this._options.strokeWidth,this._options.dashed&&(e.dashLength=3,e.gapLength=1),this._engine.storeGroup(this._blockId,this._group),this._modules.dom.refresh()}enable(e={}){return this._enabled||(this._options={...wj,...e},this._enabled=!0,this._cursorEnabled=!1,this._startNode=null,this._prevSettings=this._modules.settings.update({"cursor.node":this._options.cursorStyle,"detect.edges":!1}),this._modules.captor.isLeftPressed()&&this._interaction.start(this._modules.captor.getCursorInformation())),this}disable(){return this._enabled?(this._enabled=!1,this._modules.settings.update(this._prevSettings),this._cursorEnabled&&this._modules.graphics.removeCursorStyle(this._options.cursorStyle),this):this}enabled(){return this._enabled}},Cj=["top","bottom","left","right","cssDefined"],Lj=1e4,Nj={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}},Ij={position:"top",autoAdjust:!0,delay:100},kj={hover:{node:({target:e})=>e&&e.isNode,edge:({target:e})=>e&&!e.isNode},click:{left:{node:({target:e,button:t})=>t==="left"&&e&&e.isNode,edge:({target:e,button:t})=>t==="left"&&e&&!e.isNode,background:({target:e,button:t})=>t==="left"&&!e},right:{node:({target:e,button:t})=>t==="right"&&e&&e.isNode,edge:({target:e,button:t})=>t==="right"&&e&&!e.isNode,background:({target:e,button:t})=>t==="right"&&!e}},doubleclick:{left:{node:({target:e,button:t})=>t==="left"&&e&&e.isNode,edge:({target:e,button:t})=>t==="left"&&e&&!e.isNode,background:({target:e,button:t})=>t==="left"&&!e},right:{node:({target:e,button:t})=>t==="right"&&e&&e.isNode,edge:({target:e,button:t})=>t==="right"&&e&&!e.isNode,background:({target:e,button:t})=>t==="right"&&!e}}},Mj=class extends zt{constructor(){super(...arguments),this._x=0,this._y=0}onMounted(){this._handlers={},this._currentHandlerName=null,this._tooltip=null,this._isHover=!1,this._modules.events.register(["tooltipShow","tooltipHide"]),this._modules.events.on(["mouseup","dragStart"],()=>{this._isHover||this._hideTooltip(!1)}).on("mouseout",()=>{this._isHover&&this._hideTooltip(!1)}).on("clearGraph",()=>this._hideTooltip(!1)),this._modules.interactions.onHover(this._createInteraction("hover",!0)),this._modules.interactions.onClick(this._createInteraction("click")),this._modules.interactions.onDoubleClick(this._createInteraction("doubleclick"))}hide(){this._hideTooltip(!0)}isShown(){return!!this._tooltip}refresh(){this._refreshTooltip()}show(e,{position:t="top",autoAdjust:n=!0,className:s,x:r=0,y:i=0}={}){this._showTooltip(e,{position:t,autoAdjust:n,className:s},{x:r,y:i})}setHandler(e,t,n){const s={...Ij,...n};s.position&&Cj.indexOf(s.position)===-1&&(s.position="top"),this._handlers[e]={handler:t,condition:On(kj,e),settings:s}}_hideTooltip(e){if(this._timeout&&(this._modules.dom.clearTimeout(this._timeout),this._timeout=null),e&&(this._currentHandlerName=null),this._tooltip){const t=this._tooltip;this._tooltip.parentNode&&this._tooltip.parentNode.removeChild(this._tooltip),this._tooltip=null,this._modules.events.fire("tooltipHide",{tooltip:t})}}_createInteraction(e,t=!1){return{priority:"tooltip",check:n=>{const s=EA(e,n),r=this._handlers[s];return(!t||!this._modules.connectNodes.enabled())&&(!(!r||!r.condition(n))||!(t||!this._currentHandlerName||this._isHover)&&this._tooltip!==null)},handler:n=>{const{target:s,x:r,y:i}=n;this._hideTooltip(!1),this._isHover=t,this._elt=s,this._x=r,this._y=i,this._currentHandlerName=EA(e,n),this._refreshTooltip()}}}_refreshTooltip(){if(!this._currentHandlerName)return void this._hideTooltip(!1);const e=this._handlers[this._currentHandlerName];if(!e)return;const{settings:t,handler:n}=e,s=this._elt;if(s){const i=s.isNode?"node":"edge";if(this._currentHandlerName.indexOf(i)===-1)return}const r=n(s);Promise.resolve(r).then(i=>{this._schedule(()=>this._showTooltip(i,t),t.delay)})}_schedule(e,t){this._timeout&&this._modules.dom.clearTimeout(this._timeout),this._timeout=this._modules.dom.setTimeout(()=>{this._timeout=null,e()},t)}_showTooltip(e,t,n){this._hideTooltip(!1);const{position:s,className:r,autoAdjust:i}=t;let o=this._x,a=this._y,u=this._elt;const d=this._modules.dom.getDimensions();let c=0,g=0;if(n&&(o=n.x,a=n.y,u=null),typeof e=="string")this._tooltip=Pj("div"),Lw(this._tooltip,wy.sanitize(e));else{if(!u1(e))throw new Error(`invalid tooltip ${e}, expected HTML string or HTML element`);this._tooltip=e}const f=this._tooltip;if(r&&this._tooltip.classList.add(r),s!=="cssDefined"&&(f.style.position="absolute"),f.style.zIndex=Lj.toString(),this._modules.dom.appendElement(f),u&&u.isNode){const y=u,x=y.getPositionOnScreen(),E=Number(y.getAttribute("radius"))*(y.getAttribute("scalingMethod")==="fixed"?1:this._modules.camera.getZoom())+Number(y.getAttribute("innerStroke.width"))+Number(y.getAttribute("outerStroke.width"));o=x.x,a=x.y,c=E,g=E}const p=f.offsetWidth/2,_=f.offsetHeight/2;if(c+=p,g+=_,s&&s!=="cssDefined"){const y=Nj[s];let x=y.x,E=y.y;if(i){const b=o+c*y.x,S=a+g*y.y;(b-p<0||b+p>=d.width)&&(s==="left"||s==="right"?x*=-1:x=b-p<0?(p-b+1)/c:(d.width-(b+p)-1)/c),(S-_<0||S+_>=d.height)&&(s==="top"||s==="bottom"?E*=-1:E=S-_<0?(_-S+1)/g:(d.height-(S+_)-1)/g)}f.style.left=o+c*x-p+"px",f.style.top=a+g*E-_+"px"}this._modules.events.fire("tooltipShow",{tooltip:f})}};function EA(e,{button:t,target:n}){return`${e}${t?`.${t}`:""}.${n!==null?n.isNode?"node":"edge":"background"}`}function Pj(e){return qi?document.createElement(e):og()}var ud={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",46:"del",8:"backspace",32:"space",224:"cmd",91:"cmd",92:"cmd",93:"cmd",187:"+",189:"-"},SA=Object.keys(ud).reduce((e,t)=>{const n=ud[t];return e[n]||(e[n]=[]),e[n].push(t),e},{}),Rj=class extends zt{constructor(){super(...arguments),this._onBlur=()=>this.resetKeys(),this._onKeyUp=e=>{const t=e.keyCode||e.which;this._pressed[t]=!1,this._modules.events.fire("keyup",{domEvent:e,key:ud[t],code:t})},this._onKeyDown=e=>{const t=e.keyCode||e.which,n=this._binds[t];if(!this._pressed[t]){if(this._pressed[t]=!0,n)for(const s of n)s.keys.every(r=>r.some(i=>this._pressed[i]))&&s.handler({domEvent:e});this._modules.events.fire("keydown",{domEvent:e,key:ud[t],code:t})}}}onMounted(){this._modules.events.register(["keyup","keydown"]),this._binds=[],this._pressed=[],this._modules.dom.addWindowEventListener("keydown",this._onKeyDown).addWindowEventListener("keyup",this._onKeyUp).addWindowEventListener("visibilitychange",this._onBlur).addWindowEventListener("blur",this._onBlur,!1),this._idleTimeout=4e3,this._prevEventTimeStamp=Rs(),this._modules.events.onAnyEvent(()=>{const e=Rs();e-this._prevEventTimeStamp>this._idleTimeout&&this.resetKeys(),this._prevEventTimeStamp=e})}setIdleTimeout(e){if(!isFinite(e)||e<=1)throw new TypeError("Idle timeout must be a positive number > 1");this._idleTimeout=e}resetKeys(){for(let e=0;e<this._pressed.length;e++)this._pressed[e]&&(this._pressed[e]=!1,this._modules.events.fire("keyup",{key:ud[e],code:e}))}onKeyPress(e,t){let n=[];if(typeof e=="number")n=[e];else if(typeof e=="string")n=e.split(" ");else{if(!Array.isArray(e))throw new TypeError(`${e} is not a number, string or array`);n=e}if(n.length===0)throw new Error("the array should contain at least one element");const s=n.map(o=>{if(typeof o=="number")return[o];if(typeof o=="string"){const a=SA[o];if(!a)throw new Error(`${o} is not a valid key identifier`);return a}throw new TypeError(`${o} is not a valid key identifier`)}),r=s.pop(),i={keys:s,handler:t};r&&r.forEach(o=>{this._binds[o]||(this._binds[o]=[]),this._binds[o].push(i)})}isPressed(e){if(typeof e=="number")return this._pressed[e];if(typeof e=="string"){const t=SA[e];if(t)return t.some(n=>this._pressed[n])}return!1}},Fj=[{name:"color",isNode:!0},{name:"shape",isNode:!0},{name:"radius",isNode:!0},{name:"icon.content",isNode:!0},{name:"image.url",isNode:!0},{name:"image",isNode:!0},{name:"color",isNode:!1},{name:"shape",isNode:!1},{name:"width",isNode:!1}],Qi=Math.PI,Ji=2*Math.PI,_L=Math.cos(Qi/2-Ji/5),yL=Math.cos(Qi/2-Ji/5*2),xL=Math.cos(Qi/2-Ji/5*3),vL=Math.cos(Qi/2-Ji/5*4),bL=Math.sin(-Qi/2+Ji/5),EL=Math.sin(-Qi/2+Ji/5*2),SL=Math.sin(-Qi/2+Ji/5*3),AL=Math.sin(-Qi/2+Ji/5*4),Mg=1.6,wL=3,Dj=.9,Oc=.31,Mm=1/3,Oj=[8,3],zj=[3,3],zc={position:"bottom",widgetWidth:130,fontFamily:"Arial",fontSize:10,fontColor:"black",titleFontSize:12,titleFontColor:"black",titleMaxLength:20,titleTextAlign:"left",shapeColor:"grey",backgroundColor:"white",borderColor:"black",borderRadius:0,borderWidth:1,innerMargin:10,outerMargin:5,circleStrokeWidth:3,titleFunction:e=>e[e.length-1]},Bj=["widgetWidth","fontSize","titleFontSize","borderRadius","borderWidth","innerMargin","outerMargin","circleStrokeWidth"];function TL(e){return Array.isArray(e)?e.reduce((t,n)=>t&&TL(n),!0):e==="undefined"||!isNaN(Number(e))}function CL(e){return Array.isArray(e)?e.reduce((t,n)=>Math.min(t,CL(n)),1/0):typeof(e=Number(e))=="number"?isNaN(e)?1/0:+e:1/0}function LL(e){return Array.isArray(e)?e.reduce((t,n)=>Math.max(t,LL(n)),-1/0):typeof(e=Number(e))=="number"?isNaN(e)?-1/0:+e:-1/0}function Hi(e){const t=["K","M","B","T","P","E","Z","Y"];if(e>9999){let n=0;for(;n<t.length&&e>999;)e/=1e3,n++;return(AA(e,3)+t[n-1]).toString()}return AA(e,4).toString()}function AA(e,t=3){const n=t===4?10:1;return e<10?Math.round(100*e*n)/(100*n):e<100?Math.round(10*e*n)/(10*n):e<1e3?Math.round(e*n)/n:Math.round(e)}function NL(e){return e.innerMargin+(e.titleFontSize+e.fontSize)*Mg}var Uj=(e,t)=>e.isNode!==t.isNode?e.isNode?-1:1:e.title<=t.title?-1:1,Gj=(e,t)=>e.height-t.height,Vj=(e,t)=>e.isNode!==t.isNode?e.isNode?-1:1:t.height-e.height,jj=(e,t)=>e.isNode!==t.isNode?e.isNode?-1:1:e.content[0].title<=t.content[0].title?-1:1;function Hj(e,t,n){const s=t.getContext("2d"),{x:r,y:i,height:o,isNode:a,styleProperty:u,title:d,mapping:c,iconFont:g,iconFontStyle:f}=n;Wj(s,e,r,i,o),Xj(s,e,d,r,i);const p=e.fontSize*Mg,_=e.fontSize/2*Mg*Dj,y=e.fontSize*wL,x=e.fontSize,E=$j(e,a);let b=i+NL(e);const S=r+e.innerMargin+E/2,A=r+2*e.innerMargin+E,C=td(c),k=TL(C),M=e.fontColor,R=e.shapeColor,O=Object.keys(c);if(k&&(O.sort((j,z)=>Fi(c[z])-Fi(c[j])),u==="radius"||u==="width")){const j=CL(C),z=LL(C);return(a?u6:d6)(e,s,r,b,j,(j+z)/2,z,R)}O.forEach(j=>{const z=c[j];u==="color"&&(a?IL(s,S,b,_,j):Zj(s,S,b,y,x,j)),u==="shape"&&(a?s6(s,S,b,_,j,R):a6(s,S,b,y,x,j,R)),u==="icon.content"&&Kj(s,S,b,j,g,_,M,f),u!=="image"&&u!=="image.url"||Qj(s,S,b,_,j),Yj(s,e,A,b,z,k),b+=p})}function qj(e,t,n,s,r,i){e.beginPath(),e.arc(t,n,s,0,Ji),e.strokeStyle=r,e.lineWidth=i,e.stroke()}function Hd(e,t,n,s,r="left",i="normal"){e.textAlign=r,e.textBaseline="middle",e.fillStyle=s,e.font=`${i} ${n}px "${t}"`}function $j(e,t){const n=t?1:wL;return e.fontSize*n}function Wj(e,t,n,s,r){return l6(e,n,s,t.widgetWidth,r,t.borderRadius,t.backgroundColor,t.borderColor,t.borderWidth)}function Xj(e,t,n,s,r){Hd(e,t.fontFamily,t.titleFontSize,t.titleFontColor,t.titleTextAlign);const i=t.titleTextAlign==="center",o=t.widgetWidth-2*t.innerMargin,a=e.measureText(n).width,u=s+(i?t.widgetWidth/2:t.innerMargin),d=r+t.titleFontSize/2+t.innerMargin;if(a>o){const c=o/a,g=(n.length*c|0)-2;n=n.substr(0,g)+""}e.fillText(n,u,d)}function Yj(e,t,n,s,r,i){let o=r.join();if(i)if(r.length===1)o=Hi(r[0]);else{const a=Fi(r),u=ml(r);o=`${Hi(a)} - ${Hi(u)}`}Hd(e,t.fontFamily,t.fontSize,t.fontColor),e.fillText(o,n,s)}function IL(e,t,n,s,r){e.beginPath(),e.arc(t,n,s,0,2*Qi),e.fillStyle=r,e.fill()}function Zj(e,t,n,s,r,i){e.fillStyle=i,e.fillRect(t-s/2,n-r/2,s,r)}function Kj(e,t,n,s,r,i,o,a){Hd(e,r,2*i,o,"center",a),e.fillText(s,t,n)}function Qj(e,t,n,s,r){if(typeof Image>"u")return;e._imgStore||(e._imgStore={});let i=e._imgStore[r];if(i)return e.drawImage(i,t-s,n-s,2*s,2*s);i=new Image,i.src=r,i.onload=()=>{e.drawImage(i,t-s,n-s,2*s,2*s)},e._imgStore[r]=i}function Jj(e,t,n,s){e.fillRect(t-s,n-s*Oc,2*s,2*s*Oc),e.fillRect(t-s*Oc,n-s,2*s*Oc,2*s)}function e6(e,t,n,s){return e.beginPath(),e.moveTo(t-s,n),e.lineTo(t,n-s),e.lineTo(t+s,n),e.lineTo(t,n+s),e.fill()}function t6(e,t,n,s){e.beginPath(),e.moveTo(t,n-s),e.lineTo(t+_L*s,n+bL*s),e.lineTo(t+yL*s,n+EL*s),e.lineTo(t+xL*s,n+SL*s),e.lineTo(t+vL*s,n+AL*s),e.fill()}function n6(e,t,n,s){e.beginPath(),e.moveTo(t,n-s),e.lineTo(t+yL*s,n+EL*s),e.lineTo(t+vL*s,n+AL*s),e.lineTo(t+_L*s,n+bL*s),e.lineTo(t+xL*s,n+SL*s),e.fill()}function s6(e,t,n,s,r,i){switch(e.fillStyle=i,r){case"square":return e.fillRect(t-s,n-s,2*s,2*s);case"circle":return IL(e,t,n,s,i);case"cross":return Jj(e,t,n,s);case"diamond":return e6(e,t,n,s);case"equilateral":return t6(e,t,n,s);case"star":return n6(e,t,n,s)}}function r6(e,t,n,s,r){e.fillRect(t-s/2,n-r/4,s*(1-Mm),r/2),e.beginPath(),e.moveTo(t+s*(1-Mm-.5),n-r/2),e.lineTo(t+s*(1-Mm-.5),n+r/2),e.lineTo(t+s/2,n),e.fill()}function i6(e,t,n,s,r,i,o){e.beginPath(),e.moveTo(t-s/2,n),e.lineTo(t+s/2,n),e.strokeStyle=i,e.lineWidth=r/2,e.setLineDash(o==="dashed"?Oj:zj),e.stroke()}function o6(e,t,n,s,r){e.beginPath(),e.moveTo(t-s/2,n-r/2),e.lineTo(t-s/2,n+r/2),e.lineTo(t+s/2,n),e.fill()}function a6(e,t,n,s,r,i,o){return e.fillStyle=o,i==="line"&&e.fillRect(t-s/2,n-r/4,s,r/2),i==="arrow"?r6(e,t,n,s,r):i==="dashed"||i==="dotted"?i6(e,t,n,s,r,o,i):i==="tapered"?o6(e,t,n,s,r):void 0}function l6(e,t,n,s,r,i,o,a,u){e.setLineDash([]),e.beginPath(),e.moveTo(t+i,n),e.lineTo(t+s-i,n),e.quadraticCurveTo(t+s,n,t+s,n+i),e.lineTo(t+s,n+r-i),e.quadraticCurveTo(t+s,n+r,t+s-i,n+r),e.lineTo(t+i,n+r),e.quadraticCurveTo(t,n+r,t,n+r-i),e.lineTo(t,n+i),e.quadraticCurveTo(t,n,t+i,n),e.closePath(),e.fillStyle=o,e.fill(),e.strokeStyle=a,e.lineWidth=u,e.stroke()}function u6(e,t,n,s,r,i,o,a){const u=.7*e.fontSize,d=3*u,c=(u+d)/2,g=n+e.innerMargin+d,f=g+d+e.innerMargin,p=s+2*d-.5*e.innerMargin,_=e.circleStrokeWidth;for(const y of[u,c,d])qj(t,g,p-y,y,a,_);Hd(t,e.fontFamily,e.fontSize,e.fontColor,"left"),t.fillText(Hi(r),f,p+u-2*u),t.fillText(Hi(i),f,p+u-2*c),t.fillText(Hi(o),f,p+u-2*d)}function d6(e,t,n,s,r,i,o,a){const u=(e.widgetWidth-2*e.innerMargin)/3,d=e.fontSize,c=s-e.innerMargin/2,g=c+2*d,f=n+e.innerMargin;t.fillStyle=a,t.fillRect(f,c-d/2,u+1,d),t.fillRect(f+u,c-d/3,u+1,d/1.5),t.fillRect(f+2*u,c-d/6,u,d/3),Hd(t,e.fontFamily,e.fontSize,e.fontColor,"center"),t.fillText(Hi(o),f+.5*u,g),t.fillText(Hi(i),f+1.5*u,g),t.fillText(Hi(r),f+2.5*u,g)}function h6(e,t,n,s){const r=s.outerMargin+NL(s),i=s.fontSize*Mg,o=r-.8*s.innerMargin;return t==="radius"||t==="width"?o+i*(n?3:2):o+Object.keys(e).length*i}function c6(e,t,n){const s={width:t.width,height:t.height};let r=!1;return!!(s.width&&s.height&&n)&&(r=e.position==="top"||e.position==="bottom"?m6(s,e,n,e.position==="bottom"):g6(s,e,n,e.position==="left"),r&&n.forEach(i=>Hj(e,t,i)),r)}function g6(e,t,n,s){const r=t.widgetWidth+t.outerMargin,i=Math.floor((e.width-t.outerMargin)/r),o=e.height;let a=t.outerMargin,u=s?t.outerMargin:e.width-r,d=1;n=n.slice().sort(Uj);for(let c=0;c<n.length;++c){const g=n[c];if(a+g.height>o){if(a===t.outerMargin)return!1;a=t.outerMargin,d+=1,s?u+=r:u-=r}g.x=u,g.y=a,a+=g.height}return d<=i}function f6(e,t,n){let s=null;for(let r=0;r<t.length;++r){const i=t[r];i.isNode!==e.isNode&&t.length!==1||!(s===null||i.height<t[s].height)||(s=r)}if(s!=null){const r=t[s];r.content.push(e),r.height+=e.height+n.outerMargin}}function p6(e){let t=0;for(let n=1;n<e.length;++n)e[n].height>e[t].height&&(t=n);return t}function m6(e,t,n,s){n=n.slice();const r=t.widgetWidth+t.outerMargin,i=Math.floor((e.width-t.outerMargin)/r),o=e.height-t.outerMargin,a=new Array(Math.min(i,n.length)),u=n.length;let d=0,c=0,g=0,f=0;for(let S=0;S<u;++S){const A=n[S];A.isNode?(d+=1,c+=A.height):(g+=1,f+=A.height)}const p=c+f,_=c/p,y=f/p;let x=Math.round(_*i);const E=Math.round(y*i);if(x>d?x=d:E>g&&(x=i-g),i===0)return!1;for(let S=0;S<a.length;S++)a[S]={content:[],height:0,isNode:S<x};for(let S=0;S<u;++S){const A=p6(n);f6(n[A],a,t),n.splice(A,1)}a.every(({content:S})=>S.length===1)?a.sort(jj):a.sort(Vj);let b=t.outerMargin;for(let S=0;S<a.length;++S){const A=a[S];if(A.height>o)return!1;A.content.sort(Gj);let C=0;for(let k=0;k<A.content.length;++k){const M=A.content[k];M.x=b,M.y=s?e.height-C-M.height-t.outerMargin:C+t.outerMargin,C+=M.height+t.outerMargin}b+=r}return!0}var _6=class extends zt{constructor(){super(...arguments),this._enabled=!1,this._mustRefresh=!1,this._promises=[]}onMounted(){this._modules.events.on("frame",()=>{this._enabled&&this._mustRefresh&&this._layer.refresh()}).on(["resize","reloadFonts"],()=>{this._mustRefresh=!0})}enable(e={}){const t=this._settings;return this._settings={...zc,...e},this._mustRefresh=!this._enabled||!this._sameOptions(t,this._settings),this._enabled?Promise.resolve():(this._enabled=!0,this._layer=this._modules.layers.addCanvasLayer(n=>{this._drawOnCanvas(this._settings,n.canvas,or());const s=this._promises;this._promises=[],s.forEach(r=>r()),this._mustRefresh=!1},{isStatic:!0,noClear:!1}),this._layer.moveToTop(),this.refresh())}_afterNextUpdate(){return new Promise(e=>this._promises.push(e))}_formatSettings(e,t){const n={...zc,...e};return Bj.forEach(s=>n[s]*=t),n}disable(){return this._enabled&&(this._enabled=!1,this._layer.destroy()),Promise.resolve()}enabled(){return this._enabled}refresh(){return this._mustRefresh=!0,this._modules.dom.refresh(),this._afterNextUpdate()}destroy(){this._enabled=!1,this._mustRefresh=!1,this._settings={...zc},this._promises=[]}getOptions(){return this._enabled?{...this._settings}:{...zc}}getCurrentOptions(){return this._settings}_sameOptions(e,t){return e===t||Object.keys(e).reduce((n,s)=>n&&e[s]===t[s],!0)}_drawOnCanvas(e,t,n){const s=this._formatSettings(e,n);c6(s,t,this._computeWidgetList(s))}exportOnCanvas(e,t,n){return this._drawOnCanvas(t,e,n)}export(e={}){const{width:t,height:n}={...this._modules.camera.getSize(),...e},s=or(),r=Es(t*s,n*s);return this._drawOnCanvas(e,r,s),Promise.resolve().then(()=>r)}_computeWidgetList(e){const t=[];return Fj.forEach(({name:n,isNode:s})=>{const r=this._computeWidget(e,n,s);r&&t.push(r)}),t}_computeWidget(e,t,n){const s=this._computePropertyMapping(e,t,n);if(s){if(t!=="icon.content")return s;const r=this._getRulesForAttribute(n,"icon.font"),i=this._getRulesForAttribute(n,"icon.style");let o=null,a=null;if(r.length||(o="Arial",a="normal"),typeof r[0]=="string"&&(o=r[0],a=i[0]),o&&a)return s.iconFont=o,s.iconFontStyle=a,s}return null}_computePropertyMapping(e,t,n){const[s]=this._getRulesForAttribute(n,t),r=s&&s.mapping,i=r&&r.getValues(n);if(r&&i){const o=r.getField(),a={};return ci(i,(u,d)=>{u!==void 0&&d!=="undefined"&&(a[u]=a[u]||[],a[u].push(d))}),Object.keys(a).length===0?null:{isNode:n,title:e.titleFunction(o,t),styleProperty:t,dataProperty:o,mapping:a,height:h6(a,t,n,e)}}return null}_getRulesForAttribute(e,t){return this._modules.styleRules.getRuleList().map(n=>{const s=n.getDefinition();return On(e?s.nodeAttributes:s.edgeAttributes,t)}).filter(Yr).sort((n,s)=>n.mapping&&s.mapping?0:n.mapping?-1:1)}},wA={layer:I1,outerStroke:{color:C2,width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:L2,minVisibleSize:0}},y6={layer:I1,color:C2,text:{backgroundColor:L2,minVisibleSize:0}},TA={duration:150,easing:"quadradicOut"},x6=class extends zt{constructor(){super(...arguments),this._delay=16,this._manualTriggerDetection=!1,this._hovered=null,this._hoveredTextHidden=!1,this._onAnimate=({updatesPositions:e})=>{e&&this._hovered&&this._modules.graphics.isMoving(this._hovered)&&(this._manualTriggerDetection=!0,this._resetHover())},this._onBeforeNewFrame=()=>{if(this._manualTriggerDetection){this._manualTriggerDetection=!1,this._modules.captor.triggerDetection();const e=this._modules.captor.getPointedElement();e&&this._hover(e)}},this._onClear=()=>{this._hovered=null,this._timeout&&this._modules.dom.clearTimeout(this._timeout)},this._resetHover=()=>{this._hovered&&(this._unhover(this._hovered),this._modules.captor.triggerUnhover()),this._timeout&&(this._modules.dom.clearTimeout(this._timeout),this._timeout=null)}}_setAnimationOptions(e){this._animationOptions={duration:(e==null?void 0:e.duration)!==void 0?e.duration:TA.duration,easing:(e==null?void 0:e.easing)!==void 0?e.easing:TA.easing},e==null||delete e.duration,e==null||delete e.easing}setRate(e){return this._delay=e,this}replaceNullColor(e,t){e&&On(e,t)===null&&Ui(e,t,this._modules.settings.get("backgroundColor"))}updateNodeAttributes(e,t){this._setAnimationOptions(e),this.replaceNullColor(e,"text.backgroundColor"),this._hoverClass.update({nodeAttributes:e,fullOverwrite:t}),this._hoverExtremityHighlightedClass.update({nodeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()}updateEdgeAttributes(e,t){this.replaceNullColor(e,"text.backgroundColor"),this.replaceNullColor(e,"text.secondary.backgroundColor"),this._setAnimationOptions(e),this._hoverClass.update({edgeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()}getHoverClassDefinition(){return this._hoverClass.getDefinition()}onMounted(){this._registerSettings(),this._setAnimationOptions(null),this._hoverExtremityHighlightedClass=this._modules.classes.createClass({name:a_,isBuiltin:!0,nodeAttributes:wA}),this._hoverClass=this._modules.classes.createClass({name:nd,isBuiltin:!0,nodeAttributes:wA,edgeAttributes:y6}),this._modules.events.on("mouseover",({target:e})=>e&&this._hover(e)).on("mouseout",({target:e})=>e&&this._unhover(e)).on("animate",this._onAnimate).on("beforeNewFrame",this._onBeforeNewFrame).on("mouseout",this._resetHover).on("clearGraph",this._onClear)}_registerSettings(){this._modules.settings.register("cursor.node","pointer",(e,t)=>{this._hovered&&this._hovered.isNode&&(this._modules.graphics.removeCursorStyle(t),this._modules.graphics.addCursorStyle(e))}),this._modules.settings.register("cursor.edge","pointer",(e,t)=>{this._hovered&&!this._hovered.isNode&&(this._modules.graphics.removeCursorStyle(t),this._modules.graphics.addCursorStyle(e))}),this._modules.settings.register("nodeHover",!0,e=>{!e&&this._hovered&&this._hovered.isNode&&this._unhover(this._hovered)}),this._modules.settings.register("edgeHover",!0,e=>{e||!this._hovered||this._hovered.isNode||this._unhover(this._hovered)})}_updateExtremityHighlightLayer(){const e=this._hoverClass.getDefinition().edgeAttributes,t=e?e.layer:void 0;this._hoverExtremityHighlightedClass.update({nodeAttributes:{layer:t},fullOverwrite:!1})}_removeTimeout(){this._timeout&&(this._modules.dom.clearTimeout(this._timeout),this._timeout=null)}_hover(e){const t=e.isNode?"nodeHover":"edgeHover";this._modules.settings.get(t)&&e&&(this._removeTimeout(),this._timeout=this._modules.dom.setTimeout(()=>{this._setElementHighlight(!0,e),this._timeout=null},this._delay))}_unhover(e){this._removeTimeout(),this._hovered===e&&(this._setElementHighlight(!1,e),this._hoverExtremityHighlightedClass.clearNodes(),this._hovered=null)}_setElementHighlight(e,t){const n=this._modules.settings.get(t.isNode?"cursor.node":"cursor.edge");if(e?(this._modules.graphics.addCursorStyle(n),t.addClass(nd,this._animationOptions),this._hovered=t):(this._modules.graphics.removeCursorStyle(n),t.removeClass(nd,this._animationOptions)),t.isNode){const s=this._modules.graph.getAttribute(t.isNode,"textHidden"),r=t._index;e&&(this._hoveredTextHidden=s.get(r)!==0);const i=!e&&this._hoveredTextHidden;s.set(r,i)}else this._hoverExtremityHighlightedClass.clearNodes(),e&&t.getExtremities().addClass(a_,this._animationOptions)}},v6=class extends zt{constructor(){super(...arguments),this.x=0,this.y=0}},b6=class{constructor(e,t){this._nodeMapping={valid:!1,values:{}},this._edgeMapping={valid:!1,values:{}},this._computeMapping=t,this._field=e,this._assignedRules=[]}getValue(e,t){const n=e.isNode,s=n?this._nodeMapping:this._edgeMapping;s.valid||(s.values=this._computeMapping(n),s.valid=!0);const r=e.getData(this._field);return Array.isArray(r)?t==="color"?r.map(i=>s.values[i]):s.values[r[0]]:s.values[r]}markAsInvalid(){this._nodeMapping.valid=!1,this._edgeMapping.valid=!1}getValues(e){return e?this._nodeMapping.values:this._edgeMapping.values}getField(){return this._field}isAssignedTo(e){return this._assignedRules.find(t=>t===e)}getAssignedRules(){return this._assignedRules.slice()}assignTo(e){this.isAssignedTo(e)||this._assignedRules.push(e)}unAssignTo(e){this._assignedRules=this._assignedRules.filter(t=>t!==e)}};function kL(e,t,n){const s=(t?e.getNodes():e.getEdges()).getData(n),r={};return s.forEach(i=>{if(!Array.isArray(i))return r[i]=1;i.forEach(o=>r[o]=1)}),"undefined"in r&&delete r[void 0],Object.keys(r).sort()}function E6(e,t,n,s){const{values:r={},fallback:i}=n,o=kL(e,s,t),a={};let u=0;for(let d=0;d<o.length;++d){const c=o[d];c in r?a[c]=r[c]:(a[c]=i[u],u=(u+1)%i.length)}return a}function S6(e,{nbSlices:t,minValue:n,maxValue:s}){if(Array.isArray(e))return e.slice();const{min:r=n,max:i=s}=e,o=(i-r)/t,a=[];for(let u=1;u<t;++u)a.push(r+o*u);return a}function A6(e,t){if(Array.isArray(e))return e;const{min:n,max:s}=e,r=t.length+1,i=(s-n)/t.length,o=[];for(let a=0;a<r;a++)o.push(n+a*i);return o}function w6(e,t,n,s){const{fallback:r,stops:i={},values:o,reverse:a}=n,u=kL(e,s,t);let d=1/0,c=-1/0;for(let _=0;_<u.length;_++){const y=+u[_];nf(y)&&(d=Math.min(d,y),c=Math.max(c,y),u[_]=y)}const g={};if(!isFinite(d)){for(let _=0;_<u.length;_++)g[u[_]]=r;return g}const f=S6(i,{nbSlices:Array.isArray(o)?o.length:o.nbSlices,minValue:d,maxValue:c}),p=A6(o,f);a&&p.reverse();for(let _=0;_<u.length;++_){const y=u[_];if(isFinite(y)){let x=0;for(;x<f.length&&f[x]<=y;)x+=1;g[y]=p[x]}else g[y]=r}return g}var T6=class extends zt{constructor(){super(...arguments),this._mappingList=[]}onMounted(){this._modules.events.on(["addStyleRule","updateStyleRule"],({rule:e,options:t})=>{const n=t.nodeAttributes&&typeof t.nodeAttributes!="function"?t.nodeAttributes:{},s=t.edgeAttributes&&typeof t.edgeAttributes!="function"?t.edgeAttributes:{};[...td(n),...td(s)].forEach(r=>{r&&this._recursiveGetMapping(r).forEach(i=>i.assignTo(e.id))})}).on("removeStyleRule",({rule:e})=>{this._mappingList.forEach(t=>t.unAssignTo(e.id))}).on(["addNodes","addEdges","updateNodeData","updateEdgeData","removeNodes","beforeRemoveEdges","excludedStateChange","clearGraph"],()=>{this._mappingList.forEach(e=>{const t=e.getAssignedRules();e.markAsInvalid(),t.forEach(n=>this._modules.styleRules.refreshRule(n))}),this._modules.legend.refresh()})}_recursiveGetMapping(e,t=[]){if(!e)return t;if(e.mapping)return t.push(e.mapping),t;if(typeof e!="object")return t;const n=td(e).map(s=>this._recursiveGetMapping(s));return t.concat(...n)}createMapping({field:e,values:t={},fallback:n}={field:""}){if(e=ba(e),Array.isArray(n)?n.length===0&&(n=[void 0]):n=[n],!Ea(t))throw new Error('"mapping" should be an object');return this._createMappingFunction(E6,e,{values:t,fallback:n})}createSlices({field:e,fallback:t,stops:n={},values:s,reverse:r=!1}={field:"",values:[]}){if(e=ba(e),Array.isArray(s)||s.nbSlices||(s.nbSlices=7),Array.isArray(n)&&Array.isArray(s)&&n.length!==s.length-1)throw new Error("there should be exactly one more value that stops");return this._createMappingFunction(w6,e,{fallback:t,stops:n,values:s,reverse:r})}_createMappingFunction(e,t,n){const s=new b6(t,i=>e(this._modules.graph,t,n,i));this._mappingList.push(s);const r=(i,o,a)=>s.getValue(i,a);return r.mapping=s,r}createTemplate(e){if(typeof e!="string")throw new TypeError('"template" should be a string');const t=[];let n=0,s=!1;for(;!s;){let r=-1;const i=e.indexOf("{{",n);i!==-1&&(r=e.indexOf("}}",i+2)),r!==-1?(t.push(e.substring(n,i)),t.push(e.substring(i+2,r)),n=r+2):(t.push(e.slice(n)),s=!0)}return function(r){let i=t[0];for(let o=1;o<t.length;o+=2)i+=r.getData(t[o]),i+=t[o+1];return i}}},CA=e=>e.stopPropagation(),C6=(e,t)=>{t.style.position="absolute",t.style.left="0",t.style.top="0",e.appendChild(t)},L6=e=>t=>{for(;e.firstChild;)e.removeChild(e.firstChild);for(let n=0;n<t.length;++n)C6(e,t[n])},N6=(e,t)=>{const n=document.createElement("img");return new Promise(s=>{n.addEventListener("load",()=>{t.drawImage(n,0,0,t.canvas.width,t.canvas.height),s(t)});const r=`data:image/svg+xml;base64,${btoa(new XMLSerializer().serializeToString(e))}`;n.src=r})},I6=class extends zt{constructor(){super(...arguments),this._elements=[],this._layers=[],this.readyCallbacks=[],this.render=(e,t,n,s)=>{const r=s&&s.pixelRatio?s.pixelRatio:or(),{zoom:i,x:o,y:a,width:u,height:d}=s||this._modules.camera.getView();if(i===void 0||o===void 0||a===void 0||u===void 0||d===void 0)return null;const c=r*i;n.noClear||e.clearRect(0,0,u*r,d*r),n.isStatic||(e.save(),e.translate(u*r/2,d*r/2),e.rotate(s?-(s.angle||0):-this._modules.camera.getAngle()),e.translate(-o*c,-a*c),e.scale(c,c)),t(e),n.isStatic||e.restore()},this.createCanvas=(e,t)=>{const{width:n,height:s}=this._modules.camera.getSize(),r=t.canvas||Es(n,s),i=t.ctx||r.getContext("2d"),o=(c=e)=>{i&&this.render(i,c,t)},a=()=>{const{width:c,height:g}=this._modules.camera.getSize(),f=or();r.width=c*f,r.height=g*f,r.style.width=`${c}px`,r.style.height=`${g}px`,o()};let u,d;if(t.isStatic)this._modules.events.on("resize",a),u=()=>this._modules.events.off(a);else{let c=this._modules.camera.getCenter(),g=this._modules.camera.getZoom(),f=!1;const p=0;let _;const y=500,x=()=>{f||(o(),f=!0,c=this._modules.camera.getCenter(),g=this._modules.camera.getZoom())},E=()=>{f||x();const{x:A,y:C}=this._modules.camera.getCenter(),k=A-c.x,M=C-c.y,R=-k*g,O=-M*g,j=this._modules.camera.getZoom()/g,z=-this._modules.camera.getAngle();r.style.transform=`
          scale(${j})
          rotate(${-z}rad)
          translateX(${R}px)
          translateY(${O}px)
          rotate(${z}rad)
        `.replace(/\n/g,"")};d=()=>!f||(o(),f=!1,r.style.transform="scale(1) translateX(0px) translateY(0px)",!1);const b=A=>{_&&clearTimeout(_),x()},S=A=>{Date.now()<p&&_&&clearTimeout(_),_=setTimeout(d,A.duration+y),x()};this._modules.events.on("dragStart",b).on("zoomStart",S).on("dragEnd",d).on(["viewChanged","zoom","rotate","move","animate"],E),this._modules.dom.addDirectWindowEventListener("resize",d),this._modules.events.on("resize",a),u=()=>{this._modules.events.off(a).off(b).off(S).off(d).off(E),this._modules.dom.removeDirectWindowEventListener("resize",d)}}return r.style.touchAction="none",r.style.pointerEvents="none",a(),{element:r,removeListeners:u,refresh:c=>{d&&!d()||o(c)},clear:()=>i==null?void 0:i.clearRect(0,0,r.width,r.height)}},this.createSVG=e=>{const{element:t}=e;t.style["pointer-events"]="none";const n=()=>{e.draw(e.element)},s=r=>{let{zoom:i,x:o,y:a,width:u,height:d}=r||this._modules.camera.getView();if(u=Math.floor(u),d=Math.floor(d),i===void 0||o===void 0||a===void 0||u===void 0||d===void 0)return null;const c=u/2/i,g=d/2/i,f=Math.cos(-this._modules.camera.getAngle()),p=Math.sin(-this._modules.camera.getAngle()),_=f*o-p*a-c,y=p*o+f*a-g,x=u/i,E=d/i;t.style.width=`${u}px`,t.style.height=`${d}px`,t.setAttribute("width",`${u}`),t.setAttribute("height",`${d}`),t.setAttribute("viewBox",`${_} ${y} ${x} ${E}`)};return this._modules.events.on(["viewChanged","zoom","rotate","move","animate","afterImageExport"],()=>s()),t.addEventListener("mousemove",CA),s(),n(),{element:t,removeListeners:()=>{this._modules.events.off(s)},updateTransformation:s,refresh:n}},this._createOverlay=e=>{const t=()=>{const{element:r,position:i}=e,{zoom:o,x:a,y:u,width:d,height:c}=this._modules.camera.getView();if(o===void 0||a===void 0||u===void 0||d===void 0||c===void 0)return null;const g=o,f=d/2,p=c/2,_=-this._modules.camera.getAngle(),y=(i.x-a)*g,x=(i.y-u)*g;r.style.transformOrigin="top left",r.style.transform=`translate(${f}px, ${p}px) rotate(${_}rad) translate(${y}px, ${x}px) ${e.scaled?`scale(${g}, ${g})`:""}`};this._modules.events.on(["viewChanged","zoom","rotate","move","animate","afterImageExport"],t);const{element:n,size:s}=e;return s&&(n.style.width=`${s.width}`,n.style.height=`${s.height}`),n.addEventListener("mousemove",CA),t(),{element:n,removeListeners:()=>{this._modules.events.off(t)},updateTransformation:t}},this.addLayer=(e,t="layer",n=this._elements.length)=>{const s=typeof e=="string"?Zm(e):e;this._elements.push(s);const r={element:s};return r.type=t,r.getLevel=()=>this._elements.indexOf(s),r.moveTo=i=>(this._elements.splice(i,0,this._elements.splice(r.getLevel(),1)[0]),this._updateDom(this._elements),r),r.moveUp=()=>r.moveTo(r.getLevel()+1),r.moveDown=()=>r.moveTo(r.getLevel()-1),r.moveToTop=()=>r.moveTo(this._elements.length-1),r.moveToBottom=()=>r.moveTo(0),r.destroy=()=>this._removeLayer(r),r.hide=()=>(r.element&&(r.element.style.visibility="hidden"),r),r.show=()=>(r.element&&(r.element.style.visibility="visible"),r),r.isHidden=()=>r.element.style.visibility==="hidden",r.setOpacity=i=>(r.element&&(r.element.style.opacity=i.toString()),r),r.getOpacity=()=>parseFloat(r.element.style.opacity||"1"),r.setPosition=i=>{if(r.element){const o=r.element.style;o.left=`${i.x}px`,o.top=`${i.y}px`}return r},r.setSize=i=>{if(r.element&&i){const{width:o,height:a}=i,u=r.element.style;u.width=`${o}px`,u.height=`${a}px`}return r},r.moveTo(n),this._layers.push(r),r},this.addCanvasLayer=(e,t={isStatic:!1,noClear:!1},n=this._elements.length)=>{const s=this.createCanvas(e,t),{element:r,removeListeners:i,refresh:o,clear:a}=s,u=this.addLayer(r,"canvas",n);return r.classList.add("ogma-canvas-layer"),u.destroy=()=>this._removeLayer(u,i),u.refresh=o,u.clear=a,u.draw=e,u.options=t,u},this.addOverlay=(e,t=this._elements.length)=>{typeof e.element=="string"&&(e.element=Zm(e.element)),e.scaled=e.scaled===void 0||e.scaled;const n=this._createOverlay(e),{element:s,removeListeners:r,updateTransformation:i}=n,o=this.addLayer(s,"overlay",t);return o._onViewChange=i,o._onDestroy=r,o.destroy=()=>this._removeLayer(o,r),o.setPosition=a=>(e.position=a,i(),o),e.size&&o.setSize(e.size),o},this.addSVGLayer=(e,t=this._elements.length)=>{const n=this.createSVG(e),{element:s,refresh:r,removeListeners:i,updateTransformation:o}=n,a=this.addLayer(s,"svg",t);return a._onViewChange=o,a._onDestroy=i,a.destroy=()=>this._removeLayer(a,i),a.refresh=r,a}}canvasToImage(e,t){const n=document.createElement("canvas");n.width=t.width,n.height=t.height;const s=n.getContext("2d");this.render(s,e.draw,{...e.options,noClear:!0},{...t,pixelRatio:1});const r=rn("image");return r.setAttribute("href",n.toDataURL("image/png")),r.setAttribute("width",n.width),r.setAttribute("height",n.height),r}exportPNG(e,t,n){const s=e.getContext("2d");let r=Promise.resolve();return t.forEach(i=>{r=r.then(()=>i.type==="canvas"?(this.render(s,i.draw,{...i.options,noClear:!0},n),Promise.resolve()):(i._onViewChange&&i._onViewChange(n),N6(i.element,s)))}),r}exportSVG(e,t,n,s){let r=Promise.resolve();return t.forEach(i=>{r=r.then(()=>i.type==="canvas"?Promise.resolve(this.canvasToImage(i,n)):(i._onViewChange&&i._onViewChange(n),i.element.cloneNode(!0))).then(o=>s?e.insertBefore(o,e.querySelector(".ogma-nodes").parentNode||e.firstChild):e.appendChild(o))}),r}export(e){const t=this._layers.sort((r,i)=>r.getLevel()-i.getLevel()).filter(r=>r.type==="canvas"||r.type==="svg"),n=this.ogmaLayer?this.ogmaLayer.getLevel():0,s=e.below?t.filter(r=>r.getLevel()<n):t.filter(r=>r.getLevel()>n);return e.canvas?this.exportPNG(e.canvas,s,e.view):this.exportSVG(e.svg,s,e.view,e.below)}onMounted(){const e=this._modules.graphics.getDomElement();this._updateDom=L6(e);const t=e.firstChild;t&&(this.ogmaLayer=this.addLayer(t)),this.runCallbacks()}runCallbacks(){this.ogmaLayer&&(this.readyCallbacks.forEach(e=>e()),this.readyCallbacks=[])}whenReady(e){this.readyCallbacks.push(e),this.ogmaLayer&&this.runCallbacks()}_removeLayer(e,t){return e.element&&e.element.parentNode&&(this._elements.splice(e.getLevel(),1),t&&t(),e.element=null,this._updateDom(this._elements)),this._layers=this._layers.filter(n=>n!==e),e}destroy(){this._elements=[]}},k6=class extends zt{onMounted(){const e=this._modules.graph;this._nodeList=e.getNodeAttribute("object"),this._edgeList=e.getEdgeAttribute("object"),this._sourceList=e.getEdgeAttribute("source"),this._targetList=e.getEdgeAttribute("target"),this._excludedList=e.getEdgeAttribute("excluded"),this._virtualList=e.getEdgeAttribute("virtual")}shortestPath(e={source:void 0,target:void 0}){const{source:t,target:n,directed:s=!1,edges:r=this._ogma.getEdges(),nodes:i=this._ogma.getNodes(),edgeCostFunction:o=()=>1,heuristicFunction:a=()=>0}=e,u=r.reduce((y,x)=>(y[x._index]=!0,y),{}),d=i.reduce((y,x)=>(y[x._index]=!0,y),{}),c=this._modules.graph.getNode(t),g=this._modules.graph.getNode(n);if(!c)throw new Error("the source is not a node");if(!g)throw new Error("the target is not a node");const f=c._index,p=g._index;d[f]=!0,d[p]=!0;let _=null;if(f===p)_={nodes:c.toList(),edges:this._modules.graph.edgeList()};else{const y=this._modules.graph.getNodeMaxIndex()+1,x=new Int32Array(y),E=new Float32Array(y),b=new Float32Array(y),S=new Set,A=new tT(b);for(E.fill(1/0),b.fill(1/0),x.fill(-1),A.add(f),E[f]=0,b[f]=a(c,g);!A.isEmpty();){const C=A.removeMin();if(C===p){_=this._constructPath(x,f,p);break}S.add(C);const k=this._modules.graph.getAdjacentDirections(C);if(k)for(let M=0;M<k.length;++M){const R=k[M],O=this._modules.graph.getEdgeIndexesInDirection(R);let j=-1,z=0,X=-1;for(let oe=0;oe<O.length;++oe){const re=O[oe],Q=this._sourceList.get(re),he=this._targetList.get(re);if(Q===he||!d[Q]||!d[he]||s&&C!==Q||!u[re])continue;const fe=o(this._edgeList.get(re));(j===-1||fe<z)&&(j=re,z=fe,X=Q===C?he:Q)}if(X!==-1||S.has(X)){const oe=E[C]+z;if(!A.has(X)||oe<E[X]){const re=this._nodeList.get(C);x[X]=j,E[X]=oe,b[X]=oe+a(re,g),A.add(X)}}}}}return Promise.resolve(_)}_constructPath(e,t,n){const s=[n],r=[];let i=n;for(;i!==t;){const o=e[i],a=this._sourceList.get(o),u=this._targetList.get(o);i=i===a?u:a,s.push(i),r.push(o)}return s.reverse(),r.reverse(),{nodes:this._modules.graph.nodeList(new Uint32Array(s)),edges:this._modules.graph.edgeList(new Uint32Array(r))}}detectCycle(e,t){const n=t.getSource(),s=t.getTarget(),r=Z1(e._indexes,n._indexes,s._indexes);return r?this._modules.graph.nodeList(new Uint32Array(r)).dedupe():this._modules.graph.nodeList()}getAllSimpleCycles(e,t){const n=t.getSource(),s=t.getTarget();return new Q1(e._indexes,n._indexes,s._indexes).getCycles().map(r=>this._modules.graph.nodeList(new Uint32Array(r)))}minimumSpanningTree(e,t,n){const s=this._modules.graph;e=s.getNodes(e),t=s.getEdges(t);const r=new Set;e.forEach(u=>r.add(u._index));const i=s.getConnectedComponents(e,{filter:u=>r.has(u),internalIndexes:!0}),o={};i.forEach((u,d)=>u.forEach(c=>o[c]=d));const a=[];return t.forEach(u=>{const d=o[u.getSource()._index];d!==void 0&&(a[d]===void 0&&(a[d]=[]),a[d].push(u._index))}),i.map((u,d)=>{const c=J1(u,a[d]||[],g=>s.edge(g).getSource()._index,g=>s.edge(g).getTarget()._index,n?g=>n(s.edge(g)):void 0);return{nodes:s.nodeList(new Uint32Array(u)),edges:s.edgeList(new Uint32Array(c))}})}bfs({root:e,onNode:t,onEdge:n=Vt,directed:s=!1}){const r=this._modules.graph,i=[e],o=new Set,a={direction:s?"out":"both"};for(;i.length;){const u=i.pop();if(!o.has(u._index)){if(t(u)===!0)return;o.add(u._index),r.getAdjacentEdges(u,a).forEach(d=>{if(n(d)===!1)return;const c=d.getSource()===u?d.getTarget():d.getSource();i.unshift(c)})}}}dfs({root:e,onNode:t,onEdge:n=Vt,directed:s=!1}){const r=this._modules.graph,i=[e],o=new Set,a={direction:s?"out":"both"};for(;i.length;){const u=i.pop();if(!o.has(u._index)){if(t(u)===!0)return;o.add(u._index),r.getAdjacentEdges(u,a).forEach(d=>{if(n(d)===!1)return;const c=d.getSource()===u?d.getTarget():d.getSource();i.push(c)})}}}betweenness({nodes:e,edges:t,directed:n,normalized:s}){const r=this._ogma.getNodes().subtract(e),i=this._ogma.getEdges().subtract(t).concat(r.fastGetAdjacentElements().edges).dedupe();return eT({adjacency:e.map(o=>{const a=this._ogma.edgeList(this._ogma.modules.graph.topology.getAdjacentElements(!1,o.toList()._indexes,{direction:n?"out":"both"})).subtract(i).dedupe();return{id:o._index,adj:a.map(u=>u.getSource()._index===o._index?u.getTarget()._index:u.getSource()._index)}}),directed:n,normalized:s})}fishEyeExpand(e,t,n){return G1(e,t,n)}},LA=(e,t)=>{if(!e)throw new Error("Traversal options are required");if(typeof e.onNode!="function")throw new Error("onNode callback is required");if(e.root=t.getNode(e.root),!e.root)throw new Error(`Root node '${e.root}' does not exist`);return e},Bc=()=>({nodes:void 0,edges:void 0}),M6=class extends En{constructor(){super(...arguments),this.shortestPath=e=>this._ogma.modules.algorithms.shortestPath(e),this.hasCycle=e=>{const{nodes:t,edges:n}=e||Bc();return this.detectCycle({nodes:t,edges:n})!==null},this.getAllSimpleCycles=e=>{let{nodes:t,edges:n}=e||Bc();return t||(t=this._ogma.getNodes()),n||(n=t.getAdjacentEdges({bothExtremities:!0})),this._ogma.modules.algorithms.getAllSimpleCycles(t,n)},this.detectCycle=e=>{let{nodes:t,edges:n}=e||Bc();t||(t=this._ogma.getNodes()),n||(n=t.getAdjacentEdges({bothExtremities:!0}));const s=this._ogma.modules.algorithms.detectCycle(t,n);return s.size?s:null},this.minimumSpanningTree=e=>{const{nodes:t,edges:n,edgeCostFunction:s}=e||{...Bc(),edgeCostFunction:void 0};return this._ogma.modules.algorithms.minimumSpanningTree(t,n,s)},this.dfs=e=>this._ogma.modules.algorithms.dfs(LA(e,this._ogma.modules.graph)),this.bfs=e=>this._ogma.modules.algorithms.bfs(LA(e,this._ogma.modules.graph)),this.betweenness=(e={})=>(e={nodes:e.nodes||this._ogma.getNodes(),edges:e.edges||this._ogma.getEdges(),directed:e.directed!==void 0&&e.directed,normalized:e.normalized===void 0||e.normalized},this._ogma.modules.algorithms.betweenness(e)),this.getMinimumEnclosingCircle=e=>{if(!e||e.size===0)throw new Error("getMinimumEnclosingCircle: no nodes provided");const t=e.getAttribute("x"),n=e.getAttribute("y"),s=e.getAttribute("radius"),[r,i,o]=Od(t,n,s);return{x:r,y:i,radius:o}},this.circlePack=({nodes:e,margin:t=0,origin:n={x:0,y:0},duration:s=0,easing:r="linear",sort:i,dryRun:o})=>{if(!e||e.size===0)throw new Error("circlePack: no nodes provided");let a=e.map((d,c)=>({index:c,radius:+d.getAttribute("radius")+t,id:d.getId()}));if(i)if(i==="asc")a=a.sort((d,c)=>c.radius-d.radius);else if(i==="desc")a=a.sort((d,c)=>d.radius-c.radius);else{if(typeof i!="function")throw new Error("circlePack: invalid sort option");a=a.sort((d,c)=>i(e.get(d.index),e.get(c.index)))}if(n&&(!isFinite(n.x)||!isFinite(n.y)))throw new Error("circlePack: invalid origin");const u=U1(a,n.x,n.y).reduce((d,{index:c,x:g,y:f})=>(d[c]={x:g,y:f},d),new Array(e.size));return o?u:e.setAttributes(u,{duration:s,easing:r}).then(()=>u)},this.fishEyeExpand=({nodes:e,focusNode:t,deltaRadius:n,duration:s=0,dryRun:r=!1,easing:i="linear"})=>{if(!e||e.size===0)throw new Error("Expand/collapse: no nodes provided");if(!(t instanceof Xr))throw new Error("Expand/collapse: no focus node provided");if(!isFinite(n))throw new Error("Expand/collapse: invalid delta radius");const o=this._ogma.modules.algorithms.fishEyeExpand(e,t,n);return r?o:e.setAttributes(o,{duration:s,easing:i}).then(()=>o)}}},P6=Nx,So={},ra={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NA;function R6(){if(NA)return ra;NA=1;var e=Nd();function t(w){for(var I="https://reactjs.org/docs/error-decoder.html?invariant="+w,F=1;F<arguments.length;F++)I+="&args[]="+encodeURIComponent(arguments[F]);return"Minified React error #"+w+"; visit "+I+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=Object.prototype.hasOwnProperty,s=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,r={},i={};function o(w){return n.call(i,w)?!0:n.call(r,w)?!1:s.test(w)?i[w]=!0:(r[w]=!0,!1)}function a(w,I,F,B,le,ee,ye){this.acceptsBooleans=I===2||I===3||I===4,this.attributeName=B,this.attributeNamespace=le,this.mustUseProperty=F,this.propertyName=w,this.type=I,this.sanitizeURL=ee,this.removeEmptyString=ye}var u={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(w){u[w]=new a(w,0,!1,w,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(w){var I=w[0];u[I]=new a(I,1,!1,w[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(w){u[w]=new a(w,2,!1,w.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(w){u[w]=new a(w,2,!1,w,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(w){u[w]=new a(w,3,!1,w.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(w){u[w]=new a(w,3,!0,w,null,!1,!1)}),["capture","download"].forEach(function(w){u[w]=new a(w,4,!1,w,null,!1,!1)}),["cols","rows","size","span"].forEach(function(w){u[w]=new a(w,6,!1,w,null,!1,!1)}),["rowSpan","start"].forEach(function(w){u[w]=new a(w,5,!1,w.toLowerCase(),null,!1,!1)});var d=/[\-:]([a-z])/g;function c(w){return w[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(w){var I=w.replace(d,c);u[I]=new a(I,1,!1,w,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(w){var I=w.replace(d,c);u[I]=new a(I,1,!1,w,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(w){var I=w.replace(d,c);u[I]=new a(I,1,!1,w,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(w){u[w]=new a(w,1,!1,w.toLowerCase(),null,!1,!1)}),u.xlinkHref=new a("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(w){u[w]=new a(w,1,!1,w.toLowerCase(),null,!0,!0)});var g={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},f=["Webkit","ms","Moz","O"];Object.keys(g).forEach(function(w){f.forEach(function(I){I=I+w.charAt(0).toUpperCase()+w.substring(1),g[I]=g[w]})});var p=/["'&<>]/;function _(w){if(typeof w=="boolean"||typeof w=="number")return""+w;w=""+w;var I=p.exec(w);if(I){var F="",B,le=0;for(B=I.index;B<w.length;B++){switch(w.charCodeAt(B)){case 34:I="&quot;";break;case 38:I="&amp;";break;case 39:I="&#x27;";break;case 60:I="&lt;";break;case 62:I="&gt;";break;default:continue}le!==B&&(F+=w.substring(le,B)),le=B+1,F+=I}w=le!==B?F+w.substring(le,B):F}return w}var y=/([A-Z])/g,x=/^ms-/,E=Array.isArray;function b(w,I){return{insertionMode:w,selectedValue:I}}function S(w,I,F){switch(I){case"select":return b(1,F.value!=null?F.value:F.defaultValue);case"svg":return b(2,null);case"math":return b(3,null);case"foreignObject":return b(1,null);case"table":return b(4,null);case"thead":case"tbody":case"tfoot":return b(5,null);case"colgroup":return b(7,null);case"tr":return b(6,null)}return 4<=w.insertionMode||w.insertionMode===0?b(1,null):w}var A=new Map;function C(w,I,F){if(typeof F!="object")throw Error(t(62));I=!0;for(var B in F)if(n.call(F,B)){var le=F[B];if(le!=null&&typeof le!="boolean"&&le!==""){if(B.indexOf("--")===0){var ee=_(B);le=_((""+le).trim())}else{ee=B;var ye=A.get(ee);ye!==void 0||(ye=_(ee.replace(y,"-$1").toLowerCase().replace(x,"-ms-")),A.set(ee,ye)),ee=ye,le=typeof le=="number"?le===0||n.call(g,B)?""+le:le+"px":_((""+le).trim())}I?(I=!1,w.push(' style="',ee,":",le)):w.push(";",ee,":",le)}}I||w.push('"')}function k(w,I,F,B){switch(F){case"style":C(w,I,B);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<F.length)||F[0]!=="o"&&F[0]!=="O"||F[1]!=="n"&&F[1]!=="N"){if(I=u.hasOwnProperty(F)?u[F]:null,I!==null){switch(typeof B){case"function":case"symbol":return;case"boolean":if(!I.acceptsBooleans)return}switch(F=I.attributeName,I.type){case 3:B&&w.push(" ",F,'=""');break;case 4:B===!0?w.push(" ",F,'=""'):B!==!1&&w.push(" ",F,'="',_(B),'"');break;case 5:isNaN(B)||w.push(" ",F,'="',_(B),'"');break;case 6:!isNaN(B)&&1<=B&&w.push(" ",F,'="',_(B),'"');break;default:I.sanitizeURL&&(B=""+B),w.push(" ",F,'="',_(B),'"')}}else if(o(F)){switch(typeof B){case"function":case"symbol":return;case"boolean":if(I=F.toLowerCase().slice(0,5),I!=="data-"&&I!=="aria-")return}w.push(" ",F,'="',_(B),'"')}}}function M(w,I,F){if(I!=null){if(F!=null)throw Error(t(60));if(typeof I!="object"||!("__html"in I))throw Error(t(61));I=I.__html,I!=null&&w.push(""+I)}}function R(w){var I="";return e.Children.forEach(w,function(F){F!=null&&(I+=F)}),I}function O(w,I,F,B){w.push(X(F));var le=F=null,ee;for(ee in I)if(n.call(I,ee)){var ye=I[ee];if(ye!=null)switch(ee){case"children":F=ye;break;case"dangerouslySetInnerHTML":le=ye;break;default:k(w,B,ee,ye)}}return w.push(">"),M(w,le,F),typeof F=="string"?(w.push(_(F)),null):F}var j=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,z=new Map;function X(w){var I=z.get(w);if(I===void 0){if(!j.test(w))throw Error(t(65,w));I="<"+w,z.set(w,I)}return I}function oe(w,I,F,B,le){switch(I){case"select":w.push(X("select"));var ee=null,ye=null;for(it in F)if(n.call(F,it)){var Pe=F[it];if(Pe!=null)switch(it){case"children":ee=Pe;break;case"dangerouslySetInnerHTML":ye=Pe;break;case"defaultValue":case"value":break;default:k(w,B,it,Pe)}}return w.push(">"),M(w,ye,ee),ee;case"option":ye=le.selectedValue,w.push(X("option"));var Ve=Pe=null,rt=null,it=null;for(ee in F)if(n.call(F,ee)){var St=F[ee];if(St!=null)switch(ee){case"children":Pe=St;break;case"selected":rt=St;break;case"dangerouslySetInnerHTML":it=St;break;case"value":Ve=St;default:k(w,B,ee,St)}}if(ye!=null)if(F=Ve!==null?""+Ve:R(Pe),E(ye)){for(B=0;B<ye.length;B++)if(""+ye[B]===F){w.push(' selected=""');break}}else""+ye===F&&w.push(' selected=""');else rt&&w.push(' selected=""');return w.push(">"),M(w,it,Pe),Pe;case"textarea":w.push(X("textarea")),it=ye=ee=null;for(Pe in F)if(n.call(F,Pe)&&(Ve=F[Pe],Ve!=null))switch(Pe){case"children":it=Ve;break;case"value":ee=Ve;break;case"defaultValue":ye=Ve;break;case"dangerouslySetInnerHTML":throw Error(t(91));default:k(w,B,Pe,Ve)}if(ee===null&&ye!==null&&(ee=ye),w.push(">"),it!=null){if(ee!=null)throw Error(t(92));if(E(it)&&1<it.length)throw Error(t(93));ee=""+it}return typeof ee=="string"&&ee[0]===`
`&&w.push(`
`),ee!==null&&w.push(_(""+ee)),null;case"input":w.push(X("input")),Ve=it=Pe=ee=null;for(ye in F)if(n.call(F,ye)&&(rt=F[ye],rt!=null))switch(ye){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,"input"));case"defaultChecked":Ve=rt;break;case"defaultValue":Pe=rt;break;case"checked":it=rt;break;case"value":ee=rt;break;default:k(w,B,ye,rt)}return it!==null?k(w,B,"checked",it):Ve!==null&&k(w,B,"checked",Ve),ee!==null?k(w,B,"value",ee):Pe!==null&&k(w,B,"value",Pe),w.push("/>"),null;case"menuitem":w.push(X("menuitem"));for(var Jt in F)if(n.call(F,Jt)&&(ee=F[Jt],ee!=null))switch(Jt){case"children":case"dangerouslySetInnerHTML":throw Error(t(400));default:k(w,B,Jt,ee)}return w.push(">"),null;case"title":w.push(X("title")),ee=null;for(St in F)if(n.call(F,St)&&(ye=F[St],ye!=null))switch(St){case"children":ee=ye;break;case"dangerouslySetInnerHTML":throw Error(t(434));default:k(w,B,St,ye)}return w.push(">"),ee;case"listing":case"pre":w.push(X(I)),ye=ee=null;for(Ve in F)if(n.call(F,Ve)&&(Pe=F[Ve],Pe!=null))switch(Ve){case"children":ee=Pe;break;case"dangerouslySetInnerHTML":ye=Pe;break;default:k(w,B,Ve,Pe)}if(w.push(">"),ye!=null){if(ee!=null)throw Error(t(60));if(typeof ye!="object"||!("__html"in ye))throw Error(t(61));F=ye.__html,F!=null&&(typeof F=="string"&&0<F.length&&F[0]===`
`?w.push(`
`,F):w.push(""+F))}return typeof ee=="string"&&ee[0]===`
`&&w.push(`
`),ee;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":w.push(X(I));for(var Kt in F)if(n.call(F,Kt)&&(ee=F[Kt],ee!=null))switch(Kt){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,I));default:k(w,B,Kt,ee)}return w.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return O(w,F,I,B);case"html":return le.insertionMode===0&&w.push("<!DOCTYPE html>"),O(w,F,I,B);default:if(I.indexOf("-")===-1&&typeof F.is!="string")return O(w,F,I,B);w.push(X(I)),ye=ee=null;for(rt in F)if(n.call(F,rt)&&(Pe=F[rt],Pe!=null))switch(rt){case"children":ee=Pe;break;case"dangerouslySetInnerHTML":ye=Pe;break;case"style":C(w,B,Pe);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:o(rt)&&typeof Pe!="function"&&typeof Pe!="symbol"&&w.push(" ",rt,'="',_(Pe),'"')}return w.push(">"),M(w,ye,ee),ee}}function re(w,I,F){if(w.push('<!--$?--><template id="'),F===null)throw Error(t(395));return w.push(F),w.push('"></template>')}function Q(w,I,F,B){switch(F.insertionMode){case 0:case 1:return w.push('<div hidden id="'),w.push(I.segmentPrefix),I=B.toString(16),w.push(I),w.push('">');case 2:return w.push('<svg aria-hidden="true" style="display:none" id="'),w.push(I.segmentPrefix),I=B.toString(16),w.push(I),w.push('">');case 3:return w.push('<math aria-hidden="true" style="display:none" id="'),w.push(I.segmentPrefix),I=B.toString(16),w.push(I),w.push('">');case 4:return w.push('<table hidden id="'),w.push(I.segmentPrefix),I=B.toString(16),w.push(I),w.push('">');case 5:return w.push('<table hidden><tbody id="'),w.push(I.segmentPrefix),I=B.toString(16),w.push(I),w.push('">');case 6:return w.push('<table hidden><tr id="'),w.push(I.segmentPrefix),I=B.toString(16),w.push(I),w.push('">');case 7:return w.push('<table hidden><colgroup id="'),w.push(I.segmentPrefix),I=B.toString(16),w.push(I),w.push('">');default:throw Error(t(397))}}function he(w,I){switch(I.insertionMode){case 0:case 1:return w.push("</div>");case 2:return w.push("</svg>");case 3:return w.push("</math>");case 4:return w.push("</table>");case 5:return w.push("</tbody></table>");case 6:return w.push("</tr></table>");case 7:return w.push("</colgroup></table>");default:throw Error(t(397))}}var fe=/[<\u2028\u2029]/g;function ae(w){return JSON.stringify(w).replace(fe,function(I){switch(I){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function me(w,I){return I=I===void 0?"":I,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:I+"P:",segmentPrefix:I+"S:",boundaryPrefix:I+"B:",idPrefix:I,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:w}}function we(w,I,F,B){return F.generateStaticMarkup?(w.push(_(I)),!1):(I===""?w=B:(B&&w.push("<!-- -->"),w.push(_(I)),w=!0),w)}var Z=Object.assign,_e=Symbol.for("react.element"),ze=Symbol.for("react.portal"),Re=Symbol.for("react.fragment"),We=Symbol.for("react.strict_mode"),st=Symbol.for("react.profiler"),ft=Symbol.for("react.provider"),ut=Symbol.for("react.context"),ce=Symbol.for("react.forward_ref"),be=Symbol.for("react.suspense"),qe=Symbol.for("react.suspense_list"),Ue=Symbol.for("react.memo"),Ie=Symbol.for("react.lazy"),Fe=Symbol.for("react.scope"),Oe=Symbol.for("react.debug_trace_mode"),Xe=Symbol.for("react.legacy_hidden"),dt=Symbol.for("react.default_value"),mt=Symbol.iterator;function ht(w){if(w==null)return null;if(typeof w=="function")return w.displayName||w.name||null;if(typeof w=="string")return w;switch(w){case Re:return"Fragment";case ze:return"Portal";case st:return"Profiler";case We:return"StrictMode";case be:return"Suspense";case qe:return"SuspenseList"}if(typeof w=="object")switch(w.$$typeof){case ut:return(w.displayName||"Context")+".Consumer";case ft:return(w._context.displayName||"Context")+".Provider";case ce:var I=w.render;return w=w.displayName,w||(w=I.displayName||I.name||"",w=w!==""?"ForwardRef("+w+")":"ForwardRef"),w;case Ue:return I=w.displayName||null,I!==null?I:ht(w.type)||"Memo";case Ie:I=w._payload,w=w._init;try{return ht(w(I))}catch{}}return null}var wt={};function Lt(w,I){if(w=w.contextTypes,!w)return wt;var F={},B;for(B in w)F[B]=I[B];return F}var Tt=null;function ot(w,I){if(w!==I){w.context._currentValue2=w.parentValue,w=w.parent;var F=I.parent;if(w===null){if(F!==null)throw Error(t(401))}else{if(F===null)throw Error(t(401));ot(w,F)}I.context._currentValue2=I.value}}function jt(w){w.context._currentValue2=w.parentValue,w=w.parent,w!==null&&jt(w)}function Nt(w){var I=w.parent;I!==null&&Nt(I),w.context._currentValue2=w.value}function Gt(w,I){if(w.context._currentValue2=w.parentValue,w=w.parent,w===null)throw Error(t(402));w.depth===I.depth?ot(w,I):Gt(w,I)}function Wt(w,I){var F=I.parent;if(F===null)throw Error(t(402));w.depth===F.depth?ot(w,F):Wt(w,F),I.context._currentValue2=I.value}function hn(w){var I=Tt;I!==w&&(I===null?Nt(w):w===null?jt(I):I.depth===w.depth?ot(I,w):I.depth>w.depth?Gt(I,w):Wt(I,w),Tt=w)}var Sn={isMounted:function(){return!1},enqueueSetState:function(w,I){w=w._reactInternals,w.queue!==null&&w.queue.push(I)},enqueueReplaceState:function(w,I){w=w._reactInternals,w.replace=!0,w.queue=[I]},enqueueForceUpdate:function(){}};function Jn(w,I,F,B){var le=w.state!==void 0?w.state:null;w.updater=Sn,w.props=F,w.state=le;var ee={queue:[],replace:!1};w._reactInternals=ee;var ye=I.contextType;if(w.context=typeof ye=="object"&&ye!==null?ye._currentValue2:B,ye=I.getDerivedStateFromProps,typeof ye=="function"&&(ye=ye(F,le),le=ye==null?le:Z({},le,ye),w.state=le),typeof I.getDerivedStateFromProps!="function"&&typeof w.getSnapshotBeforeUpdate!="function"&&(typeof w.UNSAFE_componentWillMount=="function"||typeof w.componentWillMount=="function"))if(I=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),I!==w.state&&Sn.enqueueReplaceState(w,w.state,null),ee.queue!==null&&0<ee.queue.length)if(I=ee.queue,ye=ee.replace,ee.queue=null,ee.replace=!1,ye&&I.length===1)w.state=I[0];else{for(ee=ye?I[0]:w.state,le=!0,ye=ye?1:0;ye<I.length;ye++){var Pe=I[ye];Pe=typeof Pe=="function"?Pe.call(w,ee,F,B):Pe,Pe!=null&&(le?(le=!1,ee=Z({},ee,Pe)):Z(ee,Pe))}w.state=ee}else ee.queue=null}var Wn={id:1,overflow:""};function Un(w,I,F){var B=w.id;w=w.overflow;var le=32-Xn(B)-1;B&=~(1<<le),F+=1;var ee=32-Xn(I)+le;if(30<ee){var ye=le-le%5;return ee=(B&(1<<ye)-1).toString(32),B>>=ye,le-=ye,{id:1<<32-Xn(I)+le|F<<le|B,overflow:ee+w}}return{id:1<<ee|F<<le|B,overflow:w}}var Xn=Math.clz32?Math.clz32:Vn,Gn=Math.log,is=Math.LN2;function Vn(w){return w>>>=0,w===0?32:31-(Gn(w)/is|0)|0}function An(w,I){return w===I&&(w!==0||1/w===1/I)||w!==w&&I!==I}var Yn=typeof Object.is=="function"?Object.is:An,xn=null,fn=null,Ht=null,vt=null,Pn=!1,Zn=!1,qt=0,cn=null,on=0;function vn(){if(xn===null)throw Error(t(321));return xn}function wn(){if(0<on)throw Error(t(312));return{memoizedState:null,queue:null,next:null}}function Rn(){return vt===null?Ht===null?(Pn=!1,Ht=vt=wn()):(Pn=!0,vt=Ht):vt.next===null?(Pn=!1,vt=vt.next=wn()):(Pn=!0,vt=vt.next),vt}function jn(){fn=xn=null,Zn=!1,Ht=null,on=0,vt=cn=null}function Bt(w,I){return typeof I=="function"?I(w):I}function os(w,I,F){if(xn=vn(),vt=Rn(),Pn){var B=vt.queue;if(I=B.dispatch,cn!==null&&(F=cn.get(B),F!==void 0)){cn.delete(B),B=vt.memoizedState;do B=w(B,F.action),F=F.next;while(F!==null);return vt.memoizedState=B,[B,I]}return[vt.memoizedState,I]}return w=w===Bt?typeof I=="function"?I():I:F!==void 0?F(I):I,vt.memoizedState=w,w=vt.queue={last:null,dispatch:null},w=w.dispatch=Y.bind(null,xn,w),[vt.memoizedState,w]}function q(w,I){if(xn=vn(),vt=Rn(),I=I===void 0?null:I,vt!==null){var F=vt.memoizedState;if(F!==null&&I!==null){var B=F[1];e:if(B===null)B=!1;else{for(var le=0;le<B.length&&le<I.length;le++)if(!Yn(I[le],B[le])){B=!1;break e}B=!0}if(B)return F[0]}}return w=w(),vt.memoizedState=[w,I],w}function Y(w,I,F){if(25<=on)throw Error(t(301));if(w===xn)if(Zn=!0,w={action:F,next:null},cn===null&&(cn=new Map),F=cn.get(I),F===void 0)cn.set(I,w);else{for(I=F;I.next!==null;)I=I.next;I.next=w}}function ne(){throw Error(t(394))}function K(){}var Me={readContext:function(w){return w._currentValue2},useContext:function(w){return vn(),w._currentValue2},useMemo:q,useReducer:os,useRef:function(w){xn=vn(),vt=Rn();var I=vt.memoizedState;return I===null?(w={current:w},vt.memoizedState=w):I},useState:function(w){return os(Bt,w)},useInsertionEffect:K,useLayoutEffect:function(){},useCallback:function(w,I){return q(function(){return w},I)},useImperativeHandle:K,useEffect:K,useDebugValue:K,useDeferredValue:function(w){return vn(),w},useTransition:function(){return vn(),[!1,ne]},useId:function(){var w=fn.treeContext,I=w.overflow;w=w.id,w=(w&~(1<<32-Xn(w)-1)).toString(32)+I;var F=Qe;if(F===null)throw Error(t(404));return I=qt++,w=":"+F.idPrefix+"R"+w,0<I&&(w+="H"+I.toString(32)),w+":"},useMutableSource:function(w,I){return vn(),I(w._source)},useSyncExternalStore:function(w,I,F){if(F===void 0)throw Error(t(407));return F()}},Qe=null,at=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function tt(w){return console.error(w),null}function ct(){}function yt(w,I,F,B,le,ee,ye,Pe,Ve){var rt=[],it=new Set;return I={destination:null,responseState:I,progressiveChunkSize:B===void 0?12800:B,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:it,pingedTasks:rt,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:le===void 0?tt:le,onAllReady:ct,onShellReady:ye===void 0?ct:ye,onShellError:ct,onFatalError:ct},F=Pt(I,0,null,F,!1,!1),F.parentFlushed=!0,w=Mt(I,w,null,F,it,wt,null,Wn),rt.push(w),I}function Mt(w,I,F,B,le,ee,ye,Pe){w.allPendingTasks++,F===null?w.pendingRootTasks++:F.pendingTasks++;var Ve={node:I,ping:function(){var rt=w.pingedTasks;rt.push(Ve),rt.length===1&&Ee(w)},blockedBoundary:F,blockedSegment:B,abortSet:le,legacyContext:ee,context:ye,treeContext:Pe};return le.add(Ve),Ve}function Pt(w,I,F,B,le,ee){return{status:0,id:-1,index:I,parentFlushed:!1,chunks:[],children:[],formatContext:B,boundary:F,lastPushedText:le,textEmbedded:ee}}function At(w,I){if(w=w.onError(I),w!=null&&typeof w!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof w+'" instead');return w}function Ft(w,I){var F=w.onShellError;F(I),F=w.onFatalError,F(I),w.destination!==null?(w.status=2,w.destination.destroy(I)):(w.status=1,w.fatalError=I)}function Zt(w,I,F,B,le){for(xn={},fn=I,qt=0,w=F(B,le);Zn;)Zn=!1,qt=0,on+=1,vt=null,w=F(B,le);return jn(),w}function nn(w,I,F,B){var le=F.render(),ee=B.childContextTypes;if(ee!=null){var ye=I.legacyContext;if(typeof F.getChildContext!="function")B=ye;else{F=F.getChildContext();for(var Pe in F)if(!(Pe in ee))throw Error(t(108,ht(B)||"Unknown",Pe));B=Z({},ye,F)}I.legacyContext=B,G(w,I,le),I.legacyContext=ye}else G(w,I,le)}function H(w,I){if(w&&w.defaultProps){I=Z({},I),w=w.defaultProps;for(var F in w)I[F]===void 0&&(I[F]=w[F]);return I}return I}function U(w,I,F,B,le){if(typeof F=="function")if(F.prototype&&F.prototype.isReactComponent){le=Lt(F,I.legacyContext);var ee=F.contextType;ee=new F(B,typeof ee=="object"&&ee!==null?ee._currentValue2:le),Jn(ee,F,B,le),nn(w,I,ee,F)}else{ee=Lt(F,I.legacyContext),le=Zt(w,I,F,B,ee);var ye=qt!==0;if(typeof le=="object"&&le!==null&&typeof le.render=="function"&&le.$$typeof===void 0)Jn(le,F,B,ee),nn(w,I,le,F);else if(ye){B=I.treeContext,I.treeContext=Un(B,1,0);try{G(w,I,le)}finally{I.treeContext=B}}else G(w,I,le)}else if(typeof F=="string"){switch(le=I.blockedSegment,ee=oe(le.chunks,F,B,w.responseState,le.formatContext),le.lastPushedText=!1,ye=le.formatContext,le.formatContext=S(ye,F,B),ie(w,I,ee),le.formatContext=ye,F){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:le.chunks.push("</",F,">")}le.lastPushedText=!1}else{switch(F){case Xe:case Oe:case We:case st:case Re:G(w,I,B.children);return;case qe:G(w,I,B.children);return;case Fe:throw Error(t(343));case be:e:{F=I.blockedBoundary,le=I.blockedSegment,ee=B.fallback,B=B.children,ye=new Set;var Pe={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:ye,errorDigest:null},Ve=Pt(w,le.chunks.length,Pe,le.formatContext,!1,!1);le.children.push(Ve),le.lastPushedText=!1;var rt=Pt(w,0,null,le.formatContext,!1,!1);rt.parentFlushed=!0,I.blockedBoundary=Pe,I.blockedSegment=rt;try{if(ie(w,I,B),w.responseState.generateStaticMarkup||rt.lastPushedText&&rt.textEmbedded&&rt.chunks.push("<!-- -->"),rt.status=1,se(Pe,rt),Pe.pendingTasks===0)break e}catch(it){rt.status=4,Pe.forceClientRender=!0,Pe.errorDigest=At(w,it)}finally{I.blockedBoundary=F,I.blockedSegment=le}I=Mt(w,ee,F,Ve,ye,I.legacyContext,I.context,I.treeContext),w.pingedTasks.push(I)}return}if(typeof F=="object"&&F!==null)switch(F.$$typeof){case ce:if(B=Zt(w,I,F.render,B,le),qt!==0){F=I.treeContext,I.treeContext=Un(F,1,0);try{G(w,I,B)}finally{I.treeContext=F}}else G(w,I,B);return;case Ue:F=F.type,B=H(F,B),U(w,I,F,B,le);return;case ft:if(le=B.children,F=F._context,B=B.value,ee=F._currentValue2,F._currentValue2=B,ye=Tt,Tt=B={parent:ye,depth:ye===null?0:ye.depth+1,context:F,parentValue:ee,value:B},I.context=B,G(w,I,le),w=Tt,w===null)throw Error(t(403));B=w.parentValue,w.context._currentValue2=B===dt?w.context._defaultValue:B,w=Tt=w.parent,I.context=w;return;case ut:B=B.children,B=B(F._currentValue2),G(w,I,B);return;case Ie:le=F._init,F=le(F._payload),B=H(F,B),U(w,I,F,B,void 0);return}throw Error(t(130,F==null?F:typeof F,""))}}function G(w,I,F){if(I.node=F,typeof F=="object"&&F!==null){switch(F.$$typeof){case _e:U(w,I,F.type,F.props,F.ref);return;case ze:throw Error(t(257));case Ie:var B=F._init;F=B(F._payload),G(w,I,F);return}if(E(F)){$(w,I,F);return}if(F===null||typeof F!="object"?B=null:(B=mt&&F[mt]||F["@@iterator"],B=typeof B=="function"?B:null),B&&(B=B.call(F))){if(F=B.next(),!F.done){var le=[];do le.push(F.value),F=B.next();while(!F.done);$(w,I,le)}return}throw w=Object.prototype.toString.call(F),Error(t(31,w==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":w))}typeof F=="string"?(B=I.blockedSegment,B.lastPushedText=we(I.blockedSegment.chunks,F,w.responseState,B.lastPushedText)):typeof F=="number"&&(B=I.blockedSegment,B.lastPushedText=we(I.blockedSegment.chunks,""+F,w.responseState,B.lastPushedText))}function $(w,I,F){for(var B=F.length,le=0;le<B;le++){var ee=I.treeContext;I.treeContext=Un(ee,B,le);try{ie(w,I,F[le])}finally{I.treeContext=ee}}}function ie(w,I,F){var B=I.blockedSegment.formatContext,le=I.legacyContext,ee=I.context;try{return G(w,I,F)}catch(Ve){if(jn(),typeof Ve=="object"&&Ve!==null&&typeof Ve.then=="function"){F=Ve;var ye=I.blockedSegment,Pe=Pt(w,ye.chunks.length,null,ye.formatContext,ye.lastPushedText,!0);ye.children.push(Pe),ye.lastPushedText=!1,w=Mt(w,I.node,I.blockedBoundary,Pe,I.abortSet,I.legacyContext,I.context,I.treeContext).ping,F.then(w,w),I.blockedSegment.formatContext=B,I.legacyContext=le,I.context=ee,hn(ee)}else throw I.blockedSegment.formatContext=B,I.legacyContext=le,I.context=ee,hn(ee),Ve}}function ue(w){var I=w.blockedBoundary;w=w.blockedSegment,w.status=3,ge(this,I,w)}function te(w,I,F){var B=w.blockedBoundary;w.blockedSegment.status=3,B===null?(I.allPendingTasks--,I.status!==2&&(I.status=2,I.destination!==null&&I.destination.push(null))):(B.pendingTasks--,B.forceClientRender||(B.forceClientRender=!0,w=F===void 0?Error(t(432)):F,B.errorDigest=I.onError(w),B.parentFlushed&&I.clientRenderedBoundaries.push(B)),B.fallbackAbortableTasks.forEach(function(le){return te(le,I,F)}),B.fallbackAbortableTasks.clear(),I.allPendingTasks--,I.allPendingTasks===0&&(B=I.onAllReady,B()))}function se(w,I){if(I.chunks.length===0&&I.children.length===1&&I.children[0].boundary===null){var F=I.children[0];F.id=I.id,F.parentFlushed=!0,F.status===1&&se(w,F)}else w.completedSegments.push(I)}function ge(w,I,F){if(I===null){if(F.parentFlushed){if(w.completedRootSegment!==null)throw Error(t(389));w.completedRootSegment=F}w.pendingRootTasks--,w.pendingRootTasks===0&&(w.onShellError=ct,I=w.onShellReady,I())}else I.pendingTasks--,I.forceClientRender||(I.pendingTasks===0?(F.parentFlushed&&F.status===1&&se(I,F),I.parentFlushed&&w.completedBoundaries.push(I),I.fallbackAbortableTasks.forEach(ue,w),I.fallbackAbortableTasks.clear()):F.parentFlushed&&F.status===1&&(se(I,F),I.completedSegments.length===1&&I.parentFlushed&&w.partialBoundaries.push(I)));w.allPendingTasks--,w.allPendingTasks===0&&(w=w.onAllReady,w())}function Ee(w){if(w.status!==2){var I=Tt,F=at.current;at.current=Me;var B=Qe;Qe=w.responseState;try{var le=w.pingedTasks,ee;for(ee=0;ee<le.length;ee++){var ye=le[ee],Pe=w,Ve=ye.blockedSegment;if(Ve.status===0){hn(ye.context);try{G(Pe,ye,ye.node),Pe.responseState.generateStaticMarkup||Ve.lastPushedText&&Ve.textEmbedded&&Ve.chunks.push("<!-- -->"),ye.abortSet.delete(ye),Ve.status=1,ge(Pe,ye.blockedBoundary,Ve)}catch(Xt){if(jn(),typeof Xt=="object"&&Xt!==null&&typeof Xt.then=="function"){var rt=ye.ping;Xt.then(rt,rt)}else{ye.abortSet.delete(ye),Ve.status=4;var it=ye.blockedBoundary,St=Xt,Jt=At(Pe,St);if(it===null?Ft(Pe,St):(it.pendingTasks--,it.forceClientRender||(it.forceClientRender=!0,it.errorDigest=Jt,it.parentFlushed&&Pe.clientRenderedBoundaries.push(it))),Pe.allPendingTasks--,Pe.allPendingTasks===0){var Kt=Pe.onAllReady;Kt()}}}finally{}}}le.splice(0,ee),w.destination!==null&&Be(w,w.destination)}catch(Xt){At(w,Xt),Ft(w,Xt)}finally{Qe=B,at.current=F,F===Me&&hn(I)}}}function xe(w,I,F){switch(F.parentFlushed=!0,F.status){case 0:var B=F.id=w.nextSegmentId++;return F.lastPushedText=!1,F.textEmbedded=!1,w=w.responseState,I.push('<template id="'),I.push(w.placeholderPrefix),w=B.toString(16),I.push(w),I.push('"></template>');case 1:F.status=2;var le=!0;B=F.chunks;var ee=0;F=F.children;for(var ye=0;ye<F.length;ye++){for(le=F[ye];ee<le.index;ee++)I.push(B[ee]);le=Se(w,I,le)}for(;ee<B.length-1;ee++)I.push(B[ee]);return ee<B.length&&(le=I.push(B[ee])),le;default:throw Error(t(390))}}function Se(w,I,F){var B=F.boundary;if(B===null)return xe(w,I,F);if(B.parentFlushed=!0,B.forceClientRender)return w.responseState.generateStaticMarkup||(B=B.errorDigest,I.push("<!--$!-->"),I.push("<template"),B&&(I.push(' data-dgst="'),B=_(B),I.push(B),I.push('"')),I.push("></template>")),xe(w,I,F),w=w.responseState.generateStaticMarkup?!0:I.push("<!--/$-->"),w;if(0<B.pendingTasks){B.rootSegmentID=w.nextSegmentId++,0<B.completedSegments.length&&w.partialBoundaries.push(B);var le=w.responseState,ee=le.nextSuspenseID++;return le=le.boundaryPrefix+ee.toString(16),B=B.id=le,re(I,w.responseState,B),xe(w,I,F),I.push("<!--/$-->")}if(B.byteSize>w.progressiveChunkSize)return B.rootSegmentID=w.nextSegmentId++,w.completedBoundaries.push(B),re(I,w.responseState,B.id),xe(w,I,F),I.push("<!--/$-->");if(w.responseState.generateStaticMarkup||I.push("<!--$-->"),F=B.completedSegments,F.length!==1)throw Error(t(391));return Se(w,I,F[0]),w=w.responseState.generateStaticMarkup?!0:I.push("<!--/$-->"),w}function Ne(w,I,F){return Q(I,w.responseState,F.formatContext,F.id),Se(w,I,F),he(I,F.formatContext)}function De(w,I,F){for(var B=F.completedSegments,le=0;le<B.length;le++)ve(w,I,F,B[le]);if(B.length=0,w=w.responseState,B=F.id,F=F.rootSegmentID,I.push(w.startInlineScript),w.sentCompleteBoundaryFunction?I.push('$RC("'):(w.sentCompleteBoundaryFunction=!0,I.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),B===null)throw Error(t(395));return F=F.toString(16),I.push(B),I.push('","'),I.push(w.segmentPrefix),I.push(F),I.push('")<\/script>')}function ve(w,I,F,B){if(B.status===2)return!0;var le=B.id;if(le===-1){if((B.id=F.rootSegmentID)===-1)throw Error(t(392));return Ne(w,I,B)}return Ne(w,I,B),w=w.responseState,I.push(w.startInlineScript),w.sentCompleteSegmentFunction?I.push('$RS("'):(w.sentCompleteSegmentFunction=!0,I.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),I.push(w.segmentPrefix),le=le.toString(16),I.push(le),I.push('","'),I.push(w.placeholderPrefix),I.push(le),I.push('")<\/script>')}function Be(w,I){try{var F=w.completedRootSegment;if(F!==null&&w.pendingRootTasks===0){Se(w,I,F),w.completedRootSegment=null;var B=w.responseState.bootstrapChunks;for(F=0;F<B.length-1;F++)I.push(B[F]);F<B.length&&I.push(B[F])}var le=w.clientRenderedBoundaries,ee;for(ee=0;ee<le.length;ee++){var ye=le[ee];B=I;var Pe=w.responseState,Ve=ye.id,rt=ye.errorDigest,it=ye.errorMessage,St=ye.errorComponentStack;if(B.push(Pe.startInlineScript),Pe.sentClientRenderFunction?B.push('$RX("'):(Pe.sentClientRenderFunction=!0,B.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),Ve===null)throw Error(t(395));if(B.push(Ve),B.push('"'),rt||it||St){B.push(",");var Jt=ae(rt||"");B.push(Jt)}if(it||St){B.push(",");var Kt=ae(it||"");B.push(Kt)}if(St){B.push(",");var Xt=ae(St);B.push(Xt)}if(!B.push(")<\/script>")){w.destination=null,ee++,le.splice(0,ee);return}}le.splice(0,ee);var an=w.completedBoundaries;for(ee=0;ee<an.length;ee++)if(!De(w,I,an[ee])){w.destination=null,ee++,an.splice(0,ee);return}an.splice(0,ee);var Qt=w.partialBoundaries;for(ee=0;ee<Qt.length;ee++){var gn=Qt[ee];e:{le=w,ye=I;var Yt=gn.completedSegments;for(Pe=0;Pe<Yt.length;Pe++)if(!ve(le,ye,gn,Yt[Pe])){Pe++,Yt.splice(0,Pe);var as=!1;break e}Yt.splice(0,Pe),as=!0}if(!as){w.destination=null,ee++,Qt.splice(0,ee);return}}Qt.splice(0,ee);var gs=w.completedBoundaries;for(ee=0;ee<gs.length;ee++)if(!De(w,I,gs[ee])){w.destination=null,ee++,gs.splice(0,ee);return}gs.splice(0,ee)}finally{w.allPendingTasks===0&&w.pingedTasks.length===0&&w.clientRenderedBoundaries.length===0&&w.completedBoundaries.length===0&&I.push(null)}}function $e(w,I){try{var F=w.abortableTasks;F.forEach(function(B){return te(B,w,I)}),F.clear(),w.destination!==null&&Be(w,w.destination)}catch(B){At(w,B),Ft(w,B)}}function je(){}function Ye(w,I,F,B){var le=!1,ee=null,ye="",Pe={push:function(rt){return rt!==null&&(ye+=rt),!0},destroy:function(rt){le=!0,ee=rt}},Ve=!1;if(w=yt(w,me(F,I?I.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,je,void 0,function(){Ve=!0}),Ee(w),$e(w,B),w.status===1)w.status=2,Pe.destroy(w.fatalError);else if(w.status!==2&&w.destination===null){w.destination=Pe;try{Be(w,Pe)}catch(rt){At(w,rt),Ft(w,rt)}}if(le)throw ee;if(!Ve)throw Error(t(426));return ye}return ra.renderToNodeStream=function(){throw Error(t(207))},ra.renderToStaticMarkup=function(w,I){return Ye(w,I,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},ra.renderToStaticNodeStream=function(){throw Error(t(208))},ra.renderToString=function(w,I){return Ye(w,I,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},ra.version="18.3.1",ra}var Uc={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IA;function F6(){if(IA)return Uc;IA=1;var e=Nd();function t(L){for(var P="https://reactjs.org/docs/error-decoder.html?invariant="+L,V=1;V<arguments.length;V++)P+="&args[]="+encodeURIComponent(arguments[V]);return"Minified React error #"+L+"; visit "+P+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=null,s=0;function r(L,P){if(P.length!==0)if(512<P.length)0<s&&(L.enqueue(new Uint8Array(n.buffer,0,s)),n=new Uint8Array(512),s=0),L.enqueue(P);else{var V=n.length-s;V<P.length&&(V===0?L.enqueue(n):(n.set(P.subarray(0,V),s),L.enqueue(n),P=P.subarray(V)),n=new Uint8Array(512),s=0),n.set(P,s),s+=P.length}}function i(L,P){return r(L,P),!0}function o(L){n&&0<s&&(L.enqueue(new Uint8Array(n.buffer,0,s)),n=null,s=0)}var a=new TextEncoder;function u(L){return a.encode(L)}function d(L){return a.encode(L)}function c(L,P){typeof L.error=="function"?L.error(P):L.close()}var g=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},_={};function y(L){return g.call(_,L)?!0:g.call(p,L)?!1:f.test(L)?_[L]=!0:(p[L]=!0,!1)}function x(L,P,V,W,Le,Te,He){this.acceptsBooleans=P===2||P===3||P===4,this.attributeName=W,this.attributeNamespace=Le,this.mustUseProperty=V,this.propertyName=L,this.type=P,this.sanitizeURL=Te,this.removeEmptyString=He}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(L){E[L]=new x(L,0,!1,L,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(L){var P=L[0];E[P]=new x(P,1,!1,L[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(L){E[L]=new x(L,2,!1,L.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(L){E[L]=new x(L,2,!1,L,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(L){E[L]=new x(L,3,!1,L.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(L){E[L]=new x(L,3,!0,L,null,!1,!1)}),["capture","download"].forEach(function(L){E[L]=new x(L,4,!1,L,null,!1,!1)}),["cols","rows","size","span"].forEach(function(L){E[L]=new x(L,6,!1,L,null,!1,!1)}),["rowSpan","start"].forEach(function(L){E[L]=new x(L,5,!1,L.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function S(L){return L[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(L){var P=L.replace(b,S);E[P]=new x(P,1,!1,L,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(L){var P=L.replace(b,S);E[P]=new x(P,1,!1,L,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(L){var P=L.replace(b,S);E[P]=new x(P,1,!1,L,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(L){E[L]=new x(L,1,!1,L.toLowerCase(),null,!1,!1)}),E.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(L){E[L]=new x(L,1,!1,L.toLowerCase(),null,!0,!0)});var A={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},C=["Webkit","ms","Moz","O"];Object.keys(A).forEach(function(L){C.forEach(function(P){P=P+L.charAt(0).toUpperCase()+L.substring(1),A[P]=A[L]})});var k=/["'&<>]/;function M(L){if(typeof L=="boolean"||typeof L=="number")return""+L;L=""+L;var P=k.exec(L);if(P){var V="",W,Le=0;for(W=P.index;W<L.length;W++){switch(L.charCodeAt(W)){case 34:P="&quot;";break;case 38:P="&amp;";break;case 39:P="&#x27;";break;case 60:P="&lt;";break;case 62:P="&gt;";break;default:continue}Le!==W&&(V+=L.substring(Le,W)),Le=W+1,V+=P}L=Le!==W?V+L.substring(Le,W):V}return L}var R=/([A-Z])/g,O=/^ms-/,j=Array.isArray,z=d("<script>"),X=d("<\/script>"),oe=d('<script src="'),re=d('<script type="module" src="'),Q=d('" async=""><\/script>'),he=/(<\/|<)(s)(cript)/gi;function fe(L,P,V,W){return""+P+(V==="s"?"\\u0073":"\\u0053")+W}function ae(L,P,V,W,Le){L=L===void 0?"":L,P=P===void 0?z:d('<script nonce="'+M(P)+'">');var Te=[];if(V!==void 0&&Te.push(P,u((""+V).replace(he,fe)),X),W!==void 0)for(V=0;V<W.length;V++)Te.push(oe,u(M(W[V])),Q);if(Le!==void 0)for(W=0;W<Le.length;W++)Te.push(re,u(M(Le[W])),Q);return{bootstrapChunks:Te,startInlineScript:P,placeholderPrefix:d(L+"P:"),segmentPrefix:d(L+"S:"),boundaryPrefix:L+"B:",idPrefix:L,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function me(L,P){return{insertionMode:L,selectedValue:P}}function we(L){return me(L==="http://www.w3.org/2000/svg"?2:L==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function Z(L,P,V){switch(P){case"select":return me(1,V.value!=null?V.value:V.defaultValue);case"svg":return me(2,null);case"math":return me(3,null);case"foreignObject":return me(1,null);case"table":return me(4,null);case"thead":case"tbody":case"tfoot":return me(5,null);case"colgroup":return me(7,null);case"tr":return me(6,null)}return 4<=L.insertionMode||L.insertionMode===0?me(1,null):L}var _e=d("<!-- -->");function ze(L,P,V,W){return P===""?W:(W&&L.push(_e),L.push(u(M(P))),!0)}var Re=new Map,We=d(' style="'),st=d(":"),ft=d(";");function ut(L,P,V){if(typeof V!="object")throw Error(t(62));P=!0;for(var W in V)if(g.call(V,W)){var Le=V[W];if(Le!=null&&typeof Le!="boolean"&&Le!==""){if(W.indexOf("--")===0){var Te=u(M(W));Le=u(M((""+Le).trim()))}else{Te=W;var He=Re.get(Te);He!==void 0||(He=d(M(Te.replace(R,"-$1").toLowerCase().replace(O,"-ms-"))),Re.set(Te,He)),Te=He,Le=typeof Le=="number"?Le===0||g.call(A,W)?u(""+Le):u(Le+"px"):u(M((""+Le).trim()))}P?(P=!1,L.push(We,Te,st,Le)):L.push(ft,Te,st,Le)}}P||L.push(qe)}var ce=d(" "),be=d('="'),qe=d('"'),Ue=d('=""');function Ie(L,P,V,W){switch(V){case"style":ut(L,P,W);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<V.length)||V[0]!=="o"&&V[0]!=="O"||V[1]!=="n"&&V[1]!=="N"){if(P=E.hasOwnProperty(V)?E[V]:null,P!==null){switch(typeof W){case"function":case"symbol":return;case"boolean":if(!P.acceptsBooleans)return}switch(V=u(P.attributeName),P.type){case 3:W&&L.push(ce,V,Ue);break;case 4:W===!0?L.push(ce,V,Ue):W!==!1&&L.push(ce,V,be,u(M(W)),qe);break;case 5:isNaN(W)||L.push(ce,V,be,u(M(W)),qe);break;case 6:!isNaN(W)&&1<=W&&L.push(ce,V,be,u(M(W)),qe);break;default:P.sanitizeURL&&(W=""+W),L.push(ce,V,be,u(M(W)),qe)}}else if(y(V)){switch(typeof W){case"function":case"symbol":return;case"boolean":if(P=V.toLowerCase().slice(0,5),P!=="data-"&&P!=="aria-")return}L.push(ce,u(V),be,u(M(W)),qe)}}}var Fe=d(">"),Oe=d("/>");function Xe(L,P,V){if(P!=null){if(V!=null)throw Error(t(60));if(typeof P!="object"||!("__html"in P))throw Error(t(61));P=P.__html,P!=null&&L.push(u(""+P))}}function dt(L){var P="";return e.Children.forEach(L,function(V){V!=null&&(P+=V)}),P}var mt=d(' selected=""');function ht(L,P,V,W){L.push(ot(V));var Le=V=null,Te;for(Te in P)if(g.call(P,Te)){var He=P[Te];if(He!=null)switch(Te){case"children":V=He;break;case"dangerouslySetInnerHTML":Le=He;break;default:Ie(L,W,Te,He)}}return L.push(Fe),Xe(L,Le,V),typeof V=="string"?(L.push(u(M(V))),null):V}var wt=d(`
`),Lt=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Tt=new Map;function ot(L){var P=Tt.get(L);if(P===void 0){if(!Lt.test(L))throw Error(t(65,L));P=d("<"+L),Tt.set(L,P)}return P}var jt=d("<!DOCTYPE html>");function Nt(L,P,V,W,Le){switch(P){case"select":L.push(ot("select"));var Te=null,He=null;for(Dt in V)if(g.call(V,Dt)){var et=V[Dt];if(et!=null)switch(Dt){case"children":Te=et;break;case"dangerouslySetInnerHTML":He=et;break;case"defaultValue":case"value":break;default:Ie(L,W,Dt,et)}}return L.push(Fe),Xe(L,He,Te),Te;case"option":He=Le.selectedValue,L.push(ot("option"));var Rt=et=null,Ut=null,Dt=null;for(Te in V)if(g.call(V,Te)){var _n=V[Te];if(_n!=null)switch(Te){case"children":et=_n;break;case"selected":Ut=_n;break;case"dangerouslySetInnerHTML":Dt=_n;break;case"value":Rt=_n;default:Ie(L,W,Te,_n)}}if(He!=null)if(V=Rt!==null?""+Rt:dt(et),j(He)){for(W=0;W<He.length;W++)if(""+He[W]===V){L.push(mt);break}}else""+He===V&&L.push(mt);else Ut&&L.push(mt);return L.push(Fe),Xe(L,Dt,et),et;case"textarea":L.push(ot("textarea")),Dt=He=Te=null;for(et in V)if(g.call(V,et)&&(Rt=V[et],Rt!=null))switch(et){case"children":Dt=Rt;break;case"value":Te=Rt;break;case"defaultValue":He=Rt;break;case"dangerouslySetInnerHTML":throw Error(t(91));default:Ie(L,W,et,Rt)}if(Te===null&&He!==null&&(Te=He),L.push(Fe),Dt!=null){if(Te!=null)throw Error(t(92));if(j(Dt)&&1<Dt.length)throw Error(t(93));Te=""+Dt}return typeof Te=="string"&&Te[0]===`
`&&L.push(wt),Te!==null&&L.push(u(M(""+Te))),null;case"input":L.push(ot("input")),Rt=Dt=et=Te=null;for(He in V)if(g.call(V,He)&&(Ut=V[He],Ut!=null))switch(He){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,"input"));case"defaultChecked":Rt=Ut;break;case"defaultValue":et=Ut;break;case"checked":Dt=Ut;break;case"value":Te=Ut;break;default:Ie(L,W,He,Ut)}return Dt!==null?Ie(L,W,"checked",Dt):Rt!==null&&Ie(L,W,"checked",Rt),Te!==null?Ie(L,W,"value",Te):et!==null&&Ie(L,W,"value",et),L.push(Oe),null;case"menuitem":L.push(ot("menuitem"));for(var ws in V)if(g.call(V,ws)&&(Te=V[ws],Te!=null))switch(ws){case"children":case"dangerouslySetInnerHTML":throw Error(t(400));default:Ie(L,W,ws,Te)}return L.push(Fe),null;case"title":L.push(ot("title")),Te=null;for(_n in V)if(g.call(V,_n)&&(He=V[_n],He!=null))switch(_n){case"children":Te=He;break;case"dangerouslySetInnerHTML":throw Error(t(434));default:Ie(L,W,_n,He)}return L.push(Fe),Te;case"listing":case"pre":L.push(ot(P)),He=Te=null;for(Rt in V)if(g.call(V,Rt)&&(et=V[Rt],et!=null))switch(Rt){case"children":Te=et;break;case"dangerouslySetInnerHTML":He=et;break;default:Ie(L,W,Rt,et)}if(L.push(Fe),He!=null){if(Te!=null)throw Error(t(60));if(typeof He!="object"||!("__html"in He))throw Error(t(61));V=He.__html,V!=null&&(typeof V=="string"&&0<V.length&&V[0]===`
`?L.push(wt,u(V)):L.push(u(""+V)))}return typeof Te=="string"&&Te[0]===`
`&&L.push(wt),Te;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":L.push(ot(P));for(var Ys in V)if(g.call(V,Ys)&&(Te=V[Ys],Te!=null))switch(Ys){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,P));default:Ie(L,W,Ys,Te)}return L.push(Oe),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return ht(L,V,P,W);case"html":return Le.insertionMode===0&&L.push(jt),ht(L,V,P,W);default:if(P.indexOf("-")===-1&&typeof V.is!="string")return ht(L,V,P,W);L.push(ot(P)),He=Te=null;for(Ut in V)if(g.call(V,Ut)&&(et=V[Ut],et!=null))switch(Ut){case"children":Te=et;break;case"dangerouslySetInnerHTML":He=et;break;case"style":ut(L,W,et);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:y(Ut)&&typeof et!="function"&&typeof et!="symbol"&&L.push(ce,u(Ut),be,u(M(et)),qe)}return L.push(Fe),Xe(L,He,Te),Te}}var Gt=d("</"),Wt=d(">"),hn=d('<template id="'),Sn=d('"></template>'),Jn=d("<!--$-->"),Wn=d('<!--$?--><template id="'),Un=d('"></template>'),Xn=d("<!--$!-->"),Gn=d("<!--/$-->"),is=d("<template"),Vn=d('"'),An=d(' data-dgst="');d(' data-msg="'),d(' data-stck="');var Yn=d("></template>");function xn(L,P,V){if(r(L,Wn),V===null)throw Error(t(395));return r(L,V),i(L,Un)}var fn=d('<div hidden id="'),Ht=d('">'),vt=d("</div>"),Pn=d('<svg aria-hidden="true" style="display:none" id="'),Zn=d('">'),qt=d("</svg>"),cn=d('<math aria-hidden="true" style="display:none" id="'),on=d('">'),vn=d("</math>"),wn=d('<table hidden id="'),Rn=d('">'),jn=d("</table>"),Bt=d('<table hidden><tbody id="'),os=d('">'),q=d("</tbody></table>"),Y=d('<table hidden><tr id="'),ne=d('">'),K=d("</tr></table>"),Me=d('<table hidden><colgroup id="'),Qe=d('">'),at=d("</colgroup></table>");function tt(L,P,V,W){switch(V.insertionMode){case 0:case 1:return r(L,fn),r(L,P.segmentPrefix),r(L,u(W.toString(16))),i(L,Ht);case 2:return r(L,Pn),r(L,P.segmentPrefix),r(L,u(W.toString(16))),i(L,Zn);case 3:return r(L,cn),r(L,P.segmentPrefix),r(L,u(W.toString(16))),i(L,on);case 4:return r(L,wn),r(L,P.segmentPrefix),r(L,u(W.toString(16))),i(L,Rn);case 5:return r(L,Bt),r(L,P.segmentPrefix),r(L,u(W.toString(16))),i(L,os);case 6:return r(L,Y),r(L,P.segmentPrefix),r(L,u(W.toString(16))),i(L,ne);case 7:return r(L,Me),r(L,P.segmentPrefix),r(L,u(W.toString(16))),i(L,Qe);default:throw Error(t(397))}}function ct(L,P){switch(P.insertionMode){case 0:case 1:return i(L,vt);case 2:return i(L,qt);case 3:return i(L,vn);case 4:return i(L,jn);case 5:return i(L,q);case 6:return i(L,K);case 7:return i(L,at);default:throw Error(t(397))}}var yt=d('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),Mt=d('$RS("'),Pt=d('","'),At=d('")<\/script>'),Ft=d('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),Zt=d('$RC("'),nn=d('","'),H=d('")<\/script>'),U=d('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),G=d('$RX("'),$=d('"'),ie=d(")<\/script>"),ue=d(","),te=/[<\u2028\u2029]/g;function se(L){return JSON.stringify(L).replace(te,function(P){switch(P){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var ge=Object.assign,Ee=Symbol.for("react.element"),xe=Symbol.for("react.portal"),Se=Symbol.for("react.fragment"),Ne=Symbol.for("react.strict_mode"),De=Symbol.for("react.profiler"),ve=Symbol.for("react.provider"),Be=Symbol.for("react.context"),$e=Symbol.for("react.forward_ref"),je=Symbol.for("react.suspense"),Ye=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),F=Symbol.for("react.scope"),B=Symbol.for("react.debug_trace_mode"),le=Symbol.for("react.legacy_hidden"),ee=Symbol.for("react.default_value"),ye=Symbol.iterator;function Pe(L){if(L==null)return null;if(typeof L=="function")return L.displayName||L.name||null;if(typeof L=="string")return L;switch(L){case Se:return"Fragment";case xe:return"Portal";case De:return"Profiler";case Ne:return"StrictMode";case je:return"Suspense";case Ye:return"SuspenseList"}if(typeof L=="object")switch(L.$$typeof){case Be:return(L.displayName||"Context")+".Consumer";case ve:return(L._context.displayName||"Context")+".Provider";case $e:var P=L.render;return L=L.displayName,L||(L=P.displayName||P.name||"",L=L!==""?"ForwardRef("+L+")":"ForwardRef"),L;case w:return P=L.displayName||null,P!==null?P:Pe(L.type)||"Memo";case I:P=L._payload,L=L._init;try{return Pe(L(P))}catch{}}return null}var Ve={};function rt(L,P){if(L=L.contextTypes,!L)return Ve;var V={},W;for(W in L)V[W]=P[W];return V}var it=null;function St(L,P){if(L!==P){L.context._currentValue=L.parentValue,L=L.parent;var V=P.parent;if(L===null){if(V!==null)throw Error(t(401))}else{if(V===null)throw Error(t(401));St(L,V)}P.context._currentValue=P.value}}function Jt(L){L.context._currentValue=L.parentValue,L=L.parent,L!==null&&Jt(L)}function Kt(L){var P=L.parent;P!==null&&Kt(P),L.context._currentValue=L.value}function Xt(L,P){if(L.context._currentValue=L.parentValue,L=L.parent,L===null)throw Error(t(402));L.depth===P.depth?St(L,P):Xt(L,P)}function an(L,P){var V=P.parent;if(V===null)throw Error(t(402));L.depth===V.depth?St(L,V):an(L,V),P.context._currentValue=P.value}function Qt(L){var P=it;P!==L&&(P===null?Kt(L):L===null?Jt(P):P.depth===L.depth?St(P,L):P.depth>L.depth?Xt(P,L):an(P,L),it=L)}var gn={isMounted:function(){return!1},enqueueSetState:function(L,P){L=L._reactInternals,L.queue!==null&&L.queue.push(P)},enqueueReplaceState:function(L,P){L=L._reactInternals,L.replace=!0,L.queue=[P]},enqueueForceUpdate:function(){}};function Yt(L,P,V,W){var Le=L.state!==void 0?L.state:null;L.updater=gn,L.props=V,L.state=Le;var Te={queue:[],replace:!1};L._reactInternals=Te;var He=P.contextType;if(L.context=typeof He=="object"&&He!==null?He._currentValue:W,He=P.getDerivedStateFromProps,typeof He=="function"&&(He=He(V,Le),Le=He==null?Le:ge({},Le,He),L.state=Le),typeof P.getDerivedStateFromProps!="function"&&typeof L.getSnapshotBeforeUpdate!="function"&&(typeof L.UNSAFE_componentWillMount=="function"||typeof L.componentWillMount=="function"))if(P=L.state,typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount(),P!==L.state&&gn.enqueueReplaceState(L,L.state,null),Te.queue!==null&&0<Te.queue.length)if(P=Te.queue,He=Te.replace,Te.queue=null,Te.replace=!1,He&&P.length===1)L.state=P[0];else{for(Te=He?P[0]:L.state,Le=!0,He=He?1:0;He<P.length;He++){var et=P[He];et=typeof et=="function"?et.call(L,Te,V,W):et,et!=null&&(Le?(Le=!1,Te=ge({},Te,et)):ge(Te,et))}L.state=Te}else Te.queue=null}var as={id:1,overflow:""};function gs(L,P,V){var W=L.id;L=L.overflow;var Le=32-pn(W)-1;W&=~(1<<Le),V+=1;var Te=32-pn(P)+Le;if(30<Te){var He=Le-Le%5;return Te=(W&(1<<He)-1).toString(32),W>>=He,Le-=He,{id:1<<32-pn(P)+Le|V<<Le|W,overflow:Te+L}}return{id:1<<Te|V<<Le|W,overflow:L}}var pn=Math.clz32?Math.clz32:Ss,es=Math.log,mr=Math.LN2;function Ss(L){return L>>>=0,L===0?32:31-(es(L)/mr|0)|0}function mn(L,P){return L===P&&(L!==0||1/L===1/P)||L!==L&&P!==P}var Fn=typeof Object.is=="function"?Object.is:mn,Hn=null,As=null,_r=null,ln=null,Xs=!1,ar=!1,yr=0,lr=null,Ia=0;function mi(){if(Hn===null)throw Error(t(321));return Hn}function ka(){if(0<Ia)throw Error(t(312));return{memoizedState:null,queue:null,next:null}}function eo(){return ln===null?_r===null?(Xs=!1,_r=ln=ka()):(Xs=!0,ln=_r):ln.next===null?(Xs=!1,ln=ln.next=ka()):(Xs=!0,ln=ln.next),ln}function Bo(){As=Hn=null,ar=!1,_r=null,Ia=0,ln=lr=null}function ql(L,P){return typeof P=="function"?P(L):P}function Rr(L,P,V){if(Hn=mi(),ln=eo(),Xs){var W=ln.queue;if(P=W.dispatch,lr!==null&&(V=lr.get(W),V!==void 0)){lr.delete(W),W=ln.memoizedState;do W=L(W,V.action),V=V.next;while(V!==null);return ln.memoizedState=W,[W,P]}return[ln.memoizedState,P]}return L=L===ql?typeof P=="function"?P():P:V!==void 0?V(P):P,ln.memoizedState=L,L=ln.queue={last:null,dispatch:null},L=L.dispatch=Pa.bind(null,Hn,L),[ln.memoizedState,L]}function Ma(L,P){if(Hn=mi(),ln=eo(),P=P===void 0?null:P,ln!==null){var V=ln.memoizedState;if(V!==null&&P!==null){var W=V[1];e:if(W===null)W=!1;else{for(var Le=0;Le<W.length&&Le<P.length;Le++)if(!Fn(P[Le],W[Le])){W=!1;break e}W=!0}if(W)return V[0]}}return L=L(),ln.memoizedState=[L,P],L}function Pa(L,P,V){if(25<=Ia)throw Error(t(301));if(L===Hn)if(ar=!0,L={action:V,next:null},lr===null&&(lr=new Map),V=lr.get(P),V===void 0)lr.set(P,L);else{for(P=V;P.next!==null;)P=P.next;P.next=L}}function qd(){throw Error(t(394))}function _i(){}var Uo={readContext:function(L){return L._currentValue},useContext:function(L){return mi(),L._currentValue},useMemo:Ma,useReducer:Rr,useRef:function(L){Hn=mi(),ln=eo();var P=ln.memoizedState;return P===null?(L={current:L},ln.memoizedState=L):P},useState:function(L){return Rr(ql,L)},useInsertionEffect:_i,useLayoutEffect:function(){},useCallback:function(L,P){return Ma(function(){return L},P)},useImperativeHandle:_i,useEffect:_i,useDebugValue:_i,useDeferredValue:function(L){return mi(),L},useTransition:function(){return mi(),[!1,qd]},useId:function(){var L=As.treeContext,P=L.overflow;L=L.id,L=(L&~(1<<32-pn(L)-1)).toString(32)+P;var V=Go;if(V===null)throw Error(t(404));return P=yr++,L=":"+V.idPrefix+"R"+L,0<P&&(L+="H"+P.toString(32)),L+":"},useMutableSource:function(L,P){return mi(),P(L._source)},useSyncExternalStore:function(L,P,V){if(V===void 0)throw Error(t(407));return V()}},Go=null,_s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function to(L){return console.error(L),null}function yi(){}function Vo(L,P,V,W,Le,Te,He,et,Rt){var Ut=[],Dt=new Set;return P={destination:null,responseState:P,progressiveChunkSize:W===void 0?12800:W,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:Dt,pingedTasks:Ut,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Le===void 0?to:Le,onAllReady:Te===void 0?yi:Te,onShellReady:He===void 0?yi:He,onShellError:et===void 0?yi:et,onFatalError:Rt===void 0?yi:Rt},V=no(P,0,null,V,!1,!1),V.parentFlushed=!0,L=$l(P,L,null,V,Dt,Ve,null,as),Ut.push(L),P}function $l(L,P,V,W,Le,Te,He,et){L.allPendingTasks++,V===null?L.pendingRootTasks++:V.pendingTasks++;var Rt={node:P,ping:function(){var Ut=L.pingedTasks;Ut.push(Rt),Ut.length===1&&Zl(L)},blockedBoundary:V,blockedSegment:W,abortSet:Le,legacyContext:Te,context:He,treeContext:et};return Le.add(Rt),Rt}function no(L,P,V,W,Le,Te){return{status:0,id:-1,index:P,parentFlushed:!1,chunks:[],children:[],formatContext:W,boundary:V,lastPushedText:Le,textEmbedded:Te}}function xi(L,P){if(L=L.onError(P),L!=null&&typeof L!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof L+'" instead');return L}function Jr(L,P){var V=L.onShellError;V(P),V=L.onFatalError,V(P),L.destination!==null?(L.status=2,c(L.destination,P)):(L.status=1,L.fatalError=P)}function jo(L,P,V,W,Le){for(Hn={},As=P,yr=0,L=V(W,Le);ar;)ar=!1,yr=0,Ia+=1,ln=null,L=V(W,Le);return Bo(),L}function Wl(L,P,V,W){var Le=V.render(),Te=W.childContextTypes;if(Te!=null){var He=P.legacyContext;if(typeof V.getChildContext!="function")W=He;else{V=V.getChildContext();for(var et in V)if(!(et in Te))throw Error(t(108,Pe(W)||"Unknown",et));W=ge({},He,V)}P.legacyContext=W,Bs(L,P,Le),P.legacyContext=He}else Bs(L,P,Le)}function $d(L,P){if(L&&L.defaultProps){P=ge({},P),L=L.defaultProps;for(var V in L)P[V]===void 0&&(P[V]=L[V]);return P}return P}function Xl(L,P,V,W,Le){if(typeof V=="function")if(V.prototype&&V.prototype.isReactComponent){Le=rt(V,P.legacyContext);var Te=V.contextType;Te=new V(W,typeof Te=="object"&&Te!==null?Te._currentValue:Le),Yt(Te,V,W,Le),Wl(L,P,Te,V)}else{Te=rt(V,P.legacyContext),Le=jo(L,P,V,W,Te);var He=yr!==0;if(typeof Le=="object"&&Le!==null&&typeof Le.render=="function"&&Le.$$typeof===void 0)Yt(Le,V,W,Te),Wl(L,P,Le,V);else if(He){W=P.treeContext,P.treeContext=gs(W,1,0);try{Bs(L,P,Le)}finally{P.treeContext=W}}else Bs(L,P,Le)}else if(typeof V=="string"){switch(Le=P.blockedSegment,Te=Nt(Le.chunks,V,W,L.responseState,Le.formatContext),Le.lastPushedText=!1,He=Le.formatContext,Le.formatContext=Z(He,V,W),Yl(L,P,Te),Le.formatContext=He,V){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Le.chunks.push(Gt,u(V),Wt)}Le.lastPushedText=!1}else{switch(V){case le:case B:case Ne:case De:case Se:Bs(L,P,W.children);return;case Ye:Bs(L,P,W.children);return;case F:throw Error(t(343));case je:e:{V=P.blockedBoundary,Le=P.blockedSegment,Te=W.fallback,W=W.children,He=new Set;var et={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:He,errorDigest:null},Rt=no(L,Le.chunks.length,et,Le.formatContext,!1,!1);Le.children.push(Rt),Le.lastPushedText=!1;var Ut=no(L,0,null,Le.formatContext,!1,!1);Ut.parentFlushed=!0,P.blockedBoundary=et,P.blockedSegment=Ut;try{if(Yl(L,P,W),Ut.lastPushedText&&Ut.textEmbedded&&Ut.chunks.push(_e),Ut.status=1,Fa(et,Ut),et.pendingTasks===0)break e}catch(Dt){Ut.status=4,et.forceClientRender=!0,et.errorDigest=xi(L,Dt)}finally{P.blockedBoundary=V,P.blockedSegment=Le}P=$l(L,Te,V,Rt,He,P.legacyContext,P.context,P.treeContext),L.pingedTasks.push(P)}return}if(typeof V=="object"&&V!==null)switch(V.$$typeof){case $e:if(W=jo(L,P,V.render,W,Le),yr!==0){V=P.treeContext,P.treeContext=gs(V,1,0);try{Bs(L,P,W)}finally{P.treeContext=V}}else Bs(L,P,W);return;case w:V=V.type,W=$d(V,W),Xl(L,P,V,W,Le);return;case ve:if(Le=W.children,V=V._context,W=W.value,Te=V._currentValue,V._currentValue=W,He=it,it=W={parent:He,depth:He===null?0:He.depth+1,context:V,parentValue:Te,value:W},P.context=W,Bs(L,P,Le),L=it,L===null)throw Error(t(403));W=L.parentValue,L.context._currentValue=W===ee?L.context._defaultValue:W,L=it=L.parent,P.context=L;return;case Be:W=W.children,W=W(V._currentValue),Bs(L,P,W);return;case I:Le=V._init,V=Le(V._payload),W=$d(V,W),Xl(L,P,V,W,void 0);return}throw Error(t(130,V==null?V:typeof V,""))}}function Bs(L,P,V){if(P.node=V,typeof V=="object"&&V!==null){switch(V.$$typeof){case Ee:Xl(L,P,V.type,V.props,V.ref);return;case xe:throw Error(t(257));case I:var W=V._init;V=W(V._payload),Bs(L,P,V);return}if(j(V)){Ra(L,P,V);return}if(V===null||typeof V!="object"?W=null:(W=ye&&V[ye]||V["@@iterator"],W=typeof W=="function"?W:null),W&&(W=W.call(V))){if(V=W.next(),!V.done){var Le=[];do Le.push(V.value),V=W.next();while(!V.done);Ra(L,P,Le)}return}throw L=Object.prototype.toString.call(V),Error(t(31,L==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":L))}typeof V=="string"?(W=P.blockedSegment,W.lastPushedText=ze(P.blockedSegment.chunks,V,L.responseState,W.lastPushedText)):typeof V=="number"&&(W=P.blockedSegment,W.lastPushedText=ze(P.blockedSegment.chunks,""+V,L.responseState,W.lastPushedText))}function Ra(L,P,V){for(var W=V.length,Le=0;Le<W;Le++){var Te=P.treeContext;P.treeContext=gs(Te,W,Le);try{Yl(L,P,V[Le])}finally{P.treeContext=Te}}}function Yl(L,P,V){var W=P.blockedSegment.formatContext,Le=P.legacyContext,Te=P.context;try{return Bs(L,P,V)}catch(Rt){if(Bo(),typeof Rt=="object"&&Rt!==null&&typeof Rt.then=="function"){V=Rt;var He=P.blockedSegment,et=no(L,He.chunks.length,null,He.formatContext,He.lastPushedText,!0);He.children.push(et),He.lastPushedText=!1,L=$l(L,P.node,P.blockedBoundary,et,P.abortSet,P.legacyContext,P.context,P.treeContext).ping,V.then(L,L),P.blockedSegment.formatContext=W,P.legacyContext=Le,P.context=Te,Qt(Te)}else throw P.blockedSegment.formatContext=W,P.legacyContext=Le,P.context=Te,Qt(Te),Rt}}function _f(L){var P=L.blockedBoundary;L=L.blockedSegment,L.status=3,Xd(this,P,L)}function Wd(L,P,V){var W=L.blockedBoundary;L.blockedSegment.status=3,W===null?(P.allPendingTasks--,P.status!==2&&(P.status=2,P.destination!==null&&P.destination.close())):(W.pendingTasks--,W.forceClientRender||(W.forceClientRender=!0,L=V===void 0?Error(t(432)):V,W.errorDigest=P.onError(L),W.parentFlushed&&P.clientRenderedBoundaries.push(W)),W.fallbackAbortableTasks.forEach(function(Le){return Wd(Le,P,V)}),W.fallbackAbortableTasks.clear(),P.allPendingTasks--,P.allPendingTasks===0&&(W=P.onAllReady,W()))}function Fa(L,P){if(P.chunks.length===0&&P.children.length===1&&P.children[0].boundary===null){var V=P.children[0];V.id=P.id,V.parentFlushed=!0,V.status===1&&Fa(L,V)}else L.completedSegments.push(P)}function Xd(L,P,V){if(P===null){if(V.parentFlushed){if(L.completedRootSegment!==null)throw Error(t(389));L.completedRootSegment=V}L.pendingRootTasks--,L.pendingRootTasks===0&&(L.onShellError=yi,P=L.onShellReady,P())}else P.pendingTasks--,P.forceClientRender||(P.pendingTasks===0?(V.parentFlushed&&V.status===1&&Fa(P,V),P.parentFlushed&&L.completedBoundaries.push(P),P.fallbackAbortableTasks.forEach(_f,L),P.fallbackAbortableTasks.clear()):V.parentFlushed&&V.status===1&&(Fa(P,V),P.completedSegments.length===1&&P.parentFlushed&&L.partialBoundaries.push(P)));L.allPendingTasks--,L.allPendingTasks===0&&(L=L.onAllReady,L())}function Zl(L){if(L.status!==2){var P=it,V=_s.current;_s.current=Uo;var W=Go;Go=L.responseState;try{var Le=L.pingedTasks,Te;for(Te=0;Te<Le.length;Te++){var He=Le[Te],et=L,Rt=He.blockedSegment;if(Rt.status===0){Qt(He.context);try{Bs(et,He,He.node),Rt.lastPushedText&&Rt.textEmbedded&&Rt.chunks.push(_e),He.abortSet.delete(He),Rt.status=1,Xd(et,He.blockedBoundary,Rt)}catch(Zs){if(Bo(),typeof Zs=="object"&&Zs!==null&&typeof Zs.then=="function"){var Ut=He.ping;Zs.then(Ut,Ut)}else{He.abortSet.delete(He),Rt.status=4;var Dt=He.blockedBoundary,_n=Zs,ws=xi(et,_n);if(Dt===null?Jr(et,_n):(Dt.pendingTasks--,Dt.forceClientRender||(Dt.forceClientRender=!0,Dt.errorDigest=ws,Dt.parentFlushed&&et.clientRenderedBoundaries.push(Dt))),et.allPendingTasks--,et.allPendingTasks===0){var Ys=et.onAllReady;Ys()}}}finally{}}}Le.splice(0,Te),L.destination!==null&&Kl(L,L.destination)}catch(Zs){xi(L,Zs),Jr(L,Zs)}finally{Go=W,_s.current=V,V===Uo&&Qt(P)}}}function Da(L,P,V){switch(V.parentFlushed=!0,V.status){case 0:var W=V.id=L.nextSegmentId++;return V.lastPushedText=!1,V.textEmbedded=!1,L=L.responseState,r(P,hn),r(P,L.placeholderPrefix),L=u(W.toString(16)),r(P,L),i(P,Sn);case 1:V.status=2;var Le=!0;W=V.chunks;var Te=0;V=V.children;for(var He=0;He<V.length;He++){for(Le=V[He];Te<Le.index;Te++)r(P,W[Te]);Le=Oa(L,P,Le)}for(;Te<W.length-1;Te++)r(P,W[Te]);return Te<W.length&&(Le=i(P,W[Te])),Le;default:throw Error(t(390))}}function Oa(L,P,V){var W=V.boundary;if(W===null)return Da(L,P,V);if(W.parentFlushed=!0,W.forceClientRender)W=W.errorDigest,i(P,Xn),r(P,is),W&&(r(P,An),r(P,u(M(W))),r(P,Vn)),i(P,Yn),Da(L,P,V);else if(0<W.pendingTasks){W.rootSegmentID=L.nextSegmentId++,0<W.completedSegments.length&&L.partialBoundaries.push(W);var Le=L.responseState,Te=Le.nextSuspenseID++;Le=d(Le.boundaryPrefix+Te.toString(16)),W=W.id=Le,xn(P,L.responseState,W),Da(L,P,V)}else if(W.byteSize>L.progressiveChunkSize)W.rootSegmentID=L.nextSegmentId++,L.completedBoundaries.push(W),xn(P,L.responseState,W.id),Da(L,P,V);else{if(i(P,Jn),V=W.completedSegments,V.length!==1)throw Error(t(391));Oa(L,P,V[0])}return i(P,Gn)}function Yd(L,P,V){return tt(P,L.responseState,V.formatContext,V.id),Oa(L,P,V),ct(P,V.formatContext)}function Zd(L,P,V){for(var W=V.completedSegments,Le=0;Le<W.length;Le++)za(L,P,V,W[Le]);if(W.length=0,L=L.responseState,W=V.id,V=V.rootSegmentID,r(P,L.startInlineScript),L.sentCompleteBoundaryFunction?r(P,Zt):(L.sentCompleteBoundaryFunction=!0,r(P,Ft)),W===null)throw Error(t(395));return V=u(V.toString(16)),r(P,W),r(P,nn),r(P,L.segmentPrefix),r(P,V),i(P,H)}function za(L,P,V,W){if(W.status===2)return!0;var Le=W.id;if(Le===-1){if((W.id=V.rootSegmentID)===-1)throw Error(t(392));return Yd(L,P,W)}return Yd(L,P,W),L=L.responseState,r(P,L.startInlineScript),L.sentCompleteSegmentFunction?r(P,Mt):(L.sentCompleteSegmentFunction=!0,r(P,yt)),r(P,L.segmentPrefix),Le=u(Le.toString(16)),r(P,Le),r(P,Pt),r(P,L.placeholderPrefix),r(P,Le),i(P,At)}function Kl(L,P){n=new Uint8Array(512),s=0;try{var V=L.completedRootSegment;if(V!==null&&L.pendingRootTasks===0){Oa(L,P,V),L.completedRootSegment=null;var W=L.responseState.bootstrapChunks;for(V=0;V<W.length-1;V++)r(P,W[V]);V<W.length&&i(P,W[V])}var Le=L.clientRenderedBoundaries,Te;for(Te=0;Te<Le.length;Te++){var He=Le[Te];W=P;var et=L.responseState,Rt=He.id,Ut=He.errorDigest,Dt=He.errorMessage,_n=He.errorComponentStack;if(r(W,et.startInlineScript),et.sentClientRenderFunction?r(W,G):(et.sentClientRenderFunction=!0,r(W,U)),Rt===null)throw Error(t(395));r(W,Rt),r(W,$),(Ut||Dt||_n)&&(r(W,ue),r(W,u(se(Ut||"")))),(Dt||_n)&&(r(W,ue),r(W,u(se(Dt||"")))),_n&&(r(W,ue),r(W,u(se(_n)))),i(W,ie)}Le.splice(0,Te);var ws=L.completedBoundaries;for(Te=0;Te<ws.length;Te++)Zd(L,P,ws[Te]);ws.splice(0,Te),o(P),n=new Uint8Array(512),s=0;var Ys=L.partialBoundaries;for(Te=0;Te<Ys.length;Te++){var Zs=Ys[Te];e:{Le=L,He=P;var Ho=Zs.completedSegments;for(et=0;et<Ho.length;et++)if(!za(Le,He,Zs,Ho[et])){et++,Ho.splice(0,et);var Ql=!1;break e}Ho.splice(0,et),Ql=!0}if(!Ql){L.destination=null,Te++,Ys.splice(0,Te);return}}Ys.splice(0,Te);var ei=L.completedBoundaries;for(Te=0;Te<ei.length;Te++)Zd(L,P,ei[Te]);ei.splice(0,Te)}finally{o(P),L.allPendingTasks===0&&L.pingedTasks.length===0&&L.clientRenderedBoundaries.length===0&&L.completedBoundaries.length===0&&P.close()}}function Kd(L,P){try{var V=L.abortableTasks;V.forEach(function(W){return Wd(W,L,P)}),V.clear(),L.destination!==null&&Kl(L,L.destination)}catch(W){xi(L,W),Jr(L,W)}}return Uc.renderToReadableStream=function(L,P){return new Promise(function(V,W){var Le,Te,He=new Promise(function(Dt,_n){Te=Dt,Le=_n}),et=Vo(L,ae(P?P.identifierPrefix:void 0,P?P.nonce:void 0,P?P.bootstrapScriptContent:void 0,P?P.bootstrapScripts:void 0,P?P.bootstrapModules:void 0),we(P?P.namespaceURI:void 0),P?P.progressiveChunkSize:void 0,P?P.onError:void 0,Te,function(){var Dt=new ReadableStream({type:"bytes",pull:function(_n){if(et.status===1)et.status=2,c(_n,et.fatalError);else if(et.status!==2&&et.destination===null){et.destination=_n;try{Kl(et,_n)}catch(ws){xi(et,ws),Jr(et,ws)}}},cancel:function(){Kd(et)}},{highWaterMark:0});Dt.allReady=He,V(Dt)},function(Dt){He.catch(function(){}),W(Dt)},Le);if(P&&P.signal){var Rt=P.signal,Ut=function(){Kd(et,Rt.reason),Rt.removeEventListener("abort",Ut)};Rt.addEventListener("abort",Ut)}Zl(et)})},Uc.version="18.3.1",Uc}var kA;function D6(){if(kA)return So;kA=1;var e,t;return e=R6(),t=F6(),So.version=e.version,So.renderToString=e.renderToString,So.renderToStaticMarkup=e.renderToStaticMarkup,So.renderToNodeStream=e.renderToNodeStream,So.renderToStaticNodeStream=e.renderToStaticNodeStream,So.renderToReadableStream=t.renderToReadableStream,So}var sy=D6(),kx=uw(),MA={exports:{}},Uu={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PA;function O6(){if(PA)return Uu;PA=1;var e=Bi,t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(a,u,d){var c,g={},f=null,p=null;d!==void 0&&(f=""+d),u.key!==void 0&&(f=""+u.key),u.ref!==void 0&&(p=u.ref);for(c in u)s.call(u,c)&&!i.hasOwnProperty(c)&&(g[c]=u[c]);if(a&&a.defaultProps)for(c in u=a.defaultProps,u)g[c]===void 0&&(g[c]=u[c]);return{$$typeof:t,type:a,key:f,ref:p,props:g,_owner:r.current}}return Uu.Fragment=n,Uu.jsx=o,Uu.jsxs=o,Uu}var RA;function z6(){return RA||(RA=1,MA.exports=O6()),MA.exports}var FA=z6();const ML=Ge.createContext(void 0),zs=()=>{const e=Ge.useContext(ML);if(!e)throw new Error("useOgma must be used within an OgmaProvider");return e},DA={},B6=({options:e=DA,children:t,graph:n,onReady:s},r)=>{const[i,o]=Ge.useState(!1),[a,u]=Ge.useState(),[d,c]=Ge.useState(null),[g,f]=Ge.useState(),[p,_]=Ge.useState(DA);return Ge.useImperativeHandle(r,()=>a,[a]),Ge.useEffect(()=>{if(d){const y=new P6({container:d,graph:n,options:e});u(y),o(!0),s&&s(y)}},[u,d]),Ge.useLayoutEffect(()=>{const y=()=>a==null?void 0:a.view.forceResize();return y(),window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)},[]),Ge.useEffect(()=>{a&&(n&&a&&n!==g&&(f(n),a.setGraph(n)),e&&p!==e&&(_(e),a.setOptions(e)))},[n,e]),FA.jsx(ML.Provider,{value:a,children:FA.jsx("div",{style:{width:"100%",height:"100%"},ref:y=>c(y),children:i&&t})})},U6=Ge.forwardRef(B6),G6=({selector:e,attributes:t},n)=>{const s=zs(),[r,i]=Ge.useState();return Ge.useImperativeHandle(n,()=>r,[r]),Ge.useEffect(()=>{const o=e?s.styles.addNodeRule(e,t):s.styles.addNodeRule(t);return i(o),()=>{o.destroy(),i(void 0)}},[e,t]),null};Ge.forwardRef(G6);const V6=({selector:e,attributes:t},n)=>{const s=zs(),[r,i]=Ge.useState();return Ge.useImperativeHandle(n,()=>r,[r]),Ge.useEffect(()=>{const o=e?s.styles.addEdgeRule(e,t):s.styles.addEdgeRule(t);return i(o),()=>{o.destroy(),i(void 0)}},[e,t]),null};Ge.forwardRef(V6);function La(e,t,n){t===e.isEnabled()&&(t?e.disable(n):e.enable(n))}function Na(e,t,n){const s=({target:u})=>{u===t&&e.onEnabled&&e.onEnabled(t)},r=({target:u})=>{u===t&&e.onDisabled&&e.onDisabled(t)},i=({target:u})=>{u===t&&e.onUpdated&&e.onUpdated(t)},o=({target:u,index:d})=>{u===t&&e.onSetIndex&&e.onSetIndex(t,d)},a=({target:u})=>{u===t&&(e.onDestroyed&&e.onDestroyed(t),n.events.off(s).off(r).off(i).off(o).off(a))};return n.events.on("transformationEnabled",s).on("transformationDisabled",r).on("transformationDestroyed",a).on("transformationSetIndex",o).on("transformationRefresh",i),()=>{n.events.off(s).off(r).off(i).off(o).off(a)}}function j6(e,t){const n=zs(),[s,r]=Ge.useState();return Ge.useImperativeHandle(t,()=>s,[s]),Ge.useEffect(()=>{const i=n.transformations.addNodeGrouping({...e,enabled:!e.disabled});return Na(e,i,n),r(i),()=>{i.destroy(),r(void 0)}},[]),Ge.useEffect(()=>{s&&La(s,!!e.disabled,e.duration)},[e.disabled]),Ge.useEffect(()=>{s==null||s.setOptions(e)},[e.groupIdFunction,e.groupSelfLoopEdges,e.edgeGenerator,e.nodeGenerator,e.groupEdges,e.padding,e.selector,e.showContents,e.separateEdgesByDirection]),null}Ge.forwardRef(j6);function H6(e,t){const n=zs(),[s,r]=Ge.useState();return Ge.useImperativeHandle(t,()=>s,[s]),Ge.useEffect(()=>{const i=n.transformations.addEdgeGrouping({...e,enabled:!e.disabled});return Na(e,i,n),r(i),()=>{i.destroy(),r(void 0)}},[]),Ge.useEffect(()=>{s&&La(s,!!e.disabled,e.duration)},[e.disabled]),Ge.useEffect(()=>{s==null||s.setOptions(e)},[e.selector,e.generator,e.groupIdFunction,e.separateEdgesByDirection]),null}Ge.forwardRef(H6);function q6(e,t){const n=zs(),[s,r]=Ge.useState();return Ge.useImperativeHandle(t,()=>s,[s]),Ge.useEffect(()=>{const i=n.transformations.addNodeCollapsing({...e,enabled:!e.disabled});return Na(e,i,n),r(i),()=>{i.destroy(),r(void 0)}},[]),Ge.useEffect(()=>{s&&La(s,!!e.disabled,e.duration)},[e.disabled]),Ge.useEffect(()=>{s==null||s.setOptions(e)},[e.edgeGenerator,e.selector]),null}Ge.forwardRef(q6);function $6(e,t){const n=zs(),[s,r]=Ge.useState();return Ge.useImperativeHandle(t,()=>s,[s]),Ge.useEffect(()=>{const i=n.transformations.addNeighborMerging({...e,enabled:!e.disabled});return Na(e,i,n),r(i),()=>{i.destroy(),r(void 0)}},[]),Ge.useEffect(()=>{s&&La(s,!!e.disabled,e.duration)},[e.disabled]),Ge.useEffect(()=>{s==null||s.setOptions(e)},[e.dataFunction,e.selector]),null}Ge.forwardRef($6);function W6(e,t){const n=zs(),[s,r]=Ge.useState();return Ge.useImperativeHandle(t,()=>s,[s]),Ge.useEffect(()=>{const i=n.transformations.addNeighborGeneration({...e,enabled:!e.disabled});return Na(e,i,n),r(i),()=>{i.destroy(),r(void 0)}},[]),Ge.useEffect(()=>{s&&La(s,!!e.disabled,e.duration)},[e.disabled]),Ge.useEffect(()=>{s==null||s.setOptions(e)},[e.edgeGenerator,e.nodeGenerator,e.neighborIdFunction,e.selector]),null}Ge.forwardRef(W6);function X6(e,t){const n=zs(),[s,r]=Ge.useState();return Ge.useImperativeHandle(t,()=>s,[s]),Ge.useEffect(()=>{const i=n.transformations.addEdgeFilter({...e,enabled:!e.disabled});return Na(e,i,n),r(i),()=>{i.destroy(),r(void 0)}},[]),Ge.useEffect(()=>{s&&La(s,!!e.disabled,e.duration)},[e.disabled]),Ge.useEffect(()=>{s==null||s.setOptions(e)},[e.criteria]),null}Ge.forwardRef(X6);function Y6(e,t){const n=zs(),[s,r]=Ge.useState();return Ge.useImperativeHandle(t,()=>s,[s]),Ge.useEffect(()=>{const i=n.transformations.addNodeFilter({...e,enabled:!e.disabled});return Na(e,i,n),r(i),()=>{i.destroy(),r(void 0)}},[]),Ge.useEffect(()=>{s&&La(s,!!e.disabled,e.duration)},[e.disabled]),Ge.useEffect(()=>{s==null||s.setOptions(e)},[e.criteria]),null}Ge.forwardRef(Y6);function PL(e,t,n,s){return typeof n=="string"?n:typeof n=="function"?sy.renderToString(n(e,t)):sy.renderToString(s)}function Cd(e,t){return typeof e=="function"?e(t):e}const Pg=(e,t)=>`${e} ${e}--${t}`;function Z6(e="&times;",t){if(e){const n=typeof e=="string"?e:sy.renderToString(e);return`<div class=${t}>${n}</div>`}return""}function K6(e,t,n,s){const{width:r,height:i}=s.view.getSize(),{x:o,y:a}=s.view.graphToScreenCoordinates(e);let u=t;const{width:d,height:c}=n;return t==="left"&&o-d<0?u="right":t==="right"&&o+d>r?u="left":t==="bottom"&&a+c>i?u="top":t==="top"&&a-c<0&&(u="bottom"),u==="right"||u==="left"?a+c/2>i?u="top":a-c/2<0&&(u="bottom"):o+d/2>r?u="left":o-d/2<0&&(u="right"),u}function Q6(){}const Pm={x:-9999,y:-9999},J6="ogma-popup--content",eH="ogma-popup--close",tH="ogma-popup--body",nH="ogma-popup",sH=({content:e,position:t,children:n,isOpen:s=!0,closeButton:r,onClose:i=Q6,placement:o="top",popupClass:a=nH,closeButtonClass:u=eH,contentClass:d=J6,popupBodyClass:c=tH,size:g,closeOnEsc:f=!0},p)=>{const _=zs(),[y,x]=Ge.useState(null);if(Ge.useImperativeHandle(p,()=>y,[y]),Ge.useEffect(()=>{let b=null,S=null,A=null;if(s){const C=Cd(t,_)||Pm;if(b=_.layers.addOverlay({position:C||Pm,element:`<div class="${Pg(a,o)}"/>
          <div class="${c}">
            ${Z6(r,u)}
            <div class="${d} "></div>
          </div>
        </div>`,size:g||{width:"auto",height:"auto"},scaled:!1}),A=k=>{const M=b==null?void 0:b.element.querySelector(`.${u}`);k.target&&M.contains(k.target)&&(k.stopPropagation(),k.preventDefault(),i())},S=({code:k})=>{k===27&&i()},f&&_.events.on("keyup",S),b.element.addEventListener("click",A),x(b),e&&!n){const k=b.element.querySelector(`.${d}`),M=PL(_,C,e,n);k&&(k.innerHTML=M)}x(b)}return()=>{b&&(A&&b.element.removeEventListener("click",A),S&&_.events.off(S),b.destroy(),x(null))}},[s,_]),Ge.useEffect(()=>{if(y&&y.element){const b=Cd(t,_)||Pm;if(y.setPosition(b),y.element.className=Pg(a,o),e&&!n){const S=y.element.querySelector(`.${d}`);S&&(S.innerHTML=typeof e=="string"?e:"")}s?y.show():y.hide()}},[y,t,s,o,a,e,n]),!y||!s)return null;const E=y.element.querySelector(`.${d}`);return E&&n?kx.createPortal(n,E):null};Ge.forwardRef(sH);const rH=({tooltipClass:e="ogma-tooltip",placement:t="right",position:n,size:s={width:"auto",height:"auto"},children:r,content:i,visible:o=!0},a)=>{const u=zs(),[d,c]=Ge.useState(),[g,f]=Ge.useState(),[p,_]=Ge.useState(""),[y,x]=Ge.useState(),E=Ge.useRef(0);return Ge.useImperativeHandle(a,()=>d,[d]),Ge.useEffect(()=>{const b=`<div class="${Pg(e,t)}"><div class="${e}--content" /></div>`,S={x:-9999,y:-9999};f(S);const A=u.layers.addOverlay({position:S,element:b,scaled:!1,size:s});return c(A),()=>{A.destroy()}},[]),Ge.useEffect(()=>{const b=PL(u,g,i,r);if(d){b!==p&&(d.element.firstElementChild.innerHTML=b,_(b),x({width:d.element.offsetWidth,height:d.element.offsetHeight}));const S=Cd(n,u);g!==S&&f(S),o?d.show():d.hide()}return E.current=requestAnimationFrame(()=>{d&&d.element&&g&&y&&(d.element.className=Pg(e,K6(g,t,y,u)),d.setPosition(g))}),()=>cancelAnimationFrame(E.current)},[r,i,n,o]),null};Ge.forwardRef(rH);const iH=({noClear:e=!1,isStatic:t=!1,render:n,index:s,visible:r},i)=>{const o=zs(),[a,u]=Ge.useState(null);return Ge.useImperativeHandle(i,()=>a,[a]),Ge.useEffect(()=>{const d=o.layers.addCanvasLayer(n,{isStatic:t,noClear:e},s);return u(d),()=>{d&&(d.destroy(),u(null))}},[]),Ge.useEffect(()=>{a&&(s!==void 0&&isFinite(s)&&a.moveTo(s),r===a.isHidden()&&r?a.show():a.hide())},[a,s,r]),null};Ge.forwardRef(iH);const Rm={x:-9999,y:-9999};Ge.forwardRef(({position:e,children:t,className:n="",size:s,scaled:r},i)=>{const o=zs(),[a,u]=Ge.useState(null);return Ge.useImperativeHandle(i,()=>a,[a]),Ge.useEffect(()=>{const d=Cd(e,o)||Rm,c=document.createElement("div");c.className=n;const g=o.layers.addOverlay({position:d||Rm,element:c,size:s||{width:"auto",height:"auto"},scaled:r});return u(g),()=>{a&&(a.destroy(),u(null))}},[]),Ge.useEffect(()=>{if(a){const d=Cd(e,o)||Rm;n&&(a.element.className=n),a.setPosition(d)}},[e,n]),a?kx.createPortal(t,a.element):null});const oH=Ge.forwardRef(({children:e,className:t="",index:n},s)=>{const r=zs(),[i,o]=Ge.useState(null);return Ge.useImperativeHandle(s,()=>i,[i]),Ge.useEffect(()=>{const a=document.createElement("div");a.className=t;const u=r.layers.addLayer(a,n);return o(u),()=>{i&&(i.destroy(),o(null))}},[]),Ge.useEffect(()=>{i&&(i.element.className=t)},[t]),i?kx.createPortal(e,i.element):null});var aH=Object.defineProperty,lH=(e,t,n)=>t in e?aH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lt=(e,t,n)=>lH(e,typeof t!="symbol"?t+"":t,n);let pf=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");const Ld={strokeType:"plain",strokeColor:"#202020",strokeWidth:1,head:"none",tail:"none"},OA={id:0,type:"Feature",properties:{type:"arrow",style:{...Ld}},geometry:{type:"LineString",coordinates:[[0,0],[100,100]]}},RL=(e=0,t=0,n=0,s=0,r={...Ld})=>({id:pf(),type:"Feature",properties:{type:"arrow",style:{...Ld,...r}},geometry:{type:"LineString",coordinates:[[e,t],[n,s]]}}),uH="http://www.w3.org/2000/svg";function xa(e){return document.createElementNS(uH,e)}function FL(e){return e.geometry.bbox||dH(e),e.geometry.bbox}function Oi(e){const t=FL(e);return{width:t[2]-t[0],height:t[3]-t[1]}}function Ri(e){const t=FL(e);return{x:t[0],y:t[1]}}function dH(e){const[t,n]=e.geometry.coordinates[0][0],[s,r]=e.geometry.coordinates[0][2];e.geometry.bbox=[t,n,s,r]}function hH(e,t,n,s,r){e.geometry.bbox=[t,n,t+s,n+r],e.geometry.coordinates=[[[t,n],[t+s,n],[t+s,n+r],[t,n+r],[t,n]]]}function dd(e){const[t,n]=e.geometry.coordinates[0];return{x:t,y:n}}function Gc(e,t){const[n,s]=e.geometry.coordinates[t==="start"?0:1];return{x:n,y:s}}function Rg(e){const[t,n]=e.geometry.coordinates[1];return{x:t,y:n}}function DL(e,t,n){e.geometry.coordinates[0]=[t,n]}function OL(e,t,n){e.geometry.coordinates[1]=[t,n]}function Fg(e){return{start:dd(e),end:Rg(e)}}function dl(e,t,n,s){t==="start"?DL(e,n,s):OL(e,n,s)}const zL=e=>parseInt(e.getAttribute("data-handle-id")||"-1");function cH(e){return Array.isArray(e)&&e.length===2&&e.every(isFinite)}function gH(e,t,n,s){for(let r=0;r<e.coordinates.length;r++){const i=e.coordinates[r];if(cH(i))i[0]=n+(i[0]-n)*t,i[1]=s+(i[1]-s)*t;else for(let o=0;o<i.length;o++){const a=i[o];a[0]=n+(a[0]-n)*t,a[1]=s+(a[1]-s)*t}}return e}function Vc(e,t,n){const s=Math.atan2(e.y-t.y,e.x-t.x);return{x:t.x+n*Math.cos(s),y:t.y+n*Math.sin(s)}}function ry(e,t){if(!t)return{x:e.clientX,y:e.clientY};const n=t.getBoundingClientRect();return{x:e.clientX-n.left-t.clientLeft,y:e.clientY-n.top-t.clientTop}}function fH(e,t){return e.startsWith("#")?mH(e,t):e.startsWith("rgb")?_H(e,t):e}function pH(e){return e.length===4?e.split("").map(t=>t+t).join(""):e}function mH(e,t){const[n,s,r]=pH(e).match(/\w\w/g).map(i=>parseInt(i,16));return`rgba(${n}, ${s}, ${r}, ${t})`}function _H(e,t){const[n,s,r]=e.match(/\d+/g).map(i=>parseInt(i,10));return`rgba(${n}, ${s}, ${r}, ${t})`}const va=(e,t)=>({x:e.x-t.x,y:e.y-t.y}),Ll=e=>Math.sqrt(e.x*e.x+e.y*e.y),BL=e=>({x:-e.x,y:-e.y}),UL=e=>{const t=Ll(e);return t===0?{x:0,y:0}:{x:e.x/t,y:e.y/t}},Al=(e,t)=>({x:e.x+t.x,y:e.y+t.y}),GL=(e,t)=>({x:e.x*t,y:e.y*t}),jc=(e,t)=>({x:e.x*t.x,y:e.y*t.y}),fr=(e,t)=>{const n=Math.sin(t),s=Math.cos(t);return{x:e.x*s-e.y*n,y:e.x*n+e.y*s}},yH=(e,t)=>({x:e.x/t,y:e.y/t}),zA=(e,t)=>e.x*t.x+e.y*t.y,xH=.5;function VL(e,t=5,n=30){var s;const{start:r,end:i}=Fg(e),o=va(i,r),a=e.properties.style&&e.properties.style.strokeWidth?(s=e.properties.style)==null?void 0:s.strokeWidth:0;return Math.min(n,Math.max(3*a,Ll(o)*.01,t))}function BA(e,t,n,s){const r=GL(BL(UL(t)),s);if(!n||n!=="arrow"&&n!=="arrow-plain")return"";const i=Al(e,fr(r,Math.PI/10)),o=Al(e,fr(r,-Math.PI/10)),a=`${e.x} ${e.y}`;return`M ${i.x} ${i.y} L ${a} ${o.x} ${o.y} ${n==="arrow"?"":`${i.x} ${i.y}`}`}function vH(e,t,n,s,r){const{start:i,end:o}=Fg(e),{tail:a,head:u,strokeColor:d,strokeWidth:c=0}=e.properties.style||n,g=va(o,i),f=VL(e,s,r),p=xa("g"),_=xa("path");p.setAttribute("data-annotation",`${e.id}`),p.setAttribute("data-annotation-type","arrow");const y=u==="arrow-plain"||a==="arrow",x=d||"none";_.setAttribute("stroke",x),_.setAttribute("stroke-width",`${c}`),_.setAttribute("fill",y?d||"":"none"),_.setAttribute("stroke-linecap","round"),_.setAttribute("stroke-linejoin","round");const E=BA(i,BL(g),a,f),b=BA(o,g,u,f),S=E+`M ${i.x} ${i.y} ${o.x} ${o.y}`+b;_.setAttribute("d",S),p.appendChild(_),UA(p,i,x,a,c),UA(p,o,x,u,c),t.appendChild(p)}function UA(e,t,n,s,r){s==="halo-dot"&&GA(e,t,bH(n),r*4),(s==="dot"||s==="halo-dot")&&GA(e,t,n,r*2)}function bH(e){return e==="none"?"none":fH(e,xH)}function GA(e,t,n,s){const r=xa("circle");r.setAttribute("cx",`${t.x}`),r.setAttribute("cy",`${t.y}`),r.setAttribute("r",`${s}`),r.setAttribute("fill",n),e.appendChild(r)}const ds=-1,Dg="dragging",Og="dragstart",Vl="dragend",iy="select",oy="unselect",EH="hover",SH="unhover",ay="remove",ly="add",AH="cancelDrawing",uy="update",wH="link";function jL(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var VA={exports:{}},jA;function TH(){return jA||(jA=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(n=!1));function r(u,d,c){this.fn=u,this.context=d,this.once=c||!1}function i(u,d,c,g,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var p=new r(c,g||u,f),_=n?n+d:d;return u._events[_]?u._events[_].fn?u._events[_]=[u._events[_],p]:u._events[_].push(p):(u._events[_]=p,u._eventsCount++),u}function o(u,d){--u._eventsCount===0?u._events=new s:delete u._events[d]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],d,c;if(this._eventsCount===0)return u;for(c in d=this._events)t.call(d,c)&&u.push(n?c.slice(1):c);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},a.prototype.listeners=function(u){var d=n?n+u:u,c=this._events[d];if(!c)return[];if(c.fn)return[c.fn];for(var g=0,f=c.length,p=new Array(f);g<f;g++)p[g]=c[g].fn;return p},a.prototype.listenerCount=function(u){var d=n?n+u:u,c=this._events[d];return c?c.fn?1:c.length:0},a.prototype.emit=function(u,d,c,g,f,p){var _=n?n+u:u;if(!this._events[_])return!1;var y=this._events[_],x=arguments.length,E,b;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),x){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,c),!0;case 4:return y.fn.call(y.context,d,c,g),!0;case 5:return y.fn.call(y.context,d,c,g,f),!0;case 6:return y.fn.call(y.context,d,c,g,f,p),!0}for(b=1,E=new Array(x-1);b<x;b++)E[b-1]=arguments[b];y.fn.apply(y.context,E)}else{var S=y.length,A;for(b=0;b<S;b++)switch(y[b].once&&this.removeListener(u,y[b].fn,void 0,!0),x){case 1:y[b].fn.call(y[b].context);break;case 2:y[b].fn.call(y[b].context,d);break;case 3:y[b].fn.call(y[b].context,d,c);break;case 4:y[b].fn.call(y[b].context,d,c,g);break;default:if(!E)for(A=1,E=new Array(x-1);A<x;A++)E[A-1]=arguments[A];y[b].fn.apply(y[b].context,E)}}return!0},a.prototype.on=function(u,d,c){return i(this,u,d,c,!1)},a.prototype.once=function(u,d,c){return i(this,u,d,c,!0)},a.prototype.removeListener=function(u,d,c,g){var f=n?n+u:u;if(!this._events[f])return this;if(!d)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===d&&(!g||p.once)&&(!c||p.context===c)&&o(this,f);else{for(var _=0,y=[],x=p.length;_<x;_++)(p[_].fn!==d||g&&!p[_].once||c&&p[_].context!==c)&&y.push(p[_]);y.length?this._events[f]=y.length===1?y[0]:y:o(this,f)}return this},a.prototype.removeAllListeners=function(u){var d;return u?(d=n?n+u:u,this._events[d]&&o(this,d)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}(VA)),VA.exports}var CH=TH();const HL=jL(CH);class qL extends HL{constructor(t,n){super(),lt(this,"ogma"),lt(this,"elements"),lt(this,"layer"),lt(this,"editor"),lt(this,"selectedId",ds),lt(this,"hoveredId",ds),lt(this,"ogmaOptions"),lt(this,"shouldDetect"),lt(this,"isDragging"),lt(this,"showeditorOnHover"),lt(this,"_onKeyUp",s=>{s.code===27&&this.selectedId!==ds?this.unselect():(s.code===46||s.code===8)&&this.selectedId!==ds&&this._canRemove()&&this.remove(this.selectedId)}),lt(this,"_onClickMouseMove",s=>{if(!s.domEvent||this.isDragging||!this.shouldDetect||s.domEvent.type!=="mousemove"&&s.domEvent.target&&s.domEvent.target.tagName==="a")return;const r=this.ogma.view.screenToGraphCoordinates(s),i=this.shouldDetect||!this.shouldDetect&&+this.selectedId>-1?this.detect(r,0):void 0;s.domEvent.type==="mousemove"?i?this.hover(i.id):this.hoveredId!==ds&&this.unhover():i?this.select(i.id):this.selectedId!==ds&&this.unselect()}),this.ogma=t,this.elements=[],this.shouldDetect=!0,this.isDragging=!1,this.showeditorOnHover=!0,this.ogmaOptions=t.getOptions(),t.events.on(["click","mousemove"],this._onClickMouseMove).on("keyup",this._onKeyUp).on("frame",()=>{this.refreshEditor(),this.refreshDrawing()}),this.layer=t.layers.addSVGLayer({draw:s=>this.draw(s)}),this.layer.moveToTop(),this.editor=t.layers.addLayer(n),this.editor.hide()}_canRemove(){return!0}add(t){const n=this.getDefaultOptions(),s=Object.assign(t,{id:t.id===void 0?pf():t.id,type:t.type,properties:{...n.properties,...t.properties||{},style:{...n.properties.style,...t.properties.style||{}}},geometry:{...n.geometry,...t.geometry}});return this.elements.push(s),this.layer.refresh(),this.emit(ly,s),s}updateStyle(t,n){this.updateAnnotation(t,{properties:{style:n}})}updateGeometry(t,n){this.updateAnnotation(t,{geometry:n})}scale(t,n,s,r){this.updateGeometry(t,gH(t.geometry,n,s,r))}update(t,n){const s=this.getById(t);this.updateAnnotation(s,n)}updateAnnotation(t,n){if(!t)return;const s=t.id;Object.keys(n).forEach(r=>{if(r!=="id")if(r==="properties"){const i=n.properties||{style:{}};t.properties={...t.properties||{},...i||{},style:{...t.properties.style||{},...i.style||{}}}}else r==="geometry"?t.geometry={...t.geometry,...n.geometry}:t[r]=n[r]}),s===this.selectedId&&this.refreshEditor(),this.layer.refresh()}getById(t){const n=Number(t);for(let s=0;s<this.elements.length;s++){const r=this.elements[s];if(!(r.id!==t&&r.id!==n))return r}}select(t){const n=this.getById(t);n&&(this.editor.show(),this.selectedId=t,this.refreshEditor(),this.layer.refresh(),this.emit(iy,n))}hover(t){const n=this.getById(t);n&&(this.showeditorOnHover&&this.editor.show(),this.hoveredId=t,this.refreshEditor(),this.layer.refresh(),this.emit(EH,n))}getSelectedFeature(){return this.selectedId===ds?null:this.getById(this.selectedId)}unselect(){const t=this.getById(this.selectedId);return t&&this.emit(oy,t),this.selectedId=ds,this.hoveredId===ds&&this.editor.hide(),this.layer.refresh(),this}unhover(){const t=this.getById(this.hoveredId);return this.emit(SH,t),this.hoveredId=ds,this.selectedId===ds&&this.editor.hide(),this.layer.refresh(),this}remove(t){const n=this.getById(t);t===this.hoveredId&&this.unhover(),t===this.selectedId&&this.unselect(),this.elements=this.elements.filter(s=>s.id!==t),n&&this.emit(ay,n),this.layer.refresh()}disableDragging(){this.ogma.setOptions({interactions:{drag:{enabled:!1},pan:{enabled:!1}},detect:{nodes:!1,edges:!1,nodeTexts:!1,edgeTexts:!1}})}restoreDragging(){this.ogma.setOptions(this.ogmaOptions)}enableDetection(){this.shouldDetect=!0}disableDetection(){this.shouldDetect=!1}refreshLayer(){this.layer.refresh()}refreshDrawing(){}getElements(){return[...this.elements]}destroy(){this.ogma.events.off(this._onClickMouseMove).off(this._onKeyUp),this.layer.destroy()}}const HA="handle-line",qA="handle-start",$A="handle-end";class LH extends qL{constructor(t,n={}){super(t,`
    <div class="arrow-handle">
      <div id="${HA}" data-handle-id="0" class="handle line"></div>
      <div id="${qA}" data-handle-id="1" class="handle point"></div>
      <div id="${$A}" data-handle-id="2" class="handle point"></div>
    </div>
  `),lt(this,"draggedHandle",ds),lt(this,"start",{x:0,y:0}),lt(this,"end",{x:0,y:0}),lt(this,"arrow",{...OA}),lt(this,"startX",0),lt(this,"startY",0),lt(this,"minArrowHeight",0),lt(this,"maxArrowHeight",0),lt(this,"handles",[]),lt(this,"onHandleMouseDown",s=>{const r=this.getById(this.selectedId)||this.getById(this.hoveredId);if(!r)return;const{x:i,y:o}=ry(s,this.ogma.getContainer());this.startDragging(r,i,o),this.draggedHandle=zL(s.target)}),lt(this,"onMouseUp",()=>{this.draggedHandle!==-1&&(this.restoreDragging(),this.isDragging=!1,this.draggedHandle=ds,this.emit(Vl,this.arrow))}),lt(this,"onMouseMove",s=>{if(!this.isDragging||this.draggedHandle===ds)return;const r=this.handles[this.draggedHandle],i=this.ogma.view.getAngle(),{x:o,y:a}=fr(yH({x:s.x-this.startX,y:s.y-this.startY},this.ogma.view.getZoom()),i),u=r.id===HA,d=r.id===qA,c=r.id===$A;(u||d)&&DL(this.arrow,this.start.x+o,this.start.y+a),(u||c)&&OL(this.arrow,this.end.x+o,this.end.y+a),this.emit(Dg,this.arrow,u?"line":d?"start":"end"),this.refreshEditor(),this.layer.refresh()}),this.minArrowHeight=n.minArrowHeight||0,this.maxArrowHeight=n.maxArrowHeight||1e6,this.handles=Array.prototype.slice.call(this.editor.element.querySelectorAll(".arrow-handle>.handle")),this.handles.forEach(s=>s.addEventListener("mousedown",this.onHandleMouseDown)),document.addEventListener("mousemove",this.onMouseMove,!0),document.addEventListener("mouseup",this.onMouseUp)}startDrawing(t,n,s=RL(t,n,t,n,Ld)){var r;this.disableDragging(),this.add(s),this.hoveredId=s.id;const i=this.ogma.view.graphToScreenCoordinates({x:t,y:n}),o=((r=this.ogma.getContainer())==null?void 0:r.getBoundingClientRect())||{left:0,top:0};this.startDragging(this.getById(s.id),i.x+(o==null?void 0:o.left),i.y+o.top),this.draggedHandle=2}cancelDrawing(){this.isDragging&&(this.remove(this.arrow.id),this.emit(Vl,this.arrow),this.restoreDragging(),this.isDragging=!1,this.draggedHandle=ds)}startDragging(t,n,s){this.selectedId!==t.id&&this.select(this.hoveredId),this.arrow=t,this.startX=n,this.startY=s,this.start=dd(this.arrow),this.end=Rg(this.arrow),this.disableDragging(),this.emit(Og,this.arrow),this.isDragging=!0}detect(t,n=0){return this.elements.find(s=>{const{start:r,end:i}=Fg(s),o=va(t,{x:(r.x+i.x)/2,y:(r.y+i.y)/2}),a=va(i,r),u=Ll(a),d=UL(a),c=VL(s);return Math.abs(zA(d,o))<u/2+n&&Math.abs(zA(fr(d,Math.PI/2),o))<c/2+n})}refreshEditor(){if(+this.selectedId<0&&+this.hoveredId<0)return;const t=this.selectedId!==ds?this.getById(this.selectedId):this.getById(this.hoveredId),n=Fg(t),s=this.ogma.view.graphToScreenCoordinates(n.start),r=this.ogma.view.graphToScreenCoordinates(n.end),[i,o,a]=Array.prototype.slice.call(this.editor.element.querySelectorAll(".handle"));o.style.transform=`translate(${s.x}px, ${s.y}px) translate(-50%, -50%)`,a.style.transform=`translate(${r.x}px, ${r.y}px) translate(-50%, -50%)`;const u={x:(r.x+s.x)/2,y:(r.y+s.y)/2},d=va(r,s),c=GL(d,1/Ll(d)),g=Math.atan2(c.y,c.x);i.style.width=`${Ll(d)}px`,i.style.left=`${u.x}px`,i.style.top=`${u.y}px`,i.style.transform=`translate(-50%, -50%) rotate(${g}rad)`}getDefaultOptions(){return OA}draw(t){t.innerHTML="";const n=xa("g"),s=this.ogma.view.getAngle();s!==0&&n.setAttribute("transform",`rotate(${-s*(180/Math.PI)})`),this.elements.forEach(r=>vH(r,n,Ld,this.minArrowHeight,this.maxArrowHeight)),t.appendChild(n)}refreshDrawing(){const t=this.ogma.view.getAngle();this.layer.element!==null&&t!==0&&this.layer.element.children[0].setAttribute("transform",`rotate(${-t*(180/Math.PI)})`)}destroy(){super.destroy(),document.removeEventListener("mousemove",this.onMouseMove,!0),document.removeEventListener("mouseup",this.onMouseUp)}}const Nl={font:"sans-serif",fontSize:18,color:"#505050",background:"#f5f5f5",strokeWidth:0,borderRadius:8,padding:16,strokeType:"plain"},Fm={id:0,type:"Feature",properties:{type:"text",content:"",style:{...Nl}},geometry:{type:"Polygon",coordinates:[[[0,0],[100,0],[100,50],[0,50],[0,0]]]}},WA={handleSize:3.5,placeholder:"Your text..."},$L=(e=0,t=0,n=100,s=50,r="",i={...Nl})=>({id:pf(),type:"Feature",properties:{type:"text",content:r,style:{...Nl,...i}},geometry:{type:"Polygon",coordinates:[[[e,t],[e+n,t],[e+n,t+s],[e,t+s],[e,t]]]}});var dy={exports:{}},NH=dy.exports,XA;function IH(){return XA||(XA=1,function(e,t){(function(n,s){e.exports=s()})(NH,()=>(()=>{var n={d:(q,Y)=>{for(var ne in Y)n.o(Y,ne)&&!n.o(q,ne)&&Object.defineProperty(q,ne,{enumerable:!0,get:Y[ne]})},o:(q,Y)=>Object.prototype.hasOwnProperty.call(q,Y)},s={};function r(q){return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},r(q)}n.d(s,{default:()=>os});var i=/^((?:[a-z\d-]+\s+)*)([\d.]+(%|em|px)|(?:x+-)?large|(?:x+-)?small|medium)(?:\s*\/\s*(normal|[\d.]+(%|px|em)?))?(\s.+)?$/,o=/\bsmall-caps\b/,a=/\b(?:italic|oblique)\b/,u=/\bbold(?:er)?\b/,d=13.3333333,c={"xx-small":9,"x-small":10,smaller:13.3333,small:13,medium:16,large:18,larger:19.2,"x-large":24,"xx-large":32};function g(q){var Y="",ne=this;return ne.style&&ne.style!=="normal"&&(Y+=ne.style),ne.variant&&ne.variant!=="normal"&&(Y+=(Y?" ":"")+ne.variant),ne.weight&&ne.weight!=="normal"&&(Y+=(Y?" ":"")+ne.weight),ne.size&&(Y+=(Y?" ":"")+ne.size+"px",ne.height!==ne.size&&(Y+="/"+ne.height+"px")),ne.family&&(Y+=(Y?" ":"")+ne.family),q&&(Y+="::"+ne.baseline),q&&(Y+="::"+ne.color),Y}var f={id:"",family:"sans-serif",height:14,size:12,variant:"",style:"",weight:"",baseline:"",color:null,toString:g,valueOf:g};function p(q){var Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ne=i.exec(q);Y.family=(ne[6]||"").trim();var K=c[ne[2]]||parseFloat(ne[2]);ne[3]==="%"?K*=.16:ne[3]==="em"?K*=16:ne[3]==="pt"&&(K*=d),Y.size=K;var Me=parseFloat(ne[4]);if(Me!=="normal"&&Me!=="inherit"&&Me?ne[5]&&ne[5]!=="em"?ne[5]==="pt"?Y.height=Me*d:ne[5]==="%"?Y.height=.01*K:Y.height=Me:Y.height=Me*K:Y.height=Math.round(K*(7/6)),o.test(ne[1])&&(Y.variant="small-caps"),a.test(ne[1])&&(Y.style="italic"),u.test(ne[1]))Y.weight="bold";else{var Qe=parseInt(/\b(\d+)\b/.exec(ne[1]),10);Qe>=100&&Qe!==400&&(Y.weight=Qe)}return Y}function _(){var q,Y,ne,K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"12px/14px sans-serif",Me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Qe=14,at=12,tt=null,ct=null,yt="";if(K&&K.nodeType){var Mt=K&&(K.ownerDocument&&K.ownerDocument.defaultView||K.document&&K||K.defaultView),Pt=Mt.getComputedStyle(K,null);q=Pt.getPropertyValue("font-family")||"",at=parseFloat(Pt.getPropertyValue("font-size")),Qe=Pt.getPropertyValue("line-height"),tt=Pt.getPropertyValue("font-weight"),ct=Pt.getPropertyValue("font-style"),yt=Pt.getPropertyValue("font-variant")||""}else if(typeof K=="string"){var At=p(K);q=At.family,at=At.size,Qe=At.height,yt=At.variant,ct=At.style,tt=At.weight}else r(K)==="object"&&(q=K.family,at=K.size,Qe=K.height,yt=K.variant,tt=K.weight,ct=K.style,Y=K.baseline,ne=K.color);Me.size&&Me.size<3&&(at*=Me.size),Qe=Qe!=="normal"&&Qe?parseFloat(Qe):at*(7/6),Me.height&&Me.height<3&&(Qe*=Me.height);var Ft=Object.create(f);return Ft.family=Me.family||q||"sans-serif",Ft.height=Qe??14,Ft.size=at??12,Ft.variant=Me.variant||yt||"",Ft.style=Me.style||ct||"",Ft.weight=Me.weight||tt||"",Ft.baseline=Y||0,Me.baseline!=null&&(Ft.baseline=Me.baseline),Ft.color=Me.color||ne||"",Ft.id=g.call(Ft,!0),Ft}const y={"\n":.28,"\r":.28," ":.28,"":.28,"":.28,"":0,"":.5,"":1,"":.5,"":1,"":.33,"":.25,"":.16,"":.56,"":.28,"":.2,"":.15,"":0,"":.16,"":.22,"":1,"\uFEFF":0};var x,E=function(q){var Y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(100,100)||q&&q.createElement("canvas");if(Y&&Y.getContext){var ne=Y.getContext("2d");if(ne&&typeof ne.measureText=="function")return function(K,Me){return ne.font=String(Me),ne.measureText(K).width}}}(typeof document<"u"?document:null)||(x={},function(q,Y){if(!x[Y]){var ne=_(Y);x[Y]=ne,/\bmonospace\b/.test(ne.family)?ne.size*=.6:(ne.size*=.45,ne.weight&&(ne.size*=1.18))}return q.length*x[Y].size}),b={},S={trim:!0,collapse:!0};function A(q,Y,ne){var K=Object.assign({},S,ne),Me=String(q);if(!Me)return 0;if(Me in y){var Qe=Y.id+"/"+Me;return Qe in b||(b[Qe]=E("_".concat(Me,"_"),Y)-E("__",Y)),b[Qe]}return K.trim&&K.collapse?K.trim?Me=Me.trim():K.collapse&&(Me=Me.replace(/\s+/g," ")):Me=Me.replace(/\n/g," "),E(Me,Y)+Y.size*(q.tracking||0)}function C(q){return C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},C(q)}function k(q,Y){if(typeof Y!="function"&&Y!==null)throw new TypeError("Super expression must either be null or a function");q.prototype=Object.create(Y&&Y.prototype,{constructor:{value:q,writable:!0,configurable:!0}}),Object.defineProperty(q,"prototype",{writable:!1}),Y&&M(q,Y)}function M(q,Y){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ne,K){return ne.__proto__=K,ne},M(q,Y)}function R(q){var Y=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var ne,K=j(q);if(Y){var Me=j(this).constructor;ne=Reflect.construct(K,arguments,Me)}else ne=K.apply(this,arguments);return O(this,ne)}}function O(q,Y){if(Y&&(C(Y)==="object"||typeof Y=="function"))return Y;if(Y!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(ne){if(ne===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne}(q)}function j(q){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Y){return Y.__proto__||Object.getPrototypeOf(Y)},j(q)}function z(q,Y){if(!(q instanceof Y))throw new TypeError("Cannot call a class as a function")}function X(q,Y){for(var ne=0;ne<Y.length;ne++){var K=Y[ne];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(q,(Me=function(Qe,at){if(C(Qe)!=="object"||Qe===null)return Qe;var tt=Qe[Symbol.toPrimitive];if(tt!==void 0){var ct=tt.call(Qe,at);if(C(ct)!=="object")return ct;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Qe)}(K.key,"string"),C(Me)==="symbol"?Me:String(Me)),K)}var Me}function oe(q,Y,ne){return Y&&X(q.prototype,Y),Object.defineProperty(q,"prototype",{writable:!1}),q}var re=function(){function q(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";z(this,q),this.value=Y,this.weight=null,this.style=null,this.font=null,this.href=null,this.sub=!1,this.sup=!1}return oe(q,[{key:"clone",value:function(){var Y=new q(this.value);return Y.value=this.value,Y.weight=this.weight,Y.style=this.style,Y.font=this.font,Y.href=this.href,Y.sub=this.sub,Y.sup=this.sup,Y}},{key:"valueOf",value:function(){return this.value}},{key:"toString",value:function(){return this.value}}]),q}(),Q=function(q){k(ne,q);var Y=R(ne);function ne(){return z(this,ne),Y.apply(this,arguments)}return oe(ne)}(re),he=function(q){k(ne,q);var Y=R(ne);function ne(){return z(this,ne),Y.apply(this,arguments)}return oe(ne)}(re),fe=function(q){k(ne,q);var Y=R(ne);function ne(){return z(this,ne),Y.apply(this,arguments)}return oe(ne)}(re),ae=/^[\n\r\t\x20\xA0\u2000-\u200B\u205F\u3000]/,me=/^[^\n\r\t\u0020\u2000-\u200B\u205F\u3000]{2,}/,we=/^[\xA0\u2011\u202F\u2060\uFEFF]/,Z=/^(?:[;\xAD%?]|,(?!\d))/,_e=/^[$\u2212]/;function ze(q,Y){Y!==!1&&(q=q.trim());for(var ne,K,Me=[],Qe=q.charAt(0),at=0,tt=1,ct=q.length;tt<ct;tt++){ne=q.charAt(tt),K=q.charAt(tt+1);var yt=ae.test(Qe),Mt=ae.test(ne),Pt=Mt||yt,At=void 0;if((_e.test(ne)&&!we.test(Qe)||Z.test(Qe+K)&&!we.test(ne))&&(Pt=!0),Qe!=="-"&&Qe!==""&&Qe!==""&&Qe!==""||((At=ae.test(q.charAt(tt-2)))&&!Mt&&(Pt=!1),!At&&me.test(ne+K)&&(Pt=!0)),Pt){var Ft=q.slice(at,tt);/\u00AD$/.test(Ft)?(Me.push(new re(Ft.slice(0,-1))),Me.push(new fe)):(Me.push(new re(Ft)),Me.push(new Q)),at=tt}Qe=ne}return Me.push(new re(q.slice(at))),Me}const Re={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:""};var We=/^[\n\r\x20\u2000-\u200B\u205F\u3000]/,st=/^<\/([a-zA-Z0-9]+)([^>]*)>/,ft=/^<([a-zA-Z0-9]+)((?:\s[^=\s/]+(?:\s*=\s*(?:"[^"]+"|'[^']+'|[^>\\s]+))?)+)?\s*(\/?)>(\n*)/,ut=/^<!--(.+?)-->/,ce=/&(?:#(\d\d{2,})|#x([\da-fA-F]{2,})|([a-zA-Z][a-zA-Z1-4]{1,8}));/g,be={b:function(q){q.weight="bold"},strong:function(q){q.weight="bold"},i:function(q){q.style="italic"},em:function(q){q.style="italic"},dfn:function(q){q.style="italic"},cite:function(q){q.style="italic"},code:function(q){q.family="monospace"},kbd:function(q){q.family="monospace"},samp:function(q){q.family="monospace"},var:function(q){q.family="monospace"},tt:function(q){q.family="monospace"},sub:function(q){q.sub=!0},sup:function(q){q.sup=!0}},qe={div:1,li:1,blockquote:2,h1:2,h2:2,h3:2,h4:2,h5:2,h6:2,ul:2,ol:2,hr:2,p:2};function Ue(q){return q.replace(ce,function(Y,ne,K,Me){if(ne||K){var Qe=ne?10:16;return String.fromCharCode(parseInt(ne||K,Qe))}return Me in Re?Re[Me]:Y})}function Ie(q){return q&&q.length>1&&(q[0]==='"'&&q[q.length-1]==='"'||q[0]==="'"&&q[q.length-1]==="'")?q.slice(1,-1):q}var Fe=/^\s*([^=\s&]+)(?:\s*=\s*("[^"]+"|'[^']+'|[^>\s]+))?/;function Oe(q){var Y,ne={};if(q){do if(Y=Fe.exec(q)){var K=Ue(Ie(Y[2]||"")).replace(/[ \r\n\t]+/g," ").trim();if(ne[Y[1]]=K,(q=q.slice(Y[0].length)).length&&/^\S/.test(q[0]))throw new Error("Attribute error")}while(Y&&q.length);if(/\S/.test(q))throw new Error("Attribute error")}return ne}const Xe={copyright:"",textcopyright:"",dag:"",textdagger:"",ddag:"",textdaggerdbl:"",guillemotleft:"",guillemotright:"",guilsinglleft:"",guilsinglright:"",ldots:"",dots:"",textellipsis:"",lq:"",P:"",textparagraph:"",pounds:"",textsterling:"",quotedblbase:"",quotesinglbase:"",rq:"",S:"",sim:"~",textasciicircum:"^",textasciitilde:"",texttildelow:"~",textasteriskcentered:"*",textbackslash:"'",textbar:"|",textbardbl:"",textbigcircle:"",textbraceleft:"{",textbraceright:"}",textbullet:"",textdollar:"$",textemdash:"",textendash:"",texteuro:"",eurosym:"",euro:"",textexclamdown:"",textgreater:">",textless:"<",textordfeminine:"",textordmasculine:"",textperiodcentered:"",cdot:"",textquestiondown:"",textquotedblleft:"",textquotedblright:"",textquoteleft:"",textquoteright:"",textquotestraightbase:"",textquotestraightdblbase:"",textregistered:"",textthreequartersemdash:"-",texttrademark:"",texttwelveudash:"-",textunderscore:"_",textvisiblespace:"",gets:"",textleftarrow:"",to:"",textrightarrow:"",textdegree:"",infty:"",triangle:"",triangledown:"",blacktriangle:"",blacktriangledown:"",angle:"",sphericalangle:"",aleph:"",hbar:"",imath:"",jmath:"",ell:"",wp:"",Re:"",Im:"",mho:"",prime:"",emptyset:"",nabla:"",surd:"",partial:"",top:"",bot:"",vdash:"",dashv:"",forall:"",exists:"",nexists:"",neg:"",lnot:"",flat:"",natural:"",sharp:"",backslash:"\\",Box:"",Diamond:"",clubsuit:"",diamondsuit:"",heartsuit:"",spadesuit:"",Join:"",blacksquare:"",bigstar:"",diagdown:"",diagup:"",blacklozenge:"",rfloor:"",lfloor:"",rceil:"",lceil:"",rangle:"",langle:"",sum:"",int:"",oint:"",prod:"",coprod:"",bigcap:"",bigcup:"",bigsqcup:"",bigvee:"",bigwedge:"",bigodot:"",bigotimes:"",bigoplus:"",biguplus:"",alpha:"",beta:"",chi:"",delta:"",epsilon:"",eta:"",gamma:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",omega:"",phi:"",pi:"",psi:"",rho:"",sigma:"",tau:"",theta:"",upsilon:"",xi:"",zeta:"",Alpha:"",Beta:"",Chi:"",Delta:"",Epsilon:"",Eta:"",Gamma:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Omega:"",Phi:"",Pi:"",Psi:"",Rho:"",Sigma:"",Tau:"",Theta:"",Upsilon:"",Xi:"",Zeta:"",aa:"",AA:"",ae:"",AE:"",dh:"",DH:"",dj:"",DJ:"",ij:"",IJ:"",l:"",L:"",ng:"",NG:"",o:"",O:"",oe:"",OE:"",ss:"",SS:"SS",th:"",TH:""};var dt=/^(\^|_|\\[^#$%&~_^\\{}()\s]+)(\{)?/,mt=/^%[^\n]+(?:\n|$)/,ht=/^[^#$%&~_^\\{}]+/,wt=/^\\([&{}$%#_])/,Lt=/(?:\\[\\@,!:;-]|-{2,3}|[!?]`|``?|,,|''?|~|<<|>>)/g,Tt={"---":"","--":"","!`":"","?`":"","``":"",",,":"","''":"","`":"","'":"","<<":"",">>":"","~":"","\\-":"","\\,":"","\\;":"","\\:":"","\\!":"","\\@":"\uFEFF","\\\\":"\\newline{}"},ot={bf:function(q){q.weight="bold"},it:function(q){q.style="italic"},sl:function(q){q.style="italic"},color:function(q,Y){q.color=Y},href:function(q,Y){q.href=Y},"^":function(q){q.sup=!0},_:function(q){q.sub=!0},par:function(q){this.tokens.push(new he,new he)},newline:function(q){this.tokens.push(new he)},url:function(q,Y){this.open_context().href=Y,this.add_token(new re(Y)),this.close_context()}};ot.textsuperscript=ot["^"],ot.textsubscript=ot._,ot.textsl=ot.sl,ot.mathbf=ot.bf,ot.mathit=ot.it,ot.textbf=ot.bf,ot.textit=ot.it,ot.textcolor=ot.color;var jt=/[\r\n\xA0]+/g;function Nt(q,Y){q.sup&&(q.baseline=.45,q.size=.7),q.sub&&(q.baseline=-.3,q.size=.7);var ne=Y;return(q.style||q.weight||q.baseline||q.color||q.size||q.family)&&(ne=_(Y,q)),ne}function Gt(q,Y,ne){for(var K,Me,Qe=q.width;Qe+ne.width>Y&&q.length;)Me=(K=q[q.length-1]).width,K.width>ne.width?(K.value=K.value.slice(0,-1),K.width=A(K,K.font),Qe+=K.width):q.pop(),Qe-=Me;q[q.length-1]instanceof fe&&q.pop(),K=q[q.length-1]||K||{},ne.font=_(ne.font,K.bold,K.italic,""),ne.href=q.length?K.href:null,ne.rel=q.length?K.rel:null,ne.target=q.length?K.target:null,q.push(ne)}function Wt(q){return Math.round(1e6*q)/1e6}function hn(q){return function(Y){if(Array.isArray(Y))return Sn(Y)}(q)||function(Y){if(typeof Symbol<"u"&&Y[Symbol.iterator]!=null||Y["@@iterator"]!=null)return Array.from(Y)}(q)||function(Y,ne){if(Y){if(typeof Y=="string")return Sn(Y,ne);var K=Object.prototype.toString.call(Y).slice(8,-1);return K==="Object"&&Y.constructor&&(K=Y.constructor.name),K==="Map"||K==="Set"?Array.from(Y):K==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(K)?Sn(Y,ne):void 0}}(q)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Sn(q,Y){(Y==null||Y>q.length)&&(Y=q.length);for(var ne=0,K=new Array(Y);ne<Y;ne++)K[ne]=q[ne];return K}var Jn={center:"middle",right:"end"},Wn={middle:.5,center:.5,bottom:1,end:1},Un=function(q,Y){return!q&&!Y||q===Y};function Xn(q,Y){var ne=[],K=Y.font(),Me=K.size,Qe=K.family,at=Y.align(),tt=Y.createElement();if(q.length){var ct=K.height,yt=Y.valign(),Mt=Y.height()(),Pt=Y.width()(0),At=!isFinite(Pt)&&q.length===1,Ft=At?null:Y.x(),Zt=Wt(ct/Me),nn=At?null:Wt(ct/(1.15*Me+(ct-Me)/2));if(Wn[yt]&&isFinite(Mt)){var H=yt==="bottom"?1:.5;nn+=(Mt*H-ct*q.length*H)/Me}var U=at==="justify",G=0;at==="right"?G=Pt:at==="center"&&(G=Pt/2);for(var $=[],ie="tspan",ue=null,te="",se=function(){if(te){var le=tt(ie,ue,te);$.push(le)}ie="tspan",ue=null,te=""},ge=0,Ee=q.length;ge<Ee;ge++){var xe="",Se="",Ne=0,De=q[ge];if(De.length){$=[];for(var ve=0,Be=0,$e=void 0,je=0,Ye=De.length;je<Ye;je++){var w=De[je],I=w.font;w.whitespace&&ve++,Be+=w.width,je&&!w.tracking&&!Ne&&Un(I.id,xe)&&Un(w.class,Se)&&Un($e,w.href)?te+=w.value:(se(),te=w.value,ue={fontFamily:I.family!==Qe?I.family:null,fontSize:I.size!==Me?I.size:null,fontWeight:I.weight||null,fontStyle:I.style||null,fontVariant:I.variant!=="normal"&&I.variant||null,fill:I.color||null,baselineShift:I.baseline?100*I.baseline+"%":null,className:w.class||null},Ne&&(ue.dx=Wt(Ne),Ne=0),w.tracking&&(Ne=I.size*w.tracking),w.href&&!$e?($e=w.href,ie="a",ue.href=$e,ue.rel=w.rel,ue.target=w.target):$e=null,xe=I.id,Se=w.class)}if(se(),At)ne.push.apply(ne,hn($));else{var F=null,B=ge===Ee-1||De[De.length-1]instanceof he;U&&De.length>1&&!B&&(F=Wt((Pt-Be)/ve)),ne.push(tt.apply(void 0,["tspan",{wordSpacing:F,x:Ft(ge)+G,dy:Wt(ge?Zt:nn)+"em"}].concat(hn($))))}}else ne.push(tt("tspan",{x:Ft(ge),dy:Wt(ge?Zt:nn)+"em"},""))}}return tt.apply(void 0,["text",{fontFamily:Qe,fontSize:Me,textAnchor:Jn[at]||"start"}].concat(ne))}var Gn={middle:.5,center:.5,bottom:1,end:1};function is(q,Y,ne){if(q.length){ne.textBaseline="middle";var K=Y.font(),Me=K.height,Qe=K.size,at=Y.valign(),tt=Y.height()(),ct=Y.width()(0),yt=Y.align(),Mt=yt==="justify",Pt=.5*Me,At=Gn[at];if(At&&isFinite(tt)){var Ft=q.length*Me;Pt+=tt*At-Ft*At}q.forEach(function(Zt,nn){var H=Y.x()(nn),U=nn*Me+Pt,G=0,$=0;Zt.forEach(function(te){te.whitespace&&G++,$+=te.width});var ie=0,ue=nn===q.length-1||Zt[Zt.length-1]instanceof he;Mt&&Zt.length>1&&!ue&&(ie=(ct-$)/G),Zt.forEach(function(te){ne.font=te.font;var se=te.font,ge=se.baseline?Qe*-se.baseline+.15*Qe:0;ne.fillStyle=function(Se,Ne){return Se.color?Se.color:Ne.href?"#00C":"#000"}(se,te);var Ee=0;if(yt==="right"?Ee+=ct-$:yt==="center"?Ee+=ct/2-$/2:yt==="justify"&&(te.whitespace||te instanceof he)&&(H+=ie),ne.fillText(te.value,H+Ee,U+ge),te.href){ne.beginPath(),ne.strokeStyle=ne.fillStyle;var xe=Math.floor(U+.45*Qe)+.5;ne.moveTo(H+Ee,xe),ne.lineTo(H+Ee+te.width,xe),ne.stroke()}H+=te.width})})}}function Vn(q){return Vn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},Vn(q)}function An(q){for(var Y={},ne=0;ne<q.length;ne++){var K=q[ne];typeof K!="number"&&K!=null&&(typeof K=="string"?Y.text=K:typeof K=="function"?Y.fn=K:Vn(K)==="object"&&K._groups?Y.d3=K:K&&K.nodeType&&K.getContext?Y.ctx=K.getContext("2d"):K&&K.fillText&&K.beginPath?Y.ctx=K:K&&(Y.text=K))}return Y}function Yn(q){return Yn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},Yn(q)}function xn(q,Y){for(var ne=0;ne<Y.length;ne++){var K=Y[ne];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(q,(Me=function(Qe,at){if(Yn(Qe)!=="object"||Qe===null)return Qe;var tt=Qe[Symbol.toPrimitive];if(tt!==void 0){var ct=tt.call(Qe,at);if(Yn(ct)!=="object")return ct;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Qe)}(K.key,"string"),Yn(Me)==="symbol"?Me:String(Me)),K)}var Me}var fn=_(),Ht=function(q){return typeof q=="function"?q:function(){return q}},vt=function(){function q(K){if(function(Qe,at){if(!(Qe instanceof at))throw new TypeError("Cannot call a class as a function")}(this,q),this.props={overflow:"ellipsis",lineclamp:null,align:"left",wordBreak:null,valign:"top",width:function(){return 1/0},height:function(){return 1/0},x:function(){return 0},font:null,tAnchor:0,parser:q.defaultparser},K)for(var Me in K)typeof this[Me]=="function"&&this[Me](K[Me])}var Y,ne;return Y=q,ne=[{key:"linebreak",value:function(K){var Me=this,Qe=this.props.parser(String(K)),at=this.font(),tt=function(ct,yt,Mt){if(!ct.length)return[];var Pt=yt.height(),At=yt.width(),Ft=yt.overflowLine(),Zt=yt.overflowWrap(),nn=_(Mt,!0,!1),H=isFinite(Pt())?Math.floor(Pt()/Mt.height):1/0;if(!Pt()&&!At(0)||!H)return[];for(var U=0,G=0,$=0,ie=[],ue=[],te=!1;U<ct.length&&G<H;){var se=ct[U],ge=Nt(se,Mt);if(se.width=A(se,ge),se.font=ge,se.line=G,se.whitespace=se.value in y,se.value&&(se.value=se.value.replace(jt," ")),!(!$&&se.whitespace||te&&se.whitespace))if(se instanceof he)$=0,ue=[],ie.push(U+1),G++;else if(se instanceof Q||se instanceof fe)ue.push({index:U,width:$});else if(se.whitespace||$+se.width<At(G))$+=se.width;else if(ue.length){var Ee=void 0,xe=void 0;do{xe=!0,Ee=ue.pop();var Se=ct[Ee.index],Ne=void 0;Se instanceof fe&&(Ne=A("-",Se.font),Ee.width+Ne>At(G)&&(xe=!ue.length))}while(!xe);ie.push(Ee.index+1),$=0,G++,U=Ee.index,ue=[]}else if(Zt==="break-word"){var De=At(G);if($+se.width>De){var ve=se.clone();do se.value=se.value.slice(0,-1),se.width=A(se,se.font),$+=se.width;while(se.value&&se.width>De);ve.value=ve.value.slice(se.value.length),ct.splice(U+1,0,new Q,ve)}ie.push(U+1),$=0,G++}else $+=se.width;U++,te=se.whitespace}U!==ie[ie.length-1]&&ie.push(U);var Be=0,$e=0,je=ie.map(function(le){for(var ee,ye=Be;(ee=ct[ye])&&(ee.whitespace||!ee.value);)ye++;for(var Pe=le,Ve=null;Pe>ye&&(ee=ct[Pe-1])&&(ee.whitespace||!(ee.value||ee instanceof fe));)ee instanceof he&&(Ve=ee),Pe--;ee instanceof fe&&(ee.value="-",ee.width=A("-",ee.font)),Be=le;var rt=ct.slice(ye,Pe).filter(function(it){return it.value});return Ve&&rt.push(Ve),rt.width=rt.reduce(function(it,St){return it+St.width},0),rt.width>$e&&($e=rt.width),rt});if(je.hasLineOverflow=!1,Ft){var Ye=Ft==="ellipsis"?"":Ft;je.forEach(function(le,ee){var ye=At(ee);if(le.width>ye){var Pe=new re(Ye);Pe.font=Mt,Pe.width=A(Ye,nn),Gt(le,ye,Pe),je.hasLineOverflow=!0}})}var w=yt.overflow()==="ellipsis"?"":yt.overflow();if(w&&U!==ct.length){var I=At(je.length-1),F=je[je.length-1],B=new re(w);B.font=Mt,B.width=A(w,nn),Gt(F,I,B),je.hasOverflow=!0}else je.hasOverflow=!1;return je.font=Mt,je.width=$e,je}(Qe,this,at);return tt.height=tt.length*at.height,tt.render=function(ct){return Me.render(tt,ct)},tt.svg=tt.render,tt.draw=tt.render,tt}},{key:"font",value:function(K){return arguments.length?(this.props.font=_(K),this):this.props.font||_(fn)}},{key:"overflow",value:function(K){return arguments.length?(this.props.overflow=String(K),this):this.props.overflow}},{key:"overflowLine",value:function(K){return arguments.length?(this.props.lineclamp=String(K),this):this.props.lineclamp}},{key:"valign",value:function(K){return arguments.length?(this.props.valign=K,this):this.props.valign}},{key:"align",value:function(K){if(!arguments.length)return this.props.align;var Me=String(K).toLowerCase();return Me==="left"||Me==="start"?(this.props.align="left",this.props.tAnchor=0):Me==="center"||Me==="middle"?(this.props.align="center",this.props.tAnchor=-.5):Me==="end"||Me==="right"?(this.props.align="right",this.props.tAnchor=-1):Me==="justify"&&(this.props.align=K,this.props.tAnchor=0),this}},{key:"overflowWrap",value:function(K){if(!arguments.length)return this.props.overflowWrap||"normal";var Me=String(K).toLowerCase();return Me==="break-word"?this.props.overflowWrap="break-word":Me!=="normal"&&K!=null||(this.props.overflowWrap=null),this}},{key:"width",value:function(K){return arguments.length?(this.props.width=Ht(K),this):this.props.width}},{key:"height",value:function(K){return arguments.length?(this.props.height=Ht(K),this):this.props.height}},{key:"x",value:function(K){return arguments.length?(this.props.x=Ht(K),this):this.props.x}},{key:"parser",value:function(K){if(!arguments.length)return this.props.parser;if(typeof K=="string"){var Me=q[K]||q[K+"parser"];typeof Me=="function"&&(K=Me)}if(typeof K!="function")throw new Error("Unknown parser: "+K);return this.props.parser=K,this}},{key:"createElement",value:function(K){return arguments.length?(this.props.createElement=K,this):this.props.createElement||q.createElement}},{key:"render",value:function(){var K=An(arguments);return typeof K.text=="string"&&(K.text=this.linebreak(K.text)),K.ctx?is(K.text,this,K.ctx):Xn(K.text,this)}}],ne&&xn(Y.prototype,ne),Object.defineProperty(Y,"prototype",{writable:!1}),q}();function Pn(q){return Pn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},Pn(q)}function Zn(q,Y){(Y==null||Y>q.length)&&(Y=q.length);for(var ne=0,K=new Array(Y);ne<Y;ne++)K[ne]=q[ne];return K}function qt(q,Y){for(var ne=0;ne<Y.length;ne++){var K=Y[ne];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(q,(Me=function(Qe,at){if(Pn(Qe)!=="object"||Qe===null)return Qe;var tt=Qe[Symbol.toPrimitive];if(tt!==void 0){var ct=tt.call(Qe,at);if(Pn(ct)!=="object")return ct;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Qe)}(K.key,"string"),Pn(Me)==="symbol"?Me:String(Me)),K)}var Me}var cn=function(q){return typeof q=="function"?q:function(){return q}},on=function(){function q(K){if(function(Qe,at){if(!(Qe instanceof at))throw new TypeError("Cannot call a class as a function")}(this,q),this.props={width:function(){return 1/0},height:function(){return 1/0},rotation:0,vAnchor:0,hAnchor:0},K)for(var Me in K)typeof this[Me]=="function"&&this[Me](K[Me]);this.render=this.render.bind(this)}var Y,ne;return Y=q,ne=[{key:"anchor",value:function(K){var Me=this.props,Qe=Me.hAnchor,at=Me.vAnchor,tt=Me.width,ct=Me.height;if(!arguments.length)return[Qe*tt(0),at*ct(0)];if(typeof K=="string"){var yt=this.props;K.toLowerCase().trim().split(/\s+/).forEach(function(Mt){Mt==="top"&&(yt.vAnchor=-0),Mt==="middle"&&(yt.vAnchor=-.5),Mt==="bottom"&&(yt.vAnchor=-1),Mt==="left"&&(yt.hAnchor=-0),Mt==="center"&&(yt.hAnchor=-.5),Mt==="right"&&(yt.hAnchor=-1)})}return this}},{key:"width",value:function(K){return arguments.length?(this.props.width=cn(K),this):this.props.width}},{key:"height",value:function(K){return arguments.length?(this.props.height=cn(K),this):this.props.height}},{key:"rotate",value:function(K){return arguments.length?(this.props.rotation=K,this):this.props.rotation}},{key:"createElement",value:function(K){return arguments.length?(this.props.createElement=K,this):this.props.createElement||q.createElement}},{key:"canvas",value:function(K,Me){var Qe,at=K.getContext?K.getContext("2d"):K;return at.save(),at.rotate(this.rotate()*Math.PI/180),at.translate.apply(at,function(tt){if(Array.isArray(tt))return Zn(tt)}(Qe=this.anchor())||function(tt){if(typeof Symbol<"u"&&tt[Symbol.iterator]!=null||tt["@@iterator"]!=null)return Array.from(tt)}(Qe)||function(tt,ct){if(tt){if(typeof tt=="string")return Zn(tt,ct);var yt=Object.prototype.toString.call(tt).slice(8,-1);return yt==="Object"&&tt.constructor&&(yt=tt.constructor.name),yt==="Map"||yt==="Set"?Array.from(tt):yt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(yt)?Zn(tt,ct):void 0}}(Qe)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()),Me(at),at.restore(),at}},{key:"render",value:function(){var K=An(arguments);if(K.d3)return K.d3.attr("transform","rotate(".concat(this.rotate(),") translate(").concat(this.anchor(),")"));if(K.ctx)return this.canvas(K.ctx,K.fn);if(K.text){var Me=typeof K.text.render=="function"?K.text.render():K.text;return this.createElement()("g",{transform:"rotate(".concat(this.rotate(),") translate(").concat(this.anchor(),")")},Me)}}}],ne&&qt(Y.prototype,ne),Object.defineProperty(Y,"prototype",{writable:!1}),q}(),vn=Object.prototype.hasOwnProperty,wn={};function Rn(q){return wn[q]||(wn[q]=q.replace(/([a-z])([A-Z])/g,function(Y,ne,K){return ne+"-"+K.toLowerCase()})),wn[q]}function jn(q,Y){if(Array.isArray(Y))return Y.forEach(function(ne){return jn(q,ne)});typeof Y=="string"&&(Y=document.createTextNode(Y)),q.appendChild(Y)}function Bt(q,Y){if(typeof document<"u"){var ne=typeof q=="string"?document.createElementNS("http://www.w3.org/2000/svg",q):q;if(Y&&ne.setAttribute)for(var K in Y)vn.call(Y,K)&&Y[K]!=null&&ne.setAttribute(K==="className"?"class":Rn(K),Y[K]);for(var Me=arguments.length,Qe=new Array(Me>2?Me-2:0),at=2;at<Me;at++)Qe[at-2]=arguments[at];return Qe!=null&&Qe.length&&Qe.forEach(function(tt){jn(ne,tt)}),ne}}vt.createElement=Bt,vt.textparser=ze,vt.defaultparser=ze,vt.htmlparser=function(q){q=String(q||"").trim();for(var Y,ne,K={weight:null,style:null,sub:!1,sup:!1,href:null,color:null,rel:null,target:null},Me=[],Qe=[],at=function(Pt){for(var At in K)K[At]&&(Pt[At]=K[At]);Me.push(Pt)},tt=function(Pt){var At=Me.length,Ft=qe[Pt];if(At&&Ft){for(var Zt=At-1;Me[Zt]&&(Me[Zt]instanceof Q||We.test(Me[Zt].value));)Zt--;for(;Ft&&Me[Zt]&&Me[Zt]instanceof he;)Zt--,Ft--;for(;Ft-- >0;)Me.push(new he)}};q.length;){if(Y=/^[^<]+/.exec(q))ze(Ue(Y[0]),!1).forEach(at);else if(!(Y=ut.exec(q)))if(Y=st.exec(q))Qe.length&&(K=Qe.pop()),tt(Y[1]);else if(Y=ft.exec(q)){var ct=Y[1];tt(ct),Qe.push(K),K=Object.create(K),be[ct]&&be[ct](K,"");var yt=Oe(Y[2]);ct==="a"&&(yt.href&&(K.href=yt.href),yt.rel&&(K.rel=yt.rel),yt.target&&(K.target=yt.target)),yt.class&&(K.class=K.class?K.class+" "+yt.class:yt.class),yt.style&&(ne=/(?:^|\s|;)color\s*:\s*([^;\s"']+)/.exec(yt.style))&&ne[1]&&(K.color=ne[1]),ct==="br"&&Me.push(new he)}else Y=[q.slice(0,1)],at(new re(Y[0]));q=q.slice(Y[0].length)}for(var Mt=Me[Me.length-1];Mt instanceof he;)Me.pop(),Mt=Me[Me.length-1];return Me},vt.latexparser=function(q){q=String(q||"").trim();var Y=[0];q=q.replace(/\\verb,(.*?),/,function(H,U){return Y.push(U),"\\verb,"+(Y.length-1)+","}).replace(/\\\\\n/g,function(){return"\\\\"}).replace(Lt,function(H,U,G){return G.charAt(U-1)==="\\"?H:Tt[H]}).replace(/\n\s+/g,function(H){return/\n/.test(H.slice(1))?"\\par ":H}).replace(/\\symbol\{(\d+)\}/,function(H,U,G,$){return $.charAt(G-1)==="\\"?H:String.fromCharCode(1*U)}).replace(/(^|[^\\])(\^|_)(\d|[^{]\S*)/g,function(H,U,G,$){return U+G+"{"+$+"}"}).replace(/\\verb,(.*?),/,function(H,U){return"\\verb,".concat(Y[+U],",")});for(var ne,K={weight:null,italic:null,variant:null,sub:!1,sup:!1,href:null},Me=[],Qe=[],at=function(H){for(var U in K)K[U]&&(H[U]=K[U]);return Me.push(H),H},tt=function(){Qe.push(K),K=Object.create(K)},ct=function(){if(!Qe.length)throw new Error("Unexpected }");K=Qe.pop()},yt={tokens:Me,open_context:tt,close_context:ct,add_token:at};q.length;){if(ne=ht.exec(q))ze(ne[0],!1).forEach(at);else if(ne=wt.exec(q))at(new re(ne[1]));else if(!(ne=mt.exec(q))){if(ne=/^\{/.exec(q))tt();else if(ne=/^\}/.exec(q))ct();else if(!(ne=/^\$/.exec(q)))if(ne=/^\\verb,([^,]+),/.exec(q))at(new re(ne[1]));else if(ne=dt.exec(q)){var Mt=ne[1].slice(1)||ne[1],Pt=!!ne[2];if(/^(La)?TeX$/i.test(Mt)){tt(),K.family="serif";var At=void 0;Mt==="LaTeX"&&((At=at(new re("L"))).tracking=-.25,(At=at(new re("A"))).size=.7,At.baseline=.3,At.tracking=-.1),(At=at(new re("T"))).tracking=-.17,(At=at(new re("E"))).baseline=-.22,At.tracking=-.13,At=at(new re("X")),ct()}else if(Mt in Xe)at(new re(Xe[Mt])),Pt&&tt();else if(Mt in ot){var Ft=[],Zt=ot[Mt].length-1,nn=void 0;if(Zt){for(Pt=!1,q=q.slice(ne[0].length-1);Zt--;){if(!(nn=/^\{([^}]+)\}/.exec(q)))throw new Error(Mt+" is missing an argument");Ft.push(nn[1]),q=q.slice(nn[0].length)}ne[0]=/^\{/.exec(q)?"{":"",Pt=!!ne[0]}Pt&&tt(),ot[Mt].apply(yt,[K].concat(Ft))}else console.warn("unknown latex command",Mt),at(new re(ne[1])),Pt&&tt()}else ne=[q.slice(0,1)],at(new re(ne[0]))}q=q.slice(ne[0].length)}return Me},vt.measureText=function(q,Y,ne){return A(q,_(Y),ne)},vt.Token=re,vt.Break=Q,vt.LineBreak=he,vt.SoftHyphen=fe,vt.Rotator=on,on.createElement=Bt;const os=vt;return s.default})())}(dy)),dy.exports}var kH=IH();const YA=jL(kH);function Dm(e){return e.replace(/$/,"")}function Om(e){return e.children[0].innerHTML}function MH(e,t){const n=Oi(e),{fontSize:s,font:r,padding:i=0}=e.properties.style||{};if(n.width===n.height&&n.width===0)return;const o=new YA({font:`${s}px/${s}px ${r}`.replace(/(px)+/g,"px"),width:n.width-i*2,height:n.height-i*2,align:"left",valign:"top",x:0,overflow:"ellipsis",parser:"html",createElement:YA.createElement});o.overflowWrap("break-word");const a=o.linebreak(e.properties.content.replaceAll(`
`,"<br>")).render(),u=[...a.children];let d=0;const c=[];e.properties.content.split(`
`).forEach(p=>{let _=p;for(;_.length&&d<u.length;){if(u[d].innerHTML==="&nbsp;"){_.startsWith(`
`)||c.push(d),d++;break}const y=Dm(Om(u[d]));_.startsWith(y)&&(_=_.slice(y.length).trim()),d++}}),c.forEach(p=>a.removeChild(u[p]));const g=e.properties.content.match(/(https?:\/\/.*)/gm),f=g?g.map(p=>p.split(" ")[0]):[];a.setAttribute("transform",`translate(${i}, ${i})`),f.forEach(p=>{let _=p;const y=[];for(;_.length>0;){const x=u.find(b=>!!b.children[0]&&b.children[0].tagName==="tspan"&&_.startsWith(Dm(Om(b))));if(!x)break;y.push(x);const E=Dm(x.children[0].innerHTML).length;if(!E)break;_=_.slice(E)}y.forEach(x=>{const E=document.createElementNS("http://www.w3.org/2000/svg","a");E.setAttribute("href",p),E.setAttribute("target","_blank"),E.innerHTML=Om(x),x.children[0].innerHTML="",x.children[0].appendChild(E)})}),t.appendChild(a)}const ZA=20;class PH extends qL{constructor(t,n={}){super(t,`
    <div class="annotation-text-handle" data-handle-id="8">
      <span class="handle line-handle top" data-handle-id="0"></span>
      <span class="handle line-handle bottom" data-handle-id="1"></span>
      <span class="handle line-handle left" data-handle-id="2"></span>
      <span class="handle line-handle right" data-handle-id="3"></span>
      <span class="handle top right point-handle top-right" data-handle-id="4"></span>
      <span class="handle left top point-handle top-left" data-handle-id="5"></span>
      <span class="handle bottom right point-handle bottom-right" data-handle-id="6"></span>
      <span class="handle left bottom left-handle point-handle bottom-left" data-handle-id="7"></span>
      <textarea wrap="on"></textarea>
    </div>
  `),lt(this,"textArea"),lt(this,"handleSize"),lt(this,"rect",{x:0,y:0,width:0,height:0}),lt(this,"annotation",{...Fm}),lt(this,"startX",0),lt(this,"startY",0),lt(this,"handles",[]),lt(this,"draggedHandle",ds),lt(this,"isFocused",!1),lt(this,"placeholder","Type your text here..."),lt(this,"_onFocus",()=>{this.textArea.value===this.placeholder&&(this.textArea.value=""),this.isFocused=!0}),lt(this,"_onBlur",()=>{this.isFocused=!1}),lt(this,"startDrawing",(r,i,o=$L(r,i,0,0,"",Nl))=>{this.add(o);const a=this.ogma.view.graphToScreenCoordinates({x:r,y:i});this.select(o.id),this.startDragging(this.getById(o.id),a.x,a.y),this.draggedHandle=6}),lt(this,"cancelDrawing",()=>{this.isDragging&&(this.remove(this.annotation.id),this.annotation={...Fm},this.draggedHandle=ds,this.isDragging=!1,this.emit(Vl,this.annotation))}),lt(this,"startDragging",(r,i,o)=>{this.annotation=r;const a=Ri(this.annotation),u=Oi(this.annotation);this.rect.x=a.x,this.rect.y=a.y,this.rect.width=u.width,this.rect.height=u.height,this.startX=i,this.startY=o,this.disableDragging(),this.textArea.classList.add("noevents"),this.textArea.setAttribute("disabled","disabled"),this.emit(Og,this.annotation),this.isDragging=!0}),lt(this,"onHandleMouseDown",r=>{const i=this.getById(this.selectedId)||this.getById(this.hoveredId);if(!i)return;this.selectedId!==i.id&&this.select(this.hoveredId);const{x:o,y:a}=ry(r,this.ogma.getContainer());this.startDragging(i,o,a),this.draggedHandle=zL(r.target)}),lt(this,"onMouseMove",r=>{requestAnimationFrame(()=>this._onMouseMove(r))}),lt(this,"_onMouseMove",r=>{if(!this.isDragging)return;r.stopPropagation(),r.preventDefault();const i=this.handles[this.draggedHandle];let o=i.classList.contains("top");const a=i.classList.contains("left"),u=i.classList.contains("right"),d=i.classList.contains("bottom");let c=i.classList.contains("line-handle");!c&&!o&&!d&&!a&&!u&&(o=!0,c=!0);const{x:g,y:f}=ry(r,this.ogma.getContainer());let p=this.rect.x,_=this.rect.y,y=Math.max(this.rect.width,ZA),x=Math.max(this.rect.height,ZA);const E=this.ogma.view.getZoom(),b=(g-this.startX)/E,S=(f-this.startY)/E,A=this.ogma.view.getAngle(),C=fr({x:b,y:S},A),k=fr({x:b,y:S},-A);c?(p=this.rect.x+C.x,_=this.rect.y+C.y):a&&o?(p+=C.x,_+=C.y,y-=b,x-=S):u&&d?(y+=b,x+=S):a&&d?(p+=k.x,y-=k.x,x+=k.y):u&&o&&(_+=k.y,y+=k.x,x-=k.y),hH(this.annotation,p,_,y,x),this.emit(Dg,this.annotation,"text"),this.refreshEditor(),this.layer.refresh()}),lt(this,"onMouseUp",()=>{!this.isDragging||this.draggedHandle===ds||(this.restoreDragging(),this.textArea.classList.remove("noevents"),this.textArea.removeAttribute("disabled"),this.emit(Vl,this.annotation),this.isDragging=!1,this.draggedHandle=ds)}),lt(this,"_onMousedown",r=>{r.stopPropagation()}),lt(this,"onViewChanged",()=>{const r=Math.max(2,this.handleSize/this.ogma.view.getZoom());document.documentElement.style.setProperty("--handle-scale",`${1/r}`),this.ogma.view.getAngle()===0?this.editor.element.classList.remove("rotated"):this.editor.element.classList.add("rotated")}),lt(this,"_onInput",()=>{const r=this.getById(this.selectedId);r&&(this.textArea.value=this.textArea.value.replace(/ +(?= )/g,""),this.textArea.focus(),r.properties.content=this.textArea.value,this.emit(uy,r),this.layer.refresh())}),this.showeditorOnHover=!1,this.handleSize=WA.handleSize,this.placeholder=WA.placeholder;const s=this.textArea=this.editor.element.querySelector("textarea");s.addEventListener("input",this._onInput),s.addEventListener("focus",this._onFocus),s.addEventListener("blur",this._onBlur),s.addEventListener("mousedown",this._onMousedown),s.spellcheck=!1,this.handles=Array.prototype.slice.call(this.editor.element.querySelectorAll(".annotation-text-handle > .handle")),this.handles.push(this.editor.element),this.handles.forEach(r=>r.addEventListener("mousedown",this.onHandleMouseDown)),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousemove",this.onMouseMove,!0),t.events.on(["viewChanged","zoom"],this.onViewChanged)}_canRemove(){return!this.isFocused}detect({x:t,y:n},s=0){const r={x:t,y:n},i=this.ogma.view.getAngle();return this.elements.find(o=>{const{x:a,y:u}=Ri(o),{width:d,height:c}=Oi(o),g={x:a,y:u},{x:f,y:p}=fr(va(r,g),-i);return f>-s&&f<d+s&&p>-s&&p<c+s})}draw(t){t.innerHTML="";const n="",s=this.ogma.view.getAngle();for(let i=0;i<this.elements.length;i++){const o=this.elements[i],a=`class${i}`,u=Oi(o),d=Ri(o);if(o.id===this.selectedId)continue;const{color:c,fontSize:g,font:f,strokeColor:p,strokeWidth:_,strokeType:y,background:x,borderRadius:E}=o.properties.style||Nl,b=xa("g");b.classList.add("annotation-text"),b.setAttribute("fill",`${c}`),b.setAttribute("font-size",`${g}px`),b.setAttribute("font-family",`${f}`);const S=xa("rect");E&&(S.setAttribute("rx",`${E}`),S.setAttribute("ry",`${E}`));let A=!1;y&&y!=="none"&&(A=!0,S.setAttribute("stroke",p||"black"),S.setAttribute("stroke-width",`${_}`),y==="dashed"&&S.setAttribute("stroke-dasharray","5,5")),(x&&x.length||A)&&(A=!0,S.setAttribute("fill",x||"transparent")),A&&(S.setAttribute("width",`${u.width}`),S.setAttribute("height",`${u.height}`)),b.appendChild(S),MH(o,b);const{x:C,y:k}=fr(d,-s);b.setAttribute("transform",`translate(${C},${k})`),b.classList.add(a),b.setAttribute("data-annotation",`${o.id}`),b.setAttribute("data-annotation-type","text"),t.appendChild(b)}const r=xa("style");r.innerHTML=n,t.firstChild&&t.insertBefore(r,t.firstChild)}refreshDrawing(){const t=this.ogma.view.getAngle(),n=this.layer.element.children;for(let s=0;s<n.length;s++){const r=n[s];if(!r.hasAttribute("data-annotation"))continue;const i=r.getAttribute("data-annotation"),o=Ri(this.getById(i)),{x:a,y:u}=fr(o,-t);r.setAttribute("transform",`translate(${a},${u})`)}}getDefaultOptions(){return Fm}refreshEditor(){if(+this.selectedId<0&&+this.hoveredId<0)return;const t=this.getById(this.selectedId)||this.getById(this.hoveredId),n=Oi(t),s=this.ogma.view.graphToScreenCoordinates(Ri(t)),r=this.ogma.view.getZoom(),{font:i,fontSize:o,color:a,background:u,padding:d=0}=t.properties.style||Nl,c=(o||1)*r;this.textArea.value=t.properties.content;const g=this.editor.element.style;g.transform=`translate(${s.x}px, ${s.y}px)translate(-50%, -50%)translate(${n.width/2*r}px, ${n.height/2*r}px)`,g.width=`${n.width*r}px`,g.height=`${n.height*r}px`;const f=this.textArea.style;f.font=`${c} ${i}`,f.fontFamily=i||"sans-serif",f.fontSize=`${c}px`,f.padding=`${r*d}px`,f.lineHeight=`${c}px`,f.boxSizing="border-box",f.color=a||"black",f.background=u||"transparent",this.textArea.placeholder=this.placeholder,this.layer.refresh()}select(t){super.select(t),this.textArea.classList.add("noevents")}destroy(){super.destroy(),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove,!0),this.ogma.events.off(this.onViewChanged)}}class RH{constructor(){lt(this,"links",{}),lt(this,"linksByTargetId",{}),lt(this,"linksByArrowId",{})}add(t,n,s,r,i){const o=pf(),a=t.id,u={id:o,arrow:a,target:s,targetType:r,connectionPoint:i,side:n};return this.links[o]=u,this.linksByTargetId[s]||(this.linksByTargetId[s]=[]),this.linksByTargetId[s].push(o),this.linksByArrowId[a]||(this.linksByArrowId[a]={}),this.linksByArrowId[a][n]=o,t.properties.link=t.properties.link||{},t.properties.link[n]={id:s,side:n,type:r,magnet:i},this}arrowIsLinked(t,n){var s;return!!((s=this.linksByArrowId[t])!=null&&s[n])}remove(t,n){var s,r;const i=t.id,o=(s=this.linksByArrowId[i])==null?void 0:s[n];if((r=t.properties.link)==null||delete r[n],!o)return this;const a=this.links[o];delete this.links[o];const u=this.linksByTargetId[a.target];for(let d=0;d<u.length;d++)if(u[d]===o){u.splice(d,1);break}return delete this.linksByArrowId[i][n],this}getArrowLink(t,n){var s;const r=(s=this.linksByArrowId[t])==null?void 0:s[n];return r?this.links[r]:null}getTargetLinks(t,n){var s;return((s=this.linksByTargetId[t])==null?void 0:s.map(r=>this.links[r]).filter(r=>r.targetType===n))??[]}forEach(t){Object.values(this.links).forEach(t)}}const sr=e=>e.properties.type==="arrow",jr=e=>e.properties.type==="text",KA=e=>e.type==="FeatureCollection",FH={magnetColor:"#3e8",detectMargin:20,magnetHandleRadius:5,magnetRadius:10,textPlaceholder:"Type here",arrowHandleSize:3.5,textHandleSize:3.5,minArrowHeight:20,maxArrowHeight:30},QA=["start","end"],JA=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:0,y:.5},{x:1,y:.5},{x:0,y:1},{x:.5,y:1},{x:1,y:1}];class DH extends HL{constructor(t,n={}){super(),lt(this,"arrows"),lt(this,"texts"),lt(this,"links",new RH),lt(this,"layer"),lt(this,"annotations"),lt(this,"ogma"),lt(this,"options"),lt(this,"selected",null),lt(this,"updateTimeout",0),lt(this,"hoveredNode",null),lt(this,"dragged",null),lt(this,"textToMagnet"),lt(this,"activeLinks",[]),lt(this,"_render",s=>{if(!this.dragged||this.textToMagnet===void 0)return;s.beginPath(),s.fillStyle="green";const r=this.ogma.view.getZoom();JA.forEach(i=>{if(!this.textToMagnet)return;const o=Oi(this.textToMagnet),a=Ri(this.textToMagnet),u=jc(i,{x:o.width,y:o.height}),d=fr(u,this.ogma.view.getAngle()),{x:c,y:g}=Al(d,a);s.moveTo(c,g),s.arc(c,g,this.options.magnetHandleRadius/r,0,Math.PI*2)}),s.fill(),s.closePath()}),lt(this,"_onFeatureDrag",(s,r)=>{const i=r;if(sr(s)&&i==="line")["start","end"].find(o=>{const a=o==="start"?dd(s):Rg(s);return this._snapToText(s,i,a)||this._findAndSnapToNode(s,o,a)});else if(sr(s)&&i!=="line"){const o=i==="start"?dd(s):Rg(s);this._snapToText(s,i,o)||this._findAndSnapToNode(s,i,o)}else jr(s)&&(this.activeLinks.forEach(({arrow:o,side:a,connectionPoint:u})=>{const d=this.getAnnotation(o),c=Oi(s),g=Ri(s),f=jc(u,{x:c.width,y:c.height}),p=fr(f,this.ogma.view.getAngle()),_=Al(p,g);d.geometry.coordinates[a==="start"?0:1]=[_.x,_.y]}),this.activeLinks.length&&this.arrows.refreshLayer());this.layer.refresh(),this.emit(Dg,s,r)}),lt(this,"_onFeatureDragEnd",s=>{this.dragged!==null&&sr(s)&&dd(this.dragged)&&QA.forEach(r=>{this.links.getArrowLink(s.id,r)&&this.emit(wH,{arrow:s,link:this.links.getArrowLink(s.id,r)})}),(jr(s)||sr(s))&&this.onUpdate(s),this.dragged=null,this.activeLinks=[],this.textToMagnet=void 0,this.annotations.forEach(r=>r.enableDetection()),this.layer.refresh(),this.emit(Vl,s)}),lt(this,"_onFeatureDragStart",s=>{this.textToMagnet=void 0,sr(s)?this.dragged=s:jr(s)&&this.activeLinks.push(...this.links.getTargetLinks(s.id,"text")),this.annotations.forEach(r=>{const i=r.getSelectedFeature();i&&i!==s&&r.unhover().unselect(),r.disableDetection()}),this.emit(Og,s)}),lt(this,"_onNodesDragStart",()=>{this.arrows.unhover().unselect(),this.texts.unhover().unselect()}),lt(this,"_onNodesDrag",s=>{const{dx:r,dy:i}=s;this._moveNodes(s.nodes,r,i)}),lt(this,"_onLayoutEnd",s=>{s.ids.forEach((r,i)=>{this.links.getTargetLinks(r,"node").forEach(o=>{const a=this.getAnnotation(o.arrow),u=o.side,d=Gc(a,u==="start"?"end":"start"),c=s.positions.current[i],g=this.ogma.getNode(r).getAttribute("radius"),f=Vc(d,c,+g);dl(a,u,f.x,f.y)})}),this.arrows.refreshLayer(),this.texts.refreshLayer()}),lt(this,"_onAdded",s=>{this.emit(ly,s)}),lt(this,"_onRemoved",s=>{this.emit(ay,s)}),lt(this,"_onUnselect",s=>{this.selected=null,this.emit(oy,s)}),lt(this,"_onSelect",s=>{this.selected!==s&&(this.selected=s,this.emit(iy,this.selected))}),lt(this,"onUpdate",s=>{cancelAnimationFrame(this.updateTimeout),this.updateTimeout=requestAnimationFrame(()=>this._onUpdate(s))}),lt(this,"_onUpdate",s=>{this.emit(uy,s)}),this.options=this.setOptions({...FH,...n}),this.ogma=t,this.arrows=new LH(t,this.options),this.texts=new PH(t,this.options),this.annotations=[this.arrows,this.texts],this.annotations.forEach(s=>{s.on(Og,this._onFeatureDragStart).on(Dg,this._onFeatureDrag).on(Vl,this._onFeatureDragEnd).on(uy,this.onUpdate).on(oy,this._onUnselect).on(iy,this._onSelect).on(ly,this._onAdded).on(ay,this._onRemoved)}),this.ogma.events.on("nodesDragStart",this._onNodesDragStart).on("nodesDragProgress",this._onNodesDrag).on("layoutEnd",this._onLayoutEnd).on(["viewChanged","rotate"],()=>{this.refreshTextLinks()}),this.layer=t.layers.addCanvasLayer(this._render),this.layer.moveToBottom()}_moveNodes(t,n,s){t.forEach(r=>{const i=this.links.getTargetLinks(r.getId(),"node"),o=r.getPosition();i.forEach(a=>{const u=this.getAnnotation(a.arrow),d=a.side,c=Gc(u,d==="start"?"end":"start");let g=o;const f=+r.getAttribute("radius"),p=1e-6;(a.connectionPoint.x-(o.x-n)>p||a.connectionPoint.y-(o.y-s)>p)&&(g=Vc(c,o,f)),dl(u,d,g.x,g.y)})}),this.arrows.refreshLayer()}_snapToText(t,n,s){const r=this.texts.detect(s,this.options.detectMargin);if(this.links.remove(t,n),!r)return!1;this.textToMagnet=r;const i=this.findMagnetPoint(JA,r,s);return i?(dl(t,n,i.point.x,i.point.y),this.links.add(t,n,r.id,"text",i.magnet),!0):!1}_findAndSnapToNode(t,n,s){var r,i;const o=this.ogma.view.graphToScreenCoordinates(s),a=this.ogma.view.getElementAt(o);this.links.remove(t,n),a&&a.isNode?((r=this.hoveredNode)==null||r.setSelected(!1),this.hoveredNode=a,a.setSelected(!0),this._snapToNode(t,n,a,o)):((i=this.hoveredNode)==null||i.setSelected(!1),this.hoveredNode=null)}_snapToNode(t,n,s,r){const i=s.getPositionOnScreen(),o=+s.getAttribute("radius"),a=o*this.ogma.view.getZoom(),u=r.x-i.x,d=r.y-i.y,c=Math.sqrt(u*u+d*d),g=s.getPosition();if(c<a+this.options.detectMargin){let f=g;if(c>a/2){const p=Gc(t,n==="end"?"start":"end");f=Vc(p,f,o)}dl(t,n,f.x,f.y),this.links.add(t,n,s.getId(),"node",f)}}refreshTextLinks(){let t=!1;this.links.forEach(({connectionPoint:n,targetType:s,target:r,arrow:i,side:o})=>{if(s!=="text")return;t=!0;const a=this.getAnnotation(r),u=this.getAnnotation(i),d=Oi(a),c=Ri(a),g=jc(n,{x:d.width,y:d.height}),f=fr(g,this.ogma.view.getAngle()),p=Al(f,c);dl(u,o,p.x,p.y)}),t&&this.arrows.refreshLayer()}getSelected(){return this.selected}findMagnetPoint(t,n,s){let r;for(const i of t){const o=Oi(n),a=Ri(n),u=jc(i,{x:o.width,y:o.height}),d=fr(u,this.ogma.view.getAngle()),c=Al(d,a),g=Ll(va(c,s)),f=Math.min(this.options.magnetRadius*this.ogma.view.getZoom(),o.width/2,o.height/2);if(g<Math.max(f,this.options.magnetHandleRadius)){r={point:c,magnet:i};break}}return r}setOptions(t={}){return this.options={...this.options||{},...t},this.options}select(t){const n=this.getAnnotations().features.find(s=>s.id===t);return n?(sr(n)?this.arrows.select(n.id):jr(n)&&this.texts.select(n.id),this):this}unselect(){return this.selected?(sr(this.selected)?this.arrows.unselect():jr(this.selected)&&this.texts.unselect(),this):this}add(t){if(KA(t)){const[n,s]=t.features.reduce((r,i)=>(sr(i)?r[1].push(i):jr(i)&&r[0].push(i),r),[[],[]]);return n.forEach(r=>this.add(r)),s.forEach(r=>this.add(r)),this.arrows.refreshLayer(),this}switch(t.properties.type){case"text":this.texts.add(t);break;default:this.arrows.add(t),this.loadLink(t);break}return this}remove(t){return KA(t)?(t.features.forEach(n=>this.remove(n)),this):(sr(t)?(this.links.remove(t,"start"),this.links.remove(t,"end"),this.arrows.remove(t.id)):this.texts.remove(t.id),this)}loadLink(t){if(t.properties.link)for(const n of QA){const s=t.properties.link[n];if(!s)continue;const r=this.getAnnotation(s.id);if(s.type==="text"&&r)this.links.add(t,n,s.id,s.type,s.magnet);else if(s.type==="node"){const i=this.ogma.getNode(s.id);if(!i)continue;this.links.add(t,n,s.id,s.type,s.magnet);const o=i.getPosition(),a=i.getAttribute("radius")||0,u=Gc(t,n==="start"?"end":"start"),d=Vc(u,o,+a);dl(t,n,d.x,d.y)}}}startArrow(t,n,s){this.cancelDrawing(),this.arrows.startDrawing(t,n,s)}startText(t,n,s){this.cancelDrawing(),this.texts.startDrawing(t,n,s)}cancelDrawing(){this.annotations.forEach(t=>t.cancelDrawing()),this.emit(AH)}updateStyle(t,n){const s=this.getAnnotations().features.find(r=>r.id===t);return s?(sr(s)?this.arrows.updateStyle(s,n):jr(s)&&this.texts.updateStyle(s,n),this.onUpdate(s),this):this}setScale(t,n,s,r){const i=this.getAnnotations().features.find(o=>o.id===t);return i?(sr(i)?this.arrows.scale(i,n,s,r):jr(i)&&this.texts.scale(i,n,s,r),this.onUpdate(i),this):this}getAnnotations(){const t={type:"FeatureCollection",features:[]};return this.annotations.forEach(n=>{t.features=[...t.features,...n.getElements()]}),t}getAnnotation(t){return this.getAnnotations().features.find(n=>n.id===t)}destroy(){this.annotations.forEach(t=>t.destroy()),this.layer.destroy()}}const hy=[8,10,12,14,16,24,32,48,64,72],ew="none",WL="#333333",zm=["#FFFFFF","#F44E3B","#FE9200","#FCDC00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#1E88E5","#333333","#808080","#cccccc"],OH=["Roboto","Helvetica Neue","Helvetica","Arial","sans-serif","Georgia, serif","Menlo","Monaco","Consolas","Courier New","monospace"].sort((e,t)=>e.toLocaleLowerCase().localeCompare(t.toLocaleLowerCase())),zg={head:"arrow",strokeColor:WL,strokeWidth:5},zH=.25,Bg={font:"Roboto",fontSize:hy[2],padding:hy[2]*zH,color:WL,strokeType:ew,background:ew};function BH(e){return e.reduce((t,n)=>t+n,0)/e.length}function tw(e,t=0,n=1){return t+(n-t)*e}function nw(e,t=0,n=1){return(e-t)/(n-t)}const XL=Ge.createContext(void 0),mf=()=>Ge.useContext(XL),UH=(e,t)=>{switch(t.type){case"add":return{...e,features:[...e.features,t.payload]};case"remove":return{...e,features:e.features.filter(n=>n.id!==t.payload.id)};case"update":return{...e,features:e.features.map(n=>n.id===t.payload.id?t.payload:n)};default:return e}},GH=({children:e})=>{const t=zs(),[n,s]=Ge.useReducer(UH,{type:"FeatureCollection",features:[]}),[r,i]=Ge.useState(null),[o,a]=Ge.useState(zg),[u,d]=Ge.useState(Bg),[c,g]=Ge.useState(),[f,p]=Ge.useState(1),[_,y]=Ge.useState(1);return Ge.useEffect(()=>{if(!t)return;const x=new DH(t,{minArrowHeight:1}),E=BH(t.getNodes().getAttribute("radius"))/5,b=f;return a({...o,strokeWidth:(o.strokeWidth||1)*b}),p(b),y(E),x.on("select",S=>{sr(S)?a({...S.properties.style||{}}):jr(S)&&d({...S.properties.style||{}}),i(S)}).on("unselect",()=>{i(null)}),g(x),()=>{c==null||c.destroy()}},[t]),Ge.useEffect(()=>{c&&r&&(r==null?void 0:r.properties.type)==="arrow"&&c.updateStyle(r.id,o)},[c,o,r]),Ge.useEffect(()=>{c&&r&&(r==null?void 0:r.properties.type)==="text"&&c.updateStyle(r.id,u)},[c,u,r]),Ct.jsx(XL.Provider,{value:{annotations:n,updateAnnotations:s,currentAnnotation:r,setCurrentAnnotation:i,textStyle:u,setTextStyle:d,arrowStyle:o,setArrowStyle:a,arrowWidthFactor:f,setArrowWidthFactor:p,textSizeFactor:_,setTextSizeFactor:y,editor:c,setEditor:g},children:e})},Mx=Bi.createContext({});var VH=Object.defineProperty,sw=Object.getOwnPropertySymbols,jH=Object.prototype.hasOwnProperty,HH=Object.prototype.propertyIsEnumerable,rw=(e,t,n)=>t in e?VH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Bm=(e,t)=>{for(var n in t||(t={}))jH.call(t,n)&&rw(e,n,t[n]);if(sw)for(var n of sw(t))HH.call(t,n)&&rw(e,n,t[n]);return e};const qH=(e,t)=>{const n=Ge.useContext(Mx),s=Bm(Bm({},n),e);return Ge.createElement("svg",Bm({width:"1.5em",height:"1.5em",viewBox:"0 0 24 24",strokeWidth:1.5,fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"currentColor",ref:t},s),Ge.createElement("path",{d:"M3 12L21 12M21 12L12.5 3.5M21 12L12.5 20.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}))},$H=Ge.forwardRef(qH);var WH=$H,XH=Object.defineProperty,iw=Object.getOwnPropertySymbols,YH=Object.prototype.hasOwnProperty,ZH=Object.prototype.propertyIsEnumerable,ow=(e,t,n)=>t in e?XH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Um=(e,t)=>{for(var n in t||(t={}))YH.call(t,n)&&ow(e,n,t[n]);if(iw)for(var n of iw(t))ZH.call(t,n)&&ow(e,n,t[n]);return e};const KH=(e,t)=>{const n=Ge.useContext(Mx),s=Um(Um({},n),e);return Ge.createElement("svg",Um({width:"1.5em",height:"1.5em",strokeWidth:1.5,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"currentColor",ref:t},s),Ge.createElement("path",{d:"M6 20L18 20",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),Ge.createElement("path",{d:"M12 4V16M12 16L15.5 12.5M12 16L8.5 12.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}))},QH=Ge.forwardRef(KH);var JH=QH,eq=Object.defineProperty,aw=Object.getOwnPropertySymbols,tq=Object.prototype.hasOwnProperty,nq=Object.prototype.propertyIsEnumerable,lw=(e,t,n)=>t in e?eq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Gm=(e,t)=>{for(var n in t||(t={}))tq.call(t,n)&&lw(e,n,t[n]);if(aw)for(var n of aw(t))nq.call(t,n)&&lw(e,n,t[n]);return e};const sq=(e,t)=>{const n=Ge.useContext(Mx),s=Gm(Gm({},n),e);return Ge.createElement("svg",Gm({width:"1.5em",height:"1.5em",strokeWidth:1.5,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"currentColor",ref:t},s),Ge.createElement("path",{d:"M19 7V5L5 5V7",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),Ge.createElement("path",{d:"M12 5L12 19M12 19H10M12 19H14",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}))},rq=Ge.forwardRef(sq);var iq=rq;const oq=()=>{const{editor:e}=mf(),t=zs(),n=Bi.useCallback(i=>{const o=t.getOptions();t.setOptions({cursor:{default:"crosshair"}}),t.events.once("mousedown",a=>{const{x:u,y:d}=t.view.screenToGraphCoordinates(a),c=i==="arrow"?RL(u,d,u,d,{...zg}):$L(u,d,0,0,"...",{...Bg});setTimeout(()=>{sr(c)&&e.startArrow(u,d,c),jr(c)&&e.startText(u,d,c)},50),e.once("add",()=>{t.setOptions(o)})})},[zg,Bg,e,t]);function s(){const i=document.createElement("a");i.href=URL.createObjectURL(new Blob([JSON.stringify(e.getAnnotations())],{type:"text/plain"})),i.download="annotations.json",i.click()}const r=16;return Ct.jsxs("div",{className:"add-menu",children:[Ct.jsx("button",{"data-tooltip":"Add arrow",onClick:()=>n("arrow"),children:Ct.jsx(WH,{width:r,height:r})}),Ct.jsx("button",{"data-tooltip":"Add text",onClick:()=>n("text"),children:Ct.jsx(iq,{width:r,height:r})}),Ct.jsx("button",{"data-tooltip":"Download",onClick:()=>s(),children:Ct.jsx(JH,{width:r,height:r})})]})},aq=({children:e})=>Ct.jsx("div",{className:"button-group",children:e}),lq=()=>Ct.jsx("svg",{width:"1.5em",height:"1.5em",strokeWidth:"1.5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"currentColor",fr:"",children:Ct.jsx("path",{d:"M6 12h12",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})}),uq=()=>Ct.jsx("svg",{width:"1.5em",height:"1.5em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"#000000",children:Ct.jsx("path",{d:"M9 12h13m0 0l-3-3m3 3l-3 3",transform:"translate(-3 0)",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),dq=()=>Ct.jsx("svg",{width:"1.5em",height:"1.5em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"#000000",children:Ct.jsx("path",{d:"M 9 12 h 12 m 2 0 l -3 -3 m 3 3 l -3 3 m -10 -6 l -3 3 m 0 0 l 3 3",transform:"translate(-3,0)",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),cy=({color:e,setColor:t,hasTransparent:n})=>{const[s,r]=Bi.useState(zm);Bi.useEffect(()=>{r(n?["none",...zm.slice(0,-1)]:[...zm])},[n]);const[i,o]=Bi.useState(e);return Ct.jsx("span",{className:"colorpicker",children:s.map(a=>Ct.jsx("div",{className:a===i?"selected":"",style:{width:12,height:12,borderRadius:10,backgroundColor:a==="none"?"#fff":a,margin:5,cursor:"pointer"},onClick:()=>{o(a),t&&t(a)}},a))})},hq=({min:e,max:t,step:n=1,initialValue:s=e,onChange:r})=>{const[i,o]=Ge.useState(s),a=Ge.useRef(null),u=Ge.useRef(null);Ge.useEffect(()=>{f(i)},[i]);const d=p=>{p.preventDefault(),document.addEventListener("mousemove",c),document.addEventListener("mouseup",g)},c=p=>{if(a.current){const _=a.current.getBoundingClientRect();let y=Math.min(Math.max(e,(p.clientX-_.left)/_.width*(t-e)+e),t);const x=y%n;x!==0&&(x<n/2?y-=x:y+=n-x),o(y),r(y)}},g=()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",g)},f=p=>{if(a.current&&u.current){const _=(p-e)/(t-e)*100;u.current.style.left=`calc(${_}% - ${u.current.offsetWidth/2}px)`}};return Ct.jsxs("div",{className:"slider-container",ref:a,children:[Ct.jsx("div",{className:"slider-track"}),Ct.jsx("div",{className:"slider-knob",ref:u,onMouseDown:d,children:Math.round(i)})]})},cq=({minThickness:e,maxThickness:t})=>{const{arrowStyle:n,setArrowStyle:s}=mf();function r(a){const u={head:"none",tail:"none"};a==="one"&&(u.head="arrow"),a==="both"&&(u.head="arrow",u.tail="arrow"),s({...n,...u})}function i(a){const u=tw(nw(a,0,100),e,t);s({...n,strokeWidth:u})}function o(a){s({...n,strokeColor:a})}return Ct.jsxs("span",{className:"settings-panel",children:[Ct.jsx("h4",{children:"Shape"}),Ct.jsxs(aq,{children:[Ct.jsx("button",{"data-tooltip":"Undirected",onClick:()=>r("none"),children:Ct.jsx(lq,{})}),Ct.jsx("button",{"data-tooltip":"Arrow",onClick:()=>r("one"),children:Ct.jsx(uq,{})}),Ct.jsx("button",{"data-tooltip":"Bidirectional",onClick:()=>r("both"),children:Ct.jsx(dq,{})})]}),Ct.jsx("h4",{children:"Color"}),Ct.jsx(cy,{color:n.strokeColor,setColor:a=>o(a)}),Ct.jsx("h4",{children:"Thickness"}),Ct.jsx(hq,{min:0,max:100,onChange:a=>i(a),initialValue:Math.floor(tw(nw(n.strokeWidth||0,e,t),0,100))})]})},gq=OH.map(e=>({value:e,label:e})),fq=hy.map(e=>({value:`${e}`,label:e})),pq=()=>{var o;const{textStyle:e,setTextStyle:t}=mf();function n(a){t({...e,font:a})}function s(a){t({...e,fontSize:parseFloat(a)})}function r(a){t({...e,background:a})}function i(a){t({...e,color:a})}return Ct.jsxs("span",{className:"settings-panel",children:[Ct.jsx("h4",{children:"Font"}),Ct.jsx("select",{onChange:a=>n(a.target.value),value:e.font,children:gq.map(a=>Ct.jsx("option",{value:a.value,children:a.label},a.value))}),Ct.jsx("h4",{children:"Size"}),Ct.jsx("select",{onChange:a=>s(a.target.value),value:((o=e.fontSize)==null?void 0:o.toString())||"",children:fq.map(a=>Ct.jsx("option",{value:a.value,children:a.label},a.value))}),Ct.jsx("h4",{children:"Color"}),Ct.jsx(cy,{color:e.color,setColor:a=>i(a)}),Ct.jsx("h4",{children:"Background"}),Ct.jsx(cy,{hasTransparent:!0,color:e.background,setColor:a=>r(a)})]})},Vm=e=>{e.cancelable&&e.stopPropagation()},mq=({minThickness:e,maxThickness:t,defaultArrowStyle:n={},defaultTextStyle:s={}})=>{const{currentAnnotation:r}=mf(),i=Bi.useCallback(Vm,[]),o=Bi.useCallback(a=>(a&&a.element&&a.element.addEventListener("wheel",Vm,{passive:!1}),()=>{a.element.removeEventListener("wheel",Vm)}),[i]);return Bi.useEffect(()=>{Object.assign(zg,n),Object.assign(Bg,s)},[n,s]),Ct.jsx(oH,{className:"controls",ref:o,index:100,children:Ct.jsxs("div",{className:"container",children:[!r&&Ct.jsx(oq,{}),Ct.jsxs("div",{className:"settings",onMouseDown:i,onClick:i,children:[r&&sr(r)&&Ct.jsx(cq,{minThickness:e,maxThickness:t}),r&&jr(r)&&Ct.jsx(pq,{})]})]})})};function _q(){const[e]=Ge.useState({nodes:[{id:0,attributes:{x:0,y:0}},{id:1,attributes:{x:50,y:-100}},{id:2,attributes:{x:-50,y:-100}}],edges:[{source:0,target:1},{source:1,target:2},{source:2,target:0}]});return Ct.jsx("div",{className:"App",children:Ct.jsx(U6,{graph:e,children:Ct.jsx(GH,{children:Ct.jsx(mq,{minThickness:1,maxThickness:10,defaultArrowStyle:{strokeType:"plain",strokeColor:"#3A03CF",strokeWidth:2,head:"arrow"},defaultTextStyle:{font:"IBM Plex Sans",fontSize:10,color:"#3A03CF",background:"#EDE6FF",borderRadius:8,padding:12}})})})})}aI.createRoot(document.getElementById("root")).render(Ct.jsx(_q,{}))});export default yq();
